/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.maps_bundle_jsonpfunction=window.maps_bundle_jsonpfunction||[]).push([[7],{309:function(e,t,n){e.exports=h,h.Minimatch=f;var r=function(){try{return n(595)}catch(e){}}()||{sep:"/"};h.sep=r.sep;var i=h.GLOBSTAR=f.GLOBSTAR={},a=n(596),s={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},o="[^/]",l=o+"*?",c="().*{}+?[]^$\\!".split("").reduce((function(e,t){return e[t]=!0,e}),{}),u=/\/+/;function p(e,t){t=t||{};var n={};return Object.keys(e).forEach((function(t){n[t]=e[t]})),Object.keys(t).forEach((function(e){n[e]=t[e]})),n}function h(e,t,n){return b(t),n||(n={}),!(!n.nocomment&&"#"===t.charAt(0))&&new f(t,n).match(e)}function f(e,t){if(!(this instanceof f))return new f(e,t);b(e),t||(t={}),e=e.trim(),t.allowWindowsEscape||"/"===r.sep||(e=e.split(r.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}function d(e,t){return t||(t=this instanceof f?this.options:{}),e=void 0===e?this.pattern:e,b(e),t.nobrace||!/\{(?:(?!\{).)*\}/.test(e)?[e]:a(e)}h.filter=function(e,t){return t=t||{},function(n,r,i){return h(n,e,t)}},h.defaults=function(e){if(!e||"object"!=typeof e||!Object.keys(e).length)return h;var t=h,n=function(n,r,i){return t(n,r,p(e,i))};return(n.Minimatch=function(n,r){return new t.Minimatch(n,p(e,r))}).defaults=function(n){return t.defaults(p(e,n)).Minimatch},n.filter=function(n,r){return t.filter(n,p(e,r))},n.defaults=function(n){return t.defaults(p(e,n))},n.makeRe=function(n,r){return t.makeRe(n,p(e,r))},n.braceExpand=function(n,r){return t.braceExpand(n,p(e,r))},n.match=function(n,r,i){return t.match(n,r,p(e,i))},n},f.defaults=function(e){return h.defaults(e).Minimatch},f.prototype.debug=function(){},f.prototype.make=function(){var e=this.pattern,t=this.options;if(t.nocomment||"#"!==e.charAt(0))if(e){this.parseNegate();var n=this.globSet=this.braceExpand();t.debug&&(this.debug=function(){console.error.apply(console,arguments)}),this.debug(this.pattern,n),n=this.globParts=n.map((function(e){return e.split(u)})),this.debug(this.pattern,n),n=n.map((function(e,t,n){return e.map(this.parse,this)}),this),this.debug(this.pattern,n),n=n.filter((function(e){return-1===e.indexOf(!1)})),this.debug(this.pattern,n),this.set=n}else this.empty=!0;else this.comment=!0},f.prototype.parseNegate=function(){var e=this.pattern,t=!1,n=0;if(!this.options.nonegate){for(var r=0,i=e.length;r<i&&"!"===e.charAt(r);r++)t=!t,n++;n&&(this.pattern=e.substr(n)),this.negate=t}},h.braceExpand=function(e,t){return d(e,t)},f.prototype.braceExpand=d;var b=function(e){if("string"!=typeof e)throw new TypeError("invalid pattern");if(e.length>65536)throw new TypeError("pattern is too long")};f.prototype.parse=function(e,t){b(e);var n=this.options;if("**"===e){if(!n.noglobstar)return i;e="*"}if(""===e)return"";var r,a="",u=!!n.nocase,p=!1,h=[],f=[],d=!1,y=-1,v=-1,m="."===e.charAt(0)?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",O=this;function I(){if(r){switch(r){case"*":a+=l,u=!0;break;case"?":a+=o,u=!0;break;default:a+="\\"+r}O.debug("clearStateChar %j %j",r,a),r=!1}}for(var C,T=0,_=e.length;T<_&&(C=e.charAt(T));T++)if(this.debug("%s\t%s %s %j",e,T,a,C),p&&c[C])a+="\\"+C,p=!1;else switch(C){case"/":return!1;case"\\":I(),p=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,T,a,C),d){this.debug("  in class"),"!"===C&&T===v+1&&(C="^"),a+=C;continue}O.debug("call clearStateChar %j",r),I(),r=C,n.noext&&I();continue;case"(":if(d){a+="(";continue}if(!r){a+="\\(";continue}h.push({type:r,start:T-1,reStart:a.length,open:s[r].open,close:s[r].close}),a+="!"===r?"(?:(?!(?:":"(?:",this.debug("plType %j %j",r,a),r=!1;continue;case")":if(d||!h.length){a+="\\)";continue}I(),u=!0;var x=h.pop();a+=x.close,"!"===x.type&&f.push(x),x.reEnd=a.length;continue;case"|":if(d||!h.length||p){a+="\\|",p=!1;continue}I(),a+="|";continue;case"[":if(I(),d){a+="\\"+C;continue}d=!0,v=T,y=a.length,a+=C;continue;case"]":if(T===v+1||!d){a+="\\"+C,p=!1;continue}var E=e.substring(v+1,T);try{RegExp("["+E+"]")}catch(e){var A=this.parse(E,g);a=a.substr(0,y)+"\\["+A[0]+"\\]",u=u||A[1],d=!1;continue}u=!0,d=!1,a+=C;continue;default:I(),p?p=!1:!c[C]||"^"===C&&d||(a+="\\"),a+=C}for(d&&(E=e.substr(v+1),A=this.parse(E,g),a=a.substr(0,y)+"\\["+A[0],u=u||A[1]),x=h.pop();x;x=h.pop()){var M=a.slice(x.reStart+x.open.length);this.debug("setting tail",a,x),M=M.replace(/((?:\\{2}){0,64})(\\?)\|/g,(function(e,t,n){return n||(n="\\"),t+t+n+"|"})),this.debug("tail=%j\n   %s",M,M,x,a);var S="*"===x.type?l:"?"===x.type?o:"\\"+x.type;u=!0,a=a.slice(0,x.reStart)+S+"\\("+M}I(),p&&(a+="\\\\");var R=!1;switch(a.charAt(0)){case"[":case".":case"(":R=!0}for(var L=f.length-1;L>-1;L--){var j=f[L],N=a.slice(0,j.reStart),P=a.slice(j.reStart,j.reEnd-8),w=a.slice(j.reEnd-8,j.reEnd),D=a.slice(j.reEnd);w+=D;var U=N.split("(").length-1,F=D;for(T=0;T<U;T++)F=F.replace(/\)[+*?]?/,"");var k="";""===(D=F)&&t!==g&&(k="$"),a=N+P+D+k+w}if(""!==a&&u&&(a="(?=.)"+a),R&&(a=m+a),t===g)return[a,u];if(!u)return e.replace(/\\(.)/g,"$1");var H=n.nocase?"i":"";try{var z=new RegExp("^"+a+"$",H)}catch(e){return new RegExp("$.")}return z._glob=e,z._src=a,z};var g={};h.makeRe=function(e,t){return new f(e,t||{}).makeRe()},f.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,n=t.noglobstar?l:t.dot?"(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?":"(?:(?!(?:\\/|^)\\.).)*?",r=t.nocase?"i":"",a=e.map((function(e){return e.map((function(e){return e===i?n:"string"==typeof e?e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"):e._src})).join("\\/")})).join("|");a="^(?:"+a+")$",this.negate&&(a="^(?!"+a+").*$");try{this.regexp=new RegExp(a,r)}catch(e){this.regexp=!1}return this.regexp},h.match=function(e,t,n){var r=new f(t,n=n||{});return e=e.filter((function(e){return r.match(e)})),r.options.nonull&&!e.length&&e.push(t),e},f.prototype.match=function(e,t){if(void 0===t&&(t=this.partial),this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var n=this.options;"/"!==r.sep&&(e=e.split(r.sep).join("/")),e=e.split(u),this.debug(this.pattern,"split",e);var i,a,s=this.set;for(this.debug(this.pattern,"set",s),a=e.length-1;a>=0&&!(i=e[a]);a--);for(a=0;a<s.length;a++){var o=s[a],l=e;if(n.matchBase&&1===o.length&&(l=[i]),this.matchOne(l,o,t))return!!n.flipNegate||!this.negate}return!n.flipNegate&&this.negate},f.prototype.matchOne=function(e,t,n){var r=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var a=0,s=0,o=e.length,l=t.length;a<o&&s<l;a++,s++){this.debug("matchOne loop");var c,u=t[s],p=e[a];if(this.debug(t,u,p),!1===u)return!1;if(u===i){this.debug("GLOBSTAR",[t,u,p]);var h=a,f=s+1;if(f===l){for(this.debug("** at the end");a<o;a++)if("."===e[a]||".."===e[a]||!r.dot&&"."===e[a].charAt(0))return!1;return!0}for(;h<o;){var d=e[h];if(this.debug("\nglobstar while",e,h,t,f,d),this.matchOne(e.slice(h),t.slice(f),n))return this.debug("globstar found match!",h,o,d),!0;if("."===d||".."===d||!r.dot&&"."===d.charAt(0)){this.debug("dot detected!",e,h,t,f);break}this.debug("globstar swallow a segment, and continue"),h++}return!(!n||(this.debug("\n>>> no match, partial?",e,h,t,f),h!==o))}if("string"==typeof u?(c=p===u,this.debug("string match",u,p,c)):(c=p.match(u),this.debug("pattern match",u,p,c)),!c)return!1}if(a===o&&s===l)return!0;if(a===o)return n;if(s===l)return a===o-1&&""===e[a];throw new Error("wtf?")}},315:function(e,t,n){"use strict";n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return R}));var r=n(4),i=n(1),a=n(0),s=n(2),o=n.n(s),l=n(15),c=n(3);let u;!function(e){e.APM_RUM_PERFORMANCE="APM_RUM_PERFORMANCE",e.APM_RUM_TRAFFIC="APM_RUM_TRAFFIC"}(u||(u={}));const p=[{value:u.APM_RUM_PERFORMANCE,text:i.i18n.translate("xpack.maps.observability.apmRumPerformanceLabel",{defaultMessage:"APM RUM Performance"})},{value:u.APM_RUM_TRAFFIC,text:i.i18n.translate("xpack.maps.observability.apmRumTrafficLabel",{defaultMessage:"APM RUM Traffic"})}];function h(e){const t=e.value?p:[{value:"",text:""},...p];return Object(c.jsx)(l.EuiFormRow,{label:i.i18n.translate("xpack.maps.observability.layerLabel",{defaultMessage:"Layer"})},Object(c.jsx)(l.EuiSelect,{options:t,value:e.value?e.value:"",onChange:function(t){e.onChange(t.target.value)}}))}let f;!function(e){e.TRANSACTION_DURATION="TRANSACTION_DURATION",e.COUNT="COUNT",e.UNIQUE_COUNT="UNIQUE_COUNT"}(f||(f={}));const d=[{value:f.TRANSACTION_DURATION,text:i.i18n.translate("xpack.maps.observability.transactionDurationLabel",{defaultMessage:"Transaction duraction"})}],b=[{value:f.COUNT,text:i.i18n.translate("xpack.maps.observability.countLabel",{defaultMessage:"Count"})},{value:f.UNIQUE_COUNT,text:i.i18n.translate("xpack.maps.observability.uniqueCountLabel",{defaultMessage:"Unique count"})}];function g(e){return e===u.APM_RUM_PERFORMANCE?d:e===u.APM_RUM_TRAFFIC?b:[]}function y(e){return e.layer&&e.value?Object(c.jsx)(l.EuiFormRow,{label:i.i18n.translate("xpack.maps.observability.metricLabel",{defaultMessage:"Metric"})},Object(c.jsx)(l.EuiSelect,{options:g(e.layer),value:e.value,onChange:function(t){e.onChange(t.target.value)}})):null}let v;!function(e){e.CHOROPLETH="CHOROPLETH",e.CLUSTERS="CLUSTERS",e.GRIDS="GRIDS",e.HEATMAP="HEATMAP"}(v||(v={}));const m=[{value:v.CHOROPLETH,text:i.i18n.translate("xpack.maps.observability.choroplethLabel",{defaultMessage:"World boundaries"})},{value:v.CLUSTERS,text:i.i18n.translate("xpack.maps.observability.clustersLabel",{defaultMessage:"Clusters"})},{value:v.GRIDS,text:i.i18n.translate("xpack.maps.observability.gridsLabel",{defaultMessage:"Grids"})},{value:v.HEATMAP,text:i.i18n.translate("xpack.maps.observability.heatMapLabel",{defaultMessage:"Heat map"})}];function O(e){return e.layer?Object(c.jsx)(l.EuiFormRow,{label:i.i18n.translate("xpack.maps.observability.displayLabel",{defaultMessage:"Display"})},Object(c.jsx)(l.EuiSelect,{options:m,value:e.value,onChange:function(t){e.onChange(t.target.value)}})):null}var I=n(43),C=n(93),T=n(86),_=n(122),x=n(141),E=n(76),A=n(123),M=n(83);const S="apm_static_index_pattern_id",R="traces-apm*,logs-apm*,metrics-apm*,apm-*",L=Object(M.i)();function j(e,t){return{type:a.Eb.DYNAMIC,options:{...L[a.Ib.FILL_COLOR].options,field:t,color:e===u.APM_RUM_PERFORMANCE?"Green to Red":"Yellow to Red",type:a.j.ORDINAL}}}function N(e){return e===v.HEATMAP?a.ub.HEATMAP:e===v.GRIDS?a.ub.GRID:a.ub.POINT}class observability_layer_template_ObservabilityLayerTemplate extends r.Component{constructor(...e){super(...e),o()(this,"state",{layer:null,metric:null,display:v.CHOROPLETH}),o()(this,"_onLayerChange",(e=>{const t={layer:e,metric:this.state.metric},n=g(e);n.find((e=>e.value===this.state.metric))||(n.length?t.metric=n[0].value:t.metric=null),this.setState(t,this._previewLayer)})),o()(this,"_onMetricChange",(e=>{this.setState({metric:e},this._previewLayer)})),o()(this,"_onDisplayChange",(e=>{this.setState({display:e},this._previewLayer)}))}_previewLayer(){const e=function({layer:e,metric:t,display:n}){if(!e||!t||!n)return null;const r=function(e){let t;return e!==u.APM_RUM_PERFORMANCE&&e!==u.APM_RUM_TRAFFIC||(t='processor.event:"transaction"'),t?{language:"kuery",query:t}:void 0}(e),s=function(e,t){let n,r;return e===u.APM_RUM_PERFORMANCE?n=i.i18n.translate("xpack.maps.observability.apmRumPerformanceLayerName",{defaultMessage:"Performance"}):e===u.APM_RUM_TRAFFIC&&(n=i.i18n.translate("xpack.maps.observability.apmRumTrafficLayerName",{defaultMessage:"Traffic"})),t===f.TRANSACTION_DURATION?r=i.i18n.translate("xpack.maps.observability.durationMetricName",{defaultMessage:"Duration"}):t===f.COUNT?r=i.i18n.translate("xpack.maps.observability.countMetricName",{defaultMessage:"Total"}):t===f.UNIQUE_COUNT&&(r=i.i18n.translate("xpack.maps.observability.uniqueCountMetricName",{defaultMessage:"Unique count"})),`[${n}] ${r}`}(e,t),o=function(e){return e===f.TRANSACTION_DURATION?{type:a.b.AVG,field:"transaction.duration.us"}:e===f.UNIQUE_COUNT?{type:a.b.UNIQUE_COUNT,field:"transaction.id"}:{type:a.b.COUNT}}(t);if(n===v.CHOROPLETH){const t=Object(I.v4)(),n=Object(C.a)({aggType:o.type,aggFieldName:"field"in o?o.field:"",rightSourceId:t});return E.b.createDescriptor({label:s,joins:[{leftField:"iso2",right:{type:a.Cb.ES_TERM_SOURCE,id:t,indexPatternId:S,term:"client.geo.country_iso_code",metrics:[o],whereQuery:r,applyGlobalQuery:!0,applyGlobalTime:!0,applyForceRefresh:!0}}],sourceDescriptor:_.a.createDescriptor({id:a.Lb,tooltipProperties:["name","iso2"]}),style:T.a.createDescriptor({[a.Ib.FILL_COLOR]:j(e,{name:n,origin:a.D.JOIN}),[a.Ib.LINE_COLOR]:{type:a.Eb.STATIC,options:{color:"#3d3d3d"}}})})}const l=x.a.createDescriptor({indexPatternId:S,geoField:"client.geo.location",metrics:[o],requestType:N(n),resolution:a.L.MOST_FINE});if(n===v.HEATMAP)return A.a.createDescriptor({label:s,query:r,sourceDescriptor:l});const c={name:Object(C.b)({aggType:o.type,aggFieldName:"field"in o?o.field:void 0}),origin:a.D.SOURCE},p={[a.Ib.FILL_COLOR]:j(e,c),[a.Ib.ICON_SIZE]:{type:a.Eb.DYNAMIC,options:{...L[a.Ib.ICON_SIZE].options,field:c}},[a.Ib.LINE_COLOR]:{type:a.Eb.STATIC,options:{color:"#3d3d3d"}}};return E.b.createDescriptor({label:s,query:r,sourceDescriptor:l,style:T.a.createDescriptor(p)})}({layer:this.state.layer,metric:this.state.metric,display:this.state.display});this.props.previewLayers(e?[e]:[])}render(){return Object(c.jsx)(l.EuiPanel,null,Object(c.jsx)(h,{value:this.state.layer,onChange:this._onLayerChange}),Object(c.jsx)(y,{layer:this.state.layer,value:this.state.metric,onChange:this._onMetricChange}),Object(c.jsx)(O,{layer:this.state.layer,value:this.state.display,onChange:this._onDisplayChange}))}}var P=n(5);const w={id:a.Jb.OBSERVABILITY,order:20,categories:[a.ab.ELASTICSEARCH,a.ab.SOLUTIONS],getIsDisabled:async()=>{try{return await Object(P.u)().get(S),!1}catch(e){return!0}},disabledReason:i.i18n.translate("xpack.maps.observability.disabledDesc",{defaultMessage:"Cannot find APM data view. To get started with Observably, go to Observability > Overview."}),description:i.i18n.translate("xpack.maps.observability.desc",{defaultMessage:"APM layers"}),icon:"logoObservability",renderWizard:e=>Object(c.jsx)(observability_layer_template_ObservabilityLayerTemplate,e),title:i.i18n.translate("xpack.maps.observability.title",{defaultMessage:"Observability"})}},595:function(e,t,n){(function(e){function n(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}function r(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}t.resolve=function(){for(var t="",i=!1,a=arguments.length-1;a>=-1&&!i;a--){var s=a>=0?arguments[a]:e.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(t=s+"/"+t,i="/"===s.charAt(0))}return(i?"/":"")+(t=n(r(t.split("/"),(function(e){return!!e})),!i).join("/"))||"."},t.normalize=function(e){var a=t.isAbsolute(e),s="/"===i(e,-1);return(e=n(r(e.split("/"),(function(e){return!!e})),!a).join("/"))||a||(e="."),e&&s&&(e+="/"),(a?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(r(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,n){function r(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=t.resolve(e).substr(1),n=t.resolve(n).substr(1);for(var i=r(e.split("/")),a=r(n.split("/")),s=Math.min(i.length,a.length),o=s,l=0;l<s;l++)if(i[l]!==a[l]){o=l;break}var c=[];for(l=o;l<i.length;l++)c.push("..");return(c=c.concat(a.slice(o))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!i){r=a;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},t.basename=function(e,t){var n=function(e){"string"!=typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,a=0,s=e.length-1;s>=0;--s){var o=e.charCodeAt(s);if(47!==o)-1===r&&(i=!1,r=s+1),46===o?-1===t?t=s:1!==a&&(a=1):-1!==t&&(a=-1);else if(!i){n=s+1;break}}return-1===t||-1===r||0===a||1===a&&t===r-1&&t===n+1?"":e.slice(t,r)};var i="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}}).call(this,n(106))},596:function(e,t,n){var r=n(597),i=n(598);e.exports=function(e){return e?("{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2)),y(function(e){return e.split("\\\\").join(a).split("\\{").join(s).split("\\}").join(o).split("\\,").join(l).split("\\.").join(c)}(e),!0).map(p)):[]};var a="\0SLASH"+Math.random()+"\0",s="\0OPEN"+Math.random()+"\0",o="\0CLOSE"+Math.random()+"\0",l="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function u(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function p(e){return e.split(a).join("\\").split(s).join("{").split(o).join("}").split(l).join(",").split(c).join(".")}function h(e){if(!e)return[""];var t=[],n=i("{","}",e);if(!n)return e.split(",");var r=n.pre,a=n.body,s=n.post,o=r.split(",");o[o.length-1]+="{"+a+"}";var l=h(s);return s.length&&(o[o.length-1]+=l.shift(),o.push.apply(o,l)),t.push.apply(t,o),t}function f(e){return"{"+e+"}"}function d(e){return/^-?0\d/.test(e)}function b(e,t){return e<=t}function g(e,t){return e>=t}function y(e,t){var n=[],a=i("{","}",e);if(!a||/\$$/.test(a.pre))return[e];var s,l=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(a.body),c=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(a.body),p=l||c,v=a.body.indexOf(",")>=0;if(!p&&!v)return a.post.match(/,.*\}/)?y(e=a.pre+"{"+a.body+o+a.post):[e];if(p)s=a.body.split(/\.\./);else if(1===(s=h(a.body)).length&&1===(s=y(s[0],!1).map(f)).length)return(I=a.post.length?y(a.post,!1):[""]).map((function(e){return a.pre+s[0]+e}));var m,O=a.pre,I=a.post.length?y(a.post,!1):[""];if(p){var C=u(s[0]),T=u(s[1]),_=Math.max(s[0].length,s[1].length),x=3==s.length?Math.abs(u(s[2])):1,E=b;T<C&&(x*=-1,E=g);var A=s.some(d);m=[];for(var M=C;E(M,T);M+=x){var S;if(c)"\\"===(S=String.fromCharCode(M))&&(S="");else if(S=String(M),A){var R=_-S.length;if(R>0){var L=new Array(R+1).join("0");S=M<0?"-"+L+S.slice(1):L+S}}m.push(S)}}else m=r(s,(function(e){return y(e,!1)}));for(var j=0;j<m.length;j++)for(var N=0;N<I.length;N++){var P=O+m[j]+I[N];(!t||p||P)&&n.push(P)}return n}},597:function(e,t){e.exports=function(e,t){for(var r=[],i=0;i<e.length;i++){var a=t(e[i],i);n(a)?r.push.apply(r,a):r.push(a)}return r};var n=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},598:function(e,t,n){"use strict";function r(e,t,n){e instanceof RegExp&&(e=i(e,n)),t instanceof RegExp&&(t=i(t,n));var r=a(e,t,n);return r&&{start:r[0],end:r[1],pre:n.slice(0,r[0]),body:n.slice(r[0]+e.length,r[1]),post:n.slice(r[1]+t.length)}}function i(e,t){var n=t.match(e);return n?n[0]:null}function a(e,t,n){var r,i,a,s,o,l=n.indexOf(e),c=n.indexOf(t,l+1),u=l;if(l>=0&&c>0){if(e===t)return[l,c];for(r=[],a=n.length;u>=0&&!o;)u==l?(r.push(u),l=n.indexOf(e,u+1)):1==r.length?o=[r.pop(),c]:((i=r.pop())<a&&(a=i,s=c),c=n.indexOf(t,u+1)),u=l<c&&l>=0?l:c;r.length&&(o=[a,s])}return o}e.exports=r,r.range=a},602:function(e,t,n){"use strict";n.r(t),n.d(t,"createSecurityLayerDescriptors",(function(){return T})),n.d(t,"SecurityLayerWizardConfig",(function(){return L}));var r=n(309),i=n.n(r),a=n(1),s=n(15),o=n(0),l=n(76),c=n(90),u=n(86),p=n(111),h=n(303),f=n(83),d=n(315);const b=Object(f.i)(),g=Object(s.euiPaletteColorBlind)();function y(e){return d.a.split(",").map((t=>i()(e,t))).some(Boolean)}function v(e){return y(e)?"client.geo.location":"source.geo.location"}function m(e){return y(e)?"server.geo.location":"destination.geo.location"}function O(e,t,n){const r=p.ESSearchSource.createDescriptor({indexPatternId:e,geoField:v(t),scalingType:o.wb.TOP_HITS,topHitsSplitField:y(t)?"client.ip":"source.ip",tooltipProperties:y(t)?["host.name","client.ip","client.domain","client.geo.country_iso_code","client.as.organization.name"]:["host.name","source.ip","source.domain","source.geo.country_iso_code","source.as.organization.name"]}),i={[o.Ib.FILL_COLOR]:{type:o.Eb.STATIC,options:{color:g[1]}},[o.Ib.LINE_COLOR]:{type:o.Eb.STATIC,options:{color:"#FFFFFF"}},[o.Ib.LINE_WIDTH]:{type:o.Eb.STATIC,options:{size:2}},[o.Ib.SYMBOLIZE_AS]:{options:{value:o.Fb.ICON}},[o.Ib.ICON]:{type:o.Eb.STATIC,options:{value:"home"}},[o.Ib.ICON_SIZE]:{type:o.Eb.STATIC,options:{size:8}}};return l.b.createDescriptor({label:a.i18n.translate("xpack.maps.sescurity.sourceLayerLabel",{defaultMessage:"{indexPatternTitle} | Source Point",values:{indexPatternTitle:t}}),parent:n,sourceDescriptor:r,style:u.a.createDescriptor(i)})}function I(e,t,n){const r=p.ESSearchSource.createDescriptor({indexPatternId:e,geoField:m(t),scalingType:o.wb.TOP_HITS,topHitsSplitField:y(t)?"server.ip":"destination.ip",tooltipProperties:y(t)?["host.name","server.ip","server.domain","server.geo.country_iso_code","server.as.organization.name"]:["host.name","destination.ip","destination.domain","destination.geo.country_iso_code","destination.as.organization.name"]}),i={[o.Ib.FILL_COLOR]:{type:o.Eb.STATIC,options:{color:g[2]}},[o.Ib.LINE_COLOR]:{type:o.Eb.STATIC,options:{color:"#FFFFFF"}},[o.Ib.LINE_WIDTH]:{type:o.Eb.STATIC,options:{size:2}},[o.Ib.SYMBOLIZE_AS]:{options:{value:o.Fb.ICON}},[o.Ib.ICON]:{type:o.Eb.STATIC,options:{value:"marker"}},[o.Ib.ICON_SIZE]:{type:o.Eb.STATIC,options:{size:8}}};return l.b.createDescriptor({label:a.i18n.translate("xpack.maps.sescurity.destinationLayerLabel",{defaultMessage:"{indexPatternTitle} | Destination point",values:{indexPatternTitle:t}}),parent:n,sourceDescriptor:r,style:u.a.createDescriptor(i)})}function C(e,t,n){const r=h.a.createDescriptor({indexPatternId:e,sourceGeoField:v(t),destGeoField:m(t),metrics:[{type:o.b.SUM,field:y(t)?"client.bytes":"source.bytes"},{type:o.b.SUM,field:y(t)?"server.bytes":"destination.bytes"}]}),i={[o.Ib.LINE_COLOR]:{type:o.Eb.STATIC,options:{color:g[1]}},[o.Ib.LINE_WIDTH]:{type:o.Eb.DYNAMIC,options:{...b[o.Ib.LINE_WIDTH].options,field:{name:o.k,origin:o.D.SOURCE},minSize:1,maxSize:8}}};return l.b.createDescriptor({label:a.i18n.translate("xpack.maps.sescurity.lineLayerLabel",{defaultMessage:"{indexPatternTitle} | Line",values:{indexPatternTitle:t}}),parent:n,sourceDescriptor:r,style:u.a.createDescriptor(i)})}function T(e,t){const n=c.b.createDescriptor({label:t});return[O(e,t,n.id),I(e,t,n.id),C(e,t,n.id),n]}var _=n(4),x=n(5);async function E(){const e=Object(x.S)();let t;try{t=e.get("securitySolution:defaultIndex")}catch(e){return[]}return(await Object(x.u)().getCache()).filter((e=>t.some((t=>{var n;return i()(t,null==e||null===(n=e.attributes)||void 0===n?void 0:n.title)})))).map((e=>({id:e.id,title:e.attributes.title})))}var A=n(2),M=n.n(A),S=n(78),R=n(3);class index_pattern_select_IndexPatternSelect extends _.Component{constructor(...e){super(...e),M()(this,"_isMounted",!1),M()(this,"state",{hasLoaded:!1,options:[]}),M()(this,"_onChange",(e=>{const t=this.state.options.find((({value:t,text:n})=>e.target.value===t));""!==e.target.value&&t?this.props.onChange({id:t.value,title:t.text}):this.props.onChange(null)}))}componentWillUnmount(){this._isMounted=!1}componentDidMount(){this._isMounted=!0,this._loadOptions()}async _loadOptions(){const e=await E();this._isMounted&&this.setState({hasLoaded:!0,options:[{value:"",text:""},...e.map((({id:e,title:t})=>({value:e,text:t})))]})}render(){return this.state.hasLoaded?Object(R.jsx)(s.EuiFormRow,{label:Object(S.b)()},Object(R.jsx)(s.EuiSelect,{options:this.state.options,value:this.props.value?this.props.value:"",onChange:this._onChange})):null}}class security_layer_template_SecurityLayerTemplate extends _.Component{constructor(...e){super(...e),M()(this,"state",{indexPatternId:null,indexPatternTitle:null}),M()(this,"_onIndexPatternChange",(e=>{this.setState({indexPatternId:e?e.id:null,indexPatternTitle:e?e.title:null},this._previewLayer)}))}_previewLayer(){this.state.indexPatternId&&this.state.indexPatternTitle?this.props.previewLayers(T(this.state.indexPatternId,this.state.indexPatternTitle)):this.props.previewLayers([])}render(){return Object(R.jsx)(s.EuiPanel,null,Object(R.jsx)(index_pattern_select_IndexPatternSelect,{value:this.state.indexPatternId?this.state.indexPatternId:"",onChange:this._onIndexPatternChange}))}}const L={id:o.Jb.SECURITY,order:20,categories:[o.ab.ELASTICSEARCH,o.ab.SOLUTIONS],getIsDisabled:async()=>0===(await E()).length,disabledReason:a.i18n.translate("xpack.maps.security.disabledDesc",{defaultMessage:"Cannot find security data view. To get started with Security, go to Security > Overview."}),description:a.i18n.translate("xpack.maps.security.desc",{defaultMessage:"Security layers"}),icon:"logoSecurity",renderWizard:e=>Object(R.jsx)(security_layer_template_SecurityLayerTemplate,e),title:a.i18n.translate("xpack.maps.security.title",{defaultMessage:"Security"})}}}]);