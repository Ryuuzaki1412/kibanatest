/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.lens_bundle_jsonpfunction=window.lens_bundle_jsonpfunction||[]).push([[7],{503:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(504);case"v8light":return n(506)}},504:function(e,t,n){var a=n(67),i=n(505);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},505:function(e,t,n){(t=n(68)(!1)).push([e.i,".lnsRowCompressedMargin+.lnsRowCompressedMargin{margin-top:8px}.lnsConfigPanelNoPadding{padding:0}.lnsConfigPanelDate__label{min-width:56px}.lnsConfigPanelAnnotations__addButton{margin-top:4px}.lnsConfigPanelAnnotations__fieldPicker{cursor:pointer}",""]),e.exports=t},506:function(e,t,n){var a=n(67),i=n(507);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},507:function(e,t,n){(t=n(68)(!1)).push([e.i,".lnsRowCompressedMargin+.lnsRowCompressedMargin{margin-top:8px}.lnsConfigPanelNoPadding{padding:0}.lnsConfigPanelDate__label{min-width:56px}.lnsConfigPanelAnnotations__addButton{margin-top:4px}.lnsConfigPanelAnnotations__fieldPicker{cursor:pointer}",""]),e.exports=t},508:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(509);case"v8light":return n(511)}},509:function(e,t,n){var a=n(67),i=n(510);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},510:function(e,t,n){(t=n(68)(!1)).push([e.i,'.lnsDimensionEditorSection{padding-bottom:16px;padding-top:16px}.lnsDimensionEditorSection:first-child{padding-top:0}.lnsDimensionEditorSection:first-child .lnsDimensionEditorSection__border{display:none}.lnsDimensionEditorSection__border{position:relative}.lnsDimensionEditorSection__border:before{border-top:1px solid #343741;content:"";left:-16px;position:absolute;right:-16px;top:-16px}.lnsDimensionEditorSection__heading{padding-bottom:16px}',""]),e.exports=t},511:function(e,t,n){var a=n(67),i=n(512);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},512:function(e,t,n){(t=n(68)(!1)).push([e.i,'.lnsDimensionEditorSection{padding-bottom:16px;padding-top:16px}.lnsDimensionEditorSection:first-child{padding-top:0}.lnsDimensionEditorSection:first-child .lnsDimensionEditorSection__border{display:none}.lnsDimensionEditorSection__border{position:relative}.lnsDimensionEditorSection__border:before{border-top:1px solid #d3dae6;content:"";left:-16px;position:absolute;right:-16px;top:-16px}.lnsDimensionEditorSection__heading{padding-bottom:16px}',""]),e.exports=t},560:function(e,t,n){"use strict";n.r(t),n.d(t,"idPrefix",(function(){return $})),n(503);var a=n(541),i=n(7),l=n.n(i),o=n(0),s=n(4),d=(n(508),n(2));const r=({children:e,title:t})=>Object(d.jsx)("div",{className:"lnsDimensionEditorSection"},Object(d.jsx)("div",{className:"lnsDimensionEditorSection__border"}),t&&Object(d.jsx)(s.EuiTitle,{size:"xxs",className:"lnsDimensionEditorSection__heading"},Object(d.jsx)("h3",null,t)),e);var u=n(548),p=n(534),c=n(539),m=n(543),b=n(540),f=n(535),y=n(115),g=n(14),j=n.n(g),C=n(82),x=n(27),h=n(29),v=n(92),O=n.n(v);const _=h.euiLightVars.euiColorAccent,S="#F04E981A",w=o.i18n.translate("eventAnnotationComponents.xyChart.defaultAnnotationLabel",{defaultMessage:"Event"}),A=o.i18n.translate("eventAnnotationComponents.xyChart.defaultRangeAnnotationLabel",{defaultMessage:"Event range"}),k=(e=_)=>O()(Object(s.transparentize)(e,.1)).hex().toUpperCase(),F=(e=S)=>O()(Object(s.transparentize)(e,1)).hex().toUpperCase();var E=n(114),N=n(528),M=n(119),D=n(545),T=n(565),I=n(544);const P=2,R=Object(s.htmlIdGenerator)(),q=new Set(["string","boolean","number","ip","date"]);function Y(e){return null!=e.value}function B({currentConfig:e,setConfig:t,dataView:n,invalidFields:r}){const{hasFieldData:u}=Object(y.b)(),p=Object(i.useCallback)((n=>{t({...e,extraFields:n.filter(Y).map((({value:e})=>e))})}),[t,e]),{wrappedValues:c,rawValuesLookup:b}=Object(i.useMemo)((()=>{var t;const n=null!==(t=e.extraFields)&&void 0!==t?t:[];return{wrappedValues:n.map((e=>({id:R(),value:e}))),rawValuesLookup:new Set(n)}}),[e]),{inputValue:f,handleInputChange:g}=Object(M.a)({onChange:p,value:c}),j=Object(i.useCallback)(((e,t=0)=>{const a=[...f];n.getFieldByName(e.field)&&(a[t]={id:R(),value:e.field},g(a))}),[f,n,g]),C=Object(d.jsx)(D.a,{className:"lnsConfigPanelAnnotations__addButton","data-test-subj":"lnsXY-annotation-tooltip-add_field",onClick:()=>{g([...f,{id:R(),value:void 0,isNew:!0}])},label:o.i18n.translate("eventAnnotationComponents.xyChart.annotation.tooltip.addField",{defaultMessage:"Add field"}),isDisabled:f.length>P});if(0===f.length)return Object(d.jsx)(l.a.Fragment,null,Object(d.jsx)(s.EuiFlexItem,{grow:!0},Object(d.jsx)(s.EuiPanel,{color:"subdued",paddingSize:"s",className:"lnsConfigPanelAnnotations__noFieldsPrompt"},Object(d.jsx)(s.EuiText,{color:"subdued",size:"s",textAlign:"center"},o.i18n.translate("eventAnnotationComponents.xyChart.annotation.tooltip.noFields",{defaultMessage:"None selected"})))),C);const x=n.fields.filter(a.a).filter((({displayName:e,type:t})=>e&&!b.has(e)&&q.has(t))).map((e=>({label:e.displayName,value:{type:"field",field:e.name,dataType:Object(N.a)(e)},exists:!!n.id&&u(n.id,e.name),compatible:!0,"data-test-subj":`lnsXY-annotation-tooltip-fieldOption-${e.name}`}))).sort(((e,t)=>e.label.localeCompare(t.label)));return Object(d.jsx)(l.a.Fragment,null,Object(d.jsx)(T.a,{onDragEnd:e=>{g(e)},droppableId:"ANNOTATION_TOOLTIP_DROPPABLE_AREA",items:f,bgColor:"subdued"},f.map((({id:e,value:t,isNew:a},i,l)=>{const s=!t||Boolean(n.getFieldByName(t));return Object(d.jsx)(T.b,{id:(null!=t?t:"newField")+e,key:(null!=t?t:"newField")+e,idx:i,onRemoveClick:()=>{g(l.filter(((e,t)=>t!==i)))},removeTitle:o.i18n.translate("eventAnnotationComponents.xyChart.annotation.tooltip.deleteButtonLabel",{defaultMessage:"Delete"}),isNotDraggable:l.length<2,Container:I.a,isInsidePanel:!0,"data-test-subj":`lnsXY-annotation-tooltip-${i}`},Object(d.jsx)(m.a,{compressed:!0,selectedOptions:t?[{label:t,value:{type:"field",field:t}}]:[],options:x,onChoose:e=>{j(e,i)},fieldIsInvalid:!s,className:"lnsConfigPanelAnnotations__fieldPicker","data-test-subj":`lnsXY-annotation-tooltip-field-picker--${i}`,autoFocus:a&&null==t}))}))),C)}const V=({annotation:e,onChange:t,getDefaultRangeEnd:n})=>{const a=Object(C.g)(e);return Object(d.jsx)(s.EuiFormRow,{display:"columnCompressed",className:"lnsRowCompressedMargin"},Object(d.jsx)(s.EuiSwitch,{"data-test-subj":"lns-xyAnnotation-rangeSwitch",label:Object(d.jsx)(s.EuiText,{size:"xs"},o.i18n.translate("eventAnnotationComponents.xyChart.applyAsRange",{defaultMessage:"Apply as range"})),checked:a,onChange:()=>{if(a){const n={type:"manual",key:{type:"point_in_time",timestamp:e.key.timestamp},id:e.id,label:e.label===A?w:e.label,color:F(e.color),isHidden:e.isHidden};t(n)}else if(e){const a={type:"manual",key:{type:"range",timestamp:e.key.timestamp,endTimestamp:n(e.key.timestamp)},id:e.id,label:e.label===w?A:e.label,color:k(e.color),isHidden:e.isHidden};t(a)}},compressed:!0}))},W=({value:e,label:t,prependLabel:n,onChange:a,calendarClassName:i,dataTestSubj:l="lnsXY_annotation_date_picker"})=>Object(d.jsx)(s.EuiFormRow,{display:"rowCompressed",fullWidth:!0,label:t,className:"lnsRowCompressedMargin"},n?Object(d.jsx)(s.EuiFormControlLayout,{fullWidth:!0,className:"lnsConfigPanelNoPadding",prepend:Object(d.jsx)(s.EuiFormLabel,{className:"lnsConfigPanelDate__label"},n)},Object(d.jsx)(s.EuiDatePicker,{calendarClassName:i,fullWidth:!0,showTimeSelect:!0,selected:e,onChange:a,dateFormat:"MMM D, YYYY @ HH:mm:ss.SSS","data-test-subj":l})):Object(d.jsx)(s.EuiDatePicker,{calendarClassName:i,fullWidth:!0,showTimeSelect:!0,selected:e,onChange:a,dateFormat:"MMM D, YYYY @ HH:mm:ss.SSS","data-test-subj":l})),H=({annotation:e,onChange:t,getDefaultRangeEnd:n,calendarClassName:a})=>{const i=Object(C.g)(e);return Object(d.jsx)(l.a.Fragment,null,i?Object(d.jsx)(l.a.Fragment,null,Object(d.jsx)(W,{dataTestSubj:"lns-xyAnnotation-fromTime",calendarClassName:a,prependLabel:o.i18n.translate("eventAnnotationComponents.xyChart.annotationDate.from",{defaultMessage:"From"}),value:j()(null==e?void 0:e.key.timestamp),onChange:n=>{if(n){const a=j()(null==e?void 0:e.key.endTimestamp).valueOf();if(a<n.valueOf()){const i=a-j()(null==e?void 0:e.key.timestamp).valueOf();t({key:{...(null==e?void 0:e.key)||{type:"range"},timestamp:n.toISOString(),endTimestamp:j()(n.valueOf()+i).toISOString()}})}else t({key:{...(null==e?void 0:e.key)||{type:"range"},timestamp:n.toISOString()}})}},label:o.i18n.translate("eventAnnotationComponents.xyChart.annotationDate",{defaultMessage:"Annotation date"})}),Object(d.jsx)(W,{dataTestSubj:"lns-xyAnnotation-toTime",calendarClassName:a,prependLabel:o.i18n.translate("eventAnnotationComponents.xyChart.annotationDate.to",{defaultMessage:"To"}),value:j()(null==e?void 0:e.key.endTimestamp),onChange:n=>{if(n){const a=j()(null==e?void 0:e.key.timestamp).valueOf();if(a>n.valueOf()){const i=j()(null==e?void 0:e.key.endTimestamp).valueOf()-a;t({key:{...(null==e?void 0:e.key)||{type:"range"},endTimestamp:n.toISOString(),timestamp:j()(n.valueOf()-i).toISOString()}})}else t({key:{...(null==e?void 0:e.key)||{type:"range"},endTimestamp:n.toISOString()}})}}})):Object(d.jsx)(W,{dataTestSubj:"lns-xyAnnotation-time",calendarClassName:a,label:o.i18n.translate("eventAnnotationComponents.xyChart.annotationDate",{defaultMessage:"Annotation date"}),value:j()(null==e?void 0:e.key.timestamp),onChange:n=>{n&&t({key:{...(null==e?void 0:e.key)||{type:"point_in_time"},timestamp:n.toISOString()}})}}),Object(d.jsx)(V,{annotation:e,onChange:t,getDefaultRangeEnd:n}))};var L=n(547);const X={query:"",language:"kuery"},z=({annotation:e,dataView:t,onChange:n,queryInputShouldOpen:i,queryInputServices:r,appName:u})=>{var p,c;const{hasFieldData:b}=Object(y.b)(),f=t.fields.filter(a.a).filter((e=>"date"===e.type&&e.displayName)).map((e=>({label:e.displayName,value:{type:"field",field:e.name,dataType:e.type},exists:!!t.id&&b(t.id,e.name),compatible:!0,"data-test-subj":`lns-fieldOption-${e.name}`}))),g=(null==e?void 0:e.timeField)||t.timeFieldName||(null===(p=f[0])||void 0===p?void 0:p.value.field),j=!g||Boolean(t.getFieldByName(g));return Object(d.jsx)(l.a.Fragment,null,Object(d.jsx)(s.EuiFormRow,{hasChildLabel:!0,display:"rowCompressed",className:"lnsRowCompressedMargin",fullWidth:!0,label:o.i18n.translate("eventAnnotationComponents.xyChart.annotation.queryInput",{defaultMessage:"Annotation query"})},Object(d.jsx)(L.a,{"data-test-subj":"annotation-query-based-query-input",initiallyOpen:i,label:"",inputFilter:null!==(c=null==e?void 0:e.filter)&&void 0!==c?c:X,onChange:e=>{n({filter:{type:"kibana_query",...e}})},dataView:t,appName:u,queryInputServices:r})),Object(d.jsx)(s.EuiFormRow,{display:"rowCompressed",fullWidth:!0,label:o.i18n.translate("eventAnnotationComponents.xyChart.annotation.queryField",{defaultMessage:"Target date field"})},Object(d.jsx)(m.a,{compressed:!0,options:f,selectedOptions:g?[{label:g,value:{type:"field",field:g}}]:[],onChoose:function(e){e&&n({timeField:e.field})},fieldIsInvalid:!j,"data-test-subj":"lnsXY-annotation-query-based-field-picker"})))},$=Object(s.htmlIdGenerator)()(),G=({label:e,"data-test-subj":t,value:n,onChange:a})=>Object(d.jsx)(s.EuiFormRow,{label:e,display:"columnCompressedSwitch",fullWidth:!0},Object(d.jsx)(s.EuiSwitch,{compressed:!0,label:e,showLabel:!1,"data-test-subj":t,checked:n,onChange:a}));t.default=({annotation:e,onAnnotationChange:t,dataView:n,getDefaultRangeEnd:g,calendarClassName:h,queryInputServices:v,appName:O})=>{const{hasFieldData:k}=Object(y.b)(),N=Object(C.f)(e),M=Object(C.g)(e),[D,T]=l.a.useState(!1);Object(i.useEffect)((()=>{T(!N)}),[N]);const I=Object(i.useCallback)((n=>{return n&&t((a={...e,...n},Object(C.g)(a)?Object(x.pick)(a,["type","label","key","id","isHidden","color","outside"]):Object(C.f)(a)?Object(x.pick)(a,["type","id","label","key","timeField","isHidden","lineStyle","lineWidth","color","icon","textVisibility","textField","filter","extraFields"]):Object(x.pick)(a,["type","id","label","key","isHidden","lineStyle","lineWidth","color","icon","textVisibility"])));var a}),[e,t]);return Object(d.jsx)(l.a.Fragment,null,Object(d.jsx)(r,{title:o.i18n.translate("eventAnnotationComponents.xyChart.placement",{defaultMessage:"Placement"})},Object(d.jsx)(s.EuiFormRow,{label:o.i18n.translate("eventAnnotationComponents.xyChart.annotationDate.placementType",{defaultMessage:"Placement type"}),display:"rowCompressed",fullWidth:!0},Object(d.jsx)(s.EuiButtonGroup,{legend:o.i18n.translate("eventAnnotationComponents.xyChart.annotationDate.placementType",{defaultMessage:"Placement type"}),"data-test-subj":"lns-xyAnnotation-placementType",name:"placementType",buttonSize:"compressed",options:[{id:"lens_xyChart_annotation_manual",label:o.i18n.translate("eventAnnotationComponents.xyChart.annotation.manual",{defaultMessage:"Static date"}),"data-test-subj":"lnsXY_annotation_manual"},{id:"lens_xyChart_annotation_query",label:o.i18n.translate("eventAnnotationComponents.xyChart.annotation.query",{defaultMessage:"Custom query"}),"data-test-subj":"lnsXY_annotation_query"}],idSelected:`lens_xyChart_annotation_${null==e?void 0:e.type}`,onChange:t=>{const i=t.replace("lens_xyChart_annotation_","");if((null==e?void 0:e.type)!==i){if("query"===i){var l,o;const t=Object(C.g)(e)?{label:e.label===A?w:e.label,color:F(e.color)}:{};return I({type:i,timeField:null!==(l=n.timeFieldName||(null===(o=n.fields.filter(a.a).find((({type:e})=>"date"===e)))||void 0===o?void 0:o.displayName))&&void 0!==l?l:"",key:{type:"point_in_time"},...t})}return I({type:i,key:{type:"point_in_time",timestamp:j()().toISOString()}})}},isFullWidth:!0})),N?Object(d.jsx)(z,{annotation:e,onChange:I,dataView:n,queryInputShouldOpen:D,queryInputServices:v,appName:O}):Object(d.jsx)(H,{annotation:e,onChange:I,getDefaultRangeEnd:g,calendarClassName:h})),Object(d.jsx)(r,{title:o.i18n.translate("eventAnnotationComponents.xyChart.appearance",{defaultMessage:"Appearance"})},Object(d.jsx)(u.a,{value:(null==e?void 0:e.label)||w,defaultValue:w,onChange:e=>{I({label:e})}}),!M&&Object(d.jsx)(l.a.Fragment,null,Object(d.jsx)(p.b,{currentIcon:e.icon,setIcon:e=>I({icon:e}),defaultIcon:"triangle",customIconSet:E.a}),Object(d.jsx)(c.a,{idPrefix:$,setConfig:I,currentConfig:e,isQueryBased:N},(t=>{if("field"!==t)return null;const i=n.fields.filter(a.a).filter((({displayName:e,type:t})=>e&&"document"!==t)).map((e=>({label:e.displayName,value:{type:"field",field:e.name,dataType:e.type},exists:k(n.id,e.name),compatible:!0,"data-test-subj":`lnsXY-annotation-fieldOption-${e.name}`}))),o=e.textField,r=!o||Boolean(n.getFieldByName(o));return Object(d.jsx)(l.a.Fragment,null,Object(d.jsx)(s.EuiSpacer,{size:"xs"}),Object(d.jsx)(m.a,{selectedOptions:o?[{label:o,value:{type:"field",field:o}}]:[],options:i,onChoose:function(e){e&&I({textField:e.field,textVisibility:!0})},fieldIsInvalid:!r,"data-test-subj":"lnsXY-annotation-query-based-text-decoration-field-picker",autoFocus:!o}))})),Object(d.jsx)(b.a,{idPrefix:$,setConfig:I,currentConfig:{lineStyle:e.lineStyle,lineWidth:e.lineWidth}})),M&&Object(d.jsx)(s.EuiFormRow,{label:o.i18n.translate("eventAnnotationComponents.xyChart.fillStyle",{defaultMessage:"Fill"}),display:"columnCompressed",fullWidth:!0},Object(d.jsx)(s.EuiButtonGroup,{legend:o.i18n.translate("eventAnnotationComponents.xyChart.fillStyle",{defaultMessage:"Fill"}),"data-test-subj":"lns-xyAnnotation-fillStyle",name:"fillStyle",buttonSize:"compressed",options:[{id:"lens_xyChart_fillStyle_inside",label:o.i18n.translate("eventAnnotationComponents.xyChart.fillStyle.inside",{defaultMessage:"Inside"}),"data-test-subj":"lnsXY_fillStyle_inside"},{id:"lens_xyChart_fillStyle_outside",label:o.i18n.translate("eventAnnotationComponents.xyChart.fillStyle.outside",{defaultMessage:"Outside"}),"data-test-subj":"lnsXY_fillStyle_inside"}],idSelected:"lens_xyChart_fillStyle_"+(Boolean(null==e?void 0:e.outside)?"outside":"inside"),onChange:e=>{I({outside:"lens_xyChart_fillStyle_outside"===e})},isFullWidth:!0})),Object(d.jsx)(f.a,{overwriteColor:e.color,isClearable:!1,defaultColor:M?S:_,showAlpha:M,setConfig:I,disableHelpTooltip:!0,label:o.i18n.translate("eventAnnotationComponents.xyChart.lineColor.label",{defaultMessage:"Color"})}),Object(d.jsx)(G,{label:o.i18n.translate("eventAnnotationComponents.xyChart.annotation.hide",{defaultMessage:"Hide annotation"}),"data-test-subj":"lns-annotations-hide-annotation",value:Boolean(e.isHidden),onChange:e=>I({isHidden:e.target.checked})})),N&&e&&Object(d.jsx)(r,{title:o.i18n.translate("eventAnnotationComponents.xyChart.tooltip",{defaultMessage:"Tooltip"})},Object(d.jsx)(s.EuiFormRow,{display:"rowCompressed",className:"lnsRowCompressedMargin",fullWidth:!0,label:o.i18n.translate("eventAnnotationComponents.xyChart.annotation.tooltip",{defaultMessage:"Show additional fields"})},Object(d.jsx)(B,{currentConfig:e,setConfig:I,dataView:n}))))}}}]);