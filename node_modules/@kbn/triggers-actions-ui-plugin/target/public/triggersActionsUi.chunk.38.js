/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[38],{148:function(e,t,n){"use strict";function r(e){return e}function a(e){throw new Error("Called `absurd` function which should be uncallable")}Object.defineProperty(t,"__esModule",{value:!0}),t.bindTo_=t.bind_=t.hole=t.pipe=t.untupled=t.tupled=t.absurd=t.decrement=t.increment=t.tuple=t.flow=t.flip=t.constVoid=t.constUndefined=t.constNull=t.constFalse=t.constTrue=t.constant=t.not=t.unsafeCoerce=t.identity=void 0,t.identity=r,t.unsafeCoerce=r,t.not=function(e){return function(t){return!e(t)}},t.constant=function(e){return function(){return e}},t.constTrue=function(){return!0},t.constFalse=function(){return!1},t.constNull=function(){return null},t.constUndefined=function(){},t.constVoid=function(){},t.flip=function(e){return function(t,n){return e(n,t)}},t.flow=function(e,t,n,r,a,u,i,s,o){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return r(n(t(e.apply(this,arguments))))};case 5:return function(){return a(r(n(t(e.apply(this,arguments)))))};case 6:return function(){return u(a(r(n(t(e.apply(this,arguments))))))};case 7:return function(){return i(u(a(r(n(t(e.apply(this,arguments)))))))};case 8:return function(){return s(i(u(a(r(n(t(e.apply(this,arguments))))))))};case 9:return function(){return o(s(i(u(a(r(n(t(e.apply(this,arguments)))))))))}}},t.tuple=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e},t.increment=function(e){return e+1},t.decrement=function(e){return e-1},t.absurd=a,t.tupled=function(e){return function(t){return e.apply(void 0,t)}},t.untupled=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e(t)}},t.pipe=function(e,t,n,r,a,u,i,s,o,c,l,d,f,p,g,y,h,b,v,w){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return a(r(n(t(e))));case 6:return u(a(r(n(t(e)))));case 7:return i(u(a(r(n(t(e))))));case 8:return s(i(u(a(r(n(t(e)))))));case 9:return o(s(i(u(a(r(n(t(e))))))));case 10:return c(o(s(i(u(a(r(n(t(e)))))))));case 11:return l(c(o(s(i(u(a(r(n(t(e))))))))));case 12:return d(l(c(o(s(i(u(a(r(n(t(e)))))))))));case 13:return f(d(l(c(o(s(i(u(a(r(n(t(e))))))))))));case 14:return p(f(d(l(c(o(s(i(u(a(r(n(t(e)))))))))))));case 15:return g(p(f(d(l(c(o(s(i(u(a(r(n(t(e))))))))))))));case 16:return y(g(p(f(d(l(c(o(s(i(u(a(r(n(t(e)))))))))))))));case 17:return h(y(g(p(f(d(l(c(o(s(i(u(a(r(n(t(e))))))))))))))));case 18:return b(h(y(g(p(f(d(l(c(o(s(i(u(a(r(n(t(e)))))))))))))))));case 19:return v(b(h(y(g(p(f(d(l(c(o(s(i(u(a(r(n(t(e))))))))))))))))));case 20:return w(v(b(h(y(g(p(f(d(l(c(o(s(i(u(a(r(n(t(e)))))))))))))))))))}},t.hole=a,t.bind_=function(e,t,n){var r;return Object.assign({},e,((r={})[t]=n,r))},t.bindTo_=function(e){return function(t){var n;return(n={})[e]=t,n}}},155:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=[]},215:function(e,t,n){"use strict";n.r(t),n.d(t,"AlertsSearchBar",(function(){return y})),n.d(t,"default",(function(){return y}));var r=n(1),a=n(21),u=n(10),i=n(155),s=n(2);const o=s.i18n.translate("xpack.triggersActionsUI.alertsSearchBar.placeholder",{defaultMessage:"Search alerts (e.g. kibana.alert.evaluation.threshold > 75)"});var c=n(5),l=n(138);const d=[];var f=n(54),p=n(0);const g={type:"alerts",fields:{}};function y({appName:e,disableQueryLanguageSwitcher:t=!1,featureIds:n,ruleTypeId:y,query:h,filters:b,onQueryChange:v,onQuerySubmit:w,onFiltersUpdated:j,rangeFrom:O,rangeTo:I,showFilterBar:m=!1,showDatePicker:S=!0,showSubmitButton:q=!0,placeholder:F=o,submitOnBlur:_=!1}){var A;const{unifiedSearch:{ui:{SearchBar:T}}}=Object(a.useKibana)().services,[M,R]=Object(r.useState)("kuery"),{dataviews:k,loading:E}=function(e){const{http:t,data:n,notifications:{toasts:i}}=Object(a.useKibana)().services,[o,d]=Object(r.useState)(void 0),f=e.sort().join(","),p=1===e.length&&e.includes(u.ob.SIEM),g=e.length>1&&e.includes(u.ob.SIEM),y=e.length>0&&!p&&!g,h=()=>{i.addDanger(s.i18n.translate("xpack.triggersActionsUI.useAlertDataView.useAlertDataMessage",{defaultMessage:"Unable to load alert data view"}))},{data:b,isSuccess:v,isInitialLoading:w,isLoading:j}=Object(c.useQuery)({queryKey:["loadAlertIndexNames",f],queryFn:()=>async function({http:e,features:t}){const{index_name:n=[]}=await e.get(`${l.a}/index`,{query:{features:t}});return n}({http:t,features:f}),onError:h,refetchOnWindowFocus:!1,enabled:e.length>0&&!g}),{data:O,isSuccess:I,isInitialLoading:m,isLoading:S}=Object(c.useQuery)({queryKey:["loadAlertFields",f],queryFn:()=>async function({http:e,featureIds:t}){const{fields:n=[]}=await e.get(`${l.a}/browser_fields`,{query:{featureIds:t}});return n}({http:t,featureIds:e}),onError:h,refetchOnWindowFocus:!1,enabled:y});return Object(r.useEffect)((()=>()=>{null==o||o.map((e=>{n.dataViews.clearInstanceCache(e.id)}))}),[o]),Object(r.useEffect)((()=>{p&&v&&async function(){const e=await n.dataViews.create({title:(null!=b?b:[]).join(","),allowNoIndex:!0});d([e])}()}),[n.dataViews,b,v,p]),Object(r.useEffect)((()=>{var e;b&&O&&!p&&I&&v&&d([{title:(null!=b?b:[]).join(","),fieldFormatMap:{},fields:null===(e=null!=O?O:[])||void 0===e?void 0:e.map((e=>({...e,...e.esTypes&&e.esTypes.includes("flattened")?{type:"string"}:{}})))}])}),[O,n.dataViews,b,v,p,I]),Object(r.useMemo)((()=>({dataviews:o,loading:0!==e.length&&!g&&(p?w||j:w||j||m||S)})),[o,e.length,g,p,w,j,m,S])}(null!=n?n:[]),{aadFields:Q,loading:U}=function(e){const{http:t,notifications:{toasts:n}}=Object(a.useKibana)().services,{data:u=d,isInitialLoading:i,isLoading:o}=Object(c.useQuery)({queryKey:["loadAlertAadFieldsPerRuleType",e],queryFn:()=>async function({http:e,ruleTypeId:t}){return t?await e.get(`${l.a}/aad_fields`,{query:{ruleTypeId:t}}):d}({http:t,ruleTypeId:e}),onError:()=>{n.addDanger(s.i18n.translate("xpack.triggersActionsUI.useRuleAADFields.errorMessage",{defaultMessage:"Unable to load alert fields per rule type"}))},refetchOnWindowFocus:!1,enabled:void 0!==e});return Object(r.useMemo)((()=>({aadFields:u,loading:void 0!==e&&(i||o)})),[u,i,o,e])}(y),x=y&&null!=Q&&Q.length?[{title:y,fields:Q}]:k,B=Object(f.a)({filteredRuleTypes:void 0!==y?[y]:[],enabled:void 0!==y}),C=n&&1===n.length&&n.includes(u.ob.SIEM)||B&&y&&(null===(A=B.ruleTypesState.data.get(y))||void 0===A?void 0:A.producer)===u.ob.SIEM,L=Object(r.useCallback)((({dateRange:e,query:t})=>{var n;w({dateRange:e,query:"string"==typeof(null==t?void 0:t.query)?t.query:void 0}),R(null!==(n=null==t?void 0:t.language)&&void 0!==n?n:"kuery")}),[w,R]),V=Object(r.useCallback)((({dateRange:e,query:t})=>{var n;null==v||v({dateRange:e,query:"string"==typeof(null==t?void 0:t.query)?t.query:void 0}),R(null!==(n=null==t?void 0:t.language)&&void 0!==n?n:"kuery")}),[v,R]);return Object(p.jsx)(T,{appName:e,disableQueryLanguageSwitcher:t,indexPatterns:E||U?i.a:x,placeholder:F,query:{query:null!=h?h:"",language:M},filters:b,dateRangeFrom:O,dateRangeTo:I,displayStyle:"inPage",showFilterBar:m,onQuerySubmit:L,onFiltersUpdated:j,onRefresh:({dateRange:e})=>{w({dateRange:e})},showDatePicker:S,showQueryInput:!0,saveQueryMenuVisibility:"allowed_by_app_privilege",showSubmitButton:q,submitOnBlur:_,onQueryChange:V,suggestionsAbstraction:C?void 0:g})}}}]);