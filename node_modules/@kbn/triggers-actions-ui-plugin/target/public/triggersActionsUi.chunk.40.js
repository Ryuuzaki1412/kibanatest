/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[40],{129:function(e,t,s){"use strict";s.d(t,"a",(function(){return u}));var n=s(2),a=s(1),o=s.n(a),i=s(3),l=s(0);const r=n.i18n.translate("xpack.triggersActionsUI.components.toastWithCircuitBreaker.seeFullError",{defaultMessage:"See full error"}),c=n.i18n.translate("xpack.triggersActionsUI.components.toastWithCircuitBreaker.hideFullError",{defaultMessage:"Hide full error"}),u=({children:e})=>{const[t,s]=Object(a.useState)(!1),n=Object(a.useCallback)((()=>{s((e=>!e))}),[]);return Object(l.jsx)(o.a.Fragment,null,t&&Object(l.jsx)(o.a.Fragment,null,Object(l.jsx)(i.EuiText,{size:"s"},e),Object(l.jsx)(i.EuiSpacer,null)),Object(l.jsx)(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(l.jsx)(i.EuiFlexItem,{grow:!1},Object(l.jsx)(i.EuiButton,{size:"s",color:"danger",onClick:n},t?c:r))))}},98:function(e,t,s){"use strict";s.r(t),s.d(t,"RuleStatusDropdown",(function(){return p})),s.d(t,"futureTimeToInterval",(function(){return S})),s.d(t,"default",(function(){return p}));var n=s(1),a=s.n(n),o=s(32),i=s.n(o),l=s(2),r=s(21),c=s(12),u=s(3),d=s(30),b=s(133),j=s(17),g=s(129),x=s(0);const O="LL @ LT",p=({rule:e,onRuleChanged:t,disableRule:s,enableRule:a,snoozeRule:o,unsnoozeRule:l,isEditable:b,hideSnoozeOption:p=!1,direction:S="column"})=>{const[w,C]=Object(n.useState)(e.enabled),[y,I]=Object(n.useState)(!p&&Object(j.d)(e)),{notifications:{toasts:R}}=Object(d.b)().services;Object(n.useEffect)((()=>{C(e.enabled)}),[e.enabled]),Object(n.useEffect)((()=>{p||I(Object(j.d)(e))}),[e,p]);const[v,M]=Object(n.useState)(!1),[T,A]=Object(n.useState)(!1),D=Object(n.useCallback)((()=>A((e=>!e))),[A]),L=Object(n.useCallback)((()=>A(!1)),[A]),U=Object(n.useCallback)((async()=>{const{errors:e}=await a();if(!e.length)return;const t=Object(c.parseRuleCircuitBreakerErrorMessage)(e[0].message);throw R.addDanger({title:t.summary,...t.details&&{text:Object(r.toMountPoint)(Object(x.jsx)(g.a,null,t.details))}}),new Error}),[a,R]),F=Object(n.useCallback)((async n=>{if(e.enabled!==n){M(!0);try{n?await U():await s(),C(!w),t()}finally{M(!1)}}}),[e.enabled,w,t,U,s]),P=Object(n.useCallback)((async e=>{try{await o(e),t()}finally{L()}}),[o,t,L]),B=Object(n.useCallback)((async e=>{try{await l(e),t()}finally{L()}}),[l,t,L]),_=w?y?"warning":"primary":"default",G=w?y?h:f:m,N=w&&y?Object(x.jsx)(u.EuiToolTip,{content:e.muteAll?k:i()(new Date(e.isSnoozedUntil)).format(O)},Object(x.jsx)(u.EuiText,{color:"subdued",size:"xs"},e.muteAll?k:i()(new Date(e.isSnoozedUntil)).fromNow(!0))):null,W=Object(x.jsx)(u.EuiBadge,{color:_,"data-test-subj":"statusDropdownReadonly"},G),$=Object(x.jsx)(u.EuiBadge,{color:_,iconSide:"right",iconType:!v&&b?"arrowDown":void 0,onClick:D,iconOnClick:D,onClickAriaLabel:E,iconOnClickAriaLabel:E,isDisabled:v},G,v&&Object(x.jsx)(u.EuiLoadingSpinner,{style:{marginLeft:"4px",marginRight:"4px"},size:"s"}));return Object(x.jsx)(u.EuiFlexGroup,{direction:S,alignItems:"row"===S?"center":"flexStart",justifyContent:"flexStart",gutterSize:"row"===S?"s":"xs",responsive:!1},Object(x.jsx)(u.EuiFlexItem,{grow:!1},b?Object(x.jsx)(u.EuiPopover,{button:$,isOpen:T&&b,closePopover:L,panelPaddingSize:"s","data-test-subj":"statusDropdown",title:G},Object(x.jsx)(z,{onClosePopover:L,onChangeEnabledStatus:F,isEnabled:w,isSnoozed:y,snoozeEndTime:e.isSnoozedUntil,hideSnoozeOption:p,snoozeRule:P,unsnoozeRule:B,scheduledSnoozes:e.snoozeSchedule,activeSnoozes:e.activeSnoozes})):W),Object(x.jsx)(u.EuiFlexItem,{"data-test-subj":"remainingSnoozeTime",grow:!1},N))},z=({onChangeEnabledStatus:e,onClosePopover:t,isEnabled:s,isSnoozed:o,snoozeEndTime:l,hideSnoozeOption:r=!1,snoozeRule:c,unsnoozeRule:d,scheduledSnoozes:j=[],activeSnoozes:g=[]})=>{const p=Object(n.useCallback)((()=>{o?d():e(!0),t()}),[e,t,d,o]),z=Object(n.useCallback)((()=>{e(!1),t()}),[e,t]);let h=Object(x.jsx)(u.EuiText,{size:"s"},w);o&&l&&(h=Object(x.jsx)(a.a.Fragment,null,Object(x.jsx)(u.EuiText,{size:"s"},w)," ",Object(x.jsx)(u.EuiText,{size:"xs",color:"subdued"},i()(l).format(O))));const E=[{id:0,width:360,items:[{name:f,icon:s&&!o?"check":"empty",onClick:p,"data-test-subj":"statusDropdownEnabledItem"},{name:m,icon:s?"empty":"check",onClick:z,"data-test-subj":"statusDropdownDisabledItem"},...r?[]:[{name:h,icon:s&&o?"check":"empty",panel:1,disabled:!s,"data-test-subj":"statusDropdownSnoozeItem"}]]},...r?[]:[{id:1,width:400,title:w,content:Object(x.jsx)(u.EuiPanel,{paddingSize:"none",hasShadow:!1},Object(x.jsx)(b.a,{interval:S(l),showCancel:o,snoozeRule:c,unsnoozeRule:d,scheduledSnoozes:j,activeSnoozes:g,hasTitle:!1}))}]];return Object(x.jsx)(u.EuiContextMenu,{"data-test-subj":"ruleStatusMenu",initialPanelId:0,panels:E})},S=e=>{if(!e)return;const t=i()(e).locale("en").fromNow(!0),[s,n]=t.split(" ");let a,o="a"===s||"an"===s?1:parseInt(s,10);switch(n){case"year":case"years":a="M",o*=12;break;case"month":case"months":a="M";break;case"day":case"days":a="d";break;case"hour":case"hours":a="h";break;case"minute":case"minutes":a="m"}return a?`${o}${a}`:void 0},f=l.i18n.translate("xpack.triggersActionsUI.sections.rulesList.enabledRuleStatus",{defaultMessage:"Enabled"}),m=l.i18n.translate("xpack.triggersActionsUI.sections.rulesList.disabledRuleStatus",{defaultMessage:"Disabled"}),h=l.i18n.translate("xpack.triggersActionsUI.sections.rulesList.snoozedRuleStatus",{defaultMessage:"Snoozed"}),w=l.i18n.translate("xpack.triggersActionsUI.sections.rulesList.snoozeMenuTitle",{defaultMessage:"Snooze"}),E=l.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusDropdownMenuLabel",{defaultMessage:"Change rule status or snooze"}),k=l.i18n.translate("xpack.triggersActionsUI.sections.rulesList.remainingSnoozeIndefinite",{defaultMessage:"Indefinitely"})}}]);