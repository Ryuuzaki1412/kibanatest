/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[13,40,60,61,62],{100:function(e,t,s){"use strict";s.r(t),s.d(t,"RuleTagBadge",(function(){return c})),s.d(t,"default",(function(){return c}));var a=s(1),l=s(2),i=s(3),n=s(0);const o=l.i18n.translate("xpack.triggersActionsUI.sections.rules_list.rules_tag_badge.tagTitle",{defaultMessage:"Tag"}),r={width:"300px"},u=e=>`ruleTagBadgeItem-${e}`,c=e=>{const{tagsOutPopover:t=!1,tags:s=[],badgeDataTestSubj:l="ruleTagBadge",titleDataTestSubj:c="ruleTagPopoverTitle",tagItemDataTestSubj:d=u}=e,{isOpen:b,onClose:j,onClick:p}=e,g=Object(a.useMemo)((()=>Object(n.jsx)(i.EuiBadge,{"data-test-subj":l,color:"hollow",iconType:"tag",iconSide:"left",tabIndex:-1,onClick:p,onClickAriaLabel:"Tags",iconOnClick:p,iconOnClickAriaLabel:"Tags"},s.length)),[l,p,s.length]),m=Object(a.useMemo)((()=>s.map(((e,t)=>Object(n.jsx)(i.EuiBadge,{"data-test-subj":d(e),key:t,color:"hollow",iconType:"tag",iconSide:"left"},e)))),[s,d]);return t?Object(n.jsx)(i.EuiFlexGroup,{"data-test-subj":"tagsOutPopover",style:{marginLeft:0},wrap:!0},m):Object(n.jsx)(i.EuiPopover,{button:g,anchorPosition:"upCenter",isOpen:b,closePopover:j},Object(n.jsx)(i.EuiPopoverTitle,{"data-test-subj":c},o),Object(n.jsx)("div",{style:r},m))}},102:function(e,t,s){"use strict";s.r(t),s.d(t,"RuleTagFilter",(function(){return f})),s.d(t,"default",(function(){return f}));var a=s(1),l=s.n(a),i=s(2),n=s(26),o=s(3),r=s(5),u=s(67),c=s(30);const d=[];var b=s(0);const j=e=>`ruleTagFilterOption-${e}`,p=i.i18n.translate("xpack.triggersActionsUI.sections.ruleTagFilter.loading",{defaultMessage:"Loading tags"}),g=[],m=Object(a.memo)((({label:e,setObserver:t,canSetObserver:s})=>{const l=Object(a.useCallback)((e=>{s&&e&&t(e)}),[s,t]);return Object(b.jsx)("div",{ref:l},e)})),O=Object(a.memo)((({selectedTags:e,onClosePopover:t,buttonDataTestSubj:s})=>Object(b.jsx)(o.EuiFilterButton,{"data-test-subj":s,iconType:"arrowDown",hasActiveFilters:e.length>0,numActiveFilters:e.length,numFilters:e.length,onClick:t},Object(b.jsx)(n.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.ruleTagFilterButton",defaultMessage:"Tags"})))),x=Object(a.memo)((({options:e,renderOption:t,onChange:s,onSearchTextChange:a,isLoading:i,loadingMessage:n,noMatchesMessage:r,emptyMessage:u,errorMessage:c,selectableDataTestSubj:d})=>Object(b.jsx)(o.EuiSelectable,{searchable:!0,searchProps:{onChange:a},listProps:{activeOptionIndex:void 0},"data-test-subj":d,options:e,noMatchesMessage:i?n:r,emptyMessage:i?n:u,errorMessage:c,renderOption:t,onChange:s},((e,t)=>Object(b.jsx)(l.a.Fragment,null,t,Object(b.jsx)(o.EuiSpacer,{size:"xs"}),e))))),f=Object(a.memo)((e=>{const{selectedTags:t=g,isGrouped:s=!1,canLoadRules:n=!0,refresh:f,loadingMessage:h=p,noMatchesMessage:y,emptyMessage:S,errorMessage:E,dataTestSubj:T="ruleTagFilter",selectableDataTestSubj:v="ruleTagFilterSelectable",optionDataTestSubj:k=j,buttonDataTestSubj:I="ruleTagFilterButton",onChange:C=(()=>{})}=e,F=Object(a.useRef)(),[R,L]=Object(a.useState)(""),[A,M]=Object(a.useState)(!1),{tags:w=g,isLoading:z,hasNextPage:P,fetchNextPage:U}=function(e){const{enabled:t,refresh:s,search:l,perPage:n,page:o=1}=e,{http:b,notifications:{toasts:j}}=Object(c.b)().services,{refetch:p,data:g,fetchNextPage:m,isLoading:O,isFetching:x,hasNextPage:f,isFetchingNextPage:h}=Object(r.useInfiniteQuery)({queryKey:["loadRuleTags",l,n,o,{refresh:null==s?void 0:s.toISOString()}],queryFn:({pageParam:e})=>e?Object(u.b)({http:b,perPage:e.perPage,page:e.page,search:l}):Object(u.b)({http:b,perPage:n,page:o,search:l}),onError:()=>{j.addDanger(i.i18n.translate("xpack.triggersActionsUI.sections.rulesList.unableToLoadRuleTags",{defaultMessage:"Unable to load rule tags"}))},enabled:t,getNextPageParam:e=>{if(Math.max(1,Math.ceil(e.total/e.perPage))!==e.page)return{...e,page:e.page+1}},refetchOnWindowFocus:!1});return{tags:Object(a.useMemo)((()=>(null==g?void 0:g.pages.reduce(((e,t)=>e.concat(t.data)),[]))||d),[g]),hasNextPage:f,refetch:p,isLoading:O||x||h,fetchNextPage:m}}({enabled:n,refresh:f,search:R}),_=Object(a.useCallback)((async()=>{var e;P&&!z&&(await U(),null===(e=F.current)||void 0===e||e.disconnect())}),[U,P,z]);Object(a.useEffect)((()=>()=>{var e;return null===(e=F.current)||void 0===e?void 0:e.disconnect()}),[]);const D=Object(a.useMemo)((()=>[...new Set(t.sort().concat(w))]),[t,w]),B=Object(a.useCallback)((e=>{var t,s;null===(t=F.current)||void 0===t||t.disconnect(),F.current=new IntersectionObserver(_,{root:null,threshold:1}),null===(s=F.current)||void 0===s||s.observe(e)}),[_]),N=Object(a.useMemo)((()=>D.map((e=>({label:e,checked:t.includes(e)?"on":void 0,"data-test-subj":k(e)})))),[D,t,k]),G=Object(a.useCallback)((e=>Object(b.jsx)(m,{label:e.label,setObserver:B,canSetObserver:e.label===D[D.length-1]})),[B,D]),$=Object(a.useCallback)((e=>{const t=e.reduce(((e,t)=>("on"===t.checked&&(e=[...e,t.label]),e)),[]);C(t)}),[C]),q=Object(a.useCallback)((e=>{L(e)}),[L]),K=Object(a.useCallback)((()=>{M((e=>!e))}),[M]),H=Object(a.useMemo)((()=>s?l.a.Fragment:o.EuiFilterGroup),[s]);return Object(b.jsx)(H,s?{}:{"data-test-subj":"ruleTagFilterUngrouped"},Object(b.jsx)(o.EuiPopover,{"data-test-subj":T,isOpen:A,closePopover:K,button:Object(b.jsx)(O,{selectedTags:t,onClosePopover:K,buttonDataTestSubj:I})},Object(b.jsx)(x,{isLoading:z,options:N,renderOption:G,onChange:$,onSearchTextChange:q,loadingMessage:h,noMatchesMessage:y,emptyMessage:S,errorMessage:E,selectableDataTestSubj:v})))}))},106:function(e,t,s){"use strict";s.r(t),s.d(t,"percentileFields",(function(){return gt})),s.d(t,"RulesList",(function(){return xt})),s.d(t,"default",(function(){return xt}));var a=s(2),l=s(11),i=s(26),n=s(21),o=s(12),r=s(1),u=s.n(r),c=s(3),d=s(89),b=s(10),j=s(24),p=s(19),g=s(36),m=s.n(g),O=s(119),x=s(6),f=s(0);const h=e=>{const{children:t,numberOfSelectedRules:s=0,canModifySelectedRules:a}=e,[l]=Object(n.useUiSetting$)(x.d),[i,o]=Object(r.useState)(!1),d=Object(r.useMemo)((()=>m()(s).format(l)),[s,l]);return Object(f.jsx)(c.EuiPopover,{isOpen:i,closePopover:()=>o(!1),"data-test-subj":"bulkAction",panelPaddingSize:"s",button:Object(f.jsx)(c.EuiButtonEmpty,{size:"xs",iconSide:"right",iconType:a?"arrowDown":void 0,disabled:!a,"aria-label":O.v,"data-test-subj":"showBulkActionButton",onClick:()=>o(!i)},Object(O.s)(d,s))},t&&u.a.Children.map(t,(e=>u.a.isValidElement(e)?Object(f.jsx)(u.a.Fragment,null,u.a.cloneElement(e,{})):e)))};var y=s(120),S=(s(276),s(30));const E=Object(y.a)((({selectedItems:e,isAllSelected:t=!1,getFilter:s,onPerformingAction:l=T,onActionPerformed:n=T,bulkEditAction:o,isEnablingRules:d=!1,isDisablingRules:b=!1,isBulkEditing:j=!1,updateRulesToBulkEdit:p,onEnable:g,onDisable:m})=>{const{notifications:{toasts:O}}=Object(S.b)().services,x=d||b||j,h=Object(r.useMemo)((()=>!t&&!!e.find((e=>!e.enabledInLicense))),[e,t]);return Object(f.jsx)(c.EuiFlexGroup,{alignItems:"baseline",direction:"column",gutterSize:"none","data-test-subj":"ruleQuickEditButton"},!t&&Object(f.jsx)(u.a.Fragment,null,Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiButtonEmpty,{onClick:async function(){l();try{p(t?{action:"snooze",filter:s()}:{action:"snooze",rules:e})}catch(e){O.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToSnoozeRules",{defaultMessage:"Failed to snooze or unsnooze rules"})})}finally{n()}},isLoading:j&&"snooze"===o,isDisabled:x||h,"data-test-subj":"bulkSnooze"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.snoozeAllTitle",defaultMessage:"Snooze now"}))),Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiButtonEmpty,{onClick:async function(){l();try{p(t?{action:"unsnooze",filter:s()}:{action:"unsnooze",rules:e})}catch(e){O.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToSnoozeRules",{defaultMessage:"Failed to snooze or unsnooze rules"})})}finally{n()}},isLoading:j&&"unsnooze"===o,isDisabled:x||h,"data-test-subj":"bulkUnsnooze"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.unsnoozeAllTitle",defaultMessage:"Unsnooze now"}))),Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiButtonEmpty,{onClick:async function(){l();try{p(t?{action:"schedule",filter:s()}:{action:"schedule",rules:e})}catch(e){O.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToSnoozeRules",{defaultMessage:"Failed to snooze or unsnooze rules"})})}finally{n()}},isLoading:j&&"schedule"===o,isDisabled:x||h,"data-test-subj":"bulkSnoozeSchedule"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.snoozeScheduleAllTitle",defaultMessage:"Schedule snooze"}))),Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiButtonEmpty,{onClick:async function(){l();try{p(t?{action:"unschedule",filter:s()}:{action:"unschedule",rules:e})}catch(e){O.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToSnoozeRules",{defaultMessage:"Failed to snooze or unsnooze rules"})})}finally{n()}},isLoading:j&&"unschedule"===o,isDisabled:x||h,"data-test-subj":"bulkRemoveSnoozeSchedule"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.removeSnoozeScheduleAllTitle",defaultMessage:"Unschedule snooze"})))),Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiButtonEmpty,{onClick:g,isLoading:d,isDisabled:x||h,"data-test-subj":"bulkEnable"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.enableAllTitle",defaultMessage:"Enable"}))),Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiButtonEmpty,{onClick:m,isLoading:b,isDisabled:x||h,"data-test-subj":"bulkDisable"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.disableAllTitle",defaultMessage:"Disable"}))),Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiButtonEmpty,{onClick:async function(){l();try{p(t?{action:"updateApiKey",filter:s()}:{action:"updateApiKey",rules:e})}catch(e){O.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToUpdateRuleAPIKeysMessage",{defaultMessage:"Failed to update API keys for rules"})})}finally{n()}},isLoading:j&&"updateApiKey"===o,isDisabled:x,"data-test-subj":"updateAPIKeys"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.updateRuleAPIKeysTitle",defaultMessage:"Update API keys"}))),Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiButtonEmpty,{onClick:async function(){l();try{p(t?{action:"delete",filter:s()}:{action:"delete",rules:e})}catch(e){O.addDanger({title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.failedToDeleteRulesMessage",{defaultMessage:"Failed to delete rules"})})}finally{n()}},isLoading:j&&"delete"===o,iconType:"trash",color:"danger",isDisabled:x||h,"data-test-subj":"bulkDelete",className:"actBulkActionPopover__deleteAll"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkActionPopover.deleteAllTitle",defaultMessage:"Delete"}))))}));function T(){}var v=s(94),k=s(32),I=s.n(k),C=s(17),F=(s(281),s(133)),R=s(91);const L=Object(y.a)((({item:e,onLoading:t,onRuleChanged:s,bulkDisableRules:l,bulkEnableRules:i,onDeleteRule:n,onEditRule:o,onUpdateAPIKey:u,snoozeRule:d,unsnoozeRule:j,onRunRule:p,onCloneRule:g})=>{var m,O;const{ruleTypeRegistry:x,notifications:{toasts:h}}=Object(S.b)().services,[y,E]=Object(r.useState)(!1),[T,k]=Object(r.useState)(!e.enabled);Object(r.useEffect)((()=>{k(!e.enabled)}),[e.enabled]);const L=Object(r.useCallback)((()=>{E(!1)}),[E]),A=Object(r.useCallback)((async a=>{try{t(!0),await d(e,a),await s(),h.addSuccess(R.SNOOZE_SUCCESS_MESSAGE)}catch(e){h.addDanger(R.SNOOZE_FAILED_MESSAGE)}finally{t(!1),L()}await d(e,a)}),[t,d,e,s,h,L]),M=Object(r.useCallback)((async a=>{try{t(!0),await j(e,a),await s(),h.addSuccess(R.UNSNOOZE_SUCCESS_MESSAGE)}catch(e){h.addDanger(R.SNOOZE_FAILED_MESSAGE)}finally{t(!1),L()}}),[t,j,e,s,h,L]),w=!!x.has(e.ruleTypeId)&&!x.get(e.ruleTypeId).requiresAppContext,z=Object(f.jsx)(c.EuiButtonIcon,{disabled:!e.isEditable,"data-test-subj":"selectActionButton","data-testid":"selectActionButton",iconType:"boxesHorizontal",onClick:()=>E(!y),"aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.popoverButtonTitle",{defaultMessage:"Actions"})}),P=Object(r.useMemo)((()=>Object(C.d)(e)),[e]),U=Object(r.useMemo)((()=>e.muteAll?a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActions.snoozedIndefinitely",{defaultMessage:"Snoozed indefinitely"}):P?a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActions.snoozedUntil",{defaultMessage:"Snoozed until {snoozeTime}",values:{snoozeTime:I()(e.isSnoozedUntil).format("MMM D")}}):a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActions.snooze",{defaultMessage:"Snooze"})),[P,e]),_=[{id:0,hasFocus:!1,items:[...Object(r.useMemo)((()=>T||e.consumer===b.ob.SIEM?[]:[{disabled:!e.isEditable||!e.enabledInLicense,"data-test-subj":"snoozeButton",icon:"bellSlash",name:U,panel:1}]),[T,e,U]),{isSeparator:!0},{disabled:!e.isEditable||!e.enabledInLicense,"data-test-subj":"disableButton",onClick:async()=>{const t=!T;v.asyncScheduler.schedule((async()=>{t?await l({ids:[e.id]}):await i({ids:[e.id]}),s()}),10),k(!T),E(!y)},name:T?a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.enableTitle",{defaultMessage:"Enable"}):a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.disableTitle",{defaultMessage:"Disable"})},{disabled:!e.isEditable||e.consumer===b.ob.SIEM,"data-test-subj":"cloneRule",onClick:async()=>{E(!y),g(e.id)},name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.cloneRuleTitle",{defaultMessage:"Clone rule"})},{disabled:!e.isEditable||!w,"data-test-subj":"editRule",onClick:()=>{E(!y),o(e)},name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.editTitle",{defaultMessage:"Edit rule"})},{disabled:!e.isEditable,"data-test-subj":"updateApiKey",onClick:()=>{E(!y),u(e)},name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActions.updateApiKey",{defaultMessage:"Update API key"})},{disabled:!e.isEditable,"data-test-subj":"runRule",onClick:()=>{E(!y),p(e)},name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActions.runRule",{defaultMessage:"Run rule"})},{disabled:!e.isEditable,className:"collapsedItemActions__deleteButton","data-test-subj":"deleteRule",onClick:()=>{E(!y),n(e)},name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.deleteRuleTitle",{defaultMessage:"Delete rule"})}]},{id:1,title:Object(f.jsx)(c.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiIcon,{type:"bellSlash"})),Object(f.jsx)(c.EuiFlexItem,{grow:!1},a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.collapsedItemActons.snoozeActions",{defaultMessage:"Snooze notifications"}))),width:500,content:Object(f.jsx)(c.EuiPanel,null,Object(f.jsx)(F.a,{interval:Object(F.b)(e.isSnoozedUntil),hasTitle:!1,scheduledSnoozes:null!==(m=e.snoozeSchedule)&&void 0!==m?m:[],activeSnoozes:null!==(O=e.activeSnoozes)&&void 0!==O?O:[],showCancel:Object(C.d)(e),snoozeRule:A,unsnoozeRule:M}))}];return Object(f.jsx)(c.EuiPopover,{button:z,isOpen:y,closePopover:()=>E(!1),ownFocus:!0,panelPaddingSize:"none","data-test-subj":"collapsedItemActions"},Object(f.jsx)(c.EuiContextMenu,{initialPanelId:0,panels:_,className:"actCollapsedItemActions","data-test-subj":"collapsedActionPanel","data-testid":"collapsedActionPanel"}))}));var A=s(33);const M=e=>{const{rulesStatuses:t,rulesLastRunOutcomes:s}=e;return Object(A.a)("ruleUseExecutionStatus")?Object(f.jsx)(c.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiHealth,{color:"success","data-test-subj":"totalActiveRulesCount"},Object(O.m)(t.active))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiHealth,{color:"danger","data-test-subj":"totalErrorRulesCount"},Object(O.n)(t.error))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiHealth,{color:"warning","data-test-subj":"totalWarningRulesCount"},Object(O.r)(t.warning))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiHealth,{color:"primary","data-test-subj":"totalOkRulesCount"},Object(O.o)(t.ok))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiHealth,{color:"accent","data-test-subj":"totalPendingRulesCount"},Object(O.p)(t.pending))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiHealth,{color:"subdued","data-test-subj":"totalUnknownRulesCount"},Object(O.q)(t.unknown)))):Object(f.jsx)(c.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiHealth,{color:"success","data-test-subj":"totalSucceededRulesCount"},Object(O.j)(s.succeeded))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiHealth,{color:"danger","data-test-subj":"totalFailedRulesCount"},Object(O.h)(s.failed))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiHealth,{color:"warning","data-test-subj":"totalWarningRulesCount"},Object(O.l)(s.warning))))},w={marginLeft:"auto"},z=e=>I()(e).isValid()?a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListAutoRefresh.lastUpdateText",{defaultMessage:"Updated {lastUpdateText}",values:{lastUpdateText:I()(e).locale(a.i18n.getLocale()).fromNow()}}):"",P=3e5,U=e=>{const{lastUpdate:t,initialUpdateInterval:s=P,onRefresh:a}=e,[l,i]=Object(r.useState)(!1),[n,o]=Object(r.useState)(Math.max(s,1e3)),[u,d]=Object(r.useState)(""),b=Object(r.useRef)((()=>{})),j=Object(r.useRef)(),p=Object(r.useRef)();Object(r.useEffect)((()=>{b.current=a}),[a]),Object(r.useEffect)((()=>{d(z(t));const e=()=>{j.current=window.setTimeout((()=>{d(z(t)),e()}),6e4)};return e(),()=>{j.current&&clearTimeout(j.current)}}),[t,d]),Object(r.useEffect)((()=>{if(l)return;const e=()=>{p.current=window.setTimeout((()=>{b.current(),e()}),n)};return e(),()=>{p.current&&clearTimeout(p.current)}}),[l,n]);const g=Object(r.useCallback)((({isPaused:e,refreshInterval:t})=>{i(e),o(t)}),[i,o]);return Object(f.jsx)(c.EuiFlexGroup,{"data-test-subj":"rulesListAutoRefresh",alignItems:"center"},Object(f.jsx)(c.EuiFlexItem,{grow:!1,style:w},Object(f.jsx)(c.EuiText,{"data-test-subj":"rulesListAutoRefresh-lastUpdateText",size:"s",color:"subdued"},u)),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiAutoRefreshButton,{isPaused:l,shortHand:!0,refreshInterval:n,onRefreshChange:g})))};var _=s(37);const D=[...o.RuleExecutionStatusValues].sort(),B=({selectedStatuses:e,onChange:t})=>{const{euiTheme:s}=Object(c.useEuiTheme)(),[a,l]=Object(r.useState)(e),[n,o]=Object(r.useState)(!1),u=Object(r.useCallback)((()=>{o((e=>!e))}),[o]),d=Object(r.useCallback)((()=>{o(!1)}),[o]);return Object(r.useEffect)((()=>{t&&t(a)}),[a]),Object(r.useEffect)((()=>{l(e)}),[e]),Object(f.jsx)(c.EuiPopover,{isOpen:n,closePopover:d,button:Object(f.jsx)(c.EuiFilterButton,{iconType:"arrowDown",hasActiveFilters:a.length>0,numActiveFilters:a.length,numFilters:a.length,onClick:u,"data-test-subj":"ruleExecutionStatusFilterButton"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.ruleExecutionStatusFilterLabel",defaultMessage:"Last response"}))},Object(f.jsx)("div",{className:"eui-yScroll",css:Object(f.css)({maxHeight:30*s.base},"","")},D.map((e=>{const t=Object(_.a)(e);return Object(f.jsx)(c.EuiFilterSelectItem,{key:e,style:{textTransform:"capitalize"},onClick:()=>{const t=a.includes(e);l(t?a.filter((t=>t!==e)):a.concat(e))},checked:a.includes(e)?"on":void 0,"data-test-subj":`ruleExecutionStatus${e}FilterOption`},Object(f.jsx)(c.EuiHealth,{color:t},O.L[e]))}))))},N=[...o.RuleLastRunOutcomeValues].sort(),G=({selectedOutcomes:e,onChange:t})=>{const{euiTheme:s}=Object(c.useEuiTheme)(),[a,l]=Object(r.useState)(!1),n=Object(r.useCallback)((()=>{l((e=>!e))}),[l]),o=Object(r.useCallback)((()=>{l(!1)}),[l]),u=Object(r.useCallback)((s=>()=>{e.includes(s)?null==t||t(e.filter((e=>e!==s))):null==t||t(e.concat(s))}),[t,e]);return Object(f.jsx)(c.EuiPopover,{isOpen:a,closePopover:o,button:Object(f.jsx)(c.EuiFilterButton,{iconType:"arrowDown",hasActiveFilters:e.length>0,numActiveFilters:e.length,numFilters:e.length,onClick:n,"data-test-subj":"ruleLastRunOutcomeFilterButton"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.ruleLastRunOutcomeFilterLabel",defaultMessage:"Last response"}))},Object(f.jsx)("div",{className:"eui-yScroll",css:Object(f.css)({maxHeight:30*s.base},"","")},N.map((t=>{const s=Object(_.b)(t);return Object(f.jsx)(c.EuiFilterSelectItem,{key:t,style:{textTransform:"capitalize"},onClick:u(t),checked:e.includes(t)?"on":void 0,"data-test-subj":`ruleLastRunOutcome${t}FilterOption`},Object(f.jsx)(c.EuiHealth,{color:s},O.K[t]))}))))},$=e=>{const{rulesLastRunOutcomes:t,setRuleExecutionStatusesFilter:s,setRuleLastRunOutcomesFilter:a}=e;return 0===t.failed?null:Object(f.jsx)(u.a.Fragment,null,Object(f.jsx)(c.EuiCallOut,{color:"danger",size:"s","data-test-subj":"rulesErrorBanner"},Object(f.jsx)("p",null,Object(f.jsx)(c.EuiIcon,{color:"danger",type:"warning"})," ",Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.attentionBannerTitle",defaultMessage:"Error found in {totalStatusesError, plural, one {# rule} other {# rules}}.",values:{totalStatusesError:t.failed}})," ",Object(f.jsx)(c.EuiLink,{color:"primary",onClick:()=>{Object(A.a)("ruleUseExecutionStatus")?s(["error"]):a(["failed"])}},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.viewBannerButtonLabel",defaultMessage:"Show {totalStatusesError, plural, one {rule} other {rules}} with error",values:{totalStatusesError:t.failed}})))),Object(f.jsx)(c.EuiSpacer,{size:"s"}))},q=({options:e,onChange:t,filters:s})=>{const{euiTheme:a}=Object(c.useEuiTheme)(),[l,n]=Object(r.useState)(!1);return Object(f.jsx)(c.EuiPopover,{isOpen:l,closePopover:()=>n(!1),button:Object(f.jsx)(c.EuiFilterButton,{iconType:"arrowDown",hasActiveFilters:s.length>0,numActiveFilters:s.length,numFilters:s.length,onClick:()=>n(!l),"data-test-subj":"ruleTypeFilterButton"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.typeFilterLabel",defaultMessage:"Type"}))},Object(f.jsx)("div",{className:"eui-yScroll",css:Object(f.css)({maxHeight:30*a.base},"","")},e.map(((e,a)=>Object(f.jsx)(r.Fragment,{key:`group${a}`},Object(f.jsx)(c.EuiTitle,{"data-test-subj":`ruleType${a}Group`,size:"xxs"},Object(f.jsx)("h3",null,e.groupName)),e.subOptions.map(((e,a)=>Object(f.jsx)(c.EuiFilterSelectItem,{key:a,onClick:()=>{const a=s.includes(e.value);t(a?s.filter((t=>t!==e.value)):s.concat(e.value))},checked:s.includes(e.value)?"on":void 0,"data-test-subj":`ruleType${e.value}FilterOption`},e.name))))))))},K=({actionTypes:e,onChange:t,filters:s})=>{const{euiTheme:a}=Object(c.useEuiTheme)(),[l,n]=Object(r.useState)(!1),o=Object(r.useCallback)((e=>()=>{const a=s.includes(e.id);t(a?s.filter((t=>t!==e.id)):s.concat(e.id))}),[s,t]);return Object(f.jsx)(c.EuiPopover,{isOpen:l,closePopover:()=>n(!1),button:Object(f.jsx)(c.EuiFilterButton,{iconType:"arrowDown",hasActiveFilters:s.length>0,numActiveFilters:s.length,numFilters:s.length,onClick:()=>n(!l),"data-test-subj":"actionTypeFilterButton"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.actionTypeFilterLabel",defaultMessage:"Action type"}))},Object(f.jsx)("div",{className:"eui-yScroll",css:Object(f.css)({maxHeight:30*a.base},"","")},e.map((e=>Object(f.jsx)(c.EuiFilterSelectItem,{key:e.id,onClick:o(e),checked:s.includes(e.id)?"on":void 0,"data-test-subj":`actionType${e.id}FilterOption`},e.name)))))};var H=s(102),Q=s(99),W=s(95),V=s(286),J=s.n(V),Z=s(155);const Y=["is","range","nested"],X=({astFilter:e,suggestionsAbstraction:t,hasNestedKey:s=!1,nestedKeys:a,storeValue:i,path:n="arguments",action:r=(()=>{})})=>{let u,c=i;void 0===c&&(c="function"===e.type&&Y.includes(e.function)),"function"===e.type&&"nested"===e.function&&(s=!0),e.arguments.forEach(((e,i)=>{if(0===i)if(s&&"literal"===e.type&&null!=e.value)u=e.value;else if("literal"===e.type&&e.value&&"string"==typeof e.value){const s="properties."+(t.fields[e.value]?t.fields[e.value].field:e.value).split(".").join(".properties."),a=Object(l.get)(o.alertMappings,s);null!=a&&"nested"===a.type&&(u=e.value)}if(e.arguments){const s=`${n}.${i}`;X({astFilter:e,suggestionsAbstraction:t,storeValue:"function"===e.type&&Y.includes(e.function),path:`${s}.arguments`,hasNestedKey:"function"===e.type&&"nested"===e.function,nestedKeys:u||a,action:r})}if(c){const t=null!=a?`${a}.${e.value}`:e.value;r({ast:e,index:i,fieldName:t})}}))},ee={type:"rules",fields:{"alert.tags":{field:"alert.tags",fieldToQuery:"alert.attributes.tags",displayField:"tags"},"alert.name.keyword":{field:"alert.name.keyword",fieldToQuery:"alert.attributes.name.keyword",displayField:"name"},"alert.actions.actionTypeId":{field:"alert.actions.actionTypeId",nestedPath:"alert.actions",nestedField:"actionTypeId",nestedDisplayField:"id",fieldToQuery:"alert.attributes.actions",displayField:"actions"},"alert.alertTypeId":{field:"alert.alertTypeId",fieldToQuery:"alert.attributes.alertTypeId",displayField:"type"},"alert.lastRun.outcome":{field:"alert.lastRun.outcome",fieldToQuery:"alert.attributes.lastRun.outcome",displayField:"lastResponse"},"alert.enabled":{field:"alert.enabled",fieldToQuery:"alert.attributes.enabled",displayField:"enabled"},"alert.muteAll":{field:"alert.muteAll",fieldToQuery:"alert.attributes.muteAll",displayField:"muted"},"alert.params.threat.tactic.name":{field:"alert.params.threat.tactic.name",fieldToQuery:"alert.attributes.params.threat.tactic.name",displayField:"threat.tactic.name"},"alert.params.threat.technique.name":{field:"alert.params.threat.technique.name",fieldToQuery:"alert.attributes.params.threat.technique.name",displayField:"threat.technique.name"}}},te=u.a.memo((({onQuerySubmit:e})=>{const{http:t,notifications:{toasts:s},unifiedSearch:{ui:{SearchBar:a}}}=Object(S.b)().services,{value:i,loading:n,error:o}=J()((async()=>t.post("/internal/rules/saved_objects/fields",{body:JSON.stringify({fields:Object.keys(ee.fields).filter((e=>e.includes("alert.")))})})),[]),u=[{title:"",fieldFormatMap:{},fields:null==i?void 0:i.map((e=>({...e,...ee.fields[e.name]?{customLabel:ee.fields[e.name].displayField}:{},...e.esTypes.includes("flattened")?{type:"string"}:{}})))}],c=Object(r.useMemo)((()=>{return{type:(e=ee).type,fields:Object.entries(e.fields).reduce(((e,[t,s])=>{const{displayField:a,nestedDisplayField:l,...i}=s;return l&&a?(Object.assign(e,{[`${a}.${l}`]:{...i,fieldToQuery:i.nestedField}}),Object.assign(e,{[`${a}`]:i})):a&&Object.assign(e,{[a]:i}),e}),e.fields)};var e}),[]);return Object(f.jsx)(a,{appName:"StackRules",disableQueryLanguageSwitcher:!0,query:{query:"",language:"kuery"},indexPatterns:n||o?Z.a:u,showAutoRefreshOnly:!1,showDatePicker:!1,saveQueryMenuVisibility:"hidden",showQueryInput:!0,showQueryMenu:!1,showFilterBar:!0,showSubmitButton:!1,suggestionsAbstraction:c,onQuerySubmit:({query:t})=>{let a={};if(!Object(l.isEmpty)(null==t?void 0:t.query)){var i;a=Object(W.fromKueryExpression)(null!==(i=null==t?void 0:t.query)&&void 0!==i?i:"");try{(({astFilter:e,suggestionsAbstraction:t})=>{const s=Object.values(t.fields).reduce(((e,t)=>(t.displayField&&!e.includes(t.displayField)&&e.push(t.displayField),t.displayField&&t.nestedDisplayField&&!e.includes(`${t.displayField}.${t.nestedDisplayField}`)&&e.push(`${t.displayField}.${t.nestedDisplayField}`),e)),[]);X({astFilter:e,suggestionsAbstraction:t,action:({ast:e,index:a,fieldName:l})=>{if(0===a&&!s.includes(l))throw new Error(`Filter is not supported on this field "${l}"`);t.fields[l]&&(e.value=t.fields[l].fieldToQuery)}})})({astFilter:a,suggestionsAbstraction:c})}catch(e){return void s.addDanger(e.toString())}}e(a)}})})),se=u.a.memo((e=>{const{actionTypes:t,filterOptions:s,filters:l,inputText:n,lastUpdate:o,onClearSelection:r,onRefreshRules:d,onToggleRuleErrors:b,rulesLastRunOutcomesTotal:j,rulesStatusesTotal:p,setInputText:g,showActionFilter:m=!0,showErrors:O,canLoadRules:x,refresh:h,updateFilters:y}=e,S=Object(A.a)("ruleTagFilter"),E=Object(A.a)("ruleStatusFilter"),T=Object(A.a)("ruleUseExecutionStatus"),v=[Object(f.jsx)(q,{key:"type-filter",options:s,filters:l.types,onChange:e=>y({filter:"types",value:e})}),m&&Object(f.jsx)(K,{key:"action-type-filter",actionTypes:t,filters:l.actionTypes,onChange:e=>y({filter:"actionTypes",value:e})}),...T?[Object(f.jsx)(B,{key:"rule-status-filter",selectedStatuses:l.ruleExecutionStatuses,onChange:e=>y({filter:"ruleExecutionStatuses",value:e})})]:[Object(f.jsx)(G,{key:"rule-last-run-outcome-filter",selectedOutcomes:l.ruleLastRunOutcomes,onChange:e=>y({filter:"ruleLastRunOutcomes",value:e})})],...S?[Object(f.jsx)(H.RuleTagFilter,{isGrouped:!0,refresh:h,canLoadRules:x,selectedTags:l.tags,onChange:e=>y({filter:"tags",value:e})})]:[]],k=Object(A.a)("ruleKqlBar");return Object(f.jsx)(u.a.Fragment,null,Object(f.jsx)($,{rulesLastRunOutcomes:j,setRuleExecutionStatusesFilter:e=>y({filter:"ruleExecutionStatuses",value:e}),setRuleLastRunOutcomesFilter:e=>y({filter:"ruleLastRunOutcomes",value:e})}),k&&Object(f.jsx)(te,{onQuerySubmit:e=>y({filter:"kueryNode",value:e})}),Object(f.jsx)(c.EuiFlexGroup,{gutterSize:"s"},Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiFieldSearch,{"data-test-subj":"ruleSearchField",fullWidth:!0,isClearable:!0,placeholder:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.searchPlaceholderTitle",{defaultMessage:"Search"}),value:n,onChange:e=>{g(e.target.value),""===e.target.value&&y({filter:"searchText",value:e.target.value})},onKeyUp:e=>{13===e.keyCode&&y({filter:"searchText",value:n})}})),Object(f.jsx)(c.EuiFlexItem,{grow:!1},E?Object(f.jsx)(Q.RuleStatusFilter,{selectedStatuses:l.ruleStatuses,onChange:e=>y({filter:"ruleStatuses",value:e})}):null),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiFilterGroup,null,v.map(((e,t)=>Object(f.jsx)(u.a.Fragment,{key:t},e))))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiButton,{"data-test-subj":"refreshRulesButton",iconType:"refresh",onClick:()=>{r(),d()},name:"refresh",color:"primary"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.refreshRulesButtonLabel",defaultMessage:"Refresh"})))),Object(f.jsx)(c.EuiSpacer,{size:"m"}),Object(f.jsx)(c.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(f.jsx)(M,{rulesStatuses:p,rulesLastRunOutcomes:j}),Object(f.jsx)(U,{lastUpdate:o,onRefresh:d}))),p.error>0&&Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiLink,{"data-test-subj":"expandRulesError",color:"primary",onClick:b},!O&&Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.showAllErrors",defaultMessage:"Show {totalStatusesError, plural, one {error} other {errors}}",values:{totalStatusesError:p.error}}),O&&Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.hideAllErrors",defaultMessage:"Hide {totalStatusesError, plural, one {error} other {errors}}",values:{totalStatusesError:p.error}})))))}));var ae=s(122),le=s(123),ie=s(226),ne=s(137),oe=s(136),re=s(59),ue=s(135),ce=s(117),de=s(227);const be=({onCreateRulesClick:e,showCreateRule:t=!0})=>Object(f.jsx)(c.EuiPageTemplate.EmptyPrompt,{iconType:"watchesApp","data-test-subj":"createFirstRuleEmptyPrompt",title:Object(f.jsx)("h2",null,Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.components.emptyPrompt.emptyTitle",defaultMessage:"Create your first rule"})),body:Object(f.jsx)("p",null,Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.components.emptyPrompt.emptyDesc",defaultMessage:"Receive an alert through email, Slack, or another connector when a condition is met."})),actions:t?[Object(f.jsx)(c.EuiButton,{iconType:"plusInCircle","data-test-subj":"createFirstRuleButton",key:"create-action",fill:!0,onClick:e},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.components.emptyPrompt.emptyButton",defaultMessage:"Create rule"}))]:null});var je=s(52);const pe=()=>Object(f.jsx)(c.EuiPageTemplate.EmptyPrompt,{"data-test-subj":"noPermissionPrompt",iconType:"securityApp",title:Object(f.jsx)("h1",null,Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.noPermissionToReadTitle",defaultMessage:"No permissions to read rules"})),body:Object(f.jsx)("p",{"data-test-subj":"permissionDeniedMessage"},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.noPermissionToCreateDescription",defaultMessage:"Contact your system administrator."}))}),ge=e=>{const{showNoAuthPrompt:t,showSpinner:s,showCreateRuleButtonInPrompt:a,showCreateFirstRulePrompt:l,onCreateRulesClick:i}=e;return t?Object(f.jsx)(pe,null):l?Object(f.jsx)(be,{showCreateRule:a,onCreateRulesClick:i}):s?Object(f.jsx)(c.EuiPageTemplate.Section,{grow:!1,paddingSize:"none"},Object(f.jsx)(je.a,null)):null};s(289);const me=e=>{const{openFlyout:t}=e;return Object(f.jsx)(c.EuiButton,{iconType:"plusInCircle",key:"create-rule","data-test-subj":"createRuleButton",fill:!0,onClick:t},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.addRuleButtonLabel",defaultMessage:"Create rule"}))},Oe=({licenseType:e,ruleTypeId:t,onConfirm:s,onCancel:n})=>{const o=Object(l.capitalize)(e);return Object(f.jsx)(c.EuiConfirmModal,{title:a.i18n.translate("xpack.triggersActionsUI.sections.manageLicense.manageLicenseTitle",{defaultMessage:"{licenseRequired} license required",values:{licenseRequired:o}}),onCancel:n,onConfirm:s,confirmButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.manageLicense.manageLicenseConfirmButtonText",{defaultMessage:"Manage license"}),cancelButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.manageLicense.manageLicenseCancelButtonText",{defaultMessage:"Cancel"}),defaultFocusedButton:"confirm","data-test-subj":"manageLicenseModal"},Object(f.jsx)("p",null,Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.manageLicense.manageLicenseMessage",defaultMessage:"Rule type {ruleTypeId} is disabled because it requires a {licenseRequired} license. Continue to License Management to view upgrade options.",values:{ruleTypeId:t,licenseRequired:o}})))},xe=({onClickClearFilter:e})=>Object(f.jsx)(u.a.Fragment,null,Object(f.jsx)(c.EuiCallOut,{color:"primary",size:"s","data-test-subj":"rulesListClearRuleFilterBanner"},Object(f.jsx)("p",null,Object(f.jsx)(c.EuiIcon,{color:"primary",type:"iInCircle"})," ",Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.ruleParamBannerTitle",defaultMessage:"Rule list filtered by url parameters."})," ",Object(f.jsx)(c.EuiLink,{color:"primary",onClick:e},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.ruleParamBannerButton",defaultMessage:"Show all"})))),Object(f.jsx)(c.EuiSpacer,{size:"s"}));var fe=s(141);const he=a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.ruleExecutionPercentileSelectButton",{defaultMessage:"select percentile"}),ye={width:200},Se=Object(r.memo)((e=>{const{options:t,onOptionsChange:s}=e,[a,l]=Object(r.useState)(!1),i=Object(r.useCallback)((e=>{e.stopPropagation(),l((e=>!e))}),[]),n=Object(r.useCallback)((()=>{l(!1)}),[]),o=Object(r.useCallback)((e=>{n(),s(e)}),[s,n]),u=Object(r.useCallback)((e=>{e.stopPropagation()}),[]);return Object(f.jsx)(c.EuiPopover,{button:Object(f.jsx)(c.EuiButtonIcon,{iconType:"gear",size:"s","data-test-subj":"percentileSelectablePopover-iconButton",title:he,"aria-label":he,onClick:i}),panelPaddingSize:"s",isOpen:a,closePopover:n,anchorPosition:"downRight"},Object(f.jsx)("div",{style:ye,onClick:u},Object(f.jsx)(c.EuiSelectable,{"data-test-subj":"percentileSelectablePopover-selectable",singleSelection:"always",options:t,onChange:o},(e=>e))))}));var Ee=s(211),Te=s(171),ve=s(176),ke=s(100),Ie=s(98),Ce=s(31);const Fe=e=>{const{rule:t,onManageLicenseClick:s}=e,{lastRun:a}=t,l=Object(Ce.b)(t),n=Object(Ce.d)(t),o=Object(Ce.e)({rule:t,licenseErrorText:O.a,lastOutcomeTranslations:O.K,executionStatusTranslations:O.L}),r="failed"===(null==a?void 0:a.outcome)?`Error: ${null==a?void 0:a.outcomeMsg}`:null;if(!o)return Object(f.jsx)(c.EuiStat,{titleSize:"xs",title:"--",description:"",isLoading:!(null!=a&&a.outcome||t.nextRun)});const u=Object(f.jsx)(c.EuiHealth,{"data-test-subj":`ruleStatus-${(null==a?void 0:a.outcome)||"pending"}`,color:n||"default"},o),d=r?Object(f.jsx)(c.EuiToolTip,{"data-test-subj":"ruleStatus-error-tooltip",position:"top",content:r},u):u;return Object(f.jsx)(c.EuiFlexGroup,{gutterSize:"none"},Object(f.jsx)(c.EuiFlexItem,null,d),l&&Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiButtonEmpty,{size:"xs","data-test-subj":"ruleStatus-error-license-fix",onClick:()=>s(t)},Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.fixLicenseLink",defaultMessage:"Fix"}))))},Re=["ruleName","ruleTags","ruleExecutionStatusLastDate","ruleSnoozeNotify","ruleScheduleInterval","ruleExecutionStatusLastDuration","ruleExecutionPercentile","ruleExecutionSuccessRatio","ruleExecutionStatus","ruleExecutionState"],Le={[p.j.P50]:"50th",[p.j.P95]:"95th",[p.j.P99]:"99th"},Ae={[p.j.P50]:"monitoring.run.calculated_metrics.p50",[p.j.P95]:"monitoring.run.calculated_metrics.p95",[p.j.P99]:"monitoring.run.calculated_metrics.p99"},Me={},we=()=>{},ze=()=>null;function Pe(e){const{rules:t,ruleTypeIndex:s,canExecuteActions:a,config:l}=e,i=l.minimumScheduleInterval?Object(o.parseDuration)(l.minimumScheduleInterval.value):0;return t.map(((e,t)=>{var l,n,r;return{...e,index:t,actionsCount:e.actions.length,ruleType:null!==(l=null===(n=s.get(e.ruleTypeId))||void 0===n?void 0:n.name)&&void 0!==l?l:e.ruleTypeId,isEditable:Object(ce.a)(e.consumer,s.get(e.ruleTypeId))&&(a||!a&&!e.actions.length),enabledInLicense:!(null===(r=s.get(e.ruleTypeId))||void 0===r||!r.enabledInLicense),showIntervalWarning:Object(o.parseDuration)(e.schedule.interval)<i}}))}const Ue=e=>{const{rulesListKey:t,rulesState:s,items:l=[],ruleTypesState:i,ruleTypeRegistry:d,isLoading:b=!1,sort:j,isPageSelected:g=!1,isAllSelected:h=!1,numberOfSelectedRules:y=0,page:E,percentileOptions:T,itemIdToExpandedRowMap:v=Me,config:k=Me,onSort:C=we,onPage:F=we,onRuleClick:L=we,onRuleEditClick:M=we,onRuleDeleteClick:w=we,onManageLicenseClick:z=we,onPercentileOptionsChange:P=we,onRuleChanged:U,onEnableRule:_,onDisableRule:D,onSnoozeRule:B=we,onUnsnoozeRule:N=we,onSelectAll:G=we,onSelectPage:$=we,onSelectRow:q=we,isRowSelected:K=(()=>!1),renderCollapsedItemActions:H=ze,renderSelectAllDropdown:Q,renderRuleError:W=ze,visibleColumns:V,resetFilters:J,numberOfFilters:Z}=e,[Y,X]=Object(r.useState)(-1),[ee,te]=Object(r.useState)({}),se=Object(A.a)("ruleUseExecutionStatus"),[ae]=Object(n.useUiSetting$)(x.d),{euiTheme:le}=Object(c.useEuiTheme)(),ie=Object(r.useMemo)((()=>{const e=T.find((e=>"on"===e.checked));if(e)return p.j[e.key]}),[T]),ne=Object(r.useCallback)((()=>Object(f.jsx)("span",{"data-test-subj":`rulesTable-${ie}ColumnName`},Object(f.jsx)(c.EuiToolTip,{content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.ruleExecutionPercentileTooltip",{defaultMessage:"{percentileOrdinal} percentile of this rule's past {sampleLimit} run durations (mm:ss).",values:{percentileOrdinal:Le[ie],sampleLimit:o.MONITORING_HISTORY_LIMIT}})},Object(f.jsx)("span",null,ie," ",Object(f.jsx)(c.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),Object(f.jsx)(Se,{options:T,onOptionsChange:P}))),[P,T,ie]),oe=Object(r.useCallback)((e=>Object(f.jsx)("span",{"data-test-subj":`${ie}Percentile`},Object(f.jsx)(Ee.a,{allowZero:!1,duration:e}))),[ie]),re=Object(r.useCallback)((e=>!!d.has(e)&&!d.get(e).requiresAppContext),[d]),ue=Object(r.useCallback)((e=>Object(f.jsx)(Ie.RuleStatusDropdown,{hideSnoozeOption:!0,disableRule:async()=>await D(e),enableRule:async()=>await _(e),snoozeRule:async()=>{},unsnoozeRule:async()=>{},rule:e,onRuleChanged:U,isEditable:e.isEditable&&re(e.ruleTypeId)})),[re,D,_,U]),ce=Object(r.useMemo)((()=>({id:"ruleSelection",field:"selection",sortable:!1,width:"32px",mobileOptions:{header:!1},name:Object(f.jsx)(c.EuiCheckbox,{id:"rulesListTable_selectAll",checked:g,onChange:$,"data-test-subj":"checkboxSelectAll"}),render:(e,t)=>Object(f.jsx)(c.EuiCheckbox,{id:`ruleListTable_select_${t.id}}`,onChange:()=>q(t),disabled:!t.isEditable,checked:K(t),"data-test-subj":`checkboxSelectRow-${t.id}`})})),[g,$,q,K]),de=Object(r.useMemo)((()=>se?"executionStatus.status":"lastRun.outcome"),[se]),be=Object(r.useCallback)((()=>[{id:"ruleName",field:"name",name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.nameTitle",{defaultMessage:"Name"}),sortable:!0,truncateText:!1,width:"22%","data-test-subj":"rulesTableCell-name",render:(e,t)=>{const s=i.data.get(t.ruleTypeId),a=Object(Te.a)(s),l=Object(f.jsx)(u.a.Fragment,null,Object(f.jsx)(c.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiFlexGroup,{gutterSize:"xs"},Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiLink,{title:e,onClick:()=>L(t)},e)),Object(f.jsx)(c.EuiFlexItem,{grow:!1},!a.isEnabled&&Object(f.jsx)(c.EuiIconTip,{anchorClassName:"ruleDisabledQuestionIcon","data-test-subj":"ruleDisabledByLicenseTooltip",type:"questionInCircle",content:a.message,position:"right"})))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiText,{color:"subdued",size:"xs"},t.ruleType))));return Object(f.jsx)(u.a.Fragment,null,l)}},{id:"ruleTags",field:"tags",selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.tagsTitle",{defaultMessage:"Tags"}),name:"",sortable:!1,width:"50px","data-test-subj":"rulesTableCell-tagsPopover",render:(e,t)=>e.length>0?Object(f.jsx)(ke.RuleTagBadge,{isOpen:Y===t.index,tags:e,onClick:()=>X(t.index),onClose:()=>X(-1)}):null},{id:"ruleExecutionStatusLastDate",field:"executionStatus.lastExecutionDate",selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.lastRunTitle",{defaultMessage:"Last run"}),name:Object(f.jsx)(c.EuiToolTip,{"data-test-subj":"rulesTableCell-lastExecutionDateTooltip",content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.lastRunTitleTooltip",{defaultMessage:"Start time of the last run."})},Object(f.jsx)("span",null,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.lastRunTitle",{defaultMessage:"Last run"}),Object(f.jsx)(c.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:!0,width:"20%","data-test-subj":"rulesTableCell-lastExecutionDate",render:e=>{if(e)return Object(f.jsx)(u.a.Fragment,null,Object(f.jsx)(c.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(f.jsx)(c.EuiFlexItem,{grow:!1},I()(e).format("MMM D, YYYY HH:mm:ssa")),Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiText,{color:"subdued",size:"xs"},I()(e).fromNow()))))}},{id:"ruleSnoozeNotify",selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.notifyTitle",{defaultMessage:"Notify"}),name:Object(f.jsx)(c.EuiToolTip,{"data-test-subj":"rulesTableCell-notifyTooltip",content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.notifyTooltip",{defaultMessage:"Snooze notifications for a rule."})},Object(f.jsx)("span",null,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.notifyTitle",{defaultMessage:"Notify"})," ",Object(f.jsx)(c.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),width:"14%","data-test-subj":"rulesTableCell-rulesListNotify",render:e=>e.enabled?Object(f.jsx)(R.RulesListNotifyBadge,{showOnHover:!0,snoozeSettings:e,loading:!!ee[e.id],disabled:!e.isEditable,onRuleChanged:U,snoozeRule:async t=>{await B(e,t)},unsnoozeRule:async t=>await N(e,t)}):null},{id:"ruleScheduleInterval",field:"schedule.interval",width:"6%",name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.scheduleTitle",{defaultMessage:"Interval"}),sortable:!1,truncateText:!1,"data-test-subj":"rulesTableCell-interval",render:(e,t)=>{const s=Object(o.formatDuration)(e);return Object(f.jsx)(u.a.Fragment,null,Object(f.jsx)(c.EuiFlexGroup,{direction:"row",gutterSize:"xs"},Object(f.jsx)(c.EuiFlexItem,{grow:!1},s),Object(f.jsx)(c.EuiFlexItem,{grow:!1},t.showIntervalWarning&&Object(f.jsx)(c.EuiToolTip,{"data-test-subj":`ruleInterval-config-tooltip-${t.index}`,title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.intervalTooltipTitle",{defaultMessage:"Below configured minimum interval"}),content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.intervalTooltipText",{defaultMessage:"Rule interval of {interval} is below the minimum configured interval of {minimumInterval}. This may impact alerting performance.",values:{minimumInterval:Object(o.formatDuration)(k.minimumScheduleInterval.value,!0),interval:Object(o.formatDuration)(e,!0)}}),position:"top"},Object(f.jsx)(c.EuiButtonIcon,{color:"text","data-test-subj":`ruleInterval-config-icon-${t.index}`,onClick:()=>M(t),iconType:"flag","aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.intervalIconAriaLabel",{defaultMessage:"Below configured minimum interval"})})))))}},{id:"ruleExecutionStatusLastDuration",field:"executionStatus.lastDuration",width:"12%",selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.durationTitle",{defaultMessage:"Duration"}),name:Object(f.jsx)(c.EuiToolTip,{"data-test-subj":"rulesTableCell-durationTooltip",content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.durationTitleTooltip",{defaultMessage:"The length of time it took for the rule to run (mm:ss)."})},Object(f.jsx)("span",null,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.durationTitle",{defaultMessage:"Duration"}),Object(f.jsx)(c.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:!0,truncateText:!1,"data-test-subj":"rulesTableCell-duration",render:(e,t)=>{const s=Object(fe.b)(i.data.get(t.ruleTypeId),e);return Object(f.jsx)(u.a.Fragment,null,Object(f.jsx)(Ee.a,{duration:e}),s&&Object(f.jsx)(c.EuiIconTip,{"data-test-subj":"ruleDurationWarning",anchorClassName:"ruleDurationWarningIcon",type:"rule",color:"warning",content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleTypeExcessDurationMessage",{defaultMessage:"Duration exceeds the rule's expected run time."}),position:"right"}))}},{id:"ruleExecutionPercentile",mobileOptions:{header:!1},selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.percentileTitle",{defaultMessage:"Percentile"}),field:Ae[ie],width:"16%",name:ne(),"data-test-subj":"rulesTableCell-ruleExecutionPercentile",sortable:!0,truncateText:!1,render:oe},{id:"ruleExecutionSuccessRatio",field:"monitoring.run.calculated_metrics.success_ratio",width:"12%",selectorName:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selector.successRatioTitle",{defaultMessage:"Success ratio"}),name:Object(f.jsx)(c.EuiToolTip,{"data-test-subj":"rulesTableCell-successRatioTooltip",content:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.successRatioTitleTooltip",{defaultMessage:"How often this rule runs successfully."})},Object(f.jsx)("span",null,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.successRatioTitle",{defaultMessage:"Success ratio"}),Object(f.jsx)(c.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),sortable:!0,truncateText:!1,"data-test-subj":"rulesTableCell-successRatio",render:e=>Object(f.jsx)("span",{"data-test-subj":"successRatio"},void 0!==e?Object(ve.c)(e):"N/A")},{id:"ruleExecutionStatus",field:de,name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.lastResponseTitle",{defaultMessage:"Last response"}),sortable:!0,truncateText:!1,width:"120px","data-test-subj":"rulesTableCell-lastResponse",render:(e,t)=>Object(f.jsx)(Fe,{rule:t,onManageLicenseClick:z})},{id:"ruleExecutionState",field:"enabled",name:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.stateTitle",{defaultMessage:"State"}),sortable:!0,truncateText:!1,width:"10%","data-test-subj":"rulesTableCell-status",render:(e,t)=>ue(t)},{name:"",width:"90px",render:e=>Object(f.jsx)(c.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},Object(f.jsx)(c.EuiFlexItem,{grow:!1,className:"ruleSidebarItem"},Object(f.jsx)(c.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"xs"},e.isEditable&&re(e.ruleTypeId)?Object(f.jsx)(c.EuiFlexItem,{grow:!1,"data-test-subj":"ruleSidebarEditAction"},Object(f.jsx)(c.EuiButtonIcon,{color:"primary",title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.editButtonTooltip",{defaultMessage:"Edit"}),className:"ruleSidebarItem__action","data-test-subj":"editActionHoverButton",onClick:()=>M(e),iconType:"pencil","aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.editAriaLabel",{defaultMessage:"Edit"})})):null,e.isEditable?Object(f.jsx)(c.EuiFlexItem,{grow:!1,"data-test-subj":"ruleSidebarDeleteAction"},Object(f.jsx)(c.EuiButtonIcon,{color:"danger",title:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.deleteButtonTooltip",{defaultMessage:"Delete"}),className:"ruleSidebarItem__action","data-test-subj":"deleteActionHoverButton",onClick:()=>w(e),iconType:"trash","aria-label":a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.deleteAriaLabel",{defaultMessage:"Delete"})})):null)),Object(f.jsx)(c.EuiFlexItem,{grow:!1},H(e,(t=>((e,t)=>{te((s=>({...s,[e]:t})))})(e.id,t)))))},{align:c.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,name:Object(f.jsx)(c.EuiScreenReaderOnly,null,Object(f.jsx)("span",null,"Expand rows")),render:W}]),[k.minimumScheduleInterval,ee,re,U,L,w,M,B,N,z,H,oe,ne,W,ue,i.data,ie,Y,de]),je=Object(r.useMemo)((()=>be()),[be]),[pe,ge]=(({allRuleColumns:e,rulesListKey:t="triggersActionsUi_rulesListColumns",visibleColumns:s=Re})=>{const{storage:a}=Object(S.b)().services,l=null==a?void 0:a.get(t),[i,n]=Object(r.useState)(null!=l?l:s),o=Object(r.useMemo)((()=>e.filter((e=>null!=e.id))),[e]),u=Object(r.useMemo)((()=>e.filter((e=>void 0===e.id))),[e]),d=Object(r.useMemo)((()=>{const e=i.map((e=>{var t;const{id:s="",selectorName:a="",...l}=null!==(t=o.find((t=>t.id===e)))&&void 0!==t?t:{};return l}));return e.push(...u),e}),[o,i,u]),b=Object(r.useMemo)((()=>o.map((e=>({id:e.id})))),[o]),j=Object(r.useCallback)((e=>{t&&(null==a||a.set(t,e))}),[t,a]),p=Object(r.useMemo)((()=>({visibleColumns:i,setVisibleColumns:e=>{j(e),n(e)}})),[i,j]),g=Object(r.useMemo)((()=>e.filter((e=>null!=e.id)).reduce(((e,{id:t,name:s,selectorName:a})=>t?{...e,[t]:null!=a?a:s}:e),{})),[e]),[m]=Object(c.useDataGridColumnSelector)(b,p,!0,g);return Object(r.useMemo)((()=>[d,m]),[m,d])})({allRuleColumns:je,rulesListKey:t,visibleColumns:V}),me=Object(r.useMemo)((()=>m()(s.totalItemCount).format(ae)),[s.totalItemCount,ae]),Oe=Object(r.useMemo)((()=>h?O.e:Object(O.u)(me,s.totalItemCount)),[h,me,s.totalItemCount]),xe=Object(r.useCallback)((e=>{var t;const s=K(e)?"euiTableRow-isSelected":"";return{"data-test-subj":"rule-row",className:null!==(t=i.data.get(e.ruleTypeId))&&void 0!==t&&t.enabledInLicense?s:`actRulesList__tableRowDisabled ${s}`}}),[i,K]),he=Object(r.useMemo)((()=>{let e=!0;return i.data.forEach((t=>{e&&(Object.values(t.authorizedConsumers).every((e=>e.all))||(e=!1))})),e}),[i]);return Object(f.jsx)(c.EuiFlexGroup,{gutterSize:"none",direction:"column"},Object(f.jsx)(c.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"none",alignItems:"center"},Object(f.jsx)(c.EuiFlexItem,{grow:!1},Object(f.jsx)(c.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"s",alignItems:"center"},Object(f.jsx)(c.EuiFlexItem,{grow:!1},y>0?null==Q?void 0:Q():Object(f.jsx)(c.EuiText,{size:"xs",style:{fontWeight:le.font.weight.semiBold},"data-test-subj":"totalRulesCount"},Object(O.x)(me,s.totalItemCount))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},y>0&&he&&Object(f.jsx)(c.EuiButtonEmpty,{size:"xs","aria-label":O.t,"data-test-subj":"selectAllRulesButton",iconType:h?"cross":"pagesSelect",onClick:G},Oe)),Z>0&&Object(f.jsx)(c.EuiFlexItem,{css:Object(f.css)({borderLeft:le.border.thin,paddingLeft:le.size.m},"","")},Object(f.jsx)(c.EuiButtonEmpty,{onClick:J,size:"xs",iconSide:"left",flush:"left","data-test-subj":"rules-list-clear-filter"},Object(O.d)(Z))))),Object(f.jsx)(c.EuiFlexItem,{grow:!1},ge)),Object(f.jsx)(c.EuiFlexItem,null,Object(f.jsx)(c.EuiBasicTable,{loading:b,items:l,itemId:"id",columns:[ce,...pe],sorting:{sort:j},rowProps:xe,cellProps:e=>{var t;return{"data-test-subj":"cell",className:null!==(t=i.data.get(e.ruleTypeId))&&void 0!==t&&t.enabledInLicense?"":"actRulesList__tableCellDisabled"}},"data-test-subj":"rulesList",pagination:{pageIndex:E.index,pageSize:E.size,totalItemCount:i.initialLoad?0:s.totalItemCount},onChange:({page:e,sort:t})=>{e&&F(e),t&&C(t)},itemIdToExpandedRowMap:v,isExpandable:!0})))};var _e=s(213),De=s(228),Be=s(214);const Ne=a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkSnoozeFailMessage",{defaultMessage:"Failed to bulk snooze rules"}),Ge=Object(y.a)((e=>{const{bulkEditAction:t,rules:s,filter:l,numberOfSelectedRules:n=0,onClose:o,onSave:u,setIsBulkEditing:d,onSearchPopulate:b,bulkSnoozeRules:j,bulkUnsnoozeRules:p}=e,{notifications:{toasts:g}}=Object(S.b)().services,{showToast:m}=Object(Be.a)({onSearchPopulate:b}),O=Object(r.useMemo)((()=>{if(l)return;const e=s.find((e=>e.isSnoozedUntil));return e?Object(F.b)(e.isSnoozedUntil):void 0}),[s,l]),x=async()=>{o(),d(!0);try{const e=await p({ids:s.map((e=>e.id)),filter:l});m(e,"snooze")}catch(e){g.addError(e,{title:Ne})}d(!1),u()},h=Object(r.useMemo)((()=>{return!l&&1===n&&s[0]?(e=s[0].name,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkUnsnoozeConfirmationSingle",{defaultMessage:"Unsnooze {ruleName}?",values:{ruleName:e}})):(t=n,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkUnsnoozeConfirmationPlural",{defaultMessage:"Unsnooze {total, plural, one {# rule} other {# rules}}? ",values:{total:t}}));var e,t}),[s,l,n]);return"unsnooze"===t&&(s.length||l)?Object(f.jsx)(c.EuiConfirmModal,{title:h,onCancel:o,onConfirm:x,confirmButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkUnsnoozeConfirmButton",{defaultMessage:"Unsnooze"}),cancelButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkUnsnoozeCancelButton",{defaultMessage:"Cancel"}),buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"bulkUnsnoozeConfirmationModal"}):"snooze"===t&&(s.length||l)?Object(f.jsx)(c.EuiModal,{onClose:o},Object(f.jsx)(c.EuiModalHeader,null,Object(f.jsx)(c.EuiModalHeaderTitle,null,Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkSnoozeModal.modalTitle",defaultMessage:"Add snooze now"})),Object(f.jsx)(c.EuiSpacer,{size:"s"})),Object(f.jsx)(c.EuiModalBody,null,Object(f.jsx)(F.a,{hasTitle:!1,showCancel:!1,showAddSchedule:!1,interval:O,snoozeRule:async e=>{o(),d(!0);try{const t=await j({ids:s.map((e=>e.id)),filter:l,snoozeSchedule:e});m(t,"snooze")}catch(e){g.addError(e,{title:Ne})}d(!1),u()},unsnoozeRule:x,scheduledSnoozes:[],activeSnoozes:[]})),Object(f.jsx)(c.EuiModalFooter,null,Object(f.jsx)(c.EuiButtonEmpty,{onClick:o},"Close"))):null}));var $e=s(231);const qe=a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkSnoozeScheduleFailMessage",{defaultMessage:"Failed to bulk snooze rules"}),Ke=Object(y.a)((e=>{const{rules:t,filter:s,bulkEditAction:l,numberOfSelectedRules:n=0,onClose:o,onSave:u,bulkSnoozeRules:d,bulkUnsnoozeRules:b,setIsBulkEditing:j,onSearchPopulate:p}=e,{notifications:{toasts:g}}=Object(S.b)().services,{showToast:m}=Object(Be.a)({onSearchPopulate:p}),O=async()=>{o(),j(!0);try{const e=await b({ids:t.map((e=>e.id)),filter:s,scheduleIds:[]});m(e,"snoozeSchedule")}catch(e){g.addError(e,{title:qe})}j(!1),u()},x=Object(r.useMemo)((()=>{return!s&&1===n&&t[0]?(e=t[0].name,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkDeleteConfirmationSingle",{defaultMessage:"Delete all snooze schedules for {ruleName}?",values:{ruleName:e}})):(l=n,a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkDeleteConfirmationPlural",{defaultMessage:"Delete all snooze schedules for {total, plural, one {# rule} other {# rules}}? ",values:{total:l}}));var e,l}),[t,s,n]);return"unschedule"===l&&(t.length||s)?Object(f.jsx)(c.EuiConfirmModal,{title:x,onCancel:o,onConfirm:O,confirmButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkDeleteConfirmButton",{defaultMessage:"Delete"}),cancelButtonText:a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.bulkDeleteCancelButton",{defaultMessage:"Cancel"}),buttonColor:"danger",defaultFocusedButton:"confirm","data-test-subj":"bulkRemoveScheduleConfirmationModal"}):"schedule"===l&&(t.length||s)?Object(f.jsx)(c.EuiModal,{onClose:o},Object(f.jsx)(c.EuiModalHeader,null,Object(f.jsx)(c.EuiModalHeaderTitle,null,Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.bulkSnoozeScheduleModal.modalTitle",defaultMessage:"Add snooze schedule"})),Object(f.jsx)(c.EuiSpacer,{size:"s"})),Object(f.jsx)(c.EuiModalBody,null,Object(f.jsx)($e.a,{bulkSnoozeSchedule:!0,hasTitle:!1,isLoading:!1,initialSchedule:null,onSaveSchedule:async e=>{o(),j(!0);try{const a=await d({ids:t.map((e=>e.id)),filter:s,snoozeSchedule:e});m(a,"snoozeSchedule")}catch(e){g.addError(e,{title:qe})}j(!1),u()},onCancelSchedules:O,onClose:()=>{}})),Object(f.jsx)(c.EuiModalFooter,null,Object(f.jsx)(c.EuiButtonEmpty,{onClick:o},"Close"))):null})),He=({typesFilter:e,actionTypesFilter:t,ruleExecutionStatusesFilter:s,ruleLastRunOutcomesFilter:a,ruleParamsFilter:i,ruleStatusesFilter:n,tagsFilter:o,searchText:r,kueryNode:u})=>{const c=[];if(u&&!Object(l.isEmpty)(u)&&c.push(u),e&&e.length&&c.push(W.nodeBuilder.or(e.map((e=>W.nodeBuilder.is("alert.attributes.alertTypeId",e))))),t&&t.length&&c.push(W.nodeBuilder.or(t.map((e=>Object(W.fromKueryExpression)(`alert.attributes.actions:{ actionTypeId: ${e} }`))))),s&&s.length&&c.push(W.nodeBuilder.or(s.map((e=>W.nodeBuilder.is("alert.attributes.executionStatus.status",e))))),a&&a.length&&c.push(W.nodeBuilder.or(a.map((e=>W.nodeBuilder.is("alert.attributes.lastRun.outcome",e))))),i&&Object.keys(i).length&&c.push(W.nodeBuilder.and(Object.keys(i).map((e=>W.nodeBuilder.is(`alert.attributes.params.${e}`,String(i[e])))))),n&&n.length){const e=W.nodeBuilder.or([Object(W.fromKueryExpression)("alert.attributes.muteAll: true"),Object(W.fromKueryExpression)("alert.attributes.snoozeSchedule:{ duration > 0 }")]),t=Object(W.fromKueryExpression)("alert.attributes.enabled: true"),s=Object(W.fromKueryExpression)("alert.attributes.enabled: false"),a=[];n.includes("enabled")&&a.push(t),n.includes("disabled")&&a.push(s),n.includes("snoozed")&&a.push(e),c.push(W.nodeBuilder.or(a))}if(o&&o.length&&c.push(W.nodeBuilder.or(o.map((e=>W.nodeBuilder.is("alert.attributes.tags",e))))),r&&""!==r){const e=r.match(/(['"`])(.*?)\1/g)?W.nodeTypes.literal.buildNode(r,!0):W.nodeTypes.wildcard.buildNode(r);c.push(W.nodeBuilder.or([W.nodeBuilder.is("alert.attributes.name",e),W.nodeBuilder.is("alert.attributes.tags",e)]))}return c.length?W.nodeBuilder.and(c):null};var Qe;!function(e){e.TOGGLE_SELECT_ALL="TOGGLE_SELECT_ALL",e.TOGGLE_ROW="TOGGLE_ROW",e.SET_SELECTION="SET_SELECTION",e.CLEAR_SELECTION="CLEAR_SELECTION"}(Qe||(Qe={}));const We={selectedIds:new Set,isAllSelected:!1},Ve=(e,t)=>{const{type:s,payload:a}=t;switch(s){case Qe.TOGGLE_SELECT_ALL:return{...e,isAllSelected:!e.isAllSelected,selectedIds:new Set};case Qe.TOGGLE_ROW:{const t=a;return e.selectedIds.has(t)?e.selectedIds.delete(t):e.selectedIds.add(t),{...e,selectedIds:new Set(e.selectedIds)}}case Qe.SET_SELECTION:{const t=a;return{...e,selectedIds:new Set(t)}}case Qe.CLEAR_SELECTION:return{...We,selectedIds:new Set};default:return e}};var Je=s(232),Ze=s(5),Ye=s(23),Xe=s(22),et=s(49);const tt=e=>e.reduce(((e,t)=>({...e,[t]:0})),{});var st=s(54),at=s(34);var lt=s(134),it=s(129),nt=s(229),ot=s(230);var rt=s(48),ut=s(294),ct=s.n(ut);const dt="triggersActionsUi_rulesList",bt=e=>({actionTypes:e.actionTypes,lastResponse:e.ruleLastRunOutcomes,params:e.ruleParams,search:e.searchText,status:e.ruleStatuses,tags:e.tags,type:e.types}),jt=Object(r.lazy)((()=>Promise.all([s.e(0),s.e(3),s.e(55)]).then(s.bind(null,79)))),pt=Object(r.lazy)((()=>Promise.all([s.e(0),s.e(3),s.e(58)]).then(s.bind(null,80)))),gt={[p.j.P50]:"monitoring.run.calculated_metrics.p50",[p.j.P95]:"monitoring.run.calculated_metrics.p95",[p.j.P99]:"monitoring.run.calculated_metrics.p99"},mt=Object.values(p.j).map((e=>({checked:e===p.j.P50?"on":void 0,label:e,key:e}))),Ot=[],xt=({filterConsumers:e,filteredRuleTypes:t=Ot,lastResponseFilter:s,lastRunOutcomeFilter:p,refresh:g,ruleDetailsRoute:m,ruleParamFilter:y,rulesListKey:T,searchFilter:v="",showActionFilter:k=!0,showCreateRuleButtonInPrompt:C=!1,showSearchBar:F=!0,statusFilter:R,typeFilter:M,visibleColumns:w,onLastResponseFilterChange:z,onLastRunOutcomeFilterChange:P,onRuleParamFilterChange:U,onSearchFilterChange:_,onStatusFilterChange:D,onTypeFilterChange:B,onRefresh:N,setHeaderActions:G,initialSelectedConsumer:$=b.vb})=>{const q=Object(d.useHistory)(),K=Object(S.b)().services,{actionTypeRegistry:H,application:{capabilities:Q},http:V,kibanaFeatures:J,notifications:{toasts:Z},ruleTypeRegistry:Y}=K,X=Object(ce.c)(Q),[ee,te]=Object(r.useState)(!1),[be,je]=Object(r.useState)({index:0,size:x.f}),[pe,fe]=Object(r.useState)(v),[he,ye]=Object(r.useState)(!1),[Se,Ee]=Object(r.useState)(!1),[Te,ve]=Object(r.useState)(null),[ke,Ie]=Object(r.useState)({}),[Ce,Fe]=Object(r.useState)(!1),Re=Object(r.useRef)(null),Le=Object(A.a)("ruleStatusFilter"),[Ae,Me]=Object(r.useState)(mt),[we,ze]=Object(r.useState)({field:"name",direction:"asc"}),[Be,Ne]=Object(r.useState)(null),[$e,qe]=Object(r.useState)(!1),[ut,gt]=Object(r.useState)(!1),[xt,ht]=Object(r.useState)([]),[yt,St]=Object(r.useState)(),[Et,Tt]=Object(r.useState)(),[vt,kt]=Object(r.useState)(!1),[It,Ct]=Object(r.useState)(!1),[Ft,Rt]=Object(r.useState)(!1),[Lt,At]=Object(r.useState)(new Date),{config:Mt}=(()=>{const{http:e}=Object(S.b)().services,{data:t}=Object(Ze.useQuery)({queryKey:["loadConfig"],queryFn:()=>Object(lt.a)({http:e}),initialData:{isUsingSecurity:!1},refetchOnWindowFocus:!1});return{config:t}})(),{ruleTypesState:wt,hasAnyAuthorizedRuleType:zt,authorizedRuleTypes:Pt,authorizedToReadAnyRules:Ut,authorizedToCreateAnyRules:_t,isSuccess:Dt}=Object(st.a)({filteredRuleTypes:t}),{actionTypes:Bt}=(()=>{const{http:e,actionTypeRegistry:t,notifications:{toasts:s}}=Object(S.b)().services,{data:l=[]}=Object(Ze.useQuery)({queryKey:["loadActionTypes"],queryFn:()=>Object(Xe.d)({http:e,featureId:Ye.AlertingConnectorFeatureId}),onError:()=>{s.addDanger(a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.unableToLoadConnectorTypesMessage",{defaultMessage:"Unable to load connector types"}))},refetchOnWindowFocus:!1});return{actionTypes:l.filter((({id:e})=>t.has(e))).sort(((e,t)=>e.name.localeCompare(t.name)))}})(),{filters:Nt,setFiltersStore:Gt,numberOfFiltersStore:$t,resetFiltersStore:qt}=(({lastResponseFilter:e,lastRunOutcomeFilter:t,rulesListKey:s=dt,ruleParamFilter:a,statusFilter:i,searchFilter:n,typeFilter:o})=>{var u,c,b,j,p,g,m,O,x,f,h,y;const S=Object(d.useHistory)(),E=Object(rt.createKbnUrlStateStorage)({history:S,useHash:!1,useHashQuery:!1}),[T,v]=ct()(`${dt}_filters`,{}),k=Object(r.useMemo)((()=>!!T&&!Object.values(T).every((e=>Object(l.isEmpty)(e)))),[T]),I=Object(r.useMemo)((()=>{var e;return null!==(e=E.get("_a"))&&void 0!==e?e:{}}),[E]),C=Object(r.useMemo)((()=>!!I&&!Object.values(I).every((e=>Object(l.isEmpty)(e)))),[I]),F=Object(r.useMemo)((()=>C?I:k?T:{}),[k,C,T,I]),[R,L]=Object(r.useState)({actionTypes:null!==(u=null==F?void 0:F.actionTypes)&&void 0!==u?u:[],ruleExecutionStatuses:null!=e?e:[],ruleLastRunOutcomes:null!==(c=null!==(b=null==F?void 0:F.lastResponse)&&void 0!==b?b:t)&&void 0!==c?c:[],ruleParams:null!==(j=null!==(p=null==F?void 0:F.params)&&void 0!==p?p:a)&&void 0!==j?j:{},ruleStatuses:null!==(g=null!==(m=null==F?void 0:F.status)&&void 0!==m?m:i)&&void 0!==g?g:[],searchText:null!==(O=null!==(x=null==F?void 0:F.search)&&void 0!==x?x:n)&&void 0!==O?O:"",tags:null!==(f=null==F?void 0:F.tags)&&void 0!==f?f:[],types:null!==(h=null!==(y=null==F?void 0:F.type)&&void 0!==y?y:o)&&void 0!==h?h:[],kueryNode:void 0}),A=Object(r.useCallback)((e=>{E.set("_a",bt(e))}),[E]),M=Object(r.useCallback)((e=>{v(bt(e))}),[v]),w=Object(r.useCallback)((e=>{const{filter:t,value:s}=e;L((e=>{const a={...e,[t]:s};return A(a),M(a),a}))}),[M,A]),z=Object(r.useCallback)((()=>{const e={actionTypes:[],ruleExecutionStatuses:[],ruleLastRunOutcomes:[],ruleParams:{},ruleStatuses:[],searchText:"",tags:[],types:[],kueryNode:void 0};L(e),A(e),M(e)}),[M,A]);return Object(r.useEffect)((()=>{var s,l,r,u,c,d,b,j,p,g,m,O;(C||k)&&L({actionTypes:null!==(s=null==F?void 0:F.actionTypes)&&void 0!==s?s:[],ruleExecutionStatuses:null!=e?e:[],ruleLastRunOutcomes:null!==(l=null!==(r=null==F?void 0:F.lastResponse)&&void 0!==r?r:t)&&void 0!==l?l:[],ruleParams:null!==(u=null!==(c=null==F?void 0:F.params)&&void 0!==c?c:a)&&void 0!==u?u:{},ruleStatuses:null!==(d=null!==(b=null==F?void 0:F.status)&&void 0!==b?b:i)&&void 0!==d?d:[],searchText:null!==(j=null!==(p=null==F?void 0:F.search)&&void 0!==p?p:n)&&void 0!==j?j:"",tags:null!==(g=null==F?void 0:F.tags)&&void 0!==g?g:[],types:null!==(m=null!==(O=null==F?void 0:F.type)&&void 0!==O?O:o)&&void 0!==m?m:[],kueryNode:void 0})}),[]),Object(r.useMemo)((()=>({filters:R,setFiltersStore:w,numberOfFiltersStore:Object.values(R).filter((e=>!Object(l.isEmpty)(e))).length,resetFiltersStore:z})),[R,z,w])})({lastResponseFilter:s,lastRunOutcomeFilter:p,rulesListKey:T,ruleParamFilter:y,statusFilter:R,searchFilter:v,typeFilter:M}),Kt=Object(l.isEmpty)(Nt.types)?Pt.map((e=>e.id)):Nt.types,Ht=Object(l.isEmpty)(Nt.types),Qt=Object(r.useMemo)((()=>({...Nt,types:Kt})),[Nt,Kt]),Wt=Dt&&zt,{rulesState:Vt,loadRules:Jt,hasData:Zt,lastUpdate:Yt}=(e=>{var t,s;const{filterConsumers:l,filters:i,page:n,sort:o,onPage:r,enabled:u,refresh:c}=e,{http:d,notifications:{toasts:b}}=Object(S.b)().services,{refetch:j,isLoading:p,data:g,dataUpdatedAt:m,isInitialLoading:O,isFetching:f}=Object(Ze.useQuery)({queryKey:["loadRules",i.tags,i.searchText,i.types,i.actionTypes,i.ruleStatuses,i.ruleLastRunOutcomes,i.ruleParams,i.kueryNode,n,o,{refresh:null==c?void 0:c.toISOString()},l],queryFn:()=>async function({http:e,page:t,searchText:s,typesFilter:a,actionTypesFilter:l,ruleExecutionStatusesFilter:i,ruleLastRunOutcomesFilter:n,ruleParamsFilter:o,ruleStatusesFilter:r,tagsFilter:u,sort:c={field:"name",direction:"asc"},kueryNode:d,filterConsumers:b}){const j=He({typesFilter:a,actionTypesFilter:l,tagsFilter:u,ruleExecutionStatusesFilter:i,ruleLastRunOutcomesFilter:n,ruleParamsFilter:o,ruleStatusesFilter:r,searchText:s,kueryNode:d}),p=await e.post(`${x.j}/rules/_find`,{body:JSON.stringify({page:t.index+1,per_page:t.size,...j?{filter:JSON.stringify(j)}:{},sort_field:c.field,sort_order:c.direction,filter_consumers:b})});return{page:p.page,perPage:p.per_page,total:p.total,data:(g=p.data,g.map((e=>Object(at.b)(e))))};var g}({http:d,page:n,searchText:i.searchText,typesFilter:i.types,actionTypesFilter:i.actionTypes,ruleExecutionStatusesFilter:i.ruleExecutionStatuses,ruleLastRunOutcomesFilter:i.ruleLastRunOutcomes,ruleParamsFilter:i.ruleParams,ruleStatusesFilter:i.ruleStatuses,tagsFilter:i.tags,kueryNode:i.kueryNode,sort:o,filterConsumers:l}),onSuccess:e=>{var t;(null==e||null===(t=e.data)||void 0===t||!t.length)&&n.index>0&&r({...n,index:0})},onError:()=>{b.addDanger(a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.unableToLoadRulesMessage",{defaultMessage:"Unable to load rules"}))},enabled:u,keepPreviousData:!0,cacheTime:0,refetchOnWindowFocus:!1}),h=Boolean(g&&g.data.length>0);return{rulesState:{isLoading:u&&(p||f),data:null!==(t=null==g?void 0:g.data)&&void 0!==t?t:[],totalItemCount:null!==(s=null==g?void 0:g.total)&&void 0!==s?s:0,initialLoad:p||O},lastUpdate:I()(m).format(),hasData:h,loadRules:j}})({filterConsumers:e,filters:Qt,hasDefaultRuleTypesFiltersOn:Ht,page:be,sort:we,onPage:je,enabled:Wt,refresh:g}),{loadRuleAggregations:Xt,rulesStatusesTotal:es,rulesLastRunOutcomesTotal:ts}=(e=>{var t,s;const{filters:l,enabled:i,refresh:n,filterConsumers:r}=e,{http:u,notifications:{toasts:c}}=Object(S.b)().services,{data:d,refetch:b,isLoading:j,isFetching:p}=Object(Ze.useQuery)({queryKey:["loadRuleAggregationsWithKueryFilter",l.searchText,l.types,l.actionTypes,l.ruleExecutionStatuses,l.ruleLastRunOutcomes,l.ruleStatuses,l.tags,{refresh:null==n?void 0:n.toISOString()}],queryFn:()=>async function({http:e,searchText:t,typesFilter:s,actionTypesFilter:a,ruleExecutionStatusesFilter:l,ruleStatusesFilter:i,tagsFilter:n,filterConsumers:o}){const r=He({typesFilter:s,actionTypesFilter:a,tagsFilter:n,ruleExecutionStatusesFilter:l,ruleStatusesFilter:i,searchText:t}),u=await e.post(`${x.j}/rules/_aggregate`,{body:JSON.stringify({...r?{filter:JSON.stringify(r)}:{},filter_consumers:o,default_search_operator:"AND"})});return Object(et.a)(u)}({http:u,searchText:l.searchText,typesFilter:l.types,actionTypesFilter:l.actionTypes,ruleExecutionStatusesFilter:l.ruleExecutionStatuses,ruleLastRunOutcomesFilter:l.ruleLastRunOutcomes,ruleStatusesFilter:l.ruleStatuses,tagsFilter:l.tags,filterConsumers:r}),onError:()=>{c.addDanger(a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.unableToLoadRuleStatusInfoMessage",{defaultMessage:"Unable to load rule status info"}))},enabled:i,keepPreviousData:!0,cacheTime:0,refetchOnWindowFocus:!1}),g=d||{ruleExecutionStatus:tt(o.RuleExecutionStatusValues),ruleLastRunOutcome:tt(o.RuleLastRunOutcomeValues)};return{loadRuleAggregations:b,rulesStatusesTotal:null!==(t=g.ruleExecutionStatus)&&void 0!==t?t:{},rulesLastRunOutcomesTotal:null!==(s=g.ruleLastRunOutcome)&&void 0!==s?s:{},isLoading:j&&p}})({filterConsumers:e,filters:Qt,enabled:Wt,refresh:g}),{showSpinner:ss,showRulesList:as,showNoAuthPrompt:ls,showCreateFirstRulePrompt:is}=(({authorizedToReadAnyRules:e,authorizedToCreateAnyRules:t,filters:s,hasDefaultRuleTypesFiltersOn:a,isLoadingRuleTypes:i,isLoadingRules:n,isInitialLoadingRuleTypes:o,isInitialLoadingRules:r,hasData:u})=>{const c=(({hasEmptyTypesFilter:e,filters:t})=>!(e&&Object(l.isEmpty)(t.searchText)&&Object(l.isEmpty)(t.actionTypes)&&Object(l.isEmpty)(t.ruleExecutionStatuses)&&Object(l.isEmpty)(t.ruleLastRunOutcomes)&&Object(l.isEmpty)(t.ruleStatuses)&&Object(l.isEmpty)(t.tags)))({hasEmptyTypesFilter:!!a||Object(l.isEmpty)(s.types),filters:s}),d=!o&&!e,b=!(i||n)&&!u&&!c&&t,j=(o||r)&&(i||!d&&n);return{showSpinner:j,showRulesList:!j&&!b&&!d,showNoAuthPrompt:d,showCreateFirstRulePrompt:b}})({authorizedToReadAnyRules:Ut,authorizedToCreateAnyRules:_t,filters:Nt,hasDefaultRuleTypesFiltersOn:Ht,isLoadingRuleTypes:wt.isLoading,isLoadingRules:Vt.isLoading,hasData:Zt,isInitialLoadingRuleTypes:wt.initialLoad,isInitialLoadingRules:Vt.initialLoad}),ns=e=>{Ee(!0),ve(e)},os=Object(r.useCallback)((async()=>{if(!wt||!zt)return;const e=new Date;At(e),null==N||N(e),await Jt(),await Xt()}),[Jt,Xt,At,N,Le,zt,wt]),rs=Object(r.useMemo)((()=>wt.initialLoad?[]:Pe({rules:Vt.data,ruleTypeIndex:wt.data,canExecuteActions:X,config:Mt})),[wt,Vt.data,X,Mt]),{isAllSelected:us,selectedIds:cs,isPageSelected:ds,numberOfSelectedItems:bs,isRowSelected:js,getFilter:ps,onSelectRow:gs,onSelectAll:ms,onSelectPage:Os,onClearSelection:xs}=function(e){const{totalItemCount:t=0,items:s=[],typesFilter:a,actionTypesFilter:l,tagsFilter:i,ruleExecutionStatusesFilter:n,ruleLastRunOutcomesFilter:o,ruleStatusesFilter:u,searchText:c}=e,[d,b]=Object(r.useReducer)(Ve,{...We,selectedIds:new Set}),j=Object(r.useMemo)((()=>s.map((e=>e.id))),[s]),p=Object(r.useMemo)((()=>{const{selectedIds:e,isAllSelected:s}=d;return t?s?t-e.size:j.filter((t=>e.has(t))).length:0}),[d,j,t]),g=Object(r.useMemo)((()=>{const{selectedIds:e,isAllSelected:t}=d;return!!s.length&&s.every((s=>!s.isEditable||(t?!e.has(s.id):e.has(s.id))))}),[d,s]),m=Object(r.useCallback)((e=>{const{selectedIds:t,isAllSelected:s}=d;return!!e.isEditable&&(s?!t.has(e.id):t.has(e.id))}),[d]),O=Object(r.useCallback)((e=>{b({type:Qe.TOGGLE_ROW,payload:e.id})}),[]),x=Object(r.useCallback)((()=>{b({type:Qe.TOGGLE_SELECT_ALL,payload:!d.isAllSelected})}),[d]),f=Object(r.useCallback)((()=>{const{selectedIds:e,isAllSelected:t}=d;if(!g&&!t){const t=s.filter((e=>e.isEditable)).map((e=>e.id));b({type:Qe.SET_SELECTION,payload:[...e,...t]})}g&&!t&&(s.forEach((t=>e.delete(t.id))),b({type:Qe.SET_SELECTION,payload:[...e]})),!g&&t&&(s.forEach((t=>{t.isEditable&&e.delete(t.id)})),b({type:Qe.SET_SELECTION,payload:[...e]})),g&&t&&b({type:Qe.SET_SELECTION,payload:[...e,...j]})}),[d,g,s,j]),h=Object(r.useCallback)((()=>{b({type:Qe.CLEAR_SELECTION})}),[]),y=Object(r.useCallback)((e=>{const t=He({typesFilter:a,actionTypesFilter:l,tagsFilter:i,ruleExecutionStatusesFilter:n,ruleLastRunOutcomesFilter:o,ruleStatusesFilter:u,searchText:c});if(e&&e.length){const s=Object(W.fromKueryExpression)(`NOT (${e.map((e=>`alert.id: "alert:${e}"`)).join(" or ")})`);return t?W.nodeBuilder.and([t,s]):s}return t}),[a,l,i,n,o,u,c]),S=Object(r.useCallback)((()=>{const{selectedIds:e,isAllSelected:t}=d,s=[...e];return t?0===s.length?y():y(s):y()}),[d,y]);return Object(r.useMemo)((()=>({selectedIds:[...d.selectedIds],isAllSelected:d.isAllSelected,isPageSelected:g,numberOfSelectedItems:p,isRowSelected:m,getFilter:S,onSelectRow:O,onSelectAll:x,onSelectPage:f,onClearSelection:h})),[d,g,p,m,S,O,x,f,h])}({totalItemCount:Vt.totalItemCount,items:rs,...Nt,typesFilter:Kt}),fs=Object(r.useCallback)((e=>{const{filter:t,value:s}=e;switch(xs(),t){case"ruleStatuses":null==D||D(s);break;case"ruleExecutionStatuses":null==z||z(s);break;case"ruleLastRunOutcomes":null==P||P(s);break;case"ruleParams":null==U||U(s);break;case"searchText":null==_||_(s);break;case"types":null==B||B(s)}}),[D,z,P,_,B,xs]),hs=Object(r.useCallback)((e=>{Gt(e),fs(e)}),[Gt,fs]);Object(r.useEffect)((()=>{R&&hs({filter:"ruleStatuses",value:R})}),[R]),Object(r.useEffect)((()=>{s&&hs({filter:"ruleExecutionStatuses",value:s})}),[s]),Object(r.useEffect)((()=>{p&&hs({filter:"ruleLastRunOutcomes",value:p})}),[p]),Object(r.useEffect)((()=>{y&&!Object(l.isEqual)(y,Nt.ruleParams)&&hs({filter:"ruleParams",value:y})}),[y]),Object(r.useEffect)((()=>{"string"==typeof v&&hs({filter:"searchText",value:v})}),[v]),Object(r.useEffect)((()=>{M&&hs({filter:"types",value:M})}),[M]),Object(r.useEffect)((()=>{if(Re.current){const e=rs.find((e=>e.id===Re.current));Re.current=null,Ct(!1),e&&ns(e)}}),[rs]);const ys=e=>{var t,s;const a="error"===e.status,l=null==e||null===(t=e.error)||void 0===t?void 0:t.message,n=(null===(s=e.error)||void 0===s?void 0:s.reason)===o.RuleExecutionStatusErrorReasons.License?O.a:null;return[{title:Object(f.jsx)(i.FormattedMessage,{id:"xpack.triggersActionsUI.sections.rulesList.expandRow.title",defaultMessage:"Error from last run"}),description:Object(f.jsx)(u.a.Fragment,null,l,a&&n&&Object(f.jsx)(c.EuiSpacer,{size:"xs"}),n)}]},Ss=Object(r.useCallback)((()=>{Fe((e=>{if(e)Ie({});else{const e=Vt.data.reduce(((e,t)=>{var s;return(null===(s=t.lastRun)||void 0===s?void 0:s.outcome)===o.RuleLastRunOutcomeValues[2]||"error"===t.executionStatus.status?{...e,[t.id]:Object(f.jsx)(c.EuiDescriptionList,{listItems:ys(t.executionStatus)})}:e}),{});Ie(e)}return!e}))}),[Ce,Vt]),Es=Object(r.useCallback)((e=>Object(ne.a)({http:V,ids:[e.id]})),[ne.a]),Ts=Object(r.useCallback)((e=>Object(oe.a)({http:V,ids:[e.id]})),[oe.a]),vs=e=>{fe(e),hs({filter:"searchText",value:e})},ks=Object(l.sortBy)(Object.entries(Pt.reduce(((e,t)=>{const s=t.producer;return(e[s]=e[s]||[]).push({value:t.id,name:t.name}),e}),{}))).map((([e,t])=>{var s,a,i;return{groupName:null!==(a=e,s=null==J||null===(i=J.find((e=>e.id===a)))||void 0===i?void 0:i.name)&&void 0!==s?s:Object(l.capitalize)(e),subOptions:t.sort(((e,t)=>e.name.localeCompare(t.name)))}})),Is=Object(r.useMemo)((()=>!!us||!!cs.length&&ft(Vt.data,cs).every((e=>Object(ce.a)(e.consumer,wt.data.get(e.ruleTypeId))))),[cs,Vt.data,wt.data,us]),Cs=Object(r.useCallback)((({action:e,rules:t,filter:s})=>{Tt(e),t&&ht(t),s&&St(s),"delete"===e&&ws(t&&t.length>0||Boolean(s))}),[]),Fs=Object(r.useCallback)((()=>{"delete"===Et&&ws(!1),ht([]),St(void 0),Tt(void 0)}),[]),Rs=Ft||Vt.isLoading||wt.isLoading||vt||ee||$e||ut||It,Ls=async e=>{Ct(!0);try{const t=await Object(ue.a)({http:V,ruleId:e});Re.current=t.id,await Jt()}catch{Re.current=null,Ct(!1),Z.addDanger(a.i18n.translate("xpack.triggersActionsUI.sections.rulesList.cloneFailed",{defaultMessage:"Unable to clone rule"}))}},As=Object(r.useCallback)((()=>{ye(!0)}),[]);Object(r.useEffect)((()=>{null==G||G([..._t?[Object(f.jsx)(me,{openFlyout:As})]:[],Object(f.jsx)(ot.RulesSettingsLink,null),Object(f.jsx)(_e.a,null)])}),[_t]),Object(r.useEffect)((()=>()=>null==G?void 0:G()),[]);const[Ms,ws]=Object(r.useState)(!1),{showToast:zs}=Object(nt.a)({onSearchPopulate:vs}),Ps=async()=>{qe(!0);const{errors:e,total:t}=us?await Object(oe.a)({http:V,filter:ps()}):await Object(oe.a)({http:V,ids:cs});qe(!1);const s=e.find((e=>!!Object(o.parseRuleCircuitBreakerErrorMessage)(e.message).details));if(s){const e=Object(o.parseRuleCircuitBreakerErrorMessage)(s.message);Z.addDanger({title:e.summary,text:Object(n.toMountPoint)(Object(f.jsx)(it.a,null,e.details))})}else zs({action:"ENABLE",errors:e,total:t});await os(),xs()},Us=async()=>{gt(!0);const{errors:e,total:t}=us?await Object(ne.a)({http:V,filter:ps()}):await Object(ne.a)({http:V,ids:cs});gt(!1),zs({action:"DISABLE",errors:e,total:t}),await os(),xs()},_s=xt.length||bs;return Object(f.jsx)(u.a.Fragment,null,F&&!Object(l.isEmpty)(Nt.ruleParams)?Object(f.jsx)(xe,{onClickClearFilter:()=>hs({filter:"ruleParams",value:{}})}):null,Object(f.jsx)(j.c,{kibanaServices:K,categories:e}),Object(f.jsx)(ge,{showNoAuthPrompt:ls,showCreateFirstRulePrompt:is,showCreateRuleButtonInPrompt:C,showSpinner:ss,onCreateRulesClick:As}),Object(f.jsx)(c.EuiPageTemplate.Section,{"data-test-subj":"rulesList",grow:!1,paddingSize:"none"},Ms&&Object(f.jsx)(de.a,{onConfirm:async()=>{if("delete"!==Et)return;ws(!1),kt(!0);const e=us&&yt?{filter:yt,http:V}:{ids:xt.map((e=>e.id)),http:V},{errors:t,total:s}=await Object(re.a)(e);kt(!1),zs({action:"DELETE",errors:t,total:s}),Fs(),xs(),os()},onCancel:()=>{ws(!1),Fs()},confirmButtonText:Object(O.y)(_s,O.w,O.f),confirmModalText:Object(O.z)(_s,O.w,O.f)}),Object(f.jsx)(Ge,{rules:xt,filter:yt,bulkEditAction:Et,numberOfSelectedRules:bs,setIsBulkEditing:kt,onClose:()=>{ht([]),St(void 0)},onSave:async()=>{Fs(),xs(),await os()},onSearchPopulate:vs}),Object(f.jsx)(Ke,{rules:xt,filter:yt,bulkEditAction:Et,numberOfSelectedRules:bs,setIsBulkEditing:kt,onClose:()=>{ht([]),St(void 0)},onSave:async()=>{Fs(),xs(),await os()},onSearchPopulate:vs}),"updateApiKey"===Et&&Object(f.jsx)(De.a,{onCancel:()=>{Fs()},rulesToUpdate:xt,idsToUpdateFilter:yt,numberOfSelectedRules:bs,apiUpdateApiKeyCall:ie.a,setIsLoadingState:e=>{kt(e),Rt(e)},onUpdated:async()=>{Fs(),xs(),await os()},onSearchPopulate:vs}),Object(f.jsx)(c.EuiSpacer,{size:"xs"}),as&&Object(f.jsx)(u.a.Fragment,null,F?Object(f.jsx)(u.a.Fragment,null,Object(f.jsx)(se,{actionTypes:Bt,filterOptions:ks,filters:Nt,inputText:pe,lastUpdate:Yt,rulesLastRunOutcomesTotal:ts,rulesStatusesTotal:es,setInputText:fe,showActionFilter:k,showErrors:Ce,canLoadRules:Wt,refresh:g||Lt,updateFilters:hs,onClearSelection:xs,onRefreshRules:os,onToggleRuleErrors:Ss}),Object(f.jsx)(c.EuiSpacer,{size:"s"})):null,Object(f.jsx)(Ue,{items:rs,isLoading:Rs,rulesState:Vt,ruleTypesState:wt,ruleTypeRegistry:Y,isPageSelected:ds,isAllSelected:us,numberOfSelectedRules:bs,sort:we,page:be,percentileOptions:Ae,itemIdToExpandedRowMap:ke,onSort:ze,onPage:je,onRuleChanged:os,onRuleClick:e=>{const t=m||b.Ab;q.push(t.replace(":ruleId",e.id))},onRuleEditClick:e=>{var t;e.isEditable&&(t=e.ruleTypeId,Y.has(t)&&!Y.get(t).requiresAppContext)&&ns(e)},onRuleDeleteClick:e=>Cs({action:"delete",rules:[e]}),onManageLicenseClick:e=>{var t;return Ne({licenseType:null===(t=wt.data.get(e.ruleTypeId))||void 0===t?void 0:t.minimumLicenseRequired,ruleTypeId:e.ruleTypeId})},onPercentileOptionsChange:Me,onDisableRule:Es,onEnableRule:Ts,onSnoozeRule:(e,t)=>Object(ae.b)({http:V,id:e.id,snoozeSchedule:t}),onUnsnoozeRule:(e,t)=>Object(le.b)({http:V,id:e.id,scheduleIds:t}),onSelectAll:ms,onSelectPage:Os,onSelectRow:gs,isRowSelected:js,renderCollapsedItemActions:(e,t)=>Object(f.jsx)(L,{key:e.id,item:e,onLoading:t,onRuleChanged:os,onDeleteRule:()=>Cs({action:"delete",rules:[e]}),onEditRule:()=>ns(e),onUpdateAPIKey:()=>Cs({action:"updateApiKey",rules:[e]}),onRunRule:()=>(async e=>{await Object(Je.a)(V,Z,e)})(e.id),onCloneRule:Ls}),renderRuleError:e=>{var t;const s=e.executionStatus,a="error"===s.status;return(null===(t=s.error)||void 0===t?void 0:t.reason)===o.RuleExecutionStatusErrorReasons.License||a?Object(f.jsx)(c.EuiButtonIcon,{onClick:()=>((e,t)=>{Ie((s=>{const a={...s};return a[t.id]?delete a[t.id]:a[t.id]=Object(f.jsx)(c.EuiDescriptionList,{listItems:ys(e)}),a}))})(s,e),"aria-label":ke[e.id]?"Collapse":"Expand",iconType:ke[e.id]?"arrowUp":"arrowDown"}):null},renderSelectAllDropdown:()=>Object(f.jsx)(h,{numberOfSelectedRules:bs,canModifySelectedRules:Is},Object(f.jsx)(E,{selectedItems:Pe({rules:ft(Vt.data,cs),ruleTypeIndex:wt.data,canExecuteActions:X,config:Mt}),isBulkEditing:vt,bulkEditAction:Et,updateRulesToBulkEdit:Cs,isAllSelected:us,getFilter:ps,onPerformingAction:()=>te(!0),onActionPerformed:()=>{os(),te(!1)},isEnablingRules:$e,isDisablingRules:ut,onEnable:Ps,onDisable:Us})),rulesListKey:T,config:Mt,visibleColumns:w,numberOfFilters:$t,resetFilters:qt}),Be&&Object(f.jsx)(Oe,{licenseType:Be.licenseType,ruleTypeId:Be.ruleTypeId,onConfirm:()=>{window.open(`${V.basePath.get()}/app/management/stack/license_management`,"_blank"),Ne(null)},onCancel:()=>Ne(null)})),he&&Object(f.jsx)(r.Suspense,{fallback:Object(f.jsx)("div",null)},Object(f.jsx)(jt,{consumer:o.ALERTS_FEATURE_ID,onClose:()=>{ye(!1)},actionTypeRegistry:H,ruleTypeRegistry:Y,ruleTypeIndex:wt.data,onSave:os,initialSelectedConsumer:$})),Se&&Te&&Object(f.jsx)(r.Suspense,{fallback:Object(f.jsx)("div",null)},Object(f.jsx)(pt,{initialRule:Te,onClose:()=>{Ee(!1)},actionTypeRegistry:H,ruleTypeRegistry:Y,ruleType:wt.data.get(Te.ruleTypeId),onSave:os}))))};function ft(e,t){return e.filter((e=>t.includes(e.id)))}},129:function(e,t,s){"use strict";s.d(t,"a",(function(){return c}));var a=s(2),l=s(1),i=s.n(l),n=s(3),o=s(0);const r=a.i18n.translate("xpack.triggersActionsUI.components.toastWithCircuitBreaker.seeFullError",{defaultMessage:"See full error"}),u=a.i18n.translate("xpack.triggersActionsUI.components.toastWithCircuitBreaker.hideFullError",{defaultMessage:"Hide full error"}),c=({children:e})=>{const[t,s]=Object(l.useState)(!1),a=Object(l.useCallback)((()=>{s((e=>!e))}),[]);return Object(o.jsx)(i.a.Fragment,null,t&&Object(o.jsx)(i.a.Fragment,null,Object(o.jsx)(n.EuiText,{size:"s"},e),Object(o.jsx)(n.EuiSpacer,null)),Object(o.jsx)(n.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(o.jsx)(n.EuiFlexItem,{grow:!1},Object(o.jsx)(n.EuiButton,{size:"s",color:"danger",onClick:a},t?u:r))))}},141:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s.d(t,"b",(function(){return r}));var a=s(32),l=s.n(a),i=s(11),n=s(12);function o(e){if(!e)return"00:00:00.000";const t=l.a.duration(e);return`${[t.hours(),t.minutes(),t.seconds()].map((e=>Object(i.padStart)(`${e}`,2,"0"))).join(":")}.${Object(i.padStart)(`${t.milliseconds()}`,3,"0")}`}function r(e,t){if(!e||!e.ruleTaskTimeout)return!1;const s=e.ruleTaskTimeout;return t>Object(n.parseDuration)(s)}},155:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));const a=[]},171:function(e,t,s){"use strict";s.d(t,"a",(function(){return n}));var a=s(11),l=s(2);const i=e=>({isEnabled:!1,message:l.i18n.translate("xpack.triggersActionsUI.checkRuleTypeEnabled.ruleTypeDisabledByLicenseMessage",{defaultMessage:"This rule type requires a {minimumLicenseRequired} license.",values:{minimumLicenseRequired:Object(a.upperFirst)(e.minimumLicenseRequired)}})});function n(e){return!1===(null==e?void 0:e.enabledInLicense)?i(e):{isEnabled:!0}}},176:function(e,t,s){"use strict";s.d(t,"c",(function(){return o})),s.d(t,"a",(function(){return r})),s.d(t,"b",(function(){return u}));var a=s(32),l=s.n(a),i=s(36),n=s.n(i);function o(e){return`${n()(100*e).format("0,0")}%`}function r(e){if(!e)return"00:00";const t=l.a.duration(e);let s=Math.floor(t.asMinutes()),a=t.seconds();return t.milliseconds()>=500&&(a+=1,60===a&&(a=0,s+=1)),`${s.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}function u(e){return`${n()(e).format("0,0")} ms`}},211:function(e,t,s){"use strict";s.d(t,"a",(function(){return o}));var a=s(1),l=s(3),i=s(176),n=s(0);const o=Object(a.memo)((e=>{const{duration:t,allowZero:s=!0}=e,o=Object(a.useMemo)((()=>s||"number"==typeof t?Object(i.a)(t):"N/A"),[t,s]),r=Object(a.useMemo)((()=>s||"number"==typeof t?Object(i.b)(t):"N/A"),[t,s]);return Object(n.jsx)(l.EuiToolTip,{"data-test-subj":"rule-duration-format-tooltip",content:r},Object(n.jsx)("span",{"data-test-subj":"rule-duration-format-value"},o))}))},213:function(e,t,s){"use strict";s.d(t,"a",(function(){return o})),s(1);var a=s(26),l=s(3),i=s(30),n=s(0);const o=()=>{const{docLinks:e}=Object(i.b)().services;return Object(n.jsx)(l.EuiButtonEmpty,{href:e.links.alerting.guide,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(n.jsx)(a.FormattedMessage,{id:"xpack.triggersActionsUI.home.docsLinkText",defaultMessage:"Documentation"}))}},276:function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(277);case"v8light":return s(279)}},277:function(e,t,s){var a=s(50),l=s(278);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},278:function(e,t,s){(t=s(51)(!1)).push([e.i,".actBulkActionPopover__deleteAll .euiButtonEmpty__text{padding-top:4px}",""]),e.exports=t},279:function(e,t,s){var a=s(50),l=s(280);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},280:function(e,t,s){(t=s(51)(!1)).push([e.i,".actBulkActionPopover__deleteAll .euiButtonEmpty__text{padding-top:4px}",""]),e.exports=t},281:function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(282);case"v8light":return s(284)}},282:function(e,t,s){var a=s(50),l=s(283);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},283:function(e,t,s){(t=s(51)(!1)).push([e.i,".collapsedItemActions__deleteButton{color:#f86b63}",""]),e.exports=t},284:function(e,t,s){var a=s(50),l=s(285);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},285:function(e,t,s){(t=s(51)(!1)).push([e.i,".collapsedItemActions__deleteButton{color:#bd271e}",""]),e.exports=t},286:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(90),l=s(1),i=a.__importDefault(s(287));t.default=function(e,t){void 0===t&&(t=[]);var s=i.default(e,t,{loading:!0}),a=s[0],n=s[1];return l.useEffect((function(){n()}),[n]),a}},287:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(90),l=s(1),i=a.__importDefault(s(288));t.default=function(e,t,s){void 0===t&&(t=[]),void 0===s&&(s={loading:!1});var n=l.useRef(0),o=i.default(),r=l.useState(s),u=r[0],c=r[1],d=l.useCallback((function(){for(var t=[],s=0;s<arguments.length;s++)t[s]=arguments[s];var l=++n.current;return c((function(e){return a.__assign(a.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return o()&&l===n.current&&c({value:e,loading:!1}),e}),(function(e){return o()&&l===n.current&&c({error:e,loading:!1}),e}))}),t);return[u,d]}},288:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(1);t.default=function(){var e=a.useRef(!1),t=a.useCallback((function(){return e.current}),[]);return a.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},289:function(e,t,s){switch(window.__kbnThemeTag__){case"v8dark":return s(290);case"v8light":return s(292)}},290:function(e,t,s){var a=s(50),l=s(291);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},291:function(e,t,s){(t=s(51)(!1)).push([e.i,".actRulesList__tableRowDisabled{background-color:#25262e}.actRulesList__tableRowDisabled .actRulesList__tableCellDisabled{color:#98a2b3}.euiTableRow:focus-within .ruleSidebarItem__action,.euiTableRow:hover .ruleSidebarItem__action,.euiTableRow[class*=-isActive] .ruleSidebarItem__action{opacity:1}.ruleSidebarItem__action{opacity:0}.ruleSidebarItem__action.ruleSidebarItem__mobile,.ruleSidebarItem__action:focus{opacity:1}.ruleDurationWarningIcon{margin-bottom:4px;margin-left:8px}.ruleDisabledQuestionIcon{bottom:4px;margin-left:4px;position:relative}",""]),e.exports=t},292:function(e,t,s){var a=s(50),l=s(293);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);a(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},293:function(e,t,s){(t=s(51)(!1)).push([e.i,".actRulesList__tableRowDisabled{background-color:#f5f7fa}.actRulesList__tableRowDisabled .actRulesList__tableCellDisabled{color:#69707d}.euiTableRow:focus-within .ruleSidebarItem__action,.euiTableRow:hover .ruleSidebarItem__action,.euiTableRow[class*=-isActive] .ruleSidebarItem__action{opacity:1}.ruleSidebarItem__action{opacity:0}.ruleSidebarItem__action.ruleSidebarItem__mobile,.ruleSidebarItem__action:focus{opacity:1}.ruleDurationWarningIcon{margin-bottom:4px;margin-left:8px}.ruleDisabledQuestionIcon{bottom:4px;margin-left:4px;position:relative}",""]),e.exports=t},294:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(1),l=s(149),i=function(){};t.default=function(e,t,s){if(!l.isClient)return[t,i,i];if(!e)throw new Error("useLocalStorage key may not be falsy");var n=s?s.raw?function(e){return e}:s.deserializer:JSON.parse,o=a.useState((function(){try{var a=s?s.raw?String:s.serializer:JSON.stringify,l=localStorage.getItem(e);return null!==l?n(l):(t&&localStorage.setItem(e,a(t)),t)}catch(e){return t}})),r=o[0],u=o[1],c=a.useCallback((function(t){try{var a="function"==typeof t?t(r):t;if(void 0===a)return;var l;l=s?s.raw?"string"==typeof a?a:JSON.stringify(a):s.serializer?s.serializer(a):JSON.stringify(a):JSON.stringify(a),localStorage.setItem(e,l),u(n(l))}catch(e){}}),[e,u]),d=a.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[r,c,d]}},98:function(e,t,s){"use strict";s.r(t),s.d(t,"RuleStatusDropdown",(function(){return O})),s.d(t,"futureTimeToInterval",(function(){return f})),s.d(t,"default",(function(){return O}));var a=s(1),l=s.n(a),i=s(32),n=s.n(i),o=s(2),r=s(21),u=s(12),c=s(3),d=s(30),b=s(133),j=s(17),p=s(129),g=s(0);const m="LL @ LT",O=({rule:e,onRuleChanged:t,disableRule:s,enableRule:l,snoozeRule:i,unsnoozeRule:o,isEditable:b,hideSnoozeOption:O=!1,direction:f="column"})=>{const[E,k]=Object(a.useState)(e.enabled),[I,C]=Object(a.useState)(!O&&Object(j.d)(e)),{notifications:{toasts:F}}=Object(d.b)().services;Object(a.useEffect)((()=>{k(e.enabled)}),[e.enabled]),Object(a.useEffect)((()=>{O||C(Object(j.d)(e))}),[e,O]);const[R,L]=Object(a.useState)(!1),[A,M]=Object(a.useState)(!1),w=Object(a.useCallback)((()=>M((e=>!e))),[M]),z=Object(a.useCallback)((()=>M(!1)),[M]),P=Object(a.useCallback)((async()=>{const{errors:e}=await l();if(!e.length)return;const t=Object(u.parseRuleCircuitBreakerErrorMessage)(e[0].message);throw F.addDanger({title:t.summary,...t.details&&{text:Object(r.toMountPoint)(Object(g.jsx)(p.a,null,t.details))}}),new Error}),[l,F]),U=Object(a.useCallback)((async a=>{if(e.enabled!==a){L(!0);try{a?await P():await s(),k(!E),t()}finally{L(!1)}}}),[e.enabled,E,t,P,s]),_=Object(a.useCallback)((async e=>{try{await i(e),t()}finally{z()}}),[i,t,z]),D=Object(a.useCallback)((async e=>{try{await o(e),t()}finally{z()}}),[o,t,z]),B=E?I?"warning":"primary":"default",N=E?I?S:h:y,G=E&&I?Object(g.jsx)(c.EuiToolTip,{content:e.muteAll?v:n()(new Date(e.isSnoozedUntil)).format(m)},Object(g.jsx)(c.EuiText,{color:"subdued",size:"xs"},e.muteAll?v:n()(new Date(e.isSnoozedUntil)).fromNow(!0))):null,$=Object(g.jsx)(c.EuiBadge,{color:B,"data-test-subj":"statusDropdownReadonly"},N),q=Object(g.jsx)(c.EuiBadge,{color:B,iconSide:"right",iconType:!R&&b?"arrowDown":void 0,onClick:w,iconOnClick:w,onClickAriaLabel:T,iconOnClickAriaLabel:T,isDisabled:R},N,R&&Object(g.jsx)(c.EuiLoadingSpinner,{style:{marginLeft:"4px",marginRight:"4px"},size:"s"}));return Object(g.jsx)(c.EuiFlexGroup,{direction:f,alignItems:"row"===f?"center":"flexStart",justifyContent:"flexStart",gutterSize:"row"===f?"s":"xs",responsive:!1},Object(g.jsx)(c.EuiFlexItem,{grow:!1},b?Object(g.jsx)(c.EuiPopover,{button:q,isOpen:A&&b,closePopover:z,panelPaddingSize:"s","data-test-subj":"statusDropdown",title:N},Object(g.jsx)(x,{onClosePopover:z,onChangeEnabledStatus:U,isEnabled:E,isSnoozed:I,snoozeEndTime:e.isSnoozedUntil,hideSnoozeOption:O,snoozeRule:_,unsnoozeRule:D,scheduledSnoozes:e.snoozeSchedule,activeSnoozes:e.activeSnoozes})):$),Object(g.jsx)(c.EuiFlexItem,{"data-test-subj":"remainingSnoozeTime",grow:!1},G))},x=({onChangeEnabledStatus:e,onClosePopover:t,isEnabled:s,isSnoozed:i,snoozeEndTime:o,hideSnoozeOption:r=!1,snoozeRule:u,unsnoozeRule:d,scheduledSnoozes:j=[],activeSnoozes:p=[]})=>{const O=Object(a.useCallback)((()=>{i?d():e(!0),t()}),[e,t,d,i]),x=Object(a.useCallback)((()=>{e(!1),t()}),[e,t]);let S=Object(g.jsx)(c.EuiText,{size:"s"},E);i&&o&&(S=Object(g.jsx)(l.a.Fragment,null,Object(g.jsx)(c.EuiText,{size:"s"},E)," ",Object(g.jsx)(c.EuiText,{size:"xs",color:"subdued"},n()(o).format(m))));const T=[{id:0,width:360,items:[{name:h,icon:s&&!i?"check":"empty",onClick:O,"data-test-subj":"statusDropdownEnabledItem"},{name:y,icon:s?"empty":"check",onClick:x,"data-test-subj":"statusDropdownDisabledItem"},...r?[]:[{name:S,icon:s&&i?"check":"empty",panel:1,disabled:!s,"data-test-subj":"statusDropdownSnoozeItem"}]]},...r?[]:[{id:1,width:400,title:E,content:Object(g.jsx)(c.EuiPanel,{paddingSize:"none",hasShadow:!1},Object(g.jsx)(b.a,{interval:f(o),showCancel:i,snoozeRule:u,unsnoozeRule:d,scheduledSnoozes:j,activeSnoozes:p,hasTitle:!1}))}]];return Object(g.jsx)(c.EuiContextMenu,{"data-test-subj":"ruleStatusMenu",initialPanelId:0,panels:T})},f=e=>{if(!e)return;const t=n()(e).locale("en").fromNow(!0),[s,a]=t.split(" ");let l,i="a"===s||"an"===s?1:parseInt(s,10);switch(a){case"year":case"years":l="M",i*=12;break;case"month":case"months":l="M";break;case"day":case"days":l="d";break;case"hour":case"hours":l="h";break;case"minute":case"minutes":l="m"}return l?`${i}${l}`:void 0},h=o.i18n.translate("xpack.triggersActionsUI.sections.rulesList.enabledRuleStatus",{defaultMessage:"Enabled"}),y=o.i18n.translate("xpack.triggersActionsUI.sections.rulesList.disabledRuleStatus",{defaultMessage:"Disabled"}),S=o.i18n.translate("xpack.triggersActionsUI.sections.rulesList.snoozedRuleStatus",{defaultMessage:"Snoozed"}),E=o.i18n.translate("xpack.triggersActionsUI.sections.rulesList.snoozeMenuTitle",{defaultMessage:"Snooze"}),T=o.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusDropdownMenuLabel",{defaultMessage:"Change rule status or snooze"}),v=o.i18n.translate("xpack.triggersActionsUI.sections.rulesList.remainingSnoozeIndefinite",{defaultMessage:"Indefinitely"})},99:function(e,t,s){"use strict";s.r(t),s.d(t,"RuleStatusFilter",(function(){return u})),s.d(t,"default",(function(){return u}));var a=s(1),l=s(26),i=s(3),n=s(0);const o=["enabled","disabled","snoozed"],r=e=>`ruleStatusFilterOption-${e}`,u=e=>{const{selectedStatuses:t=[],dataTestSubj:s="ruleStatusFilter",selectDataTestSubj:u="ruleStatusFilterSelect",buttonDataTestSubj:c="ruleStatusFilterButton",optionDataTestSubj:d=r,onChange:b=(()=>{})}=e,[j,p]=Object(a.useState)(!1),g=Object(a.useCallback)((e=>()=>{t.includes(e)?b(t.filter((t=>t!==e))):b([...t,e])}),[t,b]),m=Object(a.useCallback)((()=>{p((e=>!e))}),[p]);return Object(n.jsx)(i.EuiFilterGroup,{"data-test-subj":s},Object(n.jsx)(i.EuiPopover,{isOpen:j,closePopover:()=>p(!1),button:Object(n.jsx)(i.EuiFilterButton,{"data-test-subj":c,iconType:"arrowDown",hasActiveFilters:t.length>0,numActiveFilters:t.length,numFilters:t.length,onClick:m},Object(n.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleDetails.ruleStateFilterButton",defaultMessage:"Rule state"}))},Object(n.jsx)("div",{"data-test-subj":u},o.map((e=>Object(n.jsx)(i.EuiSelectableListItem,{key:e,"data-test-subj":d(e),onClick:g(e),checked:t.includes(e)?"on":void 0},(e=>"enabled"===e?Object(n.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleDetails.ruleStateFilter.enabledOptionText",defaultMessage:"Rule is enabled"}):"disabled"===e?Object(n.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleDetails.ruleStateFilter.disabledOptionText",defaultMessage:"Rule is disabled"}):"snoozed"===e?Object(n.jsx)(l.FormattedMessage,{id:"xpack.triggersActionsUI.sections.ruleDetails.ruleStateFilter.snoozedOptionText",defaultMessage:"Rule has snoozed"}):void 0)(e)))))))}}}]);