/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[22,41,48],{107:function(e,t,n){"use strict";n.r(t),n.d(t,"RuleEventLogList",(function(){return T})),n.d(t,"default",(function(){return T}));var s=n(1),r=n.n(s),a=n(3),i=n(2),u=n(30),l=n(52),o=n(26),c=n(65),d=n(7),g=n(11),p=n(32),m=n.n(p),f=n(141),b=n(0);const h=[120,60,30,15].map((e=>({value:e,text:i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.numberOfExecutionsOption",{defaultMessage:"{value} runs",values:{value:e}})}))),x=({executionDuration:e,numberOfExecutions:t,onChangeDuration:n,isLoading:u})=>{const l=function(e,t){const n=Object.entries(e);return n.length===t?n:n.length<t?Object(g.assign)(Object(g.fill)(new Array(t),[null,null]),n):n.slice(-t)}(e.valuesWithTimestamp,t),p=Object(s.useCallback)((({target:e})=>n(Number(e.value))),[n]);return Object(b.jsx)(a.EuiPanel,{"data-test-subj":"executionDurationChartPanel",hasBorder:!0},Object(b.jsx)(a.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(b.jsx)(a.EuiFlexItem,{grow:!1},Object(b.jsx)(a.EuiTitle,{size:"xxs"},Object(b.jsx)("h4",null,Object(b.jsx)(o.FormattedMessage,{id:"xpack.triggersActionsUI.sections.executionDurationChart.recentDurationsTitle",defaultMessage:"Recent run durations"})))),Object(b.jsx)(a.EuiFlexGroup,{justifyContent:"flexEnd"},Object(b.jsx)(a.EuiFlexItem,{grow:!1},Object(b.jsx)(a.EuiSelect,{id:"select-number-execution-durations","data-test-subj":"executionDurationChartPanelSelect",options:h,value:t,"aria-label":i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.selectNumberOfExecutionDurationsLabel",{defaultMessage:"Select number of runs"}),onChange:p})))),u&&Object(b.jsx)(a.EuiFlexGroup,{justifyContent:"center"},Object(b.jsx)(a.EuiFlexItem,{grow:!1,style:{height:"80px",justifyContent:"center"}},Object(b.jsx)(a.EuiLoadingChart,{size:"xl"}))),!u&&(e.valuesWithTimestamp&&Object.entries(e.valuesWithTimestamp).length>0?Object(b.jsx)(r.a.Fragment,null,Object(b.jsx)(d.Chart,{"data-test-subj":"executionDurationChart",size:{height:80}},Object(b.jsx)(d.Settings,{theme:{lineSeriesStyle:{point:{visible:!1},line:{stroke:c.euiLightVars.euiColorAccent}}},locale:i.i18n.getLocale()}),Object(b.jsx)(d.BarSeries,{id:"executionDuration",name:i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.durationLabel",{defaultMessage:"Duration"}),xScaleType:"linear",yScaleType:"linear",xAccessor:0,yAccessors:[1],data:l.map((([e,t],n)=>[e?m()(e).format("D MMM YYYY @ HH:mm:ss"):n,t])),minBarHeight:2}),Object(b.jsx)(d.LineSeries,{id:"rule_duration_avg",name:i.i18n.translate("xpack.triggersActionsUI.sections.executionDurationChart.avgDurationLabel",{defaultMessage:"Avg Duration"}),xScaleType:"linear",yScaleType:"linear",xAccessor:0,yAccessors:[1],data:l.map((([t,n],s)=>[t?m()(t).format("D MMM YYYY @ HH:mm:ss"):s,n?e.average:null])),curve:d.CurveType.CURVE_NATURAL}),Object(b.jsx)(d.Axis,{id:"left-axis",position:"left",tickFormat:e=>Object(f.a)(e)}))):Object(b.jsx)(r.a.Fragment,null,Object(b.jsx)(a.EuiEmptyPrompt,{"data-test-subj":"executionDurationChartEmpty",body:Object(b.jsx)(r.a.Fragment,null,Object(b.jsx)("p",null,Object(b.jsx)(o.FormattedMessage,{id:"xpack.triggersActionsUI.sections.executionDurationChart.executionDurationNoData",defaultMessage:"There is no available run duration information for this rule."})))}))))};var j=n(120);const O=60,y=i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.alertsList.ruleTypeExcessDurationMessage",{defaultMessage:"Duration exceeds the rule's expected run time."}),S=Object(j.a)((e=>{const{ruleId:t,ruleType:n,ruleSummary:r,refreshToken:o,fetchRuleSummary:c=!1,numberOfExecutions:d=O,onChangeDuration:g,loadRuleSummary:p,isLoadingRuleSummary:m=!1}=e,{notifications:{toasts:h}}=Object(u.b)().services,{euiTheme:j}=Object(a.useEuiTheme)(),S=Object(s.useRef)(!1),[I,k]=Object(s.useState)(null),[E,T]=Object(s.useState)(O),[A,v]=Object(s.useState)(!1),_=Object(s.useMemo)((()=>c?I:r),[c,r,I]),U=Object(s.useMemo)((()=>c?E:d),[c,d,E]),L=Object(s.useMemo)((()=>c?A:m),[c,m,A]),w=Object(s.useCallback)((e=>{T(e)}),[T]),M=Object(s.useMemo)((()=>c?w:g||w),[c,g,w]),R=async()=>{if(c){v(!0);try{const e=await p(t,U);k(e)}catch(e){h.addDanger({title:i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.ruleExecutionSummaryAndChart.loadSummaryError",{defaultMessage:"Unable to load rule summary: {message}",values:{message:e.message}})})}v(!1)}};Object(s.useEffect)((()=>{R()}),[t,U]),Object(s.useEffect)((()=>{S.current&&R(),S.current=!0}),[o]);const D=Object(s.useMemo)((()=>!!_&&Object(f.b)(n,_.executionDuration.average)),[n,_]);return _?Object(b.jsx)(a.EuiFlexGroup,null,Object(b.jsx)(a.EuiFlexItem,{grow:1},Object(b.jsx)(a.EuiPanel,{"data-test-subj":"avgExecutionDurationPanel",color:D?"warning":"subdued",hasBorder:!1},Object(b.jsx)(a.EuiText,{size:"s",color:"text"},i.i18n.translate("xpack.triggersActionsUI.sections.ruleDetails.alertsList.avgDurationDescription",{defaultMessage:"Average duration"})),Object(b.jsx)(a.EuiFlexGroup,{gutterSize:"xs",style:{alignItems:"center"}},D&&Object(b.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"ruleDurationWarning"},Object(b.jsx)(a.EuiIconTip,{anchorClassName:"ruleDurationWarningIcon",type:"warning",color:"warning",content:y,"aria-label":y,position:"top",size:"m"})),Object(b.jsx)(a.EuiFlexItem,{grow:!1,"data-test-subj":"ruleEventLogListAvgDuration"},Object(b.jsx)(a.EuiText,{size:"m",color:j.colors.text},Object(b.jsx)("strong",null,Object(f.a)(_.executionDuration.average))))))),Object(b.jsx)(a.EuiFlexItem,{grow:2},Object(b.jsx)(x,{executionDuration:_.executionDuration,numberOfExecutions:U,onChangeDuration:M,isLoading:L}))):Object(b.jsx)(l.a,null)}));var I=n(216);const k="xpack.triggersActionsUI.ruleEventLogList.initialColumns",E={minHeight:400},T=e=>{const{ruleId:t,ruleType:n,localStorageKey:s=k,refreshToken:r,requestRefresh:i,fetchRuleSummary:u=!0}=e,{ruleSummary:l,numberOfExecutions:o,onChangeDuration:c,isLoadingRuleSummary:d=!1}=e;return Object(b.jsx)("div",{style:E,"data-test-subj":"ruleEventLogListContainer"},Object(b.jsx)(a.EuiSpacer,null),Object(b.jsx)(S,{ruleId:t,ruleType:n,ruleSummary:l,numberOfExecutions:o,isLoadingRuleSummary:d,refreshToken:r,onChangeDuration:c,requestRefresh:i,fetchRuleSummary:u}),Object(b.jsx)(a.EuiSpacer,null),Object(b.jsx)(I.a,{localStorageKey:s,ruleId:t,refreshToken:r}))}},118:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const s=({message:e,outcomeFilter:t,runId:n,ruleTypeIds:s})=>{const r=[];if(e){const t=e.replace(/([\)\(\<\>\}\{\"\:\\])/gm,"\\$&");r.push(`(message: "${t}" OR error.message: "${t}")`)}if(t&&t.length){const e=function(e){const t={failure:"event.outcome: failure",warning:"kibana.alerting.outcome: warning",success:"kibana.alerting.outcome:success OR (event.outcome: success AND NOT kibana.alerting.outcome:*)",unknown:"event.outcome: unknown"};return`${e.map((e=>t[e])).join(" OR ")}`}(t);e&&r.push(`(${e})`)}return n&&r.push(`kibana.alert.rule.execution.uuid: ${n}`),null!=s&&s.length&&r.push(`kibana.alert.rule.rule_type_id:(${s.join(" or ")})`),r}},119:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return o})),n.d(t,"i",(function(){return d})),n.d(t,"k",(function(){return g})),n.d(t,"g",(function(){return p})),n.d(t,"L",(function(){return m})),n.d(t,"K",(function(){return f})),n.d(t,"J",(function(){return v})),n.d(t,"M",(function(){return _})),n.d(t,"t",(function(){return U})),n.d(t,"v",(function(){return L})),n.d(t,"x",(function(){return w})),n.d(t,"s",(function(){return M})),n.d(t,"u",(function(){return R})),n.d(t,"e",(function(){return D})),n.d(t,"m",(function(){return C})),n.d(t,"n",(function(){return $})),n.d(t,"r",(function(){return F})),n.d(t,"o",(function(){return N})),n.d(t,"p",(function(){return z})),n.d(t,"q",(function(){return P})),n.d(t,"j",(function(){return W})),n.d(t,"l",(function(){return J})),n.d(t,"h",(function(){return H})),n.d(t,"w",(function(){return B})),n.d(t,"f",(function(){return q})),n.d(t,"c",(function(){return Y})),n.d(t,"d",(function(){return G})),n.d(t,"z",(function(){return K})),n.d(t,"y",(function(){return Q})),n.d(t,"G",(function(){return V})),n.d(t,"I",(function(){return X})),n.d(t,"H",(function(){return Z})),n.d(t,"A",(function(){return ee})),n.d(t,"C",(function(){return te})),n.d(t,"B",(function(){return ne})),n.d(t,"D",(function(){return se})),n.d(t,"F",(function(){return re})),n.d(t,"E",(function(){return ae}));var s=n(2);const r=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusOk",{defaultMessage:"Ok"}),a=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusActive",{defaultMessage:"Active"}),i=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusError",{defaultMessage:"Error"}),u=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusLicenseError",{defaultMessage:"License Error"}),l=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusPending",{defaultMessage:"Pending"}),o=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusUnknown",{defaultMessage:"Unknown"}),c=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleStatusWarning",{defaultMessage:"Warning"}),d=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleLastRunOutcomeSucceeded",{defaultMessage:"Succeeded"}),g=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleLastRunOutcomeWarning",{defaultMessage:"Warning"}),p=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleLastRunOutcomeFailed",{defaultMessage:"Failed"}),m={ok:r,active:a,error:i,pending:l,unknown:o,warning:c},f={succeeded:d,warning:g,failed:p},b=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonUnknown",{defaultMessage:"An error occurred for unknown reasons."}),h=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonReading",{defaultMessage:"An error occurred when reading the rule."}),x=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonDecrypting",{defaultMessage:"An error occurred when decrypting the rule."}),j=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonRunning",{defaultMessage:"An error occurred when running the rule."}),O=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonLicense",{defaultMessage:"Cannot run rule"}),y=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonTimeout",{defaultMessage:"Rule execution cancelled due to timeout."}),S=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonDisabled",{defaultMessage:"Rule failed to execute because rule ran after it was disabled."}),I=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleErrorReasonValidate",{defaultMessage:"An error occurred when validating the rule parameters."}),k=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleWarningReasonMaxExecutableActions",{defaultMessage:"Action limit exceeded"}),E=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleWarningReasonMaxQueuedActions",{defaultMessage:"Queued action limit exceeded."}),T=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleWarningReasonMaxAlerts",{defaultMessage:"Alert limit exceeded"}),A=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.ruleWarningReasonUnknown",{defaultMessage:"Unknown reason"}),v={read:h,decrypt:x,execute:j,unknown:b,license:O,timeout:y,disabled:S,validate:I},_={maxExecutableActions:k,maxAlerts:T,maxQueuedActions:E,unknown:A},U=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selectAllAriaLabel",{defaultMessage:"Toggle select all rules"}),L=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.rulesListTable.columns.selectShowBulkActionsAriaLabel",{defaultMessage:"Show bulk actions"}),w=(e,t)=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalRulesLabel",{values:{formattedTotalRules:e,totalRules:t},defaultMessage:"{formattedTotalRules} {totalRules, plural, =1 {rule} other {rules}}"}),M=(e,t)=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.selectedRulesButton",{values:{formattedSelectedRules:e,selectedRules:t},defaultMessage:"Selected {formattedSelectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),R=(e,t)=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.selectAllRulesButton",{values:{formattedTotalRules:e,totalRules:t},defaultMessage:"Select all {formattedTotalRules} {totalRules, plural, =1 {rule} other {rules}}"}),D=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.clearAllSelectionButton",{defaultMessage:"Clear selection"}),C=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesActiveDescription",{defaultMessage:"Active: {totalStatusesActive}",values:{totalStatusesActive:e}}),$=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesErrorDescription",{defaultMessage:"Error: {totalStatusesError}",values:{totalStatusesError:e}}),F=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesWarningDescription",{defaultMessage:"Warning: {totalStatusesWarning}",values:{totalStatusesWarning:e}}),N=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesOkDescription",{defaultMessage:"Ok: {totalStatusesOk}",values:{totalStatusesOk:e}}),z=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesPendingDescription",{defaultMessage:"Pending: {totalStatusesPending}",values:{totalStatusesPending:e}}),P=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.totalStatusesUnknownDescription",{defaultMessage:"Unknown: {totalStatusesUnknown}",values:{totalStatusesUnknown:e}}),W=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.lastRunOutcomeSucceededDescription",{defaultMessage:"Succeeded: {total}",values:{total:e}}),J=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.lastRunOutcomeWarningDescription",{defaultMessage:"Warning: {total}",values:{total:e}}),H=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.lastRunOutcomeFailedDescription",{defaultMessage:"Failed: {total}",values:{total:e}}),B=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.singleTitle",{defaultMessage:"rule"}),q=s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.multipleTitle",{defaultMessage:"rules"}),Y=s.i18n.translate("xpack.triggersActionsUI.deleteSelectedIdsConfirmModal.cancelButtonLabel",{defaultMessage:"Cancel"}),G=e=>s.i18n.translate("xpack.triggersActionsUI.sections.rulesList.clearFilterLink",{values:{numberOfFilters:e},defaultMessage:"Clear {numberOfFilters, plural, =1 {filter} other {filters}}"}),K=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.deleteSelectedIdsConfirmModal.descriptionText",{defaultMessage:"You won't be able to recover {numIdsToDelete, plural, one {a deleted {singleTitle}} other {deleted {multipleTitle}}}.",values:{numIdsToDelete:e,singleTitle:t,multipleTitle:n}}),Q=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.deleteSelectedIdsConfirmModal.deleteButtonLabel",{defaultMessage:"Delete {numIdsToDelete, plural, one {{singleTitle}} other {# {multipleTitle}}} ",values:{numIdsToDelete:e,singleTitle:t,multipleTitle:n}}),V=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.deleteSelectedIdsSuccessNotification.descriptionText",{defaultMessage:"Deleted {numSuccesses, number} {numSuccesses, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numSuccesses:e,singleTitle:t,multipleTitle:n}}),X=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.enableSelectedIdsSuccessNotification.descriptionText",{defaultMessage:"Enabled {numSuccesses, number} {numSuccesses, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numSuccesses:e,singleTitle:t,multipleTitle:n}}),Z=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.disableSelectedIdsSuccessNotification.descriptionText",{defaultMessage:"Disabled {numSuccesses, number} {numSuccesses, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numSuccesses:e,singleTitle:t,multipleTitle:n}}),ee=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.deleteSelectedIdsErrorNotification.descriptionText",{defaultMessage:"Failed to delete {numErrors, number} {numErrors, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numErrors:e,singleTitle:t,multipleTitle:n}}),te=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.enableSelectedIdsErrorNotification.descriptionText",{defaultMessage:"Failed to enable {numErrors, number} {numErrors, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numErrors:e,singleTitle:t,multipleTitle:n}}),ne=(e,t,n)=>s.i18n.translate("xpack.triggersActionsUI.components.disableSelectedIdsErrorNotification.descriptionText",{defaultMessage:"Failed to disable {numErrors, number} {numErrors, plural, one {{singleTitle}} other {{multipleTitle}}}",values:{numErrors:e,singleTitle:t,multipleTitle:n}}),se=(e,t,n,r)=>s.i18n.translate("xpack.triggersActionsUI.components.deleteSelectedIdsPartialSuccessNotification.descriptionText",{defaultMessage:"Deleted {numberOfSuccess, number} {numberOfSuccess, plural, one {{singleTitle}} other {{multipleTitle}}}, {numberOfErrors, number} {numberOfErrors, plural, one {{singleTitle}} other {{multipleTitle}}} encountered errors",values:{numberOfSuccess:e,numberOfErrors:t,singleTitle:n,multipleTitle:r}}),re=(e,t,n,r)=>s.i18n.translate("xpack.triggersActionsUI.components.enableSelectedIdsPartialSuccessNotification.descriptionText",{defaultMessage:"Enabled {numberOfSuccess, number} {numberOfSuccess, plural, one {{singleTitle}} other {{multipleTitle}}}, {numberOfErrors, number} {numberOfErrors, plural, one {{singleTitle}} other {{multipleTitle}}} encountered errors",values:{numberOfSuccess:e,numberOfErrors:t,singleTitle:n,multipleTitle:r}}),ae=(e,t,n,r)=>s.i18n.translate("xpack.triggersActionsUI.components.disableSelectedIdsPartialSuccessNotification.descriptionText",{defaultMessage:"Disabled {numberOfSuccess, number} {numberOfSuccess, plural, one {{singleTitle}} other {{multipleTitle}}}, {numberOfErrors, number} {numberOfErrors, plural, one {{singleTitle}} other {{multipleTitle}}} encountered errors",values:{numberOfSuccess:e,numberOfErrors:t,singleTitle:n,multipleTitle:r}})},120:function(e,t,n){"use strict";n.d(t,"a",(function(){return U}));var s=n(13),r=n.n(s),a=(n(1),n(121)),i=n(135),u=n(63),l=n(62),o=n(131),c=n(55),d=n(126),g=n(6);async function p({id:e,http:t}){await t.post(`${g.b}/rule/${encodeURIComponent(e)}/_mute_all`)}async function m({id:e,http:t}){await t.post(`${g.b}/rule/${encodeURIComponent(e)}/_unmute_all`)}const f=({rule_type_state:e,alerts:t,previous_started_at:n,...s})=>({...s,alertTypeState:e,alertInstances:t,previousStartedAt:n});var b=n(118);const h=({id:e,http:t,outcomeFilter:n,message:s,dateStart:r,dateEnd:a,ruleTypeIds:i})=>{const u=Object(b.a)({outcomeFilter:n,message:s,ruleTypeIds:i});return t.get(`${g.j}/rule/${e}/_execution_kpi`,{query:{filter:u.length?u.join(" and "):void 0,date_start:r,date_end:a}})},x=({id:e,http:t,outcomeFilter:n,message:s,dateStart:r,dateEnd:a,namespaces:i,ruleTypeIds:u})=>{const l=Object(b.a)({outcomeFilter:n,message:s,ruleTypeIds:u});return t.get(`${g.j}/_global_execution_kpi`,{query:{filter:l.length?l.join(" and "):void 0,date_start:r,date_end:a,namespaces:i?JSON.stringify(i):i}})},j={timestamp:"@timestamp"},O=({id:e,http:t,dateStart:n,dateEnd:s,runId:r,message:a,perPage:i=10,page:u=0,sort:l,namespace:o,withAuth:c=!1})=>{const d=(e=>e?e.map((e=>{const t=Object.keys(e)[0],n=e[Object.keys(e)[0]];return{[j[t]||t]:{...n}}})):[])(l),p=Object(b.a)({runId:r,message:a});return t.get(`${g.j}/rule/${e}/_action_error_log`,{query:{date_start:n,date_end:s,filter:p.length?p.join(" and "):void 0,per_page:i,page:u+1,sort:d.length?JSON.stringify(d):void 0,namespace:o,with_auth:c}})};var y=n(132),S=n(34),I=n(122),k=n(123),E=n(59),T=n(136),A=n(137),v=n(30),_=n(0);function U(e){return t=>{const{http:n}=Object(v.b)().services;return Object(_.jsx)(e,r()({},t,{muteRules:async e=>async function({ids:e,http:t}){await Promise.all(e.map((e=>p({http:t,id:e}))))}({http:n,ids:e.filter((e=>!L(e))).map((e=>e.id))}),unmuteRules:async e=>async function({ids:e,http:t}){await Promise.all(e.map((e=>m({id:e,http:t}))))}({http:n,ids:e.filter(L).map((e=>e.id))}),muteRule:async e=>{if(!L(e))return await p({http:n,id:e.id})},unmuteRule:async e=>{if(L(e))return await m({http:n,id:e.id})},muteAlertInstance:async(e,t)=>{if(!w(e,t))return Object(o.a)({http:n,id:e.id,instanceId:t})},unmuteAlertInstance:async(e,t)=>{if(w(e,t))return Object(y.a)({http:n,id:e.id,instanceId:t})},loadRule:async e=>Object(u.a)({http:n,ruleId:e}),loadRuleState:async e=>async function({http:e,ruleId:t}){return await e.get(`${g.j}/rule/${t}/state`).then((e=>e?f(e):{}))}({http:n,ruleId:e}),loadRuleSummary:async(e,t)=>Object(l.a)({http:n,ruleId:e,numberOfExecutions:t}),loadRuleTypes:async()=>Object(c.a)({http:n}),loadExecutionLogAggregations:async e=>Object(d.a)({...e,http:n}),loadGlobalExecutionLogAggregations:async e=>Object(d.b)({...e,http:n}),loadActionErrorLog:async e=>O({...e,http:n}),loadExecutionKPIAggregations:async e=>h({...e,http:n}),loadGlobalExecutionKPIAggregations:async e=>x({...e,http:n}),resolveRule:async e=>async function({http:e,ruleId:t}){const n=await e.get(`${g.j}/rule/${encodeURIComponent(t)}/_resolve`);return Object(S.a)(n)}({http:n,ruleId:e}),getHealth:async()=>Object(a.a)({http:n}),snoozeRule:async(e,t)=>await Object(I.b)({http:n,id:e.id,snoozeSchedule:t}),bulkSnoozeRules:async e=>await Object(I.a)({http:n,...e}),unsnoozeRule:async(e,t)=>await Object(k.b)({http:n,id:e.id,scheduleIds:t}),bulkUnsnoozeRules:async e=>await Object(k.a)({http:n,...e}),cloneRule:async e=>await Object(i.a)({http:n,ruleId:e}),bulkDeleteRules:async e=>await Object(E.a)({http:n,...e}),bulkEnableRules:async e=>await Object(T.a)({http:n,...e}),bulkDisableRules:async e=>await Object(A.a)({http:n,...e})}))}}function L(e){return!0===e.muteAll}function w(e,t){return e.mutedInstanceIds.findIndex((e=>e===t))>=0}},121:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var s=n(6);const r=({decryption_health:e,execution_health:t,read_health:n,...s})=>({decryptionHealth:e,executionHealth:t,readHealth:n,...s}),a=({is_sufficiently_secure:e,has_permanent_encryption_key:t,alerting_framework_health:n,...s})=>({isSufficientlySecure:e,hasPermanentEncryptionKey:t,alertingFrameworkHealth:n,...s});async function i({http:e}){const t=await e.get(`${s.b}/_health`),n=r(t.alerting_framework_health);return{...a(t),alertingFrameworkHealth:n}}},122:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var s=n(6);function r({id:e,duration:t,rRule:n}){return{...e?{id:e}:{},duration:t,rRule:{...n,...n.until?{until:n.until.toISOString()}:{}}}}async function a({id:e,snoozeSchedule:t,http:n}){await n.post(`${s.j}/rule/${encodeURIComponent(e)}/_snooze`,{body:JSON.stringify({snooze_schedule:r(t)})})}function i({ids:e,filter:t,snoozeSchedule:n,http:a}){let i;try{i=JSON.stringify({ids:null!=e&&e.length?e:void 0,...t?{filter:JSON.stringify(t)}:{},operations:[{operation:"set",field:"snoozeSchedule",value:r(n)}]})}catch(e){throw new Error(`Unable to parse bulk snooze params: ${e}`)}return a.post(`${s.j}/rules/_bulk_edit`,{body:i})}},123:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return a}));var s=n(6);async function r({id:e,http:t,scheduleIds:n}){await t.post(`${s.j}/rule/${encodeURIComponent(e)}/_unsnooze`,{body:JSON.stringify({schedule_ids:n})})}function a({ids:e,filter:t,scheduleIds:n,http:r}){let a;try{a=JSON.stringify({ids:null!=e&&e.length?e:void 0,...t?{filter:JSON.stringify(t)}:{},operations:[{operation:"delete",field:"snoozeSchedule",value:n}]})}catch(e){throw new Error(`Unable to parse bulk unsnooze params: ${e}`)}return r.post(`${s.j}/rules/_bulk_edit`,{body:a})}},126:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u}));var s=n(6),r=n(118);const a=({data:e,...t})=>({data:e.map((e=>(e=>{const{duration_ms:t,total_search_duration_ms:n,es_search_duration_ms:s,schedule_delay_ms:r,...a}=e;return{execution_duration:e.duration_ms,total_search_duration:e.total_search_duration_ms,es_search_duration:e.es_search_duration_ms,schedule_delay:e.schedule_delay_ms,...a}})(e))),...t}),i=async({id:e,http:t,dateStart:n,dateEnd:i,outcomeFilter:u,ruleTypeIds:l,message:o,perPage:c=10,page:d=0,sort:g=[]})=>{const p=g,m=Object(r.a)({outcomeFilter:u,message:o,ruleTypeIds:l}),f=await t.get(`${s.j}/rule/${e}/_execution_log`,{query:{date_start:n,date_end:i,filter:m.length?m.join(" and "):void 0,per_page:c,page:d+1,sort:p.length?JSON.stringify(p):void 0}});return a(f)},u=async({http:e,dateStart:t,dateEnd:n,outcomeFilter:i,ruleTypeIds:u,message:l,perPage:o=10,page:c=0,sort:d=[],namespaces:g})=>{const p=d,m=Object(r.a)({outcomeFilter:i,message:l,ruleTypeIds:u}),f=await e.get(`${s.j}/_global_execution_logs`,{query:{date_start:t,date_end:n,filter:m.length?m.join(" and "):void 0,per_page:o,page:c+1,sort:p.length?JSON.stringify(p):void 0,namespaces:g?JSON.stringify(g):void 0}});return a(f)}},131:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(6);async function r({id:e,instanceId:t,http:n}){await n.post(`${s.b}/rule/${encodeURIComponent(e)}/alert/${encodeURIComponent(t)}/_mute`)}},132:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(6);async function r({id:e,instanceId:t,http:n}){await n.post(`${s.b}/rule/${encodeURIComponent(e)}/alert/${encodeURIComponent(t)}/_unmute`)}},135:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var s=n(6),r=n(34);async function a({http:e,ruleId:t}){const n=await e.post(`${s.j}/rule/${encodeURIComponent(t)}/_clone`);return Object(r.b)(n)}},136:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(6);const r=async({filter:e,ids:t,http:n})=>{try{const r=JSON.stringify({ids:null!=t&&t.length?t:void 0,...e?{filter:JSON.stringify(e)}:{}});return n.patch(`${s.j}/rules/_bulk_enable`,{body:r})}catch(e){throw new Error(`Unable to parse bulk enable params: ${e}`)}}},137:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var s=n(6);const r=async({filter:e,ids:t,http:n})=>{try{const r=JSON.stringify({ids:null!=t&&t.length?t:void 0,...e?{filter:JSON.stringify(e)}:{}});return n.patch(`${s.j}/rules/_bulk_disable`,{body:r})}catch(e){throw new Error(`Unable to parse bulk disable params: ${e}`)}}},141:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l}));var s=n(32),r=n.n(s),a=n(11),i=n(12);function u(e){if(!e)return"00:00:00.000";const t=r.a.duration(e);return`${[t.hours(),t.minutes(),t.seconds()].map((e=>Object(a.padStart)(`${e}`,2,"0"))).join(":")}.${Object(a.padStart)(`${t.milliseconds()}`,3,"0")}`}function l(e,t){if(!e||!e.ruleTaskTimeout)return!1;const n=e.ruleTaskTimeout;return t>Object(i.parseDuration)(n)}},145:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var s=n(1),r=n(5),a=n(53),i=n.n(a),u=n(30),l=n(126);const o=e=>{var t;return e.includes("now")&&(null===(t=i.a.parse(e))||void 0===t?void 0:t.format())||e},c=e=>"*"===e.id;function d(e){const{http:t}=Object(u.b)().services,n=Object(s.useCallback)((()=>c(e)?Object(l.b)({http:t,...e,dateStart:o(e.dateStart),...e.dateEnd?{dateEnd:o(e.dateEnd)}:{}}):Object(l.a)({http:t,...e,dateStart:o(e.dateStart),...e.dateEnd?{dateEnd:o(e.dateEnd)}:{}})),[e,t]),{data:a,error:i,isLoading:d,isFetching:g,refetch:p}=Object(r.useQuery)({queryKey:["loadRuleEventLog",e],queryFn:n,onError:e.onError,retry:0,refetchOnWindowFocus:!1}),m=Object(s.useMemo)((()=>i&&413===i.body.statusCode),[i]);return Object(s.useMemo)((()=>({data:a,hasExceedLogs:m,isLoading:d||g,loadEventLogs:p})),[a,m,g,d,p])}}}]);