/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.triggersActionsUi_bundle_jsonpfunction=window.triggersActionsUi_bundle_jsonpfunction||[]).push([[39],{170:function(t,e,r){"use strict";r.d(e,"a",(function(){return n}));const n="/internal/rac/alerts"},341:function(t,e,r){"use strict";r.r(e),r.d(e,"AlertSummaryWidget",(function(){return l})),r.d(e,"default",(function(){return l}));var n=r(1),i=r(170),a=r(30);var o=r(71),c=r(0);const l=({chartProps:t,featureIds:e,filter:r,fullSize:l,onClick:u=(()=>{}),timeRange:s,hideChart:d,onLoaded:v})=>{const{alertSummary:{activeAlertCount:f,activeAlerts:A,recoveredAlertCount:C},isLoading:g,error:b}=function({featureIds:t,timeRange:e,filter:r}){const{http:o}=Object(a.b)().services,[c,l]=Object(n.useState)({isLoading:!0,alertSummary:{activeAlertCount:0,activeAlerts:[],recoveredAlertCount:0}}),u=Object(n.useRef)(!1),s=Object(n.useRef)(new AbortController),d=Object(n.useCallback)((async()=>{if(t){u.current=!1,s.current.abort(),s.current=new AbortController;try{const{activeAlertCount:n,activeAlerts:a,recoveredAlertCount:c}=await async function({featureIds:t,filter:e,http:r,signal:n,timeRange:{utcFrom:a,utcTo:o,fixedInterval:c}}){var l,u,s;const d=await r.post(`${i.a}/_alert_summary`,{signal:n,body:JSON.stringify({fixed_interval:c,gte:a,lte:o,featureIds:t,filter:[e]})});return{activeAlertCount:null!==(l=null==d?void 0:d.activeAlertCount)&&void 0!==l?l:0,activeAlerts:null!==(u=null==d?void 0:d.activeAlerts)&&void 0!==u?u:[],recoveredAlertCount:null!==(s=null==d?void 0:d.recoveredAlertCount)&&void 0!==s?s:0}}({featureIds:t,filter:r,http:o,signal:s.current.signal,timeRange:e});u.current||l((()=>({alertSummary:{activeAlertCount:n,activeAlerts:a,recoveredAlertCount:c},isLoading:!1})))}catch(t){u.current||"AbortError"!==t.name&&l((e=>({...e,isLoading:!1,error:t.message})))}}}),[t,r,o,e]);return Object(n.useEffect)((()=>{d()}),[d]),c}({featureIds:e,filter:r,timeRange:s});return Object(n.useEffect)((()=>{!g&&v&&v()}),[g,v]),g?Object(c.jsx)(o.d,{fullSize:l,isLoadingWithoutChart:d}):b?Object(c.jsx)(o.b,null):l?f||C?Object(c.jsx)(o.c,{activeAlertCount:f,activeAlerts:A,chartProps:t,dateFormat:s.dateFormat,recoveredAlertCount:C,hideChart:d}):null:Object(c.jsx)(o.a,{activeAlertCount:f,activeAlerts:A,chartProps:t,onClick:u,recoveredAlertCount:C,timeRangeTitle:s.title})}}}]);