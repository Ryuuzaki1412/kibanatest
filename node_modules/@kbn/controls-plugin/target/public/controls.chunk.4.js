(window.controls_bundle_jsonpfunction=window.controls_bundle_jsonpfunction||[]).push([[4],{102:function(t,e,i){"use strict";i.r(e),i.d(e,"OptionsListEmbeddableContext",(function(){return J})),i.d(e,"useOptionsList",(function(){return K})),i.d(e,"OptionsListEmbeddable",(function(){return options_list_embeddable_OptionsListEmbeddable}));var o=i(1),s=i.n(o),n=i(40),r=i.n(n),l=i(41),a=i(5),p=i.n(a),c=i(2),d=i(29),u=i(6),h=i.n(u),g=i(42),v=i(21),f=i(0),b=i(20),x=i(58),j=i(34),S=i(17),O=i(43),m=i.n(O),w=i(8);const L=1e3;var I=i(10),y=i(4);const _=[{id:"optionsList__includeResults",label:I.a.popover.getIncludeLabel()},{id:"optionsList__excludeResults",label:I.a.popover.getExcludeLabel()}],E=({isLoading:t})=>{const e=K(),i=e.select((t=>t.explicitInput.exclude)),o=e.select((t=>t.componentState.allowExpensiveQueries));return Object(y.jsx)(h.a.Fragment,null,Object(y.jsx)(w.EuiPopoverFooter,{paddingSize:"none",css:Object(y.css)("background-color:",Object(w.useEuiBackgroundColor)("subdued"),";","")},t&&Object(y.jsx)("div",{style:{position:"absolute",width:"100%"}},Object(y.jsx)(w.EuiProgress,{"data-test-subj":"optionsList-control-popover-loading",size:"xs",color:"accent"})),Object(y.jsx)(w.EuiFlexGroup,{gutterSize:"xs",responsive:!1,alignItems:"center",css:Object(y.css)("padding:",Object(w.useEuiPaddingSize)("s"),";",""),justifyContent:"spaceBetween"},Object(y.jsx)(w.EuiFlexItem,{grow:!1},Object(y.jsx)(w.EuiButtonGroup,{legend:I.a.popover.getIncludeExcludeLegend(),options:_,idSelected:i?"optionsList__excludeResults":"optionsList__includeResults",onChange:t=>e.dispatch.setExclude("optionsList__excludeResults"===t),buttonSize:"compressed","data-test-subj":"optionsList__includeExcludeButtonGroup"})),!o&&Object(y.jsx)(w.EuiFlexItem,{"data-test-subj":"optionsList-allow-expensive-queries-warning",grow:!1},Object(y.jsx)(w.EuiIconTip,{type:"warning",color:"warning",content:I.a.popover.getAllowExpensiveQueriesWarning(),"aria-label":I.a.popover.getAllowExpensiveQueriesWarning()})))))};var P=i(13);const C=[{id:"asc",iconType:"sortAscending","data-test-subj":"optionsList__sortOrder_asc",label:I.a.editorAndPopover.sortOrder.asc.getSortOrderLabel()},{id:"desc",iconType:"sortDescending","data-test-subj":"optionsList__sortOrder_desc",label:I.a.editorAndPopover.sortOrder.desc.getSortOrderLabel()}],F=({showOnlySelected:t})=>{const e=K(),i=e.select((t=>t.componentState.field)),o=e.select((t=>{var e;return null!==(e=t.explicitInput.sort)&&void 0!==e?e:P.a})),[s,n]=Object(u.useState)(!1),[r,l]=Object(u.useState)((()=>Object(P.b)(null==i?void 0:i.type).map((t=>({onFocusBadge:!1,data:{sortBy:t},checked:t===o.by?"on":void 0,"data-test-subj":`optionsList__sortBy_${t}`,label:I.a.editorAndPopover.sortBy[t].getSortByLabel(null==i?void 0:i.type)}))))),a=Object(u.useCallback)((t=>{l(t);const i=t.find((({checked:t})=>"on"===t));i&&e.dispatch.setSort({by:i.data.sortBy})}),[e.dispatch]);return Object(y.jsx)(w.EuiPopover,{button:Object(y.jsx)(w.EuiToolTip,{position:"top",content:t?I.a.popover.getSortDisabledTooltip():I.a.popover.getSortPopoverTitle()},Object(y.jsx)((()=>Object(y.jsx)(w.EuiButtonIcon,{size:"xs",display:"empty",color:"text",iconType:"asc"===(null==o?void 0:o.direction)?"sortAscending":"sortDescending",isDisabled:t,className:"optionsList__sortButton","data-test-subj":"optionsListControl__sortingOptionsButton",onClick:()=>n(!s),"aria-label":I.a.popover.getSortPopoverDescription()})),null)),panelPaddingSize:"none",isOpen:s,"aria-labelledby":"optionsList_sortingOptions",closePopover:()=>n(!1),panelClassName:"optionsList--sortPopover",anchorClassName:"optionsList__sortButtonPopoverAnchor"},Object(y.jsx)("span",{"data-test-subj":"optionsListControl__sortingOptionsPopover"},Object(y.jsx)(w.EuiPopoverTitle,{paddingSize:"s"},Object(y.jsx)(w.EuiFlexGroup,{alignItems:"center",responsive:!1},Object(y.jsx)(w.EuiFlexItem,null,I.a.popover.getSortPopoverTitle()),Object(y.jsx)(w.EuiFlexItem,{grow:!1},Object(y.jsx)(w.EuiButtonGroup,{isIconOnly:!0,buttonSize:"compressed",options:C,idSelected:o.direction,legend:I.a.editorAndPopover.getSortDirectionLegend(),onChange:t=>e.dispatch.setSort({direction:t})})))),Object(y.jsx)(w.EuiSelectable,{options:r,singleSelection:"always",onChange:a,id:"optionsList_sortingOptions",listProps:{bordered:!1},"data-test-subj":"optionsListControl__sortingOptions","aria-label":I.a.popover.getSortPopoverDescription()},(t=>t))))};var R=i(9);const B=({showOnlySelected:t,updateSearchString:e,setShowOnlySelected:i})=>{var o;const s=K(),n=null!==(o=s.select((t=>t.componentState.totalCardinality)))&&void 0!==o?o:0,r=s.select((t=>t.componentState.searchString)),l=s.select((t=>t.componentState.field)),a=s.select((t=>t.componentState.invalidSelections)),p=s.select((t=>t.explicitInput.hideSort)),c=s.select((t=>t.explicitInput.searchTechnique)),d=s.select((t=>t.componentState.allowExpensiveQueries));return Object(y.jsx)("div",{className:"optionsList__actions"},"date"!==(null==l?void 0:l.type)&&Object(y.jsx)(w.EuiFormRow,{className:"optionsList__searchRow",fullWidth:!0},Object(y.jsx)(w.EuiFieldSearch,{isInvalid:!r.valid,compressed:!0,disabled:t,fullWidth:!0,onChange:t=>e(t.target.value),value:r.value,"data-test-subj":"optionsList-control-search-input",placeholder:I.a.popover.searchPlaceholder[null!=c?c:R.b].getPlaceholderText()})),Object(y.jsx)(w.EuiFormRow,{className:"optionsList__actionsRow",fullWidth:!0},Object(y.jsx)(w.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"s",responsive:!1},d&&Object(y.jsx)(w.EuiFlexItem,{grow:!1},Object(y.jsx)(w.EuiText,{size:"xs",color:"subdued","data-test-subj":"optionsList-cardinality-label"},I.a.popover.getCardinalityLabel(n))),a&&a.length>0&&Object(y.jsx)(h.a.Fragment,null,d&&Object(y.jsx)(w.EuiFlexItem,{grow:!1},Object(y.jsx)("div",{className:"optionsList__actionBarDivider"})),Object(y.jsx)(w.EuiFlexItem,{grow:!1},Object(y.jsx)(w.EuiText,{size:"xs",color:"subdued"},I.a.popover.getInvalidSelectionsLabel(a.length)))),Object(y.jsx)(w.EuiFlexItem,{grow:!0},Object(y.jsx)(w.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexEnd",responsive:!1},Object(y.jsx)(w.EuiFlexItem,{grow:!1},Object(y.jsx)(w.EuiToolTip,{position:"top",content:t?I.a.popover.getAllOptionsButtonTitle():I.a.popover.getSelectedOptionsButtonTitle()},Object(y.jsx)(w.EuiButtonIcon,{size:"xs",iconType:"list","aria-pressed":t,color:t?"primary":"text",display:t?"base":"empty",onClick:()=>i(!t),"data-test-subj":"optionsList-control-show-only-selected","aria-label":t?I.a.popover.getAllOptionsButtonTitle():I.a.popover.getSelectedOptionsButtonTitle()}))),!p&&Object(y.jsx)(w.EuiFlexItem,{grow:!1},Object(y.jsx)(F,{showOnlySelected:t})))))))};var V=i(50);const M=({showOnlySelected:t})=>Object(y.jsx)(w.EuiSelectableMessage,{"data-test-subj":"optionsList-control-"+(t?"selectionsEmptyMessage":"noSelectionsMessage")},Object(y.jsx)(w.EuiIcon,{type:"minusInCircle"}),Object(y.jsx)(w.EuiSpacer,{size:"xs"}),t?I.a.popover.getSelectionsEmptyMessage():I.a.popover.getEmptyMessage()),A=({documentCount:t})=>{const{euiTheme:e}=Object(w.useEuiTheme)();return Object(y.jsx)(h.a.Fragment,null,Object(y.jsx)(w.EuiToolTip,{content:I.a.popover.getDocumentCountTooltip(t),position:"right"},Object(y.jsx)(w.EuiText,{size:"xs","aria-hidden":!0,className:"eui-textNumber",color:e.colors.subduedText,"data-test-subj":"optionsList-document-count-badge",css:Object(y.css)("font-weight:",e.font.weight.medium,"!important;","")},`${t.toLocaleString()}`)),Object(y.jsx)(w.EuiScreenReaderOnly,null,Object(y.jsx)("div",null,'" "'," ",I.a.popover.getDocumentCountScreenReaderText(t))))};var T=i(64);const k=({showOnlySelected:t,loadMoreSuggestions:e})=>{var i;const o=K(),s=o.select((t=>t.componentState.searchString)),n=o.select((t=>t.componentState.availableOptions)),r=o.select((t=>t.componentState.totalCardinality)),l=o.select((t=>t.componentState.invalidSelections)),a=o.select((t=>t.componentState.field)),p=o.select((t=>t.explicitInput.sort)),c=o.select((t=>t.explicitInput.fieldName)),d=o.select((t=>t.explicitInput.hideExists)),g=o.select((t=>t.explicitInput.singleSelect)),v=o.select((t=>t.explicitInput.existsSelected)),f=o.select((t=>t.explicitInput.selectedOptions)),b=o.select((t=>t.output.dataViewId)),x=null!==(i=o.select((t=>t.output.loading)))&&void 0!==i&&i,j=Object(u.useRef)(null),S=Object(T.a)({dataViewId:b,fieldSpec:a}),O=Object(u.useMemo)((()=>!!r&&(null!=n?n:[]).length<Math.min(r,L)),[n,r]),m=Object(u.useMemo)((()=>new Set(f)),[f]),_=Object(u.useMemo)((()=>new Set(l)),[l]),E=Object(u.useMemo)((()=>t?f:null!=n?n:[]),[n,f,t]),P=Object(u.useMemo)((()=>{if(!d&&(v||!t&&0!==(null==E?void 0:E.length)))return{key:"exists-option",checked:v?"on":void 0,label:I.a.controlAndPopover.getExists(),className:"optionsList__existsFilter","data-test-subj":"optionsList-control-selection-exists"}}),[E,v,t,d]),[C,F]=Object(u.useState)([]);Object(u.useEffect)((()=>{const e=(null!=E?E:[]).map((e=>{var i,o;return"string"==typeof e&&(e={value:e}),{key:e.value,label:null!==(i=S(e.value))&&void 0!==i?i:e.value,checked:null!=m&&m.has(e.value)?"on":void 0,"data-test-subj":`optionsList-control-selection-${e.value}`,className:t&&_.has(e.value)?"optionsList__selectionInvalid":"optionsList__validSuggestion",append:!t&&null!==(o=e)&&void 0!==o&&o.docCount?Object(y.jsx)(A,{documentCount:e.docCount}):void 0}}));O?e.push({key:"loading-option",className:"optionslist--loadingMoreGroupLabel",label:I.a.popover.getLoadingMoreMessage(),isGroupLabel:!0}):e.length===L&&e.push({key:"no-more-option",className:"optionslist--endOfOptionsGroupLabel",label:I.a.popover.getAtEndOfOptionsMessage(),isGroupLabel:!0}),F(P?[P,...e]:e)}),[E,n,t,m,_,P,O,S]);const R=Object(u.useCallback)((()=>{var t;const i=null===(t=j.current)||void 0===t?void 0:t.querySelector(".euiSelectableList__list");if(!i)return;const{scrollTop:o,scrollHeight:s,clientHeight:n}=i;o+n>=s-parseInt(V.euiThemeVars.euiSizeXXL,10)&&e(null!=r?r:L)}),[e,r]);return Object(u.useEffect)((()=>{const t=j.current;if(!x&&O)return null==t||t.addEventListener("scroll",R,!0),()=>{null==t||t.removeEventListener("scroll",R,!0)}}),[R,x,O]),Object(u.useEffect)((()=>{var t;const e=null===(t=j.current)||void 0===t?void 0:t.querySelector(".euiSelectableList__list");null==e||e.scrollTo({top:0})}),[p,s]),Object(y.jsx)(h.a.Fragment,null,Object(y.jsx)("div",{ref:j},Object(y.jsx)(w.EuiSelectable,{options:C,renderOption:t=>Object(y.jsx)(w.EuiHighlight,{search:"exists-option"===t.key?"":s.value},t.label),listProps:{onFocusBadge:!1},"aria-label":I.a.popover.getSuggestionsAriaLabel(c,C.length),emptyMessage:Object(y.jsx)(M,{showOnlySelected:t}),onChange:(e,i,s)=>{var n;const r=null!==(n=s.key)&&void 0!==n?n:s.label;F(e),"exists-option"===r?o.dispatch.selectExists(!Boolean(v)):t||m.has(r)?o.dispatch.deselectOption(r):g?o.dispatch.replaceSelection(r):o.dispatch.selectOption(r)}},(t=>t))))},$=()=>{var t,e;const i=K(),o=i.select((t=>t.explicitInput.fieldName)),s=i.select((t=>t.componentState.invalidSelections)),n=i.select((t=>t.componentState.field)),r=i.select((t=>t.output.dataViewId)),l=Object(T.a)({dataViewId:r,fieldSpec:n}),[a,p]=Object(u.useState)([]);return Object(u.useEffect)((()=>{const t=(null!=s?s:[]).map((t=>({key:t,label:l(t),checked:"on",className:"optionsList__selectionInvalid","data-test-subj":`optionsList-control-ignored-selection-${t}`,prepend:Object(y.jsx)(w.EuiScreenReaderOnly,null,Object(y.jsx)("div",null,I.a.popover.getInvalidSelectionScreenReaderText(),'" "'," "))})));p(t)}),[l,s]),Object(y.jsx)(h.a.Fragment,null,Object(y.jsx)(w.EuiSpacer,{size:"s"}),Object(y.jsx)(w.EuiTitle,{size:"xxs",className:"optionsList-control-ignored-selection-title","data-test-subj":"optionList__ignoredSelectionLabel"},Object(y.jsx)("label",null,I.a.popover.getInvalidSelectionsSectionTitle(null!==(t=null==s?void 0:s.length)&&void 0!==t?t:0))),Object(y.jsx)(w.EuiSelectable,{"aria-label":I.a.popover.getInvalidSelectionsSectionAriaLabel(o,null!==(e=null==s?void 0:s.length)&&void 0!==e?e:0),options:a,listProps:{onFocusBadge:!1,isVirtualized:!1},onChange:(t,e,o)=>{p(t),i.dispatch.deselectOption(o.label)}},(t=>t)))},N=({isLoading:t,updateSearchString:e,loadMoreSuggestions:i})=>{const o=K(),s=o.select((t=>t.componentState.field)),n=o.select((t=>t.componentState.availableOptions)),r=o.select((t=>t.componentState.invalidSelections)),l=o.select((t=>t.explicitInput.id)),a=o.select((t=>t.explicitInput.hideExclude)),p=o.select((t=>t.explicitInput.hideActionBar)),[d,h]=Object(u.useState)(!1);return Object(y.jsx)("div",{id:`control-popover-${l}`,className:"optionsList__popover","data-test-subj":"optionsList-control-popover"},"boolean"!==(null==s?void 0:s.type)&&!p&&Object(y.jsx)(B,{showOnlySelected:d,updateSearchString:e,setShowOnlySelected:h}),Object(y.jsx)("div",{"data-test-subj":"optionsList-control-available-options","data-option-count":t?0:Object.keys(null!=n?n:{}).length,style:{width:"100%",height:"100%"}},Object(y.jsx)(k,{loadMoreSuggestions:i,showOnlySelected:d}),!d&&r&&!Object(c.isEmpty)(r)&&Object(y.jsx)($,null)),!a&&Object(y.jsx)(E,{isLoading:t}))};i(85);var z=i(63),D=i(72);const G=({typeaheadSubject:t,loadMoreSubject:e})=>{const i=K(),o=i.select((t=>t.componentState.error)),s=i.select((t=>t.componentState.popoverOpen)),n=i.select((t=>t.componentState.validSelections)),r=i.select((t=>t.componentState.invalidSelections)),l=i.select((t=>t.componentState.field)),a=i.select((t=>t.explicitInput.id)),p=i.select((t=>t.explicitInput.exclude)),d=i.select((t=>t.explicitInput.fieldName)),g=i.select((t=>t.explicitInput.placeholder)),v=i.select((t=>t.explicitInput.controlStyle)),f=i.select((t=>t.explicitInput.singleSelect)),b=i.select((t=>t.explicitInput.existsSelected)),x=i.select((t=>t.explicitInput.selectedOptions)),j=i.select((t=>t.output.loading)),S=i.select((t=>t.output.dataViewId)),O=Object(T.a)({dataViewId:S,fieldSpec:l});Object(u.useEffect)((()=>()=>{i.dispatch.setPopoverOpen(!1)}),[i]);const[_,E]=Object(u.useState)(!0),P=Object(u.useMemo)((()=>Object(c.debounce)((t=>{E(t)}),100)),[]);Object(u.useEffect)((()=>P(null!=j&&j)),[j,P]),Object(u.useEffect)((()=>{f&&x&&(null==x?void 0:x.length)>1&&i.dispatch.replaceSelection(x[0])}),[x,f,i.dispatch]);const C=Object(u.useCallback)((e=>{t.next(e),i.dispatch.setSearchString(e)}),[t,i.dispatch]),F=Object(u.useCallback)((t=>{e.next(Math.min(t,L))}),[e]),{hasSelections:R,selectionDisplayNode:B,validSelectionsCount:V}=Object(u.useMemo)((()=>{const t=I.a.control.getSeparator(null==l?void 0:l.type);return{hasSelections:!Object(c.isEmpty)(n)||!Object(c.isEmpty)(r),validSelectionsCount:null==n?void 0:n.length,selectionDisplayNode:Object(y.jsx)(h.a.Fragment,null,p&&Object(y.jsx)(h.a.Fragment,null,Object(y.jsx)("span",{className:"optionsList__negateLabel"},b?I.a.control.getExcludeExists():I.a.control.getNegate())," "),b?Object(y.jsx)("span",{className:"optionsList__existsFilter"},I.a.controlAndPopover.getExists(+Boolean(p))):Object(y.jsx)(h.a.Fragment,null,null!=n&&n.length?Object(y.jsx)("span",{className:"optionsList__filterValid"},n.map((t=>O(t))).join(t)):null,null!=n&&n.length&&null!=r&&r.length?t:null,null!=r&&r.length?Object(y.jsx)("span",{className:"optionsList__filterInvalid"},r.map((t=>O(t))).join(t)):null))}}),[p,b,n,r,O,null==l?void 0:l.type]),M=Object(y.jsx)(w.EuiFilterButton,{badgeColor:"success",iconType:"arrowDown",isLoading:_,className:m()("optionsList--filterBtn",{"optionsList--filterBtnSingle":"twoLine"!==v,"optionsList--filterBtnPlaceholder":!R}),"data-test-subj":`optionsList-control-${a}`,onClick:()=>i.dispatch.setPopoverOpen(!s),isSelected:s,numActiveFilters:V,hasActiveFilters:Boolean(V)},R||b?B:null!=g?g:I.a.control.getPlaceholder());return o?Object(y.jsx)(z.a,{error:o}):Object(y.jsx)(w.EuiFilterGroup,{className:m()("optionsList--filterGroup",{"optionsList--filterGroupSingle":"twoLine"!==v})},Object(y.jsx)(w.EuiInputPopover,{ownFocus:!0,input:M,hasArrow:!1,repositionOnScroll:!0,isOpen:s,panelPaddingSize:"none",panelMinWidth:D.a,className:"optionsList__inputButtonOverride",initialFocus:"[data-test-subj=optionsList-control-search-input]",closePopover:()=>i.dispatch.setPopoverOpen(!1),panelClassName:"optionsList__popoverOverride",panelProps:{"aria-label":I.a.popover.getAriaLabel(d)}},Object(y.jsx)(N,{isLoading:_,updateSearchString:C,loadMoreSuggestions:F})))};var Q=i(90),q=i.n(Q);const W=(t,e)=>{const i="ipv4"===t;return{min:i?e.concat(Array(4-e.length).fill("0")).join("."):e.join(":")+"::",max:i?e.concat(Array(4-e.length).fill("255")).join("."):e.concat(Array(8-e.length).fill("ffff")).join(":")}},H=t=>{const{type:e,segments:i}=t,o="ipv4"===e,s=i.join(o?".":":");if(q.a.isValid(s))return[{key:e,mask:o?s+"/32":s+"/128"}]},U={deselectOption:(t,e)=>{if(!t.explicitInput.selectedOptions)return;const i=t.explicitInput.selectedOptions.indexOf(e.payload);if(-1!==i){const e=[...t.explicitInput.selectedOptions];e.splice(i,1),t.explicitInput.selectedOptions=e}},setSearchString:(t,e)=>{var i;t.componentState.searchString.value=e.payload,""!==e.payload&&"ip"===(null===(i=t.componentState.field)||void 0===i?void 0:i.type)&&(t.componentState.searchString.valid=(t=>{if(null===t.match(/^[A-Fa-f0-9.:]*$/))return{validSearch:!1};const e=(t=>-1!==t.indexOf(".")?{segments:t.split(".").filter((t=>""!==t)),type:"ipv4"}:-1!==t.indexOf(":")?{segments:t.split(":").filter((t=>""!==t)),type:"ipv6"}:{segments:[t],type:"unknown"})(t);if("ipv4"===e.type&&4===e.segments.length){const t=H(e);return{validSearch:Boolean(t),rangeQuery:t}}if("ipv6"===e.type&&8===e.segments.length){const t=H(e);return{validSearch:Boolean(t),rangeQuery:t}}const i=(t=>{const{type:e,segments:i}=t,o=[];if("unknown"===e||"ipv4"===e){const{min:t,max:e}=W("ipv4",i);q.a.isValid(t)&&q.a.isValid(e)&&o.push({key:"ipv4",from:t,to:e})}if("unknown"===e||"ipv6"===e){const{min:t,max:e}=W("ipv6",i);q.a.isValid(t)&&q.a.isValid(e)&&o.push({key:"ipv6",from:t,to:e})}return o})(e);return{validSearch:!(0===(null==i?void 0:i.length)),rangeQuery:i}})(e.payload).validSearch)},setAllowExpensiveQueries:(t,e)=>{t.componentState.allowExpensiveQueries=e.payload},setPopoverOpen:(t,e)=>{t.componentState.popoverOpen=e.payload},setSort:(t,e)=>{var i;t.explicitInput.sort={...null!==(i=t.explicitInput.sort)&&void 0!==i?i:P.a,...e.payload}},selectExists:(t,e)=>{e.payload?(t.explicitInput.existsSelected=!0,t.explicitInput.selectedOptions=[]):t.explicitInput.existsSelected=!1},selectOption:(t,e)=>{var i;t.explicitInput.selectedOptions||(t.explicitInput.selectedOptions=[]),t.explicitInput.existsSelected&&(t.explicitInput.existsSelected=!1),null===(i=t.explicitInput.selectedOptions)||void 0===i||i.push(e.payload)},replaceSelection:(t,e)=>{t.explicitInput.selectedOptions=[e.payload],t.explicitInput.existsSelected&&(t.explicitInput.existsSelected=!1)},clearSelections:t=>{t.explicitInput.existsSelected&&(t.explicitInput.existsSelected=!1),t.explicitInput.selectedOptions&&(t.explicitInput.selectedOptions=[])},setExclude:(t,e)=>{t.explicitInput.exclude=e.payload},clearValidAndInvalidSelections:t=>{t.componentState.invalidSelections=[],t.componentState.validSelections=[]},setValidAndInvalidSelections:(t,e)=>{const{invalidSelections:i,validSelections:o}=e.payload;t.componentState.invalidSelections=i,t.componentState.validSelections=o},setErrorMessage:(t,e)=>{t.componentState.error=e.payload},setLoading:(t,e)=>{t.output.loading=e.payload},setField:(t,e)=>{t.componentState.field=e.payload},updateQueryResults:(t,e)=>{var i;t.componentState={...null!==(i=t.componentState)&&void 0!==i?i:{},...e.payload}},publishFilters:(t,e)=>{t.output.filters=e.payload},setDataViewId:(t,e)=>{t.output.dataViewId=e.payload},setExplicitInputDataViewId:(t,e)=>{t.explicitInput.dataViewId=e.payload}},X=(t,e)=>{if(!e||!t)return!1;const{filters:i,...o}=e,{filters:s,...n}=t;return!!p()(o,n)&&!!Object(v.compareFilters)(null!=s?s:[],null!=i?i:[],v.COMPARE_ALL_OPTIONS)},J=Object(u.createContext)(null),K=()=>{const t=Object(u.useContext)(J);if(null==t)throw new Error("useOptionsList must be used inside OptionsListEmbeddableContext.");return t};class options_list_embeddable_OptionsListEmbeddable extends b.Embeddable{constructor(t,e,i,o){super(e,i,o),s()(this,"type",j.OPTIONS_LIST_CONTROL),s()(this,"deferEmbeddableLoad",!0),s()(this,"subscriptions",new d.Subscription),s()(this,"node",void 0),s()(this,"dataViewsService",void 0),s()(this,"optionsListService",void 0),s()(this,"typeaheadSubject",new d.Subject),s()(this,"loadMoreSubject",new d.Subject),s()(this,"abortController",void 0),s()(this,"dataView",void 0),s()(this,"field",void 0),s()(this,"select",void 0),s()(this,"getState",void 0),s()(this,"dispatch",void 0),s()(this,"onStateChange",void 0),s()(this,"cleanupStateTools",void 0),s()(this,"initialize",(async()=>{const{selectedOptions:t}=this.getInput();t||this.setInitializationFinished(),this.dispatch.setAllowExpensiveQueries(await this.optionsListService.getAllowExpensiveQueries()),this.runOptionsListQuery().then((async()=>{t&&(await this.buildFilter(),this.setInitializationFinished()),this.setupSubscriptions()}))})),s()(this,"setupSubscriptions",(()=>{const t=this.getInput$().pipe(Object(g.map)((t=>{var e;return{validate:!Boolean(null===(e=t.ignoreParentSettings)||void 0===e?void 0:e.ignoreValidations),lastReloadRequestTime:t.lastReloadRequestTime,existsSelected:t.existsSelected,searchTechnique:t.searchTechnique,dataViewId:t.dataViewId,fieldName:t.fieldName,timeRange:t.timeRange,timeslice:t.timeslice,exclude:t.exclude,filters:t.filters,query:t.query,sort:t.sort}})),Object(g.distinctUntilChanged)(X)),e=this.typeaheadSubject.pipe(Object(g.debounceTime)(100)),i=this.loadMoreSubject.pipe(Object(g.debounceTime)(100));this.subscriptions.add(Object(d.merge)(t,e).pipe(Object(g.skip)(1)).subscribe((()=>{this.runOptionsListQuery()}))),this.subscriptions.add(i.subscribe((t=>{this.runOptionsListQuery(t)}))),this.subscriptions.add(this.getInput$().pipe(Object(g.distinctUntilChanged)(((t,e)=>t.exclude===e.exclude&&t.existsSelected===e.existsSelected&&Object(c.isEqual)(t.selectedOptions,e.selectedOptions))),Object(d.tap)((({selectedOptions:t})=>{if(!t||Object(c.isEmpty)(t))this.dispatch.clearValidAndInvalidSelections({});else{var e;const{invalidSelections:i}=null!==(e=this.getState().componentState)&&void 0!==e?e:{},o=[],s=[];for(const e of t)null!=i&&i.includes(e)?s.push(e):o.push(e);this.dispatch.setValidAndInvalidSelections({validSelections:o,invalidSelections:s})}})),Object(d.switchMap)((async()=>{const t=await this.buildFilter();this.dispatch.publishFilters(t)}))).subscribe())})),s()(this,"getCurrentDataViewAndField",(async()=>{const{explicitInput:{dataViewId:t,fieldName:e}}=this.getState();if(!this.dataView||this.dataView.id!==t){var i;try{this.dataView=await this.dataViewsService.get(t)}catch(t){this.dispatch.setErrorMessage(t.message)}this.dispatch.setDataViewId(null===(i=this.dataView)||void 0===i?void 0:i.id)}if(this.dataView&&(!this.field||this.field.name!==e)){const t=this.dataView.getFieldByName(e);t?(this.field=t.toSpec(),this.dispatch.setField(this.field)):this.dispatch.setErrorMessage(f.i18n.translate("controls.optionsList.errors.fieldNotFound",{defaultMessage:"Could not locate field: {fieldName}",values:{fieldName:e}}))}return{dataView:this.dataView,field:this.field}})),s()(this,"runOptionsListQuery",(async(t=10)=>{var e;const i=null===(e=this.field)||void 0===e?void 0:e.name,{dataView:o,field:s}=await this.getCurrentDataViewAndField();if(!o||!s)return;i&&s.name!==i&&this.dispatch.setSearchString("");const{componentState:{searchString:n,allowExpensiveQueries:r},explicitInput:{selectedOptions:a,runPastTimeout:p,existsSelected:d,sort:u,searchTechnique:h}}=this.getState();if(this.dispatch.setLoading(!0),n.valid){const{ignoreParentSettings:e,filters:i,query:g,timeRange:v,timeslice:f}=this.getInput();this.abortController&&this.abortController.abort(),this.abortController=new AbortController;const b=void 0!==f?{from:new Date(f[0]).toISOString(),to:new Date(f[1]).toISOString(),mode:"absolute"}:v,x=await this.optionsListService.runOptionsListRequest({sort:u,size:t,field:s,query:g,filters:i,dataView:o,timeRange:b,searchTechnique:h,runPastTimeout:p,selectedOptions:a,allowExpensiveQueries:r,searchString:n.value},this.abortController.signal);if(this.optionsListService.optionsListResponseWasFailure(x)){if("aborted"===x.error)return;return void this.dispatch.setErrorMessage(x.error.message)}const{suggestions:j,invalidSelections:S,totalCardinality:O}=x;if(!a&&!d||Object(c.isEmpty)(S)||null!=e&&e.ignoreValidations)this.dispatch.updateQueryResults({availableOptions:j,invalidSelections:void 0,validSelections:a,totalCardinality:O});else{const t=[],e=[];for(const i of null!=a?a:[])null!=S&&S.includes(String(i))?e.push(i):t.push(i);this.dispatch.updateQueryResults({availableOptions:j,invalidSelections:e,validSelections:t,totalCardinality:O})}const m=await this.buildFilter();Object(l.batch)((()=>{this.dispatch.setErrorMessage(void 0),this.dispatch.setLoading(!1),this.dispatch.publishFilters(m)}))}else Object(l.batch)((()=>{this.dispatch.setErrorMessage(void 0),this.dispatch.updateQueryResults({availableOptions:[]}),this.dispatch.setLoading(!1)}))})),s()(this,"buildFilter",(async()=>{var t,e;const{validSelections:i}=null!==(t=this.getState().componentState)&&void 0!==t?t:{},{existsSelected:o}=null!==(e=this.getState().explicitInput)&&void 0!==e?e:{},{exclude:s}=this.getInput();if((!i||Object(c.isEmpty)(i))&&!o)return[];const{dataView:n,field:r}=await this.getCurrentDataViewAndField();if(!n||!r)return;let l;return o?l=Object(v.buildExistsFilter)(r,n):i&&(l=1===i.length?Object(v.buildPhraseFilter)(r,i[0],n):Object(v.buildPhrasesFilter)(r,i,n)),l?(l.meta.key=null==r?void 0:r.name,s&&(l.meta.negate=!0),[l]):[]})),s()(this,"reload",(()=>{this.optionsListService.clearOptionsListCache(),this.runOptionsListQuery()})),s()(this,"destroy",(()=>{var t;super.destroy(),this.cleanupStateTools(),null===(t=this.abortController)||void 0===t||t.abort(),this.subscriptions.unsubscribe(),this.node&&r.a.unmountComponentAtNode(this.node)})),s()(this,"render",(t=>{this.node&&r.a.unmountComponentAtNode(this.node),this.node=t,r.a.render(Object(y.jsx)(x.a,{theme:S.a.getServices().core.theme},Object(y.jsx)(J.Provider,{value:this},Object(y.jsx)(G,{typeaheadSubject:this.typeaheadSubject,loadMoreSubject:this.loadMoreSubject}))),t)})),({dataViews:this.dataViewsService,optionsList:this.optionsListService}=S.a.getServices()),this.typeaheadSubject=new d.Subject,this.loadMoreSubject=new d.Subject;const n=t.createReduxEmbeddableTools({embeddable:this,reducers:U,initialComponentState:{popoverOpen:!1,allowExpensiveQueries:!0,searchString:{value:"",valid:!0}}});this.select=n.select,this.getState=n.getState,this.dispatch=n.dispatch,this.cleanupStateTools=n.cleanup,this.onStateChange=n.onStateChange,this.initialize()}clearSelections(){this.dispatch.clearSelections({})}isChained(){return!0}}},85:function(t,e,i){switch(window.__kbnThemeTag__){case"v8dark":return i(86);case"v8light":return i(88)}},86:function(t,e,i){var o=i(53),s=i(87);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);o(s,{insert:"head",singleton:!1}),t.exports=s.locals||{}},87:function(t,e,i){(e=i(54)(!1)).push([t.i,".optionsList--filterGroup{background-color:initial;box-shadow:none;width:100%}.optionsList--filterGroup .optionsList__inputButtonOverride{max-inline-size:none}.optionsList--filterGroup .optionsList--filterBtn{height:40px}.optionsList--filterGroup .optionsList--filterBtn.optionsList--filterBtnPlaceholder{color:#7a7f89;font-weight:400}.optionsList--filterGroup .optionsList--filterBtn .optionsList__filterValid{font-weight:500}.optionsList--filterGroup .optionsList--filterBtn .optionsList__filterInvalid{color:#7a7f89;font-weight:400;text-decoration:line-through}.optionsList--filterGroup .optionsList--filterBtn .optionsList__negateLabel{color:#f86b63;font-size:12px;font-weight:600}.optionsList--filterGroup .optionsList--filterBtn .euiFilterButton__text-hasNotification{flex-grow:1;justify-content:space-between;width:0}.optionsList--sortPopover{width:224px}.optionsList__existsFilter{font-style:italic;font-weight:500}.optionsList__popoverOverride{box-shadow:0 .9px 4px -1px #0003,0 2.6px 8px -1px #00000026,0 5.7px 12px -1px rgba(0,0,0,.125),0 15px 15px -1px #0000001a;filter:none}.optionsList__popover .optionsList__actions{border-bottom:1px solid;border-color:#202128;padding:0 8px}.optionsList__popover .optionsList__actions .optionsList__searchRow{padding-top:8px}.optionsList__popover .optionsList__actions .optionsList__actionsRow{margin:4px 0!important}.optionsList__popover .optionsList__actions .optionsList__actionsRow .optionsList__actionBarDivider{border-right:1px solid #343741;height:16px}.optionsList__popover .optionsList-control-ignored-selection-title{padding-left:8px}.optionsList__popover .optionsList__selectionInvalid{color:#7a7f89;text-decoration:line-through}.optionsList__popover .optionslist--loadingMoreGroupLabel{font-style:italic;height:40px!important;padding:12px;text-align:center}.optionsList__popover .optionslist--endOfOptionsGroupLabel{color:#7a7f89;font-size:12px;height:auto!important;padding:12px;text-align:center}",""]),t.exports=e},88:function(t,e,i){var o=i(53),s=i(89);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);o(s,{insert:"head",singleton:!1}),t.exports=s.locals||{}},89:function(t,e,i){(e=i(54)(!1)).push([t.i,".optionsList--filterGroup{background-color:initial;box-shadow:none;width:100%}.optionsList--filterGroup .optionsList__inputButtonOverride{max-inline-size:none}.optionsList--filterGroup .optionsList--filterBtn{height:40px}.optionsList--filterGroup .optionsList--filterBtn.optionsList--filterBtnPlaceholder{color:#69707d;font-weight:400}.optionsList--filterGroup .optionsList--filterBtn .optionsList__filterValid{font-weight:500}.optionsList--filterGroup .optionsList--filterBtn .optionsList__filterInvalid{color:#69707d;font-weight:400;text-decoration:line-through}.optionsList--filterGroup .optionsList--filterBtn .optionsList__negateLabel{color:#bd271e;font-size:12px;font-weight:600}.optionsList--filterGroup .optionsList--filterBtn .euiFilterButton__text-hasNotification{flex-grow:1;justify-content:space-between;width:0}.optionsList--sortPopover{width:224px}.optionsList__existsFilter{font-style:italic;font-weight:500}.optionsList__popoverOverride{box-shadow:0 .9px 4px -1px #00000014,0 2.6px 8px -1px #0000000f,0 5.7px 12px -1px #0000000d,0 15px 15px -1px #0000000a;filter:none}.optionsList__popover .optionsList__actions{border-bottom:1px solid;border-color:#eef2f7;padding:0 8px}.optionsList__popover .optionsList__actions .optionsList__searchRow{padding-top:8px}.optionsList__popover .optionsList__actions .optionsList__actionsRow{margin:4px 0!important}.optionsList__popover .optionsList__actions .optionsList__actionsRow .optionsList__actionBarDivider{border-right:1px solid #d3dae6;height:16px}.optionsList__popover .optionsList-control-ignored-selection-title{padding-left:8px}.optionsList__popover .optionsList__selectionInvalid{color:#69707d;text-decoration:line-through}.optionsList__popover .optionslist--loadingMoreGroupLabel{font-style:italic;height:40px!important;padding:12px;text-align:center}.optionsList__popover .optionslist--endOfOptionsGroupLabel{color:#69707d;font-size:12px;height:auto!important;padding:12px;text-align:center}",""]),t.exports=e},90:function(t,e,i){!function(e){"use strict";const i="(0?\\d+|0x[a-f0-9]+)",o={fourOctet:new RegExp(`^${i}\\.${i}\\.${i}\\.${i}$`,"i"),threeOctet:new RegExp(`^${i}\\.${i}\\.${i}$`,"i"),twoOctet:new RegExp(`^${i}\\.${i}$`,"i"),longValue:new RegExp(`^${i}$`,"i")},s=new RegExp("^0[0-7]+$","i"),n=new RegExp("^0x[a-f0-9]+$","i"),r="%[0-9a-z]{1,}",l="(?:[0-9a-f]+::?)+",a={zoneIndex:new RegExp(r,"i"),native:new RegExp(`^(::)?(${l})?([0-9a-f]+)?(::)?(${r})?$`,"i"),deprecatedTransitional:new RegExp(`^(?:::)(${i}\\.${i}\\.${i}\\.${i}(${r})?)$`,"i"),transitional:new RegExp(`^((?:${l})|(?:::)(?:${l})?)${i}\\.${i}\\.${i}\\.${i}(${r})?$`,"i")};function p(t,e){if(t.indexOf("::")!==t.lastIndexOf("::"))return null;let i,o,s=0,n=-1,r=(t.match(a.zoneIndex)||[])[0];for(r&&(r=r.substring(1),t=t.replace(/%.+$/,""));(n=t.indexOf(":",n+1))>=0;)s++;if("::"===t.substr(0,2)&&s--,"::"===t.substr(-2,2)&&s--,s>e)return null;for(o=e-s,i=":";o--;)i+="0:";return":"===(t=t.replace("::",i))[0]&&(t=t.slice(1)),":"===t[t.length-1]&&(t=t.slice(0,-1)),{parts:e=function(){const e=t.split(":"),i=[];for(let t=0;t<e.length;t++)i.push(parseInt(e[t],16));return i}(),zoneId:r}}function c(t,e,i,o){if(t.length!==e.length)throw new Error("ipaddr: cannot match CIDR for objects with different lengths");let s,n=0;for(;o>0;){if(s=i-o,s<0&&(s=0),t[n]>>s!=e[n]>>s)return!1;o-=i,n+=1}return!0}function d(t){if(n.test(t))return parseInt(t,16);if("0"===t[0]&&!isNaN(parseInt(t[1],10))){if(s.test(t))return parseInt(t,8);throw new Error(`ipaddr: cannot parse ${t} as octal`)}return parseInt(t,10)}function u(t,e){for(;t.length<e;)t=`0${t}`;return t}const h={};h.IPv4=function(){function t(t){if(4!==t.length)throw new Error("ipaddr: ipv4 octet count should be 4");let e,i;for(e=0;e<t.length;e++)if(i=t[e],!(0<=i&&i<=255))throw new Error("ipaddr: ipv4 octet should fit in 8 bits");this.octets=t}return t.prototype.SpecialRanges={unspecified:[[new t([0,0,0,0]),8]],broadcast:[[new t([255,255,255,255]),32]],multicast:[[new t([224,0,0,0]),4]],linkLocal:[[new t([169,254,0,0]),16]],loopback:[[new t([127,0,0,0]),8]],carrierGradeNat:[[new t([100,64,0,0]),10]],private:[[new t([10,0,0,0]),8],[new t([172,16,0,0]),12],[new t([192,168,0,0]),16]],reserved:[[new t([192,0,0,0]),24],[new t([192,0,2,0]),24],[new t([192,88,99,0]),24],[new t([198,51,100,0]),24],[new t([203,0,113,0]),24],[new t([240,0,0,0]),4]]},t.prototype.kind=function(){return"ipv4"},t.prototype.match=function(t,e){let i;if(void 0===e&&(i=t,t=i[0],e=i[1]),"ipv4"!==t.kind())throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one");return c(this.octets,t.octets,8,e)},t.prototype.prefixLengthFromSubnetMask=function(){let t=0,e=!1;const i={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};let o,s,n;for(o=3;o>=0;o-=1){if(s=this.octets[o],!(s in i))return null;if(n=i[s],e&&0!==n)return null;8!==n&&(e=!0),t+=n}return 32-t},t.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},t.prototype.toByteArray=function(){return this.octets.slice(0)},t.prototype.toIPv4MappedAddress=function(){return h.IPv6.parse(`::ffff:${this.toString()}`)},t.prototype.toNormalizedString=function(){return this.toString()},t.prototype.toString=function(){return this.octets.join(".")},t}(),h.IPv4.broadcastAddressFromCIDR=function(t){try{const e=this.parseCIDR(t),i=e[0].toByteArray(),o=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),s=[];let n=0;for(;n<4;)s.push(parseInt(i[n],10)|255^parseInt(o[n],10)),n++;return new this(s)}catch(t){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.isIPv4=function(t){return null!==this.parser(t)},h.IPv4.isValid=function(t){try{return new this(this.parser(t)),!0}catch(t){return!1}},h.IPv4.isValidFourPartDecimal=function(t){return!(!h.IPv4.isValid(t)||!t.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/))},h.IPv4.networkAddressFromCIDR=function(t){let e,i,o,s,n;try{for(e=this.parseCIDR(t),o=e[0].toByteArray(),n=this.subnetMaskFromPrefixLength(e[1]).toByteArray(),s=[],i=0;i<4;)s.push(parseInt(o[i],10)&parseInt(n[i],10)),i++;return new this(s)}catch(t){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}},h.IPv4.parse=function(t){const e=this.parser(t);if(null===e)throw new Error("ipaddr: string is not formatted like an IPv4 Address");return new this(e)},h.IPv4.parseCIDR=function(t){let e;if(e=t.match(/^(.+)\/(\d+)$/)){const t=parseInt(e[2]);if(t>=0&&t<=32){const i=[this.parse(e[1]),t];return Object.defineProperty(i,"toString",{value:function(){return this.join("/")}}),i}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")},h.IPv4.parser=function(t){let e,i,s;if(e=t.match(o.fourOctet))return function(){const t=e.slice(1,6),o=[];for(let e=0;e<t.length;e++)i=t[e],o.push(d(i));return o}();if(e=t.match(o.longValue)){if(s=d(e[1]),s>4294967295||s<0)throw new Error("ipaddr: address outside defined range");return function(){const t=[];let e;for(e=0;e<=24;e+=8)t.push(s>>e&255);return t}().reverse()}return(e=t.match(o.twoOctet))?function(){const t=e.slice(1,4),i=[];if(s=d(t[1]),s>16777215||s<0)throw new Error("ipaddr: address outside defined range");return i.push(d(t[0])),i.push(s>>16&255),i.push(s>>8&255),i.push(255&s),i}():(e=t.match(o.threeOctet))?function(){const t=e.slice(1,5),i=[];if(s=d(t[2]),s>65535||s<0)throw new Error("ipaddr: address outside defined range");return i.push(d(t[0])),i.push(d(t[1])),i.push(s>>8&255),i.push(255&s),i}():null},h.IPv4.subnetMaskFromPrefixLength=function(t){if((t=parseInt(t))<0||t>32)throw new Error("ipaddr: invalid IPv4 prefix length");const e=[0,0,0,0];let i=0;const o=Math.floor(t/8);for(;i<o;)e[i]=255,i++;return o<4&&(e[o]=Math.pow(2,t%8)-1<<8-t%8),new this(e)},h.IPv6=function(){function t(t,e){let i,o;if(16===t.length)for(this.parts=[],i=0;i<=14;i+=2)this.parts.push(t[i]<<8|t[i+1]);else{if(8!==t.length)throw new Error("ipaddr: ipv6 part count should be 8 or 16");this.parts=t}for(i=0;i<this.parts.length;i++)if(o=this.parts[i],!(0<=o&&o<=65535))throw new Error("ipaddr: ipv6 part should fit in 16 bits");e&&(this.zoneId=e)}return t.prototype.SpecialRanges={unspecified:[new t([0,0,0,0,0,0,0,0]),128],linkLocal:[new t([65152,0,0,0,0,0,0,0]),10],multicast:[new t([65280,0,0,0,0,0,0,0]),8],loopback:[new t([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new t([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new t([0,0,0,0,0,65535,0,0]),96],rfc6145:[new t([0,0,0,0,65535,0,0,0]),96],rfc6052:[new t([100,65435,0,0,0,0,0,0]),96],"6to4":[new t([8194,0,0,0,0,0,0,0]),16],teredo:[new t([8193,0,0,0,0,0,0,0]),32],reserved:[[new t([8193,3512,0,0,0,0,0,0]),32]]},t.prototype.isIPv4MappedAddress=function(){return"ipv4Mapped"===this.range()},t.prototype.kind=function(){return"ipv6"},t.prototype.match=function(t,e){let i;if(void 0===e&&(i=t,t=i[0],e=i[1]),"ipv6"!==t.kind())throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one");return c(this.parts,t.parts,16,e)},t.prototype.prefixLengthFromSubnetMask=function(){let t=0,e=!1;const i={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};let o,s;for(let n=7;n>=0;n-=1){if(o=this.parts[n],!(o in i))return null;if(s=i[o],e&&0!==s)return null;16!==s&&(e=!0),t+=s}return 128-t},t.prototype.range=function(){return h.subnetMatch(this,this.SpecialRanges)},t.prototype.toByteArray=function(){let t;const e=[],i=this.parts;for(let o=0;o<i.length;o++)t=i[o],e.push(t>>8),e.push(255&t);return e},t.prototype.toFixedLengthString=function(){const t=function(){const t=[];for(let e=0;e<this.parts.length;e++)t.push(u(this.parts[e].toString(16),4));return t}.call(this).join(":");let e="";return this.zoneId&&(e=`%${this.zoneId}`),t+e},t.prototype.toIPv4Address=function(){if(!this.isIPv4MappedAddress())throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4");const t=this.parts.slice(-2),e=t[0],i=t[1];return new h.IPv4([e>>8,255&e,i>>8,255&i])},t.prototype.toNormalizedString=function(){const t=function(){const t=[];for(let e=0;e<this.parts.length;e++)t.push(this.parts[e].toString(16));return t}.call(this).join(":");let e="";return this.zoneId&&(e=`%${this.zoneId}`),t+e},t.prototype.toRFC5952String=function(){const t=/((^|:)(0(:|$)){2,})/g,e=this.toNormalizedString();let i,o=0,s=-1;for(;i=t.exec(e);)i[0].length>s&&(o=i.index,s=i[0].length);return s<0?e:`${e.substring(0,o)}::${e.substring(o+s)}`},t.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")},t}(),h.IPv6.isIPv6=function(t){return null!==this.parser(t)},h.IPv6.isValid=function(t){if("string"==typeof t&&-1===t.indexOf(":"))return!1;try{const e=this.parser(t);return new this(e.parts,e.zoneId),!0}catch(t){return!1}},h.IPv6.parse=function(t){const e=this.parser(t);if(null===e.parts)throw new Error("ipaddr: string is not formatted like an IPv6 Address");return new this(e.parts,e.zoneId)},h.IPv6.parseCIDR=function(t){let e,i,o;if((i=t.match(/^(.+)\/(\d+)$/))&&(e=parseInt(i[2]),e>=0&&e<=128))return o=[this.parse(i[1]),e],Object.defineProperty(o,"toString",{value:function(){return this.join("/")}}),o;throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")},h.IPv6.parser=function(t){let e,i,o,s,n,r;if(o=t.match(a.deprecatedTransitional))return this.parser(`::ffff:${o[1]}`);if(a.native.test(t))return p(t,8);if((o=t.match(a.transitional))&&(r=o[6]||"",e=p(o[1].slice(0,-1)+r,6),e.parts)){for(n=[parseInt(o[2]),parseInt(o[3]),parseInt(o[4]),parseInt(o[5])],i=0;i<n.length;i++)if(s=n[i],!(0<=s&&s<=255))return null;return e.parts.push(n[0]<<8|n[1]),e.parts.push(n[2]<<8|n[3]),{parts:e.parts,zoneId:e.zoneId}}return null},h.fromByteArray=function(t){const e=t.length;if(4===e)return new h.IPv4(t);if(16===e)return new h.IPv6(t);throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")},h.isValid=function(t){return h.IPv6.isValid(t)||h.IPv4.isValid(t)},h.parse=function(t){if(h.IPv6.isValid(t))return h.IPv6.parse(t);if(h.IPv4.isValid(t))return h.IPv4.parse(t);throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")},h.parseCIDR=function(t){try{return h.IPv6.parseCIDR(t)}catch(e){try{return h.IPv4.parseCIDR(t)}catch(t){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}},h.process=function(t){const e=this.parse(t);return"ipv6"===e.kind()&&e.isIPv4MappedAddress()?e.toIPv4Address():e},h.subnetMatch=function(t,e,i){let o,s,n,r;for(s in null==i&&(i="unicast"),e)if(Object.prototype.hasOwnProperty.call(e,s))for(n=e[s],!n[0]||n[0]instanceof Array||(n=[n]),o=0;o<n.length;o++)if(r=n[o],t.kind()===r[0].kind()&&t.match.apply(t,r))return s;return i},t.exports?t.exports=h:e.ipaddr=h}(this)}}]);