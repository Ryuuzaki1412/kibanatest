/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(n){var t={};function e(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return n[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var i in n)e.d(r,i,function(t){return n[t]}.bind(null,i));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=5)}([function(n,t){n.exports=__kbnSharedDeps__.KbnI18n},function(n,t){n.exports=__kbnSharedDeps__.Lodash},function(n,t,e){"use strict";e.r(t),e.d(t,"AlertingConnectorFeatureId",(function(){return i})),e.d(t,"CasesConnectorFeatureId",(function(){return u})),e.d(t,"UptimeConnectorFeatureId",(function(){return o})),e.d(t,"SecurityConnectorFeatureId",(function(){return a})),e.d(t,"GenerativeAIConnectorFeatureId",(function(){return l})),e.d(t,"InvalidEmailReason",(function(){return C})),e.d(t,"isActionTypeExecutorResult",(function(){return F})),e.d(t,"ALERT_HISTORY_PREFIX",(function(){return S})),e.d(t,"AlertHistoryDefaultIndexName",(function(){return T})),e.d(t,"AlertHistoryEsIndexConnectorId",(function(){return k})),e.d(t,"buildAlertHistoryDocument",(function(){return w})),e.d(t,"AlertHistoryDocumentTemplate",(function(){return j})),e.d(t,"MustacheInEmailRegExp",(function(){return P})),e.d(t,"hasMustacheTemplate",(function(){return R})),e.d(t,"withoutMustacheTemplate",(function(){return M})),e.d(t,"validateEmailAddressesAsAlwaysValid",(function(){return N})),e.d(t,"validateEmailAddresses",(function(){return G})),e.d(t,"invalidEmailsAsMessage",(function(){return L})),e.d(t,"GenerativeAIForObservabilityConnectorFeatureId",(function(){return s})),e.d(t,"AlertingConnectorFeature",(function(){return m})),e.d(t,"CasesConnectorFeature",(function(){return v})),e.d(t,"UptimeConnectorFeature",(function(){return g})),e.d(t,"SecuritySolutionFeature",(function(){return b})),e.d(t,"GenerativeAIFeature",(function(){return h})),e.d(t,"GenerativeAIForObservabilityFeature",(function(){return y})),e.d(t,"areValidFeatures",(function(){return _})),e.d(t,"getConnectorFeatureName",(function(){return x})),e.d(t,"getConnectorCompatibility",(function(){return I})),e.d(t,"EMPTY_EXECUTION_KPI_RESULT",(function(){return H})),e.d(t,"executionLogSortableColumns",(function(){return q})),e.d(t,"BASE_ACTION_API_PATH",(function(){return $})),e.d(t,"INTERNAL_BASE_ACTION_API_PATH",(function(){return B})),e.d(t,"ACTIONS_FEATURE_ID",(function(){return V})),e.d(t,"DEFAULT_MICROSOFT_EXCHANGE_URL",(function(){return X})),e.d(t,"DEFAULT_MICROSOFT_GRAPH_API_URL",(function(){return z})),e.d(t,"DEFAULT_MICROSOFT_GRAPH_API_SCOPE",(function(){return K}));var r=e(0);const i="alerting",u="cases",o="uptime",a="siem",l="generativeAI",s="generativeAIForObservability",c=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAI",{defaultMessage:"Generative AI"}),d=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.generativeAIForObservability",{defaultMessage:"Generative AI For Observability"}),f=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.alertingRules",{defaultMessage:"Alerting Rules"}),p=r.i18n.translate("xpack.actions.availableConnectorFeatures.compatibility.cases",{defaultMessage:"Cases"}),m={id:i,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.alerting",{defaultMessage:"Alerting"}),compatibility:f},v={id:u,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.cases",{defaultMessage:"Cases"}),compatibility:p},g={id:o,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.uptime",{defaultMessage:"Uptime"}),compatibility:f},b={id:a,name:r.i18n.translate("xpack.actions.availableConnectorFeatures.securitySolution",{defaultMessage:"Security Solution"}),compatibility:f},h={id:l,name:c,compatibility:c},y={id:s,name:d,compatibility:d},A={[m.id]:m,[v.id]:v,[g.id]:g,[b.id]:b,[h.id]:h,[y.id]:y};function _(n){return n.every((n=>!!A[n]))}function x(n){const t=A[n];return t?t.name:n}function I(n){const t=new Set;if(n&&n.length>0)for(const e of n)A[e]&&t.add(A[e].compatibility);return Array.from(t)}let C;!function(n){n.invalid="invalid",n.notAllowed="notAllowed"}(C||(C={}));const O=["ok","error"];function F(n){const t=n;return t&&"string"==typeof(null==t?void 0:t.actionId)&&O.includes(null==t?void 0:t.status)}var E=e(1);const S="kibana-alert-history-",T=`${S}default`,k="preconfigured-alert-history-es-index",w=n=>{const{date:t,alert:e,context:r,params:i,tags:u,rule:o}=n;if(!e||!o)return null;const{actionGroup:a,actionGroupName:l,id:s}=e,{id:c,name:d,spaceId:f,type:p}=o;if(!p)return null;const m=p.replace(/\./g,"__"),v={...c?{id:c}:{},...d?{name:d}:{},...Object(E.isEmpty)(i)?{}:{params:{[m]:i}},...f?{space:f}:{},...p?{type:p}:{}},g={...s?{id:s}:{},...Object(E.isEmpty)(r)?{}:{context:{[m]:r}},...a?{actionGroup:a}:{},...l?{actionGroupName:l}:{}},b={"@timestamp":t||(new Date).toISOString(),...u&&u.length>0?{tags:u}:{},...null!=r&&r.message?{message:r.message}:{},...Object(E.isEmpty)(v)?{}:{rule:v},...Object(E.isEmpty)(g)?{}:{kibana:{alert:g}}};return Object(E.isEmpty)(b)?null:{...b,event:{kind:"alert"}}},j=Object.freeze(w({rule:{id:"{{rule.id}}",name:"{{rule.name}}",type:"{{rule.type}}",spaceId:"{{rule.spaceId}}"},context:"{{context}}",params:"{{rule.params}}",tags:"{{rule.tags}}",alert:{id:"{{alert.id}}",actionGroup:"{{alert.actionGroup}}",actionGroupName:"{{alert.actionGroupName}}"}})),P=/\{\{((.|\n)*)\}\}/;function R(n){return!!n.match(P)}function M(n){return n.filter((n=>!R(n)))}var D=e(4);function N(n){return n.map((n=>({address:n,valid:!0})))}function G(n,t,e={}){return t.map((t=>function(n,t,e){if(e.treatMustacheTemplatesAsValid&&R(t))return{address:t,valid:!0};try{return function(n,t){const e=Object(D.parseAddressList)(t);if(null==e)return{address:t,valid:!1,reason:C.invalid};if(null!==n){const r=new Set(n);for(const n of e){let e=[];if("group"===n.type)e=n.addresses.map((n=>n.domain));else{if("mailbox"!==n.type)return{address:t,valid:!1,reason:C.invalid};e=[n.domain]}for(const n of e)if(!r.has(n))return{address:t,valid:!1,reason:C.notAllowed}}}return{address:t,valid:!0}}(n,t)}catch(n){return{address:t,valid:!1,reason:C.invalid}}}(n,t,e)))}function L(n){const t=n.filter((n=>!n.valid&&n.reason===C.invalid)),e=n.filter((n=>!n.valid&&n.reason===C.notAllowed)),r=[];if(0!==t.length&&r.push(`not valid emails: ${U(t).join(", ")}`),0!==e.length&&r.push(`not allowed emails: ${U(e).join(", ")}`),0!==r.length)return r.join("; ")}function U(n){return n.map((n=>n.address))}const H={success:0,unknown:0,failure:0,warning:0},q=["timestamp","execution_duration","schedule_delay"],$="/api/actions",B="/internal/actions",V="actions",X="https://login.microsoftonline.com",z="https://graph.microsoft.com/v1.0",K="https://graph.microsoft.com/.default"},function(n,t,e){n.exports=e(7)(2)},function(n,t,e){!function(t){"use strict";function e(n){function t(){return On<Fn}function e(){return On}function i(n){On=n}function u(){On=0,Fn=Cn.length}function o(n,t){return{name:n,tokens:t||"",semantic:t||"",children:[]}}function a(n,t){var e;return null===t?null:((e=o(n)).tokens=t.tokens,e.semantic=t.semantic,e.children.push(t),e)}function l(n,t){return null!==t&&(n.tokens+=t.tokens,n.semantic+=t.semantic),n.children.push(t),n}function s(n){var e;return t()&&n(e=Cn[On])?(On+=1,o("token",e)):null}function c(){return null}function d(n){return function(){return a("literal",s((function(t){return t===n})))}}function f(){var n=arguments;return function(){var t,r,u,a;for(a=e(),r=o("and"),t=0;t<n.length;t+=1){if(null===(u=n[t]()))return i(a),null;l(r,u)}return r}}function p(){var n=arguments;return function(){var t,r,u;for(u=e(),t=0;t<n.length;t+=1){if(null!==(r=n[t]()))return r;i(u)}return null}}function m(n){return function(){var t,r;return r=e(),null!==(t=n())?t:(i(r),o("opt"))}}function v(n){return function(){var t=n();return null!==t&&(t.semantic=""),t}}function g(n){return function(){var t=n();return null!==t&&t.semantic.length>0&&(t.semantic=" "),t}}function b(n,t){return function(){var r,u,a,s,c;for(s=e(),r=o("star"),a=0,c=void 0===t?0:t;null!==(u=n());)a+=1,l(r,u);return a>=c?r:(i(s),null)}}function h(n){return n.charCodeAt(0)>=128}function y(){return a("cr",d("\r")())}function A(){return a("crlf",f(y,I)())}function _(){return a("dquote",d('"')())}function x(){return a("htab",d("\t")())}function I(){return a("lf",d("\n")())}function C(){return a("sp",d(" ")())}function O(){return a("vchar",s((function(t){var e=t.charCodeAt(0),r=33<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r})))}function F(){return a("wsp",p(C,x)())}function E(){var n=a("quoted-pair",p(f(d("\\"),p(O,F)),un)());return null===n?null:(n.semantic=n.semantic[1],n)}function S(){return a("fws",p(an,f(m(f(b(F),v(A))),b(F,1)))())}function T(){return a("ctext",p((function(){return s((function(t){var e=t.charCodeAt(0),r=33<=e&&e<=39||42<=e&&e<=91||93<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r}))}),en)())}function k(){return a("ccontent",p(T,E,w)())}function w(){return a("comment",f(d("("),b(f(m(S),k)),m(S),d(")"))())}function j(){return a("cfws",p(f(b(f(m(S),w),1),m(S)),S)())}function P(){return a("atext",s((function(t){var e="a"<=t&&t<="z"||"A"<=t&&t<="Z"||"0"<=t&&t<="9"||["!","#","$","%","&","'","*","+","-","/","=","?","^","_","`","{","|","}","~"].indexOf(t)>=0;return n.rfc6532&&(e=e||h(t)),e})))}function R(){return a("atom",f(g(m(j)),b(P,1),g(m(j)))())}function M(){var n,t;return null===(n=a("dot-atom-text",b(P,1)()))||null!==(t=b(f(d("."),b(P,1)))())&&l(n,t),n}function D(){return a("dot-atom",f(v(m(j)),M,v(m(j)))())}function N(){return a("qtext",p((function(){return s((function(t){var e=t.charCodeAt(0),r=33===e||35<=e&&e<=91||93<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r}))}),rn)())}function G(){return a("qcontent",p(N,E)())}function L(){return a("quoted-string",f(v(m(j)),v(_),b(f(m(g(S)),G)),m(v(S)),v(_),v(m(j)))())}function U(){return a("word",p(R,L)())}function H(){return a("address",p(q,V)())}function q(){return a("mailbox",p($,nn)())}function $(){return a("name-addr",f(m(X),B)())}function B(){return a("angle-addr",p(f(v(m(j)),d("<"),nn,d(">"),v(m(j))),ln)())}function V(){return a("group",f(X,d(":"),m(W),d(";"),v(m(j)))())}function X(){return a("display-name",(null!==(n=a("phrase",p(on,b(U,1))()))&&(n.semantic=n.semantic.replace(/([ \t]|\r\n)+/g," ").replace(/^\s*/,"").replace(/\s*$/,"")),n));var n}function z(){return a("mailbox-list",p(f(q,b(f(d(","),q))),dn)())}function K(){return a("address-list",p(f(H,b(f(d(n.addressListSeparator),H))),fn)())}function W(){return a("group-list",p(z,v(j),pn)())}function Y(){return a("local-part",p(mn,D,L)())}function Z(){return a("dtext",p((function(){return s((function(t){var e=t.charCodeAt(0),r=33<=e&&e<=90||94<=e&&e<=126;return n.rfc6532&&(r=r||h(t)),r}))}),gn)())}function J(){return a("domain-literal",f(v(m(j)),d("["),b(f(m(S),Z)),m(S),d("]"),v(m(j)))())}function Q(){return a("domain",(t=p(vn,D,J)(),n.rejectTLD&&t&&t.semantic&&t.semantic.indexOf(".")<0?null:(t&&(t.semantic=t.semantic.replace(/\s+/g,"")),t)));var t}function nn(){return a("addr-spec",f(Y,d("@"),Q)())}function tn(){return n.strict?null:a("obs-NO-WS-CTL",s((function(n){var t=n.charCodeAt(0);return 1<=t&&t<=8||11===t||12===t||14<=t&&t<=31||127===t})))}function en(){return n.strict?null:a("obs-ctext",tn())}function rn(){return n.strict?null:a("obs-qtext",tn())}function un(){return n.strict?null:a("obs-qp",f(d("\\"),p(d("\0"),tn,I,y))())}function on(){return n.strict?null:a("obs-phrase",f(U,b(p(U,d("."),n.atInDisplayName?d("@"):c,n.commaInDisplayName?d(","):c,g(j))))())}function an(){return n.strict?null:a("obs-FWS",b(f(v(m(A)),F),1)())}function ln(){return n.strict?null:a("obs-angle-addr",f(v(m(j)),d("<"),sn,nn,d(">"),v(m(j)))())}function sn(){return n.strict?null:a("obs-route",f(cn,d(":"))())}function cn(){return n.strict?null:a("obs-domain-list",f(b(p(v(j),d(","))),d("@"),Q,b(f(d(","),v(m(j)),m(f(d("@"),Q)))))())}function dn(){return n.strict?null:a("obs-mbox-list",f(b(f(v(m(j)),d(","))),q,b(f(d(","),m(f(q,v(j))))))())}function fn(){return n.strict?null:a("obs-addr-list",f(b(f(v(m(j)),d(","))),H,b(f(d(","),m(f(H,v(j))))))())}function pn(){return n.strict?null:a("obs-group-list",f(b(f(v(m(j)),d(",")),1),v(m(j)))())}function mn(){return n.strict?null:a("obs-local-part",f(U,b(f(d("."),U)))())}function vn(){return n.strict?null:a("obs-domain",f(R,b(f(d("."),R)))())}function gn(){return n.strict?null:a("obs-dtext",p(tn,E)())}function bn(n,t){var e,r,i;if(null==t)return null;for(r=[t];r.length>0;){if((i=r.pop()).name===n)return i;for(e=i.children.length-1;e>=0;e-=1)r.push(i.children[e])}return null}function hn(n,t){var e,r,i,u,o;if(null==t)return null;for(r=[t],u=[],o={},e=0;e<n.length;e+=1)o[n[e]]=!0;for(;r.length>0;)if((i=r.pop()).name in o)u.push(i);else for(e=i.children.length-1;e>=0;e-=1)r.push(i.children[e]);return u}function yn(t){var e,r,i,u,o;if(null===t)return null;for(e=[],r=hn(["group","mailbox"],t),i=0;i<r.length;i+=1)"group"===(u=r[i]).name?e.push(An(u)):"mailbox"===u.name&&e.push(_n(u));return o={ast:t,addresses:e},n.simple&&(o=function(n){var t;if(n&&n.addresses)for(t=0;t<n.addresses.length;t+=1)delete n.addresses[t].node;return n}(o)),n.oneResult?function(t){return t?!n.partial&&t.addresses.length>1?null:t.addresses&&t.addresses[0]:null}(o):n.simple?o&&o.addresses:o}function An(n){var t,e=bn("display-name",n),r=[],i=hn(["mailbox"],n);for(t=0;t<i.length;t+=1)r.push(_n(i[t]));return{node:n,parts:{name:e},type:n.name,name:xn(e),addresses:r}}function _n(n){var t=bn("display-name",n),e=bn("addr-spec",n),r=function(n,t){var e,r,i,u;if(null==t)return null;for(r=[t],u=[];r.length>0;)for("cfws"===(i=r.pop()).name&&u.push(i),e=i.children.length-1;e>=0;e-=1)r.push(i.children[e]);return u}(0,n),i=hn(["comment"],n),u=bn("local-part",e),o=bn("domain",e);return{node:n,parts:{name:t,address:e,local:u,domain:o,comments:r},type:n.name,name:xn(t),address:xn(e),local:xn(u),domain:xn(o),comments:In(i),groupName:xn(n.groupName)}}function xn(n){return null!=n?n.semantic:null}function In(n){var t="";if(n)for(var e=0;e<n.length;e+=1)t+=xn(n[e]);return t}var Cn,On,Fn,En,Sn;if(null===(n=r(n,{})))return null;if(Cn=n.input,Sn={address:H,"address-list":K,"angle-addr":B,from:function(){return a("from",p(z,K)())},group:V,mailbox:q,"mailbox-list":z,"reply-to":function(){return a("reply-to",K())},sender:function(){return a("sender",p(q,H)())}}[n.startAt]||K,!n.strict){if(u(),n.strict=!0,En=Sn(Cn),n.partial||!t())return yn(En);n.strict=!1}return u(),En=Sn(Cn),!n.partial&&t()?null:yn(En)}function r(n,t){function e(n){return"[object String]"===Object.prototype.toString.call(n)}function r(n){return null==n}var i,u;if(e(n))n={input:n};else if(!function(n){return n===Object(n)}(n))return null;if(!e(n.input))return null;if(!t)return null;for(u in i={oneResult:!1,partial:!1,rejectTLD:!1,rfc6532:!1,simple:!1,startAt:"address-list",strict:!1,atInDisplayName:!1,commaInDisplayName:!1,addressListSeparator:","})r(n[u])&&(n[u]=r(t[u])?i[u]:t[u]);return n}e.parseOneAddress=function(n){return e(r(n,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"address-list"}))},e.parseAddressList=function(n){return e(r(n,{rfc6532:!0,simple:!0,startAt:"address-list"}))},e.parseFrom=function(n){return e(r(n,{rfc6532:!0,simple:!0,startAt:"from"}))},e.parseSender=function(n){return e(r(n,{oneResult:!0,rfc6532:!0,simple:!0,startAt:"sender"}))},e.parseReplyTo=function(n){return e(r(n,{rfc6532:!0,simple:!0,startAt:"reply-to"}))},void 0!==n.exports?n.exports=e:t.emailAddresses=e}(this)},function(n,t,e){e(6),__kbnBundles__.define("plugin/actions/public",e,8),__kbnBundles__.define("plugin/actions/common",e,2)},function(n,t,e){e.p=window.__kbnPublicPath__.actions},function(n,t){n.exports=__kbnSharedDeps_npm__},function(n,t,e){"use strict";e.r(t),e.d(t,"Plugin",(function(){return plugin_Plugin})),e.d(t,"plugin",(function(){return o}));var r=e(3),i=e.n(r),u=e(2);class plugin_Plugin{constructor(n){var t;i()(this,"allowedEmailDomains",null);const e=n.config.get();this.allowedEmailDomains=(null===(t=e.email)||void 0===t?void 0:t.domain_allowlist)||null}setup(){return{validateEmailAddresses:(n,t)=>Object(u.validateEmailAddresses)(this.allowedEmailDomains,n,t)}}start(){}}function o(n){return new plugin_Plugin(n)}}]);