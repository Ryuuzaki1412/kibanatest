/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[8],{119:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return p})),a.d(t,"c",(function(){return h})),a.d(t,"d",(function(){return y}));var n=a(2),r=a(16),i=a(5),s=a(25),l=a(109),o=a.n(l),c=a(10),u=a(132),d=a(113);const m={palette:"cool",steps:10,reverseColors:!1},p={metric:{type:"cpu"},groupBy:[],nodeType:"host",view:"map",customOptions:[],boundsOverride:{max:1,min:0},autoBounds:!0,accountId:"",region:"",customMetrics:[],legend:m,source:"default",sort:{by:"name",direction:"desc"},timelineOpen:!1},g=e=>c.e.encode(e),f=e=>{const t=Object(r.pipe)(c.e.decode(e),Object(i.fold)(Object(s.constant)(void 0),s.identity));return t&&(t.source="url"),t},b=o()((()=>{const[e,t]=Object(d.a)({defaultState:p,decodeUrlState:f,encodeUrlState:g,urlStateKey:"waffleOptions"}),[a,r]=Object(n.useState)(e);Object(n.useEffect)((()=>t(a)),[t,a]);const i=Object(n.useCallback)((e=>r((t=>({...t,metric:e})))),[r]),s=Object(n.useCallback)((e=>r((t=>({...t,groupBy:e})))),[r]),l=Object(n.useCallback)((e=>r((t=>({...t,nodeType:e})))),[r]),o=Object(n.useCallback)((e=>r((t=>({...t,view:e})))),[r]),c=Object(n.useCallback)((e=>r((t=>({...t,customOptions:e})))),[r]),m=Object(n.useCallback)((e=>r((t=>({...t,autoBounds:e})))),[r]),b=Object(n.useCallback)((e=>r((t=>({...t,boundsOverride:e})))),[r]),h=Object(n.useCallback)((e=>r((t=>({...t,accountId:e})))),[r]),y=Object(n.useCallback)((e=>r((t=>({...t,region:e})))),[r]),E=Object(n.useCallback)((e=>{r((t=>({...t,customMetrics:e})))}),[r]),v=Object(n.useCallback)((e=>{r((t=>({...t,legend:e})))}),[r]),x=Object(n.useCallback)((e=>{r((t=>({...t,sort:e})))}),[r]),{inventoryPrefill:w}=Object(u.b)();Object(n.useEffect)((()=>{const{setNodeType:e,setMetric:t,setCustomMetrics:n}=w;e(a.nodeType),t(a.metric),n(a.customMetrics)}),[a,w]);const k=Object(n.useCallback)((e=>r((t=>({...t,timelineOpen:e})))),[r]);return{...p,...a,changeMetric:i,changeGroupBy:s,changeNodeType:l,changeView:o,changeCustomOptions:c,changeAutoBounds:m,changeBoundsOverride:b,changeAccount:h,changeRegion:y,changeCustomMetrics:E,changeLegend:v,changeSort:x,changeTimelineOpen:k,setWaffleOptionsState:r}})),[h,y]=b},121:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),r=a.n(n),i=a(1),s=a(24),l=a(83),o=a(111);function c(e,t,a,c=(e=>e),u,d,m=!1,p){var g;const f=Object(s.useKibana)(),b=u||(null===(g=f.services.http)||void 0===g?void 0:g.fetch),h=d||f.notifications.toasts.danger,[y,E]=Object(n.useState)(null),[v,x]=Object(n.useState)(null),w=Object(n.useRef)(new AbortController),k=Object(n.useCallback)((e=>{var t,a,n,s,c;const u=e;e&&(e instanceof o.a||e.name===l.AbortError.name)||(x(u),h({toastLifeTimeMs:3e3,title:i.i18n.translate("xpack.infra.useHTTPRequest.error.title",{defaultMessage:"Error while fetching resource"}),body:r.a.createElement("div",null,u.response?r.a.createElement(r.a.Fragment,null,r.a.createElement("h5",null,i.i18n.translate("xpack.infra.useHTTPRequest.error.status",{defaultMessage:"Error"})),null===(t=u.response)||void 0===t?void 0:t.statusText," (",null===(a=u.response)||void 0===a?void 0:a.status,")",r.a.createElement("h5",null,i.i18n.translate("xpack.infra.useHTTPRequest.error.url",{defaultMessage:"URL"})),null===(n=u.response)||void 0===n?void 0:n.url,r.a.createElement("h5",null,i.i18n.translate("xpack.infra.useHTTPRequest.error.body.message",{defaultMessage:"Message"})),(null===(s=u.body)||void 0===s?void 0:s.message)||u.message):r.a.createElement("h5",null,(null===(c=u.body)||void 0===c?void 0:c.message)||u.message))}))}),[h]);Object(n.useEffect)((()=>()=>{m&&w.current.abort()}),[m]);const[O,M,j]=Object(o.b)({cancelPreviousOn:"resolution",createPromise:()=>{if(!b)throw new Error("HTTP service is unavailable");return m&&w.current.abort(),w.current=new AbortController,b(e,{signal:w.current.signal,method:t,body:a,...p})},onResolve:e=>{try{E(c(e)),x(null)}catch(e){k(e)}},onReject:e=>{k(e)}},[e,a,t,u,h,k,p]);return{response:y,error:v,loading:"uninitialized"===O.state||"pending"===O.state,makeRequest:M,resetRequestState:j}}},140:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),r=a(172),i=function(){};t.default=function(e,t,a){if(!r.isClient)return[t,i,i];if(!e)throw new Error("useLocalStorage key may not be falsy");var s=a?a.raw?function(e){return e}:a.deserializer:JSON.parse,l=n.useState((function(){try{var n=a?a.raw?String:a.serializer:JSON.stringify,r=localStorage.getItem(e);return null!==r?s(r):(t&&localStorage.setItem(e,n(t)),t)}catch(e){return t}})),o=l[0],c=l[1],u=n.useCallback((function(t){try{var n="function"==typeof t?t(o):t;if(void 0===n)return;var r;r=a?a.raw?"string"==typeof n?n:JSON.stringify(n):a.serializer?a.serializer(n):JSON.stringify(n):JSON.stringify(n),localStorage.setItem(e,r),c(s(r))}catch(e){}}),[e,c]),d=n.useCallback((function(){try{localStorage.removeItem(e),c(void 0)}catch(e){}}),[e,c]);return[o,u,d]}},154:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(1);const r=e=>{const t={avg:n.i18n.translate("xpack.infra.waffle.aggregationNames.avg",{defaultMessage:"Avg of {field}",values:{field:e.field}}),max:n.i18n.translate("xpack.infra.waffle.aggregationNames.max",{defaultMessage:"Max of {field}",values:{field:e.field}}),min:n.i18n.translate("xpack.infra.waffle.aggregationNames.min",{defaultMessage:"Min of {field}",values:{field:e.field}}),rate:n.i18n.translate("xpack.infra.waffle.aggregationNames.rate",{defaultMessage:"Rate of {field}",values:{field:e.field}})};return e.label?e.label:t[e.aggregation]}},155:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(67),r=a(2),i=n.__importDefault(a(169));t.default=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=[]);var n=i.default(e,t),s=n[0],l=n[1],o=n[2];return r.useEffect(o,a),[s,l]}},165:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(85),r=a(24),i=a(28),s=a(139),l=a(19);function o(e,t,a,{fromTimestamp:o,toTimestamp:c,interval:u},d=!0){const{http:m}=Object(r.useKibana)().services,{isLoading:p,data:g,error:f,refetch:b,fetchNextPage:h}=Object(n.useInfiniteQuery)({queryKey:["metricExplorer",e,o,c],queryFn:async({signal:n,pageParam:r={afterKey:null}})=>{if(!o||!c)throw new Error("Unable to parse timerange");if(!m)throw new Error("HTTP service is unavailable");if(!t)throw new Error("Source is unavailable");const{afterKey:d}=r,p=await m.post("/api/infra/metrics_explorer",{method:"POST",body:JSON.stringify({forceInterval:e.forceInterval,dropLastBucket:null==e.dropLastBucket||e.dropLastBucket,metrics:"count"===e.aggregation?[{aggregation:"count"}]:e.metrics,groupBy:e.groupBy,afterKey:d,limit:e.limit,indexPattern:t.metricAlias,filterQuery:e.filterQuery&&Object(s.a)(e.filterQuery,a)||void 0,timerange:{interval:u,from:o,to:c}}),signal:n});return Object(l.b)(i.f)(p)},getNextPageParam:e=>e.pageInfo,enabled:d&&!!o&&!!c&&!!m&&!!t,refetchOnWindowFocus:!1});return{data:g,error:f,fetchNextPage:h,isLoading:p,refetch:b}}},166:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(5),r=a(25),i=a(16),s=a(2),l=a(19),o=a(121),c=a(33);function u({timerange:e,currentTime:t,accountId:a="",region:u="",groupBy:d=null,sendRequestImmediately:m=!0,includeTimeseries:p=!0,dropPartialBuckets:g=!0,requestTs:f,...b},h){const y={...b,accountId:a,region:u,groupBy:d,timerange:null!=e?e:{interval:"1m",to:t,from:t-12e5,lookbackSize:5},includeTimeseries:p,dropPartialBuckets:g},{error:E,loading:v,response:x,makeRequest:w,resetRequestState:k}=Object(o.a)("/api/metrics/snapshot","POST",JSON.stringify(y),(e=>Object(i.pipe)(c.g.decode(e),Object(n.fold)(Object(l.d)(l.a),r.identity))),void 0,void 0,null==h?void 0:h.abortable);return Object(s.useEffect)((()=>(m&&w(),()=>{k()})),[w,m,k,f]),{error:E&&E.message||null,loading:v,nodes:x?x.nodes:[],interval:x?x.interval:"60s",reload:w}}},167:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(8),r=a(43),i=a(33),s=a(146),l=a(46);const o={count:{formatter:r.b.number,template:"{{value}}"},cpu:{formatter:r.b.percent,template:"{{value}}"},diskIOReadBytes:{formatter:r.b.bytes,template:"{{value}}/s"},diskIOWriteBytes:{formatter:r.b.bytes,template:"{{value}}/s"},diskLatency:{formatter:r.b.number,template:"{{value}} ms"},diskSpaceUsage:{formatter:r.b.percent,template:"{{value}}"},memory:{formatter:r.b.percent,template:"{{value}}"},memoryFree:{formatter:r.b.bytes,template:"{{value}}"},memoryTotal:{formatter:r.b.bytes,template:"{{value}}"},normalizedLoad1m:{formatter:r.b.percent,template:"{{value}}"},rx:{formatter:r.b.bits,template:"{{value}}/s"},tx:{formatter:r.b.bits,template:"{{value}}/s"},logRate:{formatter:r.b.abbreviatedNumber,template:"{{value}}/s"},s3BucketSize:{formatter:r.b.bytes,template:"{{value}}"},s3TotalRequests:{formatter:r.b.abbreviatedNumber,template:"{{value}}"},s3NumberOfObjects:{formatter:r.b.abbreviatedNumber,template:"{{value}}"},s3UploadBytes:{formatter:r.b.bytes,template:"{{value}}"},s3DownloadBytes:{formatter:r.b.bytes,template:"{{value}}"},sqsOldestMessage:{formatter:r.b.number,template:"{{value}} seconds"},rdsLatency:{formatter:r.b.number,template:"{{value}} ms"}},c=e=>t=>{if(i.d.is(e)){const a=Object(s.a)(e);return Object(n.isNumber)(t)?a(t):t}const a=Object(n.get)(o,e.type,o.count);return null!=t&&a?Object(l.b)(a.formatter,a.template)(t):""}},168:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(1),r=a(8);const i={CPUUsage:n.i18n.translate("xpack.infra.waffle.metricOptions.cpuUsageText",{defaultMessage:"CPU usage"}),MemoryUsage:n.i18n.translate("xpack.infra.waffle.metricOptions.memoryUsageText",{defaultMessage:"memory usage"}),InboundTraffic:n.i18n.translate("xpack.infra.waffle.metricOptions.inboundTrafficText",{defaultMessage:"inbound traffic"}),OutboundTraffic:n.i18n.translate("xpack.infra.waffle.metricOptions.outboundTrafficText",{defaultMessage:"outbound traffic"}),LogRate:n.i18n.translate("xpack.infra.waffle.metricOptions.hostLogRateText",{defaultMessage:"log rate"}),Load:n.i18n.translate("xpack.infra.waffle.metricOptions.loadText",{defaultMessage:"load"}),Count:n.i18n.translate("xpack.infra.waffle.metricOptions.countText",{defaultMessage:"count"}),DiskIOReadBytes:n.i18n.translate("xpack.infra.waffle.metricOptions.diskIOReadBytes",{defaultMessage:"disk reads"}),DiskIOWriteBytes:n.i18n.translate("xpack.infra.waffle.metricOptions.diskIOWriteBytes",{defaultMessage:"disk writes"}),s3BucketSize:n.i18n.translate("xpack.infra.waffle.metricOptions.s3BucketSize",{defaultMessage:"bucket size"}),s3TotalRequests:n.i18n.translate("xpack.infra.waffle.metricOptions.s3TotalRequests",{defaultMessage:"total requests"}),s3NumberOfObjects:n.i18n.translate("xpack.infra.waffle.metricOptions.s3NumberOfObjects",{defaultMessage:"number of objects"}),s3DownloadBytes:n.i18n.translate("xpack.infra.waffle.metricOptions.s3DownloadBytes",{defaultMessage:"downloads (bytes)"}),s3UploadBytes:n.i18n.translate("xpack.infra.waffle.metricOptions.s3UploadBytes",{defaultMessage:"uploads (bytes)"}),rdsConnections:n.i18n.translate("xpack.infra.waffle.metricOptions.rdsConnections",{defaultMessage:"connections"}),rdsQueriesExecuted:n.i18n.translate("xpack.infra.waffle.metricOptions.rdsQueriesExecuted",{defaultMessage:"queries executed"}),rdsActiveTransactions:n.i18n.translate("xpack.infra.waffle.metricOptions.rdsActiveTransactions",{defaultMessage:"active transactions"}),rdsLatency:n.i18n.translate("xpack.infra.waffle.metricOptions.rdsLatency",{defaultMessage:"latency"}),sqsMessagesVisible:n.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesVisible",{defaultMessage:"messages available"}),sqsMessagesDelayed:n.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesDelayed",{defaultMessage:"messages delayed"}),sqsMessagesSent:n.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesSent",{defaultMessage:"messages added"}),sqsMessagesEmpty:n.i18n.translate("xpack.infra.waffle.metricOptions.sqsMessagesEmpty",{defaultMessage:"messages returned empty"}),sqsOldestMessage:n.i18n.translate("xpack.infra.waffle.metricOptions.sqsOldestMessage",{defaultMessage:"oldest message"})},s=Object(r.mapValues)(i,(e=>`${e[0].toUpperCase()}${e.slice(1)}`)),l=e=>{switch(e){case"cpu":return{text:s.CPUUsage,textLC:i.CPUUsage,value:"cpu"};case"memory":return{text:s.MemoryUsage,textLC:i.MemoryUsage,value:"memory"};case"rx":return{text:s.InboundTraffic,textLC:i.InboundTraffic,value:"rx"};case"tx":return{text:s.OutboundTraffic,textLC:i.OutboundTraffic,value:"tx"};case"logRate":return{text:s.LogRate,textLC:i.LogRate,value:"logRate"};case"load":return{text:s.Load,textLC:i.Load,value:"load"};case"count":return{text:s.Count,textLC:i.Count,value:"count"};case"diskIOReadBytes":return{text:s.DiskIOReadBytes,textLC:i.DiskIOReadBytes,value:"diskIOReadBytes"};case"diskIOWriteBytes":return{text:s.DiskIOWriteBytes,textLC:i.DiskIOWriteBytes,value:"diskIOWriteBytes"};case"s3BucketSize":return{text:s.s3BucketSize,textLC:i.s3BucketSize,value:"s3BucketSize"};case"s3TotalRequests":return{text:s.s3TotalRequests,textLC:i.s3TotalRequests,value:"s3TotalRequests"};case"s3NumberOfObjects":return{text:s.s3NumberOfObjects,textLC:i.s3NumberOfObjects,value:"s3NumberOfObjects"};case"s3DownloadBytes":return{text:s.s3DownloadBytes,textLC:i.s3DownloadBytes,value:"s3DownloadBytes"};case"s3UploadBytes":return{text:s.s3UploadBytes,textLC:i.s3UploadBytes,value:"s3UploadBytes"};case"rdsConnections":return{text:s.rdsConnections,textLC:i.rdsConnections,value:"rdsConnections"};case"rdsQueriesExecuted":return{text:s.rdsQueriesExecuted,textLC:i.rdsQueriesExecuted,value:"rdsQueriesExecuted"};case"rdsActiveTransactions":return{text:s.rdsActiveTransactions,textLC:i.rdsActiveTransactions,value:"rdsActiveTransactions"};case"rdsLatency":return{text:s.rdsLatency,textLC:i.rdsLatency,value:"rdsLatency"};case"sqsMessagesVisible":return{text:s.sqsMessagesVisible,textLC:i.sqsMessagesVisible,value:"sqsMessagesVisible"};case"sqsMessagesDelayed":return{text:s.sqsMessagesDelayed,textLC:i.sqsMessagesDelayed,value:"sqsMessagesDelayed"};case"sqsMessagesSent":return{text:s.sqsMessagesSent,textLC:i.sqsMessagesSent,value:"sqsMessagesSent"};case"sqsMessagesEmpty":return{text:s.sqsMessagesEmpty,textLC:i.sqsMessagesEmpty,value:"sqsMessagesEmpty"};case"sqsOldestMessage":return{text:s.sqsOldestMessage,textLC:i.sqsOldestMessage,value:"sqsOldestMessage"}}}},169:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t){void 0===t&&(t=0);var a=n.useRef(!1),r=n.useRef(),i=n.useRef(e),s=n.useCallback((function(){return a.current}),[]),l=n.useCallback((function(){a.current=!1,r.current&&clearTimeout(r.current),r.current=setTimeout((function(){a.current=!0,i.current()}),t)}),[t]),o=n.useCallback((function(){a.current=null,r.current&&clearTimeout(r.current)}),[]);return n.useEffect((function(){i.current=e}),[e]),n.useEffect((function(){return l(),o}),[t]),[s,o,l]}},220:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(40),r=a(1),i=a(2),s=a.n(i);const l=({options:e,onChange:t,fields:a,errorOptions:l})=>{const o=Object(i.useCallback)((e=>{const a=e.map((e=>e.label));t(a)}),[t]),c=Array.isArray(e.groupBy)?e.groupBy.map((e=>({label:e,color:null!=l&&l.includes(e)?"danger":void 0}))):e.groupBy?[{label:e.groupBy,color:null!=l&&l.includes(e.groupBy)?"danger":void 0}]:[];return s.a.createElement(n.EuiComboBox,{"data-test-subj":"metricsExplorer-groupBy",placeholder:r.i18n.translate("xpack.infra.metricsExplorer.groupByLabel",{defaultMessage:"Everything"}),"aria-label":r.i18n.translate("xpack.infra.metricsExplorer.groupByAriaLabel",{defaultMessage:"Graph per"}),fullWidth:!0,singleSelection:!1,selectedOptions:c,options:a.filter((e=>e.aggregatable&&"string"===e.type)).map((e=>({label:e.name}))),onChange:o,isClearable:!0})}},221:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));const n=new RegExp("^([0-9\\.]*)\\s*("+["y","M","w","d","h","m","s","ms"].join("|")+")$"),r={ms:.001,s:1,m:60,h:3600,d:86400,w:604800,M:2592e3,y:30758400},i=e=>{const t=e.match(n);if(t)return parseFloat(t[1])*r[t[2]];throw new Error("Invalid interval string format.")}},287:function(e,t,a){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},288:function(e,t,a){const n=a(287),r={};for(const e of Object.keys(n))r[n[e]]=e;const i={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};e.exports=i;for(const e of Object.keys(i)){if(!("channels"in i[e]))throw new Error("missing channels property: "+e);if(!("labels"in i[e]))throw new Error("missing channel labels property: "+e);if(i[e].labels.length!==i[e].channels)throw new Error("channel and label counts mismatch: "+e);const{channels:t,labels:a}=i[e];delete i[e].channels,delete i[e].labels,Object.defineProperty(i[e],"channels",{value:t}),Object.defineProperty(i[e],"labels",{value:a})}i.rgb.hsl=function(e){const t=e[0]/255,a=e[1]/255,n=e[2]/255,r=Math.min(t,a,n),i=Math.max(t,a,n),s=i-r;let l,o;i===r?l=0:t===i?l=(a-n)/s:a===i?l=2+(n-t)/s:n===i&&(l=4+(t-a)/s),l=Math.min(60*l,360),l<0&&(l+=360);const c=(r+i)/2;return o=i===r?0:c<=.5?s/(i+r):s/(2-i-r),[l,100*o,100*c]},i.rgb.hsv=function(e){let t,a,n,r,i;const s=e[0]/255,l=e[1]/255,o=e[2]/255,c=Math.max(s,l,o),u=c-Math.min(s,l,o),d=function(e){return(c-e)/6/u+.5};return 0===u?(r=0,i=0):(i=u/c,t=d(s),a=d(l),n=d(o),s===c?r=n-a:l===c?r=1/3+t-n:o===c&&(r=2/3+a-t),r<0?r+=1:r>1&&(r-=1)),[360*r,100*i,100*c]},i.rgb.hwb=function(e){const t=e[0],a=e[1];let n=e[2];const r=i.rgb.hsl(e)[0],s=1/255*Math.min(t,Math.min(a,n));return n=1-1/255*Math.max(t,Math.max(a,n)),[r,100*s,100*n]},i.rgb.cmyk=function(e){const t=e[0]/255,a=e[1]/255,n=e[2]/255,r=Math.min(1-t,1-a,1-n);return[100*((1-t-r)/(1-r)||0),100*((1-a-r)/(1-r)||0),100*((1-n-r)/(1-r)||0),100*r]},i.rgb.keyword=function(e){const t=r[e];if(t)return t;let a,i=1/0;for(const t of Object.keys(n)){const r=(l=n[t],((s=e)[0]-l[0])**2+(s[1]-l[1])**2+(s[2]-l[2])**2);r<i&&(i=r,a=t)}var s,l;return a},i.keyword.rgb=function(e){return n[e]},i.rgb.xyz=function(e){let t=e[0]/255,a=e[1]/255,n=e[2]/255;return t=t>.04045?((t+.055)/1.055)**2.4:t/12.92,a=a>.04045?((a+.055)/1.055)**2.4:a/12.92,n=n>.04045?((n+.055)/1.055)**2.4:n/12.92,[100*(.4124*t+.3576*a+.1805*n),100*(.2126*t+.7152*a+.0722*n),100*(.0193*t+.1192*a+.9505*n)]},i.rgb.lab=function(e){const t=i.rgb.xyz(e);let a=t[0],n=t[1],r=t[2];return a/=95.047,n/=100,r/=108.883,a=a>.008856?a**(1/3):7.787*a+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,r=r>.008856?r**(1/3):7.787*r+16/116,[116*n-16,500*(a-n),200*(n-r)]},i.hsl.rgb=function(e){const t=e[0]/360,a=e[1]/100,n=e[2]/100;let r,i,s;if(0===a)return s=255*n,[s,s,s];r=n<.5?n*(1+a):n+a-n*a;const l=2*n-r,o=[0,0,0];for(let e=0;e<3;e++)i=t+1/3*-(e-1),i<0&&i++,i>1&&i--,s=6*i<1?l+6*(r-l)*i:2*i<1?r:3*i<2?l+(r-l)*(2/3-i)*6:l,o[e]=255*s;return o},i.hsl.hsv=function(e){const t=e[0];let a=e[1]/100,n=e[2]/100,r=a;const i=Math.max(n,.01);return n*=2,a*=n<=1?n:2-n,r*=i<=1?i:2-i,[t,100*(0===n?2*r/(i+r):2*a/(n+a)),(n+a)/2*100]},i.hsv.rgb=function(e){const t=e[0]/60,a=e[1]/100;let n=e[2]/100;const r=Math.floor(t)%6,i=t-Math.floor(t),s=255*n*(1-a),l=255*n*(1-a*i),o=255*n*(1-a*(1-i));switch(n*=255,r){case 0:return[n,o,s];case 1:return[l,n,s];case 2:return[s,n,o];case 3:return[s,l,n];case 4:return[o,s,n];case 5:return[n,s,l]}},i.hsv.hsl=function(e){const t=e[0],a=e[1]/100,n=e[2]/100,r=Math.max(n,.01);let i,s;s=(2-a)*n;const l=(2-a)*r;return i=a*r,i/=l<=1?l:2-l,i=i||0,s/=2,[t,100*i,100*s]},i.hwb.rgb=function(e){const t=e[0]/360;let a=e[1]/100,n=e[2]/100;const r=a+n;let i;r>1&&(a/=r,n/=r);const s=Math.floor(6*t),l=1-n;i=6*t-s,0!=(1&s)&&(i=1-i);const o=a+i*(l-a);let c,u,d;switch(s){default:case 6:case 0:c=l,u=o,d=a;break;case 1:c=o,u=l,d=a;break;case 2:c=a,u=l,d=o;break;case 3:c=a,u=o,d=l;break;case 4:c=o,u=a,d=l;break;case 5:c=l,u=a,d=o}return[255*c,255*u,255*d]},i.cmyk.rgb=function(e){const t=e[0]/100,a=e[1]/100,n=e[2]/100,r=e[3]/100;return[255*(1-Math.min(1,t*(1-r)+r)),255*(1-Math.min(1,a*(1-r)+r)),255*(1-Math.min(1,n*(1-r)+r))]},i.xyz.rgb=function(e){const t=e[0]/100,a=e[1]/100,n=e[2]/100;let r,i,s;return r=3.2406*t+-1.5372*a+-.4986*n,i=-.9689*t+1.8758*a+.0415*n,s=.0557*t+-.204*a+1.057*n,r=r>.0031308?1.055*r**(1/2.4)-.055:12.92*r,i=i>.0031308?1.055*i**(1/2.4)-.055:12.92*i,s=s>.0031308?1.055*s**(1/2.4)-.055:12.92*s,r=Math.min(Math.max(0,r),1),i=Math.min(Math.max(0,i),1),s=Math.min(Math.max(0,s),1),[255*r,255*i,255*s]},i.xyz.lab=function(e){let t=e[0],a=e[1],n=e[2];return t/=95.047,a/=100,n/=108.883,t=t>.008856?t**(1/3):7.787*t+16/116,a=a>.008856?a**(1/3):7.787*a+16/116,n=n>.008856?n**(1/3):7.787*n+16/116,[116*a-16,500*(t-a),200*(a-n)]},i.lab.xyz=function(e){let t,a,n;a=(e[0]+16)/116,t=e[1]/500+a,n=a-e[2]/200;const r=a**3,i=t**3,s=n**3;return a=r>.008856?r:(a-16/116)/7.787,t=i>.008856?i:(t-16/116)/7.787,n=s>.008856?s:(n-16/116)/7.787,t*=95.047,a*=100,n*=108.883,[t,a,n]},i.lab.lch=function(e){const t=e[0],a=e[1],n=e[2];let r;return r=360*Math.atan2(n,a)/2/Math.PI,r<0&&(r+=360),[t,Math.sqrt(a*a+n*n),r]},i.lch.lab=function(e){const t=e[0],a=e[1],n=e[2]/360*2*Math.PI;return[t,a*Math.cos(n),a*Math.sin(n)]},i.rgb.ansi16=function(e,t=null){const[a,n,r]=e;let s=null===t?i.rgb.hsv(e)[2]:t;if(s=Math.round(s/50),0===s)return 30;let l=30+(Math.round(r/255)<<2|Math.round(n/255)<<1|Math.round(a/255));return 2===s&&(l+=60),l},i.hsv.ansi16=function(e){return i.rgb.ansi16(i.hsv.rgb(e),e[2])},i.rgb.ansi256=function(e){const t=e[0],a=e[1],n=e[2];return t===a&&a===n?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(a/255*5)+Math.round(n/255*5)},i.ansi16.rgb=function(e){let t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),t=t/10.5*255,[t,t,t];const a=.5*(1+~~(e>50));return[(1&t)*a*255,(t>>1&1)*a*255,(t>>2&1)*a*255]},i.ansi256.rgb=function(e){if(e>=232){const t=10*(e-232)+8;return[t,t,t]}let t;return e-=16,[Math.floor(e/36)/5*255,Math.floor((t=e%36)/6)/5*255,t%6/5*255]},i.rgb.hex=function(e){const t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},i.hex.rgb=function(e){const t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];let a=t[0];3===t[0].length&&(a=a.split("").map((e=>e+e)).join(""));const n=parseInt(a,16);return[n>>16&255,n>>8&255,255&n]},i.rgb.hcg=function(e){const t=e[0]/255,a=e[1]/255,n=e[2]/255,r=Math.max(Math.max(t,a),n),i=Math.min(Math.min(t,a),n),s=r-i;let l,o;return l=s<1?i/(1-s):0,o=s<=0?0:r===t?(a-n)/s%6:r===a?2+(n-t)/s:4+(t-a)/s,o/=6,o%=1,[360*o,100*s,100*l]},i.hsl.hcg=function(e){const t=e[1]/100,a=e[2]/100,n=a<.5?2*t*a:2*t*(1-a);let r=0;return n<1&&(r=(a-.5*n)/(1-n)),[e[0],100*n,100*r]},i.hsv.hcg=function(e){const t=e[1]/100,a=e[2]/100,n=t*a;let r=0;return n<1&&(r=(a-n)/(1-n)),[e[0],100*n,100*r]},i.hcg.rgb=function(e){const t=e[0]/360,a=e[1]/100,n=e[2]/100;if(0===a)return[255*n,255*n,255*n];const r=[0,0,0],i=t%1*6,s=i%1,l=1-s;let o=0;switch(Math.floor(i)){case 0:r[0]=1,r[1]=s,r[2]=0;break;case 1:r[0]=l,r[1]=1,r[2]=0;break;case 2:r[0]=0,r[1]=1,r[2]=s;break;case 3:r[0]=0,r[1]=l,r[2]=1;break;case 4:r[0]=s,r[1]=0,r[2]=1;break;default:r[0]=1,r[1]=0,r[2]=l}return o=(1-a)*n,[255*(a*r[0]+o),255*(a*r[1]+o),255*(a*r[2]+o)]},i.hcg.hsv=function(e){const t=e[1]/100,a=t+e[2]/100*(1-t);let n=0;return a>0&&(n=t/a),[e[0],100*n,100*a]},i.hcg.hsl=function(e){const t=e[1]/100,a=e[2]/100*(1-t)+.5*t;let n=0;return a>0&&a<.5?n=t/(2*a):a>=.5&&a<1&&(n=t/(2*(1-a))),[e[0],100*n,100*a]},i.hcg.hwb=function(e){const t=e[1]/100,a=t+e[2]/100*(1-t);return[e[0],100*(a-t),100*(1-a)]},i.hwb.hcg=function(e){const t=e[1]/100,a=1-e[2]/100,n=a-t;let r=0;return n<1&&(r=(a-n)/(1-n)),[e[0],100*n,100*r]},i.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},i.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},i.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},i.gray.hsl=function(e){return[0,0,e[0]]},i.gray.hsv=i.gray.hsl,i.gray.hwb=function(e){return[0,100,e[0]]},i.gray.cmyk=function(e){return[0,0,0,e[0]]},i.gray.lab=function(e){return[e[0],0,0]},i.gray.hex=function(e){const t=255&Math.round(e[0]/100*255),a=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(a.length)+a},i.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},289:function(e,t,a){var n=a(492),r=a(493);e.exports=function(e,t,a){(void 0!==a&&!r(e[t],a)||void 0===a&&!(t in e))&&n(e,t,a)}},290:function(e,t){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},291:function(e,t,a){e.exports=a(66)(1236)},465:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(285),r=a(5);t.ThrowReporter={report:function(e){if(r.isLeft(e))throw new Error(n.PathReporter.report(e).join("\n"))}}},467:function(e){e.exports=JSON.parse('{"groups":["hosts","metrics"],"description":"Metrics: Hosts - Identify unusual spikes in memory usage across hosts.","analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(\'system.memory.actual.used.pct\')","function":"max","field_name":"system.memory.actual.used.pct","custom_rules":[{"actions":["skip_result"],"conditions":[{"applies_to":"actual","operator":"lt","value":0.1}]}]}],"influencers":["host.name"]},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"64mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-hosts","custom_urls":[{"url_name":"Host Metrics","url_value":"metrics/detail/host/$host.name$?_a=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},468:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"system.memory"}}]}}}')},469:function(e){e.exports=JSON.parse('{"description":"Metrics: Hosts - Identify unusual spikes in inbound traffic across hosts.","groups":["hosts","metrics"],"analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(bytes_in_derivative)","function":"max","field_name":"bytes_in_derivative"}],"influencers":["host.name"],"summary_count_field_name":"doc_count"},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"32mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-hosts","custom_urls":[{"url_name":"Host Metrics","url_value":"metrics/detail/host/$host.name$?_a=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},470:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"system.network"}}]}},"chunking_config":{"mode":"manual","time_span":"900s"},"aggregations":{"host.name":{"terms":{"field":"host.name","size":100},"aggregations":{"buckets":{"date_histogram":{"field":"@timestamp","fixed_interval":"5m"},"aggregations":{"@timestamp":{"max":{"field":"@timestamp"}},"bytes_in_max":{"max":{"field":"system.network.in.bytes"}},"bytes_in_derivative":{"derivative":{"buckets_path":"bytes_in_max"}},"positive_only":{"bucket_script":{"buckets_path":{"in_derivative":"bytes_in_derivative.value"},"script":"params.in_derivative > 0.0 ? params.in_derivative : 0.0"}}}}}}}}')},471:function(e){e.exports=JSON.parse('{"description":"Metrics: Hosts - Identify unusual spikes in outbound traffic across hosts.","groups":["hosts","metrics"],"analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(bytes_out_derivative)","function":"max","field_name":"bytes_out_derivative"}],"influencers":["host.name"],"summary_count_field_name":"doc_count"},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"32mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-hosts","custom_urls":[{"url_name":"Host Metrics","url_value":"metrics/detail/host/$host.name$?_a=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},472:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"system.network"}}]}},"chunking_config":{"mode":"manual","time_span":"900s"},"aggregations":{"host.name":{"terms":{"field":"host.name","size":100},"aggregations":{"buckets":{"date_histogram":{"field":"@timestamp","fixed_interval":"5m"},"aggregations":{"@timestamp":{"max":{"field":"@timestamp"}},"bytes_out_max":{"max":{"field":"system.network.out.bytes"}},"bytes_out_derivative":{"derivative":{"buckets_path":"bytes_out_max"}},"positive_only":{"bucket_script":{"buckets_path":{"out_derivative":"bytes_out_derivative.value"},"script":"params.out_derivative > 0.0 ? params.out_derivative : 0.0"}}}}}}}}')},473:function(e){e.exports=JSON.parse('{"groups":["k8s","metrics"],"description":"Metrics: Kubernetes - Identify unusual spikes in memory usage across Kubernetes pods.","analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(\'kubernetes.pod.memory.usage.node.pct\')","function":"max","field_name":"kubernetes.pod.memory.usage.node.pct","partition_field_name":"kubernetes.namespace","custom_rules":[{"actions":["skip_result"],"conditions":[{"applies_to":"actual","operator":"lt","value":0.1}]}]}],"influencers":["kubernetes.namespace","kubernetes.node.name","kubernetes.pod.uid"]},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"64mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-k8s","custom_urls":[{"url_name":"Pod Metrics","url_value":"metrics/detail/pod/$kubernetes.pod.uid$?_a=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},474:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"kubernetes.pod.uid"}},{"exists":{"field":"kubernetes.pod.memory"}}]}}}')},475:function(e){e.exports=JSON.parse('{"description":"Metrics: Kubernetes - Identify unusual spikes in inbound traffic across Kubernetes pods.","groups":["k8s","metrics"],"analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(bytes_in_derivative)","function":"max","field_name":"bytes_in_derivative","partition_field_name":"kubernetes.namespace"}],"influencers":["kubernetes.namespace","kubernetes.pod.uid"],"summary_count_field_name":"doc_count"},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"32mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-k8s","custom_urls":[{"url_name":"Pod Metrics","url_value":"metrics/detail/pod/$kubernetes.pod.uid$?_a=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},476:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"kubernetes.pod.network"}}]}},"chunking_config":{"mode":"manual","time_span":"900s"},"aggregations":{"kubernetes.namespace":{"terms":{"field":"kubernetes.namespace","size":25},"aggregations":{"kubernetes.pod.uid":{"terms":{"field":"kubernetes.pod.uid","size":100},"aggregations":{"buckets":{"date_histogram":{"field":"@timestamp","fixed_interval":"5m"},"aggregations":{"@timestamp":{"max":{"field":"@timestamp"}},"bytes_in_max":{"max":{"field":"kubernetes.pod.network.rx.bytes"}},"bytes_in_derivative":{"derivative":{"buckets_path":"bytes_in_max"}},"positive_only":{"bucket_script":{"buckets_path":{"in_derivative":"bytes_in_derivative.value"},"script":"params.in_derivative > 0.0 ? params.in_derivative : 0.0"}}}}}}}}}}')},477:function(e){e.exports=JSON.parse('{"description":"Metrics: Kubernetes - Identify unusual spikes in outbound traffic across Kubernetes pods.","groups":["k8s","metrics"],"analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(bytes_out_derivative)","function":"max","field_name":"bytes_out_derivative","partition_field_name":"kubernetes.namespace"}],"influencers":["kubernetes.namespace","kubernetes.pod.uid"],"summary_count_field_name":"doc_count"},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"32mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-k8s","custom_urls":[{"url_name":"Pod Metrics","url_value":"metrics/detail/pod/$kubernetes.pod.uid$?_a=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},478:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"kubernetes.pod.network"}}]}},"chunking_config":{"mode":"manual","time_span":"900s"},"aggregations":{"kubernetes.namespace":{"terms":{"field":"kubernetes.namespace","size":25},"aggregations":{"kubernetes.pod.uid":{"terms":{"field":"kubernetes.pod.uid","size":100},"aggregations":{"buckets":{"date_histogram":{"field":"@timestamp","fixed_interval":"5m"},"aggregations":{"@timestamp":{"max":{"field":"@timestamp"}},"bytes_out_max":{"max":{"field":"kubernetes.pod.network.tx.bytes"}},"bytes_out_derivative":{"derivative":{"buckets_path":"bytes_out_max"}},"positive_only":{"bucket_script":{"buckets_path":{"pos_derivative":"bytes_out_derivative.value"},"script":"params.pos_derivative > 0.0 ? params.pos_derivative : 0.0"}}}}}}}}}}')},479:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(67),r=a(2),i=n.__importDefault(a(117));t.default=function(e,t){void 0===t&&(t=[]);var a=r.useState(0),s=a[0],l=a[1],o=i.default(e,n.__spreadArrays(t,[s])),c=o.loading,u=r.useCallback((function(){c||l((function(e){return e+1}))}),n.__spreadArrays(t,[c]));return n.__assign(n.__assign({},o),{retry:u})}},480:function(e,t,a){"use strict";t.decode=t.parse=a(481),t.encode=t.stringify=a(482)},481:function(e,t,a){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,a,i){t=t||"&",a=a||"=";var s={};if("string"!=typeof e||0===e.length)return s;var l=/\+/g;e=e.split(t);var o=1e3;i&&"number"==typeof i.maxKeys&&(o=i.maxKeys);var c=e.length;o>0&&c>o&&(c=o);for(var u=0;u<c;++u){var d,m,p,g,f=e[u].replace(l,"%20"),b=f.indexOf(a);b>=0?(d=f.substr(0,b),m=f.substr(b+1)):(d=f,m=""),p=decodeURIComponent(d),g=decodeURIComponent(m),n(s,p)?r(s[p])?s[p].push(g):s[p]=[s[p],g]:s[p]=g}return s};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},482:function(e,t,a){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,a,l){return t=t||"&",a=a||"=",null===e&&(e=void 0),"object"==typeof e?i(s(e),(function(s){var l=encodeURIComponent(n(s))+a;return r(e[s])?i(e[s],(function(e){return l+encodeURIComponent(n(e))})).join(t):l+encodeURIComponent(n(e[s]))})).join(t):l?encodeURIComponent(n(l))+a+encodeURIComponent(n(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var a=[],n=0;n<e.length;n++)a.push(t(e[n],n));return a}var s=Object.keys||function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return t}},483:function(e,t,a){const n=a(484),r=a(487),i=["keyword","gray","hex"],s={};for(const e of Object.keys(r))s[[...r[e].labels].sort().join("")]=e;const l={};function o(e,t){if(!(this instanceof o))return new o(e,t);if(t&&t in i&&(t=null),t&&!(t in r))throw new Error("Unknown model: "+t);let a,c;if(null==e)this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(e instanceof o)this.model=e.model,this.color=[...e.color],this.valpha=e.valpha;else if("string"==typeof e){const t=n.get(e);if(null===t)throw new Error("Unable to parse color from string: "+e);this.model=t.model,c=r[this.model].channels,this.color=t.value.slice(0,c),this.valpha="number"==typeof t.value[c]?t.value[c]:1}else if(e.length>0){this.model=t||"rgb",c=r[this.model].channels;const a=Array.prototype.slice.call(e,0,c);this.color=m(a,c),this.valpha="number"==typeof e[c]?e[c]:1}else if("number"==typeof e)this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;const t=Object.keys(e);"alpha"in e&&(t.splice(t.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);const n=t.sort().join("");if(!(n in s))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=s[n];const{labels:i}=r[this.model],l=[];for(a=0;a<i.length;a++)l.push(e[i[a]]);this.color=m(l)}if(l[this.model])for(c=r[this.model].channels,a=0;a<c;a++){const e=l[this.model][a];e&&(this.color[a]=e(this.color[a]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}o.prototype={toString(){return this.string()},toJSON(){return this[this.model]()},string(e){let t=this.model in n.to?this:this.rgb();t=t.round("number"==typeof e?e:1);const a=1===t.valpha?t.color:[...t.color,this.valpha];return n.to[t.model](a)},percentString(e){const t=this.rgb().round("number"==typeof e?e:1),a=1===t.valpha?t.color:[...t.color,this.valpha];return n.to.rgb.percent(a)},array(){return 1===this.valpha?[...this.color]:[...this.color,this.valpha]},object(){const e={},{channels:t}=r[this.model],{labels:a}=r[this.model];for(let n=0;n<t;n++)e[a[n]]=this.color[n];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray(){const e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject(){const e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round(e){return e=Math.max(e||0,0),new o([...this.color.map(c(e)),this.valpha],this.model)},alpha(e){return void 0!==e?new o([...this.color,Math.max(0,Math.min(1,e))],this.model):this.valpha},red:u("rgb",0,d(255)),green:u("rgb",1,d(255)),blue:u("rgb",2,d(255)),hue:u(["hsl","hsv","hsl","hwb","hcg"],0,(e=>(e%360+360)%360)),saturationl:u("hsl",1,d(100)),lightness:u("hsl",2,d(100)),saturationv:u("hsv",1,d(100)),value:u("hsv",2,d(100)),chroma:u("hcg",1,d(100)),gray:u("hcg",2,d(100)),white:u("hwb",1,d(100)),wblack:u("hwb",2,d(100)),cyan:u("cmyk",0,d(100)),magenta:u("cmyk",1,d(100)),yellow:u("cmyk",2,d(100)),black:u("cmyk",3,d(100)),x:u("xyz",0,d(95.047)),y:u("xyz",1,d(100)),z:u("xyz",2,d(108.833)),l:u("lab",0,d(100)),a:u("lab",1),b:u("lab",2),keyword(e){return void 0!==e?new o(e):r[this.model].keyword(this.color)},hex(e){return void 0!==e?new o(e):n.to.hex(this.rgb().round().color)},hexa(e){if(void 0!==e)return new o(e);const t=this.rgb().round().color;let a=Math.round(255*this.valpha).toString(16).toUpperCase();return 1===a.length&&(a="0"+a),n.to.hex(t)+a},rgbNumber(){const e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity(){const e=this.rgb().color,t=[];for(const[a,n]of e.entries()){const e=n/255;t[a]=e<=.04045?e/12.92:((e+.055)/1.055)**2.4}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast(e){const t=this.luminosity(),a=e.luminosity();return t>a?(t+.05)/(a+.05):(a+.05)/(t+.05)},level(e){const t=this.contrast(e);return t>=7?"AAA":t>=4.5?"AA":""},isDark(){const e=this.rgb().color;return(2126*e[0]+7152*e[1]+722*e[2])/1e4<128},isLight(){return!this.isDark()},negate(){const e=this.rgb();for(let t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten(e){const t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken(e){const t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate(e){const t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate(e){const t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten(e){const t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken(e){const t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale(){const e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return o.rgb(t,t,t)},fade(e){return this.alpha(this.valpha-this.valpha*e)},opaquer(e){return this.alpha(this.valpha+this.valpha*e)},rotate(e){const t=this.hsl();let a=t.color[0];return a=(a+e)%360,a=a<0?360+a:a,t.color[0]=a,t},mix(e,t){if(!e||!e.rgb)throw new Error('Argument to "mix" was not a Color instance, but rather an instance of '+typeof e);const a=e.rgb(),n=this.rgb(),r=void 0===t?.5:t,i=2*r-1,s=a.alpha()-n.alpha(),l=((i*s==-1?i:(i+s)/(1+i*s))+1)/2,c=1-l;return o.rgb(l*a.red()+c*n.red(),l*a.green()+c*n.green(),l*a.blue()+c*n.blue(),a.alpha()*r+n.alpha()*(1-r))}};for(const e of Object.keys(r)){if(i.includes(e))continue;const{channels:t}=r[e];o.prototype[e]=function(...t){return this.model===e?new o(this):t.length>0?new o(t,e):new o([...(a=r[this.model][e].raw(this.color),Array.isArray(a)?a:[a]),this.valpha],e);var a},o[e]=function(...a){let n=a[0];return"number"==typeof n&&(n=m(a,t)),new o(n,e)}}function c(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}function u(e,t,a){e=Array.isArray(e)?e:[e];for(const n of e)(l[n]||(l[n]=[]))[t]=a;return e=e[0],function(n){let r;return void 0!==n?(a&&(n=a(n)),r=this[e](),r.color[t]=n,r):(r=this[e]().color[t],a&&(r=a(r)),r)}}function d(e){return function(t){return Math.max(0,Math.min(e,t))}}function m(e,t){for(let a=0;a<t;a++)"number"!=typeof e[a]&&(e[a]=0);return e}e.exports=o},484:function(e,t,a){var n=a(287),r=a(485),i=Object.hasOwnProperty,s={};for(var l in n)i.call(n,l)&&(s[n[l]]=l);var o=e.exports={to:{},get:{}};function c(e,t,a){return Math.min(Math.max(t,e),a)}function u(e){var t=Math.round(e).toString(16).toUpperCase();return t.length<2?"0"+t:t}o.get=function(e){var t,a;switch(e.substring(0,3).toLowerCase()){case"hsl":t=o.get.hsl(e),a="hsl";break;case"hwb":t=o.get.hwb(e),a="hwb";break;default:t=o.get.rgb(e),a="rgb"}return t?{model:a,value:t}:null},o.get.rgb=function(e){if(!e)return null;var t,a,r,s=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(r=t[2],t=t[1],a=0;a<3;a++){var l=2*a;s[a]=parseInt(t.slice(l,l+2),16)}r&&(s[3]=parseInt(r,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(r=(t=t[1])[3],a=0;a<3;a++)s[a]=parseInt(t[a]+t[a],16);r&&(s[3]=parseInt(r+r,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)(?=[\s,])\s*(?:,\s*)?([+-]?\d+)\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)){for(a=0;a<3;a++)s[a]=parseInt(t[a+1],0);t[4]&&(t[5]?s[3]=.01*parseFloat(t[4]):s[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*,?\s*([+-]?[\d\.]+)\%\s*(?:[,|\/]\s*([+-]?[\d\.]+)(%?)\s*)?\)$/)))return(t=e.match(/^(\w+)$/))?"transparent"===t[1]?[0,0,0,0]:i.call(n,t[1])?((s=n[t[1]])[3]=1,s):null:null;for(a=0;a<3;a++)s[a]=Math.round(2.55*parseFloat(t[a+1]));t[4]&&(t[5]?s[3]=.01*parseFloat(t[4]):s[3]=parseFloat(t[4]))}for(a=0;a<3;a++)s[a]=c(s[a],0,255);return s[3]=c(s[3],0,1),s},o.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,?\s*([+-]?[\d\.]+)%\s*,?\s*([+-]?[\d\.]+)%\s*(?:[,|\/]\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var a=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,c(parseFloat(t[2]),0,100),c(parseFloat(t[3]),0,100),c(isNaN(a)?1:a,0,1)]}return null},o.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?(?=\.\d|\d)(?:0|[1-9]\d*)?(?:\.\d*)?(?:[eE][+-]?\d+)?)\s*)?\)$/);if(t){var a=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,c(parseFloat(t[2]),0,100),c(parseFloat(t[3]),0,100),c(isNaN(a)?1:a,0,1)]}return null},o.to.hex=function(){var e=r(arguments);return"#"+u(e[0])+u(e[1])+u(e[2])+(e[3]<1?u(Math.round(255*e[3])):"")},o.to.rgb=function(){var e=r(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},o.to.rgb.percent=function(){var e=r(arguments),t=Math.round(e[0]/255*100),a=Math.round(e[1]/255*100),n=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+a+"%, "+n+"%)":"rgba("+t+"%, "+a+"%, "+n+"%, "+e[3]+")"},o.to.hsl=function(){var e=r(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},o.to.hwb=function(){var e=r(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},o.to.keyword=function(e){return s[e.slice(0,3)]}},485:function(e,t,a){"use strict";var n=a(486),r=Array.prototype.concat,i=Array.prototype.slice,s=e.exports=function(e){for(var t=[],a=0,s=e.length;a<s;a++){var l=e[a];n(l)?t=r.call(t,i.call(l)):t.push(l)}return t};s.wrap=function(e){return function(){return e(s(arguments))}}},486:function(e,t){e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},487:function(e,t,a){const n=a(288),r=a(488),i={};Object.keys(n).forEach((e=>{i[e]={},Object.defineProperty(i[e],"channels",{value:n[e].channels}),Object.defineProperty(i[e],"labels",{value:n[e].labels});const t=r(e);Object.keys(t).forEach((a=>{const n=t[a];i[e][a]=function(e){const t=function(...t){const a=t[0];if(null==a)return a;a.length>1&&(t=a);const n=e(t);if("object"==typeof n)for(let e=n.length,t=0;t<e;t++)n[t]=Math.round(n[t]);return n};return"conversion"in e&&(t.conversion=e.conversion),t}(n),i[e][a].raw=function(e){const t=function(...t){const a=t[0];return null==a?a:(a.length>1&&(t=a),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(n)}))})),e.exports=i},488:function(e,t,a){const n=a(288);function r(e,t){return function(a){return t(e(a))}}function i(e,t){const a=[t[e].parent,e];let i=n[t[e].parent][e],s=t[e].parent;for(;t[s].parent;)a.unshift(t[s].parent),i=r(n[t[s].parent][s],i),s=t[s].parent;return i.conversion=a,i}e.exports=function(e){const t=function(e){const t=function(){const e={},t=Object.keys(n);for(let a=t.length,n=0;n<a;n++)e[t[n]]={distance:-1,parent:null};return e}(),a=[e];for(t[e].distance=0;a.length;){const e=a.pop(),r=Object.keys(n[e]);for(let n=r.length,i=0;i<n;i++){const n=r[i],s=t[n];-1===s.distance&&(s.distance=t[e].distance+1,s.parent=e,a.unshift(n))}}return t}(e),a={},r=Object.keys(t);for(let e=r.length,n=0;n<e;n++){const e=r[n];null!==t[e].parent&&(a[e]=i(e,t))}return a}},489:function(e,t,a){var n=a(490),r=a(510)((function(e,t,a){n(e,t,a)}));e.exports=r},490:function(e,t,a){var n=a(491),r=a(289),i=a(494),s=a(496),l=a(215),o=a(291),c=a(290);e.exports=function e(t,a,u,d,m){t!==a&&i(a,(function(i,o){if(m||(m=new n),l(i))s(t,a,o,u,e,d,m);else{var p=d?d(c(t,o),i,o+"",t,a,m):void 0;void 0===p&&(p=i),r(t,o,p)}}),o)}},491:function(e,t,a){e.exports=a(66)(1610)},492:function(e,t,a){e.exports=a(66)(1636)},493:function(e,t,a){e.exports=a(66)(814)},494:function(e,t,a){var n=a(495)();e.exports=n},495:function(e,t){e.exports=function(e){return function(t,a,n){for(var r=-1,i=Object(t),s=n(t),l=s.length;l--;){var o=s[e?l:++r];if(!1===a(i[o],o,i))break}return t}}},496:function(e,t,a){var n=a(289),r=a(497),i=a(498),s=a(499),l=a(500),o=a(501),c=a(275),u=a(502),d=a(505),m=a(274),p=a(215),g=a(506),f=a(507),b=a(290),h=a(508);e.exports=function(e,t,a,y,E,v,x){var w=b(e,a),k=b(t,a),O=x.get(k);if(O)n(e,a,O);else{var M=v?v(w,k,a+"",e,t,x):void 0,j=void 0===M;if(j){var S=c(k),C=!S&&d(k),T=!S&&!C&&f(k);M=k,S||C||T?c(w)?M=w:u(w)?M=s(w):C?(j=!1,M=r(k,!0)):T?(j=!1,M=i(k,!0)):M=[]:g(k)||o(k)?(M=w,o(w)?M=h(w):p(w)&&!m(w)||(M=l(k))):j=!1}j&&(x.set(k,M),E(M,k,y,v,x),x.delete(k)),n(e,a,M)}}},497:function(e,t,a){e.exports=a(66)(3379)},498:function(e,t,a){e.exports=a(66)(3388)},499:function(e,t,a){e.exports=a(66)(3380)},500:function(e,t,a){e.exports=a(66)(3389)},501:function(e,t,a){e.exports=a(66)(1619)},502:function(e,t,a){var n=a(503),r=a(504);e.exports=function(e){return r(e)&&n(e)}},503:function(e,t,a){e.exports=a(66)(1233)},504:function(e,t,a){e.exports=a(66)(286)},505:function(e,t,a){e.exports=a(66)(1229)},506:function(e,t,a){e.exports=a(66)(3400)},507:function(e,t,a){e.exports=a(66)(1621)},508:function(e,t,a){var n=a(509),r=a(291);e.exports=function(e){return n(e,r(e))}},509:function(e,t,a){e.exports=a(66)(678)},510:function(e,t,a){var n=a(511),r=a(515);e.exports=function(e){return n((function(t,a){var n=-1,i=a.length,s=i>1?a[i-1]:void 0,l=i>2?a[2]:void 0;for(s=e.length>3&&"function"==typeof s?(i--,s):void 0,l&&r(a[0],a[1],l)&&(s=i<3?void 0:s,i=1),t=Object(t);++n<i;){var o=a[n];o&&e(t,o,n,s)}return t}))}},511:function(e,t,a){var n=a(512),r=a(513),i=a(514);e.exports=function(e,t){return i(r(e,t,n),e+"")}},512:function(e,t,a){e.exports=a(66)(1630)},513:function(e,t,a){e.exports=a(66)(3405)},514:function(e,t,a){e.exports=a(66)(3407)},515:function(e,t,a){e.exports=a(66)(3689)},526:function(e,t,a){"use strict";a.r(t),a.d(t,"METRICS_APP_DATA_TEST_SUBJ",(function(){return rh})),a.d(t,"renderApp",(function(){return ih}));var n=a(2),r=a.n(n),i=a(35),s=a.n(i),l=a(126),o=a(86),c=(a(233),a(80)),u=a(20),d=a(27),m=a.n(d),p=a(127),g=a(109),f=a.n(g),b=a(32),h=a.n(b),y=a(18),E=a.n(y),v=a(0),x=a(16),w=a(5),k=a(25),O=a(113);const M=e=>{const t=E.a.parse(e.from.toString()),a=E.a.parse(e.to.toString(),{roundUp:!0});return{...e,from:t&&t.valueOf()||h()().subtract(1,"hour").valueOf(),to:a&&a.valueOf()||h()().valueOf()}},j={from:"now-1h",to:"now",interval:">=1m"},S={time:j,autoReload:!1,refreshInterval:5e3},C=v.type({from:v.union([v.string,v.number]),to:v.union([v.string,v.number]),interval:v.string}),T=v.partial({time:C,autoReload:v.boolean,refreshInterval:v.number}),I=T.encode,F=e=>Object(x.pipe)(T.decode(e),Object(w.fold)(Object(k.constant)(void 0),k.identity)),L=(e,t)=>Number.isNaN(e)||Number.isNaN(t)?e=>e:Object(p.f)("_a",{autoReload:!1,time:{interval:">=1m",from:h()(e).toISOString(),to:h()(t).toISOString()}}),P=f()((()=>{const[e,t]=Object(O.a)({defaultState:S,decodeUrlState:F,encodeUrlState:I,urlStateKey:"_a"}),[a,r]=Object(n.useState)(e.autoReload||!1),[i,s]=Object(n.useState)(e.refreshInterval||5e3),[l,o]=Object(n.useState)(h()().valueOf()),[c,u]=Object(n.useState)({...j,...e.time});Object(n.useEffect)((()=>t({time:c,autoReload:a,refreshInterval:i})),[a,i,t,c]);const[d,m]=Object(n.useState)(M(e.time||j)),p=Object(n.useCallback)(((e,t=!0)=>{u(e),t&&m(M(e))}),[]);return{timeRange:c,setTimeRange:p,parsedTimeRange:d,refreshInterval:i,setRefreshInterval:s,isAutoReloading:a,setAutoReload:r,lastRefresh:l,triggerRefresh:Object(n.useCallback)((()=>o(h()().valueOf())),[o])}})),[D,_]=P;let R,A;!function(e){e.OVERVIEW="overview",e.METADATA="metadata",e.PROCESSES="processes",e.PROFILING="profiling",e.ANOMALIES="anomalies",e.OSQUERY="osquery",e.LOGS="logs",e.LINK_TO_APM="linkToApm"}(R||(R={})),function(e){e.kubernetes="kubernetes"}(A||(A={}));const B="infraAssetDetailsFlyout",V="infraAssetDetailsPage",N="host.hostname",z="assetDetails",$={[A.kubernetes]:["kubernetes.node"]},q="from",U="to",G="assetDetails",H=()=>{const{params:{nodeType:e,nodeId:t}}=Object(c.useRouteMatch)(),a=Object(c.useLocation)(),n=new URLSearchParams(a.search),i="host"===e?(e=>{const t=e.get(q),a=e.get(U),n=e.get(G);return Object(p.f)(z,{...n?m.a.decode(n):void 0,dateRange:{from:t?new Date(parseFloat(t)).toISOString():void 0,to:a?new Date(parseFloat(a)).toISOString():void 0}})("")})(n):(e=>{const t=e.get(q),a=e.get(U);return L(t?parseFloat(t):NaN,a?parseFloat(a):NaN)("")})(n);return r.a.createElement(c.Redirect,{to:{pathname:`/detail/${e}/${t}`,search:i,state:a.state}})};var W=a(1),Q=a(24),J=a(193),K=a(149),Y=a(40),X=a(76),Z=a(31),ee=a(218);const te=Object(Z.euiStyled)(ee.b)`
  overflow: auto;
  background-color: ${e=>e.theme.eui.euiColorLightestShade};
`,ae=({message:e})=>r.a.createElement(ee.a,null,r.a.createElement(te,null,r.a.createElement(ne,{message:e}))),ne=({message:e})=>r.a.createElement(Y.EuiPageTemplate,{offset:0,restrictWidth:!1,bottomBorder:!1,grow:!1},r.a.createElement(Y.EuiPageTemplate.Header,null,r.a.createElement(Y.EuiTitle,{size:"m"},r.a.createElement("h1",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.errorPage.unexpectedErrorTitle",defaultMessage:"Oops!"})))),r.a.createElement(Y.EuiPageTemplate.Section,null,r.a.createElement(Y.EuiCallOut,{color:"danger",title:e,iconType:"error"},r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.errorPage.tryAgainDescription ",defaultMessage:"Please click the back button and try again."})))));var re=a(110);const ie=({match:{params:{hostIp:e}},location:t})=>{const{source:a}=Object(re.b)(),{error:i,name:s}=((e,t)=>{var a;const r=null===(a=Object(Q.useKibana)().services.http)||void 0===a?void 0:a.fetch,[i,s]=Object(n.useState)(null),[l,o]=Object(n.useState)(!0),[c,u]=Object(n.useState)(null);return Object(n.useEffect)((()=>{(async()=>{o(!0),s(null);try{if(!r)throw new Error("HTTP service is unavailable");if(e&&t){const a=await r("/api/infra/ip_to_host",{method:"POST",body:JSON.stringify({ip:e,index_pattern:t})});o(!1),u(a)}}catch(e){o(!1),s(e)}})()}),[e,t,r]),{name:c&&c.host||null,loading:l,error:i}})(e,a&&a.configuration&&a.configuration.metricAlias||null);if(i)return r.a.createElement(ae,{message:W.i18n.translate("xpack.infra.linkTo.hostWithIp.error",{defaultMessage:'Host not found with IP address "{hostIp}".',values:{hostIp:e}})});const l=L(Object(J.b)(t),Object(J.d)(t))("");return s?r.a.createElement(c.Redirect,{to:`/detail/host/${s}?${l}`}):r.a.createElement(K.a,{message:W.i18n.translate("xpack.infra.linkTo.hostWithIp.loading",{defaultMessage:'Loading host with IP address "{hostIp}".',values:{hostIp:e}})})};var se=a(53);const le=({location:e})=>{const t=function(e){if(0===e.length)return{};const t=Object(se.parse)(e.substring(1));for(const e in t)Object.hasOwnProperty.call(t,e)&&(t[e]||delete t[e],Array.isArray(t.key)&&(t[e]=t[e][0]));return t}(e.search),a="?waffleFilter=(expression:'',kind:kuery)&waffleTime=(currentTime:{timestamp},isAutoReloading:!f)&waffleOptions=(accountId:'',autoBounds:!t,boundsOverride:(max:1,min:0),customMetrics:!({customMetric}),customOptions:!(),groupBy:!(),legend:(palette:cool,reverseColors:!f,steps:10),metric:{metric},nodeType:{nodeType},region:'',sort:(by:name,direction:desc),timelineOpen:!f,view:map)".replace(/{(\w+)}/g,((e,a)=>t[a]||""));return r.a.createElement(c.Redirect,{to:"/inventory"+a})},oe=u.inventoryModels.map((e=>e.id)).join("|"),ce=e=>r.a.createElement(l.c,null,r.a.createElement(l.a,{path:`${e.match.url}/:nodeType(${oe})-detail/:nodeId`,component:H}),r.a.createElement(l.a,{path:`${e.match.url}/host-detail-via-ip/:hostIp`,component:ie}),r.a.createElement(l.a,{path:`${e.match.url}/inventory`,component:le}),r.a.createElement(c.Redirect,{to:"/"}));var ue=a(108),de=a.n(ue),me=a(41),pe=a(89),ge=a(22),fe=a(234),be=a(235),he=a(115),ye=a(92),Ee=a(465),ve=a(173);const xe=()=>{const{options:e,chartOptions:t,setChartOptions:a,timeRange:i,setOptions:s,setTimeRange:l}=Object(he.g)(),o=Object(n.useMemo)((()=>({options:e,chartOptions:t,timerange:i})),[e,t,i]),c=e=>{var t;e&&e.options&&(t=e.options,s(t)),e&&e.timerange&&l(e.timerange),e&&e.chartOptions&&a(e.chartOptions)};return r.a.createElement(ve.a,{urlState:o,urlStateKey:"metricsExplorer",mapToUrlState:we,onChange:c,onInitialize:c,populateWithInitialState:!0})},we=e=>{const t={};if(e)return e.options&&function(e){const t=he.e.decode(e);try{return Ee.ThrowReporter.report(t),!0}catch(e){return!1}}(e.options)&&(e.options.source="url",Object(ye.set)(t,"options",e.options)),e.timerange&&function(e){const t=he.f.decode(e);try{return Ee.ThrowReporter.report(t),!0}catch(e){return!1}}(e.timerange)&&Object(ye.set)(t,"timerange",e.timerange),e.chartOptions&&function(e){const t=he.d.decode(e);try{return Ee.ThrowReporter.report(t),!0}catch(e){return!1}}(e.chartOptions)&&Object(ye.set)(t,"chartOptions",e.chartOptions),t},ke=(e,t,a)=>{const n=new URL(e);return t&&n.searchParams.append("entry.548460210",t),a&&n.searchParams.append("entry.573002982",a),n.href},Oe=({formUrl:e,"data-test-subj":t,onClickCapture:a,defaultButton:n,surveyButtonText:i=r.a.createElement(X.FormattedMessage,{id:"xpack.infra.homePage.tellUsWhatYouThinkLink",defaultMessage:"Tell us what you think!"})})=>{const{services:{kibanaVersion:s,isCloudEnv:l,isServerlessEnv:o}}=Object(ge.b)(),c=((e,t)=>t?"Serverless (fully-managed projects)":e?"Elastic Cloud (we manage)":"Self-Managed (you manage)")(l,o);return r.a.createElement(Y.EuiButton,{href:ke(e,s,c),target:"_blank",color:n?void 0:"warning",iconType:n?void 0:"editorComment","data-test-subj":t,onClickCapture:a},i)};var Me=a(122),je=a(85);const Se=()=>{const{notifications:e}=Object(ge.b)();return{deleteViewFailure:t=>{e.toasts.danger({toastLifeTimeMs:3e3,title:t||W.i18n.translate("xpack.infra.savedView.errorOnDelete.title",{defaultMessage:"An error occured deleting the view."})})},getViewFailure:t=>{e.toasts.danger({toastLifeTimeMs:3e3,title:t||W.i18n.translate("xpack.infra.savedView.findError.title",{defaultMessage:"An error occurred while loading views."})})},upsertViewFailure:t=>{e.toasts.danger({toastLifeTimeMs:3e3,title:t||W.i18n.translate("xpack.infra.savedView.errorOnCreate.title",{defaultMessage:"An error occured saving view."})})}}},Ce={find:["metrics-explorer-views-find"],get:["metrics-explorer-views-get"],getById:e=>["metrics-explorer-views-get",e]},Te=()=>{var e;const{metricsExplorerViews:t}=Object(ge.b)().services;if(void 0===t)throw new Error("MetricsExplorerViews service has not been initialized.");const a=Object(me.useUiTracker)({app:"infra_metrics"}),n=Object(je.useQueryClient)(),{source:r,updateSourceConfiguration:i}=Object(re.b)(),s=null!==(e=null==r?void 0:r.configuration.metricsExplorerDefaultView)&&void 0!==e?e:"0",[l,o]=Object(O.a)({defaultState:s,decodeUrlState:Le,encodeUrlState:Fe,urlStateKey:"metricsExplorerViewId",writeDefaultState:!0}),c=Se(),{data:u,refetch:d,isFetching:m}=Object(je.useQuery)({queryKey:Ce.find,queryFn:()=>t.client.findMetricsExplorerViews(),enabled:!1,placeholderData:[],onError:e=>{var t,a;return c.getViewFailure(null!==(t=null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message)},onSuccess:e=>{const t=e.length>=1e3?"over":"under";a({metric:`${t}_1000_saved_objects_for_metrics_explorer_view`})}}),{data:p,isFetching:g}=Object(je.useQuery)({queryKey:Ce.getById(l),queryFn:({queryKey:[,e]})=>t.client.getMetricsExplorerView(e),onError:e=>{var t,a;c.getViewFailure(null!==(t=null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message),o(s)},placeholderData:null}),{mutate:f}=Object(je.useMutation)({mutationFn:e=>i({metricsExplorerDefaultView:e}),onMutate:async e=>{await n.cancelQueries({queryKey:Ce.find});const t=n.getQueryData(Ce.find),a=Pe(e,t);return n.setQueryData(Ce.find,a),{previousViews:t}},onSuccess:(e,t,a)=>!e&&null!=a&&a.previousViews?n.setQueryData(Ce.find,a.previousViews):n.invalidateQueries({queryKey:Ce.get})}),{mutateAsync:b,isLoading:h}=Object(je.useMutation)({mutationFn:e=>t.client.createMetricsExplorerView(e),onError:e=>{var t,a;c.upsertViewFailure(null!==(t=null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message)},onSuccess:e=>{n.setQueryData(Ce.getById(e.id),e),o(e.id)}}),{mutateAsync:y,isLoading:E}=Object(je.useMutation)({mutationFn:({id:e,attributes:a})=>t.client.updateMetricsExplorerView(e,a),onError:e=>{var t,a;c.upsertViewFailure(null!==(t=null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message)},onSuccess:e=>{n.setQueryData(Ce.getById(e.id),e)}}),{mutate:v}=Object(je.useMutation)({mutationFn:e=>t.client.deleteMetricsExplorerView(e),onMutate:async e=>{await n.cancelQueries({queryKey:Ce.find});const t=n.getQueryData(Ce.find),a=De(e,t);return n.setQueryData(Ce.find,a),{previousViews:t}},onError:(e,t,a)=>{var r,i;c.deleteViewFailure(null!==(r=null===(i=e.body)||void 0===i?void 0:i.message)&&void 0!==r?r:e.message),null!=a&&a.previousViews&&n.setQueryData(Ce.find,a.previousViews)},onSuccess:(e,t)=>{(null==p?void 0:p.id)===t&&o(s)},onSettled:()=>{d()}});return{views:u,currentView:p,createView:b,deleteViewById:v,fetchViews:d,updateViewById:y,switchViewById:o,setDefaultViewById:f,isCreatingView:h,isFetchingCurrentView:g,isFetchingViews:m,isUpdatingView:E}},Ie=v.string,Fe=Ie.encode,Le=e=>Object(x.pipe)(Ie.decode(e),Object(w.fold)(Object(k.constant)(void 0),k.identity)),Pe=(e,t=[])=>t.map((t=>({...t,attributes:{...t.attributes,isDefault:t.id===e}}))),De=(e,t=[])=>t.filter((t=>t.id!==e));var _e=a(237),Re=a(37),Ae=a(114);const Be=e=>{Object(_e.a)(Re.e,Ae.h,e)};var Ve=a(148),Ne=a(8);class loading_InfraLoadingPanel extends n.PureComponent{render(){const{height:e,text:t,width:a}=this.props;return n.createElement(ze,{style:{height:e,width:a}},n.createElement($e,null,n.createElement(Y.EuiPanel,null,n.createElement(Y.EuiLoadingChart,{size:"m"}),n.createElement(Y.EuiText,null,n.createElement("p",null,t)))))}}const ze=Z.euiStyled.div`
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,$e=Z.euiStyled.div`
  flex: 0 0 auto;
  align-self: center;
  text-align: center;
`;var qe=a(219),Ue=a(79),Ge=a(118),He=a(163),We=a(56),Qe=a(17),Je=a(132);const Ke=e=>{const{visible:t,setVisible:a}=e,{triggersActionsUI:i}=Object(n.useContext)(We.a),s=Object(n.useCallback)((()=>a(!1)),[a]),l=Object(n.useMemo)((()=>i&&i.getAddRuleFlyout({consumer:"infrastructure",onClose:s,canChangeTrigger:!1,ruleTypeId:Qe.e,metadata:{currentOptions:e.options,series:e.series}})),[i,s]);return r.a.createElement(r.a.Fragment,null,t&&l)},Ye=({onClose:e})=>{const{metricThresholdPrefill:t}=Object(Je.b)(),{groupBy:a,filterQuery:n,metrics:i}=t;return r.a.createElement(Ke,{options:{groupBy:a,filterQuery:n,metrics:i},visible:!0,setVisible:e})};var Xe=a(34),Ze=a(26),et=a(187),tt=a(43),at=a(188);const nt="metric*",rt=e=>{if("rate"===e.aggregation){const t=Object(Xe.v4)(),a=Object(Xe.v4)(),n=Object(Xe.v4)();return[{id:t,type:"max",field:e.field||void 0},{id:n,type:"derivative",field:t,unit:"1s"},{id:a,type:"positive_only",field:n}]}if("p95"===e.aggregation||"p99"===e.aggregation){const t="p95"===e.aggregation?"95":"99";return[{id:Object(Xe.v4)(),type:"percentile",field:e.field,percentiles:[{id:Object(Xe.v4)(),value:t,mode:"line",percentile:"",shade:.2}]}]}return[{id:Object(Xe.v4)(),type:e.aggregation,field:e.field||void 0}]},it=e=>t=>{const a=Object(et.a)(t);return{label:Object(at.a)(t),axis_position:"right",chart_type:"line",color:t.color&&Object(Ze.b)(t.color)||Object(Ze.b)(Ze.a.color0),fill:e.type===he.a.area?.5:0,formatter:a===tt.b.bits?tt.b.bytes:a,value_template:"rate"===t.aggregation?"{{value}}/s":"{{value}}",id:Object(Xe.v4)(),line_width:2,metrics:rt(t),point_size:0,separate_axis:0,split_mode:"everything",stacked:e.stack?"stacked":"none"}},st=(e,t)=>{const a=[];if(e.filterQuery&&a.push(e.filterQuery),e.groupBy){const n=t.id.replace('"','\\"'),r=Array.isArray(e.groupBy)?e.groupBy.map(((e,a)=>{if(!t.keys)return null;const n=t.keys[a];return n?`${e}: "${n.replace('"','\\"')}"`:null})).join(" and "):`${e.groupBy} : "${n}"`;a.push(r)}return{language:"kuery",query:a.join(" and ")}},lt=(e,t,a,n,r)=>{const i=(s=e&&e.metricAlias||nt).split(",").length>1?nt:s;var s;const l={filters:[],linked:!1,query:{language:"kuery",query:""},uiState:{},vis:{aggs:[],params:{axis_formatter:"number",axis_position:"left",axis_scale:"normal",id:Object(Xe.v4)(),default_index_pattern:i,index_pattern:i,interval:"auto",series:t.metrics.map(it(r)),show_grid:1,show_legend:1,time_field:Re.h,type:"timeseries",filter:st(t,a)},title:a.id,type:"metrics"}};r.yAxisMode===he.c.fromZero&&Object(ye.set)(l,"vis.params.axis_min",0);const o={refreshInterval:{pause:!0,value:0},time:{from:n.from,to:n.to}};return{app:"visualize",hash:"/create",search:{type:"metrics",_g:Object(d.encode)(o),_a:Object(d.encode)(l)}}};a(226),a(194);var ot=a(57),ct=a.n(ot);const ut=()=>{const e=Object(c.useLocation)(),{services:{application:{currentAppId$:t}}}=Object(ge.b)(),a=ct()(t);return{getNodeDetailUrl:Object(n.useCallback)((({assetType:t,assetId:n,search:r})=>{const{from:i,to:s,...l}=r;return{app:"metrics",pathname:`link-to/${t}-detail/${n}`,search:{...Object.keys(l).length>0?{[G]:m.a.encodeUnknown(l)}:void 0,...i?{[q]:`${i}`}:void 0,...s?{[U]:`${s}`}:void 0},state:{...e.key?{originAppId:a,originSearch:e.search,originPathname:e.pathname}:void 0}}}),[e.key,e.search,e.pathname,a])}},dt=(e,t=!1)=>{const a=E.a.parse(e,{roundUp:t});if(!a)throw new Error(`"${e}" is not a valid time string`);return a.valueOf()},mt=({onFilter:e,options:t,series:a,source:i,timeRange:s,uiCapabilities:l,chartOptions:o})=>{var c,u;const{getNodeDetailUrl:d}=ut(),[m,p]=Object(n.useState)(!1),[g,f]=Object(n.useState)(!1),b=null!=t.groupBy&&null!=e,h=Object(n.useCallback)((()=>{b&&e&&(Array.isArray(t.groupBy)?e(t.groupBy.map(((e,t)=>{var n;return`${e}: "${null===(n=a.keys)||void 0===n?void 0:n[t]}"`})).join(" and ")):e(`${t.groupBy}: "${a.id}"`)),p(!1)}),[b,e,t,a.keys,a.id]),y=b?[{name:W.i18n.translate("xpack.infra.metricsExplorer.filterByLabel",{defaultMessage:"Add filter"}),icon:"metricsApp",onClick:h,"data-test-subj":"metricsExplorerAction-AddFilter"}]:[],E=i&&t.groupBy&&((e,t)=>{const a=Array.isArray(t)?t:[t];return a.includes(Re.b)?"host":a.includes(Re.g)?"pod":a.includes(Re.a)?"container":void 0})(0,t.groupBy),v=Object(me.useLinkProps)({app:"metrics",...E?d({assetType:E,assetId:a.id,search:{from:dt(s.from),to:dt(s.to,!0)}}):{}}),x=Object(me.useLinkProps)({...lt(i,t,a,s,o)}),w=E?[{name:W.i18n.translate("xpack.infra.metricsExplorer.viewNodeDetail",{defaultMessage:"View metrics for {name}",values:{name:E}}),icon:"metricsApp",...E?v:{},"data-test-subj":"metricsExplorerAction-ViewNodeMetrics"}]:[],k=[...y,...null!=l&&null!==(c=l.visualize)&&void 0!==c&&c.show?[{name:W.i18n.translate("xpack.infra.metricsExplorer.openInTSVB",{defaultMessage:"Open in Visualize"}),...x,icon:"visualizeApp",disabled:0===t.metrics.length,"data-test-subj":"metricsExplorerAction-OpenInTSVB"}]:[],...w,...null!=l&&null!==(u=l.infrastructure)&&void 0!==u&&u.save?[{name:W.i18n.translate("xpack.infra.metricsExplorer.alerts.createRuleButton",{defaultMessage:"Create threshold rule"}),icon:"bell",onClick(){f(!0)}}]:[]];if(0===k.length)return null;const O=[{id:0,title:"Actions",items:k}],M=W.i18n.translate("xpack.infra.metricsExplorer.actionsLabel.aria",{defaultMessage:"Actions for {grouping}",values:{grouping:a.id}}),j=W.i18n.translate("xpack.infra.metricsExplorer.actionsLabel.button",{defaultMessage:"Actions"}),S=r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraMetricsExplorerChartContextMenuButton",contentProps:{"aria-label":M},onClick:()=>p((e=>!e)),size:"s",iconType:"arrowDown",iconSide:"right"},j);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiPopover,{closePopover:()=>p(!1),id:`${a.id}-popover`,button:S,isOpen:m,panelPaddingSize:"none"},r.a.createElement(Y.EuiContextMenu,{initialPanelId:0,panels:O}),r.a.createElement(Ke,{series:a,options:t,setVisible:f,visible:g})))},pt=W.i18n.translate("xpack.infra.metricsExplorer.everything",{defaultMessage:"Everything"}),gt=({series:e})=>{if(null!=e.keys){const{keys:t}=e;return r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs"},t.map(((e,a)=>r.a.createElement(n.Fragment,{key:e},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiText,{size:"m",color:t.length-1>a?"subdued":"default"},r.a.createElement("strong",null,"*"===e?pt:e))),t.length-1>a&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiText,{size:"m",color:"subdued"},r.a.createElement("span",null,"/")))))))}return r.a.createElement("span",null,e.id)},ft=()=>r.a.createElement(Y.EuiEmptyPrompt,{iconType:"stats",title:r.a.createElement("h3",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metricsExplorer.emptyChart.title",defaultMessage:"Chart Data Missing"})),body:r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metricsExplorer.emptyChart.body",defaultMessage:"Unable to render chart."}))});var bt=a(145),ht=a(146);const yt=()=>r.a.createElement(Y.EuiEmptyPrompt,{"data-test-subj":"metricsExplorer-missingMetricMessage",iconType:"stats",title:r.a.createElement("h3",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metricsExplorer.noMetrics.title",defaultMessage:"Missing Metric"})),body:r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metricsExplorer.noMetrics.body",defaultMessage:"Please choose a metric above."}))});var Et=a(147);const vt=({source:e,options:t,chartOptions:a,series:i,title:s,onFilter:l,height:o=200,width:c="100%",timeRange:u,onTimeChange:d})=>{const{services:{application:{capabilities:m}}}=Object(ge.b)(),p=Object(Ge.a)(),{metrics:g}=t,[f]=Object(He.a)("dateFormat"),b=Object(n.useMemo)((()=>{const e=Object(Ne.first)(i.rows),t=Object(Ne.last)(i.rows);return e&&t?Object(Ue.niceTimeFormatter)([e.timestamp,t.timestamp]):e=>`${e}`}),[i.rows]),y={headerFormatter:Object(n.useCallback)((({value:e})=>h()(e).format(f||"Y-MM-DD HH:mm:ss.SSS")),[f])},E=Object(n.useCallback)(Object(ht.a)(Object(Ne.first)(g)),[t]),v=Object(bt.a)(i,g,a.stack),x=a.yAxisMode===he.c.fromZero?{...v,min:0}:v;return r.a.createElement("div",{style:{padding:24},"data-test-subj":"metricsExplorer-chart"},t.groupBy?r.a.createElement(Y.EuiTitle,{size:"xs"},r.a.createElement(Y.EuiFlexGroup,{alignItems:"center"},r.a.createElement(xt,null,r.a.createElement(Y.EuiToolTip,{content:s,anchorClassName:"metricsExplorerTitleAnchor"},r.a.createElement(gt,{series:i}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(mt,{timeRange:u,options:t,chartOptions:a,series:i,onFilter:l,source:e,uiCapabilities:m})))):r.a.createElement(Y.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(mt,{options:t,chartOptions:a,series:i,source:e,timeRange:u,uiCapabilities:m}))),r.a.createElement("div",{className:"metricsExplorerChart",style:{height:o,width:c}},g.length&&i.rows.length>0?r.a.createElement(Ue.Chart,null,g.map(((e,t)=>r.a.createElement(Et.a,{type:a.type,key:t,metric:e,id:t,series:i,stack:a.stack}))),r.a.createElement(Ue.Axis,{id:"timestamp",position:Ue.Position.Bottom,showOverlappingTicks:!0,tickFormat:b}),r.a.createElement(Ue.Axis,{id:"values",position:Ue.Position.Left,tickFormat:E,domain:x}),r.a.createElement(Ue.Tooltip,y),r.a.createElement(Ue.Settings,{onBrushEnd:({x:e})=>{if(!e)return;const[t,a]=e;d(h()(t).toISOString(),h()(a).toISOString())},baseTheme:p.baseTheme,locale:W.i18n.getLocale()})):t.metrics.length>0?r.a.createElement(ft,null):r.a.createElement(yt,null)))},xt=Z.euiStyled.div`
  width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  text-align: left;
  flex: 1 1 auto;
  margin: 12px;
`,wt=({isLoading:e,data:t,onLoadMore:a,options:n,chartOptions:i,onRefetch:s,onFilter:l,source:o,timeRange:c,onTimeChange:u})=>{if(e)return r.a.createElement(loading_InfraLoadingPanel,{height:800,width:"100%",text:W.i18n.translate("xpack.infra.metricsExplorer.loadingCharts",{defaultMessage:"Loading charts"})});if(!t||0===Object(Ne.first)(t.pages).series.length)return r.a.createElement(qe.a,{titleText:W.i18n.translate("xpack.infra.metricsExplorer.noDataTitle",{defaultMessage:"There is no data to display."}),bodyText:W.i18n.translate("xpack.infra.metricsExplorer.noDataBodyText",{defaultMessage:"Try adjusting your time, filters or group by settings."}),refetchText:W.i18n.translate("xpack.infra.metricsExplorer.noDataRefetchText",{defaultMessage:"Check for new data"}),testString:"metrics-explorer-no-data",onRefetch:s});const d=W.i18n.translate("xpack.infra.metricsExplorer.andLabel",{defaultMessage:'" and "'}),m=Object(Ne.first)(t.pages),p=Object(Ne.last)(t.pages).pageInfo.afterKey;return r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(Y.EuiFlexGrid,{gutterSize:"s",columns:1===m.series.length?1:3},t.pages.map((e=>e.series.map((t=>r.a.createElement(Y.EuiFlexItem,{key:t.id,style:{minWidth:0}},r.a.createElement(vt,{key:`chart-${t.id}`,onFilter:l,options:n,chartOptions:i,title:n.groupBy?t.id:null,height:e.series.length>1?200:400,series:t,source:o,timeRange:c,onTimeChange:u}))))))),m.series.length>1?r.a.createElement("div",{style:{textAlign:"center",marginBottom:16}},r.a.createElement(Y.EuiHorizontalRule,null),r.a.createElement(Y.EuiText,{color:"subdued"},r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metricsExplorer.footerPaginationMessage",defaultMessage:'Displaying {length} of {total} charts grouped by "{groupBy}".',values:{length:Object(Ne.sumBy)(t.pages,"series.length"),total:m.pageInfo.total,groupBy:Array.isArray(n.groupBy)?n.groupBy.join(d):n.groupBy}}))),p?r.a.createElement("div",{style:{margin:"16px 0"}},r.a.createElement(Y.EuiButton,{"data-test-subj":"infraMetricsExplorerChartsLoadMoreChartsButton",isLoading:e,size:"s",onClick:a},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metricsExplorer.loadMoreChartsButton",defaultMessage:"Load More Charts"}))):null):null)};var kt=a(81),Ot=a(164);const Mt=({options:e,onChange:t,fields:a,autoFocus:i=!1})=>{const s=Object.keys(Ze.a),[l,o]=Object(n.useState)(i),c=Object(n.useCallback)((e=>{e&&l&&(e.focus(),o(!1))}),[l]),u=Object(n.useCallback)((a=>{t(a.map(((t,a)=>({aggregation:e.aggregation,field:t.value,color:s[a]}))))}),[t,e.aggregation,s]),d=a.map((e=>({label:e.name,value:e.name}))),m=e.metrics.filter((e=>"count"!==e.aggregation)).map((e=>({label:e.field||"",value:e.field||"",color:Object(Ze.b)(e.color||Ze.a.color0)}))),p=W.i18n.translate("xpack.infra.metricsExplorer.metricComboBoxPlaceholder",{defaultMessage:"choose a metric to plot"});return r.a.createElement(Y.EuiComboBox,{"data-test-subj":"metricsExplorer-metrics","aria-label":p,isDisabled:"count"===e.aggregation,placeholder:p,fullWidth:!0,options:d,selectedOptions:m,onChange:u,isClearable:!0,inputRef:c})};var jt=a(220),St=a(28);const Ct=({options:e,onChange:t})=>{const a={avg:W.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.avg",{defaultMessage:"Average"}),sum:W.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.sum",{defaultMessage:"Sum"}),max:W.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.max",{defaultMessage:"Max"}),min:W.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.min",{defaultMessage:"Min"}),cardinality:W.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.cardinality",{defaultMessage:"Cardinality"}),rate:W.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.rate",{defaultMessage:"Rate"}),p95:W.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.p95",{defaultMessage:"95th Percentile"}),p99:W.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.p99",{defaultMessage:"99th Percentile"}),count:W.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.count",{defaultMessage:"Document count"})},i=Object(n.useCallback)((e=>{const a=St.d.is(e.target.value)&&e.target.value||"avg";t(a)}),[t]),s=W.i18n.translate("xpack.infra.metricsExplorer.aggregationSelectLabel",{defaultMessage:"Select an aggregation"}),l=Object(Ne.xor)(St.a,["custom"]);return r.a.createElement(Y.EuiSelect,{"data-test-subj":"infraMetricsExplorerAggregationPickerSelect","aria-label":s,placeholder:s,fullWidth:!0,value:e.aggregation,options:l.map((e=>({text:a[e],value:e}))),onChange:i})},Tt=({chartOptions:e,onChange:t})=>{const[a,i]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>{i(!1)}),[]),l=Object(n.useCallback)((()=>{i(!0)}),[]),o=r.a.createElement(Y.EuiButtonEmpty,{iconSide:"left",iconType:"eye",onClick:l,"data-test-subj":"metricsExplorer-customize"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metricsExplorer.customizeChartOptions",defaultMessage:"Customize"})),c=[{id:he.c.auto,label:W.i18n.translate("xpack.infra.metricsExplorer.chartOptions.autoLabel",{defaultMessage:"Automatic (min to max)"})},{id:he.c.fromZero,label:W.i18n.translate("xpack.infra.metricsExplorer.chartOptions.fromZeroLabel",{defaultMessage:"From zero (0 to max)"})}],u=[{"data-test-subj":"metricsExplorer-chartRadio-line",id:he.a.line,label:W.i18n.translate("xpack.infra.metricsExplorer.chartOptions.lineLabel",{defaultMessage:"Line"})},{"data-test-subj":"metricsExplorer-chartRadio-area",id:he.a.area,label:W.i18n.translate("xpack.infra.metricsExplorer.chartOptions.areaLabel",{defaultMessage:"Area"})},{"data-test-subj":"metricsExplorer-chartRadio-bar",id:he.a.bar,label:W.i18n.translate("xpack.infra.metricsExplorer.chartOptions.barLabel",{defaultMessage:"Bar"})}],d=Object(n.useCallback)((a=>{t({...e,yAxisMode:a})}),[e,t]),m=Object(n.useCallback)((a=>{t({...e,type:a})}),[e,t]),p=Object(n.useCallback)((a=>{t({...e,stack:a.target.checked})}),[e,t]);return r.a.createElement(Y.EuiPopover,{id:"MetricExplorerChartOptionsPopover",button:o,isOpen:a,closePopover:s},r.a.createElement(Y.EuiForm,null,r.a.createElement(Y.EuiFormRow,{display:"rowCompressed",label:W.i18n.translate("xpack.infra.metricsExplorer.chartOptions.typeLabel",{defaultMessage:"Chart style"})},r.a.createElement(Y.EuiRadioGroup,{"data-test-subj":"infraMetricsExplorerChartOptionsRadioGroup",compressed:!0,options:u,idSelected:e.type,onChange:m})),r.a.createElement(Y.EuiFormRow,{display:"rowCompressed",label:W.i18n.translate("xpack.infra.metricsExplorer.chartOptions.stackLabel",{defaultMessage:"Stack series"})},r.a.createElement(Y.EuiSwitch,{label:W.i18n.translate("xpack.infra.metricsExplorer.chartOptions.stackSwitchLabel",{defaultMessage:"Stack"}),checked:e.stack,onChange:p})),r.a.createElement(Y.EuiFormRow,{display:"rowCompressed",label:W.i18n.translate("xpack.infra.metricsExplorer.chartOptions.yAxisDomainLabel",{defaultMessage:"Y Axis Domain"})},r.a.createElement(Y.EuiRadioGroup,{"data-test-subj":"infraMetricsExplorerChartOptionsRadioGroup",compressed:!0,options:c,idSelected:e.yAxisMode,onChange:d}))))},It=e=>e?e.map((e=>({start:e.from,end:e.to,label:e.display}))):[],Ft=({timeRange:e,derivedIndexPattern:t,options:a,onTimeChange:n,onRefresh:i,onGroupByChange:s,onFilterQuerySubmit:l,onMetricsChange:o,onAggregationChange:c,chartOptions:u,onChartOptionsChange:d})=>{const m="avg"===a.aggregation&&0===a.metrics.length,[p]=Object(He.a)(kt.UI_SETTINGS.TIMEPICKER_QUICK_RANGES),g=It(p);return r.a.createElement(Y.EuiFlexGroup,{gutterSize:"m",direction:"column"},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiFlexGroup,{alignItems:"center"},r.a.createElement(Y.EuiFlexItem,{grow:"count"===a.aggregation&&2},r.a.createElement(Ct,{fullWidth:!0,options:a,onChange:c})),"count"!==a.aggregation&&r.a.createElement(Y.EuiText,{size:"s",color:"subdued"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metricsExplorer.aggregationLabel",defaultMessage:"of"})),"count"!==a.aggregation&&r.a.createElement(Y.EuiFlexItem,{grow:2},r.a.createElement(Mt,{autoFocus:m,fields:t.fields,options:a,onChange:o})),r.a.createElement(Y.EuiText,{size:"s",color:"subdued"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metricsExplorer.groupByToolbarLabel",defaultMessage:"graph per"})),r.a.createElement(Y.EuiFlexItem,{grow:1},r.a.createElement(jt.a,{onChange:s,fields:t.fields,options:a})))),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiFlexGroup,{alignItems:"center"},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Ot.a,{derivedIndexPattern:t,onSubmit:l,value:a.filterQuery})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Tt,{onChange:d,chartOptions:u})),r.a.createElement(Y.EuiFlexItem,{grow:!1,style:{marginRight:5}},r.a.createElement(Y.EuiSuperDatePicker,{start:e.from,end:e.to,onTimeChange:({start:e,end:t})=>n(e,t),onRefresh:i,commonlyUsedRanges:g})))))};var Lt=a(165),Pt=a(137),Dt=a(153),_t=a.n(Dt);const Rt={box:{incremental:!0}};function At({onClose:e,views:t=[],onSwitchView:a,onMakeDefaultView:i,onDeleteView:s,loading:l}){const o=Object(n.useMemo)((()=>t.map(Vt)),[t]),c=[{field:"name",name:W.i18n.translate("xpack.infra.openView.columnNames.name",{defaultMessage:"Name"}),sortable:!0,truncateText:!0,render:(t,n)=>r.a.createElement(Y.EuiButtonEmpty,{key:n.id,"data-test-subj":"infraRenderNameButton",onClick:()=>{a(n.id),e()}},t)},{name:W.i18n.translate("xpack.infra.openView.columnNames.actions",{defaultMessage:"Actions"}),actions:[{render:e=>r.a.createElement(Y.EuiButtonIcon,{key:e.id,"data-test-subj":"infraRenderMakeDefaultActionButton",iconType:e.attributes.isDefault?"starFilled":"starEmpty",size:"s",onClick:()=>{i(e.id)}})},{available:e=>!e.attributes.isStatic,render:e=>r.a.createElement(Bt,{key:e.id,isDisabled:e.attributes.isDefault,onConfirm:()=>{s(e.id)}})}]}];return r.a.createElement(Y.EuiPortal,null,r.a.createElement(Y.EuiFlyout,{onClose:e,"data-test-subj":"loadViewsFlyout"},r.a.createElement(Y.EuiFlyoutHeader,null,r.a.createElement(Y.EuiTitle,{size:"m"},r.a.createElement("h2",null,r.a.createElement(X.FormattedMessage,{defaultMessage:"Manage saved views",id:"xpack.infra.openView.flyoutHeader"})))),r.a.createElement(Y.EuiFlyoutBody,null,r.a.createElement(Y.EuiInMemoryTable,{items:o,columns:c,loading:l,search:Rt,pagination:!0,sorting:!0})),r.a.createElement(Y.EuiModalFooter,null,r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"cancelSavedViewModal",onClick:e},r.a.createElement(X.FormattedMessage,{defaultMessage:"Cancel",id:"xpack.infra.openView.cancelButton"})))))}const Bt=({isDisabled:e,onConfirm:t})=>{const[a,n]=_t()(!1);return a?r.a.createElement(Y.EuiFlexGroup,null,r.a.createElement(Y.EuiButtonEmpty,{onClick:n,"data-test-subj":"hideConfirm"},r.a.createElement(X.FormattedMessage,{defaultMessage:"cancel",id:"xpack.infra.waffle.savedViews.cancel"})),r.a.createElement(Y.EuiButton,{disabled:e,fill:!0,iconType:"trash",color:"danger",onClick:t,"data-test-subj":"showConfirm"},r.a.createElement(X.FormattedMessage,{defaultMessage:"Delete view?",id:"xpack.infra.openView.actionNames.deleteConfirmation"}))):r.a.createElement(Y.EuiButtonIcon,{"data-test-subj":"infraDeleteConfimationButton",iconType:"trash",color:"danger",size:"s",onClick:n})},Vt=e=>({...e,name:e.attributes.name}),Nt=(e=!1)=>{const[t,a]=_t()(e);return[t,Object(n.useMemo)((()=>({toggle:a,on:()=>a(!0),off:()=>a(!1)})),[a])]},zt=W.i18n.translate("xpack.infra.waffle.savedViews.viewNamePlaceholder",{defaultMessage:"Name"}),$t=({onClose:e,onSave:t,isSaving:a,initialName:i="",initialIncludeTime:s=!1,title:l})=>{const[o,c]=Object(n.useState)(i),[u,d]=Object(n.useState)(s),m=o.trim();return r.a.createElement(Y.EuiModal,{onClose:e,"data-test-subj":"savedViews-upsertModal"},r.a.createElement(Y.EuiModalHeader,null,r.a.createElement(Y.EuiModalHeaderTitle,null,l)),r.a.createElement(Y.EuiModalBody,null,r.a.createElement(Y.EuiFieldText,{placeholder:zt,"data-test-subj":"savedViewName",value:o,onChange:e=>{c(e.target.value)},"aria-label":zt}),r.a.createElement(Y.EuiSpacer,{size:"xl"}),r.a.createElement(Y.EuiSwitch,{id:"saved-view-save-time-checkbox",label:r.a.createElement(X.FormattedMessage,{defaultMessage:"Store time with view",id:"xpack.infra.waffle.savedViews.includeTimeFilterLabel"}),checked:u,onChange:e=>{d(e.target.checked)}}),r.a.createElement(Y.EuiSpacer,{size:"s"}),r.a.createElement(Y.EuiText,{size:"xs",grow:!1,style:{maxWidth:400}},r.a.createElement(X.FormattedMessage,{defaultMessage:"This changes the time filter to the currently selected time each time the view is loaded",id:"xpack.infra.waffle.savedViews.includeTimeHelpText"}))),r.a.createElement(Y.EuiModalFooter,null,r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraSavedViewCreateModalCancelButton",onClick:e},r.a.createElement(X.FormattedMessage,{defaultMessage:"Cancel",id:"xpack.infra.waffle.savedViews.cancelButton"})),r.a.createElement(Y.EuiButton,{disabled:0===m.length,fill:!0,isLoading:a,onClick:()=>{t(m,u)},"data-test-subj":"createSavedViewButton"},r.a.createElement(X.FormattedMessage,{defaultMessage:"Save",id:"xpack.infra.waffle.savedViews.saveButton"}))))};function qt(e){const{currentView:t,views:a,isFetchingViews:n,isFetchingCurrentView:i,isCreatingView:s,isUpdatingView:l,onCreateView:o,onDeleteView:c,onUpdateView:u,onLoadViews:d,onSetDefaultView:m,onSwitchView:p,viewState:g}=e,[f,{off:b,toggle:h}]=Nt(!1),[y,{on:E,off:v}]=Nt(!1),[x,{on:w,off:k}]=Nt(!1),[O,{on:M,off:j}]=Nt(!1);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiPopover,{"data-test-subj":"savedViews-popover",button:r.a.createElement(Y.EuiButton,{onClick:()=>{f||d(),h()},"data-test-subj":"savedViews-openPopover",iconType:"arrowDown",iconSide:"right",color:"text",isLoading:i},t?t.attributes.name:W.i18n.translate("xpack.infra.savedView.unknownView",{defaultMessage:"No view selected"})),isOpen:f,closePopover:b,anchorPosition:"leftCenter"},r.a.createElement(Y.EuiListGroup,{flush:!0},r.a.createElement(Y.EuiListGroupItem,{"data-test-subj":"savedViews-manageViews",iconType:"indexSettings",onClick:()=>{b(),E()},label:W.i18n.translate("xpack.infra.savedView.manageViews",{defaultMessage:"Manage views"})}),r.a.createElement(Y.EuiListGroupItem,{"data-test-subj":"savedViews-updateView",iconType:"refresh",onClick:()=>{b(),M()},isDisabled:!t||t.attributes.isStatic,label:W.i18n.translate("xpack.infra.savedView.updateView",{defaultMessage:"Update view"})}),r.a.createElement(Y.EuiListGroupItem,{"data-test-subj":"savedViews-saveNewView",iconType:"save",onClick:()=>{b(),w()},label:W.i18n.translate("xpack.infra.savedView.saveNewView",{defaultMessage:"Save new view"})}))),x&&r.a.createElement($t,{isSaving:s,onClose:k,onSave:(e,t=!1)=>{const a={...g,name:e};t||delete a.time,o(a).then(k)},title:r.a.createElement(X.FormattedMessage,{defaultMessage:"Save View",id:"xpack.infra.waffle.savedView.createHeader"})}),O&&r.a.createElement($t,{isSaving:l,onClose:j,onSave:(e,a=!1)=>{if(!t)return;const n={...g,name:e};a||delete n.time,u({id:t.id,attributes:n}).then(j)},initialName:null==t?void 0:t.attributes.name,initialIncludeTime:Boolean(null==t?void 0:t.attributes.time),title:r.a.createElement(X.FormattedMessage,{defaultMessage:"Update View",id:"xpack.infra.waffle.savedView.updateHeader"})}),y&&r.a.createElement(At,{loading:n,views:a,onMakeDefaultView:m,onDeleteView:c,onClose:v,onSwitchView:p}))}const Ut=({viewState:e})=>{const{currentView:t,views:a,isFetchingViews:n,isFetchingCurrentView:i,isCreatingView:s,isUpdatingView:l,createView:o,deleteViewById:c,fetchViews:u,updateViewById:d,switchViewById:m,setDefaultViewById:p}=Te();return r.a.createElement(qt,{currentView:t,views:a,isFetchingViews:n,isFetchingCurrentView:i,isCreatingView:s,isUpdatingView:l,onCreateView:o,onDeleteView:c,onUpdateView:d,onLoadViews:u,onSetDefaultView:p,onSwitchView:m,viewState:e})},Gt=({source:e,derivedIndexPattern:t})=>{var a;const[i,s]=Object(n.useState)(!1),{isLoading:l,error:o,data:c,timeRange:u,options:d,chartOptions:m,setChartOptions:p,handleAggregationChange:g,handleMetricsChange:f,handleFilterQuerySubmit:b,handleGroupByChange:h,handleTimeChange:y,handleLoadMore:v,onViewStateChange:x,refresh:w}=((e,t,a=!0)=>{const{defaultViewState:r,options:i,timeRange:s,chartOptions:l,setChartOptions:o,setTimeRange:c,setOptions:u,timestamps:d,setTimestamps:m}=Object(he.g)(),p=Object(n.useCallback)((()=>{const e=E.a.parse(s.from).valueOf(),t=E.a.parse(s.to,{roundUp:!0}).valueOf();m({interval:s.interval,fromTimestamp:e,toTimestamp:t})}),[m,s]),{data:g,error:f,fetchNextPage:b,isLoading:h}=Object(Lt.a)(i,e,t,d,a);Object(n.useEffect)((()=>{p()}),[i,u,p]);const y=Object(n.useCallback)(((e,t)=>{c({interval:s.interval,from:e,to:t})}),[c,s.interval]),v=Object(n.useCallback)((e=>{u({...i,groupBy:e||void 0})}),[i,u]),x=Object(n.useCallback)((e=>{u({...i,filterQuery:e})}),[i,u]),w=Object(n.useCallback)((e=>{u({...i,metrics:e})}),[i,u]),k=Object(n.useCallback)((e=>{const t="count"===e?[{aggregation:e}]:i.metrics.filter((e=>"count"!==e.aggregation)).map((t=>({...t,aggregation:e})));u({...i,aggregation:e,metrics:t})}),[i,u]),O=Object(n.useCallback)((e=>{e.attributes.chartOptions&&o(e.attributes.chartOptions),e.attributes.currentTimerange&&(e.attributes.isStatic||c(e.attributes.currentTimerange)),e.attributes.options&&u(e.attributes.options)}),[o,u,c]);return{chartOptions:l,timeRange:s,data:g,defaultViewState:r,error:f,isLoading:h,handleAggregationChange:k,handleMetricsChange:w,handleFilterQuerySubmit:x,handleGroupByChange:v,handleTimeChange:y,handleLoadMore:b,onViewStateChange:O,options:i,setChartOptions:o,refresh:p}})(e,t,i),{currentView:k}=Te(),{source:O,metricIndicesExist:M}=Object(re.b)();Object(me.useTrackPageview)({app:"infra_metrics",path:"metrics_explorer"}),Object(me.useTrackPageview)({app:"infra_metrics",path:"metrics_explorer",delay:15e3});const{remoteClustersExist:j}=null!==(a=null==O?void 0:O.status)&&void 0!==a?a:{};Object(n.useEffect)((()=>{k&&x(k)}),[k,x]),Object(n.useEffect)((()=>{null!=k&&s(!0)}),[k]),Be([{text:Ae.g}]);const S={options:d,chartOptions:m,currentTimerange:u};return l&&!O?r.a.createElement(Me.a,null):j?r.a.createElement(Y.EuiErrorBoundary,null,r.a.createElement(Pt.a,{hasData:M,pageHeader:{pageTitle:Ae.g,rightSideItems:[r.a.createElement(Ut,{viewState:S}),r.a.createElement(Oe,{formUrl:"https://ela.st/survey-infra-metricsexplorer?usp=pp_url","data-test-subj":"infraMetricsExplorerFeedbackLink"})]}},r.a.createElement(Ft,{derivedIndexPattern:t,timeRange:u,options:d,chartOptions:m,onRefresh:w,onTimeChange:y,onGroupByChange:h,onFilterQuerySubmit:b,onMetricsChange:f,onAggregationChange:g,onChartOptionsChange:p}),o?r.a.createElement(Ve.a,{titleText:"Whoops!",bodyText:W.i18n.translate("xpack.infra.metricsExplorer.errorMessage",{defaultMessage:'It looks like the request failed with "{message}"',values:{message:o.message}}),onRefetch:w,refetchText:"Try Again"}):r.a.createElement(wt,{timeRange:u,isLoading:l,data:c,source:e,options:d,chartOptions:m,onLoadMore:v,onFilter:b,onRefetch:w,onTimeChange:y}))):r.a.createElement(Ve.b,null)};var Ht=a(29),Wt=a(77);const Qt=new RegExp(`^([\\d\\.]+)\\s*(${E.a.units.join("|")})$`),Jt=(v.keyof({seconds:null,minutes:null,hours:null,days:null,weeks:null,months:null,years:null}),["seconds","minutes","hours","days","weeks","months","years"]),Kt={seconds:W.i18n.translate("xpack.infra.durationUnits.seconds.plural",{defaultMessage:"seconds"}),minutes:W.i18n.translate("xpack.infra.durationUnits.minutes.plural",{defaultMessage:"minutes"}),hours:W.i18n.translate("xpack.infra.durationUnits.hours.plural",{defaultMessage:"hours"}),days:W.i18n.translate("xpack.infra.durationUnits.days.plural",{defaultMessage:"days"}),weeks:W.i18n.translate("xpack.infra.durationUnits.weeks.plural",{defaultMessage:"weeks"}),months:W.i18n.translate("xpack.infra.durationUnits.months.plural",{defaultMessage:"months"}),years:W.i18n.translate("xpack.infra.durationUnits.years.plural",{defaultMessage:"years"})},Yt={seconds:W.i18n.translate("xpack.infra.durationUnits.seconds.singular",{defaultMessage:"second"}),minutes:W.i18n.translate("xpack.infra.durationUnits.minutes.singular",{defaultMessage:"minute"}),hours:W.i18n.translate("xpack.infra.durationUnits.hours.singular",{defaultMessage:"hour"}),days:W.i18n.translate("xpack.infra.durationUnits.days.singular",{defaultMessage:"day"}),weeks:W.i18n.translate("xpack.infra.durationUnits.weeks.singular",{defaultMessage:"week"}),months:W.i18n.translate("xpack.infra.durationUnits.months.singular",{defaultMessage:"month"}),years:W.i18n.translate("xpack.infra.durationUnits.years.singular",{defaultMessage:"year"})};var Xt=a(141);const Zt={currentTime:Date.now(),isAutoReloading:!1},ea=v.type({currentTime:v.number,isAutoReloading:v.boolean}),ta=ea.encode,aa=e=>Object(x.pipe)(ea.decode(e),Object(w.fold)(Object(k.constant)(void 0),k.identity)),na=f()((()=>{const[e]=Object(Xt.a)({from:"now",to:"now"}),t=E.a.parse(e().to),[a,r]=Object(O.a)({defaultState:{...Zt,currentTime:t?t.toDate().getTime():Date.now()},decodeUrlState:aa,encodeUrlState:ta,urlStateKey:"waffleTime"}),[i,s]=Object(n.useState)(a);Object(n.useEffect)((()=>{r(i)}),[r,i]);const{currentTime:l,isAutoReloading:o}=a;return{currentTime:l,currentTimeRange:{from:l-3e5,interval:"1m",to:l},isAutoReloading:o,startAutoReload:Object(n.useCallback)((()=>{s((e=>({...e,isAutoReloading:!0,currentTime:Date.now()})))}),[s]),stopAutoReload:Object(n.useCallback)((()=>{s((e=>({...e,isAutoReloading:!1})))}),[s]),jumpToTime:Object(n.useCallback)((e=>{s((t=>({...t,currentTime:e})))}),[s]),setWaffleTimeState:s}})),[ra,ia]=na,sa=Object(Z.withTheme)((({interval:e})=>{const{currentTime:t,isAutoReloading:a,startAutoReload:i,stopAutoReload:s,jumpToTime:l}=ia(),o=h()(t),c=(e=>{const t=(e=>{if(e){const t=e.match(Qt);if(t)return{value:Number(t[1]),unit:t[2]}}throw new Error(W.i18n.translate("xpack.infra.parseInterval.errorMessage",{defaultMessage:"{value} is not an interval string",values:{value:e}}))})(e);if("s"===(null==t?void 0:t.unit)){const e=h.a.duration(t.value,t.unit),r=Jt.reduce(((t,a)=>e.as(a)>=1?a:t),"seconds"),i=e.as(r);return`${Math.floor(i)} ${a=i,n=r,1===Math.floor(a)?Yt[n]:Kt[n]}`}var a,n})(e),u=a?r.a.createElement(Y.EuiButton,{"data-test-subj":"infraWaffleTimeControlsStopRefreshingButton",color:"primary",iconSide:"left",iconType:"pause",onClick:s},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.waffleTime.stopRefreshingButtonLabel",defaultMessage:"Stop refreshing"})):r.a.createElement(Y.EuiButton,{"data-test-subj":"infraWaffleTimeControlsAutoRefreshButton",iconSide:"left",iconType:"play",onClick:i},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.waffleTime.autoRefreshButtonLabel",defaultMessage:"Auto-refresh"})),d=Object(n.useCallback)((e=>{e&&l(e.valueOf())}),[l]);return r.a.createElement(Y.EuiFlexGroup,{gutterSize:"m"},r.a.createElement(Y.EuiFlexItem,{grow:!1,"data-test-subj":"waffleDatePicker"},r.a.createElement(Y.EuiToolTip,{content:`Last ${c} of data for the selected time`,delay:"long",display:"inlineBlock",position:"top","data-test-subj":"waffleDatePickerIntervalTooltip"},r.a.createElement(Y.EuiDatePicker,{dateFormat:"L LTS",disabled:a,injectTimes:o?[o]:[],isLoading:a,onChange:d,popoverPlacement:"upRight",selected:o,shouldCloseOnSelect:!0,showTimeSelect:!0,timeFormat:"LT"}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},u))}));var la=a(295),oa=a(286),ca=a(45),ua=a(10),da=a(139);const ma={kind:"kuery",expression:""},pa=ua.d.encode,ga=e=>Object(x.pipe)(ua.d.decode(e),Object(w.fold)(Object(k.constant)(void 0),k.identity)),fa=f()((()=>{const{createDerivedIndexPattern:e}=Object(re.b)(),t=e(),[a,r]=Object(O.a)({defaultState:ma,decodeUrlState:ga,encodeUrlState:pa,urlStateKey:"waffleFilter"}),[i,s]=Object(n.useState)(a);Object(n.useEffect)((()=>r(i)),[r,i]);const[l,o]=Object(n.useState)(a.expression),c=Object(n.useMemo)((()=>Object(da.a)(a.expression,t)),[t,a.expression]),u=Object(n.useCallback)((e=>{s((t=>({...t,kind:"kuery",expression:e})))}),[s]),d=Object(n.useCallback)((e=>{s(e),o(e.expression)}),[]),m=Object(n.useMemo)((()=>(e=>{try{Object(ca.fromKueryExpression)(e)}catch(e){return!1}return!0})(l)),[l]),{inventoryPrefill:p}=Object(Je.b)(),g=Object(n.useMemo)((()=>p),[p]);return Object(n.useEffect)((()=>g.setFilterQuery(i.expression)),[g,i]),{filterQuery:a,filterQueryDraft:l,filterQueryAsJson:c,applyFilterQuery:d,setFilterQueryDraftFromKueryExpression:o,applyFilterQueryFromKueryExpression:u,isFilterQueryDraftValid:m,setWaffleFiltersState:d}})),[ba,ha]=fa,ya=()=>{const{createDerivedIndexPattern:e}=Object(re.b)(),{applyFilterQueryFromKueryExpression:t,filterQueryDraft:a,isFilterQueryDraftValid:n,setFilterQueryDraftFromKueryExpression:i}=ha();return r.a.createElement(oa.a,{indexPattern:e()},(({isLoadingSuggestions:e,loadSuggestions:s,suggestions:l})=>r.a.createElement(la.a,{isLoadingSuggestions:e,isValid:n,loadSuggestions:s,onChange:i,onSubmit:t,placeholder:W.i18n.translate("xpack.infra.homePage.toolbar.kqlSearchFieldPlaceholder",{defaultMessage:"Search for infrastructure data… (e.g. host.name:host-1)"}),suggestions:l,value:a||"",autoFocus:!0})))},Ea=({interval:e})=>r.a.createElement(Y.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"m",style:{flexGrow:0}},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(ya,null)),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(sa,{interval:e})));var va=a(158);const xa=({detailedMessage:e,retry:t,shortMessage:a})=>r.a.createElement(va.a,{isEmptyState:!0},r.a.createElement(Y.EuiCallOut,{color:"danger",iconType:"cross",title:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.errorPage.errorOccurredTitle",defaultMessage:"An error occurred"})},r.a.createElement(Y.EuiFlexGroup,{alignItems:"center"},r.a.createElement(Y.EuiFlexItem,null,a),t?r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,{"data-test-subj":"infraErrorPageTryAgainButton",onClick:t,iconType:"refresh"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.errorPage.tryAgainButtonLabel",defaultMessage:"Try again"}))):null),e?r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiSpacer,null),r.a.createElement("div",null,e)):null)),wa=({errorMessage:e,retry:t})=>r.a.createElement(xa,{shortMessage:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceErrorPage.failedToLoadDataSourcesMessage",defaultMessage:"Failed to load data sources."}),detailedMessage:r.a.createElement("pre",null,r.a.createElement("code",null,e)),retry:t}),ka={find:["inventory-views-find"],get:["inventory-views-get"],getById:e=>["inventory-views-get",e]},Oa=()=>{var e;const{inventoryViews:t}=Object(ge.b)().services,a=Object(me.useUiTracker)({app:"infra_metrics"}),n=Object(je.useQueryClient)(),{source:r,updateSourceConfiguration:i}=Object(re.b)(),s=null!==(e=null==r?void 0:r.configuration.inventoryDefaultView)&&void 0!==e?e:"0",[l,o]=Object(O.a)({defaultState:s,decodeUrlState:Sa,encodeUrlState:ja,urlStateKey:"inventoryViewId",writeDefaultState:!0}),c=Se(),{data:u,refetch:d,isFetching:m}=Object(je.useQuery)({queryKey:ka.find,queryFn:()=>t.client.findInventoryViews(),enabled:!1,placeholderData:[],onError:e=>{var t,a;return c.getViewFailure(null!==(t=null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message)},onSuccess:e=>{const t=e.length>=1e3?"over":"under";a({metric:`${t}_1000_saved_objects_for_inventory_view`})}}),{data:p,isFetching:g}=Object(je.useQuery)({queryKey:ka.getById(l),queryFn:({queryKey:[,e]})=>t.client.getInventoryView(e),onError:e=>{var t,a;c.getViewFailure(null!==(t=null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message),o(s)},placeholderData:null}),{mutate:f}=Object(je.useMutation)({mutationFn:e=>i({inventoryDefaultView:e}),onMutate:async e=>{await n.cancelQueries({queryKey:ka.find});const t=n.getQueryData(ka.find),a=Ca(e,t);return n.setQueryData(ka.find,a),{previousViews:t}},onSuccess:(e,t,a)=>!e&&null!=a&&a.previousViews?n.setQueryData(ka.find,a.previousViews):n.invalidateQueries({queryKey:ka.get})}),{mutateAsync:b,isLoading:h}=Object(je.useMutation)({mutationFn:e=>t.client.createInventoryView(e),onError:e=>{var t,a;c.upsertViewFailure(null!==(t=null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message)},onSuccess:e=>{n.setQueryData(ka.getById(e.id),e),o(e.id)}}),{mutateAsync:y,isLoading:E}=Object(je.useMutation)({mutationFn:({id:e,attributes:a})=>t.client.updateInventoryView(e,a),onError:e=>{var t,a;c.upsertViewFailure(null!==(t=null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message)},onSuccess:e=>{n.setQueryData(ka.getById(e.id),e)}}),{mutate:v}=Object(je.useMutation)({mutationFn:e=>t.client.deleteInventoryView(e),onMutate:async e=>{await n.cancelQueries({queryKey:ka.find});const t=n.getQueryData(ka.find),a=Ta(e,t);return n.setQueryData(ka.find,a),{previousViews:t}},onError:(e,t,a)=>{var r,i;c.deleteViewFailure(null!==(r=null===(i=e.body)||void 0===i?void 0:i.message)&&void 0!==r?r:e.message),null!=a&&a.previousViews&&n.setQueryData(ka.find,a.previousViews)},onSuccess:(e,t)=>{(null==p?void 0:p.id)===t&&o(s)},onSettled:()=>{d()}});return{views:u,currentView:p,createView:b,deleteViewById:v,fetchViews:d,updateViewById:y,switchViewById:o,setDefaultViewById:f,isCreatingView:h,isFetchingCurrentView:g,isFetchingViews:m,isUpdatingView:E}},Ma=v.string,ja=Ma.encode,Sa=e=>Object(x.pipe)(Ma.decode(e),Object(w.fold)(Object(k.constant)(void 0),k.identity)),Ca=(e,t=[])=>t.map((t=>({...t,attributes:{...t.attributes,isDefault:t.id===e}}))),Ta=(e,t=[])=>t.filter((t=>t.id!==e));var Ia=a(78),Fa=a.n(Ia),La=a(176),Pa=a.n(La),Da=a(140),_a=a.n(Da),Ra=a(183);function Aa(e){return e&&null!=e.nodes&&Array.isArray(e.nodes)}function Ba(e){return e&&null!=e.groups&&Array.isArray(e.groups)}function Va(e){return e.map((e=>e.value)).join("/")}function Na(e,t){const a=0===t.length?"__all__":Va(t),n=Object(Ne.first)(t);if(2===t.length&&n){const t=n.value,r=e.find((e=>e.id===t));if(Ba(r)){const e=r.groups.find((e=>e.id===a));if(Aa(e))return e}}const r=Object(Ne.last)(t),i=e.find((e=>e.id===a));return Aa(i)?i:{id:a,name:"__all__"===a?W.i18n.translate("xpack.infra.nodesToWaffleMap.groupsWithNodes.allName",{defaultMessage:"All"}):r&&r.label||"Unknown Group",count:0,width:0,squareSize:0,nodes:[]}}function za(e){const t=Object(Ne.last)(e.path);if(!t)throw new Error("There must be at least one node path item");return{pathId:e.path.map((e=>e.value)).join("/"),path:e.path,id:t.value,ip:t.ip,name:t.label||t.value,metrics:e.metrics}}function $a(e){return t=>t.id!==e.id}var qa=a(4),Ua=a.n(qa);class group_name_GroupName extends r.a.PureComponent{constructor(...e){super(...e),Ua()(this,"handleClick",(e=>{e.preventDefault();const{groupBy:t}=this.props.options;if(0===t.length)return;const a=this.props.isChild&&t.length>1?t[1]:t[0];this.props.onDrilldown(`${a.field}: "${this.props.group.name}"`)}))}render(){const{group:e,isChild:t}=this.props,a={fontSize:t?"0.85em":"1em"};return r.a.createElement(Ga,null,r.a.createElement(Ha,{isChild:t},r.a.createElement(Wa,null,r.a.createElement(Y.EuiToolTip,{position:"top",content:e.name},r.a.createElement(Y.EuiLink,{style:a,onClickCapture:this.handleClick,"data-test-subj":"groupNameLink"},e.name))),r.a.createElement(Qa,null,e.count)))}}const Ga=Z.euiStyled.div`
  position: relative;
  text-align: center;
  font-size: 16px;
  margin-bottom: 5px;
  top: 20px;
  display: flex;
  justify-content: center;
  padding: 0 10px;
`,Ha=Z.euiStyled.div`
  border: 1px solid ${e=>e.theme.eui.euiBorderColor};
  background-color: ${e=>e.isChild?e.theme.eui.euiColorLightestShade:e.theme.eui.euiColorEmptyShade};
  border-radius: 4px;
  box-shadow: 0px 2px 0px 0px ${e=>e.theme.eui.euiBorderColor};
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
`,Wa=Z.euiStyled.div`
  flex: 1 1 auto;
  padding: 6px 10px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,Qa=Z.euiStyled.div`
  flex: 0 0 auto;
  border-left: 1px solid ${e=>e.theme.eui.euiBorderColor};
  padding: 6px 10px;
  font-size: 0.85em;
  font-weight: normal;
`;var Ja=a(154),Ka=a(166),Ya=a(167),Xa=a(168);const Za=Object.keys(u.SnapshotMetricTypeKeys).reduce(((e,t)=>{var a;const n=null===(a=Object(Xa.a)(t))||void 0===a?void 0:a.text;return n&&(e[t]=n),e}),{});var en=a(119);const tn=({node:e,nodeType:t,currentTime:a})=>{const{euiTheme:i}=Object(Y.useEuiTheme)(),{sourceId:s}=Object(re.b)(),l=Object(n.useRef)(a),o=Object(u.findInventoryModel)(t),{customMetrics:c}=Object(en.d)(),d=o.tooltipMetrics.map((e=>({type:e}))).concat(c),m=JSON.stringify({bool:{filter:{match_phrase:{[o.fields.id]:e.id}}}}),{nodes:p,loading:g}=Object(Ka.a)({filterQuery:m,metrics:d,groupBy:[],nodeType:t,sourceId:s,currentTime:l.current,accountId:"",region:"",includeTimeseries:!1},{abortable:!0}),f=Object(Ne.first)(p),b=f&&f.metrics||[];return r.a.createElement("div",{style:{minWidth:200},"data-test-subj":`conditionalTooltipContent-${e.name}`},r.a.createElement("div",{style:{borderBottom:`${i.border.thin}`,borderBottomColor:`${i.colors.mediumShade}`,paddingBottom:i.size.xs,marginBottom:i.size.xs}},e.name),g?r.a.createElement(Y.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},r.a.createElement(Y.EuiFlexItem,{grow:!1,"data-test-subj":"conditionalTooltipContent-loading"},r.a.createElement(Y.EuiLoadingSpinner,{size:"s"}))):b.map((e=>{const t=u.SnapshotMetricTypeRT.is(e.name)?e.name:"custom",a=Za[t]||t,n="custom"===a?c.find((t=>t.id===e.name)):null,i=n?Object(ht.a)(n):Object(Ya.a)({type:t});return r.a.createElement(Y.EuiFlexGroup,{gutterSize:"s",key:e.name},r.a.createElement(Y.EuiFlexItem,{grow:1,className:"eui-textTruncate eui-displayBlock","data-test-subj":"conditionalTooltipContent-metric"},n?Object(Ja.a)(n):a),r.a.createElement(Y.EuiFlexItem,{grow:!1,"data-test-subj":"conditionalTooltipContent-value"},e.value&&i(e.value)||"-"))})))};var an=a(159);const nn={[tt.c.eq]:Ne.isEqual,[tt.c.lt]:Ne.lt,[tt.c.lte]:Ne.lte,[tt.c.gte]:Ne.gte,[tt.c.gt]:Ne.gt},rn=e=>Object(an.toColorString)(Object(an.parseToRgb)(e)),sn=(e,t,a)=>(a-e)/(t-e),ln=({options:e,nodeType:t,filter:a,visible:i,setVisible:s})=>{const{triggersActionsUI:l}=Object(n.useContext)(We.a),{inventoryPrefill:o}=Object(Je.b)(),{customMetrics:c=[]}=null!=o?o:{},u=Object(n.useCallback)((()=>s(!1)),[s]),d=Object(n.useMemo)((()=>l&&l.getAddRuleFlyout({consumer:"infrastructure",onClose:u,canChangeTrigger:!1,ruleTypeId:Qe.d,metadata:{options:e,nodeType:t,filter:a,customMetrics:c},useRuleProducer:!0})),[l,i]);return r.a.createElement(r.a.Fragment,null,i&&d)},on=({onClose:e})=>{const{inventoryPrefill:t}=Object(Je.b)(),{nodeType:a,metric:n,filterQuery:i}=t;return r.a.createElement(ln,{options:{metric:n},nodeType:a,filter:i,visible:!0,setVisible:e})};var cn=a(39);const un=Object(Z.withTheme)((({options:e,currentTime:t,node:a,nodeType:i})=>{var s,l;const{getNodeDetailUrl:o}=ut(),[c,d]=Object(n.useState)(!1),m=Object(u.findInventoryModel)(i),p=t-1e3*m.metrics.defaultTimeRangeInSeconds,{services:g}=Object(ge.b)(),{application:f,share:b,locators:h}=g,y=null==f?void 0:f.capabilities,E="host"===i?"host.hostname":m.fields.id,v=m.crosslinkSupport.details,x=m.crosslinkSupport.logs&&a.id&&(null==y||null===(s=y.logs)||void 0===s?void 0:s.show),w=m.crosslinkSupport.apm&&(null==y?void 0:y.apm)&&(null==y?void 0:y.apm.show),k=m.crosslinkSupport.uptime&&(["pod","container"].includes(i)||a.ip),O=null==y||null===(l=y.infrastructure)||void 0===l?void 0:l.save,M=Object(n.useMemo)((()=>{if("host"!==i){const{id:e}=Object(u.findInventoryFields)(i);return{label:r.a.createElement(Y.EuiCode,null,e),value:a.id}}return a.ip?{label:r.a.createElement(Y.EuiCode,null,W.i18n.translate("xpack.infra.inventoryId.host.ipCodeLabel",{defaultMessage:"host.ip"})),value:a.ip}:{label:"",value:""}}),[i,a.ip,a.id]),j=Object(me.useLinkProps)({...o({assetType:i,assetId:a.id,search:{from:p,to:t,name:a.name}})}),S=Object(me.useLinkProps)({app:"apm",hash:"traces",search:{kuery:`${E}:"${a.id}"`}}),C={label:W.i18n.translate("xpack.infra.nodeContextMenu.viewLogsName",{defaultMessage:"{inventoryName} logs",values:{inventoryName:m.singularDisplayName}}),href:h.nodeLogsLocator.getRedirectUrl({nodeType:i,nodeId:a.id,time:t}),"data-test-subj":"viewLogsContextMenuItem",isDisabled:!x},T={label:W.i18n.translate("xpack.infra.nodeContextMenu.viewMetricsName",{defaultMessage:"{inventoryName} metrics",values:{inventoryName:m.singularDisplayName}}),...j,isDisabled:!v},I={label:W.i18n.translate("xpack.infra.nodeContextMenu.viewAPMTraces",{defaultMessage:"{inventoryName} APM traces",values:{inventoryName:m.singularDisplayName}}),...S,"data-test-subj":"viewApmTracesContextMenuItem",isDisabled:!w},F={label:W.i18n.translate("xpack.infra.nodeContextMenu.viewUptimeLink",{defaultMessage:"{inventoryName} in Uptime",values:{inventoryName:m.singularDisplayName}}),onClick:()=>((e,t,a)=>e.get(cn.uptimeOverviewLocatorID).navigate({[t]:a.id,ip:a.ip}))(b.url.locators,i,a),isDisabled:!k},L={label:W.i18n.translate("xpack.infra.nodeContextMenu.createRuleLink",{defaultMessage:"Create inventory rule"}),onClick:()=>{d(!0)},isDisabled:!O};return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{maxWidth:300},"data-test-subj":"nodeContextMenu"},r.a.createElement(me.Section,null,r.a.createElement(me.SectionTitle,null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.nodeContextMenu.title",defaultMessage:"{inventoryName} details",values:{inventoryName:m.singularDisplayName}})),M.label&&r.a.createElement(me.SectionSubtitle,null,r.a.createElement("div",{style:{wordBreak:"break-all"}},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.nodeContextMenu.description",defaultMessage:"View details for {label} {value}",values:{label:M.label,value:M.value}}))),r.a.createElement(me.SectionLinks,null,r.a.createElement(me.SectionLink,de()({"data-test-subj":"viewLogsContextMenuItem"},C)),r.a.createElement(me.SectionLink,de()({"data-test-subj":"viewAssetDetailsContextMenuItem"},T)),r.a.createElement(me.SectionLink,de()({"data-test-subj":"viewApmTracesContextMenuItem"},I)),r.a.createElement(me.SectionLink,de()({},F,{color:"primary"}))),r.a.createElement(me.ActionMenuDivider,null),r.a.createElement(me.SectionLinks,null,r.a.createElement(me.SectionLink,de()({iconType:"bell",color:"primary"},L))))),c&&r.a.createElement(ln,{filter:`${Object(u.findInventoryFields)(i).id}: "${a.id}"`,options:e,nodeType:i,setVisible:d,visible:c}))}));var dn=a(93);const mn=({children:e,css:t,...a})=>r.a.createElement(kn,de()({},a,{$_css:Object(an.readableColor)(a.color)}),e);var pn=Fa()(mn).withConfig({displayName:"_StyledSquareContent2",componentId:"sc-1oj7o9p-0"})(["font-weight:bold;font-size:0.9em;line-height:1.2em;"]),gn=Fa()(mn).withConfig({displayName:"_StyledSquareContent",componentId:"sc-1oj7o9p-1"})(["font-size:0.7em;margin-bottom:0.7em;"]);const fn=({children:e,...t})=>r.a.createElement(On,t,e),bn=({children:e,...t})=>r.a.createElement(Mn,de()({},t,{$_css2:Object(an.darken)(.1,t.color)}),e),hn=({children:e,...t})=>r.a.createElement(jn,de()({},t,{$_css3:dn.euiThemeVars.euiFocusRingSize,$_css4:dn.euiThemeVars.euiFocusRingColor}),e),yn=({children:e,...t})=>r.a.createElement(Sn,de()({},t,{$_css5:Object(an.darken)(.1,t.color)}),e),En=({children:e,...t})=>r.a.createElement(Cn,de()({},t,{$_css6:t.color}),e),vn=({children:e,...t})=>r.a.createElement(gn,t,e),xn=({children:e,...t})=>r.a.createElement(pn,t,e),wn=({squareSize:e,togglePopover:t,showToolTip:a,hideToolTip:n,color:i,nodeName:s,value:l,showBorder:o})=>{const c=e>70,u=e>30,d=W.i18n.translate("xpack.infra.node.ariaLabel",{defaultMessage:"{nodeName}, click to open menu",values:{nodeName:s}}),m=o?{border:"solid 4px #000"}:void 0;return c||u?r.a.createElement(fn,{"data-test-subj":"nodeContainer",style:{width:e||0,height:e||0},onClick:t,onKeyPress:t,onFocus:a,onMouseOver:a,onMouseLeave:n,className:"buttonContainer"},r.a.createElement(yn,{color:i,style:m},r.a.createElement(En,{color:i},c?r.a.createElement(hn,{"aria-label":d},r.a.createElement(vn,{"data-test-subj":"nodeName",color:i},s),r.a.createElement(xn,{"data-test-subj":"nodeValue",color:i},l)):u&&r.a.createElement(hn,{"aria-label":d},r.a.createElement(vn,{color:i},"..."))))):r.a.createElement(bn,{"data-test-subj":"nodeContainer",style:{width:e||0,height:e||0,...m},onClick:t,onKeyPress:t,onMouseOver:a,onFocus:a,onMouseLeave:n,color:i})};var kn=Fa()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1oj7o9p-2"})(["text-align:center;width:100%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex:1 0 auto;color:",";"],(e=>e.$_css)),On=Fa()("div").withConfig({displayName:"_StyledDiv2",componentId:"sc-1oj7o9p-3"})(["position:relative;cursor:pointer;"]),Mn=Fa()("div").withConfig({displayName:"_StyledDiv3",componentId:"sc-1oj7o9p-4"})(["cursor:pointer;position:relative;background-color:",";border-radius:3px;margin:2px;box-shadow:0 1px 2px 0 rgba(0,0,0,0.2);"],(e=>e.$_css2)),jn=Fa()("button").withConfig({displayName:"_StyledButton",componentId:"sc-1oj7o9p-5"})(["position:absolute;top:0;left:0;right:0;bottom:0;display:flex;line-height:1.2em;align-items:center;align-content:center;padding:1em;overflow:hidden;flex-wrap:wrap;width:100%;border:none;&:focus{outline:none !important;border:"," solid ",";box-shadow:none;}"],(e=>e.$_css3),(e=>e.$_css4)),Sn=Fa()("div").withConfig({displayName:"_StyledDiv4",componentId:"sc-1oj7o9p-6"})(["position:absolute;top:4px;left:4px;bottom:4px;right:4px;background-color:",";border-radius:3px;box-shadow:0 1px 2px 0 rgba(0,0,0,0.2);"],(e=>e.$_css5)),Cn=Fa()("div").withConfig({displayName:"_StyledDiv5",componentId:"sc-1oj7o9p-7"})(["position:absolute;top:0;right:0;bottom:2px;left:0;border-radius:3px;background-color:",";"],(e=>e.$_css6));const Tn=({nodeType:e,node:t,options:a,squareSize:n,bounds:i,formatter:s,currentTime:l,setFlyoutUrlState:o,detailsItemId:c})=>{const[u,{off:d,on:m}]=Nt(!1),[p,{off:g,toggle:f}]=Nt(!1),b=Object(Ne.first)(t.metrics),h=b&&b.value||0,y=((e,t,a,n="rgba(217, 217, 217, 1)")=>{try{return tt.e.is(e)?rn(((e,t,a="rgba(217, 217, 217, 1)")=>e.reduce(((e,a)=>(0,nn[a.operator])(t,a.value)?a.color:e),a))(e.rules,t,n)):tt.a.is(e)?rn(((e,t,a,n="rgba(0, 179, 164, 1)")=>{if(0===e.length)return n;if(1===e.length)return Object(Ne.last)(e).color;const{min:r,max:i}=a,s=Object(Ne.sortBy)(e,"value"),l=sn(r,i,Number(t)),o=s.reduce(((e,t)=>t.value<=l?t:e),Object(Ne.first)(s)),c=s.filter((e=>e!==o)).find((e=>e.value>=l));if(!c)return o.color;const u=sn(o.value,c.value,l);return Object(an.mix)(u,c.color,o.color)})(e.rules,t,a,n)):tt.f.is(e)?rn(((e,t,a,n="rgba(217, 217, 217, 1)")=>{var r,i;const s=sn(a.min,a.max,Number(t)),l=e.length,o=Object(Ne.last)(e);return o&&Object(Ne.gte)(s,o.value)?o.color:e.reduce(((e,t)=>{const a=t.value-1/l,n=t.value;return Object(Ne.gte)(s,a)&&Object(Ne.lte)(s,n)?t.color:e}),null!==(r=null===(i=Object(Ne.first)(e))||void 0===i?void 0:i.color)&&void 0!==r?r:n)})(e.rules,t,a,n)):n}catch(e){return n}})(a.legend,h,i),E=s(h),v=r.a.createElement(wn,{squareSize:n,togglePopover:()=>{"host"===e?o({detailsItemId:t.name}):f()},showToolTip:m,hideToolTip:d,color:y,nodeName:t.name,value:E,showBorder:c===t.name||p});return r.a.createElement(r.a.Fragment,null,p?r.a.createElement(Y.EuiPopover,{button:v,isOpen:p,closePopover:g,anchorPosition:"downCenter",style:{height:n}},r.a.createElement(un,{node:t,nodeType:e,options:a,currentTime:l})):u?r.a.createElement(Y.EuiToolTip,{delay:"regular",position:"right",content:r.a.createElement(tn,{currentTime:l,node:t,nodeType:e})},v):v)},In={detailsItemId:null},Fn=()=>{const[e,t]=Object(O.a)({defaultState:{...In},decodeUrlState:Dn,encodeUrlState:Pn,urlStateKey:"assetDetailsFlyout"});return[e,t]},Ln=v.type({detailsItemId:v.union([v.string,v.null])}),Pn=Ln.encode,Dn=e=>Object(x.pipe)(Ln.decode(e),Object(w.fold)(Object(k.constant)(void 0),k.identity)),_n=(e,t)=>{const{bounds:a,group:n,...r}=e,{bounds:i,group:s,...l}=t,{nodes:o,...c}=e.group,{nodes:u,...d}=t.group;return Object(Ne.isEqual)(r,l)&&Object(Ne.isEqual)(c,d)},Rn=r.a.memo((({group:e,options:t,formatter:a,onDrilldown:n,isChild:i=!1,bounds:s,nodeType:l,currentTime:o,detailsItemId:c})=>{const u=e.width>200?e.width:200,[d,m]=Fn();return r.a.createElement(An,{style:{width:u}},r.a.createElement(group_name_GroupName,{group:e,onDrilldown:n,isChild:i,options:t}),r.a.createElement(Bn,null,e.width?e.nodes.map((n=>r.a.createElement(Tn,{key:`${n.pathId}:${n.name}`,options:t,squareSize:e.squareSize,node:n,formatter:a,bounds:s,nodeType:l,currentTime:o,detailsItemId:c,setFlyoutUrlState:m}))):r.a.createElement(Y.EuiLoadingSpinner,{size:"xl"})))}),_n),An=Z.euiStyled.div`
  margin: 0 10px;
`,Bn=Z.euiStyled.div`
  display: flex;
  background-color: rgba(0, 0, 0, 0.05);
  flex-wrap: wrap;
  justify-content: center;
  padding: 20px 10px 10px;
  border-radius: 4px;
  border: 1px solid ${e=>e.theme.eui.euiBorderColor};
  box-shadow: 0 1px 7px rgba(0, 0, 0, 0.1);
`,Vn=e=>r.a.createElement(Nn,null,r.a.createElement(group_name_GroupName,{group:e.group,onDrilldown:e.onDrilldown,options:e.options}),r.a.createElement(zn,null,e.group.groups.map((t=>r.a.createElement(Rn,{isChild:!0,key:t.id,onDrilldown:e.onDrilldown,options:e.options,group:t,formatter:e.formatter,bounds:e.bounds,nodeType:e.nodeType,currentTime:e.currentTime,detailsItemId:e.detailsItemId}))))),Nn=Z.euiStyled.div`
  margin: 0 10px;
  width: 100%;
`,zn=Z.euiStyled.div`
  display: flex;
  background-color: rgba(0, 0, 0, 0.05);
  flex-wrap: wrap;
  justify-content: center;
  padding: 20px 10px 10px;
  border-radius: 4px;
  border: 1px solid ${e=>e.theme.eui.euiBorderColor};
  box-shadow: 0 1px 7px rgba(0, 0, 0, 0.1);
`,$n=.55,qn=1/0,Un=24;function Gn(e,t=1,a=1){const n=t/a,r=n>1.2?1.2:n,i=Math.ceil(Math.sqrt(e));return Math.ceil(i*r)}function Hn(e){return e?e.reduce(((e,t)=>Ba(t)?t.groups.reduce(((e,t)=>t.nodes.length+e),e):Aa(t)?t.nodes.length+e:e),0):0}const Wn=e=>Hn([e]);const Qn={name:e=>Object(Ne.last)(e.path),value:e=>{const t=Object(Ne.first)(e.metrics);return t&&t.value||0}},Jn=({nodes:e,options:t,currentTime:a,onFilter:n,formatter:i,bounds:s,nodeType:l,bottomMargin:o,staticHeight:c,detailsItemId:u})=>{const d=((e,t)=>{const a=Qn[e.by],n=Object(Ne.sortBy)(t,a);return"desc"===e.direction?n.reverse():n})(t.sort,e),m=function(e){return e.reduce(((e,t)=>{const a=za(t);if(2===t.path.length){const n=Na(e,t.path.slice(0,t.path.length-1));return n.nodes.push(a),e.filter($a(n)).concat([n])}if(3===t.path.length){const n=Na(e,t.path.slice(0,t.path.length-1));n.nodes.push(a);const r=function(e,t){const a=0===t.length?"__all__":Va(t),n=Object(Ne.last)(t),r=e.find((e=>e.id===a));return Ba(r)?r:{id:a,name:"__all__"===a?W.i18n.translate("xpack.infra.nodesToWaffleMap.groupsWithGroups.allName",{defaultMessage:"All"}):n&&n.label||"Unknown Group",count:0,width:0,squareSize:0,groups:[]}}(e,t.path.slice(0,t.path.length-2));return r.groups=r.groups.filter($a(n)).concat([n]),e.filter($a(r)).concat([r])}const n=Na(e,[]);return n.nodes.push(a),e.filter($a(n)).concat([n])}),[])}(d);return r.a.createElement(Ra.a,{bounds:!0},(({measureRef:e,bounds:{width:d=0,height:p=0}})=>{const g=function(e,t,a){if(0===e.length)return[];const n=Ba(Object(Ne.first)(e))?2:1,r=Hn(e),i=Math.round(function(e,t,a,n=1){const r=$n/(n>1?.7*n:1),i=e*r,s=t*r,l=Math.ceil(Math.sqrt(a*i/s));let o,c;o=Math.floor(l*s/i)*l<a?s/Math.ceil(l*s/i):i/l;const u=Math.ceil(Math.sqrt(a*s/i));c=Math.floor(u*i/s)*u<a?i/Math.ceil(i*u/s):s/u;const d=Math.max(o,c);return Math.min(Math.max(d,Un),qn)}(t,a,r,n)),s=function(e){return e?e.reduce(((e,t)=>Ba(t)?t.groups.reduce(((e,t)=>Aa(t)?e>t.nodes.length?e:t.nodes.length:e),e):Aa(t)?e>t.nodes.length?e:t.nodes.length:e),0):0}(e);return Object(Ne.sortBy)(e,Wn).reverse().map((e=>{if(Ba(e)){const n=Gn(s,t,a),r=e.groups,l=Object(Ne.sortBy)(r,Wn).reverse().filter(Aa).map((e=>({...e,count:e.nodes.length,columns:n,width:n*i,squareSize:i})));return{...e,groups:l,count:Hn([e]),squareSize:i}}if(Aa(e)){const n=Gn(Math.max(e.nodes.length,s),t,a);return{...e,count:e.nodes.length,squareSize:i,width:n*i}}return e}))}(m,d,p);return r.a.createElement(Kn,{ref:t=>e(t),bottomMargin:o,"data-test-subj":"waffleMap",staticHeight:c},r.a.createElement(Yn,null,g.map((e=>Ba(e)?r.a.createElement(Vn,{onDrilldown:n,key:e.id,options:t,group:e,formatter:i,bounds:s,nodeType:l,currentTime:a,detailsItemId:u}):Aa(e)?r.a.createElement(Rn,{key:e.id,options:t,group:e,onDrilldown:n,formatter:i,isChild:!1,bounds:s,nodeType:l,currentTime:a,detailsItemId:u}):void 0))))}))},Kn=Z.euiStyled.div`
  flex: 1 0 0%;
  display: flex;
  justify-content: flex-start;
  flex-direction: column;
  overflow-x: hidden;
  overflow-y: auto;
  margin-bottom: ${e=>e.bottomMargin}px;
  max-width: calc(100vw - 90px);
  ${e=>e.staticHeight&&"min-height: 300px;"}
`,Yn=Z.euiStyled.div`
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: center;
  align-content: flex-start;
`,Xn=W.i18n.translate("xpack.infra.groupByDisplayNames.availabilityZone",{defaultMessage:"Availability zone"}),Zn=W.i18n.translate("xpack.infra.groupByDisplayNames.machineType",{defaultMessage:"Machine type"}),er=e=>({"kubernetes.namespace":W.i18n.translate("xpack.infra.groupByDisplayNames.kubernetesNamespace",{defaultMessage:"Namespace"}),"kubernetes.node.name":W.i18n.translate("xpack.infra.groupByDisplayNames.kubernetesNodeName",{defaultMessage:"Node"}),"host.name":W.i18n.translate("xpack.infra.groupByDisplayNames.hostName",{defaultMessage:"Host"}),"cloud.availability_zone":Xn,"cloud.machine.type":Zn,"cloud.project.id":W.i18n.translate("xpack.infra.groupByDisplayNames.projectID",{defaultMessage:"Project ID"}),"cloud.provider":W.i18n.translate("xpack.infra.groupByDisplayNames.provider",{defaultMessage:"Cloud provider"}),"service.type":W.i18n.translate("xpack.infra.groupByDisplayNames.serviceType",{defaultMessage:"Service type"}),"aws.cloud.availability_zone":Xn,"aws.cloud.machine.type":Zn,"aws.tags":W.i18n.translate("xpack.infra.groupByDisplayNames.tags",{defaultMessage:"Tags"}),"aws.ec2.instance.image.id":W.i18n.translate("xpack.infra.groupByDisplayNames.image",{defaultMessage:"Image"}),"aws.ec2.instance.state.name":W.i18n.translate("xpack.infra.groupByDisplayNames.state.name",{defaultMessage:"State"}),"cloud.region":W.i18n.translate("xpack.infra.groupByDisplayNames.cloud.region",{defaultMessage:"Region"}),"aws.rds.db_instance.class":W.i18n.translate("xpack.infra.groupByDisplayNames.rds.db_instance.class",{defaultMessage:"Instance Class"}),"aws.rds.db_instance.status":W.i18n.translate("xpack.infra.groupByDisplayNames.rds.db_instance.status",{defaultMessage:"Status"})}[e]||e),tr={sort:{field:"value",direction:"desc"}},ar=e=>{switch(e.length){case 3:return e.slice(0,2);case 2:return e.slice(0,1);default:return[]}},nr=e=>{const{nodes:t,options:a,formatter:i,currentTime:s,nodeType:l}=e,[o,c]=Object(n.useState)(null),u=()=>c(null),d=[{field:"name",name:W.i18n.translate("xpack.infra.tableView.columnName.name",{defaultMessage:"Name"}),sortable:!0,truncateText:!0,textOnly:!0,render:(e,t)=>{const n=t.node.id===e?`${e}`:`${e} (${t.node.id})`,i=[...t.node.path.map((e=>e.value)),t.node.name].join(":"),d=r.a.createElement(Y.EuiToolTip,{content:n},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraColumnsButton",onClick:()=>c(i)},e));return r.a.createElement(Y.EuiPopover,{button:d,isOpen:o===i,closePopover:u,anchorPosition:"rightCenter"},r.a.createElement(un,{node:t.node,nodeType:l,currentTime:s,options:a}))}},...a.groupBy.map(((t,a)=>({field:`group_${a}`,name:er(t&&t.field||""),sortable:!0,truncateText:!0,textOnly:!0,render:a=>r.a.createElement(Y.EuiToolTip,{content:"Set Filter"},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraColumnsButton",onClick:()=>e.onFilter(`${t.field}:"${a}"`)},a))}))),{field:"value",name:W.i18n.translate("xpack.infra.tableView.columnName.last1m",{defaultMessage:"Last 1m"}),sortable:!0,truncateText:!0,dataType:"number",render:e=>r.a.createElement("span",null,i(e))},{field:"avg",name:W.i18n.translate("xpack.infra.tableView.columnName.avg",{defaultMessage:"Avg"}),sortable:!0,truncateText:!0,dataType:"number",render:e=>r.a.createElement("span",null,i(e))},{field:"max",name:W.i18n.translate("xpack.infra.tableView.columnName.max",{defaultMessage:"Max"}),sortable:!0,truncateText:!0,dataType:"number",render:e=>r.a.createElement("span",null,i(e))}],m=Object(n.useMemo)((()=>t.map((e=>{const t=Object(Ne.last)(e.path),a=Object(Ne.first)(e.metrics);return{name:t&&t.label||"unknown",...ar(e.path).reduce(((e,t,a)=>({...e,[`group_${a}`]:t.label})),{}),value:a&&a.value||0,avg:a&&a.avg||0,max:a&&a.max||0,node:za(e)}}))),[t]);return r.a.createElement(Y.EuiInMemoryTable,{pagination:!0,sorting:tr,items:m,columns:d})},rr=e=>{const t=e.map((e=>{const t=Object(Ne.first)(e.metrics);return t&&t.value?t.value:0}));1===t.length&&t.unshift(0);const a=Object(Ne.max)(t)||0,n=Object(Ne.min)(t)||0;return{min:Object(Ne.isFinite)(n)?n:0,max:Object(Ne.isFinite)(a)?a:0}},ir=({legend:e,bounds:t,formatter:a})=>{const n=e.rules.reduce(((e,t)=>e<t.value?t.value:e),0),i={background:`linear-gradient(to right, ${e.rules.map((e=>{const t=e.value/n*100;return`${e.color} ${t}%`}))})`};return r.a.createElement(sr,{style:i},e.rules.map(((e,t)=>(a,n)=>{const i=0===a.value?e.min:e.max*a.value,s={left:100*a.value+"%"},l=t(i);return r.a.createElement(lr,{style:s,key:`legend-rule-${n}`},r.a.createElement(or,null),r.a.createElement(cr,null,l))})(t,a)))},sr=Z.euiStyled.div`
  position: absolute;
  height: 10px;
  bottom: 0;
  left: 0;
  right: 40px;
`,lr=Z.euiStyled.div`
  position: absolute;
  bottom: 0;
  top: -18px;
`,or=Z.euiStyled.div`
  position: absolute;
  background-color: ${e=>e.theme.eui.euiBorderColor};
  width: 1px;
  left: 0;
  top: 15px;
  bottom: 0;
  ${lr}:first-child {
    top: 2px;
  }
  ${lr}:last-child {
    top: 2px;
  }
`,cr=Z.euiStyled.div`
  position: absolute;
  font-size: 11px;
  text-align: center;
  top: 0;
  left: 0;
  white-space: nowrap;
  transform: translate(-50%, 0);
  ${lr}:first-child & {
    padding-left: 5px;
    transform: translate(0, 0);
  }
  ${lr}:last-child & {
    padding-right: 5px;
    transform: translate(-100%, 0);
  }
`,ur={[tt.c.gte]:">=",[tt.c.gt]:">",[tt.c.lte]:"<=",[tt.c.lt]:"<",[tt.c.eq]:"="},dr=({legend:e,formatter:t})=>r.a.createElement(mr,null,e.rules.map((e=>(t,a)=>{const n=null!=t.label?t.label:`${ur[t.operator]} ${e(t.value)}`,i={backgroundColor:Object(an.darken)(.4,t.color)},s={backgroundColor:t.color};return r.a.createElement(pr,{key:`legend-step-${a}`},r.a.createElement(gr,{style:i},r.a.createElement(fr,{style:s})),r.a.createElement(br,null,n))})(t))),mr=Z.euiStyled.div`
  display: flex;
  padding: 10px 40px 10px 10px;
`,pr=Z.euiStyled.div`
  display: flex;
  margin-right: 20px
  align-items: center;
`,gr=Z.euiStyled.div`
  position: relative;
  width: 24px;
  height: 24px;
  flex: 0 0 auto;
  margin-right: 5px;
  border-radius: 3px;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2);
`,fr=Z.euiStyled.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 2px;
  border-radius: 3px;
`,br=Z.euiStyled.div`
  font-size: 12px;
`,hr=({legend:e,bounds:t,formatter:a})=>r.a.createElement(Er,null,r.a.createElement(yr,{value:1,bounds:t,formatter:a}),r.a.createElement(vr,null,e.rules.slice().reverse().map(((e,t)=>r.a.createElement(xr,{key:`step-${t}-${e.value}`,style:{backgroundColor:e.color}})))),r.a.createElement(yr,{value:0,bounds:t,formatter:a})),yr=({value:e,bounds:t,formatter:a})=>{const n=a(0===e?t.min:t.max*e);return r.a.createElement("div",null,r.a.createElement(Y.EuiText,{size:"xs"},n))},Er=Z.euiStyled.div`
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
`,vr=Z.euiStyled.div`
  height: 200px;
  width: 10px;
  display: flex;
  flex-direction: column;
  align-items: stretch;
`,xr=Z.euiStyled.div`
  flex: 1 1 auto;
  &:first-child {
    border-radius: ${e=>e.theme.eui.euiBorderRadius} ${e=>e.theme.eui.euiBorderRadius} 0 0;
  }
  &:last-child {
    border-radius: 0 0 ${e=>e.theme.eui.euiBorderRadius} ${e=>e.theme.eui.euiBorderRadius};
  }
`,wr=({legend:e,bounds:t,formatter:a})=>r.a.createElement(kr,null,tt.a.is(e)&&r.a.createElement(ir,{formatter:a,legend:e,bounds:t}),tt.e.is(e)&&r.a.createElement(dr,{formatter:a,legend:e}),tt.f.is(e)&&r.a.createElement(hr,{formatter:a,bounds:t,legend:e})),kr=Z.euiStyled.div`
  margin: 0 10px;
  display: flex;
`;var Or=a(135),Mr=a.n(Or),jr=a(21),Sr=a(38);const Cr=()=>{const e=Date.now();return{from:new Date(e-9e5).toISOString(),to:new Date(e).toISOString()}},Tr=(R.OVERVIEW,()=>{const[e,t]=Object(O.a)({defaultState:null,decodeUrlState:Dr,encodeUrlState:Pr,urlStateKey:z});return[e,Object(n.useCallback)((e=>{if(e){const a=Object.fromEntries(Object.entries(null!=e?e:{}).filter((([e,t])=>!!t||""===t)));t((e=>({...e,...a})))}else t(null)}),[t])]}),Ir=v.union([v.literal(R.OVERVIEW),v.literal(R.METADATA),v.literal(R.PROCESSES),v.literal(R.PROFILING),v.literal(R.LOGS),v.literal(R.ANOMALIES),v.literal(R.OSQUERY)]),Fr=v.partial({autoRefresh:v.partial({isPaused:v.boolean,interval:v.number}),dateRange:v.type({from:v.string,to:v.string}),tabId:Ir,name:v.string,processSearch:v.string,metadataSearch:v.string,logsSearch:v.string}),Lr=v.union([Fr,v.null]),Pr=Lr.encode,Dr=e=>Object(x.pipe)(Lr.decode(e),Object(w.fold)(Object(k.constant)(void 0),k.identity)),[_r,Rr]=f()((function({dateRange:e=Cr(),autoRefresh:t}){var a,r,i;const s=Object(n.useMemo)((()=>new jr.BehaviorSubject(null)),[]),l=Object(n.useMemo)((()=>new jr.BehaviorSubject(void 0)),[]),[o,c]=Tr(),[u,d]=Object(n.useState)(Object(Sr.d)(null!==(a=null==o?void 0:o.dateRange)&&void 0!==a?a:e));Mr()((()=>{l.next(null!=o&&o.autoRefresh?o.autoRefresh:t),c({...null!=o&&o.dateRange?void 0:{dateRange:e},...null!=o&&o.autoRefresh?void 0:{autoRefresh:t}})}));const m=Object(n.useCallback)((e=>{c({dateRange:e}),d(Object(Sr.d)(e))}),[c]),p=Object(n.useCallback)((e=>{s.next(null),m(e)}),[s,m]),g=Object(n.useCallback)((e=>{l.next(e),c({autoRefresh:e})}),[l,c]),f=Object(n.useCallback)((()=>{const e=Cr(),{from:t=e.from,to:a=e.to}=u;return{from:t,to:a}}),[u]),b=Object(n.useCallback)((()=>(({from:e,to:t})=>({from:new Date(e).getTime(),to:new Date(t).getTime()}))(f())),[f]);return{autoRefresh:null!==(r=null==o?void 0:o.autoRefresh)&&void 0!==r?r:t,autoRefreshTick$:s,autoRefreshConfig$:l,dateRange:null!==(i=null==o?void 0:o.dateRange)&&void 0!==i?i:e,getDateRangeInTimestamp:b,getParsedDateRange:f,onAutoRefresh:p,setAutoRefresh:g,setDateRange:m}}));var Ar=a(47);const[Br,Vr]=f()((()=>{const{autoRefreshTick$:e,autoRefreshConfig$:t}=Rr(),{services:a}=Object(ge.b)(),{data:{search:r}}=a,i=Object(n.useMemo)((()=>new jr.BehaviorSubject(!1)),[]),s=Object(n.useMemo)((()=>new jr.BehaviorSubject(0)),[]),l=Object(n.useMemo)((()=>new jr.BehaviorSubject(null)),[]),[o,c]=Object(n.useState)(),u=Object(n.useCallback)((()=>{c((()=>r.session.start()))}),[r.session]),d=Object(n.useCallback)((()=>s.pipe(Object(Ar.distinctUntilChanged)(),Object(Ar.skipUntil)(s.pipe(Object(Ar.first)((e=>0===e)))),Object(Ar.debounceTime)(1e3),Object(Ar.first)((e=>0===e)))),[s]),m=Object(n.useCallback)((()=>t.pipe(Object(Ar.first)((e=>!!e&&!0!==e.isPaused)))),[t]);return Object(n.useEffect)((()=>{u()}),[u]),Object(n.useEffect)((()=>{const t=l.pipe(Object(Ar.filter)((e=>!!e)),Object(Ar.map)((e=>["error","done"].includes(e)?-1:1)),Object(Ar.tap)((e=>{s.next(s.getValue()+e)})),Object(Ar.switchMap)((()=>s.pipe(Object(Ar.distinctUntilChanged)(),Object(Ar.skipUntil)(m()),Object(Ar.debounceTime)(1e3),Object(Ar.tap)((e=>{e>0&&i.next(!0)})))))).subscribe(),a=Object(jr.merge)(e.pipe(Object(Ar.skipUntil)(m()),Object(Ar.withLatestFrom)(s),Object(Ar.switchMap)((([,e])=>Object(jr.iif)((()=>e>0),d().pipe(Object(Ar.tap)((()=>i.next(!1)))),new jr.Observable((()=>{i.next(!1)})))))),e.pipe(Object(Ar.skipUntil)(m()),Object(Ar.withLatestFrom)(r.session.state$),Object(Ar.switchMap)((([,e])=>Object(jr.iif)((()=>e!==kt.SearchSessionState.Completed&&e!==kt.SearchSessionState.BackgroundCompleted),Object(kt.waitUntilNextSessionCompletes$)(r.session).pipe(Object(Ar.tap)((()=>u()))),new jr.Observable((()=>{u()}))))))).subscribe();return()=>{t.unsubscribe(),a.unsubscribe()}}),[e,m,i,l,s,r.session,u,d]),{updateSearchSessionId:u,searchSessionId:o,requestState$:l,isAutoRefreshRequestPending$:i}})),Nr=({children:e,icon:t,iconColor:a,iconSize:n,...i})=>{const[s,{off:l,toggle:o}]=Nt(!1);return r.a.createElement(Y.EuiPopover,{panelPaddingSize:"s",button:r.a.createElement(zr,{"data-test-subj":i["data-test-subj"],type:t,color:null!=a?a:"text",size:null!=n?n:"original",onClick:o}),isOpen:s,offset:10,closePopover:l,repositionOnScroll:!0,anchorPosition:"upCenter",panelStyle:{maxWidth:350}},e)};var zr=Fa()(Y.EuiIcon).withConfig({displayName:"_StyledEuiIcon",componentId:"sc-zzr6w4-0"})(["cursor:pointer;"]);const $r=[{start:"now-15m",end:"now",label:W.i18n.translate("xpack.infra.assetDetails.datePicker.commonlyUsedRanges.last15Minutes",{defaultMessage:"Last 15 minutes"})},{start:"now-1h",end:"now",label:W.i18n.translate("xpack.infra.assetDetails.datePicker.commonlyUsedRanges.last1Hour",{defaultMessage:"Last 1 hour"})},{start:"now-3h",end:"now",label:W.i18n.translate("xpack.infra.assetDetails.datePicker.commonlyUsedRanges.last3Hours",{defaultMessage:"Last 3 hours"})},{start:"now-24h",end:"now",label:W.i18n.translate("xpack.infra.assetDetails.datePicker.commonlyUsedRanges.last24Hours",{defaultMessage:"Last 24 hours"})},{start:"now-7d",end:"now",label:W.i18n.translate("xpack.infra.assetDetails.datePicker.commonlyUsedRanges.last7Days",{defaultMessage:"Last 7 days"})}],qr=()=>{const{dateRange:e,autoRefresh:t,setDateRange:a,setAutoRefresh:i,onAutoRefresh:s}=Rr(),{updateSearchSessionId:l}=Vr(),o=Object(n.useCallback)((({start:e,end:t})=>{s({from:e,to:t})}),[s]),c=Object(n.useCallback)((({start:e,end:t,isInvalid:n})=>{n||a({from:e,to:t})}),[a]),u=Object(n.useCallback)((({isPaused:t,refreshInterval:n})=>{i({isPaused:t,interval:n}),t||a({from:e.from,to:"now"})}),[e.from,i,a]),d=Object(n.useCallback)((()=>l()),[l]);return r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs",responsive:!1,direction:"column"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Gr,{commonlyUsedRanges:$r,start:e.from,end:e.to,isPaused:null==t?void 0:t.isPaused,onTimeChange:c,onRefresh:t&&o,onRefreshChange:t&&u,refreshInterval:null==t?void 0:t.interval,onClick:d,width:"full"})),r.a.createElement(Y.EuiFlexItem,{grow:!1,style:{minHeight:"18px"}},t&&!t.isPaused&&r.a.createElement(Ur,null)))},Ur=()=>r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs",alignItems:"baseline",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiText,{size:"xs",color:"subdued"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.datePicker.tooltip.autoRefresh",defaultMessage:"Experiencing continually loading data?"}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Nr,{iconSize:"s",iconColor:"subdued",icon:"iInCircle","data-test-subj":"infraAssetDetailsMetadataPopoverButton"},r.a.createElement(Y.EuiText,{size:"xs"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.datePicker.tooltip.autoRefresh.troubleshoot",defaultMessage:"Try increasing the refresh interval, shortening the date range or turning off auto-refresh."}))))),Gr=r.a.memo((({onClick:e,...t})=>r.a.createElement(Y.EuiSuperDatePicker,de()({},t,{updateButtonProps:{iconOnly:!0,contentProps:{onClick:e}}})))),Hr=e=>{const t=Object(n.useRef)(null);return null===t.current&&(t.current=e()),t},Wr=f()((function({defaultActiveTabId:e}){const[t,a]=Tr(),n=(null==t?void 0:t.tabId)||e,r=Hr((()=>new Set([n])));return{activeTabId:n,renderedTabsSet:r,showTab:e=>{r.current.add(e),a({tabId:e})}}})),[Qr,Jr]=Wr;var Kr=a(3);const Yr=v.tuple([v.union([v.string,v.number]),v.union([v.string,v.number])]),Xr=v.keyof({metrics_hosts:null,metrics_k8s:null}),Zr=v.keyof({anomalyScore:null,dataset:null,startTime:null}),ei=v.keyof({asc:null,desc:null}),ti=v.type({searchBefore:Yr}),ai=v.type({searchAfter:Yr}),ni=v.intersection([v.type({pageSize:v.number}),v.partial({cursor:v.union([ti,ai])})]),ri=v.type({field:Zr,direction:ei}),ii=v.keyof({memory_usage:null,network_in:null,network_out:null}),si=v.intersection([v.type({id:v.string,anomalyScore:v.number,typical:v.number,actual:v.number,type:Xr,influencers:v.array(v.string),duration:v.number,startTime:v.number,jobId:v.string}),v.partial({partitionFieldName:v.string,partitionFieldValue:v.string})]),li=v.intersection([v.type({data:v.intersection([v.type({anomalies:v.array(si),hasMoreEntries:v.boolean}),v.partial({paginationCursors:v.type({previousPageCursor:Yr,nextPageCursor:Yr})})])}),v.partial({timing:Kr.c})]),oi=v.type({data:v.intersection([v.type({sourceId:v.string,anomalyThreshold:v.number,timeRange:Kr.d}),v.partial({query:v.string,hostName:v.string,metric:ii,pagination:ni,sort:ri})])}),ci=v.intersection([v.type({id:v.string,anomalyScore:v.number,typical:v.number,actual:v.number,type:Xr,influencers:v.array(v.string),duration:v.number,startTime:v.number,jobId:v.string}),v.partial({partitionFieldName:v.string,partitionFieldValue:v.string})]),ui=v.intersection([v.type({data:v.intersection([v.type({anomalies:v.array(ci),hasMoreEntries:v.boolean}),v.partial({paginationCursors:v.type({previousPageCursor:Yr,nextPageCursor:Yr})})])}),v.partial({timing:Kr.c})]),di=v.type({data:v.intersection([v.type({sourceId:v.string,anomalyThreshold:v.number,timeRange:Kr.d}),v.partial({query:v.string,metric:ii,pagination:ni,sort:ri})])});var mi=a(111),pi=a(19);const gi=(e,t)=>{const a={page:1,paginationCursor:void 0};switch(t.type){case"changePaginationOptions":case"changeSortOptions":case"changeTimeRange":case"changeFilteredDatasets":return{...e,...a,...t.payload};case"changeHasNextPage":case"changeLastReceivedCursors":return{...e,...t.payload};case"fetchNextPage":return e.lastReceivedCursors?{...e,page:e.page+1,paginationCursor:{searchAfter:e.lastReceivedCursors.nextPageCursor}}:e;case"fetchPreviousPage":return e.lastReceivedCursors?{...e,page:e.page-1,paginationCursor:{searchBefore:e.lastReceivedCursors.previousPageCursor}}:e;default:return e}},fi={page:1,lastReceivedCursors:void 0,paginationCursor:void 0,hasNextPage:!1},bi=({endTime:e,startTime:t,sourceId:a,anomalyThreshold:r,defaultSortOptions:i,defaultPaginationOptions:s,onGetMetricsHostsAnomaliesDatasetsError:l,filteredDatasets:o})=>{const{services:c}=Object(ge.b)(),u=Object(n.useRef)(new AbortController),[d,m]=Object(n.useReducer)(gi,fi,(a=>({...a,paginationOptions:s,sortOptions:i,filteredDatasets:o,timeRange:{start:t,end:e}}))),[p,g]=Object(n.useState)([]);Object(n.useEffect)((()=>{const e=null==u?void 0:u.current;return()=>{e.abort()}}),[]);const[f,b]=Object(mi.b)({cancelPreviousOn:"creation",createPromise:async(e,t)=>{const{timeRange:{start:n,end:i},sortOptions:s,paginationOptions:l,paginationCursor:o}=d;return u.current.abort(),u.current=new AbortController,await hi({sourceId:a,anomalyThreshold:r,startTime:n,endTime:i,metric:e,query:t,sort:s,pagination:{...l,cursor:o}},c.http.fetch,u.current.signal)},onResolve:({data:{anomalies:e,paginationCursors:t,hasMoreEntries:a}})=>{const{paginationCursor:n}=d;t&&m({type:"changeLastReceivedCursors",payload:{lastReceivedCursors:t}}),!n||n&&"searchAfter"in n?m({type:"changeHasNextPage",payload:{hasNextPage:a}}):n&&"searchBefore"in n&&m({type:"changeHasNextPage",payload:{hasNextPage:!0}}),g(e)}},[a,r,m,d.timeRange.start,d.timeRange.end,d.sortOptions,d.paginationOptions,d.paginationCursor,d.filteredDatasets]),h=Object(n.useCallback)((e=>{m({type:"changeSortOptions",payload:{sortOptions:e}})}),[m]),y=Object(n.useCallback)((e=>{m({type:"changePaginationOptions",payload:{paginationOptions:e}})}),[m]);Object(n.useEffect)((()=>{m({type:"changeTimeRange",payload:{timeRange:{start:t,end:e}}})}),[t,e]),Object(n.useEffect)((()=>{m({type:"changeFilteredDatasets",payload:{filteredDatasets:o}})}),[o]);const E=Object(n.useCallback)((()=>{d.lastReceivedCursors&&m({type:"fetchNextPage"})}),[m,d]),v=Object(n.useCallback)((()=>{d.lastReceivedCursors&&m({type:"fetchPreviousPage"})}),[m,d]);return{metricsK8sAnomalies:p,getMetricsK8sAnomalies:b,isLoadingMetricsK8sAnomalies:Object(n.useMemo)((()=>"pending"===f.state),[f.state]),hasFailedLoadingMetricsK8sAnomalies:Object(n.useMemo)((()=>"rejected"===f.state),[f.state]),changeSortOptions:h,sortOptions:d.sortOptions,changePaginationOptions:y,paginationOptions:d.paginationOptions,fetchPreviousPage:d.page>1?v:void 0,fetchNextPage:d.hasNextPage?E:void 0,page:d.page}},hi=async(e,t,a)=>{const{sourceId:n,anomalyThreshold:r,startTime:i,endTime:s,metric:l,query:o,sort:c,pagination:u}=e,d=await t("/api/infra/infra_ml/results/metrics_k8s_anomalies",{method:"POST",body:JSON.stringify(di.encode({data:{sourceId:n,anomalyThreshold:r,timeRange:{startTime:i,endTime:s},metric:l,query:o,sort:c,pagination:u}})),signal:a});return Object(pi.b)(ui)(d)},yi=(e,t)=>{const a={page:1,paginationCursor:void 0};switch(t.type){case"changePaginationOptions":case"changeSortOptions":case"changeTimeRange":case"changeFilteredDatasets":return{...e,...a,...t.payload};case"changeHasNextPage":case"changeLastReceivedCursors":return{...e,...t.payload};case"fetchNextPage":return e.lastReceivedCursors?{...e,page:e.page+1,paginationCursor:{searchAfter:e.lastReceivedCursors.nextPageCursor}}:e;case"fetchPreviousPage":return e.lastReceivedCursors?{...e,page:e.page-1,paginationCursor:{searchBefore:e.lastReceivedCursors.previousPageCursor}}:e;default:return e}},Ei={page:1,lastReceivedCursors:void 0,paginationCursor:void 0,hasNextPage:!1},vi=({endTime:e,startTime:t,sourceId:a,anomalyThreshold:r,defaultSortOptions:i,defaultPaginationOptions:s,onGetMetricsHostsAnomaliesDatasetsError:l,filteredDatasets:o})=>{const{services:c}=Object(ge.b)(),u=Object(n.useRef)(new AbortController),[d,m]=Object(n.useReducer)(yi,Ei,((e,t,a,n,r)=>i=>({...i,paginationOptions:n,sortOptions:a,filteredDatasets:r,timeRange:{start:t,end:e}}))(e,t,i,s,o)),[p,g]=Object(n.useState)([]);Object(n.useEffect)((()=>{const e=null==u?void 0:u.current;return()=>{e.abort()}}),[]);const[f,b]=Object(mi.b)({cancelPreviousOn:"creation",createPromise:async(e,t,n)=>{const{timeRange:{start:i,end:s},sortOptions:l,paginationOptions:o,paginationCursor:m}=d;return u.current.abort(),u.current=new AbortController,await xi({sourceId:a,anomalyThreshold:r,startTime:i,endTime:s,metric:e,query:t,sort:l,pagination:{...o,cursor:m},hostName:n},c.http.fetch,u.current.signal)},onResolve:({data:{anomalies:e,paginationCursors:t,hasMoreEntries:a}})=>{const{paginationCursor:n}=d;t&&m({type:"changeLastReceivedCursors",payload:{lastReceivedCursors:t}}),!n||n&&"searchAfter"in n?m({type:"changeHasNextPage",payload:{hasNextPage:a}}):n&&"searchBefore"in n&&m({type:"changeHasNextPage",payload:{hasNextPage:!0}}),g(e)}},[a,r,m,d.timeRange.start,d.timeRange.end,d.sortOptions,d.paginationOptions,d.paginationCursor,d.filteredDatasets]),h=Object(n.useCallback)((e=>{m({type:"changeSortOptions",payload:{sortOptions:e}})}),[m]),y=Object(n.useCallback)((e=>{m({type:"changePaginationOptions",payload:{paginationOptions:e}})}),[m]);Object(n.useEffect)((()=>{m({type:"changeTimeRange",payload:{timeRange:{start:t,end:e}}})}),[t,e]),Object(n.useEffect)((()=>{m({type:"changeFilteredDatasets",payload:{filteredDatasets:o}})}),[o]);const E=Object(n.useCallback)((()=>{d.lastReceivedCursors&&m({type:"fetchNextPage"})}),[m,d]),v=Object(n.useCallback)((()=>{d.lastReceivedCursors&&m({type:"fetchPreviousPage"})}),[m,d]);return{metricsHostsAnomalies:p,getMetricsHostsAnomalies:b,isLoadingMetricsHostsAnomalies:Object(n.useMemo)((()=>"pending"===f.state),[f.state]),hasFailedLoadingMetricsHostsAnomalies:Object(n.useMemo)((()=>"rejected"===f.state),[f.state]),changeSortOptions:h,sortOptions:d.sortOptions,changePaginationOptions:y,paginationOptions:d.paginationOptions,fetchPreviousPage:d.page>1?v:void 0,fetchNextPage:d.hasNextPage?E:void 0,page:d.page,timeRange:d.timeRange}},xi=async(e,t,a)=>{const{sourceId:n,anomalyThreshold:r,startTime:i,endTime:s,metric:l,sort:o,pagination:c,query:u,hostName:d}=e,m=await t("/api/infra/infra_ml/results/metrics_hosts_anomalies",{method:"POST",body:JSON.stringify(oi.encode({data:{sourceId:n,anomalyThreshold:r,timeRange:{startTime:i,endTime:s},query:u,metric:l,sort:o,pagination:c,hostName:d}})),signal:a});return Object(pi.b)(li)(m)},wi=W.i18n.translate("xpack.infra.logs.analysis.anomaliesTablePreviousPageLabel",{defaultMessage:"Previous page"}),ki=W.i18n.translate("xpack.infra.logs.analysis.anomaliesTableNextPageLabel",{defaultMessage:"Next page"}),Oi=({fetchPreviousPage:e,fetchNextPage:t,page:a,isLoading:n})=>r.a.createElement(Y.EuiFlexGroup,{justifyContent:"center"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiFlexGroup,null,r.a.createElement(Y.EuiButtonIcon,{"data-test-subj":"infraPaginationControlsButton",iconType:"arrowLeft",isDisabled:!e||n,onClick:e,"aria-label":wi}),r.a.createElement("span",null,r.a.createElement("strong",null,a)),r.a.createElement(Y.EuiButtonIcon,{"data-test-subj":"infraPaginationControlsButton",iconType:"arrowRight",isDisabled:!t||n,onClick:t,"aria-label":ki}))));var Mi=a(11);const ji=({anomaly:e})=>{const{actual:t,typical:a}=e,n=W.i18n.translate("xpack.infra.ml.anomalyFlyout.anomaliesTableMoreThanExpectedAnomalyMessage",{defaultMessage:"more"}),i=W.i18n.translate("xpack.infra.ml.anomalyFlyout.anomaliesTableFewerThanExpectedAnomalyMessage",{defaultMessage:"fewer"}),s=t>a,l=s?n:i,o=s?t/a:a/t,c=s?"sortUp":"sortDown",u=o!==1/0?`${Object(Mi.h)(o)}x`:"";return r.a.createElement(Y.EuiFlexGroup,{gutterSize:"s",responsive:!1,alignItems:"center"},r.a.createElement(Y.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(Y.EuiIcon,{type:c})),r.a.createElement(Y.EuiFlexItem,{component:"span"},`${u} ${l}`))};var Si=a(231),Ci=a(84),Ti=a(229);const Ii=v.type({capabilities:v.type({canGetJobs:v.boolean,canCreateJob:v.boolean,canDeleteJob:v.boolean,canOpenJob:v.boolean,canCloseJob:v.boolean,canForecastJob:v.boolean,canGetDatafeeds:v.boolean,canStartStopDatafeed:v.boolean,canUpdateJob:v.boolean,canUpdateDatafeed:v.boolean,canPreviewDatafeed:v.boolean}),isPlatinumOrTrialLicense:v.boolean,mlFeatureEnabledInSpace:v.boolean,upgradeInProgress:v.boolean}),Fi=()=>{const{services:e}=Object(ge.b)(),[t,a]=Object(n.useState)(Di),[r,i]=Object(mi.b)({cancelPreviousOn:"resolution",createPromise:async()=>{const t=await e.http.fetch("/internal/ml/ml_capabilities",{version:"1"});return Object(x.pipe)(Ii.decode(t),Object(w.fold)(Object(pi.d)(pi.a),k.identity))},onResolve:e=>{a(e)}},[]);Object(n.useEffect)((()=>{i()}),[i]);const s=Object(n.useMemo)((()=>"pending"===r.state),[r.state]),l=t.capabilities.canCreateJob,o=t.capabilities.canGetJobs;return{hasInfraMLCapabilities:t.isPlatinumOrTrialLicense&&t.mlFeatureEnabledInSpace,hasInfraMLReadCapabilities:o,hasInfraMLSetupCapabilities:l,isLoading:s}},[Li,Pi]=f()(Fi),Di={capabilities:{canGetJobs:!1,canCreateJob:!1,canDeleteJob:!1,canOpenJob:!1,canCloseJob:!1,canForecastJob:!1,canGetDatafeeds:!1,canStartStopDatafeed:!1,canUpdateJob:!1,canUpdateDatafeed:!1,canPreviewDatafeed:!1,canGetCalendars:!1,canCreateCalendar:!1,canDeleteCalendar:!1,canGetFilters:!1,canCreateFilter:!1,canDeleteFilter:!1,canFindFileStructure:!1,canGetDataFrameJobs:!1,canDeleteDataFrameJob:!1,canPreviewDataFrameJob:!1,canCreateDataFrameJob:!1,canStartStopDataFrameJob:!1},isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var _i=a(225),Ri=a(125);const Ai=({jobTypes:e})=>({jobStatus:e.reduce(((e,t)=>({...e,[t]:"unknown"})),{}),jobSummaries:[],lastSetupErrorMessages:[],setupStatus:{type:"initializing"}}),Bi=e=>null!=e.error,Vi=e=>Object(n.useReducer)((e=>(t,a)=>{switch(a.type){case"startedSetup":return{...t,jobStatus:e.reduce(((e,t)=>({...e,[t]:"initializing"})),{}),setupStatus:{type:"pending"}};case"finishedSetup":{const{datafeedSetupResults:n,jobSetupResults:r,jobSummaries:i,spaceId:s,sourceId:l}=a,o=e.reduce(((e,t)=>{return{...e,[t]:(i=Object(Ri.c)(s,l,t),e=>e.filter((e=>e.id===i&&e.success&&!e.error)).length>0)(r)&&(a=Object(Ri.b)(s,l,t),e=>e.filter((e=>e.id===a&&e.success&&e.started&&!e.error)).length>0)(n)?"started":"failed"};var a,i}),{}),c=Object.values(o).every((e=>"started"===e))?{type:"succeeded"}:{type:"failed",reasons:[...Object.values(n).filter(Bi).map((e=>e.error.msg)),...Object.values(r).filter(Bi).map((e=>e.error.msg))]};return{...t,jobStatus:o,jobSummaries:i,setupStatus:c}}case"failedSetup":return{...t,jobStatus:e.reduce(((e,t)=>({...e,[t]:"failed"})),{}),setupStatus:{type:"failed",reasons:a.reason?[a.reason]:["unknown"]}};case"fetchingJobStatuses":return{...t,setupStatus:"unknown"===t.setupStatus.type?{type:"initializing"}:t.setupStatus};case"fetchedJobStatuses":{const{payload:r,spaceId:i,sourceId:s}=a,{setupStatus:l}=t,o=e.reduce(((e,t)=>{return{...e,[t]:(a=Object(Ri.c)(i,s,t),e=>e.filter((e=>e.id===a)).map((e=>"failed"===e.jobState||""===e.datafeedState?"failed":"closed"===e.jobState&&"stopped"===e.datafeedState&&e.fullJob&&null!=e.fullJob.finished_time?"finished":"closed"===e.jobState||"closing"===e.jobState||"stopped"===e.datafeedState?"stopped":"opening"===e.jobState&&!1===e.awaitingNodeAssignment||"resetting"===e.jobState||"reverting"===e.jobState?"initializing":"opened"===e.jobState&&"started"===e.datafeedState||"opening"===e.jobState&&"starting"===e.datafeedState&&!0===e.awaitingNodeAssignment?"started":"unknown"))[0]||"missing")(r)};var a}),{}),c=(n=o,e=>Object.entries(n).reduce(((e,[,t])=>"missing"===t?{type:"required"}:"required"===e.type||"succeeded"===e.type?e:"skipped"===e.type||Object(Ri.e)(t)?{type:"skipped",newlyCreated:"skipped"===e.type&&e.newlyCreated}:e),e))(l);return{...t,jobSummaries:r,jobStatus:o,setupStatus:c}}case"failedFetchingJobStatuses":return{...t,setupStatus:{type:"unknown"},jobStatus:e.reduce(((e,t)=>({...e,[t]:"unknown"})),{})};case"viewedResults":return{...t,setupStatus:{type:"skipped",newlyCreated:!0}};default:return t}var n})(e),{jobTypes:e},Ai),Ni=({sourceConfiguration:e,moduleDescriptor:t})=>{const{services:a}=Object(ge.b)(),{spaceId:r,sourceId:i}=e,[s,l]=Vi(t.jobTypes),[,o]=Object(mi.b)({cancelPreviousOn:"resolution",createPromise:async()=>(l({type:"fetchingJobStatuses"}),await t.getJobSummary(r,i,a.http.fetch)),onResolve:e=>{l({type:"fetchedJobStatuses",payload:e,spaceId:r,sourceId:i})},onReject:()=>{l({type:"failedFetchingJobStatuses"})}},[r,i]),[,c]=Object(mi.b)({cancelPreviousOn:"resolution",createPromise:async(e,n,s,o,c)=>(l({type:"startedSetup"}),{setupResult:await t.setUpModule({start:n,end:s,filter:o,moduleSourceConfiguration:{indices:e,sourceId:i,spaceId:r},partitionField:c},a.http.fetch),jobSummaries:await t.getJobSummary(r,i,a.http.fetch)}),onResolve:({setupResult:{datafeeds:e,jobs:t},jobSummaries:a})=>{l({type:"finishedSetup",datafeedSetupResults:e,jobSetupResults:t,jobSummaries:a,spaceId:r,sourceId:i})},onReject:()=>{l({type:"failedSetup"})}},[t.setUpModule,r,i]),[u,d]=Object(mi.b)({cancelPreviousOn:"resolution",createPromise:async()=>await t.cleanUpModule(r,i,a.http.fetch),onReject:e=>{throw new Error(`Failed to clean up previous ML job: ${e}`)}},[r,i]),m=Object(n.useMemo)((()=>"pending"===u.state),[u.state]),p=Object(n.useCallback)(((e,t,a,n,r)=>{l({type:"startedSetup"}),d().then((()=>{c(e,t,a,n,r)})).catch((e=>{l({type:"failedSetup",reason:e.toString()})}))}),[d,l,c]),g=Object(n.useCallback)((()=>{l({type:"viewedResults"})}),[l]),f=Object(n.useMemo)((()=>t.getJobIds(r,i)),[t,r,i]);return{cleanUpAndSetUpModule:p,cleanUpModule:d,fetchJobStatus:o,isCleaningUp:m,jobIds:f,jobStatus:s.jobStatus,jobSummaries:s.jobSummaries,lastSetupErrorMessages:s.lastSetupErrorMessages,moduleDescriptor:t,setUpModule:c,setupStatus:s.setupStatus,sourceConfiguration:e,viewResults:g}},zi=({moduleDescriptor:e,sourceConfiguration:t})=>({getIsJobConfigurationOutdated:Object(n.useMemo)((()=>$i(e,t)),[t,e])}),$i=({bucketSpan:e},t)=>a=>{if(!a.fullJob||!a.fullJob.custom_settings)return!1;const n=a.fullJob.custom_settings.metrics_source_config;return!(n&&n.bucketSpan===e&&n.indexPattern&&qi(new Set(n.indexPattern.split(",")),new Set(t.indices)))},qi=(e,t)=>Array.from(e).every((e=>t.has(e))),Ui=({sourceConfiguration:{spaceId:e,sourceId:t},moduleDescriptor:a})=>{const{services:r}=Object(ge.b)(),[i,s]=Object(n.useState)(),l=Object(n.useMemo)((()=>i?i.jobs.reduce(((a,n)=>({...a,[Object(Ri.c)(e,t,n.id)]:n})),{}):{}),[i,t,e]),[o,c]=Object(mi.b)({cancelPreviousOn:"resolution",createPromise:async()=>await a.getModuleDefinition(r.http.fetch),onResolve:e=>{s(e)},onReject:()=>{s(void 0)}},[a.getModuleDefinition,e,t]),u=Object(n.useCallback)((e=>{var t,a,n;const r=l[e.id];if(null==r)return!1;const i=null==r?void 0:r.config.custom_settings.job_revision;return(null!==(t=null===(a=e.fullJob)||void 0===a||null===(n=a.custom_settings)||void 0===n?void 0:n.job_revision)&&void 0!==t?t:0)<(null!=i?i:0)}),[l]);return{fetchModuleDefinition:c,fetchModuleDefinitionRequestState:o.state,getIsJobDefinitionOutdated:u,jobDefinitionByJobId:l,moduleDefinition:i}};var Gi=a(467),Hi=a(468),Wi=a(469),Qi=a(470),Ji=a(471),Ki=a(472);const Yi=async e=>{const t=await e("/internal/ml/jobs/blocking_jobs_tasks",{version:"1"});return Object(pi.b)(es)(t)},Xi=v.type({jobIds:v.array(v.string)}),Zi=v.record(v.string,v.type({deleted:v.boolean})),es=v.type({jobs:v.array(v.record(v.string,v.string))}),ts=v.type({datafeedIds:v.array(v.string)}),as=v.record(v.string,v.type({stopped:v.boolean})),ns=async(e,t,a,n)=>{try{await(async(e,t)=>{const{spaceId:a,sourceId:n,jobTypes:r}=e,i=await t("/internal/ml/jobs/stop_datafeeds",{method:"POST",version:"1",body:JSON.stringify(ts.encode({datafeedIds:r.map((e=>Object(Ri.b)(a,n,e)))}))});return Object(pi.b)(as)(i)})({spaceId:e,sourceId:t,jobTypes:a},n)}catch(e){var r;if(404!==(null==e||null===(r=e.response)||void 0===r?void 0:r.status))throw e}return await rs(e,t,a,n)},rs=async(e,t,a,n)=>{const r=await(async(e,t)=>{const{spaceId:a,sourceId:n,jobTypes:r}=e,i=await t("/internal/ml/jobs/delete_jobs",{method:"POST",version:"1",body:JSON.stringify(Xi.encode({jobIds:r.map((e=>Object(Ri.c)(a,n,e)))}))});return Object(pi.b)(Zi)(i)})({spaceId:e,sourceId:t,jobTypes:a},n);return await is(e,t,a,n),r},is=async(e,t,a,n)=>{const r=a.map((a=>Object(Ri.c)(e,t,a)));for(;;){const{jobs:e}=await Yi(n);if(!e.flatMap((e=>Object.keys(e))).some((e=>r.includes(e))))return!0;await ss(1e3)}},ss=e=>new Promise((t=>setTimeout(t,e))),ls=async(e,t)=>{const{spaceId:a,sourceId:n,jobTypes:r}=e,i=await t("/internal/ml/jobs/jobs_summary",{method:"POST",version:"1",body:JSON.stringify(os.encode({jobIds:r.map((e=>Object(Ri.c)(a,n,e)))}))});return Object(pi.b)(gs)(i)},os=v.type({jobIds:v.array(v.string)}),cs=v.keyof({started:null,starting:null,stopped:null,stopping:null,"":null}),us=v.keyof({closed:null,closing:null,deleting:null,failed:null,opened:null,opening:null,resetting:null,reverting:null}),ds=v.keyof({ok:null,warn:null}),ms=v.type({categorization_status:ds,categorized_doc_count:v.number,dead_category_count:v.number,frequent_category_count:v.number,rare_category_count:v.number,total_category_count:v.number}),ps=v.intersection([v.type({id:v.string,jobState:us}),v.partial({awaitingNodeAssignment:v.boolean,datafeedIndices:v.array(v.string),datafeedState:cs,fullJob:v.partial({custom_settings:Ri.f,finished_time:v.number,model_size_stats:ms})})]),gs=v.array(ps),fs=async(e,t)=>{const a=await t(`/internal/ml/modules/get_module/${e}`,{method:"GET",version:"1"});return Object(pi.b)(hs)(a)},bs=v.type({id:v.string,config:v.type({custom_settings:Ri.f})}),hs=v.type({id:v.string,jobs:v.array(bs)}),ys=async(e,t)=>{const{moduleId:a,start:n,end:r,spaceId:i,sourceId:s,indexPattern:l,jobOverrides:o=[],datafeedOverrides:c=[],query:u}=e,d=await t(`/internal/ml/modules/setup/${a}`,{method:"POST",version:"1",body:JSON.stringify(ks.encode({start:n,end:r,indexPatternName:l,prefix:Object(Ri.d)(i,s),startDatafeed:!0,jobOverrides:o,datafeedOverrides:c,query:u}))});return Object(pi.b)(Ss)(d)},Es=v.partial({start:v.number,end:v.number}),vs=v.type({job_id:v.string,custom_settings:Ri.f}),xs=v.object,ws=v.intersection([v.strict({indexPatternName:v.string,prefix:v.string,startDatafeed:v.boolean,jobOverrides:v.array(vs),datafeedOverrides:v.array(xs)}),v.exact(v.partial({query:v.object}))]),ks=v.intersection([Es,ws]),Os=v.type({msg:v.string}),Ms=v.intersection([v.type({id:v.string,started:v.boolean,success:v.boolean}),v.partial({error:Os})]),js=v.intersection([v.type({id:v.string,success:v.boolean}),v.partial({error:Os})]),Ss=v.type({datafeeds:v.array(Ms),jobs:v.array(js)}),Cs="metrics_ui_hosts",Ts=W.i18n.translate("xpack.infra.ml.metricsModuleName",{defaultMessage:"Metrics anomanly detection"}),Is=W.i18n.translate("xpack.infra.ml.metricsHostModuleDescription",{defaultMessage:"Use Machine Learning to automatically detect anomalous log entry rates."}),Fs=(e,t)=>Ri.g.reduce(((a,n)=>({...a,[n]:Object(Ri.c)(e,t,n)})),{}),Ls=e=>{switch(e){case"hosts_memory_usage":return{datafeed:Hi,job:Gi};case"hosts_network_in":return{datafeed:Qi,job:Wi};case"hosts_network_out":return{datafeed:Ki,job:Ji}}},Ps={moduleId:Cs,moduleName:Ts,moduleDescription:Is,jobTypes:Ri.g,bucketSpan:Ri.a,getJobIds:Fs,getJobSummary:async(e,t,a)=>{const n=await ls({spaceId:e,sourceId:t,jobTypes:Ri.g},a),r=Object.values(Fs(e,t));return n.filter((e=>r.includes(e.id)))},getModuleDefinition:async e=>await fs(Cs,e),setUpModule:async(e,t)=>{const{start:a,end:n,filter:r,moduleSourceConfiguration:{spaceId:i,sourceId:s,indices:l},partitionField:o}=e,c=l.join(","),u=["hosts_memory_usage","hosts_network_in","hosts_network_out"],d=u.map((e=>{const{job:t}=Ls(e),a={...t.analysis_config};return o&&(a.detectors[0].partition_field_name=o,-1===a.influencers.indexOf(o)&&a.influencers.push(o)),{job_id:e,data_description:{time_field:Re.h},analysis_config:a,custom_settings:{metrics_source_config:{indexPattern:c,timestampField:Re.h,bucketSpan:Ri.a}}}})),m=u.map((e=>{const{datafeed:t}=Ls(e),a={...t};if(r){const e=JSON.parse(r);a.query.bool={...a.query.bool,...e.bool}}if(!o||"hosts_memory_usage"===e)return{...a,job_id:e};const n={[o]:{terms:{field:o},aggregations:{...t.aggregations}}};return{...a,job_id:e,aggregations:n}}));return ys({moduleId:Cs,start:a,end:n,spaceId:i,sourceId:s,indexPattern:c,jobOverrides:d,datafeedOverrides:m},t)},cleanUpModule:async(e,t,a)=>await ns(e,t,Ri.g,a)},[Ds,_s]=f()((({indexPattern:e,sourceId:t,spaceId:a})=>{const r=Object(n.useMemo)((()=>({indices:e.split(","),sourceId:t,spaceId:a})),[e,t,a]),i=Ni({moduleDescriptor:Ps,sourceConfiguration:r}),{getIsJobConfigurationOutdated:s}=zi({sourceConfiguration:r,moduleDescriptor:Ps}),{fetchModuleDefinition:l,getIsJobDefinitionOutdated:o}=Ui({sourceConfiguration:r,moduleDescriptor:Ps}),c=Object(n.useMemo)((()=>i.jobSummaries.some(s)),[s,i.jobSummaries]),u=Object(n.useMemo)((()=>i.jobSummaries.some(o)),[o,i.jobSummaries]),d=Object(n.useMemo)((()=>Object.values(i.jobStatus).some((e=>"stopped"===e))),[i.jobStatus]);return{...i,fetchModuleDefinition:l,hasOutdatedJobConfigurations:c,hasOutdatedJobDefinitions:u,hasStoppedJobs:d}}));var Rs=a(473),As=a(474),Bs=a(475),Vs=a(476),Ns=a(477),zs=a(478);const $s="kubernetes.namespace",qs="metrics_ui_k8s",Us=W.i18n.translate("xpack.infra.ml.metricsModuleName",{defaultMessage:"Metrics anomanly detection"}),Gs=W.i18n.translate("xpack.infra.ml.metricsHostModuleDescription",{defaultMessage:"Use Machine Learning to automatically detect anomalous log entry rates."}),Hs=(e,t)=>Ri.h.reduce(((a,n)=>({...a,[n]:Object(Ri.c)(e,t,n)})),{}),Ws=e=>{switch(e){case"k8s_memory_usage":return{datafeed:As,job:Rs};case"k8s_network_in":return{datafeed:Vs,job:Bs};case"k8s_network_out":return{datafeed:zs,job:Ns}}},Qs={moduleId:qs,moduleName:Us,moduleDescription:Gs,jobTypes:Ri.h,bucketSpan:Ri.a,getJobIds:Hs,getJobSummary:async(e,t,a)=>{const n=await ls({spaceId:e,sourceId:t,jobTypes:Ri.h},a),r=Object.values(Hs(e,t));return n.filter((e=>r.includes(e.id)))},getModuleDefinition:async e=>await fs(qs,e),setUpModule:async(e,t)=>{const{start:a,end:n,filter:r,moduleSourceConfiguration:{spaceId:i,sourceId:s,indices:l},partitionField:o}=e,c=l.join(","),u=["k8s_memory_usage","k8s_network_in","k8s_network_out"],d=u.map((e=>{const{job:t}=Ws(e),a={...t.analysis_config};return o&&(a.detectors[0].partition_field_name=o,-1===a.influencers.indexOf(o)&&a.influencers.push(o)),{job_id:e,data_description:{time_field:Re.h},analysis_config:a,custom_settings:{metrics_source_config:{indexPattern:c,timestampField:Re.h,bucketSpan:Ri.a}}}})),m=u.map((e=>{const{datafeed:t}=Ws(e),a={...t};if(r){const e=JSON.parse(r);a.query.bool={...a.query.bool,...e.bool}}if(!o||"k8s_memory_usage"===e)return{...a,job_id:e};const n=t.aggregations[$s].aggregations,i={[o]:{terms:{field:o,size:25},aggregations:{...n}}};return{...a,job_id:e,aggregations:i}}));return ys({moduleId:qs,start:a,end:n,spaceId:i,sourceId:s,indexPattern:c,jobOverrides:d,datafeedOverrides:m},t)},cleanUpModule:async(e,t,a)=>await ns(e,t,Ri.h,a)},[Js,Ks]=f()((({indexPattern:e,sourceId:t,spaceId:a})=>{const r=Object(n.useMemo)((()=>({indices:e.split(","),sourceId:t,spaceId:a})),[e,t,a]),i=Ni({moduleDescriptor:Qs,sourceConfiguration:r}),{getIsJobConfigurationOutdated:s}=zi({sourceConfiguration:r,moduleDescriptor:Qs}),{fetchModuleDefinition:l,getIsJobDefinitionOutdated:o}=Ui({sourceConfiguration:r,moduleDescriptor:Qs}),c=Object(n.useMemo)((()=>i.jobSummaries.some(s)),[s,i.jobSummaries]),u=Object(n.useMemo)((()=>i.jobSummaries.some(o)),[o,i.jobSummaries]),d=Object(n.useMemo)((()=>Object.values(i.jobStatus).some((e=>"stopped"===e))),[i.jobStatus]);return{...i,fetchModuleDefinition:l,hasOutdatedJobConfigurations:c,hasOutdatedJobDefinitions:u,hasStoppedJobs:d}})),Ys=e=>{const[t,a]=Object(n.useState)("jobs"),{goToSetup:i,closeFlyout:s}=e,{fetchJobStatus:l,setupStatus:o,jobSummaries:c}=_s(),{fetchJobStatus:u,setupStatus:d,jobSummaries:m}=Ks(),{hasInfraMLCapabilities:p,hasInfraMLReadCapabilities:g,hasInfraMLSetupCapabilities:f}=Pi(),b=Object(n.useCallback)((()=>{i("hosts")}),[i]),h=Object(n.useCallback)((()=>{i("kubernetes")}),[i]),y=[...(m||[]).map((e=>e.id)),...(c||[]).map((e=>e.id))];Object(n.useEffect)((()=>{g&&(l(),u())}),[u,l,g]);const E=c.length>0||m.length>0,v=Object(me.useLinkProps)({app:"ml",pathname:"/jobs"});return p?g?"initializing"===o.type||"initializing"===d.type?r.a.createElement(K.b,{message:W.i18n.translate("xpack.infra.ml.anomalyFlyout.jobStatusLoadingMessage",{defaultMessage:"Checking status of metrics jobs..."})}):f?r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlyoutHeader,null,r.a.createElement(Y.EuiTitle,{size:"m"},r.a.createElement("h2",null,r.a.createElement(X.FormattedMessage,{defaultMessage:"Machine Learning anomaly detection",id:"xpack.infra.ml.anomalyFlyout.flyoutHeader"})))),r.a.createElement(Y.EuiTabs,null,r.a.createElement(Y.EuiTab,{isSelected:"jobs"===t,onClick:()=>a("jobs")},"Jobs"),r.a.createElement(Y.EuiTab,{isSelected:"anomalies"===t,onClick:()=>a("anomalies"),"data-test-subj":"anomalyFlyoutAnomaliesTab"},"Anomalies")),r.a.createElement(Y.EuiFlyoutBody,{banner:r.a.createElement(r.a.Fragment,null,"jobs"===t&&E&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Xs,{hasHostJobs:c.length>0,hasK8sJobs:m.length>0,jobIds:y})),r.a.createElement(Ci.MLJobsAwaitingNodeWarning,{jobIds:y}))},"jobs"===t&&r.a.createElement(r.a.Fragment,null,E&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,de()({"data-test-subj":"infraFlyoutHomeManageJobsInMlButton"},v,{style:{marginRight:5}}),r.a.createElement(X.FormattedMessage,{defaultMessage:"Manage jobs in ML",id:"xpack.infra.ml.anomalyFlyout.manageJobs"})))),r.a.createElement(Y.EuiSpacer,{size:"l"})),r.a.createElement(Y.EuiText,null,r.a.createElement("h4",null,"Create ML Jobs"),r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{defaultMessage:"Anomaly detection is powered by machine learning. Machine learning jobs are available for the following resource types. Enable these jobs to begin detecting anomalies in your infrastructure metrics.",id:"xpack.infra.ml.anomalyFlyout.createJobs"}))),r.a.createElement(Y.EuiSpacer,{size:"l"}),r.a.createElement(Zs,{hasHostJobs:c.length>0,hasK8sJobs:m.length>0,hasSetupCapabilities:e.hasSetupCapabilities,createHosts:b,createK8s:h})),"anomalies"===t&&r.a.createElement(sl,{closeFlyout:s}))):r.a.createElement(_i.c,null):r.a.createElement(_i.b,null):r.a.createElement(Ti.b,null)},Xs=e=>{let t="";return e.hasHostJobs&&e.hasK8sJobs?t=`${W.i18n.translate("xpack.infra.ml.anomalyFlyout.create.hostTitle",{defaultMessage:"Hosts"})} and ${W.i18n.translate("xpack.infra.ml.anomalyFlyout.create.k8sSuccessTitle",{defaultMessage:"Kubernetes"})}`:e.hasHostJobs?t=W.i18n.translate("xpack.infra.ml.anomalyFlyout.create.hostSuccessTitle",{defaultMessage:"Hosts"}):e.hasK8sJobs&&(t=W.i18n.translate("xpack.infra.ml.anomalyFlyout.create.k8sSuccessTitle",{defaultMessage:"Kubernetes"})),r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiCallOut,{size:"m",color:"success",title:r.a.createElement(X.FormattedMessage,{defaultMessage:"Anomaly detection enabled for {target}",id:"xpack.infra.ml.anomalyFlyout.enabledCallout",values:{target:t}}),iconType:"check"}))},Zs=e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexGroup,{gutterSize:"m"},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiCard,{isDisabled:!e.hasSetupCapabilities,icon:r.a.createElement(Y.EuiIcon,{type:"storage",size:"xl"}),title:r.a.createElement(X.FormattedMessage,{defaultMessage:"Hosts",id:"xpack.infra.ml.anomalyFlyout.create.hostTitle"}),description:r.a.createElement(X.FormattedMessage,{defaultMessage:"Detect anomalies for memory usage and network traffic on hosts.",id:"xpack.infra.ml.anomalyFlyout.create.hostDescription"}),footer:r.a.createElement(r.a.Fragment,null,e.hasHostJobs&&r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraCreateJobTabRecreateJobsButton",onClick:e.createHosts},r.a.createElement(X.FormattedMessage,{defaultMessage:"Recreate jobs",id:"xpack.infra.ml.anomalyFlyout.create.recreateButton"})),!e.hasHostJobs&&r.a.createElement(Y.EuiButton,{"data-test-subj":"infraCreateJobTabEnableButton",onClick:e.createHosts},r.a.createElement(X.FormattedMessage,{defaultMessage:"Enable",id:"xpack.infra.ml.anomalyFlyout.create.createButton"})))})),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiCard,{isDisabled:!e.hasSetupCapabilities,icon:r.a.createElement(Y.EuiIcon,{type:"logoKubernetes",size:"xl"}),title:r.a.createElement(X.FormattedMessage,{defaultMessage:"Kubernetes Pods",id:"xpack.infra.ml.anomalyFlyout.create.k8sTitle"}),description:r.a.createElement(X.FormattedMessage,{defaultMessage:"Detect anomalies for memory usage and network traffic on Kubernetes Pods.",id:"xpack.infra.ml.anomalyFlyout.create.k8sDescription"}),footer:r.a.createElement(r.a.Fragment,null,e.hasK8sJobs&&r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraCreateJobTabRecreateJobsButton",onClick:e.createK8s},r.a.createElement(X.FormattedMessage,{defaultMessage:"Recreate jobs",id:"xpack.infra.ml.anomalyFlyout.create.recreateButton"})),!e.hasK8sJobs&&r.a.createElement(Y.EuiButton,{"data-test-subj":"infraCreateJobTabEnableButton",onClick:e.createK8s},r.a.createElement(X.FormattedMessage,{defaultMessage:"Enable",id:"xpack.infra.ml.anomalyFlyout.create.createButton"})))})))),el=(e,t="absolute")=>{let a="";return a+=`(ml:(jobIds:!(${e.map((e=>`'${e}'`)).join(",")}))`,a+=`,refreshInterval:(display:Off,pause:!f,value:0),time:(from:'${h()().subtract(4,"weeks").toISOString()}'`,a+=`,to:'${h()().toISOString()}'`,"invalid"===t&&(a+=",mode:invalid"),a+="))&_a=(query:(query_string:(analyze_wildcard:!t,query:'*')))",a},tl={...en.b,filterQuery:ma,time:Zt.currentTime,autoReload:Zt.isAutoReloading},al=()=>{const{metric:e,groupBy:t,nodeType:a,view:r,customOptions:i,customMetrics:s,boundsOverride:l,autoBounds:o,accountId:c,region:u,legend:d,sort:m,timelineOpen:p,setWaffleOptionsState:g}=Object(en.d)(),{currentTime:f,isAutoReloading:b,setWaffleTimeState:h}=ia(),{filterQuery:y,setWaffleFiltersState:E}=ha(),v={metric:e,sort:m,groupBy:t,nodeType:a,view:r,customOptions:i,customMetrics:s,boundsOverride:l,autoBounds:o,accountId:c,region:u,time:f,autoReload:b,filterQuery:y,legend:d,timelineOpen:p},x=Object(n.useCallback)((e=>{const t=e.attributes;g({sort:t.sort,metric:t.metric,groupBy:t.groupBy,nodeType:t.nodeType,view:t.view,customOptions:t.customOptions,customMetrics:t.customMetrics,boundsOverride:t.boundsOverride,autoBounds:t.autoBounds,accountId:t.accountId,region:t.region,legend:t.legend,timelineOpen:t.timelineOpen}),t.time&&h({currentTime:t.time,isAutoReloading:t.autoReload}),E(t.filterQuery)}),[g,h,E]);return{viewState:v,defaultViewState:tl,onViewChange:x}},nl=({jobId:e,type:t,startTime:a,closeFlyout:i,influencerField:s,influencers:l,disableShowInInventory:o})=>{const[c,u]=Object(n.useState)(!1),d=Object(n.useCallback)((()=>u(!1)),[u]),m=Object(n.useCallback)((()=>u(!c)),[c]),{onViewChange:p}=al(),g=Object(n.useCallback)((()=>{const n=e.split("-"),r={metric:{type:{memory_usage:"memory",network_in:"rx",network_out:"tx"}[n[n.length-1].replace(/hosts_|k8s_/,"")]},sort:{by:"name",direction:"desc"},groupBy:[],nodeType:"metrics_k8s"===t?"pod":"host",view:"map",customOptions:[],customMetrics:[],boundsOverride:{max:1,min:0},autoBounds:!0,accountId:"",region:"",autoReload:!1,filterQuery:{expression:l.reduce(((e,t)=>(e&&(e=`${e} or `),`${e} ${s}: "${t}"`)),""),kind:"kuery"},legend:{palette:"cool",reverseColors:!1,steps:10},time:a};p({attributes:r}),i()}),[e,p,a,t,l,s,i]),f=Object(me.useLinkProps)({app:"ml",pathname:`/explorer?_g=${el([e.toString()])}`}),b=[r.a.createElement(Y.EuiContextMenuItem,de()({key:"openInAnomalyExplorer",icon:"popout"},f),r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.anomalyFlyout.actions.openInAnomalyExplorer",defaultMessage:"Open in Anomaly Explorer"}))];return o||b.push(r.a.createElement(Y.EuiContextMenuItem,{key:"showInInventory",icon:"search",onClick:g},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.anomalyFlyout.actions.showInInventory",defaultMessage:"Show in Inventory"}))),r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",button:r.a.createElement(Y.EuiButtonIcon,{"data-test-subj":"infraAnomalyActionMenuButton",iconType:"boxesHorizontal",onClick:m,"aria-label":W.i18n.translate("xpack.infra.ml.anomalyFlyout.actions.openActionMenu",{defaultMessage:"Open"})}),isOpen:c,closePopover:d},r.a.createElement(Y.EuiContextMenuPanel,{items:b})))},rl=()=>{const e=Object(Y.useEuiTheme)();return r.a.createElement(ll,null,r.a.createElement(Y.EuiEmptyPrompt,{iconType:"eyeClosed",iconColor:e.euiTheme.colors.mediumShade,title:r.a.createElement("h3",{"data-test-subj":"noAnomaliesFoundMsg"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.anomalyFlyout.anomalyTable.noAnomaliesFound",defaultMessage:"No anomalies found"})),body:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.anomalyFlyout.anomalyTable.noAnomaliesSuggestion",defaultMessage:"Try modifying your search or selected time range."})}))},il={from:"now-30d",to:"now"},sl=({closeFlyout:e,hostName:t,dateRange:a=il,hideDatePicker:i=!1,request$:s})=>{const[l,o]=Object(n.useState)(""),c=Object(me.useUiTracker)({app:"infra_metrics"}),[u,d]=Object(n.useState)({start:Object(Sr.b)(a.from)||0,end:Object(Sr.b)(a.to,"up")||0}),{sorting:m,setSorting:p}=function(e){const[t,a]=Object(n.useState)({field:"startTime",direction:"desc"});return{sorting:t,setSorting:a}}(),g=[{id:"hosts",label:W.i18n.translate("xpack.infra.ml.anomalyFlyout.hostBtn",{defaultMessage:"Hosts"}),"data-test-subj":"anomaliesHostComboBoxItem"},{id:"k8s",label:W.i18n.translate("xpack.infra.ml.anomalyFlyout.podsBtn",{defaultMessage:"Kubernetes Pods"}),"data-test-subj":"anomaliesK8sComboBoxItem"}],[f,b]=Object(n.useState)("hosts"),[h,y]=Object(n.useState)([g.find((e=>"hosts"===e.id))||g[0]]),{source:E}=Object(re.b)(),v=null==E?void 0:E.configuration.anomalyThreshold,x=Object(n.useCallback)((({isInvalid:e,start:t,end:a})=>{e||d({start:Object(Sr.b)(t),end:Object(Sr.b)(a,"up")})}),[]),w=Object(n.useCallback)((()=>i?{start:Object(Sr.b)(a.from)||0,end:Object(Sr.b)(a.to,"up")||0}:u),[a.from,a.to,i,u]),k=Object(n.useMemo)((()=>{const{start:e,end:t}=w();return{sourceId:"default",anomalyThreshold:v||0,startTime:e,endTime:t,defaultSortOptions:{direction:(null==m?void 0:m.direction)||"desc",field:(null==m?void 0:m.field)||"startTime"},defaultPaginationOptions:{pageSize:10}}}),[w,v,null==m?void 0:m.direction,null==m?void 0:m.field]),{metricsHostsAnomalies:O,getMetricsHostsAnomalies:M,page:j,changeSortOptions:S,fetchNextPage:C,fetchPreviousPage:T,isLoadingMetricsHostsAnomalies:I}=vi(k),{metricsK8sAnomalies:F,getMetricsK8sAnomalies:L,page:P,changeSortOptions:D,fetchNextPage:_,fetchPreviousPage:R,isLoadingMetricsK8sAnomalies:A}=bi(k),B=Object(n.useMemo)((()=>"hosts"===f?j:P),[f,j,P]),V=Object(n.useMemo)((()=>"hosts"===f?I:A),[f,I,A]),N=Object(n.useMemo)((()=>"hosts"===f?C:_),[f,C,_]),z=Object(n.useMemo)((()=>"hosts"===f?T:R),[f,T,R]),$=Object(n.useMemo)((()=>"hosts"===f?M:"k8s"===f?L:void 0),[f,L,M]),q=Object(n.useMemo)((()=>"hosts"===f?O:F),[f,O,F]),U=Object(n.useCallback)((e=>{o(e.target.value)}),[]),G=Object(n.useCallback)((e=>{y(e),b(e[0].id)}),[]),H=Object(n.useCallback)((e=>{"hosts"===f?S(e):D(e)}),[S,D,f]);Object(n.useEffect)((()=>{q&&q.forEach((e=>{e.influencers.length>100&&c({metric:"metrics_ml_anomaly_detection_more_than_100_influencers"})}))}),[q,c]);let Q=[{field:"startTime",name:W.i18n.translate("xpack.infra.ml.anomalyFlyout.columnTime",{defaultMessage:"Time"}),width:"15%",sortable:!0,textOnly:!0,truncateText:!0,render:e=>r.a.createElement(X.FormattedDate,{value:e,year:"numeric",month:"short",day:"2-digit"})},{field:"jobId",name:W.i18n.translate("xpack.infra.ml.anomalyFlyout.columnJob",{defaultMessage:"Job"}),width:"25%",render:e=>e,"data-test-subj":"anomalyRow"},{field:"anomalyScore",name:W.i18n.translate("xpack.infra.ml.anomalyFlyout.columnSeverit",{defaultMessage:"Severity"}),width:"15%",sortable:!0,render:e=>r.a.createElement(Si.a,{anomalyScore:e})},{field:"typical",name:W.i18n.translate("xpack.infra.ml.anomalyFlyout.columnSummary",{defaultMessage:"Summary"}),width:"15%",textOnly:!0,render:(e,t)=>r.a.createElement(ji,{anomaly:t})},{field:"influencers",name:W.i18n.translate("xpack.infra.ml.anomalyFlyout.columnInfluencerName",{defaultMessage:"Node name"}),width:"20%",textOnly:!0,truncateText:!0,render:e=>e.join(",")},{name:W.i18n.translate("xpack.infra.ml.anomalyFlyout.columnActionsName",{defaultMessage:"Actions"}),width:"10%",actions:[{render:t=>r.a.createElement(nl,{jobId:t.jobId,type:t.type,influencerField:"metrics_hosts"===t.type?"host.name":"kubernetes.pod.uid",disableShowInInventory:t.influencers.length>100,influencers:t.influencers,startTime:t.startTime,closeFlyout:e})}]}];return Q=t?Q.filter((e=>!("field"in e)||"influencers"!==e.field)):Q,Object(n.useEffect)((()=>{$&&(s?s.next((()=>$(void 0,l,t))):$(void 0,l,t))}),[$,t,s,l]),r.a.createElement(Y.EuiFlexGroup,{direction:"column"},!i&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiSuperDatePicker,{start:a.from,end:a.to,showUpdateButton:!1,onTimeChange:x,width:"full"})),r.a.createElement(Y.EuiFlexItem,{grow:!1},!t&&r.a.createElement(Y.EuiFlexGroup,{alignItems:"center"},r.a.createElement(Y.EuiFlexItem,{grow:3},r.a.createElement(Y.EuiFieldSearch,{"data-test-subj":"infraAnomaliesTableFieldSearch",fullWidth:!0,placeholder:W.i18n.translate("xpack.infra.ml.anomalyFlyout.searchPlaceholder",{defaultMessage:"Search"}),value:l,onChange:U,isClearable:!0})),r.a.createElement(Y.EuiFlexItem,{grow:1},r.a.createElement(Y.EuiComboBox,{placeholder:W.i18n.translate("xpack.infra.ml.anomalyFlyout.jobTypeSelect",{defaultMessage:"Select group"}),singleSelection:{asPlainText:!0},options:g,selectedOptions:h,onChange:G,fullWidth:!0,isClearable:!1,"data-test-subj":"anomaliesComboBoxType"})))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiBasicTable,{columns:Q,items:q,sorting:{sort:m},onChange:e=>{var t,a;p(e.sort),H({field:(null==e||null===(t=e.sort)||void 0===t?void 0:t.field)||"startTime",direction:(null==e||null===(a=e.sort)||void 0===a?void 0:a.direction)||"desc"})},hasActions:!0,loading:V,noItemsMessage:V?r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.anomalyFlyout.anomalyTable.loading",defaultMessage:"Loading anomalies"}):r.a.createElement(rl,null)})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Oi,{fetchNextPage:N,fetchPreviousPage:z,page:B,isLoading:V})))};var ll=Fa()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1fb2mpf-0"})(["align-self:center;"]),ol=a(121),cl=a(116);const ul=(e,t)=>{const a=t.filter((e=>e&&"metrics"===e.source)).map((e=>e&&e.name));return e.filter((e=>{const t=(0,u.metrics.tsvb[e])(Re.h,"test",">=1m");return a.some((e=>e&&t.requires.includes(e)))}))};function dl({assetId:e,assetType:t,sourceId:a,timeRange:r,requiredMetrics:i=[],request$:s}){var l,o,c;const{error:u,loading:d,response:m,makeRequest:p}=Object(ol.a)("/api/infra/metadata","POST",JSON.stringify({nodeId:e,nodeType:t,sourceId:a,timeRange:r}),(e=>Object(x.pipe)(cl.a.decode(e),Object(w.fold)(Object(pi.d)(pi.a),k.identity))),void 0,void 0,!0);return Object(n.useEffect)((()=>{s?s.next(p):p()}),[p,s]),{name:m&&m.name||"",filteredRequiredMetrics:m&&i.length>0?ul(i,m.features):[],error:u&&u.message||null,loading:d,metadata:m,cloudId:(null==m||null===(l=m.info)||void 0===l||null===(o=l.cloud)||void 0===o||null===(c=o.instance)||void 0===c?void 0:c.id)||"",reload:p}}const ml=()=>{const{requestState$:e,isAutoRefreshRequestPending$:t}=Vr(),{autoRefreshConfig$:a}=Rr(),r=Object(n.useMemo)((()=>new jr.Subject),[]);return Object(n.useEffect)((()=>{const n=r.pipe(Object(jr.withLatestFrom)(t,a),Object(Ar.filter)((([,e,t])=>!e||!0===(null==t?void 0:t.isPaused))),Object(Ar.mergeMap)((([t])=>t?(e.next("running"),Object(jr.from)(t()).pipe(Object(Ar.map)((t=>(e.next("done"),t))),Object(jr.catchError)((t=>{throw e.next("error"),t})))):Object(jr.of)(null)))).subscribe();return()=>{e.next("done"),n.unsubscribe()}}),[a,t,r,e]),{request$:r}},[pl,gl]=f()((function({assetId:e,assetType:t}){const{request$:a}=ml(),[,r]=Tr(),{getDateRangeInTimestamp:i}=Rr(),{sourceId:s}=Object(re.b)(),{loading:l,error:o,metadata:c,reload:u}=dl({assetId:e,assetType:t,sourceId:s,timeRange:i(),request$:a}),d=Object(n.useCallback)((()=>{u()}),[u]);return Object(n.useEffect)((()=>{null!=c&&c.name&&r({name:c.name})}),[null==c?void 0:c.name,r]),{loading:l,error:o,metadata:c,refresh:d}})),fl=f()((function(e){const[t]=Tr(),{metadata:a}=gl(),{assetId:n,assetName:r,assetType:i,...s}=e,l=!(r||null!=t&&t.name||null!=a&&a.name);return{...s,asset:{id:n,name:r||(null==t?void 0:t.name)||(null==a?void 0:a.name)||"",type:i},loading:l}})),[bl,hl]=fl,yl=(e,t)=>{const[a,r]=Object(n.useState)(),i=Object(n.useRef)(t),s=Object(n.useRef)(new IntersectionObserver((([e])=>r(e)),{root:e.current}));return Object(n.useEffect)((()=>{const{current:t}=s;t.disconnect();const{current:a}=e;return a&&t.observe(a),()=>t.disconnect()}),[e]),null!=a&&a.isIntersecting&&(i.current=t),i.current},El=()=>{var e;const t=Object(n.useRef)(null),{request$:a}=ml(),{getParsedDateRange:i}=Rr(),{asset:s,overrides:l}=hl(),{onClose:o=(()=>{})}=null!==(e=null==l?void 0:l.anomalies)&&void 0!==e?e:{},c=Object(n.useMemo)((()=>i()),[i]),u=yl(t,{parsedDateRange:c});return r.a.createElement("div",{ref:t},r.a.createElement(sl,{closeFlyout:o,hostName:s.name,dateRange:u.parsedDateRange,hideDatePicker:!0,request$:a}))};var vl=a(479),xl=a.n(vl);const wl=({metricAlias:e})=>{const{services:{dataViews:t}}=Object(ge.b)(),a=xl()((()=>{return t.create({id:(a=e,`infra_metrics_${Object(Xe.v5)(a,Xe.v5.DNS)}`),title:e,timeFieldName:"@timestamp"});var a}),[e]),{value:n,loading:r,error:i,retry:s}=a;return{metricAlias:e,dataView:n,loading:r,loadDataView:s,error:i}},kl=f()((({metricAlias:e})=>{const{dataView:t,loading:a,loadDataView:n,error:r}=wl({metricAlias:e});return{metricAlias:e,dataView:t,loading:a,loadDataView:n,error:r}})),[Ol,Ml]=kl;var jl=a(160),Sl=a.n(jl),Cl=a(252);const Tl=3e5,Il=6e5,Fl=18e5,Ll=36e5,Pl=72e5,Dl=288e5,_l=432e5,Rl=864e5,Al=1728e5,Bl=6048e5,Vl=12096e5,Nl=2592e6,zl=5184e6,$l=7776e6,ql=15552e6,Ul=(new v.Type("DefaultBooleanFalse",v.boolean.is,((e,t)=>null==e?v.success(!1):v.boolean.validate(e,t)),v.identity),new v.Type("DefaultBooleanTrue",v.boolean.is,((e,t)=>null==e?v.success(!0):v.boolean.validate(e,t)),v.identity),new v.Type("DefaultEmptyString",v.string.is,((e,t)=>null==e?v.success(""):v.string.validate(e,t)),v.identity),new v.Type("DefaultStringArray",v.array(v.string).is,((e,t)=>null==e?v.success([]):v.array(v.string).validate(e,t)),v.identity),new v.Type("DefaultStringBooleanFalse",v.boolean.is,((e,t)=>null==e?v.success(!1):"string"==typeof e&&"true"===e.toLowerCase()?v.success(!0):"string"==typeof e&&"false"===e.toLowerCase()?v.success(!1):v.boolean.validate(e,t)),v.identity)),Gl=new v.Type("NonEmptyString",v.string.is,((e,t)=>"string"==typeof e&&""!==e.trim()?v.success(e):v.failure(e,t)),v.identity),Hl=(new v.Type("DefaultUuid",v.string.is,((e,t)=>null==e?v.success(Object(Xe.v4)()):Gl.validate(e,t)),v.identity),new v.Type("PositiveIntegerGreaterThanZero",v.number.is,((e,t)=>"number"==typeof e&&Number.isSafeInteger(e)&&e>=1?v.success(e):v.failure(e,t)),v.identity));let Wl;v.union([Hl,v[void 0]]),new v.Type("DefaultVersionNumber",Hl.is,((e,t)=>null==e?v.success(1):Hl.validate(e,t)),v.identity),new v.Type("EmptyStringArray",v.array(v.string).is,((e,t)=>{if(null==e)return v.success([]);if("string"==typeof e&&""!==e.trim()){const a=e.trim().split(",").map((e=>e.trim()));return a.some((e=>""===e))?v.failure(e,t):v.success(a)}return v.failure(e,t)}),String),new v.Type("IsoDateString",v.string.is,((e,t)=>{if("string"!=typeof e)return v.failure(e,t);try{return new Date(e).toISOString()===e?v.success(e):v.failure(e,t)}catch(a){return v.failure(e,t)}}),v.identity),v.exact(v.partial({overwrite:Ul,overwrite_exceptions:Ul,overwrite_action_connectors:Ul,as_new_list:Ul})),new v.Type("NonEmptyOrNullableStringArray",v.array(v.string).is,((e,t)=>{const a=Array.isArray(e)&&e.some((e=>""===e)),n=Array.isArray(e)&&e.some((e=>"string"!=typeof e));return Array.isArray(e)&&(a||n||0===e.length)?v.failure(e,t):v.array(v.string).validate(e,t)}),v.identity),new v.Type("NonEmptyStringArray",v.array(v.string).is,((e,t)=>{if("string"==typeof e&&""!==e.trim()){const a=e.trim().split(",").map((e=>e.trim()));return a.some((e=>""===e))?v.failure(e,t):v.success(a)}return v.failure(e,t)}),String),new v.Type("NumberBetweenZeroAndOneInclusive",v.number.is,((e,t)=>"number"==typeof e&&!Number.isNaN(e)&&Number.isFinite(e)&&e>=0&&e<=1?v.success(e):v.failure(e,t)),v.identity),new v.Type("DefaultBooleanTrue",v.boolean.is,((e,t)=>null==e||"boolean"==typeof e&&!1===e?v.success(!1):v.failure(e,t)),v.identity),v.keyof({included:null}),v.keyof({excluded:null}),v.keyof({equals:null}),function(e){e.EQUALS="equals"}(Wl||(Wl={})),new v.Type("PositiveInteger",v.number.is,((e,t)=>"number"==typeof e&&Number.isSafeInteger(e)&&e>=0?v.success(e):v.failure(e,t)),v.identity),new v.Type("StringToPositiveNumber",v.number.is,((e,t)=>w.either.chain(v.string.validate(e,t),(a=>{const n=+a;return 0===a.trim().length||isNaN(n)||n<=0?v.failure(e,t):v.success(n)}))),String);const Ql=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,Jl=(new v.Type("UUID",v.string.is,((e,t)=>"string"==typeof e&&Ql.test(e)?v.success(e):v.failure(e,t)),v.identity),{from:"now-15m",to:"now"}),Kl={query:{language:"kuery",query:""},filters:[],panelFilters:[],dateRange:Jl,limit:100},Yl=(e,t)=>({...e,...Object.fromEntries(Object.entries(t).filter((([e,t])=>!!t)))}),Xl=v.intersection([v.type({meta:v.partial({alias:v.union([v.null,v.string]),disabled:v.boolean,negate:v.boolean,controlledBy:v.string,group:v.string,index:v.string,isMultiIndex:v.boolean,type:v.string,key:v.string,params:v.any,value:v.any})}),v.partial({query:v.record(v.string,v.any),$state:v.type({store:function(e,t){const a=e=>Object.values(t).includes(e);return new v.Type("FilterStateStore",a,((e,t)=>a(e)?v.success(e):v.failure(e,t)),v.identity)}(0,ca.FilterStateStore)})})]),Zl=v.array(Xl),eo=v.type({language:v.string,query:v.union([v.string,v.record(v.string,v.any)])}),to=v.intersection([v.type({from:v.string,to:v.string}),v.partial({mode:v.union([v.literal("absolute"),v.literal("relative")])})]),ao=v.type({filters:Zl,panelFilters:Zl,query:eo,dateRange:to,limit:v.number}),no=ao.encode,ro=e=>Object(x.pipe)(ao.decode(e),Object(w.fold)(Object(k.constant)(void 0),k.identity)),io=({field:e,values:t,dataView:a})=>{const n=null==a?void 0:a.getFieldByName(e);if(!a||!n)return{query:{terms:{[e]:t}},meta:{}};const r=t.map((e=>Object(ca.buildPhraseFilter)(n,e,a)));return Object(ca.buildCombinedFilter)(ca.BooleanRelation.OR,r,a)},so=(e,t=[])=>{for(const a of e)Object(ca.isCombinedFilter)(a)&&so(a.meta.params,t),a.meta.key&&t.push(a.meta.key);return t},lo=f()((()=>{const[e,t]=Object(n.useState)(null),[a,r]=(()=>{const[e]=Object(Xt.a)(Jl),[t,a]=_a()("hostsView:hostLimitSelection",Kl.limit),[r,i]=Object(O.a)({defaultState:{...Kl,dateRange:e(),limit:null!=t?t:Kl.limit},decodeUrlState:ro,encodeUrlState:no,urlStateKey:"_a",writeDefaultState:!0}),[s,l]=Object(n.useReducer)(Yl,r);return Sl()(s,r)||(i(s),t!==s.limit&&a(s.limit)),Object(Xt.b)(Jl,r.dateRange,(e=>l({dateRange:e}))),[s,l]})(),{dataView:i}=Ml(),{services:s}=Object(ge.b)(),l=Object(Cl.a)(),{data:{query:{filterManager:o,queryString:c,timefilter:u}},telemetry:d}=s,m=Object(n.useCallback)((e=>{Object(ca.fromKueryExpression)(e.query,l)}),[l]),p=Object(n.useCallback)((e=>{try{var a;t(null),m(null!==(a=null==e?void 0:e.query)&&void 0!==a?a:c.getQuery()),r(null!=e?e:{})}catch(a){const{query:n,...i}=null!=e?e:{};r(null!=i?i:{}),t(a)}}),[c,r,m]),g=Object(n.useMemo)((()=>{const e=(()=>{const e=Date.now();return{from:new Date(e-9e5).toISOString(),to:new Date(e).toISOString()}})(),{from:t=e.from,to:n=e.to}=Object(Sr.d)(a.dateRange);return{from:t,to:n}}),[a.dateRange]),f=Object(n.useCallback)((()=>({from:new Date(g.from).getTime(),to:new Date(g.to).getTime()})),[g]),b=Object(n.useCallback)((()=>Object(ca.buildEsQuery)(i,a.query,[...a.filters,...a.panelFilters],l)),[i,a.query,a.filters,a.panelFilters,l]);return Mr()((()=>{Sl()(o.getFilters(),a.filters)||o.setFilters(a.filters),Sl()(c.getQuery(),a.query)||c.setQuery(a.query);try{a.query&&m(a.query)}catch(e){t(e)}})),Object(n.useEffect)((()=>{const e=o.getUpdates$().pipe(Object(Ar.startWith)(void 0),Object(Ar.map)((()=>o.getFilters()))),t=c.getUpdates$().pipe(Object(Ar.startWith)(void 0),Object(Ar.map)((()=>c.getQuery()))),a=Object(jr.combineLatest)({filters:e,query:t}).pipe(Object(Ar.skip)(1)).subscribe(p);return()=>{a.unsubscribe()}}),[o,p,c,u.timefilter]),Object(n.useEffect)((()=>{const e=f();d.reportHostsViewQuerySubmitted((e=>{const{panelFilters:t,filters:a,parsedDateRange:n,query:r,limit:i}=e;return{control_filter_fields:so(t),filter_fields:so(a),interval:(s=n.to-n.from,s<6e4?"1. Less than 1 minute":s>=6e4&&s<Tl?"2. 1-5 minutes":s>=Tl&&s<Il?"3. 5-10 minutes":s>=Il&&s<Fl?"4. 10-30 minutes":s>=Fl&&s<Ll?"5. 30-60 minutes":s>=Ll&&s<Pl?"6. 1-2 hours":s>=Pl&&s<Dl?"7. 2-8 hours":s>=Dl&&s<_l?"8. 8-12 hours":s>=_l&&s<Rl?"9. 12-24 hours":s>=Rl&&s<Al?"10. 1-2 days":s>=Al&&s<Bl?"11. 2-7 days":s>=Bl&&s<Vl?"12. 7-14 days":s>=Vl&&s<Nl?"13. 14-30 days":s>=Nl&&s<zl?"14. 30-60 days":s>=zl&&s<$l?"15. 60-90 days":s>=$l&&s<ql?"16. 90-180 days":s>=ql&&s<31536e6?"17. 180-365 days":"18. More than 1 year"),with_query:!!r.query,limit:i};var s})({...a,parsedDateRange:e}))}),[f,a,d]),{error:e,buildQuery:b,onSubmit:p,parsedDateRange:g,getDateRangeAsTimestamp:f,searchCriteria:a}})),[oo,co]=lo,uo=W.i18n.translate("xpack.infra.metadataEmbeddable.filterAdded",{defaultMessage:"Filter was added"}),mo=({item:e})=>{const{dataView:t}=Ml(),{searchCriteria:a}=co(),{services:{data:{query:{filterManager:i}},notifications:{toasts:s},telemetry:l}}=Object(ge.b)(),o=Object(n.useMemo)((()=>null==a?void 0:a.filters.find((t=>t.meta.key===e.name))),[e.name,null==a?void 0:a.filters]);return o?r.a.createElement("span",null,r.a.createElement(Y.EuiToolTip,{content:W.i18n.translate("xpack.infra.metadataEmbeddable.setRemoveFilterTooltip",{defaultMessage:"Remove filter"})},r.a.createElement(Y.EuiButtonIcon,{size:"s",color:"text",iconType:"filter",display:"base","data-test-subj":"infraAssetDetailsMetadataRemoveFilterButton","aria-label":W.i18n.translate("xpack.infra.metadataEmbeddable.filterAriaLabel",{defaultMessage:"Filter"}),onClick:()=>{l.reportHostFlyoutFilterRemoved({field_name:o.meta.key}),i.removeFilter(o)}}))):r.a.createElement("span",null,r.a.createElement(Y.EuiToolTip,{content:W.i18n.translate("xpack.infra.metadataEmbeddable.setFilterByValueTooltip",{defaultMessage:"Filter by value"})},r.a.createElement(Y.EuiButtonIcon,{color:"primary",size:"s",iconType:"filter","data-test-subj":"infraAssetDetailsMetadataAddFilterButton","aria-label":W.i18n.translate("xpack.infra.metadataEmbeddable.AddFilterAriaLabel",{defaultMessage:"Add Filter"}),onClick:()=>{var a;const n=function({field:e,value:t,dataView:a,negate:n=!1}){if(!a)return null;const r=a.getFieldByName(e),i=Array.isArray(t)&&t.length>1,s=i?Object(ca.buildPhrasesFilter)(r,t,a):Object(ca.buildPhraseFilter)(r,Array.isArray(t)?t[0]:t,a);return s.meta.type=i?"phrases":"phrase",s.$state={store:"appState"},s.meta.value=Array.isArray(t)?i?void 0:`${t[0]}`:t,s.meta.key=e,s.meta.alias=null,s.meta.negate=n,s.meta.disabled=!1,s}({field:e.name,value:null!==(a=e.value)&&void 0!==a?a:"",dataView:t,negate:!1});n&&(l.reportHostFlyoutFilterAdded({field_name:e.name}),i.addFilters(n),s.addSuccess({title:uo,toastLifeTimeMs:1e4}))}})))},po=e=>{const{values:t}=e,[a,n]=_t()(!1),i=Array.isArray(t)?t:[t],[s,...l]=i,o=l.length>0,c=o&&!a;return r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs",responsive:!1,alignItems:"baseline",wrap:!0,direction:"column"},r.a.createElement("div",null,s,c&&r.a.createElement(r.a.Fragment,null," ... ",r.a.createElement(Y.EuiLink,{"data-test-subj":"infraAssetDetailsExpandableContentCountMoreLink",onClick:n},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.nodeDetails.tabs.metadata.seeMore",defaultMessage:"+{count} more",values:{count:l.length}})))),a&&l.map(((e,t)=>r.a.createElement(Y.EuiFlexItem,{key:t},e))),o&&a&&r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiLink,{"data-test-subj":"infraExpandableContentShowLessLink",onClick:n},W.i18n.translate("xpack.infra.nodeDetails.tabs.metadata.seeLess",{defaultMessage:"Show less"}))))},go=W.i18n.translate("xpack.infra.metadataEmbeddable.pinField",{defaultMessage:"Pin Field"}),fo=({fieldName:e,pinnedItems:t,onPinned:a})=>null!=t&&t.includes(e)?r.a.createElement("span",null,r.a.createElement(Y.EuiToolTip,{content:W.i18n.translate("xpack.infra.metadataEmbeddable.unpinField",{defaultMessage:"Unpin field"})},r.a.createElement(Y.EuiButtonIcon,{size:"s",color:"primary",iconType:"pinFilled","data-test-subj":"infraAssetDetailsMetadataRemovePin","aria-label":W.i18n.translate("xpack.infra.metadata.pinAriaLabel",{defaultMessage:"Pinned field"}),onClick:()=>{t&&t.includes(e)&&a((null!=t?t:[]).filter((t=>e!==t)))}}))):r.a.createElement("span",{className:"euiTableCellContent__hoverItem expandedItemActions__completelyHide"},r.a.createElement(Y.EuiToolTip,{content:go},r.a.createElement(Y.EuiButtonIcon,{color:"primary",size:"s",iconType:"pin","data-test-subj":"infraAssetDetailsMetadataAddPin","aria-label":go,onClick:()=>{a([...t,e])}}))),bo=W.i18n.translate("xpack.infra.metadataEmbeddable.field",{defaultMessage:"Field"}),ho=W.i18n.translate("xpack.infra.metadataEmbeddable.value",{defaultMessage:"Value"}),yo=W.i18n.translate("xpack.infra.metadataEmbeddable.searchForMetadata",{defaultMessage:"Search for metadata…"}),Eo=W.i18n.translate("xpack.infra.metadataEmbeddable.noMetadataFound",{defaultMessage:"No metadata found."}),vo=W.i18n.translate("xpack.infra.metadataEmbeddable.loading",{defaultMessage:"Loading..."}),xo=({loading:e,rows:t,onSearchChange:a,search:i,showActionsColumn:s})=>{const[l,o]=Object(n.useState)(null),[c,u]=Object(n.useState)(i),[d,m]=Object(n.useState)(t),[p,g]=_a()("hostsView:pinnedMetadataRows",[]);Object(n.useMemo)((()=>{var e;p&&m(null!==(e=((e,t)=>{if(t.length>0){const{pinned:a,other:n}=e.reduce(((e,a)=>((t.includes(a.name)?e.pinned:e.other).push(a),e)),{pinned:[],other:[]});return[...a,...n]}})(t,p))&&void 0!==e?e:t)}),[t,p]);const f=Object(n.useMemo)((()=>[{field:"value",name:r.a.createElement(Y.EuiIcon,{type:"pin"}),align:"center",width:"5%",sortable:!1,showOnHover:!0,render:(e,t)=>r.a.createElement(fo,{fieldName:t.name,pinnedItems:null!=p?p:[],onPinned:g})},{field:"name",name:bo,width:"35%",sortable:!1,render:e=>r.a.createElement(Y.EuiText,{size:"s"},e)},{field:"value",name:ho,width:"50%",sortable:!1,render:(e,t)=>r.a.createElement(po,{values:t.value})}]),[p,g]),b=Object(n.useMemo)((()=>Object(Ne.debounce)((e=>{a&&a(e),u(e)}),500)),[a]),h={onChange:Object(n.useCallback)((({queryText:e,error:t})=>{t?o(t):(o(null),b(e))}),[b]),box:{"data-test-subj":"infraAssetDetailsMetadataSearchBarInput",incremental:!0,schema:!0,placeholder:yo},query:c?Y.Query.parse(c):Y.Query.MATCH_ALL},y=Object(n.useMemo)((()=>s?[...f,{field:"value",name:"Actions",sortable:!1,showOnHover:!0,align:"center",render:(e,t)=>r.a.createElement(mo,{item:t})}]:f),[f,s]);return r.a.createElement(Y.EuiInMemoryTable,{"data-test-subj":"infraAssetDetailsMetadataTable",tableLayout:"fixed",responsive:!1,columns:y,items:d,rowProps:{className:"euiTableRow-hasActions"},search:h,loading:e,error:l?`${l.message}`:"",message:e?r.a.createElement("div",{"data-test-subj":"infraAssetDetailsMetadataLoading"},vo):r.a.createElement("div",{"data-test-subj":"infraAssetDetailsMetadataNoData"},Eo)})},wo=r.a.memo((()=>r.a.createElement(Y.EuiText,{size:"xs",onClick:e=>{e.stopPropagation()},style:{width:200}},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.metadata.tooltip.documentationLabel",defaultMessage:"{metadata} is populated from the last event detected for this {hostName} for the selected date period.",values:{metadata:r.a.createElement("i",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.metadata.tooltip.metadata",defaultMessage:"Metadata"})),hostName:r.a.createElement(Y.EuiLink,{"data-test-subj":"infraAssetDetailsTooltipDocumentationLink",href:"https://www.elastic.co/guide/en/ecs/current/ecs-host.html#field-host-name",target:"_blank"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.metadata.tooltip.documentationLink",defaultMessage:"host.name"}))}})))),ko=()=>{var e,t,a;const{metadata:n,loading:i}=gl();return i&&!n?r.a.createElement(Y.EuiLoadingSpinner,null):null!=n&&null!==(e=n.info)&&void 0!==e&&e.timestamp?r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs",alignItems:"baseline",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiText,{size:"xs",color:"subdued"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.metadata.tooltip.metadataSectionTitle",defaultMessage:"Showing metadata collected on {date} @ {time}",values:{date:r.a.createElement(X.FormattedDate,{value:new Date(null==n||null===(t=n.info)||void 0===t?void 0:t.timestamp),month:"short",day:"numeric",year:"numeric"}),time:r.a.createElement(X.FormattedTime,{value:new Date(null==n||null===(a=n.info)||void 0===a?void 0:a.timestamp),hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Nr,{iconSize:"s",iconColor:"subdued",icon:"iInCircle","data-test-subj":"infraAssetDetailsMetadataPopoverButton"},r.a.createElement(wo,null)))):null},Oo=()=>{const{refresh:e}=gl();return r.a.createElement(Y.EuiCallOut,{title:W.i18n.translate("xpack.infra.metadataEmbeddable.errorTitle",{defaultMessage:"Sorry, there was an error"}),color:"danger",iconType:"error","data-test-subj":"infraAssetDetailsMetadataErrorCallout"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metadataEmbeddable.errorMessage",defaultMessage:"There was an error loading your data. Try to {refetch} and open the host details again.",values:{refetch:r.a.createElement(Y.EuiLink,{"data-test-subj":"infraMetadataReloadPageLink",onClick:e},W.i18n.translate("xpack.infra.metadataEmbeddable.errorAction",{defaultMessage:"refetch the metadata"}))}}))},Mo=()=>{var e;const[t,a]=Tr(),{overrides:i}=hl(),{metadata:s,loading:l,error:o}=gl(),{showActionsColumn:c=!1}=null!==(e=null==i?void 0:i.metadata)&&void 0!==e?e:{},u=Object(n.useMemo)((()=>(e=>{var t,a,n,r;if(null==e||!e.info)return[];const i=(t,a)=>{var n,r;const i=null!==(n=null==e||null===(r=e.info)||void 0===r?void 0:r[`${t}`])&&void 0!==n?n:{};if(i.hasOwnProperty(a)){const e=i[a];return"boolean"==typeof e?{name:`${t}.${a}`,value:String(e)}:"string"==typeof e||Array.isArray(e)?{name:`${t}.${a}`,value:e}:Object.entries(null!=e?e:{}).map((([e,n])=>({name:`${t}.${a}.${e}`,value:n})))}return[]},s=Object.keys(null!==(t=e.info.agent)&&void 0!==t?t:{}).flatMap((e=>i("agent",e))),l=Object.keys(null!==(a=e.info.cloud)&&void 0!==a?a:{}).flatMap((e=>i("cloud",e)));return(e=>e.filter((e=>!(null==e||!e.value))))([...Object.keys(null!==(n=null==e||null===(r=e.info)||void 0===r?void 0:r.host)&&void 0!==n?n:{}).flatMap((e=>i("host",e))),...s,...l])})(s)),[s]),d=Object(n.useCallback)((e=>{a({metadataSearch:e})}),[a]);return o&&!l?r.a.createElement(Oo,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(ko,null),r.a.createElement(Y.EuiHorizontalRule,{margin:"m"}),r.a.createElement(xo,{search:null==t?void 0:t.metadataSearch,onSearchChange:d,showActionsColumn:c,rows:u,loading:l}))},jo=e=>e.replace(/([+\-=!\(\)\{\}\[\]^"~*?:\\/!]|&&|\|\|)/g,"\\$1");var So=a(46),Co=a(96),To=a(201);const Io={subdued:Object(To.css)("fill:",dn.euiThemeVars.euiTextSubduedColor,";",""),accent:Object(To.css)("fill:",dn.euiThemeVars.euiColorVis0,";","")},Fo=({title:e,titleId:t,...a})=>Object(Wt.jsx)("svg",de()({viewBox:"0 0 30 22",width:30,height:22,fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-labelledby":t},a),e?Object(Wt.jsx)("title",{id:t},e):null,Object(Wt.jsx)("path",{d:"M23.434 16.456c.211.553.406.982.58 1.277l.073.119c.038.058.072.105.101.141.52-.04 1.07-.248 2.13-.77l.235-.117C28.198 16.283 28.953 16 30 16v2c-.507 0-.988.146-1.89.571l-1.209.592C25.621 19.78 24.924 20 24 20l-.174-.005c-1.251-.076-1.805-1.036-2.994-4.993L22.93 15c.18.563.335 1.012.505 1.455zM6 1c1.269 0 1.966.69 3.492 2.939l.774 1.146.272.387.26.358C11.419 6.658 11.788 7 12 7c.466 0 .967-.252 1.99-.997l.891-.659.458-.325C16.424 4.272 17.093 4 18 4c1.377 0 1.925.863 3.168 4.999L19.07 9a26.766 26.766 0 00-.505-1.457c-.24-.631-.46-1.1-.652-1.395l-.051-.074-.045-.06c-.452.064-.988.375-2.007 1.13l-.691.512-.458.325C13.576 8.728 12.907 9 12 9c-1.269 0-1.966-.69-3.492-2.939l-.774-1.146-.272-.387-.26-.358C6.581 3.342 6.213 3 6 3c-.294 0-.885.651-2.017 2.33l-.491.731-.326.475C1.859 8.409 1.175 9 0 9V7c.294 0 .885-.651 2.017-2.33l.491-.731.326-.475C4.141 1.591 4.825 1 6 1z",className:Io.subdued}),Object(Wt.jsx)("path",{d:"M0 21c1.123 0 1.852-.477 3.295-1.885l.758-.75.345-.33C5.208 17.275 5.648 17 6 17c.466 0 .967.252 1.99.997l.891.659.458.325C10.424 19.728 11.093 20 12 20c1.325 0 1.996-.772 3.546-3.444l.593-1.028.385-.646C17.328 13.562 17.796 13 18 13h6c1.333 0 1.978-.795 3.452-3.676l.692-1.37.358-.69C29.333 5.7 29.831 5 30 5V3c-1.333 0-1.978.795-3.452 3.676l-.692 1.37-.358.69C24.667 10.3 24.169 11 24 11h-6c-1.325 0-1.996.772-3.546 3.444l-.593 1.028-.385.646C12.672 17.438 12.204 18 12 18c-.466 0-.967-.252-1.99-.997l-.891-.659-.458-.325C7.576 15.272 6.907 15 6 15c-1.123 0-1.852.477-3.295 1.885l-.758.75-.345.33C.792 18.725.352 19 0 19v2z",className:Io.accent}));var Lo=a(94),Po=a(112);const Do=f()((function(e){const{hostTerm:t,to:a}=e,{createDerivedIndexPattern:n}=Object(re.b)();return{hostTerm:t,indexPattern:n().title,to:a}})),[_o,Ro]=Do;var Ao=a(30);const Bo=({metricName:e})=>{const{getDateRangeInTimestamp:t}=Rr(),a=new Date(t().to);return r.a.createElement(Nr,{iconSize:"s",iconColor:"subdued",icon:"questionInCircle","data-test-subj":"infraAssetDetailsMetricNotAvailablePopoverButton"},r.a.createElement(Y.EuiText,{size:"xs",color:"subdued"},r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.processes.tooltip.metricNotAvailableTitle",defaultMessage:"No {metric} value detected for the 1 minute preceding {date} @ {time}.",values:{date:r.a.createElement(X.FormattedDate,{value:a,month:"short",day:"numeric",year:"numeric"}),time:r.a.createElement(X.FormattedTime,{value:a,hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}),metric:e}})),r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.processes.tooltip.metricNotAvailableActionText",defaultMessage:"Try changing the selected time period or check the data collection method for this host."}))))},Vo=({metricName:e})=>r.a.createElement(Ho,{icon:Fo,message:r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metrics.nodeDetails.processes.charts.noDataLabel",defaultMessage:"No results found"})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Bo,{metricName:e})))}),No=({command:e,hasCpuData:t,hasMemoryData:a})=>{const{request$:i}=ml(),{loading:s,error:l,response:o}=function(e,t){const[a,r]=Object(n.useState)(!1),{hostTerm:i,indexPattern:s,to:l}=Ro(),{error:o,loading:c,response:u,makeRequest:d}=Object(ol.a)("/api/metrics/process_list/chart","POST",JSON.stringify({hostTerm:i,indexPattern:s,to:l,command:e}),(e=>Object(x.pipe)(Po.l.decode(e),Object(w.fold)(Object(pi.d)(pi.a),k.identity))),void 0,void 0,!0);return Object(n.useEffect)((()=>r(!0)),[o]),Object(n.useEffect)((()=>r(!1)),[c]),Object(n.useEffect)((()=>{t?t.next(d):d()}),[d,t]),{error:a,loading:c,response:u,makeRequest:d}}(e,i),c=s||!o,u=l?r.a.createElement(Y.EuiEmptyPrompt,{iconType:"warning",title:r.a.createElement(Y.EuiText,null,Go)}):c?r.a.createElement(Y.EuiLoadingChart,null):t?r.a.createElement(zo,{timeseries:o.cpu,color:Ze.a.color2,label:$o}):r.a.createElement(Vo,{metricName:$o}),d=l?r.a.createElement(Y.EuiEmptyPrompt,{iconType:"warning",title:r.a.createElement(Y.EuiText,null,Go)}):c?r.a.createElement(Y.EuiLoadingChart,null):a?r.a.createElement(zo,{timeseries:o.memory,color:Ze.a.color0,label:qo}):r.a.createElement(Vo,{metricName:Uo});return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiDescriptionListTitle,null,$o),r.a.createElement(Y.EuiDescriptionListDescription,null,u)),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiDescriptionListTitle,null,qo),r.a.createElement(Y.EuiDescriptionListDescription,null,d)))},zo=({timeseries:e,color:t,label:a})=>{const i=Object(Ge.a)(),s={color:t,aggregation:"avg",label:a},l=Object(n.useMemo)((()=>{var t,a;if(!e)return()=>"";const n=null===(t=Object(Ne.first)(e.rows))||void 0===t?void 0:t.timestamp,r=null===(a=Object(Ne.last)(e.rows))||void 0===a?void 0:a.timestamp;return null==n||null==r?e=>`${e}`:Object(Ue.niceTimeFormatter)([n,r])}),[e]),o=Object(So.b)("percent"),c=Object(bt.a)(e,[s],!1),u=c?{max:1.1*c.max,min:c.min}:{max:0,min:0};return r.a.createElement(Wo,null,r.a.createElement(Ue.Chart,null,r.a.createElement(Et.a,{type:Ao.a.area,metric:s,id:"0",series:e,stack:!1}),r.a.createElement(Ue.Axis,{id:"timestamp",position:Ue.Position.Bottom,showOverlappingTicks:!0,tickFormat:l}),r.a.createElement(Ue.Axis,{id:"values",position:Ue.Position.Left,tickFormat:o,domain:u,ticks:6,gridLine:{visible:!0}}),r.a.createElement(Ue.Tooltip,{headerFormatter:({value:e})=>h()(e).format("Y-MM-DD HH:mm:ss.SSS")}),r.a.createElement(Ue.Settings,{baseTheme:i.baseTheme,theme:i.theme,locale:W.i18n.getLocale()})))},$o=W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowLabelCPU",{defaultMessage:"CPU"}),qo=W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowLabelMemory",{defaultMessage:"Memory"}),Uo=W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowMemory",{defaultMessage:"memory"}),Go=W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.failedToLoadChart",{defaultMessage:"Unable to load chart"});var Ho=Fa()(Lo.EmptyPlaceholder).withConfig({displayName:"_StyledEmptyPlaceholder",componentId:"sc-1ld6o7m-0"})(["{height:140px;}"]),Wo=Fa()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1ld6o7m-1"})(["{width:100%;height:140px;}"]);const Qo=({command:e})=>{const{observabilityAIAssistant:{ObservabilityAIAssistantContextualInsight:t}}=Object(ge.b)().services,a=Object(n.useMemo)((()=>{if(e)return[{"@timestamp":(new Date).toISOString(),message:{role:Co.MessageRole.User,content:`I am a software engineer. I am trying to understand what a process running on my\n          machine does.\n          Your task is to first describe what the process is and what its general use cases are. If I also provide you\n          with the arguments to the process you should then explain its arguments and how they influence the behaviour\n          of the process. If I do not provide any arguments then explain the behaviour of the process when no arguments are\n          provided.\n          If you do not recognise the process say "No information available for this process". If I provide an argument\n          to the process that you do not recognise then say "No information available for this argument" when explaining\n          that argument.\n          Here is an example with arguments.\n          Process: metricbeat -c /etc/metricbeat.yml -d autodiscover,kafka -e -system.hostfs=/hostfs\n          Explanation: Metricbeat is part of the Elastic Stack. It is a lightweight shipper that you can install on your\n          servers to periodically collect metrics from the operating system and from services running on the server.\n          Use cases for Metricbeat generally revolve around infrastructure monitoring. You would typically install\n          Metricbeat on your servers to collect metrics from your systems and services. These metrics are then\n          used for performance monitoring, anomaly detection, system status checks, etc.\n          Here is a breakdown of the arguments used:\n          * -c /etc/metricbeat.yml: The -c option is used to specify the configuration file for Metricbeat. In\n          this case, /etc/metricbeat.yml is the configuration file. This file contains configurations for what\n          metrics to collect and where to send them (e.g., to Elasticsearch or Logstash).\n          * -d autodiscover,kafka: The -d option is used to enable debug output for selected components. In\n          this case, debug output is enabled for autodiscover and kafka components. The autodiscover feature\n          allows Metricbeat to automatically discover services as they get started and stopped in your environment,\n          and kafka is presumably a monitored service from which Metricbeat collects metrics.\n          * -e: The -e option is used to log to stderr and disable syslog/file output. This is useful for debugging.\n          * -system.hostfs=/hostfs: The -system.hostfs option is used to set the mount point of the host’s\n          filesystem for use in monitoring a host from within a container. In this case, /hostfs is the mount\n          point. When running Metricbeat inside a container, filesystem metrics would be for the container by\n          default, but with this option, Metricbeat can get metrics for the host system.\n          Here is an example without arguments.\n          Process: metricbeat\n          Explanation: Metricbeat is part of the Elastic Stack. It is a lightweight shipper that you can install on your\n          servers to periodically collect metrics from the operating system and from services running on the server.\n          Use cases for Metricbeat generally revolve around infrastructure monitoring. You would typically install\n          Metricbeat on your servers to collect metrics from your systems and services. These metrics are then\n          used for performance monitoring, anomaly detection, system status checks, etc.\n          Running it without any arguments will start the process with the default configuration file, typically\n          located at /etc/metricbeat/metricbeat.yml. This file specifies the metrics to be collected and where\n          to ship them to.\n          Now explain this process to me.\n          Process: ${e}\n          Explanation:\n            `}}]}),[e]);return r.a.createElement(r.a.Fragment,null,t&&a?r.a.createElement(Y.EuiFlexGroup,null,r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(t,{title:Ko,messages:a})))):null)},Jo=({cells:e,item:t,supportAIAssistant:a=!1})=>{const[n,i]=_t()(!1);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiTableRow,null,r.a.createElement(Y.EuiTableRowCell,{isExpander:!0,textOnly:!1},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraProcessRowButton",iconType:n?"arrowDown":"arrowRight","aria-expanded":n,onClick:i})),e),r.a.createElement(Y.EuiTableRow,{isExpandable:!0,isExpandedRow:n},n&&r.a.createElement(ec,null,r.a.createElement(Y.EuiSpacer,{size:"s"}),r.a.createElement(Yo,null,r.a.createElement(Y.EuiFlexGroup,{gutterSize:"s"},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement("div",null,r.a.createElement(Y.EuiDescriptionListTitle,null,W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowLabelCommand",{defaultMessage:"Command"})),r.a.createElement(Y.EuiDescriptionListDescription,null,r.a.createElement(Zo,null,t.command)))),t.apmTrace&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,{"data-test-subj":"infraProcessRowViewTraceInApmButton"},W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.viewTraceInAPM",{defaultMessage:"View trace in APM"})))),r.a.createElement(Y.EuiFlexGrid,{columns:2,gutterSize:"s",responsive:!1},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiDescriptionListTitle,null,W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowLabelPID",{defaultMessage:"PID"})),r.a.createElement(Y.EuiDescriptionListDescription,null,r.a.createElement(Xo,null,t.pid))),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiDescriptionListTitle,null,W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowLabelUser",{defaultMessage:"User"})),r.a.createElement(Y.EuiDescriptionListDescription,null,r.a.createElement(Xo,null,t.user))),r.a.createElement(No,{command:t.command,hasCpuData:null!==t.cpu,hasMemoryData:null!==t.memory})),a&&r.a.createElement(Qo,{command:t.command})))))},Ko=W.i18n.translate("xpack.infra.hostFlyout.explainProcessMessageTitle",{defaultMessage:"What's this process?"}),Yo=Object(Z.euiStyled)(Y.EuiDescriptionList).attrs({compressed:!0})`
  width: 100%;
`,Xo=Object(Z.euiStyled)(Y.EuiCode).attrs({transparentBackground:!0})`
  padding: 0 !important;
  & code.euiCodeBlock__code {
    white-space: nowrap !important;
    vertical-align: middle;
  }
`,Zo=Object(Z.euiStyled)(Y.EuiCode).attrs({transparentBackground:!0})`
  padding: 0 !important;
  margin-bottom: ${e=>e.theme.eui.euiSizeS};
`,ec=Object(Z.euiStyled)(Y.EuiTableRowCell).attrs({textOnly:!1,colSpan:6})`
  padding-top: ${e=>e.theme.eui.euiSizeM} !important;
  padding-bottom: ${e=>e.theme.eui.euiSizeM} !important;
  background-color: ${e=>e.theme.eui.euiColorLightestShade};
`,tc={running:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateRunning",{defaultMessage:"Running"}),sleeping:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateSleeping",{defaultMessage:"Sleeping"}),dead:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateDead",{defaultMessage:"Dead"}),stopped:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateStopped",{defaultMessage:"Stopped"}),idle:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateIdle",{defaultMessage:"Idle"}),zombie:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateZombie",{defaultMessage:"Zombie"}),unknown:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateUnknown",{defaultMessage:"Unknown"})},ac=["running","sleeping","stopped","idle","dead","zombie","unknown"],nc=({state:e})=>{switch(e){case"running":return r.a.createElement(Y.EuiBadge,{color:"success"},tc.running);case"sleeping":return r.a.createElement(Y.EuiBadge,{color:"default"},tc.sleeping);case"dead":return r.a.createElement(Y.EuiBadge,{color:"danger"},tc.dead);case"stopped":return r.a.createElement(Y.EuiBadge,{color:"warning"},tc.stopped);case"idle":return r.a.createElement(Y.EuiBadge,{color:"primary"},tc.idle);case"zombie":return r.a.createElement(Y.EuiBadge,{color:"danger"},tc.zombie);default:return r.a.createElement(Y.EuiBadge,{color:"hollow"},tc.unknown)}},rc=W.i18n.translate("xpack.infra.assetDetailsEmbeddable.notApplicableLabel",{defaultMessage:"N/A"}),ic=({processList:e,currentTime:t,isLoading:a,sortBy:i,error:s,setSortBy:l,clearSearchBar:o})=>{const{updateSortableProperties:c}=function(e,t,a){const[r]=Object(n.useState)(new Y.SortableProperties(e,"cpu"));return{updateSortableProperties:Object(n.useCallback)((e=>{r.sortOn(e),a(Object(Ne.omit)(r.getSortedProperty(),"getValue"))}),[r,a])}}([{name:"startTime",getValue:e=>Date.parse(e.startTime),isAscending:!0},{name:"cpu",getValue:e=>e.cpu,isAscending:!1},{name:"memory",getValue:e=>e.memory,isAscending:!1}],0,l),u=Object(n.useMemo)((()=>e.sort(((e,t)=>ac.indexOf(e.state)-ac.indexOf(t.state)))),[e]);return a||0!==u.length?r.a.createElement(Y.EuiTable,{"data-test-subj":"infraAssetDetailsProcessesTable",responsive:!1},r.a.createElement(Y.EuiTableHeader,null,r.a.createElement(Y.EuiTableHeaderCell,{width:24}),dc.map((e=>{var t;return r.a.createElement(Y.EuiTableHeaderCell,{key:`${String(e.field)}-header`,align:null!==(t=e.align)&&void 0!==t?t:Y.LEFT_ALIGNMENT,width:e.width,onSort:e.sortable?()=>c(e.field):void 0,isSorted:i.name===e.field,isSortAscending:i.name===e.field&&i.isAscending},e.name)}))),r.a.createElement(pc,null,a&&r.a.createElement(Y.EuiProgress,{size:"xs",color:"primary",position:"absolute"}),a&&0===u.length&&!s&&r.a.createElement(sc,null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.processes.loading",defaultMessage:"Loading..."})),s?r.a.createElement(sc,null,r.a.createElement(Y.EuiIcon,{type:"minusInCircle",color:"danger"})," ",s):r.a.createElement(lc,{items:u,currentTime:t}))):r.a.createElement(Y.EuiEmptyPrompt,{iconType:"search",titleSize:"s",title:r.a.createElement("strong",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metrics.nodeDetails.noProcesses",defaultMessage:"No processes found"})),body:r.a.createElement(Y.EuiText,{size:"s"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metrics.nodeDetails.noProcessesBody",defaultMessage:"Try modifying your filter. Only processes that are within the configured {metricbeatDocsLink} will display here.",values:{metricbeatDocsLink:r.a.createElement(Y.EuiLink,{"data-test-subj":"infraProcessesTableTopNByCpuOrMemoryLink",href:"https://www.elastic.co/guide/en/beats/metricbeat/current/metricbeat-module-system.html",target:"_blank"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metrics.nodeDetails.noProcessesBody.metricbeatDocsLinkText",defaultMessage:"top N by CPU or Memory"}))}})),actions:r.a.createElement(Y.EuiButton,{"data-test-subj":"infraProcessesTableClearFiltersButton",onClick:o},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metrics.nodeDetails.noProcessesClearFilters",defaultMessage:"Clear filters"}))})},sc=({children:e})=>{const{euiTheme:t}=Object(Y.useEuiTheme)();return r.a.createElement(Y.EuiTableRow,null,r.a.createElement(Y.EuiTableRowCell,{"data-test-subj":"infraAssetDetailsProcessesSearchInputError",style:{paddingTop:`${t.size.s}`,paddingBottom:`${t.size.s}`},align:"center",colSpan:dc.length+1,mobileOptions:{width:"100%"},textOnly:!0},e))},lc=({items:e,currentTime:t})=>r.a.createElement(r.a.Fragment,null,e.map(((e,a)=>{const n=dc.map((n=>{var i,s;return r.a.createElement(Y.EuiTableRowCell,{key:`${String(n.field)}-${a}`,mobileOptions:{header:n.name},align:null!==(i=n.align)&&void 0!==i?i:Y.LEFT_ALIGNMENT,textOnly:null===(s=n.textOnly)||void 0===s||s},n.render?n.render(e[n.field],t):e[n.field])}));return r.a.createElement(Jo,{cells:n,item:e,key:`row-${a}`,supportAIAssistant:!0})}))),oc=36e5,cc=({startTime:e,currentTime:t})=>{let a=t-e;const n=Math.floor(a/oc);a-=n*oc;const i=Math.floor(a/6e4);a-=6e4*i;const s=Math.floor(a/1e3);a-=1e3*s;const l=n?`${n}:`:"",o=i<10?`0${i}:`:`${i}:`,c=s<10?`0${s}`:s;return r.a.createElement(r.a.Fragment,null,`${l}${o}${c}`)},uc=W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.columnLabelCPU",{defaultMessage:"CPU"}),dc=[{field:"state",name:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.columnLabelState",{defaultMessage:"State"}),sortable:!1,render:e=>r.a.createElement(nc,{state:e}),width:84,textOnly:!1},{field:"command",name:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.columnLabelCommand",{defaultMessage:"Command"}),sortable:!1,width:"40%",render:e=>r.a.createElement(mc,{command:e})},{field:"startTime",name:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.columnLabelTime",{defaultMessage:"Time"}),align:Y.RIGHT_ALIGNMENT,sortable:!0,render:(e,t)=>r.a.createElement(cc,{startTime:e,currentTime:t})},{field:"cpu",name:uc,sortable:!0,render:e=>null===e?r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs"},r.a.createElement(Y.EuiFlexItem,{grow:!1},rc),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Bo,{metricName:uc}))):So.a.percent(e)},{field:"memory",name:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.columnLabelMemory",{defaultMessage:"Mem."}),sortable:!0,render:e=>null===e?r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs"},r.a.createElement(Y.EuiFlexItem,{grow:!1},rc),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Bo,{metricName:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.memory",{defaultMessage:"memory"})}))):So.a.percent(e)}],mc=({command:e})=>{const t=Object(Y.useEuiTheme)();return r.a.createElement(gc,null,r.a.createElement(fc,{transparentBackground:!0,$_css:t.euiTheme.colors.text,$_css2:t.euiTheme.font.weight.medium},e))};var pc=Fa()(Y.EuiTableBody).withConfig({displayName:"_StyledEuiTableBody",componentId:"sc-1ednkbo-0"})(["position:relative;& .euiTableCellContent{padding-top:0;padding-bottom:0;}"]),gc=Fa()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1ednkbo-1"})(["white-space:pre;overflow:hidden;text-overflow:ellipsis;"]),fc=Fa()(Y.EuiCode).withConfig({displayName:"_StyledEuiCode",componentId:"sc-1ednkbo-2"})(["color:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2));const bc={total:rc,running:rc,sleeping:rc,dead:rc,stopped:rc,idle:rc,zombie:rc,unknown:rc},hc=({processSummary:e,isLoading:t})=>{const a=Object(n.useMemo)((()=>({...bc,...Object.fromEntries(Object.entries(e).filter((([e,t])=>!!t)))})),[e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexGroup,{gutterSize:"m",responsive:!1,wrap:!0},Object.entries(a).map((([e,a])=>r.a.createElement(Y.EuiFlexItem,{key:e},r.a.createElement(Y.EuiDescriptionList,{"data-test-subj":"infraAssetDetailsProcessesSummaryTableItem",compressed:!0},r.a.createElement(Ec,null,yc[e]),r.a.createElement(Y.EuiDescriptionListDescription,null,t?r.a.createElement(Y.EuiLoadingSpinner,{size:"m"}):a)))))),r.a.createElement(Y.EuiHorizontalRule,{margin:"m"}))},yc={total:W.i18n.translate("xpack.infra.metrics.nodeDetails.processes.headingTotalProcesses",{defaultMessage:"Total processes"}),...tc};var Ec=Fa()(Y.EuiDescriptionListTitle).withConfig({displayName:"_StyledEuiDescriptionListTitle",componentId:"sc-f4sgrc-0"})(["white-space:nowrap;"]);const vc=()=>{const{getDateRangeInTimestamp:e}=Rr(),t=new Date(e().to);return r.a.createElement(Y.EuiText,{size:"xs",color:"subdued"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.overview.processesSectionTitle",defaultMessage:"Showing process data collected for the 1 minute preceding {date} @ {time}",values:{date:r.a.createElement(X.FormattedDate,{value:t,month:"short",day:"numeric",year:"numeric"}),time:r.a.createElement(X.FormattedTime,{value:t,hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"})}}))},xc=r.a.memo((()=>r.a.createElement(Nr,{"aria-label":W.i18n.translate("xpack.infra.metrics.nodeDetails.processesHeader.tooltipLabel",{defaultMessage:"More info"}),iconSize:"m",icon:"iInCircle","data-test-subj":"infraAssetDetailsProcessesPopoverButton"},r.a.createElement(Y.EuiText,{size:"xs",style:{width:300}},r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.processes.tooltip.topProcesses",defaultMessage:"The processes listed are based on an aggregation of the top CPU and the top memory consuming processes. It does not show all processes."})),r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.processes.tooltip.label",defaultMessage:"The number of top processes is configurable in the {systemIntegration}.",values:{systemIntegration:r.a.createElement(Y.EuiLink,{"data-test-subj":"infraAssetDetailsTooltipSystemIntegrationDocumentationLink",href:"https://docs.elastic.co/en/integrations/system",target:"_blank"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.processes.tooltip.systemIntegrationDocumentationLink",defaultMessage:"System Integration"}))}})),r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.processes.tooltip.documentationLabel",defaultMessage:"Please see the following {documentation} for more details on processes.",values:{documentation:r.a.createElement(Y.EuiLink,{"data-test-subj":"infraAssetDetailsTooltipDocumentationLink",href:"https://www.elastic.co/guide/en/observability/current/view-infrastructure-metrics.html",target:"_blank"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.processes.tooltip.documentationLink",defaultMessage:"documentation"}))}})))))),wc=Object.entries(tc).map((([e,t])=>({value:e,view:t}))),kc=()=>{var e,t,a,i;const s=Object(n.useRef)(null),{request$:l}=ml(),{getDateRangeInTimestamp:o}=Rr(),[c,d]=Tr(),{asset:m}=hl(),[p,g]=Object(n.useState)(null!==(e=null==c?void 0:c.processSearch)&&void 0!==e?e:""),[f,b]=Object(n.useState)(null),[h,y]=Object(n.useState)((()=>p?Y.Query.parse(p):Y.Query.MATCH_ALL)),E=Object(n.useMemo)((()=>o().to),[o]),v=yl(s,{currentTimestamp:E}),[O,M]=Object(n.useState)({name:"cpu",isAscending:!1}),j=Object(n.useMemo)((()=>{var e;return{[null!==(e=Object(u.getFieldByType)(m.type))&&void 0!==e?e:m.type]:m.name}}),[m.name,m.type]),{loading:S,error:C,response:T,makeRequest:I}=function(e,t,a,r,i){const{createDerivedIndexPattern:s}=Object(re.b)(),l=s().title,o="runtimeLength"===a.name?{...a,name:"startTime"}:a,{error:c,loading:u,response:d,makeRequest:m}=Object(ol.a)("/api/metrics/process_list","POST",JSON.stringify({hostTerm:e,indexPattern:l,to:t,sortBy:o,searchFilter:r}),(e=>Object(x.pipe)(Po.m.decode(e),Object(w.fold)(Object(pi.d)(pi.a),k.identity))),void 0,void 0,!0);return Object(n.useEffect)((()=>{i?i.next(m):m()}),[m,i]),{error:c&&c.message||null,loading:u,response:d,makeRequest:m}}(j,v.currentTimestamp,O,(e=>{if(""===e.trim())return[{match_all:{}}];const t=e.split(" ").map((e=>e.trim())).filter(Boolean),a=t.filter((e=>e.startsWith("state=")));return[...t.filter((e=>!e.startsWith("state="))).map((e=>({query_string:{fields:["system.process.cmdline"],query:`*${jo(e)}*`,minimum_should_match:1}}))),...a.map((e=>({match:{"system.process.state":e.replace("state=","")}})))]})(p),l),F=Object(n.useMemo)((()=>Object(Ne.debounce)((e=>{g(e)}),500)),[]),L=Object(n.useCallback)((({query:e,queryText:t,error:a})=>{a?b(a):(d({processSearch:t}),b(null),y(e),F(t))}),[F,d]),P=Object(n.useCallback)((()=>{y(Y.Query.MATCH_ALL),d({processSearch:""}),b(null),g("")}),[d]);return r.a.createElement(_o,{hostTerm:j,to:v.currentTimestamp},r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"m",ref:s},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(hc,{isLoading:S&&!T,processSummary:null!==(t=C?null:null==T?void 0:T.summary)&&void 0!==t?t:{total:0}})),r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"xs"},r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiTitle,{"data-test-subj":"infraAssetDetailsTopProcessesTitle",size:"xxs"},r.a.createElement("span",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metrics.nodeDetails.processesHeader",defaultMessage:"Top processes"})))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(xc,null))),!C&&r.a.createElement(Y.EuiFlexGroup,{alignItems:"flexStart"},r.a.createElement(Y.EuiFlexItem,null,S&&!T?r.a.createElement(Y.EuiLoadingSpinner,null):(null!==(a=null==T?void 0:T.processList)&&void 0!==a?a:[]).length>0&&r.a.createElement(vc,null)))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiSearchBar,{query:h,onChange:L,box:{"data-test-subj":"infraAssetDetailsProcessesSearchBarInput",incremental:!0,placeholder:W.i18n.translate("xpack.infra.metrics.nodeDetails.searchForProcesses",{defaultMessage:"Search for processes…"})},filters:[{type:"field_value_selection",field:"state",name:"State",operator:"exact",multiSelect:!1,options:wc}]})),r.a.createElement(Y.EuiFlexItem,{grow:!1},C?r.a.createElement(Y.EuiEmptyPrompt,{iconType:"warning",title:r.a.createElement("h4",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metrics.nodeDetails.processListError",defaultMessage:"Unable to load process data"})),actions:r.a.createElement(Y.EuiButton,{"data-test-subj":"infraAssetDetailsTabComponentTryAgainButton",color:"primary",fill:!0,onClick:I},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metrics.nodeDetails.processListRetry",defaultMessage:"Try again"}))}):r.a.createElement(ic,{currentTime:v.currentTimestamp,isLoading:S||!T,processList:null!==(i=null==T?void 0:T.processList)&&void 0!==i?i:[],sortBy:O,error:null==f?void 0:f.message,setSortBy:M,clearSearchBar:P}))))};function Oc(){return r.a.createElement(Y.EuiEmptyPrompt,{color:"warning",iconType:"warning",titleSize:"xs",title:r.a.createElement("h2",null,W.i18n.translate("xpack.infra.profiling.loadErrorTitle",{defaultMessage:"Unable to load the Profiling data"})),body:r.a.createElement("p",null,W.i18n.translate("xpack.infra.profiling.loadErrorBody",{defaultMessage:"There was an error while trying to load profiling data. Try refreshing the page"}))})}const Mc="https://ela.st/profiling-feedback";function jc({hostname:e,from:t,to:a,profilingLinkLocator:n,profilingLinkLabel:i}){const s=n.getRedirectUrl({kuery:`${Re.b}:"${e}"`,rangeFrom:t,rangeTo:a});return r.a.createElement(Y.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiLink,{"data-test-subj":"infraFlamegraphTestLink",href:s},i)),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiLink,{"data-test-subj":"infraFlamegraphTestLink",href:Mc,external:!0},W.i18n.translate("xpack.infra.flamegraph.profilingFeedbackLink",{defaultMessage:"Give feedback"}))))}function Sc(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiSpacer,null),r.a.createElement(Y.EuiEmptyPrompt,{color:"subdued",iconType:"search",titleSize:"xs",title:r.a.createElement("h2",null,W.i18n.translate("xpack.infra.profiling.emptyDataPromptTitle",{defaultMessage:"No data found"})),body:r.a.createElement("p",null,W.i18n.translate("xpack.infra.profiling.emptyDataPromptBody",{defaultMessage:"Make sure this host is sending profiling data or try selecting a different date range."}))}))}function Cc(){const{services:e}=Object(ge.b)(),{asset:t}=hl(),{activeTabId:a}=Jr(),{dateRange:i,getDateRangeInTimestamp:s}=Rr(),{from:l,to:o}=s(),c=e.observabilityShared.locators.profiling.flamegraphLocator,u=W.i18n.translate("xpack.infra.flamegraph.profilingAppFlamegraphLink",{defaultMessage:"Go to Universal Profiling Flamegraph"}),d=Object(n.useMemo)((()=>({hostname:t.name,from:l,to:o})),[t.name,l,o]),{error:m,loading:p,response:g}=function({params:e,isActive:t}){const{request$:a}=ml(),r=Object(n.useMemo)((()=>({query:e})),[e]),{loading:i,error:s,response:l,makeRequest:o}=Object(ol.a)("/api/infra/profiling/flamegraph","GET",void 0,void 0,void 0,void 0,!0,r);return Object(n.useEffect)((()=>{t&&a.next(o)}),[t,o,a]),{loading:i,error:s,response:l}}({isActive:a===R.PROFILING,params:d});return null!==m?r.a.createElement(Oc,null):p||0!==(null==g?void 0:g.TotalSamples)?r.a.createElement(r.a.Fragment,null,r.a.createElement(jc,{hostname:t.name,from:i.from,to:i.to,profilingLinkLocator:c,profilingLinkLabel:u}),r.a.createElement(Y.EuiSpacer,null),r.a.createElement(me.EmbeddableFlamegraph,{data:null!=g?g:void 0,isLoading:p,height:"60vh"})):r.a.createElement(Sc,null)}function Tc(){const{services:e}=Object(ge.b)(),{asset:t}=hl(),{activeTabId:a}=Jr(),{dateRange:i,getDateRangeInTimestamp:s}=Rr(),{from:l,to:o}=s(),c=e.observabilityShared.locators.profiling.topNFunctionsLocator,u=W.i18n.translate("xpack.infra.flamegraph.profilingAppTopFunctionsLink",{defaultMessage:"Go to Universal Profiling Functions"}),d=Object(n.useMemo)((()=>({hostname:t.name,from:l,to:o,startIndex:0,endIndex:10})),[t.name,l,o]),{error:m,loading:p,response:g}=function({params:e,isActive:t}){const{request$:a}=ml(),r=Object(n.useMemo)((()=>({query:e})),[e]),{loading:i,error:s,response:l,makeRequest:o}=Object(ol.a)("/api/infra/profiling/functions","GET",void 0,void 0,void 0,void 0,!0,r);return Object(n.useEffect)((()=>{t&&a.next(o)}),[t,o,a]),{loading:i,error:s,response:l}}({isActive:a===R.PROFILING,params:d});return null!==m?r.a.createElement(Oc,null):p||0!==(null==g?void 0:g.TotalCount)?r.a.createElement(r.a.Fragment,null,r.a.createElement(jc,{hostname:t.name,from:i.from,to:i.to,profilingLinkLocator:c,profilingLinkLabel:u}),r.a.createElement(Y.EuiSpacer,null),r.a.createElement(me.EmbeddableFunctions,{data:null!=g?g:void 0,isLoading:p,rangeFrom:l,rangeTo:o})):r.a.createElement(Sc,null)}const Ic="infra-profiling-description-callout-dismissed";function Fc(){const[e,t]=_a()(Ic,!1),a=Object(n.useCallback)((()=>t(!0)),[t]);return e?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiCallOut,{title:W.i18n.translate("xpack.infra.profiling.descriptionCallout.title",{defaultMessage:"Displaying Resource Consumption for this Host"}),iconType:"iInCircle"},r.a.createElement(Y.EuiText,null,W.i18n.translate("xpack.infra.profiling.descriptionCallout.body",{defaultMessage:"Universal Profiling helps you optimize resource usage and find performance bottlenecks by showing which lines of code are consuming resources on your host, down to the application code, kernel, and third-party libraries."})),r.a.createElement(Y.EuiSpacer,null),r.a.createElement(Y.EuiFlexGroup,{alignItems:"center"},r.a.createElement(Y.EuiLink,{"data-test-subj":"infraProfilingDescriptionCalloutLearnMoreLink",href:"https://www.elastic.co/guide/en/observability/current/profiling-get-started.html",external:!0,target:"_blank"},W.i18n.translate("xpack.infra.profiling.descriptionCallout.learnMore",{defaultMessage:"Learn more"})),r.a.createElement(Y.EuiButton,{"data-test-subj":"infraDescriptionCalloutDismissButton",onClick:a},W.i18n.translate("xpack.infra.profiling.descriptionCallout.dismiss",{defaultMessage:"Dismiss"})))),r.a.createElement(Y.EuiSpacer,null))}function Lc(){const{activeTabId:e}=Jr(),{error:t,loading:a,response:i}=function({isActive:e}){const{request$:t}=ml(),{loading:a,error:r,response:i,makeRequest:s}=Object(ol.a)("/api/infra/profiling/status","GET",void 0,void 0,void 0,void 0,!0);return Object(n.useEffect)((()=>{e&&t.next(s)}),[e,s,t]),{loading:a,error:r,response:i}}({isActive:e===R.PROFILING}),s=[{id:"flamegraph",name:W.i18n.translate("xpack.infra.profiling.flamegraphTabName",{defaultMessage:"Flamegraph"}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiSpacer,null),r.a.createElement(Cc,null)),append:r.a.createElement(Nr,{iconSize:"s",iconColor:"subdued",icon:"questionInCircle"},r.a.createElement(Y.EuiText,{size:"xs"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.profiling.flamegraphInfoPopoverBody",defaultMessage:"See a visual representation of the functions that consume the most resources. Each rectangle represents a function. The rectangle width represents the time spent in the function, and the number of stacked rectangles represents the number of functions called to reach the current function. {learnMoreLink}",values:{learnMoreLink:r.a.createElement(Y.EuiLink,{"data-test-subj":"infraProfilingFlamegraphTabLearnMoreLink",href:"https://www.elastic.co/guide/en/observability/current/universal-profiling.html#profiling-flamegraphs-intro",external:!0,target:"_blank"},W.i18n.translate("xpack.infra.profiling.flamegraphTabLearnMoreLink",{defaultMessage:"Learn more"}))}})))},{id:"functions",name:W.i18n.translate("xpack.infra.tabs.profiling.functionsTabName",{defaultMessage:"Top 10 Functions"}),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiSpacer,null),r.a.createElement(Tc,null)),append:r.a.createElement(Nr,{iconSize:"s",iconColor:"subdued",icon:"questionInCircle"},r.a.createElement(Y.EuiText,{size:"xs"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.profiling.functionsInfoPopoverBody",defaultMessage:"Identify the most expensive lines of code on your host by looking at the most frequently sampled functions, broken down by CPU time, annualized CO2, and annualized cost estimates. {learnMoreLink}",values:{learnMoreLink:r.a.createElement(Y.EuiLink,{"data-test-subj":"infraProfilingFunctionsTabLearnMoreLink",href:"https://www.elastic.co/guide/en/observability/current/universal-profiling.html#profiling-functions-intro",external:!0,target:"_blank"},W.i18n.translate("xpack.infra.profiling.functionsTabLearnMoreLink",{defaultMessage:"Learn more"}))}})))}];return a?r.a.createElement(Pc,null,r.a.createElement(Y.EuiLoadingSpinner,{size:"m"})):null!==t?r.a.createElement(Oc,null):r.a.createElement(r.a.Fragment,null,!1===(null==i?void 0:i.has_setup)?r.a.createElement(me.ProfilingEmptyState,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(qr,null),r.a.createElement(Fc,null),r.a.createElement(Y.EuiTabbedContent,{tabs:s,initialSelectedTab:s[0]})))}var Pc=Fa()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1ay9uql-0"})(["display:flex;justify-content:center;"]);const Dc=Object(n.createContext)(void 0),_c=()=>{const e=Object(n.useContext)(Dc);if(void 0===e)throw new Error("PluginConfigContext value was not initialized. Use context provider to set the value before using it.");return e},Rc=Dc.Provider,Ac=()=>{var e,t,a;const{metadata:i,loading:s}=gl(),l=Object(n.useRef)(void 0);null!=i&&null!==(e=i.info)&&void 0!==e&&null!==(t=e.agent)&&void 0!==t&&t.id&&!l.current&&(l.current=i.info.agent.id);const{featureFlags:o}=_c();return o.osqueryEnabled?s&&!i?r.a.createElement(Y.EuiSkeletonText,{lines:10}):r.a.createElement(Bc,{agentId:null!==(a=l.current)&&void 0!==a?a:"_na"}):null},Bc=r.a.memo((({agentId:e})=>{const{services:{osquery:t}}=Object(ge.b)(),a=null==t?void 0:t.OsqueryAction;return a?r.a.createElement(a,{agentId:e,hideAgentsField:!0,formType:"simple"}):r.a.createElement(Y.EuiSkeletonText,{lines:10})}));var Vc=a(155),Nc=a.n(Vc),zc=a(157),$c=a(42),qc=a(6),Uc=a(117),Gc=a.n(Uc);const Hc=({id:e,extraFields:t=[]})=>{const{services:{logsShared:a}}=Object(ge.b)(),{loading:r,value:i}=Gc()((()=>a.logViews.client.getLogView(qc.DEFAULT_LOG_VIEW)),[]),s=Hr((()=>i?{type:"log-view-inline",id:e,attributes:{name:"Hosts Logs View",description:"Default view for hosts logs tab",logIndices:i.attributes.logIndices,logColumns:[{timestampColumn:{id:"5e7f964a-be8a-40d8-88d2-fbcfbdca0e2f"}},...t.map((e=>({fieldColumn:{id:Object(Xe.v4)(),field:e}}))),{messageColumn:{id:"b645d6da-824b-4723-9a2a-e8cece1645c0"}}]}}:null)),l=Object(n.useCallback)((async e=>{if(e)return(await a.logViews.client.getResolvedLogView(e)).dataViewReference}),[a.logViews.client]);return{logViewReference:s.current,loading:r,getLogsDataView:l}},[Wc,Qc]=f()((({metricAlias:e})=>{const{dataView:t,loading:a}=wl({metricAlias:e}),{logViewReference:n,getLogsDataView:r,loading:i}=Hc({id:"asset-details-logs-view"}),{value:s,loading:l}=Gc()((()=>r(n)),[n]);return{metrics:{dataView:t,loading:a},logs:{dataView:s,reference:n,loading:i||l}}})),Jc=()=>{var e,t;const a=Object(n.useRef)(null),{getDateRangeInTimestamp:i,dateRange:s,autoRefresh:l}=Rr(),[o,c]=Tr(),{asset:d}=hl(),{logs:m}=Qc(),{loading:p,reference:g}=null!=m?m:{},{services:f}=Object(ge.b)(),{locators:b}=f,[h,y]=Object(n.useState)(null!==(e=null==o?void 0:o.logsSearch)&&void 0!==e?e:""),[E,v]=Object(n.useState)(null!==(t=null==o?void 0:o.logsSearch)&&void 0!==t?t:""),x=i().to,w=yl(a,{currentTimestamp:x,startTimestamp:x-36e5,dateRange:s,autoRefresh:l});Nc()((()=>{c({logsSearch:h}),v(h)}),500,[h]);const k=Object(n.useMemo)((()=>({language:"kuery",query:[`${Object(u.findInventoryFields)(d.type).id}: "${d.name}"`,...""!==E?[E]:[]].join(" and ")})),[d.type,d.name,E]),O=Object(n.useCallback)((e=>{y(e.target.value)}),[]),M=Object(n.useMemo)((()=>g||qc.DEFAULT_LOG_VIEW),[g]),j=Object(n.useMemo)((()=>b.nodeLogsLocator.getRedirectUrl({nodeType:d.type,nodeId:d.name,time:w.startTimestamp,filter:E,logView:M})),[b.nodeLogsLocator,d.name,d.type,w.startTimestamp,E,M]);return r.a.createElement(Y.EuiFlexGroup,{direction:"column","data-test-subj":"infraAssetDetailsLogsTabContent",ref:a},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiFlexGroup,{gutterSize:"m",alignItems:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiFieldSearch,{"data-test-subj":"infraAssetDetailsLogsTabFieldSearch",fullWidth:!0,placeholder:W.i18n.translate("xpack.infra.nodeDetails.logs.textFieldPlaceholder",{defaultMessage:"Search for log entries..."}),value:h,isClearable:!0,onChange:O})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(zc.a,{coreStart:f},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraAssetDetailsLogsTabOpenInLogsButton",size:"xs",flush:"both",iconType:"popout",href:j},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.nodeDetails.logs.openLogsLink",defaultMessage:"Open in Logs"})))))),r.a.createElement(Y.EuiFlexItem,null,p||!g?r.a.createElement(loading_InfraLoadingPanel,{width:"100%",height:"60vh",text:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.tabs.logs.loadingEntriesLabel",defaultMessage:"Loading entries"})}):r.a.createElement($c.LogStream,{logView:M,startTimestamp:w.startTimestamp,endTimestamp:w.currentTimestamp,startDateExpression:w.autoRefresh&&!w.autoRefresh.isPaused?w.dateRange.from:void 0,endDateExpression:w.autoRefresh&&!w.autoRefresh.isPaused?w.dateRange.to:void 0,query:k,height:"60vh",showFlyoutAction:!0,isStreaming:w.autoRefresh&&!w.autoRefresh.isPaused})))},Kc={hostIp:W.i18n.translate("xpack.infra.assetDetailsEmbeddable.overview.metadataHostIpHeading",{defaultMessage:"Host IP"}),hostOsVersion:W.i18n.translate("xpack.infra.assetDetailsEmbeddable.overview.metadataHostOsVersionHeading",{defaultMessage:"Host OS version"}),cloudProvider:W.i18n.translate("xpack.infra.assetDetailsEmbeddable.overview.metadataCloudProviderHeading",{defaultMessage:"Cloud provider"}),operatingSystem:W.i18n.translate("xpack.infra.assetDetailsEmbeddable.overview.metadataOperatingSystemHeading",{defaultMessage:"Operating system"})},Yc=({metadataValue:e})=>r.a.createElement(Xc,null,r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},Kc[e.field]),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Nr,{icon:"iInCircle","data-test-subj":"infraAssetDetailsMetadataSummaryPopoverButton"},r.a.createElement(Y.EuiText,{size:"xs"},e.tooltipLink?r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.overviewMetadata.tooltip.documentationLabel",defaultMessage:"See {documentation} for more details.",values:{documentation:r.a.createElement(Y.EuiLink,{"data-test-subj":"infraAssetDetailsTooltipMetadataDocumentationLink",href:e.tooltipLink,target:"_blank"},r.a.createElement("code",null,e.tooltipFieldLabel))}}):r.a.createElement("code",null,e.tooltipFieldLabel))))));var Xc=Fa()(Y.EuiDescriptionListTitle).withConfig({displayName:"_StyledEuiDescriptionListTitle",componentId:"sc-vfsd2t-0"})(["white-space:nowrap;"]);const Zc="layer",eu="infra_lens_ad_hoc_default",tu=10;function au(e){return null!=e}const nu=({columnName:e,options:t})=>{var a,n;const{interval:r="auto",...i}=null!==(a=null==t?void 0:t.params)&&void 0!==a?a:{};return{[e]:{dataType:"date",isBucketed:!0,label:"@timestamp",operationType:"date_histogram",scale:"interval",sourceField:null!==(n=null==t?void 0:t.sourceField)&&void 0!==n?n:"@timestamp",params:{interval:r,...i}}}},ru=({columnName:e,field:t,options:a})=>{const{size:n=tu,...r}=null!=a?a:{};return{[e]:{label:`Top ${n} values of ${t}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:t,isBucketed:!0,params:{size:n,orderBy:{type:"alphabetical",fallback:!1},orderDirection:"asc",otherBucket:!1,missingBucket:!1,parentFormat:{id:"terms"},include:[],exclude:[],includeIsRegex:!1,excludeIsRegex:!1,...r}}}},iu=(e,t)=>{var a;return[{type:"index-pattern",id:null!==(a=e.id)&&void 0!==a?a:eu,name:`indexpattern-datasource-layer-${t}`}]},su="formula_accessor";class xy_chart_XYChart{constructor(e){Ua()(this,"_layers",null),this.chartConfig=e}getVisualizationType(){return"lnsXY"}get layers(){return this._layers||(this._layers=Array.isArray(this.chartConfig.layers)?this.chartConfig.layers:[this.chartConfig.layers]),this._layers}getLayers(){return this.layers.reduce(((e,t,a)=>{const n=`${Zc}_${a}`,r=`${su}_${a}`;return{...e,...t.getLayer(n,r,this.chartConfig.dataView,this.chartConfig.formulaAPI)}}),{})}getVisualizationState(){var e,t,a,n,r,i,s,l,o,c,u;return{...lu({layers:[...this.chartConfig.layers.map(((e,t)=>{const a=`${Zc}_${t}`,n=`${su}_${t}`;return e.getLayerConfig(a,n)}))]}),legend:null!==(e=null===(t=this.chartConfig.visualOptions)||void 0===t?void 0:t.legend)&&void 0!==e?e:{isVisible:!1,position:"right",showSingleSeries:!1},fittingFunction:null!==(a=null===(n=this.chartConfig.visualOptions)||void 0===n?void 0:n.missingValues)&&void 0!==a?a:"None",endValue:null===(r=this.chartConfig.visualOptions)||void 0===r?void 0:r.endValues,curveType:null===(i=this.chartConfig.visualOptions)||void 0===i?void 0:i.lineInterpolation,emphasizeFitting:!(null!==(s=this.chartConfig.visualOptions)&&void 0!==s&&s.showDottedLine),valueLabels:null===(l=this.chartConfig.visualOptions)||void 0===l?void 0:l.valueLabels,axisTitlesVisibilitySettings:null!==(o=null===(c=this.chartConfig.visualOptions)||void 0===c?void 0:c.axisTitlesVisibilitySettings)&&void 0!==o?o:{x:!1,yLeft:!1,yRight:!0},yLeftExtent:null===(u=this.chartConfig.visualOptions)||void 0===u?void 0:u.yLeftExtent}}getReferences(){return this.layers.flatMap(((e,t)=>{const a=`${Zc}_${t}`;return e.getReference(a,this.chartConfig.dataView)}))}getDataViews(){return[this.chartConfig.dataView,...this.chartConfig.layers.map((e=>e.getDataView())).filter((e=>!!e))]}getTitle(){var e,t;return null!==(e=null!==(t=this.chartConfig.title)&&void 0!==t?t:this.layers[0].getName())&&void 0!==e?e:""}}const lu=e=>({legend:{isVisible:!1,position:"right",showSingleSeries:!1},valueLabels:"show",yLeftScale:"linear",tickLabelsVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},labelsOrientation:{x:0,yLeft:0,yRight:0},gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},preferredSeriesType:"line",valuesInLegend:!1,hideEndzones:!0,...e}),ou="metric_formula_accessor";class metric_chart_MetricChart{constructor(e){this.chartConfig=e}getVisualizationType(){return"lnsMetric"}getLayers(){return this.chartConfig.layers.getLayer(Zc,ou,this.chartConfig.dataView,this.chartConfig.formulaAPI)}getVisualizationState(){return this.chartConfig.layers.getLayerConfig(Zc,ou)}getReferences(){return this.chartConfig.layers.getReference(Zc,this.chartConfig.dataView)}getDataViews(){return[this.chartConfig.dataView,this.chartConfig.layers.getDataView()].filter((e=>!!e))}getTitle(){var e;return null!==(e=this.chartConfig.title)&&void 0!==e?e:""}}class FormulaColumn{constructor(e){this.valueConfig=e}getValueConfig(){return this.valueConfig}getData(e,t,a,n){const{value:r,...i}=this.getValueConfig(),s=n.insertOrReplaceFormulaColumn(e,{formula:r,...i},t,a);if(!s)throw new Error("Error generating the data layer for the chart");return s}}const cu="x_date_histogram";class metric_layer_MetricLayer{constructor(e){var t;Ua()(this,"column",void 0),Ua()(this,"layerConfig",void 0),this.column=new FormulaColumn(e.data),this.layerConfig={...e,layerType:null!==(t=e.layerType)&&void 0!==t?t:"metricTrendline"}}getLayer(e,t,a,n){var r,i,s,l;const o={columnOrder:[cu],columns:nu({columnName:cu,options:{sourceField:(null!==(r=this.layerConfig.dataView)&&void 0!==r?r:a).timeFieldName,params:{interval:"auto",includeEmptyRows:!0}}}),sampling:1};return{[e]:{...this.column.getData(t,{columnOrder:[],columns:{}},null!==(i=this.layerConfig.dataView)&&void 0!==i?i:a,n)},...null!==(s=this.layerConfig.options)&&void 0!==s&&s.showTrendLine?{[`${e}_trendline`]:{linkToLayers:[e],...this.column.getData(`${t}_trendline`,o,null!==(l=this.layerConfig.dataView)&&void 0!==l?l:a,n)}}:{}}}getReference(e,t){var a,n;return[...iu(null!==(a=this.layerConfig.dataView)&&void 0!==a?a:t,e),...iu(null!==(n=this.layerConfig.dataView)&&void 0!==n?n:t,`${e}_trendline`)]}getLayerConfig(e,t){var a;const{subtitle:n,backgroundColor:r,showTrendLine:i}=null!==(a=this.layerConfig.options)&&void 0!==a?a:{};return{layerId:e,layerType:"data",metricAccessor:t,color:r,subtitle:n,showBar:!1,...i?{trendlineLayerId:`${e}_trendline`,trendlineLayerType:"metricTrendline",trendlineMetricAccessor:`${t}_trendline`,trendlineTimeAccessor:cu}:{}}}getName(){return this.column.getValueConfig().label}getDataView(){return this.layerConfig.dataView}}const uu="aggs_breakdown",du="x_date_histogram";class xy_data_layer_XYDataLayer{constructor(e){var t,a;Ua()(this,"column",void 0),Ua()(this,"layerConfig",void 0),this.column=e.data.map((e=>new FormulaColumn(e))),this.layerConfig={...e,layerType:null!==(t=e.layerType)&&void 0!==t?t:"data",options:{...e.options,buckets:{type:"date_histogram",...null===(a=e.options)||void 0===a?void 0:a.buckets}}}}getName(){return this.column[0].getValueConfig().label}getBaseLayer(e,t){var a,n,r;return{..."date_histogram"===(null===(a=t.buckets)||void 0===a?void 0:a.type)?nu({columnName:du,options:{params:{...t.buckets.params},sourceField:null!==(n=t.buckets.field)&&void 0!==n?n:e.timeFieldName}}):{},..."top_values"===(null===(r=t.breakdown)||void 0===r?void 0:r.type)?{...ru({columnName:uu,field:null==t?void 0:t.breakdown.field,options:{...t.breakdown.params}})}:{}}}getLayer(e,t,a,n){var r,i,s,l,o,c;const u=[];"top_values"===(null===(r=this.layerConfig.options)||void 0===r||null===(i=r.breakdown)||void 0===i?void 0:i.type)&&u.push(uu),"date_histogram"===(null===(s=this.layerConfig.options)||void 0===s||null===(l=s.buckets)||void 0===l?void 0:l.type)&&u.push(du);const d={columnOrder:u,columns:{...this.getBaseLayer(null!==(o=this.layerConfig.dataView)&&void 0!==o?o:a,null!==(c=this.layerConfig.options)&&void 0!==c?c:{})}};return{[e]:this.column.reduce(((e,r,i)=>{var s;return{...e,...r.getData(`${t}_${i}`,e,null!==(s=this.layerConfig.dataView)&&void 0!==s?s:a,n)}}),d)}}getReference(e,t){var a;return iu(null!==(a=this.layerConfig.dataView)&&void 0!==a?a:t,e)}getLayerConfig(e,t){var a,n,r,i,s,l;return{layerId:e,seriesType:null!==(a=null===(n=this.layerConfig.options)||void 0===n?void 0:n.seriesType)&&void 0!==a?a:"line",accessors:this.column.map(((e,a)=>`${t}_${a}`)),yConfig:this.layerConfig.data.map((({color:e},a)=>e?{forAccessor:`${t}_${a}`,color:e}:void 0)).filter(au),layerType:"data",xAccessor:"date_histogram"===(null===(r=this.layerConfig.options)||void 0===r||null===(i=r.buckets)||void 0===i?void 0:i.type)?du:void 0,splitAccessor:"top_values"===(null===(s=this.layerConfig.options)||void 0===s||null===(l=s.breakdown)||void 0===l?void 0:l.type)?uu:void 0}}getDataView(){return this.layerConfig.dataView}}class StaticColumn{constructor(e){this.valueConfig=e}getValueConfig(){return this.valueConfig}getData(e,t){const{label:a,...n}=this.getValueConfig();return{linkToLayers:[],columnOrder:[...t.columnOrder,e],columns:{[e]:{label:null!=a?a:"Reference",dataType:"number",operationType:"static_value",isStaticValue:!0,isBucketed:!1,scale:"ratio",params:n,references:[],customLabel:!0}},sampling:1,incompleteColumns:{}}}}class xy_reference_lines_layer_XYReferenceLinesLayer{constructor(e){var t;Ua()(this,"column",void 0),Ua()(this,"layerConfig",void 0),this.column=e.data.map((e=>new StaticColumn(e))),this.layerConfig={...e,layerType:null!==(t=e.layerType)&&void 0!==t?t:"referenceLine"}}getName(){return this.column[0].getValueConfig().label}getLayer(e,t){return{[`${e}_reference`]:this.column.reduce(((e,a,n)=>({...e,...a.getData(`${t}_${n}_reference_column`,e)})),{columnOrder:[],columns:{}})}}getReference(e,t){var a;return iu(null!==(a=this.layerConfig.dataView)&&void 0!==a?a:t,`${e}_reference`)}getLayerConfig(e,t){return{layerId:`${e}_reference`,layerType:"referenceLine",accessors:this.column.map(((e,a)=>`${t}_${a}_reference_column`)),yConfig:this.column.map(((e,a)=>({color:e.getValueConfig().color,forAccessor:`${t}_${a}_reference_column`,axisMode:"left",fill:e.getValueConfig().fill})))}}getDataView(){return this.layerConfig.dataView}}class data_view_cache_DataViewCache{constructor(e){Ua()(this,"cache",new Map),Ua()(this,"capacity",void 0),this.capacity=e,this.cache=new Map}static getInstance(e=10){return data_view_cache_DataViewCache.instance||(data_view_cache_DataViewCache.instance=new data_view_cache_DataViewCache(e)),data_view_cache_DataViewCache.instance}getSpec(e){var t;const a=null!==(t=e.id)&&void 0!==t?t:"lens_ad_hoc_default",n=this.cache.get(a);if(!n){const t=e.toSpec();return this.setSpec(a,t),t}return n}setSpec(e,t){if(this.cache.size>=this.capacity){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t)}}Ua()(data_view_cache_DataViewCache,"instance",void 0);class lens_attributes_builder_LensAttributesBuilder{constructor(e){Ua()(this,"dataViewCache",void 0),this.lens=e,this.dataViewCache=data_view_cache_DataViewCache.getInstance()}build(){const{visualization:e}=this.lens;return{title:e.getTitle(),visualizationType:e.getVisualizationType(),references:e.getReferences(),state:{datasourceStates:{formBased:{layers:e.getLayers()}},internalReferences:e.getReferences(),filters:[],query:{language:"kuery",query:""},visualization:e.getVisualizationState(),adHocDataViews:(t=e.getDataViews().reduce(((e,t)=>({...e,...this.dataViewCache.getSpec(t)})),{}),{[null!==(a=t.id)&&void 0!==a?a:eu]:{...t}})}};var t,a}}const mu=({dataView:e,formulaAPI:t,...a})=>{switch(a.visualizationType){case"lnsXY":if(!Array.isArray(a.layers))throw new Error("Invalid layers type. Expected an array of layers.");const n=e=>{switch(e.layerType){case"data":return new xy_data_layer_XYDataLayer(e);case"referenceLine":return new xy_reference_lines_layer_XYReferenceLinesLayer(e);default:throw new Error("Invalid layer type")}},{layers:r,...i}=a;return new xy_chart_XYChart({dataView:e,formulaAPI:t,layers:r.map((e=>n(e))),...i});case"lnsMetric":if(Array.isArray(a.layers))throw new Error("Invalid layer type. Expected a single layer object.");return new metric_chart_MetricChart({dataView:e,formulaAPI:t,layers:new metric_layer_MetricLayer({data:a.layers.data,options:{...a.layers.options},layerType:a.layers.layerType}),title:a.title});default:throw new Error("Unsupported chart type")}};var pu=a(55);const gu=({hasTopMargin:e=!1})=>{const{euiTheme:t}=Object(Y.useEuiTheme)();return r.a.createElement(bu,{size:"xs",color:"accent",position:"absolute",$_css:e?t.size.l:0,$_css2:Number(t.levels.header)-1})},fu=({style:e})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(gu,{hasTopMargin:!1}),r.a.createElement(Y.EuiFlexGroup,{style:e,justifyContent:"center",alignItems:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiLoadingChart,{mono:!0,size:"l"}))));var bu=Fa()(Y.EuiProgress).withConfig({displayName:"_StyledEuiProgress",componentId:"sc-1dy7w6g-0"})(["top:",";z-index:",";"],(e=>e.$_css),(e=>e.$_css2));const hu=({attributes:e,dateRange:t,filters:a,searchSessionId:i,loading:s=!1,onLoad:l,query:o,...c})=>{const{euiTheme:u}=Object(Y.useEuiTheme)(),[d,m]=Object(n.useState)(),[p,g]=Object(n.useState)(!1),[f,b]=Object(n.useState)({attributes:e,dateRange:t,filters:a,query:o,searchSessionId:i}),h=Object(n.useRef)(null),y=Object(n.useRef)(new IntersectionObserver((([e])=>m(e)),{root:h.current}));Object(n.useEffect)((()=>{const{current:e}=y;e.disconnect();const{current:t}=h;return t&&e.observe(t),()=>e.disconnect()}),[h]),Object(n.useEffect)((()=>{null!=d&&d.isIntersecting&&b({attributes:e,dateRange:t,filters:a,query:o,searchSessionId:i})}),[e,t,a,null==d?void 0:d.isIntersecting,o,i]);const E=Object(n.useCallback)((e=>{p||g(!0),l&&l(e)}),[p,l]),v=s||!f.attributes;return r.a.createElement(Eu,{ref:h,$_css:u.border.radius.medium},r.a.createElement(r.a.Fragment,null,v&&!p?r.a.createElement(fu,{style:c.style}):r.a.createElement(r.a.Fragment,null,v&&r.a.createElement(gu,{hasTopMargin:!c.hidePanelTitles}),r.a.createElement(yu,de()({},c,{searchSessionId:f.searchSessionId,attributes:f.attributes,filters:f.filters,onLoad:E,query:f.query,timeRange:t,viewMode:pu.ViewMode.VIEW})))))},yu=r.a.memo((({attributes:e,...t})=>{const{services:{lens:a}}=Object(ge.b)(),n=a.EmbeddableComponent;return e?r.a.createElement(n,de()({},t,{attributes:e})):r.a.createElement(fu,{style:t.style})}));var Eu=Fa()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-kjok46-0"})(["position:relative;overflow:hidden;height:100%;.echMetric{border-radius:",";pointer-events:none;}"],(e=>e.$_css));const vu=()=>r.a.createElement(xu,{gutterSize:"xs",justifyContent:"center",alignItems:"center",direction:"column"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiIcon,{type:"warning"})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiText,{size:"s",textAlign:"center"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.errorOnLoadingLensDependencies",defaultMessage:"There was an error trying to load Lens Plugin."}))));var xu=Fa()(Y.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-70ml96-0"})(["height:100%;align-content:center;"]);const wu=r.a.memo((({id:e,borderRadius:t,dateRange:a,filters:i,hidePanelTitles:s,lastReloadRequestTime:l,query:o,onBrushEnd:c,onFilter:u,overrides:d,toolTip:m,searchSessionId:p,disableTriggers:g=!1,height:f=300,loading:b=!1,...h})=>{const{formula:y,attributes:E,getExtraActions:v,error:x}=(({dataView:e,...t})=>{const{services:{lens:a}}=Object(Q.useKibana)(),{navigateToPrefilledEditor:r}=a,{value:i,error:s}=Gc()((()=>a.stateHelperApi()),[a]),{formula:l}=null!=i?i:{},o=Object(n.useMemo)((()=>e&&l?new lens_attributes_builder_LensAttributesBuilder({visualization:mu({dataView:e,formulaAPI:l,...t})}).build():null),[e,l,t]),c=Object(n.useCallback)((({filters:e,query:t})=>o?{...o,state:{...o.state,query:t,filters:[...o.state.filters,...e]}}:null),[o]),u=Object(n.useCallback)((({timeRange:e,query:t,filters:a,searchSessionId:n})=>()=>{const i=c({filters:a,query:t});i&&r({id:"",timeRange:e,attributes:i,searchSessionId:n},{openInNewTab:!0})}),[c,r]),d=Object(n.useCallback)((({timeRange:e,filters:t=[],query:a={language:"kuery",query:""},searchSessionId:n})=>{return[(r=u({timeRange:e,filters:t,query:a,searchSessionId:n}),{id:"openInLens",getDisplayName:e=>W.i18n.translate("xpack.infra.hostsViewPage.tabs.metricsCharts.actions.openInLines",{defaultMessage:"Open in Lens"}),getIconType:e=>"visArea",type:"actionButton",isCompatible:async e=>!0,async execute(e){r()},order:100})];var r}),[u]);return{formula:(()=>{const e=[...Array.isArray(t.layers)?t.layers:[t.layers]].find((e=>"data"===e.layerType));return e?(Array.isArray(e.data)?e.data[0]:e.data).value:""})(),attributes:o,getExtraActions:d,error:s}})(h),w=b||!E,k=v({timeRange:a,query:o,filters:i,searchSessionId:p}),O=r.a.createElement(hu,{id:e,attributes:E,dateRange:a,disableTriggers:g,extraActions:k,filters:i,hidePanelTitles:s,loading:w,style:{height:f},query:o,overrides:d,onBrushEnd:c,searchSessionId:p,onFilter:u}),M=m?r.a.createElement(Y.EuiToolTip,{delay:"regular",content:r.a.cloneElement(m,{formula:y}),anchorClassName:"eui-fullWidth"},r.a.createElement("div",null,O)):O;return r.a.createElement(ku,{hasBorder:!!t,borderRadius:t,hasShadow:!1,paddingSize:x?"m":"none","data-test-subj":e,$_css:f},x?r.a.createElement(vu,null):M)}));var ku=Fa()(Y.EuiPanel).withConfig({displayName:"_StyledEuiPanel",componentId:"sc-o4vles-0"})(["position:relative;min-height:","px;"],(e=>e.$_css));const Ou="https://ela.st/docs-infra-host-metrics",Mu=r.a.memo((({description:e,formula:t,showDocumentationLink:a=!1,style:n})=>r.a.createElement(Y.EuiText,{size:"xs",style:n,onClick:e=>{e.stopPropagation()}},r.a.createElement("p",null,e),t&&r.a.createElement("p",null,r.a.createElement("strong",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.table.tooltip.formula",defaultMessage:"Formula Calculation:"})),r.a.createElement("br",null),r.a.createElement(ju,null,t)),a&&r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.table.tooltip.documentationLabel",defaultMessage:"See {documentation} for more information",values:{documentation:r.a.createElement(Y.EuiLink,{"data-test-subj":"hostsViewTooltipDocumentationLink",href:Ou,target:"_blank"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.table.tooltip.documentationLink",defaultMessage:"documentation"}))}})))));var ju=Fa()("code").withConfig({displayName:"_StyledCode",componentId:"sc-1abuwye-0"})(["word-break:break-word;"]);const Su={metrics:{href:Ou,label:W.i18n.translate("xpack.infra.hostsViewPage.tooltip.whatAreTheseMetricsLink",{defaultMessage:"What are these metrics?"})},dottedLines:{href:"https://ela.st/docs-infra-why-dotted",label:W.i18n.translate("xpack.infra.hostsViewPage.tooltip.whyAmISeeingDottedLines",{defaultMessage:"Why am I seeing dotted lines?"})}},Cu=({type:e})=>r.a.createElement(Y.EuiText,{size:"xs"},r.a.createElement(Y.EuiLink,{"data-test-subj":"hostsViewMetricsDocumentationLink",href:Su[e].href,target:"_blank"},Su[e].label)),Tu=()=>r.a.createElement(Y.EuiText,{size:"xs"},r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.metricsExplanation",defaultMessage:"Showing metrics for your host(s)"})),r.a.createElement("p",null,r.a.createElement(Cu,{type:"metrics"})),r.a.createElement("p",null,r.a.createElement(Cu,{type:"dottedLines"})));var Iu=a(12);const Fu={status:"all",label:W.i18n.translate("xpack.infra.hostsViewPage.tabs.alerts.alertStatusFilter.showAll",{defaultMessage:"Show all"})},Lu={status:Iu.W,query:{term:{[Iu.V]:{value:Iu.W}}},label:W.i18n.translate("xpack.infra.hostsViewPage.tabs.alerts.alertStatusFilter.active",{defaultMessage:"Active"})},Pu={status:Iu.X,query:{term:{[Iu.V]:{value:Iu.X}}},label:W.i18n.translate("xpack.infra.hostsViewPage.tabs.alerts.alertStatusFilter.recovered",{defaultMessage:"Recovered"})},Du={status:Iu.Y,query:{term:{[Iu.V]:{value:Iu.Y}}},label:W.i18n.translate("xpack.infra.hostsViewPage.tabs.alerts.alertStatusFilter.untracked",{defaultMessage:"Untracked"})},_u={[Lu.status]:Lu.query,[Pu.status]:Pu.query,[Du.status]:Du.query},Ru="/app/observability/alerts",Au=({assetName:e,queryField:t,dateRange:a})=>{const{services:n}=Object(ge.b)(),{http:i}=n,s=i.basePath.prepend(`${Ru}?_a=${Object(d.encode)({kuery:`${t}:"${e}"`,rangeFrom:a.from,rangeTo:a.to,status:"all"})}`);return r.a.createElement(zc.a,{coreStart:n},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraAssetDetailsAlertsShowAllButton",size:"xs",iconSide:"right",iconType:"sortRight",flush:"both",href:s},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.flyout.AlertsPageLinkLabel",defaultMessage:"Show all"})))},Bu=()=>{const{services:e}=Object(ge.b)(),{http:t}=e,a=t.basePath.prepend(Ru);return r.a.createElement(zc.a,{coreStart:e},r.a.createElement(Y.EuiLink,{"data-test-subj":"assetDetailsTooltipDocumentationLink",href:a},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.table.tooltip.alertsLink",defaultMessage:"alerts."})))},Vu=r.a.memo((()=>r.a.createElement(Y.EuiText,{size:"xs",onClick:e=>{e.stopPropagation()}},r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.alerts.tooltip.alertsLabel",defaultMessage:"Showing alerts for this host. You can create and manage alerts in {alerts}",values:{alerts:r.a.createElement(Bu,null)}})),r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.alerts.tooltip.documentationLabel",defaultMessage:"See {documentation} for more information",values:{documentation:r.a.createElement(Y.EuiLink,{"data-test-subj":"infraAssetDetailsTooltipDocumentationLink",href:"https://www.elastic.co/guide/en/observability/current/create-alerts.html",target:"_blank"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.alerts.tooltip.documentationLink",defaultMessage:"documentation"}))}}))))),Nu=({title:e,"data-test-subj":t})=>r.a.createElement(Y.EuiTitle,{size:"xxs","data-test-subj":t},r.a.createElement("span",null,e)),zu=({title:e,"data-test-subj":t,tooltipTestSubj:a,children:n})=>r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Nu,{title:e,"data-test-subj":t})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Nr,{icon:"iInCircle","data-test-subj":a},n))),$u=()=>r.a.createElement(zu,{title:W.i18n.translate("xpack.infra.assetDetails.overview.metricsSectionTitle",{defaultMessage:"Metrics"}),tooltipTestSubj:"infraAssetDetailsMetricsPopoverButton"},r.a.createElement(Tu,null)),qu=()=>r.a.createElement(Nu,{title:W.i18n.translate("xpack.infra.assetDetails.overview.kubernetesMetricsSectionTitle",{defaultMessage:"Kubernetes Overview"})}),Uu=()=>r.a.createElement(Nu,{title:W.i18n.translate("xpack.infra.assetDetails.overview.metadataSectionTitle",{defaultMessage:"Metadata"}),"data-test-subj":"infraAssetDetailsMetadataTitle"}),Gu=()=>r.a.createElement(zu,{title:W.i18n.translate("xpack.infra.assetDetails.overview.alertsSectionTitle",{defaultMessage:"Alerts"}),"data-test-subj":"infraAssetDetailsAlertsTitle",tooltipTestSubj:"infraAssetDetailsAlertsPopoverButton"},r.a.createElement(Vu,null)),Hu=e=>{var t,a,n;return[{field:"hostIp",value:null==e||null===(t=e.host)||void 0===t?void 0:t.ip,tooltipFieldLabel:"host.ip",tooltipLink:"https://www.elastic.co/guide/en/ecs/current/ecs-host.html#field-host-ip"},{field:"hostOsVersion",value:null==e||null===(a=e.host)||void 0===a||null===(n=a.os)||void 0===n?void 0:n.version,tooltipFieldLabel:"host.os.version"}]},Wu=({loading:e,visibleMetadata:t})=>{const{showTab:a}=Jr();return r.a.createElement(Y.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",direction:"column",wrap:!0},r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"xs"},r.a.createElement(Y.EuiFlexGroup,{justifyContent:"spaceBetween",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Uu,null)),r.a.createElement(Y.EuiFlexItem,{grow:!1,key:"metadata-link"},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraAssetDetailsMetadataShowAllButton",onClick:()=>{a(R.METADATA)},size:"xs",flush:"both",iconSide:"right",iconType:"sortRight"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetailsEmbeddable.metadataSummary.showAllMetadataButton",defaultMessage:"Show all"})))),r.a.createElement(Y.EuiFlexGroup,null,r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(ko,null)))),r.a.createElement(Y.EuiFlexGroup,null,t.map((t=>{var a;return t&&r.a.createElement(Y.EuiFlexItem,{key:t.field,grow:!1},r.a.createElement(Y.EuiDescriptionList,{"data-test-subj":"infraMetadataSummaryItem",compressed:!0},r.a.createElement(Yc,{metadataValue:t}),r.a.createElement(Y.EuiDescriptionListDescription,null,e&&!t.value?r.a.createElement(Y.EuiLoadingSpinner,null):r.a.createElement(po,{values:null!==(a=t.value)&&void 0!==a?a:rc}))))}))))},Qu=({metadata:e,loading:t})=>{return r.a.createElement(Wu,{visibleMetadata:[...Hu(null==e?void 0:e.info),...(a=null==e?void 0:e.info,[{field:"cloudProvider",value:null==a||null===(n=a.cloud)||void 0===n?void 0:n.provider,tooltipFieldLabel:"cloud.provider",tooltipLink:"https://www.elastic.co/guide/en/ecs/current/ecs-cloud.html#field-cloud-provider"},{field:"operatingSystem",value:null==a||null===(i=a.host)||void 0===i||null===(s=i.os)||void 0===s?void 0:s.name,tooltipFieldLabel:"host.os.name"}])],loading:t});var a,n,i,s},Ju=({metadata:e,loading:t})=>r.a.createElement(Wu,{visibleMetadata:Hu(null==e?void 0:e.info),loading:t});var Ku=a(97);const Yu=({dateRange:e,hostNodeNames:t,status:a})=>{const n=[Zu(a),Xu(e),io({field:"host.name",values:t})].filter(Boolean);return Object(ca.buildEsQuery)(void 0,[],n)},Xu=e=>Object(Ku.getTime)(void 0,e,{fieldName:Iu.fb}),Zu=(e="all")=>_u[e]?{query:_u[e],meta:{}}:null,ed=[Iu.ob.INFRASTRUCTURE],td=({onClick:e})=>r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraAssetDetailsCreateAlertsRuleButton",onClick:e,size:"xs",iconSide:"left",flush:"both",iconType:"bell"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.infra.assetDetails.alerts.createAlertLink",defaultMessage:"Create rule"})),ad=({assetName:e,assetType:t,dateRange:a})=>{var i;const{featureFlags:s}=_c(),[l,{toggle:o}]=Nt(!1),{overrides:c}=hl(),d=Object(n.useMemo)((()=>Yu({dateRange:a,hostNodeNames:[e],status:"all"})),[e,a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Gu,null)),s.inventoryThresholdAlertRuleEnabled&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(td,{onClick:o})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Au,{assetName:e,queryField:`${t}.name`,dateRange:a}))),r.a.createElement(Y.EuiSpacer,{size:"s"}),r.a.createElement(nd,{alertsQuery:d,dateRange:a}),s.inventoryThresholdAlertRuleEnabled&&r.a.createElement(ln,{filter:`${Object(u.findInventoryFields)(t).name}: "${e}"`,nodeType:t,setVisible:o,visible:l,options:null==c||null===(i=c.alertRule)||void 0===i?void 0:i.options}))},nd=r.a.memo((({alertsQuery:e,dateRange:t})=>{const{services:a}=Object(ge.b)(),n=Object(cn.useSummaryTimeRange)(t),{charts:i,triggersActionsUi:s}=a,{getAlertSummaryWidget:l}=s,o={theme:i.theme.useChartsTheme(),baseTheme:i.theme.useChartsBaseTheme()};return r.a.createElement(l,{chartProps:o,featureIds:ed,filter:e,timeRange:n,fullSize:!0,hideChart:!0})})),rd={hostCount:W.i18n.translate("xpack.infra.hostsViewPage.metrics.tooltip.hostCount",{defaultMessage:"Number of hosts returned by your search criteria."}),cpuUsage:W.i18n.translate("xpack.infra.hostsViewPage.metrics.tooltip.cpuUsage",{defaultMessage:"Percentage of CPU time spent in states other than Idle and IOWait, normalized by the number of CPU cores. This includes both time spent on user space and kernel space."}),diskUsage:W.i18n.translate("xpack.infra.hostsViewPage.metrics.tooltip.diskSpaceUsage",{defaultMessage:"Percentage of disk space used."}),diskLatency:W.i18n.translate("xpack.infra.hostsViewPage.metrics.tooltip.diskLatency",{defaultMessage:"Time spent to service disk requests."}),memoryFree:W.i18n.translate("xpack.infra.hostsViewPage.metrics.tooltip.memoryFree",{defaultMessage:"Total available memory including page cache."}),memoryTotal:W.i18n.translate("xpack.infra.hostsViewPage.metrics.tooltip.memoryTotal",{defaultMessage:"Total memory capacity."}),memoryUsage:W.i18n.translate("xpack.infra.hostsViewPage.metrics.tooltip.memoryUsage",{defaultMessage:"Percentage of main memory usage excluding page cache."}),normalizedLoad1m:W.i18n.translate("xpack.infra.hostsViewPage.metrics.tooltip.normalizedLoad1m",{defaultMessage:"1 minute load average normalized by the number of CPU cores. "}),rx:W.i18n.translate("xpack.infra.hostsViewPage.metrics.tooltip.rx",{defaultMessage:"Number of bytes which have been received per second on the public interfaces of the hosts."}),tx:W.i18n.translate("xpack.infra.hostsViewPage.metrics.tooltip.tx",{defaultMessage:"Number of bytes which have been sent per second on the public interfaces of the hosts."})},id=({id:e,height:t,assetName:a,dateRange:i,dataView:s,...l})=>{const{searchSessionId:o}=Vr(),c=Object(n.useMemo)((()=>[io({field:"host.name",values:[a],dataView:s})]),[s,a]),u=Object(n.useMemo)((()=>e in rd?r.a.createElement(Mu,{description:rd[e]}):void 0),[e]);return r.a.createElement(wu,de()({},l,{id:`infraAssetDetailsKPI${e}`,dataView:s,dateRange:i,height:t,filters:c,toolTip:u,searchSessionId:o,disableTriggers:!0,hidePanelTitles:!0}))},sd=({assetName:e,dataView:t,dateRange:a})=>{const i=Object(u.findInventoryModel)("host"),{euiTheme:s}=Object(Y.useEuiTheme)(),{value:l}=Gc()((()=>i.metrics.getDashboards())),o=Object(n.useMemo)((()=>{var e;return null!==(e=null==l?void 0:l.kpi.get({metricsDataView:t,options:{backgroundColor:s.colors.lightestShade}}).charts)&&void 0!==e?e:[]}),[t,s.colors.lightestShade,null==l?void 0:l.kpi]);return r.a.createElement(Y.EuiFlexGroup,{direction:"row",gutterSize:"s","data-test-subj":"infraAssetDetailsKPIGrid"},o.map(((t,n)=>r.a.createElement(Y.EuiFlexItem,{key:n},r.a.createElement(id,de()({},t,{dateRange:a,assetName:e,height:150}))))))};const ld=({id:e,filterFieldName:t,dataViewOrigin:a,overrides:i,dateRange:s,assetName:l,dataView:o,...c})=>{const{setDateRange:u}=Rr(),{searchSessionId:d}=Vr(),{"data-test-subj":m,...p}={...c},g=Object(n.useMemo)((()=>[io({field:t,values:[l],dataView:o})]),[l,o,t]),f=Object(n.useCallback)((({range:e,preventDefault:t})=>{u({from:new Date(e[0]).toISOString(),to:new Date(e[1]).toISOString()}),t()}),[u]),b=Object(n.useCallback)((e=>{const t=function({data:e}){if(!function(e){var t;return Array.isArray(e)&&Array.isArray(null===(t=e[0])||void 0===t?void 0:t.cells)&&e[0].cells.length>0}(e))return null;const{column:t,row:a}=function(e){var t,a;const n=e[0].table,r=e[0].cells[0];return{column:null!==(t=n.columns[r.column])&&void 0!==t?t:null,row:null!==(a=n.rows[r.row])&&void 0!==a?a:null}}(e);if(!t||!a||"date"!==t.meta.type)return null;const n=a[t.id],r=(i=e[0].table.rows,s=t.id,i.length<2?0:Math.abs(i[1][s]-i[0][s]));var i,s;return{from:new Date(n).toISOString(),to:new Date(n+r).toISOString()}}(e);null!==t&&(u(t),e.preventDefault())}),[u]);return r.a.createElement(wu,de()({},p,{id:`${m}${e}`,borderRadius:"m",dataView:o,dateRange:s,height:300,searchSessionId:d,filters:g,overrides:i,onBrushEnd:f,onFilter:b}))},od=({assetName:e,dateRange:t,filterFieldName:a,charts:n,...i})=>r.a.createElement(Y.EuiFlexGrid,{columns:2,gutterSize:"s","data-test-subj":`${i["data-test-subj"]}Grid`},n.map(((n,s)=>r.a.createElement(Y.EuiFlexItem,{key:s,grow:!1},r.a.createElement(ld,de()({},n,{assetName:e,dateRange:t,filterFieldName:a,"data-test-subj":i["data-test-subj"]})))))),cd=({assetName:e,metricsDataView:t,logsDataView:a,dateRange:i})=>{var s,l,o,c,d;const m=Object(u.findInventoryModel)("host"),{value:p}=Gc()((()=>m.metrics.getDashboards())),g=Object(n.useMemo)((()=>({hosts:null==p?void 0:p.assetDetails.get({metricsDataView:t,logsDataView:a}),kubernetes:null==p?void 0:p.assetDetailsKubernetesNode.get({metricsDataView:t})})),[a,t,null==p?void 0:p.assetDetails,null==p?void 0:p.assetDetailsKubernetesNode]);return r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(dd,{title:$u},r.a.createElement(od,{assetName:e,dateRange:i,"data-test-subj":"infraAssetDetailsHostMetricsChart",charts:null!==(s=null===(l=g.hosts)||void 0===l?void 0:l.charts)&&void 0!==s?s:[],filterFieldName:m.fields.name})),r.a.createElement(dd,{dependsOn:null==g||null===(o=g.kubernetes)||void 0===o?void 0:o.dependsOn,title:qu},r.a.createElement(od,{assetName:e,dateRange:i,"data-test-subj":"infraAssetDetailsKubernetesMetricsChart",charts:null!==(c=null===(d=g.kubernetes)||void 0===d?void 0:d.charts)&&void 0!==c?c:[],filterFieldName:m.fields.name})))},ud=({assetName:e,metricsDataView:t,logsDataView:a,dateRange:i})=>{const s=Object(u.findInventoryModel)("host"),{value:l}=Gc()((()=>s.metrics.getDashboards())),o=Object(n.useMemo)((()=>{var e;return null!==(e=null==l?void 0:l.assetDetailsFlyout.get({metricsDataView:t,logsDataView:a}).charts)&&void 0!==e?e:[]}),[t,a,null==l?void 0:l.assetDetailsFlyout]);return r.a.createElement(dd,{title:$u},r.a.createElement(od,{assetName:e,dateRange:i,filterFieldName:s.fields.name,charts:o,"data-test-subj":"infraAssetDetailsHostMetricsChart"}))},dd=({title:e,dependsOn:t=[],children:a})=>{const i=e,{metadata:s}=gl();return Object(n.useMemo)((()=>0===t.length||t.some((e=>{var t;return(null!==(t=null==s?void 0:s.features)&&void 0!==t?t:[]).some((t=>t.name===e))}))),[t,null==s?void 0:s.features])?r.a.createElement(Y.EuiFlexGroup,{gutterSize:"m",direction:"column"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(i,null)),r.a.createElement(Y.EuiFlexItem,{grow:!1},a)):null},md=()=>r.a.createElement(pd,{margin:"m"});var pd=Fa()(Y.EuiHorizontalRule).withConfig({displayName:"_StyledEuiHorizontalRule",componentId:"sc-1mx6poq-0"})(["margin-bottom:0;"]);const gd=()=>r.a.createElement(Y.EuiBadge,{color:"accent"},W.i18n.translate("xpack.infra.newBadgeLabel",{defaultMessage:"NEW"}));function fd(){const{featureFlags:{profilingEnabled:e}}=_c(),t=Object(Q.useUiSetting)(pe.enableInfrastructureProfilingIntegration);return e&&t}function bd(){const{showTab:e}=Jr();return fd()?r.a.createElement(Y.EuiFlexGroup,{alignItems:"center",justifyContent:"flexStart",gutterSize:"s","data-test-subj":"infraAssetDetailsCPUProfilingPrompt"},r.a.createElement(gd,null),r.a.createElement(Y.EuiFlexGroup,{alignItems:"baseline",justifyContent:"flexStart",gutterSize:"xs"},W.i18n.translate("xpack.infra.cpuProfilingPrompt.promptText",{defaultMessage:"View CPU Breakdown using"}),r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraCpuProfilingPromptProfilingButton",onClick:()=>e("profiling"),flush:"both"},W.i18n.translate("xpack.infra.cpuProfilingPrompt.profilingLinkLabel",{defaultMessage:"Profiling"})))):null}const hd=()=>{const e=Object(n.useRef)(null),{dateRange:t}=Rr(),{asset:a,renderMode:i}=hl(),{metadata:s,loading:l,error:o}=gl(),{logs:c,metrics:u}=Qc(),d="flyout"!==i.mode,m=yl(e,{dateRange:t}),p=d?r.a.createElement(cd,{dateRange:m.dateRange,logsDataView:c.dataView,metricsDataView:u.dataView,assetName:a.name}):r.a.createElement(ud,{dateRange:m.dateRange,logsDataView:c.dataView,metricsDataView:u.dataView,assetName:a.name}),g=d?r.a.createElement(Qu,{metadata:s,loading:l}):r.a.createElement(Ju,{metadata:s,loading:l});return r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"m",ref:e},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(sd,{assetName:a.name,dateRange:m.dateRange,dataView:u.dataView}),r.a.createElement(bd,null)),r.a.createElement(Y.EuiFlexItem,{grow:!1},o&&!l?r.a.createElement(Oo,null):g,r.a.createElement(md,null)),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(ad,{assetName:a.name,assetType:a.type,dateRange:m.dateRange}),r.a.createElement(md,null)),r.a.createElement(Y.EuiFlexItem,{grow:!1},p))},yd=()=>r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"xs"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Ed,{visibleFor:[R.OVERVIEW,R.LOGS,R.METADATA,R.PROCESSES,R.ANOMALIES]})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(vd,{activeWhen:R.ANOMALIES},r.a.createElement(El,null)),r.a.createElement(vd,{activeWhen:R.OVERVIEW},r.a.createElement(hd,null)),r.a.createElement(vd,{activeWhen:R.LOGS},r.a.createElement(Jc,null)),r.a.createElement(vd,{activeWhen:R.METADATA},r.a.createElement(Mo,null)),r.a.createElement(vd,{activeWhen:R.OSQUERY},r.a.createElement(Ac,null)),r.a.createElement(vd,{activeWhen:R.PROCESSES},r.a.createElement(kc,null)),r.a.createElement(vd,{activeWhen:R.PROFILING},r.a.createElement(Lc,null)))),Ed=({visibleFor:e})=>{const{activeTabId:t}=Jr();return r.a.createElement("div",{hidden:!e.includes(t)},r.a.createElement(qr,null))},vd=({activeWhen:e,children:t})=>{const{renderedTabsSet:a,activeTabId:n}=Jr();return a.current.has(e)?r.a.createElement("div",{hidden:n!==e},t):null},xd=({title:e,tabs:t=[],rightSideItems:a=[]})=>{const{euiTheme:n}=Object(Y.useEuiTheme)();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceBetween",direction:"row"},r.a.createElement(wd,{grow:!0},r.a.createElement(Y.EuiTitle,{size:"xs"},r.a.createElement("h4",null,e))),r.a.createElement(kd,{grow:!1,$_css:Object(Y.useEuiMinBreakpoint)("m")},r.a.createElement(Od,{gutterSize:"m",responsive:!1,justifyContent:"flexEnd",alignItems:"center",$_css2:n.size.l},null==a?void 0:a.map(((e,t)=>r.a.createElement(Y.EuiFlexItem,{key:t,grow:!1},e)))))),r.a.createElement(Y.EuiSpacer,{size:"s"}),r.a.createElement(Md,{bottomBorder:!0,size:"s",$_css3:n.size.l},t.map((({label:e,...t},a)=>r.a.createElement(Y.EuiTab,de()({key:a},t),e)))))};var wd=Fa()(Y.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-1wg0et9-0"})(["overflow:hidden;& h4{text-overflow:ellipsis;overflow:hidden;white-space:nowrap;width:calc(100%);}"]),kd=Fa()(Y.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem2",componentId:"sc-1wg0et9-1"})(["align-items:flex-start;","{align-items:flex-end;}"],(e=>e.$_css)),Od=Fa()(Y.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1wg0et9-2"})(["margin-right:",";"],(e=>e.$_css2)),Md=Fa()(Y.EuiTabs).withConfig({displayName:"_StyledEuiTabs",componentId:"sc-1wg0et9-3"})(["margin-bottom:calc(-1 * ("," + 1px));"],(e=>e.$_css3)),jd=a(480);const Sd=({assetName:e,apmField:t})=>{const{services:a}=Object(ge.b)(),{http:n}=a,i=new URLSearchParams(Object(d.encode)(Object(jd.stringify)({kuery:`${t}:"${e}"`}))),s=n.basePath.prepend(`/app/apm/services?${i}`);return r.a.createElement(zc.a,{coreStart:a},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraAssetDetailsViewAPMServicesButton",size:"xs",flush:"both",href:s},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.flyout.viewApmServicesLinkLabel",defaultMessage:"APM Services"})))},Cd=({assetId:e,assetName:t,assetType:a})=>{var n,i,s,l;const[o]=Tr(),{getNodeDetailUrl:c}=ut(),{dateRange:u,autoRefresh:d,...m}=null!=o?o:{},p=Object(me.useLinkProps)({...c({assetType:a,assetId:e,search:{...m,name:t,from:null===(n=Object(y.parse)(null!==(i=null==u?void 0:u.from)&&void 0!==i?i:""))||void 0===n?void 0:n.valueOf(),to:null===(s=Object(y.parse)(null!==(l=null==u?void 0:u.to)&&void 0!==l?l:""))||void 0===s?void 0:s.valueOf()}})});return r.a.createElement(Y.EuiButtonEmpty,de()({"data-test-subj":"infraAssetDetailsOpenAsPageButton",size:"xs",flush:"both"},p),r.a.createElement(X.FormattedMessage,{id:"xpack.infra.infra.nodeDetails.openAsPage",defaultMessage:"Open as page"}))},Td=(e=[],t=[])=>{const{rightSideItems:a}=Fd(t),{tabEntries:n}=Ld(e),{breadcrumbs:r}=Id();return{rightSideItems:a,tabEntries:n,breadcrumbs:r}},Id=()=>{const e=Object(c.useHistory)(),t=Object(c.useLocation)(),{services:{application:{navigateToApp:a}}}=Object(ge.b)();return{breadcrumbs:t.state||e.length>1?[{text:r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiIcon,{size:"s",type:"arrowLeft"})),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.assetDetails.header.return",defaultMessage:"Return"}))),color:"primary","aria-current":!1,"data-test-subj":"infraAssetDetailsReturnButton",href:"#",onClick:n=>{t.state?a(t.state.originAppId,{replace:!0,path:`${t.state.originPathname}${t.state.originSearch}`}):e.goBack(),n.preventDefault()}}]:[]}},Fd=e=>{const{asset:t}=hl(),a=Object(n.useMemo)((()=>({nodeDetails:r.a.createElement(Cd,{assetId:t.id,assetName:t.name,assetType:t.type}),alertRule:r.a.createElement(td,null),apmServices:r.a.createElement(Sd,{assetName:t.name,apmField:N})})),[t.id,t.name,t.type]);return{rightSideItems:Object(n.useMemo)((()=>null==e?void 0:e.map((e=>a[e]))),[e,a])}},Ld=e=>{const{showTab:t,activeTabId:a}=Jr(),{asset:i}=hl(),{isTabEnabled:s}=(()=>{const{featureFlags:e}=_c(),t=fd(),a=Object(n.useMemo)((()=>({[R.OSQUERY]:e.osqueryEnabled,[R.PROFILING]:t})),[e.osqueryEnabled,t]);return{isTabEnabled:Object(n.useCallback)((e=>{var t;return null===(t=a[e.id])||void 0===t||t}),[a])}})(),l=Object(n.useCallback)((e=>{t(e)}),[t]),o=Object(me.useLinkProps)({app:"apm",hash:"traces",search:{kuery:`${N}:"${i.name}"`}}),c=Object(n.useCallback)((e=>({...o,"data-test-subj":"infraAssetDetailsApmServicesLinkTab",label:r.a.createElement(Y.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiIcon,{type:"popout"})),r.a.createElement(Y.EuiFlexItem,{grow:!1},e))})),[o]);return{tabEntries:Object(n.useMemo)((()=>e.filter(s).map((({name:e,...t})=>t.id===R.LINK_TO_APM?c(e):{...t,"data-test-subj":`infraAssetDetails${Object(Ne.capitalize)(t.id)}Tab`,onClick:()=>l(t.id),isSelected:t.id===a,label:e}))),[a,s,c,l,e])}},Pd=({tabs:e=[],links:t=[],closeFlyout:a})=>{const[,i]=Tr(),{asset:s,loading:l}=hl(),{rightSideItems:o,tabEntries:c}=Td(e,t),{activeTabId:u}=Jr(),{services:{telemetry:d}}=Object(ge.b)();Mr()((()=>{d.reportAssetDetailsFlyoutViewed({componentName:B,assetType:s.type,tabId:u})}));const m=Object(n.useCallback)((()=>{i(null),a()}),[a,i]);return r.a.createElement(Y.EuiFlyout,{onClose:m,ownFocus:!1,"data-component-name":B,"data-asset-type":s.type},l?r.a.createElement(loading_InfraLoadingPanel,{height:"100%",width:"auto",text:W.i18n.translate("xpack.infra.waffle.loadingDataText",{defaultMessage:"Loading data"})}):r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(xd,{title:s.name,tabs:c,rightSideItems:o})),r.a.createElement(Y.EuiFlyoutBody,null,r.a.createElement(yd,null))))},Dd=()=>({actionMenuHeight:Object(n.useMemo)((()=>{var e;const t=document.querySelector('[data-test-subj="kibanaProjectHeaderActionMenu"]');return null!==(e=null==t?void 0:t.getBoundingClientRect().height)&&void 0!==e?e:0}),[])}),_d=({tabs:e=[],links:t=[]})=>{const{loading:a}=hl(),{metadata:i,loading:s}=gl(),{rightSideItems:l,tabEntries:o,breadcrumbs:c}=Td(e,t),{asset:u}=hl(),{actionMenuHeight:d}=Dd(),m=r.a.useRef(!1),{activeTabId:p}=Jr(),{services:{telemetry:g}}=Object(ge.b)();Object(n.useEffect)((()=>{if(!m.current&&!s&&i){const e=(e=>e?Object.entries($).filter((([t,a])=>{var n;return null==e||null===(n=e.features)||void 0===n?void 0:n.some((e=>a.includes(e.name)))})).map((([e])=>e)):[])(i),t={componentName:V,assetType:u.type,tabId:p};g.reportAssetDetailsPageViewed(e.length>0?{...t,integrations:e}:t),m.current=!0}}),[p,u.type,i,s,g]);const f=Object(n.useMemo)((()=>`calc(100vh - var(--euiFixedHeadersOffset, 0) - ${d}px)`),[d]);return a?r.a.createElement(Rd,{direction:"column",$_css:f},r.a.createElement(loading_InfraLoadingPanel,{height:"100%",width:"auto",text:W.i18n.translate("xpack.infra.waffle.loadingDataText",{defaultMessage:"Loading data"})})):r.a.createElement(Y.EuiPageTemplate,{panelled:!0,contentBorder:!1,offset:0,restrictWidth:!1,style:{minBlockSize:f},"data-component-name":V,"data-asset-type":u.type},r.a.createElement(Y.EuiPageTemplate.Section,{paddingSize:"none"},r.a.createElement(Y.EuiPageTemplate.Header,{pageTitle:u.name,tabs:o,rightSideItems:l,breadcrumbs:c}),r.a.createElement(Y.EuiPageTemplate.Section,{grow:!0},r.a.createElement(yd,null))))};var Rd=Fa()(Y.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1l6ritj-0"})(["height:",";"],(e=>e.$_css));const Ad=({children:e,...t})=>{const{assetId:a,assetName:n,autoRefresh:i,dateRange:s,overrides:l,assetType:o="host",renderMode:c}=t;return r.a.createElement(_r,{dateRange:s,autoRefresh:i},r.a.createElement(Br,null,r.a.createElement(pl,{assetId:a,assetType:o},r.a.createElement(bl,{assetId:a,assetName:n,assetType:o,overrides:l,renderMode:c},e))))},Bd=({tabs:e,links:t,renderMode:a})=>"flyout"===a.mode?r.a.createElement(Pd,{tabs:e,links:t,closeFlyout:a.closeFlyout}):r.a.createElement(_d,{tabs:e,links:t}),Vd=({tabs:e,links:t,renderMode:a,metricAlias:n,...i})=>{var s;return r.a.createElement(Ad,de()({},i,{renderMode:a}),r.a.createElement(Qr,{defaultActiveTabId:null===(s=e[0])||void 0===s?void 0:s.id},r.a.createElement(Wc,{metricAlias:n},r.a.createElement(Bd,{tabs:e,links:t,renderMode:a}))))};var Nd=Vd;const zd=[{id:R.OVERVIEW,name:W.i18n.translate("xpack.infra.nodeDetails.tabs.overview.title",{defaultMessage:"Overview"})},{id:R.METADATA,name:W.i18n.translate("xpack.infra.nodeDetails.tabs.metadata.title",{defaultMessage:"Metadata"})},{id:R.PROCESSES,name:W.i18n.translate("xpack.infra.metrics.nodeDetails.tabs.processes",{defaultMessage:"Processes"})},{id:R.PROFILING,name:W.i18n.translate("xpack.infra.metrics.nodeDetails.tabs.profiling",{defaultMessage:"Universal Profiling"}),append:r.a.createElement(gd,null)},{id:R.LOGS,name:W.i18n.translate("xpack.infra.nodeDetails.tabs.logs.title",{defaultMessage:"Logs"})},{id:R.ANOMALIES,name:W.i18n.translate("xpack.infra.nodeDetails.tabs.anomalies",{defaultMessage:"Anomalies"})},{id:R.OSQUERY,name:W.i18n.translate("xpack.infra.nodeDetails.tabs.osquery",{defaultMessage:"Osquery"})}],$d=[...zd,{id:R.LINK_TO_APM,name:W.i18n.translate("xpack.infra.nodeDetails.tabs.linkToApm",{defaultMessage:"APM"})}],qd=({assetName:e,assetType:t,closeFlyout:a,currentTime:i,options:s,refreshInterval:l,isAutoReloading:o=!1})=>{const{source:c}=Object(re.b)(),u=Object(n.useMemo)((()=>o?{from:"now-1h",to:"now"}:{from:new Date(i-36e5).toISOString(),to:new Date(i).toISOString()}),[i,o]);return c?r.a.createElement(Nd,{assetId:e,assetName:e,assetType:t,overrides:{metadata:{showActionsColumn:!1},alertRule:{options:s}},tabs:$d,links:["nodeDetails"],renderMode:{mode:"flyout",closeFlyout:a},metricAlias:c.configuration.metricAlias,dateRange:u,autoRefresh:{isPaused:!o,interval:l}}):null},Ud=({autoBounds:e,boundsOverride:t,loading:a,nodes:i,nodeType:s,reload:l,view:o,currentTime:c,options:u,formatter:d,onDrilldown:m,bottomMargin:p,showLoading:g,refreshInterval:f,isAutoReloading:b})=>{const h=Object(Y.useCurrentEuiBreakpoint)(),[{detailsItemId:y},E]=Fn(),v=Object(n.useCallback)((()=>E({detailsItemId:null})),[E]),x=Object(n.useCallback)((e=>{m({kind:"kuery",expression:e})}),[m]),w=!a&&i&&0===i.length;if(a&&g)return r.a.createElement(loading_InfraLoadingPanel,{height:"100%",width:"100%",text:W.i18n.translate("xpack.infra.waffle.loadingDataText",{defaultMessage:"Loading data"})});if(w)return r.a.createElement(Ve.a,{titleText:W.i18n.translate("xpack.infra.waffle.noDataTitle",{defaultMessage:"There is no data to display."}),bodyText:W.i18n.translate("xpack.infra.waffle.noDataDescription",{defaultMessage:"Try adjusting your time or filter."}),refetchText:W.i18n.translate("xpack.infra.waffle.checkNewDataButtonLabel",{defaultMessage:"Check for new data"}),onRefetch:()=>{l()},testString:"noMetricsDataPrompt"});const k=rr(i),O=e?k:t,M=["xs","s"].includes(h);return"table"===o?r.a.createElement(Gd,null,r.a.createElement(nr,{nodeType:s,nodes:i,options:u,formatter:d,currentTime:c,onFilter:x})):r.a.createElement(Hd,{positionStatic:M},r.a.createElement(Jn,{nodeType:s,nodes:i,detailsItemId:y,options:u,formatter:d,currentTime:c,onFilter:x,bounds:O,bottomMargin:p,staticHeight:M}),"host"===s&&y&&r.a.createElement(qd,{assetName:y,assetType:s,closeFlyout:v,currentTime:c,isAutoReloading:b,options:u,refreshInterval:f}),r.a.createElement(wr,{formatter:d,bounds:O,dataBounds:k,legend:u.legend}))},Gd=Z.euiStyled.div`
  padding: ${e=>e.theme.eui.euiSizeL};
`,Hd=Z.euiStyled.div`
  position: ${e=>e.positionStatic?"static":"absolute"};
  display: flex;
  top: 0;
  right: 0;
  bottom: 0;
  left: 0;
`,Wd=v.type({value:v.string,name:v.string}),Qd=v.type({accounts:v.array(Wd),projects:v.array(v.string),regions:v.array(v.string)});v.type({sourceId:v.string,nodeType:u.ItemTypeRT,currentTime:v.number});var Jd=a(33);const Kd={avg:W.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.avg",{defaultMessage:"Average"}),max:W.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.max",{defaultMessage:"Max"}),min:W.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.min",{defaultMessage:"Min"}),rate:W.i18n.translate("xpack.infra.waffle.customMetrics.aggregationLables.rate",{defaultMessage:"Rate"})},Yd=Object(Z.withTheme)((({theme:e,onCancel:t,fields:a,onChange:i,metric:s})=>{const[l,o]=Object(n.useState)(s?s.label:void 0),[c,u]=Object(n.useState)(s?s.aggregation:"avg"),[d,m]=Object(n.useState)(s?s.field:void 0),p=Object(n.useCallback)((()=>{if(s&&c&&d)i({...s,label:l,aggregation:c,field:d});else if(c&&d){const e={type:"custom",id:Object(Xe.v4)(),label:l,aggregation:c,field:d};i(e)}}),[s,c,d,i,l]),g=Object(n.useCallback)((e=>{o(e.target.value)}),[o]),f=Object(n.useCallback)((e=>{m(e[0].label)}),[m]),b=Object(n.useCallback)((e=>{const t=e.target.value,a=Jd.c.is(t)?t:"avg";u(a)}),[u]),h=a.filter((e=>e.aggregatable&&"number"===e.type&&!(d&&d===e.name))).map((e=>({label:e.name}))),y=Jd.b.map((e=>({text:Kd[e],value:e}))),E=!d||!c,v=s?W.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.edit",{defaultMessage:"Edit custom metric"}):W.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.add",{defaultMessage:"Add custom metric"}),x=s?W.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.editAriaLabel",{defaultMessage:"Back to custom metrics edit mode"}):W.i18n.translate("xpack.infra.waffle.customMetricPanelLabel.addAriaLabel",{defaultMessage:"Back to metric picker"});return r.a.createElement("div",{style:{width:685}},r.a.createElement(Y.EuiForm,null,r.a.createElement(Y.EuiPopoverTitle,null,r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraCustomMetricFormButton",iconType:"arrowLeft",onClick:t,color:"text",size:"xs",flush:"left",style:{fontWeight:700,textTransform:"uppercase"},"aria-label":x},v)),r.a.createElement("div",{style:{padding:null==e?void 0:e.eui.euiSizeM,borderBottom:`${null==e?void 0:e.eui.euiBorderWidthThin} solid ${null==e?void 0:e.eui.euiBorderColor}`}},r.a.createElement(Y.EuiFormRow,{label:W.i18n.translate("xpack.infra.waffle.customMetrics.metricLabel",{defaultMessage:"Metric"}),display:"rowCompressed",fullWidth:!0},r.a.createElement(Y.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiSelect,{"data-test-subj":"infraCustomMetricFormSelect",onChange:b,value:c,options:y,fullWidth:!0})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiText,{color:"subdued"},r.a.createElement("span",null,"of"))),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiComboBox,{fullWidth:!0,placeholder:W.i18n.translate("xpack.infra.waffle.customMetrics.fieldPlaceholder",{defaultMessage:"Select a field"}),singleSelection:{asPlainText:!0},selectedOptions:d?[{label:d}]:[],options:h,onChange:f,isClearable:!1})))),r.a.createElement(Y.EuiFormRow,{label:W.i18n.translate("xpack.infra.waffle.customMetrics.labelLabel",{defaultMessage:"Label (optional)"}),display:"rowCompressed",fullWidth:!0},r.a.createElement(Y.EuiFieldText,{"data-test-subj":"infraCustomMetricFormFieldText",name:"label",placeholder:W.i18n.translate("xpack.infra.waffle.customMetrics.labelPlaceholder",{defaultMessage:'Choose a name to appear in the "Metric" dropdown'}),value:l,fullWidth:!0,onChange:g}))),r.a.createElement("div",{style:{padding:null==e?void 0:e.eui.euiSizeM,textAlign:"right"}},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraCustomMetricFormCancelButton",onClick:t,size:"s",style:{paddingRight:null==e?void 0:e.eui.euiSizeXL}},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.cancelLabel",defaultMessage:"Cancel"})),r.a.createElement(Y.EuiButton,{"data-test-subj":"infraCustomMetricFormSaveButton",type:"submit",size:"s",fill:!0,onClick:p,disabled:E},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.submitLabel",defaultMessage:"Save"})))))})),Xd=({onClose:e,onChange:t,metric:a,options:i,customMetrics:s})=>{const l=Jd.d.is(a)&&a.id?a.id:a.type,o=Object(n.useCallback)((a=>{if(u.SnapshotMetricTypeRT.is(a))t({type:a});else{const e=s.find((e=>e.id===a));e&&t(e)}e()}),[s,t,e]),c=[{id:0,title:"",items:[...i.map((e=>{const t=e.value===l?"check":"empty";return{name:e.text,onClick:()=>o(e.value),icon:t}})),...s.map((e=>{const t=e.id===l?"check":"empty";return{name:Object(Ja.a)(e),onClick:()=>o(e.id),icon:t}}))]}];return r.a.createElement(Y.EuiContextMenu,{initialPanelId:0,panels:c})},Zd=Object(Z.withTheme)((({onSave:e,onEditCancel:t,onEdit:a,onAdd:n,mode:i,customMetrics:s,theme:l})=>["editMetric","addMetric"].includes(i)?null:r.a.createElement("div",{style:{borderTop:`${null==l?void 0:l.eui.euiBorderWidthThin} solid ${null==l?void 0:l.eui.euiBorderColor}`,padding:12}},r.a.createElement(Y.EuiFlexGroup,{justifyContent:"spaceBetween"},"edit"===i?r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraModeSwitcherCancelButton",size:"s",flush:"left",onClick:t,"aria-label":W.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.cancelAriaLabel",{defaultMessage:"Cancel edit mode"})},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.cancel",defaultMessage:"Cancel"}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,{"data-test-subj":"infraModeSwitcherSaveButton",onClick:e,size:"s",fill:!0,"aria-label":W.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.saveButtonAriaLabel",{defaultMessage:"Save changes to custom metrics"})},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.saveButton",defaultMessage:"Save"})))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraModeSwitcherEditButton",size:"s",flush:"left",onClick:a,disabled:0===s.length,"aria-label":W.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.editAriaLabel",{defaultMessage:"Edit custom metrics"})},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.edit",defaultMessage:"Edit"}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraModeSwitcherAddMetricButton",onClick:n,size:"s",flush:"right","aria-label":W.i18n.translate("xpack.infra.waffle.customMetrics.modeSwitcher.addMetricAriaLabel",{defaultMessage:"Add custom metric"})},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.waffle.customMetrics.modeSwitcher.addMetric",defaultMessage:"Add metric"})))))))),em=Object(Z.withTheme)((({theme:e,customMetrics:t,options:a,onEdit:n,onDelete:i})=>r.a.createElement("div",{style:{width:256}},a.map((t=>r.a.createElement("div",{key:t.value,style:{padding:"14px 14px 13px 36px"}},r.a.createElement("span",{style:{color:null==e?void 0:e.eui.euiButtonColorDisabled}},t.text)))),t.map((e=>r.a.createElement(Y.EuiFlexGroup,{key:e.id,alignItems:"center",gutterSize:"none",style:{padding:"10px 0px 9px"}},r.a.createElement(Y.EuiFlexItem,{grow:!1,style:{width:36}},r.a.createElement(Y.EuiButtonIcon,{"data-test-subj":"infraMetricsEditModeButton",iconType:"pencil",onClick:()=>n(e),"aria-label":W.i18n.translate("xpack.infra.waffle.customMetrics.editMode.editButtonAriaLabel",{defaultMessage:"Edit custom metric for {name}",values:{name:Object(Ja.a)(e)}})})),r.a.createElement(Y.EuiFlexItem,{grow:1,style:{overflow:"hidden"}},Object(Ja.a)(e)),r.a.createElement(Y.EuiFlexItem,{grow:!1,style:{width:36,textAlign:"right"}},r.a.createElement(Y.EuiButtonIcon,{"data-test-subj":"infraMetricsEditModeButton",iconType:"trash",color:"danger",onClick:()=>i(e),"aria-label":W.i18n.translate("xpack.infra.waffle.customMetrics.editMode.deleteAriaLabel",{defaultMessage:"Delete custom metric for {name}",values:{name:Object(Ja.a)(e)}})})))))))),tm=({children:e})=>{const[t,a]=_a()("isKubernetesTourSeen",!1),n=()=>a(!0);return r.a.createElement("div",null,r.a.createElement(Y.EuiTourStep,{content:r.a.createElement(Y.EuiText,{size:"s",color:"subdued","data-test-subj":"infra-kubernetesTour-text"},W.i18n.translate("xpack.infra.homePage.kubernetesTour.text",{defaultMessage:"Click here to see your infrastructure in different ways, including Kubernetes pods."})),isStepOpen:!t,maxWidth:350,onFinish:n,step:1,stepsTotal:1,title:W.i18n.translate("xpack.infra.homePage.kubernetesTour.title",{defaultMessage:"Want a different view?"}),anchorPosition:"downCenter",footerAction:r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infra-kubernetesTour-dismiss",size:"s",color:"text",onClick:n},W.i18n.translate("xpack.infra.homePage.kubernetesTour.dismiss",{defaultMessage:"Dismiss"}))},e))},am=({label:e,theme:t})=>r.a.createElement(Y.EuiFlexItem,{grow:!1,style:{padding:12,background:null==t?void 0:t.eui.euiFormInputGroupLabelBackground,fontSize:"0.75em",fontWeight:600,color:null==t?void 0:t.eui.euiTitleColor}},e),nm=Object(Z.withTheme)((e=>{const{onClick:t,label:a,theme:n,children:i,showKubernetesInfo:s}=e;return r.a.createElement(Y.EuiFlexGroup,{alignItems:"center",gutterSize:"none",style:{border:null==n?void 0:n.eui.euiFormInputGroupBorder,boxShadow:`0px 3px 2px ${null==n?void 0:n.eui.euiTableActionsBorderColor}, 0px 1px 1px ${null==n?void 0:n.eui.euiTableActionsBorderColor}`}},s?r.a.createElement(tm,null,r.a.createElement(am,{label:a,theme:n})):r.a.createElement(am,{label:a,theme:n}),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":e["data-test-subj"],color:"text",iconType:"arrowDown",onClick:t,iconSide:"right",size:"xs"},i)))})),rm=({fields:e,onChange:t,onChangeCustomMetrics:a,metric:i,options:s,customMetrics:l})=>{var o;const[c,u]=Object(n.useState)(!1),[d,m]=Object(n.useState)("pick"),[p,g]=Object(n.useState)([]),[f,b]=Object(n.useState)(),h=Object(n.useCallback)((()=>{u(!1)}),[u]),y=Object(n.useCallback)((()=>{u(!c)}),[c]),E=Object(n.useCallback)((e=>{a([...l,e]),t(e),m("pick")}),[l,t,a,m]),v=Object(n.useCallback)((()=>{m("edit"),g(l)}),[l]),x=Object(n.useCallback)((()=>{m("addMetric")}),[m]),w=Object(n.useCallback)((()=>{m("pick"),g([])}),[m]),k=Object(n.useCallback)((e=>{Jd.d.is(i)&&e.id===i.id&&t({type:s[0].value});const a=p.filter((t=>t.id!==e.id));g(a)}),[p,i,t,s]),O=Object(n.useCallback)((e=>{const t=l.map((t=>t.id===e.id&&e||t));a(t),w(),b(void 0),g([])}),[l,a,w]),M=Object(n.useCallback)((e=>{b(e),m("editMetric")}),[m,b]),j=Object(n.useCallback)((()=>{a(p),m("pick")}),[p,a]);if(!s.length||!i.type)throw Error(W.i18n.translate("xpack.infra.waffle.unableToSelectMetricErrorTitle",{defaultMessage:"Unable to select options or value for metric."}));const S=Jd.d.is(i)&&i.id?i.id:i.type,C=Jd.d.is(i)?Object(Ja.a)(i):null===(o=s.find((e=>e.value===S)))||void 0===o?void 0:o.text;if(!C)return null;const T=r.a.createElement(nm,{onClick:y,label:W.i18n.translate("xpack.infra.waffle.metriclabel",{defaultMessage:"Metric"})},C);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiPopover,{isOpen:c,id:"metricsPanel",button:T,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:h},"pick"===d?r.a.createElement(Xd,{onChange:t,onClose:h,metric:i,customMetrics:l,options:s}):null,"addMetric"===d?r.a.createElement(Yd,{fields:e,customMetrics:l,onChange:E,onCancel:w}):null,"editMetric"===d?r.a.createElement(Yd,{metric:f,fields:e,customMetrics:l,onChange:O,onCancel:v}):null,"edit"===d?r.a.createElement(em,{customMetrics:p,options:s,onEdit:M,onDelete:k}):null,r.a.createElement(Zd,{onEditCancel:w,onEdit:v,onAdd:x,mode:d,onSave:j,customMetrics:l})))},im={selectedOptions:[]};class custom_field_panel_CustomFieldPanel extends r.a.PureComponent{constructor(...e){super(...e),Ua()(this,"state",im),Ua()(this,"handleSubmit",(()=>{this.props.onSubmit(this.state.selectedOptions[0].label)})),Ua()(this,"handleFieldSelection",(e=>{this.setState({selectedOptions:e})}))}render(){const{fields:e,currentOptions:t}=this.props,a=e.filter((e=>e.aggregatable&&"string"===e.type&&!(t&&t.some((t=>t.field===e.name))))).map((e=>({label:e.name}))),n=!this.state.selectedOptions.length;return r.a.createElement("div",{style:{padding:16}},r.a.createElement(Y.EuiForm,null,r.a.createElement(Y.EuiFormRow,{label:W.i18n.translate("xpack.infra.waffle.customGroupByFieldLabel",{defaultMessage:"Field"}),helpText:W.i18n.translate("xpack.infra.waffle.customGroupByHelpText",{defaultMessage:"This is the field used for the terms aggregation"}),display:"rowCompressed",fullWidth:!0},r.a.createElement(Y.EuiComboBox,{"data-test-subj":"groupByCustomField",placeholder:W.i18n.translate("xpack.infra.waffle.customGroupByDropdownPlacehoder",{defaultMessage:"Select one"}),singleSelection:{asPlainText:!0},selectedOptions:this.state.selectedOptions,options:a,onChange:this.handleFieldSelection,fullWidth:!0,isClearable:!1})),r.a.createElement(Y.EuiButton,{"data-test-subj":"groupByCustomFieldAddButton",disabled:n,type:"submit",size:"s",fill:!0,onClick:this.handleSubmit},"Add")))}}Ua()(custom_field_panel_CustomFieldPanel,"displayName","CustomFieldPanel");const sm={isPopoverOpen:!1};class waffle_group_by_controls_WaffleGroupByControls extends r.a.PureComponent{constructor(...e){super(...e),Ua()(this,"state",sm),Ua()(this,"handleRemove",(e=>()=>{const{groupBy:t}=this.props;this.props.onChange(t.filter((t=>t.field!==e)));const a=this.props.customOptions.filter((t=>t.field!==e));this.props.onChangeCustomOptions(a),setTimeout((()=>this.handleClose()))})),Ua()(this,"handleClose",(()=>{this.setState({isPopoverOpen:!1})})),Ua()(this,"handleToggle",(()=>{this.setState((e=>({isPopoverOpen:!e.isPopoverOpen})))})),Ua()(this,"handleCustomField",(e=>{const t=[...this.props.customOptions,{text:e,field:e}];this.props.onChangeCustomOptions(t),this.handleClick(e)()})),Ua()(this,"handleClick",(e=>()=>{const{groupBy:t}=this.props;t.some((t=>t.field===e))?this.handleRemove(e)():this.props.groupBy.length<2&&this.props.onChange([...t,{field:e}]),this.handleClose()}))}render(){const{nodeType:e,groupBy:t}=this.props,a=this.props.customOptions.map((e=>({...e,toolTipContent:e.text}))),n=this.props.options.concat(a);if(!n.length)throw Error(W.i18n.translate("xpack.infra.waffle.unableToSelectGroupErrorMessage",{defaultMessage:"Unable to select group by options for {nodeType}",values:{nodeType:e}}));const i=t.length>=2,s=W.i18n.translate("xpack.infra.waffle.maxGroupByTooltip",{defaultMessage:"Only two groupings can be selected at a time"}),l=[{id:"firstPanel",title:W.i18n.translate("xpack.infra.waffle.selectTwoGroupingsTitle",{defaultMessage:"Select up to two groupings"}),items:[{name:W.i18n.translate("xpack.infra.waffle.customGroupByOptionName",{defaultMessage:"Custom field"}),disabled:i,toolTipContent:i?s:null,icon:"empty",panel:"customPanel"},...n.map((e=>{const a=t.some((t=>t.field===e.field))?"check":"empty",n={name:e.text,onClick:this.handleClick(e.field),icon:a};return e.toolTipContent&&(n.toolTipContent=e.toolTipContent),i&&"empty"===a&&(n.toolTipContent=s,n.disabled=!0),n}))]},{id:"customPanel",title:W.i18n.translate("xpack.infra.waffle.customGroupByPanelTitle",{defaultMessage:"Group By Custom Field"}),width:685,content:r.a.createElement(custom_field_panel_CustomFieldPanel,{currentOptions:this.props.customOptions,onSubmit:this.handleCustomField,fields:this.props.fields})}],o=t.length>0?t.map((e=>n.find((t=>t.field===e.field)))).filter((e=>null!=e)).map((e=>r.a.createElement(Y.EuiBadge,{color:"hollow",key:e&&e.field},e&&e.text))):r.a.createElement(X.FormattedMessage,{id:"xpack.infra.waffle.groupByAllTitle",defaultMessage:"All"}),c=r.a.createElement(nm,{label:W.i18n.translate("xpack.infra.waffle.groupByLabel",{defaultMessage:"Group by"}),onClick:this.handleToggle,"data-test-subj":"waffleGroupByDropdown"},o);return r.a.createElement(Y.EuiPopover,{isOpen:this.state.isPopoverOpen,id:"groupByPanel",button:c,panelPaddingSize:"none",closePopover:this.handleClose},r.a.createElement(lm,{initialPanelId:"firstPanel",panels:l,"data-test-subj":"groupByContextMenu"}))}}Ua()(waffle_group_by_controls_WaffleGroupByControls,"displayName","WaffleGroupByControls");const lm=Object(Z.euiStyled)(Y.EuiContextMenu)`
  width: 320px;
  & .euiContextMenuItem__text {
    overflow: hidden;
    text-overflow: ellipsis;
  }
`,om={name:W.i18n.translate("xpack.infra.waffle.sortNameLabel",{defaultMessage:"Name"}),value:W.i18n.translate("xpack.infra.waffle.sort.valueLabel",{defaultMessage:"Metric value"})},cm=({sort:e,onChange:t})=>{const[a,i]=Object(n.useState)(!1),s=Object(n.useCallback)((()=>i((e=>!e))),[]),l=Object(n.useCallback)((()=>i(!1)),[]),o=om[e.by],c=r.a.createElement(nm,{label:W.i18n.translate("xpack.infra.waffle.sortLabel",{defaultMessage:"Sort by"}),onClick:s,"data-test-subj":"waffleSortByDropdown"},o),u=Object(n.useCallback)((()=>{t({...e,by:"name"}),l()}),[l,t,e]),d=Object(n.useCallback)((()=>{t({...e,by:"value"}),l()}),[l,t,e]),m=Object(n.useCallback)((()=>{t({...e,direction:"asc"===e.direction?"desc":"asc"}),l()}),[l,e,t]),p=Object(n.useMemo)((()=>[{id:0,title:"",items:[{name:om.name,icon:"name"===e.by?"check":"empty",onClick:u,"data-test-subj":"waffleSortByName"},{name:om.value,icon:"value"===e.by?"check":"empty",onClick:d,"data-test-subj":"waffleSortByValue"}]}]),[e.by,u,d]);return r.a.createElement(Y.EuiPopover,{isOpen:a,id:"sortPopover",button:c,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:l},r.a.createElement(Y.EuiContextMenu,{initialPanelId:0,panels:p}),r.a.createElement(um,null,r.a.createElement(Y.EuiSwitch,{compressed:!0,label:W.i18n.translate("xpack.infra.waffle.sortDirectionLabel",{defaultMessage:"Reverse direction"}),checked:"desc"===e.direction,onChange:m,"data-test-subj":"waffleSortByDirection"})))},um=Object(Z.withTheme)((({children:e,theme:t})=>r.a.createElement("div",{style:{padding:null==t?void 0:t.eui.euiSizeM,borderTop:`1px solid ${null==t?void 0:t.eui.euiBorderColor}`}},e))),dm=e=>Object(u.findInventoryModel)(e).displayName,mm=()=>{const{changeNodeType:e,changeGroupBy:t,changeMetric:a,changeAccount:i,changeRegion:s,changeCustomMetrics:l,nodeType:o}=Object(en.d)(),[c,d]=Object(n.useState)(!1),m=Object(n.useCallback)((()=>d(!1)),[]),p=Object(n.useCallback)((()=>d((e=>!e))),[]),g=Object(n.useCallback)((n=>{m(),e(n),t([]),l([]),i(""),s("");const r=Object(u.findInventoryModel)(n);a({type:r.metrics.defaultSnapshot})}),[m,e,t,l,i,s,a]),f=Object(n.useCallback)((()=>g("host")),[g]),b=Object(n.useCallback)((()=>g("pod")),[g]),h=Object(n.useCallback)((()=>g("container")),[g]),y=Object(n.useCallback)((()=>g("awsEC2")),[g]),E=Object(n.useCallback)((()=>g("awsS3")),[g]),v=Object(n.useCallback)((()=>g("awsRDS")),[g]),x=Object(n.useCallback)((()=>g("awsSQS")),[g]),w=Object(n.useMemo)((()=>[{id:"firstPanel",items:[{"data-test-subj":"goToHost",name:dm("host"),onClick:f},{"data-test-subj":"goToPods",name:dm("pod"),onClick:b},{"data-test-subj":"goToDocker",name:dm("container"),onClick:h},{name:"AWS",panel:"awsPanel","data-test-subj":"goToAWS-open"}]},{id:"awsPanel",title:"AWS",items:[{name:dm("awsEC2"),onClick:y,"data-test-subj":"goToAWS-EC2"},{name:dm("awsS3"),onClick:E,"data-test-subj":"goToAWS-S3"},{name:dm("awsRDS"),onClick:v,"data-test-subj":"goToAWS-RDS"},{name:dm("awsSQS"),onClick:x,"data-test-subj":"goToAWS-SQS"}]}]),[y,v,E,x,h,f,b]),k=Object(n.useMemo)((()=>dm(o)),[o]),O=r.a.createElement(nm,{"data-test-subj":"openInventorySwitcher",onClick:p,label:W.i18n.translate("xpack.infra.waffle.showLabel",{defaultMessage:"Show"}),showKubernetesInfo:!0},k);return r.a.createElement(Y.EuiPopover,{id:"contextMenu",button:O,isOpen:c,closePopover:m,panelPaddingSize:"none",anchorPosition:"downLeft"},r.a.createElement(Y.EuiContextMenu,{initialPanelId:"firstPanel",panels:w}))},pm=e=>{const{changeMetric:t,changeGroupBy:a,changeCustomOptions:n,changeAccount:i,changeRegion:s,changeSort:l,customOptions:o,groupBy:c,metric:u,nodeType:d,accountId:m,view:p,region:g,legend:f,sort:b,customMetrics:h,changeCustomMetrics:y}=Object(en.d)(),{createDerivedIndexPattern:E}=Object(re.b)();return r.a.createElement(Y.EuiFlexGroup,{responsive:!1,wrap:!0,gutterSize:"m"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(mm,null)),e.children({createDerivedIndexPattern:E,changeMetric:t,changeGroupBy:a,changeAccount:i,changeRegion:s,changeCustomOptions:n,changeSort:l,customOptions:o,groupBy:c,sort:b,view:p,metric:u,nodeType:d,region:g,accountId:m,legend:f,customMetrics:h,changeCustomMetrics:y}))},gm=e=>({text:er(e),field:e}),fm=e=>{const t=Object(n.useMemo)((()=>e.metricTypes.map(Xa.a).filter((e=>e))),[e.metricTypes]),a=Object(n.useMemo)((()=>e.groupByFields.map(gm)),[e.groupByFields]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(rm,{fields:e.createDerivedIndexPattern().fields,options:t,metric:e.metric,onChange:e.changeMetric,onChangeCustomMetrics:e.changeCustomMetrics,customMetrics:e.customMetrics})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(waffle_group_by_controls_WaffleGroupByControls,{options:a,groupBy:e.groupBy,nodeType:e.nodeType,onChange:e.changeGroupBy,fields:e.createDerivedIndexPattern().fields,onChangeCustomOptions:e.changeCustomOptions,customOptions:e.customOptions})),"map"===e.view&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(cm,{sort:e.sort,onChange:e.changeSort})))},bm=e=>{const{accountId:t,options:a}=e,[i,s]=Object(n.useState)(!1),l=Object(n.useCallback)((()=>{s(!0)}),[s]),o=Object(n.useCallback)((()=>{s(!1)}),[s]),c=a.find((e=>e.value===t)),u=Object(n.useCallback)((a=>{t===a?e.changeAccount(""):e.changeAccount(a),o()}),[t,o,e]),d=Object(n.useMemo)((()=>[{id:0,title:"",items:a.map((e=>{const a=e.value===t?"check":"empty";return{name:e.name,onClick:()=>u(e.value),icon:a}}))}]),[a,t,u]),m=r.a.createElement(nm,{label:W.i18n.translate("xpack.infra.waffle.accountLabel",{defaultMessage:"Account"}),onClick:l},c?c.name:W.i18n.translate("xpack.infra.waffle.accountAllTitle",{defaultMessage:"All"}));return r.a.createElement(Y.EuiPopover,{isOpen:i,id:"accontPopOver",button:m,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:o},r.a.createElement(Y.EuiContextMenu,{initialPanelId:0,panels:d}))},hm=e=>{const{region:t,options:a}=e,[i,s]=Object(n.useState)(!1),l=Object(n.useCallback)((()=>{s(!0)}),[s]),o=Object(n.useCallback)((()=>{s(!1)}),[s]),c=a.find((e=>t===e)),u=Object(n.useCallback)((a=>{t===a?e.changeRegion(""):e.changeRegion(a),o()}),[t,o,e]),d=Object(n.useMemo)((()=>[{id:0,title:"",items:a.map((e=>({name:e,onClick:()=>u(e),icon:e===t?"check":"empty"})))}]),[u,a,t]),m=r.a.createElement(nm,{onClick:l,label:W.i18n.translate("xpack.infra.waffle.regionLabel",{defaultMessage:"Region"})},c||W.i18n.translate("xpack.infra.waffle.region",{defaultMessage:"All"}));return r.a.createElement(Y.EuiPopover,{isOpen:i,id:"regionPanel",button:m,anchorPosition:"downLeft",panelPaddingSize:"none",closePopover:o},r.a.createElement(Y.EuiContextMenu,{initialPanelId:0,panels:d}))},ym=e=>r.a.createElement(r.a.Fragment,null,e.accounts.length>0&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(bm,{changeAccount:e.changeAccount,accountId:e.accountId,options:e.accounts})),e.regions.length>0&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(hm,{changeRegion:e.changeRegion,region:e.region,options:e.regions}))),Em=["cloud.availability_zone","cloud.machine.type","aws.ec2.instance.image.id","aws.ec2.instance.state.name"],vm=e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(ym,e),r.a.createElement(fm,de()({},e,{metricTypes:u.awsEC2SnapshotMetricTypes,groupByFields:Em}))),xm=["cloud.availability_zone","aws.rds.db_instance.class","aws.rds.db_instance.status"],wm=e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(ym,e),r.a.createElement(fm,de()({},e,{metricTypes:u.awsRDSSnapshotMetricTypes,groupByFields:xm}))),km=["cloud.region"],Om=e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(ym,e),r.a.createElement(fm,de()({},e,{metricTypes:u.awsS3SnapshotMetricTypes,groupByFields:km}))),Mm=["cloud.region"],jm=e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(ym,e),r.a.createElement(fm,de()({},e,{metricTypes:u.awsSQSSnapshotMetricTypes,groupByFields:Mm}))),Sm=["host.name","cloud.availability_zone","cloud.machine.type","cloud.project.id","cloud.provider","service.type"],Cm=e=>r.a.createElement(fm,de()({},e,{metricTypes:u.containerSnapshotMetricTypes,groupByFields:Sm})),Tm=["cloud.availability_zone","cloud.machine.type","cloud.project.id","cloud.provider","service.type"],Im=e=>r.a.createElement(fm,de()({},e,{metricTypes:u.hostSnapshotMetricTypes,groupByFields:Tm})),Fm=["kubernetes.namespace","kubernetes.node.name","service.type"],Lm=e=>r.a.createElement(fm,de()({},e,{metricTypes:u.podSnapshotMetricTypes,groupByFields:Fm})),Pm=({nodeType:e,currentTime:t})=>{const{sourceId:a}=Object(re.b)(),{accounts:i,regions:s}=function(e,t,a){const{error:r,loading:i,response:s,makeRequest:l}=Object(ol.a)("/api/infra/inventory/meta","POST",JSON.stringify({sourceId:e,nodeType:t,currentTime:a}),(e=>Object(x.pipe)(Qd.decode(e),Object(w.fold)(Object(pi.d)(pi.a),k.identity))));return Object(n.useEffect)((()=>{l()}),[l]),{error:r,loading:i,accounts:s?s.accounts:[],regions:s?s.regions:[],makeRequest:l}}(a,e,t);return r.a.createElement(pm,null,(e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Dm,de()({},e,{accounts:i,regions:s})),r.a.createElement(Y.EuiFlexItem,{grow:!0}))))},Dm=e=>{switch(e.nodeType){case"awsEC2":return r.a.createElement(vm,e);case"awsRDS":return r.a.createElement(wm,e);case"awsS3":return r.a.createElement(Om,e);case"awsSQS":return r.a.createElement(jm,e);case"container":return r.a.createElement(Cm,e);case"host":return r.a.createElement(Im,e);case"pod":return r.a.createElement(Lm,e)}},_m=({view:e,onChange:t})=>{const a=[{id:"map",label:W.i18n.translate("xpack.infra.viewSwitcher.mapViewLabel",{defaultMessage:"Map view"}),iconType:"grid"},{id:"table",label:W.i18n.translate("xpack.infra.viewSwitcher.tableViewLabel",{defaultMessage:"Table view"}),iconType:"visTable"}];return r.a.createElement(Y.EuiButtonGroup,{legend:W.i18n.translate("xpack.infra.viewSwitcher.lenged",{defaultMessage:"Switch between table and map view"}),options:a,color:"text",buttonSize:"s",idSelected:e,onChange:t,isIconOnly:!0})},Rm=(e="cool",t=10)=>{switch(e){case"temperature":return Object(Y.euiPaletteForTemperature)(t);case"status":return Object(Y.euiPaletteForStatus)(t);case"warm":return Object(Y.euiPaletteWarm)(t);case"positive":return Object(Y.euiPalettePositive)(t);case"negative":return Object(Y.euiPaletteNegative)(t);default:return Object(Y.euiPaletteCool)(t)}},Am=(e="cool",t=10,a=!1)=>a?Rm(e,t).reverse():Rm(e,t),Bm=(e,t=10,a=!1)=>({type:"steppedGradient",rules:Am(e,t,a).map(((e,a)=>({color:e,value:(a+1)/t})))}),Vm=({iconType:e,tooltipPosition:t,tooltipContent:a})=>r.a.createElement(Y.EuiBetaBadge,{label:W.i18n.translate("xpack.infra.common.tabBetaBadgeLabel",{defaultMessage:"Beta"}),tooltipContent:a,iconType:e,tooltipPosition:t,"data-test-id":"infra-beta-badge"}),Nm=({label:e,link:t,color:a="primary",experimental:n=!1,hideBadge:i=!1,onClick:s,...l})=>{const o=Object(me.useLinkProps)({...t}),c=e=>{o.onClick&&o.onClick(e),s&&s(e)};return r.a.createElement(Y.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"m"},!i&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiLink,de()({"data-test-subj":`${l["data-test-subj"]}-badge`},o,{onClick:c}),r.a.createElement(zm,{color:"accent",label:W.i18n.translate("xpack.infra.layout.tryIt",{defaultMessage:"Try it"})}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiLink,de()({"data-test-subj":l["data-test-subj"]},o,{color:a,onClick:c}),r.a.createElement(Y.EuiFlexGroup,{wrap:!1,responsive:!1,gutterSize:"m",alignItems:"center"},n&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Vm,{iconType:"beta",tooltipPosition:"top"})),r.a.createElement(Y.EuiFlexItem,null,e)))))};var zm=Fa()(Y.EuiBetaBadge).withConfig({displayName:"_StyledEuiBetaBadge",componentId:"sc-1oy0wbd-0"})(["cursor:pointer;"]),$m=a(221);const qm=({interval:e,yAxisFormatter:t,isVisible:a})=>{var i,s;const{sourceId:l,source:o}=Object(re.b)(),{metric:c,nodeType:u,accountId:d,region:m}=Object(en.d)(),{currentTime:p,jumpToTime:g,stopAutoReload:f}=ia(),{filterQueryAsJson:b}=ha(),y=Object(Ge.a)(),{loading:E,error:v,startTime:x,endTime:w,timeseries:k,reload:O}=function(e,t,a,r,i,s,l,o,c){const u=Object(n.useMemo)((()=>(e=>e&&Object($m.a)(e)<300?"5m":e)(o)),[o]),d=Object(n.useMemo)((()=>(e=>{if(e){const t=Object($m.a)(e);return{timeLength:t<=900?86400:t<=2100?259200:t<=9e3?604800:2592e3,intervalInSeconds:t}}return{timeLength:0,intervalInSeconds:0}})(u)),[u]),{timeLength:m,intervalInSeconds:p}=d,g=i+1e3*p,f=i-1e3*m,b={interval:null!=u?u:"",to:g,from:f,forceInterval:!0},{nodes:h,error:y,loading:E,reload:v}=Object(Ka.a)({metrics:t,groupBy:null,currentTime:i,nodeType:a,timerange:b,filterQuery:e,sourceId:r,accountId:s,region:l,includeTimeseries:!0,sendRequestImmediately:!1},{abortable:!0});Object(n.useEffect)((()=>{(async()=>{c&&v()})()}),[v,c]);const x=h?Object(Ne.first)(h.map((e=>{var t;return null===(t=Object(Ne.first)(e.metrics))||void 0===t?void 0:t.timeseries}))):null;return{error:y||null,loading:!o||E,timeseries:x,startTime:f,endTime:g,reload:v}}(b,[c],u,l,p,d,m,e,a),M={sourceId:"default",anomalyThreshold:(null==o?void 0:o.configuration.anomalyThreshold)||0,startTime:x,endTime:w,defaultSortOptions:{direction:"desc",field:"anomalyScore"},defaultPaginationOptions:{pageSize:100}},{metricsHostsAnomalies:j,getMetricsHostsAnomalies:S}=vi(M),{metricsK8sAnomalies:C,getMetricsK8sAnomalies:T}=bi(M),I=Object(n.useMemo)((()=>"host"===u?S:"pod"===u?T:void 0),[u,T,S]),F=Object(n.useMemo)((()=>"host"===u?j:"pod"===u?C:void 0),[u,j,C]),L=null===(i=Object(Xa.a)(c.type))||void 0===i?void 0:i.textLC,P=null===(s=Object(Xa.a)(c.type))||void 0===s?void 0:s.text,D={color:Ze.a.color0,aggregation:"avg",label:P},_=Object(n.useMemo)((()=>{var e,t;if(!k)return()=>"";const a=null===(e=Object(Ne.first)(k.rows))||void 0===e?void 0:e.timestamp,n=null===(t=Object(Ne.last)(k.rows))||void 0===t?void 0:t.timestamp;return null==a||null==n?e=>`${e}`:Object(Ue.niceTimeFormatter)([a,n])}),[k]),R={headerFormatter:({value:e})=>h()(e).format("Y-MM-DD HH:mm:ss.SSS")},A=k?Object(bt.a)(k,[D],!1):null,B=A?{max:1.1*A.max,min:A.min}:{max:0,min:0},V=Object(n.useCallback)((([e])=>{const[t]=e;if(t&&!Array.isArray(t)){const{x:e}=t;g(e),f()}}),[g,f]),N=Object(n.useMemo)((()=>{const e=c.type;return"memory"===e?"memory_usage":"rx"===e?"network_in":"tx"===e?"network_out":void 0}),[c]);return Object(n.useEffect)((()=>{I&&N&&I(N)}),[I,N]),E?r.a.createElement(Um,null,r.a.createElement(Wm,null,r.a.createElement(Y.EuiLoadingChart,{size:"xl"}))):E||!v&&k?r.a.createElement(Um,{"data-test-subj":a?"timelineContainerOpen":"timelineContainerClosed"},r.a.createElement(Gm,null,r.a.createElement(Y.EuiFlexItem,{grow:!0},r.a.createElement(Y.EuiText,null,r.a.createElement("strong",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.inventoryTimeline.header",defaultMessage:"Average {metricLabel}",values:{metricLabel:L}})))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiFlexGroup,{alignItems:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiIcon,{color:Object(Ze.b)(D.color),type:"dot"})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiText,{size:"xs"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.inventoryTimeline.header",defaultMessage:"Average {metricLabel}",values:{metricLabel:L}}))))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1,style:{backgroundColor:"#D36086",height:5,width:10}}),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiText,{size:"xs"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.inventoryTimeline.legend.anomalyLabel",defaultMessage:"Anomaly detected"})))))))),r.a.createElement(Hm,null,r.a.createElement(Ue.Chart,null,F&&r.a.createElement(Ue.RectAnnotation,{id:"anomalies",dataValues:(z=F.map((e=>[e.startTime,e.influencers])),z.map((e=>{const[t,a]=e;return{coordinates:{x0:t,x1:h()(t).add(15,"minutes").valueOf(),y0:null==A?void 0:A.min,y1:null==A?void 0:A.max},details:a.join(",")}}))),style:{fill:"#D36086"}}),r.a.createElement(Et.a,{type:he.a.area,metric:D,id:"0",series:k,stack:!1}),r.a.createElement(Ue.Axis,{id:"timestamp",position:Ue.Position.Bottom,showOverlappingTicks:!0,tickFormat:_}),r.a.createElement(Ue.Axis,{id:"values",position:Ue.Position.Left,tickFormat:t,domain:B,ticks:6,gridLine:{visible:!0}}),r.a.createElement(Ue.Tooltip,R),r.a.createElement(Ue.Settings,{onElementClick:V,baseTheme:y.baseTheme,theme:y.theme,locale:W.i18n.getLocale()})))):r.a.createElement(Um,null,r.a.createElement(Y.EuiEmptyPrompt,{iconType:"visArea",title:r.a.createElement("h4",null,v?Jm:Qm),actions:r.a.createElement(Y.EuiButton,{"data-test-subj":"infraTimelineButton",color:"primary",fill:!0,onClick:O},v?Ym:Km)}));var z},Um=Z.euiStyled.div`
  background-color: ${e=>e.theme.eui.euiPageBackgroundColor};
  border-top: 1px solid ${e=>e.theme.eui.euiColorLightShade};
  height: 220px;
  width: 100%;
  padding: ${e=>e.theme.eui.euiSizeS} ${e=>e.theme.eui.euiSizeM};
  display: flex;
  flex-direction: column;
`,Gm=Z.euiStyled.div`
  display: flex;
  width: 100%;
  padding: ${e=>e.theme.eui.euiSizeS} ${e=>e.theme.eui.euiSizeM};
  @media only screen and (max-width: 767px) {
      margin-top: 30px;
  }
`,Hm=Z.euiStyled.div`
  padding-left: ${e=>e.theme.eui.euiSizeXS};
  width: 100%;
  height: 100%;
`,Wm=Z.euiStyled.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100%;
`,Qm=W.i18n.translate("xpack.infra.inventoryTimeline.noHistoryDataTitle",{defaultMessage:"There is no historical data to display."}),Jm=W.i18n.translate("xpack.infra.inventoryTimeline.errorTitle",{defaultMessage:"Unable to show historical data."}),Km=W.i18n.translate("xpack.infra.inventoryTimeline.checkNewDataButtonLabel",{defaultMessage:"Check for new data"}),Ym=W.i18n.translate("xpack.infra.inventoryTimeline.retryButtonLabel",{defaultMessage:"Try again"}),Xm=W.i18n.translate("xpack.infra.showHistory",{defaultMessage:"Show history"}),Zm=W.i18n.translate("xpack.infra.hideHistory",{defaultMessage:"Hide history"}),ep=()=>{const[e,t]=_a()("inventoryUI:k8sDashboardClicked",!1),a=Object(n.useRef)(e);return r.a.createElement(Nm,{color:a.current?"primary":"accent",label:W.i18n.translate("xpack.infra.bottomDrawer.kubernetesDashboardsLink",{defaultMessage:"Kubernetes dashboards"}),"data-test-subj":"inventory-kubernetesDashboard-link",link:{app:"dashboards",hash:"/list",search:{_g:"()",s:"kubernetes tag:(Managed)"}},onClick:()=>{a.current||t(!0)},hideBadge:a.current})},tp=({interval:e,formatter:t,view:a,nodeType:i})=>{const{timelineOpen:s,changeTimelineOpen:l}=Object(en.d)(),[o,c]=Object(n.useState)(Boolean(s));Object(n.useEffect)((()=>{o!==s&&c(Boolean(s))}),[o,s]);const u=Object(me.useUiTracker)({app:"infra_metrics"}),d=Object(n.useCallback)((()=>{o||u({metric:"open_timeline_drawer__inventory"}),c(!o),l(!o)}),[o,u,l]);return"table"===a?"pod"===i?r.a.createElement(np,{hasBorder:!1,hasShadow:!1,borderRadius:"none",paddingSize:"s"},r.a.createElement(ep,null)):null:r.a.createElement(ap,null,r.a.createElement(rp,{borderRadius:"none",paddingSize:"s"},r.a.createElement(Y.EuiFlexGroup,{responsive:!1,justifyContent:"flexStart",alignItems:"center"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButtonEmpty,{"aria-expanded":o,iconType:o?"arrowDown":"arrowRight",onClick:d,"data-test-subj":"toggleTimelineButton"},o?Zm:Xm)),"pod"===i&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(ep,null)))),r.a.createElement(Y.EuiFlexGroup,{style:{maxHeight:o?"224px":0,transition:"max-height 0.15s ease",overflow:"hidden"}},r.a.createElement(qm,{isVisible:o,interval:e,yAxisFormatter:t})))},ap=Z.euiStyled.div`
  position: sticky;
  bottom: 0;
  left: 0;
  background: ${e=>e.theme.eui.euiColorGhost};
  width: calc(100% + ${e=>e.theme.eui.euiSizeL} * 2);
  margin-left: -${e=>e.theme.eui.euiSizeL};
`,np=Object(Z.euiStyled)(Y.EuiPanel)`
  padding: ${e=>e.theme.eui.euiSizeL} 0;
`,rp=Object(Z.euiStyled)(Y.EuiPanel)`
  padding: 0 ${e=>e.theme.eui.euiSizeL};
`,ip=e=>({min:100*e.min,max:100*(e.max||1)}),sp=({label:e,color:t})=>r.a.createElement(Y.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiColorPickerSwatch,{color:t})),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiText,{size:"xs"},r.a.createElement("strong",null,e)))),lp=({steps:e,palette:t,reverse:a})=>{const n=Am(t,e,a);return r.a.createElement(cp,null,n.map((e=>r.a.createElement(op,{key:e,style:{backgroundColor:e}}))))},op=Z.euiStyled.div`
  max-width: 15px;
  height: 12px;
  flex: 1 1 auto;
  &:first-child {
    border-radius: ${e=>e.theme.eui.euiBorderRadius} 0 0 ${e=>e.theme.eui.euiBorderRadius};
  }
  &:last-child {
    border-radius: 0 ${e=>e.theme.eui.euiBorderRadius} ${e=>e.theme.eui.euiBorderRadius} 0;
`,cp=Z.euiStyled.div`
  display: flex;
`,up=["temperature","status","cool","warm","positive","negative"].map((e=>({text:tt.d[e],value:e}))),dp=({autoBounds:e,boundsOverride:t,onChange:a,dataBounds:i,options:s})=>{const[l,o]=Object(n.useState)(!1),[c,u]=Object(n.useState)(e),[d,m]=Object(n.useState)(s),[p,g]=Object(n.useState)(ip(t));Object(n.useEffect)((()=>{c&&g(ip(i))}),[e,i,c,a,s]);const f=r.a.createElement(Y.EuiButtonIcon,{iconType:"color",color:"text",display:"base",size:"s","aria-label":W.i18n.translate("xpack.infra.legendControls.buttonLabel",{defaultMessage:"configure legend"}),onClick:()=>o(!0),"data-test-subj":"openLegendControlsButton"}),b=Object(n.useCallback)((e=>{const a=e.target.checked;u(a),a||g(ip(t))}),[t]),h=Object(n.useCallback)((e=>{m((t=>({...t,reverseColors:e.target.checked})))}),[m]),y=Object(n.useCallback)((e=>{const t=parseFloat(e.currentTarget.value),a=t<=p.min?p.min+1:t>100?100:t;g({...p,max:a})}),[p]),E=Object(n.useCallback)((e=>{const t=parseFloat(e.currentTarget.value),a=t>=p.max?p.max-1:t<0?0:t;g({...p,min:a})}),[p]),v=Object(n.useCallback)((()=>{a({auto:c,bounds:{min:p.min/100,max:p.max/100},legend:d}),o(!1)}),[a,c,p,d]),x=Object(n.useCallback)((()=>{g(ip(t)),u(e),m(s),o(!1)}),[e,t,s]),w=Object(n.useCallback)((e=>{const t=parseInt(e.target.value,10);m((e=>({...e,steps:t})))}),[m]),k=Object(n.useCallback)((e=>{const t=e.target.value;m((e=>({...e,palette:t})))}),[m]),O=c===e&&100*t.min===p.min&&100*t.max===p.max&&s.steps===d.steps&&s.reverseColors===d.reverseColors&&s.palette===d.palette,M=p.min<p.max,j=Am(d.palette,d.steps,d.reverseColors),S=M?[]:[W.i18n.translate("xpack.infra.legnedControls.boundRangeError",{defaultMessage:"Minimum must be smaller than the maximum"})];return r.a.createElement(Y.EuiPopover,{isOpen:l,closePopover:x,id:"legendControls",button:f,anchorPosition:"leftCenter","data-test-subj":"legendControls"},r.a.createElement(Y.EuiPopoverTitle,null,"Legend Options"),r.a.createElement(mp,null,r.a.createElement(Y.EuiFormRow,{display:"columnCompressed",label:W.i18n.translate("xpack.infra.legendControls.colorPaletteLabel",{defaultMessage:"Color palette"})},r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiSelect,{options:up,value:d.palette,id:"palette",onChange:k,compressed:!0,"data-test-subj":"legendControlsPalette"}),r.a.createElement(Y.EuiSpacer,{size:"m"}),r.a.createElement(lp,{palette:d.palette,steps:d.steps,reverse:d.reverseColors}))),r.a.createElement(Y.EuiFormRow,{display:"columnCompressed",label:W.i18n.translate("xpack.infra.legendControls.stepsLabel",{defaultMessage:"Number of colors"})},r.a.createElement(Y.EuiRange,{id:"steps",min:2,max:18,step:1,value:d.steps,onChange:w,showValue:!0,fullWidth:!0})),r.a.createElement(Y.EuiFormRow,{fullWidth:!0,display:"columnCompressed",label:W.i18n.translate("xpack.infra.legendControls.reverseDirectionLabel",{defaultMessage:"Reverse direction"})},r.a.createElement(Y.EuiSwitch,{showLabel:!1,name:"reverseColors",label:"reverseColors",checked:d.reverseColors,onChange:h,compressed:!0,style:{position:"relative",top:"8px"}})),r.a.createElement(Y.EuiFormRow,{fullWidth:!0,display:"columnCompressed",label:W.i18n.translate("xpack.infra.legendControls.switchLabel",{defaultMessage:"Auto calculate range"})},r.a.createElement(Y.EuiSwitch,{showLabel:!1,name:"bounds",label:"bounds",checked:c,onChange:b,compressed:!0,style:{position:"relative",top:"8px"}})),r.a.createElement(Y.EuiFormRow,{fullWidth:!0,label:r.a.createElement(sp,{color:Object(Ne.first)(j),label:W.i18n.translate("xpack.infra.legendControls.minLabel",{defaultMessage:"Minimum"})}),isInvalid:!M,display:"columnCompressed",error:S},r.a.createElement("div",{style:{maxWidth:150}},r.a.createElement(Y.EuiFieldNumber,{"data-test-subj":"infraLegendControlsFieldNumber",disabled:c,step:1,value:isNaN(p.min)?"":p.min,isInvalid:!M,name:"legendMin",onChange:E,append:"%",compressed:!0}))),r.a.createElement(Y.EuiFormRow,{fullWidth:!0,display:"columnCompressed",label:r.a.createElement(sp,{color:Object(Ne.last)(j),label:W.i18n.translate("xpack.infra.legendControls.maxLabel",{defaultMessage:"Maximum"})}),isInvalid:!M,error:S},r.a.createElement("div",{style:{maxWidth:150}},r.a.createElement(Y.EuiFieldNumber,{"data-test-subj":"infraLegendControlsFieldNumber",disabled:c,step:1,isInvalid:!M,value:isNaN(p.max)?"":p.max,name:"legendMax",onChange:y,append:"%",compressed:!0}))),r.a.createElement(Y.EuiSpacer,{size:"m"}),r.a.createElement(Y.EuiFlexGroup,{justifyContent:"flexEnd",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraLegendControlsCancelButton",type:"submit",size:"s",onClick:x},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.legendControls.cancelButton",defaultMessage:"Cancel"}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,{type:"submit",size:"s",fill:!0,disabled:O||!M,onClick:v,"data-test-subj":"applyLegendControlsButton"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.legendControls.applyButton",defaultMessage:"Apply"}))))))},mp=Object(Z.euiStyled)(Y.EuiForm)`
  min-width: 400px;
  @media (max-width: 480px) {
    min-width: 100%;
    max-width: 100%;
    width: 100vw;
  }
`,pp=r.a.memo((({currentView:e,reload:t,interval:a,nodes:i,loading:s})=>{var l,o,c;const[u,d]=Object(n.useState)(!0),{metric:m,groupBy:p,sort:g,nodeType:f,changeView:b,view:h,autoBounds:y,boundsOverride:E,legend:v,changeBoundsOverride:x,changeAutoBounds:w,changeLegend:k}=Object(en.d)(),{currentTime:O,jumpToTime:M,isAutoReloading:j}=ia(),{applyFilterQuery:S}=ha(),C=null!==(l=null==v?void 0:v.palette)&&void 0!==l?l:en.a.palette,T=null!==(o=null==v?void 0:v.steps)&&void 0!==o?o:en.a.steps,I=null!==(c=null==v?void 0:v.reverseColors)&&void 0!==c?c:en.a.reverseColors,[F,L]=_a()("inventoryUI:hostsLinkClicked",!1),P=Object(n.useRef)(F),D={formatter:tt.b.percent,formatTemplate:"{{value}}",legend:Bm(C,T,I),metric:m,sort:g,groupBy:p};Pa()((()=>{s||M(Date.now())}),j?5e3:null);const _=rr(i),R=y?_:E,A=Object(n.useCallback)((e=>Object(Ya.a)(D.metric)(e)),[D.metric]),{onViewChange:B}=al();Object(n.useEffect)((()=>{e&&B(e)}),[e,B]),Object(n.useEffect)((()=>{null!=e&&t()}),[e,t]),Object(n.useEffect)((()=>{d(!0)}),[D.metric,f]),Object(n.useEffect)((()=>{const e=i&&i.length;d(!e)}),[i]);const V=Object(n.useCallback)((e=>{x(e.bounds),w(e.auto),k(e.legend)}),[x,w,k]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(ee.b,null,r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(gp,{grow:!1},r.a.createElement(Y.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"m"},r.a.createElement(Pm,{nodeType:f,currentTime:O}),r.a.createElement(fp,{responsive:!1},"map"===h&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(dp,{options:null!=v?v:en.a,dataBounds:_,bounds:R,autoBounds:y,boundsOverride:E,onChange:V})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(_m,{view:h,onChange:b}))))),r.a.createElement(Y.EuiFlexItem,{grow:!1},!P.current&&"host"===f&&r.a.createElement(Nm,{"data-test-subj":"inventory-hostsView-link",label:W.i18n.translate("xpack.infra.layout.hostsLandingPageLink",{defaultMessage:"Introducing a new Hosts analysis experience"}),link:{app:"metrics",pathname:"/hosts"},experimental:!0,onClick:()=>{L(!0)}})),r.a.createElement(bp,{grow:!1},r.a.createElement(Ra.a,{bounds:!0},(({bounds:{height:e=0}})=>r.a.createElement(Ud,{nodes:i,options:D,nodeType:f,loading:s,showLoading:u,reload:t,onDrilldown:S,currentTime:O,view:h,autoBounds:y,boundsOverride:E,formatter:A,bottomMargin:e,isAutoReloading:j,refreshInterval:5e3})))))),r.a.createElement(tp,{interval:a,formatter:A,view:h,nodeType:f}))})),gp=Object(Z.euiStyled)(Y.EuiFlexItem)`
  padding: ${e=>`${e.theme.eui.euiSizeM} 0`};
`;var fp=Fa()(Y.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1nogghc-0"})(["margin:0;justify-content:flex-end;"]),bp=Fa()(Y.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-1nogghc-1"})(["position:relative;flex:1 1 auto;"]);const hp=e=>{const{currentView:t}=Oa();return r.a.createElement(pp,de()({currentView:t},e))},yp=()=>{const{viewState:e}=al(),{currentView:t,views:a,isFetchingViews:n,isFetchingCurrentView:i,isCreatingView:s,isUpdatingView:l,createView:o,deleteViewById:c,fetchViews:u,updateViewById:d,switchViewById:m,setDefaultViewById:p}=Oa();return r.a.createElement(qt,{currentView:t,views:a,isFetchingViews:n,isFetchingCurrentView:i,isCreatingView:s,isUpdatingView:l,onCreateView:o,onDeleteView:c,onUpdateView:d,onLoadViews:u,onSetDefaultView:p,onSwitchView:m,viewState:e})},Ep=({render:e})=>{const{sourceId:t}=Object(re.b)(),{metric:a,groupBy:n,nodeType:r,accountId:i,region:s,view:l}=Object(en.d)(),{currentTime:o}=ia(),{filterQueryAsJson:c}=ha(),{loading:u,nodes:d,reload:m,interval:p="60s"}=Object(Ka.a)({filterQuery:c,metrics:[a],groupBy:n,nodeType:r,sourceId:t,currentTime:o,accountId:i,region:s,sendRequestImmediately:!1,includeTimeseries:"table"===l},{abortable:!0});return e({loading:u,nodes:d,reload:m,interval:p})};var vp=a(209);const xp="https://ela.st/k8s-feedback",wp=()=>{const[e,t]=_a()("kubernetesToastKey",!1),a=()=>t(!0);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Oe,{formUrl:xp,"data-test-subj":"infra-kubernetes-feedback-link",surveyButtonText:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.homePage.tellUsWhatYouThinkK8sLink",defaultMessage:"Tell us what you think! (K8s)"})}),!e&&r.a.createElement(Y.EuiGlobalToastList,{toastLifeTimeMs:1/0,dismissToast:a,toasts:[{id:"k8s-toast",title:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.homePage.kubernetesToastTitle",defaultMessage:"We need your help!"}),color:"primary",iconType:"help",text:r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.homePage.kubernetesToastText",defaultMessage:"Help us design your Kubernetes experience by completing a feedback survey."})),r.a.createElement(Y.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Oe,{formUrl:xp,"data-test-subj":"infra-toast-kubernetes-survey-start",onClickCapture:a,defaultButton:!0,surveyButtonText:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.homePage.kubernetesToastButton",defaultMessage:"Start survey"})}))))}]}))},kp=()=>{const{nodeType:e}=Object(en.d)();return r.a.createElement(r.a.Fragment,null,"pod"===e?r.a.createElement(wp,null):r.a.createElement(Oe,{"data-test-subj":"infraInventoryFeedbackLink",formUrl:"https://ela.st/survey-infra-inventory?usp=pp_url"}))},Op=()=>{var e;const{isLoading:t,loadSourceFailureMessage:a,loadSource:n,source:i}=Object(re.b)();Object(me.useTrackPageview)({app:"infra_metrics",path:"inventory"}),Object(me.useTrackPageview)({app:"infra_metrics",path:"inventory",delay:15e3}),Be([{text:Ae.d}]);const{metricIndicesExist:s,remoteClustersExist:l}=null!==(e=null==i?void 0:i.status)&&void 0!==e?e:{};return t&&!i?r.a.createElement(Me.a,null):l?s?a?r.a.createElement(wa,{errorMessage:a||"",retry:n}):r.a.createElement(Y.EuiErrorBoundary,null,r.a.createElement("div",{className:Ht.APP_WRAPPER_CLASS},r.a.createElement(Pt.a,{hasData:s,pageHeader:{pageTitle:Ae.d,rightSideItems:[r.a.createElement(yp,null),r.a.createElement(kp,null)]},pageSectionProps:{contentProps:{css:Wt.css`
                ${vp.a};
                padding-bottom: 0;
              `}}},r.a.createElement(Ep,{render:({loading:e,nodes:t,reload:a,interval:n})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Ea,{interval:n}),r.a.createElement(hp,{loading:e,nodes:t,reload:a,interval:n}))})))):r.a.createElement(Pt.a,{hasData:s,"data-test-subj":"noMetricsIndicesPrompt"}):r.a.createElement(Ve.b,null)};function Mp(){const e=Object(me.useLinkProps)({app:"metrics",pathname:"hosts"}),t=Object(me.useLinkProps)({app:"metrics",pathname:"inventory"}),a=new Map([["/hosts",{text:Ae.c,link:e}],["/inventory",{text:Ae.d,link:t}]]),n=a.get("/inventory"),{state:r}=Object(c.useLocation)(),i=r;return{getBreadcrumbOptions:function(e){if(void 0===i)return function(e){return"host"===e?a.get("/hosts"):n}(e);const t=i.originPathname?a.get(i.originPathname):void 0;return null!=t?t:n}}}const jp=()=>{var e;const{isLoading:t,loadSourceFailureMessage:a,loadSource:n,source:i}=Object(re.b)(),{params:{type:s,node:l}}=Object(c.useRouteMatch)(),{metricIndicesExist:o,remoteClustersExist:u}=null!==(e=null==i?void 0:i.status)&&void 0!==e?e:{},d=Mp().getBreadcrumbOptions(s);return Be([{...d.link,text:d.text},{text:l}]),t||!i?r.a.createElement(Me.a,null):u?o?a?r.a.createElement(wa,{errorMessage:a||"",retry:n}):r.a.createElement(Pt.a,{hasData:o,pageSectionProps:{paddingSize:"none"}},r.a.createElement(Vd,{assetId:l,assetType:s,tabs:zd,links:["apmServices"],renderMode:{mode:"page"},metricAlias:i.configuration.metricAlias})):r.a.createElement(Pt.a,{hasData:o,"data-test-subj":"noMetricsIndicesPrompt"}):r.a.createElement(Ve.b,null)},Sp=v.intersection([v.type({timestamp:v.number}),v.partial({value:v.union([v.number,v.null])})]),Cp=v.type({id:v.string,label:v.string,data:v.array(Sp)}),Tp=v.intersection([v.partial({id:v.union([u.InventoryMetricRT,v.null])}),v.type({series:v.array(Cp)})]),Ip=v.type({metrics:v.array(Tp)});v.intersection([v.type({nodeType:u.ItemTypeRT,nodeId:v.string,metrics:v.array(u.InventoryMetricRT),timerange:Jd.a,sourceId:v.string}),v.partial({cloudId:v.union([v.string,v.null])})]);const Fp=({loading:e,name:t,items:a})=>{const[i,s]=Object(n.useState)(!1),l=Object(n.useCallback)((()=>{s(!i)}),[i]),o=e?null:r.a.createElement(Y.EuiSideNav,{items:a}),c=e?null:r.a.createElement(Y.EuiSideNav,{items:a,mobileTitle:t,toggleOpenOnMobile:l,isOpenOnMobile:i});return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiHideFor,{sizes:["xs","s","m"]},r.a.createElement(Y.EuiPageSidebar,{sticky:!0},o)),r.a.createElement(Y.EuiShowFor,{sizes:["xs","s","m"]},r.a.createElement(Y.EuiPageSidebar,null,c)))},Lp=e=>{const[t]=Object(He.a)(kt.UI_SETTINGS.TIMEPICKER_QUICK_RANGES),{onChangeTimeRange:a,onRefresh:i,currentTimeRange:s,isLiveStreaming:l,refreshInterval:o,setAutoReload:c,setRefreshInterval:u}=e,d=It(t),m=Object(n.useCallback)((({start:e,end:t})=>{a({from:e,to:t,interval:">=1m"})}),[a]),p=Object(n.useCallback)((({isPaused:e,refreshInterval:t})=>{e?c(!1):(u(t),c(!0))}),[c,u]);return r.a.createElement(Pp,null,r.a.createElement(Y.EuiSuperDatePicker,{start:s.from.toString(),end:s.to.toString(),isPaused:!l,refreshInterval:o||0,onTimeChange:m,onRefreshChange:p,onRefresh:i,commonlyUsedRanges:d}))},Pp=Z.euiStyled.div`
  max-width: 750px;
`,Dp=r.a.createContext({items:[],addNavItem:e=>{}});var _p=a(129);const Rp=e=>"bar"===e.type?r.a.createElement(Bp,e):r.a.createElement(Ap,e),Ap=({id:e,color:t,series:a,name:n,type:i,stack:s})=>{const l=Object(_p.a)(),o={area:{opacity:1,visible:"area"===i},line:{strokeWidth:"area"===i?1:2,visible:!0}};return r.a.createElement(Ue.AreaSeries,{id:e,name:n,xScaleType:Ue.ScaleType.Time,yScaleType:Ue.ScaleType.Linear,xAccessor:"timestamp",yAccessors:["value"],data:a.data,areaSeriesStyle:o,color:t||void 0,stackAccessors:s?["timestamp"]:void 0,timeZone:l})},Bp=({id:e,color:t,series:a,name:n,stack:i})=>{const s=Object(_p.a)(),l={rectBorder:{stroke:t||void 0,strokeWidth:1,visible:!0},rect:{opacity:1}};return r.a.createElement(Ue.BarSeries,{id:e,name:n,xScaleType:Ue.ScaleType.Time,yScaleType:Ue.ScaleType.Linear,xAccessor:"timestamp",yAccessors:["value"],data:a.data,barSeriesStyle:l,color:t||void 0,stackAccessors:i?["timestamp"]:void 0,timeZone:s})};var Vp=a(483),Np=a.n(Vp);const zp=e=>e.data.length<2,$p=(e,t,a)=>e?Object(Ne.get)(e,[t,"name"],a):a,qp=(e,t)=>{const a=e?Object(Ne.get)(e,[t,"color"]):null;return a?new Np.a(a).hex().toString():null},Up=(e,t,a)=>{if(!e||!t)return"line";const n=Object(Ne.get)(e,[a,"type"]);return u.InventoryVisTypeRT.is(n)?n:u.InventoryVisTypeRT.is(t)?t:"line"},Gp=({title:e,body:t})=>r.a.createElement(Y.EuiEmptyPrompt,{iconType:"stats",title:r.a.createElement("h3",null,e),body:r.a.createElement("p",null,t)}),Hp=({id:e,onChangeRangeTime:t,metric:a,stopLiveStreaming:i,isLiveStreaming:s,formatter:l,formatterTemplate:o,stacked:c,seriesOverrides:u,type:d})=>{const m=Object(Ge.a)(),[p]=Object(He.a)("dateFormat"),g=Object(n.useCallback)(((e="number",t="{{value}}")=>a=>null!=a?Object(So.b)(e,t)(a):"")(l,o),[l,o]),f=Object(n.useMemo)((()=>null!=a?Object(Ue.niceTimeFormatter)((e=>{if(e.series.some(zp))return[0,0];const t=e.series.reduce(((e,t)=>{const a=Object(Ne.first)(t.data),n=Object(Ne.last)(t.data);return e.concat([a&&a.timestamp||0,n&&n.timestamp||0])}),[]);return[Object(Ne.min)(t),Object(Ne.max)(t)]})(a)):void 0),[a]),b=Object(n.useCallback)((({x:e})=>{if(!e)return;const[a,n]=e;t&&(s&&i&&i(),t({from:h()(a).toISOString(),to:h()(n).toISOString(),interval:">=1m"}))}),[t,s,i]),y={headerFormatter:Object(n.useCallback)((({value:e})=>h()(e).format(p||"Y-MM-DD HH:mm:ss.SSS")),[p])};return e?a?a.series.some(zp)?r.a.createElement(Gp,{title:W.i18n.translate("xpack.infra.chartSection.notEnoughDataPointsToRenderTitle",{defaultMessage:"Not Enough Data"}),body:W.i18n.translate("xpack.infra.chartSection.notEnoughDataPointsToRenderText",{defaultMessage:"Not enough data points to render chart, try increasing the time range."})}):r.a.createElement(Y.EuiPageSection,null,r.a.createElement("div",{className:"infrastructureChart",style:{height:250,marginBottom:16}},r.a.createElement(Ue.Chart,null,r.a.createElement(Ue.Axis,{id:"timestamp",position:Ue.Position.Bottom,showOverlappingTicks:!0,tickFormat:f}),r.a.createElement(Ue.Axis,{id:"values",position:Ue.Position.Left,tickFormat:g}),a&&a.series.map((t=>r.a.createElement(Rp,{key:`series-${e}-${t.id}`,id:`series-${e}-${t.id}`,series:t,name:$p(u,t.id,t.id),type:Up(u,d,t.id),color:qp(u,t.id),stack:c}))),r.a.createElement(Ue.Tooltip,y),r.a.createElement(Ue.Settings,{onBrushEnd:b,baseTheme:m.baseTheme,showLegend:!0,showLegendExtra:!0,legendPosition:"right",locale:W.i18n.getLocale()})))):r.a.createElement(Gp,{title:W.i18n.translate("xpack.infra.chartSection.missingMetricDataText",{defaultMessage:"Missing Data"}),body:W.i18n.translate("xpack.infra.chartSection.missingMetricDataBody",{defaultMessage:"The data for this chart is missing."})}):null},Wp=r.a.createContext(null),Qp=[{field:"cloud.instance.id",label:W.i18n.translate("xpack.infra.nodeDetails.labels.instanceId",{defaultMessage:"Instance ID"})},{field:"cloud.provider",label:W.i18n.translate("xpack.infra.nodeDetails.labels.cloudProvider",{defaultMessage:"Cloud Provider"})},{field:"host.os.name",label:W.i18n.translate("xpack.infra.nodeDetails.labels.operatinSystem",{defaultMessage:"Operating System"})},{field:"host.os.kernel",label:W.i18n.translate("xpack.infra.nodeDetails.labels.kernelVersion",{defaultMessage:"Kernel Version"})},{field:"host.hostname",label:W.i18n.translate("xpack.infra.nodeDetails.labels.hostname",{defaultMessage:"Hostname"})},{field:"host.containerized",label:W.i18n.translate("xpack.infra.nodeDetails.labels.containerized",{defaultMessage:"Containerized"}),isBoolean:!0},{field:"cloud.project.id",label:W.i18n.translate("xpack.infra.nodeDetails.labels.projectId",{defaultMessage:"Project ID"})},{field:"cloud.availability_zone",label:W.i18n.translate("xpack.infra.nodeDetails.labels.availabilityZone",{defaultMessage:"Availability Zone"})},{field:"cloud.machine.type",label:W.i18n.translate("xpack.infra.nodeDetails.labels.machineType",{defaultMessage:"Machine Type"})},{field:"cloud.instance.name",label:W.i18n.translate("xpack.infra.nodeDetails.labels.instanceName",{defaultMessage:"Instance Name"})}],Jp=e=>{const[t,a]=Object(n.useState)(!1),i=Object(n.useCallback)((()=>a(!t)),[t]),s=Object(n.useMemo)((()=>e.fields&&e.fields.length?e.fields.map((e=>{const t=Qp.find((t=>t.field===e));if(t)return t})).filter((e=>e)):Qp),[e.fields]),l=Object(n.useMemo)((()=>t?s:s.slice(0,4)),[s,t]),o=Object(n.useContext)(Wp);return o?r.a.createElement(Kp,null,s.length>4?r.a.createElement(Yp,null,r.a.createElement(Y.EuiButtonIcon,{"data-test-subj":"infraMetadataDetailsButton",iconType:t?"arrowUp":"arrowDown",onClick:i,"aria-label":W.i18n.translate("xpack.infra.nodeDetails.labels.showMoreDetails",{defaultMessage:"Show more details"})})):null,r.a.createElement(Y.EuiFlexGrid,{columns:4,style:{flexGrow:1},gutterSize:"s"},l.map((e=>r.a.createElement(Y.EuiFlexItem,{key:e.field,style:{minWidth:0}},r.a.createElement(Y.EuiTitle,{size:"xs"},r.a.createElement("h5",null,(({field:e})=>{const t=Qp.find((t=>t.field===e));return t?t.label:e})(e))),r.a.createElement(Y.EuiText,null,((e,{field:t,isBoolean:a})=>a?Object(Ne.get)(e.info,t,!1)?W.i18n.translate("xpack.infra.nodeDetails.yes",{defaultMessage:"Yes"}):W.i18n.translate("xpack.infra.nodeDetails.no",{defaultMessage:"No"}):Object(Ne.get)(e.info,t,"--"))(o,e))))))):null},Kp=Z.euiStyled.div`
border-top: ${e=>e.theme.eui.euiBorderWidthThin} solid ${e=>e.theme.eui.euiBorderColor};
border-bottom: ${e=>e.theme.eui.euiBorderWidthThin} solid ${e=>e.theme.eui.euiBorderColor};
padding: ${e=>e.theme.eui.euiSizeM} 0;
margin-bottom: ${e=>e.theme.eui.euiSizeM};
display: flex;
`,Yp=Z.euiStyled.div`
flex-grow: 0;
margin-right: ${e=>e.theme.eui.euiSizeM};
min-width: 0px;
`,Xp=({children:e,metrics:t,navLabel:a,sectionLabel:i,onChangeRangeTime:s,isLiveStreaming:l,stopLiveStreaming:o})=>{const{addNavItem:c}=Object(n.useContext)(Dp),u=n.Children.toArray(e).reduce(((e,a)=>{var r;return Object(n.isValidElement)(a)?null===(null!==(r=null==t?void 0:t.find((e=>e.id===a.props.id)))&&void 0!==r?r:null)?e:a.props.label?[...e,{id:a.props.id,name:a.props.label,onClick:()=>{const e=document.getElementById(a.props.id);e&&e.scrollIntoView()}}]:e:e}),[]),d=n.Children.map(e,(e=>Object(n.isValidElement)(e)?Object(n.cloneElement)(e,{metrics:t,onChangeRangeTime:s,isLiveStreaming:l,stopLiveStreaming:o}):null));return t&&u.length?(c({id:a,name:a,items:u}),r.a.createElement("div",null,r.a.createElement(Y.EuiTitle,null,r.a.createElement("h1",null,i)),d)):null},Zp=({id:e,label:t,children:a,metrics:i,onChangeRangeTime:s,isLiveStreaming:l,stopLiveStreaming:o})=>{const c=Object(n.useMemo)((()=>null==i?void 0:i.find((t=>t.id===e))),[e,i]);if(!a||!c)return null;const u=n.Children.map(a,(t=>Object(n.isValidElement)(t)?Object(n.cloneElement)(t,{metric:c,id:e,onChangeRangeTime:s,isLiveStreaming:l,stopLiveStreaming:o}):null));return r.a.createElement("div",{style:{margin:"10px 0 16px 0"},id:e},t?r.a.createElement(Y.EuiTitle,{size:"s"},r.a.createElement("h4",null,t)):null,u)},eg=Object(Z.withTheme)((({metrics:e,theme:t,onChangeRangeTime:a})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Jp,{fields:["cloud.instance.id","cloud.provider","cloud.availability_zone","cloud.machine.type","cloud.instance.name","cloud.project.id"]}),r.a.createElement(Y.EuiPanel,null,r.a.createElement(Xp,{navLabel:"AWS EC2",sectionLabel:W.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Aws EC2 Overview"}),metrics:e,onChangeRangeTime:a},r.a.createElement(Zp,{id:"awsEC2CpuUtilization",label:W.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.cpuUsageSection.sectionLabel",{defaultMessage:"CPU Usage"})},r.a.createElement(Hp,{stacked:!0,type:"area",formatter:"percent",seriesOverrides:{total:{color:t.eui.euiColorVis1}}})),r.a.createElement(Zp,{id:"awsEC2NetworkTraffic",label:W.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.networkTrafficSection.sectionLabel",{defaultMessage:"Network Traffic"})},r.a.createElement(Hp,{formatter:"bits",formatterTemplate:"{{value}}/s",type:"area",seriesOverrides:{rx:{color:t.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.networkTrafficSection.networkRxRateSeriesLabel",{defaultMessage:"in"})},tx:{color:t.eui.euiColorVis2,name:W.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.networkTrafficSection.networkTxRateSeriesLabel",{defaultMessage:"out"})}}})),r.a.createElement(Zp,{id:"awsEC2DiskIOBytes",label:W.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.diskIOBytesSection.sectionLabel",{defaultMessage:"Disk IO (Bytes)"})},r.a.createElement(Hp,{formatter:"bytes",formatterTemplate:"{{value}}/s",type:"area",seriesOverrides:{write:{color:t.eui.euiColorVis2,name:W.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.diskIOBytesSection.writeLabel",{defaultMessage:"writes"})},read:{color:t.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.diskIOBytesSection.readLabel",{defaultMessage:"reads"})}}}))))))),tg=Object(Z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>r.a.createElement(Y.EuiPanel,null,r.a.createElement(Xp,{navLabel:"AWS RDS",sectionLabel:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Aws RDS Overview"}),metrics:e,onChangeRangeTime:t},r.a.createElement(Zp,{id:"awsRDSCpuTotal",label:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.cpuTotal.sectionLabel",{defaultMessage:"Total CPU Usage"})},r.a.createElement(Hp,{type:"area",formatter:"percent",seriesOverrides:{cpu:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.cpuTotal.chartLabel",{defaultMessage:"Total"})}}})),r.a.createElement(Zp,{id:"awsRDSConnections",label:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.connections.sectionLabel",{defaultMessage:"Connections"})},r.a.createElement(Hp,{type:"bar",formatter:"number",seriesOverrides:{connections:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.connections.chartLabel",{defaultMessage:"Connections"})}}})),r.a.createElement(Zp,{id:"awsRDSQueriesExecuted",label:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.queriesExecuted.sectionLabel",{defaultMessage:"Queries Executed"})},r.a.createElement(Hp,{type:"bar",formatter:"number",seriesOverrides:{queries:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.queriesExecuted.chartLabel",{defaultMessage:"Queries"})}}})),r.a.createElement(Zp,{id:"awsRDSActiveTransactions",label:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.activeTransactions.sectionLabel",{defaultMessage:"Transactions"})},r.a.createElement(Hp,{type:"bar",formatter:"number",seriesOverrides:{active:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.active.chartLabel",{defaultMessage:"Active"})},blocked:{color:a.eui.euiColorVis2,name:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.blocked.chartLabel",{defaultMessage:"Blocked"})}}})),r.a.createElement(Zp,{id:"awsRDSLatency",label:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.sectionLabel",{defaultMessage:"Latency"})},r.a.createElement(Hp,{type:"bar",stacked:!0,formatter:"highPrecision",formatterTemplate:"{{value}} ms",seriesOverrides:{read:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.read.chartLabel",{defaultMessage:"Read"})},write:{color:a.eui.euiColorVis2,name:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.write.chartLabel",{defaultMessage:"Write"})},insert:{color:a.eui.euiColorVis0,name:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.insert.chartLabel",{defaultMessage:"Insert"})},update:{color:a.eui.euiColorVis7,name:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.update.chartLabel",{defaultMessage:"Update"})},commit:{color:a.eui.euiColorVis3,name:W.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.commit.chartLabel",{defaultMessage:"Commit"})}}})))))),ag=Object(Z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>r.a.createElement(Y.EuiPanel,null,r.a.createElement(Xp,{navLabel:"AWS S3",sectionLabel:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Aws S3 Overview"}),metrics:e,onChangeRangeTime:t},r.a.createElement(Zp,{id:"awsS3BucketSize",label:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.bucketSize.sectionLabel",{defaultMessage:"Bucket Size"})},r.a.createElement(Hp,{type:"bar",formatter:"bytes",seriesOverrides:{bytes:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.bucketSize.chartLabel",{defaultMessage:"Total Bytes"})}}})),r.a.createElement(Zp,{id:"awsS3NumberOfObjects",label:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.numberOfObjects.sectionLabel",{defaultMessage:"Number of Objects"})},r.a.createElement(Hp,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{objects:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.numberOfObjects.chartLabel",{defaultMessage:"Objects"})}}})),r.a.createElement(Zp,{id:"awsS3TotalRequests",label:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.totalRequests.sectionLabel",{defaultMessage:"Total Requests"})},r.a.createElement(Hp,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{total:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.totalRequests.chartLabel",{defaultMessage:"Requests"})}}})),r.a.createElement(Zp,{id:"awsS3DownloadBytes",label:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.downloadBytes.sectionLabel",{defaultMessage:"Downloaded Bytes"})},r.a.createElement(Hp,{type:"bar",formatter:"bytes",seriesOverrides:{bytes:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.downloadBytes.chartLabel",{defaultMessage:"Bytes"})}}})),r.a.createElement(Zp,{id:"awsS3UploadBytes",label:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.uploadBytes.sectionLabel",{defaultMessage:"Uploaded Bytes"})},r.a.createElement(Hp,{type:"bar",formatter:"bytes",seriesOverrides:{bytes:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.uploadBytes.chartLabel",{defaultMessage:"Bytes"})}}})))))),ng=Object(Z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>r.a.createElement(Y.EuiPanel,null,r.a.createElement(Xp,{navLabel:"AWS SQS",sectionLabel:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Aws SQS Overview"}),metrics:e,onChangeRangeTime:t},r.a.createElement(Zp,{id:"awsSQSMessagesVisible",label:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesVisible.sectionLabel",{defaultMessage:"Messages Available"})},r.a.createElement(Hp,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{visible:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesVisible.chartLabel",{defaultMessage:"Available"})}}})),r.a.createElement(Zp,{id:"awsSQSMessagesDelayed",label:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesDelayed.sectionLabel",{defaultMessage:"Messages Delayed"})},r.a.createElement(Hp,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{delayed:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesDelayed.chartLabel",{defaultMessage:"Delayed"})}}})),r.a.createElement(Zp,{id:"awsSQSMessagesSent",label:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesSent.sectionLabel",{defaultMessage:"Messages Added"})},r.a.createElement(Hp,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{sent:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesSent.chartLabel",{defaultMessage:"Added"})}}})),r.a.createElement(Zp,{id:"awsSQSMessagesEmpty",label:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesEmpty.sectionLabel",{defaultMessage:"Messages Empty"})},r.a.createElement(Hp,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{sent:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesEmpty.chartLabel",{defaultMessage:"Empty"})}}})),r.a.createElement(Zp,{id:"awsSQSOldestMessage",label:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.oldestMessage.sectionLabel",{defaultMessage:"Oldest Message"})},r.a.createElement(Hp,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{oldest:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.oldestMessage.chartLabel",{defaultMessage:"Age"})}}})))))),rg=({id:e,metric:t,seriesOverrides:a,formatter:n,formatterTemplate:i})=>t&&e?r.a.createElement(Y.EuiPageSection,null,r.a.createElement(Y.EuiSpacer,{size:"m"}),r.a.createElement(ig,null,t.series.map((t=>{const s=Object(Ne.last)(t.data);if(!s)return null;const l=((e="number",t="{{value}}",a={},n)=>r=>{if(null==r)return"";const i=Object(Ne.get)(a,[n,"formatter"],e),s=Object(Ne.get)(a,[n,"formatterTemplate"],t);return Object(So.b)(i,s)(r)})(n,i,a,t.id),o=l(s.value||0),c=$p(a,t.id,t.id),u=Object(Ne.max)(t.data.map((e=>e.value||0))),d=Object(Ne.get)(a,[t.id,"gaugeMax"],u);return r.a.createElement(Y.EuiFlexItem,{key:`${e}-${t.id}`,style:{margin:"0.4rem"}},r.a.createElement(Y.EuiPanel,{style:{minWidth:"160px"}},r.a.createElement(Y.EuiText,{style:{textAlign:"right"},size:"s"},c),r.a.createElement(Y.EuiTitle,{size:"s"},r.a.createElement("h1",{style:{textAlign:"right",whiteSpace:"nowrap"}},o)),r.a.createElement(Y.EuiProgress,{value:s.value||0,max:d,size:"s",color:"primary"})))}))),r.a.createElement(Y.EuiSpacer,{size:"m"})):null,ig=Z.euiStyled.div`
  display: flex;
  flex-flow: row wrap;
  justify-content: space-evenly;
`,sg=Object(Z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Jp,null),r.a.createElement(Y.EuiPanel,null,r.a.createElement(Xp,{navLabel:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.layoutLabel",{defaultMessage:"Container"}),sectionLabel:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Container Overview"}),metrics:e,onChangeRangeTime:t},r.a.createElement(Zp,{id:"containerK8sOverview"},r.a.createElement(rg,{seriesOverrides:{cpu:{name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.cpuUsageSeriesLabel",{defaultMessage:"CPU Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},memory:{name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.memoryUsageSeriesLabel",{defaultMessage:"Memory Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1}}})),r.a.createElement(Zp,{id:"containerOverview"},r.a.createElement(rg,{seriesOverrides:{cpu:{name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.cpuUsageSeriesLabel",{defaultMessage:"CPU Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},memory:{name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.memoryUsageSeriesLabel",{defaultMessage:"Memory Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},rx:{name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.inboundRXSeriesLabel",{defaultMessage:"Inbound (RX)"}),color:a.eui.euiColorFullShade,formatter:"bits",formatterTemplate:"{{value}}/s"},tx:{name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.outboundTXSeriesLabel",{defaultMessage:"Outbound (TX)"}),color:a.eui.euiColorFullShade,formatter:"bits",formatterTemplate:"{{value}}/s"}}})),r.a.createElement(Zp,{id:"containerK8sCpuUsage",label:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.cpuUsageSection.sectionLabel",{defaultMessage:"CPU Usage"})},r.a.createElement(Hp,{stacked:!0,type:"area",formatter:"percent",seriesOverrides:{cpu:{color:a.eui.euiColorVis1}}})),r.a.createElement(Zp,{id:"containerK8sMemoryUsage",label:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.memoryUsageSection.sectionLabel",{defaultMessage:"Memory Usage"})},r.a.createElement(Hp,{stacked:!0,type:"area",formatter:"percent",seriesOverrides:{memory:{color:a.eui.euiColorVis1}}})),r.a.createElement(Zp,{id:"containerCpuUsage",label:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.cpuUsageSection.sectionLabel",{defaultMessage:"CPU Usage"})},r.a.createElement(Hp,{stacked:!0,type:"area",formatter:"percent",seriesOverrides:{cpu:{color:a.eui.euiColorVis1}}})),r.a.createElement(Zp,{id:"containerMemory",label:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.memoryUsageSection.sectionLabel",{defaultMessage:"Memory Usage"})},r.a.createElement(Hp,{stacked:!0,type:"area",formatter:"percent",seriesOverrides:{memory:{color:a.eui.euiColorVis1}}})),r.a.createElement(Zp,{id:"containerNetworkTraffic",label:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.networkTrafficSection.sectionLabel",{defaultMessage:"Network Traffic"})},r.a.createElement(Hp,{formatter:"bits",formatterTemplate:"{{value}}/s",type:"area",seriesOverrides:{rx:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.networkTrafficSection.networkRxRateSeriesLabel",{defaultMessage:"in"})},tx:{color:a.eui.euiColorVis2,name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.networkTrafficSection.networkTxRateSeriesLabel",{defaultMessage:"out"})}}})),r.a.createElement(Zp,{id:"containerDiskIOOps",label:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoOpsSection.sectionLabel",{defaultMessage:"Disk IO (Ops)"})},r.a.createElement(Hp,{type:"area",formatterTemplate:"{{value}}/s",formatter:"number",seriesOverrides:{read:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoOpsSection.readRateSeriesLabel",{defaultMessage:"reads"})},write:{color:a.eui.euiColorVis2,name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoOpsSection.writeRateSeriesLabel",{defaultMessage:"writes"})}}})),r.a.createElement(Zp,{id:"containerDiskIOBytes",label:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoBytesSection.sectionLabel",{defaultMessage:"Disk IO (Bytes)"})},r.a.createElement(Hp,{type:"area",formatter:"bytes",formatterTemplate:"{{value}}/s",seriesOverrides:{read:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoBytesSection.readRateSeriesLabel",{defaultMessage:"reads"})},write:{color:a.eui.euiColorVis2,name:W.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoBytesSection.writeRateSeriesLabel",{defaultMessage:"writes"})}}}))))))),lg=Object(Z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Xp,{navLabel:"Nginx",sectionLabel:"Nginx",metrics:e,onChangeRangeTime:t},r.a.createElement(Zp,{id:"nginxHits",label:W.i18n.translate("xpack.infra.metricDetailPage.nginxMetricsLayout.hitsSection.sectionLabel",{defaultMessage:"Hits"})},r.a.createElement(Hp,{stacked:!0,type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{"200s":{color:a.eui.euiColorVis1},"300s":{color:a.eui.euiColorVis5},"400s":{color:a.eui.euiColorVis2},"500s":{color:a.eui.euiColorVis9}}})),r.a.createElement(Zp,{id:"nginxRequestRate",label:W.i18n.translate("xpack.infra.metricDetailPage.nginxMetricsLayout.requestRateSection.sectionLabel",{defaultMessage:"Request Rate"})},r.a.createElement(Hp,{type:"area",formatter:"abbreviatedNumber",formatterTemplate:"{{value}}/s",seriesOverrides:{rate:{color:a.eui.euiColorVis1}}})),r.a.createElement(Zp,{id:"nginxActiveConnections",label:W.i18n.translate("xpack.infra.metricDetailPage.nginxMetricsLayout.activeConnectionsSection.sectionLabel",{defaultMessage:"Active Connections"})},r.a.createElement(Hp,{type:"area",formatter:"abbreviatedNumber",seriesOverrides:{connections:{color:a.eui.euiColorVis1,type:"bar"}}})),r.a.createElement(Zp,{id:"nginxRequestsPerConnection",label:W.i18n.translate("xpack.infra.metricDetailPage.nginxMetricsLayout.requestsPerConnectionsSection.sectionLabel",{defaultMessage:"Requests per Connections"})},r.a.createElement(Hp,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{reqPerConns:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.nginxMetricsLayout.requestsPerConnectionsSection.reqsPerConnSeriesLabel",{defaultMessage:"reqs per conn"})}}})))))),og=Object(Z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(Jp,null),r.a.createElement(Y.EuiPanel,null,r.a.createElement(Xp,{navLabel:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.layoutLabel",{defaultMessage:"Pod"}),sectionLabel:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Pod Overview"}),metrics:e,onChangeRangeTime:t},r.a.createElement(Zp,{id:"podOverview"},r.a.createElement(rg,{seriesOverrides:{cpu:{name:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.overviewSection.cpuUsageSeriesLabel",{defaultMessage:"CPU Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},memory:{name:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.overviewSection.memoryUsageSeriesLabel",{defaultMessage:"Memory Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},rx:{name:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.overviewSection.inboundRXSeriesLabel",{defaultMessage:"Inbound (RX)"}),color:a.eui.euiColorFullShade,formatter:"bits",formatterTemplate:"{{value}}/s"},tx:{name:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.overviewSection.outboundTXSeriesLabel",{defaultMessage:"Outbound (TX)"}),color:a.eui.euiColorFullShade,formatter:"bits",formatterTemplate:"{{value}}/s"}}})),r.a.createElement(Zp,{id:"podCpuUsage",label:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.cpuUsageSection.sectionLabel",{defaultMessage:"CPU Usage"})},r.a.createElement(Hp,{formatter:"percent",type:"area",seriesOverrides:{cpu:{color:a.eui.euiColorVis1}}})),r.a.createElement(Zp,{id:"podMemoryUsage",label:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.memoryUsageSection.sectionLabel",{defaultMessage:"Memory Usage"})},r.a.createElement(Hp,{type:"area",formatter:"percent",seriesOverrides:{memory:{color:a.eui.euiColorVis1}}})),r.a.createElement(Zp,{id:"podNetworkTraffic",label:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.networkTrafficSection.sectionLabel",{defaultMessage:"Network Traffic"})},r.a.createElement(Hp,{formatter:"bits",formatterTemplate:"{{value}}/s",type:"area",seriesOverrides:{rx:{color:a.eui.euiColorVis1,name:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.networkTrafficSection.networkRxRateSeriesLabel",{defaultMessage:"in"})},tx:{color:a.eui.euiColorVis2,name:W.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.networkTrafficSection.networkTxRateSeriesLabel",{defaultMessage:"out"})}}}))),r.a.createElement(lg,{metrics:e,onChangeRangeTime:t}))))),cg=({inventoryItemType:e,...t})=>{switch(e){case"awsEC2":return r.a.createElement(eg,t);case"awsRDS":return r.a.createElement(tg,t);case"awsS3":return r.a.createElement(ag,t);case"awsSQS":return r.a.createElement(ng,t);case"container":return r.a.createElement(sg,t);case"pod":return r.a.createElement(og,t);default:throw new Error(`${e} is not supported.`)}},ug=({loading:e,refetch:t,type:a,metrics:n,onChangeRangeTime:i,isLiveStreaming:s,stopLiveStreaming:l})=>e?r.a.createElement(loading_InfraLoadingPanel,{height:"100vh",width:"auto",text:W.i18n.translate("xpack.infra.metrics.loadingNodeDataText",{defaultMessage:"Loading data"})}):!e&&n&&0===n.length?r.a.createElement(Ve.a,{titleText:W.i18n.translate("xpack.infra.metrics.emptyViewTitle",{defaultMessage:"There is no data to display."}),bodyText:W.i18n.translate("xpack.infra.metrics.emptyViewDescription",{defaultMessage:"Try adjusting your time or filter."}),refetchText:W.i18n.translate("xpack.infra.metrics.refetchButtonLabel",{defaultMessage:"Check for new data"}),onRefetch:t,testString:"metricsEmptyViewState"}):r.a.createElement(cg,{inventoryItemType:a,metrics:n,onChangeRangeTime:i,isLiveStreaming:s,stopLiveStreaming:l}),dg=({"data-test-subj":e,app:t,children:a})=>{const n=Object(me.useLinkProps)({app:t,pathname:"/settings"});return r.a.createElement(Y.EuiButton,de()({"data-test-subj":e,color:"primary"},n),a)},mg=({nodeName:e})=>{const t=Object(me.useLinkProps)({app:"integrations",hash:"/browse"});return r.a.createElement(pg,{title:r.a.createElement("h2",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metrics.invalidNodeErrorTitle",defaultMessage:"Looks like {nodeName} isn't collecting any metrics data",values:{nodeName:e}})),body:r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.metrics.invalidNodeErrorDescription",defaultMessage:"Double check your configuration"})),actions:r.a.createElement(Y.EuiFlexGroup,null,r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiButton,de()({"data-test-subj":"infraInvalidNodeErrorViewSetupInstructionsButton"},t,{color:"primary",fill:!0}),r.a.createElement(X.FormattedMessage,{id:"xpack.infra.homePage.noMetricsIndicesInstructionsActionLabel",defaultMessage:"View setup instructions"}))),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(dg,{app:"metrics","data-test-subj":"configureSourceButton"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.configureSourceActionLabel",defaultMessage:"Change source configuration"}))))})},pg=Object(Z.euiStyled)(Y.EuiEmptyPrompt)`
  align-self: center;
`,gg=({error:e,name:t})=>{var a;return(e=>{const{services:{chrome:t}}=Object(ge.b)();Object(n.useEffect)((()=>{const a=[{text:Ae.i},...e].reverse().map((e=>e.text));t.docTitle.change(a)}),[t,e])})([{text:Ae.b}]),r.a.createElement(r.a.Fragment,null,404===(null===(a=e.body)||void 0===a?void 0:a.statusCode)?r.a.createElement(mg,{nodeName:t}):r.a.createElement(ne,{message:e.message}))},fg=e=>{const t=E.a.parse(e.from.toString()),a=E.a.parse(e.to.toString(),{roundUp:!0});return{...e,from:t&&t.valueOf()||h()().subtract(1,"hour").valueOf(),to:a&&a.valueOf()||h()().valueOf()}},bg=e=>{const{metricIndicesExist:t}=Object(re.b)(),{breadcrumbs:a}=Id(),[i,s]=Object(n.useState)(fg(e.timeRange)),{metrics:l,loading:o,makeRequest:c,error:u}=function(e,t,a,n,r,i){const{error:s,loading:l,response:o,makeRequest:c}=Object(ol.a)("/api/metrics/node_details","POST",JSON.stringify({metrics:e,nodeId:t,nodeType:a,timerange:r,cloudId:i,sourceId:n}),(e=>Object(x.pipe)(Ip.decode(e),Object(w.fold)(Object(pi.d)(pi.a),k.identity))));return{error:s,loading:l,metrics:o?o.metrics:[],makeRequest:c}}(e.requiredMetrics,e.nodeId,e.nodeType,e.sourceId,i,e.cloudId),d=Object(n.useCallback)((()=>{s(fg(e.timeRange))}),[e.timeRange]);return Object(n.useEffect)((()=>{s(fg(e.timeRange))}),[e.timeRange]),Object(n.useEffect)((()=>{c()}),[c,i]),u?r.a.createElement(gg,{error:u,name:e.name}):r.a.createElement(Pt.a,{hasData:t,pageHeader:{pageTitle:e.name,rightSideItems:[r.a.createElement(Lp,{currentTimeRange:e.timeRange,isLiveStreaming:e.isAutoReloading,refreshInterval:e.refreshInterval,setRefreshInterval:e.setRefreshInterval,onChangeTimeRange:e.setTimeRange,setAutoReload:e.setAutoReload,onRefresh:d})],breadcrumbs:a}},r.a.createElement(Y.EuiFlexGroup,null,r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Fp,{loading:e.metadataLoading,name:e.name,items:e.sideNav})),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Dp.Provider,{value:{items:e.sideNav,addNavItem:e.addNavItem}},r.a.createElement(Wp.Provider,{value:e.metadata},r.a.createElement(ug,{loading:!(l.length>0&&e.isAutoReloading)&&o,refetch:d,type:e.nodeType,metrics:l,onChangeRangeTime:e.setTimeRange,isLiveStreaming:e.isAutoReloading,stopLiveStreaming:()=>e.setAutoReload(!1)}))))))},hg=()=>{const{params:{type:e,node:t}}=Object(c.useRouteMatch)(),a=Object(u.findInventoryModel)(e),{sourceId:i,metricIndicesExist:s}=Object(re.b)(),l=Mp(),{timeRange:o,parsedTimeRange:d,setTimeRange:m,refreshInterval:p,setRefreshInterval:g,isAutoReloading:f,setAutoReload:b,triggerRefresh:h}=_(),{name:y,filteredRequiredMetrics:E,loading:v,cloudId:x,metadata:w}=dl({assetId:t,assetType:e,requiredMetrics:a.requiredMetrics,sourceId:i,timeRange:d}),k=l.getBreadcrumbOptions(e);Be([{...k.link,text:k.text},{text:y}]);const[O,M]=Object(n.useState)([]),j=r.a.useCallback((e=>{O.some((t=>t.id===e.id))||M([e,...O])}),[O]);return v&&!E.length?r.a.createElement(Pt.a,{hasData:s},r.a.createElement(loading_InfraLoadingPanel,{height:"100vh",width:"100%",text:W.i18n.translate("xpack.infra.metrics.loadingNodeDataText",{defaultMessage:"Loading data"})})):r.a.createElement(r.a.Fragment,null,w?r.a.createElement(bg,{name:y,requiredMetrics:E,sourceId:i,timeRange:o,nodeType:e,nodeId:t,cloudId:x,metadataLoading:v,isAutoReloading:f,refreshInterval:p,sideNav:O,metadata:w,addNavItem:j,setRefreshInterval:g,setAutoReload:b,triggerRefresh:h,setTimeRange:m}):null)},yg=()=>{const{params:{type:e}}=Object(c.useRouteMatch)();return r.a.createElement(Y.EuiErrorBoundary,null,"host"===e?r.a.createElement(jp,null):r.a.createElement(D,null,r.a.createElement(hg,null)))},Eg=W.i18n.translate("xpack.infra.sourceConfiguration.metricIndicesDoNotExistTitle",{defaultMessage:"No matching index found"}),vg=W.i18n.translate("xpack.infra.sourceConfiguration.remoteClusterConnectionDoNotExistTitle",{defaultMessage:"Couldn’t connect to the remote cluster"}),xg=({isLoading:e,readOnly:t,metricAliasFieldProps:a,metricIndicesExist:n,remoteClustersExist:i})=>r.a.createElement(Y.EuiForm,null,r.a.createElement(Y.EuiTitle,{size:"s"},r.a.createElement("h3",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.indicesSectionTitle",defaultMessage:"Indices"}))),r.a.createElement(Y.EuiSpacer,{size:"m"}),r.a.createElement(Y.EuiDescribedFormGroup,{title:r.a.createElement("h4",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.metricIndicesTitle",defaultMessage:"Metrics indices"})),description:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.metricIndicesDescription",defaultMessage:"Index pattern for matching indices that contain metrics data"})},r.a.createElement(Y.EuiFormRow,{error:a.error,fullWidth:!0,helpText:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.metricIndicesRecommendedValue",defaultMessage:"The recommended value is {defaultValue}",values:{defaultValue:r.a.createElement(Y.EuiCode,null,Re.f)}}),isInvalid:a.isInvalid,label:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.metricIndicesLabel",defaultMessage:"Metrics indices"})},r.a.createElement(Y.EuiFieldText,de()({"data-test-subj":"metricIndicesInput",fullWidth:!0,disabled:e,readOnly:t,isLoading:e},a))),i&&!n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiSpacer,{size:"s"}),r.a.createElement(Y.EuiCallOut,{size:"s",title:Eg,color:"warning",iconType:"warning","data-test-subj":"infraIndicesPanelSettingsWarningCallout"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.metricIndicesDoNotExist",defaultMessage:"We couldn’t find any metrics data because the pattern entered doesn’t match any index."}))),!i&&!n&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiSpacer,{size:"s"}),r.a.createElement(Y.EuiCallOut,{"data-test-subj":"infraIndicesPanelSettingsDangerCallout",size:"s",title:vg,color:"danger",iconType:"error"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.remoteClusterConnectionDoNotExist",defaultMessage:"Check that the remote cluster is available or that the remote connection settings are correct."}))))),wg=({isLoading:e,readOnly:t,anomalyThresholdFieldProps:a})=>r.a.createElement(Y.EuiForm,null,r.a.createElement(Y.EuiTitle,{size:"s"},r.a.createElement("h3",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.mlSectionTitle",defaultMessage:"Machine Learning"}))),r.a.createElement(Y.EuiSpacer,{size:"m"}),r.a.createElement(Y.EuiDescribedFormGroup,{title:r.a.createElement("h4",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.anomalyThresholdTitle",defaultMessage:"Anomaly Severity Threshold"})),description:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.anomalyThresholdDescription",defaultMessage:"Sets the minimum severity score required to show anomalies in the Metrics application."})},r.a.createElement(Y.EuiFormRow,{error:a.error,fullWidth:!0,isInvalid:a.isInvalid,label:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.anomalyThresholdLabel",defaultMessage:"Minimum severity score"})},r.a.createElement(Y.EuiRange,de()({min:0,max:100,"data-test-subj":"anomalyThresholdInput",showInput:!0,showTicks:!0,showRange:!0,tickInterval:20,"aria-label":"Minimum severity score",disabled:e,readOnly:t,isLoading:e},a))))),kg=({isLoading:e,readOnly:t,nameFieldProps:a})=>r.a.createElement(Y.EuiForm,null,r.a.createElement(Y.EuiTitle,{size:"s","data-test-subj":"sourceConfigurationNameSectionTitle"},r.a.createElement("h3",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameSectionTitle",defaultMessage:"Name"}))),r.a.createElement(Y.EuiSpacer,{size:"m"}),r.a.createElement(Y.EuiDescribedFormGroup,{title:r.a.createElement("h4",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameLabel",defaultMessage:"Name"})),description:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameDescription",defaultMessage:"A descriptive name for the source configuration"})},r.a.createElement(Y.EuiFormRow,{error:a.error,fullWidth:!0,isInvalid:a.isInvalid,label:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameLabel",defaultMessage:"Name"})},r.a.createElement(Y.EuiFieldText,de()({"data-test-subj":"nameInput",fullWidth:!0,disabled:e,readOnly:t,isLoading:e},a))))),Og=({errors:e,name:t,onChange:a,value:n})=>({error:e,isInvalid:e.length>0,name:t,onChange:e=>a(e.currentTarget.value),value:n}),Mg=(...e)=>t=>e.map((e=>e(t))).filter(Boolean),jg=e=>""===e,Sg=e=>jg(e)&&r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.fieldEmptyErrorMessage",defaultMessage:"The field must not be empty."}),Cg=e=>(e=>e.split(",").some(jg))(e)&&r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.fieldContainEmptyEntryErrorMessage",defaultMessage:"The field must not include empty comma-separated values."}),Tg=e=>(e=>e.includes(" "))(e)&&r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.fieldContainSpacesErrorMessage",defaultMessage:"The field must not include spaces."}),Ig={name:"",description:"",metricAlias:"",anomalyThreshold:0};var Fg=a(103);function Lg({readOnly:e,handleFieldChange:t,settingsEditableConfig:a,unsavedChanges:n}){const{services:{docLinks:i,notifications:s}}=Object(ge.b)(),{featureFlags:l}=_c();return r.a.createElement(Y.EuiForm,null,r.a.createElement(Y.EuiTitle,{size:"s","data-test-subj":"sourceConfigurationFeaturesSectionTitle"},r.a.createElement("h3",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.featuresSectionTitle",defaultMessage:"Features"}))),r.a.createElement(Y.EuiSpacer,{size:"m"}),r.a.createElement(Fg.LazyField,{key:pe.enableInfrastructureHostsView,setting:a[pe.enableInfrastructureHostsView],handleChange:t,enableSaving:!e,docLinks:i.links,toasts:s.toasts,unsavedChanges:n[pe.enableInfrastructureHostsView]}),l.profilingEnabled&&r.a.createElement(Fg.LazyField,{key:pe.enableInfrastructureProfilingIntegration,setting:a[pe.enableInfrastructureProfilingIntegration],handleChange:t,enableSaving:!e,docLinks:i.links,toasts:s.toasts,unsavedChanges:n[pe.enableInfrastructureProfilingIntegration]}))}const Pg=({shouldAllowEdit:e})=>{var t;Be([{text:Ae.j}]);const{createSourceConfiguration:a,source:i,sourceExists:s,isLoading:l,isUninitialized:o,updateSourceConfiguration:c}=Object(re.b)(),{indicesConfigurationProps:u,errors:d,resetForm:m,isFormDirty:p,isFormValid:g,formState:f,formStateChanges:b}=(e=>{const t=(({initialFormState:e=Ig})=>{const[t,a]=Object(n.useState)({}),r=Object(n.useCallback)((()=>a({})),[]),i=Object(n.useMemo)((()=>({...e,...t})),[e,t]),s=Object(n.useMemo)((()=>Og({errors:Mg(Sg)(i.name),name:"name",onChange:e=>a((t=>({...t,name:e}))),value:i.name})),[i.name]),l=Object(n.useMemo)((()=>Og({errors:Mg(Sg,Cg,Tg)(i.metricAlias),name:"metricAlias",onChange:e=>a((t=>({...t,metricAlias:e}))),value:i.metricAlias})),[i.metricAlias]),o=Object(n.useMemo)((()=>(({errors:e,name:t,onChange:a,value:n})=>({error:e,isInvalid:e.length>0,name:t,onChange:(e,t)=>a(+e.currentTarget.value,t),value:n}))({errors:Mg(Sg)(i.anomalyThreshold),name:"anomalyThreshold",onChange:e=>a((t=>({...t,anomalyThreshold:e}))),value:i.anomalyThreshold})),[i.anomalyThreshold]),c=Object(n.useMemo)((()=>({name:s,metricAlias:l,anomalyThreshold:o})),[s,l,o]),u=Object(n.useMemo)((()=>Object.values(c).reduce(((e,{error:t})=>[...e,...t]),[])),[c]),d=Object(n.useMemo)((()=>u.length<=0),[u]),m=Object(n.useMemo)((()=>Object.keys(t).length>0),[t]);return{errors:u,fieldProps:c,formState:i,formStateChanges:t,isFormDirty:m,isFormValid:d,resetForm:r}})({initialFormState:Object(n.useMemo)((()=>e?{name:e.name,description:e.description,metricAlias:e.metricAlias,anomalyThreshold:e.anomalyThreshold}:void 0),[e])}),a=Object(n.useMemo)((()=>[...t.errors]),[t.errors]),r=Object(n.useCallback)((()=>{t.resetForm()}),[t]),i=Object(n.useMemo)((()=>t.isFormDirty),[t.isFormDirty]),s=Object(n.useMemo)((()=>t.isFormValid),[t.isFormValid]);return{errors:a,formState:Object(n.useMemo)((()=>({name:t.formState.name,description:t.formState.description,metricAlias:t.formState.metricAlias,anomalyThreshold:t.formState.anomalyThreshold})),[t.formState]),formStateChanges:Object(n.useMemo)((()=>({name:t.formStateChanges.name,description:t.formStateChanges.description,metricAlias:t.formStateChanges.metricAlias,anomalyThreshold:t.formStateChanges.anomalyThreshold})),[t.formStateChanges]),isFormDirty:i,isFormValid:s,indicesConfigurationProps:t.fieldProps,resetForm:r}})(i&&i.configuration),h=Object(me.useEditableSettings)("infra_metrics",[pe.enableInfrastructureHostsView,pe.enableInfrastructureProfilingIntegration]),y=Object(n.useCallback)((()=>{m(),h.cleanUnsavedChanges()}),[h,m]),E=Object(n.useCallback)((async()=>{await Promise.all([s?c(b):a(f),h.saveAll()]),m()}),[s,m,c,b,h,a,f]),v=p||Object.keys(h.unsavedChanges).length>0,x=e&&(!Boolean(i)||"internal"!==(null==i?void 0:i.origin)),{metricIndicesExist:w,remoteClustersExist:k}=null!==(t=null==i?void 0:i.status)&&void 0!==t?t:{},{hasInfraMLCapabilities:O}=Pi();return!l&&!o||i?r.a.createElement(Pt.a,{pageHeader:{pageTitle:Ae.j},"data-test-subj":"sourceConfigurationContent",restrictWidth:!0},r.a.createElement(me.Prompt,{prompt:p?W.i18n.translate("xpack.infra.sourceConfiguration.unsavedFormPrompt",{defaultMessage:"Are you sure you want to leave? Changes will be lost"}):void 0}),r.a.createElement(Y.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},r.a.createElement(kg,{isLoading:l,nameFieldProps:u.name,readOnly:!x})),r.a.createElement(Y.EuiSpacer,null),r.a.createElement(Y.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},r.a.createElement(xg,{isLoading:l,metricAliasFieldProps:u.metricAlias,readOnly:!x,metricIndicesExist:w,remoteClustersExist:k})),r.a.createElement(Y.EuiSpacer,null),O&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},r.a.createElement(wg,{isLoading:l,readOnly:!x,anomalyThresholdFieldProps:u.anomalyThreshold})),r.a.createElement(Y.EuiSpacer,null)),r.a.createElement(Y.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},r.a.createElement(Lg,de()({readOnly:!x},h))),r.a.createElement(Y.EuiSpacer,null),d.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiCallOut,{color:"danger"},r.a.createElement("ul",null,d.map(((e,t)=>r.a.createElement("li",{key:t},e))))),r.a.createElement(Y.EuiSpacer,{size:"m"})):null,r.a.createElement(Y.EuiSpacer,{size:"m"}),r.a.createElement(Y.EuiFlexGroup,null,x&&r.a.createElement(Y.EuiFlexItem,null,l||h.isSaving?r.a.createElement(Y.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,{"data-test-subj":"infraSourceConfigurationSettingsLoadingButton",color:"primary",isLoading:!0,fill:!0},W.i18n.translate("xpack.infra.sourceConfiguration.loadingButtonLabel",{defaultMessage:"Loading"})))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,{"data-test-subj":"discardSettingsButton",color:"danger",iconType:"cross",isDisabled:!v,onClick:y},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.discardSettingsButtonLabel",defaultMessage:"Discard"}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,{"data-test-subj":"applySettingsButton",color:"primary",isDisabled:!v||!g,fill:!0,onClick:E},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.sourceConfiguration.applySettingsButtonLabel",defaultMessage:"Apply"})))))))):r.a.createElement(Me.a,null)},Dg=()=>{var e,t;const a=null===(e=Object(Q.useKibana)().services.application)||void 0===e?void 0:e.capabilities;return r.a.createElement(Y.EuiErrorBoundary,null,r.a.createElement(Pg,{shouldAllowEdit:null==a||null===(t=a.infrastructure)||void 0===t?void 0:t.configureSource}))};function _g({onClose:e}){const{triggersActionsUI:t}=Object(n.useContext)(We.a);return Object(n.useMemo)((()=>t?t.getAddRuleFlyout({consumer:"infrastructure",onClose:e,canChangeTrigger:!1,ruleTypeId:Iu.sb,metadata:{currentOptions:{groupBy:"host.name"}}}):null),[e,t])}const Rg=()=>{var e;const[t,a]=Object(n.useState)(!1),[i,s]=Object(n.useState)(null),l=null===(e=Object(Q.useKibana)().services.application)||void 0===e?void 0:e.capabilities,{services:{observability:o}}=Object(Q.useKibana)(),c=Object(n.useMemo)((()=>{var e;return Boolean(null==l||null===(e=l.infrastructure)||void 0===e?void 0:e.save)}),[l]),u=Object(n.useCallback)((()=>s(null)),[s]),d=Object(n.useCallback)((()=>{a(!1)}),[a]),m=Object(n.useCallback)((()=>{a(!t)}),[a,t]),p=Object(n.useCallback)((e=>{d(),s(e)}),[d]),g=function(e){const{featureFlags:t}=_c();return Object(n.useMemo)((()=>t.inventoryThresholdAlertRuleEnabled?{items:[{"data-test-subj":"inventory-alerts-menu-option",name:W.i18n.translate("xpack.infra.alerting.infrastructureDropdownMenu",{defaultMessage:"Infrastructure"}),panel:1}],panels:[{id:1,title:W.i18n.translate("xpack.infra.alerting.infrastructureDropdownTitle",{defaultMessage:"Infrastructure rules"}),items:[{"data-test-subj":"inventory-alerts-create-rule",name:W.i18n.translate("xpack.infra.alerting.createInventoryRuleButton",{defaultMessage:"Create inventory rule"}),onClick:()=>e("inventory")}]}]}:{items:[],panels:[]}),[t.inventoryThresholdAlertRuleEnabled,e])}(p),f=function(e){const{featureFlags:t}=_c();return Object(n.useMemo)((()=>t.metricThresholdAlertRuleEnabled?{items:[{"data-test-subj":"metrics-threshold-alerts-menu-option",name:W.i18n.translate("xpack.infra.alerting.metricsDropdownMenu",{defaultMessage:"Metrics"}),panel:2}],panels:[{id:2,title:W.i18n.translate("xpack.infra.alerting.metricsDropdownTitle",{defaultMessage:"Metrics rules"}),items:[{"data-test-subj":"metrics-threshold-alerts-create-rule",name:W.i18n.translate("xpack.infra.alerting.createThresholdRuleButton",{defaultMessage:"Create threshold rule"}),onClick:()=>e("metricThreshold")}]}]}:{items:[],panels:[]}),[t.metricThresholdAlertRuleEnabled,e])}(p),b=function(e){const{featureFlags:t}=_c();return Object(n.useMemo)((()=>t.customThresholdAlertsEnabled?{items:[{"data-test-subj":"custom-threshold-alerts-menu-option",name:W.i18n.translate("xpack.infra.alerting.customThresholdDropdownMenu",{defaultMessage:"Create custom threshold rule"}),onClick:()=>e("customThreshold")}],panels:[]}:{items:[],panels:[]}),[t.customThresholdAlertsEnabled,e])}(p),h=o.useRulesLink(),y=Object(n.useMemo)((()=>({name:W.i18n.translate("xpack.infra.alerting.manageRules",{defaultMessage:"Manage rules"}),icon:"tableOfContents",onClick:h.onClick})),[h]),E=Object(n.useMemo)((()=>[{id:0,title:W.i18n.translate("xpack.infra.alerting.alertDropdownTitle",{defaultMessage:"Alerts and rules"}),items:c?[...g.items,...f.items,...b.items,y]:[y]},...c?[...g.panels,...f.panels,...b.panels]:[]]),[c,g,f,b,y]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiPopover,{panelPaddingSize:"none",anchorPosition:"downLeft",button:r.a.createElement(Y.EuiHeaderLink,{color:"text",iconSide:"right",iconType:"arrowDown",onClick:m,"data-test-subj":"infrastructure-alerts-and-rules"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.alerting.alertsButton",defaultMessage:"Alerts and rules"})),isOpen:t,closePopover:d},r.a.createElement(Y.EuiContextMenu,{initialPanelId:0,panels:E,"data-test-subj":"metrics-alert-menu"})),r.a.createElement(Ag,{visibleFlyoutType:i,onClose:u}))},Ag=({visibleFlyoutType:e,onClose:t})=>{switch(e){case"inventory":return r.a.createElement(on,{onClose:t});case"metricThreshold":return r.a.createElement(Ye,{onClose:t});case"customThreshold":return r.a.createElement(_g,{onClose:t});default:return null}};var Bg=a(239);const Vg=e=>{const[t]=Object(n.useState)((()=>h()())),{goHome:a}=e,[i,s]=Object(n.useState)(t.clone().subtract(4,"weeks")),[l,o]=Object(n.useState)(null),c=_s(),u=Ks(),[d,m]=Object(n.useState)(""),[p,g]=Object(n.useState)(""),f=Object(me.useUiTracker)({app:"infra_metrics"}),{createDerivedIndexPattern:b}=Object(re.b)(),y=c.sourceConfiguration.indices,E=Object(n.useMemo)((()=>"kubernetes"===e.jobType?u.setupStatus:c.setupStatus),[e.jobType,u.setupStatus,c.setupStatus]),v=Object(n.useMemo)((()=>"kubernetes"===e.jobType?u.cleanUpAndSetUpModule:c.cleanUpAndSetUpModule),[e.jobType,u.cleanUpAndSetUpModule,c.cleanUpAndSetUpModule]),x=Object(n.useMemo)((()=>"kubernetes"===e.jobType?u.setUpModule:c.setUpModule),[e.jobType,u.setUpModule,c.setUpModule]),w=Object(n.useMemo)((()=>"kubernetes"===e.jobType?u.jobSummaries.length>0:c.jobSummaries.length>0),[e.jobType,u.jobSummaries,c.jobSummaries]),k=Object(n.useMemo)((()=>b()),[b]),O=Object(n.useCallback)((e=>{s(e)}),[]),M=Object(n.useCallback)((()=>{w?v(y,h()(i).toDate().getTime(),void 0,p,l?l[0]:void 0):x(y,h()(i).toDate().getTime(),void 0,p,l?l[0]:void 0)}),[v,p,x,w,y,l,i]),j=Object(n.useCallback)((e=>{m(e||""),g(Object(da.a)(e,k)||"")}),[k]),S=Object(n.useCallback)(Object(Ne.debounce)(j,500),[j]),C=Object(n.useCallback)((e=>{o(e.map((e=>e.label)))}),[]);return Object(n.useEffect)((()=>{"kubernetes"===e.jobType&&o([$s])}),[e.jobType]),Object(n.useEffect)((()=>{"succeeded"===E.type&&("kubernetes"===e.jobType?(f({metric:"metrics_ml_anomaly_detection_k8s_enabled"}),!l||1===l.length&&l[0]===$s||f({metric:"metrics_ml_anomaly_detection_k8s_partition_changed"})):(f({metric:"metrics_ml_anomaly_detection_hosts_enabled"}),l&&f({metric:"metrics_ml_anomaly_detection_hosts_partition_changed"}),f({metric:"metrics_ml_anomaly_detection_hosts_enabled"})),a())}),[E,e.jobType,l,f,a]),r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlyoutHeader,null,r.a.createElement(Y.EuiTitle,{size:"m"},r.a.createElement("h2",null,r.a.createElement(X.FormattedMessage,{defaultMessage:"Enable machine learning for {nodeType}",id:"xpack.infra.ml.aomalyFlyout.jobSetup.flyoutHeader",values:{nodeType:e.jobType}})))),r.a.createElement(Y.EuiFlyoutBody,null,"pending"===E.type?r.a.createElement(Y.EuiFlexGroup,{alignItems:"center"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiLoadingSpinner,{size:"xl"})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.loadingText",defaultMessage:"Creating ML job..."}))):"failed"===E.type?r.a.createElement(r.a.Fragment,null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.failureText",defaultMessage:"Something went wrong creating the necessary ML jobs."}),r.a.createElement(Y.EuiSpacer,null),E.reasons.map(((e,t)=>r.a.createElement(Y.EuiCallOut,{key:t,color:"danger",iconType:"warning",title:Ng},r.a.createElement(Y.EuiCode,{transparentBackground:!0},e)))),r.a.createElement(Y.EuiSpacer,null),r.a.createElement(Y.EuiButton,{"data-test-subj":"infraJobSetupScreenTryAgainButton",fill:!0,onClick:M},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.tryAgainButton",defaultMessage:"Try again"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiText,null,r.a.createElement("p",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.description",defaultMessage:"Settings can not be changed once the jobs are created. You can recreate jobs anytime, however, the previously detected anomalies are removed."}))),r.a.createElement(Y.EuiSpacer,{size:"l"}),r.a.createElement(Y.EuiForm,null,r.a.createElement(Y.EuiDescribedFormGroup,{title:r.a.createElement("h3",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.when.title",defaultMessage:"When does your model begin?"})),description:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.when.description",defaultMessage:"By default, machine learning jobs analyze the last 4 weeks of data and continue to run indefinitely."})},r.a.createElement(Y.EuiFormRow,{label:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.when.timePicker.label",defaultMessage:"Start date"})},r.a.createElement(Bg.a,{showTimeSelect:!0,selected:i,onChange:O,maxDate:t}))),r.a.createElement(Y.EuiDescribedFormGroup,{title:r.a.createElement("h3",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.partition.title",defaultMessage:"How do you want to partition your data?"})),description:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.partition.description",defaultMessage:"Partitions enable you to build independent models for groups of data that share similar behavior. For example, you can partition by machine type or cloud availability zone."})},r.a.createElement(Y.EuiFormRow,{label:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.partition.label",defaultMessage:"Partition field"}),display:"rowCompressed"},r.a.createElement(Y.EuiComboBox,{placeholder:W.i18n.translate("xpack.infra.metricsExplorer.groupByLabel",{defaultMessage:"Everything"}),"aria-label":W.i18n.translate("xpack.infra.metricsExplorer.groupByAriaLabel",{defaultMessage:"Graph per"}),fullWidth:!0,singleSelection:!0,selectedOptions:l?l.map((e=>({label:e}))):void 0,options:k.fields.filter((e=>e.aggregatable&&"string"===e.type)).map((e=>({label:e.name}))),onChange:C,isClearable:!0}))),r.a.createElement(Y.EuiDescribedFormGroup,{title:r.a.createElement("h3",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.filter.title",defaultMessage:"Filter"})),description:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.filter.description",defaultMessage:"By default, machine learning jobs analyze all of your metric data."})},r.a.createElement(Y.EuiFormRow,{display:"rowCompressed",label:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.filter.label",defaultMessage:"Filter (optional)"})},r.a.createElement(Ot.a,{derivedIndexPattern:k,onSubmit:j,onChange:S,value:d})))))),r.a.createElement(Y.EuiFlyoutFooter,null,r.a.createElement(Y.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"infraJobSetupScreenCancelButton",onClick:e.closeFlyout},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.cancelButton",defaultMessage:"Cancel"}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,{"data-test-subj":"infraJobSetupScreenEnableJobsButton",fill:!0,fullWidth:!1,onClick:M},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.enableButton",defaultMessage:"Enable jobs"}))))))},Ng=W.i18n.translate("xpack.infra.ml.steps.setupProcess.errorCalloutTitle",{defaultMessage:"An error occurred"});var zg=a(175);const $g=()=>{var e,t;const{hasInfraMLSetupCapabilities:a}=Fi(),[i,s]=Object(n.useState)(!1),[l,o]=Object(n.useState)("home"),[c,u]=Object(n.useState)(null),{source:d}=Object(re.b)(),{space:m}=Object(zg.a)(),p=Object(n.useCallback)((()=>{o("home"),s(!0)}),[]),g=Object(n.useCallback)((e=>{o("setup"),u({jobType:e})}),[o]),f=Object(n.useCallback)((()=>{s(!1)}),[]);return null==(null==d?void 0:d.configuration.metricAlias)||null==m?null:r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiHeaderLink,{color:"text",iconSide:"left",iconType:"inspect",onClick:p,"data-test-subj":"openAnomalyFlyoutButton"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.ml.anomalyDetectionButton",defaultMessage:"Anomaly detection"})),i&&r.a.createElement(Ds,{indexPattern:null!==(e=null==d?void 0:d.configuration.metricAlias)&&void 0!==e?e:"",sourceId:"default",spaceId:m.id},r.a.createElement(Js,{indexPattern:null!==(t=null==d?void 0:d.configuration.metricAlias)&&void 0!==t?t:"",sourceId:"default",spaceId:m.id},r.a.createElement(Y.EuiFlyout,{onClose:f,"data-test-subj":"loadMLFlyout"},"home"===l&&r.a.createElement(Ys,{hasSetupCapabilities:a,goToSetup:g,closeFlyout:f}),"setup"===l&&r.a.createElement(Vg,{goHome:p,closeFlyout:f,jobType:c.jobType})))))};var qg=a(61),Ug=a(296),Gg=a(489),Hg=a.n(Gg),Wg=a(104);const Qg={defaultOptions:{queries:{keepPreviousData:!0,refetchOnWindowFocus:!1}}};function Jg({children:e,config:t={}}){const[a]=Object(n.useState)((()=>new je.QueryClient(Hg()(Qg,t))));return r.a.createElement(je.QueryClientProvider,{client:a},r.a.createElement(Kg,null),e)}function Kg(){const[e,t]=Object(n.useState)(!1);return e?null:r.a.createElement("div",null,r.a.createElement(Y.EuiButtonIcon,{"data-test-subj":"infraHideableReactQueryDevToolsButton",iconType:"cross",color:"primary",style:{zIndex:99999,position:"fixed",bottom:"40px",left:"40px"},onClick:()=>t(!e),"aria-label":"Disable React Query Dev Tools"}),r.a.createElement(Wg.ReactQueryDevtools,{initialIsOpen:!1}))}var Yg=a(105);const Xg={HOST_OS_NAME:"host.os.name",CLOUD_PROVIDER:"cloud.provider",SERVICE_NAME:"service.name"},Zg={[Xg.HOST_OS_NAME]:{order:0,width:"medium",grow:!1,type:"optionsListControl",explicitInput:{id:Xg.HOST_OS_NAME,fieldName:Xg.HOST_OS_NAME,title:"Operating System"}},[Xg.CLOUD_PROVIDER]:{order:1,width:"medium",grow:!1,type:"optionsListControl",explicitInput:{id:Xg.CLOUD_PROVIDER,fieldName:Xg.CLOUD_PROVIDER,title:"Cloud Provider"}},[Xg.SERVICE_NAME]:{order:2,width:"medium",grow:!1,type:"optionsListControl",explicitInput:{id:Xg.SERVICE_NAME,fieldName:Xg.SERVICE_NAME,title:"Service Name"}}},ef=Object.values(Xg),tf=e=>(e=>ef.filter((t=>void 0!==(null==e?void 0:e.fields.getByName(t)))))(e).reduce(((e,t)=>({...e,[t]:Zg[t]})),{}),af=(e,t={})=>{const a=tf(e),n=Object.keys(a),r=Object(Ne.pick)(t,n);return((e,t="")=>Object.entries(e).reduce(((e,[a,n])=>({...e,[a]:{...n,explicitInput:{...n.explicitInput,dataViewId:t}}})),{}))({...a,...r},e.id)},nf=v.type({order:v.number,width:v.union([v.literal("medium"),v.literal("small"),v.literal("large")]),grow:v.boolean,type:v.string,explicitInput:v.intersection([v.type({id:v.string}),v.partial({dataViewId:v.string,fieldName:v.string,title:v.union([v.string,v[void 0]]),selectedOptions:v.array(v.string)})])}),rf=v.record(v.string,nf),sf=e=>{if(e){const a=(t=e,Object.entries(t).reduce(((e,[t,a])=>{const{explicitInput:n}=a,{dataViewId:r,...i}=n;return{...e,[t]:{...a,explicitInput:i}}}),{}));return rf.encode(a)}var t},lf=e=>{if(e)return Object(x.pipe)(rf.decode(e),Object(w.fold)(Object(k.constant)({}),k.identity))},of=({children:e})=>{const t=Object(n.useRef)(null),[a,{off:i,toggle:s}]=Nt(!1),l=Object(n.useCallback)((e=>{e.preventDefault(),e.stopPropagation(),s()}),[s]);return r.a.createElement(Y.EuiPopover,{panelPaddingSize:"s",ownFocus:!1,buttonRef:e=>t.current=e,button:r.a.createElement(cf,{"data-test-subj":"hostsViewTableColumnPopoverButton",type:"questionInCircle",onClick:l}),isOpen:a,closePopover:i,offset:10,anchorPosition:"upCenter",panelStyle:{maxWidth:350}},e)};var cf=Fa()(Y.EuiIcon).withConfig({displayName:"_StyledEuiIcon",componentId:"sc-17s5uqg-0"})(["cursor:pointer;"]);const uf={[Xg.SERVICE_NAME]:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.serviceNameControl.popoverHelpLabel",defaultMessage:"Services detected via {APMDocs}",values:{APMDocs:r.a.createElement(Y.EuiLink,{href:"https://ela.st/docs-infra-apm",target:"_blank","data-test-subj":"hostsViewServiceNameControlPopoverHelpLink"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.serviceNameControl.popoverHelpLink",defaultMessage:"APM"}))}})},df=({title:e,helpMessage:t,embeddableId:a})=>r.a.createElement(Y.EuiFormLabel,{className:"controlFrame__formControlLayoutLabel",htmlFor:a},r.a.createElement(Y.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},r.a.createElement(Y.EuiFlexItem,{grow:!1},e),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(of,null,t)))),mf=({title:e,embeddableId:t})=>{const a=uf[t];return a?r.a.createElement(df,{title:e,helpMessage:a,embeddableId:t}):r.a.createElement(Y.EuiFormLabel,{className:"controlFrame__formControlLayoutLabel",htmlFor:t},e)},pf=({dataView:e,filters:t,query:a,timeRange:i,onFiltersChange:s})=>{const[l,o]=(e=>{const t=Object(n.useMemo)((()=>tf(e)),[e]),[a,r]=Object(O.a)({defaultState:t,decodeUrlState:lf,encodeUrlState:sf,urlStateKey:"controlPanels"});return[e?af(e,a):{},r]})(e),c=Object(n.useRef)(new jr.Subscription),u=Object(n.useCallback)((async()=>{var n;return{initialInput:{id:null!==(n=null==e?void 0:e.id)&&void 0!==n?n:"",viewMode:pu.ViewMode.VIEW,chainingSystem:"HIERARCHICAL",controlStyle:"oneLine",defaultControlWidth:"small",panels:l,filters:t,query:a,timeRange:i}}}),[l,null==e?void 0:e.id,t,a,i]),d=Object(n.useCallback)((e=>{e&&(e.untilAllChildrenReady().then((()=>{e.getChildIds().map((t=>{const a=e.children[t];a.renderPrepend=()=>r.a.createElement(mf,{title:a.getTitle(),embeddableId:t})}))})),c.current.add(e.onFiltersPublished$.subscribe((e=>{s(e)}))),c.current.add(e.getInput$().subscribe((({panels:e})=>o(e)))))}),[s,o]);return Object(n.useEffect)((()=>{const e=c.current;return()=>{e.unsubscribe()}}),[]),r.a.createElement(gf,null,r.a.createElement(Yg.ControlGroupRenderer,{getCreationOptions:u,ref:d,timeRange:i,query:a,filters:t}))},gf=Z.euiStyled.div`
  .controlGroup {
    min-height: ${e=>e.theme.eui.euiSizeXXL}
  }
`,ff=({limit:e,onChange:t})=>{const[a,i]=Object(n.useState)(e),s=Object(n.useCallback)(((e,a)=>{i(a),t(a)}),[t]);return r.a.createElement(Y.EuiFlexGroup,{direction:"row",alignItems:"center",justifyContent:"spaceBetween",responsive:!1,gutterSize:"xs"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiText,{size:"xs",textAlign:"left"},r.a.createElement("strong",null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.hostLimit",defaultMessage:"Host limit"})))),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiToolTip,{className:"eui-fullWidth",delay:"regular",content:W.i18n.translate("xpack.infra.hostsViewPage.hostLimit.tooltip",{defaultMessage:"To ensure faster query performance, there is a limit to the number of hosts returned"}),anchorClassName:"eui-fullWidth"},r.a.createElement(Y.EuiIcon,{type:"iInCircle",size:"m"}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButtonGroup,{type:"single",legend:W.i18n.translate("xpack.infra.hostsViewPage.tabs.alerts.alertStatusFilter.legend",{defaultMessage:"Filter by"}),idSelected:bf(a),options:hf,onChange:s})))},bf=e=>`hostLimit_${e}`,hf=[50,100,500].map((e=>({id:bf(e),label:`${e}`,value:e,"data-test-subj":`hostsViewLimitSelection${e}Button`}))),yf=()=>{var e,t;const{services:{unifiedSearch:a,application:i}}=Object(ge.b)(),{dataView:s}=Ml(),{searchCriteria:l,onSubmit:o}=co(),{SearchBar:c}=a.ui,u=Object(n.useCallback)((e=>{o({panelFilters:e})}),[o]);return r.a.createElement(Ef,null,r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(c,{appName:"Infra Hosts",displayStyle:"inPage",indexPatterns:s&&[s],placeholder:W.i18n.translate("xpack.infra.hosts.searchPlaceholder",{defaultMessage:"Search hosts (E.g. cloud.provider:gcp AND system.load.1 > 0.5)"}),onQuerySubmit:(e,t)=>{!1===t&&o(e)},saveQueryMenuVisibility:null!=i&&null!==(e=i.capabilities)&&void 0!==e&&null!==(t=e.visualize)&&void 0!==t&&t.saveQuery?"allowed_by_app_privilege":"globally_managed",showDatePicker:!0,showFilterBar:!0,showQueryInput:!0,showQueryMenu:!0,useDefaultBehaviors:!0,isAutoRefreshDisabled:!0})),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Y.EuiFlexGroup,{direction:"row",alignItems:"center",wrap:!1,gutterSize:"s"},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(pf,{timeRange:l.dateRange,dataView:s,query:l.query,filters:l.filters,onFiltersChange:u})),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(ff,{limit:l.limit,onChange:e=>{o({limit:e})}}))))),r.a.createElement(vf,{margin:"xs"}))},Ef=({children:e})=>{const{euiTheme:t}=Object(Y.useEuiTheme)(),{actionMenuHeight:a}=Dd();return r.a.createElement(xf,{$_css:a,$_css2:t.levels.navigation,$_css3:t.colors.emptyShade,$_css4:t.size.m,$_css5:t.size.l,$_css6:t.size.l,$_css7:t.size.l,$_css8:t.size.xxxl},e)};var vf=Fa()(Y.EuiHorizontalRule).withConfig({displayName:"_StyledEuiHorizontalRule",componentId:"sc-1ppmrps-0"})(["margin-bottom:0;"]),xf=Fa()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1ppmrps-1"})(["position:sticky;top:calc(","px + var(--euiFixedHeadersOffset,0));z-index:",";background:",";padding:"," "," 0px;margin:-"," -"," 0px;min-height:calc("," * 2);"],(e=>e.$_css),(e=>e.$_css2),(e=>e.$_css3),(e=>e.$_css4),(e=>e.$_css5),(e=>e.$_css6),(e=>e.$_css7),(e=>e.$_css8)),wf=a(98);const kf={gcp:"logoGCP",aws:"logoAWS",azure:"logoAzure",unknownProvider:"cloudSunny"};function Of(e){return null==e?kf.unknownProvider:kf[e]}function Mf({cloudProvider:e,...t}){const a={type:Of(e)};return e&&(a.title=e),Object(Wt.jsx)(Y.EuiIcon,de()({},a,t))}const jf=({onClick:e,title:t})=>{const{name:a,cloudProvider:n}=t,{getNodeDetailUrl:i}=ut(),{parsedDateRange:s}=co(),l=Object(me.useLinkProps)({...i({assetId:a,assetType:"host",search:{from:null!=s&&s.from?new Date(null==s?void 0:s.from).getTime():void 0,to:null!=s&&s.to?new Date(s.to).getTime():void 0,name:a}})}),o=null!=n?n:"Unknown";return r.a.createElement(Y.EuiFlexGroup,{alignItems:"center",className:"eui-textTruncate",gutterSize:"s",responsive:!1},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiToolTip,{delay:"long",content:o},r.a.createElement(Mf,{cloudProvider:n,size:"m",title:a}))),r.a.createElement(Y.EuiFlexItem,{grow:!1,className:"eui-textTruncate",onClick:e},r.a.createElement(Y.EuiToolTip,{delay:"long",content:a},r.a.createElement(Y.EuiLink,de()({"data-test-subj":"hostsViewTableEntryTitleLink",className:"eui-displayBlock eui-textTruncate"},l),a))))},Sf={detailsItemId:null,sorting:{direction:"asc",field:"name"},pagination:{pageIndex:0,pageSize:10}},Cf=(e,t)=>({...e,...Object.fromEntries(Object.entries(t).filter((([e,t])=>void 0!==t)))}),Tf=v.partial({pageIndex:v.number,pageSize:v.number}),If=v.intersection([v.type({field:v.string}),v.partial({direction:v.union([v.literal("asc"),v.literal("desc")])})]),Ff=v.type({detailsItemId:v.union([v.string,v.null]),pagination:Tf,sorting:If}),Lf=Ff.encode,Pf=e=>Object(x.pipe)(Ff.decode(e),Object(w.fold)(Object(k.constant)(void 0),k.identity));var Df=a(198),_f=a.n(Df);const Rf=[{type:"cpu"},{type:"diskSpaceUsage"},{type:"memory"},{type:"memoryFree"},{type:"normalizedLoad1m"},{type:"rx"},{type:"tx"}],Af=f()((()=>{var e;const{sourceId:t}=Object(re.b)(),{services:{http:a,data:r}}=Object(ge.b)(),{buildQuery:i,parsedDateRange:s,searchCriteria:l}=co(),o=Object(n.useRef)(new AbortController),[c,u]=Object(n.useState)((()=>r.search.session.start())),d=Object(n.useMemo)((()=>Nf({dateRange:s,esQuery:i(),sourceId:t,limit:l.limit})),[i,s,t,l.limit]),[m,p]=_f()((()=>(o.current.abort(),o.current=new AbortController,a.post("/api/metrics/infra",{signal:o.current.signal,body:JSON.stringify(d)}))),[d,a],{loading:!0});Object(n.useEffect)((()=>{p(),u(r.search.session.start())}),[r.search.session,p]);const{value:g,error:f,loading:b}=m;return{loading:b,error:f,hostNodes:null!==(e=null==g?void 0:g.nodes)&&void 0!==e?e:[],searchSessionId:c}})),[Bf,Vf]=Af,Nf=({esQuery:e,sourceId:t,dateRange:a,limit:n})=>({type:"host",query:e,range:{from:a.from,to:a.to},metrics:Rf,limit:n,sourceId:t}),zf=r.a.memo((({label:e,toolTip:t,formula:a})=>r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs"},r.a.createElement($f,null,e),t&&r.a.createElement(of,null,r.a.createElement(Mu,{formula:a,description:t,showDocumentationLink:!0})))));var $f=Fa()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-o726u0-0"})(["overflow-wrap:break-word !important;word-break:break-word;min-width:0;text-overflow:ellipsis;overflow:hidden;"]);const qf={title:W.i18n.translate("xpack.infra.hostsViewPage.table.nameColumnHeader",{defaultMessage:"Name"}),cpuUsage:W.i18n.translate("xpack.infra.hostsViewPage.table.cpuUsageColumnHeader",{defaultMessage:"CPU usage (avg.)"}),diskSpaceUsage:W.i18n.translate("xpack.infra.hostsViewPage.table.diskUsageColumnHeader",{defaultMessage:"Disk Usage (avg.)"}),tx:W.i18n.translate("xpack.infra.hostsViewPage.table.txColumnHeader",{defaultMessage:"TX (avg.)"}),rx:W.i18n.translate("xpack.infra.hostsViewPage.table.rxColumnHeader",{defaultMessage:"RX (avg.)"}),memoryFree:W.i18n.translate("xpack.infra.hostsViewPage.table.memoryFreeColumnHeader",{defaultMessage:"Memory Free (avg.)"}),memoryUsage:W.i18n.translate("xpack.infra.hostsViewPage.table.memoryUsageColumnHeader",{defaultMessage:"Memory Usage (avg.)"}),normalizedLoad1m:W.i18n.translate("xpack.infra.hostsViewPage.table.normalizedLoad1mColumnHeader",{defaultMessage:"Normalized Load (avg.)"}),toggleDialogAction:W.i18n.translate("xpack.infra.hostsViewPage.table.toggleDialogWithDetails",{defaultMessage:"Toggle dialog with details"})},Uf=(e,t)=>t||0===t?Object(Ya.a)({type:e})(t):"N/A",Gf=e=>"object"==typeof e&&e&&"name"in e,Hf=(e,t,{direction:a})=>"string"==typeof e&&"string"==typeof t?"desc"===a?t.localeCompare(e):e.localeCompare(t):Object(wf.isNumber)(e)&&Object(wf.isNumber)(t)?"desc"===a?t-e:e-t:1,Wf=f()((()=>{const e=Object(u.findInventoryModel)("host"),[t,a]=Object(n.useState)([]),{hostNodes:i}=Vf(),{value:s}=Gc()((()=>e.metrics.getFormulas())),[{detailsItemId:l,pagination:o,sorting:c},d]=(()=>{const[e,t]=_a()("hostsView:pageSizeSelection",10),[a,r]=Object(O.a)({defaultState:{...Sf,pagination:{...Sf.pagination,pageSize:e}},decodeUrlState:Pf,encodeUrlState:Lf,urlStateKey:"tableProperties"}),[i,s]=Object(n.useReducer)(Cf,a);return Sl()(i,a)||(r(i),e!==i.pagination.pageSize&&t(i.pagination.pageSize)),[i,s]})(),{services:{telemetry:m,data:{query:{filterManager:p}}}}=Object(ge.b)(),{dataView:g}=Ml(),f=Object(n.useRef)(null),b=Object(n.useCallback)((()=>d({detailsItemId:null})),[d]),h=Object(n.useCallback)((()=>{var e;if(!t.length)return[];const n=t.map((({name:e})=>e)),r=io({field:"host.name",values:n,dataView:g});p.addFilters(r),a([]),null===(e=f.current)||void 0===e||e.setSelection([])}),[g,p,t]),y=Object(n.useCallback)((({name:e,cloudProvider:t})=>{m.reportHostEntryClicked({hostname:e,cloud_provider:t})}),[m]),E=Object(n.useCallback)((({page:e,sort:t})=>{const{index:a,size:n}=e,{field:r,direction:i}=null!=t?t:{},s={field:r,direction:i},l={pageIndex:a,pageSize:n};Object(Ne.isEqual)(c,s)?Object(Ne.isEqual)(o,l)||d({pagination:l}):d({sorting:s})}),[d,o,c]),v=Object(n.useMemo)((()=>i.map((({metrics:e,metadata:t,name:a})=>{var n,r,i,s;const l=t.reduce(((e,t)=>({...e,[t.name]:t.value})),{});return{name:a,id:`${a}-${null!==(n=l["host.os.name"])&&void 0!==n?n:"-"}`,title:{name:a,cloudProvider:null!==(r=l["cloud.provider"])&&void 0!==r?r:null},os:null!==(i=l["host.os.name"])&&void 0!==i?i:"-",ip:null!==(s=l["host.ip"])&&void 0!==s?s:"",...e.reduce(((e,t)=>{var a;return{...e,[t.name]:null!==(a=t.value)&&void 0!==a?a:0}}),{})}}))),[i]),x=Object(n.useMemo)((()=>v.find((({id:e})=>e===l))),[l,v]),w=Object(n.useMemo)((()=>{const{pageSize:e=0,pageIndex:t=0}=o,a=(t+1)*e,n=t*e;return v.sort((({direction:e,field:t})=>(a,n)=>{const r=a[t],i=n[t];return Gf(r)&&Gf(i)?Hf(r.name,i.name,{direction:e,field:t}):Hf(r,i,{direction:e,field:t})})(c)).slice(n,a)}),[v,o,c]);return{columns:Object(n.useMemo)((()=>[{name:"",width:"40px",field:"id",actions:[{name:qf.toggleDialogAction,description:qf.toggleDialogAction,icon:({id:e})=>e===l?"minimize":"expand",type:"icon","data-test-subj":"hostsView-flyout-button",onClick:({id:e})=>{d({detailsItemId:e===l?null:e})}}]},{name:qf.title,field:"title",sortable:!0,truncateText:!0,"data-test-subj":"hostsView-tableRow-title",render:e=>r.a.createElement(jf,{title:e,onClick:()=>y(e)}),width:"20%"},{name:r.a.createElement(zf,{label:qf.cpuUsage,toolTip:rd.cpuUsage,formula:null==s?void 0:s.cpuUsage.value}),field:"cpu",sortable:!0,"data-test-subj":"hostsView-tableRow-cpuUsage",render:e=>Uf("cpu",e),align:"right"},{name:r.a.createElement(zf,{label:qf.normalizedLoad1m,toolTip:rd.normalizedLoad1m,formula:null==s?void 0:s.normalizedLoad1m.value}),field:"normalizedLoad1m",sortable:!0,"data-test-subj":"hostsView-tableRow-normalizedLoad1m",render:e=>Uf("normalizedLoad1m",e),align:"right"},{name:r.a.createElement(zf,{label:qf.memoryUsage,toolTip:rd.memoryUsage,formula:null==s?void 0:s.memoryUsage.value}),field:"memory",sortable:!0,"data-test-subj":"hostsView-tableRow-memoryUsage",render:e=>Uf("memory",e),align:"right"},{name:r.a.createElement(zf,{label:qf.memoryFree,toolTip:rd.memoryFree,formula:null==s?void 0:s.memoryFree.value}),field:"memoryFree",sortable:!0,"data-test-subj":"hostsView-tableRow-memoryFree",render:e=>Uf("memoryFree",e),align:"right"},{name:r.a.createElement(zf,{label:qf.diskSpaceUsage,toolTip:rd.diskUsage,formula:null==s?void 0:s.diskUsage.value}),field:"diskSpaceUsage",sortable:!0,"data-test-subj":"hostsView-tableRow-diskSpaceUsage",render:e=>Uf("diskSpaceUsage",e),align:"right"},{name:r.a.createElement(zf,{label:qf.rx,toolTip:rd.rx,formula:null==s?void 0:s.rx.value}),field:"rx",sortable:!0,"data-test-subj":"hostsView-tableRow-rx",render:e=>Uf("rx",e),align:"right",width:"120px"},{name:r.a.createElement(zf,{label:qf.tx,toolTip:rd.tx,formula:null==s?void 0:s.tx.value}),field:"tx",sortable:!0,"data-test-subj":"hostsView-tableRow-tx",render:e=>Uf("tx",e),align:"right",width:"120px"}]),[l,null==s?void 0:s.cpuUsage.value,null==s?void 0:s.diskUsage.value,null==s?void 0:s.memoryFree.value,null==s?void 0:s.memoryUsage.value,null==s?void 0:s.normalizedLoad1m.value,null==s?void 0:s.rx.value,null==s?void 0:s.tx.value,y,d]),clickedItem:x,currentPage:w,closeFlyout:b,items:v,isFlyoutOpen:null!==l,onTableChange:E,pagination:o,sorting:c,selection:{onSelectionChange:e=>{a(e)},selectable:e=>!!e.name},selectedItemsCount:t.length,filterSelectedHosts:h,refs:{tableRef:f}}})),[Qf,Jf]=Wf,Kf=({node:{name:e},closeFlyout:t})=>{const{source:a}=Object(re.b)(),{parsedDateRange:n}=co();return a?r.a.createElement(Vd,{assetId:e,assetName:e,assetType:"host",dateRange:n,overrides:{metadata:{showActionsColumn:!0}},tabs:zd,links:["apmServices","nodeDetails"],renderMode:{mode:"flyout",closeFlyout:t},metricAlias:a.configuration.metricAlias}):null},Yf=({selectedItemsCount:e,filterSelectedHosts:t})=>{const{euiTheme:a}=Object(Y.useEuiTheme)(),[n,{off:i,toggle:s}]=Nt(!1);return r.a.createElement(Xf,{$_css:a.size.m},r.a.createElement(Y.EuiPopover,{isOpen:n,closePopover:i,"data-test-subj":"bulkAction",panelPaddingSize:"s",className:Object(To.cx)({[To.css`
            top: -${a.size.s};
            position: absolute;
            opacity: 0;
            visibility: hidden;
          `]:!0,[To.css`
            opacity: 1;
            ${Y.euiCanAnimate} {
              transition: opacity ${a.animation.extraFast} ease-in;
            }
            visibility: visible;
          `]:e>0}),button:r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"hostsViewTableSelectHostsFilterButton",size:"xs",flush:"left",iconSide:"right",iconType:"arrowDown",onClick:s},(l=e,W.i18n.translate("xpack.infra.hostsViewPage.table.selectedHostsButton",{values:{selectedHostsCount:l},defaultMessage:"Selected {selectedHostsCount} {selectedHostsCount, plural, =1 {host} other {hosts}}"})))},r.a.createElement(Y.EuiButtonEmpty,{"data-test-subj":"hostsViewTableAddFilterButton",iconType:"filter",onClick:()=>{t(),i()}},W.i18n.translate("xpack.infra.hostsViewPage.table.addFilter",{defaultMessage:"Add filter"}))));var l};var Xf=Fa()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1fc5k1t-0"})(["position:relative;height:",";"],(e=>e.$_css));const Zf=[5,10,20],eb=()=>{var e,t,a;const{loading:n}=Vf(),{columns:i,items:s,currentPage:l,isFlyoutOpen:o,closeFlyout:c,clickedItem:u,onTableChange:d,pagination:m,sorting:p,selection:g,selectedItemsCount:f,filterSelectedHosts:b,refs:h}=Jf();return r.a.createElement(r.a.Fragment,null,r.a.createElement(Yf,{selectedItemsCount:f,filterSelectedHosts:b}),r.a.createElement(Y.EuiBasicTable,{ref:h.tableRef,"data-test-subj":"hostsView-table",itemId:"id",isSelectable:!0,selection:g,pagination:{pageIndex:null!==(e=m.pageIndex)&&void 0!==e?e:0,pageSize:null!==(t=m.pageSize)&&void 0!==t?t:10,totalItemCount:s.length,pageSizeOptions:Zf},sorting:{sort:{field:p.field,direction:null!==(a=p.direction)&&void 0!==a?a:"asc"}},rowProps:{"data-test-subj":"hostsView-tableRow"},items:l,columns:i,loading:n,onChange:d,noItemsMessage:n?W.i18n.translate("xpack.infra.waffle.loadingDataText",{defaultMessage:"Loading data"}):r.a.createElement(Y.EuiEmptyPrompt,{body:W.i18n.translate("xpack.infra.waffle.noDataDescription",{defaultMessage:"Try adjusting your time or filter."}),"data-test-subj":"hostsViewTableNoData",layout:"vertical",title:r.a.createElement("h2",null,W.i18n.translate("xpack.infra.waffle.noDataTitle",{defaultMessage:"There is no data to display."})),hasBorder:!1,titleSize:"m"})}),o&&u&&r.a.createElement(Kf,{node:u,closeFlyout:c}))},tb=e=>{const t=Object(n.useRef)(e);return t.current=e,t},ab=(e,t)=>{const[a,r]=nb(e,(()=>t));return Object(n.useEffect)((()=>{r(t)}),t),a},nb=(e,t)=>{const[[a,r],i]=Object(n.useState)((()=>{const e=new jr.BehaviorSubject(t()),a=e.next.bind(e);return[e,a]})),[s]=Object(n.useState)((()=>e(a)));return[s,r]},rb=e=>{var t,a;const{latestValue:r}=((e,t)=>{const[a,r]=Object(n.useState)(void 0),[i,s]=Object(n.useState)();return((e,{next:t,error:a,complete:r,unsubscribe:i})=>{const s=Object(n.useRef)(),l=tb(t),o=tb(a),c=tb(r),u=tb(i);Object(n.useEffect)((()=>{const t=u.current,a=e.subscribe({next:e=>{var t;return null===(t=l.current)||void 0===t?void 0:t.call(l,e)},error:e=>{var t;return null===(t=o.current)||void 0===t?void 0:t.call(o,e)},complete:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.call(c)}});return s.current=a,()=>{a.unsubscribe(),null==t||t()}}),[e,l,o,c,u]),s.current})(e,{next:r,error:s}),{latestValue:a,latestError:i}})(e);return{cancelRequest:Object(n.useCallback)((()=>{null==r||r.abortController.abort()}),[r]),isRequestRunning:null!==(t=null==r?void 0:r.response.isRunning)&&void 0!==t&&t,isResponsePartial:null!==(a=null==r?void 0:r.response.isPartial)&&void 0!==a&&a,latestResponseData:null==r?void 0:r.response.data,latestResponseErrors:null==r?void 0:r.response.errors,loaded:null==r?void 0:r.response.loaded,total:null==r?void 0:r.response.total}},ib=Object(Ar.switchMap)((({abortController:e,options:t,request:a,response$:n})=>n.pipe(Object(Ar.map)((n=>({abortController:e,options:t,request:a,response:n})))))),sb=f()((()=>{const{dataView:e,metricAlias:t}=Ml(),{services:{telemetry:a}}=Object(ge.b)(),{buildQuery:r,searchCriteria:i}=co(),{search:s,requests$:l}=(({getRequest:e,parseResponses:t})=>{const{services:a}=Object(ge.b)(),r=ab((()=>new jr.ReplaySubject(1)),[]),i=Object(n.useCallback)(((...n)=>{const i=e(...n);if(null==i)return;const s=new AbortController;let l=!0;const o={...i,abortController:s,response$:a.data.search.search(i.request,{abortSignal:s.signal,...i.options}).pipe(Object(Ar.tap)({error:()=>{l=!1},complete:()=>{l=!1}}),(c=()=>{l&&s.abort()},e=>new jr.Observable((t=>{const a=e.subscribe({next:e=>t.next(e),error:e=>t.error(e),complete:()=>t.complete()});return()=>{c(),a.unsubscribe()}}))),t,Object(Ar.share)())};var c;return r.next(o),o}),[e,a.data.search,t,r]);return{requests$:r,search:i}})({getRequest:Object(n.useCallback)((()=>{var a;const n=r(),s={bool:{...n.bool,filter:[...n.bool.filter,{exists:{field:"host.name"}},{range:{[null!==(a=null==e?void 0:e.timeFieldName)&&void 0!==a?a:"@timestamp"]:{gte:i.dateRange.from,lte:i.dateRange.to}}}]}};return{request:{params:{allow_no_indices:!0,ignore_unavailable:!0,index:t,size:0,track_total_hits:!1,body:{query:s,aggs:{count:{cardinality:{field:"host.name"}}}}}},options:{strategy:Ku.ES_SEARCH_STRATEGY}}}),[r,null==e?void 0:e.timeFieldName,t,i.dateRange.from,i.dateRange.to]),parseResponses:Object(n.useMemo)((()=>ub({telemetry:a,telemetryData:{withQuery:!!i.query.query,withFilters:i.filters.length>0||i.panelFilters.length>0}})),[i.filters.length,i.panelFilters.length,i.query.query,a])}),{isRequestRunning:o,isResponsePartial:c,latestResponseData:u,latestResponseErrors:d}=(e=>{const t=((e,t)=>{const a=tb(t);return ab((e=>e.pipe(Object(Ar.switchMap)((([e])=>a.current(e))))),[e])})(e,ib),{cancelRequest:a,isRequestRunning:n,isResponsePartial:r,latestResponseData:i,latestResponseErrors:s,loaded:l,total:o}=rb(t);return{cancelRequest:a,isRequestRunning:n,isResponsePartial:r,latestResponseData:i,latestResponseErrors:s,loaded:l,total:o}})(l);return Object(n.useEffect)((()=>{s()}),[s]),{errors:d,isRequestRunning:o,isResponsePartial:c,data:null!=u?u:null}})),[lb,ob]=sb,cb={data:null,errors:[],isPartial:!0,isRunning:!0,loaded:0,total:void 0},ub=({telemetry:e,telemetryData:t})=>a=>a.pipe(Object(jr.map)((e=>{var t,a;return{data:Object(pi.b)(db)(e.rawResponse.aggregations),errors:[],isPartial:null!==(t=e.isPartial)&&void 0!==t&&t,isRunning:null!==(a=e.isRunning)&&void 0!==a&&a,loaded:e.loaded,total:e.total}})),Object(jr.tap)((({data:a})=>{e.reportHostsViewTotalHostCountRetrieved({total:a.count.value,with_query:t.withQuery,with_filters:t.withFilters})})),Object(jr.startWith)(cb),Object(jr.catchError)((e=>{var t;return Object(jr.of)({...cb,errors:[null!==(t=e.message)&&void 0!==t?t:e],isRunning:!1})}))),db=v.type({count:v.type({value:v.number})}),mb=(e,t)=>{const a=Object(n.useRef)(void 0),[r,i]=Object(n.useState)(t);return a.current&&e===a.current||(a.current=e),Object(n.useEffect)((()=>{e||i(t)}),[a.current]),{afterLoadedState:r}},pb=({id:e,height:t,visualizationType:a="lnsMetric",dataView:i,...s})=>{const{searchCriteria:l}=co(),{hostNodes:o,loading:c,searchSessionId:u}=Vf(),{isRequestRunning:d}=ob(),m=0===o.length,p=c||d,g=m?l.filters:[io({field:"host.name",values:o.map((e=>e.name)),dataView:i})],{afterLoadedState:f}=mb(p,{dateRange:l.dateRange,query:m?l.query:void 0,filters:g,searchSessionId:u}),b=Object(n.useMemo)((()=>e in rd?r.a.createElement(Mu,{description:rd[e]}):void 0),[e]);return r.a.createElement(wu,de()({},s,{id:`hostsViewKPI-${e}`,dataView:i,dateRange:f.dateRange,filters:f.filters,loading:p,height:t,visualizationType:a,query:f.query,searchSessionId:f.searchSessionId,toolTip:b,disableTriggers:!0,hidePanelTitles:!0}))},gb=r.a.memo((({color:e,extra:t,id:a,loading:i,value:s,subtitle:l,title:o,toolTip:c,style:u,...d})=>{const m=Object(Y.useEuiTheme)(),p=Object(n.useRef)(!1);Object(n.useEffect)((()=>(p.current||i||(p.current=!0),()=>{p.current=!1})),[i]);const g={title:o,subtitle:l,color:e,extra:t,value:s,valueFormatter:e=>e.toString()};return r.a.createElement(Y.EuiPanel,de()({},d,{hasShadow:!1,paddingSize:"none","data-test-subj":a}),i&&!p.current?r.a.createElement(fu,{style:u}):r.a.createElement(Y.EuiToolTip,{className:"eui-fullWidth",delay:"regular",content:c,anchorClassName:"eui-fullWidth"},r.a.createElement(fb,{size:u,$_css:m.euiTheme.border.radius.medium},r.a.createElement(Ue.Metric,{id:a,data:[[g]]}))))}));var fb=Fa()(Ue.Chart).withConfig({displayName:"_StyledChart",componentId:"sc-1apbvvm-0"})([".echMetric{border-radius:",";pointer-events:none;}"],(e=>e.$_css));const bb=({height:e})=>{var t;const a=Object(u.findInventoryModel)("host"),{data:n,isRequestRunning:i}=ob(),{searchCriteria:s}=co(),l=Object(me.useTheme)(),{value:o}=Gc()((()=>a.metrics.getFormulas())),c={id:"hostsViewKPI-hostsCount",color:l.eui.euiColorLightestShade,title:W.i18n.translate("xpack.infra.hostsViewPage.kpi.hostCount.title",{defaultMessage:"Hosts"})};return r.a.createElement(gb,de()({},c,{style:{height:e},value:null!==(t=null==n?void 0:n.count.value)&&void 0!==t?t:0,subtitle:s.limit<(null!==(d=null==n?void 0:n.count.value)&&void 0!==d?d:0)?W.i18n.translate("xpack.infra.hostsViewPage.kpi.subtitle.hostCount.limit",{defaultMessage:"Limited to {limit}",values:{limit:s.limit}}):void 0,toolTip:r.a.createElement(Mu,{formula:null==o?void 0:o.hostCount.value,description:rd.hostCount}),loading:i}));var d},hb=()=>{var e;const t=Object(u.findInventoryModel)("host"),{searchCriteria:a}=co(),{euiTheme:i}=Object(Y.useEuiTheme)(),{dataView:s}=Ml(),{data:l}=ob(),{value:o}=Gc()((()=>t.metrics.getDashboards())),c=a.limit<(null!==(e=null==l?void 0:l.count.value)&&void 0!==e?e:0)?W.i18n.translate("xpack.infra.hostsViewPage.kpi.subtitle.average.limit",{defaultMessage:"Average (of {limit} hosts)",values:{limit:a.limit}}):void 0,d=Object(n.useMemo)((()=>{var e;return null!==(e=null==o?void 0:o.kpi.get({metricsDataView:s,options:{backgroundColor:i.colors.lightestShade,...c?{subtitle:c}:{}}}).charts)&&void 0!==e?e:[]}),[null==o?void 0:o.kpi,s,i.colors.lightestShade,c]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Cu,{type:"metrics"}),r.a.createElement(Y.EuiSpacer,{size:"s"}),r.a.createElement(Y.EuiFlexGroup,{direction:"row",gutterSize:"s","data-test-subj":"hostsViewKPIGrid"},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(bb,{height:150})),d.map(((e,t)=>r.a.createElement(Y.EuiFlexItem,{key:t},r.a.createElement(pb,de()({},e,{height:150})))))))},yb=({dataView:e,...t})=>{const{searchCriteria:a}=co(),{loading:i,searchSessionId:s}=Vf(),{currentPage:l}=Jf(),o=0===l.length,{afterLoadedState:c}=mb(i,{dateRange:a.dateRange,query:o?a.query:void 0,searchSessionId:s}),u=Object(n.useMemo)((()=>o?a.filters:[io({field:"host.name",values:l.map((e=>e.name)),dataView:e})]),[a.filters,l,e,o]);return r.a.createElement(wu,de()({},t,{id:`hostsView-metricChart-${t.id}`,borderRadius:"m",dataView:e,dateRange:c.dateRange,height:300,loading:i,filters:u,query:c.query,searchSessionId:c.searchSessionId}))},Eb=()=>{const e=Object(u.findInventoryModel)("host"),{dataView:t}=Ml(),{value:a}=Gc()((()=>e.metrics.getDashboards())),i=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.hostsView.get({metricsDataView:t}).charts)&&void 0!==e?e:[]}),[t,a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiText,{size:"xs"},W.i18n.translate("xpack.infra.metricsGrid.learnMoreAboutMetricsTextLabel",{defaultMessage:"Learn more about metrics"}))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(of,null,r.a.createElement(Tu,null)))),r.a.createElement(Y.EuiSpacer,{size:"s"}),r.a.createElement(Y.EuiFlexGrid,{columns:2,gutterSize:"s","data-test-subj":"hostsView-metricChart"},i.map(((e,t)=>r.a.createElement(Y.EuiFlexItem,{key:t,grow:!1},r.a.createElement(yb,e))))))};function vb(e){const t=Object(n.useRef)(null),a=Object(n.useRef)(0);return Object(n.useLayoutEffect)((()=>{if(t.current){const e=t.current.clientHeight;a.current<e&&(a.current=e)}})),r.a.createElement("div",de()({},e,{ref:t,style:{minHeight:a.current}}))}const xb=f()((()=>{const{hostNodes:e}=Vf(),{searchCriteria:t}=co(),[a,r]=Object(n.useState)("all"),i=Object(n.useMemo)((()=>e.map((e=>e.name))),[e]),s=Object(n.useCallback)((e=>Yu({dateRange:t.dateRange,hostNodeNames:i,status:e})),[i,t.dateRange]),l=Object(n.useMemo)((()=>s()),[s,a]),o=Object(n.useMemo)((()=>s(a)),[s,a]);return{alertStatus:a,setAlertStatus:r,alertsEsQuery:l,alertsEsQueryByStatus:o}})),[wb,kb]=xb,Ob=[{id:Fu.status,label:Fu.label,value:Fu.query,"data-test-subj":"hostsView-alert-status-filter-show-all-button"},{id:Lu.status,label:Lu.label,value:Lu.query,"data-test-subj":"hostsView-alert-status-filter-active-button"},{id:Pu.status,label:Pu.label,value:Pu.query,"data-test-subj":"hostsView-alert-status-filter-recovered-button"},{id:Du.status,label:Du.label,value:Du.query,"data-test-subj":"hostsView-alert-status-filter-untracked-button"}];var Mb=function({status:e,onChange:t}){return r.a.createElement(Y.EuiButtonGroup,{legend:W.i18n.translate("xpack.infra.hostsViewPage.tabs.alerts.alertStatusFilter.legend",{defaultMessage:"Filter by"}),color:"primary",options:Ob,idSelected:e,onChange:e=>t(e)})};const jb=()=>{const{services:e}=Object(ge.b)(),{alertStatus:t,setAlertStatus:a,alertsEsQueryByStatus:n}=kb(),{onSubmit:i,searchCriteria:s}=co(),{triggersActionsUi:l}=e,{alertsTableConfigurationRegistry:o,getAlertsStateTable:c}=l;return r.a.createElement(vb,null,r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"m","data-test-subj":"hostsView-alerts"},r.a.createElement(Y.EuiFlexGroup,{justifyContent:"flexStart",alignItems:"center"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Mb,{onChange:a,status:t}))),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(Sb,{alertsQuery:n,dateRange:s.dateRange,onRangeSelection:i})),n&&r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(c,{alertsTableConfigurationRegistry:o,configurationId:Iu.ob.OBSERVABILITY,featureIds:ed,id:"xpack.infra.hosts.alerts.table",pageSize:10,query:n,showAlertStatusWithFlapping:!0}))))},Sb=r.a.memo((({alertsQuery:e,dateRange:t,onRangeSelection:a})=>{const{services:n}=Object(ge.b)(),i=Object(cn.useSummaryTimeRange)(t),{charts:s,triggersActionsUi:l}=n,{getAlertSummaryWidget:o}=l,c={theme:s.theme.useChartsTheme(),baseTheme:s.theme.useChartsBaseTheme(),onBrushEnd:e=>{const{x:t}=e;if(t){const[e,n]=t,r=new Date(e).toISOString(),i=new Date(n).toISOString();a({dateRange:{from:r,to:i}})}}};return r.a.createElement(o,{chartProps:c,featureIds:ed,filter:e,fullSize:!0,timeRange:i})}));var Cb=a(222);const Tb="kibana.alert.status";const Ib=e=>{var t,a;const n=null===(t=e.aggregations)||void 0===t?void 0:t.count;return(null!==(a=null==n?void 0:n.buckets)&&void 0!==a?a:[]).reduce(((e,t)=>(t.key===Iu.W?e.activeAlertCount=t.doc_count:t.key===Iu.X&&(e.recoveredAlertCount=t.doc_count),e)),{activeAlertCount:0,recoveredAlertCount:0})},Fb=()=>{const{alertsEsQuery:e}=kb(),{alertsCount:t,loading:a,error:i}=function({featureIds:e,query:t}){const{http:a}=Object(Q.useKibana)().services,r=Object(n.useRef)(new AbortController),[i,s]=_f()((()=>(r.current.abort(),r.current=new AbortController,async function({featureIds:e,http:t,query:a,signal:n}){return t.post(`${Cb.a}/find`,{signal:n,body:JSON.stringify({aggs:{count:{terms:{field:Tb}}},feature_ids:e,query:a,size:0})}).then(Ib)}({featureIds:e,query:t,http:a,signal:r.current.signal}))),[e,t,a],{loading:!0});Object(n.useEffect)((()=>{s()}),[s]);const{value:l,error:o,loading:c}=i;return{alertsCount:l,error:o,loading:c,refetch:s}}({featureIds:ed,query:e});return a?r.a.createElement(Y.EuiLoadingSpinner,null):i?r.a.createElement(Y.EuiToolTip,{content:W.i18n.translate("xpack.infra.hostsViewPage.tabs.alerts.countError",{defaultMessage:"The active alert count was not retrieved correctly, try reloading the page."})},r.a.createElement(Y.EuiIcon,{color:"warning",type:"warning"})):"number"==typeof(null==t?void 0:t.activeAlertCount)&&t.activeAlertCount>0?r.a.createElement(Y.EuiNotificationBadge,{className:"eui-alignCenter",size:"m","data-test-subj":"hostsView-tabs-alerts-count"},null==t?void 0:t.activeAlertCount):null},Lb=v.union([v.literal("alerts"),v.literal("logs"),v.literal("metrics")]);let Pb;!function(e){e.ALERTS="alerts",e.LOGS="logs",e.METRICS="metrics"}(Pb||(Pb={}));const Db=Lb.encode,_b=e=>t=>Object(x.pipe)(Lb.decode(t),Object(w.fold)(Object(k.constant)(e),k.identity)),Rb={language:"kuery",query:""},Ab=v.type({language:v.string,query:v.any}),Bb=Ab.encode,Vb=()=>{return Object(O.a)({defaultState:Rb,decodeUrlState:(e=Rb,t=>Object(x.pipe)(Ab.decode(t),Object(w.fold)(Object(k.constant)(e),k.identity))),encodeUrlState:Bb,urlStateKey:"logsQuery"});var e},Nb=({startTime:e,endTime:t,query:a,logView:n})=>{var i;const{services:s}=Object(ge.b)(),{locators:l}=s;return r.a.createElement(zc.a,{coreStart:s},r.a.createElement(Y.EuiButtonEmpty,{href:null===(i=l.logsLocator)||void 0===i?void 0:i.getRedirectUrl({time:t,timeRange:{startTime:e,endTime:t},filter:a,logView:n}),"data-test-subj":"hostsView-logs-link-to-stream-button",iconType:"popout",flush:"both"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.tabs.logs.openInLogsUiLinkText",defaultMessage:"Open in Logs"})))},zb=()=>{const[e,t]=Vb(),[a,i]=Object(n.useState)(e.query),s=Object(n.useCallback)((e=>{i(e.target.value)}),[]);return Nc()((()=>t({...e,query:a})),1e3,[a]),r.a.createElement(Y.EuiFieldSearch,{"data-test-subj":"hostsView-logs-text-field-search",fullWidth:!0,isClearable:!0,placeholder:W.i18n.translate("xpack.infra.hostsViewPage.tabs.logs.textFieldPlaceholder",{defaultMessage:"Search for log entries..."}),onChange:s,value:a})},$b=()=>{const[e]=Vb(),{getDateRangeAsTimestamp:t}=co(),{from:a,to:i}=Object(n.useMemo)((()=>t()),[t]),{hostNodes:s,loading:l}=Vf(),o=Object(n.useMemo)((()=>io({field:"host.name",values:s.map((e=>e.name))})),[s]),{logViewReference:c,loading:u}=Hc({id:"hosts-logs-view",extraFields:["host.name"]}),d=Object(n.useMemo)((()=>{const t=qb(s.map((e=>e.name)));return e.query&&t?`${e.query} and ${t}`:e.query||t}),[e.query,s]);return l||u||!c?r.a.createElement(Y.EuiFlexGroup,{style:{height:300},direction:"column",alignItems:"stretch"},r.a.createElement(Y.EuiFlexItem,{grow:!0},r.a.createElement(loading_InfraLoadingPanel,{width:"100%",height:"100%",text:r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.tabs.logs.loadingEntriesLabel",defaultMessage:"Loading entries"})}))):r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"m","data-test-subj":"hostsView-logs"},r.a.createElement(Y.EuiFlexGroup,{gutterSize:"m",alignItems:"center",responsive:!1},r.a.createElement(Y.EuiFlexItem,null,r.a.createElement(zb,null)),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Nb,{startTime:a,endTime:i,query:d,logView:c}))),r.a.createElement(Y.EuiFlexItem,null,r.a.createElement($c.LogStream,{height:500,logView:c,startTimestamp:a,endTimestamp:i,filters:[o],query:e,showFlyoutAction:!0})))},qb=e=>e.length?`host.name:(${e.join(" or ")})`:"",Ub=[{id:Pb.METRICS,name:W.i18n.translate("xpack.infra.hostsViewPage.tabs.metricsCharts.title",{defaultMessage:"Metrics"}),"data-test-subj":"hostsView-tabs-metrics"},{id:Pb.LOGS,name:W.i18n.translate("xpack.infra.hostsViewPage.tabs.logs.title",{defaultMessage:"Logs"}),"data-test-subj":"hostsView-tabs-logs"},{id:Pb.ALERTS,name:W.i18n.translate("xpack.infra.hostsViewPage.tabs.alerts.title",{defaultMessage:"Alerts"}),append:r.a.createElement(Fb,null),"data-test-subj":"hostsView-tabs-alerts"}],Gb=()=>{const[e,t]=((e=Pb.METRICS)=>Object(O.a)({defaultState:e,decodeUrlState:_b(e),encodeUrlState:Db,urlStateKey:"tabId"}))(Ub[0].id),a=Hr((()=>new Set([e]))),n=Ub.map(((n,i)=>r.a.createElement(Y.EuiTab,de()({},n,{key:i,onClick:()=>{a.current.add(n.id),t(n.id)},isSelected:n.id===e,append:n.append}),n.name)));return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.EuiTabs,null,n),r.a.createElement(Y.EuiSpacer,null),a.current.has(Pb.METRICS)&&r.a.createElement("div",{hidden:e!==Pb.METRICS},r.a.createElement(Eb,null)),a.current.has(Pb.LOGS)&&r.a.createElement("div",{hidden:e!==Pb.LOGS},r.a.createElement($b,null)),a.current.has(Pb.ALERTS)&&r.a.createElement("div",{hidden:e!==Pb.ALERTS},r.a.createElement(jb,null)))},Hb=({error:e,titleOverride:t,messageOverride:a,hasDetailsModal:n=!1,hasTryAgainButton:i=!1,onTryAgainClick:s})=>{const{services:{notifications:l}}=Object(ge.b)(),o=Wb(e),c=t||o.title;return r.a.createElement(Y.EuiEmptyPrompt,{iconType:"error",color:"danger",title:r.a.createElement("h2",null,c),"data-test-subj":"hostsViewErrorCallout",body:r.a.createElement(r.a.Fragment,null,a?r.a.createElement("p",null,a):o.body,r.a.createElement(Y.EuiFlexGroup,{justifyContent:"center"},n&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,{"data-test-subj":"hostsViewErrorDetailsButton",onClick:()=>{l.showErrorDialog({title:c,error:e})},color:"danger"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.error.detailsButton",defaultMessage:"Error details"}))),i&&r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(Y.EuiButton,{"data-test-subj":"hostsViewTryAgainButton",onClick:s,iconType:"refresh",color:"danger"},r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.error.tryAgainButton",defaultMessage:"Try again"})))))})},Wb=e=>e instanceof ca.KQLSyntaxError?{title:W.i18n.translate("xpack.infra.hostsViewPage.error.kqlErrorTitle",{defaultMessage:"Invalid KQL expression"}),body:r.a.createElement(r.a.Fragment,null,r.a.createElement(X.FormattedMessage,{id:"xpack.infra.hostsViewPage.error.kqlErrorMessage",defaultMessage:"We can't show any results because we couldn't apply your filter."}),r.a.createElement(Y.EuiSpacer,{size:"s"}),r.a.createElement(Y.EuiCodeBlock,{transparentBackground:!0,paddingSize:"s"},e.message))}:{title:W.i18n.translate("xpack.infra.hostsViewPage.error.unknownErrorTitle",{defaultMessage:"An error occurred"}),body:r.a.createElement(r.a.Fragment,null,e.message)},Qb=()=>{const{error:e}=co();return r.a.createElement(r.a.Fragment,null,e?r.a.createElement(Hb,{error:e,hasDetailsModal:!0}):r.a.createElement(Bf,null,r.a.createElement(Qf,null,r.a.createElement(Y.EuiFlexGroup,{direction:"column",gutterSize:"m"},r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(lb,null,r.a.createElement(hb,null))),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(eb,null)),r.a.createElement(Y.EuiFlexItem,{grow:!1},r.a.createElement(wb,null,r.a.createElement(Gb,null)))))))},Jb=()=>{const{dataView:e,loading:t,error:a,metricAlias:n,loadDataView:i}=Ml();return!t&&e||a?a?r.a.createElement(Hb,{error:a,titleOverride:W.i18n.translate("xpack.infra.hostsViewPage.errorOnCreateOrLoadDataviewTitle",{defaultMessage:"Error creating Data View"}),messageOverride:W.i18n.translate("xpack.infra.hostsViewPage.errorOnCreateOrLoadDataview",{defaultMessage:"There was an error trying to create a Data View: {metricAlias}. Try reloading the page.",values:{metricAlias:n}}),onTryAgainClick:i,hasTryAgainButton:!0}):r.a.createElement(oo,null,r.a.createElement(yf,null),r.a.createElement(Y.EuiSpacer,{size:"m"}),r.a.createElement(Qb,null)):r.a.createElement(loading_InfraLoadingPanel,{height:"100%",width:"auto",text:W.i18n.translate("xpack.infra.waffle.loadingDataText",{defaultMessage:"Loading data"})})},Kb=()=>{var e;const{isLoading:t,loadSourceFailureMessage:a,loadSource:n,source:i}=Object(re.b)();Object(me.useTrackPageview)({app:"infra_metrics",path:"hosts"}),Object(me.useTrackPageview)({app:"infra_metrics",path:"hosts",delay:15e3}),Be([{text:Ae.c}]);const{metricIndicesExist:s,remoteClustersExist:l}=null!==(e=null==i?void 0:i.status)&&void 0!==e?e:{};return t&&!i?r.a.createElement(Me.a,null):l?s?a?r.a.createElement(wa,{errorMessage:a||"",retry:n}):r.a.createElement(Y.EuiErrorBoundary,null,r.a.createElement("div",{className:Ht.APP_WRAPPER_CLASS},r.a.createElement(Pt.a,{hasData:s,pageHeader:{alignItems:"center",pageTitle:r.a.createElement(Yb,null,r.a.createElement("h1",null,Ae.c),r.a.createElement(Vm,{tooltipContent:W.i18n.translate("xpack.infra.hostsViewPage.betaBadgeDescription",{defaultMessage:'This feature is currently in beta. If you encounter any bugs or have feedback, we’d love to hear from you. Please open a support issue and/or share your feedback via the "Tell us what you think!" feedback button.'})})),rightSideItems:[r.a.createElement(Oe,{"data-test-subj":"infraHostsPageTellUsWhatYouThinkButton",formUrl:"https://docs.google.com/forms/d/e/1FAIpQLScRHG8TIVb1Oq8ZhD4aks3P1TmgiM58TY123QpDCcBz83YC6w/viewform"})]},pageSectionProps:{contentProps:{css:vp.a}}},i&&r.a.createElement(Ol,{metricAlias:i.configuration.metricAlias},r.a.createElement(Jb,null))))):r.a.createElement(Pt.a,{hasData:s,"data-test-subj":"noMetricsIndicesPrompt"}):r.a.createElement(Ve.b,null)};var Yb=Fa()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-1fsrort-0"})(["display:flex;align-items:center;gap:0.75rem;"]);const Xb=W.i18n.translate("xpack.infra.metricsHeaderAddDataButtonLabel",{defaultMessage:"Add data"}),Zb=()=>{var e,t,a,i;const{observabilityAIAssistant:{ObservabilityAIAssistantActionMenuItem:s}}=Object(ge.b)().services,o=_c(),c=null===(e=Object(Q.useKibana)().services.application)||void 0===e?void 0:e.capabilities,{setHeaderActionMenu:u,theme$:d}=Object(n.useContext)(qg.a),m=Object(Q.useUiSetting)(pe.enableInfrastructureHostsView),p=W.i18n.translate("xpack.infra.metrics.settingsTabTitle",{defaultMessage:"Settings"}),g=Object(Q.useKibana)(),{source:f,createDerivedIndexPattern:b}=Object(re.b)();Object(be.a)(!(null!=c&&null!==(t=c.infrastructure)&&void 0!==t&&t.save));const h=Object(me.useLinkProps)({app:"metrics",pathname:"settings"});return r.a.createElement(Y.EuiErrorBoundary,null,r.a.createElement(Je.a,null,r.a.createElement(en.c,null,r.a.createElement(ra,null,r.a.createElement(ba,null,r.a.createElement(Jg,null,r.a.createElement(Li,null,r.a.createElement(fe.a,{feedbackLink:"https://discuss.elastic.co/c/metrics",appName:W.i18n.translate("xpack.infra.header.infrastructureHelpAppName",{defaultMessage:"Metrics"})}),u&&d&&r.a.createElement(me.HeaderMenuPortal,{setHeaderActionMenu:u,theme$:d},r.a.createElement(Y.EuiHeaderLinks,{gutterSize:"xs"},r.a.createElement(Y.EuiHeaderLink,de()({color:"text"},h),p),r.a.createElement(l.a,{path:"/inventory",component:$g}),o.featureFlags.alertsAndRulesDropdownEnabled&&r.a.createElement(Rg,null),r.a.createElement(Y.EuiHeaderLink,{href:null===(a=g.services)||void 0===a||null===(i=a.application)||void 0===i?void 0:i.getUrlForApp("/integrations/browse"),color:"primary",iconType:"indexOpen"},Xb),s?r.a.createElement(s,null):null)),r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/inventory",component:Op}),o.featureFlags.metricsExplorerEnabled&&r.a.createElement(l.a,{path:"/explorer"},r.a.createElement(he.b,null,r.a.createElement(xe,null),null!=f&&f.configuration?r.a.createElement(eh,{configuration:f.configuration,createDerivedIndexPattern:b}):r.a.createElement(Me.a,null))),r.a.createElement(l.a,{path:"/detail/:type/:node",component:yg}),m&&r.a.createElement(l.a,{path:"/hosts",component:Kb}),r.a.createElement(l.a,{path:"/settings",component:Dg}),r.a.createElement(l.a,{render:()=>r.a.createElement(Ug.a,{title:"Infrastructure"})})))))))))},eh=e=>{const{createDerivedIndexPattern:t,configuration:a}=e;return r.a.createElement(Gt,{derivedIndexPattern:t(),source:a})};var th=a(236),ah=a(60),nh=a(284);const rh="infraMetricsPage",ih=(e,t,a,n,{element:i,history:l,setHeaderActionMenu:c,theme$:u})=>{const d=new o.Storage(window.localStorage);return Object(nh.a)(i,rh),s.a.render(r.a.createElement(sh,{core:e,history:l,plugins:t,pluginStart:a,pluginConfig:n,setHeaderActionMenu:c,storage:d,theme$:u}),i),()=>{t.data.search.session.clear(),e.chrome.docTitle.reset(),s.a.unmountComponentAtNode(i)}},sh=({core:e,history:t,pluginStart:a,pluginConfig:n,plugins:i,setHeaderActionMenu:s,storage:o,theme$:c})=>{var u,d,m,p;const g=e.application.capabilities;return r.a.createElement(ah.b,{core:e,pluginStart:a,plugins:i,theme$:c},r.a.createElement(ah.a,{appName:"Metrics UI",setHeaderActionMenu:s,storage:o,theme$:c,triggersActionsUI:i.triggersActionsUi,observabilityAIAssistant:i.observabilityAIAssistant},r.a.createElement(re.a,{sourceId:"default"},r.a.createElement(Rc,{value:n},r.a.createElement(l.b,{history:t},r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/link-to",component:ce}),(null==g||null===(u=g.infrastructure)||void 0===u?void 0:u.show)&&r.a.createElement(th.a,{from:"/",exact:!0,to:"/inventory"}),(null==g||null===(d=g.infrastructure)||void 0===d?void 0:d.show)&&r.a.createElement(th.a,{from:"/snapshot",exact:!0,to:"/inventory"}),(null==g||null===(m=g.infrastructure)||void 0===m?void 0:m.show)&&r.a.createElement(th.a,{from:"/metrics-explorer",exact:!0,to:"/explorer"}),(null==g||null===(p=g.infrastructure)||void 0===p?void 0:p.show)&&r.a.createElement(l.a,{path:"/",component:Zb})))))))}}}]);