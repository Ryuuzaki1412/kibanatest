/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[12],{112:function(e,t,a){"use strict";a.d(t,"k",(function(){return r.b})),a.d(t,"m",(function(){return s})),a.d(t,"l",(function(){return c})),a.d(t,"a",(function(){return y.a})),a.d(t,"r",(function(){return y.u})),a.d(t,"p",(function(){return y.s})),a.d(t,"q",(function(){return y.t})),a.d(t,"e",(function(){return y.f})),a.d(t,"w",(function(){return y.B})),a.d(t,"x",(function(){return y.C})),a.d(t,"f",(function(){return y.g})),a.d(t,"y",(function(){return y.D})),a.d(t,"z",(function(){return y.E})),a.d(t,"b",(function(){return y.c})),a.d(t,"n",(function(){return y.q})),a.d(t,"o",(function(){return y.r})),a.d(t,"g",(function(){return y.h})),a.d(t,"A",(function(){return y.F})),a.d(t,"B",(function(){return y.G})),a.d(t,"h",(function(){return y.i})),a.d(t,"C",(function(){return y.H})),a.d(t,"D",(function(){return y.I})),a.d(t,"d",(function(){return y.e})),a.d(t,"v",(function(){return y.A})),a.d(t,"u",(function(){return y.z})),a.d(t,"c",(function(){return y.d})),a.d(t,"s",(function(){return y.x})),a.d(t,"t",(function(){return y.y})),a.d(t,"i",(function(){return y.j})),a.d(t,"E",(function(){return y.M})),a.d(t,"F",(function(){return y.N})),a.d(t,"j",(function(){return y.k})),a.d(t,"H",(function(){return y.P})),a.d(t,"G",(function(){return y.O})),a.d(t,"I",(function(){return y.Q})),a(116);var r=a(28),n=a(44),i=(a(33),a(0));const l=i.type({value:i.number}),o=(i.type({hostTerm:i.record(i.string,i.string),indexPattern:i.string,to:i.number,sortBy:i.type({name:i.string,isAscending:i.boolean}),searchFilter:i.array(i.record(i.string,i.record(i.string,i.unknown)))}),i.type({summaryEvent:i.type({summary:i.type({hits:i.type({hits:i.array(i.type({_source:i.type({system:i.type({process:i.type({summary:i.record(i.string,i.number)})})})}))})})}),processes:i.type({filteredProcs:i.type({buckets:i.array(i.type({key:i.string,cpu:l,memory:l,startTime:i.type({value_as_string:i.string}),meta:i.type({hits:i.type({hits:i.array(i.type({_source:i.type({process:i.type({pid:i.number}),system:i.type({process:i.type({state:i.string})}),user:i.type({name:i.string})})}))})})}))})})}),i.union([i.number,i.string])),s=i.type({processList:i.array(i.type({cpu:i.union([i.null,i.number]),memory:i.union([i.null,i.number]),startTime:i.number,pid:i.number,state:i.string,user:i.string,command:i.string})),summary:i.exact(i.partial({total:o,running:o,sleeping:o,dead:o,stopped:o,idle:o,zombie:o,unknown:o}))}),c=(i.type({hostTerm:i.record(i.string,i.string),indexPattern:i.string,to:i.number,command:i.string}),i.type({process:i.type({filteredProc:i.type({buckets:i.array(i.type({timeseries:i.type({buckets:i.array(i.type({key:i.number,memory:l,cpu:l}))})}))})})}),i.type({cpu:n.a,memory:n.a}));var u=a(13);const d=i.keyof({cpu:null,normalizedLoad1m:null,diskSpaceUsage:null,memory:null,memoryFree:null,rx:null,tx:null}),m=i.type({from:u.c,to:u.c}),g=i.keyof({"cloud.provider":null,"host.ip":null,"host.os.name":null}),p=i.type({name:d,value:i.union([i.number,i.null])}),f=i.type({name:g,value:i.union([i.string,i.null])}),b=(i.intersection([i.partial({query:i.UnknownRecord}),i.type({type:i.literal("host"),limit:i.union([Object(u.d)(1,500),Object(u.b)(20)]),metrics:i.array(i.type({type:d})),sourceId:i.string,range:m})]),i.type({name:i.string,metrics:i.array(p),metadata:i.array(f)}));i.type({type:i.literal("host"),nodes:i.array(b)});var y=a(7);a(49),a(52),a(48),a(51),a(50)},116:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var r=a(0),n=a(20);r.type({nodeId:r.string,nodeType:n.ItemTypeRT,sourceId:r.string,timeRange:r.type({from:r.number,to:r.number})});const i=r.type({name:r.string,source:r.string}),l=r.partial({codename:r.string,family:r.string,kernel:r.string,name:r.string,platform:r.string,version:r.string,build:r.string}),o=r.partial({name:r.string,hostname:r.string,id:r.string,ip:r.union([r.array(r.string),r.string]),mac:r.union([r.array(r.string),r.string]),os:l,architecture:r.string,containerized:r.boolean}),s=r.partial({id:r.string,name:r.string}),c=r.partial({id:r.string,name:r.string}),u=r.partial({id:r.string}),d=r.partial({interface:r.string,type:r.string}),m=r.partial({instance:s,provider:r.string,account:c,availability_zone:r.string,project:u,machine:d,region:r.string}),g=r.partial({id:r.string,version:r.string,policy:r.string}),p=(r.partial({cloud:m,host:o,agent:g,"@timestamp":r.string}),r.partial({cloud:m,host:o,agent:g,timestamp:r.string})),f=r.type({id:r.string,name:r.string,features:r.array(i)}),b=r.partial({info:p}),y=r.intersection([f,b])},118:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var r=a(40),n=a(22);function i(){var e,t,a;const{euiTheme:i}=Object(r.useEuiTheme)(),{services:{charts:l}}=Object(n.b)(),o=l.theme.useChartsBaseTheme(),s=l.theme.useChartsTheme();return{baseTheme:o,theme:{...s,background:{...s.background,color:"transparent"},crosshair:{band:{...null===(e=s.crosshair)||void 0===e?void 0:e.band,fill:i.colors.lightShade}},axes:{gridLine:{horizontal:{visible:!1},vertical:{...null===(t=s.axes)||void 0===t||null===(a=t.gridLine)||void 0===a?void 0:a.vertical,dash:void 0}}}}}}},131:function(e,t,a){"use strict";a.d(t,"h",(function(){return g})),a.d(t,"d",(function(){return p})),a.d(t,"f",(function(){return f})),a.d(t,"i",(function(){return b})),a.d(t,"j",(function(){return y})),a.d(t,"g",(function(){return E})),a.d(t,"a",(function(){return x})),a.d(t,"e",(function(){return v})),a.d(t,"c",(function(){return T})),a.d(t,"b",(function(){return O}));var r=a(2),n=a.n(r),i=a(79),l=a(32),o=a.n(l),s=a(1),c=a(40),u=a(76),d=a(8),m=a(23);const g={headerFormatter:({value:e})=>o()(e).format("Y-MM-DD HH:mm:ss")},p=20,f={s:s.i18n.translate("xpack.infra.alerts.timeLabels.seconds",{defaultMessage:"seconds"}),m:s.i18n.translate("xpack.infra.alerts.timeLabels.minutes",{defaultMessage:"minutes"}),h:s.i18n.translate("xpack.infra.alerts.timeLabels.hours",{defaultMessage:"hours"}),d:s.i18n.translate("xpack.infra.alerts.timeLabels.days",{defaultMessage:"days"})},b=(e,t)=>Object(r.useMemo)((()=>"number"==typeof e&&"number"==typeof t?Object(i.niceTimeFormatter)([e,t]):e=>`${e}`),[e,t]),y=m.a,E=(e,t=!1)=>{let a=null,r=null;const n=e.reduce(((e,t)=>(t.points.forEach((t=>{const a=e[t.timestamp]||[];e[t.timestamp]=[...a,t.value]})),e)),{});Object.values(n).forEach((e=>{const n=t?Object(d.sum)(e):Object(d.max)(e),i=Object(d.min)(e);n&&(!r||n>r)&&(r=n),i&&(!a||i<a)&&(a=i)}));const i=Object.keys(n).map(Number),l=Object(d.min)(i)||0,o=Object(d.max)(i)||0;return{yMin:a||0,yMax:r||0,xMin:l,xMax:o}},h=({children:e})=>n.a.createElement("div",{style:{width:"100%",height:150,display:"flex",justifyContent:"center",alignItems:"center"}},e),x=({children:e})=>n.a.createElement("div",{style:{width:"100%",height:150}},e),v=()=>n.a.createElement(h,null,n.a.createElement(c.EuiText,{color:"subdued","data-test-subj":"noChartData"},n.a.createElement(u.FormattedMessage,{id:"xpack.infra.alerts.charts.noDataMessage",defaultMessage:"No chart data available"}))),T=()=>n.a.createElement(h,null,n.a.createElement(c.EuiText,{color:"subdued","data-test-subj":"loadingData"},n.a.createElement(c.EuiLoadingChart,{size:"m"}))),O=()=>n.a.createElement(h,null,n.a.createElement(c.EuiText,{color:"subdued","data-test-subj":"chartErrorState"},n.a.createElement(u.FormattedMessage,{id:"xpack.infra.alerts.charts.errorMessage",defaultMessage:"Uh oh, something went wrong"})))},156:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"e",(function(){return i})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return s}));var r=a(1);const n=r.i18n.translate("xpack.infra.metrics.alertFlyout.customEquationEditor.equationHelpMessage",{defaultMessage:"Supports basic math expressions"}),i=r.i18n.translate("xpack.infra.metrics.alertFlyout.customEquationEditor.labelLabel",{defaultMessage:"Label (optional)"}),l=r.i18n.translate("xpack.infra.metrics.alertFlyout.customEquationEditor.labelHelpMessage",{defaultMessage:"Custom label will show on the alert chart and in reason/alert title"}),o=r.i18n.translate("xpack.infra.metrics.alertFlyout.customEquation",{defaultMessage:"Custom equation"}),s=r.i18n.translate("xpack.infra.metrics.alertFlyout.customEquationEditor.deleteRowButton",{defaultMessage:"Delete"})},165:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var r=a(85),n=a(24),i=a(28),l=a(139),o=a(19);function s(e,t,a,{fromTimestamp:s,toTimestamp:c,interval:u},d=!0){const{http:m}=Object(n.useKibana)().services,{isLoading:g,data:p,error:f,refetch:b,fetchNextPage:y}=Object(r.useInfiniteQuery)({queryKey:["metricExplorer",e,s,c],queryFn:async({signal:r,pageParam:n={afterKey:null}})=>{if(!s||!c)throw new Error("Unable to parse timerange");if(!m)throw new Error("HTTP service is unavailable");if(!t)throw new Error("Source is unavailable");const{afterKey:d}=n,g=await m.post("/api/infra/metrics_explorer",{method:"POST",body:JSON.stringify({forceInterval:e.forceInterval,dropLastBucket:null==e.dropLastBucket||e.dropLastBucket,metrics:"count"===e.aggregation?[{aggregation:"count"}]:e.metrics,groupBy:e.groupBy,afterKey:d,limit:e.limit,indexPattern:t.metricAlias,filterQuery:e.filterQuery&&Object(l.a)(e.filterQuery,a)||void 0,timerange:{interval:u,from:s,to:c}}),signal:r});return Object(o.b)(i.f)(g)},getNextPageParam:e=>e.pageInfo,enabled:d&&!!s&&!!c&&!!m&&!!t,refetchOnWindowFocus:!1});return{data:p,error:f,fetchNextPage:y,isLoading:g,refetch:b}}},170:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var r=a(79),n=a(8),i=a(2),l=a.n(i),o=a(17),s=a(26);const c=.3,u=({threshold:e,sortedThresholds:t,comparator:a,color:i,id:u,firstTimestamp:d,lastTimestamp:m,domain:g})=>{if(!a||!e)return null;const p=[o.b.GT,o.b.GT_OR_EQ].includes(a),f=[o.b.LT,o.b.LT_OR_EQ].includes(a);return l.a.createElement(l.a.Fragment,null,l.a.createElement(r.LineAnnotation,{id:`${u}-thresholds`,domainType:r.AnnotationDomainType.YDomain,"data-test-subj":"threshold-line",dataValues:t.map((e=>({dataValue:e}))),style:{line:{strokeWidth:2,stroke:Object(s.b)(i),opacity:1}}}),2===t.length&&a===o.b.BETWEEN?l.a.createElement(l.a.Fragment,null,l.a.createElement(r.RectAnnotation,{id:`${u}-lower-threshold`,"data-test-subj":"between-rect",style:{fill:Object(s.b)(i),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:Object(n.first)(e),y1:Object(n.last)(e)}}]})):null,2===t.length&&a===o.b.OUTSIDE_RANGE?l.a.createElement(l.a.Fragment,null,l.a.createElement(r.RectAnnotation,{id:`${u}-lower-threshold`,"data-test-subj":"outside-range-lower-rect",style:{fill:Object(s.b)(i),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:g.min,y1:Object(n.first)(e)}}]}),l.a.createElement(r.RectAnnotation,{id:`${u}-upper-threshold`,"data-test-subj":"outside-range-upper-rect",style:{fill:Object(s.b)(i),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:Object(n.last)(e),y1:g.max}}]})):null,f&&null!=Object(n.first)(e)?l.a.createElement(r.RectAnnotation,{id:`${u}-upper-threshold`,"data-test-subj":"below-rect",style:{fill:Object(s.b)(i),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:g.min,y1:Object(n.first)(e)}}]}):null,p&&null!=Object(n.first)(e)?l.a.createElement(r.RectAnnotation,{id:`${u}-upper-threshold`,"data-test-subj":"above-rect",style:{fill:Object(s.b)(i),opacity:c},dataValues:[{coordinates:{x0:d,x1:m,y0:Object(n.first)(e),y1:g.max}}]}):null)}},220:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a(40),n=a(1),i=a(2),l=a.n(i);const o=({options:e,onChange:t,fields:a,errorOptions:o})=>{const s=Object(i.useCallback)((e=>{const a=e.map((e=>e.label));t(a)}),[t]),c=Array.isArray(e.groupBy)?e.groupBy.map((e=>({label:e,color:null!=o&&o.includes(e)?"danger":void 0}))):e.groupBy?[{label:e.groupBy,color:null!=o&&o.includes(e.groupBy)?"danger":void 0}]:[];return l.a.createElement(r.EuiComboBox,{"data-test-subj":"metricsExplorer-groupBy",placeholder:n.i18n.translate("xpack.infra.metricsExplorer.groupByLabel",{defaultMessage:"Everything"}),"aria-label":n.i18n.translate("xpack.infra.metricsExplorer.groupByAriaLabel",{defaultMessage:"Graph per"}),fullWidth:!0,singleSelection:!1,selectedOptions:c,options:a.filter((e=>e.aggregatable&&"string"===e.type)).map((e=>({label:e.name}))),onChange:s,isClearable:!0})}},228:function(e,t,a){"use strict";a.d(t,"a",(function(){return F}));var r=a(2),n=a.n(r),i=a(79),l=a(40),o=a(76),s=a(94),c=a(8),u=a(1),d=a(118),m=a(26),g=a(147),p=a(115),f=a(146),b=a(145),y=a(18),E=a.n(y),h=a(165);const x={},v=e=>"count"===e.aggType?{name:e.name,aggregation:"count",filter:e.filter}:{name:e.name,aggregation:e.aggType,field:e.field};var T=a(138),O=a(22),j=a(131),k=a(170),C=a(156);const F=({expression:e,derivedIndexPattern:t,annotations:a,chartType:y=p.a.bar,filterQuery:F,groupBy:M,hideTitle:w=!1,source:S,timeRange:A})=>{var R,z;const{charts:L}=Object(O.b)().services,B=Object(d.a)(),{isLoading:I,data:D}=((e,t,a,n,i,l=x)=>{const{timeSize:o,timeUnit:s}=e||{timeSize:1,timeUnit:"m"},c=Object(r.useMemo)((()=>{var t,a;return{limit:1,forceInterval:!0,dropLastBucket:!1,groupBy:i,filterQuery:n,metrics:["custom"===e.aggType?{aggregation:"custom",custom_metrics:null!==(t=null==e||null===(a=e.customMetrics)||void 0===a?void 0:a.map(v))&&void 0!==t?t:[],equation:e.equation}:{field:e.metric,aggregation:e.aggType}],aggregation:e.aggType||"avg"}}),[e.aggType,e.equation,e.metric,e.customMetrics,n,i]),u=Object(r.useMemo)((()=>{var e,t;const a=null!==(e=l.from)&&void 0!==e?e:`now-${20*(o||1)}${s}`,r=null!==(t=l.to)&&void 0!==t?t:"now",n=E.a.parse(a).valueOf(),i=E.a.parse(r,{roundUp:!0}).valueOf();return{interval:`>=${o||1}${s}`,fromTimestamp:n,toTimestamp:i}}),[l,o,s]);return Object(h.a)(c,null==a?void 0:a.configuration,t,u)})(e,t,S,F,M,A),q=Object(r.useRef)(null),P=Object(s.useActiveCursor)(L.activeCursor,q,{isDateHistogram:!0});if(I)return n.a.createElement(j.c,null);if(!D)return n.a.createElement(j.e,null);const N=Object(c.first)(Object(c.first)(D.pages).series);if(!N||!N.rows||0===N.rows.length)return n.a.createElement(j.e,null);const G=Object(c.first)(N.rows).timestamp,U=Object(c.last)(N.rows).timestamp,W={field:e.metric,aggregation:e.aggType,color:m.a.color0};"custom"===W.aggregation&&(W.label=e.label||C.a);const Q=null==G||null==U?e=>`${e}`:Object(i.niceTimeFormatter)([G,U]),$=e.threshold.slice().sort(),_=null!==(R=null===(z=e.warningThreshold)||void 0===z?void 0:z.slice().sort())&&void 0!==R?R:[],V=[...$,..._].sort(),H={...N,rows:N.rows.map((e=>{const t={...e};return V.forEach(((e,a)=>{t[Object(T.a)(W,`threshold_${a}`)]=e})),t}))},K=Object(b.a)(H,[W],!1),Y={max:1.1*Math.max(K.max,Object(c.last)(V)||K.max),min:.9*Math.min(K.min,Object(c.first)(V)||K.min)};Y.min===Object(c.first)(e.threshold)&&(Y.min=.9*Y.min);const{timeSize:X,timeUnit:J}=e,Z=j.f[J];return n.a.createElement(n.a.Fragment,null,n.a.createElement(j.a,null,n.a.createElement(i.Chart,{ref:q},n.a.createElement(g.a,{type:y,metric:W,id:"0",series:H,stack:!1}),n.a.createElement(k.a,{comparator:e.comparator,threshold:e.threshold,sortedThresholds:$,color:m.a.color1,id:"critical",firstTimestamp:G,lastTimestamp:U,domain:Y}),e.warningComparator&&e.warningThreshold&&n.a.createElement(k.a,{comparator:e.warningComparator,threshold:e.warningThreshold,sortedThresholds:_,color:m.a.color5,id:"warning",firstTimestamp:G,lastTimestamp:U,domain:Y}),a,n.a.createElement(i.Axis,{id:"timestamp",position:i.Position.Bottom,showOverlappingTicks:!0,tickFormat:Q}),n.a.createElement(i.Axis,{id:"values",position:i.Position.Left,tickFormat:Object(f.a)(W),domain:Y}),n.a.createElement(i.Tooltip,j.h),n.a.createElement(i.Settings,{onPointerUpdate:P,externalPointerEvents:{tooltip:{visible:!0}},baseTheme:B.baseTheme,locale:u.i18n.getLocale()}))),!w&&n.a.createElement("div",{style:{textAlign:"center"}},"ALL"!==H.id?n.a.createElement(l.EuiText,{size:"xs",color:"subdued"},n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alerts.dataTimeRangeLabelWithGrouping",defaultMessage:"Last {lookback} {timeLabel} of data for {id}",values:{id:H.id,timeLabel:Z,lookback:20*X}})):n.a.createElement(l.EuiText,{size:"xs",color:"subdued"},n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alerts.dataTimeRangeLabel",defaultMessage:"Last {lookback} {timeLabel}",values:{timeLabel:Z,lookback:20*X}}))))}},529:function(e,t,a){"use strict";a.r(t),a.d(t,"defaultExpression",(function(){return D})),a.d(t,"Expressions",(function(){return q}));var r=a(2),n=a.n(r),i=a(40),l=a(1),o=a(76),s=a(8),c=a(90),u=a(110),d=a(17),m=a(22),g=a(220),p=a(164),f=a(139),b=a(228),y=a(31),E=a(153),h=a.n(E);const x=(e,t)=>{const a=t?new RegExp(/0?\./):".",r=String(e).replace(a,"").length;return parseFloat((t?100*e:e/100).toPrecision(r))};let v;!function(e){e.COUNT="count",e.AVERAGE="avg",e.SUM="sum",e.MIN="min",e.MAX="max",e.RATE="rate",e.CARDINALITY="cardinality",e.P95="p95",e.P99="p99",e.CUSTOM="custom"}(v||(v={}));var T=a(112),O=a(156);const j=({onDelete:e,disableDelete:t})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(i.EuiFlexItem,{grow:0},n.a.createElement(i.EuiButtonIcon,{"data-test-subj":"infraMetricRowControlsButton",iconType:"trash",color:"danger",style:{marginBottom:"0.2em"},onClick:e,disabled:t,title:O.b}))),k=({name:e,aggType:t=d.a.AVERAGE,field:a,onDelete:o,disableDelete:c,fields:u,aggregationTypes:m,onChange:g,errors:p})=>{const f=Object(r.useCallback)((()=>{o(e)}),[e,o]),b=Object(r.useMemo)((()=>u.reduce(((e,a)=>(t&&m[t].validNormalizedTypes.includes(a.normalizedType)&&e.push({label:a.name}),e)),[])),[u,m,t]),y=Object(r.useMemo)((()=>Object.values(m).map((e=>({text:e.text,value:e.value})))),[m]),E=Object(r.useCallback)((a=>{g({name:e,field:a.length&&a[0].label||void 0,aggType:t})}),[e,t,g]),h=Object(r.useCallback)((t=>{const r=t.target.value;g({name:e,field:r===d.a.COUNT?void 0:a,aggType:r})}),[e,a,g]),x=null!=Object(s.get)(p,["customMetrics",e,"aggType"]),v=null!=Object(s.get)(p,["customMetrics",e,"field"])||!a;return n.a.createElement(n.a.Fragment,null,n.a.createElement(i.EuiFlexGroup,{gutterSize:"xs",alignItems:"flexEnd"},n.a.createElement(i.EuiFlexItem,{style:{maxWidth:145}},n.a.createElement(i.EuiFormRow,{label:l.i18n.translate("xpack.infra.metrics.alertFlyout.customEquationEditor.aggregationLabel",{defaultMessage:"Aggregation {name}",values:{name:e}}),isInvalid:x},n.a.createElement(i.EuiSelect,{"data-test-subj":"infraMetricRowWithAggSelect",compressed:!0,options:y,value:t,isInvalid:x,onChange:h}))),n.a.createElement(i.EuiFlexItem,null,n.a.createElement(i.EuiFormRow,{label:l.i18n.translate("xpack.infra.metrics.alertFlyout.customEquationEditor.fieldLabel",{defaultMessage:"Field {name}",values:{name:e}}),isInvalid:v},n.a.createElement(i.EuiComboBox,{fullWidth:!0,compressed:!0,isInvalid:v,singleSelection:{asPlainText:!0},options:b,selectedOptions:a?[{label:a}]:[],onChange:E}))),n.a.createElement(j,{onDelete:f,disableDelete:c})),n.a.createElement(i.EuiHorizontalRule,{margin:"xs"}))},C=({name:e,agg:t,filter:a,onDelete:o,disableDelete:s,onChange:c,aggregationTypes:u,dataView:m})=>{const g=Object(r.useMemo)((()=>Object.values(u).filter((e=>e.value!==d.a.CUSTOM)).map((e=>({text:e.text,value:e.value})))),[u]),f=Object(r.useCallback)((()=>{o(e)}),[e,o]),b=Object(r.useCallback)((t=>{c({name:e,filter:a,aggType:t.target.value})}),[e,a,c]),y=Object(r.useCallback)((a=>{c({name:e,filter:a,aggType:t})}),[e,t,c]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(i.EuiFlexGroup,{gutterSize:"xs",alignItems:"flexEnd"},n.a.createElement(i.EuiFlexItem,{style:{maxWidth:145}},n.a.createElement(i.EuiFormRow,{label:l.i18n.translate("xpack.infra.metrics.alertFlyout.customEquationEditor.aggregationLabel",{defaultMessage:"Aggregation {name}",values:{name:e}})},n.a.createElement(i.EuiSelect,{"data-test-subj":"infraMetricRowWithCountSelect",compressed:!0,options:g,value:t,onChange:b}))),n.a.createElement(i.EuiFlexItem,null,n.a.createElement(i.EuiFormRow,{label:l.i18n.translate("xpack.infra.metrics.alertFlyout.customEquationEditor.filterLabel",{defaultMessage:"KQL Filter {name}",values:{name:e}})},n.a.createElement(p.a,{placeholder:" ",compressed:!0,derivedIndexPattern:m,onChange:y,onSubmit:y,value:a}))),n.a.createElement(j,{onDelete:f,disableDelete:s})),n.a.createElement(i.EuiHorizontalRule,{margin:"xs"}))},F={name:"A",aggType:d.a.AVERAGE},M=Object(s.range)(65,91).map((e=>String.fromCharCode(e))),w=({onChange:e,expression:t,fields:a,aggregationTypes:l,errors:c,dataView:u})=>{var m;const[g,p]=Object(r.useState)(null!==(m=null==t?void 0:t.customMetrics)&&void 0!==m?m:[F]),[f,b]=Object(r.useState)((null==t?void 0:t.label)||void 0),[y,E]=Object(r.useState)((null==t?void 0:t.equation)||void 0),h=Object(r.useMemo)((()=>Object(s.debounce)(e,500)),[e]),x=Object(r.useCallback)((()=>{p((e=>{var a;const r=null!==(a=null==e?void 0:e.map((e=>e.name)))&&void 0!==a?a:[],n=Object(s.first)(Object(s.xor)(M,r)),i=[...e||[],{...F,name:n}];return h({...t,customMetrics:i,equation:y,label:f}),i}))}),[h,y,t,f]),v=Object(r.useCallback)((e=>{p((a=>{var r;const n=null!==(r=null==a?void 0:a.filter((t=>t.name!==e)))&&void 0!==r?r:[F],i=n.length&&n||[F];return h({...t,customMetrics:i,equation:y,label:f}),i}))}),[y,t,h,f]),j=Object(r.useCallback)((e=>{p((a=>{const r=null==a?void 0:a.map((t=>t.name===e.name?e:t));return h({...t,customMetrics:r,equation:y,label:f}),r}))}),[y,t,h,f]),w=Object(r.useCallback)((e=>{E(e.target.value),h({...t,customMetrics:g,equation:e.target.value,label:f})}),[h,t,g,f]),S=Object(r.useCallback)((e=>{b(e.target.value),h({...t,customMetrics:g,equation:y,label:e.target.value})}),[h,t,g,y]),A=26===(null==g?void 0:g.length),R=1===(null==g?void 0:g.length),z=Object(s.omit)(l,T.k),L=null==g?void 0:g.map((e=>e.aggType===d.a.COUNT?n.a.createElement(C,{key:e.name,name:e.name,agg:e.aggType,filter:e.filter,onAdd:x,onDelete:v,disableAdd:A,aggregationTypes:z,disableDelete:R,onChange:j,errors:c,dataView:u}):n.a.createElement(k,{key:e.name,name:e.name,aggType:e.aggType,aggregationTypes:z,field:e.field,fields:a,onAdd:x,onDelete:v,disableAdd:A,disableDelete:R,onChange:j,errors:c}))),B=Object(r.useMemo)((()=>null==g?void 0:g.map((e=>e.name)).join(" + ")),[g]);return n.a.createElement("div",{style:{minWidth:"100%"}},n.a.createElement(i.EuiSpacer,{size:"s"}),L,n.a.createElement(i.EuiFlexGroup,null,n.a.createElement(i.EuiButtonEmpty,{"data-test-subj":"infraCustomEquationEditorAddAggregationFieldButton",color:"primary",flush:"left",size:"xs",iconType:"plusInCircleFilled",onClick:x,isDisabled:A},n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.customEquationEditor.addCustomRow",defaultMessage:"Add aggregation/field"}))),n.a.createElement(i.EuiSpacer,{size:"m"}),n.a.createElement(i.EuiFlexGroup,null,n.a.createElement(i.EuiFlexItem,null,n.a.createElement(i.EuiFormRow,{label:"Equation",fullWidth:!0,helpText:O.c,isInvalid:null!=c.equation,error:[c.equation]},n.a.createElement(i.EuiFieldText,{"data-test-subj":"infraCustomEquationEditorFieldText",isInvalid:null!=c.equation,compressed:!0,fullWidth:!0,placeholder:B,onChange:w,value:null!=y?y:""})))),n.a.createElement(i.EuiSpacer,{size:"s"}),n.a.createElement(i.EuiFlexGroup,null,n.a.createElement(i.EuiFlexItem,null,n.a.createElement(i.EuiFormRow,{label:O.e,fullWidth:!0,helpText:O.d},n.a.createElement(i.EuiFieldText,{"data-test-subj":"infraCustomEquationEditorFieldText",compressed:!0,fullWidth:!0,value:f,placeholder:O.a,onChange:S})))))},S={...c.builtInComparators,[d.b.OUTSIDE_RANGE]:{text:l.i18n.translate("xpack.infra.metrics.alertFlyout.outsideRangeLabel",{defaultMessage:"Is not between"}),value:d.b.OUTSIDE_RANGE,requiredValues:2}},A=Object(y.euiStyled)(i.EuiFlexGroup)`
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  margin: 0 -4px;
`,R=y.euiStyled.div`
  padding: 0 4px;
`,z=Object(y.euiStyled)(i.EuiHealth)`
  margin-left: 4px;
`,L=e=>{var t,a;const[u,m]=h()(!0),{dataView:g,children:p,setRuleParams:f,expression:b,errors:y,expressionId:E,remove:T,fields:O,canDelete:j}=e,{aggType:k=v.MAX,metric:C,comparator:F=d.b.GT,threshold:M=[],warningThreshold:S=[],warningComparator:L}=b,[D,q]=Object(r.useState)(Boolean(null==S?void 0:S.length)),P=Object(r.useMemo)((()=>Boolean(C&&C.endsWith(".pct"))),[C]),N=Object(r.useCallback)((e=>{f(E,{...b,aggType:e,metric:["custom","count"].includes(e)?void 0:b.metric,customMetrics:"custom"===e?b.customMetrics:void 0,equation:"custom"===e?b.equation:void 0,label:"custom"===e?b.label:void 0})}),[E,b,f]),G=Object(r.useCallback)((e=>{f(E,{...b,metric:e})}),[E,b,f]),U=Object(r.useCallback)((e=>{f(E,{...b,comparator:e})}),[E,b,f]),W=Object(r.useCallback)((e=>{f(E,{...b,warningComparator:e})}),[E,b,f]),Q=Object(r.useCallback)((e=>P?e.map((e=>(e=>x(e,!1))(e))):e),[P]),$=Object(r.useCallback)((e=>{const t=Q(e);t.join()!==b.threshold.join()&&f(E,{...b,threshold:t})}),[E,b,Q,f]),_=Object(r.useCallback)((e=>{var t;const a=Q(e);a.join()!==(null===(t=b.warningThreshold)||void 0===t?void 0:t.join())&&f(E,{...b,warningThreshold:a})}),[E,b,Q,f]),V=Object(r.useCallback)((()=>{D?(q(!1),f(E,Object(s.omit)(b,"warningComparator","warningThreshold"))):(q(!0),f(E,{...b,warningComparator:F,warningThreshold:[]}))}),[D,q,f,F,b,E]),H=Object(r.useCallback)((e=>{f(E,e)}),[E,f]),K=n.a.createElement(B,{comparator:F,threshold:M,updateComparator:U,updateThreshold:$,errors:null!==(t=y.critical)&&void 0!==t?t:{},isMetricPct:P}),Y=D&&n.a.createElement(B,{comparator:L||F,threshold:S,updateComparator:W,updateThreshold:_,errors:null!==(a=y.warning)&&void 0!==a?a:{},isMetricPct:P}),X=O.map((e=>({normalizedType:e.type,name:e.name})));return n.a.createElement(n.a.Fragment,null,n.a.createElement(i.EuiFlexGroup,{gutterSize:"xs"},n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(i.EuiButtonIcon,{iconType:u?"arrowDown":"arrowRight",onClick:m,"data-test-subj":"expandRow","aria-label":l.i18n.translate("xpack.infra.metrics.alertFlyout.expandRowLabel",{defaultMessage:"Expand row."})})),n.a.createElement(i.EuiFlexItem,{grow:!0},n.a.createElement(A,{style:{gap:"custom"!==k?24:12}},n.a.createElement(R,null,n.a.createElement(c.WhenExpression,{customAggTypesOptions:I,aggType:k,onChangeSelectedAggType:N})),!["count","custom"].includes(k)&&n.a.createElement(R,null,n.a.createElement(c.OfExpression,{customAggTypesOptions:I,aggField:C,fields:X,aggType:k,errors:y,onChangeSelectedAggField:G,helpText:n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.ofExpression.helpTextDetail",defaultMessage:"Can't find a metric? {documentationLink}.",values:{documentationLink:n.a.createElement(i.EuiLink,{"data-test-subj":"infraExpressionRowLearnHowToAddMoreDataLink",href:"https://www.elastic.co/guide/en/observability/current/configure-settings.html",target:"BLANK"},n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.ofExpression.popoverLinkLabel",defaultMessage:"Learn how to add more data"}))}}),"data-test-subj":"ofExpression"})),!D&&K,!D&&n.a.createElement(n.a.Fragment,null,n.a.createElement(i.EuiSpacer,{size:"xs"}),n.a.createElement(A,null,n.a.createElement(i.EuiButtonEmpty,{"data-test-subj":"infraExpressionRowAddWarningThresholdButton",color:"primary",flush:"left",size:"xs",iconType:"plusInCircleFilled",onClick:V},n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.addWarningThreshold",defaultMessage:"Add warning threshold"}))))),D&&n.a.createElement(n.a.Fragment,null,n.a.createElement(A,null,K,n.a.createElement(z,{color:"danger"},n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.criticalThreshold",defaultMessage:"Alert"}))),n.a.createElement(A,null,Y,n.a.createElement(z,{color:"warning"},n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.warningThreshold",defaultMessage:"Warning"})),n.a.createElement(i.EuiButtonIcon,{"data-test-subj":"infraExpressionRowButton","aria-label":l.i18n.translate("xpack.infra.metrics.alertFlyout.removeWarningThreshold",{defaultMessage:"Remove warningThreshold"}),iconSize:"s",color:"text",iconType:"minusInCircleFilled",onClick:V}))),k===d.a.CUSTOM&&n.a.createElement(n.a.Fragment,null,n.a.createElement(i.EuiSpacer,{size:"m"}),n.a.createElement(A,null,n.a.createElement(w,{expression:b,fields:X,aggregationTypes:I,onChange:H,errors:y,dataView:g})),n.a.createElement(i.EuiSpacer,{size:"s"}))),j&&n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(i.EuiButtonIcon,{"data-test-subj":"infraExpressionRowButton","aria-label":l.i18n.translate("xpack.infra.metrics.alertFlyout.removeCondition",{defaultMessage:"Remove condition"}),color:"danger",iconType:"trash",onClick:()=>T(E)}))),u?n.a.createElement("div",{style:{padding:"0 0 0 28px"}},p):null,n.a.createElement(i.EuiSpacer,{size:"s"}))},B=({updateComparator:e,updateThreshold:t,threshold:a,isMetricPct:l,comparator:o,errors:s})=>{const u=Object(r.useMemo)((()=>l?a.map((e=>(e=>x(e,!0))(e))):a),[a,l]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(R,null,n.a.createElement(c.ThresholdExpression,{thresholdComparator:o||d.b.GT,threshold:u,customComparators:S,onChangeSelectedThresholdComparator:e,onChangeSelectedThreshold:t,errors:s})),l&&n.a.createElement("div",{style:{alignSelf:"center"}},n.a.createElement(i.EuiText,{size:"s"},"%")))},I={avg:{text:l.i18n.translate("xpack.infra.metrics.alertFlyout.aggregationText.avg",{defaultMessage:"Average"}),fieldRequired:!0,validNormalizedTypes:["number","histogram"],value:v.AVERAGE},max:{text:l.i18n.translate("xpack.infra.metrics.alertFlyout.aggregationText.max",{defaultMessage:"Max"}),fieldRequired:!0,validNormalizedTypes:["number","date","histogram"],value:v.MAX},min:{text:l.i18n.translate("xpack.infra.metrics.alertFlyout.aggregationText.min",{defaultMessage:"Min"}),fieldRequired:!0,validNormalizedTypes:["number","date","histogram"],value:v.MIN},cardinality:{text:l.i18n.translate("xpack.infra.metrics.alertFlyout.aggregationText.cardinality",{defaultMessage:"Cardinality"}),fieldRequired:!1,value:v.CARDINALITY,validNormalizedTypes:["number","string","ip","date"]},rate:{text:l.i18n.translate("xpack.infra.metrics.alertFlyout.aggregationText.rate",{defaultMessage:"Rate"}),fieldRequired:!1,value:v.RATE,validNormalizedTypes:["number"]},count:{text:l.i18n.translate("xpack.infra.metrics.alertFlyout.aggregationText.count",{defaultMessage:"Document count"}),fieldRequired:!1,value:v.COUNT,validNormalizedTypes:["number"]},sum:{text:l.i18n.translate("xpack.infra.metrics.alertFlyout.aggregationText.sum",{defaultMessage:"Sum"}),fieldRequired:!1,value:v.SUM,validNormalizedTypes:["number","histogram"]},p95:{text:l.i18n.translate("xpack.infra.metrics.alertFlyout.aggregationText.p95",{defaultMessage:"95th Percentile"}),fieldRequired:!1,value:v.P95,validNormalizedTypes:["number","histogram"]},p99:{text:l.i18n.translate("xpack.infra.metrics.alertFlyout.aggregationText.p99",{defaultMessage:"99th Percentile"}),fieldRequired:!1,value:v.P99,validNormalizedTypes:["number","histogram"]},custom:{text:O.a,fieldRequired:!1,value:v.CUSTOM,validNormalizedTypes:["number","histogram"]}},D={aggType:d.a.AVERAGE,comparator:d.b.GT,threshold:[],timeSize:1,timeUnit:"m"},q=e=>{const{setRuleParams:t,ruleParams:a,errors:y,metadata:E}=e,{docLinks:h}=Object(m.b)().services,{source:x,createDerivedIndexPattern:v}=Object(u.b)(),[T,O]=Object(r.useState)(1),[j,k]=Object(r.useState)("m"),C=Object(r.useMemo)((()=>v()),[v]),F=Object(r.useMemo)((()=>{var e;return null!=E&&null!==(e=E.currentOptions)&&void 0!==e&&e.metrics?E.currentOptions:{metrics:[],aggregation:"avg"}}),[E]),M=Object(r.useCallback)(((e,r)=>{const n=a.criteria?a.criteria.slice():[];n[e]=r,t("criteria",n)}),[t,a.criteria]),w=Object(r.useCallback)((()=>{var e;const r=(null===(e=a.criteria)||void 0===e?void 0:e.slice())||[];r.push({...D,timeSize:null!=T?T:D.timeSize,timeUnit:null!=j?j:D.timeUnit}),t("criteria",r)}),[t,a.criteria,T,j]),S=Object(r.useCallback)((e=>{var r;const n=(null===(r=a.criteria)||void 0===r?void 0:r.slice())||[];n.length>1&&(n.splice(e,1),t("criteria",n))}),[t,a.criteria]),A=Object(r.useCallback)((e=>{t("filterQueryText",e);try{t("filterQuery",Object(f.a)(e,C,!1)||"")}catch(e){t("filterQuery",d.f)}}),[t,C]),R=Object(r.useCallback)(Object(s.debounce)(A,500),[A]),z=Object(r.useCallback)((e=>{t("groupBy",e&&e.length?e:"")}),[t]),B=Object(r.useMemo)((()=>({aggField:[],timeSizeUnit:[],timeWindowSize:[]})),[]),I=Object(r.useCallback)((e=>{var r;const n=(null===(r=a.criteria)||void 0===r?void 0:r.map((t=>({...t,timeSize:e}))))||[];O(e||void 0),t("criteria",n)}),[a.criteria,t]),q=Object(r.useCallback)((e=>{var r;const n=(null===(r=a.criteria)||void 0===r?void 0:r.map((t=>({...t,timeUnit:e}))))||[];k(e),t("criteria",n)}),[a.criteria,t]),N=Object(r.useCallback)((()=>{var e,a;const r=E;null!=r&&null!==(e=r.currentOptions)&&void 0!==e&&null!==(a=e.metrics)&&void 0!==a&&a.length?t("criteria",r.currentOptions.metrics.map((e=>({metric:e.field,comparator:d.b.GT,threshold:[],timeSize:T,timeUnit:j,aggType:e.aggregation})))):t("criteria",[D])}),[E,t,T,j]),G=Object(r.useCallback)((()=>{var e,a;const r=E;if(r&&null!==(e=r.currentOptions)&&void 0!==e&&e.filterQuery)t("filterQueryText",r.currentOptions.filterQuery),t("filterQuery",Object(f.a)(r.currentOptions.filterQuery,C)||"");else if(r&&null!==(a=r.currentOptions)&&void 0!==a&&a.groupBy&&r.series){const{groupBy:e}=r.currentOptions,a=Array.isArray(e)?e.map(((e,t)=>{var a,n;return`${e}: "${null===(a=r.series)||void 0===a||null===(n=a.keys)||void 0===n?void 0:n[t]}"`})).join(" and "):`${e}: "${r.series.id}"`;t("filterQueryText",a),t("filterQuery",Object(f.a)(a,C)||"")}}),[E,C,t]),U=Object(r.useCallback)((()=>{var e;const a=E;a&&null!==(e=a.currentOptions)&&void 0!==e&&e.groupBy&&!a.series&&t("groupBy",a.currentOptions.groupBy)}),[E,t]);Object(r.useEffect)((()=>{a.criteria&&a.criteria.length?(O(a.criteria[0].timeSize),k(a.criteria[0].timeUnit)):N(),a.filterQuery||G(),a.groupBy||U(),a.sourceId||t("sourceId",(null==x?void 0:x.id)||"default"),void 0===a.alertOnNoData&&t("alertOnNoData",!0),void 0===a.alertOnGroupDisappear&&t("alertOnGroupDisappear",!0)}),[E,x]);const W=Object(r.useCallback)((e=>A(e.target.value)),[A]),Q=Object(r.useMemo)((()=>a.groupBy&&a.groupBy.length>0),[a.groupBy]),$=Object(r.useMemo)((()=>{var e;return null===(e=a.criteria)||void 0===e?void 0:e.every((e=>e.aggType===d.a.COUNT))}),[a.criteria]),_=Object(r.useMemo)((()=>a.groupBy?(Array.isArray(a.groupBy)?a.groupBy:[a.groupBy]).map((e=>({groupName:e,pattern:new RegExp(`{"match(_phrase)?":{"${e}":"(.*?)"}}`)}))):null),[a.groupBy]),V=Object(r.useMemo)((()=>{const{filterQuery:e}=a;return"string"==typeof e&&_?_.map((({groupName:t,pattern:a})=>{if(a.test(e))return t})).filter((e=>"string"==typeof e)):[]}),[a,_]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(i.EuiSpacer,{size:"m"}),n.a.createElement(i.EuiText,{size:"xs"},n.a.createElement("h4",null,n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.conditions",defaultMessage:"Conditions"}))),n.a.createElement(i.EuiSpacer,{size:"xs"}),a.criteria&&a.criteria.map(((e,t)=>n.a.createElement(L,{canDelete:a.criteria&&a.criteria.length>1||!1,fields:C.fields,remove:S,addExpression:w,key:t,expressionId:t,setRuleParams:M,errors:y[t]||B,expression:e||{},dataView:C},n.a.createElement(b.a,{expression:e,derivedIndexPattern:C,source:x,filterQuery:a.filterQueryText,groupBy:a.groupBy})))),n.a.createElement("div",{style:{marginLeft:28}},n.a.createElement(c.ForLastExpression,{timeWindowSize:T,timeWindowUnit:j,errors:B,onChangeWindowSize:I,onChangeWindowUnit:q})),n.a.createElement(i.EuiSpacer,{size:"m"}),n.a.createElement("div",null,n.a.createElement(i.EuiButtonEmpty,{"data-test-subj":"infraExpressionsAddConditionButton",color:"primary",iconSide:"left",flush:"left",iconType:"plusInCircleFilled",onClick:w},n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.addCondition",defaultMessage:"Add condition"}))),n.a.createElement(i.EuiSpacer,{size:"m"}),n.a.createElement(i.EuiAccordion,{id:"advanced-options-accordion",buttonContent:l.i18n.translate("xpack.infra.metrics.alertFlyout.advancedOptions",{defaultMessage:"Advanced options"})},n.a.createElement(i.EuiPanel,{color:"subdued"},n.a.createElement(i.EuiCheckbox,{disabled:$,id:"metrics-alert-no-data-toggle",label:n.a.createElement(n.a.Fragment,null,l.i18n.translate("xpack.infra.metrics.alertFlyout.alertOnNoData",{defaultMessage:"Alert me if there's no data"})," ",n.a.createElement(i.EuiToolTip,{content:($?`${P} `:"")+l.i18n.translate("xpack.infra.metrics.alertFlyout.noDataHelpText",{defaultMessage:"Enable this to trigger the action if the metric(s) do not report any data over the expected time period, or if the alert fails to query Elasticsearch"})},n.a.createElement(i.EuiIcon,{type:"questionInCircle",color:"subdued"}))),checked:a.alertOnNoData,onChange:e=>t("alertOnNoData",e.target.checked)}))),n.a.createElement(i.EuiSpacer,{size:"m"}),n.a.createElement(i.EuiFormRow,{label:l.i18n.translate("xpack.infra.metrics.alertFlyout.filterLabel",{defaultMessage:"Filter (optional)"}),helpText:l.i18n.translate("xpack.infra.metrics.alertFlyout.filterHelpText",{defaultMessage:"Use a KQL expression to limit the scope of your alert trigger."}),fullWidth:!0,display:"rowCompressed"},E&&n.a.createElement(p.a,{derivedIndexPattern:C,onChange:R,onSubmit:A,value:a.filterQueryText})||n.a.createElement(i.EuiFieldSearch,{"data-test-subj":"infraExpressionsFieldSearch",onChange:W,value:a.filterQueryText,fullWidth:!0})),n.a.createElement(i.EuiSpacer,{size:"m"}),n.a.createElement(i.EuiFormRow,{label:l.i18n.translate("xpack.infra.metrics.alertFlyout.createAlertPerText",{defaultMessage:"Group alerts by (optional)"}),helpText:l.i18n.translate("xpack.infra.metrics.alertFlyout.createAlertPerHelpText",{defaultMessage:'Create an alert for every unique value. For example: "host.id" or "cloud.region".'}),fullWidth:!0,display:"rowCompressed"},n.a.createElement(g.a,{onChange:z,fields:C.fields,options:{...F,groupBy:a.groupBy||void 0},errorOptions:V})),V.length>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement(i.EuiSpacer,{size:"s"}),n.a.createElement(i.EuiText,{size:"xs",color:"danger"},n.a.createElement(o.FormattedMessage,{id:"xpack.infra.metrics.alertFlyout.alertPerRedundantFilterError",defaultMessage:"This rule may alert on {matchedGroups} less than expected, because the filter query contains a match for {groupCount, plural, one {this field} other {these fields}}. For more information, refer to {filteringAndGroupingLink}.",values:{matchedGroups:n.a.createElement("strong",null,V.join(", ")),groupCount:V.length,filteringAndGroupingLink:n.a.createElement(i.EuiLink,{"data-test-subj":"infraExpressionsTheDocsLink",href:`${h.links.observability.metricsThreshold}#filtering-and-grouping`},l.i18n.translate("xpack.infra.metrics.alertFlyout.alertPerRedundantFilterError.docsLink",{defaultMessage:"the docs"}))}}))),n.a.createElement(i.EuiSpacer,{size:"s"}),n.a.createElement(i.EuiCheckbox,{id:"metrics-alert-group-disappear-toggle",label:n.a.createElement(n.a.Fragment,null,l.i18n.translate("xpack.infra.metrics.alertFlyout.alertOnGroupDisappear",{defaultMessage:"Alert me if a group stops reporting data"})," ",n.a.createElement(i.EuiToolTip,{content:($?`${P} `:"")+l.i18n.translate("xpack.infra.metrics.alertFlyout.groupDisappearHelpText",{defaultMessage:"Enable this to trigger the action if a previously detected group begins to report no results. This is not recommended for dynamically scaling infrastructures that may rapidly start and stop nodes automatically."})},n.a.createElement(i.EuiIcon,{type:"questionInCircle",color:"subdued"}))),disabled:!Q,checked:Boolean(Q&&a.alertOnGroupDisappear),onChange:e=>t("alertOnGroupDisappear",e.target.checked)}),n.a.createElement(i.EuiSpacer,{size:"m"}))},P=l.i18n.translate("xpack.infra.metrics.alertFlyout.docCountNoDataDisabledHelpText",{defaultMessage:"[This setting is not applicable to the Document Count aggregator.]"});t.default=Object(u.c)(q)("default")}}]);