/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[5],{127:function(e,t,n){"use strict";n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return s})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return w})),n.d(t,"a",(function(){return S}));var o=n(83),r=n(27),i=n(53),a=n(32),u=n.n(a),c=n(6);const d=e=>Number.isNaN(e)||null==e?e=>e:s(c.defaultPositionStateKey,{position:{time:u()(e).toISOString(),tiebreaker:0}}),l=e=>s("logView",e),s=(e,t)=>n=>{const a=Object(i.parse)(n,{sort:!1}),u=void 0===t?a:{...a,[e]:(c=t,Object(r.encode)(c))};var c;return Object(i.stringify)(o.url.encodeQuery(u),{sort:!1,encode:!1})},f=(e,t,n)=>s(c.defaultFilterStateKey,{query:e,...g(t,n),refreshInterval:c.DEFAULT_REFRESH_INTERVAL}),g=(e,t)=>t?{timeRange:{from:new Date(t.startTime).toISOString(),to:new Date(t.endTime).toISOString()}}:e?{timeRange:{from:w(e),to:S(e)}}:{},m={hours:1},w=e=>u()(e).subtract(m).toISOString(),S=e=>u()(e).add(m).toISOString()},522:function(e,t,n){"use strict";n.r(t),n.d(t,"createNodeLogsQuery",(function(){return c})),n.d(t,"createSearchString",(function(){return d})),n.d(t,"getLocationToDiscover",(function(){return l}));var o=n(6),r=n(8),i=n(20),a=n(37),u=n(127);const c=e=>{const{nodeType:t,nodeId:n,filter:o}=e,r=`${Object(i.findInventoryFields)(t).id}: ${n}`;return o?`(${r}) and (${o})`:r},d=({time:e,timeRange:t,filter:n="",logView:i=o.DEFAULT_LOG_VIEW})=>Object(r.flowRight)(Object(u.c)({language:"kuery",query:n},e,t),Object(u.d)(e),Object(u.e)(i))(""),l=async({core:e,timeRange:t,filter:n,logView:r=o.DEFAULT_LOG_VIEW})=>{const[,i]=await e.getStartServices(),{discover:a,logsShared:u}=i,{logViews:c}=u,d=await c.client.getResolvedLogView(r),l={...t?{from:t.startTime,to:t.endTime}:{},...n?{query:{language:"kuery",query:n}}:{}},f=await s(a,l,d);if(!f)throw new Error("Discover location not found");return f},s=async(e,t,n)=>{var o,r;if(!n)return await(null===(r=e.locator)||void 0===r?void 0:r.getLocation(t));const i=f(n.columns),a=n.dataViewReference.toSpec();return await(null===(o=e.locator)||void 0===o?void 0:o.getLocation({...t,columns:i,dataViewId:a.id,dataViewSpec:a}))},f=e=>e.map(g).filter(Boolean),g=e=>"messageColumn"in e?a.d:"timestampColumn"in e?a.h:"fieldColumn"in e?e.fieldColumn.field:null}}]);