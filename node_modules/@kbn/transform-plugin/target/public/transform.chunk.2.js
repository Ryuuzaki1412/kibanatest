/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.transform_bundle_jsonpfunction=window.transform_bundle_jsonpfunction||[]).push([[2],{114:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(28),r=a(115),n=s.__importDefault(a(117));t.default=function(e,t){n.default(e,t,r.isDeepEqual)}},115:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var s=a(28).__importDefault(a(116));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=s.default},116:function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var s,r,n;if(Array.isArray(t)){if((s=t.length)!=a.length)return!1;for(r=s;0!=r--;)if(!e(t[r],a[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((s=(n=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(r=s;0!=r--;)if(!Object.prototype.hasOwnProperty.call(a,n[r]))return!1;for(r=s;0!=r--;){var o=n[r];if(!("_owner"===o&&t.$$typeof||e(t[o],a[o])))return!1}return!0}return t!=t&&a!=a}},117:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(2);t.default=function(e,t,a){var r=s.useRef(void 0);r.current&&a(t,r.current)||(r.current=t),s.useEffect(e,r.current)}},124:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(2),r=!1,n={};t.default=function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),o=1;o<t;o++)a[o-1]=arguments[o];var i=[],l=[],c=function(e){var t=s.createContext(n);r&&e&&(t.displayName=e),i.push(t),l.push(function(e){return function(){var t=s.useContext(e);if(r&&t===n){var a=e.displayName?"The context consumer of "+e.displayName+" must be wrapped with its corresponding Provider":"Component must be wrapped with Provider.";console.warn(a)}return t}}(t))};a.length?a.forEach((function(e){return c(e.name)})):c(e.name);var d=function(t){for(var r=t.children,n=function(e,t){if(null==e)return{};var a,s,r={},n=Object.keys(e);for(s=0;s<n.length;s++)a=n[s],t.indexOf(a)>=0||(r[a]=e[a]);return r}(t,["children"]),o=e(n),l=r,c=0;c<i.length;c+=1){var d=i[c],u=a[c]||function(e){return e};l=s.createElement(d.Provider,{value:u(o)},l)}return l};return r&&e.name&&(d.displayName="Constate"),[d].concat(l)}},125:function(e,t,a){"use strict";a.r(t),a.d(t,"mountManagementSection",(function(){return Ea}));var s=a(32),r=(a(77),a(33)),n=a(26);const{expandLiteralStrings:o,collapseLiteralStrings:i}=n.XJson;var l=a(4),c=a.n(l),d=a(0);const u=new class text_TextService{constructor(){c()(this,"breadcrumbs",{})}init(){this.breadcrumbs={home:d.i18n.translate("xpack.transform.home.breadcrumbTitle",{defaultMessage:"Transforms"}),cloneTransform:d.i18n.translate("xpack.transform.cloneTransform.breadcrumbTitle",{defaultMessage:"Clone transform"}),createTransform:d.i18n.translate("xpack.transform.createTransform.breadcrumbTitle",{defaultMessage:"Create transform"})}}getSizeNotationHelpText(){return d.i18n.translate("xpack.transform.transformForm.sizeNotationPlaceholder",{defaultMessage:"Examples: {example1}, {example2}, {example3}, {example4}",values:{example1:"1g",example2:"10mb",example3:"5k",example4:"1024B"}})}};let m;!function(e){e.HOME="home",e.CLONE_TRANSFORM="cloneTransform",e.CREATE_TRANSFORM="createTransform"}(m||(m={}));const f=new class breadcrumb_BreadcrumbService{constructor(){c()(this,"breadcrumbs",{home:[],cloneTransform:[],createTransform:[]}),c()(this,"setBreadcrumbsHandler",void 0)}setup(e){this.setBreadcrumbsHandler=e,this.breadcrumbs.home=[{text:u.breadcrumbs.home,href:"/"}],this.breadcrumbs.cloneTransform=[...this.breadcrumbs.home,{text:u.breadcrumbs.cloneTransform}],this.breadcrumbs.createTransform=[...this.breadcrumbs.home,{text:u.breadcrumbs.createTransform}]}setBreadcrumbs(e){if(!this.setBreadcrumbsHandler)throw new Error("BreadcrumbService#setup() must be called first!");const t=this.breadcrumbs[e]?[...this.breadcrumbs[e]]:[...this.breadcrumbs.home],a=t.pop();t.push({...a,href:void 0}),this.setBreadcrumbsHandler(t)}},b=new class doc_title_DocTitleService{constructor(){c()(this,"changeDocTitle",(()=>{}))}init(e){this.changeDocTitle=e}setTitle(e){e&&"home"!==e?u.breadcrumbs[e]&&this.changeDocTitle(`${u.breadcrumbs[e]} - ${u.breadcrumbs.home}`):this.changeDocTitle(`${u.breadcrumbs.home}`)}};var j=a(2),p=a.n(j),g=a(27),x=a(21),O=a(18),h=a(70),T=a.n(h),v=a(23);const M={services:{}},y=Object(j.createContext)(M);var S=a(114),k=a.n(S),E=a(17);const F=({children:e,component:t,render:a,...s})=>{const r=Object(j.useMemo)((()=>{if(t)return e=>Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(w,null),Object(E.jsx)(t,e))}),[t]);if(r)return Object(E.jsx)(v.Route,T()({},s,{component:r}));if(a||"function"==typeof e){const t="function"==typeof e?e:a;return Object(E.jsx)(v.Route,T()({},s,{render:e=>Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(w,null),t(e))}))}return Object(E.jsx)(v.Route,s,Object(E.jsx)(w,null),e)},w=()=>{const{executionContext:e}=Object(j.useContext)(y).services,t=Object(v.useRouteMatch)();return function(e,t){k()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null};var C=a(34);const L=({children:e,...t})=>Object(E.jsx)(v.Router,t,Object(E.jsx)(C.CompatRouter,null,e));var D=a(20);const I=({legacySwitch:e=!0,children:t})=>{const a=Object(v.useRouteMatch)();return e?Object(E.jsx)(v.Switch,null,t):Object(E.jsx)(C.Routes,null,j.Children.map(t,(e=>{if(p.a.isValidElement(e)&&e.type===F){var s;const r=Object(D.replace)(null==e?void 0:e.props.path,a.url+"/",""),n="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(E.jsx)(C.Route,{path:r,element:Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(w,null),(null==e||null===(s=e.props)||void 0===s?void 0:s.component)&&Object(E.jsx)(e.props.component,null)||n&&n()||t)})}return e})))};var A=a(24),P=a(81),N=a(96),_=a(19),B=a(50),z=a(61),R=a(65);const V=({title:e,message:t})=>Object(E.jsx)(O.EuiEmptyPrompt,{iconType:"securityApp",title:Object(E.jsx)("h2",null,e),body:Object(E.jsx)("p",null,t)}),q=()=>Object(E.jsx)(O.EuiFlexGroup,{justifyContent:"spaceAround"},Object(E.jsx)(O.EuiFlexItem,{grow:!1},Object(E.jsx)(O.EuiPageTemplate.EmptyPrompt,{color:"danger"},Object(E.jsx)(V,{title:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.app.missingCapabilitiesTitle",defaultMessage:"Missing permission"}),message:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.app.missingCapabilitiesDescription",defaultMessage:"You're missing permissions to use this section of Transforms."})})))),H=({children:e,requiredCapabilities:t})=>{const a=Object(B.t)();var s;return(s=t,Array.isArray(s)?s:[s]).every((e=>a[e]))?Object(E.jsx)(p.a.Fragment,null,e):Object(E.jsx)(q,null)};var U=a(76),$=a(72);const G=({match:e,location:t})=>{const{dataViewId:a}=Object(N.parse)(t.search,{sort:!1});Object(j.useEffect)((()=>{f.setBreadcrumbs(m.CLONE_TRANSFORM),b.setTitle("createTransform")}),[]);const{esTransform:s}=Object(z.a)(),r=e.params.transformId,[n,o]=Object(j.useState)(),[i,l]=Object(j.useState)(),[c,u]=Object(j.useState)(!1),{error:g,searchItems:x,setSavedObjectId:h}=Object(R.a)(void 0);Object(j.useEffect)((()=>{void 0===a?l(d.i18n.translate("xpack.transform.clone.fetchErrorPromptText",{defaultMessage:"Could not fetch the Kibana data view ID."})):h(a)}),[a,h]),Object(j.useEffect)((()=>{void 0!==g&&(o(void 0),l(g),u(!0))}),[g]);const{data:T,error:v}=Object(B.h)(r,void 0===g);Object(j.useEffect)((()=>{if(null!==v&&v.message!==i)return o(void 0),l(v.message),void u(!0);if(void 0!==T)try{o(Object($.c)(T.transforms[0])),l(void 0),u(!0)}catch(e){o(void 0),void 0!==e.message?l(e.message):l(JSON.stringify(e,null,2)),u(!0)}}),[v,i,T]);const M=Object(E.jsx)(O.EuiButtonEmpty,{href:s,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformsWizard.transformDocsLinkText",defaultMessage:"Transform docs"}));return Object(E.jsx)(H,{requiredCapabilities:["canGetTransform","canPreviewTransform","canCreateTransform","canStartStopTransform"]},Object(E.jsx)(O.EuiPageTemplate.Header,{pageTitle:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformsWizard.cloneTransformTitle",defaultMessage:"Clone transform"}),rightSideItems:[M],bottomBorder:!0,paddingSize:"none"}),Object(E.jsx)(O.EuiSpacer,{size:"l"}),Object(E.jsx)(O.EuiPageTemplate.Section,{"data-test-subj":"transformPageCloneTransform",paddingSize:"none"},void 0!==i?Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiCallOut,{title:d.i18n.translate("xpack.transform.clone.errorPromptTitle",{defaultMessage:"An error occurred getting the transform configuration."}),color:"danger",iconType:"warning"},Object(E.jsx)("pre",null,JSON.stringify(i))),Object(E.jsx)(O.EuiSpacer,{size:"l"})):null,void 0!==x&&!0===c&&void 0!==n&&Object(E.jsx)(U.b,{cloneConfig:n,searchItems:x})))},J=({match:e})=>{Object(j.useEffect)((()=>{f.setBreadcrumbs(m.CREATE_TRANSFORM),b.setTitle("createTransform")}),[]);const{esTransform:t}=Object(z.a)(),{error:a,searchItems:s}=Object(R.a)(e.params.savedObjectId),r=Object(E.jsx)(O.EuiButtonEmpty,{href:t,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformsWizard.transformDocsLinkText",defaultMessage:"Transform docs"}));return Object(E.jsx)(H,{requiredCapabilities:["canGetTransform","canPreviewTransform","canCreateTransform","canStartStopTransform"]},Object(E.jsx)(O.EuiPageTemplate.Header,{pageTitle:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformsWizard.createTransformTitle",defaultMessage:"Create transform"}),rightSideItems:[r],bottomBorder:!0,paddingSize:"none"}),Object(E.jsx)(O.EuiSpacer,{size:"l"}),Object(E.jsx)(O.EuiPageTemplate.Section,{"data-test-subj":"transformPageCreateTransform",paddingSize:"none"},void 0!==a&&Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiCallOut,{title:a,color:"danger",iconType:"warning"}),Object(E.jsx)(O.EuiSpacer,{size:"l"})),void 0!==s&&Object(E.jsx)(U.b,{searchItems:s})))};var Y=a(48),W=a(49),K=a(3);var Q=a(84),Z=a(63);const X=e=>{var t,a;return Object(W.a)(null===(t=e.config)||void 0===t?void 0:t.authorization,["api_key"])&&Object(W.a)(e.stats)&&e.stats.health.status===K.l.red&&void 0!==(null===(a=e.stats.health.issues)||void 0===a?void 0:a.find((e=>"Privileges check failed"===e.issue)))};var ee=a(101),te=a(82),ae=a(47);const se=({onSearchSelected:e,createNewDataView:t,canEditDataView:a})=>{const{contentManagement:s,uiSettings:r}=Object(Y.a)();return Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiModalHeader,null,Object(E.jsx)(O.EuiModalHeaderTitle,null,Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.newTransform.newTransformTitle",defaultMessage:"New transform"})," ","/"," ",Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.newTransform.chooseSourceTitle",defaultMessage:"Choose a source"}))),Object(E.jsx)(O.EuiModalBody,null,Object(E.jsx)(ae.SavedObjectFinder,{key:"searchSavedObjectFinder",onChoose:e,showFilter:!0,noItemsMessage:d.i18n.translate("xpack.transform.newTransform.searchSelection.notFoundLabel",{defaultMessage:"No matching indices or saved searches found."}),savedObjectMetaData:[{type:"search",getIconForSavedObject:()=>"search",name:d.i18n.translate("xpack.transform.newTransform.searchSelection.savedObjectType.search",{defaultMessage:"Saved search"})},{type:"index-pattern",getIconForSavedObject:()=>"indexPatternApp",name:d.i18n.translate("xpack.transform.newTransform.searchSelection.savedObjectType.dataView",{defaultMessage:"Data view"})}],fixedPageSize:8,services:{contentClient:s.client,uiSettings:r}},a?Object(E.jsx)(O.EuiButton,{onClick:t,iconType:"plusInCircle","data-test-subj":"newDataViewButton",disabled:!a},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.newTransform.searchSelection.createADataView",defaultMessage:"Create a data view"})):Object(E.jsx)(j.Fragment,null))))};var re=a(53),ne=a(56),oe=a(54),ie=a(58),le=a(59);function ce(e){let t="";switch(e){case"canCreateTransform":t=d.i18n.translate("xpack.transform.capability.noPermission.createTransformTooltip",{defaultMessage:"You do not have permission to create transforms."});break;case"canCreateTransformAlerts":t=d.i18n.translate("xpack.transform.capability.noPermission.canCreateTransformAlertsTooltip",{defaultMessage:"You do not have permission to create transform alert rules."});break;case"canScheduleNowTransform":t=d.i18n.translate("xpack.transform.capability.noPermission.scheduleNowTransformTooltip",{defaultMessage:"You do not have permission to schedule transforms to process data instantly."});break;case"canStartStopTransform":t=d.i18n.translate("xpack.transform.capability.noPermission.startOrStopTransformTooltip",{defaultMessage:"You do not have permission to start or stop transforms."});break;case"canReauthorizeTransform":t=d.i18n.translate("xpack.transform.capability.noPermission.reauthorizeTransformTooltip",{defaultMessage:"You do not have permission to reauthorize transforms."});break;case"canDeleteTransform":t=d.i18n.translate("xpack.transform.capability.noPermission.deleteTransformTooltip",{defaultMessage:"You do not have permission to delete transforms."});break;case"canResetTransform":t=d.i18n.translate("xpack.transform.capability.noPermission.resetTransformTooltip",{defaultMessage:"You do not have permission to reset transforms."});break;case"noTransformNodes":t=d.i18n.translate("xpack.transform.capability.noPermission.noTransformNodesTooltip",{defaultMessage:"There are no transform nodes available."})}return d.i18n.translate("xpack.transform.capability.pleaseContactAdministratorTooltip",{defaultMessage:"{message} Please contact your administrator.",values:{message:t}})}const de=d.i18n.translate("xpack.transform.transformList.reauthorizeActionNameText",{defaultMessage:"Reauthorize"}),ue=(e,t,a)=>!t||0===e.length||0===a||!e.some(X),me=({items:e,forceDisable:t,transformNodes:a})=>{const{canStartStopTransform:s}=Object(B.t)(),r=e.some(X),n=ue(e,s,a);let o;n&&e.length>0&&(!s&&r&&(o=ce("canReauthorizeTransform")),r||(o=d.i18n.translate("xpack.transform.transformList.reauthorizeBulkActionDisabledToolTipContent",{defaultMessage:"One or more selected transforms must require reauthorization."})));const i=Object(E.jsx)(O.EuiText,{size:"s"},de);return!0!==t&&!n||void 0===o?Object(E.jsx)(p.a.Fragment,null,i):Object(E.jsx)(O.EuiToolTip,{position:"top",content:o},i)},fe=(e,t)=>{const{canStartStopTransform:a}=Object(B.t)(),s=(()=>{const{http:e,i18n:t,theme:a}=Object(Y.a)(),s=Object(le.a)(),r=Object(Y.b)();return Object(x.useMutation)({mutationFn:t=>e.post(Object(K.u)("reauthorize_transforms"),{body:JSON.stringify(t),version:"1"}),onError:e=>r.addDanger({title:d.i18n.translate("xpack.transform.stepCreateForm.reauthorizeTransformResponseSchemaErrorMessage",{defaultMessage:"An error occurred calling the reauthorize transforms request."}),text:Object(ne.a)(Object(E.jsx)(ie.a,{text:Object(oe.a)(e)}),{theme:a,i18n:t})}),onSuccess:e=>{for(const t in e)if(e.hasOwnProperty(t)){const a=e[t];a.success||r.addError(new Error(JSON.stringify(a.error.caused_by,null,2)),{title:d.i18n.translate("xpack.transform.transformList.reauthorizeTransformErrorMessage",{defaultMessage:"An error occurred reauthorizing the transform {transformId}",values:{transformId:t}}),toastMessage:a.error.reason})}s()}}).mutate})(),[r,n]=Object(j.useState)(!1),[o,i]=Object(j.useState)([]),l=e=>{Array.isArray(e)&&(i(e),n(!0))};return{action:Object(j.useMemo)((()=>({name:a=>Object(E.jsx)(me,{items:[a],forceDisable:e,transformNodes:t}),available:e=>X(e),enabled:e=>Object(re.b)(e)&&!ue([e],a,t),description:de,icon:"alert",type:"icon",color:"warning",onClick:e=>l([e]),"data-test-subj":"transformActionReauthorize"})),[a,e,t]),closeModal:()=>n(!1),isModalVisible:r,items:o,openModal:l,reauthorizeAndCloseModal:()=>{n(!1);const{transformIds:e}=(e=>{let t=!1;const a=e.map((e=>{var a;let s="",r=Number.MIN_VALUE;var n;return Object(W.a)(null==e||null===(a=e.config)||void 0===a?void 0:a._meta,["order"])&&("number"==typeof e.config._meta.order&&(t=!0,r=null==e||null===(n=e.config)||void 0===n?void 0:n._meta.order),Object(W.a)(e.config._meta.package,["name"])&&"string"==typeof e.config._meta.package.name&&(s=e.config._meta.package.name)),{id:e.id,order:r,packageName:s}}));return{transformIds:t?Object(D.sortBy)(a,["packageName","order"]).map((e=>({id:e.id}))):a.map((e=>({id:e.id}))),shouldInstallSequentially:t}})(o);s(e)}}},be=({closeModal:e,items:t,reauthorizeAndCloseModal:a})=>{const s=t.length>1,r=d.i18n.translate("xpack.transform.transformList.bulkReauthorizeModalTitle",{defaultMessage:"Reauthorize {count} {count, plural, one {transform} other {transforms}}?",values:{count:t&&t.length}}),n=d.i18n.translate("xpack.transform.transformList.reauthorizeModalTitle",{defaultMessage:"Reauthorize {transformId}?",values:{transformId:t[0]&&t[0].config.id}});return Object(E.jsx)(O.EuiConfirmModal,{"data-test-subj":"transformReauthorizeModal",title:!0===s?r:n,onCancel:e,onConfirm:a,cancelButtonText:d.i18n.translate("xpack.transform.transformList.reauthorizeModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:d.i18n.translate("xpack.transform.transformList.reauthorizeModalConfirmButton",{defaultMessage:"Reauthorize"}),defaultFocusedButton:O.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},Object(E.jsx)("p",null,d.i18n.translate("xpack.transform.transformList.reauthorizeModalBody",{defaultMessage:"Your current roles are used to update and start the transform. Starting a transform increases search and indexing load in your cluster. If excessive load is experienced, stop the transform."})))};var je=a(51);const pe=({onClick:e,transformNodes:t})=>{const a=Object(B.t)(),s=!a.canCreateTransform||!a.canPreviewTransform||!a.canStartStopTransform||0===t,r=Object(E.jsx)(O.EuiButton,{disabled:s,fill:!0,onClick:e,iconType:"plusInCircle","data-test-subj":"transformButtonCreate"},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformList.createTransformButton",defaultMessage:"Create a transform"}));return s?Object(E.jsx)(O.EuiToolTip,{position:"top",content:ce(t>0?"canCreateTransform":"noTransformNodes")},r):r},ge=({onClick:e,isLoading:t})=>Object(E.jsx)(O.EuiButton,{color:"success",iconType:"refresh","data-test-subj":"transformRefreshTransformListButton"+(t?" loading":" loaded"),onClick:e,isLoading:t},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformList.refreshButtonLabel",defaultMessage:"Reload"}));function xe({actionName:e,count:t=1}){return d.i18n.translate("xpack.transform.transformList.actionDisabledNoStatsTooltipMessage",{defaultMessage:"{actionName} is disabled because the status for {count, plural, one {this transform} other {some transforms}} is unavailable.",values:{actionName:e,count:t}})}const Oe=d.i18n.translate("xpack.transform.transformList.deleteActionNameText",{defaultMessage:"Delete"}),he=e=>e.stats&&![K.t.STOPPED,K.t.FAILED].includes(e.stats.state),Te=(e,t)=>{const a=e.some(he);return!0===t||a||Object(re.c)(e)},ve=({items:e,canDeleteTransform:t,disabled:a,isBulkAction:s,forceDisable:r})=>{const n=(({items:e,canDeleteTransform:t,forceDisable:a})=>{const s=e.length>1;return Object(re.c)(e)?xe({actionName:Oe,count:e.length}):t?e.some(he)?!0===s?d.i18n.translate("xpack.transform.transformList.deleteBulkActionDisabledToolTipContent",{defaultMessage:"One or more selected transforms must be stopped in order to be deleted."}):d.i18n.translate("xpack.transform.transformList.deleteActionDisabledToolTipContent",{defaultMessage:"Stop the transform in order to delete it."}):void 0:ce("canDeleteTransform")})({items:e,canDeleteTransform:t,forceDisable:r});return n?Object(E.jsx)(O.EuiToolTip,{position:"top",content:n},Object(E.jsx)(p.a.Fragment,null,Oe)):Object(E.jsx)(p.a.Fragment,null,Oe)},Me=e=>{const{canDeleteTransform:t}=Object(B.t)(),a=Object(B.c)(),[s,r]=Object(j.useState)(!1),[n,o]=Object(j.useState)([]),i=n.length>1,l=Object(j.useMemo)((()=>n.some((e=>{var t;return(null===(t=e.stats)||void 0===t?void 0:t.state)===K.t.FAILED}))),[n]),{userCanDeleteIndex:c,userCanDeleteDataView:d,deleteDestIndex:u,dataViewExists:m,deleteDataView:f,toggleDeleteIndex:b,toggleDeleteDataView:p}=Object(B.b)(n),g=e=>{Array.isArray(e)&&(o(e),r(!0))};return{action:Object(j.useMemo)((()=>({name:a=>Object(E.jsx)(ve,{canDeleteTransform:t,disabled:Te([a],e),isBulkAction:!1,items:[a],forceDisable:e}),enabled:a=>Object(re.b)(a)&&!Te([a],e)&&t,description:Oe,icon:"trash",type:"icon",onClick:e=>g([e]),"data-test-subj":"transformActionDelete"})),[t,e]),closeModal:()=>r(!1),deleteAndCloseModal:()=>{var e;r(!1);const t=c&&u,s=c&&d&&m&&f,o=i?l:n[0]&&n[0]&&(null===(e=n[0].stats)||void 0===e?void 0:e.state)===K.t.FAILED;a({transformsInfo:n.filter(re.b).map((e=>({id:e.config.id,state:e.stats.state}))),deleteDestIndex:t,deleteDestDataView:s,forceDelete:o})},deleteDestIndex:u,deleteDataView:f,dataViewExists:m,isModalVisible:s,items:n,openModal:g,shouldForceDelete:l,toggleDeleteIndex:b,toggleDeleteDataView:p,userCanDeleteIndex:c,userCanDeleteDataView:d}},ye=e=>{var t,a;return null===(t=e.config)||void 0===t||null===(a=t._meta)||void 0===a?void 0:a.managed},Se=({count:e,action:t})=>Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(O.EuiCallOut,{color:"warning"},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.managedTransformsWarningCallout",defaultMessage:"{count, plural, one {This transform} other {At least one of these transforms}} is preconfigured by Elastic; {action} {count, plural, one {it} other {them}} might impact other parts of the product.",values:{count:e,action:t}}))),ke=({closeModal:e,deleteAndCloseModal:t,deleteDestIndex:a,deleteDataView:s,dataViewExists:r,items:n,shouldForceDelete:o,toggleDeleteIndex:i,toggleDeleteDataView:l,userCanDeleteIndex:c,userCanDeleteDataView:u})=>{const m=Object(j.useMemo)((()=>n.some((e=>ye(e)))),[n]),f=n.length>1,b=d.i18n.translate("xpack.transform.transformList.bulkDeleteModalTitle",{defaultMessage:"Delete {count} {count, plural, one {transform} other {transforms}}?",values:{count:n.length}}),g=d.i18n.translate("xpack.transform.transformList.deleteModalTitle",{defaultMessage:"Delete {transformId}?",values:{transformId:n[0]&&n[0].config.id}}),x=Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiFlexGroup,{direction:"column",gutterSize:"none"},m?Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(Se,{count:n.length,action:d.i18n.translate("xpack.transform.transformList.deleteManagedTransformDescription",{defaultMessage:"deleting"})}),Object(E.jsx)(O.EuiSpacer,null)):null,Object(E.jsx)(O.EuiFlexItem,null,Object(E.jsx)(O.EuiSwitch,{"data-test-subj":"transformBulkDeleteIndexSwitch",label:d.i18n.translate("xpack.transform.actionDeleteTransform.bulkDeleteDestinationIndexTitle",{defaultMessage:"Delete destination indices"}),checked:a,onChange:i})),Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(O.EuiFlexItem,null,Object(E.jsx)(O.EuiSwitch,{"data-test-subj":"transformBulkDeleteDataViewSwitch",label:d.i18n.translate("xpack.transform.actionDeleteTransform.bulkDeleteDestDataViewTitle",{defaultMessage:"Delete destination data views"}),checked:s,onChange:l,disabled:!1===u})))),h=Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiFlexGroup,{direction:"column",gutterSize:"none"},m?Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(Se,{count:1,action:d.i18n.translate("xpack.transform.transformList.deleteManagedTransformDescription",{defaultMessage:"deleting"})}),Object(E.jsx)(O.EuiSpacer,null)):null,Object(E.jsx)(O.EuiFlexItem,null,c&&Object(E.jsx)(O.EuiSwitch,{"data-test-subj":"transformDeleteIndexSwitch",label:d.i18n.translate("xpack.transform.actionDeleteTransform.deleteDestinationIndexTitle",{defaultMessage:"Delete destination index {destinationIndex}",values:{destinationIndex:n[0]&&n[0].config.dest.index}}),checked:a,onChange:i})),c&&r&&Object(E.jsx)(O.EuiFlexItem,null,Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(O.EuiSwitch,{"data-test-subj":"transformDeleteDataViewSwitch",label:d.i18n.translate("xpack.transform.actionDeleteTransform.deleteDestDataViewTitle",{defaultMessage:"Delete data view {destinationIndex}",values:{destinationIndex:n[0]&&n[0].config.dest.index}}),checked:s,onChange:l,disabled:!1===u}))));return Object(E.jsx)(O.EuiConfirmModal,{"data-test-subj":"transformDeleteModal",title:!0===f?b:g,onCancel:e,onConfirm:t,cancelButtonText:d.i18n.translate("xpack.transform.transformList.deleteModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:d.i18n.translate("xpack.transform.transformList.deleteModalDeleteButton",{defaultMessage:"Delete"}),defaultFocusedButton:O.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"danger"},f?x:h)},Ee=d.i18n.translate("xpack.transform.transformList.resetActionNameText",{defaultMessage:"Reset"}),Fe=e=>e.stats&&![K.t.STOPPED,K.t.FAILED].includes(e.stats.state),we=(e,t)=>{const a=e.some(Fe);return!0===t||a||Object(re.c)(e)},Ce=({items:e,canResetTransform:t,forceDisable:a})=>{const s=e.length>1;if(Object(re.c)(e))return xe({actionName:Ee,count:e.length});if(!t)return ce("canResetTransform");if(we(e,a)){const e=d.i18n.translate("xpack.transform.transformList.resetBulkActionDisabledToolTipContent",{defaultMessage:"One or more selected transforms must be stopped to be reset."}),t=d.i18n.translate("xpack.transform.transformList.resetActionDisabledToolTipContent",{defaultMessage:"Stop the transform in order to reset it."});return s?e:t}},Le=({items:e,canResetTransform:t,disabled:a})=>{const s=Ce({items:e,canResetTransform:t,forceDisable:a});return s?Object(E.jsx)(O.EuiToolTip,{position:"top",content:s},Object(E.jsx)(p.a.Fragment,null,Ee)):Object(E.jsx)(p.a.Fragment,null,Ee)},De=e=>{const{canResetTransform:t}=Object(B.t)(),a=Object(B.o)(),[s,r]=Object(j.useState)(!1),[n,o]=Object(j.useState)([]),i=Object(j.useMemo)((()=>n.some((e=>{var t;return(null===(t=e.stats)||void 0===t?void 0:t.state)===K.t.FAILED}))),[n]),l=e=>{Array.isArray(e)&&(o(e),r(!0))};return{action:Object(j.useMemo)((()=>({name:a=>Object(E.jsx)(Le,{canResetTransform:t,disabled:we([a],e),isBulkAction:!1,items:[a]}),enabled:a=>void 0===Ce({items:[a],canResetTransform:t,forceDisable:e}),description:Ee,icon:"refresh",type:"icon",onClick:e=>l([e]),"data-test-subj":"transformActionReset"})),[t,e]),closeModal:()=>r(!1),resetAndCloseModal:()=>{r(!1),a({transformsInfo:n.filter(re.b).map((e=>({id:e.config.id,state:e.stats.state})))})},isModalVisible:s,items:n,openModal:l,shouldForceReset:i}},Ie=({closeModal:e,resetAndCloseModal:t,items:a,shouldForceReset:s})=>{const r=Object(j.useMemo)((()=>a.some((e=>ye(e)))),[a]),n=a.length>1,o=d.i18n.translate("xpack.transform.transformList.bulkResetModalTitle",{defaultMessage:"Reset {count} {count, plural, one {transform} other {transforms}}?",values:{count:a.length}}),i=d.i18n.translate("xpack.transform.transformList.resetModalTitle",{defaultMessage:"Reset {transformId}?",values:{transformId:a[0]&&a[0].config.id}}),l=Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiFlexGroup,{direction:"column",gutterSize:"none"},r?Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(Se,{count:a.length,action:d.i18n.translate("xpack.transform.transformList.resetManagedTransformDescription",{defaultMessage:"resetting"})}),Object(E.jsx)(O.EuiSpacer,null)):null)),c=Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiFlexGroup,{direction:"column",gutterSize:"none"},r?Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(Se,{count:1,action:d.i18n.translate("xpack.transform.transformList.resetManagedTransformDescription",{defaultMessage:"resetting"})}),Object(E.jsx)(O.EuiSpacer,null)):null));return Object(E.jsx)(O.EuiConfirmModal,{"data-test-subj":"transformResetModal",title:!0===n?o:i,onCancel:e,onConfirm:t,cancelButtonText:d.i18n.translate("xpack.transform.transformList.resetModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:d.i18n.translate("xpack.transform.transformList.resetModalResetButton",{defaultMessage:"Reset"}),defaultFocusedButton:O.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"danger"},n?l:c)},Ae=d.i18n.translate("xpack.transform.transformList.startActionNameText",{defaultMessage:"Start"}),Pe=(e,t,a)=>{const s=e.some((e=>Object(je.o)(e))),r=e.some((e=>{var t;return(null===(t=e.stats)||void 0===t?void 0:t.state)===K.t.STARTED}));return!t||s||r||0===e.length||0===a||Object(re.c)(e)},Ne=({items:e,forceDisable:t,transformNodes:a})=>{const{canStartStopTransform:s}=Object(B.t)(),r=e.length>1,n=e.some((e=>Object(je.o)(e))),o=e.some((e=>{var t;return(null===(t=e.stats)||void 0===t?void 0:t.state)===K.t.STARTED}));let i,l;!0===r?(i=d.i18n.translate("xpack.transform.transformList.startedTransformBulkToolTip",{defaultMessage:"One or more transforms are already started."}),l=d.i18n.translate("xpack.transform.transformList.cannotRestartCompleteBatchTransformBulkActionToolTip",{defaultMessage:"One or more transforms are completed batch transforms and cannot be restarted."})):(i=d.i18n.translate("xpack.transform.transformList.startedTransformToolTip",{defaultMessage:"{transformId} is already started.",values:{transformId:e[0]&&e[0].config.id}}),l=d.i18n.translate("xpack.transform.transformList.cannotRestartCompleteBatchTransformToolTip",{defaultMessage:"{transformId} is a completed batch transform and cannot be restarted.",values:{transformId:e[0]&&e[0].config.id}}));const c=Pe(e,s,a);let u;return c&&e.length>0&&(s?n?u=l:o?u=i:Object(re.c)(e)&&(u=xe({actionName:Ae,count:e.length})):u=ce("canStartStopTransform")),!0!==t&&!c||void 0===u?Object(E.jsx)(p.a.Fragment,null,Ae):Object(E.jsx)(O.EuiToolTip,{position:"top",content:u},Object(E.jsx)(p.a.Fragment,null,Ae))},_e=(e,t)=>{const{canStartStopTransform:a}=Object(B.t)(),s=Object(B.r)(),[r,n]=Object(j.useState)(!1),[o,i]=Object(j.useState)([]),l=e=>{Array.isArray(e)&&(i(e),n(!0))};return{action:Object(j.useMemo)((()=>({name:a=>Object(E.jsx)(Ne,{items:[a],forceDisable:e,transformNodes:t}),available:e=>!Object(re.b)(e)||e.stats.state===K.t.STOPPED,enabled:e=>!Pe([e],a,t),description:Ae,icon:"play",type:"icon",onClick:e=>l([e]),"data-test-subj":"transformActionStart"})),[a,e,t]),closeModal:()=>n(!1),isModalVisible:r,items:o,openModal:l,startAndCloseModal:()=>{n(!1),s(o.map((e=>({id:e.id}))))}}},Be=({closeModal:e,items:t,startAndCloseModal:a})=>{const s=t.length>1,r=d.i18n.translate("xpack.transform.transformList.bulkStartModalTitle",{defaultMessage:"Start {count} {count, plural, one {transform} other {transforms}}?",values:{count:t&&t.length}}),n=d.i18n.translate("xpack.transform.transformList.startModalTitle",{defaultMessage:"Start {transformId}?",values:{transformId:t[0]&&t[0].config.id}});return Object(E.jsx)(O.EuiConfirmModal,{"data-test-subj":"transformStartModal",title:!0===s?r:n,onCancel:e,onConfirm:a,cancelButtonText:d.i18n.translate("xpack.transform.transformList.startModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:d.i18n.translate("xpack.transform.transformList.startModalStartButton",{defaultMessage:"Start"}),defaultFocusedButton:O.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},Object(E.jsx)("p",null,d.i18n.translate("xpack.transform.transformList.startModalBody",{defaultMessage:"A transform increases search and indexing load in your cluster. If excessive load is experienced, stop the transform."})))},ze=d.i18n.translate("xpack.transform.transformList.scheduleNowActionNameText",{defaultMessage:"Schedule now"}),Re=(e,t,a)=>{const s=e.some((e=>Object(je.o)(e)));return!t||s||0===e.length||0===a||Object(re.c)(e)},Ve=({items:e,forceDisable:t,transformNodes:a})=>{const{canScheduleNowTransform:s}=Object(B.t)(),r=e.length>1,n=e.some((e=>Object(je.o)(e)));let o;o=!0===r?d.i18n.translate("xpack.transform.transformList.cannotScheduleNowCompleteBatchTransformBulkActionToolTip",{defaultMessage:"One or more transforms are completed batch transforms and cannot be scheduled to process data instantly."}):d.i18n.translate("xpack.transform.transformList.cannotScheduleNowCompleteBatchTransformToolTip",{defaultMessage:"{transformId} is a completed batch transform and cannot be scheduled to process data instantly.",values:{transformId:e[0]&&e[0].config.id}});const i=Re(e,s,a);let l=d.i18n.translate("xpack.transform.transformList.scheduleNowToolTip",{defaultMessage:"Schedule the transform to instantly process data without waiting for the configured interval between checks for changes in the source indices."});return i&&e.length>0&&(s?n?l=o:Object(re.c)(e)&&(l=xe({actionName:ze,count:e.length})):l=ce("canScheduleNowTransform")),Object(E.jsx)(O.EuiToolTip,{position:"top",content:l},Object(E.jsx)(p.a.Fragment,null,ze))},qe=(e,t)=>{const{canScheduleNowTransform:a}=Object(B.t)(),s=Object(B.p)();return{action:Object(j.useMemo)((()=>({name:a=>Object(E.jsx)(Ve,{items:[a],forceDisable:e,transformNodes:t}),available:e=>!Object(re.b)(e)||e.stats.state===K.t.STARTED,enabled:e=>Object(re.b)(e)&&!Re([e],a,t),description:ze,icon:"play",type:"icon",onClick:e=>s([{id:e.id}]),"data-test-subj":"transformActionScheduleNow"})),[a,e,s,t]),scheduleNowTransforms:s}},He=d.i18n.translate("xpack.transform.transformList.stopActionNameText",{defaultMessage:"Stop"}),Ue=(e,t,a)=>{const s=e.some((e=>{var t;return(null===(t=e.stats)||void 0===t?void 0:t.state)===K.t.STOPPED}));return!0===a||!t||!0===s||Object(re.c)(e)},$e=({items:e,forceDisable:t})=>{const a=(({items:e,capabilities:t})=>{const a=e.length>1,{canStartStopTransform:s}=t;if(Object(re.c)(e))return xe({actionName:He,count:e.length});const r=e.some((e=>Object(re.b)(e)&&e.stats.state===K.t.STOPPED));return s?r?!0===a?d.i18n.translate("xpack.transform.transformList.stoppedTransformBulkToolTip",{defaultMessage:"One or more transforms are already stopped."}):d.i18n.translate("xpack.transform.transformList.stoppedTransformToolTip",{defaultMessage:"{transformId} is already stopped.",values:{transformId:e[0]&&e[0].config.id}}):void 0:ce("canStartStopTransform")})({items:e,capabilities:Object(B.t)()});return t||a?Object(E.jsx)(O.EuiToolTip,{position:"top",content:a},Object(E.jsx)(p.a.Fragment,null,He)):Object(E.jsx)(p.a.Fragment,null,He)},Ge=e=>{const{canStartStopTransform:t}=Object(B.t)(),a=Object(B.s)(),[s,r]=Object(j.useState)(!1),[n,o]=Object(j.useState)([]),i=e=>{Array.isArray(e)&&(o(e),r(!0))},l=Object(j.useCallback)((e=>{r(!1),a(e.map((e=>({id:e.id,state:e.stats?e.stats.state:"waiting"}))))}),[a]),c=Object(j.useCallback)((e=>a([{id:e.id,state:e.stats?e.stats.state:"waiting"}])),[a]);return{action:Object(j.useMemo)((()=>({name:t=>Object(E.jsx)($e,{items:[t],forceDisable:e}),available:e=>!Object(re.b)(e)||e.stats.state!==K.t.STOPPED,enabled:a=>Object(re.b)(a)&&!Ue([a],t,e),description:He,icon:"stop",type:"icon",onClick:e=>{ye(e)?i([e]):c(e)},"data-test-subj":"transformActionStop"})),[t,c,e]),closeModal:()=>r(!1),openModal:i,isModalVisible:s,items:n,stopAndCloseModal:l}};var Je=a(64);const Ye=d.i18n.translate("xpack.transform.transformList.cloneActionNameText",{defaultMessage:"Clone"}),We=({disabled:e})=>e?Object(E.jsx)(O.EuiToolTip,{position:"top",content:ce("canStartStopTransform")},Object(E.jsx)(p.a.Fragment,null,Ye)):Object(E.jsx)(p.a.Fragment,null,Ye);var Ke=a(39);const Qe=d.i18n.translate("xpack.transform.transformList.discoverActionNameText",{defaultMessage:"View in Discover"}),Ze=({dataViewExists:e,items:t})=>{var a;const s=t.length>1,r=t[0],n=(null===(a=r.stats)||void 0===a?void 0:a.state)===K.t.STOPPED,o=Object(je.l)(r),i=void 0===r.config.sync,l=n&&void 0===o&&!0===i;let c;return!0===s?c=d.i18n.translate("xpack.transform.transformList.discoverTransformBulkToolTip",{defaultMessage:"Links to Discover are not supported as a bulk action."}):e?l&&(c=d.i18n.translate("xpack.transform.transformList.discoverTransformToolTip",{defaultMessage:"The transform needs to be started before it's available in Discover."})):c=d.i18n.translate("xpack.transform.transformList.discoverTransformNoDataViewToolTip",{defaultMessage:"A Kibana data view is required for the destination index to be viewable in Discover"}),void 0!==c?Object(E.jsx)(O.EuiToolTip,{position:"top",content:c},Object(E.jsx)("span",{"data-test-subj":"transformDiscoverActionNameText disabled"},Qe)):Object(E.jsx)("span",{"data-test-subj":"transformDiscoverActionNameText enabled"},Qe)};var Xe=a(124),et=a.n(Xe),tt=a(60),at=a(80),st=a(86),rt=a(85);const nt=d.i18n.translate("xpack.transform.transformList.editFlyoutFormNumberAboveZeroNotValidErrorMessage",{defaultMessage:"Value needs to be an integer above zero."}),ot=d.i18n.translate("xpack.transform.transformList.editFlyoutFormRequiredErrorMessage",{defaultMessage:"Required field."}),it=d.i18n.translate("xpack.transform.transformList.editFlyoutFormStringNotValidErrorMessage",{defaultMessage:"Value needs to be of type string."});function lt(e,t){if("string"!=typeof e||null===e)return[it];const a=e.match(/[a-z]+|[^a-z]+/gi);if(null===a||Array.isArray(a)&&2!==a.length)return[ct];const s=+a[0],r=a[1];return isNaN(s)||!Number.isInteger(s)||0===s?[ct]:{number:s,timeUnit:r}}const ct=d.i18n.translate("xpack.transform.transformList.editFlyoutFormFrequencyNotValidErrorMessage",{defaultMessage:"The frequency value is not valid."}),dt={string:(e,t=!0)=>"string"!=typeof e?[it]:0!==e.length||t?[]:[ot],frequency:e=>{const t=lt(e);return Array.isArray(t)?t:Object(rt.c)(t)?[]:[ct]},integerAboveZero:e=>(e+"").includes(".")||null!==Object(tt.e)({min:1,integerOnly:!0})(+e)?[nt]:[],transformSettingsNumberOfRetriesValidator:rt.h,transformSettingsPageSearchSizeValidator:rt.i,retentionPolicyMaxAgeValidator:e=>{const t=lt(e,st.e);return Array.isArray(t)?t:Object(rt.d)(t)?[]:[st.e]}},ut=(e,t,a,s)=>{const r=void 0!==(null==s?void 0:s.defaultValue)?s.defaultValue:"",n=Object(at.a)(a,t,void 0);return{formFieldName:e,configFieldName:t,defaultValue:r,dependsOn:[],errorMessages:[],isNullable:!1,isOptional:!0,validator:"string",value:null!=n?n.toString():"",valueParser:e=>e,...void 0!==s?{...s}:{}}},mt=(e,t,a,s)=>{var r;return{formSectionName:e,configFieldName:t,defaultEnabled:null!==(r=null==s?void 0:s.defaultEnabled)&&void 0!==r&&r,enabled:null!=Object(at.a)(a,t,void 0)}},ft=(e,t,a,s=!1)=>{const{formFields:r,formSections:n}=a,o=r[e],i=o.isNullable?null:o.defaultValue,l=void 0===o.section||n[o.section].enabled,c=""!==o.value?o.valueParser(o.value):i,d=Object(at.a)(t,o.configFieldName,i),u=!1===s?o.dependsOn.reduce(((e,s)=>Object(D.merge)({...e},ft(s,t,a,!0))),{}):{};return c===o.defaultValue&&c===d&&o.isOptional?{}:void 0===o.section||l?l&&(c!==d||s)?Object(at.b)(u,o.configFieldName,""===c&&o.isOptional?void 0:c):{}:Object(at.b)(u,n[o.section].configFieldName,null)},bt=e=>({formFields:{description:ut("description","description",e),frequency:ut("frequency","frequency",e,{defaultValue:K.e,validator:"frequency"}),destinationIndex:ut("destinationIndex","dest.index",e,{dependsOn:["destinationIngestPipeline"],isOptional:!1}),destinationIngestPipeline:ut("destinationIngestPipeline","dest.pipeline",e,{dependsOn:["destinationIndex"],isOptional:!0}),docsPerSecond:ut("docsPerSecond","settings.docs_per_second",e,{isNullable:!0,isOptional:!0,validator:"integerAboveZero",valueParser:e=>""===e?null:+e}),maxPageSearchSize:ut("maxPageSearchSize","settings.max_page_search_size",e,{defaultValue:`${K.g}`,isNullable:!0,isOptional:!0,validator:"transformSettingsPageSearchSizeValidator",valueParser:e=>+e}),numFailureRetries:ut("numFailureRetries","settings.num_failure_retries",e,{defaultValue:void 0,isNullable:!0,isOptional:!0,validator:"transformSettingsNumberOfRetriesValidator",valueParser:e=>+e}),retentionPolicyField:ut("retentionPolicyField","retention_policy.time.field",e,{dependsOn:["retentionPolicyMaxAge"],isNullable:!1,isOptional:!0,section:"retentionPolicy"}),retentionPolicyMaxAge:ut("retentionPolicyMaxAge","retention_policy.time.max_age",e,{dependsOn:["retentionPolicyField"],isNullable:!1,isOptional:!0,section:"retentionPolicy",validator:"retentionPolicyMaxAgeValidator"})},formSections:{retentionPolicy:mt("retentionPolicy","retention_policy",e)},isFormTouched:!1,isFormValid:!0}),jt=(e,t)=>({...e,errorMessages:e.isOptional&&"string"==typeof t&&0===t.length?[]:dt[e.validator](t,e.isOptional),value:t}),pt=(e,t)=>({...e,enabled:t}),gt=e=>Object.values(e).map((e=>e.value)),xt=e=>Object.values(e).map((e=>e.enabled)),[Ot,...ht]=et()((({config:e,dataViewId:t})=>{const[a,s]=Object(j.useReducer)((e=>{const t=bt(e),a=gt(t.formFields),s=xt(t.formSections);return(e,t)=>{const r="form_field"===t.name?{...e.formFields,[t.payload.field]:jt(e.formFields[t.payload.field],t.payload.value)}:e.formFields,n="form_section"===t.name?{...e.formSections,[t.payload.section]:pt(e.formSections[t.payload.section],t.payload.enabled)}:e.formSections;return{...e,apiErrorMessage:"api_error"===t.name?t.payload:e.apiErrorMessage,formFields:r,formSections:n,isFormTouched:!Object(D.isEqual)(a,gt(r))||!Object(D.isEqual)(s,xt(n)),isFormValid:(o=r,Object.keys(o).reduce(((e,t)=>e&&0===o[t].errorMessages.length),!0))};var o}})(e),bt(e)),r=Object(j.useMemo)((()=>({apiError:e=>s({name:"api_error",payload:e}),formField:e=>s({name:"form_field",payload:e}),formSection:e=>s({name:"form_section",payload:e})})),[]),n=Object(j.useMemo)((()=>((e,t)=>Object.keys(t.formFields).reduce(((a,s)=>Object(D.merge)({...a},ft(s,e,t))),{}))(e,a)),[e,a]),o=Object(j.useMemo)((()=>!a.isFormValid||!a.isFormTouched),[a.isFormValid,a.isFormTouched]);return{config:e,dataViewId:t,formState:a,actions:r,requestConfig:n,isUpdateButtonDisabled:o}}),(e=>e.config),(e=>e.dataViewId),(e=>e.actions),(e=>e.formState.apiErrorMessage),(e=>e.formState.formSections),(e=>e.formState.formFields.description),(e=>e.formState.formFields.destinationIndex),(e=>e.formState.formFields.docsPerSecond),(e=>e.formState.formFields.frequency),(e=>e.formState.formFields.destinationIngestPipeline),(e=>e.formState.formFields.maxPageSearchSize),(e=>e.formState.formFields.numFailureRetries),(e=>e.formState.formFields.retentionPolicyField),(e=>e.formState.formFields.retentionPolicyMaxAge),(e=>e.requestConfig),(e=>e.isUpdateButtonDisabled));let Tt;!function(e){e[e.config=0]="config",e[e.dataViewId=1]="dataViewId",e[e.actions=2]="actions",e[e.apiErrorMessage=3]="apiErrorMessage",e[e.stateFormSection=4]="stateFormSection",e[e.description=5]="description",e[e.destinationIndex=6]="destinationIndex",e[e.docsPerSecond=7]="docsPerSecond",e[e.frequency=8]="frequency",e[e.destinationIngestPipeline=9]="destinationIngestPipeline",e[e.maxPageSearchSize=10]="maxPageSearchSize",e[e.numFailureRetries=11]="numFailureRetries",e[e.retentionPolicyField=12]="retentionPolicyField",e[e.retentionPolicyMaxAge=13]="retentionPolicyMaxAge",e[e.requestConfig=14]="requestConfig",e[e.isUpdateButtonDisabled=15]="isUpdateButtonDisabled"}(Tt||(Tt={}));const vt=e=>ht[Tt[e]](),Mt=()=>{const e=vt("apiErrorMessage");return Object(E.jsx)(p.a.Fragment,null,void 0!==e&&Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiSpacer,{size:"m"}),Object(E.jsx)(O.EuiCallOut,{title:d.i18n.translate("xpack.transform.transformList.editTransformGenericErrorMessage",{defaultMessage:"An error occurred calling the API endpoint to update transforms."}),color:"danger",iconType:"warning"},Object(E.jsx)("p",null,e))))},yt=()=>{const{esTransformUpdate:e}=Object(z.a)();return Object(E.jsx)(O.EuiCallOut,null,Object(E.jsx)(O.EuiFlexGroup,null,Object(E.jsx)(O.EuiFlexItem,{grow:!1},Object(E.jsx)(O.EuiIcon,{type:"help"})),Object(E.jsx)(O.EuiFlexItem,null,Object(E.jsx)(O.EuiTextColor,{color:"subdued"},d.i18n.translate("xpack.transform.transformList.editFlyoutCalloutText",{defaultMessage:"This form allows you to update a transform. The list of properties that you can update is a subset of the list that you can define when you create a transform."})),Object(E.jsx)(O.EuiLink,{href:e,target:"_BLANK"},d.i18n.translate("xpack.transform.transformList.editFlyoutCalloutDocs",{defaultMessage:"View docs"})))))};function St(e){return e.charAt(0).toUpperCase()+e.slice(1)}const kt=({field:e,label:t,helpText:a,placeHolder:s=!1})=>{const{defaultValue:r,errorMessages:n,value:o}=vt(e),{formField:i}=vt("actions"),l=St(e);return Object(E.jsx)(O.EuiFormRow,{label:t,helpText:a,isInvalid:n.length>0,error:n},Object(E.jsx)(O.EuiFieldText,{"data-test-subj":`transformEditFlyout${l}Input`,placeholder:s?d.i18n.translate("xpack.transform.transformList.editFlyoutFormPlaceholderText",{defaultMessage:"Default: {defaultValue}",values:{defaultValue:r}}):void 0,isInvalid:n.length>0,value:o,onChange:t=>i({field:e,value:t.target.value}),"aria-label":t}))},Et=({field:e,label:t,helpText:a,placeHolder:s=!1})=>{const{defaultValue:r,errorMessages:n,value:o}=vt(e),{formField:i}=vt("actions"),l=St(e);return Object(E.jsx)(O.EuiFormRow,{label:t,helpText:a,isInvalid:n.length>0,error:n},Object(E.jsx)(O.EuiTextArea,{"data-test-subj":`transformEditFlyout${l}Input`,placeholder:s?d.i18n.translate("xpack.transform.transformList.editFlyoutFormPlaceholderText",{defaultMessage:"Default: {defaultValue}",values:{defaultValue:r}}):void 0,isInvalid:n.length>0,value:o,onChange:t=>i({field:e,value:t.target.value}),"aria-label":t}))},Ft=()=>{const{i18n:e,theme:t}=Object(Y.a)(),a=Object(Y.b)(),s=vt("dataViewId"),r=vt("stateFormSection"),n=vt("retentionPolicyField"),{formField:o,formSection:i}=vt("actions"),l=vt("config"),c=Object(j.useMemo)((()=>({source:l.source,...Object(Je.c)(l)?{pivot:l.pivot}:{},...Object(Je.b)(l)?{latest:l.latest}:{}})),[l]),{error:u,data:m}=Object(B.m)(c),f=Object(j.useMemo)((()=>{if(null!=m&&m.generated_dest_index){const e=m.generated_dest_index.mappings.properties;return Object.keys(e).filter((t=>"date"===e[t].type))}return[]}),[m]);Object(j.useEffect)((()=>{null!==u&&a.addDanger({title:d.i18n.translate("xpack.transform.transformList.errorGettingTransformPreview",{defaultMessage:"An error occurred fetching the transform preview"}),text:Object(ne.a)(Object(E.jsx)(ie.a,{text:Object(oe.a)(u)}),{theme:t,i18n:e})})}),[u]);const b=f.length>0,g=Object(j.useMemo)((()=>Array.isArray(f)?f.map((e=>({text:e,value:e}))):[]),[f]);return Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiFormRow,{helpText:!1===b?d.i18n.translate("xpack.transform.transformList.editFlyoutFormEetentionPolicyError",{defaultMessage:"Retention policy settings are not available for indices without date fields."}):""},Object(E.jsx)(O.EuiSwitch,{name:"transformEditRetentionPolicySwitch",label:d.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicySwitchLabel",{defaultMessage:"Retention policy"}),checked:r.retentionPolicy.enabled,onChange:e=>i({section:"retentionPolicy",enabled:e.target.checked}),disabled:!b,"data-test-subj":"transformEditRetentionPolicySwitch"})),r.retentionPolicy.enabled&&Object(E.jsx)("div",{"data-test-subj":"transformEditRetentionPolicyContent"},Object(E.jsx)(O.EuiSpacer,{size:"m"}),s?Object(E.jsx)(O.EuiFormRow,{label:d.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyFieldLabel",{defaultMessage:"Field"}),isInvalid:n.errorMessages.length>0,error:n.errorMessages,helpText:d.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyDateFieldHelpText",{defaultMessage:"Select the date field that can be used to identify out of date documents in the destination index."})},Object(E.jsx)(O.EuiSelect,{"aria-label":d.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyFieldSelectAriaLabel",{defaultMessage:"Date field to set retention policy"}),"data-test-subj":"transformEditFlyoutRetentionPolicyFieldSelect",options:g,value:n.value,onChange:e=>o({field:"retentionPolicyField",value:e.target.value}),hasNoInitialSelection:!g.map((e=>e.text)).includes(n.value)})):Object(E.jsx)(kt,{field:"retentionPolicyField",label:d.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyFieldLabel",{defaultMessage:"Field"})}),Object(E.jsx)(kt,{field:"retentionPolicyMaxAge",label:d.i18n.translate("xpack.transform.transformList.editFlyoutFormRetentionPolicyMaxAgeLabel",{defaultMessage:"Max age"})})))},wt=d.i18n.translate("xpack.transform.transformList.editFlyoutFormDestinationIngestPipelineLabel",{defaultMessage:"Ingest Pipeline"}),Ct=()=>{var e;const{euiTheme:t}=Object(O.useEuiTheme)(),{errorMessages:a,value:s}=vt("destinationIngestPipeline"),{formField:r}=vt("actions"),{data:n,isLoading:o}=Object(B.g)(),i=null!==(e=null==n?void 0:n.map((({name:e})=>e)))&&void 0!==e?e:[];return Object(E.jsx)(p.a.Fragment,null,i.length>0||o?Object(E.jsx)(O.EuiFormRow,{label:wt,isInvalid:a.length>0,error:a},Object(E.jsx)(O.EuiSkeletonRectangle,{width:"100%",height:t.size.xxl,isLoading:o,contentAriaLabel:wt},Object(E.jsx)(O.EuiComboBox,{"data-test-subj":"transformEditFlyoutDestinationIngestPipelineFieldSelect","aria-label":d.i18n.translate("xpack.transform.stepDetailsForm.editFlyoutFormDestinationIngestPipelineFieldSelectAriaLabel",{defaultMessage:"Select an ingest pipeline"}),placeholder:d.i18n.translate("xpack.transform.stepDetailsForm.editFlyoutFormDestinationIngestPipelineFieldSelectPlaceholder",{defaultMessage:"Select an ingest pipeline"}),singleSelection:{asPlainText:!0},options:i.map((e=>({label:e}))),selectedOptions:[{label:s}],onChange:e=>{var t,a;return r({field:"destinationIngestPipeline",value:null!==(t=null===(a=e[0])||void 0===a?void 0:a.label)&&void 0!==t?t:""})}}))):Object(E.jsx)(kt,{field:"destinationIngestPipeline",label:wt}))},Lt=()=>Object(E.jsx)(O.EuiForm,null,Object(E.jsx)(Et,{field:"description",label:d.i18n.translate("xpack.transform.transformList.editFlyoutFormDescriptionLabel",{defaultMessage:"Description"})}),Object(E.jsx)(kt,{field:"frequency",label:d.i18n.translate("xpack.transform.transformList.editFlyoutFormFrequencyLabel",{defaultMessage:"Frequency"}),helpText:d.i18n.translate("xpack.transform.transformList.editFlyoutFormFrequencyHelpText",{defaultMessage:"The interval to check for changes in source indices when the transform runs continuously."})}),Object(E.jsx)(O.EuiSpacer,{size:"l"}),Object(E.jsx)(Ft,null),Object(E.jsx)(O.EuiSpacer,{size:"l"}),Object(E.jsx)(O.EuiAccordion,{"data-test-subj":"transformEditAccordionDestination",id:"transformEditAccordionDestination",buttonContent:d.i18n.translate("xpack.transform.transformList.editFlyoutFormDestinationButtonContent",{defaultMessage:"Destination configuration"}),paddingSize:"s"},Object(E.jsx)("div",{"data-test-subj":"transformEditAccordionDestinationContent"},Object(E.jsx)(kt,{field:"destinationIndex",label:d.i18n.translate("xpack.transform.transformList.editFlyoutFormDestinationIndexLabel",{defaultMessage:"Destination index"})}),Object(E.jsx)(O.EuiSpacer,{size:"m"}),Object(E.jsx)("div",{"data-test-subj":"transformEditAccordionIngestPipelineContent"},Object(E.jsx)(Ct,null)))),Object(E.jsx)(O.EuiSpacer,{size:"l"}),Object(E.jsx)(O.EuiAccordion,{"data-test-subj":"transformEditAccordionAdvancedSettings",id:"transformEditAccordionAdvancedSettings",buttonContent:d.i18n.translate("xpack.transform.transformList.editFlyoutFormAdvancedSettingsButtonContent",{defaultMessage:"Advanced settings"}),paddingSize:"s"},Object(E.jsx)("div",{"data-test-subj":"transformEditAccordionAdvancedSettingsContent"},Object(E.jsx)(kt,{field:"docsPerSecond",helpText:d.i18n.translate("xpack.transform.transformList.editFlyoutFormDocsPerSecondHelpText",{defaultMessage:"To enable throttling, set a limit of documents to input per second."}),label:d.i18n.translate("xpack.transform.transformList.editFlyoutFormDocsPerSecondLabel",{defaultMessage:"Documents per second"})}),Object(E.jsx)(kt,{field:"maxPageSearchSize",helpText:d.i18n.translate("xpack.transform.transformList.editFlyoutFormMaxPageSearchSizeHelpText",{defaultMessage:"The initial page size to use for the composite aggregation for each checkpoint."}),label:d.i18n.translate("xpack.transform.transformList.editFlyoutFormMaxPageSearchSizeLabel",{defaultMessage:"Maximum page search size"}),placeHolder:!0}),Object(E.jsx)(kt,{field:"numFailureRetries",helpText:d.i18n.translate("xpack.transform.transformList.editFlyoutFormNumFailureRetriesHelpText",{defaultMessage:"The number of retries on a recoverable failure before the transform task is marked as failed. Set it to -1 for infinite retries."}),label:d.i18n.translate("xpack.transform.transformList.numFailureRetriesLabel",{defaultMessage:"Number of failure retries"})})))),Dt=({closeFlyout:e})=>{const t=vt("requestConfig"),a=vt("isUpdateButtonDisabled"),s=vt("config"),{apiError:r}=vt("actions"),n=Object(B.u)(s.id,t);return Object(E.jsx)(O.EuiButton,{"data-test-subj":"transformEditFlyoutUpdateButton",onClick:async function(){r(void 0),n(void 0,{onError:e=>r(Object(oe.a)(e)),onSuccess:()=>e()})},fill:!0,isDisabled:a},d.i18n.translate("xpack.transform.transformList.editFlyoutUpdateButtonText",{defaultMessage:"Update"}))},It=({closeFlyout:e,config:t,dataViewId:a,isFlyoutVisible:s})=>t&&s?Object(E.jsx)(Ot,{config:t,dataViewId:a},Object(E.jsx)(O.EuiFlyout,{onClose:e,hideCloseButton:!0,"aria-labelledby":"transformEditFlyoutTitle","data-test-subj":"transformEditFlyout"},Object(E.jsx)(O.EuiFlyoutHeader,{hasBorder:!0},Object(E.jsx)(O.EuiTitle,{size:"m"},Object(E.jsx)("h2",{id:"transformEditFlyoutTitle"},d.i18n.translate("xpack.transform.transformList.editFlyoutTitle",{defaultMessage:"Edit {transformId}",values:{transformId:t.id}})))),ye({config:t})?Object(E.jsx)(Se,{count:1,action:d.i18n.translate("xpack.transform.transformList.editManagedTransformsDescription",{defaultMessage:"editing"})}):null,Object(E.jsx)(O.EuiFlyoutBody,{banner:Object(E.jsx)(yt,null)},Object(E.jsx)(Lt,null),Object(E.jsx)(Mt,null)),Object(E.jsx)(O.EuiFlyoutFooter,null,Object(E.jsx)(O.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(E.jsx)(O.EuiFlexItem,{grow:!1},Object(E.jsx)(O.EuiButtonEmpty,{iconType:"cross",onClick:e,flush:"left"},d.i18n.translate("xpack.transform.transformList.editFlyoutCancelButtonText",{defaultMessage:"Cancel"}))),Object(E.jsx)(O.EuiFlexItem,{grow:!1},Object(E.jsx)(Dt,{closeFlyout:e})))))):null,At=d.i18n.translate("xpack.transform.transformList.editActionNameText",{defaultMessage:"Edit"}),Pt=()=>{const{canCreateTransform:e}=Object(B.t)();return e?Object(E.jsx)(p.a.Fragment,null,At):Object(E.jsx)(O.EuiToolTip,{position:"top",content:ce("canStartStopTransform")},Object(E.jsx)(p.a.Fragment,null,At))},Nt=d.i18n.translate("xpack.transform.transformList.createAlertRuleNameText",{defaultMessage:"Create alert rule"}),_t=({disabled:e})=>e?Object(E.jsx)(O.EuiToolTip,{position:"top",content:ce("canCreateTransformAlerts")},Object(E.jsx)(p.a.Fragment,null,Nt)):Object(E.jsx)(p.a.Fragment,null,Nt);var Bt=a(75);const zt=({closeModal:e,items:t,stopAndCloseModal:a})=>{const s=Object(j.useMemo)((()=>t.some((e=>ye(e)))),[t]),r=t.length>1,n=d.i18n.translate("xpack.transform.transformList.bulkStopModalTitle",{defaultMessage:"Stop {count} {count, plural, one {transform} other {transforms}}?",values:{count:t&&t.length}}),o=d.i18n.translate("xpack.transform.transformList.stopModalTitle",{defaultMessage:"Stop {transformId}?",values:{transformId:t[0]&&t[0].config.id}});return Object(E.jsx)(O.EuiConfirmModal,{"data-test-subj":"transformStopModal",title:!0===r?n:o,onCancel:e,onConfirm:()=>a(t),cancelButtonText:d.i18n.translate("xpack.transform.transformList.startModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:d.i18n.translate("xpack.transform.transformList.startModalStopButton",{defaultMessage:"Stop"}),defaultFocusedButton:O.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},s?Object(E.jsx)(Se,{count:t.length,action:d.i18n.translate("xpack.transform.transformList.stopManagedTransformsDescription",{defaultMessage:"stopping"})}):null)},Rt=({forceDisable:e,transformNodes:t})=>{const a=((e,t)=>{const a=Object(v.useHistory)(),s=Object(Y.a)().data.dataViews,r=Object(Y.b)(),{getDataViewIdByTitle:n,loadDataViews:o}=Object(B.q)(void 0),{canCreateTransform:i}=Object(B.t)(),l=Object(j.useCallback)((async e=>{try{await o(s);const t=Array.isArray(e.config.source.index)?e.config.source.index.join(","):e.config.source.index,i=n(t);void 0===i?r.addDanger(d.i18n.translate("xpack.transform.clone.noDataViewErrorPromptText",{defaultMessage:"Unable to clone the transform {transformId}. No data view exists for {dataViewTitle}.",values:{dataViewTitle:t,transformId:e.id}})):a.push(`/${P.a.CLONE_TRANSFORM}/${e.id}?dataViewId=${i}`)}catch(e){r.addError(e,{title:d.i18n.translate("xpack.transform.clone.errorPromptText",{defaultMessage:"An error occurred checking if source data view exists"})})}}),[a,s,r,o,n]);return{action:Object(j.useMemo)((()=>({name:e=>Object(E.jsx)(We,{disabled:!i}),enabled:()=>i&&!e&&t>0,description:Ye,icon:"copy",type:"icon",onClick:l,"data-test-subj":"transformActionClone"})),[i,e,l,t])}})(e,t),s=Me(e),r=(e=>{var t;const{share:a,data:{dataViews:s},application:{capabilities:r}}=Object(Y.a)(),n=!(null===(t=r.discover)||void 0===t||!t.show),{getDataViewIdByTitle:o,loadDataViews:i}=Object(R.a)(void 0),[l,c]=Object(j.useState)(!1);Object(j.useEffect)((()=>{!async function(){await i(s),c(!0)}()}),[i,s]);const d=Object(j.useCallback)((e=>{const t=a.url.locators.get(Ke.DISCOVER_APP_LOCATOR);if(!t)return;const s=o(e.config.dest.index);t.navigateSync({indexPatternId:s})}),[o,a]),u=Object(j.useCallback)((e=>void 0!==o(e.config.dest.index)),[o]);return{action:Object(j.useMemo)((()=>({name:e=>Object(E.jsx)(Ze,{items:[e],dataViewExists:u(e)}),available:()=>n,enabled:t=>l&&!((e,t,a)=>{var s;if(1!==e.length)return!0;const r=e[0],n=(null===(s=r.stats)||void 0===s?void 0:s.state)===K.t.STOPPED,o=Object(je.l)(r),i=void 0===r.config.sync;return!0===t||!1===a||1==(!0===n&&void 0===o&&!0===i)})([t],e,u(t)),description:Qe,icon:"visTable",type:"icon",onClick:d,"data-test-subj":"transformActionDiscover"})),[e,u,l,n,d])}})(e),n=((e,t)=>{const{canCreateTransform:a}=Object(B.t)(),[s,r]=Object(j.useState)(),[n,o]=Object(j.useState)(!1),[i,l]=Object(j.useState)(),{getDataViewIdByTitle:c}=Object(R.a)(void 0),u=Object(Y.b)(),m=Object(Y.a)().data.dataViews,f=Object(j.useCallback)((async e=>{try{const t=Array.isArray(e.config.source.index)?e.config.source.index.join(","):e.config.source.index,a=c(t);void 0===a&&u.addWarning(d.i18n.translate("xpack.transform.edit.noDataViewErrorPromptText",{defaultMessage:"Unable to get the data view for the transform {transformId}. No data view exists for {dataViewTitle}.",values:{dataViewTitle:t,transformId:e.id}})),l(a),r(e.config),o(!0)}catch(e){u.addError(e,{title:d.i18n.translate("xpack.transform.edit.errorPromptText",{defaultMessage:"An error occurred checking if source data view exists"})})}}),[m,u,c]);return{action:Object(j.useMemo)((()=>({name:()=>Object(E.jsx)(Pt,null),enabled:()=>a&&!e&&t>0,description:At,icon:"pencil",type:"icon",onClick:e=>f(e),"data-test-subj":"transformActionEdit"})),[a,f,e,t]),config:s,closeFlyout:()=>o(!1),isFlyoutVisible:n,dataViewId:i}})(e,t),o=fe(e,t),i=De(e),l=qe(e,t),c=_e(e,t),u=Ge(e),m=(e=>{const{canCreateTransformAlerts:t}=Object(B.t)(),{setCreateAlertRule:a}=Object(Bt.e)(),s=Object(j.useCallback)((e=>{a(e.id)}),[a]);return{action:Object(j.useMemo)((()=>({name:e=>Object(E.jsx)(_t,{disabled:!t}),available:e=>Object(Je.a)(e.config),enabled:()=>t&&!e,description:Nt,type:"icon",icon:"bell",onClick:s,"data-test-subj":"transformActionCreateAlertRule"})),[t,e,s])}})(e);return{modals:Object(E.jsx)(p.a.Fragment,null,i.isModalVisible&&Object(E.jsx)(Ie,i),c.isModalVisible&&Object(E.jsx)(Be,c),u.isModalVisible&&Object(E.jsx)(zt,u),o.isModalVisible&&Object(E.jsx)(be,o),Object(E.jsx)(It,n),s.isModalVisible&&Object(E.jsx)(ke,s)),actions:[r.action,m.action,l.action,c.action,u.action,n.action,a.action,s.action,o.action,i.action]}},Vt=({healthStatus:e,compact:t=!0,showToolTip:a=!0})=>{const s=K.o[e],r=K.n[e],n=K.p[e],o=Object(E.jsx)(O.EuiHealth,{color:r,textSize:t?"xs":void 0,"data-test-subj":"transformListHealth"},n,t?"":`: ${s}`);return a?Object(E.jsx)(O.EuiToolTip,{content:s},o):o},qt={aborting:"warning",failed:"danger",indexing:"primary",started:"primary",stopped:"hollow",stopping:"hollow",waiting:"hollow"},Ht=({state:e,reason:t})=>{const a=qt[e];return e===K.t.FAILED&&void 0!==t?Object(E.jsx)(O.EuiToolTip,{content:t},Object(E.jsx)(O.EuiBadge,{className:"transform__TaskStateBadge",color:a},e)):Object(E.jsx)(O.EuiBadge,{className:"transform__TaskStateBadge",color:a},e)},Ut=d.i18n.translate("xpack.transform.transformList.needsReauthorizationBadge.insufficientPermissions",{defaultMessage:"This transform was created with insufficient permissions."}),$t=()=>Object(E.jsx)(O.EuiText,{textAlign:"center",color:"subdued",size:"s"},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformList.statsUnknown",defaultMessage:"Unknown"}));var Gt=a(25),Jt=a.n(Gt),Yt=a(79),Wt=a(95),Kt=a(62);const Qt=({section:e})=>0===e.items.length?null:Object(E.jsx)(O.EuiPanel,null,Object(E.jsx)(O.EuiTitle,{size:"xs"},Object(E.jsx)("span",null,e.title)),Object(E.jsx)(O.EuiDescriptionList,{compressed:!0,type:"column",listItems:e.items})),Zt=({sections:e,dataTestSubj:t})=>Object(E.jsx)("div",{"data-test-subj":null!=t?t:"transformDetailsTabContent"},Object(E.jsx)(O.EuiFlexGroup,null,Object(E.jsx)(O.EuiFlexItem,{style:{width:"50%"}},e.filter((e=>"left"===e.position)).map((e=>Object(E.jsx)(j.Fragment,{key:e.title},Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(Qt,{section:e}))))),Object(E.jsx)(O.EuiFlexItem,{style:{width:"50%"}},e.filter((e=>"right"===e.position)).map((e=>Object(E.jsx)(j.Fragment,{key:e.title},Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(Qt,{section:e}))))))),Xt=({json:e})=>Object(E.jsx)("div",{"data-test-subj":"transformJsonTabContent"},Object(E.jsx)(O.EuiFlexGroup,null,Object(E.jsx)(O.EuiFlexItem,null,Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(O.EuiCodeBlock,{"aria-label":d.i18n.translate("xpack.transform.transformList.transformDetails.expandedRowJsonPane",{defaultMessage:"JSON of transform configuration"}),fontSize:"s",language:"json",paddingSize:"s",style:{width:"100%"},isCopyable:!0},JSON.stringify(e,null,2))),Object(E.jsx)(O.EuiFlexItem,{grow:!1}," ")));var ea=a(31);const[ta,aa,sa]=["info","warning","error"],ra=({message:e,showTooltip:t=!1})=>{if(void 0===e)return Object(E.jsx)("span",null);let a="primary";const s="warning";return e.level===ta?a="primary":e.level===aa?a="warning":e.level===sa&&(a="danger"),t?Object(E.jsx)(O.EuiToolTip,{position:"bottom",content:e.text},Object(E.jsx)(O.EuiIcon,{type:s,color:a})):Object(E.jsx)(O.EuiIcon,{type:s,color:a})},na=({transformId:e})=>{const{showNodeInfo:t}=Object(Z.b)(),[a,s]=Object(j.useState)(0),[r,n]=Object(j.useState)(10),[o,i]=Object(j.useState)({sort:{field:"timestamp",direction:"desc"}}),{isLoading:l,error:c,data:u={messages:[],total:0}}=Object(B.i)(e,o.sort.field,o.sort.direction),{messages:m,total:f}=u,b=null!==c?d.i18n.translate("xpack.transform.transformList.transformDetails.messagesPane.errorMessage",{defaultMessage:"Messages could not be loaded"}):"",p=Object(B.n)(),g=[{name:p?Object(E.jsx)(O.EuiToolTip,{content:d.i18n.translate("xpack.transform.transformList.refreshLabel",{defaultMessage:"Refresh"})},Object(E.jsx)(O.EuiButtonIcon,{onClick:e=>{e.currentTarget.blur(),p()},iconType:"refresh","aria-label":d.i18n.translate("xpack.transform.transformList.refreshAriaLabel",{defaultMessage:"Refresh"})})):"",render:e=>Object(E.jsx)(ra,{message:e}),width:ea.euiLightVars.euiSizeXL},{field:"timestamp",name:d.i18n.translate("xpack.transform.transformList.transformDetails.messagesPane.timeLabel",{defaultMessage:"Time"}),render:e=>Object(O.formatDate)(e,K.j),sortable:!0},...t?[{field:"node_name",name:d.i18n.translate("xpack.transform.transformList.transformDetails.messagesPane.nodeLabel",{defaultMessage:"Node"}),sortable:!0}]:[],{field:"message",name:d.i18n.translate("xpack.transform.transformList.transformDetails.messagesPane.messageLabel",{defaultMessage:"Message"}),width:t?"50%":"70%"}],{pageOfMessages:x,totalItemCount:h}=(({index:e,size:t})=>{let a=m;if(f<=K.c){var s;const e=null!==(s=o.sort.field)&&void 0!==s?s:"timestamp";a=m.sort(((t,a)=>{const s=t[e],r=a[e];return"asc"===o.sort.direction?s-r:r-s}))}const r=a.length,n=e*t;return{pageOfMessages:a.slice(n,n+t),totalItemCount:r}})({index:a,size:r}),T={pageIndex:a,pageSize:r,totalItemCount:h,pageSizeOptions:[10,20,50],showPerPageOptions:!0};return Object(E.jsx)(O.EuiPanel,{color:"transparent",hasBorder:!1,paddingSize:"s","data-test-subj":"transformMessagesTabContent"},Object(E.jsx)(O.EuiBasicTable,{className:"transform__TransformTable__messagesPaneTable",items:x,columns:g,compressed:!0,loading:l,error:b,pagination:T,onChange:({page:e={index:0,size:10},sort:t})=>{const{index:a,size:r}=e;s(a),n(r),t&&i({sort:t})},sorting:o}))};var oa=a(67),ia=a(92),la=a(102);const ca=({transformConfig:e})=>{const t=Object(Y.b)(),{searchQuery:a,validationStatus:s,previewRequest:r,runtimeMappings:n}=Object(j.useMemo)((()=>Object(la.d)(Object(la.f)({}),e)),[e]),o=Object(j.useMemo)((()=>Object(je.j)(a)),[a]),i=Array.isArray(e.source.index)?e.source.index.join(","):e.source.index,l=Object(ia.a)({getIndexPattern:()=>i},o,s,r,n);return Object(E.jsx)(oa.a,T()({},l,{dataTestSubj:"transformPivotPreview",toastNotifications:t}))},da=({health:e})=>{const{status:t,issues:a}=e,s=[{field:"first_occurrence",name:d.i18n.translate("xpack.transform.transformList.transformDetails.healthPane.firstOccurrenceLabel",{defaultMessage:"First occurrence"}),render:e=>Object(O.formatDate)(e,K.j),sortable:!0},{field:"count",name:d.i18n.translate("xpack.transform.transformList.transformDetails.healthPane.countLabel",{defaultMessage:"count"}),sortable:!0,width:"60px"},{field:"issue",name:d.i18n.translate("xpack.transform.transformList.transformDetails.healthPane.issueLabel",{defaultMessage:"Issue"}),sortable:!0},{field:"details",name:d.i18n.translate("xpack.transform.transformList.transformDetails.healthPane.detailsLabel",{defaultMessage:"Details"}),width:"50%"}];return Object(E.jsx)(O.EuiPanel,{color:"transparent",hasBorder:!1,paddingSize:"s","data-test-subj":"transformHealthTabContent"},Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(Vt,{healthStatus:t,compact:!1}),Array.isArray(a)&&a.length>0&&Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(O.EuiInMemoryTable,{"data-test-subj":"transformHealthTabContentIssueTable",items:a,columns:s,compressed:!0,pagination:a.length>10,sorting:{sort:{field:"first_occurrence",direction:"desc"}}})))},ua=({transformsStatsLoading:e})=>{const{euiTheme:t}=Object(O.useEuiTheme)(),a=e?Object(E.jsx)(O.EuiLoadingSpinner,null):Object(E.jsx)(O.EuiFlexItem,{grow:!0},Object(E.jsx)(O.EuiCallOut,{size:"s",color:"warning",iconType:"iInCircle",title:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformList.noStatsAvailable",defaultMessage:"No stats available for this transform."})}));return Object(E.jsx)(O.EuiFlexGroup,{justifyContent:"center",alignItems:"center",css:Object(E.css)({height:t.size.xxxxl},"","")},a)};var ma={name:"e4be8d",styles:"width:100%;.euiTable{background-color:transparent;}"};const fa=({item:e,onAlertEdit:t,transformsStatsLoading:a})=>{var s,r;const{showNodeInfo:n}=Object(Z.b)(),o=[];o.push({title:"ID",description:e.id});const i=Object(j.useMemo)((()=>{var t,a,s,r;const n=[{title:"transform_id",description:e.id},{title:"transform_version",description:null!==(t=e.config.version)&&void 0!==t?t:""},{title:"description",description:null!==(a=e.config.description)&&void 0!==a?a:""},{title:"create_time",description:null!==(s=Object(Yt.a)(1e3*Jt()(e.config.create_time).unix()))&&void 0!==s?s:""},{title:"source_index",description:Array.isArray(e.config.source.index)?e.config.source.index[0]:e.config.source.index},{title:"destination_index",description:e.config.dest.index},{title:"authorization",description:e.config.authorization?JSON.stringify(e.config.authorization):""}];var o,i;return Object(Kt.a)(null===(r=e.config.settings)||void 0===r?void 0:r.num_failure_retries)&&n.push({title:"num_failure_retries",description:null!==(o=null===(i=e.config.settings)||void 0===i?void 0:i.num_failure_retries)&&void 0!==o?o:""}),n}),[null==e?void 0:e.config]),l=[];Object(re.b)(e)&&(o.push({title:"state",description:e.stats.state}),n&&void 0!==e.stats.node&&o.push({title:"node.name",description:e.stats.node.name}),void 0!==e.stats.health&&o.push({title:"health",description:Object(E.jsx)(Vt,{healthStatus:e.stats.health.status})}),void 0!==e.stats.checkpointing.changes_last_detected_at&&l.push({title:"changes_last_detected_at",description:Object(Yt.a)(e.stats.checkpointing.changes_last_detected_at)}),void 0!==e.stats.checkpointing.last&&(l.push({title:"last.checkpoint",description:e.stats.checkpointing.last.checkpoint}),void 0!==e.stats.checkpointing.last.timestamp_millis&&(l.push({title:"last.timestamp",description:Object(Yt.a)(e.stats.checkpointing.last.timestamp_millis)}),l.push({title:"last.timestamp_millis",description:e.stats.checkpointing.last.timestamp_millis}))),void 0!==e.stats.checkpointing.last_search_time&&l.push({title:"last_search_time",description:Object(Yt.a)(e.stats.checkpointing.last_search_time)}),void 0!==e.stats.checkpointing.next&&(l.push({title:"next.checkpoint",description:e.stats.checkpointing.next.checkpoint}),void 0!==e.stats.checkpointing.next.checkpoint_progress&&(l.push({title:"next.checkpoint_progress.total_docs",description:e.stats.checkpointing.next.checkpoint_progress.total_docs}),l.push({title:"next.checkpoint_progress.docs_remaining",description:e.stats.checkpointing.next.checkpoint_progress.docs_remaining}),l.push({title:"next.checkpoint_progress.percent_complete",description:e.stats.checkpointing.next.checkpoint_progress.percent_complete}))),void 0!==e.stats.checkpointing.operations_behind&&l.push({title:"operations_behind",description:e.stats.checkpointing.operations_behind}));const c={title:"State",items:o,position:"right"},u={title:"General",items:i,position:"left"},m=null===(s=e.alerting_rules)||void 0===s?void 0:s.map((e=>({title:Object(E.jsx)(O.EuiButtonEmpty,{iconType:"documentEdit",iconSide:"left",onClick:()=>{t(e)},flush:"left",size:"xs",iconSize:"s"},e.name),description:e.executionStatus.status}))),f={title:"Checkpointing",items:l,position:"right"},b={title:d.i18n.translate("xpack.transform.transformList.transformDetails.alertRulesTitle",{defaultMessage:"Alert rules"}),items:m,position:"right"},p={title:"Stats",items:Object(re.b)(e)?Object.entries(e.stats.stats).map((e=>{return{title:e[0].toString(),description:(t=e[1],"object"==typeof t?JSON.stringify(t):t.toString())};var t})):[],position:"left"},g=Object(Wt.a)(e.id),x=[{id:`transform-details-tab-${g}`,"data-test-subj":"transformDetailsTab",name:d.i18n.translate("xpack.transform.transformList.transformDetails.tabs.transformDetailsLabel",{defaultMessage:"Details"}),content:Object(E.jsx)(Zt,{sections:[u,c,f,...b.items?[b]:[]],dataTestSubj:"transformDetailsTabContent"})},{id:`transform-stats-tab-${g}`,"data-test-subj":"transformStatsTab",name:d.i18n.translate("xpack.transform.transformList.transformDetails.tabs.transformStatsLabel",{defaultMessage:"Stats"}),content:Object(re.b)(e)?Object(E.jsx)(Zt,{sections:[p],dataTestSubj:"transformStatsTabContent"}):Object(E.jsx)(ua,{transformsStatsLoading:a})},{id:`transform-json-tab-${g}`,"data-test-subj":"transformJsonTab",name:"JSON",content:Object(E.jsx)(Xt,{json:e.config})},...null!==(r=e.stats)&&void 0!==r&&r.health?[{id:`transform-health-tab-${g}`,"data-test-subj":"transformHealthTab",name:d.i18n.translate("xpack.transform.transformList.transformDetails.tabs.transformHealthLabel",{defaultMessage:"Health"}),content:Object(E.jsx)(da,{health:e.stats.health})}]:[],{id:`transform-messages-tab-${g}`,"data-test-subj":"transformMessagesTab",name:d.i18n.translate("xpack.transform.transformList.transformDetails.tabs.transformMessagesLabel",{defaultMessage:"Messages"}),content:Object(E.jsx)(na,{transformId:e.id})},{id:`transform-preview-tab-${g}`,"data-test-subj":"transformPreviewTab",name:d.i18n.translate("xpack.transform.transformList.transformDetails.tabs.transformPreviewLabel",{defaultMessage:"Preview"}),content:Object(E.jsx)(ca,{transformConfig:e.config})}];return Object(E.jsx)(O.EuiTabbedContent,{size:"s",tabs:x,initialSelectedTab:x[0],onTabClick:()=>{},expand:!1,css:ma,"data-test-subj":"transformExpandedRowTabbedContent"})},ba=[{type:"field_value_selection",field:"state.state",name:d.i18n.translate("xpack.transform.statusFilter",{defaultMessage:"Status"}),multiSelect:"or",options:Object.values(K.t).map((e=>({value:e,name:e,view:Object(E.jsx)(Ht,{state:e})})))},{type:"field_value_selection",field:"mode",name:d.i18n.translate("xpack.transform.modeFilter",{defaultMessage:"Mode"}),multiSelect:!1,options:Object.values(K.q).map((e=>({value:e,name:e,view:Object(E.jsx)(O.EuiBadge,{className:"transform__TaskModeBadge",color:"hollow"},e)})))},{type:"field_value_selection",field:"health",name:d.i18n.translate("xpack.transform.healthFilter",{defaultMessage:"Health"}),multiSelect:!1,options:Object.values(K.l).map((e=>({value:e,name:e,view:Object(E.jsx)(Vt,{compact:!0,showToolTip:!1,healthStatus:e})})))}];function ja(e,t){return"string"==typeof e&&"string"==typeof t&&null===e.toLowerCase().match(t.toLowerCase())==0}const pa=[10,25,50],ga=({isLoading:e,onCreateTransform:t,transformNodes:a,transforms:s,transformsLoading:r,transformsStatsLoading:n})=>{var o,i,l;const c=Object(B.n)(),{setEditAlertRule:u}=Object(Bt.e)(),[m,f]=Object(j.useState)(),[b,g]=Object(j.useState)([]),[x,h]=Object(j.useState)([]),[T,v]=Object(j.useState)(!1),M=_e(!1,a),y=Me(!1),S=fe(!1,a),k=De(!1),F=Ge(!1),w=qe(!1,a),C=Object(B.t)(),L=!C.canCreateTransform||!C.canPreviewTransform||!C.canStartStopTransform,{sorting:D,pagination:I,onTableChange:A}=function(e,t){const[a,s]=Object(j.useState)({pageIndex:0,pageSize:10,totalItemCount:0,showPerPageOptions:!0,sortField:e,sortDirection:"asc"}),{pageIndex:r,pageSize:n,sortField:o,sortDirection:i}=a;return{onTableChange:({page:t={index:0,size:10},sort:r={field:e,direction:"asc"}})=>{const{index:n,size:o}=t,{field:i,direction:l}=r;s({...a,pageIndex:n,pageSize:o,sortField:i,sortDirection:l})},pagination:{pageIndex:r,pageSize:n,totalItemCount:t.length,pageSizeOptions:pa},sorting:{sort:{field:o,direction:i}}}}(je.c.ID,s),{columns:P,modals:N}=((e,t,a,s,r)=>{const n=r?O.EuiLoadingSpinner:$t,{canStartStopTransform:o}=Object(B.t)(),{actions:i,modals:l}=Rt({forceDisable:s.length>0,transformNodes:a});return{columns:[{name:Object(E.jsx)(O.EuiScreenReaderOnly,null,Object(E.jsx)("p",null,Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformList.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each transform"}))),align:O.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:a=>Object(E.jsx)(O.EuiButtonIcon,{onClick:()=>function(a){const s=e.indexOf(a.config.id);-1!==s?(e.splice(s,1),t([...e])):e.push(a.config.id),t([...e])}(a),"aria-label":e.includes(a.config.id)?d.i18n.translate("xpack.transform.transformList.rowCollapse",{defaultMessage:"Hide details for {transformId}",values:{transformId:a.config.id}}):d.i18n.translate("xpack.transform.transformList.rowExpand",{defaultMessage:"Show details for {transformId}",values:{transformId:a.config.id}}),iconType:e.includes(a.config.id)?"arrowDown":"arrowRight","data-test-subj":"transformListRowDetailsToggle"})},{field:je.c.ID,"data-test-subj":"transformListColumnId",name:"ID",sortable:!0,truncateText:{lines:3},scope:"row",render:(e,t)=>ye(t)?Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)("span",{title:`${e} (${d.i18n.translate("xpack.transform.transformList.managedBadgeLabel",{defaultMessage:"Managed"})})`},e)," ",Object(E.jsx)(O.EuiToolTip,{content:d.i18n.translate("xpack.transform.transformList.managedBadgeTooltip",{defaultMessage:"This transform is preconfigured and managed by Elastic; other parts of the product might have might have dependencies on its behavior."})},Object(E.jsx)(O.EuiBadge,{color:"hollow","data-test-subj":"transformListRowIsManagedBadge"},d.i18n.translate("xpack.transform.transformList.managedBadgeLabel",{defaultMessage:"Managed"})))):Object(E.jsx)("span",{title:e},e)},{id:"alertRule",name:Object(E.jsx)(O.EuiScreenReaderOnly,null,Object(E.jsx)("p",null,Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformList.alertingRules.screenReaderDescription",defaultMessage:"This column displays an icon when there are alert rules associated with a transform"}))),width:"30px",render:e=>{const t=X(e),a=o?d.i18n.translate("xpack.transform.transformList.needsReauthorizationBadge.reauthorizeTooltip",{defaultMessage:"Reauthorize to start transforms."}):d.i18n.translate("xpack.transform.transformList.needsReauthorizationBadge.contactAdminTooltip",{defaultMessage:"Contact your administrator to request the required permissions."}),s=t?Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiToolTip,{content:`${Ut} ${a}`},Object(E.jsx)(O.EuiIcon,{size:"s",color:"warning",type:"alert"}))," "):null,r=Array.isArray(e.alerting_rules)?Object(E.jsx)(O.EuiToolTip,{position:"bottom",content:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformList.alertingRules.tooltipContent",defaultMessage:"Transform has {rulesCount} associated alert {rulesCount, plural, one { rule} other { rules}}",values:{rulesCount:e.alerting_rules.length}})},Object(E.jsx)(O.EuiIcon,{type:"bell"})):Object(E.jsx)("span",null);return Object(E.jsx)(p.a.Fragment,null,s,r)}},{field:je.c.DESCRIPTION,"data-test-subj":"transformListColumnDescription",name:d.i18n.translate("xpack.transform.description",{defaultMessage:"Description"}),sortable:!0,truncateText:{lines:3},render:e=>Object(E.jsx)("span",{title:e},e)},{name:d.i18n.translate("xpack.transform.type",{defaultMessage:"Type"}),"data-test-subj":"transformListColumnType",sortable:e=>e.mode,truncateText:!0,render(e){let t=d.i18n.translate("xpack.transform.type.unknown",{defaultMessage:"unknown"});return!0===Object(Je.c)(e.config)&&(t=d.i18n.translate("xpack.transform.type.pivot",{defaultMessage:"pivot"})),!0===Object(Je.b)(e.config)&&(t=d.i18n.translate("xpack.transform.type.latest",{defaultMessage:"latest"})),Object(E.jsx)(O.EuiBadge,{color:"hollow"},t)},width:"100px"},{name:d.i18n.translate("xpack.transform.status",{defaultMessage:"Status"}),"data-test-subj":"transformListColumnStatus",sortable:e=>{var t;return null===(t=e.stats)||void 0===t?void 0:t.state},truncateText:!0,render:e=>e.stats?Object(E.jsx)(Ht,{state:e.stats.state,reason:e.stats.reason}):Object(E.jsx)(n,null),width:"100px"},{name:d.i18n.translate("xpack.transform.mode",{defaultMessage:"Mode"}),"data-test-subj":"transformListColumnMode",sortable:e=>e.mode,truncateText:!0,render(e){const t=e.mode;return Object(E.jsx)(O.EuiBadge,{color:"hollow"},t)},width:"100px"},{name:d.i18n.translate("xpack.transform.progress",{defaultMessage:"Progress"}),"data-test-subj":"transformListColumnProgress",sortable:e=>Object(je.l)(e)||0,truncateText:!0,render(e){const t=Object(je.l)(e),a=void 0===e.config.sync;return void 0===t&&!0===a?null:e.stats?Object(E.jsx)(O.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},a&&Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiFlexItem,{style:{width:"40px"},grow:!1},Object(E.jsx)(O.EuiProgress,{value:t,max:100,color:"primary",size:"m","data-test-subj":"transformListProgress"},t,"%")),Object(E.jsx)(O.EuiFlexItem,{style:{width:"35px"},grow:!1},Object(E.jsx)(O.EuiText,{size:"xs"},`${t}%`))),!a&&e.stats&&Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiFlexItem,{style:{width:"40px"},grow:!1},e.stats.state!==K.t.STOPPED&&e.stats.state!==K.t.WAITING&&e.stats.state!==K.t.FAILED&&Object(E.jsx)(O.EuiProgress,{color:"primary",size:"m"}),(e.stats.state===K.t.STOPPED||e.stats.state===K.t.WAITING||e.stats.state===K.t.FAILED)&&Object(E.jsx)(O.EuiProgress,{value:0,max:100,color:"primary",size:"m"})),Object(E.jsx)(O.EuiFlexItem,{style:{width:"35px"},grow:!1}," "))):Object(E.jsx)(n,null)},width:"100px"},{name:d.i18n.translate("xpack.transform.health",{defaultMessage:"Health"}),"data-test-subj":"transformListColumnHealth",sortable:e=>{var t;return null===(t=e.stats)||void 0===t?void 0:t.health.status},truncateText:!0,render:e=>e.stats?Object(E.jsx)(Vt,{healthStatus:e.stats.health.status}):Object(E.jsx)(n,null),width:"100px"},{name:d.i18n.translate("xpack.transform.tableActionLabel",{defaultMessage:"Actions"}),actions:i,width:"80px"}],modals:l}})(b,g,a,x,n),z=null!=m&&m.error?null==m?void 0:m.error.message:void 0,R=null!==(o=null==m||null===(i=m.query)||void 0===i||null===(l=i.ast)||void 0===l?void 0:l.clauses)&&void 0!==o?o:[],V=R.length>0?((e,t)=>{const a=e.reduce(((e,t)=>(e[t.id]={transform:t,count:0},e)),{});return t.forEach((t=>{const s="must"===t.match;let r=[];r="term"===t.type?!0===s?e.filter((e=>ja(e.id,t.value)===s||ja(e.config.description,t.value)===s)):e.filter((e=>ja(e.id,t.value)===s&&ja(e.config.description,t.value)===s)):"is"!==t.type&&Array.isArray(t.value)?e.filter((e=>e.stats&&t.value.includes(e.stats.state))):e.filter((e=>{if(!e.stats)return!1;var a;if("field"===t.type&&"health"===t.field)return(null===(a=e.stats.health)||void 0===a?void 0:a.status)===t.value;if("field"===t.type&&"mode"===t.field)return e.mode===t.value;if("field"===t.type&&"type"===t.field){if(t.value===K.k.PIVOT)return Object(Je.c)(e.config);if(t.value===K.k.LATEST)return Object(Je.b)(e.config)}return!1})),r.forEach((e=>a[e.id].count++))})),Object.values(a).filter((e=>(e&&e.count)>=t.length)).map((e=>e.transform))})(s,R):s;if(0===s.length)return Object(E.jsx)(O.EuiPageTemplate.EmptyPrompt,{color:"subdued",title:Object(E.jsx)("h2",null,d.i18n.translate("xpack.transform.list.emptyPromptTitle",{defaultMessage:"No transforms found"})),actions:[Object(E.jsx)(O.EuiButton,{color:"primary",fill:!0,onClick:t,isDisabled:L,"data-test-subj":"transformCreateFirstButton"},d.i18n.translate("xpack.transform.list.emptyPromptButtonText",{defaultMessage:"Create your first transform"}))],"data-test-subj":"transformNoTransformsFound"});const q=function(e,t,a,s){return e.reduce(((e,r)=>{const n=t.find((e=>e.config.id===r));return void 0!==n&&(e[r]=Object(E.jsx)(fa,{item:n,onAlertEdit:a,transformsStatsLoading:s})),e}),{})}(b,s,u,n),H=[Object(E.jsx)("div",{key:"startAction",className:"transform__BulkActionItem"},Object(E.jsx)(O.EuiButtonEmpty,{onClick:()=>M.openModal(x),disabled:Pe(x,C.canStartStopTransform,a)},Object(E.jsx)(Ne,{items:x,transformNodes:a}))),Object(E.jsx)("div",{key:"scheduleNowAction",className:"transform__BulkActionItem"},Object(E.jsx)(O.EuiButtonEmpty,{onClick:()=>w.scheduleNowTransforms(x.map((e=>({id:e.id})))),disabled:Re(x,C.canScheduleNowTransform,a)},Object(E.jsx)(Ve,{items:x,transformNodes:a}))),Object(E.jsx)("div",{key:"stopAction",className:"transform__BulkActionItem"},Object(E.jsx)(O.EuiButtonEmpty,{onClick:()=>{F.openModal(x)},disabled:Ue(x,C.canStartStopTransform,!1)},Object(E.jsx)($e,{items:x}))),Object(E.jsx)("div",{key:"reauthorizeAction",className:"transform__BulkActionItem"},Object(E.jsx)(O.EuiButtonEmpty,{onClick:()=>{S.openModal(x)},disabled:ue(x,C.canStartStopTransform,a)},Object(E.jsx)(me,{items:x,transformNodes:a}))),Object(E.jsx)("div",{key:"resetAction",className:"transform__BulkActionItem"},Object(E.jsx)(O.EuiButtonEmpty,{onClick:()=>{k.openModal(x)},disabled:we(x,!1)},Object(E.jsx)(Le,{canResetTransform:C.canResetTransform,disabled:we(x,!1),isBulkAction:!0,items:x}))),Object(E.jsx)("div",{key:"deleteAction",className:"transform__BulkActionItem"},Object(E.jsx)(O.EuiButtonEmpty,{onClick:()=>y.openModal(x),disabled:Te(x,!1)},Object(E.jsx)(ve,{canDeleteTransform:C.canDeleteTransform,disabled:Te(x,!1),isBulkAction:!0,items:x,forceDisable:!1})))],U=Object(E.jsx)(O.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},Object(E.jsx)(O.EuiFlexItem,null,Object(E.jsx)(ge,{onClick:c,isLoading:e})),Object(E.jsx)(O.EuiFlexItem,null,Object(E.jsx)(pe,{onClick:t,transformNodes:a}))),$={toolsLeft:x.length>0?(()=>{const e=Object(E.jsx)(O.EuiButtonIcon,{size:"s",iconType:"gear",color:"text",onClick:()=>{v(!0)},"aria-label":d.i18n.translate("xpack.transform.multiTransformActionsMenu.managementActionsAriaLabel",{defaultMessage:"Management actions"})}),t=Object(E.jsx)(O.EuiPopover,{key:"bulkActionIcon",id:"transformBulkActionsMenu",button:e,isOpen:T,closePopover:()=>v(!1),panelPaddingSize:"s",anchorPosition:"rightUp"},H);return[Object(E.jsx)(O.EuiTitle,{key:"selectedText",size:"s"},Object(E.jsx)("h3",null,d.i18n.translate("xpack.transform.multiTransformActionsMenu.transformsCount",{defaultMessage:"{count} {count, plural, one {transform} other {transforms}} selected",values:{count:x.length}}))),Object(E.jsx)("div",{key:"bulkActionsBorder",className:"transform__BulkActionsBorder"}),t]})():void 0,toolsRight:U,onChange:f,box:{incremental:!0},filters:ba},G={onSelectionChange:e=>h(e)};return Object(E.jsx)("div",{"data-test-subj":"transformListTableContainer"},M.isModalVisible&&Object(E.jsx)(Be,M),y.isModalVisible&&Object(E.jsx)(ke,y),S.isModalVisible&&Object(E.jsx)(be,S),k.isModalVisible&&Object(E.jsx)(Ie,k),F.isModalVisible&&Object(E.jsx)(zt,F),N,Object(E.jsx)(O.EuiInMemoryTable,{allowNeutralSort:!1,className:"transform__TransformTable",columns:P,error:z,hasActions:!1,isExpandable:!0,isSelectable:!1,items:V,itemId:je.c.ID,itemIdToExpandedRowMap:q,loading:e||r,onTableChange:A,pagination:I,rowProps:e=>({"data-test-subj":`transformListRow row-${e.id}`}),selection:G,sorting:D,search:$,"data-test-subj":"transformListTable "+(e||r?"loading":"loaded")}))},xa=({stat:e})=>Object(E.jsx)("span",{className:"transformStat"},Object(E.jsx)("span",null,e.label),": ",Object(E.jsx)("strong",null,e.value)),Oa=({stats:e,dataTestSub:t})=>{const a=Object(j.useMemo)((()=>Object.values(e)),[e]);return Object(E.jsx)("div",{className:"transformStatsBar","data-test-subj":t},a.filter((e=>e.show)).map((e=>Object(E.jsx)(xa,{key:e.label,stat:e}))))},ha=({transformNodes:e,transformsList:t})=>{const{showNodeInfo:a}=Object(Z.b)(),s=Object(B.n)(),{esNodeRoles:r}=Object(B.d)(),n=function(e,t,a){const s={total:{label:d.i18n.translate("xpack.transform.statsBar.totalTransformsLabel",{defaultMessage:"Total transforms"}),value:0,show:!0},batch:{label:d.i18n.translate("xpack.transform.statsBar.batchTransformsLabel",{defaultMessage:"Batch"}),value:0,show:!0},continuous:{label:d.i18n.translate("xpack.transform.statsBar.continuousTransformsLabel",{defaultMessage:"Continuous"}),value:0,show:!0},failed:{label:d.i18n.translate("xpack.transform.statsBar.failedTransformsLabel",{defaultMessage:"Failed"}),value:0,show:!1},started:{label:d.i18n.translate("xpack.transform.statsBar.startedTransformsLabel",{defaultMessage:"Started"}),value:0,show:!0}};if(a&&(s.nodes={label:d.i18n.translate("xpack.transform.statsBar.transformNodesLabel",{defaultMessage:"Nodes"}),value:e,show:!0}),void 0===t)return s;let r=0,n=0;return t.forEach((e=>{e.mode===K.q.CONTINUOUS&&"number"==typeof s.continuous.value?s.continuous.value++:e.mode===K.q.BATCH&&"number"==typeof s.batch.value&&s.batch.value++,e.stats&&(e.stats.state===K.t.FAILED?r++:e.stats.state===K.t.STARTED&&n++)})),s.total.value=t.length,s.started.value=n,0!==r?(s.failed.value=r,s.failed.show=!0):s.failed.show=!1,s}(e,t,a);return Object(E.jsx)(p.a.Fragment,null,a&&0===e&&Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiCallOut,{title:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformNodes.noTransformNodesCallOutTitle",defaultMessage:"There are no transform nodes available."}),color:"warning",iconType:"warning"},Object(E.jsx)("p",null,Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformNodes.noTransformNodesCallOutBody",defaultMessage:"You will not be able to create or run transforms. {learnMoreLink}",values:{learnMoreLink:Object(E.jsx)(O.EuiLink,{href:r,target:"_blank"},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformNodes.noTransformNodesLearnMoreLinkText",defaultMessage:"Learn more"}))}})),Object(E.jsx)(O.EuiButton,{onClick:()=>s(),size:"s"},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformNodes.noTransformNodesRetryButtonText",defaultMessage:"Retry"}))),Object(E.jsx)(O.EuiSpacer,{size:"s"})),Object(E.jsx)(Oa,{stats:n,dataTestSub:"transformStatsBar"}))},Ta=({text:e,errorMessage:t})=>Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(O.EuiCallOut,{size:"s",title:Object(E.jsx)(p.a.Fragment,null,e," ",null!==t&&Object(E.jsx)(te.a,{inline:!0,forceModal:!0,text:t})),color:"danger",iconType:"error"})),va=()=>{const{esTransform:e}=Object(B.d)(),{showNodeInfo:t}=Object(Z.b)(),{dataViewEditor:a}=Object(Y.a)(),s=Object(B.c)(),{isInitialLoading:r,error:n,data:o=0}=Object(B.j)({enabled:!0}),i=null===n?o:0,{isInitialLoading:l,isLoading:c,error:u,data:{transforms:m,transformIdsWithoutConfig:f}}=Object(B.l)({enabled:!r&&i>0}),{isLoading:b,error:g,data:x}=Object(Q.b)({enabled:!r&&i>0}),h=Object(j.useMemo)((()=>x?m.map((e=>{const t=x.transforms.find((t=>e.config.id===t.id));return a=t,Object(W.a)(a,["state"])&&function(e){return"string"==typeof e&&Object.values(K.t).includes(e)}(a.state)?{...e,stats:t}:e;var a})):m),[x,m]),T=r||l,{canStartStopTransform:v}=Object(B.t)(),M=Object(j.useMemo)((()=>{const e=h.filter((e=>X(e))).length;if(!e)return null;const t=d.i18n.translate("xpack.transform.transformList.unauthorizedTransformsCallout.insufficientPermissionsMsg",{defaultMessage:"{unauthorizedCnt, plural, one {A transform was created with insufficient permissions.} other {# transforms were created with insufficient permissions.}}",values:{unauthorizedCnt:e}}),a=v?d.i18n.translate("xpack.transform.transformList.unauthorizedTransformsCallout.reauthorizeMsg",{defaultMessage:"Reauthorize to start {unauthorizedCnt, plural, one {transform} other {# transforms}}.",values:{unauthorizedCnt:e}}):d.i18n.translate("xpack.transform.transformList.unauthorizedTransformsCallout.contactAdminMsg",{defaultMessage:"Contact your administrator to request the required permissions."});return Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiCallOut,{iconType:"alert",color:"warning","data-test-subj":"transformPageReauthorizeCallout",title:`${t} ${a}`}),Object(E.jsx)(O.EuiSpacer,{size:"s"}))}),[h,v]),[y,S]=Object(j.useState)(!1),[k,F]=Object(j.useState)(null),w=Object(j.useCallback)((()=>S(!1)),[]),C=Object(j.useCallback)(((e,t)=>{F(e)}),[]),L=Boolean(null==a?void 0:a.userPermissions.editDataView()),D=Object(j.useRef)(),I=Object(j.useCallback)((()=>{w(),D.current=null==a?void 0:a.openEditor({onSave:async e=>{e.id&&C(e.id,"index-pattern")},allowAdHocDataView:!0})}),[a,w,C]);if(Object(j.useEffect)((function(){return()=>{D.current&&D.current()}}),[]),null!==k)return Object(E.jsx)(ee.a,{savedObjectId:k});const A=Object(E.jsx)(O.EuiButtonEmpty,{href:e,target:"_blank",iconType:"help","data-test-subj":"documentationLink"},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformList.transformDocsLinkText",defaultMessage:"Transform docs"}));return Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiPageTemplate.Header,{pageTitle:Object(E.jsx)("span",{"data-test-subj":"transformAppTitle"},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformList.transformTitle",defaultMessage:"Transforms"})),description:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.transformList.transformDescription",defaultMessage:"Use transforms to pivot existing Elasticsearch indices into summarized entity-centric indices or to create an indexed view of the latest documents for fast access."}),rightSideItems:[A],bottomBorder:!0,paddingSize:"none"}),Object(E.jsx)(O.EuiPageTemplate.Section,{paddingSize:"none","data-test-subj":"transformPageTransformList"},T&&Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(O.EuiSkeletonText,{lines:2})),!T&&Object(E.jsx)(p.a.Fragment,null,M,t&&null!==n&&Object(E.jsx)(Ta,{text:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.list.transformNodesErrorPromptTitle",defaultMessage:"An error occurred getting the number of transform nodes."}),errorMessage:n}),null!==u&&Object(E.jsx)(Ta,{text:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.list.transformListErrorPromptTitle",defaultMessage:"An error occurred getting the transform list."}),errorMessage:u}),null!==g?Object(E.jsx)(Ta,{text:Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.list.transformStatsErrorPromptTitle",defaultMessage:"An error occurred getting the transform stats."}),errorMessage:g}):null,Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(ha,{transformNodes:i,transformsList:h}),Object(E.jsx)(O.EuiSpacer,{size:"s"}),Object(E.jsx)(Bt.a.Provider,{value:Object(Bt.d)()},f?Object(E.jsx)(p.a.Fragment,null,Object(E.jsx)(O.EuiCallOut,{color:"warning"},Object(E.jsx)("p",null,Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.danglingTasksError",defaultMessage:"{count} {count, plural, one {transform is} other {transforms are}} missing configuration details: [{transformIds}] {count, plural, one {It} other {They}} cannot be recovered and should be deleted.",values:{count:f.length,transformIds:f.join(", ")}})),Object(E.jsx)(O.EuiButton,{color:"warning",size:"s",onClick:()=>s({transformsInfo:f.map((e=>({id:e,state:K.t.FAILED}))),deleteDestIndex:!1,deleteDestDataView:!1,forceDelete:!0})},Object(E.jsx)(_.FormattedMessage,{id:"xpack.transform.forceDeleteTransformMessage",defaultMessage:"Delete {count} {count, plural, one {transform} other {transforms}}",values:{count:f.length}}))),Object(E.jsx)(O.EuiSpacer,null)):null,(i>0||h.length>0)&&Object(E.jsx)(ga,{isLoading:c,onCreateTransform:()=>S(!0),transformNodes:i,transforms:h,transformsLoading:c,transformsStatsLoading:b}),Object(E.jsx)(Bt.c,null)))),y&&Object(E.jsx)(O.EuiModal,{onClose:w,className:"transformCreateTransformSearchDialog","data-test-subj":"transformSelectSourceModal"},Object(E.jsx)(se,{onSearchSelected:C,canEditDataView:L,createNewDataView:I})))},Ma=()=>(Object(j.useEffect)((()=>{f.setBreadcrumbs(m.HOME),b.setTitle("home")}),[]),Object(E.jsx)(H,{requiredCapabilities:"canGetTransform"},Object(E.jsx)(va,null))),ya=({history:e})=>Object(E.jsx)(L,{history:e},Object(E.jsx)(I,null,Object(E.jsx)(F,{path:`/${P.a.CLONE_TRANSFORM}/:transformId`,component:G}),Object(E.jsx)(F,{path:`/${P.a.CREATE_TRANSFORM}/:savedObjectId`,component:J}),Object(E.jsx)(F,{path:"/",component:Ma}))),Sa=(e,t,a)=>{const s=t.i18n.Context,r=new x.QueryClient({defaultOptions:{queries:{staleTime:1/0,retry:!1}}});return Object(g.render)(Object(E.jsx)(O.EuiErrorBoundary,null,Object(E.jsx)(x.QueryClientProvider,{client:r},Object(E.jsx)(A.KibanaThemeProvider,{theme$:t.theme.theme$},Object(E.jsx)(A.KibanaContextProvider,{services:t},Object(E.jsx)(s,null,Object(E.jsx)(Z.a,{enabledFeatures:a},Object(E.jsx)(ya,{history:t.history}))))))),e),()=>{Object(g.unmountComponentAtNode)(e)}},ka=new s.Storage(window.localStorage);async function Ea(e,t,a){const{element:s,setBreadcrumbs:n,history:o}=t,{http:i,getStartServices:l}=e,c=await l(),[d,m]=c,{analytics:j,application:p,chrome:g,docLinks:x,i18n:O,overlays:h,theme:T,savedObjects:v,uiSettings:M,settings:y,notifications:S}=d,{data:k,dataViews:E,dataViewEditor:F,share:w,spaces:C,triggersActionsUi:L,unifiedSearch:D,charts:I,fieldFormats:A,savedObjectsManagement:P,savedSearch:N,contentManagement:_}=m,{docTitle:B}=g;u.init(),b.init(B.change),f.setup(n);const z={analytics:j,application:p,chrome:g,data:k,dataViewEditor:F,dataViews:E,docLinks:x,http:i,i18n:O,notifications:S,overlays:h,theme:T,savedObjects:v,storage:ka,uiSettings:M,settings:y,history:o,savedObjectsPlugin:m.savedObjects,share:w,spaces:C,ml:await Object(r.getMlSharedImports)(),triggersActionsUi:L,unifiedSearch:D,charts:I,fieldFormats:A,savedObjectsManagement:P,savedSearch:N,contentManagement:_},R=Sa(s,z,{showNodeInfo:!a});return()=>{B.reset(),R()}}}}]);