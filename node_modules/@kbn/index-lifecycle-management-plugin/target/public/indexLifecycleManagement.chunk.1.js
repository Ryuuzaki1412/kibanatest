/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.indexLifecycleManagement_bundle_jsonpfunction=window.indexLifecycleManagement_bundle_jsonpfunction||[]).push([[1],Array(38).concat([function(e,t,a){"use strict";var i,l=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),s=[];function o(e){for(var t=-1,a=0;a<s.length;a++)if(s[a].identifier===e){t=a;break}return t}function n(e,t){for(var a={},i=[],l=0;l<e.length;l++){var n=e[l],r=t.base?n[0]+t.base:n[0],c=a[r]||0,d="".concat(r," ").concat(c);a[r]=c+1;var u=o(d),m={css:n[1],media:n[2],sourceMap:n[3]};-1!==u?(s[u].references++,s[u].updater(m)):s.push({identifier:d,updater:x(m,t),references:1}),i.push(d)}return i}function r(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var s=a.nc;s&&(i.nonce=s)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var o=l(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var c,d=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function u(e,t,a,i){var l=a?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=d(t,l);else{var s=document.createTextNode(l),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(s,o[t]):e.appendChild(s)}}function m(e,t,a){var i=a.css,l=a.media,s=a.sourceMap;if(l?e.setAttribute("media",l):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var p=null,h=0;function x(e,t){var a,i,l;if(t.singleton){var s=h++;a=p||(p=r(t)),i=u.bind(null,a,s,!1),l=u.bind(null,a,s,!0)}else a=r(t),i=m.bind(null,a,t),l=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else l()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var a=n(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<a.length;i++){var l=o(a[i]);s[l].references--}for(var r=n(e,t),c=0;c<a.length;c++){var d=o(a[c]);0===s[d].references&&(s[d].updater(),s.splice(d,1))}a=r}}}},function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a,i,l,s=e[1]||"",o=e[3];if(!o)return s;if(t&&"function"==typeof btoa){var n=(a=o,i=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(l," */")),r=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[s].concat(r).concat([n]).join("\n")}return[s].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,i){"string"==typeof e&&(e=[[null,e,""]]);var l={};if(i)for(var s=0;s<this.length;s++){var o=this[s][0];null!=o&&(l[o]=!0)}for(var n=0;n<e.length;n++){var r=[].concat(e[n]);i&&l[r[0]]||(a&&(r[2]?r[2]="".concat(a," and ").concat(r[2]):r[2]=a),t.push(r))}},t}},function(e,t,a){e.exports=a(21)(3)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(29),l=a(7),s=i.__importDefault(a(42));t.default=function(e,t){var a=l.useState(t),i=a[0],o=a[1];return s.default((function(){var t=e.subscribe(o);return function(){return t.unsubscribe()}}),[e]),i}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(7),l="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;t.default=l},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(29),l=a(44),s=i.__importDefault(a(46));t.default=function(e,t){s.default(e,t,l.isDeepEqual)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var i=a(29).__importDefault(a(45));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=i.default},function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var i,l,s;if(Array.isArray(t)){if((i=t.length)!=a.length)return!1;for(l=i;0!=l--;)if(!e(t[l],a[l]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((i=(s=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(l=i;0!=l--;)if(!Object.prototype.hasOwnProperty.call(a,s[l]))return!1;for(l=i;0!=l--;){var o=s[l];if(!("_owner"===o&&t.$$typeof||e(t[o],a[o])))return!1}return!0}return t!=t&&a!=a}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(7);t.default=function(e,t,a){var l=i.useRef(void 0);l.current&&a(t,l.current)||(l.current=t),i.useEffect(e,l.current)}},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(48);case"v8light":return a(50)}},function(e,t,a){var i=a(38),l=a(49);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmPhases [class*=euiTimelineItemIcon-top]{padding-top:16px}.ilmPhases [class*=euiTimelineItemIcon-top]:before{margin-top:32px}",""]),e.exports=t},function(e,t,a){var i=a(38),l=a(51);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmPhases [class*=euiTimelineItemIcon-top]{padding-top:16px}.ilmPhases [class*=euiTimelineItemIcon-top]:before{margin-top:32px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(53);case"v8light":return a(55)}},function(e,t,a){var i=a(38),l=a(54);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmTimeline{overflow:hidden;width:100%}.ilmTimeline__phasesContainer{display:inline-block;margin-top:8px;width:100%}.ilmTimeline__phasesContainer__phase:first-child{padding-left:0;padding-right:8px}.ilmTimeline__phasesContainer__phase:last-child{padding-left:8px;padding-right:0}.ilmTimeline__phasesContainer__phase:only-child{padding-left:0;padding-right:0}.ilmTimeline__phasesContainer__phase{display:inline-block;padding-left:8px;padding-right:8px}.ilmTimeline__deleteIconContainer{background-color:#25262e;border-radius:50%;color:#98a2b3;margin-left:12px;padding:12px}.ilmTimeline__colorBar{border-radius:4px;display:inline-block;height:8px;margin-bottom:4px;margin-top:8px;width:100%}.ilmTimeline__hotPhase{width:var(--ilm-timeline-hot-phase-width)}.ilmTimeline__hotPhase__colorBar{background-color:#e7664c}.ilmTimeline__warmPhase{width:var(--ilm-timeline-warm-phase-width)}.ilmTimeline__warmPhase__colorBar{background-color:#d6bf57}.ilmTimeline__coldPhase{width:var(--ilm-timeline-cold-phase-width)}.ilmTimeline__coldPhase__colorBar{background-color:#6092c0}.ilmTimeline__frozenPhase{width:var(--ilm-timeline-frozen-phase-width)}.ilmTimeline__frozenPhase__colorBar{background-color:#ca8eae}",""]),e.exports=t},function(e,t,a){var i=a(38),l=a(56);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmTimeline{overflow:hidden;width:100%}.ilmTimeline__phasesContainer{display:inline-block;margin-top:8px;width:100%}.ilmTimeline__phasesContainer__phase:first-child{padding-left:0;padding-right:8px}.ilmTimeline__phasesContainer__phase:last-child{padding-left:8px;padding-right:0}.ilmTimeline__phasesContainer__phase:only-child{padding-left:0;padding-right:0}.ilmTimeline__phasesContainer__phase{display:inline-block;padding-left:8px;padding-right:8px}.ilmTimeline__deleteIconContainer{background-color:#f5f7fa;border-radius:50%;color:#69707d;margin-left:12px;padding:12px}.ilmTimeline__colorBar{border-radius:4px;display:inline-block;height:8px;margin-bottom:4px;margin-top:8px;width:100%}.ilmTimeline__hotPhase{width:var(--ilm-timeline-hot-phase-width)}.ilmTimeline__hotPhase__colorBar{background-color:#e7664c}.ilmTimeline__warmPhase{width:var(--ilm-timeline-warm-phase-width)}.ilmTimeline__warmPhase__colorBar{background-color:#d6bf57}.ilmTimeline__coldPhase{width:var(--ilm-timeline-cold-phase-width)}.ilmTimeline__coldPhase__colorBar{background-color:#6092c0}.ilmTimeline__frozenPhase{width:var(--ilm-timeline-frozen-phase-width)}.ilmTimeline__frozenPhase__colorBar{background-color:#ca8eae}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(58);case"v8light":return a(60)}},function(e,t,a){var i=a(38),l=a(59);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".indexLifecycleManagement__phase__dataTierAllocation__controlSection{background-color:#25262e;padding:12px}",""]),e.exports=t},function(e,t,a){var i=a(38),l=a(61);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".indexLifecycleManagement__phase__dataTierAllocation__controlSection{background-color:#f5f7fa;padding:12px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(63);case"v8light":return a(65)}},function(e,t,a){var i=a(38),l=a(64);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmDataTierAllocationField{max-width:400px}",""]),e.exports=t},function(e,t,a){var i=a(38),l=a(66);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmDataTierAllocationField{max-width:400px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(68);case"v8light":return a(70)}},function(e,t,a){var i=a(38),l=a(69);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmSearchableSnapshotField{max-width:400px}",""]),e.exports=t},function(e,t,a){var i=a(38),l=a(71);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmSearchableSnapshotField{max-width:400px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(73);case"v8light":return a(75)}},function(e,t,a){var i=a(38),l=a(74);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmPhaseIcon{align-items:center;background-color:#25262e;border-radius:50%;display:flex;height:32px;justify-content:center;width:32px}.ilmPhaseIcon--disabled{height:16px;margin:8px;width:16px}.ilmPhaseIcon--delete{background-color:#343741}.ilmPhaseIcon__inner--hot{fill:#ff7e62}.ilmPhaseIcon__inner--warm{fill:#f1d86f}.ilmPhaseIcon__inner--cold{fill:#79aad9}.ilmPhaseIcon__inner--frozen{fill:#e4a6c7}.ilmPhaseIcon__inner--delete{fill:#98a2b3}.ilmPhaseIcon__inner--disabled{fill:#535966}",""]),e.exports=t},function(e,t,a){var i=a(38),l=a(76);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmPhaseIcon{align-items:center;background-color:#f5f7fa;border-radius:50%;display:flex;height:32px;justify-content:center;width:32px}.ilmPhaseIcon--disabled{height:16px;margin:8px;width:16px}.ilmPhaseIcon--delete{background-color:#d3dae6}.ilmPhaseIcon__inner--hot{fill:#ff7e62}.ilmPhaseIcon__inner--warm{fill:#f1d86f}.ilmPhaseIcon__inner--cold{fill:#79aad9}.ilmPhaseIcon__inner--frozen{fill:#e4a6c7}.ilmPhaseIcon__inner--delete{fill:#69707d}.ilmPhaseIcon__inner--disabled{fill:#98a2b3}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(78);case"v8light":return a(80)}},function(e,t,a){var i=a(38),l=a(79);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmSettingsAccordion .ilmSettingsButton{color:#36a2ef;padding-bottom:8px;padding-top:8px}",""]),e.exports=t},function(e,t,a){var i=a(38),l=a(81);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmSettingsAccordion .ilmSettingsButton{color:#07c;padding-bottom:8px;padding-top:8px}",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(83);case"v8light":return a(85)}},function(e,t,a){var i=a(38),l=a(84);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmPhaseRequiredBadge{max-width:150px}.ilmPhaseTitle{min-width:100px}",""]),e.exports=t},function(e,t,a){var i=a(38),l=a(86);"string"==typeof(l=l.__esModule?l.default:l)&&(l=[[e.i,l,""]]);i(l,{insert:"head",singleton:!1}),e.exports=l.locals||{}},function(e,t,a){(t=a(39)(!1)).push([e.i,".ilmPhaseRequiredBadge{max-width:150px}.ilmPhaseTitle{min-width:100px}",""]),e.exports=t},function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return ai}));var i=a(7),l=a.n(i),s=a(35),o=a(27),n=a(25),r=a(31),c=a(26),d=a(17),u=a(40),m=a.n(u),p=a(41),h=a.n(p),x=a(0);const g=l.a.createContext(null),b=({children:e,...t})=>{const{navigateToUrl:a,currentAppId:i}=t;return Object(x.jsx)(g.Provider,{value:{navigateToUrl:a,currentAppId:i}},e)},f=({children:e,coreStart:t})=>{const{navigateToUrl:a,currentAppId$:i}=t.application,l=h()(i,void 0);return Object(x.jsx)(g.Provider,{value:{navigateToUrl:a,currentAppId:l}},e)};var j=a(1);a(36);const y={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},v=({children:e,navigateToUrl:t,currentAppId:a,...l})=>{const s=Object(i.useRef)(null),o=Object(i.useCallback)((e=>(({event:e,container:t,navigateToUrl:a,currentAppId:i})=>{if(!t||!i)return;const l=((e,t)=>{let a=e;do{var i,l;if("a"===(null===(i=a)||void 0===i?void 0:i.tagName.toLowerCase()))return a;const e=null===(l=a)||void 0===l?void 0:l.parentElement;if(!e||e===document.body||e===t)break;a=e}while(parent||parent!==document.body||parent!==t)})(e.target,t);if(!l)return;const s=l.href,o=""===l.target||"_self"===l.target,n=0===e.button;s&&o&&n&&!e.defaultPrevented&&!(e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)(e)&&(e.preventDefault(),a(l.href))})({event:e,currentAppId:a,navigateToUrl:t,container:s.current})),[a,t]);return Object(x.jsx)("div",m()({onClick:o,ref:s,css:y,"data-test-subj":"kbnRedirectAppLink"},l),e)},O=({children:e,...t})=>Object(x.jsx)(v,m()({},function(){const e=Object(i.useContext)(g);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t),e),M=({children:e,...t})=>{if(void 0!==t.coreStart){const{coreStart:a,...i}=t,l=Object(x.jsx)(O,i,e);return Object(x.jsx)(f,{coreStart:a},l)}const{navigateToUrl:a,currentAppId:i,...l}=t,s=Object(x.jsx)(O,l,e);return Object(x.jsx)(b,{currentAppId:i,navigateToUrl:a},s)};var P=a(32);const _=()=>Object(o.useKibana)();var T=a(28);const k={services:{}},w=Object(i.createContext)(k);var L=a(43),S=a.n(L);const E=({children:e,component:t,render:a,...s})=>{const o=Object(i.useMemo)((()=>{if(t)return e=>Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(F,null),Object(x.jsx)(t,e))}),[t]);if(o)return Object(x.jsx)(T.Route,m()({},s,{component:o}));if(a||"function"==typeof e){const t="function"==typeof e?e:a;return Object(x.jsx)(T.Route,m()({},s,{render:e=>Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(F,null),t(e))}))}return Object(x.jsx)(T.Route,s,Object(x.jsx)(F,null),e)},F=()=>{const{executionContext:e}=Object(i.useContext)(w).services,t=Object(T.useRouteMatch)();return function(e,t){S()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null};var C=a(33);const z=({children:e,...t})=>Object(x.jsx)(T.Router,t,Object(x.jsx)(C.CompatRouter,null,e));var A=a(10);const I=({legacySwitch:e=!0,children:t})=>{const a=Object(T.useRouteMatch)();return e?Object(x.jsx)(T.Switch,null,t):Object(x.jsx)(C.Routes,null,i.Children.map(t,(e=>{if(l.a.isValidElement(e)&&e.type===E){var i;const s=Object(A.replace)(null==e?void 0:e.props.path,a.url+"/",""),o="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(x.jsx)(C.Route,{path:s,element:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(F,null),(null==e||null===(i=e.props)||void 0===i?void 0:i.component)&&Object(x.jsx)(e.props.component,null)||o&&o()||t)})}return e})))};var D=a(14),N=a(5),R=a(3),U=a(12),B=a(11);const $=e=>{let t="",a="";const i=/(\d+)(\w+)/.exec(e);return i&&(t=i[1],a=i[2]),{size:t,units:a}};var q=a(2),V=(a(47),a(8)),W=a(34);const H=(e={})=>{const{allocate:t,migrate:a}=e;return!1===(null==a?void 0:a.enabled)?"none":t&&(t.require&&Object.keys(t.require).length||t.include&&Object.keys(t.include).length||t.exclude&&Object.keys(t.exclude).length)?"node_attrs":"node_roles"},G=e=>{var t,a,i;const l=null==e||null===(t=e.phases)||void 0===t||null===(a=t.hot)||void 0===a||null===(i=a.actions)||void 0===i?void 0:i.rollover;return Boolean(l&&l.max_age===N.p.max_age&&l.max_docs===N.p.max_docs&&l.max_primary_shard_size===N.p.max_primary_shard_size&&l.max_primary_shard_docs===N.p.max_primary_shard_docs)};var J=a(30),Y=a.n(J);const K=["hot","warm","cold","frozen","delete"],Q=(e,t)=>{var a,i;return{min_age:null!==(a=t.phases)&&void 0!==a&&null!==(i=a[e])&&void 0!==i&&i.min_age?t.phases[e].min_age+t._meta[e].minAgeUnit:"0ms"}},Z=(e,t)=>{let a;return a="micros"===t?parseInt(e,10)/1e3:"nanos"===t?parseInt(e,10)/1e6:Y.a.duration(e,t).asMilliseconds(),a},X=e=>{var t;return 0===e.length?"":Boolean(null===(t=e[0])||void 0===t?void 0:t.snapshot_repository)?e[0].snapshot_repository:X(e.slice(1))},ee="_meta.hot.customRollover.enabled",te="_meta.hot.isUsingDefaultRollover",ae=e=>`_meta.${e}.downsample.enabled`,ie={maxDocs:"phases.hot.actions.rollover.max_docs",maxAge:"phases.hot.actions.rollover.max_age",maxSize:"phases.hot.actions.rollover.max_size",maxPrimaryShardSize:"phases.hot.actions.rollover.max_primary_shard_size",maxPrimaryShardDocs:"phases.hot.actions.rollover.max_primary_shard_docs"},le="found-snapshots",se=[{value:"gb",text:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.gigabytesLabel",{defaultMessage:"gigabytes"})},{value:"mb",text:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.megabytesLabel",{defaultMessage:"megabytes"})},{value:"b",text:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.bytesLabel",{defaultMessage:"bytes"})},{value:"kb",text:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.kilobytesLabel",{defaultMessage:"kilobytes"})},{value:"tb",text:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.terabytesLabel",{defaultMessage:"terabytes"})},{value:"pb",text:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.byteSizeUnits.petabytesLabel",{defaultMessage:"petabytes"})}],oe=[{value:"d",text:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.timeUnits.daysLabel",{defaultMessage:"days"})},{value:"h",text:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.timeUnits.hoursLabel",{defaultMessage:"hours"})},{value:"m",text:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.timeUnits.minutesLabel",{defaultMessage:"minutes"})}],ne=({dataTierAllocationType:e,allocationNodeAttribute:t},a={},i={},l)=>{var s,o;const{allocate:n,migrate:r,...c}=a,d={...c};if(n){const{include:e,exclude:t,require:a,number_of_replicas:i,...l}=n;Object(A.isEmpty)(l)||(d.allocate={...l})}switch(e){case"node_attrs":if(t){const[e,a]=t.split(":");d.allocate={...d.allocate,require:{[e]:a}}}else d.migrate=i.migrate;var u,m;Object(A.isEmpty)(null==i||null===(s=i.allocate)||void 0===s?void 0:s.include)||(d.allocate={...d.allocate,include:{...null==i||null===(u=i.allocate)||void 0===u?void 0:u.include}}),Object(A.isEmpty)(null==i||null===(o=i.allocate)||void 0===o?void 0:o.exclude)||(d.allocate={...d.allocate,exclude:{...null==i||null===(m=i.allocate)||void 0===m?void 0:m.exclude}});break;case"none":d.migrate={...null==i?void 0:i.migrate,enabled:!1}}return null!=l&&(d.allocate={...d.allocate,number_of_replicas:l}),d},re={editPolicy:{shrinkLabel:q.i18n.translate("xpack.indexLifecycleMgmt.shrink.enableShrinkLabel",{defaultMessage:"Shrink index"}),shrinkCountLabel:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.shrink.configureShardCountLabel",{defaultMessage:"Configure shard count"}),shrinkSizeLabel:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.shrink.configureShardSizeLabel",{defaultMessage:"Configure shard size"}),rolloverOffsetsHotPhaseTiming:q.i18n.translate("xpack.indexLifecycleMgmt.rollover.rolloverOffsetsPhaseTimingDescription",{defaultMessage:"How long it takes to reach the rollover criteria in the hot phase can vary."}),searchableSnapshotInHotPhase:{searchableSnapshotDisallowed:{calloutTitle:q.i18n.translate("xpack.indexLifecycleMgmt.searchableSnapshot.disallowedCalloutTitle",{defaultMessage:"Searchable snapshot disabled"}),calloutBody:q.i18n.translate("xpack.indexLifecycleMgmt.searchableSnapshot.disallowedCalloutBody",{defaultMessage:"To use searchable snapshot in this phase you must disable searchable snapshot in the hot phase."})}},forceMergeEnabledFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.forcemerge.enableLabel",{defaultMessage:"Force merge data"}),readonlyEnabledFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.readonlyFieldLabel",{defaultMessage:"Make index read only"}),downsampleEnabledFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.downsampleFieldLabel",{defaultMessage:"Enable downsampling"}),downsampleIntervalFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.downsampleIntervalFieldLabel",{defaultMessage:"Downsampling interval"}),downsampleIntervalFieldUnitsLabel:q.i18n.translate("xpack.indexLifecycleMgmt.downsampleIntervalFieldUnitsLabel",{defaultMessage:"Downsampling interval units"}),maxNumSegmentsFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.forceMerge.numberOfSegmentsLabel",{defaultMessage:"Number of segments"}),indexPriorityFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.indexPriorityLabel",{defaultMessage:"Index priority"}),bestCompressionFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.forcemerge.bestCompressionLabel",{defaultMessage:"Compress stored fields"}),bestCompressionFieldHelpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.forceMerge.bestCompressionText",{defaultMessage:"Use higher compression for stored fields at the cost of slower performance."}),allocationTypeOptionsFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.dataTierAllocation.allocationFieldLabel",{defaultMessage:"Data tier options"}),allocationNodeAttributeFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.dataTierAllocation.nodeAllocationFieldLabel",{defaultMessage:"Select a node attribute"}),searchableSnapshotsRepoFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotRepoFieldLabel",{defaultMessage:"Snapshot repository"}),searchableSnapshotsStorageFieldLabel:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotStorageFieldLabel",{defaultMessage:"Searchable snapshot storage"}),maxPrimaryShardSizeLabel:q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumPrimaryShardSizeLabel",{defaultMessage:"Maximum primary shard size"}),maxPrimaryShardDocsLabel:q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumPrimaryShardDocsLabel",{defaultMessage:"Maximum docs in the primary shard"}),maxPrimaryShardSizeUnitsLabel:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.maximumPrimaryShardSizeAriaLabel",{defaultMessage:"Maximum shard size units"}),errors:{numberRequired:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.numberRequiredErrorMessage",{defaultMessage:"A number is required."}),numberGreatThan0Required:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.numberAboveZeroRequiredError",{defaultMessage:"Only numbers above 0 are allowed."}),integerRequired:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.integerRequiredError",{defaultMessage:"Only integers are allowed."}),maximumAgeRequiredMessage:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.maximumAgeMissingError",{defaultMessage:"A maximum age is required."}),maximumSizeRequiredMessage:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.maximumIndexSizeMissingError",{defaultMessage:"A maximum index size is required."}),maximumDocumentsRequiredMessage:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.maximumDocumentsMissingError",{defaultMessage:"Maximum documents is required."}),maximumPrimaryShardSizeRequiredMessage:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.maximumPrimaryShardSizeMissingError",{defaultMessage:"A maximum primary shard size is required"}),maximumPrimaryShardDocsRequiredMessage:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.maximumPrimaryShardDocsMissingError",{defaultMessage:"Maximum documents in the primary shard is required"}),rollOverConfigurationCallout:{title:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.rolloverConfigurationError.title",{defaultMessage:"Invalid rollover configuration"}),body:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.rolloverConfigurationError.body",{defaultMessage:"A value for one of maximum primary shard size, maximum documents, maximum age or maximum index size is required."})},nonNegativeNumberRequired:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.nonNegativeNumberRequiredError",{defaultMessage:"Only non-negative numbers are allowed."}),policyNameContainsInvalidChars:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.errors.policyNameContainsInvalidCharsError",{defaultMessage:"A policy name cannot contain spaces or commas."}),policyNameAlreadyUsedErrorMessage:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.policyNameAlreadyUsedError",{defaultMessage:"That policy name is already used."}),policyNameMustBeDifferentErrorMessage:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.differentPolicyNameRequiredError",{defaultMessage:"The policy name must be different."}),policyNameRequiredMessage:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.policyNameRequiredError",{defaultMessage:"A policy name is required."}),policyNameStartsWithUnderscoreErrorMessage:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.policyNameStartsWithUnderscoreError",{defaultMessage:"A policy name cannot start with an underscore."}),policyNameTooLongErrorMessage:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.policyNameTooLongError",{defaultMessage:"A policy name cannot be longer than 255 bytes."}),searchableSnapshotRepoRequired:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotRepoRequiredError",{defaultMessage:"A snapshot repository name is required."})},titles:{hot:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.hotPhase.hotPhaseTitle",{defaultMessage:"Hot phase"}),warm:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.warmPhase.warmPhaseTitle",{defaultMessage:"Warm phase"}),cold:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.coldPhase.coldPhaseTitle",{defaultMessage:"Cold phase"}),frozen:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.frozenPhase.frozenPhaseTitle",{defaultMessage:"Frozen phase"}),delete:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.deletePhaseTitle",{defaultMessage:"Delete phase"})},descriptions:{hot:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.hotPhase.hotPhaseDescription",{defaultMessage:"Store your most recent, most frequently-searched data in the hot tier. The hot tier provides the best indexing and search performance by using the most powerful, expensive hardware."}),warm:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.warmPhase.warmPhaseDescription",{defaultMessage:"Move data to the warm tier when you are still likely to search it, but infrequently need to update it. The warm tier is optimized for search performance over indexing performance."}),cold:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.coldPhase.coldPhaseDescription",{defaultMessage:"Move data to the cold tier when you are searching it less often and don’t need to update it. The cold tier is optimized for cost savings over search performance."}),frozen:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.frozenPhase.frozenPhaseDescription",{defaultMessage:"Move data to the frozen tier for long term retention. The frozen tier provides the most cost-effective way store your data and still be able to search it."}),delete:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.deletePhaseDescription",{defaultMessage:"Delete data you no longer need."})}}},{numberGreaterThanField:ce,containsCharsField:de,emptyField:ue,startsWithField:me}=r.fieldValidators,pe=({than:e,message:t})=>a=>{if(a.value)return ce({than:e,message:t})({...a,value:parseInt(a.value,10)})},he=pe({than:0,message:re.editPolicy.errors.numberGreatThan0Required}),xe=pe({than:-1,message:re.editPolicy.errors.nonNegativeNumberRequired}),ge="ROLLOVER_VALUE_REQUIRED_VALIDATION_CODE",be=Object.values(ie),fe=({form:e,path:t})=>{const a=e.getFields();if(!be.some((e=>{var t;return Boolean(null===(t=a[e])||void 0===t?void 0:t.value)}))){const e={code:ge,message:""};switch(t){case ie.maxAge:e.message=re.editPolicy.errors.maximumAgeRequiredMessage;break;case ie.maxDocs:e.message=re.editPolicy.errors.maximumDocumentsRequiredMessage;break;case ie.maxPrimaryShardSize:e.message=re.editPolicy.errors.maximumPrimaryShardSizeRequiredMessage;break;case ie.maxPrimaryShardDocs:e.message=re.editPolicy.errors.maximumPrimaryShardDocsRequiredMessage;break;default:e.message=re.editPolicy.errors.maximumSizeRequiredMessage}return e}be.forEach((e=>{var t;null===(t=a[e])||void 0===t||t.clearErrors(ge)}))},je=e=>{var t;if(!Number.isInteger(Number(null!==(t=e.value)&&void 0!==t?t:"")))return{message:re.editPolicy.errors.integerRequired}},ye=e=>({formData:t})=>{if("warm"===e)return;const a=e=>{const a=t[`_meta.${e}.minAgeToMilliSeconds`];return{milli:a,esFormat:a>=0?t[`phases.${e}.min_age`]+t[`_meta.${e}.minAgeUnit`]:void 0}},i={warm:a("warm"),cold:a("cold"),frozen:a("frozen"),delete:a("delete")},l={greaterThanWarmPhase:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.minAgeSmallerThanWarmPhaseError",{defaultMessage:"Must be greater or equal than the warm phase value ({value})",values:{value:i.warm.esFormat}}),greaterThanColdPhase:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.minAgeSmallerThanColdPhaseError",{defaultMessage:"Must be greater or equal than the cold phase value ({value})",values:{value:i.cold.esFormat}}),greaterThanFrozenPhase:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.minAgeSmallerThanFrozenPhaseError",{defaultMessage:"Must be greater or equal than the frozen phase value ({value})",values:{value:i.frozen.esFormat}})};if("cold"===e)return i.warm.milli>=0&&i.cold.milli<i.warm.milli?{message:l.greaterThanWarmPhase}:void 0;if("frozen"===e)return i.cold.milli>=0&&i.frozen.milli<i.cold.milli?{message:l.greaterThanColdPhase}:i.warm.milli>=0&&i.frozen.milli<i.warm.milli?{message:l.greaterThanWarmPhase}:void 0;if("delete"===e){if(i.frozen.milli>=0&&i.delete.milli<i.frozen.milli)return{message:l.greaterThanFrozenPhase};if(i.cold.milli>=0&&i.delete.milli<i.cold.milli)return{message:l.greaterThanColdPhase};if(i.warm.milli>=0&&i.delete.milli<i.warm.milli)return{message:l.greaterThanWarmPhase}}},ve=e=>({formData:t})=>{if("hot"===e)return;const a=e=>{const a=t[`_meta.${e}.downsample.fixedIntervalSize`],i=t[`_meta.${e}.downsample.fixedIntervalUnits`];return a&&i?{milliseconds:Y.a.duration(a,i).asMilliseconds(),esFormat:a+i}:null},i={hot:a("hot"),warm:a("warm"),cold:a("cold")},l=(e,t)=>e>t&&e%t==0;if("warm"===e&&i.warm&&i.hot&&!l(i.warm.milliseconds,i.hot.milliseconds))return{message:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.downsamplePreviousIntervalWarmPhaseError",{defaultMessage:"Must be greater than and a multiple of the hot phase value ({value})",values:{value:i.hot.esFormat}})};if("cold"===e&&i.cold)if(i.warm){if(!l(i.cold.milliseconds,i.warm.milliseconds))return{message:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.downsamplePreviousIntervalColdPhaseWarmError",{defaultMessage:"Must be greater than and a multiple of the warm phase value ({value})",values:{value:i.warm.esFormat}})}}else if(i.hot&&!l(i.cold.milliseconds,i.hot.milliseconds))return{message:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.downsamplePreviousIntervalColdPhaseHotError",{defaultMessage:"Must be greater than and a multiple of the hot phase value ({value})",values:{value:i.hot.esFormat}})}},Oe=Object.values(ie),{emptyField:Me,numberGreaterThanField:Pe}=r.fieldValidators,_e={stringToNumber:e=>null!=e?parseInt(e,10):void 0},Te={label:re.editPolicy.maxNumSegmentsFieldLabel,validations:[{validator:Me(q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.forcemerge.numberOfSegmentsRequiredError",{defaultMessage:"A value for number of segments is required."}))},{validator:he}],serializer:_e.stringToNumber},ke={snapshot_repository:{label:re.editPolicy.searchableSnapshotsRepoFieldLabel,validations:[{validator:Me(re.editPolicy.errors.searchableSnapshotRepoRequired)}],helpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshot.repositoryHelpText",{defaultMessage:"Each phase uses the same snapshot repository."})},storage:{label:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshot.storageLabel",{defaultMessage:"Storage"}),helpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshot.storageHelpText",{defaultMessage:"Type of snapshot mounted for the searchable snapshot. This is an advanced option. Only change it if you know what you're doing."})}},we={label:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.numberOfReplicasLabel",{defaultMessage:"Number of replicas"}),validations:[{validator:Me(re.editPolicy.errors.numberRequired)},{validator:xe}],serializer:_e.stringToNumber},Le={label:q.i18n.translate("xpack.indexLifecycleMgmt.shrink.numberOfPrimaryShardsLabel",{defaultMessage:"Number of primary shards"}),defaultValue:1,validations:[{validator:Me(re.editPolicy.errors.numberRequired)},{validator:Pe({message:re.editPolicy.errors.numberGreatThan0Required,than:0})}],serializer:_e.stringToNumber},Se={label:re.editPolicy.maxPrimaryShardSizeLabel,validations:[{validator:Me(re.editPolicy.errors.numberRequired)},{validator:Pe({message:re.editPolicy.errors.numberGreatThan0Required,than:0})}],serializer:_e.stringToNumber},Ee=e=>({defaultValue:N.n[e],label:re.editPolicy.indexPriorityFieldLabel,validations:[{validator:Me(re.editPolicy.errors.numberRequired)},{validator:xe}],serializer:_e.stringToNumber}),Fe=(e,t)=>({defaultValue:t,fieldsToValidateOnChange:[],validations:[{validator:Me(re.editPolicy.errors.numberRequired)},{validator:xe},{validator:je},{validator:ye(e)}]}),Ce=(e,t=!0)=>{const a=["hot","warm","cold"];return(i=e,a.slice(a.indexOf(i)+(t?0:1))).map((e=>`_meta.${e}.downsample.fixedIntervalSize`));var i},ze=e=>({enabled:{defaultValue:!1,label:re.editPolicy.downsampleEnabledFieldLabel,fieldsToValidateOnChange:Ce(e,!1)},fixedIntervalSize:{label:re.editPolicy.downsampleIntervalFieldLabel,fieldsToValidateOnChange:Ce(e),validations:[{validator:Me(re.editPolicy.errors.numberRequired)},{validator:he},{validator:je},{validator:ve(e)}]},fixedIntervalUnits:{defaultValue:"d",fieldsToValidateOnChange:Ce(e)}}),Ae=Object(i.createContext)(null),Ie="phases.hot.actions.searchable_snapshot.snapshot_repository",De="phases.cold.actions.searchable_snapshot.snapshot_repository",Ne=({children:e})=>{const[t]=Object(n.useFormData)({watch:[Ie,De,ee,te,ae("hot"),ae("warm"),ae("cold")]}),a=Object(A.get)(t,te),i=Object(A.get)(t,ee,!0),l={isUsingRollover:!1!==a||i,isUsingSearchableSnapshotInHotPhase:null!=Object(A.get)(t,Ie),isUsingSearchableSnapshotInColdPhase:null!=Object(A.get)(t,De),isUsingDownsampleInHotPhase:!!Object(A.get)(t,ae("hot")),isUsingDownsampleInWarmPhase:!!Object(A.get)(t,ae("warm")),isUsingDownsampleInColdPhase:!!Object(A.get)(t,ae("cold"))};return Object(x.jsx)(Ae.Provider,{value:l},e)},Re=()=>{const e=Object(i.useContext)(Ae);if(!e)throw new Error("Cannot use configuration outside of configuration context");return e},Ue=Object(i.createContext)(null),Be=()=>({hasErrors:!1,hot:{},warm:{},cold:{},frozen:{},delete:{},other:{}}),$e=({children:e})=>{const[t,a]=Object(i.useState)(Be),l=Object(n.useFormContext)(),{getErrors:s,isSubmitted:o}=l,r=Object(i.useCallback)(((e,t,i)=>{a((a=>({...a,hasErrors:!0,[e]:{...a[e],[t]:i}})))}),[a]),c=Object(i.useCallback)(((e,t)=>{s().length?a((a=>{const{[e]:{[t]:i,...l},hasErrors:s,...o}=a,n=Object.keys(l).length>0||Object.values(o).some((e=>Object.keys(e).length>0));return{...a,hasErrors:n,[e]:l}})):a(Be)}),[s,a]);return Object(x.jsx)(Ue.Provider,{value:{errors:t,addError:r,clearError:c,isFormSubmitted:o}},e)},qe=()=>{const e=Object(i.useContext)(Ue);if(!e)throw new Error("useFormErrorsContext can only be used inside of FormErrorsProvider");return e},Ve=e=>{var t,a,i,l,s,o;const n=null==e||null===(t=e._meta)||void 0===t||null===(a=t.warm)||void 0===a?void 0:a.enabled,r=null==e||null===(i=e._meta)||void 0===i||null===(l=i.cold)||void 0===l?void 0:l.enabled,c=null==e||null===(s=e._meta)||void 0===s||null===(o=s.frozen)||void 0===o?void 0:o.enabled;return{hot:{isFinalDataPhase:!n&&!r&&!c},warm:{isFinalDataPhase:n&&!r&&!c},cold:{isFinalDataPhase:r&&!c},frozen:{isFinalDataPhase:c}}},We=Object(i.createContext)(null),He=({children:e})=>{const{deleteEnabled:t}=Qe(),[a]=Object(n.useFormData)({watch:["_meta.warm.enabled","_meta.cold.enabled","_meta.frozen.enabled","_meta.delete.enabled"]});return Object(x.jsx)(We.Provider,{value:{...Ve(a),isDeletePhaseEnabled:t.value,setDeletePhaseEnabled:t.setValue}},e)},Ge=()=>{const e=Object(i.useContext)(We);if(!e)throw new Error("Cannot use phase timings outside of phase timings context");return e},Je=Object(i.createContext)(null),Ye={deleteEnabled:{path:"_meta.delete.enabled"},searchableSnapshotRepo:{path:"_meta.searchableSnapshot.repository"},warmMinAgeMilliSeconds:{path:"_meta.warm.minAgeToMilliSeconds"},coldMinAgeMilliSeconds:{path:"_meta.cold.minAgeToMilliSeconds"},frozenMinAgeMilliSeconds:{path:"_meta.frozen.minAgeToMilliSeconds"},deleteMinAgeMilliSeconds:{path:"_meta.delete.minAgeToMilliSeconds"},hotIsUsingShardSize:{path:"_meta.hot.shrink.isUsingShardSize"},warmIsUsingShardSize:{path:"_meta.warm.shrink.isUsingShardSize"}},Ke=({children:e})=>Object(x.jsx)(n.UseMultiFields,{fields:Ye},(t=>Object(x.jsx)(Je.Provider,{value:t},e))),Qe=()=>{const e=Object(i.useContext)(Je);if(!e)throw new Error("Cannot use global fields outside of global fields context");return e},Ze=({form:e,children:t})=>Object(x.jsx)(n.Form,{form:e},Object(x.jsx)(Ne,null,Object(x.jsx)($e,null,Object(x.jsx)(Ke,null,Object(x.jsx)(He,null,t))))),Xe=e=>t=>t.startsWith(`phases.${e}`)||t.startsWith(`_meta.${e}`),et=Xe("hot"),tt=Xe("warm"),at=Xe("cold"),it=Xe("frozen"),lt=Xe("delete"),st=e=>{const{path:t}=e,a=Object(i.useRef)(!1),l=Object(i.useMemo)((()=>{return et(e=t)?"hot":tt(e)?"warm":at(e)?"cold":it(e)?"frozen":lt(e)?"delete":"other";var e}),[t]),{addError:s,clearError:o}=qe(),r=Object(i.useCallback)((e=>{a.current&&(e?s(l,t,e):o(l,t))}),[l,t,s,o]);return Object(i.useEffect)((()=>(a.current=!0,()=>{a.current=!1})),[]),Object(i.useEffect)((()=>()=>{!1===a.current&&o(l,t)}),[l,t,o]),Object(x.jsx)(n.UseField,m()({},e,{onError:r}))};var ot=a(9),nt=a(15);const rt=({docPath:e,text:t})=>{const a=t||Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.learnMore",defaultMessage:"Learn more"});return Object(x.jsx)(j.EuiLink,{href:e,target:"_blank",external:!0},a)},ct=()=>Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.optionalMessage",defaultMessage:" (optional)"}),dt=({policyName:e,close:t})=>{const[a,s]=Object(i.useState)(void 0),{validate:o,getErrors:r}=Object(n.useFormContext)(),[,c]=Object(n.useFormData)(),d=Object(i.useCallback)((async()=>{s(void 0);const e=await o(),t=r(),a=1===t.length&&t[0]===re.editPolicy.errors.policyNameRequiredMessage;var i;s(e||a?{phases:{hot:(i=c()).phases.hot,warm:i.phases.warm,cold:i.phases.cold,frozen:i.phases.frozen,delete:i.phases.delete},_meta:i._meta}:null)}),[s,c,o,r]);let u;switch(Object(i.useEffect)((()=>{d()}),[d]),a){case void 0:u=Object(x.jsx)(j.EuiLoadingSpinner,null);break;case null:u=Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"policyRequestInvalidAlert",iconType:"warning",color:"danger",title:q.i18n.translate("xpack.indexLifecycleMgmt.policyJsonFlyout.validationErrorCallout.title",{defaultMessage:"Invalid policy"})},q.i18n.translate("xpack.indexLifecycleMgmt.policyJsonFlyout.validationErrorCallout.body",{defaultMessage:"To view the JSON for this policy address all validation errors."}));break;default:const t=`PUT _ilm/policy/${e||"<policyName>"}\n${JSON.stringify({policy:{...a}},null,2)}`;u=Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiText,null,Object(x.jsx)("p",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyJsonFlyout.descriptionText",defaultMessage:"This Elasticsearch request will create or update this index lifecycle policy."}))),Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(j.EuiCodeBlock,{language:"json",isCopyable:!0,"data-test-subj":"policyRequestJson"},t))}return Object(x.jsx)(j.EuiFlyout,{maxWidth:480,onClose:t},Object(x.jsx)(j.EuiFlyoutHeader,null,Object(x.jsx)(j.EuiTitle,null,Object(x.jsx)("h2",null,e?Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyJsonFlyout.namedTitle",defaultMessage:"Request for '{policyName}'",values:{policyName:e}}):Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyJsonFlyout.unnamedTitle",defaultMessage:"Request"})))),Object(x.jsx)(j.EuiFlyoutBody,null,u),Object(x.jsx)(j.EuiFlyoutFooter,null,Object(x.jsx)(j.EuiButtonEmpty,{iconType:"cross",onClick:t,flush:"left","data-test-subj":"policyRequestClose"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyJsonFlyout.closeButtonLabel",defaultMessage:"Close"}))))},ut=({children:e,switchProps:t,description:a,fieldNotices:s,...o})=>{var n;if(t&&"boolean"!=typeof t.checked&&"boolean"!=typeof t.initialValue)throw new Error("Must specify controlled, uncontrolled component. See SwitchProps interface!");const[r,c]=Object(i.useState)((()=>{var e;return null!==(e=null==t?void 0:t.initialValue)&&void 0!==e&&e})),d=Boolean(void 0===t||(null!==(n=null==t?void 0:t.checked)&&void 0!==n?n:r));return Object(x.jsx)(j.EuiDescribedFormGroup,m()({},o,{description:Object(x.jsx)(l.a.Fragment,null,a,Object(x.jsx)(j.EuiSpacer,{size:"m"}),(()=>{if(!t)return null;const{onChange:e,checked:a,initialValue:i,...l}=t;return Object(x.jsx)(j.EuiSwitch,m()({},l,{checked:d,onChange:t=>{const a=t.target.checked;c(a),e&&e(a)}}))})(),s)}),d?"function"==typeof e?e():e:null)},mt=({switchProps:e,...t})=>Object(x.jsx)(st,{path:e.path},(a=>Object(x.jsx)(ut,m()({},t,{switchProps:{...e,label:a.label,checked:a.value,onChange:a.setValue}})))),pt=e=>{const{title:t,body:a,resendRequest:i}=e;return Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"m"}),Object(x.jsx)(j.EuiCallOut,{"data-test-subj":e["data-test-subj"],iconType:"help",color:"warning",title:Object(x.jsx)(l.a.Fragment,null,t,Object(x.jsx)(j.EuiButtonIcon,{size:"s",color:"warning",onClick:i,iconType:"refresh","aria-label":e["aria-label"]}))},a))},ht=({phaseName:e,durationInPhase:t})=>Object(x.jsx)(j.EuiFlexGroup,{alignItems:"center",justifyContent:"flexStart",gutterSize:"s"},Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiText,{size:"s"},Object(x.jsx)("strong",null,e))),Object(x.jsx)(j.EuiFlexItem,{grow:!1},"string"==typeof t?Object(x.jsx)(j.EuiText,{size:"s"},t):t));a(52);const xt=e=>null!=e,gt=(e,t)=>e/t*100,bt=(e,t)=>isFinite(e)?0===t?100:gt(e,t):100,ft={title:q.i18n.translate("xpack.indexLifecycleMgmt.timeline.title",{defaultMessage:"Policy summary"}),description:q.i18n.translate("xpack.indexLifecycleMgmt.timeline.description",{defaultMessage:"This policy moves data through the following phases."}),hotPhase:q.i18n.translate("xpack.indexLifecycleMgmt.timeline.hotPhaseSectionTitle",{defaultMessage:"Hot phase"}),warmPhase:q.i18n.translate("xpack.indexLifecycleMgmt.timeline.warmPhaseSectionTitle",{defaultMessage:"Warm phase"}),coldPhase:q.i18n.translate("xpack.indexLifecycleMgmt.timeline.coldPhaseSectionTitle",{defaultMessage:"Cold phase"}),frozenPhase:q.i18n.translate("xpack.indexLifecycleMgmt.timeline.frozenPhaseSectionTitle",{defaultMessage:"Frozen phase"}),deleteIcon:{toolTipContent:q.i18n.translate("xpack.indexLifecycleMgmt.timeline.deleteIconToolTipContent",{defaultMessage:"Policy deletes the index after lifecycle phases complete."})},foreverIcon:{ariaLabel:q.i18n.translate("xpack.indexLifecycleMgmt.timeline.foreverIconToolTipContent",{defaultMessage:"Forever"})}},jt=Object(i.memo)((({hasDeletePhase:e,isUsingRollover:t,...a})=>{const i={hot:{min_age:a.hotPhaseMinAge},warm:a.warmPhaseMinAge?{min_age:a.warmPhaseMinAge}:void 0,cold:a.coldPhaseMinAge?{min_age:a.coldPhaseMinAge}:void 0,frozen:a.frozenPhaseMinAge?{min_age:a.frozenPhaseMinAge}:void 0,delete:a.deletePhaseMinAge?{min_age:a.deletePhaseMinAge}:void 0},l=(s=i,K.reduce(((e,t,a)=>{var i;if("delete"===t)return e;if(!s[t])return e;const l=K.slice(a+1).find((e=>Boolean(s[e])));let o=1/0;if(l&&null!==(i=s[l])&&void 0!==i&&i.min_age){const{units:e,size:t}=$(s[l].min_age);o=Z(t,e)}return{total:Math.max(e.total,o),phases:{...e.phases,[t]:Math.max(o-e.total,0)}}}),{total:0,phases:{hot:0,warm:s.warm?0:void 0,cold:s.cold?0:void 0,frozen:s.frozen?0:void 0}}));var s;const o=(e=>{const t=bt(e.phases.hot,e.total)+50,a=null!=e.phases.warm?bt(e.phases.warm,e.total)+50:0,i=null!=e.phases.cold?bt(e.phases.cold,e.total)+50:0,l=null!=e.phases.frozen?bt(e.phases.frozen,e.total)+50:0,s=t+a+i+l;return{hot:`${gt(t,s)}%`,warm:`${gt(a,s)}%`,cold:`${gt(i,s)}%`,frozen:`${gt(l,s)}%`}})(l),n=e=>l.phases[e]===1/0?Object(x.jsx)(kt,{color:"subdued","aria-label":ft.foreverIcon.ariaLabel}):null,{docLinks:r}=_().services;return Object(x.jsx)(j.EuiFlexGroup,{gutterSize:"s",direction:"column",responsive:!1},Object(x.jsx)(j.EuiFlexItem,null,Object(x.jsx)(j.EuiTitle,{size:"s"},Object(x.jsx)("h2",null,ft.title)),Object(x.jsx)(j.EuiText,{size:"s",color:"subdued"},ft.description," ",Object(x.jsx)(rt,{docPath:r.links.elasticsearch.ilmPhaseTransitions,text:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.learnAboutTimingText",defaultMessage:"Learn about timing"})}))),Object(x.jsx)(j.EuiFlexItem,null,Object(x.jsx)("div",{className:"ilmTimeline",ref:e=>{var t,a,i;e&&(e.style.setProperty("--ilm-timeline-hot-phase-width",o.hot),e.style.setProperty("--ilm-timeline-warm-phase-width",null!==(t=o.warm)&&void 0!==t?t:null),e.style.setProperty("--ilm-timeline-cold-phase-width",null!==(a=o.cold)&&void 0!==a?a:null),e.style.setProperty("--ilm-timeline-frozen-phase-width",null!==(i=o.frozen)&&void 0!==i?i:null))}},Object(x.jsx)(j.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",responsive:!1},Object(x.jsx)(j.EuiFlexItem,null,Object(x.jsx)("div",{className:"ilmTimeline__phasesContainer"},Object(x.jsx)("div",{"data-test-subj":"ilmTimelinePhase-hot",className:"ilmTimeline__phasesContainer__phase ilmTimeline__hotPhase"},Object(x.jsx)("div",{className:"ilmTimeline__colorBar ilmTimeline__hotPhase__colorBar"}),Object(x.jsx)(ht,{phaseName:ft.hotPhase,durationInPhase:n("hot")})),xt(l.phases.warm)&&Object(x.jsx)("div",{"data-test-subj":"ilmTimelinePhase-warm",className:"ilmTimeline__phasesContainer__phase ilmTimeline__warmPhase"},Object(x.jsx)("div",{className:"ilmTimeline__colorBar ilmTimeline__warmPhase__colorBar"}),Object(x.jsx)(ht,{phaseName:ft.warmPhase,durationInPhase:n("warm")})),xt(l.phases.cold)&&Object(x.jsx)("div",{"data-test-subj":"ilmTimelinePhase-cold",className:"ilmTimeline__phasesContainer__phase ilmTimeline__coldPhase"},Object(x.jsx)("div",{className:"ilmTimeline__colorBar ilmTimeline__coldPhase__colorBar"}),Object(x.jsx)(ht,{phaseName:ft.coldPhase,durationInPhase:n("cold")})),xt(l.phases.frozen)&&Object(x.jsx)("div",{"data-test-subj":"ilmTimelinePhase-frozen",className:"ilmTimeline__phasesContainer__phase ilmTimeline__frozenPhase"},Object(x.jsx)("div",{className:"ilmTimeline__colorBar ilmTimeline__frozenPhase__colorBar"}),Object(x.jsx)(ht,{phaseName:ft.frozenPhase,durationInPhase:n("frozen")})))),e&&Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)("div",{"data-test-subj":"ilmTimelinePhase-delete",className:"ilmTimeline__deleteIconContainer"},Object(x.jsx)(j.EuiIconTip,{type:"trash",content:ft.deleteIcon.toolTipContent})))))))})),yt=()=>{var e,t,a,i,l,s;const[o]=Object(n.useFormData)(),r=(e=>{var t;const{_meta:a}=e;return a?{hot:{min_age:void 0},warm:a.warm.enabled?Q("warm",e):void 0,cold:a.cold.enabled?Q("cold",e):void 0,frozen:null!==(t=a.frozen)&&void 0!==t&&t.enabled?Q("frozen",e):void 0,delete:a.delete.enabled?Q("delete",e):void 0}:{hot:{min_age:void 0}}})(o),{isUsingRollover:c}=Re();return Object(x.jsx)(jt,{hotPhaseMinAge:r.hot.min_age,warmPhaseMinAge:null===(e=r.warm)||void 0===e?void 0:e.min_age,coldPhaseMinAge:null===(t=r.cold)||void 0===t?void 0:t.min_age,frozenPhaseMinAge:null===(a=r.frozen)||void 0===a?void 0:a.min_age,deletePhaseMinAge:null===(i=r.delete)||void 0===i?void 0:i.min_age,isUsingRollover:c,hasDeletePhase:Boolean(null===(l=o._meta)||void 0===l||null===(s=l.delete)||void 0===s?void 0:s.enabled)})},vt={callout:{title:q.i18n.translate("xpack.indexLifecycleMgmt.policyErrorCalloutTitle",{defaultMessage:"This policy contains errors"}),body:q.i18n.translate("xpack.indexLifecycleMgmt.policyErrorCalloutDescription",{defaultMessage:"Please fix all errors before saving the policy."})}},Ot=()=>{const{errors:{hasErrors:e},isFormSubmitted:t}=qe();return t&&e?Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"policyFormErrorsCallout",color:"danger",title:vt.callout.title},vt.callout.body),Object(x.jsx)(j.EuiSpacer,null)):null},Mt=e=>Object(x.jsx)("svg",m()({viewBox:"0 0 16 16","aria-hidden":"true",xmlns:"http://www.w3.org/2000/svg",fill:"none"},e),Object(x.jsx)("defs",null),Object(x.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M5.44354 9.86928c-.47429.46802-1.12585.75702-1.84475.75702-1.45038 0-2.626143-1.17576-2.626143-2.62614S2.14841 5.37401 3.59879 5.37401c.71899 0 1.37049.28893 1.84473.75702l.00033-.00033.27438.27438L7.31327 8.0001l-.00001.00001.68777.68777.00001-.00002 1.86843 1.86844-.00078.0007c.65021.6442 1.54481 1.042 2.53251 1.042C14.3888 11.599 16 9.98772 16 8.00016s-1.6112-3.59879-3.5988-3.59879c-.9876 0-1.8822.39779-2.53249 1.04188l.00072.00073-.76518.76516.68777.68777.79978-.79975-.0002-.00017c.471-.44801 1.1082-.72298 1.8096-.72298 1.4504 0 2.6262 1.17577 2.6262 2.62615s-1.1758 2.62614-2.6262 2.62614c-.7012 0-1.3384-.2749-1.8094-.72282l.0002-.00024L8.68881 8.0001l.00278-.00277-.68777-.68777-.00278.00278-1.90297-1.90295-.0007.0007c-.64728-.62456-1.52806-1.00872-2.49858-1.00872C1.61124 4.40137 0 6.0126 0 8.00016 0 9.98772 1.61124 11.599 3.59879 11.599c.97055 0 1.85122-.3841 2.49844-1.0086l.00065.0006.80272-.8027-.68777-.68777-.76902.76901-.00027-.00026z"})),Pt=q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseTiming.beforeDeleteDescription",{defaultMessage:"Delete data after this phase"}),_t=q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseTiming.foreverTimingDescription",{defaultMessage:"Keep data in this phase forever"}),Tt=({phase:e})=>{const{isDeletePhaseEnabled:t,setDeletePhaseEnabled:a,[e]:i}=Ge();if(!i.isFinalDataPhase)return null;const l=t?"ilmEnableDeletePhaseButton":"ilmDisableDeletePhaseButton",s=[{id:"ilmDisableDeletePhaseButton",label:_t,iconType:Mt},{id:"ilmEnableDeletePhaseButton",label:Pt,iconType:"trash","data-test-subj":"enableDeletePhaseButton"}];return Object(x.jsx)(j.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!0},Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiText,{size:"s",color:"subdued"},t?Pt:_t)),Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiButtonGroup,{legend:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.buttonGroupLegend",{defaultMessage:"Enable or disable delete phase"}),options:s,idSelected:l,onChange:e=>{a("ilmEnableDeletePhaseButton"===e)},isIconOnly:!0})))},kt=e=>Object(x.jsx)(j.EuiIcon,m()({type:Mt},e)),wt=Object(i.createContext)(null),Lt=({value:e,children:t})=>Object(x.jsx)(wt.Provider,{value:e},t),St=()=>{const e=Object(i.useContext)(wt);if(!e)throw new Error("useEditPolicyContext can only be called inside of EditPolicyContext!");return e};var Et=a(13),Ft=a(18);const Ct=({policyName:e,indexTemplates:t,close:a})=>{const{services:{getUrlForApp:i}}=_();return Object(x.jsx)(j.EuiFlyout,{onClose:a},Object(x.jsx)(j.EuiFlyoutHeader,{hasBorder:!0},Object(x.jsx)(j.EuiTitle,{size:"m","data-test-subj":"indexTemplatesFlyoutHeader"},Object(x.jsx)("h2",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.indexTemplatesFlyout.headerText",defaultMessage:"Index templates that apply {policyName}",values:{policyName:e}})))),Object(x.jsx)(j.EuiFlyoutBody,null,Object(x.jsx)(j.EuiInMemoryTable,{pagination:!0,items:null!=t?t:[],columns:[{name:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.indexTemplatesTable.nameHeader",{defaultMessage:"Index template name"}),render:e=>{return Object(x.jsx)(j.EuiLink,{"data-test-subj":"indexTemplateLink",className:"eui-textBreakAll",href:(t=e,i("management",{path:`data/index_management${Object(Ft.getTemplateDetailsLink)(t)}`}))},e);var t}}]})),Object(x.jsx)(j.EuiFlyoutFooter,null,Object(x.jsx)(j.EuiButtonEmpty,{iconType:"cross",onClick:a,flush:"left"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexTemplatesFlyout.closeButtonLabel",defaultMessage:"Close"}))))},zt=()=>{var e;const{isNewPolicy:t,indices:a,indexTemplates:s,policyName:o,policy:n}=St(),{services:{getUrlForApp:r}}=_(),[c,d]=Object(i.useState)(!1);if(t)return null;const u=a.length>0?Object(x.jsx)(j.EuiLink,{"data-test-subj":"linkedIndicesLink",external:!0,href:Object(Et.b)(null!=o?o:"",r),target:"_blank"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.linkedIndices",defaultMessage:"{indicesCount, plural, one {# linked index} other {# linked indices}}",values:{indicesCount:a.length}})):null,m=s.length>0?Object(x.jsx)(j.EuiLink,{"data-test-subj":"linkedIndexTemplatesLink",onClick:()=>d(!c)},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.linkedIndexTemplates",defaultMessage:"{indexTemplatesCount, plural, one {# linked index template} other {# linked index templates}}",values:{indexTemplatesCount:s.length}})):null,p=u?Object(x.jsx)(l.a.Fragment,null,u,m?Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.andDependenciesLink",defaultMessage:" and {indexTemplatesLink}",values:{indexTemplatesLink:m}}):null):m,h=null==n||null===(e=n._meta)||void 0===e?void 0:e.managed;return Object(x.jsx)(l.a.Fragment,null,c&&Object(x.jsx)(Ct,{policyName:null!=o?o:"",indexTemplates:s,close:()=>d(!1)}),Object(x.jsx)(j.EuiText,{"data-test-subj":"editWarning"},h&&Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiCallOut,{title:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicyModal.proceedWithCautionCallOutTitle",defaultMessage:"Editing a managed policy can break Kibana"}),color:"danger",iconType:"warning","data-test-subj":"editManagedPolicyCallOut"},Object(x.jsx)("p",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicyModal.proceedWithCautionCallOutDescription",defaultMessage:"Managed policies are critical for internal operations."}))),Object(x.jsx)(j.EuiSpacer,null)),Object(x.jsx)("p",null,Object(x.jsx)("strong",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.editingExistingPolicyMessage",defaultMessage:"You are editing an existing policy."})),p?Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.dependenciesMessage",defaultMessage:" Any changes you make will affect {dependenciesLinks} that {count, plural, one {is} other {are}} attached to this policy.",values:{dependenciesLinks:p,count:a.length+s.length}}):null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.saveAsNewMessage",defaultMessage:" Alternatively, you can save these changes in a new policy."}))))},At=({close:e,selectedNodeAttrs:t})=>{const{data:a,isLoading:i,error:l,resendRequest:s}=Object(B.i)(t);let o;if(i)o=Object(x.jsx)(j.EuiSkeletonText,{lines:3});else if(l){const{statusCode:e,message:t}=l;o=Object(x.jsx)(j.EuiCallOut,{title:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.nodeDetailsLoadingFailedTitle",defaultMessage:"Unable to load node attribute details"}),color:"danger"},Object(x.jsx)("p",null,t," (",e,")"),Object(x.jsx)(j.EuiButton,{onClick:s,iconType:"refresh",color:"danger"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.nodeDetailsReloadButton",defaultMessage:"Try again"})))}else o=Object(x.jsx)(j.EuiInMemoryTable,{items:a||[],columns:[{field:"nodeId",name:q.i18n.translate("xpack.indexLifecycleMgmt.nodeAttrDetails.idField",{defaultMessage:"ID"})},{field:"stats.name",name:q.i18n.translate("xpack.indexLifecycleMgmt.nodeAttrDetails.nameField",{defaultMessage:"Name"})},{field:"stats.host",name:q.i18n.translate("xpack.indexLifecycleMgmt.nodeAttrDetails.hostField",{defaultMessage:"Host"})}],pagination:!0,sorting:!0});return Object(x.jsx)(j.EuiPortal,null,Object(x.jsx)(j.EuiFlyout,{ownFocus:!0,onClose:e},Object(x.jsx)(j.EuiFlyoutBody,null,Object(x.jsx)(j.EuiTitle,null,Object(x.jsx)("h2",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.nodeAttrDetails.title",defaultMessage:"Nodes that contain the attribute {selectedNodeAttrs}",values:{selectedNodeAttrs:t}}))),Object(x.jsx)(j.EuiSpacer,{size:"s"}),o)))},It={allocateToDataNodesOption:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.nodeAllocation.allocateToDataNodesOption",{defaultMessage:"Any data node"})},Dt=({phase:e,nodes:t,isLoading:a,isCloudEnabled:s,isUsingDeprecatedDataRoleConfig:o})=>{const r=`_meta.${e}.allocationNodeAttribute`,[d]=Object(n.useFormData)({watch:[r]}),{docLinks:u}=_().services,m=u.links.elasticsearch.shardAllocationSettings,p=Object(A.get)(d,r),[h,g]=Object(i.useState)(null),b=Object.keys(t).map((e=>({text:`${e} (${t[e].length})`,value:e})));b.sort(((e,t)=>e.value.localeCompare(t.value)));let f=[];if(!s||o){const e={text:It.allocateToDataNodesOption,value:""};f.push(e)}return f=f.concat(b),Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiText,{size:"s"},Object(x.jsx)("p",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.nodeAllocation.customOption.description",defaultMessage:"Use node attributes to control shard allocation. {learnMoreLink}.",values:{learnMoreLink:Object(x.jsx)(rt,{text:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.learnAboutShardAllocationLink",defaultMessage:"Learn about shard allocation"}),docPath:m})}}))),Object(x.jsx)(j.EuiSpacer,{size:"m"}),Object(x.jsx)(st,{path:`_meta.${e}.allocationNodeAttribute`,component:c.SelectField,componentProps:{helpText:p?Object(x.jsx)(j.EuiButtonEmpty,{size:"xs",style:{maxWidth:400},"data-test-subj":`${e}-viewNodeDetailsFlyoutButton`,flush:"left",onClick:()=>g(p)},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.viewNodeDetailsButton",defaultMessage:"View nodes with the selected attribute"})):void 0,euiFieldProps:{"data-test-subj":`${e}-selectedNodeAttrs`,options:f,hasNoInitialSelection:!1,isLoading:a}}}),h?Object(x.jsx)(At,{selectedNodeAttrs:h,close:()=>g(null)}):null)};a(57);const Nt={inputDisplay:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.customOption.input",{defaultMessage:"Custom"}),helpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.customOption.helpText",{defaultMessage:"Move data based on node attributes."})},Rt={allocationOptions:{warm:{default:{input:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.warm.defaultOption.input",{defaultMessage:"Use warm nodes (recommended)"}),helpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.warm.defaultOption.helpText",{defaultMessage:"Move data to nodes in the warm tier."})},none:{inputDisplay:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.warm.noneOption.input",{defaultMessage:"Off"}),helpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.warm.noneOption.helpText",{defaultMessage:"Do not move data in the warm phase."})},custom:Nt},cold:{default:{input:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.cold.defaultOption.input",{defaultMessage:"Use cold nodes (recommended)"}),helpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.cold.defaultOption.helpText",{defaultMessage:"Move data to nodes in the cold tier."})},none:{inputDisplay:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.cold.noneOption.input",{defaultMessage:"Off"}),helpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.cold.noneOption.helpText",{defaultMessage:"Do not move data in the cold phase."})},custom:Nt},frozen:{default:{input:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.frozen.defaultOption.input",{defaultMessage:"Use frozen nodes (recommended)"}),helpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.frozen.defaultOption.helpText",{defaultMessage:"Move data to nodes in the frozen tier."})},none:{inputDisplay:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.frozen.noneOption.input",{defaultMessage:"Off"}),helpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.common.dataTierAllocation.frozen.noneOption.helpText",{defaultMessage:"Do not move data in the frozen phase."})},custom:Nt}}},Ut=(e,t)=>[t?void 0:{"data-test-subj":"defaultDataAllocationOption",value:"node_roles",inputDisplay:Rt.allocationOptions[e].default.input,dropdownDisplay:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)("strong",null,Rt.allocationOptions[e].default.input),Object(x.jsx)(j.EuiText,{size:"s",color:"subdued"},Object(x.jsx)("p",null,Rt.allocationOptions[e].default.helpText)))},{"data-test-subj":"customDataAllocationOption",value:"node_attrs",inputDisplay:Rt.allocationOptions[e].custom.inputDisplay,dropdownDisplay:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)("strong",null,Rt.allocationOptions[e].custom.inputDisplay),Object(x.jsx)(j.EuiText,{size:"s",color:"subdued"},Object(x.jsx)("p",null,Rt.allocationOptions[e].custom.helpText)))},{"data-test-subj":"noneDataAllocationOption",value:"none",inputDisplay:Rt.allocationOptions[e].none.inputDisplay,dropdownDisplay:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)("strong",null,Rt.allocationOptions[e].none.inputDisplay),Object(x.jsx)(j.EuiText,{size:"s",color:"subdued"},Object(x.jsx)("p",null,Rt.allocationOptions[e].none.helpText)))}].filter(Boolean),Bt=e=>{const{phase:t,hasNodeAttributes:a,isCloudEnabled:i,isUsingDeprecatedDataRoleConfig:s,isLoading:o}=e,r=Boolean(i&&s),d=`_meta.${t}.dataTierAllocationType`,[u]=Object(n.useFormData)({watch:d}),m=Object(A.get)(u,d);return Object(x.jsx)("div",{"data-test-subj":`${t}-dataTierAllocationControls`},Object(x.jsx)(st,{path:d},(e=>(r&&"node_roles"===e.value&&e.setValue("node_attrs"),Object(x.jsx)(c.SuperSelectField,{field:e,euiFieldProps:{isLoading:o,hasDividers:!0,"data-test-subj":"dataTierSelect",options:Ut(t,r)}})))),"node_attrs"===m&&a&&Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)("div",{className:"indexLifecycleManagement__phase__dataTierAllocation__controlSection"},Object(x.jsx)(Dt,e))))},$t={data_hot:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.dataTierHotLabel",{defaultMessage:"hot"}),data_warm:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.dataTierWarmLabel",{defaultMessage:"warm"})},qt={warm:{title:q.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.willUseFallbackTierTitle",{defaultMessage:"No nodes assigned to the warm tier"}),body:e=>q.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.willUseFallbackTierDescription",{defaultMessage:"If no warm nodes are available, data is stored in the {tier} tier.",values:{tier:$t[e]}})},cold:{title:q.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.willUseFallbackTierTitle",{defaultMessage:"No nodes assigned to the cold tier"}),body:e=>q.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.willUseFallbackTierDescription",{defaultMessage:"If no cold nodes are available, data is stored in the {tier} tier.",values:{tier:$t[e]}})}},Vt=({phase:e,targetNodeRole:t})=>Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"willUseFallbackTierNotice",title:qt[e].title},qt[e].body(t)),Wt=q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.noCustomAttributesTitle",{defaultMessage:"No custom attributes defined"}),Ht=({docLinks:e})=>Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.defaultToDataNodesDescription",defaultMessage:"To allocate data to particular data nodes, {roleBasedGuidance} or configure custom node attributes in elasticsearch.yml.",values:{roleBasedGuidance:Object(x.jsx)(j.EuiLink,{href:e.links.elasticsearch.migrateIndexAllocationFilters,target:"_blank",external:!0},q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.defaultToDataNodesDescription.migrationGuidanceMessage",{defaultMessage:"use role-based allocation"}))}}),Gt=({phase:e,targetNodeRole:t})=>Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"willUseFallbackTierUsingNodeAttributesNotice",title:Wt},Object(x.jsx)("p",null,q.i18n.translate("xpack.indexLifecycleMgmt.dataTier.willUseFallbackTierUsingNodeAttributesDescription",{defaultMessage:"No {phase} nodes available. Data will be allocated to the {fallbackTier} tier.",values:{phase:e,fallbackTier:$t[t]}})),Object(x.jsx)("p",null,Ht)),Jt={warm:{title:q.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.noTiersAvailableTitle",{defaultMessage:"No nodes assigned to the warm tier"}),body:q.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.noTiersAvailableBody",{defaultMessage:"To use role-based allocation, assign one or more nodes to the warm or hot tiers. Allocation will fail if there are no available nodes."})},cold:{title:q.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.noTiersAvailableTitle",{defaultMessage:"No nodes assigned to the cold tier"}),body:q.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.noTiersAvailableBody",{defaultMessage:"To use role-based allocation, assign one or more nodes to the cold, warm, or hot tiers. Allocation will fail if there are no available nodes."})}},Yt=({phase:e})=>Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"noTiersAvailableNotice",title:Jt[e].title,color:"warning"},Jt[e].body),Kt=()=>Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"noTiersAvailableUsingNodeAttributesNotice",title:Wt,color:"warning"},Object(x.jsx)("p",null,q.i18n.translate("xpack.indexLifecycleMgmt.dataTier.noTiersAvailableUsingNodeAttributesDescription",{defaultMessage:"Unable to allocate data: no available data nodes."})),Object(x.jsx)("p",null,Ht)),Qt={body:{warm:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)("p",null,q.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.defaultAllocationNotAvailableDescription",{defaultMessage:"Data will be allocated to the warm tier."})),Ht),cold:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)("p",null,q.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.defaultAllocationNotAvailableDescription",{defaultMessage:"Data will be allocated to the cold tier."})),Ht)}},Zt=({phase:e})=>Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"defaultToDataTiersNotice",style:{maxWidth:400},title:Wt,color:"primary"},Qt.body[e]),Xt=({phase:e})=>Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"defaultToDataNodesNotice",style:{maxWidth:400},title:Wt,color:"primary"},Object(x.jsx)("p",null,q.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.defaultToDataNodesDescription",{defaultMessage:"Data will be allocated to any available data node."})),Ht),ea={title:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.cloudDataTierCallout.title",{defaultMessage:"Migrate to data tiers"}),body:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.cloudDataTierCallout.body",{defaultMessage:"Migrate your Elastic Cloud deployment to use data tiers."}),linkText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.cloudDataTierCallout.linkToCloudDeploymentDescription",{defaultMessage:"View cloud deployment"})},ta=({linkToCloudDeployment:e})=>Object(x.jsx)(j.EuiCallOut,{title:ea.title,"data-test-subj":"cloudDataTierCallout"},ea.body," ",Boolean(e)&&Object(x.jsx)(j.EuiLink,{href:e,external:!0},ea.linkText)),aa=({statusCode:e,message:t,onResendRequest:a})=>Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(j.EuiCallOut,{title:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.nodeAttributesLoadingFailedTitle",defaultMessage:"Unable to load node data"}),color:"danger"},Object(x.jsx)("p",null,t," (",e,")"),Object(x.jsx)(j.EuiButton,{onClick:a,iconType:"refresh",color:"danger"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.nodeAttributesReloadButton",defaultMessage:"Try again"}))),Object(x.jsx)(j.EuiSpacer,{size:"xl"}));a(62);const ia={title:q.i18n.translate("xpack.indexLifecycleMgmt.common.dataTier.title",{defaultMessage:"Data allocation"})},la=({phase:e,description:t})=>{var a;const{services:{cloud:i}}=_(),s=`_meta.${e}.dataTierAllocationType`,[o]=Object(n.useFormData)({watch:s}),r=Object(A.get)(o,s),{data:c,resendRequest:d,error:u,isLoading:m}=Object(B.j)(),{nodesByRoles:p,nodesByAttributes:h,isUsingDeprecatedDataRoleConfig:g}=c,b=Boolean(Object.keys(null!=h?h:{}).length),f=null!==(a=null==i?void 0:i.isCloudEnabled)&&void 0!==a&&a,y=null==i?void 0:i.deploymentUrl,v=((e,t)=>{var a;const i=U.c[e];return null!==(a=t.data)&&void 0!==a&&a.length?i[0]:i.find((e=>{var a;return Boolean(null===(a=t[e])||void 0===a?void 0:a.length)}))})(e,p),O=void 0===v,M=void 0!==v&&!((e,t)=>U.c[e][0]===t)(e,v);return Object(x.jsx)(j.EuiDescribedFormGroup,{title:Object(x.jsx)("h3",null,ia.title),description:Object(x.jsx)(l.a.Fragment,null,t,m?Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"m"}),Object(x.jsx)(j.EuiLoadingSpinner,{"data-test-subj":"allocationLoadingSpinner",size:"xl"})):u&&Object(x.jsx)(aa,{onResendRequest:d,message:u.message,statusCode:u.statusCode})),fullWidth:!0},Object(x.jsx)("div",{className:"ilmDataTierAllocationField"},Object(x.jsx)(Bt,{hasNodeAttributes:b,phase:e,nodes:h,isCloudEnabled:f,isUsingDeprecatedDataRoleConfig:g,isLoading:m}),!m&&(()=>{switch(r){case"node_roles":if(f)return null;if(O)return Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(Yt,{phase:e}));if(M)return Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(Vt,{phase:e,targetNodeRole:v}));break;case"node_attrs":if(!b)return g?Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(Xt,{phase:e})):O?Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(Kt,null)):M?Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(Gt,{phase:e,targetNodeRole:v})):Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(Zt,{phase:e}));if(f&&g)return Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(ta,{linkToCloudDeployment:y}));break;default:return null}})()))};var sa=a(37);const oa=({phase:e})=>{const{policy:t}=St(),a=Object(i.useMemo)((()=>{var a,i;return null!=(null===(a=t.phases[e])||void 0===a||null===(i=a.actions)||void 0===i?void 0:i.forcemerge)}),[t,e]),{docLinks:s}=_().services;return Object(x.jsx)(ut,{title:Object(x.jsx)("h3",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.forceMerge.enableText",defaultMessage:"Force merge"})),description:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.forceMerge.enableExplanationText",defaultMessage:"Reduce the number of segments in each index shard and clean up deleted documents."})," ",Object(x.jsx)(rt,{docPath:s.links.elasticsearch.ilmForceMerge})),titleSize:"xs",fullWidth:!0,switchProps:{label:re.editPolicy.forceMergeEnabledFieldLabel,"data-test-subj":`${e}-forceMergeSwitch`,initialValue:a}},Object(x.jsx)(st,{path:`phases.${e}.actions.forcemerge.max_num_segments`,component:c.NumericField,componentProps:{fullWidth:!1,euiFieldProps:{"data-test-subj":`${e}-selectedForceMergeSegments`,min:1}}}),Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(st,{path:`_meta.${e}.bestCompression`},(t=>Object(x.jsx)(j.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiCheckbox,{label:t.label,checked:t.value,onChange:t.onChange,"data-test-subj":`${e}-bestCompression`,id:Object(sa.v4)()})),Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiIconTip,{content:re.editPolicy.bestCompressionFieldHelpText,position:"right"}))))))};function na(e){switch(e){case"warm":return q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseWarm.minimumAgeUnitsAriaLabel",{defaultMessage:"Units for timing of warm phase"});case"cold":return q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseCold.minimumAgeUnitsAriaLabel",{defaultMessage:"Units for timing of cold phase"});case"frozen":return q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseFrozen.minimumAgeUnitsAriaLabel",{defaultMessage:"Units for timing of frozen phase"});case"delete":return q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseDelete.minimumAgeUnitsAriaLabel",{defaultMessage:"Units for timing of delete phase"})}}function ra(e){switch(e){case"warm":return q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseWarm.minimumAgeLabel",{defaultMessage:"Timing for warm phase"});case"cold":return q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseCold.minimumAgeLabel",{defaultMessage:"Timing for cold phase"});case"frozen":return q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseFrozen.minimumAgeLabel",{defaultMessage:"Timing for frozen phase"});case"delete":return q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.phaseDelete.minimumAgeLabel",{defaultMessage:"Timing for delete phase"})}}const ca={rolloverToolTipDescription:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.minimumAge.rolloverToolTipDescription",{defaultMessage:"Data age is calculated from rollover. Rollover is configured in the hot phase."}),minAgeUnitFieldSuffix:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.minimumAge.minimumAgeFieldSuffixLabel",{defaultMessage:"old"})},da=({phase:e})=>{const t=`phases.${e}.min_age`,a=`_meta.${e}.minAgeUnit`,{isUsingRollover:s}=Re(),o=Qe(),{setValue:r}=o[`${e}MinAgeMilliSeconds`],[c]=Object(n.useFormData)({watch:[t,a]}),d=Object(A.get)(c,t),u=Object(A.get)(c,a);return Object(i.useEffect)((()=>{if(void 0===d)return;const e=""===d.trim()?-1:Z(d,u);r(e)}),[d,u,r]),Object(i.useEffect)((()=>()=>{r(-1)}),[r]),Object(x.jsx)(st,{path:t},(t=>{const{isInvalid:i,errorMessage:o}=Object(n.getFieldValidityAndErrorMessage)(t);return Object(x.jsx)(j.EuiFormRow,{fullWidth:!0,isInvalid:i,error:o},Object(x.jsx)(j.EuiFlexGroup,{gutterSize:"s",alignItems:"center",justifyContent:"spaceBetween",wrap:!0},Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiText,{className:"eui-textNoWrap",size:"xs"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.minimumAge.minimumAgeFieldLabel",defaultMessage:"Move data into phase when:"}))),Object(x.jsx)(j.EuiFlexItem,{grow:!0},Object(x.jsx)(j.EuiFlexGroup,{gutterSize:"s"},Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiFieldNumber,{style:{minWidth:50},compressed:!0,"aria-label":ra(e),isInvalid:i,value:t.value,onChange:t.onChange,isLoading:t.isValidating,"data-test-subj":`${e}-selectedMinimumAge`,min:0})),Object(x.jsx)(j.EuiFlexItem,{grow:!0,style:{minWidth:165}},Object(x.jsx)(st,{path:a},(t=>{const{isInvalid:a}=Object(n.getFieldValidityAndErrorMessage)(t),i=Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)("div",{"data-test-subj":`${e}-rolloverMinAgeInputIconTip`}),Object(x.jsx)(j.EuiIconTip,{type:"iInCircle","aria-label":ca.rolloverToolTipDescription,content:ca.rolloverToolTipDescription})),o=s?[ca.minAgeUnitFieldSuffix,i]:[ca.minAgeUnitFieldSuffix],r=t.value;let c=oe;return r&&!c.some((e=>e.value===r))&&(c=[...oe,{value:r,text:r}]),Object(x.jsx)(j.EuiSelect,{compressed:!0,value:r,onChange:e=>{t.setValue(e.target.value)},isInvalid:a,append:o,"data-test-subj":`${e}-selectedMinimumAgeUnits`,"aria-label":na(e),options:c})})))))))}))},ua="phases.delete.actions.wait_for_snapshot.policy",ma=()=>{const{services:{docLinks:e,getUrlForApp:t}}=_(),{error:a,isLoading:i,data:s,resendRequest:o}=Object(B.l)(),[r]=Object(n.useFormData)({watch:ua}),d=Object(A.get)(r,ua),u=s.map((e=>({label:e,value:e}))),m=()=>t("management",{path:"data/snapshot_restore/add_policy"});let p;return a?p=Object(x.jsx)(pt,{resendRequest:o,"data-test-subj":"policiesErrorCallout","aria-label":q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.reloadPoliciesLabel",{defaultMessage:"Reload policies"}),title:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.noPoliciesLoadedTitle",defaultMessage:"Unable to load existing policies"}),body:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.noPoliciesLoadedMessage",defaultMessage:"Refresh this field and enter the name of an existing snapshot policy."})}):0===s.length?p=Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"m"}),Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"noPoliciesCallout",color:"warning",title:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.noPoliciesCreatedTitle",defaultMessage:"No snapshot policies found"})},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.noPoliciesCreatedMessage",defaultMessage:"{link} to automate the creation and deletion of cluster snapshots.",values:{link:Object(x.jsx)(j.EuiLink,{href:m(),target:"_blank"},q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.noPoliciesCreatedLink",{defaultMessage:"Create a snapshot lifecycle policy"}))}}))):d&&!s.includes(d)&&(p=Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"m"}),Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"customPolicyCallout",color:"warning",title:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.customPolicyTitle",defaultMessage:"Policy name not found"})},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.customPolicyMessage",defaultMessage:"Enter the name of an existing snapshot policy, or {link} with this name.",values:{link:Object(x.jsx)(j.EuiLink,{href:m(),target:"_blank"},q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.customPolicyLink",{defaultMessage:"create a new policy"}))}})))),Object(x.jsx)(j.EuiDescribedFormGroup,{title:Object(x.jsx)("h3",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.waitForSnapshotTitle",defaultMessage:"Wait for snapshot policy"})),description:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.waitForSnapshotDescription",defaultMessage:"Specify a snapshot policy to be executed before the deletion of the index. This ensures that a snapshot of the deleted index is available."})," ",Object(x.jsx)(rt,{docPath:e.links.elasticsearch.ilmWaitForSnapshot})),titleSize:"xs",fullWidth:!0},Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(st,{path:ua,componentProps:{label:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.waitForSnapshotLabel",defaultMessage:"Snapshot policy name"}),Object(x.jsx)(ct,null))}},(e=>{const t=e.value?[e.value]:[];return Object(x.jsx)(c.ComboBoxField,{field:{...e,value:t},euiFieldProps:{"data-test-subj":"snapshotPolicyCombobox",fullWidth:!1,options:u,singleSelection:{asPlainText:!0},isLoading:i,noSuggestions:!(!a&&0!==s.length),onCreateOption:t=>{e.setValue(t)},onChange:t=>{t.length>0?e.setValue(t[0].label):e.setValue("")}}})})),p))},pa=({path:e,options:t,euiFieldProps:a})=>{const[l,s]=Object(i.useState)(!1);return Object(x.jsx)(st,{key:e,path:e},(e=>{var i,o;return Object(x.jsx)(j.EuiPopover,m()({button:Object(x.jsx)(j.EuiButtonEmpty,{size:"xs",color:"text",iconSide:"right",iconType:"arrowDown",onClick:()=>s((e=>!e)),"data-test-subj":"show-filters-button"},null!==(i=null===(o=t.find((t=>t.value===e.value)))||void 0===o?void 0:o.text)&&void 0!==i?i:`${e.value}`),ownFocus:!0,panelPaddingSize:"none",isOpen:l,closePopover:()=>s(!1)},a),t.map((t=>Object(x.jsx)(j.EuiFilterSelectItem,{key:t.value,checked:e.value===t.value?"on":void 0,onClick:()=>{return a=t.value,e.setValue(a),void s(!1);var a},"data-test-subj":`filter-option-${t.value}`},t.text))))}))},ha=({phase:e})=>{var t,a;const i=Qe(),{setValue:s}=i[`${e}IsUsingShardSize`],{policy:o}=St(),r=`_meta.${e}.shrink.isUsingShardSize`,[d]=Object(n.useFormData)({watch:[r]}),u=Object(A.get)(d,r),m=`phases.${e}.actions.shrink.${u?"max_primary_shard_size":"number_of_shards"}`,{docLinks:p}=_().services;return Object(x.jsx)(ut,{title:Object(x.jsx)("h3",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.shrinkText",defaultMessage:"Shrink"})),description:Object(x.jsx)(j.EuiTextColor,{color:"subdued"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.shrinkIndexExplanationText",defaultMessage:"Shrink the index to a new index with fewer primary shards."})," ",Object(x.jsx)(rt,{docPath:p.links.elasticsearch.ilmShrink})),titleSize:"xs",switchProps:{"data-test-subj":`${e}-shrinkSwitch`,label:re.editPolicy.shrinkLabel,initialValue:Boolean(null===(t=o.phases[e])||void 0===t||null===(a=t.actions)||void 0===a?void 0:a.shrink)},fullWidth:!0},void 0===u?null:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiRadioGroup,{options:[{id:`${e}-configureShardCount`,label:re.editPolicy.shrinkCountLabel,"data-test-subj":`${e}-configureShardCount`},{id:`${e}-configureShardSize`,label:re.editPolicy.shrinkSizeLabel,"data-test-subj":`${e}-configureShardSize`}],idSelected:u?`${e}-configureShardSize`:`${e}-configureShardCount`,onChange:t=>s(t===`${e}-configureShardSize`)}),Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(st,{path:m,key:m,component:c.NumericField,componentProps:{fullWidth:!1,euiFieldProps:{"data-test-subj":`${e}-primaryShard${u?"Size":"Count"}`,min:1,append:u?Object(x.jsx)(pa,{path:`_meta.${e}.shrink.maxPrimaryShardSizeUnits`,options:se,euiFieldProps:{"data-test-subj":`${e}-shrinkMaxPrimaryShardSizeUnits`,"aria-label":re.editPolicy.maxPrimaryShardSizeUnitsLabel}}):null}}})))},xa=({children:e})=>e(Object(B.m)()),ga=({field:e,isLoading:t,repos:a,noSuggestions:l,globalRepository:s})=>{const o=Object(i.useRef)(!1),{setValue:n}=e,{searchableSnapshotRepo:{setValue:r}}=Qe();return Object(i.useEffect)((()=>{o.current&&n(Boolean(s.trim())?[s]:[]),o.current=!0}),[n,s]),Object(x.jsx)(c.ComboBoxField,{field:e,fullWidth:!1,euiFieldProps:{"data-test-subj":"searchableSnapshotCombobox",options:a.map((e=>({label:e,value:e}))),singleSelection:{asPlainText:!0},isLoading:t,noSuggestions:l,onCreateOption:e=>{r(e)},onChange:e=>{e.length>0?r(e[0].label):r("")}}})};a(67);const ba=({phase:e,canBeDisabled:t=!0})=>{const{services:{cloud:a,docLinks:s,getUrlForApp:o}}=_(),{policy:r,license:c,isNewPolicy:d}=St(),{isUsingSearchableSnapshotInHotPhase:u}=Re(),m=`phases.${e}.actions.searchable_snapshot.snapshot_repository`,[p]=Object(n.useFormData)({watch:Ye.searchableSnapshotRepo.path}),h=Object(A.get)(p,Ye.searchableSnapshotRepo.path),g="cold"===e||"frozen"===e,b=!c.canUseSearchableSnapshot(),[f,y]=Object(i.useState)((()=>{var t,i,l;return Boolean(g&&d&&(null==a?void 0:a.isCloudEnabled)||(null===(t=r.phases[e])||void 0===t||null===(i=t.actions)||void 0===i||null===(l=i.searchable_snapshot)||void 0===l?void 0:l.snapshot_repository))})),v=s.links.elasticsearch.ilmSearchableSnapshot,O=s.links.elasticsearch.searchableSnapshotSharedCache,M=((e,t,a)=>{switch(e){case"hot":case"cold":return{title:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.fullyMountedSearchableSnapshotField.title",{defaultMessage:"Searchable snapshot"}),description:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.fullyMountedSearchableSnapshotField.description",defaultMessage:"Convert to a fully-mounted index that contains a complete copy of your data and is backed by a snapshot. You can reduce the number of replicas and rely on the snapshot for resiliency. {learnMoreLink}",values:{learnMoreLink:Object(x.jsx)(rt,{docPath:t})}}),toggleLabel:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.fullyMountedSearchableSnapshotField.toggleLabel",{defaultMessage:"Convert to fully-mounted index"})};case"frozen":return{title:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.partiallyMountedSearchableSnapshotField.title",{defaultMessage:"Searchable snapshot"}),description:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.frozenPhase.partiallyMountedSearchableSnapshotField.description",defaultMessage:"Convert to a partially-mounted index that caches the index metadata. Data is retrieved from the snapshot as needed to process search requests. This minimizes the index footprint while keeping all of your data fully searchable. {learnMoreLink}",values:{learnMoreLink:Object(x.jsx)(rt,{docPath:a})}}),toggleLabel:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.partiallyMountedSearchableSnapshotField.toggleLabel",{defaultMessage:"Convert to partially-mounted index"})}}})(e,v,O);return Object(i.useEffect)((()=>{b&&y(!1)}),[b]),Object(x.jsx)(ut,{"data-test-subj":`searchableSnapshotField-${e}`,switchProps:t?{checked:f,disabled:b,onChange:y,"data-test-subj":"searchableSnapshotToggle",label:M.toggleLabel}:void 0,title:Object(x.jsx)("h3",null,M.title),description:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiTextColor,{color:"subdued"},M.description)),fieldNotices:(()=>{let t;return"hot"===e&&u?t=Object(x.jsx)(j.EuiCallOut,{size:"s",title:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotCalloutBody",{defaultMessage:"Force merge, shrink, downsample and read only actions are not allowed when converting data to a fully-mounted index in this phase."}),"data-test-subj":"searchableSnapshotFieldsDisabledCallout"}):b&&(t=Object(x.jsx)(j.EuiCallOut,{"data-test-subj":"searchableSnapshotDisabledDueToLicense",title:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotLicenseCalloutTitle",{defaultMessage:"Enterprise license required"}),iconType:"questionInCircle"},q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.searchableSnapshotLicenseCalloutBody",{defaultMessage:"To create a searchable snapshot an enterprise license is required."}))),t?Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,null),t,Object(x.jsx)(j.EuiSpacer,null)):void 0})(),fullWidth:!0},b?Object(x.jsx)("div",null):()=>Object(x.jsx)(xa,null,(({error:e,isLoading:t,resendRequest:a,data:i})=>{var s;const n=null!==(s=null==i?void 0:i.repositories)&&void 0!==s?s:[];let r;return t||(e?r=Object(x.jsx)(pt,{resendRequest:a,"data-test-subj":"repositoriesErrorCallout","aria-label":q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.reloadSnapshotRepositoriesLabel",{defaultMessage:"Reload snapshot repositories"}),title:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.loadSnapshotRepositoriesErrorTitle",defaultMessage:"Unable to load snapshot repositories"}),body:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.loadSnapshotRepositoriesErrorBody",defaultMessage:"Refresh this field and enter the name of an existing snapshot repository."})}):0===n.length?r=Object(x.jsx)(j.EuiCallOut,{color:"warning",title:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.noSnapshotRepositoriesTitle",{defaultMessage:"No snapshot repositories found"})},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.noSnapshotRepositoriesFoundBody",defaultMessage:"{link} to use searchable snapshots.",values:{link:Object(x.jsx)(j.EuiLink,{href:o("management",{path:"data/snapshot_restore/add_repository"}),target:"_blank"},q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.createSearchableSnapshotLink",{defaultMessage:"Create a snapshot repository"}))}})):h&&!n.includes(h)&&(r=Object(x.jsx)(j.EuiCallOut,{title:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.noSnapshotRepositoriesWithNameTitle",{defaultMessage:"Repository name not found"}),color:"warning"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.noSnapshotRepositoryWithNameBody",defaultMessage:"Enter the name of an existing repository, or {link} with this name.",values:{link:Object(x.jsx)(j.EuiLink,{href:o("management",{path:"data/snapshot_restore/add_repository"}),target:"_blank"},q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.createSnapshotRepositoryLink",{defaultMessage:"create a new snapshot repository"}))}})))),Object(x.jsx)("div",{className:"ilmSearchableSnapshotField"},Object(x.jsx)(st,{path:m,defaultValue:h?[h]:[],component:ga,componentProps:{globalRepository:h,isLoading:t,repos:n,noSuggestions:!(!e&&0!==n.length)}}),r&&Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),r))})))},fa=({phase:e})=>{const{docLinks:t}=_().services;return Object(x.jsx)(mt,{title:Object(x.jsx)("h3",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.readonlyTitle",defaultMessage:"Read only"})),description:Object(x.jsx)(j.EuiTextColor,{color:"subdued"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.readonlyDescription",defaultMessage:"Enable to make the index and index metadata read only, disable to allow writes and metadata changes."})," ",Object(x.jsx)(rt,{docPath:t.links.elasticsearch.ilmReadOnly})),fullWidth:!0,titleSize:"xs",switchProps:{"data-test-subj":`${e}-readonlySwitch`,path:`_meta.${e}.readonlyEnabled`}},Object(x.jsx)("div",null))},ja=({phase:e})=>{var t,a,i;const{policy:l}=St(),s=null!=(null===(t=l.phases[e])||void 0===t||null===(a=t.actions)||void 0===a||null===(i=a.allocate)||void 0===i?void 0:i.number_of_replicas);return Object(x.jsx)(ut,{title:Object(x.jsx)("h3",null,q.i18n.translate("xpack.indexLifecycleMgmt.numberOfReplicas.formRowTitle",{defaultMessage:"Replicas"})),description:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.numberOfReplicas.formRowDescription",{defaultMessage:"Set the number of replicas. Remains the same as the previous phase by default."}),switchProps:{"data-test-subj":`${e}-setReplicasSwitch`,label:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.numberOfReplicas.switchLabel",{defaultMessage:"Set replicas"}),initialValue:s},fullWidth:!0},Object(x.jsx)(st,{path:`phases.${e}.actions.allocate.number_of_replicas`,component:c.NumericField,componentProps:{fullWidth:!1,euiFieldProps:{"data-test-subj":`${e}-selectedReplicaCount`,min:0}}}))},ya=({phase:e})=>{const{policy:t,isNewPolicy:a}=St(),l=Object(i.useMemo)((()=>{var i,l,s;return a||!(null!==(i=t.phases[e])&&void 0!==i&&i.actions)||null!=(null===(l=t.phases[e])||void 0===l||null===(s=l.actions)||void 0===s?void 0:s.set_priority)}),[a,t.phases,e]),{docLinks:s}=_().services;return Object(x.jsx)(ut,{title:Object(x.jsx)("h3",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.indexPriorityText",defaultMessage:"Index priority"})),description:Object(x.jsx)(j.EuiTextColor,{color:"subdued"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.warmPhase.indexPriorityExplanationText",defaultMessage:"Set the priority for recovering your indices after a node restart. Indices with higher priorities are recovered before indices with lower priorities."})," ",Object(x.jsx)(rt,{docPath:s.links.elasticsearch.ilmSetPriority})),titleSize:"xs",fullWidth:!0,switchProps:{label:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.indexPriority.indexPriorityEnabledFieldLabel",{defaultMessage:"Set index priority"}),"data-test-subj":`${e}-indexPrioritySwitch`,initialValue:l}},Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(st,{path:`phases.${e}.actions.set_priority.priority`,component:c.NumericField,euiFieldProps:{fullWidth:!1,"data-test-subj":`${e}-indexPriority`,min:0}}))},va=({phase:e})=>{const t=`_meta.${e}.downsample.enabled`,a=`_meta.${e}.downsample.fixedIntervalSize`,i=`_meta.${e}.downsample.fixedIntervalUnits`;return Object(x.jsx)(mt,{title:Object(x.jsx)("h3",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.downsampleTitle",defaultMessage:"Downsample"})),description:Object(x.jsx)(j.EuiTextColor,{color:"subdued"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.downsampleDescription",defaultMessage:"Roll up documents within a fixed interval to a single summary document. Reduces the index footprint by storing time series data at reduced granularity."})," "),fullWidth:!0,titleSize:"xs",switchProps:{"data-test-subj":`${e}-downsampleSwitch`,path:t}},Object(x.jsx)(st,{path:a,key:a,component:c.NumericField,componentProps:{fullWidth:!1,euiFieldProps:{"data-test-subj":`${e}-downsampleFixedInterval`,min:1,append:Object(x.jsx)(pa,{path:i,options:oe,euiFieldProps:{"data-test-subj":`${e}-downsampleFixedIntervalUnits`,"aria-label":re.editPolicy.downsampleIntervalFieldUnitsLabel}})}}}))};a(72);const Oa=({enabled:e,phase:t})=>Object(x.jsx)("div",{className:`ilmPhaseIcon ilmPhaseIcon--${t} ${e?"":"ilmPhaseIcon--disabled"}`},e?Object(x.jsx)(j.EuiIcon,{className:`ilmPhaseIcon__inner--${t}`,type:"delete"===t?"trash":"checkInCircleFilled",size:"delete"===t?"m":"l"}):Object(x.jsx)(j.EuiIcon,{className:"ilmPhaseIcon__inner--disabled",type:"dot",size:"s"}));a(77),a(82);const Ma=({phase:e})=>{const t=`_meta.${e}.enabled`,[a]=Object(n.useFormData)({watch:[t]}),i="hot"===e,l="delete"===e,{setDeletePhaseEnabled:s}=Ge(),o=Object(A.get)(a,t)||i,{errors:r}=qe(),d=Object.keys(r[e]).length>0;return Object(x.jsx)(j.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"spaceBetween"},Object(x.jsx)(j.EuiFlexItem,{grow:!0},Object(x.jsx)(j.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!0},!i&&!l&&Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(st,{path:t,component:c.ToggleField,componentProps:{euiFieldProps:{"data-test-subj":`enablePhaseSwitch-${e}`,showLabel:!1}}})),Object(x.jsx)(j.EuiFlexItem,{grow:!1,className:"ilmPhaseTitle"},Object(x.jsx)(j.EuiTitle,{size:"s"},Object(x.jsx)("h2",null,re.editPolicy.titles[e]))),i&&Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiBadge,{className:"ilmPhaseRequiredBadge"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.phaseTitle.requiredBadge",defaultMessage:"Required"}))),l&&Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiButtonEmpty,{onClick:()=>s(!1),"data-test-subj":"disableDeletePhaseButton"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.deletePhase.removeDeletePhaseButtonLabel",defaultMessage:"Remove"}))),d&&Object(x.jsx)(j.EuiFlexItem,{grow:!1,"data-test-subj":`phaseErrorIndicator-${e}`},Object(x.jsx)(j.EuiIconTip,{type:"warning",color:"danger",content:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.phaseErrorIcon.tooltipDescription",defaultMessage:"This phase contains errors."})})))),!i&&o&&Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(da,{phase:e})))},Pa=({children:e,topLevelSettings:t,phase:a})=>{const i=`_meta.${a}.enabled`,[s]=Object(n.useFormData)({watch:[i]}),o="hot"===a,r="delete"===a,c=Object(A.get)(s,i)||o;return r&&!c?null:Object(x.jsx)(j.EuiTimelineItem,{icon:Object(x.jsx)(Oa,{enabled:c,phase:a}),verticalAlign:"top","data-test-subj":`${a}-phase`},Object(x.jsx)(j.EuiSplitPanel.Outer,{color:"transparent",hasBorder:!0,grow:!0},Object(x.jsx)(j.EuiSplitPanel.Inner,{color:c?"transparent":"subdued"},Object(x.jsx)(Ma,{phase:a})),Object(x.jsx)(j.EuiHorizontalRule,{margin:"none"}),Object(x.jsx)(j.EuiSplitPanel.Inner,null,Object(x.jsx)(j.EuiText,{color:"subdued",size:"s",style:{maxWidth:"50%"}},re.editPolicy.descriptions[a]),c&&Object(x.jsx)(l.a.Fragment,null,t?Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,null),t):Object(x.jsx)(j.EuiSpacer,{size:"m"}),e?Object(x.jsx)(j.EuiAccordion,{id:`${a}-settingsSwitch`,className:"ilmSettingsAccordion",buttonContent:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.phaseSettings.buttonLabel",defaultMessage:"Advanced settings"}),buttonClassName:"ilmSettingsButton",extraAction:!r&&Object(x.jsx)(Tt,{phase:a})},Object(x.jsx)(j.EuiSpacer,null),e):!r&&Object(x.jsx)(j.EuiFlexGroup,{justifyContent:"flexEnd"},Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(Tt,{phase:a})))))))},_a=Object.values(ie),Ta=()=>Object(x.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s"},Object(x.jsx)(j.EuiFlexItem,{style:{maxWidth:400}},Object(x.jsx)(st,{path:ie.maxPrimaryShardSize,component:c.NumericField,componentProps:{euiFieldProps:{"data-test-subj":"hot-selectedMaxPrimaryShardSize",min:1,append:Object(x.jsx)(pa,{path:"_meta.hot.customRollover.maxPrimaryShardSizeUnit",options:se,euiFieldProps:{"data-test-subj":"hot-selectedMaxPrimaryShardSizeUnits","aria-label":re.editPolicy.maxPrimaryShardSizeUnitsLabel}})}}}))),ka=()=>Object(x.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s"},Object(x.jsx)(j.EuiFlexItem,{style:{maxWidth:400}},Object(x.jsx)(st,{path:ie.maxPrimaryShardDocs,component:c.NumericField,componentProps:{euiFieldProps:{"data-test-subj":"hot-selectedMaxPrimaryShardDocs",min:1}}}))),wa=()=>Object(x.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s"},Object(x.jsx)(j.EuiFlexItem,{style:{maxWidth:400}},Object(x.jsx)(st,{path:ie.maxAge,component:c.NumericField,componentProps:{euiFieldProps:{"data-test-subj":"hot-selectedMaxAge",min:1,append:Object(x.jsx)(pa,{path:"_meta.hot.customRollover.maxAgeUnit",options:oe,euiFieldProps:{"data-test-subj":"hot-selectedMaxAgeUnits","aria-label":q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumAgeUnitsAriaLabel",{defaultMessage:"Maximum age units"})}})}}}))),La=()=>Object(x.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s"},Object(x.jsx)(j.EuiFlexItem,{style:{maxWidth:400}},Object(x.jsx)(st,{path:ie.maxDocs,component:c.NumericField,componentProps:{euiFieldProps:{"data-test-subj":"hot-selectedMaxDocuments",min:1}}}))),Sa={deprecationMessage:q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumIndexSizeDeprecationMessage",{defaultMessage:"Maximum index size is deprecated and will be removed in a future version. Use maximum primary shard size instead."}),maxSizeUnit:{ariaLabel:q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumIndexSizeUnitsAriaLabel",{defaultMessage:"Maximum index size units"})}},Ea=()=>Object(x.jsx)(j.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"s"},Object(x.jsx)(j.EuiFlexItem,{style:{maxWidth:400}},Object(x.jsx)(st,{path:ie.maxSize,component:c.NumericField,componentProps:{euiFieldProps:{"data-test-subj":"hot-selectedMaxSizeStored",min:1,prepend:Object(x.jsx)(j.EuiIconTip,{type:"warning","aria-label":Sa.deprecationMessage,content:Sa.deprecationMessage}),append:Object(x.jsx)(pa,{path:"_meta.hot.customRollover.maxStorageSizeUnit",options:se,euiFieldProps:{"data-test-subj":"hot-selectedMaxSizeStoredUnits","aria-label":Sa.maxSizeUnit.ariaLabel}})}}}))),Fa=Object.values(ie),Ca=()=>{const{license:e}=St(),[t]=Object(n.useFormData)({watch:[te,...Fa]}),{isUsingRollover:a,isUsingDownsampleInHotPhase:s}=Re(),o=Object(A.get)(t,te),r=(()=>{const[e,t]=Object(i.useState)(!1),[a]=Object(n.useFormData)({watch:_a}),{getFields:l}=Object(n.useFormContext)();return Object(i.useEffect)((()=>{var e,a;const i=null!==(e=null===(a=Object(A.get)(l(),ie.maxPrimaryShardSize))||void 0===a?void 0:a.errors)&&void 0!==e?e:[];t(i.some((e=>e.code===ge)))}),[l,a]),e})(),{docLinks:c}=_().services;return Object(x.jsx)(Pa,{phase:"hot"},Object(x.jsx)(ut,{title:Object(x.jsx)("h3",null,q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.rolloverFieldTitle",{defaultMessage:"Rollover"})),description:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiTextColor,{color:"subdued"},Object(x.jsx)("p",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.hotPhase.rolloverDescriptionMessage",defaultMessage:"Start writing to a new index when the current index reaches a certain size, document count, or age. Enables you to optimize performance and manage resource usage when working with time series data."}))),Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(j.EuiTextColor,{color:"subdued"},Object(x.jsx)("p",null,Object(x.jsx)("strong",null,q.i18n.translate("xpack.indexLifecycleMgmt.rollover.rolloverOffsetsPhaseTimingDescriptionNote",{defaultMessage:"Note: "})),re.editPolicy.rolloverOffsetsHotPhaseTiming," ",Object(x.jsx)(rt,{text:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.hotPhase.learnAboutRolloverLinkText",defaultMessage:"Learn more"}),docPath:c.links.elasticsearch.ilmRollover}))),Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(st,{path:te},(e=>Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiText,{color:"default"},Object(x.jsx)(j.EuiSwitch,{label:e.label,checked:e.value,onChange:t=>e.setValue(t.target.checked),"data-test-subj":"useDefaultRolloverSwitch"})),Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.hotPhase.rolloverDefaultsTipContent",defaultMessage:"Roll over when an index is 30 days old or any primary shard reaches 50 gigabytes."}))))),fullWidth:!0},!1===o?Object(x.jsx)("div",{"aria-live":"polite",role:"region"},Object(x.jsx)(st,{path:"_meta.hot.customRollover.enabled"},(e=>Object(x.jsx)(j.EuiSwitch,{label:e.label,checked:e.value,onChange:t=>e.setValue(t.target.checked),"data-test-subj":"rolloverSwitch"}))),a&&Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"m"}),r&&Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiCallOut,{size:"s",title:re.editPolicy.errors.rollOverConfigurationCallout.title,"data-test-subj":"rolloverSettingsRequired",color:"danger"},Object(x.jsx)("div",null,re.editPolicy.errors.rollOverConfigurationCallout.body)),Object(x.jsx)(j.EuiSpacer,{size:"s"})),Object(x.jsx)(Ta,null),Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(ka,null),Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(wa,null),Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(La,null),Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(Ea,null))):Object(x.jsx)("div",null)),a&&Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(oa,{phase:"hot"}),Object(x.jsx)(ha,{phase:"hot"}),e.canUseSearchableSnapshot()&&Object(x.jsx)(ba,{phase:"hot"}),Object(x.jsx)(va,{phase:"hot"}),!s&&Object(x.jsx)(fa,{phase:"hot"})),Object(x.jsx)(ya,{phase:"hot"}))},za={dataTierAllocation:{description:q.i18n.translate("xpack.indexLifecycleMgmt.warmPhase.dataTier.description",{defaultMessage:"Move data to nodes optimized for less-frequent, read-only access."})}},Aa=()=>{const{isUsingSearchableSnapshotInHotPhase:e,isUsingDownsampleInHotPhase:t,isUsingDownsampleInWarmPhase:a}=Re();return Object(x.jsx)(Pa,{phase:"warm"},Object(x.jsx)(ja,{phase:"warm"}),!e&&Object(x.jsx)(ha,{phase:"warm"}),!e&&Object(x.jsx)(oa,{phase:"warm"}),!e&&Object(x.jsx)(va,{phase:"warm"}),!e&&!t&&!a&&Object(x.jsx)(fa,{phase:"warm"}),Object(x.jsx)(la,{description:za.dataTierAllocation.description,phase:"warm"}),Object(x.jsx)(ya,{phase:"warm"}))},Ia={dataTierAllocation:{description:q.i18n.translate("xpack.indexLifecycleMgmt.coldPhase.dataTier.description",{defaultMessage:"Move data to nodes optimized for less frequent, read-only access. Store data in the cold phase on less-expensive hardware."})}},Da=()=>{const{isUsingSearchableSnapshotInHotPhase:e,isUsingDownsampleInHotPhase:t,isUsingDownsampleInWarmPhase:a,isUsingDownsampleInColdPhase:i}=Re();return Object(x.jsx)(Pa,{phase:"cold",topLevelSettings:Object(x.jsx)(ba,{phase:"cold"})},Object(x.jsx)(ja,{phase:"cold"}),!e&&Object(x.jsx)(va,{phase:"cold"}),!e&&!t&&!a&&!i&&Object(x.jsx)(fa,{phase:"cold"}),Object(x.jsx)(la,{description:Ia.dataTierAllocation.description,phase:"cold"}),Object(x.jsx)(ya,{phase:"cold"}))},Na=()=>Object(x.jsx)(Pa,{phase:"frozen",topLevelSettings:Object(x.jsx)(ba,{phase:"frozen",canBeDisabled:!1})}),Ra=()=>Object(x.jsx)(Pa,{phase:"delete",topLevelSettings:Object(x.jsx)(ma,null)}),Ua="name",Ba=()=>{Object(i.useEffect)((()=>{window.scrollTo(0,0)}),[]);const[e,t]=Object(i.useState)(!1),{isNewPolicy:a,policy:s,existingPolicies:o,policyName:r,license:d}=St(),{services:{cloud:u,docLinks:m}}=_(),[p,h]=Object(i.useState)(!1),g=a?"":r,b=d.canUseSearchableSnapshot(),f=Boolean(null==u?void 0:u.isCloudEnabled),y=Object(i.useMemo)((()=>{return e=a?void 0:s,t=>{const{_meta:a,...i}=t;return i.phases={hot:{actions:{}},...i.phases},Object(W.produce)(null!=e?e:N.o,(t=>{var l,s,o;Object(A.merge)(t,i);const n=Boolean((null===(l=a.hot)||void 0===l?void 0:l.isUsingDefaultRollover)||(null===(s=a.hot)||void 0===s?void 0:s.customRollover.enabled));var r,c;if(t.phases.hot&&(t.phases.hot.min_age=null!==(r=t.phases.hot.min_age)&&void 0!==r?r:"0ms",null!==(c=t.phases.hot)&&void 0!==c&&c.actions)){var d,u;const e=t.phases.hot.actions;if(n){var m,p,h,x,g,b,f,j,y,v,O,M,P,_,T,k,w,L;if(null!==(m=a.hot)&&void 0!==m&&m.isUsingDefaultRollover?e.rollover=Object(A.cloneDeep)(N.p):(e.rollover||(e.rollover={}),null!==(O=i.phases.hot.actions.rollover)&&void 0!==O&&O.max_age?e.rollover.max_age=`${e.rollover.max_age}${null===(k=a.hot)||void 0===k?void 0:k.customRollover.maxAgeUnit}`:delete e.rollover.max_age,"number"!=typeof(null===(M=i.phases.hot.actions.rollover)||void 0===M?void 0:M.max_docs)&&delete e.rollover.max_docs,null!==(P=i.phases.hot.actions.rollover)&&void 0!==P&&P.max_primary_shard_size?e.rollover.max_primary_shard_size=`${e.rollover.max_primary_shard_size}${null===(w=a.hot)||void 0===w?void 0:w.customRollover.maxPrimaryShardSizeUnit}`:delete e.rollover.max_primary_shard_size,"number"!=typeof(null===(_=i.phases.hot.actions.rollover)||void 0===_?void 0:_.max_primary_shard_docs)&&delete e.rollover.max_primary_shard_docs,null!==(T=i.phases.hot.actions.rollover)&&void 0!==T&&T.max_size?e.rollover.max_size=`${e.rollover.max_size}${null===(L=a.hot)||void 0===L?void 0:L.customRollover.maxStorageSizeUnit}`:delete e.rollover.max_size),null!==(p=i.phases.hot.actions)&&void 0!==p&&p.forcemerge?null!==(h=a.hot)&&void 0!==h&&h.bestCompression?e.forcemerge.index_codec="best_compression":delete e.forcemerge.index_codec:delete e.forcemerge,null!==(x=a.hot)&&void 0!==x&&x.bestCompression&&e.forcemerge&&(e.forcemerge.index_codec="best_compression"),null!==(g=a.hot)&&void 0!==g&&g.readonlyEnabled?e.readonly=null!==(v=e.readonly)&&void 0!==v?v:{}:delete e.readonly,null!==(b=i.phases.hot)&&void 0!==b&&null!==(f=b.actions)&&void 0!==f&&f.shrink)if(a.hot.shrink.isUsingShardSize){var S,E;delete e.shrink.number_of_shards,e.shrink.max_primary_shard_size=`${null===(S=e.shrink)||void 0===S?void 0:S.max_primary_shard_size}${null===(E=a.hot)||void 0===E?void 0:E.shrink.maxPrimaryShardSizeUnits}`}else delete e.shrink.max_primary_shard_size;else delete e.shrink;null!==(j=a.hot)&&void 0!==j&&null!==(y=j.downsample)&&void 0!==y&&y.enabled?e.downsample={...e.downsample,fixed_interval:`${a.hot.downsample.fixedIntervalSize}${a.hot.downsample.fixedIntervalUnits}`}:delete e.downsample}else delete e.rollover,delete e.forcemerge,delete e.readonly,delete e.shrink;null!==(d=i.phases.hot.actions)&&void 0!==d&&d.set_priority||delete e.set_priority,null!==(u=i.phases.hot.actions)&&void 0!==u&&u.searchable_snapshot?e.searchable_snapshot={...e.searchable_snapshot,snapshot_repository:a.searchableSnapshot.repository}:delete e.searchable_snapshot}if(a.warm.enabled){var F,C,z,I,D,R,U,B,$,q,V,W,H,G,J;t.phases.warm.actions=null!==(F=null===(C=t.phases.warm)||void 0===C?void 0:C.actions)&&void 0!==F?F:{};const l=t.phases.warm;var Y;if(null!==(z=i.phases.warm)&&void 0!==z&&z.min_age&&(l.min_age=`${i.phases.warm.min_age}${a.warm.minAgeUnit}`),l.actions=ne(a.warm,l.actions,null==e||null===(I=e.phases.warm)||void 0===I?void 0:I.actions,null===(D=i.phases.warm)||void 0===D||null===(R=D.actions)||void 0===R||null===(U=R.allocate)||void 0===U?void 0:U.number_of_replicas),null!==(B=i.phases.warm)&&void 0!==B&&null!==($=B.actions)&&void 0!==$&&$.forcemerge?a.warm.bestCompression?l.actions.forcemerge.index_codec="best_compression":delete l.actions.forcemerge.index_codec:delete l.actions.forcemerge,a.warm.readonlyEnabled?l.actions.readonly=null!==(Y=l.actions.readonly)&&void 0!==Y?Y:{}:delete l.actions.readonly,null!==(q=i.phases.warm)&&void 0!==q&&null!==(V=q.actions)&&void 0!==V&&V.set_priority||delete l.actions.set_priority,null!==(W=i.phases.warm)&&void 0!==W&&null!==(H=W.actions)&&void 0!==H&&H.shrink)if(a.warm.shrink.isUsingShardSize){var K,Q;delete l.actions.shrink.number_of_shards,l.actions.shrink.max_primary_shard_size=`${null===(K=l.actions.shrink)||void 0===K?void 0:K.max_primary_shard_size}${null===(Q=a.warm)||void 0===Q?void 0:Q.shrink.maxPrimaryShardSizeUnits}`}else delete l.actions.shrink.max_primary_shard_size;else delete l.actions.shrink;null!==(G=a.warm)&&void 0!==G&&null!==(J=G.downsample)&&void 0!==J&&J.enabled?l.actions.downsample={...l.actions.downsample,fixed_interval:`${a.warm.downsample.fixedIntervalSize}${a.warm.downsample.fixedIntervalUnits}`}:delete l.actions.downsample}else delete t.phases.warm;if(a.cold.enabled){var Z,X,ee,te,ae,ie,le,se,oe,re,ce,de,ue;t.phases.cold.actions=null!==(Z=null===(X=t.phases.cold)||void 0===X?void 0:X.actions)&&void 0!==Z?Z:{};const l=t.phases.cold;var me;null!==(ee=i.phases.cold)&&void 0!==ee&&ee.min_age&&(l.min_age=`${i.phases.cold.min_age}${a.cold.minAgeUnit}`),l.actions=ne(a.cold,l.actions,null==e||null===(te=e.phases.cold)||void 0===te?void 0:te.actions,null===(ae=i.phases.cold)||void 0===ae||null===(ie=ae.actions)||void 0===ie||null===(le=ie.allocate)||void 0===le?void 0:le.number_of_replicas),l.actions.freeze&&delete l.actions.freeze,a.cold.readonlyEnabled?l.actions.readonly=null!==(me=l.actions.readonly)&&void 0!==me?me:{}:delete l.actions.readonly,null!==(se=i.phases.cold)&&void 0!==se&&null!==(oe=se.actions)&&void 0!==oe&&oe.set_priority||delete l.actions.set_priority,null!==(re=i.phases.cold)&&void 0!==re&&null!==(ce=re.actions)&&void 0!==ce&&ce.searchable_snapshot?l.actions.searchable_snapshot={...l.actions.searchable_snapshot,snapshot_repository:a.searchableSnapshot.repository}:delete l.actions.searchable_snapshot,null!==(de=a.cold)&&void 0!==de&&null!==(ue=de.downsample)&&void 0!==ue&&ue.enabled?l.actions.downsample={...l.actions.downsample,fixed_interval:`${a.cold.downsample.fixedIntervalSize}${a.cold.downsample.fixedIntervalUnits}`}:delete l.actions.downsample}else delete t.phases.cold;if(null!==(o=a.frozen)&&void 0!==o&&o.enabled){var pe,he,xe,ge,be;t.phases.frozen.actions=null!==(pe=null===(he=t.phases.frozen)||void 0===he?void 0:he.actions)&&void 0!==pe?pe:{};const e=t.phases.frozen;null!==(xe=i.phases.frozen)&&void 0!==xe&&xe.min_age&&(e.min_age=`${i.phases.frozen.min_age}${a.frozen.minAgeUnit}`),null!==(ge=i.phases.frozen)&&void 0!==ge&&null!==(be=ge.actions)&&void 0!==be&&be.searchable_snapshot?e.actions.searchable_snapshot={...e.actions.searchable_snapshot,snapshot_repository:a.searchableSnapshot.repository}:delete e.actions.searchable_snapshot}else delete t.phases.frozen;if(a.delete.enabled){var fe,je,ye,ve,Oe;const e=t.phases.delete;e.actions=null!==(fe=e.actions)&&void 0!==fe?fe:{},e.actions.delete=null!==(je=e.actions.delete)&&void 0!==je?je:{},null!==(ye=i.phases.delete)&&void 0!==ye&&ye.min_age&&(e.min_age=`${i.phases.delete.min_age}${a.delete.minAgeUnit}`),null!==(ve=i.phases.delete)&&void 0!==ve&&null!==(Oe=ve.actions)&&void 0!==Oe&&Oe.wait_for_snapshot||delete e.actions.wait_for_snapshot}else delete t.phases.delete}))};var e}),[a,s]),v=Object(i.useMemo)((()=>(e=>t=>{var a,i,l,s,o,n,r,c,d,u,m,p,h;const{phases:{hot:x,warm:g,cold:b,frozen:f,delete:j}}=t;let y=X([null==x?void 0:x.actions.searchable_snapshot,null==b?void 0:b.actions.searchable_snapshot,null==f?void 0:f.actions.searchable_snapshot]);!y&&e&&(y=le);const v={hot:{isUsingDefaultRollover:G(t),customRollover:{enabled:Boolean(null==x||null===(a=x.actions)||void 0===a?void 0:a.rollover)},bestCompression:"best_compression"===(null==x||null===(i=x.actions)||void 0===i||null===(l=i.forcemerge)||void 0===l?void 0:l.index_codec),readonlyEnabled:Boolean(null==x||null===(s=x.actions)||void 0===s?void 0:s.readonly),shrink:{isUsingShardSize:Boolean(null==x||null===(o=x.actions.shrink)||void 0===o?void 0:o.max_primary_shard_size)},downsample:{enabled:Boolean(null==x||null===(n=x.actions)||void 0===n?void 0:n.downsample)}},warm:{enabled:Boolean(g),warmPhaseOnRollover:void 0===g||Boolean("0ms"===g.min_age),bestCompression:"best_compression"===(null==g||null===(r=g.actions)||void 0===r||null===(c=r.forcemerge)||void 0===c?void 0:c.index_codec),dataTierAllocationType:H(null==g?void 0:g.actions),readonlyEnabled:Boolean(null==g||null===(d=g.actions)||void 0===d?void 0:d.readonly),minAgeToMilliSeconds:-1,shrink:{isUsingShardSize:Boolean(null==g||null===(u=g.actions.shrink)||void 0===u?void 0:u.max_primary_shard_size)},downsample:{enabled:Boolean(null==g||null===(m=g.actions)||void 0===m?void 0:m.downsample)}},cold:{enabled:Boolean(b),dataTierAllocationType:H(null==b?void 0:b.actions),readonlyEnabled:Boolean(null==b||null===(p=b.actions)||void 0===p?void 0:p.readonly),minAgeToMilliSeconds:-1,downsample:{enabled:Boolean(null==b||null===(h=b.actions)||void 0===h?void 0:h.downsample)}},frozen:{enabled:Boolean(f),dataTierAllocationType:H(null==f?void 0:f.actions),minAgeToMilliSeconds:-1},delete:{enabled:Boolean(j),minAgeToMilliSeconds:-1},searchableSnapshot:{repository:y}};return Object(W.produce)({...t,_meta:v},(e=>{var t,a,i,l,s,o;if(null!==(t=e.phases.hot)&&void 0!==t&&null!==(a=t.actions)&&void 0!==a&&a.rollover){if(e.phases.hot.actions.rollover.max_size){const t=$(e.phases.hot.actions.rollover.max_size);e.phases.hot.actions.rollover.max_size=t.size,e._meta.hot.customRollover.maxStorageSizeUnit=t.units}if(e.phases.hot.actions.rollover.max_primary_shard_size){const t=$(e.phases.hot.actions.rollover.max_primary_shard_size);e.phases.hot.actions.rollover.max_primary_shard_size=t.size,e._meta.hot.customRollover.maxPrimaryShardSizeUnit=t.units}if(e.phases.hot.actions.rollover.max_age){const t=$(e.phases.hot.actions.rollover.max_age);e.phases.hot.actions.rollover.max_age=t.size,e._meta.hot.customRollover.maxAgeUnit=t.units}}if(null!==(i=e.phases.hot)&&void 0!==i&&null!==(l=i.actions.shrink)&&void 0!==l&&l.max_primary_shard_size){const t=$(e.phases.hot.actions.shrink.max_primary_shard_size);e.phases.hot.actions.shrink.max_primary_shard_size=t.size,e._meta.hot.shrink.maxPrimaryShardSizeUnits=t.units}if(null!==(s=e.phases.hot)&&void 0!==s&&null!==(o=s.actions.downsample)&&void 0!==o&&o.fixed_interval){const t=$(e.phases.hot.actions.downsample.fixed_interval);e._meta.hot.downsample.fixedIntervalUnits=t.units,e._meta.hot.downsample.fixedIntervalSize=t.size}if(e.phases.warm){var n,r,c,d,u;if(null!==(n=e.phases.warm.actions)&&void 0!==n&&null!==(r=n.allocate)&&void 0!==r&&r.require&&Object.entries(e.phases.warm.actions.allocate.require).forEach((t=>{e._meta.warm.allocationNodeAttribute=t.join(":")})),e.phases.warm.min_age){const t=$(e.phases.warm.min_age);e.phases.warm.min_age=t.size,e._meta.warm.minAgeUnit=t.units}if(null!==(c=e.phases.warm.actions.shrink)&&void 0!==c&&c.max_primary_shard_size){const t=$(e.phases.warm.actions.shrink.max_primary_shard_size);e.phases.warm.actions.shrink.max_primary_shard_size=t.size,e._meta.warm.shrink.maxPrimaryShardSizeUnits=t.units}if(null!==(d=e.phases.warm)&&void 0!==d&&null!==(u=d.actions.downsample)&&void 0!==u&&u.fixed_interval){const t=$(e.phases.warm.actions.downsample.fixed_interval);e._meta.warm.downsample.fixedIntervalUnits=t.units,e._meta.warm.downsample.fixedIntervalSize=t.size}}if(e.phases.cold){var m,p,h,x;if(null!==(m=e.phases.cold.actions)&&void 0!==m&&null!==(p=m.allocate)&&void 0!==p&&p.require&&Object.entries(e.phases.cold.actions.allocate.require).forEach((t=>{e._meta.cold.allocationNodeAttribute=t.join(":")})),e.phases.cold.min_age){const t=$(e.phases.cold.min_age);e.phases.cold.min_age=t.size,e._meta.cold.minAgeUnit=t.units}if(null!==(h=e.phases.cold)&&void 0!==h&&null!==(x=h.actions.downsample)&&void 0!==x&&x.fixed_interval){const t=$(e.phases.cold.actions.downsample.fixed_interval);e._meta.cold.downsample.fixedIntervalUnits=t.units,e._meta.cold.downsample.fixedIntervalSize=t.size}}if(e.phases.frozen&&e.phases.frozen.min_age){const t=$(e.phases.frozen.min_age);e.phases.frozen.min_age=t.size,e._meta.frozen.minAgeUnit=t.units}if(e.phases.delete&&e.phases.delete.min_age){const t=$(e.phases.delete.min_age);e.phases.delete.min_age=t.size,e._meta.delete.minAgeUnit=t.units}}))})(f)),[f]),O=Object(i.useMemo)((()=>({...s,name:g})),[s,g]),M=Object(i.useMemo)((()=>(e=>({_meta:{hot:{isUsingDefaultRollover:{defaultValue:!0,label:q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.isUsingDefaultRollover",{defaultMessage:"Use recommended defaults"})},customRollover:{enabled:{defaultValue:!0,label:q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.enableRolloverLabel",{defaultMessage:"Enable rollover"})},maxStorageSizeUnit:{defaultValue:"gb"},maxPrimaryShardSizeUnit:{defaultValue:"gb"},maxAgeUnit:{defaultValue:"d"}},bestCompression:{label:re.editPolicy.bestCompressionFieldLabel},readonlyEnabled:{defaultValue:!1,label:re.editPolicy.readonlyEnabledFieldLabel},shrink:{isUsingShardSize:{defaultValue:!1},maxPrimaryShardSizeUnits:{defaultValue:"gb"}},downsample:ze("hot")},warm:{enabled:{defaultValue:!1,label:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.warmPhase.activateWarmPhaseSwitchLabel",{defaultMessage:"Activate warm phase"})},minAgeUnit:{defaultValue:"d"},minAgeToMilliSeconds:{defaultValue:-1,fieldsToValidateOnChange:["phases.warm.min_age","phases.cold.min_age","phases.frozen.min_age","phases.delete.min_age"]},bestCompression:{label:re.editPolicy.bestCompressionFieldLabel},dataTierAllocationType:{label:re.editPolicy.allocationTypeOptionsFieldLabel},allocationNodeAttribute:{label:re.editPolicy.allocationNodeAttributeFieldLabel},readonlyEnabled:{defaultValue:!1,label:re.editPolicy.readonlyEnabledFieldLabel},shrink:{isUsingShardSize:{defaultValue:!1},maxPrimaryShardSizeUnits:{defaultValue:"gb"}},downsample:ze("warm")},cold:{enabled:{defaultValue:!1,label:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.coldPhase.activateColdPhaseSwitchLabel",{defaultMessage:"Activate cold phase"})},readonlyEnabled:{defaultValue:!1,label:re.editPolicy.readonlyEnabledFieldLabel},minAgeUnit:{defaultValue:"d"},minAgeToMilliSeconds:{defaultValue:-1,fieldsToValidateOnChange:["phases.cold.min_age","phases.frozen.min_age","phases.delete.min_age"]},dataTierAllocationType:{label:re.editPolicy.allocationTypeOptionsFieldLabel},allocationNodeAttribute:{label:re.editPolicy.allocationNodeAttributeFieldLabel},downsample:ze("cold")},frozen:{enabled:{defaultValue:!1,label:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.frozenPhase.activateFrozenPhaseSwitchLabel",{defaultMessage:"Activate frozen phase"})},minAgeUnit:{defaultValue:"d"},minAgeToMilliSeconds:{defaultValue:-1,fieldsToValidateOnChange:["phases.frozen.min_age","phases.delete.min_age"]},dataTierAllocationType:{label:re.editPolicy.allocationTypeOptionsFieldLabel},allocationNodeAttribute:{label:re.editPolicy.allocationNodeAttributeFieldLabel}},delete:{enabled:{defaultValue:!1,label:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.deletePhase.activateWarmPhaseSwitchLabel",{defaultMessage:"Activate delete phase"})},minAgeUnit:{defaultValue:"d"},minAgeToMilliSeconds:{defaultValue:-1,fieldsToValidateOnChange:["phases.delete.min_age"]}},searchableSnapshot:{repository:{defaultValue:e?le:""}}},phases:{hot:{actions:{rollover:{max_age:{label:q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumAgeLabel",{defaultMessage:"Maximum age"}),validations:[{validator:fe},{validator:he},{validator:je}],fieldsToValidateOnChange:Oe},max_docs:{label:q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumDocumentsLabel",{defaultMessage:"Maximum documents"}),validations:[{validator:fe},{validator:he},{validator:je}],serializer:_e.stringToNumber,fieldsToValidateOnChange:Oe},max_primary_shard_size:{label:re.editPolicy.maxPrimaryShardSizeLabel,validations:[{validator:fe},{validator:he}],fieldsToValidateOnChange:Oe},max_primary_shard_docs:{label:re.editPolicy.maxPrimaryShardDocsLabel,validations:[{validator:fe},{validator:he},{validator:je}],serializer:_e.stringToNumber,fieldsToValidateOnChange:Oe},max_size:{label:q.i18n.translate("xpack.indexLifecycleMgmt.hotPhase.maximumIndexSizeLabel",{defaultMessage:"Maximum index size"}),validations:[{validator:fe},{validator:he}],fieldsToValidateOnChange:Oe}},forcemerge:{max_num_segments:Te},shrink:{number_of_shards:Le,max_primary_shard_size:Se},set_priority:{priority:Ee("hot")},searchable_snapshot:ke}},warm:{min_age:Fe("warm"),actions:{allocate:{number_of_replicas:we},shrink:{number_of_shards:Le,max_primary_shard_size:Se},forcemerge:{max_num_segments:Te},set_priority:{priority:Ee("warm")}}},cold:{min_age:Fe("cold"),actions:{allocate:{number_of_replicas:we},set_priority:{priority:Ee("cold")},searchable_snapshot:ke}},frozen:{min_age:Fe("frozen"),actions:{allocate:{number_of_replicas:we},set_priority:{priority:Ee("frozen")},searchable_snapshot:ke}},delete:{min_age:Fe("delete","365"),actions:{wait_for_snapshot:{policy:{label:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.waitForSnapshot.snapshotPolicyFieldLabel",{defaultMessage:"Policy name (optional)"})}}}}}}))(f)),[f]),{form:P}=Object(n.useForm)({schema:M,defaultValue:O,deserializer:v,serializer:y}),[k]=Object(n.useFormData)({form:P,watch:Ua}),w=()=>a||p?Object(A.get)(k,Ua):g,L=Object(i.useMemo)((()=>(({policies:e,isClonedPolicy:t,originalPolicyName:a})=>[{validator:ue(re.editPolicy.errors.policyNameRequiredMessage)},{validator:me({message:re.editPolicy.errors.policyNameStartsWithUnderscoreErrorMessage,char:"_"})},{validator:de({message:re.editPolicy.errors.policyNameContainsInvalidChars,chars:[","," "]})},{validator:e=>{const t=e.value;if(window.TextEncoder&&(new window.TextEncoder).encode(t).length>255)return{message:re.editPolicy.errors.policyNameTooLongErrorMessage}}},{validator:i=>{const l=i.value;return t&&l===a?{message:re.editPolicy.errors.policyNameMustBeDifferentErrorMessage}:l!==a&&e.map((e=>e.name)).includes(l)?{message:re.editPolicy.errors.policyNameAlreadyUsedErrorMessage}:void 0}}])({originalPolicyName:g,policies:o,isClonedPolicy:p})),[g,o,p]),S=Object(T.useHistory)(),E=()=>{S.push("/policies")};return Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiPageHeader,{pageTitle:Object(x.jsx)("span",{"data-test-subj":"policyTitle"},a?q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.createPolicyMessage",{defaultMessage:"Create policy"}):q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.editPolicyMessage",{defaultMessage:"Edit policy {originalPolicyName}",values:{originalPolicyName:g}})),bottomBorder:!0,rightSideItems:[Object(x.jsx)(j.EuiButtonEmpty,{href:m.links.elasticsearch.ilm,target:"_blank",iconType:"help"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.documentationLinkText",defaultMessage:"Documentation"}))]}),Object(x.jsx)(j.EuiSpacer,{size:"l"}),Object(x.jsx)(Ze,{form:P},a?null:Object(x.jsx)(i.Fragment,null,Object(x.jsx)(zt,null),Object(x.jsx)(j.EuiSpacer,null),Object(x.jsx)(j.EuiFormRow,null,Object(x.jsx)(j.EuiSwitch,{"data-test-subj":"saveAsNewSwitch",style:{maxWidth:"100%"},checked:p,onChange:e=>{h(e.target.checked)},label:Object(x.jsx)("span",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.saveAsNewPolicyMessage",defaultMessage:"Save as new policy"}))}))),p||a?Object(x.jsx)(st,{path:Ua,config:{label:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.policyNameLabel",{defaultMessage:"Policy name"}),helpText:q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.validPolicyNameMessage",{defaultMessage:"A policy name cannot start with an underscore and cannot contain a comma or a space."}),validations:L},component:c.TextField,componentProps:{fullWidth:!1,euiFieldProps:{"data-test-subj":"policyNameField"}}}):null,Object(x.jsx)(j.EuiHorizontalRule,null),Object(x.jsx)(yt,null),Object(x.jsx)(j.EuiSpacer,{size:"l"}),Object(x.jsx)(j.EuiTimeline,{className:"ilmPhases"},Object(x.jsx)(Ca,null),Object(x.jsx)(Aa,null),Object(x.jsx)(Da,null),b&&Object(x.jsx)(Na,null),Object(x.jsx)(Ra,null)),Object(x.jsx)(j.EuiHorizontalRule,null),Object(x.jsx)(Ot,null),Object(x.jsx)(j.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiFlexGroup,null,Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiButton,{"data-test-subj":"savePolicyButton",fill:!0,iconType:"check",iconSide:"left",disabled:!1===P.isValid||P.isSubmitting,onClick:async()=>{const{data:e,isValid:t}=await P.submit();t?await(async(e,t)=>{try{await Object(B.g)(e)}catch(t){const a=q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.saveErrorMessage",{defaultMessage:"Error saving lifecycle policy {lifecycleName}",values:{lifecycleName:e.name}});return Object(nt.a)(t,a),!1}const a=Object(ot.a)(e.phases);a.push(t?N.j:N.m),Object(ot.c)(D.METRIC_TYPE.COUNT,a);const i=q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.successfulSaveMessage",{defaultMessage:'{verb} lifecycle policy "{lifecycleName}"',values:{verb:t?q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.createdMessage",{defaultMessage:"Created"}):q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.updatedMessage",{defaultMessage:"Updated"}),lifecycleName:e.name}});return V.c.addSuccess(i),!0})({...e,name:w()},a||p)&&E():V.c.addDanger(q.i18n.translate("xpack.indexLifecycleMgmt.editPolicy.formErrorsMessage",{defaultMessage:"Please fix the errors on this page."}))}},p?Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.saveAsNewButton",defaultMessage:"Save as new policy"}):Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.saveButton",defaultMessage:"Save policy"}))),Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiButtonEmpty,{"data-test-subj":"cancelTestPolicy",onClick:E},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.cancelButton",defaultMessage:"Cancel"}))))),Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiButtonEmpty,{onClick:()=>{t(!e)},"data-test-subj":"requestButton"},e?Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.hidePolicyJsonButton",defaultMessage:"Hide request"}):Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.showPolicyJsonButton",defaultMessage:"Show request"})))),e?Object(x.jsx)(dt,{policyName:w(),close:()=>t(!1)}):null))},$a=({match:{params:{policyName:e}}})=>{var t;const{services:{breadcrumbService:a,license:l}}=_(),{error:s,isLoading:o,data:n,resendRequest:r}=Object(B.k)();if(Object(i.useEffect)((()=>{a.setBreadcrumbs("editPolicy")}),[a]),o)return Object(x.jsx)(j.EuiPageTemplate.EmptyPrompt,{title:Object(x.jsx)(j.EuiLoadingSpinner,{size:"xl"}),body:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.policiesLoading",defaultMessage:"Loading policies..."})});if(s||!n){const{statusCode:e,message:t}=s||{statusCode:"",message:""};return Object(x.jsx)(j.EuiPageTemplate.EmptyPrompt,{color:"danger",title:Object(x.jsx)("h2",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.lifecyclePoliciesLoadingFailedTitle",defaultMessage:"Unable to load existing lifecycle policies"})),body:Object(x.jsx)("p",null,t," (",e,")"),actions:Object(x.jsx)(j.EuiButton,{onClick:r,iconType:"refresh",color:"danger"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.lifecyclePoliciesReloadButton",defaultMessage:"Try again"}))})}const c=((e,t="")=>{if(e&&e.length>0)return e.find((e=>e.name===t))})(n,Object(d.attemptToURIDecode)(e));return Object(x.jsx)(Lt,{value:{isNewPolicy:!(null!=c&&c.policy),policyName:Object(d.attemptToURIDecode)(e),policy:null!==(t=null==c?void 0:c.policy)&&void 0!==t?t:N.o,existingPolicies:n,license:{canUseSearchableSnapshot:()=>l.hasAtLeast(U.a)},indices:c&&c.indices?c.indices:[],indexTemplates:c&&c.indexTemplates?c.indexTemplates:[]}},Object(x.jsx)(Ba,null))};const qa=Object(i.createContext)({listAction:null,setListAction:()=>{}}),Va=({children:e})=>{const[t,a]=Object(i.useState)(null);return Object(x.jsx)(qa.Provider,{value:{listAction:t,setListAction:a}},e)},Wa=()=>{const e=Object(i.useContext)(qa);if(!e)throw new Error("usePolicyListContext can only be called inside of PolicyListContext!");return e},Ha={deleteEnabled:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.deletePolicyButtonText",{defaultMessage:"Delete policy"}),deleteDisabled:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.deletePolicyButtonDisabledTooltip",{defaultMessage:"You cannot delete a policy that is being used by an index"}),viewIndices:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.viewIndicesButtonText",{defaultMessage:"View indices linked to policy"}),addIndexTemplate:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addPolicyToTemplateButtonText",{defaultMessage:"Add policy to index template"})},Ga={badge:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.templateBadgeType.managedLabel",{defaultMessage:"Managed"}),badgeTooltip:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.templateBadgeType.managedDescription",{defaultMessage:"This policy is preconfigured and managed by Elastic; editing or deleting this policy might break Kibana."})},Ja=({policies:e})=>{const t=Object(T.useHistory)(),{services:{getUrlForApp:a}}=_(),[s,n]=function(e,t){const a=localStorage.getItem(e),[l,s]=Object(i.useState)(function(e,t){if(!e)return t;try{return JSON.parse(e)}catch(e){return t}}(a,t));return Object(i.useEffect)((()=>{localStorage.setItem(e,JSON.stringify(l))}),[e,l]),[l,s]}("ILM_SHOW_MANAGED_POLICIES_BY_DEFAULT",!1),{setListAction:r}=Wa(),c=Object(i.useMemo)((()=>({box:{incremental:!0,"data-test-subj":"ilmSearchBar"},toolsRight:Object(x.jsx)(j.EuiFlexItem,{grow:!1},Object(x.jsx)(j.EuiSwitch,{id:"checkboxShowHiddenIndices","data-test-subj":"includeHiddenPoliciesSwitch",checked:s,onChange:e=>n(e.target.checked),label:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.hiddenPoliciesSwitchLabel",defaultMessage:"Include managed system policies"})}))})),[s,n]),d=Object(i.useMemo)((()=>s?e:e.filter((e=>{var t,a;return!(null!==(t=e.policy)&&void 0!==t&&null!==(a=t._meta)&&void 0!==a&&a.managed)}))),[e,s]),u=[{"data-test-subj":"policy-name",field:"name",name:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.headers.nameHeader",{defaultMessage:"Name"}),sortable:!0,render:(e,a)=>{var i,s;const n=null===(i=a.policy)||void 0===i||null===(s=i._meta)||void 0===s?void 0:s.managed;return Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(j.EuiLink,m()({className:"eui-textBreakAll","data-test-subj":"policyTablePolicyNameLink"},Object(o.reactRouterNavigate)(t,Object(Et.e)(e),(()=>Object(ot.c)(D.METRIC_TYPE.CLICK,N.f)))),e),n&&Object(x.jsx)(l.a.Fragment,null," ",Object(x.jsx)(j.EuiToolTip,{content:Ga.badgeTooltip},Object(x.jsx)(j.EuiBadge,{color:"hollow","data-test-subj":"managedPolicyBadge"},Ga.badge))))}},{"data-test-subj":"policy-indexTemplates",field:"indexTemplates",name:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.headers.indexTemplatesHeader",{defaultMessage:"Linked index templates"}),sortable:({indexTemplates:e})=>(null!=e?e:[]).length,render:(e,t)=>e&&e.length>0?Object(x.jsx)(j.EuiToolTip,{content:Ha.viewIndices,position:"left"},Object(x.jsx)(j.EuiButtonEmpty,{flush:"both","data-test-subj":"viewIndexTemplates",onClick:()=>r({selectedPolicy:t,actionType:"viewIndexTemplates"})},e.length)):"0"},{"data-test-subj":"policy-indices",field:"indices",name:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.headers.linkedIndicesHeader",{defaultMessage:"Linked indices"}),sortable:({indices:e})=>(null!=e?e:[]).length,render:(e,t)=>e&&e.length>0?Object(x.jsx)(j.EuiToolTip,{content:Ha.viewIndices,position:"left"},Object(x.jsx)(j.EuiLink,{href:Object(Et.b)(t.name,a)},e.length)):"0"},{"data-test-subj":"policy-modifiedDate",field:"modifiedDate",name:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.headers.modifiedDateHeader",{defaultMessage:"Modified date"}),sortable:!0,render:e=>e?Y()(e).format("MMM D, YYYY"):e},{actions:[{render:e=>Object(x.jsx)(j.EuiToolTip,{content:Ha.addIndexTemplate},Object(x.jsx)(j.EuiButtonIcon,{"data-test-subj":"addPolicyToTemplate",onClick:()=>r({selectedPolicy:e,actionType:"addIndexTemplate"}),iconType:"plusInCircle","aria-label":Ha.addIndexTemplate}))},{render:(e,t)=>Object(x.jsx)(j.EuiToolTip,{content:t?Ha.deleteEnabled:Ha.deleteDisabled},Object(x.jsx)(j.EuiButtonIcon,{"data-test-subj":"deletePolicy",onClick:()=>r({selectedPolicy:e,actionType:"deletePolicy"}),iconType:"trash","aria-label":Ha.deleteEnabled,disabled:!t})),enabled:e=>!(e=>Boolean(e.indices&&e.indices.length))(e)}],name:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.headers.actionsHeader",{defaultMessage:"Actions"})}];return Object(x.jsx)(j.EuiInMemoryTable,{tableCaption:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.captionText",{defaultMessage:"The table below contains {count, plural, one {# Index Lifecycle policy} other {# Index Lifecycle policies}} .",values:{count:e.length}}),pagination:!0,sorting:{sort:{field:"name",direction:"asc"}},search:c,tableLayout:"auto",items:d,columns:u,rowProps:e=>({"data-test-subj":`policyTableRow-${e.name}`})})};var Ya=a(6),Ka=a.n(Ya);class confirm_delete_ConfirmDelete extends i.Component{constructor(...e){super(...e),Ka()(this,"state",{isDeleteConfirmed:!1}),Ka()(this,"setIsDeleteConfirmed",(e=>{this.setState({isDeleteConfirmed:e})})),Ka()(this,"deletePolicy",(async()=>{const{policyToDelete:e,callback:t}=this.props,a=e.name;try{await Object(B.c)(a);const e=q.i18n.translate("xpack.indexLifecycleMgmt.confirmDelete.successMessage",{defaultMessage:"Deleted policy {policyName}",values:{policyName:a}});V.c.addSuccess(e)}catch(e){const t=q.i18n.translate("xpack.indexLifecycleMgmt.confirmDelete.errorMessage",{defaultMessage:"Error deleting policy {policyName}",values:{policyName:a}});Object(nt.a)(e,t)}t&&t()})),Ka()(this,"isPolicyPolicy",!0)}render(){var e,t;const{policyToDelete:a,onCancel:i}=this.props,{isDeleteConfirmed:l}=this.state,s=null===(e=a.policy)||void 0===e||null===(t=e._meta)||void 0===t?void 0:t.managed,o=q.i18n.translate("xpack.indexLifecycleMgmt.confirmDelete.title",{defaultMessage:'Delete policy "{name}"',values:{name:a.name}});return Object(x.jsx)(j.EuiConfirmModal,{"data-test-subj":"deletePolicyModal",title:o,onCancel:i,onConfirm:this.deletePolicy,cancelButtonText:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.confirmDelete.cancelButton",defaultMessage:"Cancel"}),confirmButtonText:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.confirmDelete.deleteButton",defaultMessage:"Delete"}),buttonColor:"danger",confirmButtonDisabled:!!s&&!l},s?Object(x.jsx)(j.EuiCallOut,{title:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.deletePolicyModal.proceedWithCautionCallOutTitle",defaultMessage:"Deleting a managed policy can break Kibana"}),color:"danger",iconType:"warning","data-test-subj":"deleteManagedPolicyCallOut"},Object(x.jsx)("p",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.deletePolicyModal.proceedWithCautionCallOutDescription",defaultMessage:"Managed policies are critical for internal operations. If you delete this managed policy, you can’t recover it."})),Object(x.jsx)(j.EuiCheckbox,{id:"confirmDeletePolicyCheckbox",label:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.deletePolicyModal.confirmDeleteCheckboxLabel",defaultMessage:"I understand the consequences of deleting a managed policy"}),checked:l,onChange:e=>this.setIsDeleteConfirmed(e.target.checked)})):Object(x.jsx)("div",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.confirmDelete.undoneWarning",defaultMessage:"You can't recover a deleted policy."})))}}const Qa=({policy:e,onSuccess:t,onCancel:a})=>{const[s,o]=Object(i.useState)(!1),[n,r]=Object(i.useState)(""),[c,d]=Object(i.useState)(""),[u,m]=Object(i.useState)(""),{error:p,isLoading:h,data:g,resendRequest:b}=Object(B.h)(s),f=q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.title",{defaultMessage:'Add policy "{name}" to index template',values:{name:e.name}}),{docLinks:y}=_().services;return Object(x.jsx)(j.EuiConfirmModal,{"data-test-subj":"addPolicyToTemplateModal",title:f,onCancel:a,onConfirm:async()=>{const a=e.name;if(n)try{await Object(B.b)({policyName:a,templateName:n,aliasName:""===c?void 0:c},s);const e=q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.successMessage",{defaultMessage:"Added policy {policyName} to index template {templateName}",values:{policyName:a,templateName:n}});V.c.addSuccess(e),t(n)}catch(e){const t=q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.errorMessage",{defaultMessage:'Error adding policy "{policyName}" to index template {templateName}',values:{policyName:a,templateName:n}});Object(nt.a)(e,t)}else m(q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.noTemplateSelectedErrorMessage",{defaultMessage:"You must select an index template."}))},cancelButtonText:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.confirmButton",{defaultMessage:"Add policy"}),confirmButtonDisabled:h||!!p||!g},Object(x.jsx)(j.EuiText,null,Object(x.jsx)("p",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.explanationText",defaultMessage:"This will apply the lifecycle policy to all indices which match the index template."})," ",Object(x.jsx)(rt,{docPath:y.links.elasticsearch.indexTemplates,text:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.editPolicy.learnAboutIndexTemplatesLink",defaultMessage:"Learn about index templates"})}))),Object(x.jsx)(j.EuiSpacer,{size:"m"}),(()=>{let t=[];return g&&(t=g.map((({name:e})=>({label:e})))),Object(x.jsx)(j.EuiForm,null,Object(x.jsx)(j.EuiFormRow,null,Object(x.jsx)(j.EuiSwitch,{label:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.showLegacyTemplates",defaultMessage:"Show legacy index templates"}),checked:s,onChange:e=>{r(""),o(e.target.checked)}})),p?(()=>{const{statusCode:e="",message:t=""}=p;return Object(x.jsx)(i.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(j.EuiCallOut,{style:{maxWidth:400},title:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.errorLoadingTemplatesTitle",defaultMessage:"Unable to load index templates"}),color:"danger"},Object(x.jsx)("p",null,t," (",e,")"),Object(x.jsx)(j.EuiButton,{isLoading:h,color:"danger",onClick:b},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyToTemplateConfirmModal.errorLoadingTemplatesButton",defaultMessage:"Try again"}))),Object(x.jsx)(j.EuiSpacer,{size:"s"}))})():Object(x.jsx)(l.a.Fragment,null,(()=>{var e,t,a;const l=null==g?void 0:g.find((e=>e.name===n)),s=null==l||null===(e=l.settings)||void 0===e||null===(t=e.index)||void 0===t||null===(a=t.lifecycle)||void 0===a?void 0:a.name;if(s)return Object(x.jsx)(i.Fragment,null,Object(x.jsx)(j.EuiSpacer,{size:"s"}),Object(x.jsx)(j.EuiCallOut,{style:{maxWidth:400},title:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.templateHasPolicyWarningTitle",defaultMessage:"Template already has policy"}),color:"warning"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.indexManagementTable.addLifecyclePolicyToTemplateConfirmModal.indexHasNoAliasesWarningMessage",defaultMessage:"This index template already has the policy {existingPolicyName} attached to it. Adding this policy will overwrite that configuration.",values:{existingPolicyName:s}})),Object(x.jsx)(j.EuiSpacer,{size:"s"}))})(),Object(x.jsx)(j.EuiFormRow,{isInvalid:!!u,error:u,label:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.chooseTemplateLabel",defaultMessage:"Index template"})},Object(x.jsx)(j.EuiComboBox,{isLoading:h,placeholder:q.i18n.translate("xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.chooseTemplateMessage",{defaultMessage:"Select an index template"}),options:t,selectedOptions:n?[{label:n}]:[],onChange:e=>{m(""),r(e.length>0?e[0].label:"")},singleSelection:{asPlainText:!0},isClearable:!0}))),(null===(a=e.policy.phases.hot)||void 0===a?void 0:a.actions.rollover)?Object(x.jsx)(j.EuiFormRow,{label:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.addLifecyclePolicyToTemplateConfirmModal.rolloverAliasLabel",defaultMessage:"Alias for rollover index"})},Object(x.jsx)(j.EuiFieldText,{value:c,onChange:e=>{d(e.target.value)}})):null);var a})())},Za=({updatePolicies:e})=>{const{listAction:t,setListAction:a}=Wa();var i;return"viewIndexTemplates"===(null==t?void 0:t.actionType)?Object(x.jsx)(Ct,{policyName:t.selectedPolicy.name,indexTemplates:null!==(i=t.selectedPolicy.indexTemplates)&&void 0!==i?i:[],close:()=>{a(null)}}):"deletePolicy"===(null==t?void 0:t.actionType)?Object(x.jsx)(confirm_delete_ConfirmDelete,{policyToDelete:t.selectedPolicy,callback:()=>{e(),a(null)},onCancel:()=>{a(null)}}):"addIndexTemplate"===(null==t?void 0:t.actionType)?Object(x.jsx)(Qa,{policy:t.selectedPolicy,onSuccess:e=>{t.selectedPolicy.indexTemplates=[...t.selectedPolicy.indexTemplates||[],e],a(null)},onCancel:()=>a(null)}):null},Xa=({policies:e,updatePolicies:t})=>{const a=Object(T.useHistory)(),s=Object(x.jsx)(j.EuiButton,m()({},Object(o.reactRouterNavigate)(a,Object(Et.d)()),{fill:!0,iconType:"plusInCircle","data-test-subj":"createPolicyButton"}),Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.emptyPrompt.createButtonLabel",defaultMessage:"Create policy"}));return 0===e.length?Object(x.jsx)(j.EuiPageTemplate.EmptyPrompt,{iconType:"managementApp",title:Object(x.jsx)("h1",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.emptyPromptTitle",defaultMessage:"Create your first index lifecycle policy"})),body:Object(x.jsx)(i.Fragment,null,Object(x.jsx)("p",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.emptyPromptDescription",defaultMessage:" An index lifecycle policy helps you manage your indices as they age."}))),actions:s}):Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(Za,{updatePolicies:t}),Object(x.jsx)(j.EuiPageHeader,{pageTitle:Object(x.jsx)("span",{"data-test-subj":"ilmPageHeader"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.sectionHeading",defaultMessage:"Index Lifecycle Policies"})),description:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.sectionDescription",defaultMessage:"Manage your indices as they age.  Attach a policy to automate when and how to transition an index through its lifecycle."}),bottomBorder:!0,rightSideItems:[s]}),Object(x.jsx)(j.EuiSpacer,{size:"l"}),Object(x.jsx)(Ja,{policies:e}))},ei=()=>{const{services:{breadcrumbService:e}}=_(),{data:t,isLoading:a,error:l,resendRequest:s}=Object(B.k)();if(Object(i.useEffect)((()=>{e.setBreadcrumbs("policies")}),[e]),a)return Object(x.jsx)(j.EuiPageTemplate.EmptyPrompt,{title:Object(x.jsx)(j.EuiLoadingSpinner,{size:"xl"}),body:Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.policiesLoading",defaultMessage:"Loading policies..."})});if(l){const{statusCode:e,message:t}=l||{statusCode:"",message:""};return Object(x.jsx)(j.EuiPageTemplate.EmptyPrompt,{color:"danger",title:Object(x.jsx)("h2",null,Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.policiesLoadingFailedTitle",defaultMessage:"Unable to load existing lifecycle policies"})),body:Object(x.jsx)("p",null,t," (",e,")"),actions:Object(x.jsx)(j.EuiButton,{onClick:s,iconType:"refresh",color:"danger"},Object(x.jsx)(R.FormattedMessage,{id:"xpack.indexLifecycleMgmt.policyTable.policiesReloadButton",defaultMessage:"Try again"}))})}return Object(x.jsx)(Va,null,Object(x.jsx)(Xa,{policies:t||[],updatePolicies:s}))},ti=({history:e})=>(Object(i.useEffect)((()=>Object(ot.c)(D.METRIC_TYPE.LOADED,N.a)),[]),Object(x.jsx)(z,{history:e},Object(x.jsx)(I,null,Object(x.jsx)(T.Redirect,{exact:!0,from:"/",to:Et.a.list}),Object(x.jsx)(E,{exact:!0,path:Et.a.list,component:ei}),Object(x.jsx)(E,{path:Et.a.edit,component:$a})))),ai=(e,t,a,i,l,n,r,c,d,u)=>{const{getUrlForApp:m}=i;return Object(s.render)(Object(x.jsx)("div",{className:P.APP_WRAPPER_CLASS},Object(x.jsx)(M,{coreStart:{application:i}},Object(x.jsx)(t,null,Object(x.jsx)(o.KibanaThemeProvider,{theme$:r},Object(x.jsx)(o.KibanaContextProvider,{services:{cloud:u,breadcrumbService:l,license:n,getUrlForApp:m,docLinks:c,executionContext:d}},Object(x.jsx)(ti,{history:a})))))),e),()=>Object(s.unmountComponentAtNode)(e)}}])]);