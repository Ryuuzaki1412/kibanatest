(window.unifiedDocViewer_bundle_jsonpfunction=window.unifiedDocViewer_bundle_jsonpfunction||[]).push([[5],{27:function(e,t,i){"use strict";i.r(t),i(40);var l=i(1),a=i(2),n=i(5),s=i(20),o=i(6),d=i(43),c=i(19),r=i(65),u=i(66),b=i(64),f=i(67);const j=Object(o.memoize)((function(e){const t=e.trim();let i=t.split(/[* ]+/).map(o.escapeRegExp).join(".*");return t.includes(" ")&&(i=".*"+i+".*"),new RegExp(i.includes("*")?`^${i}$`:i,"i")})),g=(e,t)=>{if(null==t||!t.trim())return!1;const i=j(t);return!!e.displayName&&i.test(e.displayName)||i.test(e.name)};function p(e,t){const i=(t||"").trim();return(i.includes("*")||i.includes(" "))&&g({name:e},i)?e:i}var m=i(68),O=i(3),x=i(41),w=i(0);const V=({mode:e="as_popover",pinned:t,field:i,fieldMapping:s,flattenedField:o,onToggleColumn:d,onFilter:c,ignoredValue:r,onTogglePinned:u})=>{const[b,f]=Object(l.useState)(!1),j=n.i18n.translate("unifiedDocViewer.docView.table.actions.open",{defaultMessage:"Open actions"}),g=n.i18n.translate("unifiedDocViewer.docView.table.actions.label",{defaultMessage:"Actions"}),p=!s||!s.filterable||r||!c,m=n.i18n.translate("unifiedDocViewer.docViews.table.filterForValueButtonTooltip",{defaultMessage:"Filter for value"}),O=n.i18n.translate("unifiedDocViewer.docViews.table.filterForValueButtonAriaLabel",{defaultMessage:"Filter for value"}),x=n.i18n.translate("unifiedDocViewer.docViews.table.filterOutValueButtonTooltip",{defaultMessage:"Filter out value"}),V=n.i18n.translate("unifiedDocViewer.docViews.table.filterOutValueButtonAriaLabel",{defaultMessage:"Filter out value"}),F=p&&n.i18n.translate("unifiedDocViewer.docViews.table.unindexedFieldsCanNotBeSearchedTooltip",{defaultMessage:"Unindexed fields or ignored values cannot be searched"})||void 0,C=n.i18n.translate("unifiedDocViewer.docViews.table.filterForFieldPresentButtonTooltip",{defaultMessage:"Filter for field present"}),T=n.i18n.translate("unifiedDocViewer.docViews.table.filterForFieldPresentButtonAriaLabel",{defaultMessage:"Filter for field present"}),v=!s||!s.filterable||!c,h=v&&(s&&s.scripted?n.i18n.translate("unifiedDocViewer.docViews.table.unableToFilterForPresenceOfScriptedFieldsTooltip",{defaultMessage:"Unable to filter for presence of scripted fields"}):n.i18n.translate("unifiedDocViewer.docViews.table.unableToFilterForPresenceOfMetaFieldsTooltip",{defaultMessage:"Unable to filter for presence of meta fields"}))||void 0,k=n.i18n.translate("unifiedDocViewer.docViews.table.toggleColumnInTableButtonTooltip",{defaultMessage:"Toggle column in table"}),y=n.i18n.translate("unifiedDocViewer.docViews.table.toggleColumnInTableButtonAriaLabel",{defaultMessage:"Toggle column in table"}),P=t?n.i18n.translate("unifiedDocViewer.docViews.table.unpinFieldLabel",{defaultMessage:"Unpin field"}):n.i18n.translate("unifiedDocViewer.docViews.table.pinFieldLabel",{defaultMessage:"Pin field"}),E=t?n.i18n.translate("unifiedDocViewer.docViews.table.unpinFieldAriaLabel",{defaultMessage:"Unpin field"}):n.i18n.translate("unifiedDocViewer.docViews.table.pinFieldAriaLabel",{defaultMessage:"Pin field"}),M=t?"pinFilled":"pin",D=Object(l.useCallback)((()=>f((e=>!e))),[]),I=Object(l.useCallback)((()=>f(!1)),[]),S=Object(l.useCallback)((()=>u(i)),[i,u]),N=Object(l.useCallback)((e=>()=>{e(),I()}),[I]),B=[{id:0,title:g,items:[{name:m,"aria-label":O,toolTipContent:F,icon:"plusInCircle",disabled:p,"data-test-subj":`addFilterForValueButton-${i}`,onClick:c?N(c.bind({},s,o,"+")):void 0},{name:x,"aria-label":V,toolTipContent:F,icon:"minusInCircle",disabled:p,"data-test-subj":`addFilterOutValueButton-${i}`,onClick:c?N(c.bind({},s,o,"-")):void 0},{name:C,"aria-label":T,toolTipContent:h,icon:"filter",disabled:v,"data-test-subj":`addExistsFilterButton-${i}`,onClick:c?N(c.bind({},"_exists_",i,"+")):void 0},{name:k,"aria-label":y,"data-test-subj":`toggleColumnButton-${i}`,icon:"listAdd",onClick:N(d.bind({},i))},{name:P,"aria-label":E,icon:M,"data-test-subj":`togglePinFilterButton-${i}`,onClick:N(S)}]}];return"inline"===e?Object(w.jsx)(a.EuiFlexGroup,{responsive:!1,gutterSize:"xs",className:"kbnDocViewer__buttons","data-test-subj":`fieldActionsGroup-${i}`},B[0].items.map((e=>Object(w.jsx)(a.EuiFlexItem,{key:e.icon,grow:!1},Object(w.jsx)(a.EuiToolTip,{content:e.name},Object(w.jsx)(a.EuiButtonIcon,{className:"kbnDocViewer__actionButton","data-test-subj":e["data-test-subj"],"aria-label":e["aria-label"],iconType:e.icon,iconSize:"s",disabled:e.disabled,onClick:e.onClick})))))):Object(w.jsx)(a.EuiPopover,{button:Object(w.jsx)(a.EuiButtonIcon,{"data-test-subj":`openFieldActionsButton-${i}`,"aria-label":j,onClick:D,iconType:"boxesHorizontal",color:"text"}),isOpen:b,closePopover:I,display:"block",panelPaddingSize:"none"},Object(w.jsx)(a.EuiContextMenu,{initialPanelId:0,size:"s",panels:B}))},F={header:!1},C=[25,50,100],T="discover:pinnedFields",v="discover:pageSize",h="discover:searchText",k=e=>{const t=Number(e.get(v));return t&&C.includes(t)?t:25},y=Object(o.debounce)(((e,t)=>t.set(h,e)),500);t.default=({columns:e,columnTypes:t,hit:i,dataView:o,hideActionsColumn:j,filter:P,onAddColumn:E,onRemoveColumn:M})=>{const D=Object(a.useIsWithinBreakpoints)(["xl"],!0),{fieldFormats:I,storage:S,uiSettings:N}=Object(O.b)(),B=N.get(c.c),_=o.id,[z,A]=Object(l.useState)((e=>e.get(h)||"")(S)),[R,$]=Object(l.useState)(((e,t)=>{const i=t.get(T);return"object"==typeof i&&null!==i&&Array.isArray(i[e])?i[e].filter((e=>"string"==typeof e)):[]})(_,S)),L=i.flattened,H=Object(l.useMemo)((()=>Object(r.a)(Object.keys(L),o,B)),[L,o,B]),U=n.i18n.translate("unifiedDocViewer.docView.table.searchPlaceHolder",{defaultMessage:"Search field names"}),G=Object(l.useCallback)((e=>o.fields.getByName(e)),[o.fields]),W=Object(l.useCallback)((t=>{M&&E&&e&&(e.includes(t)?M(t):E(t))}),[M,E,e]),q=Object(l.useCallback)((e=>{const t=R.includes(e)?R.filter((t=>t!==e)):[...R,e];((e,t,i)=>{let l=i.get(T);l="object"==typeof l&&null!==l?l:{},i.set(T,{...l,[t]:e})})(t,_,S),$(t)}),[_,R,S]),J=Object(l.useCallback)((l=>{var a;const n=G(l),s=null!==(a=null==n?void 0:n.displayName)&&void 0!==a?a:l,c=t?t[l]:Object(u.a)(l,o)?"nested":n?Object(d.a)(n):void 0,r=Object(b.b)(null!=n?n:l,i.raw._ignored);return{action:{onToggleColumn:W,onFilter:P,isActive:!(null==e||!e.includes(l)),flattenedField:L[l]},field:{field:l,displayName:s,fieldMapping:n,fieldType:c,scripted:Boolean(null==n?void 0:n.scripted),pinned:R.includes(s),onTogglePinned:q},value:{formattedValue:Object(f.a)(i.flattened[l],i.raw,I,o,n),ignored:r}}}),[G,o,i,W,P,e,t,L,R,q,I]),K=Object(l.useCallback)((e=>{const t=e.currentTarget.value;y(t,S),A(t)}),[S]),{pinnedItems:Q,restItems:X}=Object.keys(L).sort(((e,t)=>{const i=G(e),l=G(t),a=i&&i.displayName?i.displayName:e,n=l&&l.displayName?l.displayName:t;return a.localeCompare(n)})).reduce(((e,t)=>{if(!H(t))return e;if(R.includes(t))e.pinnedItems.push(J(t));else{const i=G(t);null!=z&&z.trim()&&!g({name:t,displayName:null==i?void 0:i.displayName},z)||e.restItems.push(J(t))}return e}),{pinnedItems:[],restItems:[]}),{curPageIndex:Y,pageSize:Z,totalPages:ee,startIndex:te,changePageIndex:ie,changePageSize:le}=(({initialPageSize:e,totalItems:t})=>{const[i,a]=Object(l.useState)(e),[n,s]=Object(l.useState)(0),o=Object(l.useMemo)((()=>{const e=Math.ceil(t/i);return{totalPages:e,startIndex:i*n,hasNextPage:n+1<e}}),[n,i,t]),d=Object(l.useCallback)((e=>s(e)),[]),c=Object(l.useCallback)((e=>a(e)),[]);return Object(l.useEffect)((()=>{o.totalPages<n+1&&d(0)}),[n,o.totalPages,d]),Object(l.useMemo)((()=>({...o,curPageIndex:n,pageSize:i,changePageIndex:d,changePageSize:c})),[d,c,n,o,i])})({initialPageSize:k(S),totalItems:X.length}),ae=0!==ee,ne=Object(l.useCallback)((e=>{((e,t)=>{t.set(v,e)})(e,S),le(e)}),[le,S]),se=[!j&&Object(w.jsx)(a.EuiTableHeaderCell,{key:"header-cell-actions",align:"left",width:D?150:62,isSorted:!1},Object(w.jsx)(a.EuiText,{size:"xs"},Object(w.jsx)("strong",null,Object(w.jsx)(s.FormattedMessage,{id:"unifiedDocViewer.fieldChooser.discoverField.actions",defaultMessage:"Actions"})))),Object(w.jsx)(a.EuiTableHeaderCell,{key:"header-cell-name",align:"left",width:"30%",isSorted:!1},Object(w.jsx)(a.EuiText,{size:"xs"},Object(w.jsx)("strong",null,Object(w.jsx)(s.FormattedMessage,{id:"unifiedDocViewer.fieldChooser.discoverField.name",defaultMessage:"Field"})))),Object(w.jsx)(a.EuiTableHeaderCell,{key:"header-cell-value",align:"left",isSorted:!1},Object(w.jsx)(a.EuiText,{size:"xs"},Object(w.jsx)("strong",null,Object(w.jsx)(s.FormattedMessage,{id:"unifiedDocViewer.fieldChooser.discoverField.value",defaultMessage:"Value"}))))],oe=Object(l.useCallback)((e=>e.map((({action:{flattenedField:e,onFilter:t},field:{field:i,fieldMapping:l,fieldType:n,scripted:s,pinned:o},value:{formattedValue:d,ignored:c}})=>{var r;return Object(w.jsx)(a.EuiTableRow,{key:i,className:"kbnDocViewer__tableRow",isSelected:o},!j&&Object(w.jsx)(a.EuiTableRowCell,{key:i+"-actions",align:D?"left":"center",width:D?void 0:62,className:"kbnDocViewer__tableActionsCell",textOnly:!1,mobileOptions:F},Object(w.jsx)(V,{mode:D?"inline":"as_popover",field:i,pinned:o,fieldMapping:l,flattenedField:e,onFilter:t,onToggleColumn:W,ignoredValue:!!c,onTogglePinned:q})),Object(w.jsx)(a.EuiTableRowCell,{key:i+"-field-name",align:"left",width:"30%",className:"kbnDocViewer__tableFieldNameCell",textOnly:!1,mobileOptions:F},Object(w.jsx)(m.a,{fieldName:i,fieldType:n,fieldMapping:l,scripted:s,highlight:p(null!==(r=null==l?void 0:l.displayName)&&void 0!==r?r:i,z)})),Object(w.jsx)(a.EuiTableRowCell,{key:i+"-value",align:"left",className:"kbnDocViewer__tableValueCell",textOnly:!1,mobileOptions:F},Object(w.jsx)(x.a,{field:i,formattedValue:d,rawValue:e,ignoreReason:c})))}))),[j,D,W,q,z]),de=[...oe(Q),...oe(X.slice(te,Z+te))];return Object(w.jsx)(a.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},Object(w.jsx)(a.EuiFlexItem,{grow:!1},Object(w.jsx)(a.EuiSpacer,{size:"s"})),Object(w.jsx)(a.EuiFlexItem,{grow:!1},Object(w.jsx)(a.EuiFieldSearch,{"aria-label":U,fullWidth:!0,onChange:K,placeholder:U,value:z,"data-test-subj":"unifiedDocViewerFieldsSearchInput"})),0===de.length?Object(w.jsx)(a.EuiSelectableMessage,{style:{minHeight:300}},Object(w.jsx)("p",null,Object(w.jsx)(a.EuiI18n,{token:"unifiedDocViewer.docViews.table.noFieldFound",default:"No fields found"}))):Object(w.jsx)(a.EuiFlexItem,{grow:!1},Object(w.jsx)(a.EuiTable,{responsive:!1},Object(w.jsx)(a.EuiTableHeader,null,se),Object(w.jsx)(a.EuiTableBody,null,de))),Object(w.jsx)(a.EuiFlexItem,{grow:!1},Object(w.jsx)(a.EuiSpacer,{size:"m"})),ae&&Object(w.jsx)(a.EuiFlexItem,{grow:!1},Object(w.jsx)(a.EuiTablePagination,{activePage:Y,itemsPerPage:Z,itemsPerPageOptions:C,pageCount:ee,onChangeItemsPerPage:ne,onChangePage:ie})))}}}]);