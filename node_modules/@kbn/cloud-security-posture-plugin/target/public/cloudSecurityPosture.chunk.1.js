/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cloudSecurityPosture_bundle_jsonpfunction=window.cloudSecurityPosture_bundle_jsonpfunction||[]).push([[1],Array(49).concat([function(e,t,i){"use strict";i.d(t,"q",(function(){return b})),i.d(t,"a",(function(){return m})),i.d(t,"m",(function(){return j})),i.d(t,"b",(function(){return x})),i.d(t,"h",(function(){return f})),i.d(t,"g",(function(){return h})),i.d(t,"k",(function(){return y})),i.d(t,"j",(function(){return v})),i.d(t,"l",(function(){return O})),i.d(t,"f",(function(){return k})),i.d(t,"i",(function(){return M})),i.d(t,"p",(function(){return T})),i.d(t,"e",(function(){return C})),i.d(t,"n",(function(){return S})),i.d(t,"o",(function(){return w})),i.d(t,"d",(function(){return E})),i.d(t,"c",(function(){return I}));var a=i(5),n=i(24),s=i(2),o=i(60),r=i.n(o),l=i(64),u=i.n(l),c=i(65),d=i.n(c),p=i(61),g=i.n(p);const b={passed:n.euiThemeVars.euiColorSuccess,failed:n.euiThemeVars.euiColorVis9},m="MMMM D, YYYY @ HH:mm:ss.SSS",j=500,x=25,f="cloudPosture:dataTable:pageSize",h="cloudPosture:dataTable:columns",y="cloudPosture:findings:pageSize",v="cloudPosture:benchmark:pageSize",O="cloudPosture:rules:pageSize",k="cloudPosture:complianceDashboard:benchmarkSort",M="cloudPosture:findings:lastSelectedTab",T={cspm:{policyTemplate:s.v,name:a.i18n.translate("xpack.csp.cspmIntegration.integration.nameTitle",{defaultMessage:"Cloud Security Posture Management"}),shortName:a.i18n.translate("xpack.csp.cspmIntegration.integration.shortNameTitle",{defaultMessage:"CSPM"}),options:[{type:s.k,name:a.i18n.translate("xpack.csp.cspmIntegration.awsOption.nameTitle",{defaultMessage:"AWS"}),benchmark:a.i18n.translate("xpack.csp.cspmIntegration.awsOption.benchmarkTitle",{defaultMessage:"CIS AWS"}),icon:"logoAWS",testId:"cisAwsTestId"},{type:s.n,name:a.i18n.translate("xpack.csp.cspmIntegration.gcpOption.nameTitle",{defaultMessage:"GCP"}),benchmark:a.i18n.translate("xpack.csp.cspmIntegration.gcpOption.benchmarkTitle",{defaultMessage:"CIS GCP"}),icon:g.a,testId:"cisGcpTestId"},{type:s.l,name:a.i18n.translate("xpack.csp.cspmIntegration.azureOption.nameTitle",{defaultMessage:"Azure"}),benchmark:a.i18n.translate("xpack.csp.cspmIntegration.azureOption.benchmarkTitle",{defaultMessage:"CIS Azure"}),icon:"logoAzure",testId:"cisAzureTestId"}]},kspm:{policyTemplate:s.H,name:a.i18n.translate("xpack.csp.kspmIntegration.integration.nameTitle",{defaultMessage:"Kubernetes Security Posture Management"}),shortName:a.i18n.translate("xpack.csp.kspmIntegration.integration.shortNameTitle",{defaultMessage:"KSPM"}),options:[{type:s.p,name:a.i18n.translate("xpack.csp.kspmIntegration.vanillaOption.nameTitle",{defaultMessage:"Self-Managed"}),benchmark:a.i18n.translate("xpack.csp.kspmIntegration.vanillaOption.benchmarkTitle",{defaultMessage:"CIS Kubernetes"}),icon:"logoKubernetes"},{type:s.m,name:a.i18n.translate("xpack.csp.kspmIntegration.eksOption.nameTitle",{defaultMessage:"EKS"}),benchmark:a.i18n.translate("xpack.csp.kspmIntegration.eksOption.benchmarkTitle",{defaultMessage:"CIS EKS"}),icon:r.a,tooltip:a.i18n.translate("xpack.csp.kspmIntegration.eksOption.tooltipContent",{defaultMessage:"Elastic Kubernetes Service"})},{type:s.j,name:a.i18n.translate("xpack.csp.kspmIntegration.aksOption.nameTitle",{defaultMessage:"AKS"}),benchmark:a.i18n.translate("xpack.csp.kspmIntegration.aksOption.benchmarkTitle",{defaultMessage:"CIS AKS"}),disabled:!0,icon:u.a,tooltip:a.i18n.translate("xpack.csp.kspmIntegration.aksOption.tooltipContent",{defaultMessage:"Azure Kubernetes Service - Coming soon"})},{type:s.o,name:a.i18n.translate("xpack.csp.kspmIntegration.gkeOption.nameTitle",{defaultMessage:"GKE"}),benchmark:a.i18n.translate("xpack.csp.kspmIntegration.gkeOption.benchmarkTitle",{defaultMessage:"CIS GKE"}),disabled:!0,icon:d.a,tooltip:a.i18n.translate("xpack.csp.kspmIntegration.gkeOption.tooltipContent",{defaultMessage:"Google Kubernetes Engine - Coming soon"})}]},vuln_mgmt:{policyTemplate:s.bb,name:"Vulnerability Management",shortName:"VULN_MGMT",options:[{type:s.q,name:a.i18n.translate("xpack.csp.vulnMgmtIntegration.awsOption.nameTitle",{defaultMessage:"Amazon Web Services"}),icon:"logoAWS",benchmark:"N/A"},{type:s.s,name:a.i18n.translate("xpack.csp.vulnMgmtIntegration.gcpOption.nameTitle",{defaultMessage:"GCP"}),disabled:!0,icon:g.a,tooltip:a.i18n.translate("xpack.csp.vulnMgmtIntegration.gcpOption.tooltipContent",{defaultMessage:"Coming soon"}),benchmark:"N/A"},{type:s.r,name:a.i18n.translate("xpack.csp.vulnMgmtIntegration.azureOption.nameTitle",{defaultMessage:"Azure"}),disabled:!0,icon:"logoAzure",tooltip:a.i18n.translate("xpack.csp.vulnMgmtIntegration.azureOption.tooltipContent",{defaultMessage:"Coming soon"}),benchmark:"N/A"}]}},C="https://ela.st/findings",S="1.5.2",w=1e4,E="detection_engine_rules",I="detection_engine_alerts"},function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var a=i(9);const n=()=>Object(a.useKibana)()},function(e,t,i){"use strict";i.d(t,"e",(function(){return s})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return r})),i.d(t,"b",(function(){return l})),i.d(t,"d",(function(){return u}));var a=i(30),n=i(2);const s=e=>!!e,o=(e,t="Unknown Error")=>e instanceof Error?e.message:"string"==typeof e?e:t;function r(e,t){if(!e)throw new Error(t)}a.PACKAGE_POLICY_SAVED_OBJECT_TYPE,n.t;const l=(e,t)=>{const i=e+t;return 0===i?i:Number((e/(e+t)*100).toFixed(1))},u=(e,t)=>{if(t){const i=t.indicesDetails.find((t=>-1!==t.index.indexOf(e)));if(i)return i.status}return"unknown"}},function(e,t,i){"use strict";e.exports=i(131)},function(e,t,i){"use strict";var a,n=function(){var e={};return function(t){if(void 0===e[t]){var i=document.querySelector(t);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}e[t]=i}return e[t]}}(),s=[];function o(e){for(var t=-1,i=0;i<s.length;i++)if(s[i].identifier===e){t=i;break}return t}function r(e,t){for(var i={},a=[],n=0;n<e.length;n++){var r=e[n],l=t.base?r[0]+t.base:r[0],u=i[l]||0,c="".concat(l," ").concat(u);i[l]=u+1;var d=o(c),p={css:r[1],media:r[2],sourceMap:r[3]};-1!==d?(s[d].references++,s[d].updater(p)):s.push({identifier:c,updater:m(p,t),references:1}),a.push(c)}return a}function l(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var s=i.nc;s&&(a.nonce=s)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var o=n(e.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,i,a){var n=i?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=c(t,n);else{var s=document.createTextNode(n),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(s,o[t]):e.appendChild(s)}}function p(e,t,i){var a=i.css,n=i.media,s=i.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var g=null,b=0;function m(e,t){var i,a,n;if(t.singleton){var s=b++;i=g||(g=l(t)),a=d.bind(null,i,s,!1),n=d.bind(null,i,s,!0)}else i=l(t),a=p.bind(null,i,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(i)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a));var i=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<i.length;a++){var n=o(i[a]);s[n].references--}for(var l=r(e,t),u=0;u<i.length;u++){var c=o(i[u]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}i=l}}}},function(e,t,i){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=function(e,t){var i,a,n,s=e[1]||"",o=e[3];if(!o)return s;if(t&&"function"==typeof btoa){var r=(i=o,a=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),n="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(n," */")),l=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[s].concat(l).concat([r]).join("\n")}return[s].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,a){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(a)for(var s=0;s<this.length;s++){var o=this[s][0];null!=o&&(n[o]=!0)}for(var r=0;r<e.length;r++){var l=[].concat(e[r]);a&&n[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),t.push(l))}},t}},,function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"a",(function(){return s}));var a=i(11),n=i.n(a);let s,o;!function(e){e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.MATCH_ONLY_TEXT="match_only_text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.AGGREGATE_METRIC_DOUBLE="aggregate_metric_double",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram"}(s||(s={})),function(e){e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing"}(o||(o={}));class kbn_field_type_KbnFieldType{constructor(e={}){n()(this,"name",void 0),n()(this,"sortable",void 0),n()(this,"filterable",void 0),n()(this,"esTypes",void 0),this.name=e.name||o.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}new kbn_field_type_KbnFieldType({name:o.UNKNOWN});new kbn_field_type_KbnFieldType({name:o.STRING,sortable:!0,filterable:!0,esTypes:[s.STRING,s.TEXT,s.MATCH_ONLY_TEXT,s.KEYWORD,s.VERSION,s._TYPE,s._ID]}),new kbn_field_type_KbnFieldType({name:o.NUMBER,sortable:!0,filterable:!0,esTypes:[s.FLOAT,s.HALF_FLOAT,s.SCALED_FLOAT,s.DOUBLE,s.INTEGER,s.LONG,s.UNSIGNED_LONG,s.SHORT,s.BYTE,s.TOKEN_COUNT,s.AGGREGATE_METRIC_DOUBLE]}),new kbn_field_type_KbnFieldType({name:o.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[s.FLOAT_RANGE,s.DOUBLE_RANGE,s.INTEGER_RANGE,s.LONG_RANGE]}),new kbn_field_type_KbnFieldType({name:o.DATE,sortable:!0,filterable:!0,esTypes:[s.DATE,s.DATE_NANOS]}),new kbn_field_type_KbnFieldType({name:o.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[s.DATE_RANGE]}),new kbn_field_type_KbnFieldType({name:o.IP,sortable:!0,filterable:!0,esTypes:[s.IP]}),new kbn_field_type_KbnFieldType({name:o.IP_RANGE,sortable:!0,filterable:!0,esTypes:[s.IP_RANGE]}),new kbn_field_type_KbnFieldType({name:o.BOOLEAN,sortable:!0,filterable:!0,esTypes:[s.BOOLEAN]}),new kbn_field_type_KbnFieldType({name:o.OBJECT,esTypes:[s.OBJECT]}),new kbn_field_type_KbnFieldType({name:o.NESTED,esTypes:[s.NESTED]}),new kbn_field_type_KbnFieldType({name:o.GEO_POINT,esTypes:[s.GEO_POINT]}),new kbn_field_type_KbnFieldType({name:o.GEO_SHAPE,esTypes:[s.GEO_SHAPE]}),new kbn_field_type_KbnFieldType({name:o.ATTACHMENT,esTypes:[s.ATTACHMENT]}),new kbn_field_type_KbnFieldType({name:o.MURMUR3,esTypes:[s.MURMUR3]}),new kbn_field_type_KbnFieldType({name:o._SOURCE,esTypes:[s._SOURCE]}),new kbn_field_type_KbnFieldType({name:o.HISTOGRAM,filterable:!0,esTypes:[s.HISTOGRAM]}),new kbn_field_type_KbnFieldType({name:o.CONFLICT})},,,,function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2aWV3Qm94PSIwIDAgMzcuMTE4IDQxLjc3OCI+PGRlZnM+PGxpbmVhckdyYWRpZW50IGlkPSJhIiB4MT0iMy4wNjciIHkxPSI5LjkzIiB4Mj0iMjkuNTQiIHkyPSIzNi40MDMiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNjODUxMWIiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmOTAiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9IjEzLjIzMyIgeTE9Ii0xLjg5IiB4Mj0iNDAuNDAyIiB5Mj0iMjUuMjc4IiB4bGluazpocmVmPSIjYSIvPjxsaW5lYXJHcmFkaWVudCBpZD0iYyIgeDE9IjUuNDU0IiB5MT0iNi45NDgiIHgyPSIzMi40MjYiIHkyPSIzMy45MiIgeGxpbms6aHJlZj0iI2EiLz48L2RlZnM+PHBhdGggZD0iTTE4LjU2IDQxLjc3OWEuNzcuNzcgMCAwIDEtLjM4Ny0uMUwuMzg3IDMxLjQwOUEuNzczLjc3MyAwIDAgMSAwIDMwLjczN1YxMC4yYS43NzQuNzc0IDAgMCAxIC4zODctLjY3M0wxNi42MjcuMWEuNzc0Ljc3NCAwIDAgMSAxLjE2LjY3M3Y4LjlhLjc3NS43NzUgMCAwIDEtLjM4Ny42NzNMOS4yOCAxNS4wOXYxMC43MjZsOS4yOCA1LjM1OSA4LjEtNC42NGEuNzczLjc3MyAwIDAgMSAuNzczIDBMMzUuMTY2IDMxYS43NzIuNzcyIDAgMCAxIDAgMS4zNDVsLTE2LjIyMSA5LjMzM2EuNzc0Ljc3NCAwIDAgMS0uMzg1LjEwMVpNMS41NDUgMzAuMjg3bDE3LjAxMyA5LjgyOSAxNC42OTMtOC41MDctNi4xODYtMy41NzItOC4xMiA0LjcwOWEuNzc1Ljc3NSAwIDAgMS0uNzc0IDBMOC4xMTggMjYuOTM5YS43NzUuNzc1IDAgMCAxLS4zODctLjY3M3YtMTEuNmEuNzc1Ljc3NSAwIDAgMSAuMzg3LS42NzNsOC4xMi00LjcyNVYyLjExNUwxLjU0NSAxMC42MjFaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0uMDAxKSIgc3R5bGU9ImZpbGw6dXJsKCNhKSIvPjxwYXRoIGQ9Ik0zNi4zNDUgMjkuNzNhLjc3Ljc3IDAgMCAxLS4zODctLjFsLTcuNzMzLTQuNDQ3YS42Ny42NyAwIDAgMS0uMzQ4LS42NzN2LTkuNDE5bC04LjE1OS00LjY0YS43NzUuNzc1IDAgMCAxLS4zODctLjY3M1YuODYyYS43NzQuNzc0IDAgMCAxIC4zODctLjY3My44Mi44MiAwIDAgMSAuNzczIDBsMTYuMjQgOS4zMzRhLjc3NS43NzUgMCAwIDEgLjM4Ny42NzN2MTguNzYxYS43NzMuNzczIDAgMCAxLS43NzMuNzczWm0tNi45Ni01LjY2MSA2LjE4NiAzLjU0MlYxMC42NDZMMjAuODc4IDIuMnY3LjEzOUwyOSAxMy45NzlhLjc3Ni43NzYgMCAwIDEgLjM4Ny42NjZaIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIC0uMDAxKSIgc3R5bGU9ImZpbGw6dXJsKCNiKSIvPjxwYXRoIGQ9Ik0xNC42OTMgMjYuM1YxNC43aDEuNTUydjUuMjgybDUuMDI3LTUuMjgyaDIuMDQxbC01LjI0OCA1LjY0OSA1LjcgNS45NTVoLTIuMTEybC01LjQwOC01LjQxOFYyNi4zWiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAtLjAwMSkiIHN0eWxlPSJmaWxsOnVybCgjYykiLz48L3N2Zz4K"},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDMyIDMyIj4KICA8ZyBjbGlwLXBhdGg9InVybCgjYSkiPgogICAgPHBhdGggZmlsbD0iI0VBNDMzNSIgZD0iTTIwLjk1MSAxMC43MjMgMjMuNTYgOC4wOWwuMTc0LTEuMTA5QzE4Ljk4IDIuNjE4IDExLjQyNyAzLjExMyA3LjE0MyA4LjAxNGMtMS4xOSAxLjM2LTIuMDczIDMuMDU4LTIuNTQzIDQuODFsLjkzNC0uMTMzIDUuMjE1LS44NjguNDAzLS40MTZjMi4zMi0yLjU3MyA2LjI0Mi0yLjkxOSA4LjkyLS43M2wuODguMDQ2WiIvPgogICAgPHBhdGggZmlsbD0iIzQyODVGNCIgZD0iTTI3LjI3NCAxMi43NDZhMTEuODggMTEuODggMCAwIDAtMy41NDEtNS43NjVsLTMuNjYgMy42OTZhNi41OTUgNi41OTUgMCAwIDEgMi4zODggNS4yMXYuNjU3YzEuOCAwIDMuMjU4IDEuNDcyIDMuMjU4IDMuMjg4YTMuMjQyIDMuMjQyIDAgMCAxLTMuMjU4IDMuMjUzaC02LjUyNGwtLjY0LjcwMnYzLjk0NWwuNjQuNjE5aDYuNTI0YzQuNjguMDM3IDguNTAyLTMuNzI3IDguNTM5LTguNDUxYTguNTc5IDguNTc5IDAgMCAwLTMuNzI2LTcuMTU0WiIvPgogICAgPHBhdGggZmlsbD0iIzM0QTg1MyIgZD0iTTkuNDIyIDI4LjM1aDYuNTE1di01LjI2NUg5LjQyMmEzLjE3IDMuMTcgMCAwIDEtMS4zMzYtLjI5NmwtLjkyNC4yODYtMi42MjYgMi42MzQtLjIyOS44OTZjMS40NzMgMS4xMjIgMy4yNyAxLjc1NCA1LjExNSAxLjc0NloiLz4KICAgIDxwYXRoIGZpbGw9IiNGQkJDMDUiIGQ9Ik05LjQyMiAxMS4yNjhDNC43NDMgMTEuMjk2Ljk3MiAxNS4xNSAxIDE5Ljg3NGE4LjU4NCA4LjU4NCAwIDAgMCAzLjMwOCA2LjczbDMuNzc5LTMuODE1Yy0xLjY0LS43NDgtMi4zNjktMi42OTYtMS42MjgtNC4zNTJhMy4yNDUgMy4yNDUgMCAwIDEgNS45MzcgMGwzLjc4LTMuODE1YTguNDM1IDguNDM1IDAgMCAwLTYuNzU0LTMuMzU0WiIvPgogIDwvZz4KICA8ZGVmcz4KICAgIDxjbGlwUGF0aCBpZD0iYSI+CiAgICAgIDxwYXRoIGZpbGw9IiNmZmYiIGQ9Ik0xIDRoMzB2MjQuMzc1SDF6Ii8+CiAgICA8L2NsaXBQYXRoPgogIDwvZGVmcz4KPC9zdmc+Cgo="},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),n=i(66),s=function(){};t.default=function(e,t,i){if(!n.isClient)return[t,s,s];if(!e)throw new Error("useLocalStorage key may not be falsy");var o=i?i.raw?function(e){return e}:i.deserializer:JSON.parse,r=a.useState((function(){try{var a=i?i.raw?String:i.serializer:JSON.stringify,n=localStorage.getItem(e);return null!==n?o(n):(t&&localStorage.setItem(e,a(t)),t)}catch(e){return t}})),l=r[0],u=r[1],c=a.useCallback((function(t){try{var a="function"==typeof t?t(l):t;if(void 0===a)return;var n;n=i?i.raw?"string"==typeof a?a:JSON.stringify(a):i.serializer?i.serializer(a):JSON.stringify(a):JSON.stringify(a),localStorage.setItem(e,n),u(o(n))}catch(e){}}),[e,u]),d=a.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[l,c,d]}},,function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICA8cGF0aCBmaWxsPSIjODA0OTk4IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Im03LjQxMiA0LjkxLTIuMTU2LjkyOVYybDIuMTU2LjgzNlY0LjkxWk0zLjMyNCAyLjY1djIuNTA4bDEuNTk2LjY4VjIuMDMybC0xLjU5Ni42MlptLjE2OCAyLjMyMi0uMDg0LS4wMzFWMi44NjdsLjA4NC0uMDMxLjA4NC0uMDMxLjA4NC0uMDMxdjIuMjZsLS4wODQtLjAzMS0uMDg0LS4wMzFabS40Mi4xMjRMMy44IDUuMDY1VjIuNzQzbC4xMTItLjAzLjExMi0uMDMyLjExMi0uMDN2Mi41MzhsLS4xMTItLjAzMS0uMTEyLS4wNjJabS41MDQuMTg2LS4xNC0uMDYyVjIuNTg4bC4xNC0uMDMuMTQtLjA2My4xNjgtLjA2MnYyLjk0MWwtLjE2OC0uMDYxLS4xNC0uMDMxWm04LjAwOC0uMzcyLTIuMTU2LjkyOVYybDIuMTU2LjgzNlY0LjkxWk04LjMzNiAyLjY1djIuNTA4bDEuNTk2LjY4VjIuMDMybC0xLjU5Ni42MlptLjE2OCAyLjMyMi0uMDg0LS4wMzFWMi44NjdsLjA4NC0uMDMxLjA4NC0uMDMxLjA4NC0uMDMxdjIuMjZsLS4wODQtLjAzMS0uMDg0LS4wMzFabS40Mi4xMjQtLjExMi0uMDMxVjIuNzQzbC4xMTItLjAzLjExMi0uMDMyLjExMi0uMDN2Mi41MzhsLS4xMTItLjAzMS0uMTEyLS4wNjJabS41MDQuMTg2LS4xNC0uMDYyVjIuNTg4bC4xNC0uMDMuMTQtLjA2My4xNjgtLjA2MnYyLjk0MWwtLjE2OC0uMDYxLS4xNC0uMDMxWm0tMi4wMTYgNy4yNDQtMi4xNTYuOTI4VjkuNjE2bDIuMTU2LjgzNnYyLjA3NFptLTQuMDg4LTIuMjZ2Mi41MDhsMS41OTYuNjhWOS42NDdsLTEuNTk2LjYxOVptLjE2OCAyLjMyMi0uMDg0LS4wMzF2LTIuMDc1bC4wODQtLjAzLjA4NC0uMDMxLjA4NC0uMDMxdjIuMjZsLS4wODQtLjAzMS0uMDg0LS4wMzFabS40Mi4xMjRMMy44IDEyLjY4di0yLjMyMmwuMTEyLS4wMzEuMTEyLS4wMzEuMTEyLS4wMzF2Mi41MzhsLS4xMTItLjAzLS4xMTItLjA2MlptLjUwNC4xODUtLjE0LS4wNjJ2LTIuNjMxbC4xNC0uMDMxLjE0LS4wNjIuMTY4LS4wNjJ2Mi45NDFsLS4xNjgtLjA2Mi0uMTQtLjAzWm04LjAwOC0uMzcxLTIuMTU2LjkyOFY5LjYxNmwyLjE1Ni44MzZ2Mi4wNzRabS00LjA4OC0yLjI2djIuNTA4bDEuNTk2LjY4VjkuNjQ3bC0xLjU5Ni42MTlabS4xNjggMi4zMjItLjA4NC0uMDMxdi0yLjA3NWwuMDg0LS4wMy4wODQtLjAzMS4wODQtLjAzMXYyLjI2bC0uMDg0LS4wMzEtLjA4NC0uMDMxWm0uNDIuMTI0LS4xMTItLjAzMXYtMi4zMjJsLjExMi0uMDMxLjExMi0uMDMxLjExMi0uMDMxdjIuNTM4bC0uMTEyLS4wMy0uMTEyLS4wNjJabS41MDQuMTg1LS4xNC0uMDYydi0yLjYzMWwuMTQtLjAzMS4xNC0uMDYyLjE2OC0uMDYydjIuOTQxbC0uMTY4LS4wNjItLjE0LS4wM1ptLjY0NC00LjE3OS0yLjEyOC44OThWNS44MDhsMi4xMjguODM2djIuMDc0Wk01Ljk4NCA2LjQyN3YyLjUwOGwxLjU5Ni42OFY1LjgwOWwtMS41OTYuNjE5Wm0uMTY4IDIuMzIyLS4wODQtLjAzMVY2LjY0NGwuMDg0LS4wMzEuMDg0LS4wMzEuMDg0LS4wMzF2Mi4yNmwtLjA4NC0uMDMxLS4wODQtLjAzMVptLjQyLjE1NS0uMTEyLS4wMzFWNi41NWwuMTEyLS4wMzEuMTEyLS4wMzEuMTEyLS4wMzF2Mi41MzlsLS4xMTItLjAzMS0uMTEyLS4wNjJabS41MDQuMTg1LS4xNC0uMDYxVjYuMzk2bC4xNC0uMDMuMTQtLjA2My4xNjgtLjA2MnYyLjk0MWwtLjE2OC0uMDYyLS4xNC0uMDNabS0xLjk4OC0uMzcxLTIuMTI4Ljg5OFY1LjgwOGwyLjEyOC44MzZ2Mi4wNzRaTTEgNi40Mjd2Mi41MDhsMS41OTYuNjhWNS44MDlMMSA2LjQyN1ptLjE2OCAyLjMyMi0uMDg0LS4wMzFWNi42NDRsLjA4NC0uMDMxLjA4NC0uMDMxLjA4NC0uMDMxdjIuMjZsLS4wODQtLjAzMS0uMDg0LS4wMzFabS40Mi4xNTUtLjExMi0uMDMxVjYuNTVsLjExMi0uMDMxLjExMi0uMDMxLjExMi0uMDMxdjIuNTM5bC0uMTEyLS4wMy0uMTEyLS4wNjJabS41MDQuMTg1LS4xNC0uMDYxVjYuMzk2bC4xNC0uMDMuMTQtLjA2My4xNjgtLjA2MnYyLjk0MWwtLjE2OC0uMDYyLS4xNC0uMDNaTTE1IDguNzE4bC0yLjEyOC44OThWNS44MDhMMTUgNi42NDR2Mi4wNzRaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiLz4KICA8cGF0aCBmaWxsPSIjZmZmIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGQ9Im03LjQxMiA0LjkxLTIuMTU2LjkyOVYybDIuMTU2LjgzNlY0LjkxWm01LjAxMiAwLTIuMTU2LjkyOVYybDIuMTU2LjgzNlY0LjkxWm0tNS4wMTIgNy42MTYtMi4xNTYuOTI4VjkuNjE2bDIuMTU2LjgzNnYyLjA3NFptNS4wMTIgMC0yLjE1Ni45MjhWOS42MTZsMi4xNTYuODM2djIuMDc0Wm0tMi4zNTItMy44MDgtMi4xMjguODk4VjUuODA4bDIuMTI4LjgzNnYyLjA3NFptLTQuOTg0IDAtMi4xMjguODk4VjUuODA4bDIuMTI4LjgzNnYyLjA3NFptOS45MTIgMC0yLjEyOC44OThWNS44MDhMMTUgNi42NDR2Mi4wNzRaIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIG9wYWNpdHk9Ii4yIi8+CiAgPHBhdGggZmlsbD0iIzgwNDk5OCIgZmlsbC1ydWxlPSJldmVub2RkIiBkPSJNMTAuOTEyIDYuNDI3djIuNTA4bDEuNTk2LjY4VjUuODA5bC0xLjU5Ni42MTlabS4xNjggMi4zMjItLjA4NC0uMDMxVjYuNjQ0bC4wODQtLjAzMS4wODQtLjAzMS4wODQtLjAzMXYyLjI2bC0uMDg0LS4wMzEtLjA4NC0uMDMxWm0uNDIuMTU1LS4xMTItLjAzMVY2LjU1bC4xMTItLjAzMS4xMTItLjAzMS4xMTItLjAzMXYyLjUzOWwtLjExMi0uMDMxLS4xMTItLjA2MlptLjUwNC4xODUtLjE0LS4wNjFWNi4zOTZsLjE0LS4wMy4xNC0uMDYzLjE2OC0uMDYydjIuOTQxbC0uMTY4LS4wNjItLjE0LS4wM1oiIGNsaXAtcnVsZT0iZXZlbm9kZCIvPgo8L3N2Zz4="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgZmlsbD0ibm9uZSIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICA8ZyBjbGlwLXBhdGg9InVybCgjYSkiPgogICAgPHBhdGggZmlsbD0idXJsKCNiKSIgZD0iTTMuNDc0IDE0LjQwMi4xOTMgOC43MmExLjQzNyAxLjQzNyAwIDAgMSAwLTEuNDM4bDMuMjgtNS42ODNBMS40MzcgMS40MzcgMCAwIDEgNC43Mi44NzhoNi41NjJjLjUxNCAwIC45ODguMjc1IDEuMjQ1LjcybDMuMjgxIDUuNjgzYy4yNTcuNDQ1LjI1Ny45OTMgMCAxLjQzOGwtMy4yOCA1LjY4NGExLjQzNyAxLjQzNyAwIDAgMS0xLjI0Ni43MThINC43MmMtLjUxNCAwLS45ODgtLjI3NC0xLjI0NS0uNzE5WiIvPgogICAgPG1hc2sgaWQ9ImMiIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgeD0iMCIgeT0iMCIgbWFza1VuaXRzPSJ1c2VyU3BhY2VPblVzZSIgc3R5bGU9Im1hc2stdHlwZTpsdW1pbmFuY2UiPgogICAgICA8cGF0aCBmaWxsPSIjZmZmIiBkPSJNMy40NzQgMTQuNDAyLjE5MyA4LjcyYTEuNDM3IDEuNDM3IDAgMCAxIDAtMS40MzhsMy4yOC01LjY4M0ExLjQzNyAxLjQzNyAwIDAgMSA0LjcyLjg3OGg2LjU2MmMuNTE0IDAgLjk4OC4yNzUgMS4yNDUuNzJsMy4yODEgNS42ODNjLjI1Ny40NDUuMjU3Ljk5MyAwIDEuNDM4bC0zLjI4IDUuNjg0YTEuNDM3IDEuNDM3IDAgMCAxLTEuMjQ2LjcxOEg0LjcyYy0uNTE0IDAtLjk4OC0uMjc0LTEuMjQ1LS43MTkiLz4KICAgIDwvbWFzaz4KICAgIDxnIG1hc2s9InVybCgjYykiPgogICAgICA8cGF0aCBmaWxsPSIjMDAwIiBkPSJtMTUuNTA2IDEwLjM1Ny00LjMwMi00LjMwMkw4IDQuNjI1IDQuOTM3IDYuMjg5IDQuODEgOS45NTZsNS4zMTggNS4zMTggMi4wODItLjAxOSAzLjI5Ny00Ljg5OFoiIG9wYWNpdHk9Ii4wNyIvPgogICAgPC9nPgogICAgPHBhdGggZmlsbD0iI2ZmZiIgZD0ibTExLjEyOSA2LTIuOTYtMS43MWEuMzM3LjMzNyAwIDAgMC0uMzM3IDBMNC44NzIgNmEuMzM3LjMzNyAwIDAgMC0uMTY4LjI5MVY5LjcxYzAgLjEyLjA2NC4yMzIuMTY4LjI5MmwyLjk2IDEuNzA5Yy4xMDQuMDYuMjMzLjA2LjMzNyAwTDExLjEzIDEwYS4zMzguMzM4IDAgMCAwIC4xNjgtLjI5MVY2LjI5QS4zMzcuMzM3IDAgMCAwIDExLjEzIDZabS0uNDA2IDMuMzgyTDkuNjkgOC43ODZ2LTEuNTdsLTEuNTI0Ljg4djEuNzZsMS4zNi0uNzg1IDEuMDMyLjU5Nkw4IDExLjE0NCA1LjQ0MyA5LjY2N2wxLjAzMy0uNTk2IDEuMzYuNzg1di0xLjc2bC0xLjUyNS0uODh2MS41N2wtMS4wMzMuNTk2VjYuNDI5bDIuNTU4LTEuNDc3djEuMTkybC0xLjM2Ljc4Nkw4IDcuODFsMS41MjQtLjg4LTEuMzYtLjc4NlY0Ljk1MmwyLjU1OCAxLjQ3N3YyLjk1M1oiLz4KICA8L2c+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImIiIHgxPSIwIiB4Mj0iMCIgeTE9Ii44NzkiIHkyPSIxNS4wOTkiIGdyYWRpZW50VW5pdHM9InVzZXJTcGFjZU9uVXNlIj4KICAgICAgPHN0b3Agc3RvcC1jb2xvcj0iIzQzODdGRCIvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM0NjgzRUEiLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgICA8Y2xpcFBhdGggaWQ9ImEiPgogICAgICA8cGF0aCBmaWxsPSIjZmZmIiBkPSJNMCAwaDE2djE2SDB6Ii8+CiAgICA8L2NsaXBQYXRoPgogIDwvZGVmcz4KPC9zdmc+"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var a=i(16).__importDefault(i(123));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];return e.removeEventListener.apply(e,t)},t.isDeepEqual=a.default},,,,,,,,,,function(e,t,i){e.exports=i.p+"3c3c7102c3ff5856912e8c531cf93763.svg"},function(e,t,i){e.exports=i.p+"4c19e824d4ddbcb450a8dd5b72ceb88f.svg"},function(e,t,i){e.exports=i.p+"2d015490d219c87a014c81f9555e556a.svg"},function(e,t,i){e.exports=i.p+"432a17d27c37a1b4467753dcc2332f12.svg"},function(e,t,i){e.exports=i.p+"8d3deaa318988ae73e799b48ff864cb3.svg"},function(e,t,i){e.exports=i.p+"c82e317671d73dcc4b62ca8bfdf1979c.svg"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(16),n=i(1),s=a.__importDefault(i(128));t.default=function(e,t,i){void 0===t&&(t=[]),void 0===i&&(i={loading:!1});var o=n.useRef(0),r=s.default(),l=n.useState(i),u=l[0],c=l[1],d=n.useCallback((function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=++o.current;return c((function(e){return a.__assign(a.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return r()&&n===o.current&&c({value:e,loading:!1}),e}),(function(e){return r()&&n===o.current&&c({error:e,loading:!1}),e}))}),t);return[u,d]}},function(e,t,i){"use strict";e.exports=i(133)},function(e,t,i){"use strict";e.exports=i(140)},function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(146);case"v8light":return i(148)}},function(e,t,i){e.exports=i(8)(8)},function(e,t,i){"use strict";let a;i.d(t,"a",(function(){return a})),i.d(t,"b",(function(){return s})),function(e){e.DOCUMENT="document",e.BINARY="binary",e.BOOLEAN="boolean",e.CONFLICT="conflict",e.COUNTER="counter",e.DATE="date",e.DATE_RANGE="date_range",e.DENSE_VECTOR="dense_vector",e.GAUGE="gauge",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.HISTOGRAM="histogram",e.IP="ip",e.IP_RANGE="ip_range",e.FLATTENED="flattened",e.KEYWORD="keyword",e.MURMUR3="murmur3",e.NUMBER="number",e.NESTED="nested",e.RANK_FEATURE="rank_feature",e.RANK_FEATURES="rank_features",e.POINT="point",e.SHAPE="shape",e.SPARSE_VECTOR="sparse_vector",e.STRING="string",e.TEXT="text",e.VERSION="version"}(a||(a={}));const n=Object.values(a),s=e=>!!e&&n.includes(e)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(16),n=i(1),s=a.__importDefault(i(153));t.default=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=[]);var a=s.default(e,t),o=a[0],r=a[1],l=a[2];return n.useEffect(l,i),[o,r]}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(16),n=i(66),s=a.__importDefault(i(124));t.default=function(e,t){s.default(e,t,n.isDeepEqual)}},function(e,t,i){"use strict";e.exports=function e(t,i){if(t===i)return!0;if(t&&i&&"object"==typeof t&&"object"==typeof i){if(t.constructor!==i.constructor)return!1;var a,n,s;if(Array.isArray(t)){if((a=t.length)!=i.length)return!1;for(n=a;0!=n--;)if(!e(t[n],i[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if((a=(s=Object.keys(t)).length)!==Object.keys(i).length)return!1;for(n=a;0!=n--;)if(!Object.prototype.hasOwnProperty.call(i,s[n]))return!1;for(n=a;0!=n--;){var o=s[n];if(!("_owner"===o&&t.$$typeof||e(t[o],i[o])))return!1}return!0}return t!=t&&i!=i}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(1);t.default=function(e,t,i){var n=a.useRef(void 0);n.current&&i(t,n.current)||(n.current=t),a.useEffect(e,n.current)}},function(e,t,i){e.exports=i.p+"9fbaf98ccebbedc599a6a5985bd24430.svg"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),n=i(66);t.default=function(e,t,i){if(!n.isClient)return[t,function(){}];var s=a.useState((function(){try{var a=sessionStorage.getItem(e);return"string"!=typeof a?(sessionStorage.setItem(e,i?String(t):JSON.stringify(t)),t):i?a:JSON.parse(a||"null")}catch(e){return t}})),o=s[0],r=s[1];return a.useEffect((function(){try{var t=i?String(o):JSON.stringify(o);sessionStorage.setItem(e,t)}catch(e){}})),[o,r]}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(16),n=i(1),s=a.__importDefault(i(82));t.default=function(e,t){void 0===t&&(t=[]);var i=s.default(e,t,{loading:!0}),a=i[0],o=i[1];return n.useEffect((function(){o()}),[o]),a}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(1);t.default=function(){var e=a.useRef(!1),t=a.useCallback((function(){return e.current}),[]);return a.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},function(e,t,i){"use strict";var a=i(130),n={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var i,s,o,r,l,u,c=!1;t||(t={}),i=t.debug||!1;try{if(o=a(),r=document.createRange(),l=document.getSelection(),(u=document.createElement("span")).textContent=e,u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",(function(a){if(a.stopPropagation(),t.format)if(a.preventDefault(),void 0===a.clipboardData){i&&console.warn("unable to use e.clipboardData"),i&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var s=n[t.format]||n.default;window.clipboardData.setData(s,e)}else a.clipboardData.clearData(),a.clipboardData.setData(t.format,e);t.onCopy&&(a.preventDefault(),t.onCopy(a.clipboardData))})),document.body.appendChild(u),r.selectNodeContents(u),l.addRange(r),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");c=!0}catch(a){i&&console.error("unable to copy using execCommand: ",a),i&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),c=!0}catch(a){i&&console.error("unable to copy using clipboardData: ",a),i&&console.error("falling back to prompt"),s=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(s,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(r):l.removeAllRanges()),u&&document.body.removeChild(u),o()}return c}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,i=[],a=0;a<e.rangeCount;a++)i.push(e.getRangeAt(a));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||i.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(132);i(41),i(83),i(84);var n=a.default({key:"css"}),s=n.flush,o=n.hydrate,r=n.cx,l=n.merge,u=n.getRegisteredStyles,c=n.injectGlobal,d=n.keyframes,p=n.css,g=n.sheet,b=n.cache;t.cache=b,t.css=p,t.cx=r,t.flush=s,t.getRegisteredStyles=u,t.hydrate=o,t.injectGlobal=c,t.keyframes=d,t.merge=l,t.sheet=g},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(41),n=i(83),s=i(84);function o(e){return e&&e.__esModule?e:{default:e}}var r=o(a);function l(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function u(e,t,i){var a=[],n=s.getRegisteredStyles(e,a,i);return a.length<2?i:n+t(a)}var c=function e(t){for(var i="",a=0;a<t.length;a++){var n=t[a];if(null!=n){var s=void 0;switch(typeof n){case"boolean":break;case"object":if(Array.isArray(n))s=e(n);else for(var o in s="",n)n[o]&&o&&(s&&(s+=" "),s+=o);break;default:s=n}s&&(i&&(i+=" "),i+=s)}}return i};t.default=function(e){var t=r.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var i=function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];var o=n.serializeStyles(i,t.registered,void 0);return s.insertStyles(t,o,!1),t.key+"-"+o.name};return{css:i,cx:function(){for(var e=arguments.length,a=new Array(e),n=0;n<e;n++)a[n]=arguments[n];return u(t.registered,i,c(a))},injectGlobal:function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];var s=n.serializeStyles(i,t.registered);l(t,s)},keyframes:function(){for(var e=arguments.length,i=new Array(e),a=0;a<e;a++)i[a]=arguments[a];var s=n.serializeStyles(i,t.registered),o="animation-"+s.name;return l(t,{name:s.name,styles:"@keyframes "+o+"{"+s.styles+"}"}),o},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:s.getRegisteredStyles.bind(null,t.registered),merge:u.bind(null,t.registered,i)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(134),n=i(136),s=i(138);function o(e){return e&&e.__esModule?e:{default:e}}var r=o(a),l=o(n),u=/[A-Z]|^ms/g,c=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},p=function(e){return null!=e&&"boolean"!=typeof e},g=o(s).default((function(e){return d(e)?e:e.replace(u,"-$&").toLowerCase()})),b=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(c,(function(e,t,i){return j={name:t,styles:i,next:j},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function m(e,t,i){if(null==i)return"";if(void 0!==i.__emotion_styles)return i;switch(typeof i){case"boolean":return"";case"object":if(1===i.anim)return j={name:i.name,styles:i.styles,next:j},i.name;if(void 0!==i.styles){var a=i.next;if(void 0!==a)for(;void 0!==a;)j={name:a.name,styles:a.styles,next:j},a=a.next;return i.styles+";"}return function(e,t,i){var a="";if(Array.isArray(i))for(var n=0;n<i.length;n++)a+=m(e,t,i[n])+";";else for(var s in i){var o=i[s];if("object"!=typeof o)null!=t&&void 0!==t[o]?a+=s+"{"+t[o]+"}":p(o)&&(a+=g(s)+":"+b(s,o)+";");else if(!Array.isArray(o)||"string"!=typeof o[0]||null!=t&&void 0!==t[o[0]]){var r=m(e,t,o);switch(s){case"animation":case"animationName":a+=g(s)+":"+r+";";break;default:a+=s+"{"+r+"}"}}else for(var l=0;l<o.length;l++)p(o[l])&&(a+=g(s)+":"+b(s,o[l])+";")}return a}(e,t,i);case"function":if(void 0!==e){var n=j,s=i(e);return j=n,m(e,t,s)}}if(null==t)return i;var o=t[i];return void 0!==o?o:i}var j,x=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,i){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var a=!0,n="";j=void 0;var s=e[0];null==s||void 0===s.raw?(a=!1,n+=m(i,t,s)):n+=s[0];for(var o=1;o<e.length;o++)n+=m(i,t,e[o]),a&&(n+=s[o]);x.lastIndex=0;for(var l,u="";null!==(l=x.exec(n));)u+="-"+l[1];return{name:r.default(n)+u,styles:n,next:j}}},function(e,t,i){"use strict";e.exports=i(135)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,i=0,a=0,n=e.length;n>=4;++a,n-=4)t=1540483477*(65535&(t=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+(59797*(t>>>16)<<16),i=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&i)+(59797*(i>>>16)<<16);switch(n){case 3:i^=(255&e.charCodeAt(a+2))<<16;case 2:i^=(255&e.charCodeAt(a+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(a)))+(59797*(i>>>16)<<16)}return(((i=1540483477*(65535&(i^=i>>>13))+(59797*(i>>>16)<<16))^i>>>15)>>>0).toString(36)}},function(e,t,i){"use strict";e.exports=i(137)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,i){"use strict";e.exports=i(139)},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(i){return void 0===t[i]&&(t[i]=e(i)),t[i]}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="undefined"!=typeof document,n=function(e,t,i){var n=e.key+"-"+t.name;(!1===i||!1===a&&void 0!==e.compat)&&void 0===e.registered[n]&&(e.registered[n]=t.styles)};t.getRegisteredStyles=function(e,t,i){var a="";return i.split(" ").forEach((function(i){void 0!==e[i]?t.push(e[i]+";"):a+=i+" "})),a},t.insertStyles=function(e,t,i){n(e,t,i);var s=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var o="",r=t;do{var l=e.insert(t===r?"."+s:"",r,e.sheet,!0);a||void 0===l||(o+=l),r=r.next}while(void 0!==r);if(!a&&0!==o.length)return o}},t.registerStyles=n},function(e,t,i){switch(window.__kbnThemeTag__){case"v8dark":return i(142);case"v8light":return i(144)}},function(e,t,i){var a=i(53),n=i(143);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,i){(t=i(54)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Consolas,Menlo,Courier,monospace}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Consolas,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGrid__controls{border-top:1px solid #343741}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #343741}.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover,.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover .euiDataGridRowCell__actions--overlay{background-color:#343741}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:initial}.unifiedDataTable__inner .euiDataGridRowCell__autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.unifiedDataTable__flyoutHeader{white-space:nowrap}.unifiedDataTable__flyoutDocumentNavigation{justify-content:flex-end}.euiDataGridHeader .euiDataGridHeaderCell__content{flex-grow:1;max-width:100%;overflow:hidden!important;overflow:hidden;text-overflow:ellipsis!important;white-space:nowrap!important;white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-3px}.euiDataGridRowCell__defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.14286rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px) and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px) and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.euiDataGrid__restrictBody :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},function(e,t,i){var a=i(53),n=i(145);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,i){(t=i(54)(!1)).push([e.i,".unifiedDataTable{height:100%;max-width:100%;overflow:hidden;width:100%}.unifiedDataTable__cellValue{font-family:Roboto Mono,Consolas,Menlo,Courier,monospace}.unifiedDataTable__cellPopover .lines-content.monaco-editor-background{contain:unset!important;overflow:unset!important}.unifiedDataTable__cellPopoverValue{font-family:Roboto Mono,Consolas,Menlo,Courier,monospace;font-size:14px}.unifiedDataTable__inner{display:flex;flex-direction:column;flex-wrap:nowrap;height:100%}.unifiedDataTable__inner .euiDataGrid__content{background:#0000}.unifiedDataTable__inner .euiDataGrid__controls{border-top:1px solid #d3dae6}.unifiedDataTable__inner .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:1px solid #d3dae6}.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=openDetails],.unifiedDataTable__inner .euiDataGridRowCell.euiDataGridRowCell--controlColumn[data-gridcell-column-id=select]{padding-left:0;padding-right:0}.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover,.unifiedDataTable__inner .euiDataGrid--rowHoverHighlight .euiDataGridRow:hover .euiDataGridRowCell__actions--overlay{background-color:#e9edf3}.unifiedDataTable__inner .euiDataGrid__scrollOverlay .euiDataGrid__scrollBarOverlayRight{background-color:initial}.unifiedDataTable__inner .euiDataGridRowCell__autoHeight,.unifiedDataTable__inner .euiDataGridRowCell__lineCountHeight{white-space:pre-wrap}.unifiedDataTable__table{flex-grow:1;flex-shrink:1;min-height:0}.unifiedDataTable__flyoutHeader{white-space:nowrap}.unifiedDataTable__flyoutDocumentNavigation{justify-content:flex-end}.euiDataGridHeader .euiDataGridHeaderCell__content{flex-grow:1;max-width:100%;overflow:hidden!important;overflow:hidden;text-overflow:ellipsis!important;white-space:nowrap!important;white-space:pre-wrap}.euiDataGridHeader .euiDataGridHeaderCell__popover{flex-basis:auto;flex-grow:0;padding-left:4px;width:auto}.euiDataGridRowCell--numeric{text-align:right}.euiDataGrid__loading,.euiDataGrid__noResults{display:flex;flex:1 0 100%;flex-direction:column;height:100%;justify-content:center;text-align:center;width:100%}.unifiedDataTableFormatSource{max-width:100%;overflow:hidden!important;text-overflow:ellipsis!important;white-space:nowrap!important}.unifiedDataTable__rowControl{margin-top:-3px}.euiDataGridRowCell__defaultHeight .unifiedDataTable__rowControl{margin-top:0}.euiDataGridRowCell__defaultHeight .unifiedDataTable__descriptionList{-webkit-line-clamp:1;-webkit-box-orient:vertical;display:-webkit-box;height:100%;overflow:hidden}.unifiedDataTable__descriptionListTitle{background:#0000;font-weight:700;margin-inline:0 0;padding-inline:0}.unifiedDataTable__descriptionListDescription{margin-inline:8px 8px;padding-inline:0;white-space:normal;word-break:break-all}.unifiedDataTable__descriptionListDescription img{max-height:1.14286rem!important;max-width:500px!important;vertical-align:middle}@media only screen and (max-width:574px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:575px) and (max-width:767px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}@media only screen and (min-width:768px) and (max-width:991px){.unifiedDataTable__flyoutDocumentNavigation .euiPagination__compressedText{display:none}}.euiDataGrid__restrictBody :not(.euiDataGrid--fullScreen,.euiDataGrid--fullScreen *,[data-euiportal=true],[data-euiportal=true] *){z-index:unset!important}",""]),e.exports=t},function(e,t,i){var a=i(53),n=i(147);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,i){(t=i(54)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},function(e,t,i){var a=i(53),n=i(149);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);a(n,{insert:"head",singleton:!1}),e.exports=n.locals||{}},function(e,t,i){(t=i(54)(!1)).push([e.i,".unifiedDataTableJsonEditor{width:100%}",""]),e.exports=t},function(e,t,i){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});var a=i(1),n=i(48);function s(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(i){if("default"!==i){var a=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,a.get?a:{enumerable:!0,get:function(){return e[i]}})}})),t.default=e,Object.freeze(t)}var o=s(a),r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},r(e,t)};function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var u=function(){return u=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},u.apply(this,arguments)};function c(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(i[a[n]]=e[a[n]])}return i}var d="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==e?e:"undefined"!=typeof self?self:{},p=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},g="object"==typeof d&&d&&d.Object===Object&&d,b="object"==typeof self&&self&&self.Object===Object&&self,m=g||b||Function("return this")(),j=m,x=/\s/,f=/^\s+/,h=m.Symbol,y=h,v=Object.prototype,O=v.hasOwnProperty,k=v.toString,M=y?y.toStringTag:void 0,T=Object.prototype.toString,C=function(e){var t=O.call(e,M),i=e[M];try{e[M]=void 0;var a=!0}catch(e){}var n=k.call(e);return a&&(t?e[M]=i:delete e[M]),n},S=h?h.toStringTag:void 0,w=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":S&&S in Object(e)?C(e):function(e){return T.call(e)}(e)},E=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&x.test(e.charAt(t)););return t}(e)+1).replace(f,""):e},I=p,F=/^[-+]0x[0-9a-f]+$/i,N=/^0b[01]+$/i,_=/^0o[0-7]+$/i,D=parseInt,L=p,z=function(){return j.Date.now()},A=function(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return null!=e&&"object"==typeof e}(e)&&"[object Symbol]"==w(e)}(e))return NaN;if(I(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=I(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=E(e);var i=N.test(e);return i||_.test(e)?D(e.slice(2),i?2:8):F.test(e)?NaN:+e},R=Math.max,P=Math.min,V=function(e,t,i){var a,n,s,o,r,l,u=0,c=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function g(t){var i=a,s=n;return a=n=void 0,u=t,o=e.apply(s,i)}function b(e){var i=e-l;return void 0===l||i>=t||i<0||d&&e-u>=s}function m(){var e=z();if(b(e))return j(e);r=setTimeout(m,function(e){var i=t-(e-l);return d?P(i,s-(e-u)):i}(e))}function j(e){return r=void 0,p&&a?g(e):(a=n=void 0,o)}function x(){var e=z(),i=b(e);if(a=arguments,n=this,l=e,i){if(void 0===r)return function(e){return u=e,r=setTimeout(m,t),c?g(e):o}(l);if(d)return clearTimeout(r),r=setTimeout(m,t),g(l)}return void 0===r&&(r=setTimeout(m,t)),o}return t=A(t)||0,L(i)&&(c=!!i.leading,s=(d="maxWait"in i)?R(A(i.maxWait)||0,t):s,p="trailing"in i?!!i.trailing:p),x.cancel=function(){void 0!==r&&clearTimeout(r),u=0,a=l=n=r=void 0},x.flush=function(){return void 0===r?o:j(z())},x},G=V,B=p,U=function(e,t,i,a){switch(t){case"debounce":return V(e,i,a);case"throttle":return function(e,t,i){var a=!0,n=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return B(i)&&(a="leading"in i?!!i.leading:a,n="trailing"in i?!!i.trailing:n),G(e,t,{leading:a,maxWait:t,trailing:n})}(e,i,a);default:return e}},W=function(e){return"function"==typeof e},H=function(){return"undefined"==typeof window},Q=function(e){return e instanceof Element||e instanceof HTMLDocument},Z=function(e,t,i,a){return function(n){var s=n.width,o=n.height;t((function(t){return t.width===s&&t.height===o||t.width===s&&!a||t.height===o&&!i?t:(e&&W(e)&&e(s,o),{width:s,height:o})}))}},Y=function(e){function t(t){var i=e.call(this,t)||this;i.cancelHandler=function(){i.resizeHandler&&i.resizeHandler.cancel&&(i.resizeHandler.cancel(),i.resizeHandler=null)},i.attachObserver=function(){var e=i.props,t=e.targetRef,a=e.observerOptions;if(!H()){t&&t.current&&(i.targetRef.current=t.current);var n=i.getElement();n&&(i.observableElement&&i.observableElement===n||(i.observableElement=n,i.resizeObserver.observe(n,a)))}},i.getElement=function(){var e=i.props,t=e.querySelector,a=e.targetDomEl;if(H())return null;if(t)return document.querySelector(t);if(a&&Q(a))return a;if(i.targetRef&&Q(i.targetRef.current))return i.targetRef.current;var s=n.findDOMNode(i);if(!s)return null;switch(i.getRenderType()){case"renderProp":case"childFunction":case"child":case"childArray":return s;default:return s.parentElement}},i.createResizeHandler=function(e){var t=i.props,a=t.handleWidth,n=void 0===a||a,s=t.handleHeight,o=void 0===s||s,r=t.onResize;if(n||o){var l=Z(r,i.setState.bind(i),n,o);e.forEach((function(e){var t=e&&e.contentRect||{},a=t.width,n=t.height;!i.skipOnMount&&!H()&&l({width:a,height:n}),i.skipOnMount=!1}))}},i.getRenderType=function(){var e=i.props,t=e.render,n=e.children;return W(t)?"renderProp":W(n)?"childFunction":a.isValidElement(n)?"child":Array.isArray(n)?"childArray":"parent"};var s=t.skipOnMount,o=t.refreshMode,r=t.refreshRate,l=void 0===r?1e3:r,u=t.refreshOptions;return i.state={width:void 0,height:void 0},i.skipOnMount=s,i.targetRef=a.createRef(),i.observableElement=null,H()||(i.resizeHandler=U(i.createResizeHandler,o,l,u),i.resizeObserver=new window.ResizeObserver(i.resizeHandler)),i}return l(t,e),t.prototype.componentDidMount=function(){this.attachObserver()},t.prototype.componentDidUpdate=function(){this.attachObserver()},t.prototype.componentWillUnmount=function(){H()||(this.observableElement=null,this.resizeObserver.disconnect(),this.cancelHandler())},t.prototype.render=function(){var e,t=this.props,i=t.render,n=t.children,s=t.nodeType,r=void 0===s?"div":s,l=this.state,u={width:l.width,height:l.height,targetRef:this.targetRef};switch(this.getRenderType()){case"renderProp":return i&&i(u);case"childFunction":return(e=n)(u);case"child":if((e=n).type&&"string"==typeof e.type){var d=c(u,["targetRef"]);return a.cloneElement(e,d)}return a.cloneElement(e,u);case"childArray":return(e=n).map((function(e){return!!e&&a.cloneElement(e,u)}));default:return o.createElement(r,null)}},t}(a.PureComponent),J=H()?a.useEffect:a.useLayoutEffect;t.default=Y,t.useResizeDetector=function(e){void 0===e&&(e={});var t=e.skipOnMount,i=void 0!==t&&t,n=e.refreshMode,s=e.refreshRate,o=void 0===s?1e3:s,r=e.refreshOptions,l=e.handleWidth,c=void 0===l||l,d=e.handleHeight,p=void 0===d||d,g=e.targetRef,b=e.observerOptions,m=e.onResize,j=a.useRef(i),x=a.useRef(null),f=null!=g?g:x,h=a.useRef(),y=a.useState({width:void 0,height:void 0}),v=y[0],O=y[1];return J((function(){if(!H()){var e=Z(m,O,c,p);h.current=U((function(t){(c||p)&&t.forEach((function(t){var i=t&&t.contentRect||{},a=i.width,n=i.height;!j.current&&!H()&&e({width:a,height:n}),j.current=!1}))}),n,o,r);var t=new window.ResizeObserver(h.current);return f.current&&t.observe(f.current,b),function(){t.disconnect();var e=h.current;e&&e.cancel&&e.cancel()}}}),[n,o,r,c,p,m,b,f.current]),u({ref:f},v)},t.withResizeDetector=function(e,t){void 0===t&&(t={});var i=function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e.ref=a.createRef(),e}return l(n,i),n.prototype.render=function(){var i=this.props,a=i.forwardedRef,n=c(i,["forwardedRef"]),s=null!=a?a:this.ref;return o.createElement(Y,u({},t,{targetRef:s}),o.createElement(e,u({targetRef:s},n)))},n}(a.Component);function n(e,t){return o.createElement(i,u({},e,{forwardedRef:t}))}var s=e.displayName||e.name;return n.displayName="withResizeDetector(".concat(s,")"),a.forwardRef(n)}}).call(this,i(151))},function(e,t,i){e.exports=i(8)(191)},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNDIiIGhlaWdodD0iNDIiIGZpbGw9Im5vbmUiIHZpZXdCb3g9IjAgMCA0MiA0MiI+CiAgPHBhdGggZmlsbD0idXJsKCNyZWRoYXQpIiBkPSJNMzguNzE0IDhIM3YyNi4xOWgzNS43MTRWOFoiLz4KICA8ZGVmcz4KICAgIDxwYXR0ZXJuIGlkPSJyZWRoYXQiIHdpZHRoPSIxIiBoZWlnaHQ9IjEiIHBhdHRlcm5Db250ZW50VW5pdHM9Im9iamVjdEJvdW5kaW5nQm94Ij4KICAgICAgPHVzZSB4bGluazpocmVmPSIjYiIgdHJhbnNmb3JtPSJzY2FsZSguMDEwMyAuMDE0MDYpIi8+CiAgICA8L3BhdHRlcm4+CiAgICA8aW1hZ2UgeGxpbms6aHJlZj0iZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFHRUFBQUJIQ0FZQUFBQVg4eW1JQUFBQUNYQklXWE1BQUFzVEFBQUxFd0VBbXB3WUFBQUFBWE5TUjBJQXJzNGM2UUFBQUFSblFVMUJBQUN4and2OFlRVUFBQXcvU1VSQlZIZ0I3WjE3akZUVkhjZC9NN003c3kvWUI2OVZnUVZxOGNIRExScTFTb3VOMW1xeE5xR21MVlJ0VUdOanJMYmFKcFZxL3hEN0VBczFiYTFwYTB4SnFrMGYwbFlsWUswbENvZ1ZlYXpZRWtXUWgrRENnckFMQzhQdXpwM3I1M2ZQREE2N003dXpNL2ZPSy90TlR1NkR1M1B2UGQvemU1OXpFUmxDM3VHVFBNQVdDUndXcVk3U0FpTGxITnNoa2U2d3lJbVJOQjdLR3VEdlF4MGluK0dpTzdqMlNrNVpuSHVYL1kzODN0b2VrYzNsSW0zRFJUbzUxeTBGanB5VFFHY0ZqNG8wUWNCMTdIK05VNStrV1J4djlZdTh5QU90cE8ycU5SM1lrK1R2cS9qNzZ5SGdoeHhPUzNHYlE3UjFYUHNzYlIzRTdLOHp2eGVSQWtST1NWQUpvQU12WXJ1UVRyODZ4VFg3ZWFoVmROeHlPdnIvbkdvdk05TGhaMGlQWkR1ZmEyNWsyeWpwQWFHVHRkenZYL3hOUzVYSTN2ZTR4NVFDa3BDY2t2Q2h5RGhHKzROMDR2dzBMdS9rdXExc1czaklQZnhkRGNkWDBhWnlya0l5dzNiYUtuNXZCU1MvUFV5a1ZZeUVSQ1dQeUJrSmRGNE5RL0kyYnZnUWh6V1NYM1RSVmtIc0d2VFRHMEdJaHBERCtTSWpaeVMwaTh6Z0RYL0M3alZTUUtBRDFxUDJua2N5dG5DNEJkdXhOOWUySXlja3FERkdGYzFqNUMzaHNFRUtFOXZwak9VTWxKVjRWcHR5S1JrNUlRRmpmQTZqYlFGa2ZGTUtIR3FINkpUVjdEN1BhRmtoT1VDWjVBREk5dGxzWmtvUkFBTE9GOU9hc1dIajYwV1djdTZrZUFqUFNVQUtSdUlMZmdwVjFDVEZoVXRwazQvdzNCL2dUSnlKbXl3ZXdTOGVBNlU2SHFOM29lUkk2bHlHMnEvYks0bk14VU40U2dMNnRReGJjRGJiR1ZLOGFPRDU3MWJWSkI3QlV4S1EzOUZzTHFPTmxlS0dFakJQUElLbkpHQ1F4L3VOS3ZKYzdlVUFYeENQNEZubnFDcWlUYUZkSWlVQVBLVExpSFdHaXdmd2pJVGplRVZpcEtCY1NnQWFjSllaMWVvNlBDT0JISFFqbnRIbnBJUVFNVzZyNi9DRUJFWk5CZTFjTWExa2dFcTZRanlBSnlSUTlTSzJLUzBwaUdHV25Ya2FQU1c4SU1IZktUS0c3ZWVsQk1FQSs2eTREQzlJR0xhVU5BWEpsak9rQkdGN1lKeTlJT0dzdjRwY3U1NFNvcFFtWm9uTGNKc0VyWmhOcFNZNTgzYzRFeFJ5T3FYRWdDUmMzT1p5WlRDanBKb1c3SStKMU9PeVVUZVg0WGdOWmRwK2dRcWlkRGFiODNXdlk4Q2VvekR5RllpdU50ZVZDcXBDcHM3OVgzRUpBNUpBaC9zT2NHTXVITWYrR0xZTkhTYXBOWTZPSDhiMlRQVVlTTlQ1enpVQm1wUG9JdUVWZklJMmdzb205Y3hnb0RpenFFbGhHVmZWZXhKaTg0TXVRS1djQi9QVE9UNkgwMDFzRzJtamVsK1BJVDZKRWVpd2pHZWs4S09XYWhaVFVxQ2VjT2hLOW9mbnY4RHZGdFF1UEN3dW9ROEptdk5oRkU4bVQzSzkzMVRETk9ENnhFQS9SSnFpZTdPWjR6TW00YmNxdEhyK1U0ZzRpSDM0dWpqSmw2SW5ndmRxMW5kenErTFdoNFIyTTdYd0J0cEZNZ2hkamgyd2p5YVpwYUFQdXdPcG9zTGZ0Uk5KbVUrR2U3SkpjUmN0ZE9JWjc5b3NMcW1rMDd3akNMaVZUdnUrbUlCa1VNYVVNTkpQWUJCTWRSOGtvZkpwalBuOWtQR0NTR3Qza2ltT3hRUWUvbUp4Q1lINERnVGNnRDVmRE10blNRWW9OMVcwcW1WbW1raFNXMFBIbCsyQnI0M3NzMjFIeDUyb0wxTDFwQk9ORjRuOFdWeUFRNEw2dmZ6b0gzeG1Wa1JHUUtUOGtORDFxc2krUXlJalVsMm5OZ2ZDeTFCTklkeFlDMklPVGpHenN3TlNSSGdOTS9nbmtkK0xDM0RVRWQ3UGRXSjgzNnhBRFRONHUwaXRER3l3MVBoWHZvR0wrMHNJdXdmaU5oZFpoSDNFU0h1enVBQ0hCRWJ3emVLQ0gwOVFGcHBObXlPeU41M3J1VzhJdFZUOU4xVGdYTlRVdDBUZStaL0lCMUlFV09uTTVuRm5TcWN6QTQ5UkdSWVhVN1RvL0RaWTdXZzFhdy9TUlJTcmJtRWpqdU1WSExnTEtabHFVdUlGQ1ZUb0pweU4zYmlEY3lSTHhFbXd4V1ZBeEluWkpsQkxkeDFCYjV6RVFPMzZMZ2J3aXlJVDZqeXE3MmFDRlNKdjNrZ2d5MjRIZmJjVGRmSmpubStaWklnNENkaEtSNWU3QmxSTjVDOUV5dmVLNHhWbFNvU0RZYWczQXIxOWQ0cE1HcDhrV3M4bDN1TTVMbUhRV3JGcFBHOWl5OGFaZE0wV3lGZ0FHUy9LSU9HUVFIVDhVbXp0bDZ0QVZIdndJdG9XSUJYdmlFeTBzcmM3WWFLODk2OG0rdjRHS1JSZXZwWmdKb0o3N0VlWGxnVThxaFRxZ0NKZkZubUYrT1pXNC9tZGtzcmZpTFRNL2RoQW4wQ2xQTWRMUHRvbHNuVjBtbGxraHdSY3lzZjlIazcxZTR0YjNBZlhtMGgvZEJsWDFJM1o0R0ZFZHg5djN3NHAxWmVUVUtSM0tpR2xSNmQzbEJsaWdwbitPTzVkTndGWmxGNE1iRU5aL0FEeXQ1a3N3bW00UldUOTR0TUR0Nml1TEtJdG9rK2ZHVzdXei9VTHB6TXc4ek1adGY4V0QrcW5jV0Nrai94UjVCaUtzdzZSTG1kMFZZckw0QWYzWThrUGttbTBDUVFyTG9VWVZGa2xMdmhKaUxGNFdadHRsSmVNOWhZWk90eEh4L3ZaQnRoV0lNRzdjYUU3R1AwTlhmMU1nYndXQS8xMDhtbWVLZ1gvNUo1TFVGRnY5YmNpOWRTSVBHenlJSjVPMU1JRkM3L0VyWjdrWmRHbE5SMG1OZUo1a0laVXRGV2FUb2xDU2hjWnhwN2VJdEptbHZWVzBPRWgybGc3VGRYMmJaSFhGNmJ1TjQyWFZ0UEo5MEhFbGxSRW5DSUJ1L0JWRHVnZjc5TUlCQkh0LzBBcUlHVFlCcDRoN0xKVGtFczhobTJlWnp5bFZOQ09mNDIrdlI4aTFpVmJpblZxRk9JSzdpdzNVZk1VOFJqb3lRcVVhL1g1R0RKVkZReFJDL2NzR2kyeTJYcEkwMkhTOUZVRHBPZjlQak1SYmdKaXNYR1JJM1NuNHpRRFNVMWdCcUs0WEhJNFU0SUg2MXFMSUQ3RFBybWswRDUwZUtSSXlxSEVMeTFQcForNk9FcG5MMlhVUDlUYldQZnhVc2lKa01weDFwZmwxQi9YU1FFVWdJNUNSUGxxRENpZVZDQ21wZ3F5TElvazcva3R3akJwY0RIUWZnek5yM2lwSlltZmUraGpGQjhRMlJFMUlxVHpMblBXQWVwT05tRWpMdVNlMDVDT0NSQkJDaU9NZExiVC9ORXMzRTIzb1FUOFRCeTlQZGkwZnhYdlVYY0NqK29SM092NHlUNlNvSVY5WG5vME5OM04vcjArRDkzVy9vQTFzL0JXanVQT2RoUG9CZFpneU5keC9nRFJhVFJQNm9wUnNKOHNzWkN5OEdkYUhhUlBqNnRhWW9COXoyY1d0U2NQbW5SS0MrN2plRjcydG53U0VRZStlemZENWhpRStOaUdXdkRmVVZ1ZHU1Q2NzSm41RVJJUEFlUHZmeHFwdkFuVlE5SGRic2pPbTlNODNXYjY5Slo2Sit2UlQrU3FST0MyTnFLdjVrREd3NzRDTVphVzhhVENOSXVCRWlRSTdDRlplSkNvL1BpNzJCT0tFdldRTnNMTzB0UGlaZmNRaFIrWkJjbHM2NGt0ckVhWFhHbWVyWlYrZlJTWDllZDY3QnZnNGdCbWZIUnMxc1VqWER4QkNneW96VzRpL2k3MHJIWE1HUE55emdVWllxMDRHZUVkTkZTWXBjNDV4MzRHVmtWUFFpQkdyNTZrZ3lOcUhJbTBnK2lZY25JUVRXeTdTWU5FNktoZ2pmc0RVT3ZySzVHb0wrdkJnRGtjdFJHTXVEcWtZU1lYUDJDN1dPRDJFc1FlWVRyZUNwc1NxcTA2UU44Y2x6Z1FUWGh2OUt3VmlxWHlpYWI5bWdTc3kwM2QrK1dHMlBLQnRCTnB0cGt4TWFuTWlldmtUaGxDdG1paEwrY1NNN3lkZHVwWFA3YUJpRzVuVkMxay96dTJxY1lOSVF0WU1ZZG4wUGwzakZNYjR2cFl3TXhOZWtHR2tDazY2OHhIc0RJcmdxaFU4QU1iMkZMUGtEdHN4MzBmd2lBUjhjV0tQbGxWb3ZCejIybFBSSTFVUEM1bUxtcEJmdXl2a0VEblkxNWxRL3c0NjNLZzVzaEpNbTJEakh1UWlDL1IvaU1tV1pYWDc4b1ZNdWlqUXhqbHRmRmoxMnF5UHVOWHI3UE1aT0tiN05pbk5YMUY4RjNTWENMV0h6dm9uelVKNTd5QkxpUkJGRzZtWGVNM2F4dDBNVW5CSk9IeUNCMllEK3JIck9JblBDTWhEaXhQWTdmNWxPWlYrckVSMjh4M3pXc3VLby9RcVVYTDZmUzc2czIrQTg5SmlDT0JqQ3Q4UmpLVWpLem1JeFVUVkEzeDd1dlovZ2dDWHU3MWI3a0YrUnU4VzJtT0dqSzBRRTVXMlBrMFcxSE55aDRNWW5aZ0t5UTgyZUNVcGZ2OGUzNmc5Z0c3TWRZeVg0SzUzRzgreTZNMTdsS1REdjJZT29WQ1dkeGdwc0QwY1ZUeVJrSWk5R09GRWJNMnJwa0h1aURoNHlRanBiaWhIYjZlOS9sMUtnSVVCVUZDSEpvNnB4N1FVRWxCeVRLTEZhZjV6TVFxL1RxOFRqNG9sbVc0R2lQdFE3cWZZcnVzMXN3NVNyazhyS0JJU0VRaUliYXA1VTduemFicjFtZHNTQ0Y2V05yNXJiYjVRdjNmR1VpYlJwbVBvdmVMZ2lXaE44aUgxUEt3OVQ0eklWZGpFSldVNWxoVDFaWFBDV1E2eWwvbDJWNWgreXcxaTcxbm1OUkVXaWdhRWhLaFV0THUxR0FjVDZ2T052dE5pUDk1a0RPUjQ0aytZK1M5TE01bzFLdi9yY0FHTmJ6Y2R6ZVI2TUZha3o4YkZJcVNoR1RReFkvVmtNR1FySXc2Szdla05tcEtzK3B0cVpTb1dxdU1MWTVNSkVkamxqNnFUZXNsWExzdHRxL3I2ZlEvMTNDYW1NN1gvM2VoblhzY1lpUWM4dzN3WDlEMGg1SWhJUmxzODJtSE1xcFhBVjIvZ0ZVUDZEYzIvQWtHdmllRmJiSE44aTNIbTZHakk3cEdnV3NqbzB3SzJ0TnZadzhoRC9nSWlNMVB3aGxVWVo4QUFBQUFTVVZPUks1Q1lJST0iIGlkPSJiIiB3aWR0aD0iOTciIGhlaWdodD0iNzEiIGRhdGEtbmFtZT0icmVkaGF0LnBuZyIvPgogIDwvZGVmcz4KPC9zdmc+"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(1);t.default=function(e,t){void 0===t&&(t=0);var i=a.useRef(!1),n=a.useRef(),s=a.useRef(e),o=a.useCallback((function(){return i.current}),[]),r=a.useCallback((function(){i.current=!1,n.current&&clearTimeout(n.current),n.current=setTimeout((function(){i.current=!0,s.current()}),t)}),[t]),l=a.useCallback((function(){i.current=null,n.current&&clearTimeout(n.current)}),[]);return a.useEffect((function(){s.current=e}),[e]),a.useEffect((function(){return r(),l}),[t]),[o,l,r]}},,,,,,,,,function(e,t,i){"use strict";i.r(t),i.d(t,"CspRouter",(function(){return Xu})),i.d(t,"default",(function(){return Xu}));var a=i(3),n=i.n(a),s=i(1),o=i.n(s),r=i(22),l=i(23);const u={services:{}},c=Object(s.createContext)(u);var d=i(122),p=i.n(d),g=i(0);const b=({children:e,component:t,render:i,...a})=>{const r=Object(s.useMemo)((()=>{if(t)return e=>Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(m,null),Object(g.jsx)(t,e))}),[t]);if(r)return Object(g.jsx)(l.Route,n()({},a,{component:r}));if(i||"function"==typeof e){const t="function"==typeof e?e:i;return Object(g.jsx)(l.Route,n()({},a,{render:e=>Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(m,null),t(e))}))}return Object(g.jsx)(l.Route,a,Object(g.jsx)(m,null),e)},m=()=>{const{executionContext:e}=Object(s.useContext)(c).services,t=Object(l.useRouteMatch)();return function(e,t){p()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null};var j=i(38),x=i(26);const f=({legacySwitch:e=!0,children:t})=>{const i=Object(l.useRouteMatch)();return e?Object(g.jsx)(l.Switch,null,t):Object(g.jsx)(j.Routes,null,s.Children.map(t,(e=>{if(o.a.isValidElement(e)&&e.type===b){var a;const n=Object(x.replace)(null==e?void 0:e.props.path,i.url+"/",""),s="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(g.jsx)(j.Route,{path:n,element:Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(m,null),(null==e||null===(a=e.props)||void 0===a?void 0:a.component)&&Object(g.jsx)(e.props.component,null)||s&&s()||t)})}return e})))};var h=i(6);const y=o.a.createContext(void 0),v=()=>Object(s.useContext)(y);var O=i(62),k=i.n(O),M=i(4),T=i(21),C=i(35),S=i(2),w=i(50);const E=e=>{const{http:t}=Object(w.a)().services;return Object(r.useQuery)(["csp_status_key"],(()=>t.get(S.U,{version:S.T})),e)};var I=i(5),F=i(10),N=i(29),_=i(30);const D=()=>{const{http:e}=Object(w.a)().services;return Object(r.useQuery)(["integrations"],(()=>e.get(_.epmRouteService.getInfoPath(S.t),{version:_.API_VERSIONS.public.v1})))},L=({name:e,perPage:t,page:i,sortField:a,sortOrder:n})=>{const{http:s}=Object(w.a)().services,o={package_policy_name:e,per_page:t,page:i,sort_field:a,sort_order:n};return Object(r.useQuery)(["csp_benchmark_integrations",o],(()=>s.get(S.d,{query:o,version:S.c})),{keepPreviousData:!0})},z=({postureType:e})=>{var t;const{http:i}=Object(w.a)().services,a=D(),n=L({name:"",page:1,perPage:100,sortField:"package_policy.name",sortOrder:"asc"});if(!a.isSuccess)return;const s=null===(t=n.data)||void 0===t?void 0:t.items,o=null==s?void 0:s.find((t=>{var i,a,n;return(null==t||null===(i=t.package_policy)||void 0===i||null===(a=i.inputs)||void 0===a||null===(n=a.find((e=>null==e?void 0:e.enabled)))||void 0===n?void 0:n.policy_template)===e})),r=(null==o?void 0:o.agent_policy.id)||"",l=(null==o?void 0:o.package_policy.id)||"",u=N.pagePathGetters.integration_details_policies({addAgentToPolicyId:r,integration:l,pkgkey:Object(N.pkgKeyFromPackageInfo)({name:a.data.item.name,version:a.data.item.version})}).join("");return i.basePath.prepend(u)};var A=i(9);const R=({licenseManagementLocator:e})=>Object(g.jsx)(M.EuiPageSection,{color:"danger",alignment:"center"},Object(g.jsx)(M.EuiEmptyPrompt,{iconType:"warning",title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptTitle",defaultMessage:"Upgrade for subscription features"})),body:e?Object(g.jsx)("p",{"data-test-subj":"has_locator"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptDescription",defaultMessage:"To use these cloud security features, you must {link}.",values:{link:Object(g.jsx)(M.EuiLink,{href:e},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptLinkText",defaultMessage:"start a trial or upgrade your subscription"}))}})):Object(g.jsx)("p",{"data-test-subj":"no_locator"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.subscriptionNotAllowed.promptDescriptionNoLocator",defaultMessage:"Contact your administrator to change your license."}))}));var P=i(14);const V="Cloud Security";var G=i(13);const B=e=>{var t,i,a;return!!(null!=e&&e.body&&null!=e&&null!==(t=e.body)&&void 0!==t&&t.error&&null!=e&&null!==(i=e.body)&&void 0!==i&&i.message&&null!=e&&null!==(a=e.body)&&void 0!==a&&a.statusCode)};var U={name:"14cfceb",styles:">:nth-child(3){display:block;margin:auto;width:450px;}"};const W=({pageTitle:e,docsLink:t,actionHref:i,actionTitle:a,actionDescription:n,testId:s})=>Object(g.jsx)(A.NoDataPage,{"data-test-subj":s,css:U,pageTitle:e,solution:I.i18n.translate("xpack.csp.cloudPosturePage.packageNotInstalled.solutionNameLabel",{defaultMessage:"Cloud Security Posture"}),docsLink:t,logo:"logoSecurity",actions:{elasticAgent:{href:i,isDisabled:!i,title:a,description:n}}}),H=()=>Object(g.jsx)(G.a,{"data-test-subj":"cloud_posture_page_loading"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.loadingDescription",defaultMessage:"Loading..."})),Q=e=>Object(g.jsx)(F.a,null,Object(g.jsx)(M.EuiEmptyPrompt,{color:"danger",iconType:"warning","data-test-subj":"cloud_posture_page_error",title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.errorRenderer.errorTitle",defaultMessage:"We couldn't fetch your cloud security posture data"})),body:B(e)?Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.errorRenderer.errorDescription",defaultMessage:"{error} {statusCode}: {body}",values:{error:e.body.error,statusCode:e.body.statusCode,body:e.body.message}})):void 0})),Z=()=>Object(g.jsx)(F.a,null,Object(g.jsx)(A.NoDataPage,{"data-test-subj":"cloud_posture_page_no_data",pageTitle:I.i18n.translate("xpack.csp.cloudPosturePage.defaultNoDataConfig.pageTitle",{defaultMessage:"No data found"}),solution:I.i18n.translate("xpack.csp.cloudPosturePage.defaultNoDataConfig.solutionNameLabel",{defaultMessage:"Cloud Security Posture"}),docsLink:"https://www.elastic.co/guide/index.html",logo:"logoSecurity",actions:{}})),Y=({children:e,query:t,loadingRender:i=H,errorRender:a=Q,noDataRenderer:n=Z})=>{const l=(()=>{const{licensing:e}=Object(w.a)().services,{isCloudEnabled:t}=Object(s.useContext)(P.a);return Object(r.useQuery)(["csp_subscription_query_key"],(async()=>{const i=await e.refresh();return((e,t)=>!!e||!!t&&"valid"===t.check(V,"enterprise").state)(t,i)}))})(),u=(()=>{const{share:e}=Object(w.a)().services;return Object(r.useQuery)(["license_management_url_key"],(()=>{const t=e.url.locators.get("LICENSE_MANAGEMENT_LOCATOR");if(t)return t.getUrl({page:"dashboard"})}))})();return Object(g.jsx)(o.a.Fragment,null,l.isError?Q(l.error):l.isLoading||u.isLoading?H():l.data?t?t.isError?a(t.error):t.isLoading?i():t.data?e:n():e:(c=u.data,Object(g.jsx)(F.a,{"data-test-subj":"cloud_posture_page_subscription_not_allowed"},Object(g.jsx)(R,{licenseManagementLocator:c}))));var c};var J=i(76),q=i.n(J);const K=e=>{const{http:t}=Object(w.a)().services,i=D();if(!i.isSuccess)return;const a=N.pagePathGetters.add_integration_to_policy({integration:e,pkgkey:Object(N.pkgKeyFromPackageInfo)({name:i.data.item.name,version:i.data.item.version})}).join("");return t.basePath.prepend(a)};var $=i(49);const X=({postureType:e})=>{const t=z({postureType:e});return Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"status-api-no-agent-deployed",color:"plain",iconType:"fleetApp",title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noFindingsStates.noAgentsDeployed.noAgentsDeployedTitle",defaultMessage:"No Agents Installed"})),body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noFindingsStates.noAgentsDeployed.noAgentsDeployedDescription",defaultMessage:"In order to begin detecting security misconfigurations, you'll need to deploy elastic-agent into the cloud account or Kubernetes cluster you want to monitor."})),actions:[Object(g.jsx)(M.EuiButton,{fill:!0,href:t,isDisabled:!t},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noFindingsStates.noAgentsDeployed.noAgentsDeployedButtonTitle",defaultMessage:"Install Agent"}))]})},ee=()=>Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"status-api-indexing",color:"plain",icon:Object(g.jsx)(M.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}),title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexing.indexingButtonTitle",defaultMessage:"Posture evaluation underway"})),body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexing.indexingDescription",defaultMessage:"Waiting for data to be collected and indexed. Check back later to see your findings"}))}),te=()=>Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"status-api-index-timeout",color:"plain",icon:Object(g.jsx)(M.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}),title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexTimeout.indexTimeoutTitle",defaultMessage:"Waiting for Findings data"})),body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexTimeout.indexTimeoutDescription",defaultMessage:"Collecting findings is taking longer than expected. {docs}.",values:{docs:Object(g.jsx)(M.EuiLink,{href:"https://ela.st/findings",target:"_blank"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noFindingsStates.indexTimeout.indexTimeoutDocLink",defaultMessage:"Learn more"}))}}))});var ie={name:"1b7vz4z",styles:"text-align:initial"};const ae=({unprivilegedIndices:e})=>Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"status-api-unprivileged",color:"plain",icon:Object(g.jsx)(M.EuiIcon,{type:"logoSecurity",size:"xl"}),title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noFindingsStates.unprivileged.unprivilegedTitle",defaultMessage:"Privileges required"})),body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noFindingsStates.unprivileged.unprivilegedDescription",defaultMessage:"To view cloud posture data, you must update privileges. For more information, contact your Kibana administrator."})),footer:Object(g.jsx)(M.EuiMarkdownFormat,{css:ie,children:I.i18n.translate("xpack.csp.noFindingsStates.unprivileged.unprivilegedFooterMarkdown",{defaultMessage:"Required Elasticsearch index privilege `read` for the following indices:"})+e.map((e=>`\n- \`${e}\``))})}),ne=({kspmIntegrationLink:e,cspmIntegrationLink:t})=>Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"cloud_posture_page_package_not_installed",icon:Object(g.jsx)(M.EuiImage,{size:"fullWidth",src:q.a,alt:"no-data-illustration"}),title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalledRenderer.promptTitle",defaultMessage:"Detect security misconfigurations in your cloud infrastructure!"})),layout:"horizontal",color:"plain",body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalledRenderer.promptDescription",defaultMessage:"Detect and remediate potential configuration risks in your cloud infrastructure, like publicly accessible S3 buckets, with our Cloud and Kubernetes Security Posture Management solutions. {learnMore}",values:{learnMore:Object(g.jsx)(M.EuiLink,{href:h.d.cspm.overviewPath,target:"_blank"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalledRenderer.learnMoreTitle",defaultMessage:"Learn more about Cloud Security Posture"}))}})),actions:Object(g.jsx)(M.EuiFlexGroup,null,Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiButton,{color:"primary",fill:!0,href:t,"data-test-subj":"cspm-not-installed-action"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalledRenderer.addCspmIntegrationButtonTitle",defaultMessage:"Add CSPM Integration"}))),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiButton,{color:"primary",fill:!0,href:e,"data-test-subj":"kspm-not-installed-action"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.packageNotInstalledRenderer.addKspmIntegrationButtonTitle",defaultMessage:"Add KSPM Integration"}))))}),se=({posturetype:e})=>{var t,i,a,n,s,o,r,l,u;const c=E({refetchInterval:$.o}),d=null===(t=c.data)||void 0===t||null===(i=t.kspm)||void 0===i?void 0:i.status,p=null===(a=c.data)||void 0===a||null===(n=a.cspm)||void 0===n?void 0:n.status,b=null===(s=c.data)||void 0===s?void 0:s.indicesDetails,m="cspm"===e?p:d,j="not-installed"===(null===(o=c.data)||void 0===o||null===(r=o.kspm)||void 0===r?void 0:r.status)&&"not-installed"===(null===(l=c.data)||void 0===l||null===(u=l.cspm)||void 0===u?void 0:u.status),x=K(S.H),f=K(S.v),h=b&&b.filter((e=>"unprivileged"===e.status)).map((e=>e.index)).sort(((e,t)=>e.localeCompare(t)));return Object(g.jsx)(Y,{query:c},Object(g.jsx)(F.a,null,"not-deployed"===m?Object(g.jsx)(X,{postureType:e}):"indexing"===m||"waiting_for_results"===m?Object(g.jsx)(ee,null):"index-timeout"===m?Object(g.jsx)(te,null):"unprivileged"===m?Object(g.jsx)(ae,{unprivilegedIndices:h||[]}):j?Object(g.jsx)(ne,{kspmIntegrationLink:x,cspmIntegrationLink:f}):void 0))},oe={"result.evaluation":I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resultColumnLabel",{defaultMessage:"Result"}),"resource.id":I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceIdColumnLabel",{defaultMessage:"Resource ID"}),"resource.name":I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceNameColumnLabel",{defaultMessage:"Resource Name"}),"resource.sub_type":I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceTypeColumnLabel",{defaultMessage:"Resource Type"}),"rule.benchmark.rule_number":I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleNumberColumnLabel",{defaultMessage:"Rule Number"}),"rule.name":I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleNameColumnLabel",{defaultMessage:"Rule Name"}),"rule.section":I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleSectionColumnLabel",{defaultMessage:"CIS Section"}),"@timestamp":I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.lastCheckedColumnLabel",{defaultMessage:"Last Checked"})},re=e=>{const{data:{dataViews:t}}=Object(A.useKibana)().services;return Object(r.useQuery)([`useDataView-${e}`],(async()=>{const[i]=await t.find(e);if(!i)throw new Error(`Data view not found [Name: {${e}}]`);return e===S.J&&(Object.entries(oe).forEach((([e,t])=>{var a,n;null!==(a=i.getFieldAttrs()[e])&&void 0!==a&&a.customLabel&&(null===(n=i.getFieldAttrs()[e])||void 0===n?void 0:n.customLabel)!==e||i.setFieldCustomLabel(e,t)})),await t.updateSavedObject(i)),i}))},le=({dataView:e,loading:t,setQuery:i,placeholder:a=I.i18n.translate("xpack.csp.findings.searchBar.searchPlaceholder",{defaultMessage:'Search findings (eg. rule.section : "API Server" )'})})=>{const{euiTheme:n}=Object(M.useEuiTheme)(),{unifiedSearch:{ui:{SearchBar:r}}}=Object(A.useKibana)().services,l=Object(s.useContext)(y);let u=Object(g.jsx)("div",{css:ue(n)},Object(g.jsx)(r,{appName:V,showFilterBar:!0,showQueryInput:!0,showDatePicker:!1,saveQueryMenuVisibility:"hidden",isLoading:t,indexPatterns:[e],onQuerySubmit:i,onFiltersUpdated:e=>i({filters:e}),placeholder:a}));if(l){const e=l.getFiltersGlobalComponent();u=Object(g.jsx)(e,null,u)}return Object(g.jsx)(o.a.Fragment,null,u)},ue=e=>Object(g.css)("border-bottom:",e.border.thin,";background-color:",e.colors.body,";padding:",e.size.base,";",""),ce=(e,t,i)=>Object(s.useMemo)((()=>{if(!e)return[];const a=t*i;return e.slice(a,a+i)}),[e,t,i]);var de=i(27),pe=i(51);const ge=I.i18n.translate("xpack.csp.findings.findingsErrorToast.searchFailedTitle",{defaultMessage:"Search failed"}),be=(e,t)=>{t instanceof Error?e.addError(t,{title:ge}):e.addDanger(Object(pe.c)(t,ge))};var me=i(25);const je={negate:!1},xe=({filters:e,dataView:t,field:i,value:a,negate:n})=>{const s=t.getFieldByName(i);if(!s)return e;const o=Object(me.buildFilter)(t,s,me.FILTERS.PHRASE,n,!1,a,null,me.FilterStateStore.APP_STATE);return[...e.filter((e=>!Object(me.compareFilters)(e,o,je))),o]},fe=e=>{const t=e.find((e=>"passed"===(null==e?void 0:e.key))),i=e.find((e=>"failed"===(null==e?void 0:e.key)));return{passed:(null==t?void 0:t.doc_count)||0,failed:(null==i?void 0:i.doc_count)||0}},he=(e,t)=>e.resource.id===(null==t?void 0:t.resource.id)&&e.rule.id===(null==t?void 0:t.rule.id),ye=(e,t,i)=>({background:he(t,i)?e.colors.highlight:void 0}),ve=({query:e,sortDirection:t})=>({index:S.w,query:e,size:0,runtime_mappings:{belongs_to:{type:"keyword",script:{source:'\n        def postureTypeAvailable = doc.containsKey("rule.benchmark.posture_type") &&\n          !doc["rule.benchmark.posture_type"].empty;\n        def orchestratorIdAvailable = doc.containsKey("orchestrator.cluster.id") &&\n          !doc["orchestrator.cluster.id"].empty;\n\n        if (!postureTypeAvailable) {\n          def belongs_to = orchestratorIdAvailable ?\n            doc["orchestrator.cluster.id"].value : doc["cluster_id"].value;\n          emit(belongs_to);\n        } else {\n          def policy_template_type = doc["rule.benchmark.posture_type"].value;\n\n          if (policy_template_type == "cspm") {\n            def belongs_to = doc["cloud.account.name"].value;\n            emit(belongs_to);\n          } else if (policy_template_type == "kspm") {\n            def belongs_to = orchestratorIdAvailable ?\n              doc["orchestrator.cluster.id"].value : doc["cluster_id"].value;\n            emit(belongs_to);\n          } else {\n            // Default behaviour when policy_template_type is unknown\n            def belongs_to = orchestratorIdAvailable ?\n              doc["orchestrator.cluster.id"].value : doc["cluster_id"].value;\n            emit(belongs_to);\n          }\n        }\n      '}}},aggs:{count:{terms:{field:"result.evaluation"}},resource_total:{cardinality:{field:"resource.id"}},resources:{terms:{field:"resource.id",size:6e4},aggs:{name:{terms:{field:"resource.name",size:1}},subtype:{terms:{field:"resource.sub_type",size:1}},benchmarkName:{terms:{field:"rule.benchmark.name"}},cis_sections:{terms:{field:"rule.section"}},failed_findings:{filter:{term:{"result.evaluation":"failed"}}},passed_findings:{filter:{term:{"result.evaluation":"passed"}}},belongs_to:{terms:{field:"belongs_to",size:1}},compliance_score:{bucket_script:{buckets_path:{passed:"passed_findings>_count",failed:"failed_findings>_count"},script:"params.passed / (params.passed + params.failed)"}},sort_by_compliance_score:{bucket_sort:{size:$.m,sort:[{compliance_score:{order:t},_count:{order:"desc"},_key:{order:"asc"}}]}}}}},ignore_unavailable:!1}),Oe=e=>{if(Array.isArray(e)&&e.length)return e[0].key},ke=e=>{if(Array.isArray(e)&&e.length)return e.map((e=>e.key))},Me=e=>({resource_id:e.key,"resource.name":Oe(e.name.buckets),"resource.sub_type":Oe(e.subtype.buckets),"rule.section":ke(e.cis_sections.buckets),"rule.benchmark.name":Oe(e.benchmarkName.buckets),belongs_to:Oe(e.belongs_to.buckets),compliance_score:e.compliance_score.value,findings:{failed_findings:e.failed_findings.doc_count,normalized:e.doc_count>0?e.failed_findings.doc_count/e.doc_count:0,total_findings:e.doc_count,passed_findings:e.passed_findings.doc_count}});var Te=i(39),Ce=i.n(Te);const Se=({tooltipContent:e,columnName:t})=>Object(g.jsx)(M.EuiToolTip,{content:e},Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)("span",null,t)),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiIcon,{size:"m",color:"subdued",type:"questionInCircle"}))));var we={name:"1d3w5wq",styles:"width:100%"};const Ee=({totalPassed:e,totalFailed:t,size:i="m",overrideCss:a})=>{const{euiTheme:n}=Object(M.useEuiTheme)(),s=Object(pe.b)(e,t),o=we;return Object(g.jsx)(M.EuiToolTip,{anchorProps:{css:a||o},content:I.i18n.translate("xpack.csp.complianceScoreBar.tooltipTitle",{defaultMessage:"{failed} failed and {passed} passed findings",values:{passed:e,failed:t}})},Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",justifyContent:"flexEnd"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"none",css:Object(g.css)("height:","m"===i?n.size.xs:"6px",";border-radius:",n.border.radius.medium,";overflow:hidden;gap:1px;","")},!!e&&Object(g.jsx)(M.EuiFlexItem,{css:Object(g.css)("flex:",e,";background:",$.q.passed,";","")}),!!t&&Object(g.jsx)(M.EuiFlexItem,{css:Object(g.css)("flex:",t,";background:",$.q.failed,";","")}))),Object(g.jsx)(M.EuiFlexItem,{grow:!1,css:Object(g.css)("width:",n.size.xxl,";text-align:right;","")},Object(g.jsx)(M.EuiText,{size:"xs","data-test-subj":"cloudSecurityFindingsComplianceScore",css:Object(g.css)("font-weight:",n.font.weight.bold,";","")},`${s.toFixed(0)}%`))))};var Ie=i(24),Fe=i(33),Ne=i.n(Fe);const _e=({timestamp:e})=>Object(g.jsx)(M.EuiToolTip,{position:"top",content:Ne()(e).format($.a)},Object(g.jsx)("span",null,Ne()(e).fromNow())),De=e=>"passed"===e?$.q.passed:"failed"===e?$.q.failed:"default",Le=({type:e})=>Object(g.jsx)(M.EuiBadge,{color:De(e),css:Object(g.css)("width:","46px",";display:flex;justify-content:center;",""),"data-test-subj":`${e}_finding`},"failed"===e?Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cspEvaluationBadge.failLabel",defaultMessage:"Fail"}):Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cspEvaluationBadge.passLabel",defaultMessage:"Pass"})),ze=({children:e})=>Object(g.jsx)(M.EuiTitle,{size:"l"},Object(g.jsx)("div",null,e)),Ae=({title:e})=>Object(g.jsx)(M.EuiText,{grow:!1,size:"s"},Object(g.jsx)("h1",null,e)),Re=({onClick:e})=>({width:"40px",actions:[{"data-test-subj":"findings_table_expand_column",name:I.i18n.translate("xpack.csp.expandColumnNameLabel",{defaultMessage:"Expand"}),description:I.i18n.translate("xpack.csp.expandColumnDescriptionLabel",{defaultMessage:"Expand"}),type:"icon",icon:"expand",onClick:e}]}),Pe=[{field:"resource.id",name:Object(g.jsx)(Se,{columnName:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceIdColumnLabel",{defaultMessage:"Resource ID"}),tooltipContent:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceIdColumnTooltipLabel",{defaultMessage:"Custom Elastic Resource ID"})}),truncateText:!0,width:"180px",sortable:!0,render:e=>Object(g.jsx)(M.EuiToolTip,{position:"top",content:e,anchorClassName:"eui-textTruncate"},Object(g.jsx)("span",null,e))},{field:"result.evaluation",name:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resultColumnLabel",{defaultMessage:"Result"}),width:"80px",sortable:!0,render:e=>Object(g.jsx)(Le,{type:e})},{field:"resource.sub_type",name:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceTypeColumnLabel",{defaultMessage:"Resource Type"}),sortable:!0,truncateText:!0,width:"10%"},{field:"resource.name",name:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.resourceNameColumnLabel",{defaultMessage:"Resource Name"}),sortable:!0,truncateText:!0,width:"12%",render:e=>{if(e)return Object(g.jsx)(M.EuiToolTip,{content:e,position:"left",anchorClassName:"eui-textTruncate"},Object(g.jsx)(o.a.Fragment,null,e))}},{field:"rule.name",name:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleNameColumnLabel",{defaultMessage:"Rule Name"}),sortable:!0,render:e=>Object(g.jsx)(M.EuiToolTip,{content:e,position:"left",anchorClassName:"eui-textTruncate"},Object(g.jsx)(o.a.Fragment,null,e))},{field:"rule.benchmark.rule_number",name:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleNumberColumnLabel",{defaultMessage:"Rule Number"}),sortable:!0,width:"120px"},{field:"rule.benchmark.name",name:Object(g.jsx)(Se,{columnName:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleBenchmarkColumnLabel",{defaultMessage:"Applicable Benchmark"}),tooltipContent:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleBenchmarkColumnTooltipLabel",{defaultMessage:"The benchmark used to evaluate this resource"})}),sortable:!0,truncateText:!0},{field:"rule.section",name:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.ruleSectionColumnLabel",{defaultMessage:"CIS Section"}),width:"150px",sortable:!0,truncateText:!0,render:e=>Object(g.jsx)(M.EuiToolTip,{content:e,anchorClassName:"eui-textTruncate"},Object(g.jsx)(o.a.Fragment,null,e))},{field:"@timestamp",align:"right",width:"10%",name:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.lastCheckedColumnLabel",{defaultMessage:"Last Checked"}),truncateText:!0,sortable:!0,render:e=>Object(g.jsx)(_e,{timestamp:e})}],Ve=Object.fromEntries(Pe.map((e=>[e.field,e]))),Ge=(e,{onAddFilter:t})=>({...e,render:(i,a)=>{var n;return Object(g.jsx)(We,{onAddFilter:()=>t(e.field,i,!1),onAddNegateFilter:()=>t(e.field,i,!0),field:e.field},(null===(n=e.render)||void 0===n?void 0:n.call(e,i,a))||Be(i))}}),Be=e=>{if(e)return"string"==typeof e||"number"==typeof e?e:void 0};var Ue={name:"1w3lhpq",styles:"opacity:0;position:absolute;right:0;top:0;display:flex"};const We=({children:e,onAddFilter:t,onAddNegateFilter:i,field:a})=>Object(g.jsx)("div",{css:Object(g.css)("position:relative;width:100%;&:hover{>.__filter_buttons{opacity:1;}>.__filter_value{max-width:calc(100% - calc(",Ie.euiThemeVars.euiSizeL," * 2));}}","")},Object(g.jsx)("div",{className:"__filter_value eui-textTruncate","data-test-subj":"filter_cell_value"},e),Object(g.jsx)("div",{className:"__filter_buttons",css:Ue},Object(g.jsx)(M.EuiToolTip,{position:"top",content:I.i18n.translate("xpack.csp.findings.findingsTableCell.addFilterButtonTooltip",{defaultMessage:"Add {field} filter",values:{field:a}})},Object(g.jsx)(M.EuiButtonIcon,{iconType:"plusInCircleFilled",onClick:t,"data-test-subj":"findings_table_cell_add_filter","aria-label":I.i18n.translate("xpack.csp.findings.findingsTableCell.addFilterButton",{defaultMessage:"Add {field} filter",values:{field:a}})})),Object(g.jsx)(M.EuiToolTip,{position:"top",content:I.i18n.translate("xpack.csp.findings.findingsTableCell.addNegatedFilterButtonTooltip",{defaultMessage:"Add {field} negated filter",values:{field:a}})},Object(g.jsx)(M.EuiButtonIcon,{iconType:"minusInCircleFilled",onClick:i,"data-test-subj":"findings_table_cell_add_negated_filter","aria-label":I.i18n.translate("xpack.csp.findings.findingsTableCell.addNegateFilterButton",{defaultMessage:"Add {field} negated filter",values:{field:a}})})))),He=()=>Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiSpacer,{size:"xxl"}),Object(g.jsx)(M.EuiBottomBar,{"data-test-subj":"test-bottom-bar",paddingSize:"s"},Object(g.jsx)(M.EuiText,{textAlign:"center"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings..bottomBarLabel",defaultMessage:"These are the first {maxItems} findings matching your search, refine your search to see others.",values:{maxItems:$.m}}))));var Qe=i(125),Ze=i.n(Qe),Ye={name:"p3n7py",styles:"width:290px"};const Je=({onResetFilters:e,docsUrl:t=$.e})=>{const{euiTheme:i}=Object(M.useEuiTheme)();return Object(g.jsx)(M.EuiEmptyPrompt,{css:Object(g.css)("max-width:734px;&&>.euiEmptyPrompt__main{gap:",i.size.xl,";}&&{margin-top:",i.size.xxxl,";}",""),"data-test-subj":"csp:empty-state",icon:Object(g.jsx)(M.EuiImage,{url:Ze.a,alt:I.i18n.translate("xpack.csp.emptyState.illustrationAlt",{defaultMessage:"No results"}),css:Ye}),title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.emptyState.title",defaultMessage:"No results match your search criteria"})),layout:"horizontal",color:"plain",body:Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.emptyState.description",defaultMessage:"Try modifying your search or filter set"}))),actions:[Object(g.jsx)(M.EuiButton,{color:"primary",fill:!0,onClick:e},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.emptyState.resetFiltersButton",defaultMessage:"Reset filters"})),Object(g.jsx)(M.EuiLink,{href:t,target:"_blank"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.emptyState.readDocsLink",defaultMessage:"Read the docs"}))]})},qe=e=>{const t=e["rule.section"]||[];return[e.resource_id,...t].join("/")},Ke=({items:e,loading:t,pagination:i,sorting:a,setTableOptions:n,onAddFilter:o,onResetFilters:r})=>{const l=e=>({...e,sortable:!1}),u=Object(s.useMemo)((()=>[{...l(Xe.resource_id),"data-test-subj":"findings_by_resource_table_resource_id_column"},Ge(l(Xe["resource.sub_type"]),{onAddFilter:o}),Ge(l(Xe["resource.name"]),{onAddFilter:o}),Ge(l(Xe["rule.benchmark.name"]),{onAddFilter:o}),l(Xe.belongs_to),Xe.compliance_score]),[o]);return t||e.length?Object(g.jsx)(M.EuiBasicTable,{"data-test-subj":"findings_by_resource_table",loading:t,items:e,columns:u,rowProps:e=>{return{"data-test-subj":(t=qe(e),`findings_resource_table_row_${t}`)};var t},pagination:i,sorting:a,onChange:n}):Object(g.jsx)(Je,{onResetFilters:r})},$e=[{...Ve["resource.id"],field:"resource_id",width:"15%",render:e=>{if(e)return Object(g.jsx)(l.Link,{to:Object(l.generatePath)(h.e.resource_findings.path,{resourceId:encodeURIComponent(e)}),className:"eui-textTruncate",title:e},e)}},Ve["resource.sub_type"],Ve["resource.name"],Ve["rule.benchmark.name"],{field:"rule.section",truncateText:!0,name:Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.findingsByResourceTable.cisSectionsColumnLabel",defaultMessage:"CIS Sections"}),render:e=>{const t=e.join(", ");return Object(g.jsx)(M.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},Object(g.jsx)(o.a.Fragment,null,t))}},{field:"belongs_to",name:Object(g.jsx)(Se,{columnName:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.clusterIdColumnLabel",{defaultMessage:"Belongs To"}),tooltipContent:I.i18n.translate("xpack.csp.findings.findingsTable.findingsTableColumn.clusterIdColumnTooltipLabel",{defaultMessage:"Kubernetes Cluster ID or Cloud Account Name"})}),truncateText:!0},{field:"compliance_score",width:"150px",truncateText:!0,sortable:!0,name:Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.findingsByResourceTable.postureScoreColumnLabel",defaultMessage:"Posture Score"}),render:(e,t)=>Object(g.jsx)(Ee,{totalPassed:t.findings.passed_findings,totalFailed:t.findings.failed_findings}),dataType:"number"}],Xe=Object.fromEntries($e.map((e=>[e.field,e]))),et=o.a.memo(Ke),tt=()=>[{value:"default",label:I.i18n.translate("xpack.csp.findings.groupBySelector.groupByNoneLabel",{defaultMessage:"None"})},{value:"resource",label:I.i18n.translate("xpack.csp.findings.groupBySelector.groupByResourceIdLabel",{defaultMessage:"Resource"})}],it=e=>{const[t]=e;return"resource"===(null==t?void 0:t.value)?h.e.findings_by_resource.path:h.e.findings_default.path},at=({type:e,pathnameHandler:t=it})=>{const i=Object(s.useMemo)(tt,[]),a=Object(l.useHistory)();return Object(g.jsx)(M.EuiComboBox,{"data-test-subj":"findings_group_by_selector",prepend:Object(g.jsx)(nt,null),singleSelection:{asPlainText:!0},options:i,selectedOptions:i.filter((t=>t.value===e)),onChange:e=>a.push({pathname:t(e)}),isClearable:!1,compressed:!0})},nt=()=>Object(g.jsx)(M.EuiFormLabel,null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.groupBySelector.groupByLabel",defaultMessage:"Group by"})),st="1rem",ot=({testId:e,listItems:t})=>{const{euiTheme:i}=Object(M.useEuiTheme)(),a=(e=>null==e?void 0:e.filter((e=>!(null==e||!e.title||null==e||!e.description))).map((e=>({...e,title:`${e.title}:`}))))(t);return Object(g.jsx)(M.EuiDescriptionList,{"data-test-subj":e,type:"inline",titleProps:{style:{background:"initial",color:i.colors.subduedText,fontSize:st,paddingRight:0,paddingInline:0}},descriptionProps:{style:{color:i.colors.subduedText,marginRight:i.size.xs,fontSize:st}},listItems:a})},rt=({title:e,isBeta:t})=>Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiTitle,null,Object(g.jsx)("h1",null,e))),t&&Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiBetaBadge,{label:"Beta",tooltipContent:Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.betaLabel",defaultMessage:"This functionality is in beta and is subject to change. The design and code is less mature than official generally available features and is being provided as-is with no warranties. Beta features are not subject to the support service level agreement of official generally available features."}),tooltipPosition:"bottom"})));var lt=i(36);const ut=({query:e,resourceId:t,sort:i})=>{var a;return{index:S.w,body:{size:$.m,runtime_mappings:{safe_kspm_cluster_id:{type:"keyword",script:{source:'\n        def orchestratorIdAvailable = doc.containsKey("orchestrator.cluster.id") &&\n          !doc["orchestrator.cluster.id"].empty;\n        def clusterIdAvailable = doc.containsKey("cluster_id") &&\n          !doc["cluster_id"].empty;\n          \n        if (orchestratorIdAvailable) {\n          emit(doc["orchestrator.cluster.id"].value);\n        } else if (clusterIdAvailable) {\n          emit(doc["cluster_id"].value);\n        }\n      '}}},query:{...e,bool:{...null==e?void 0:e.bool,filter:[...(null==e||null===(a=e.bool)||void 0===a?void 0:a.filter)||[],{term:{"resource.id":t}}]}},sort:[{[i.field]:i.direction}],aggs:{count:{terms:{field:"result.evaluation"}},cloudAccountName:{terms:{field:"cloud.account.name"}},clusterId:{terms:{field:"safe_kspm_cluster_id"}},resourceSubType:{terms:{field:"resource.sub_type"}},resourceName:{terms:{field:"resource.name"}}}},ignore_unavailable:!1}};function ct(e){if(!Array.isArray(e))throw new Error("expected buckets to be an array")}const dt=e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.key};var pt=i(37),gt=i(77),bt=i.n(gt);const mt=(e,t,i)=>e.toasts.addSuccess({toastLifeTimeMs:1e4,color:"success",iconType:"","data-test-subj":"csp:toast-success",text:Object(A.toMountPoint)(Object(g.jsx)("div",null,Object(g.jsx)(M.EuiText,{size:"m"},Object(g.jsx)("strong",{"data-test-subj":"csp:toast-success-title"},i.name)," ",Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.flyout.ruleCreatedToastTitle",defaultMessage:"detection rule was created."})),Object(g.jsx)(M.EuiText,{size:"s"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.flyout.ruleCreatedToast",defaultMessage:"Add rule actions to get notified when alerts are generated."})),Object(g.jsx)(M.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiButton,{"data-test-subj":"csp:toast-success-link",size:"s",href:t.basePath.prepend("/app/security/rules/id/"+i.id)},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.flyout.ruleCreatedToastViewRuleButton",defaultMessage:"View rule"}))))))}),jt=({createRuleFn:e})=>{const t=Object(r.useQueryClient)(),[i,a]=Object(s.useState)(!1),[n,o]=Object(s.useState)(!1),l=()=>{a(!1)},u=Object(M.useGeneratedHtmlId)({prefix:"smallContextMenuPopover"}),{http:c,notifications:d}=Object(w.a)().services,p=Object(g.jsx)(M.EuiButton,{isLoading:n,fill:!0,iconType:"arrowDown",iconSide:"right",onClick:()=>a(!i)},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.flyout.takeActionButton",defaultMessage:"Take action"}));return Object(g.jsx)(M.EuiPopover,{id:u,button:p,isOpen:i,closePopover:l,panelPaddingSize:"none",anchorPosition:"downLeft","data-test-subj":"csp:take_action"},Object(g.jsx)(M.EuiContextMenuPanel,{size:"s",items:[Object(g.jsx)(M.EuiContextMenuItem,{key:"createRule",onClick:async()=>{l(),o(!0);const i=await e(c);o(!1),mt(d,c,i),t.invalidateQueries([$.d]),t.invalidateQueries([$.c])},"data-test-subj":"csp:create_rule"},Object(g.jsx)(T.FormattedMessage,{defaultMessage:"Create a detection rule",id:"xpack.csp.createDetectionRuleButton"}))]}))},xt={box:{incremental:!0}},ft={sort:{field:"key",direction:"asc"}},ht={initialPageSize:100,showPerPageOptions:!1},yt=[{field:"key",name:I.i18n.translate("xpack.csp.flyout.tableTab.fieldLabel",{defaultMessage:"Field"}),width:"25%"},{field:"value",name:I.i18n.translate("xpack.csp.flyout.tableTab.fieldValueLabel",{defaultMessage:"Value"}),render:(e,t)=>Object(g.jsx)("div",{style:{width:"100%"}},(e=>void 0===e?"undefined":"boolean"==typeof e||null===e?Object(g.jsx)(M.EuiCode,null,JSON.stringify(e)):"object"==typeof e?Object(g.jsx)(M.EuiCodeBlock,{isCopyable:!0,overflowHeight:300},JSON.stringify(e,null,2)):Object(g.jsx)(M.EuiText,{size:"s"},e))(e))}],vt=({data:e})=>{return Object(g.jsx)(M.EuiInMemoryTable,{items:(t=e,Object.entries(Object(pt.getFlattenedObject)(t)).map((([e,t])=>({key:e,value:t})))),columns:yt,sorting:ft,search:xt,pagination:ht});var t};var Ot=i(28);const kt=({data:e})=>Object(g.jsx)("div",{style:{position:"absolute",inset:0,top:120,bottom:72}},Object(g.jsx)(A.CodeEditor,{isCopyable:!0,allowFullScreen:!0,languageId:Ot.XJsonLang.ID,value:JSON.stringify(e,null,2),options:{readOnly:!0,lineNumbers:"on",folding:!0}}));var Mt=i(126),Tt=i.n(Mt);const Ct="alert.attributes.tags";function St(e){return`${Ct}:(${e.map((e=>`"${e}"`)).join(" AND ")})`}const wt=({tags:e,createRuleFn:t})=>{const{data:i,isLoading:a}=(e=>{const{http:t}=Object(A.useKibana)().services,i={page:1,per_page:1,filter:St(e)};return Object(r.useQuery)([$.d,e],(()=>t.fetch("/api/detection_engine/rules/_find",{method:"GET",version:S.z,query:i})))})(e),{data:n,isLoading:u}=(e=>{const{http:t}=Object(A.useKibana)().services;if(!t)throw new Error("Kibana http service is not available");return Object(r.useQuery)([$.c,e],(()=>t.get(S.F,{version:S.y,query:{tags:e}})))})(e),[c,d]=Object(s.useState)(!1),p=Object(r.useQueryClient)(),{http:b,notifications:m}=Object(w.a)().services,j=Object(l.useHistory)(),[,x]=Tt()("securitySolution.rulesTable"),f=Object(s.useCallback)((async()=>{await x({tags:e}),j.push({pathname:"/rules/management"})}),[j,x,e]),h=Object(s.useCallback)((()=>{j.push({pathname:"/alerts"})}),[j]),y=Object(s.useCallback)((async()=>{d(!0);const e=await t(b);d(!1),mt(m,b,e),p.invalidateQueries([$.d]),p.invalidateQueries([$.c])}),[t,b,m,p]);return Object(g.jsx)(M.EuiSkeletonText,{"data-test-subj":"csp:detection-rule-counter-loading",lines:1,size:"m",isLoading:a||u},0===(null==i?void 0:i.total)?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiText,{size:"s"},c?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.creatingRule",defaultMessage:"Creating detection rule"})," ",Object(g.jsx)(M.EuiLoadingSpinner,{size:"s","data-test-subj":"csp:findings-flyout-detection-rule-counter-loading"})):Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiLink,{onClick:y,"data-test-subj":"csp:findings-flyout-create-detection-rule-link"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.createRuleAction",defaultMessage:"Create a detection rule"}))," ",Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.createRuleDescription",defaultMessage:"to generate alerts."})))):Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiLink,{onClick:h,"data-test-subj":"csp:findings-flyout-alert-count"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.alertCount",defaultMessage:"{alertCount, plural, one {# alert} other {# alerts}}",values:{alertCount:(null==n?void 0:n.total)||0}}))," ",Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.detectedBy",defaultMessage:"detected by"})," ",Object(g.jsx)(M.EuiLink,{onClick:f,"data-test-subj":"csp:findings-flyout-detection-rule-count"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findingsFlyout.alerts.detectionRuleCount",defaultMessage:"{ruleCount, plural, one {# detection rule} other {# detection rules}}",values:{ruleCount:(null==i?void 0:i.total)||0}}))))},Et=async({http:e,rule:t})=>await e.post("/api/detection_engine/rules",{version:S.z,body:JSON.stringify(t)}),It={field_names:["resource.name","resource.id","resource.type","resource.sub_type"]};var Ft;!function(e){e.DoNotSuppress="doNotSuppress",e.Suppress="suppress"}(Ft||(Ft={}));const Nt=e=>{if(!e)return[];const t=e.match(/(https?:\/\/\S+)/g);return t?t.map((e=>e.replace(/^\d+\. /,"").replace(/\n/g,""))):[]},_t=["Cloud Security","Use Case: Configuration Audit"],Dt=({rule:e})=>{const t=e.benchmark.id.split("_").map((e=>e.toUpperCase())),i=`${e.benchmark.id.replace("_"," ").toUpperCase()} ${e.benchmark.rule_number}`;return t.concat([i])},Lt=e=>[_t].concat(Dt(e)).concat(e.rule.benchmark.posture_type?[e.rule.benchmark.posture_type.toUpperCase(),`Data Source: ${e.rule.benchmark.posture_type.toUpperCase()}`]:[]).concat("cspm"===e.rule.benchmark.posture_type?["Domain: Cloud"]:["Domain: Container"]).flat(),zt=e=>{const t=(new Date).toISOString();return`rule.benchmark.rule_number: "${e.rule.benchmark.rule_number}"\n    AND rule.benchmark.id: "${e.rule.benchmark.id}"\n    AND result.evaluation: "failed"\n    AND event.ingested >= "${t}"`},At=async(e,t)=>await Et({http:e,rule:{type:"query",language:"kuery",license:"Elastic License v2",author:["Elastic"],filters:[],false_positives:[],risk_score:0,risk_score_mapping:[],severity:"low",severity_mapping:[],threat:[],interval:"1h",from:`now-${S.K}`,to:"now",max_signals:100,timestamp_override:"event.ingested",timestamp_override_fallback_disabled:!1,actions:[],enabled:!0,alert_suppression:{group_by:["resource.id"],missing_fields_strategy:Ft.Suppress},index:[S.B],query:zt(t),references:Nt(t.rule.references),name:t.rule.name,description:t.rule.rationale,tags:Lt(t),investigation_fields:It,note:t.rule.remediation}}),Rt=({finding:e})=>Object(g.jsx)(wt,{tags:Dt(e),createRuleFn:async t=>await At(t,e)}),Pt=(e,t)=>[{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.ruleNameTitle",{defaultMessage:"Rule Name"}),description:e.rule.name},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.alertsTitle",{defaultMessage:"Alerts"}),description:Object(g.jsx)(Rt,{finding:e})},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.ruleTagsTitle",{defaultMessage:"Rule Tags"}),description:Object(g.jsx)(o.a.Fragment,null,e.rule.tags.map((e=>Object(g.jsx)(M.EuiBadge,{key:e},e))))},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.evaluatedAtTitle",{defaultMessage:"Evaluated at"}),description:Ne()(e["@timestamp"]).format($.a)},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.resourceIdTitle",{defaultMessage:"Resource ID"}),description:e.resource.id},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.resourceNameTitle",{defaultMessage:"Resource Name"}),description:e.resource.name},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.frameworkSourcesTitle",{defaultMessage:"Framework Sources"}),description:Object(g.jsx)(ti,{benchmarkId:e.rule.benchmark.id,benchmarkName:e.rule.benchmark.name})},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.cisSectionTitle",{defaultMessage:"CIS Section"}),description:e.rule.section},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.indexTitle",{defaultMessage:"Index"}),description:t?Object(g.jsx)(M.EuiLink,{href:t},S.I):S.I}],Vt=e=>[{title:"",description:Object(g.jsx)(ei,null,e.remediation)},...e.impact?[{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.impactTitle",{defaultMessage:"Impact"}),description:Object(g.jsx)(ei,null,e.impact)}]:[],...e.default_value?[{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.defaultValueTitle",{defaultMessage:"Default Value"}),description:Object(g.jsx)(ei,null,e.default_value)}]:[],{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.rationaleTitle",{defaultMessage:"Rationale"}),description:Object(g.jsx)(ei,null,e.rationale)}],Gt=({result:e})=>[{title:"",description:Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiText,{color:"subdued"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.findingsFlyout.overviewTab.evidenceDescription",defaultMessage:"The specific resource metadata that was evaluated to generate this posture finding"})),Object(g.jsx)(M.EuiSpacer,{size:"s"}),Object(g.jsx)(Xt,{language:"json"},JSON.stringify(e.evidence,null,2)))}].filter(pe.e),Bt=({data:e})=>{var t;const{services:{discover:i}}=Object(w.a)(),a=re(S.J),n=Object(s.useMemo)((()=>{var e,t;return null===(e=i.locator)||void 0===e?void 0:e.getRedirectUrl({indexPatternId:null===(t=a.data)||void 0===t?void 0:t.id})}),[i.locator,null===(t=a.data)||void 0===t?void 0:t.id]),r=!Object(x.isEmpty)(e.result.evidence),l=Object(s.useMemo)((()=>[{initialIsOpen:!0,title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.detailsTitle",{defaultMessage:"Details"}),id:"detailsAccordion",listItems:Pt(e,n)},{initialIsOpen:!0,title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.remediationTitle",{defaultMessage:"Remediation"}),id:"remediationAccordion",listItems:Vt(e.rule)},S.G.showFindingFlyoutEvidence&&r&&{initialIsOpen:!0,title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTab.evidenceSourcesTitle",{defaultMessage:"Evidence"}),id:"evidenceAccordion",listItems:Gt(e)}].filter(pe.e)),[e,n,r]);return Object(g.jsx)(o.a.Fragment,null,l.map((e=>Object(g.jsx)(o.a.Fragment,{key:e.id},Object(g.jsx)(M.EuiPanel,{hasShadow:!1,hasBorder:!0},Object(g.jsx)(M.EuiAccordion,{id:e.id,buttonContent:Object(g.jsx)(M.EuiText,null,Object(g.jsx)("strong",null,e.title)),arrowDisplay:"left",initialIsOpen:e.initialIsOpen},Object(g.jsx)(M.EuiSpacer,{size:"m"}),Object(g.jsx)(M.EuiDescriptionList,{listItems:e.listItems}))),Object(g.jsx)(M.EuiSpacer,{size:"m"})))))},Ut=e=>[{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.nameTitle",{defaultMessage:"Name"}),description:e.name},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.descriptionTitle",{defaultMessage:"Description"}),description:Object(g.jsx)(ei,null,e.description)},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.tagsTitle",{defaultMessage:"Tags"}),description:Object(g.jsx)(o.a.Fragment,null,e.tags.map((e=>Object(g.jsx)(M.EuiBadge,{key:e},e))))},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.frameworkSourcesTitle",{defaultMessage:"Framework Sources"}),description:Object(g.jsx)(ti,{benchmarkId:e.benchmark.id,benchmarkName:e.benchmark.name})},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.cisSectionTitle",{defaultMessage:"CIS Section"}),description:e.section},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.profileApplicabilityTitle",{defaultMessage:"Profile Applicability"}),description:Object(g.jsx)(ei,null,e.profile_applicability)},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.benchmarkTitle",{defaultMessage:"Benchmark"}),description:e.benchmark.name},{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.auditTitle",{defaultMessage:"Audit"}),description:Object(g.jsx)(ei,null,e.audit)},...e.references?[{title:I.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTab.referencesTitle",{defaultMessage:"References"}),description:Object(g.jsx)(ei,null,e.references)}]:[]],Wt=({data:e})=>Object(g.jsx)(M.EuiDescriptionList,{listItems:Ut(e.rule)});var Ht=i(60),Qt=i.n(Ht),Zt=i(61),Yt=i.n(Zt);const Jt=e=>{switch(e.type){case"cis_eks":return Qt.a;case"cis_azure":return"logoAzure";case"cis_aws":return"logoAWS";case"cis_gcp":return Yt.a;default:return"logoKubernetes"}},qt=e=>Object(g.jsx)(M.EuiToolTip,{content:e.name},Object(g.jsx)(M.EuiIcon,{type:Jt(e),size:e.size||"xl",css:e.style})),Kt=[{id:"overview",title:I.i18n.translate("xpack.csp.findings.findingsFlyout.overviewTabTitle",{defaultMessage:"Overview"})},{id:"rule",title:I.i18n.translate("xpack.csp.findings.findingsFlyout.ruleTabTitle",{defaultMessage:"Rule"})},{id:"table",title:I.i18n.translate("xpack.csp.findings.findingsFlyout.tableTabTitle",{defaultMessage:"Table"})},{id:"json",title:I.i18n.translate("xpack.csp.findings.findingsFlyout.jsonTabTitle",{defaultMessage:"JSON"})}],$t=I.i18n.translate("xpack.csp.findings.findingsFlyout.paginationLabel",{defaultMessage:"Finding navigation"}),Xt=e=>Object(g.jsx)(M.EuiCodeBlock,n()({isCopyable:!0,paddingSize:"s",overflowHeight:300},e)),ei=e=>Object(g.jsx)(M.EuiMarkdownFormat,n()({textSize:"s"},e)),ti=({benchmarkId:e,benchmarkName:t})=>Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiToolTip,{content:"Center for Internet Security"},Object(g.jsx)(M.EuiIcon,{type:bt.a,size:"xl"}))),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(qt,{type:e,name:t}))),ii=({tab:e,findings:t})=>{switch(e.id){case"overview":return Object(g.jsx)(Bt,{data:t});case"rule":return Object(g.jsx)(Wt,{data:t});case"table":return Object(g.jsx)(vt,{data:t});case"json":return Object(g.jsx)(kt,{data:t});default:Object(pt.assertNever)(e)}},ai=({onClose:e,findings:t,flyoutIndex:i,findingsCount:a,onPaginate:n})=>{const[o,r]=Object(s.useState)(Kt[0]);return Object(g.jsx)(M.EuiFlyout,{onClose:e,"data-test-subj":"findings_flyout"},Object(g.jsx)(M.EuiFlyoutHeader,null,Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(Le,{type:t.result.evaluation})),Object(g.jsx)(M.EuiFlexItem,{grow:!0,style:{minWidth:0}},Object(g.jsx)(M.EuiTitle,{size:"m",className:"eui-textTruncate"},Object(g.jsx)(M.EuiTextColor,{color:"primary",title:t.rule.name},t.rule.name)))),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(M.EuiTabs,null,Kt.map((e=>Object(g.jsx)(M.EuiTab,{key:e.id,isSelected:o.id===e.id,onClick:()=>r(e),"data-test-subj":`findings_flyout_tab_${e.id}`},e.title))))),Object(g.jsx)(M.EuiFlyoutBody,{key:o.id},Object(g.jsx)(ii,{tab:o,findings:t})),Object(g.jsx)(M.EuiFlyoutFooter,null,Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:n?"spaceBetween":"flexEnd"},n&&Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiPagination,{"aria-label":$t,pageCount:a,activePage:i,onPageClick:n,compressed:!0})),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(jt,{createRuleFn:async e=>await At(e,t)})))))},ni=({items:e,loading:t,pagination:i,sorting:a,setTableOptions:n,onAddFilter:r,onOpenFlyout:l,flyoutFindingIndex:u,onPaginateFlyout:c,onCloseFlyout:d,onResetFilters:p})=>{const{euiTheme:b}=Object(M.useEuiTheme)(),m=e[u],j=Object(s.useMemo)((()=>[Re({onClick:l}),Ge(Ve["result.evaluation"],{onAddFilter:r}),Ve["rule.benchmark.rule_number"],Ge(Ve["rule.name"],{onAddFilter:r}),Ge(Ve["rule.section"],{onAddFilter:r}),Ve["@timestamp"]]),[r,l]);return t||e.length?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiBasicTable,{"data-test-subj":"resource_findings_table",loading:t,items:e,columns:j,onChange:n,pagination:i,sorting:a,rowProps:e=>{return{style:ye(b,e,m),"data-test-subj":(t=e.resource.id,`resource_findings_table_row_${t}`)};var t}}),m&&Object(g.jsx)(ai,{findings:m,onClose:d,findingsCount:i.totalItemCount,flyoutIndex:u+i.pageIndex*i.pageSize,onPaginate:c})):Object(g.jsx)(Je,{onResetFilters:p})},si=o.a.memo(ni),oi=({error:e})=>{const{data:{search:t}}=Object(w.a)().services;return Object(g.jsx)(M.EuiFlexGroup,{justifyContent:"center",alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiPanel,{paddingSize:"l",grow:!0},Object(g.jsx)(M.EuiCallOut,{title:I.i18n.translate("xpack.csp.findings.errorCallout.pageSearchErrorTitle",{defaultMessage:"We encountered an error retrieving search results"}),color:"danger",iconType:"warning"},Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(M.EuiButton,{size:"s",color:"danger",onClick:()=>t.showError(e)},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.errorCallout.showErrorButtonLabel",defaultMessage:"Show error message"}))))))},ri=e=>isNaN(e)?0:e<1e3?e:Ce()(e).format("0.0a"),li=({pageEnd:e,pageStart:t,total:i,type:a})=>Object(g.jsx)(M.EuiTextColor,{color:"subdued"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.distributionBar.showingPageOfTotalLabel",defaultMessage:"Showing {pageStart}-{pageEnd} of {total} {type}",values:{pageStart:Object(g.jsx)("b",null,t),pageEnd:Object(g.jsx)("b",null,e),total:Object(g.jsx)("b",null,ri(i)),type:a}})),ui=e=>Object(g.jsx)("div",null,Object(g.jsx)(ci,e),Object(g.jsx)(M.EuiSpacer,{size:"s"}),Object(g.jsx)(pi,e)),ci=e=>Object(g.jsx)(M.EuiFlexGroup,{justifyContent:"flexEnd"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiFlexGroup,{justifyContent:"flexEnd"},Object(g.jsx)(di,e)))),di=({passed:e,failed:t})=>{const{euiTheme:i}=Object(M.useEuiTheme)();return Object(g.jsx)("div",{css:Object(g.css)("display:grid;grid-template-columns:auto auto;grid-column-gap:",i.size.m,";","")},Object(g.jsx)(bi,{label:I.i18n.translate("xpack.csp.findings.distributionBar.totalPassedLabel",{defaultMessage:"Passed Findings"}),color:$.q.passed,value:e}),Object(g.jsx)(bi,{label:I.i18n.translate("xpack.csp.findings.distributionBar.totalFailedLabel",{defaultMessage:"Failed Findings"}),color:$.q.failed,value:t}))},pi=({passed:e,failed:t,distributionOnClick:i})=>{const{euiTheme:a}=Object(M.useEuiTheme)();return Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"none",css:Object(g.css)("height:8px;background:",a.colors.lightestShade,";","")},Object(g.jsx)(gi,{value:e,color:$.q.passed,distributionOnClick:()=>{i(S.O)},"data-test-subj":"distribution_bar_passed"}),Object(g.jsx)(gi,{value:t,color:$.q.failed,distributionOnClick:()=>{i(S.N)},"data-test-subj":"distribution_bar_failed"}))},gi=({value:e,color:t,distributionOnClick:i,...a})=>Object(g.jsx)("button",{"data-test-subj":a["data-test-subj"],onClick:i,css:Object(g.css)("flex:",e,";background:",t,";height:100%;","")}),bi=({label:e,value:t,color:i})=>Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,{grow:1},Object(g.jsx)(M.EuiHealth,{color:i},e)),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiBadge,null,ri(t))));var mi=i(43);const ji="cspq",xi=e=>{const t=(e=>{try{return Object(mi.encode)(e)}catch(e){console.error(e)}})(e);if(t)return`${ji}=${t}`},fi=e=>{const t=new URLSearchParams(e).get(ji);if(t)return(e=>{try{return Object(mi.decode)(e)}catch(e){console.error(e)}})(t)},hi=e=>{const{push:t,replace:i}=Object(l.useHistory)(),{search:a,key:n}=Object(l.useLocation)(),o=Object(s.useMemo)((()=>({...e(),...fi(a)})),[e,a]),r=Object(s.useCallback)((i=>t({search:xi({...e(),...o,...i})})),[e,o,t]);return Object(s.useEffect)((()=>{a||i({search:xi(e())})}),[e,a,i]),{key:n,urlQuery:o,setUrlQuery:r}},yi=e=>{const[t,i]=k()(e,$.b);let a=$.b;return t&&(a=t),{pageSize:a,setPageSize:i}},vi=(e,t=[10,25,100],i=!0)=>({...e,pageSizeOptions:t,showPerPageOptions:i}),Oi=({query:e,filters:t})=>({query:e,filters:t,sort:{field:"@timestamp",direction:"desc"},pageIndex:0}),ki=({defaultQuery:e=Oi,dataView:t,paginationLocalStorageKey:i,columnsLocalStorageKey:a})=>{const n=(e=>{const{data:{query:{filterManager:t,queryString:i}}}=Object(w.a)().services;return Object(s.useCallback)((()=>e({filters:t.getAppFilters(),query:i.getQuery()})),[e,t,i])})(e),{urlQuery:o,setUrlQuery:r}=hi(n),{pageSize:l,setPageSize:u}=yi(i),c=Object(s.useCallback)((e=>{u(e),r({pageIndex:0,pageSize:e})}),[u,r]),d=Object(s.useCallback)((()=>{r({pageIndex:0,filters:[],query:{query:"",language:"kuery"}})}),[r]),p=Object(s.useCallback)((e=>{r({pageIndex:e})}),[r]),g=Object(s.useCallback)((e=>{r({sort:e})}),[r]),b=Object(s.useCallback)((({page:e,sort:t})=>{u(e.size),r({sort:t,pageIndex:e.index})}),[r,u]),m=(({dataView:e,filters:t,query:i})=>{const{notifications:{toasts:a},data:{query:{filterManager:n,queryString:o}},uiSettings:r}=Object(w.a)().services,l=r.get("query:allowLeadingWildcards"),u=Object(s.useMemo)((()=>({allowLeadingWildcards:l})),[l]),c=Object(s.useMemo)((()=>(({dataView:e,query:t,filters:i,config:a})=>{try{return{query:Object(me.buildEsQuery)(e,t,i,a)}}catch(e){return{query:void 0,error:e instanceof Error?e:new Error("Unknown Error")}}})({dataView:e,filters:t,query:i,config:u})),[e,t,i,u]);return Object(s.useEffect)((()=>{n.setAppFilters(t),o.setQuery(i)}),[t,n,o,i]),Object(s.useEffect)((()=>{const e=c.error;e&&a.addError(e,{title:I.i18n.translate("xpack.csp.findings.search.queryErrorToastMessage",{defaultMessage:"Query Error"}),toastLifeTimeMs:5e3})}),[c.error,a]),c})({dataView:t,filters:o.filters,query:o.query}),j=Object(s.useCallback)((e=>{r({...e,pageIndex:0})}),[r]);return{setUrlQuery:r,sort:o.sort,filters:o.filters,query:m.query,queryError:m.error,pageIndex:o.pageIndex,urlQuery:o,setTableOptions:b,handleUpdateQuery:j,pageSize:l,setPageSize:u,onChangeItemsPerPage:c,onChangePage:p,onSort:g,onResetFilters:d,columnsLocalStorageKey:a||$.g,getRowsFromPages:e=>(null==e?void 0:e.map((({page:e})=>e)).flat())||[]}},Mi=({total:e,pageIndex:t,pageSize:i})=>Object(s.useMemo)((()=>((e,t,i,a)=>{const n=e>t,s=n?t:e,o=Math.ceil(s/i);return{isLastLimitedPage:n&&o===a+1,limitedTotalItemCount:s}})(e||0,$.m,i,t)),[e,t,i]),Ti=({query:e,filters:t})=>({query:e,filters:t,sort:{field:"result.evaluation",direction:"asc"},pageIndex:0,findingIndex:-1}),Ci=()=>Object(g.jsx)(l.Link,{to:Object(l.generatePath)(h.e.findings_by_resource.path)},Object(g.jsx)(M.EuiButtonEmpty,{iconType:"arrowLeft",flush:"both"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.resourceFindings.backToResourcesPageButtonLabel",defaultMessage:"Back to resources"}))),Si=({dataView:e})=>{var t,i,a,n,u,c,d,p;const b=Object(l.useParams)(),m=decodeURIComponent(b.resourceId),{pageIndex:j,sort:x,query:f,queryError:h,pageSize:y,setTableOptions:v,urlQuery:O,setUrlQuery:k,onResetFilters:T}=ki({dataView:e,defaultQuery:Ti,paginationLocalStorageKey:$.k}),C=(e=>{const{data:t,notifications:{toasts:i}}=Object(w.a)().services,a={...e};return Object(r.useQuery)(["csp_resource_findings",{params:a}],(()=>Object(de.lastValueFrom)(t.search.search({params:ut(a)}))),{enabled:e.enabled,keepPreviousData:!0,select:({rawResponse:{hits:e,aggregations:t}})=>{var i,a,n,s,o,r,l,u,c,d;if(!t)throw new Error("expected aggregations to exists");return ct(null===(i=t.count)||void 0===i?void 0:i.buckets),ct(null===(a=t.clusterId)||void 0===a?void 0:a.buckets),ct(null===(n=t.resourceSubType)||void 0===n?void 0:n.buckets),ct(null===(s=t.resourceName)||void 0===s?void 0:s.buckets),ct(null===(o=t.cloudAccountName)||void 0===o?void 0:o.buckets),{page:e.hits.map((e=>e._source)),total:lt.number.is(e.total)?e.total:0,count:fe(null===(r=t.count)||void 0===r?void 0:r.buckets),clusterId:dt(null===(l=t.clusterId)||void 0===l?void 0:l.buckets),resourceSubType:dt(null===(u=t.resourceSubType)||void 0===u?void 0:u.buckets),resourceName:dt(null===(c=t.resourceName)||void 0===c?void 0:c.buckets),cloudAccountName:dt(null===(d=t.cloudAccountName)||void 0===d?void 0:d.buckets)}},onError:e=>be(i,e)})})({sort:x,resourceId:m,enabled:!h,query:f}),S=C.error||h,E=ce(null===(t=C.data)||void 0===t?void 0:t.page,O.pageIndex,y),{isLastLimitedPage:F,limitedTotalItemCount:N}=Mi({total:null===(i=C.data)||void 0===i?void 0:i.total,pageIndex:O.pageIndex,pageSize:y}),_=null==O?void 0:O.findingIndex,D=vi({pageSize:y,pageIndex:j,totalItemCount:N}),L=Object(s.useCallback)((e=>{k({findingIndex:E.findIndex((t=>t.resource.id===(null==e?void 0:e.resource.id)&&t.rule.id===(null==e?void 0:e.rule.id)))})}),[E,k]),z=Object(s.useCallback)((e=>{const t=e%y,i=Math.floor(e/y);k({pageIndex:i,findingIndex:t})}),[y,k]);return Object(g.jsx)("div",{"data-test-subj":"resources_findings_container"},Object(g.jsx)(le,{dataView:e,setQuery:e=>{k({...e,pageIndex:0})},loading:C.isFetching}),Object(g.jsx)(Ci,null),Object(g.jsx)(M.EuiSpacer,{size:"xs"}),Object(g.jsx)(ze,null,Object(g.jsx)(Ae,{title:Object(g.jsx)(rt,{title:I.i18n.translate("xpack.csp.findings.resourceFindings.resourceFindingsPageTitle",{defaultMessage:"{resourceName} {hyphen} Findings",values:{resourceName:null===(a=C.data)||void 0===a?void 0:a.resourceName,hyphen:null!==(n=C.data)&&void 0!==n&&n.resourceName?"-":""}})})})),Object(g.jsx)(M.EuiSpacer,null),C.data&&Object(g.jsx)(ot,{listItems:(A={resourceId:m,resourceName:(null===(u=C.data)||void 0===u?void 0:u.resourceName)||"",resourceSubType:(null===(c=C.data)||void 0===c?void 0:c.resourceSubType)||"",clusterId:(null===(d=C.data)||void 0===d?void 0:d.clusterId)||"",cloudAccountName:(null===(p=C.data)||void 0===p?void 0:p.cloudAccountName)||""},[{title:I.i18n.translate("xpack.csp.findings.resourceFindingsSharedValues.resourceTypeTitle",{defaultMessage:"Resource Type"}),description:A.resourceSubType},{title:I.i18n.translate("xpack.csp.findings.resourceFindingsSharedValues.resourceIdTitle",{defaultMessage:"Resource ID"}),description:A.resourceId},{title:I.i18n.translate("xpack.csp.findings.resourceFindingsSharedValues.clusterIdTitle",{defaultMessage:"Cluster ID"}),description:A.clusterId},{title:I.i18n.translate("xpack.csp.findings.resourceFindingsSharedValues.cloudAccountName",{defaultMessage:"Cloud Account Name"}),description:A.cloudAccountName}])}),Object(g.jsx)(M.EuiSpacer,null),S&&Object(g.jsx)(oi,{error:S}),!S&&Object(g.jsx)(o.a.Fragment,null,C.isSuccess&&!!C.data.page.length&&Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(ui,{distributionOnClick:t=>{k({pageIndex:0,filters:xe({filters:O.filters,dataView:e,field:"result.evaluation",value:t,negate:!1})})},type:I.i18n.translate("xpack.csp.findings.resourceFindings.tableRowTypeLabel",{defaultMessage:"Findings"}),passed:C.data.count.passed,failed:C.data.count.failed}),Object(g.jsx)(M.EuiSpacer,{size:"l"}),Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(li,{pageStart:O.pageIndex*y+1,pageEnd:O.pageIndex*y+E.length,total:C.data.total,type:I.i18n.translate("xpack.csp.findings.resourceFindings.tableRowTypeLabel",{defaultMessage:"Findings"})})))),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(si,{onCloseFlyout:()=>k({findingIndex:-1}),onPaginateFlyout:z,onOpenFlyout:L,onResetFilters:T,flyoutFindingIndex:_,loading:C.isFetching,items:E,pagination:D,sorting:{sort:{field:O.sort.field,direction:O.sort.direction}},setTableOptions:v,onAddFilter:(t,i,a)=>k({pageIndex:0,filters:xe({filters:O.filters,dataView:e,field:t,value:i,negate:a})})})),F&&Object(g.jsx)(He,null));var A},wi=({query:e,filters:t})=>({query:e,filters:t,pageIndex:0,sort:{field:"compliance_score",direction:"asc"}}),Ei=({dataView:e})=>Object(g.jsx)(f,null,Object(g.jsx)(b,{exact:!0,path:h.e.findings_by_resource.path,render:()=>Object(g.jsx)(C.TrackApplicationView,{viewId:h.e.findings_by_resource.id},Object(g.jsx)(Ii,{dataView:e}))}),Object(g.jsx)(b,{path:h.e.resource_findings.path,render:()=>Object(g.jsx)(C.TrackApplicationView,{viewId:h.e.resource_findings.id},Object(g.jsx)(Si,{dataView:e}))})),Ii=({dataView:e})=>{var t,i;const{queryError:a,query:n,pageSize:s,setTableOptions:l,urlQuery:u,setUrlQuery:c,onResetFilters:d}=ki({dataView:e,defaultQuery:wi,paginationLocalStorageKey:$.k}),p=(e=>{const{data:t,notifications:{toasts:i}}=Object(w.a)().services,a={...e};return Object(r.useQuery)(["csp_findings_resource",{params:a}],(async()=>{const{rawResponse:{aggregations:e}}=await Object(de.lastValueFrom)(t.search.search({params:ve(a)}));if(!e)throw new Error("Failed to aggregate by, missing resource id");if(!Array.isArray(e.resources.buckets)||!Array.isArray(e.count.buckets))throw new Error("Failed to group by, missing resource id");return{page:e.resources.buckets.map(Me),total:e.resource_total.value,count:fe(e.count.buckets)}}),{enabled:e.enabled,keepPreviousData:!0,onError:e=>be(i,e)})})({sortDirection:u.sort.direction,query:n,enabled:!a}),b=p.error||a,m=ce(null===(t=p.data)||void 0===t?void 0:t.page,u.pageIndex,s),{isLastLimitedPage:j,limitedTotalItemCount:x}=Mi({total:null===(i=p.data)||void 0===i?void 0:i.total,pageIndex:u.pageIndex,pageSize:s});return Object(g.jsx)("div",{"data-test-subj":"findings_by_resource_container"},Object(g.jsx)(le,{dataView:e,setQuery:e=>{c({...e,pageIndex:0})},loading:p.isFetching}),Object(g.jsx)(M.EuiSpacer,{size:"m"}),b&&Object(g.jsx)(oi,{error:b}),!b&&Object(g.jsx)(o.a.Fragment,null,p.isSuccess&&!!p.data.page.length&&Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(ui,{distributionOnClick:t=>{c({pageIndex:0,filters:xe({filters:u.filters,dataView:e,field:"result.evaluation",value:t,negate:!1})})},type:I.i18n.translate("xpack.csp.findings.findingsByResource.tableRowTypeLabel",{defaultMessage:"Resources"}),passed:p.data.count.passed,failed:p.data.count.failed}),Object(g.jsx)(M.EuiSpacer,{size:"l"}),Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(li,{pageStart:u.pageIndex*s+1,pageEnd:u.pageIndex*s+m.length,total:p.data.total,type:I.i18n.translate("xpack.csp.findings.findingsByResource.tableRowTypeLabel",{defaultMessage:"Resources"})})),Object(g.jsx)(M.EuiFlexItem,{grow:!1,style:{width:188,marginLeft:"auto"}},Object(g.jsx)(at,{type:"resource"})))),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(et,{loading:p.isFetching,items:m,onResetFilters:d,pagination:vi({pageSize:s,pageIndex:u.pageIndex,totalItemCount:x}),setTableOptions:l,sorting:{sort:{field:"compliance_score",direction:u.sort.direction}},onAddFilter:(t,i,a)=>c({pageIndex:0,filters:xe({filters:u.filters,dataView:e,field:t,value:i,negate:a})})})),j&&Object(g.jsx)(He,null))};var Fi=i(11),Ni=i.n(Fi);const _i={selectedOptions:[]};class custom_field_panel_CustomFieldPanel extends o.a.PureComponent{constructor(...e){super(...e),Ni()(this,"state",_i),Ni()(this,"handleSubmit",(()=>{this.props.onSubmit(this.state.selectedOptions[0].label)})),Ni()(this,"handleFieldSelection",(e=>{this.setState({selectedOptions:e})}))}render(){const{fields:e,currentOptions:t}=this.props,i=e.filter((e=>e.aggregatable&&"string"===e.type&&!(t&&t.some((t=>t.field===e.name))))).map((e=>({label:e.name}))),a=!this.state.selectedOptions.length;return Object(g.jsx)("div",{"data-test-subj":"custom-field-panel",style:{padding:16}},Object(g.jsx)(M.EuiForm,null,Object(g.jsx)(M.EuiFormRow,{label:I.i18n.translate("grouping.groupSelector.customGroupByFieldLabel",{defaultMessage:"Field"}),helpText:I.i18n.translate("grouping.groupSelector.customGroupByHelpText",{defaultMessage:"This is the field used for the terms aggregation"}),display:"rowCompressed",fullWidth:!0},Object(g.jsx)(M.EuiComboBox,{"data-test-subj":"groupByCustomField",placeholder:I.i18n.translate("grouping.groupSelector.customGroupByDropdownPlacehoder",{defaultMessage:"Select one"}),singleSelection:{asPlainText:!0},selectedOptions:this.state.selectedOptions,options:i,onChange:this.handleFieldSelection,fullWidth:!0,isClearable:!1})),Object(g.jsx)(M.EuiButton,{"data-test-subj":"groupByCustomFieldAddButton",disabled:a,type:"submit",size:"s",fill:!0,onClick:this.handleSubmit},I.i18n.translate("grouping.selector.grouping.label.add",{defaultMessage:"Add"}))))}}Ni()(custom_field_panel_CustomFieldPanel,"displayName","CustomFieldPanel");const Di=I.i18n.translate("grouping.additionalActions.takeAction",{defaultMessage:"Take actions"}),Li=I.i18n.translate("grouping.alerts.label",{defaultMessage:"Group alerts by"}),zi=I.i18n.translate("grouping.customGroupByPanelTitle",{defaultMessage:"Group By Custom Field"}),Ai=I.i18n.translate("grouping.groupBySingleField",{defaultMessage:"Select grouping"}),Ri=I.i18n.translate("grouping.noneGroupByOptionName",{defaultMessage:"None"}),Pi=I.i18n.translate("grouping.customGroupByOptionName",{defaultMessage:"Custom field"});var Vi=i(44);const Gi=Object(g.css)("font-size:",Ie.euiThemeVars.euiFontSizeXS,";font-weight:",Ie.euiThemeVars.euiFontWeightSemiBold,";border-right:",Ie.euiThemeVars.euiBorderThin,";margin-right:16px;padding-right:16px;",""),Bi=Object(g.css)("font-size:",Ie.euiThemeVars.euiFontSizeXS,";font-weight:",Ie.euiThemeVars.euiFontWeightSemiBold,";border-right:",Ie.euiThemeVars.euiBorderThin,";margin-right:16px;padding-right:16px;.smallDot{width:3px!important;display:inline-block;}.euiBadge__text{text-align:center;width:100%;}",""),Ui=Object(g.css)(".groupingAccordionForm .euiAccordion__childWrapper .euiAccordion__children{margin-left:8px;margin-right:8px;border-left:",Ie.euiThemeVars.euiBorderThin,";border-right:",Ie.euiThemeVars.euiBorderThin,";border-bottom:",Ie.euiThemeVars.euiBorderThin,";border-radius:0 0 6px 6px;}.groupingAccordionForm .euiAccordion__triggerWrapper{border-bottom:",Ie.euiThemeVars.euiBorderThin,";border-left:",Ie.euiThemeVars.euiBorderThin,";border-right:",Ie.euiThemeVars.euiBorderThin,";border-radius:6px;min-height:78px;padding-left:16px;padding-right:16px;}.groupingAccordionForm{border-top:",Ie.euiThemeVars.euiBorderThin,";border-bottom:none;border-radius:6px;min-width:1090px;}.groupingPanelRenderer{display:table;table-layout:fixed;width:100%;padding-right:32px;}",""),Wi=Object(g.css)(".groupingAccordionFormLevel .euiAccordion__childWrapper .euiAccordion__children{margin-left:8px;margin-right:8px;border-left:none;border-right:none;border-bottom:",Ie.euiThemeVars.euiBorderThin,";border-radius:0;}.groupingAccordionFormLevel .euiAccordion__triggerWrapper{border-bottom:",Ie.euiThemeVars.euiBorderThin,";border-left:none;border-right:none;min-height:78px;padding-left:16px;padding-right:16px;border-radius:0;}.groupingAccordionFormLevel{border-top:none;border-bottom:none;border-radius:0;min-width:1090px;}.groupingPanelRenderer{display:table;table-layout:fixed;width:100%;padding-right:32px;}",""),Hi=Object(Vi.euiStyled)(M.EuiContextMenu)`
  width: 250px;
  & .euiContextMenuItem__text {
    overflow: hidden;
    text-overflow: ellipsis;
  }
  .euiContextMenuItem {
    border-bottom: ${Ie.euiThemeVars.euiBorderThin};
  }
  .euiContextMenuItem:last-child {
    border: none;
  }
`,Qi=Object(Vi.euiStyled)(M.EuiButtonEmpty)`
  font-weight: 'normal';

  .euiButtonEmpty__text {
    max-width: 300px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
`,Zi=({"data-test-subj":e,fields:t,groupsSelected:i=["none"],onGroupChange:a,options:n,title:o=Li,maxGroupingLevels:r=1})=>{const[l,u]=Object(s.useState)(!1),c=Object(s.useCallback)((e=>!!i.find((t=>t===e))),[i]),d=Object(s.useMemo)((()=>{const e=e=>1!==r&&!(i.length!==r||e&&c(e));return[{id:"firstPanel",title:1===r?Ai:(s=r,I.i18n.translate("grouping.groupByPanelTitle",{values:{groupingLevelsCount:s},defaultMessage:"Select up to {groupingLevelsCount} groupings"})),items:[{"data-test-subj":"panel-none",name:Ri,icon:c("none")?"check":"empty",onClick:()=>a("none")},...n.map((t=>({"data-test-subj":`panel-${t.key}`,disabled:e(t.key),name:t.label,onClick:()=>a(t.key),icon:c(t.key)?"check":"empty"}))),{"data-test-subj":"panel-custom",name:Pi,icon:"empty",disabled:e(),panel:"customPanel",hasPanel:!0}]},{id:"customPanel",title:zi,width:685,content:Object(g.jsx)(custom_field_panel_CustomFieldPanel,{currentOptions:n.map((e=>({text:e.label,field:e.key}))),onSubmit:e=>{a(e),u(!1)},fields:t})}];var s}),[t,i.length,c,r,a,n]),p=Object(s.useMemo)((()=>n.filter((e=>c(e.key)))),[c,n]),b=Object(s.useCallback)((()=>u((e=>!e))),[]),m=Object(s.useCallback)((()=>u(!1)),[]),j=Object(s.useMemo)((()=>{const e=c("none")?Ri:i.reduce(((e,t)=>{const i=p.find((e=>e.key===t));return null==i?e:e?[e,i.label].join(", "):i.label}),"");return Object(g.jsx)(Qi,{"data-test-subj":"group-selector-dropdown",flush:"both",iconSide:"right",iconSize:"s",iconType:"arrowDown",onClick:b,title:e,size:"xs"},`${o}: ${e}`)}),[i,c,b,p,o]);return Object(g.jsx)(M.EuiPopover,{"data-test-subj":null!=e?e:"groupByPopover",button:j,closePopover:m,isOpen:l,panelPaddingSize:"none"},Object(g.jsx)(Hi,{"data-test-subj":"groupByContextMenu",initialPanelId:"firstPanel",panels:d}))},Yi=o.a.memo(Zi);var Ji=i(40);let qi;!function(e){e.updateActiveGroups="UPDATE_ACTIVE_GROUPS",e.updateGroupOptions="UPDATE_GROUP_OPTIONS"}(qi||(qi={}));const Ki={},$i={activeGroups:["none"],options:[]},Xi=e=>{return t=e,I.i18n.translate("grouping.eventsTab.unit",{values:{totalCount:t},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"});var t},ea="groups",ta=e=>{const t=e.getItem(ea);return t?JSON.parse(t):Ki},ia=(e,t)=>null!=t&&t.length>0?t.reduce(((t,i)=>[...t,{meta:{alias:null,disabled:!1,key:e,negate:!1,params:{query:i},type:"phrase"},query:{match_phrase:{[e]:{query:i}}}}]),[{meta:{alias:null,disabled:!1,type:me.FILTERS.CUSTOM,negate:!1,key:e},query:{script:{script:{source:"doc[params['field']].size()==params['size']",params:{field:e,size:t.length}}}}}]):[],aa=e=>[{meta:{disabled:!1,negate:!0,alias:null,key:e,value:"exists",type:"exists"},query:{exists:{field:e}}}],na=({isNullGroup:e,title:t,nullGroupMessage:i})=>Object(g.jsx)("div",null,Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},Object(g.jsx)(M.EuiFlexItem,{grow:!1,className:"eui-textTruncate"},Object(g.jsx)(M.EuiTitle,{size:"xs"},Object(g.jsx)("h4",{className:"eui-textTruncate",title:t},t))),e&&i&&Object(g.jsx)(M.EuiFlexItem,{grow:!1,"data-test-subj":"null-group-icon"},Object(g.jsx)(M.EuiIconTip,{content:i,position:"right"})))),sa=({customAccordionButtonClassName:e,customAccordionClassName:t="groupingAccordionForm",extraAction:i,forceState:a,groupBucket:n,groupPanelRenderer:o,groupingLevel:r=0,isLoading:l,isNullGroup:u=!1,onGroupClose:c,onToggleGroup:d,renderChildComponent:p,selectedGroup:b,nullGroupMessage:m})=>{const j=Object(s.useRef)(a);Object(s.useEffect)((()=>{"open"===j.current&&"closed"===a?(c(),j.current="closed"):"closed"===j.current&&"open"===a&&(j.current="open")}),[c,a,b]);const x=Object(s.useMemo)((()=>n.selectedGroup===b?{asString:n.key_as_string,asArray:n.key}:{asString:null,asArray:null}),[n.key,n.key_as_string,n.selectedGroup,b]),f=Object(s.useMemo)((()=>u?aa(b):ia(b,x.asArray)),[x.asArray,u,b]),h=Object(s.useCallback)((e=>{d&&d(e,n)}),[n,d]);return x.asString?Object(g.jsx)(M.EuiAccordion,{buttonClassName:e,buttonContent:Object(g.jsx)("div",{"data-test-subj":"group-panel-toggle",className:"groupingPanelRenderer"},null!=o?o:Object(g.jsx)(na,{title:x.asString,isNullGroup:u,nullGroupMessage:m})),buttonElement:"div",className:r>0?"groupingAccordionFormLevel":t,"data-test-subj":"grouping-accordion",extraAction:i,forceState:a,isLoading:l,id:`group${r}-${x.asString}`,onToggle:h,paddingSize:"m"},Object(g.jsx)("span",{"data-test-subj":"grouping-accordion-content"},p(f))):null},oa=o.a.memo(sa),ra=({bucketKey:e,groupFilter:t,groupNumber:i,onTakeActionsOpen:a,statRenderers:n,takeActionItems:o})=>{const[r,l]=Object(s.useState)(!1),[u,c]=Object(s.useState)([]),d=Object(s.useCallback)((()=>(r||0!==u.length||c(o(t,i)),!r&&a?a():l(!r))),[o,t,i,r,a,u.length]),p=Object(s.useMemo)((()=>null==n?void 0:n.map((e=>{var t,i;const{dataTestSubj:a,component:n}=null!=e.badge?{dataTestSubj:`metric-${e.title}`,component:Object(g.jsx)(M.EuiToolTip,{position:"top",content:e.badge.value},Object(g.jsx)(M.EuiBadge,{style:{marginLeft:10,width:null!==(t=e.badge.width)&&void 0!==t?t:35},color:null!==(i=e.badge.color)&&void 0!==i?i:"hollow"},e.badge.value>99?"99+":e.badge.value.toString()))}:{dataTestSubj:`customMetric-${e.title}`,component:e.renderer};return Object(g.jsx)(M.EuiFlexItem,{grow:!1,key:e.title},Object(g.jsx)("span",{css:Bi,"data-test-subj":a},e.title,n))}))),[n]),b=Object(s.useMemo)((()=>Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiPopover,{anchorPosition:"downLeft",button:Object(g.jsx)(M.EuiButtonEmpty,{"data-test-subj":"take-action-button",onClick:d,iconType:"arrowDown",iconSide:"right"},Di),closePopover:()=>l(!1),isOpen:r,panelPaddingSize:"none"},Object(g.jsx)(M.EuiContextMenuPanel,{items:u})))),[r,d,u]);return Object(g.jsx)(M.EuiFlexGroup,{"data-test-subj":"group-stats",key:`stats-${e}`,gutterSize:"none",alignItems:"center"},p,b)},la=o.a.memo(ra);i(78);var ua=i(79),ca=i.n(ua);i(80),i(81);const da={maxWidth:500},pa={tall:490,short:250},ga=({height:e="tall"})=>Object(g.jsx)(M.EuiPanel,{color:"subdued","data-test-subj":"empty-results-panel"},Object(g.jsx)(M.EuiFlexGroup,{style:{height:pa[e]},alignItems:"center",justifyContent:"center"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiPanel,{hasBorder:!0,style:da},Object(g.jsx)(M.EuiFlexGroup,null,Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{size:"s"},Object(g.jsx)(M.EuiTitle,null,Object(g.jsx)("h3",null,Object(g.jsx)(T.FormattedMessage,{id:"grouping.empty.title",defaultMessage:"No grouping results match your selected Group alerts field"}))),Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"grouping.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your Group alerts field"})))),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiImage,{size:"200px",alt:"",src:ca.a})))))));var ba;!function(e){e.GROUP_TOGGLED="alerts_table_toggled_",e.GROUPED_ALERTS="alerts_table_group_by_"}(ba||(ba={}));const ma=({activePage:e,data:t,groupPanelRenderer:i,groupSelector:a,groupStatsRenderer:n,groupingId:r,groupingLevel:l=0,inspectButton:u,isLoading:c,itemsPerPage:d,onChangeGroupsItemsPerPage:p,onChangeGroupsPage:b,onGroupClose:m,onGroupToggle:j,renderChildComponent:x,selectedGroup:f,takeActionItems:h,tracker:y,unit:v=Xi})=>{var O,k,T;const[C,S]=Object(s.useState)({}),w=Object(s.useMemo)((()=>{var e,i;return null!==(e=null==t||null===(i=t.unitsCount)||void 0===i?void 0:i.value)&&void 0!==e?e:0}),[null==t||null===(O=t.unitsCount)||void 0===O?void 0:O.value]),E=Object(s.useMemo)((()=>`${w.toLocaleString()} ${v&&v(w)}`),[w,v]),F=Object(s.useMemo)((()=>{var e,i;return null!==(e=null==t||null===(i=t.groupsCount)||void 0===i?void 0:i.value)&&void 0!==e?e:0}),[null==t||null===(k=t.groupsCount)||void 0===k?void 0:k.value]),N=Object(s.useMemo)((()=>{return`${F.toLocaleString()} ${e=F,I.i18n.translate("grouping.total.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {group} other {groups}}"})}`;var e}),[F]),_=Object(s.useMemo)((()=>{var e,a;return null==t||null===(e=t.groupByFields)||void 0===e||null===(a=e.buckets)||void 0===a?void 0:a.map(((e,t)=>{var a,s;const o=function(e){if(null!==e){if(!Array.isArray(e))return e;for(const t of e)if(null!==t)return t}}(e.key),u=`group-${t}-${o}`,d=null!==(a=e.isNullGroup)&&void 0!==a&&a,p=d?((e,t)=>I.i18n.translate("grouping.nullGroup.title",{values:{selectedGroup:e,unit:t},defaultMessage:"The selected group by field, {selectedGroup}, is missing a value for this group of {unit}."}))(f,v(e.doc_count)):void 0;return Object(g.jsx)("span",{key:u,"data-test-subj":`level-${l}-group-${t}`},Object(g.jsx)(oa,{isNullGroup:d,nullGroupMessage:p,onGroupClose:m,extraAction:Object(g.jsx)(la,{bucketKey:u,groupFilter:d?aa(f):ia(f,Array.isArray(e.key)?e.key:[e.key]),groupNumber:t,statRenderers:n&&n(f,e),takeActionItems:h}),forceState:null!==(s=C[u]&&C[u].state)&&void 0!==s?s:"closed",groupBucket:e,groupPanelRenderer:i&&i(f,e,p,c),isLoading:c,onToggleGroup:e=>{null==y||y(Ji.METRIC_TYPE.CLICK,(({isOpen:e,groupingId:t,groupNumber:i})=>`${ba.GROUP_TOGGLED}${e?"on":"off"}_${t}_group-${i}`)({isOpen:e,groupingId:r,groupNumber:t})),S({[u]:{state:e?"open":"closed"}}),null==j||j({isOpen:e,groupName:o,groupNumber:t,groupingId:r})},renderChildComponent:C[u]&&"open"===C[u].state?x:()=>Object(g.jsx)("span",null),selectedGroup:f,groupingLevel:l}),l>0?null:Object(g.jsx)(M.EuiSpacer,{size:"s"}))}))}),[null==t||null===(T=t.groupByFields)||void 0===T?void 0:T.buckets,i,n,r,l,c,m,j,x,f,h,y,C,v]),D=Object(s.useMemo)((()=>F?Math.ceil(F/d):1),[F,d]);return Object(g.jsx)(o.a.Fragment,null,l>0?null:Object(g.jsx)(M.EuiFlexGroup,{"data-test-subj":"grouping-table",justifyContent:"spaceBetween",alignItems:"center",style:{paddingBottom:20,paddingTop:20}},Object(g.jsx)(M.EuiFlexItem,{grow:!1},F>0&&w>0?Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"none"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)("span",{css:Gi,"data-test-subj":"unit-count"},E)),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)("span",{css:Gi,"data-test-subj":"group-count",style:{borderRight:"none"}},N))):null),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"xs"},u&&Object(g.jsx)(M.EuiFlexItem,null,u),Object(g.jsx)(M.EuiFlexItem,null,a)))),Object(g.jsx)("div",{css:l>0?Wi:Ui,className:"eui-xScroll"},c&&Object(g.jsx)(M.EuiProgress,{"data-test-subj":"is-loading-grouping-table",size:"xs",color:"accent"}),F>0?Object(g.jsx)("span",{"data-test-subj":`grouping-level-${l}`},_,F>0&&Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiSpacer,{size:"m"}),Object(g.jsx)(M.EuiTablePagination,{activePage:e,"data-test-subj":`grouping-level-${l}-pagination`,itemsPerPage:d,itemsPerPageOptions:[10,25,50,100],onChangeItemsPerPage:e=>{p&&p(e)},onChangePage:e=>{b&&b(e)},pageCount:D,showPerPageOptions:!0}))):Object(g.jsx)(ga,null)))},ja=o.a.memo(ma),xa=e=>!!e.find((e=>"none"===e)),fa=window.localStorage,ha={groupById:Ki},ya=(e,t)=>{let i={};fa&&(i=ta(fa));const a=((e,t,i)=>{switch(t.type){case qi.updateActiveGroups:{const{id:a,activeGroups:n}=t.payload;return{...e,groupById:{...i,[a]:{...$i,...i[a],activeGroups:n}}}}case qi.updateGroupOptions:{const{id:a,newOptionList:n}=t.payload;return{...e,groupById:{...i,[a]:{...$i,...i[a],options:n}}}}}throw Error("Unknown grouping action")})(e,t,{...e.groupById,...i});if(fa){const e=t.payload.id;((e,t,i)=>{const a=ta(e);e.setItem(ea,JSON.stringify({...a,[t]:i}))})(fa,e,a.groupById[e])}return a},va=({activeGroups:e,id:t})=>({payload:{activeGroups:e,id:t},type:qi.updateActiveGroups}),Oa=(e,t)=>(e=>e.groups.groupById)(e)[t],ka=({componentProps:e,defaultGroupingOptions:t,fields:i,groupingId:a,maxGroupingLevels:o,onGroupChange:r,onOptionsChange:l,tracker:u,title:c})=>{const[d,p]=Object(s.useReducer)(ya,ha),{activeGroups:b}=Object(s.useMemo)((()=>{var e;return null!==(e=Oa({groups:d},a))&&void 0!==e?e:$i}),[a,d]),m=Object(s.useCallback)((e=>{p(va({id:a,activeGroups:e}))}),[a]),j=(({defaultGroupingOptions:e,dispatch:t,fields:i,groupingId:a,groupingState:n,maxGroupingLevels:o=1,onGroupChange:r,onOptionsChange:l,tracker:u,title:c})=>{var d;const{activeGroups:p,options:b}=null!==(d=Oa({groups:n},a))&&void 0!==d?d:$i,m=Object(s.useCallback)((e=>{t(va({id:a,activeGroups:e}))}),[t,a]),j=Object(s.useCallback)((e=>{t((({newOptionList:e,id:t})=>({payload:{newOptionList:e,id:t},type:qi.updateGroupOptions}))({id:a,newOptionList:e})),null==l||l(e)}),[t,a,l]),x=Object(s.useCallback)((e=>{if(1===o)m([e]);else{if(p.find((t=>t===e))){const t=p.filter((t=>t!==e));return void(0===t.length?m(["none"]):m(t))}const t=xa([e])?[e]:[...p.filter((e=>"none"!==e)),e];m(t)}null==u||u(Ji.METRIC_TYPE.CLICK,(({groupingId:e,selected:t})=>`${ba.GROUPED_ALERTS}${e}_${t}`)({groupingId:a,selected:e})),null==r||r({tableId:a,groupByField:e})}),[a,o,r,p,m,u]);return Object(s.useEffect)((()=>{if(0===b.length&&e.length>0)return j(e.find((e=>p.find((t=>t===e.key))))?e:[...e,...xa(p)?[]:p.map((e=>({key:e,label:e})))]);if(xa(p))return;const t=b.map((e=>e.key)),i=[...b];p.forEach((e=>{t.includes(e)||i.push({label:e,key:e})})),i.length!==b.length&&j(i)}),[e,b,p,j]),Object(g.jsx)(Yi,{groupingId:a,groupsSelected:p,"data-test-subj":"alerts-table-group-selector",onGroupChange:x,fields:i,maxGroupingLevels:o,options:b,title:c})})({defaultGroupingOptions:t,dispatch:p,fields:i,groupingId:a,groupingState:d,maxGroupingLevels:o,onGroupChange:r,onOptionsChange:l,tracker:u,title:c}),x=Object(s.useCallback)((t=>xa([t.selectedGroup])?t.renderChildComponent([]):Object(g.jsx)(ja,n()({},e,t,{groupSelector:j,groupingId:a,tracker:u}))),[e,j,a,u]);return Object(s.useMemo)((()=>({getGrouping:x,groupSelector:j,selectedGroups:b,setSelectedGroups:m})),[x,j,b,m])};var Ma=i(45);const Ta=({query:e,filters:t})=>({query:e,filters:t,sort:{field:"@timestamp",direction:"desc"},pageIndex:0}),Ca=({dataView:e,filters:t=[],query:i,nonPersistedFilters:a})=>{const{notifications:{toasts:n},data:{query:{filterManager:o,queryString:r}},uiSettings:l}=Object(w.a)().services,u=l.get("query:allowLeadingWildcards"),c=Object(s.useMemo)((()=>({allowLeadingWildcards:u})),[u]),d=Object(s.useMemo)((()=>(({dataView:e,query:t,filters:i,config:a})=>{try{return{query:Object(me.buildEsQuery)(e,t,i,a)}}catch(e){return{query:void 0,error:e instanceof Error?e:new Error("Unknown Error")}}})({dataView:e,filters:t.concat(null!=a?a:[]).flat(),query:i,config:c})),[e,t,a,i,c]);return Object(s.useEffect)((()=>{o.setAppFilters(t),r.setQuery(i)}),[t,o,r,i]),Object(s.useEffect)((()=>{const e=d instanceof Error?d:void 0;e&&n.addError(e,{title:I.i18n.translate("xpack.csp.findings.search.queryErrorToastMessage",{defaultMessage:"Query Error"}),toastLifeTimeMs:5e3})}),[d,n]),d},Sa=e=>{const{data:{query:{filterManager:t,queryString:i}}}=Object(w.a)().services;return Object(s.useCallback)((()=>e({filters:t.getAppFilters(),query:i.getQuery()})),[e,t,i])},wa=({grouping:e,pageSize:t})=>Object(g.jsx)("div",{"data-test-subj":"cloudSecurityGroupingLoading"},e.getGrouping({activePage:0,data:{groupsCount:{value:1},unitsCount:{value:1}},groupingLevel:0,inspectButton:void 0,isLoading:!0,itemsPerPage:t,renderChildComponent:()=>Object(g.jsx)(o.a.Fragment,null),onGroupClose:()=>{},selectedGroup:"",takeActionItems:()=>[]}));var Ea={name:"f1fxbl",styles:"&& [data-test-subj='group-stats']>.euiFlexItem:last-child{display:none;}&& [data-test-subj='group-stats']>.euiFlexItem:not(:first-child)>span{border-right:none;margin-right:0;}"};const Ia=({data:e,renderChildComponent:t,grouping:i,activePageIndex:a,isFetching:n,pageSize:s,onChangeGroupsItemsPerPage:o,onChangeGroupsPage:r,selectedGroup:l,isGroupLoading:u})=>u?Object(g.jsx)(wa,{grouping:i,pageSize:s}):Object(g.jsx)("div",{"data-test-subj":"cloudSecurityGrouping",css:Ea},i.getGrouping({activePage:a,data:e,groupingLevel:0,inspectButton:void 0,isLoading:n,itemsPerPage:s,onChangeGroupsItemsPerPage:o,onChangeGroupsPage:r,renderChildComponent:t,onGroupClose:()=>{},selectedGroup:l,takeActionItems:()=>[]})),Fa=e=>I.i18n.translate("xpack.csp.findings.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {finding} other {findings}}"}),Na="resource.name",_a="rule.name",Da="cloud.account.name",La="orchestrator.cluster.name",za=I.i18n.translate("xpack.csp.findings.grouping.nullGroupUnit",{defaultMessage:"findings"}),Aa={RESOURCE_NAME:I.i18n.translate("xpack.csp.findings.grouping.resource.nullGroupTitle",{defaultMessage:"No resource"}),RULE_NAME:I.i18n.translate("xpack.csp.findings.grouping.rule.nullGroupTitle",{defaultMessage:"No rule"}),CLOUD_ACCOUNT_NAME:I.i18n.translate("xpack.csp.findings.grouping.cloudAccount.nullGroupTitle",{defaultMessage:"No cloud account"}),ORCHESTRATOR_CLUSTER_NAME:I.i18n.translate("xpack.csp.findings.grouping.kubernetes.nullGroupTitle",{defaultMessage:"No Kubernetes cluster"}),DEFAULT:I.i18n.translate("xpack.csp.findings.grouping.default.nullGroupTitle",{defaultMessage:"No grouping"})},Ra=[{label:I.i18n.translate("xpack.csp.findings.latestFindings.groupByResource",{defaultMessage:"Resource"}),key:Na},{label:I.i18n.translate("xpack.csp.findings.latestFindings.groupByRuleName",{defaultMessage:"Rule name"}),key:_a},{label:I.i18n.translate("xpack.csp.findings.latestFindings.groupByCloudAccount",{defaultMessage:"Cloud account"}),key:Da},{label:I.i18n.translate("xpack.csp.findings.latestFindings.groupByKubernetesCluster",{defaultMessage:"Kubernetes cluster"}),key:La}],Pa=I.i18n.translate("xpack.csp.findings.latestFindings.groupBy",{defaultMessage:"Group findings by"}),Va=({query:e,filters:t})=>({query:e,filters:t,sort:[["@timestamp","desc"]]}),Ga=[{id:"result.evaluation",width:80},{id:"resource.id"},{id:"resource.name"},{id:"resource.sub_type"},{id:"rule.benchmark.rule_number"},{id:"rule.name"},{id:"rule.section"},{id:"@timestamp"}],Ba=e=>({...e,index:S.w,size:0}),Ua=(e,t)=>({[e]:{terms:{field:t,size:1}}}),Wa=e=>{if(xa([e]))return[];const t=[{groupByField:{cardinality:{field:e}},failedFindings:{filter:{term:{"result.evaluation":{value:"failed"}}}},passedFindings:{filter:{term:{"result.evaluation":{value:"passed"}}}},complianceScore:{bucket_script:{buckets_path:{passed:"passedFindings>_count",failed:"failedFindings>_count"},script:"params.passed / (params.passed + params.failed)"}}}];switch(e){case Na:return[...t,Ua("resourceName","resource.id"),Ua("resourceSubType","resource.sub_type"),Ua("resourceType","resource.type")];case _a:return[...t,Ua("benchmarkName","rule.benchmark.name"),Ua("benchmarkVersion","rule.benchmark.version")];case Da:case La:return[...t,Ua("benchmarkName","rule.benchmark.name"),Ua("benchmarkId","rule.benchmark.id")]}return t},Ha=e=>{var t,i;return void 0!==(null==e||null===(t=e.passedFindings)||void 0===t?void 0:t.doc_count)&&void 0!==(null==e||null===(i=e.failedFindings)||void 0===i?void 0:i.doc_count)};async function Qa(e,t,i,a){var n;if(!e.id||null==a||null===(n=a.indexPatterns)||void 0===n||!n.save)return;const s=e.fields.getByName(t);if(s&&(s.count++,e.isPersisted()))try{await i.updateSavedObject(e,0,!0)}catch{}}function Za(e,t=!1){return e.length>1&&-1!==e.indexOf("_source")?e.filter((e=>"_source"!==e)):0!==e.length?e:t?[]:["_source"]}function Ya(e,t){return e?t?e.filter((e=>"_source"!==e)):e:[]}var Ja=i(32),qa=i.n(Ja),Ka=i(12),$a=i.n(Ka);i(141);const Xa="cellAction-filter";let en;!function(e){e.HOVER_DOWN="hover-down",e.HOVER_RIGHT="hover-right",e.INLINE="inline"}(en||(en={}));var tn=i(31);const an=Object(s.createContext)(null),nn=({children:e,getTriggerCompatibleActions:t})=>{const i=Object(s.useMemo)((()=>({getActions:e=>t(e.trigger.id,e).then((e=>Object(tn.orderBy)(["order","id"],["asc","asc"],e)))})),[t]);return Object(g.jsx)(an.Provider,{value:i},e)};I.i18n.translate("cellActions.extraActionsAriaLabel",{defaultMessage:"Extra actions"}),I.i18n.translate("cellActions.showMoreActionsLabel",{defaultMessage:"More actions"}),I.i18n.translate("cellActions.actionsAriaLabel",{defaultMessage:"Actions"}),Ie.euiThemeVars.euiColorPrimaryText;var sn=i(127),on=i.n(sn);i(82);const rn=(Ie.euiThemeVars.euiSizeS,[()=>Object(g.jsx)(M.EuiLoadingSpinner,{size:"s","data-test-subj":"dataGridColumnCellAction-loading"})]),ln=[],un=({fields:e,getCellValue:t,triggerId:i,metadata:a,dataGridRef:n,disabledActionTypes:o=[]})=>{const r=Object(s.useMemo)((()=>{if(i&&null!=e&&e.length)return e.map((e=>({data:[{field:e}],trigger:{id:i},metadata:a})))}),[e,i,a]),{loading:l,value:u}=((e,t={})=>{const{getActions:i}=(()=>{const e=Object(s.useContext)(an);if(!e)throw new Error("No CellActionsContext found. Please wrap the application with CellActionsProvider");return e})(),{error:a,...n}=on()((()=>{var a;return Promise.all(null!==(a=null==e?void 0:e.map((e=>i(e).then((e=>{var i;return null!==(i=((e,t=[])=>e?e.filter((({type:e})=>!(null!=t&&t.includes(e)))):void 0)(e,t.disabledActionTypes))&&void 0!==i?i:[]})))))&&void 0!==a?a:[])}),[e]);return(e=>{if(e)throw e})(a),n})(r,{disabledActionTypes:o});return Object(s.useMemo)((()=>l?null!=e&&e.length?e.map((()=>rn)):ln:i&&null!=u&&u.length&&null!=e&&e.length?u.length!==e.length?ln:u.map(((s,o)=>s.map((s=>cn({action:s,field:e[o],getCellValue:t,metadata:a,triggerId:i,dataGridRef:n}))))):ln),[u,e,t,l,a,i,n])},cn=({action:e,field:t,getCellValue:i,metadata:a,triggerId:n,dataGridRef:o})=>function({Component:r,rowIndex:l,isExpanded:u}){const c=Object(s.useRef)(null),d=Object(s.useRef)(null),p=Object(s.useMemo)((()=>{const{name:e}=t,s=i(e,l);return{data:[{field:t,value:s}],trigger:{id:n},nodeRef:c,metadata:a}}),[l]),b=Object(s.useCallback)((async()=>{p.nodeRef.current=await dn({dataGrid:o.current,isExpanded:u,buttonRef:d}),e.execute(p)}),[p,u]);return Object(g.jsx)(r,{buttonRef:d,"aria-label":e.getDisplayName(p),title:e.getDisplayName(p),"data-test-subj":`dataGridColumnCellAction-${e.id}`,iconType:e.getIconType(p),onClick:b},e.getDisplayName(p))},dn=({dataGrid:e,isExpanded:t,buttonRef:i})=>new Promise((a=>{const n=t?document.querySelector('div[role="gridcell"].euiDataGridRowCell--open'):pn(i.current);null==e||e.closeCellPopover(),setTimeout((()=>{var e;a(null!==(e=null==n?void 0:n.firstElementChild)&&void 0!==e?e:null)}))})),pn=e=>null==e?null:"DIV"===e.nodeName&&"gridcell"===e.getAttribute("role")?e:pn(e.parentElement);var gn=i(129),bn=i.n(gn);const mn=e=>t=>{const i=e(t);return jn(i)},jn=e=>{const t=t=>fn(e,t);return t.combine=t=>{const i=xn(e,t);return jn(i)},t},xn=(e,t)=>hn(e,t),fn=(e,t)=>hn(e,t),hn=(e,t)=>{const{isCompatible:i,execute:a,...n}=t;let s=e.isCompatible;i&&(s=a?i:async t=>await e.isCompatible(t)&&await i(t));const o=null!=a?a:e.execute;return{...e,isCompatible:s,execute:o,...n}};var yn=i(56);const vn=[yn.b.DATE,yn.b.IP,yn.b.STRING,yn.b.NUMBER,yn.b.BOOLEAN],On=e=>vn.includes(e),kn=e=>e.every((e=>Object(tn.isString)(e)||Object(tn.isNumber)(e)||Object(tn.isBoolean)(e)))&&(e=>e.every((t=>typeof t==typeof e[0])))(e),Mn=e=>e.filter((e=>null!=e)),Tn=e=>Array.isArray(e)?e:[e],Cn=I.i18n.translate("cellActions.actions.incompatibility.warningMessage",{defaultMessage:"The action can not be executed because the value and type are incompatible"}),Sn=I.i18n.translate("cellActions.actions.copyToClipboard.displayName",{defaultMessage:"Copy to Clipboard"}),wn=I.i18n.translate("cellActions.actions.copyToClipboard.successMessage",{defaultMessage:"Copied to the clipboard"}),En=(mn((({notifications:e})=>({type:"cellAction-copy",getIconType:()=>"copyClipboard",getDisplayName:()=>Sn,getDisplayNameTooltip:()=>Sn,isCompatible:async({data:e})=>{var t;const i=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&null!=i.name&&On(i.type)},execute:async({data:t})=>{var i,a;const n=null===(i=t[0])||void 0===i?void 0:i.field,s=null===(a=t[0])||void 0===a?void 0:a.value,o=Mn(Tn(s));if(!kn(o))return void e.toasts.addWarning({title:Cn});const r=o.map((e=>Object(tn.isString)(e)?`"${(e=>e.replace(/"/g,'\\"'))(e)}"`:e)).join(" AND "),l=""!==r?`${n.name}: ${r}`:n.name;bn()(l,{debug:!0})&&e.toasts.addSuccess({title:wn},{toastLifeTimeMs:800})}}))),e=>0===e.length||e.every((e=>""===e))),In=({key:e,negate:t,value:i})=>({meta:{key:e,negate:t,type:me.FILTERS.PHRASE,params:{query:i.toString()}},query:{match_phrase:{[e]:{query:i.toString()}}}}),Fn=({key:e,value:t,negate:i})=>0===t.length?(({key:e,negate:t})=>({meta:{key:e,negate:t,type:me.FILTERS.EXISTS,value:"exists"},query:{exists:{field:e}}}))({key:e,negate:i}):t.length>1?(({values:e,key:t,negate:i})=>({meta:{key:t,negate:i,type:me.FILTERS.COMBINED,relation:me.BooleanRelation.AND,params:e.map((e=>In({key:t,value:e})))}}))({key:e,negate:i,values:t}):In({key:e,negate:i,value:t[0]}),Nn=I.i18n.translate("cellActions.actions.filterIn",{defaultMessage:"Filter In"}),_n=(mn((({filterManager:e,notifications:{toasts:t}})=>({type:Xa,getIconType:()=>"plusInCircle",getDisplayName:()=>Nn,getDisplayNameTooltip:()=>Nn,isCompatible:async({data:e})=>{var t;const i=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&!!i.name&&On(i.type)},execute:async({data:i})=>{var a,n;const s=null===(a=i[0])||void 0===a?void 0:a.field,o=null===(n=i[0])||void 0===n?void 0:n.value,r=Mn(Tn(o));kn(r)?_n({filterManager:e,fieldName:s.name,value:r}):t.addWarning({title:Cn})}}))),({filterManager:e,fieldName:t,value:i})=>{if(null!=e){const a=Fn({key:t,value:i,negate:En(i)});e.addFilters(a)}}),Dn=I.i18n.translate("cellActions.actions.filterOut",{defaultMessage:"Filter Out"}),Ln=(mn((({filterManager:e,notifications:{toasts:t}})=>({type:Xa,getIconType:()=>"minusInCircle",getDisplayName:()=>Dn,getDisplayNameTooltip:()=>Dn,isCompatible:async({data:e})=>{var t;const i=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&!!i.name&&On(i.type)},execute:async({data:i})=>{var a,n;const s=null===(a=i[0])||void 0===a?void 0:a.field,o=null===(n=i[0])||void 0===n?void 0:n.value,r=Mn(Tn(o));kn(r)?Ln({filterManager:e,fieldName:s.name,value:r}):t.addWarning({title:Cn})}}))),({filterManager:e,fieldName:t,value:i})=>{if(null!=e){const a=Fn({key:t,value:i,negate:!En(i)});e.addFilters(a)}}),zn=["_source"];var An=i(47);function Rn(e,t,i,a,n,s,o){const r=null!=s?s:"html",l={hit:t,field:n,...o};return a&&n?a.getFormatterForField(n).convert(e,r,l):i.getDefaultInstance(yn.b.STRING).convert(e,r,l)}const Pn=(e,t)=>t?JSON.stringify(e):JSON.stringify(e,null,2),Vn=Object(An.createEscapeValue)({separator:",",quoteValues:!0,escapeFormulaValues:!0}),Gn=e=>Vn(e),Bn=[10,25,50,100,250,500],Un=212,Wn="kibana-json",Hn={border:"horizontal",fontSize:"s",cellPadding:"l",rowHover:"highlight",header:"underline",stripes:!0},Qn={showColumnSelector:{allowHide:!1,allowReorder:!0}},Zn=new WeakMap,Yn={},Jn=o.a.createContext(Yn);i(85);var qn=i(150),Kn=i(34),$n=i(86);function Xn(e){return/^\d+$/.test(e)?e+"px":e}function es(){}var ts,is=(ts=function(e,t){return ts=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},ts(e,t)},function(e,t){function i(){this.constructor=e}ts(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),as=function(){return as=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},as.apply(this,arguments)},ns=(function(e){function t(t){var i=e.call(this,t)||this;return i.assignRef=function(e){i.containerElement=e},i.containerElement=void 0,i}is(t,e),t.prototype.componentDidMount=function(){this.initMonaco()},t.prototype.componentDidUpdate=function(e){var t=this.props,i=t.language,a=t.theme,n=t.height,s=t.options,o=t.width,r=this.editor.getModel(),l=r.original,u=r.modified;this.props.original!==l.getValue()&&l.setValue(this.props.original),null!=this.props.value&&this.props.value!==u.getValue()&&(this.__prevent_trigger_change_event=!0,this.editor.modifiedEditor.pushUndoStop(),u.pushEditOperations([],[{range:u.getFullModelRange(),text:this.props.value}]),this.editor.modifiedEditor.pushUndoStop(),this.__prevent_trigger_change_event=!1),e.language!==i&&(Kn.editor.setModelLanguage(l,i),Kn.editor.setModelLanguage(u,i)),e.theme!==a&&Kn.editor.setTheme(a),!this.editor||o===e.width&&n===e.height||this.editor.layout(),e.options!==s&&this.editor.updateOptions(s)},t.prototype.componentWillUnmount=function(){this.destroyMonaco()},t.prototype.editorWillMount=function(){return(0,this.props.editorWillMount)(Kn)||{}},t.prototype.editorDidMount=function(e){var t=this;this.props.editorDidMount(e,Kn);var i=e.getModel().modified;this._subscription=i.onDidChangeContent((function(e){t.__prevent_trigger_change_event||t.props.onChange(i.getValue(),e)}))},t.prototype.initModels=function(e,t){var i=this.props.language,a=Kn.editor.createModel(t,i),n=Kn.editor.createModel(e,i);this.editor.setModel({original:a,modified:n})},t.prototype.initMonaco=function(){var e=null!=this.props.value?this.props.value:this.props.defaultValue,t=this.props,i=t.original,a=t.theme,n=t.options,s=t.overrideServices;this.containerElement&&(this.editorWillMount(),this.editor=Kn.editor.createDiffEditor(this.containerElement,as(as({},n),a?{theme:a}:{}),s),this.initModels(e,i),this.editorDidMount(this.editor))},t.prototype.destroyMonaco=function(){if(this.editor){this.editor.dispose();var e=this.editor.getModel(),t=e.original,i=e.modified;t&&t.dispose(),i&&i.dispose()}this._subscription&&this._subscription.dispose()},t.prototype.render=function(){var e=this.props,t=e.width,i=e.height,a={width:Xn(t),height:Xn(i)};return s.createElement("div",{ref:this.assignRef,style:a,className:"react-monaco-editor-container"})},t.propTypes={width:$n.oneOfType([$n.string,$n.number]),height:$n.oneOfType([$n.string,$n.number]),original:$n.string,value:$n.string,defaultValue:$n.string,language:$n.string,theme:$n.string,options:$n.object,overrideServices:$n.object,editorDidMount:$n.func,editorWillMount:$n.func,onChange:$n.func},t.defaultProps={width:"100%",height:"100%",original:null,value:null,defaultValue:"",language:"javascript",theme:null,options:{},overrideServices:{},editorDidMount:es,editorWillMount:es,onChange:es}}(s.Component),function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}()),ss=function(){return ss=Object.assign||function(e){for(var t,i=1,a=arguments.length;i<a;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},ss.apply(this,arguments)},os=function(e){function t(t){var i=e.call(this,t)||this;return i.assignRef=function(e){i.containerElement=e},i.containerElement=void 0,i}return ns(t,e),t.prototype.componentDidMount=function(){this.initMonaco()},t.prototype.componentDidUpdate=function(e){var t=this.props,i=t.value,a=t.language,n=t.theme,s=t.height,o=t.options,r=t.width,l=this.editor,u=l.getModel();if(null!=this.props.value&&this.props.value!==u.getValue()&&(this.__prevent_trigger_change_event=!0,this.editor.pushUndoStop(),u.pushEditOperations([],[{range:u.getFullModelRange(),text:i}]),this.editor.pushUndoStop(),this.__prevent_trigger_change_event=!1),e.language!==a&&Kn.editor.setModelLanguage(u,a),e.theme!==n&&Kn.editor.setTheme(n),!l||r===e.width&&s===e.height||l.layout(),e.options!==o){o.model;var c=function(e,t){var i={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(i[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(i[a[n]]=e[a[n]])}return i}(o,["model"]);l.updateOptions(c)}},t.prototype.componentWillUnmount=function(){this.destroyMonaco()},t.prototype.destroyMonaco=function(){if(this.editor){this.editor.dispose();var e=this.editor.getModel();e&&e.dispose()}this._subscription&&this._subscription.dispose()},t.prototype.initMonaco=function(){var e=null!=this.props.value?this.props.value:this.props.defaultValue,t=this.props,i=t.language,a=t.theme,n=t.overrideServices;if(this.containerElement){var s=ss(ss({},this.props.options),this.editorWillMount());this.editor=Kn.editor.create(this.containerElement,ss(ss({value:e,language:i},s),a?{theme:a}:{}),n),this.editorDidMount(this.editor)}},t.prototype.editorWillMount=function(){return(0,this.props.editorWillMount)(Kn)||{}},t.prototype.editorDidMount=function(e){var t=this;this.props.editorDidMount(e,Kn),this._subscription=e.onDidChangeModelContent((function(i){t.__prevent_trigger_change_event||t.props.onChange(e.getValue(),i)}))},t.prototype.render=function(){var e=this.props,t=e.width,i=e.height,a={width:Xn(t),height:Xn(i)};return s.createElement("div",{ref:this.assignRef,style:a,className:"react-monaco-editor-container"})},t.propTypes={width:$n.oneOfType([$n.string,$n.number]),height:$n.oneOfType([$n.string,$n.number]),value:$n.string,defaultValue:$n.string,language:$n.string,theme:$n.string,options:$n.object,overrideServices:$n.object,editorDidMount:$n.func,editorWillMount:$n.func,onChange:$n.func},t.defaultProps={width:"100%",height:"100%",value:null,defaultValue:"",language:"javascript",theme:null,options:{},overrideServices:{},editorDidMount:es,editorWillMount:es,onChange:es},t}(s.Component);const rs={ID:"css",lexerRules:{defaultToken:"",tokenPostfix:".css",ws:"[ \t\n\r\f]*",identifier:"-?-?([a-zA-Z]|(\\\\(([0-9a-fA-F]{1,6}\\s?)|[^[0-9a-fA-F])))([\\w\\-]|(\\\\(([0-9a-fA-F]{1,6}\\s?)|[^[0-9a-fA-F])))*",brackets:[{open:"{",close:"}",token:"delimiter.bracket"},{open:"[",close:"]",token:"delimiter.bracket"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}],tokenizer:{root:[{include:"@selector"}],selector:[{include:"@comments"},{include:"@import"},{include:"@strings"},["[@](keyframes|-webkit-keyframes|-moz-keyframes|-o-keyframes)",{token:"keyword",next:"@keyframedeclaration"}],["[@](page|content|font-face|-moz-document)",{token:"keyword"}],["[@](charset|namespace)",{token:"keyword",next:"@declarationbody"}],["(url-prefix)(\\()",["attribute.value",{token:"delimiter.parenthesis",next:"@urldeclaration"}]],["(url)(\\()",["attribute.value",{token:"delimiter.parenthesis",next:"@urldeclaration"}]],{include:"@selectorname"},["[\\*]","tag"],["[>\\+,]","delimiter"],["\\[",{token:"delimiter.bracket",next:"@selectorattribute"}],["{",{token:"delimiter.bracket",next:"@selectorbody"}]],selectorbody:[{include:"@comments"},["[*_]?@identifier@ws:(?=(\\s|\\d|[^{;}]*[;}]))","attribute.name","@rulevalue"],["}",{token:"delimiter.bracket",next:"@pop"}]],selectorname:[["(\\.|#(?=[^{])|%|(@identifier)|:)+","tag"]],selectorattribute:[{include:"@term"},["]",{token:"delimiter.bracket",next:"@pop"}]],term:[{include:"@comments"},["(url-prefix)(\\()",["attribute.value",{token:"delimiter.parenthesis",next:"@urldeclaration"}]],["(url)(\\()",["attribute.value",{token:"delimiter.parenthesis",next:"@urldeclaration"}]],{include:"@functioninvocation"},{include:"@numbers"},{include:"@name"},{include:"@strings"},["([<>=\\+\\-\\*\\/\\^\\|\\~,])","delimiter"],[",","delimiter"]],rulevalue:[{include:"@comments"},{include:"@strings"},{include:"@term"},["!important","keyword"],[";","delimiter","@pop"],["(?=})",{token:"",next:"@pop"}]],warndebug:[["[@](warn|debug)",{token:"keyword",next:"@declarationbody"}]],import:[["[@](import)",{token:"keyword",next:"@declarationbody"}]],urldeclaration:[{include:"@strings"},["[^)\r\n]+","string"],["\\)",{token:"delimiter.parenthesis",next:"@pop"}]],parenthizedterm:[{include:"@term"},["\\)",{token:"delimiter.parenthesis",next:"@pop"}]],declarationbody:[{include:"@term"},[";","delimiter","@pop"],["(?=})",{token:"",next:"@pop"}]],comments:[["\\/\\*","comment","@comment"],["\\/\\/+.*","comment"]],comment:[["\\*\\/","comment","@pop"],[/[^*/]+/,"comment"],[/./,"comment"]],name:[["@identifier","attribute.value"]],numbers:[["-?(\\d*\\.)?\\d+([eE][\\-+]?\\d+)?",{token:"attribute.value.number",next:"@units"}],["#[0-9a-fA-F_]+(?!\\w)","attribute.value.hex"]],units:[["(em|ex|ch|rem|vmin|vmax|vw|vh|vm|cm|mm|in|px|pt|pc|deg|grad|rad|turn|s|ms|Hz|kHz|%)?","attribute.value.unit","@pop"]],keyframedeclaration:[["@identifier","attribute.value"],["{",{token:"delimiter.bracket",switchTo:"@keyframebody"}]],keyframebody:[{include:"@term"},["{",{token:"delimiter.bracket",next:"@selectorbody"}],["}",{token:"delimiter.bracket",next:"@pop"}]],functioninvocation:[["@identifier\\(",{token:"attribute.value",next:"@functionarguments"}]],functionarguments:[["\\$@identifier@ws:","attribute.name"],["[,]","delimiter"],{include:"@term"},["\\)",{token:"attribute.value",next:"@pop"}]],strings:[['~?"',{token:"string",next:"@stringenddoublequote"}],["~?'",{token:"string",next:"@stringendquote"}]],stringenddoublequote:[["\\\\.","string"],['"',{token:"string",next:"@pop"}],[/[^\\"]+/,"string"],[".","string"]],stringendquote:[["\\\\.","string"],["'",{token:"string",next:"@pop"}],[/[^\\']+/,"string"],[".","string"]]}},languageConfiguration:{wordPattern:/(#?-?\d*\.\d\w*%?)|((::|[@#.!:])?[\w-?]+%?)|::|[@#.!:]/g,comments:{blockComment:["/*","*/"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}",notIn:["string","comment"]},{open:"[",close:"]",notIn:["string","comment"]},{open:"(",close:")",notIn:["string","comment"]},{open:'"',close:'"',notIn:["string","comment"]},{open:"'",close:"'",notIn:["string","comment"]}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],folding:{markers:{start:new RegExp("^\\s*\\/\\*\\s*#region\\b\\s*(.*?)\\s*\\*\\/"),end:new RegExp("^\\s*\\/\\*\\s*#endregion\\b.*\\*\\/")}}}},ls={ID:"markdown",languageConfiguration:{comments:{blockComment:["\x3c!--","--\x3e"]},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:"<",close:">",notIn:["string"]}],surroundingPairs:[{open:"(",close:")"},{open:"[",close:"]"},{open:"`",close:"`"}],folding:{markers:{start:new RegExp("^\\s*\x3c!--\\s*#?region\\b.*--\x3e"),end:new RegExp("^\\s*\x3c!--\\s*#?endregion\\b.*--\x3e")}}},lexerRules:{defaultToken:"",tokenPostfix:".md",control:/[\\`*_\[\]{}()#+\-\.!]/,noncontrol:/[^\\`*_\[\]{}()#+\-\.!]/,escapes:/\\(?:@control)/,jsescapes:/\\(?:[btnfr\\"']|[0-7][0-7]?|[0-3][0-7]{2})/,empty:["area","base","basefont","br","col","frame","hr","img","input","isindex","link","meta","param"],tokenizer:{root:[[/^\s*\|/,"@rematch","@table_header"],[/^(\s{0,3})(#+)((?:[^\\#]|@escapes)+)((?:#+)?)/,["white","keyword","keyword","keyword"]],[/^\s*(=+|\-+)\s*$/,"keyword"],[/^\s*((\*[ ]?)+)\s*$/,"meta.separator"],[/^\s*>+/,"comment"],[/^\s*([\*\-+:]|\d+\.)\s/,"keyword"],[/^(\t|[ ]{4})[^ ].*$/,"string"],[/^\s*~~~\s*((?:\w|[\/\-#])+)?\s*$/,{token:"string",next:"@codeblock"}],[/^\s*```\s*((?:\w|[\/\-#])+).*$/,{token:"string",next:"@codeblockgh",nextEmbedded:"$1"}],[/^\s*```\s*$/,{token:"string",next:"@codeblock"}],{include:"@linecontent"}],table_header:[{include:"@table_common"},[/[^\|]+/,"keyword.table.header"]],table_body:[{include:"@table_common"},{include:"@linecontent"}],table_common:[[/\s*[\-:]+\s*/,{token:"keyword",switchTo:"table_body"}],[/^\s*\|/,"keyword.table.left"],[/^\s*[^\|]/,"@rematch","@pop"],[/^\s*$/,"@rematch","@pop"],[/\|/,{cases:{"@eos":"keyword.table.right","@default":"keyword.table.middle"}}]],codeblock:[[/^\s*~~~\s*$/,{token:"string",next:"@pop"}],[/^\s*```\s*$/,{token:"string",next:"@pop"}],[/.*$/,"variable.source"]],codeblockgh:[[/```\s*$/,{token:"variable.source",next:"@pop",nextEmbedded:"@pop"}],[/[^`]+/,"variable.source"]],linecontent:[[/&\w+;/,"string.escape"],[/@escapes/,"escape"],[/\b__([^\\_]|@escapes|_(?!_))+__\b/,"strong"],[/\*\*([^\\*]|@escapes|\*(?!\*))+\*\*/,"strong"],[/\b_[^_]+_\b/,"emphasis"],[/\*([^\\*]|@escapes)+\*/,"emphasis"],[/`([^\\`]|@escapes)+`/,"variable"],[/\{+[^}]+\}+/,"string.target"],[/(!?\[)((?:[^\]\\]|@escapes)*)(\]\([^\)]+\))/,["string.link","","string.link"]],[/(!?\[)((?:[^\]\\]|@escapes)*)(\])/,"string.link"],{include:"html"}],html:[[/<(\w+)\/>/,"tag"],[/<(\w+)/,{cases:{"@empty":{token:"tag",next:"@tag.$1"},"@default":{token:"tag",next:"@tag.$1"}}}],[/<\/(\w+)\s*>/,{token:"tag"}],[/<!--/,"comment","@comment"]],comment:[[/[^<\-]+/,"comment.content"],[/-->/,"comment","@pop"],[/<!--/,"comment.content.invalid"],[/[<\-]/,"comment.content"]],tag:[[/[ \t\r\n]+/,"white"],[/(type)(\s*=\s*)(")([^"]+)(")/,["attribute.name.html","delimiter.html","string.html",{token:"string.html",switchTo:"@tag.$S2.$4"},"string.html"]],[/(type)(\s*=\s*)(')([^']+)(')/,["attribute.name.html","delimiter.html","string.html",{token:"string.html",switchTo:"@tag.$S2.$4"},"string.html"]],[/(\w+)(\s*=\s*)("[^"]*"|'[^']*')/,["attribute.name.html","delimiter.html","string.html"]],[/\w+/,"attribute.name.html"],[/\/>/,"tag","@pop"],[/>/,{cases:{"$S2==style":{token:"tag",switchTo:"embeddedStyle",nextEmbedded:"text/css"},"$S2==script":{cases:{$S3:{token:"tag",switchTo:"embeddedScript",nextEmbedded:"$S3"},"@default":{token:"tag",switchTo:"embeddedScript",nextEmbedded:"text/javascript"}}},"@default":{token:"tag",next:"@pop"}}}]],embeddedStyle:[[/[^<]+/,""],[/<\/style\s*>/,{token:"@rematch",next:"@pop",nextEmbedded:"@pop"}],[/</,""]],embeddedScript:[[/[^<]+/,""],[/<\/script\s*>/,{token:"@rematch",next:"@pop",nextEmbedded:"@pop"}],[/</,""]]}}};Object(Ot.registerLanguage)(rs),Object(Ot.registerLanguage)({ID:"handlebars",languageConfiguration:{wordPattern:/(-?\d*\.\d\w*)|([^\`\~\!\@\$\^\&\*\(\)\=\+\[\{\]\}\\\|\;\:\'\"\,\.\<\>\/\s]+)/g,comments:{blockComment:["{{!--","--}}"]},brackets:[["<",">"],["{{","}}"],["{","}"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"<",close:">"},{open:'"',close:'"'},{open:"'",close:"'"}]},lexerRules:{defaultToken:"invalid",tokenPostfix:"",brackets:[{token:"constant.delimiter.double",open:"{{",close:"}}"},{token:"constant.delimiter.triple",open:"{{{",close:"}}}"}],tokenizer:{root:[{include:"@maybeHandlebars"},{include:"@whitespace"},{include:"@urlScheme"},{include:"@urlAuthority"},{include:"@urlSlash"},{include:"@urlParamKey"},{include:"@urlParamValue"},{include:"@text"}],maybeHandlebars:[[/\{\{/,{token:"@rematch",switchTo:"@handlebars.root"}]],whitespace:[[/[ \t\r\n]+/,""]],text:[[/[^<{\?\&\/]+/,{token:"text",next:"@popall"}]],rematchAsRoot:[[/.+/,{token:"@rematch",switchTo:"@root"}]],urlScheme:[[/([a-zA-Z0-9\+\.\-]{1,10})(:)/,[{token:"text.keyword.scheme.url"},{token:"delimiter"}]]],urlAuthority:[[/(\/\/)([a-zA-Z0-9\.\-_]+)/,[{token:"delimiter"},{token:"metatag.keyword.authority.url"}]]],urlSlash:[[/\/+/,{token:"delimiter"}]],urlParamKey:[[/([\?\&\#])([a-zA-Z0-9_\-]+)/,[{token:"delimiter.key.query.url"},{token:"label.label.key.query.url"}]]],urlParamValue:[[/(\=)([^\?\&\{}]+)/,[{token:"text.separator.value.query.url"},{token:"text.value.query.url"}]]],handlebars:[[/\{\{\{?/,{token:"@brackets",bracket:"@open"}],[/\}\}\}?/,{token:"@brackets",bracket:"@close",switchTo:"@$S2.$S3"}],{include:"handlebarsExpression"}],handlebarsExpression:[[/"[^"]*"/,"string.handlebars"],[/[#/][^\s}]+/,"keyword.helper.handlebars"],[/else\b/,"keyword.helper.handlebars"],[/[\s]+/],[/[^}]/,"variable.parameter.handlebars"]]}}}),Object(Ot.registerLanguage)(ls),Object(Ot.registerLanguage)({ID:"yaml",languageConfiguration:{comments:{lineComment:"#"},brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],folding:{offSide:!0}},lexerRules:{tokenPostfix:".yaml",brackets:[{token:"delimiter.bracket",open:"{",close:"}"},{token:"delimiter.square",open:"[",close:"]"}],keywords:["true","True","TRUE","false","False","FALSE","null","Null","Null","~"],numberInteger:/(?:0|[+-]?[0-9]+)/,numberFloat:/(?:0|[+-]?[0-9]+)(?:\.[0-9]+)?(?:e[-+][1-9][0-9]*)?/,numberOctal:/0o[0-7]+/,numberHex:/0x[0-9a-fA-F]+/,numberInfinity:/[+-]?\.(?:inf|Inf|INF)/,numberNaN:/\.(?:nan|Nan|NAN)/,numberDate:/\d{4}-\d\d-\d\d([Tt ]\d\d:\d\d:\d\d(\.\d+)?(( ?[+-]\d\d?(:\d\d)?)|Z)?)?/,escapes:/\\(?:[btnfr\\"']|[0-7][0-7]?|[0-3][0-7]{2})/,tokenizer:{root:[{include:"@whitespace"},{include:"@comment"},[/%[^ ]+.*$/,"meta.directive"],[/---/,"operators.directivesEnd"],[/\.{3}/,"operators.documentEnd"],[/[-?:](?= )/,"operators"],{include:"@anchor"},{include:"@tagHandle"},{include:"@flowCollections"},{include:"@blockStyle"},[/@numberInteger(?![ \t]*\S+)/,"number"],[/@numberFloat(?![ \t]*\S+)/,"number.float"],[/@numberOctal(?![ \t]*\S+)/,"number.octal"],[/@numberHex(?![ \t]*\S+)/,"number.hex"],[/@numberInfinity(?![ \t]*\S+)/,"number.infinity"],[/@numberNaN(?![ \t]*\S+)/,"number.nan"],[/@numberDate(?![ \t]*\S+)/,"number.date"],[/(".*?"|'.*?'|.*?)([ \t]*)(:)( |$)/,["type","white","operators","white"]],{include:"@flowScalars"},[/[^#]+/,{cases:{"@keywords":"keyword","@default":"string"}}]],object:[{include:"@whitespace"},{include:"@comment"},[/\}/,"@brackets","@pop"],[/,/,"delimiter.comma"],[/:(?= )/,"operators"],[/(?:".*?"|'.*?'|[^,\{\[]+?)(?=: )/,"type"],{include:"@flowCollections"},{include:"@flowScalars"},{include:"@tagHandle"},{include:"@anchor"},{include:"@flowNumber"},[/[^\},]+/,{cases:{"@keywords":"keyword","@default":"string"}}]],array:[{include:"@whitespace"},{include:"@comment"},[/\]/,"@brackets","@pop"],[/,/,"delimiter.comma"],{include:"@flowCollections"},{include:"@flowScalars"},{include:"@tagHandle"},{include:"@anchor"},{include:"@flowNumber"},[/[^\],]+/,{cases:{"@keywords":"keyword","@default":"string"}}]],multiString:[[/^( +).+$/,"string","@multiStringContinued.$1"]],multiStringContinued:[[/^( *).+$/,{cases:{"$1==$S2":"string","@default":{token:"@rematch",next:"@popall"}}}]],whitespace:[[/[ \t\r\n]+/,"white"]],comment:[[/#.*$/,"comment"]],flowCollections:[[/\[/,"@brackets","@array"],[/\{/,"@brackets","@object"]],flowScalars:[[/"([^"\\]|\\.)*$/,"string.invalid"],[/'([^'\\]|\\.)*$/,"string.invalid"],[/'[^']*'/,"string"],[/"/,"string","@doubleQuotedString"]],doubleQuotedString:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],blockStyle:[[/[>|][0-9]*[+-]?$/,"operators","@multiString"]],flowNumber:[[/@numberInteger(?=[ \t]*[,\]\}])/,"number"],[/@numberFloat(?=[ \t]*[,\]\}])/,"number.float"],[/@numberOctal(?=[ \t]*[,\]\}])/,"number.octal"],[/@numberHex(?=[ \t]*[,\]\}])/,"number.hex"],[/@numberInfinity(?=[ \t]*[,\]\}])/,"number.infinity"],[/@numberNaN(?=[ \t]*[,\]\}])/,"number.nan"],[/@numberDate(?=[ \t]*[,\]\}])/,"number.date"]],tagHandle:[[/\![^ ]*/,"tag"]],anchor:[[/[&*][^ ]+/,"namespace"]]}}}),Object(Ot.registerLanguage)({ID:"hjson",languageConfiguration:{brackets:[["{","}"],["[","]"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:'"',close:'"',notIn:["string"]}],comments:{lineComment:"//",blockComment:["/*","*/"]}},lexerRules:{defaultToken:"",tokenPostfix:"",escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,digits:/-?(?:0|[1-9]\d*)(?:(?:\.\d+)?(?:[eE][+-]?\d+)?)?/,symbols:/[,:]+/,tokenizer:{root:[[/(@digits)n?/,"number"],[/(@symbols)n?/,"delimiter"],{include:"@keyword"},{include:"@url"},{include:"@whitespace"},{include:"@brackets"},{include:"@keyName"},{include:"@string"}],keyword:[[/(?:true|false|null)\b/,"keyword"]],url:[[/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/,"string"]],keyName:[[/(?:[^,\{\[\}\]\s]+|"(?:[^"\\]|\\.)*")\s*(?=:)/,"variable"]],brackets:[[/{/,"@push"],[/}/,"@pop"],[/[[(]/],[/[\])]/]],whitespace:[[/[ \t\r\n]+/,""],[/\/\*/,"comment","@comment"],[/\/\/.*$/,"comment"]],comment:[[/[^\/*]+/,"comment"],[/\*\//,"comment","@pop"],[/[\/*]/,"comment"]],string:[[/(?:[^,\{\[\}\]\s]+|"(?:[^"\\]|\\.)*")\s*/,"string"],[/"""/,"string","@stringLiteral"],[/"/,"string","@stringDouble"]],stringDouble:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,"string","@pop"]],stringLiteral:[[/"""/,"string","@pop"],[/\\""""/,"string","@pop"],[/./,"string"]]}}}),Object(Ot.registerLanguage)({ID:"grok",languageConfiguration:{brackets:[["{","}"],["[","]"],["(",")"]],autoClosingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}],surroundingPairs:[{open:"{",close:"}"},{open:"[",close:"]"},{open:"(",close:")"},{open:'"',close:'"'},{open:"'",close:"'"}]},lexerRules:{grokRegexSymbols:/[\[\]()?:|]/,tokenizer:{root:[[/(%\{)([^:}]+)(})/,["string.openGrok","variable.syntax","string.closeGrok"]],[/(%\{)([^:}]+)(:)([^:}]+)(})/,["string.openGrok","variable.syntax","string.separator","variable.id","string.closeGrok"]],[/(%\{)([^:}]+)(:)([^:}]+)(:)([^:}]+)(})/,["string.openGrok","variable.syntax","string.separator","variable.id","string.separator","variable.type","string.closeGrok"]],[/(\\)(@grokRegexSymbols)/,["string.escape.grokEscape","source.grokEscaped"]],[/@grokRegexSymbols/,"regexp.grokRegex"]]}}});var us=i(52);class placeholder_widget_PlaceholderWidget{constructor(e,t,i){Ni()(this,"domNode",void 0),this.placeholderText=e,this.euiTheme=t,this.editor=i,i.addContentWidget(this)}getId(){return"KBN_CODE_EDITOR_PLACEHOLDER_WIDGET_ID"}getDomNode(){if(!this.domNode){const e=document.createElement("div");e.innerText=this.placeholderText,e.className=Object(us.css)("color:",this.euiTheme.colors.subduedText,";width:max-content;pointer-events:none;",""),this.editor.applyFontInfo(e),this.domNode=e}return this.domNode}getPosition(){return{position:{column:1,lineNumber:1},preference:[Ot.monaco.editor.ContentWidgetPositionPreference.EXACT]}}dispose(){this.editor.removeContentWidget(this)}}const cs={container:{name:"1wv4onu",styles:"position:relative;height:100%"},fullscreenContainer:{name:"1m19vma",styles:"position:absolute;left:0;top:0"},keyboardHint:e=>Object(g.css)("position:absolute;top:0;bottom:0;right:0;left:0;&:focus{z-index:",e.levels.mask,";}",""),controls:{base:e=>Object(g.css)("position:absolute;top:",e.size.xs,";right:",e.size.base,";z-index:",e.levels.menu,";",""),fullscreen:e=>Object(g.css)("top:",e.size.l,";right:",e.size.l,";","")}};function ds(e,t,i){return{base:"vs",inherit:!0,rules:[{token:"",foreground:e.euiColorDarkestShade,background:e.euiFormBackgroundColor},{token:"invalid",foreground:e.euiColorAccentText},{token:"emphasis",fontStyle:"italic"},{token:"strong",fontStyle:"bold"},{token:"variable",foreground:e.euiColorPrimaryText},{token:"variable.predefined",foreground:e.euiColorSuccessText},{token:"constant",foreground:e.euiColorAccentText},{token:"comment",foreground:e.euiTextSubduedColor},{token:"number",foreground:e.euiColorAccentText},{token:"number.hex",foreground:e.euiColorAccentText},{token:"regexp",foreground:e.euiColorDangerText},{token:"annotation",foreground:e.euiTextSubduedColor},{token:"type",foreground:e.euiColorSuccessText},{token:"delimiter",foreground:e.euiTextSubduedColor},{token:"delimiter.html",foreground:e.euiColorDarkShade},{token:"delimiter.xml",foreground:e.euiColorPrimaryText},{token:"tag",foreground:e.euiColorDangerText},{token:"tag.id.jade",foreground:e.euiColorPrimaryText},{token:"tag.class.jade",foreground:e.euiColorPrimaryText},{token:"meta.scss",foreground:e.euiColorAccentText},{token:"metatag",foreground:e.euiColorSuccessText},{token:"metatag.content.html",foreground:e.euiColorDangerText},{token:"metatag.html",foreground:e.euiTextSubduedColor},{token:"metatag.xml",foreground:e.euiTextSubduedColor},{token:"metatag.php",fontStyle:"bold"},{token:"key",foreground:e.euiColorWarningText},{token:"string.key.json",foreground:e.euiColorDangerText},{token:"string.value.json",foreground:e.euiColorPrimaryText},{token:"attribute.name",foreground:e.euiColorDangerText},{token:"attribute.name.css",foreground:e.euiColorSuccessText},{token:"attribute.value",foreground:e.euiColorPrimaryText},{token:"attribute.value.number",foreground:e.euiColorWarningText},{token:"attribute.value.unit",foreground:e.euiColorWarningText},{token:"attribute.value.html",foreground:e.euiColorPrimaryText},{token:"attribute.value.xml",foreground:e.euiColorPrimaryText},{token:"string",foreground:e.euiColorDangerText},{token:"string.html",foreground:e.euiColorPrimaryText},{token:"string.sql",foreground:e.euiColorDangerText},{token:"string.yaml",foreground:e.euiColorPrimaryText},{token:"keyword",foreground:e.euiColorPrimaryText},{token:"keyword.json",foreground:e.euiColorPrimaryText},{token:"keyword.flow",foreground:e.euiColorWarningText},{token:"keyword.flow.scss",foreground:e.euiColorPrimaryText},{token:"keyword.deprecated",foreground:e.euiColorAccentText},{token:"operator.scss",foreground:e.euiColorDarkShade},{token:"operator.sql",foreground:e.euiTextSubduedColor},{token:"operator.swift",foreground:e.euiTextSubduedColor},{token:"predefined.sql",foreground:e.euiTextSubduedColor},{token:"text",foreground:e.euiTitleColor},{token:"label",foreground:e.euiColorVis9}],colors:{"editor.foreground":e.euiColorDarkestShade,"editor.background":null!=i?i:e.euiFormBackgroundColor,"editorLineNumber.foreground":e.euiColorDarkShade,"editorLineNumber.activeForeground":e.euiColorDarkShade,"editorIndentGuide.background":e.euiColorLightShade,"editor.selectionBackground":t,"editorWidget.border":e.euiColorLightShade,"editorWidget.background":e.euiColorLightestShade,"editorCursor.foreground":e.euiColorDarkestShade,"editorSuggestWidget.selectedBackground":e.euiColorLightShade,"list.hoverBackground":e.euiColorLightShade,"list.highlightForeground":e.euiColorPrimary,"editor.lineHighlightBorder":e.euiColorLightestShade}}}const ps=ds(Ie.euiDarkVars,"#343551"),gs=ds(Ie.euiLightVars,"#E3E4ED"),bs=ds(Ie.euiDarkVars,"#343551","#00000000"),ms=ds(Ie.euiLightVars,"#E3E4ED","#00000000");var js={name:"eivff4",styles:"display:none"};const xs=({languageId:e,value:t,onChange:i,width:a,height:n,options:r,overrideEditorWillMount:l,editorDidMount:u,editorWillMount:c,useDarkTheme:d,transparentBackground:p,suggestionProvider:b,signatureProvider:m,hoverProvider:j,placeholder:x,languageConfiguration:f,"aria-label":h=I.i18n.translate("sharedUXPackages.codeEditor.ariaLabel",{defaultMessage:"Code Editor"}),isCopyable:y=!1,allowFullScreen:v=!1})=>{var O,k;const{colorMode:C,euiTheme:S}=Object(M.useEuiTheme)(),w=null!=d?d:"DARK"===C,E=Object(s.useMemo)((()=>"function"==typeof os&&"JestMockEditor"===os.name?os():os),[]),{FullScreenDisplay:F,FullScreenButton:N,isFullScreen:_,setIsFullScreen:D,onKeyDown:L}=fs({allowFullScreen:v}),z=null!==(O=null==r?void 0:r.readOnly)&&void 0!==O&&O,A=Object(s.useRef)(null),R=Object(s.useRef)(null),P=Object(s.useRef)(!1),V=Object(s.useRef)(null),G=Object(s.useRef)(null),[B,U]=Object(s.useState)(!0),W=Object(s.useCallback)((()=>{var e;null===(e=A.current)||void 0===e||e.layout()}),[]);Object(qn.useResizeDetector)({handleWidth:!0,handleHeight:!0,onResize:W,refreshMode:"debounce"});const H=Object(s.useCallback)((()=>{var e;U(!1),null===(e=A.current)||void 0===e||e.focus()}),[]),Q=Object(s.useCallback)((()=>{U(!0)}),[]),Z=Object(s.useCallback)((e=>{e.key===M.keys.ENTER&&(e.preventDefault(),H())}),[H]),Y=Object(s.useCallback)((e=>{var t;e.keyCode===Ot.monaco.KeyCode.Escape&&(P.current||(e.preventDefault(),e.stopPropagation(),Q(),null===(t=V.current)||void 0===t||t.focus()),D(!1))}),[Q,D]),J=Object(s.useCallback)((()=>{Q()}),[Q]),q=Object(s.useCallback)((()=>{const e=Object(g.jsx)("strong",null,I.i18n.translate("sharedUXPackages.codeEditor.enterKeyLabel",{defaultMessage:"Enter",description:"The name used for the Enter key on keyword. Will be {key} in sharedUXPackages.codeEditor.startEditing(ReadOnly)."})),t=Object(g.jsx)("strong",null,I.i18n.translate("sharedUXPackages.codeEditor.escapeKeyLabel",{defaultMessage:"Esc",description:"The label of the Escape key as printed on the keyboard. Will be {key} inside sharedUXPackages.codeEditor.stopEditing(ReadOnly)."}));return Object(g.jsx)(M.EuiToolTip,{display:"block",content:Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)("p",null,z?Object(g.jsx)(T.FormattedMessage,{id:"sharedUXPackages.codeEditor.startEditingReadOnly",defaultMessage:"Press {key} to start interacting with the code.",values:{key:e}}):Object(g.jsx)(T.FormattedMessage,{id:"sharedUXPackages.codeEditor.startEditing",defaultMessage:"Press {key} to start editing.",values:{key:e}})),Object(g.jsx)("p",null,z?Object(g.jsx)(T.FormattedMessage,{id:"sharedUXPackages.codeEditor.stopEditingReadOnly",defaultMessage:"Press {key} to stop interacting with the code.",values:{key:t}}):Object(g.jsx)(T.FormattedMessage,{id:"sharedUXPackages.codeEditor.stopEditing",defaultMessage:"Press {key} to stop editing.",values:{key:t}})))},Object(g.jsx)("div",{css:[cs.keyboardHint(S),!B&&js,"",""],id:Object(M.htmlIdGenerator)("codeEditor")(),ref:V,tabIndex:0,role:"button",onClick:H,onKeyDown:Z,"aria-label":h,"data-test-subj":"codeEditorHint codeEditorHint--"+(B?"active":"inactive")}))}),[B,z,S,H,Z,h]),K=Object(s.useCallback)((t=>{if(t!==Ot.monaco)throw new Error("react-monaco-editor is using a different version of monaco");l?l():(null==c||c(),Ot.monaco.languages.onLanguage(e,(()=>{b&&Ot.monaco.languages.registerCompletionItemProvider(e,b),m&&Ot.monaco.languages.registerSignatureHelpProvider(e,m),j&&Ot.monaco.languages.registerHoverProvider(e,j),f&&Ot.monaco.languages.setLanguageConfiguration(e,f)})),Ot.monaco.editor.defineTheme("euiColors",w?ps:gs),Ot.monaco.editor.defineTheme("euiColorsTransparent",w?bs:ms))}),[l,c,e,w,b,m,j,f]),$=Object(s.useCallback)(((e,t)=>{var i,a,n;if(t!==Ot.monaco)throw new Error("react-monaco-editor is using a different version of monaco");"fonts"in window.document&&"ready"in window.document.fonts&&window.document.fonts.ready.then((()=>{Ot.monaco.editor.remeasureFonts()})).catch((e=>{console.warn("Failed to remeasureFonts in <CodeEditor/>"),console.warn(e)})),A.current=e;const s=null===(i=e.getDomNode())||void 0===i?void 0:i.getElementsByTagName("textarea")[0];s&&(s.tabIndex=-1,G.current=new MutationObserver((function(){s.tabIndex>=0&&(s.tabIndex=-1)})),G.current.observe(s,{attributes:!0})),e.onKeyDown(Y),e.onDidBlurEditorText(J);const o=null===(a=e.getContribution("editor.contrib.suggestController"))||void 0===a||null===(n=a.widget)||void 0===n?void 0:n.value;o&&o.onDidShow&&o.onDidHide&&(o.onDidShow((()=>{P.current=!0})),o.onDidHide((()=>{P.current=!1}))),null==u||u(e)}),[u,J,Y]);Object(s.useEffect)((()=>()=>{var e;null===(e=G.current)||void 0===e||e.disconnect()}),[]),Object(s.useEffect)((()=>(x&&!t&&A.current&&(R.current=new placeholder_widget_PlaceholderWidget(x,S,A.current)),()=>{var e;null===(e=R.current)||void 0===e||e.dispose(),R.current=null})),[x,t,S]);const{CopyButton:X}=hs({isCopyable:y,value:t});Object(s.useEffect)((()=>{Ot.monaco.editor.defineTheme("euiColors",w?ps:gs),Ot.monaco.editor.defineTheme("euiColorsTransparent",w?bs:ms)}),[w]);const ee=null!==(k=null==r?void 0:r.theme)&&void 0!==k?k:p?"euiColorsTransparent":"euiColors";return Object(g.jsx)("div",{css:cs.container,onKeyDown:L,"data-test-subj":"kibanaCodeEditor",className:"kibanaCodeEditor"},q(),Object(g.jsx)(F,null,v||y?Object(g.jsx)("div",{css:_?[cs.controls.base(S),cs.controls.fullscreen(S)]:cs.controls.base(S)},Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"xs"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(X,null)),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(N,null)))):null,Object(g.jsx)(E,{theme:ee,language:e,value:t,onChange:i,width:_?"100vw":a,height:_?"100vh":n,editorWillMount:K,editorDidMount:$,options:{padding:v||y?{top:24}:{},renderLineHighlight:"none",scrollBeyondLastLine:!1,minimap:{enabled:!1},scrollbar:{useShadows:!1,alwaysConsumeMouseWheel:!1},wordBasedSuggestions:!1,wordWrap:"on",wrappingIndent:"indent",matchBrackets:"never",fontFamily:"Roboto Mono",fontSize:_?16:12,lineHeight:_?24:21,...r}})))},fs=({allowFullScreen:e})=>{const[t,i]=Object(s.useState)(!1),a=()=>{i(!t)},n=Object(s.useCallback)((e=>{e.key===M.keys.ESCAPE&&(e.preventDefault(),e.stopPropagation(),i(!1))}),[]);return{FullScreenButton:()=>e?Object(g.jsx)(M.EuiI18n,{tokens:["euiCodeBlock.fullscreenCollapse","euiCodeBlock.fullscreenExpand"],defaults:["Collapse","Expand"]},(([e,i])=>Object(g.jsx)(M.EuiButtonIcon,{onClick:a,iconType:t?"fullScreenExit":"fullScreen",color:"text","aria-label":t?e:i,size:"xs"}))):null,FullScreenDisplay:Object(s.useMemo)((()=>({children:e})=>t?Object(g.jsx)(M.EuiOverlayMask,null,Object(g.jsx)(M.EuiFocusTrap,{clickOutsideDisables:!0},Object(g.jsx)("div",{css:cs.fullscreenContainer},e))):Object(g.jsx)(o.a.Fragment,null,e)),[t]),onKeyDown:n,isFullScreen:t,setIsFullScreen:i}},hs=({isCopyable:e,value:t})=>{const i=e&&t;return{showCopyButton:i,CopyButton:()=>i?Object(g.jsx)("div",{className:"euiCodeBlock__copyButton"},Object(g.jsx)(M.EuiI18n,{token:"euiCodeBlock.copyButton",default:"Copy"},(e=>Object(g.jsx)(M.EuiCopy,{textToCopy:t},(t=>Object(g.jsx)(M.EuiButtonIcon,{onClick:t,iconType:"copyClipboard",color:"text","aria-label":e,size:"xs"})))))):null}},ys=I.i18n.translate("unifiedDataTable.json.codeEditorAriaLabel",{defaultMessage:"Read only JSON view of an elasticsearch document"}),vs=I.i18n.translate("unifiedDataTable.json.copyToClipboardLabel",{defaultMessage:"Copy to clipboard"}),Os=({jsonValue:e,width:t,height:i,hasLineNumbers:a,onEditorDidMount:n,hideCopyButton:s})=>{if(""===e)return null;const o=Object(g.jsx)(xs,{languageId:Ot.XJsonLang.ID,width:t,height:i,value:e||"",editorDidMount:n,"aria-label":ys,options:{automaticLayout:!0,fontSize:12,lineNumbers:a?"on":"off",minimap:{enabled:!1},overviewRulerBorder:!1,readOnly:!0,scrollbar:{alwaysConsumeMouseWheel:!1},scrollBeyondLastLine:!1,wordWrap:"on",wrappingIndent:"indent"}});return s?o:Object(g.jsx)(M.EuiFlexGroup,{className:"unifiedDataTableJsonEditor",direction:"column",gutterSize:"s"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiSpacer,{size:"s"}),Object(g.jsx)("div",{className:"eui-textRight"},Object(g.jsx)(M.EuiCopy,{textToCopy:e},(e=>Object(g.jsx)(M.EuiButtonEmpty,{size:"xs",flush:"right",iconType:"copyClipboard",onClick:e},vs))))),Object(g.jsx)(M.EuiFlexItem,null,o))};function ks({json:e,width:t,height:i,hasLineNumbers:a}){const n=JSON.stringify(e,null,2);return Object(g.jsx)(Os,{jsonValue:n,width:t,height:i,hasLineNumbers:a,onEditorDidMount:()=>{},hideCopyButton:!0})}const Ms="unifiedDataTable__cellValue";function Ts(e,t){return Object.fromEntries(Object.entries(e).filter((([e])=>e.startsWith(`${t}.`))))}function Cs(e,t,i){return i?Ts(t.raw.fields,e):t.raw}const Ss=I.i18n.translate("unifiedDataTable.copyEscapedValueWithFormulasToClipboardWarningText",{defaultMessage:"Values may contain formulas that are escaped."}),ws=I.i18n.translate("unifiedDataTable.copyFailedErrorText",{defaultMessage:"Unable to copy to clipboard in this browser"}),Es=({rowIndex:e,columnId:t,toastNotifications:i,valueToStringConverter:a})=>{const n=a(e,t),s=n.formattedString;if(!Object(M.copyToClipboard)(s))return i.addWarning({title:ws}),null;const o=I.i18n.translate("unifiedDataTable.copyValueToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return n.withFormula?i.addWarning({title:o,text:Ss}):i.addInfo({title:o}),s},Is=async({columnId:e,columnDisplayName:t,toastNotifications:i,valueToStringConverter:a,rowsCount:n})=>{const s={formattedString:Gn(o=t),withFormula:Object(An.cellHasFormulas)(o)};var o;let r=s.withFormula;const l=[...Array(n)].map(((t,i)=>{const n=a(i,e,{compatibleWithCSV:!0});return r=r||n.withFormula,n.formattedString})),u=`${s.formattedString}\n${l.join("\n")}`;let c;try{var d,p;await(null===(d=window.navigator)||void 0===d||null===(p=d.clipboard)||void 0===p?void 0:p.writeText(u)),c=!0}catch(e){c=Object(M.copyToClipboard)(u)}if(!c)return i.addWarning({title:ws}),null;const g=I.i18n.translate("unifiedDataTable.copyColumnValuesToClipboard.toastTitle",{defaultMessage:'Values of "{column}" column copied to clipboard',values:{column:t}});return r?i.addWarning({title:g,text:Ss}):i.addInfo({title:g}),u},Fs=({columnDisplayName:e,toastNotifications:t})=>{if(!Object(M.copyToClipboard)(e))return t.addWarning({title:ws}),null;const i=I.i18n.translate("unifiedDataTable.copyColumnNameToClipboard.toastTitle",{defaultMessage:"Copied to clipboard"});return t.addInfo({title:i}),e};function Ns(e,t,i,a){const n=e.rows[t].flattened[i],s=e.dataView.fields.getByName(i);s&&e.onFilter&&e.onFilter(s,n,a)}const _s=({Component:e,rowIndex:t,columnId:i})=>{const a=Object(s.useContext)(Jn),n=I.i18n.translate("unifiedDataTable.grid.filterForAria",{defaultMessage:"Filter for this {value}",values:{value:i}});return Object(g.jsx)(e,{onClick:()=>{Ns(a,t,i,"+")},iconType:"plusInCircle","aria-label":n,title:n,"data-test-subj":"filterForButton"},I.i18n.translate("unifiedDataTable.grid.filterFor",{defaultMessage:"Filter for"}))},Ds=({Component:e,rowIndex:t,columnId:i})=>{const a=Object(s.useContext)(Jn),n=I.i18n.translate("unifiedDataTable.grid.filterOutAria",{defaultMessage:"Filter out this {value}",values:{value:i}});return Object(g.jsx)(e,{onClick:()=>{Ns(a,t,i,"-")},iconType:"minusInCircle","aria-label":n,title:n,"data-test-subj":"filterOutButton"},I.i18n.translate("unifiedDataTable.grid.filterOut",{defaultMessage:"Filter out"}))};function Ls(e){switch(e){case yn.b.IP:case yn.b.GEO_SHAPE:case yn.b.NUMBER:return"numeric";case yn.b.BOOLEAN:return"boolean";case yn.b.STRING:return"string";case yn.b.DATE:return"datetime";default:return Wn}}function zs({isFilterActive:e,rows:t,selectedDocs:i,setIsFilterActive:a,setSelectedDocs:n}){const[o,r]=Object(s.useState)(!1),l=Object(s.useCallback)((()=>[e?Object(g.jsx)(M.EuiContextMenuItem,{"data-test-subj":"dscGridShowAllDocuments",key:"showAllDocuments",icon:"eye",onClick:()=>{r(!1),a(!1)}},Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.showAllDocuments",defaultMessage:"Show all documents"})):Object(g.jsx)(M.EuiContextMenuItem,{"data-test-subj":"dscGridShowSelectedDocuments",key:"showSelectedDocuments",icon:"eye",onClick:()=>{r(!1),a(!0)}},Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.showSelectedDocumentsOnly",defaultMessage:"Show selected documents only"})),Object(g.jsx)(M.EuiCopy,{key:"copyJsonWrapper","data-test-subj":"dscGridCopySelectedDocumentsJSON",textToCopy:t?JSON.stringify(t.filter((e=>i.includes(e.id))).map((e=>e.raw))):""},(e=>Object(g.jsx)(M.EuiContextMenuItem,{key:"copyJSON",icon:"copyClipboard",onClick:e},Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.copyToClipboardJSON",defaultMessage:"Copy documents to clipboard (JSON)"})))),Object(g.jsx)(M.EuiContextMenuItem,{"data-test-subj":"dscGridClearSelectedDocuments",key:"clearSelection",icon:"cross",onClick:()=>{r(!1),n([]),a(!1)}},Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.clearSelection",defaultMessage:"Clear selection"}))]),[e,t,i,a,r,n]),u=Object(s.useCallback)((()=>r((e=>!e))),[]);return Object(g.jsx)(M.EuiPopover,{closePopover:()=>r(!1),isOpen:o,panelPaddingSize:"none",button:Object(g.jsx)(M.EuiButtonEmpty,{size:"xs",color:"text",iconType:"documents",onClick:u,"data-selected-documents":i.length,"data-test-subj":"dscGridSelectionBtn",isSelected:e,className:qa()({euiDataGrid__controlBtn:!0,"euiDataGrid__controlBtn--active":e})},Object(g.jsx)(M.EuiFlexGroup,{responsive:!1,direction:"row",alignItems:"center",gutterSize:"s"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.selectedRowsButtonLabel",defaultMessage:"Selected",description:"Selected documents"})),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiNotificationBadge,{color:"subdued"},i.length))))},o&&Object(g.jsx)(M.EuiContextMenuPanel,{items:l()}))}function As({label:e,onCopy:t,dataTestSubj:i}){return{size:"xs",label:e,iconType:"copyClipboard",iconProps:{size:"m"},onClick:t,"data-test-subj":i}}function Rs({columnDisplayName:e,toastNotifications:t}){return As({label:Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnNameToClipBoardButton",defaultMessage:"Copy name"}),onCopy:()=>Fs({columnDisplayName:e,toastNotifications:t}),dataTestSubj:"gridCopyColumnNameToClipBoardButton"})}function Ps({columnId:e,columnDisplayName:t,toastNotifications:i,rowsCount:a,valueToStringConverter:n}){return As({label:Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.grid.copyColumnValuesToClipBoardButton",defaultMessage:"Copy column"}),onCopy:()=>Is({columnId:e,columnDisplayName:t,toastNotifications:i,rowsCount:a,valueToStringConverter:n}),dataTestSubj:"gridCopyColumnValuesToClipBoardButton"})}const Vs=({hasEditDataViewPermission:e,dataView:t,field:i,editField:a})=>{if("_source"===i.name)return null;const{canEdit:n}=((e,t)=>{var i;const a=Boolean(null===(i=e.getFieldByName(t.name))||void 0===i?void 0:i.runtimeField);return{canEdit:!("unknown"===t.type||"unknown_selected"===t.type)||a,canDelete:a}})(t,i),s=e()||!t.isPersisted();return n&&s?{size:"xs",label:Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.grid.editFieldButton",defaultMessage:"Edit data view field"}),iconType:"pencil",iconProps:{size:"m"},onClick:()=>{a(i.name)},"data-test-subj":"gridEditFieldButton"}:null},Gs=()=>Object(g.jsx)(s.Fragment,null),Bs=o.a.lazy((()=>i.e(3).then(i.bind(null,164)))),Us=function(e){return Object(g.jsx)(o.a.Suspense,{fallback:Object(g.jsx)(Gs,null)},Object(g.jsx)(Bs,e))};var Ws=i(87);function Hs(e,t){var i;const a=t?t(e):function(e){var t;return e.timeSeriesMetric||(null!==(t=e.type)&&void 0!==t?t:"string")}(e),n=(null===(i=e.esTypes)||void 0===i?void 0:i[0])||null;return n&&["_id","_index"].includes(n)&&"string"===a?"keyword":"unknown"===a&&n&&Object(Ws.b)(n)||"string"===a&&n?n:a}var Qs={name:"16blt2w",styles:".euiDataGridHeaderCell--numeric &{justify-content:flex-end;}"};const Zs=e=>{const{columnDisplayName:t,columnName:i,columnTypes:a,dataView:n}=e,o=Object(s.useMemo)((()=>function({dataView:e,columnName:t,columnTypes:i}){if(!t||"_source"===t)return null;if(i)return i[t]&&"unknown"!==i[t]?Object(g.jsx)(Us,{type:i[t]}):null;const a=e.getFieldByName(t);return a?Object(g.jsx)(Us,{type:Hs(n=a),scripted:n.scripted}):function(e,t){const i=new RegExp(Object(tn.escapeRegExp)(e)+"(\\.|$)");return!t.fields.getByName(e)&&!!t.fields.getAll().find((e=>{var t;const a=Object(me.getDataViewFieldSubtypeNested)(e);return!!a&&i.test(null!==(t=null==a?void 0:a.nested.path)&&void 0!==t?t:"")}))}(t,e)?Object(g.jsx)(Us,{type:"nested"}):null;var n}({columnName:i,columnTypes:a,dataView:n})),[i,a,n]);return Object(g.jsx)(M.EuiFlexGroup,{direction:"row",wrap:!1,responsive:!1,alignItems:"center",gutterSize:"xs",css:Qs},o&&Object(g.jsx)(M.EuiFlexItem,{grow:!1},o),Object(g.jsx)(M.EuiFlexItem,{grow:!1,className:"eui-displayInline eui-textTruncate","data-test-subj":"unifiedDataTableColumnTitle"},t))},Ys=o.a.memo(Zs),Js={id:"openDetails",width:26,headerCellRender:()=>Object(g.jsx)(M.EuiScreenReaderOnly,null,Object(g.jsx)("span",null,I.i18n.translate("unifiedDataTable.controlColumnHeader",{defaultMessage:"Control column"}))),rowCellRender:({rowIndex:e,setCellProps:t})=>{const i=Object(s.useRef)(null),[a,n]=Object(s.useState)(!1),{expanded:o,setExpanded:r,rows:l,isDarkMode:u,componentsTourSteps:c}=Object(s.useContext)(Jn),d=l[e],p=c?c.expandButton:void 0;Object(s.useEffect)((()=>{d.isAnchor?t({className:"dscDocsGrid__cell--highlight"}):o&&d&&o.id===d.id?t({style:{backgroundColor:u?Ie.euiDarkVars.euiColorHighlight:Ie.euiLightVars.euiColorHighlight}}):t({style:void 0})}),[o,d,t,u]);const b=d===o,m=I.i18n.translate("unifiedDataTable.grid.viewDoc",{defaultMessage:"Toggle dialog with details"}),j=d.isAnchor?"docTableExpandToggleColumnAnchor":"docTableExpandToggleColumn";return Object(s.useEffect)((()=>{!b&&a&&(n(!1),setTimeout((()=>{var e;null===(e=i.current)||void 0===e||e.hideToolTip()}),100))}),[b,n,a]),r?Object(g.jsx)("div",{className:"unifiedDataTable__rowControl"},Object(g.jsx)(M.EuiToolTip,{content:m,delay:"long",ref:i},Object(g.jsx)(M.EuiButtonIcon,{id:0===e?p:void 0,size:"xs",iconSize:"s","aria-label":m,"data-test-subj":j,onClick:()=>{var e;const t=b?void 0:d;null===(e=i.current)||void 0===e||e.hideToolTip(),n(Boolean(t)),null==r||r(t)},color:b?"primary":"text",iconType:b?"minimize":"expand",isSelected:b}))):null}},qs={id:"select",width:24,rowCellRender:({rowIndex:e,setCellProps:t})=>{const{euiTheme:i}=Object(M.useEuiTheme)(),{selectedDocs:a,expanded:n,rows:o,isDarkMode:r,setSelectedDocs:l}=Object(s.useContext)(Jn),u=Object(s.useMemo)((()=>o[e]),[o,e]),c=Object(s.useMemo)((()=>a.includes(u.id)),[a,u.id]),d=I.i18n.translate("unifiedDataTable.grid.selectDoc",{defaultMessage:"Select document '{rowNumber}'",values:{rowNumber:e+1}});return Object(s.useEffect)((()=>{n&&u&&n.id===u.id?t({style:{backgroundColor:r?Ie.euiDarkVars.euiColorHighlight:Ie.euiLightVars.euiColorHighlight}}):t({style:void 0})}),[n,u,t,r]),Object(g.jsx)(M.EuiFlexGroup,{responsive:!1,direction:"column",justifyContent:"center",className:"unifiedDataTable__rowControl",css:Object(g.css)("padding-block:",i.size.xs,";padding-left:",i.size.xs,";","")},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiCheckbox,{id:u.id,"aria-label":d,checked:c,"data-test-subj":`dscGridSelectDoc-${u.id}`,onChange:()=>{if(c){const e=a.filter((e=>e!==u.id));l(e)}else l([...a,u.id])}})))},headerCellRender:()=>Object(g.jsx)(M.EuiScreenReaderOnly,null,Object(g.jsx)("span",null,I.i18n.translate("unifiedDataTable.selectColumnHeader",{defaultMessage:"Select column"})))};function Ks({columns:e,columnsCellActions:t,rowsCount:i,settings:a,dataView:n,defaultColumns:s,isSortEnabled:r,isPlainRecord:l,services:u,hasEditDataViewPermission:c,valueToStringConverter:d,onFilter:p,editField:b,visibleCellActions:m,columnTypes:j,showColumnTokens:x}){const f=e=>{var t,i,n;return null!==(t=null==a||null===(i=a.columns)||void 0===i||null===(n=i[e])||void 0===n?void 0:n.width)&&void 0!==t?t:0};return e.map(((e,a)=>function({columnName:e,columnWidth:t=0,dataView:i,defaultColumns:a,isSortEnabled:n,isPlainRecord:s,toastNotifications:r,hasEditDataViewPermission:l,valueToStringConverter:u,rowsCount:c,onFilter:d,editField:p,columnCellActions:b,visibleCellActions:m,columnTypes:j,showColumnTokens:x}){var f;const h=i.getFieldByName(e),y=p&&h&&Vs({hasEditDataViewPermission:l,dataView:i,field:h,editField:p}),v="_source"===e?I.i18n.translate("unifiedDataTable.grid.documentHeader",{defaultMessage:"Document"}):(null==h?void 0:h.displayName)||e;let O;O=null!=b&&b.length?b:h?function(e,t,i,a){return[...a&&e.filterable?[_s,Ds]:[],({Component:e,rowIndex:a,columnId:n})=>function({Component:e,rowIndex:t,columnId:i},a,n){const s=I.i18n.translate("unifiedDataTable.grid.copyClipboardButtonTitle",{defaultMessage:"Copy value of {column}",values:{column:i}});return Object(g.jsx)(e,{onClick:()=>{Es({rowIndex:t,columnId:i,valueToStringConverter:n,toastNotifications:a})},iconType:"copyClipboard","aria-label":s,title:s,"data-test-subj":"copyClipboardButton"},I.i18n.translate("unifiedDataTable.grid.copyCellValueButton",{defaultMessage:"Copy value"}))}({Component:e,rowIndex:a,columnId:n},t,i)]}(h,r,u,d):[];const k={id:e,schema:Ls(null!==(f=null==j?void 0:j[e])&&void 0!==f?f:null==h?void 0:h.type),isSortable:n&&(s||!0===(null==h?void 0:h.sortable)),display:x?Object(g.jsx)(Ys,{dataView:i,columnName:e,columnDisplayName:v,columnTypes:j}):void 0,displayAsText:v,actions:{showHide:!a&&e!==i.timeFieldName&&{label:I.i18n.translate("unifiedDataTable.removeColumnLabel",{defaultMessage:"Remove column"}),iconType:"cross"},showMoveLeft:!a,showMoveRight:!a,additional:[..."__source"===e?[]:[Rs({columnDisplayName:v,toastNotifications:r})],Ps({columnId:e,columnDisplayName:v,toastNotifications:r,rowsCount:c,valueToStringConverter:u}),...y?[y]:[]]},cellActions:O,visibleCellActions:m};if(k.id===i.timeFieldName){var T;const e=null!==(T=null==h?void 0:h.customLabel)&&void 0!==T?T:i.timeFieldName,t=I.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltipAriaLabel",{defaultMessage:"{timeFieldName} - this field represents the time that events occurred.",values:{timeFieldName:e}}),a=I.i18n.translate("unifiedDataTable.tableHeader.timeFieldIconTooltip",{defaultMessage:"This field represents the time that events occurred."});k.display=Object(g.jsx)("div",{"aria-label":t},Object(g.jsx)(M.EuiToolTip,{content:a},Object(g.jsx)(o.a.Fragment,null,e," ",Object(g.jsx)(M.EuiIcon,{type:"clock"})))),k.initialWidth=Un}return t>0&&(k.initialWidth=Number(t)),k}({columnName:e,columnCellActions:null==t?void 0:t[a],columnWidth:f(e),dataView:n,defaultColumns:s,isSortEnabled:r,isPlainRecord:l,toastNotifications:u.toastNotifications,hasEditDataViewPermission:c,valueToStringConverter:d,rowsCount:i,onFilter:p,editField:b,visibleCellActions:m,columnTypes:j,showColumnTokens:x})))}const $s=e=>"number"==typeof e&&!Number.isNaN(e)&&Math.floor(e)===e&&e>=-1&&e<=20,Xs=e=>`${e}:dataGridRowHeight`,eo=e=>{const{isLoadingMore:t,rowCount:i,sampleSize:a,pageIndex:o,pageCount:r,totalHits:l=0,onFetchMoreRecords:u,data:c}=e,d=c.query.timefilter.timefilter,[p,b]=Object(s.useState)(d.getRefreshInterval());Object(s.useEffect)((()=>{const e=d.getRefreshIntervalUpdate$().subscribe((()=>{b(d.getRefreshInterval())}));return()=>e.unsubscribe()}),[d,b]);const m=Boolean(p&&!1===p.pause&&p.value>0),{euiTheme:j}=Object(M.useEuiTheme)();return o===r-1&&i<l?u&&"boolean"==typeof t?i<=1e4-a?Object(g.jsx)(to,n()({hasButton:!0},e),Object(g.jsx)(M.EuiToolTip,{content:m?I.i18n.translate("unifiedDataTable.gridSampleSize.fetchMoreLinkDisabledTooltip",{defaultMessage:"To load more the refresh interval needs to be disabled first"}):void 0},Object(g.jsx)(M.EuiButtonEmpty,{disabled:m,isLoading:t,flush:"both","data-test-subj":"dscGridSampleSizeFetchMoreLink",onClick:u,css:Object(g.css)("margin-left:",j.size.xs,";","")},Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.fetchMoreLinkLabel",defaultMessage:"Load more"})))):Object(g.jsx)(to,n()({hasButton:!1},e)):i<l?Object(g.jsx)(to,n()({hasButton:!1},e)):null:null},to=({hasButton:e,rowCount:t,children:i,fieldFormats:a})=>{const{euiTheme:n}=Object(M.useEuiTheme)(),s=a.getDefaultInstance(yn.b.NUMBER,[yn.a.INTEGER]).convert(t);return Object(g.jsx)("p",{"data-test-subj":"unifiedDataTableFooter",css:Object(g.css)("display:flex;flex-direction:row;align-items:center;justify-content:center;flex-shrink:0;background-color:",n.colors.lightestShade,";padding:",e?`0 ${n.size.base}`:`${n.size.s} ${n.size.base}`,";margin-top:",n.size.xs,";text-align:center;","")},Object(g.jsx)("span",null,e?Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.lastPageDescription",defaultMessage:"Search results are limited to {rowCount} documents.",values:{rowCount:s}}):Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.gridSampleSize.limitDescription",defaultMessage:"Search results are limited to {sampleSize} documents. Add more search terms to narrow your search.",values:{sampleSize:s}})),i)},io=({maxAllowedSampleSize:e=1e3,sampleSize:t,onChangeSampleSize:i})=>{const[a,n]=Object(s.useState)(t),o=Math.max(Math.min(10,t),1),r=Object(s.useMemo)((()=>Object(x.debounce)(i,300,{leading:!1,trailing:!0})),[i]),l=Object(s.useCallback)((t=>{if(!t.target.value)return void n("");const i=Number(t.target.value);i>=1&&(n(i),i<=e&&r(i))}),[e,n,r]),u=I.i18n.translate("unifiedDataTable.sampleSizeSettings.sampleSizeLabel",{defaultMessage:"Sample size"});return Object(s.useEffect)((()=>{n(t)}),[t,n]),Object(g.jsx)(M.EuiFormRow,{label:u,display:"columnCompressed"},Object(g.jsx)(M.EuiRange,{compressed:!0,fullWidth:!0,min:o,max:e,step:10===o?10:1,showInput:!0,value:a,onChange:l,"data-test-subj":"unifiedDataTableSampleSizeInput"}))};let ao;!function(e){e.loading="loading",e.loadingMore="loadingMore",e.loaded="loaded"}(ao||(ao={}));const no={darkMode:!1},so=o.a.memo(M.EuiDataGrid),oo=["openDetails","select"],ro=({ariaLabelledBy:e,columns:t,columnTypes:i,showColumnTokens:a,controlColumnIds:n=oo,dataView:r,loadingState:l,onFilter:u,onResize:c,onSetColumns:d,onSort:p,rows:b,searchDescription:m,searchTitle:j,settings:f,showTimeCol:h,showFullScreenButton:y=!0,sort:v,useNewFieldsApi:O,isSortEnabled:k=!0,isPaginationEnabled:C=!0,cellActionsTriggerId:S,className:w,rowHeightState:E,onUpdateRowHeight:F,maxAllowedSampleSize:N,sampleSizeState:_,onUpdateSampleSize:D,isPlainRecord:L=!1,rowsPerPageState:z,onUpdateRowsPerPage:A,onFieldEdited:R,services:P,renderCustomGridBody:V,renderCustomToolbar:G,trailingControlColumns:B,totalHits:U,onFetchMoreRecords:W,renderDocumentView:H,setExpandedDoc:Q,expandedDoc:Z,configRowHeight:Y,showMultiFields:J=!0,maxDocFieldsDisplayed:q=50,externalControlColumns:K,externalAdditionalControls:$,rowsPerPageOptions:X,visibleCellActions:ee,externalCustomRenderers:te,consumer:ie="discover",componentsTourSteps:ae,gridStyleOverride:ne,rowLineHeightOverride:se})=>{var oe,re;const{fieldFormats:le,toastNotifications:ue,dataViewFieldEditor:ce,uiSettings:pe,storage:ge,data:be}=P,{darkMode:je}=$a()(null!==(oe=null===(re=P.theme)||void 0===re?void 0:re.theme$)&&void 0!==oe?oe:Object(de.of)(no),no),xe=Object(s.useRef)(null),[fe,he]=Object(s.useState)([]),[ye,ve]=Object(s.useState)(!1),Oe=function(e=[],t){return e&&e.length>0&&(1!==e.length||e[0]!==t.timeFieldName)?e:zn}(t,r),ke=Oe.includes("_source"),Me=Object(s.useMemo)((()=>{if(!fe.length||null==b||!b.length)return[];const e=b.reduce(((e,t)=>e.set(t.id,!0)),new Map),t=fe.filter((t=>!!e.get(t)));return 0===t.length&&ye&&ve(!1),t}),[fe,b,ye]),Te=Object(s.useMemo)((()=>{if(!b)return[];if(!ye||0===Me.length)return b;const e=b.filter((e=>Me.includes(e.id)));return e.length?e:b}),[b,Me,ye]),Ce=Object(s.useCallback)(((e,t,i)=>(({rowIndex:e,rows:t,columnId:i,dataView:a,fieldFormats:n,options:s})=>{var o,r;if(!t[e])return{formattedString:"",withFormula:!1};const l=t[e].flattened,u=null==l?void 0:l[i],c=a.fields.getByName(i),d=Array.isArray(u)?u:[u],p=null!==(o=null==s?void 0:s.compatibleWithCSV)&&void 0!==o&&o,g=null!==(r=null==s?void 0:s.compatibleWithCSV)&&void 0!==r&&r;if("_source"===(null==c?void 0:c.type))return{formattedString:Pn(l,p),withFormula:!1};let b=!1;return{formattedString:d.map((i=>{const s=Rn(i,t[e].raw,n,a,c,"text",{skipFormattingInStringifiedJSON:p});return"string"==typeof s?(b=b||Object(An.cellHasFormulas)(s),g?Gn(s):s):Pn(s,p)||""})).join(", "),withFormula:b}})({rowIndex:e,rows:Te,dataView:r,columnId:t,fieldFormats:le,options:i})),[Te,r,le]),Se=Object(s.useMemo)((()=>({expanded:Z,setExpanded:Q,rows:Te,onFilter:u,dataView:r,isDarkMode:je,selectedDocs:Me,setSelectedDocs:e=>{he(e),ye&&0===e.length&&ve(!1)},valueToStringConverter:Ce,componentsTourSteps:ae})),[ae,je,r,Te,Z,ye,u,Q,Me,Ce]),we="number"==typeof z&&z>0?z:100,[Ee,Fe]=Object(s.useState)({pageIndex:0,pageSize:we}),Ne=Object(s.useMemo)((()=>Te?Te.length:0),[Te]),_e=Object(s.useMemo)((()=>Math.ceil(Ne/Ee.pageSize)),[Ne,Ee]),De=Object(s.useMemo)((()=>{return C?{onChangeItemsPerPage:e=>{null==A||A(e)},onChangePage:e=>Fe((t=>({...t,pageIndex:e}))),pageIndex:Ee.pageIndex>_e-1?0:Ee.pageIndex,pageSize:Ee.pageSize,pageSizeOptions:null!=X?X:(e=Ee.pageSize,Object(x.sortBy)(Object(x.uniq)("number"==typeof e&&e>0?[...Bn,e]:Bn)))}:void 0;var e}),[C,Ee.pageIndex,Ee.pageSize,_e,X,A]);Object(s.useEffect)((()=>{Fe((e=>e.pageSize===we?e:{...e,pageSize:we}))}),[we,Fe]);const Le=Object(s.useMemo)((()=>((e,t,i)=>{if(i)return()=>!0;const a=new Map;return e.forEach((e=>{a.set(e,((e,t)=>{var i;const a=t.fields.getByName(e);if(!a)return{show:!0};const n=Object(me.getDataViewFieldSubtypeMulti)(a.spec);return{show:!Boolean(null==n?void 0:n.multi),parentName:null==n||null===(i=n.multi)||void 0===i?void 0:i.parent}})(e,t))})),e=>{const t=a.get(e);return!t||t.show||!!t.parentName&&!a.has(t.parentName)}})(r.fields.getAll().map((e=>e.name)),r,J)),[r,J]),ze=Object(s.useMemo)((()=>(({dataView:e,rows:t,useNewFieldsApi:i,shouldShowFieldHandler:a,closePopover:n,fieldFormats:r,maxEntries:l,externalCustomRenderers:u,isPlainRecord:c})=>({rowIndex:d,columnId:p,isDetails:b,setCellProps:m,colIndex:j,isExpandable:x,isExpanded:f})=>{if(u&&u[p])return Object(g.jsx)(o.a.Fragment,null,u[p]({rowIndex:d,columnId:p,isDetails:b,setCellProps:m,isExpandable:x,isExpanded:f,colIndex:j}));const h=t?t[d]:void 0,y=e.fields.getByName(p),v=Object(s.useContext)(Jn);if(Object(s.useEffect)((()=>{null!=h&&h.isAnchor?m({className:"dscDocsGrid__cell--highlight"}):v.expanded&&h&&v.expanded.id===h.id?m({style:{backgroundColor:v.isDarkMode?Ie.euiDarkVars.euiColorHighlight:Ie.euiLightVars.euiColorHighlight}}):m({style:void 0})}),[v,h,m]),void 0===h)return Object(g.jsx)("span",{className:Ms},"-");const O=Boolean(i&&!y&&(null==h?void 0:h.raw.fields)&&!h.raw.fields[p]);if(b)return function({row:e,field:t,columnId:i,dataView:a,useTopLevelObjectColumns:n,fieldFormats:s,closePopover:o}){const r=Object(g.jsx)(M.EuiButtonIcon,{"aria-label":I.i18n.translate("unifiedDataTable.grid.closePopover",{defaultMessage:"Close popover"}),"data-test-subj":"docTableClosePopover",iconSize:"s",iconType:"cross",size:"xs",onClick:o});return n||"_source"===(null==t?void 0:t.type)?Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"none",direction:"column",justifyContent:"flexEnd",className:"unifiedDataTable__cellPopover"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none",responsive:!1},Object(g.jsx)(M.EuiFlexItem,{grow:!1},r))),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(ks,{json:Cs(i,e,n),width:370,height:200}))):Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"none",direction:"row",responsive:!1},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)("span",{className:"unifiedDataTable__cellPopoverValue eui-textBreakWord",dangerouslySetInnerHTML:{__html:Rn(e.flattened[i],e.raw,s,a,t)}})),Object(g.jsx)(M.EuiFlexItem,{grow:!1},r))}({row:h,field:y,columnId:p,dataView:e,useTopLevelObjectColumns:O,fieldFormats:r,closePopover:n});if("_source"===(null==y?void 0:y.type)||O){const t=O?function(e,t,i,a){var n;const s=Ts(e.fields,t),o=null!==(n=e.highlight)&&void 0!==n?n:{},r=[],l=[];return Object.entries(s).forEach((([t,n])=>{var s;const u=i.getFieldByName(t),c=i.fields.getByName?null===(s=i.fields.getByName(t))||void 0===s?void 0:s.displayName:void 0,d=u?i.getFormatterForField(u):{convert:(e,...t)=>String(e)},p=n.map((t=>d.convert(t,"html",{field:u,hit:e}))).join(", "),g=o[t]?r:l;c?a(c)&&g.push([c,p,t]):g.push([t,p,t])})),[...r,...l]}(h.raw,p,e,a).slice(0,l):function(e,t,i,a,n){var s;const o=Zn.get(e.raw);if(o&&o.maxEntries===a)return o.formattedHit;const r=null!==(s=e.raw.highlight)&&void 0!==s?s:{},l=e.flattened,u=[],c=[];Object.entries(l).forEach((([a,s])=>{const o=t.fields.getByName(a),l=null==o?void 0:o.displayName,d=r[a]?u:c,p=Rn(s,e.raw,n,t,o);l?i(a)&&d.push([l,p,a]):d.push([a,p,a])}));const d=[...u,...c],p=d.length<=a?d:[...d.slice(0,a),[I.i18n.translate("discover.formatHit.moreFields",{defaultMessage:"and {count} more {count, plural, one {field} other {fields}}",values:{count:d.length-a}}),"",null]];return Zn.set(e.raw,{formattedHit:p,maxEntries:a}),p}(h,e,a,l,r);return Object(g.jsx)(M.EuiDescriptionList,{type:"inline",compressed:!0,className:qa()("unifiedDataTable__descriptionList",Ms)},t.map((([e,t,i])=>c&&i&&null===h.flattened[i]?null:Object(g.jsx)(s.Fragment,{key:e},Object(g.jsx)(M.EuiDescriptionListTitle,{className:"unifiedDataTable__descriptionListTitle"},e),Object(g.jsx)(M.EuiDescriptionListDescription,{className:"unifiedDataTable__descriptionListDescription",dangerouslySetInnerHTML:{__html:t}})))))}return Object(g.jsx)("span",{className:Ms,dangerouslySetInnerHTML:{__html:Rn(h.flattened[p],h.raw,r,e,y)}})})({dataView:r,rows:Te,useNewFieldsApi:O,shouldShowFieldHandler:Le,closePopover:()=>{var e;return null===(e=xe.current)||void 0===e?void 0:e.closeCellPopover()},fieldFormats:P.fieldFormats,maxEntries:q,externalCustomRenderers:te,isPlainRecord:L})),[r,Te,O,Le,q,P.fieldFormats,te,L]),Ae=Object(s.useMemo)((()=>Object(M.htmlIdGenerator)()()),[]),Re=Object(s.useRef)();Object(s.useEffect)((()=>()=>{null!=Re&&Re.current&&(null==Re||Re.current())}),[]);const Pe=Object(s.useMemo)((()=>R?e=>{Re.current=P.dataViewFieldEditor.openEditor({ctx:{dataView:r},fieldName:e,onSave:async()=>{await R()}})}:void 0),[r,R,P.dataViewFieldEditor]),Ve=Object(s.useMemo)((()=>function(e,t,i,a,n){const s=t.timeFieldName;return n&&e.includes("_source")&&s&&i?s in i:a}(Oe,r,i,h,L)),[r,Oe,L,h,i]),Ge=Object(s.useMemo)((()=>function(e,t,i){const a=t.timeFieldName;return i&&a&&!e.find((e=>e===a))?[a,...e]:e}(Oe,r,Ve)),[r,Oe,Ve]),Be=Object(s.useCallback)(((e,t)=>Te[t%Te.length].flattened[e]),[Te]),Ue=Object(s.useMemo)((()=>S&&!L?Ge.map((e=>{var t,i;return null!==(t=null===(i=r.getFieldByName(e))||void 0===i?void 0:i.toSpec())&&void 0!==t?t:{name:"",type:"",aggregatable:!1,searchable:!1}})):void 0),[S,L,Ge,r]),We=un({fields:Ue,getCellValue:Be,triggerId:S,dataGridRef:xe}),He=Object(s.useMemo)((()=>Ks({columns:Ge,columnsCellActions:We,rowsCount:Te.length,settings:f,dataView:r,defaultColumns:ke,isSortEnabled:k,isPlainRecord:L,services:{uiSettings:pe,toastNotifications:ue},hasEditDataViewPermission:()=>ce.userPermissions.editIndexPattern(),valueToStringConverter:Ce,onFilter:u,editField:Pe,visibleCellActions:ee,columnTypes:i,showColumnTokens:a})),[u,Ge,We,Te,r,f,ke,k,L,pe,ue,ce,Ce,Pe,ee,i,a]),Qe=Object(s.useMemo)((()=>P.uiSettings.get("doc_table:hideTimeColumn",!1)),[P.uiSettings]),Ze=Object(s.useMemo)((()=>[{type:Wn,detector:()=>0,sortTextAsc:"",sortTextDesc:"",icon:"",color:""}]),[]),Ye=Object(s.useMemo)((()=>({visibleColumns:Ge,setVisibleColumns:e=>{d(e,Qe)}})),[Ge,Qe,d]),Je=Object(s.useMemo)((()=>v.map((([e,t])=>({id:e,direction:t}))).filter((({id:e})=>Ge.includes(e)))),[v,Ge]),[qe,Ke]=Object(s.useState)([]),$e=Object(s.useCallback)((e=>{k&&(L?Ke(e):p&&p(e.map((({id:e,direction:t})=>[e,t]))))}),[p,k,L,Ke]),Xe=Object(s.useMemo)((()=>k?{columns:L?qe:Je,onSort:$e}:{columns:Je,onSort:()=>{}}),[k,Je,L,qe,$e]),et=Boolean(Q&&!!H),tt=Object(s.useMemo)((()=>{const e=function(e){return e?[Js,qs]:[qs]}(et).filter((({id:e})=>n.includes(e)));return K?[...e,...K]:e}),[et,K,n]),it=Object(s.useMemo)((()=>$||Me.length?Object(g.jsx)(o.a.Fragment,null,Me.length?Object(g.jsx)(zs,{isFilterActive:ye,rows:b,selectedDocs:Me,setSelectedDocs:he,setIsFilterActive:ve}):null,$):null),[Me,ye,b,$]),at=Object(s.useMemo)((()=>G?e=>G({toolbarProps:e,gridProps:{additionalControls:it}}):void 0),[G,it]),nt=Object(s.useMemo)((()=>{const e={};return F&&(e.allowDensity=!1,e.allowRowHeight=!0),D&&(e.allowResetButton=!1,e.additionalDisplaySettings=Object(g.jsx)(io,{maxAllowedSampleSize:N,sampleSize:_,onChangeSampleSize:D})),Object.keys(e).length?e:void 0}),[N,_,F,D]),st=Object(s.useMemo)((()=>L&&t.length?{level:"sorting"}:void 0),[t.length,L]),ot=Object(s.useMemo)((()=>ke?{...Qn,showColumnSelector:!1,showSortSelector:k,additionalControls:it,showDisplaySelector:nt,showFullScreenSelector:y}:{...Qn,showSortSelector:k,additionalControls:it,showDisplaySelector:nt,showFullScreenSelector:y}),[ke,k,it,nt,y]),rt=(({rowHeightState:e,onUpdateRowHeight:t,storage:i,configRowHeight:a=3,consumer:n,rowLineHeight:o="1.6em"})=>Object(s.useMemo)((()=>{const s=((e,t)=>{const i=e.get(Xs(t));return"object"==typeof i&&null!==i&&$s(i.previousRowHeight)&&$s(i.previousConfigRowHeight)?i:null})(i,n);let r;var l;r=$s(e)?e:null!==(l=s)&&a===l.previousConfigRowHeight?s.previousRowHeight:a;const u=-1===(c=r)?"auto":0!==c?{lineCount:c}:void 0;var c;return{defaultHeight:u,lineHeight:o,onChange:({defaultHeight:s})=>{if(s===u&&void 0===e)return;const o=(e=>"auto"===e||-1===e?-1:"object"==typeof e&&e.lineCount?e.lineCount:"number"==typeof e?e:0)(s===u?a:s);((e,t,i,a)=>{i.set(Xs(a),{previousRowHeight:e,previousConfigRowHeight:t})})(o,a,i,n),null==t||t(o)}}}),[i,n,e,o,a,t]))({rowHeightState:E,onUpdateRowHeight:F,storage:ge,configRowHeight:Y,consumer:ie,rowLineHeight:se}),lt=l!==ao.loading;return Ne||l!==ao.loading?Ne?Object(g.jsx)(Jn.Provider,{value:Se},Object(g.jsx)("span",{className:"unifiedDataTable__inner"},Object(g.jsx)("div",{"data-test-subj":"discoverDocTable","data-render-complete":lt,"data-shared-item":"","data-title":j,"data-description":m,"data-document-number":Te.length,className:qa()(w,"unifiedDataTable__table")},Object(g.jsx)(so,{"aria-describedby":Ae,"aria-labelledby":e,columns:He,columnVisibility:Ye,"data-test-subj":"docTable",leadingControlColumns:tt,onColumnResize:c,pagination:De,renderCellValue:ze,ref:xe,rowCount:Ne,schemaDetectors:Ze,sorting:Xe,toolbarVisibility:ot,rowHeightsOptions:rt,inMemory:st,gridStyle:null!=ne?ne:Hn,renderCustomGridBody:V,renderCustomToolbar:at,trailingControlColumns:B})),l!==ao.loading&&!Me.length&&C&&Object(g.jsx)(eo,{isLoadingMore:l===ao.loadingMore,rowCount:Ne,sampleSize:_,pageCount:_e,pageIndex:null==De?void 0:De.pageIndex,totalHits:U,onFetchMoreRecords:W,data:be,fieldFormats:le}),j&&Object(g.jsx)(M.EuiScreenReaderOnly,null,Object(g.jsx)("p",{id:String(Ae)},m?Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescriptionGrid",defaultMessage:"Table generated by search {searchTitle} ({searchDescription})",values:{searchTitle:j,searchDescription:m}}):Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.searchGenerationWithDescription",defaultMessage:"Table generated by search {searchTitle}",values:{searchTitle:j}}))),et&&Z&&H(Z,Te,Oe,i))):Object(g.jsx)("div",{className:"euiDataGrid__noResults","data-render-complete":lt,"data-shared-item":"","data-title":j,"data-description":m,"data-document-number":0},Object(g.jsx)(M.EuiText,{size:"xs",color:"subdued"},Object(g.jsx)(M.EuiIcon,{type:"discoverApp",size:"m",color:"subdued"}),Object(g.jsx)(M.EuiSpacer,{size:"s"}),Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.noResultsFound",defaultMessage:"No results found"}))):Object(g.jsx)("div",{className:"euiDataGrid__loading","data-test-subj":"unifiedDataTableLoading"},Object(g.jsx)(M.EuiText,{size:"xs",color:"subdued"},Object(g.jsx)(M.EuiLoadingSpinner,null),Object(g.jsx)(M.EuiSpacer,{size:"s"}),Object(g.jsx)(T.FormattedMessage,{id:"unifiedDataTable.loadingResults",defaultMessage:"Loading results"})))};var lo=i(46);const uo=()=>{const{euiTheme:e}=Object(M.useEuiTheme)(),t=Object(us.css)({name:"v92fmm",styles:"min-height:400px"});return{gridStyle:Object(us.css)("& .euiDataGridHeaderCell__icon{display:none;}& .euiDataGrid__controls{border-bottom:none;margin-bottom:",e.size.s,";border-top:none;}& .euiDataGrid--headerUnderline .euiDataGridHeaderCell{border-bottom:",e.border.width.thick," solid ",e.colors.fullShade,";}& .euiDataGridRowCell__contentByHeight+.euiDataGridRowCell__expandActions{padding:0;}& .euiButtonIcon[data-test-subj='docTableExpandToggleColumn']{color:",e.colors.primary,";}& .euiDataGridRowCell{font-size:",e.size.m,";}& .euiDataGridRowCell__expandFlex{align-items:center;}& .euiDataGridRowCell.euiDataGridRowCell--numeric{text-align:left;}& .euiDataGrid__controls{gap:",e.size.s,";}& .euiDataGrid__leftControls{display:flex;align-items:center;width:100%;}& .cspDataTableTotal{font-size:",e.size.m,";font-weight:",e.font.weight.bold,";border-right:",e.border.thin,";margin-right:",e.size.s,";padding-right:",e.size.m,";}& .euiDataGrid__rightControls{display:none;}& [data-test-subj='docTableExpandToggleColumn'] svg{inline-size:16px;block-size:16px;}& .unifiedDataTable__cellValue{font-family:",e.font.family,";}",""),groupBySelector:Object(us.css)({name:"1o3nkn",styles:"margin-left:auto"}),gridContainer:t}},co={sort:{field:"name",direction:"asc"}},po=({title:e,dataView:t,columns:i,onAddColumn:a,onRemoveColumn:n})=>{const o=Object(s.useMemo)((()=>t.fields.getAll().filter((e=>"@timestamp"!==e.name&&"_index"!==e.name&&e.visualizable)).map((e=>({id:e.name,name:e.name,displayName:e.customLabel||""})))),[t.fields]),[r,l]=Object(s.useState)(o);let u;const[c,d]=Object(s.useState)(i),p=[{field:"action",name:"",width:"24px",sortable:!1,render:(e,{id:t})=>Object(g.jsx)(M.EuiCheckbox,{checked:c.includes(t),id:t,onChange:e=>{const i=e.target.checked;return d(i?[...c,t]:c.filter((e=>e!==t))),i?a(t):n(t)}})},{field:"name",name:I.i18n.translate("xpack.csp.dataTable.fieldsModalName",{defaultMessage:"Name"}),sortable:!0},{field:"displayName",name:I.i18n.translate("xpack.csp.dataTable.fieldsModalCustomLabel",{defaultMessage:"Custom Label"}),sortable:e=>e.displayName.toLowerCase()}],b=Object(s.useMemo)((()=>t&&0!==t.fields.length?"":I.i18n.translate("xpack.csp.dataTable.fieldsModalError",{defaultMessage:"No fields found in the data view"})),[t]),m={onChange:({query:e})=>{clearTimeout(u),u=setTimeout((()=>{const t=o.filter((t=>{const i=`${t.name} ${t.displayName}`.toLowerCase(),a=(null==e?void 0:e.text.toLowerCase())||"";return-1!==i.indexOf(a)}));l(t)}),300)},box:{incremental:!0,placeholder:I.i18n.translate("xpack.csp.dataTable.fieldsModalSearch",{defaultMessage:"Search field name"})}},j=Object(s.useMemo)((()=>{const e=r.length;return Object(g.jsx)(M.EuiFlexGroup,null,Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{"data-test-subj":"csp:dataTable:fieldsModal:fieldsShowing",size:"xs"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.dataTable.fieldsModalFieldsShowing",defaultMessage:"Showing"})," ",Object(g.jsx)("strong",{"data-test-subj":"csp:dataTable:fieldsModal:fieldsCount"},e)," ",Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.dataTable.fieldsModalFieldsCount",defaultMessage:"{totalFields, plural, one {field} other {fields}}",values:{totalFields:e}}))))}),[r.length]);return Object(g.jsx)(M.EuiInMemoryTable,{tableCaption:e,items:r,columns:p,search:m,pagination:!0,sorting:co,error:b,childrenBetween:j})},go=({closeModal:e,dataView:t,columns:i,onAddColumn:a,onRemoveColumn:n})=>{const s=I.i18n.translate("xpack.csp.dataTable.fieldsModalTitle",{defaultMessage:"Fields"});return Object(g.jsx)(M.EuiModal,{onClose:e},Object(g.jsx)(M.EuiModalHeader,null,Object(g.jsx)(M.EuiModalHeaderTitle,null,s)),Object(g.jsx)(M.EuiModalBody,null,Object(g.jsx)(po,{title:s,dataView:t,columns:i,onAddColumn:a,onRemoveColumn:n})),Object(g.jsx)(M.EuiModalFooter,null,Object(g.jsx)(M.EuiButton,{onClick:e,fill:!0},"Close")))},bo=({children:e})=>{const t=uo();return Object(g.jsx)(M.EuiFlexItem,{grow:!1,className:t.groupBySelector},e)},mo=({total:e,title:t,dataView:i,columns:a,onAddColumn:n,onRemoveColumn:r,groupSelectorComponent:l})=>{const[u,c]=Object(s.useState)(!1);return Object(g.jsx)(o.a.Fragment,null,u&&Object(g.jsx)(go,{columns:a,dataView:i,closeModal:()=>c(!1),onAddColumn:n,onRemoveColumn:r}),Object(g.jsx)(M.EuiFlexItem,{grow:0},Object(g.jsx)("span",{className:"cspDataTableTotal"},`${ri(e)} ${t}`)),Object(g.jsx)(M.EuiFlexItem,{grow:0},Object(g.jsx)(M.EuiButtonEmpty,{className:"cspDataTableFields",iconType:"tableOfContents",onClick:()=>c(!0),size:"xs",color:"text"},I.i18n.translate("xpack.csp.dataTable.fields",{defaultMessage:"Fields"}))),l&&Object(g.jsx)(bo,null,l))},jo={border:"horizontal",cellPadding:"l",stripes:!1,header:"underline"},xo=["openDetails"],fo=({dataView:e,isLoading:t,defaultColumns:i,rows:a,total:n,flyoutComponent:o,cloudPostureTable:r,loadMore:l,title:u,customCellRenderer:c,groupSelectorComponent:d,height:p,...b})=>{const{columnsLocalStorageKey:m,pageSize:j,onChangeItemsPerPage:f,setUrlQuery:h,onSort:y,onResetFilters:v,filters:O,sort:T}=r,[C,S]=k()(m,i.map((e=>e.id))),[E,I]=k()(`${m}:settings`,{columns:i.reduce(((e,t)=>{const i=t.width?{width:t.width}:{};return{...e,[t.id]:i}}),{})}),[F,N]=Object(s.useState)(void 0),{uiSettings:_,uiActions:D,dataViews:L,data:z,application:A,theme:R,fieldFormats:P,toastNotifications:V,storage:G,dataViewFieldEditor:B}=Object(w.a)().services,U=uo(),{capabilities:W}=A,{filterManager:H}=z.query,Q={theme:R,fieldFormats:P,uiSettings:_,toastNotifications:V,storage:G,data:z,dataViewFieldEditor:B},{columns:Z,onSetColumns:Y,onAddColumn:J,onRemoveColumn:q}=(({capabilities:e,dataView:t,dataViews:i,setAppState:a,useNewFieldsApi:n,columns:o,sort:r,defaultOrder:l="desc"})=>{const[u,c]=Object(s.useState)(Ya(o,n));Object(s.useEffect)((()=>{const e=Ya(o,n);Object(x.isEqual)(u,e)||c(e)}),[o,n,u]);const{onAddColumn:d,onRemoveColumn:p,onSetColumns:g,onMoveColumn:b}=Object(s.useMemo)((()=>function({capabilities:e,dataView:t,dataViews:i,useNewFieldsApi:a,setAppState:n,columns:s,sort:o,defaultOrder:r}){return{onAddColumn:function(l){Qa(t,l,i,e);const u=function(e,t,i){return e.includes(t)?e:Za([...e,t],i)}(s||[],l,a),c="_score"!==l||null!=o&&o.length?o:[["_score",r]];n({columns:u,sort:c})},onRemoveColumn:function(r){Qa(t,r,i,e);const l=function(e,t,i){return e.includes(t)?Za(e.filter((e=>e!==t)),i):e}(s||[],r,a),u=o&&o.length?o.filter((e=>e[0]!==r)):[];n({columns:l,sort:u})},onMoveColumn:function(e,t){const i=function(e,t,i){if(i<0||i>=e.length||!e.includes(t))return e;const a=[...e];return a.splice(a.indexOf(t),1),a.splice(i,0,t),a}(s||[],e,t);n({columns:i})},onSetColumns:function(e,i){const a=!i&&t.timeFieldName&&t.timeFieldName===e[0]?(e||[]).slice(1):e;n({columns:a})}}}({capabilities:e,dataView:t,dataViews:i,setAppState:a,useNewFieldsApi:n,columns:u,sort:r,defaultOrder:l})),[e,t,i,l,a,r,n,u]);return{columns:u,onAddColumn:d,onRemoveColumn:p,onMoveColumn:b,onSetColumns:g}})({capabilities:W,defaultOrder:_.get("discover:sort:defaultOrder"),dataView:e,dataViews:L,setAppState:e=>S(e.columns),useNewFieldsApi:!0,columns:C,sort:T}),K=Object(s.useMemo)((()=>H&&e?(t,i,a)=>{const n=Object(lo.generateFilters)(H,t,i,a,e);H.addFilters(n),h({filters:H.getFilters()})}:void 0),[e,H,h]),X=Object(s.useMemo)((()=>{if(c)return c(a)}),[c,a]);if(!t&&!a.length)return Object(g.jsx)(Je,{onResetFilters:v});const ee=Object(g.jsx)(mo,{total:n,dataView:e,title:u,columns:Z,onAddColumn:J,onRemoveColumn:q,groupSelectorComponent:d}),te={height:null!=p?p:`calc(100vh - ${(null==O?void 0:O.length)>0?443:403}px)`},ie={opacity:t?1:0};return Object(g.jsx)(nn,{getTriggerCompatibleActions:D.getTriggerCompatibleActions},Object(g.jsx)("div",{"data-test-subj":b["data-test-subj"],className:U.gridContainer,style:te},Object(g.jsx)(M.EuiProgress,{size:"xs",color:"accent",style:ie}),Object(g.jsx)(ro,{className:U.gridStyle,ariaLabelledBy:u,columns:Z,expandedDoc:F,dataView:e,loadingState:t?ao.loading:ao.loaded,onFilter:K,onResize:e=>{const t=E||{},i={...t.columns||{}};i[e.columnId]={width:Math.round(e.width)};const a={...t,columns:i};I(a)},onSetColumns:Y,onSort:y,rows:a,sampleSizeState:$.m,setExpandedDoc:N,renderDocumentView:e=>o(e,(()=>N(void 0))),sort:T,rowsPerPageState:j,totalHits:n,services:Q,useNewFieldsApi:!0,onUpdateRowsPerPage:f,rowHeightState:0,showMultiFields:_.get("discover:showMultiFields"),showTimeCol:!1,settings:E,onFetchMoreRecords:l,externalCustomRenderers:X,externalAdditionalControls:ee,gridStyleOverride:jo,rowLineHeightOverride:"24px",controlColumnIds:xo})))},ho=["_type","_source"];function yo(e,t,i){var a;const n={};function s(e,a=""){for(const[o,r]of Object.entries(e)){const e=a+o,l=null==t?void 0:t.fields.getByName(e);if(!1===(null==i?void 0:i.shallow)){const t="nested"===(null==l?void 0:l.type);if(Array.isArray(r)&&!t){r.forEach((t=>Object(x.isPlainObject)(t)&&s(t,e+".")));continue}}else if(void 0!==n[e])continue;const u=l&&"conflict"!==l.type,c=!Object(x.isPlainObject)(r);u||c?n[e]?Array.isArray(n[e])?n[e].push(r):n[e]=[n[e],r]:n[e]=r:s(r,e+".")}}return s(e.fields||{}),!1!==(null==i?void 0:i.source)&&e._source?s(e._source):null!=i&&i.includeIgnoredValues&&e.ignored_field_values&&Object.entries(e.ignored_field_values).forEach((([e,t])=>{n[e]?Array.isArray(n[e])?n[e]=[...n[e],...t]:n[e]=[n[e],...t]:n[e]=t})),null==t||null===(a=t.metaFields)||void 0===a||a.forEach((t=>{ho.includes(t)||"_"!==t.charAt(0)||(n[t]=e[t])})),new Proxy(n,{ownKeys:e=>Reflect.ownKeys(e).sort(((e,i)=>{var a,n;const s=null==t||null===(a=t.metaFields)||void 0===a?void 0:a.includes(String(e)),o=null==t||null===(n=t.metaFields)||void 0===n?void 0:n.includes(String(i));return s&&o?String(e).localeCompare(String(i)):s?1:o?-1:String(e).localeCompare(String(i))}))})}const vo=e=>{const t=e._routing?e._routing:"";return[e._index,e._id,t].join("::")};const Oo=({query:e,sort:t},i)=>{var a,n;return{index:S.w,sort:ko(t),size:$.m,aggs:{count:{terms:{field:"result.evaluation"}}},ignore_unavailable:!1,query:{...e,bool:{...null==e?void 0:e.bool,filter:[...null!==(a=null==e||null===(n=e.bool)||void 0===n?void 0:n.filter)&&void 0!==a?a:[],{range:{"@timestamp":{gte:`now-${S.K}`,lte:"now"}}}]}},...i?{search_after:i}:{}}},ko=e=>e.map((([e,t])=>({...To({field:e,direction:t})}))),Mo=["rule.section","resource.name","resource.sub_type"],To=({field:e,direction:t})=>Mo.includes(e)?{_script:{type:"string",order:t,script:{source:`doc["${e}"].value.toLowerCase()`,lang:"painless"}}}:{[e]:t},Co=({dataView:e,getDefaultQuery:t,nonPersistedFilters:i,showDistributionBar:a})=>{const n=(({defaultQuery:e=Ta,dataView:t,paginationLocalStorageKey:i,columnsLocalStorageKey:a,nonPersistedFilters:n})=>{const o=Sa(e),{urlQuery:r,setUrlQuery:l}=hi(o),{pageSize:u,setPageSize:c}=yi(i),d=Object(s.useCallback)((e=>{c(e),l({pageIndex:0,pageSize:e})}),[c,l]),p=Object(s.useCallback)((()=>{l({pageIndex:0,filters:[],query:{query:"",language:"kuery"}})}),[l]),g=Object(s.useCallback)((e=>{l({pageIndex:e})}),[l]),b=Object(s.useCallback)((e=>{l({sort:e})}),[l]),m=Object(s.useCallback)((({page:e,sort:t})=>{c(e.size),l({sort:t,pageIndex:e.index})}),[l,c]),j=Ca({dataView:t,filters:r.filters,query:r.query,...n?{nonPersistedFilters:n}:{}}),x=Object(s.useCallback)((e=>{l({...e,pageIndex:0})}),[l]),f=j instanceof Error?j:void 0;return{setUrlQuery:l,sort:r.sort,filters:r.filters,query:j.query?j.query:{bool:{must:[],filter:[],should:[],must_not:[]}},queryError:f,pageIndex:r.pageIndex,urlQuery:r,setTableOptions:m,handleUpdateQuery:x,pageSize:u,setPageSize:c,onChangeItemsPerPage:d,onChangePage:g,onSort:b,onResetFilters:p,columnsLocalStorageKey:a||$.g,getRowsFromPages:e=>(null==e?void 0:e.map((({page:e})=>e)).flat())||[]}})({dataView:e,paginationLocalStorageKey:$.h,columnsLocalStorageKey:"cloudPosture:latestFindings:columns",defaultQuery:t,nonPersistedFilters:i}),{query:o,sort:l,queryError:u,setUrlQuery:c,filters:d,getRowsFromPages:p}=n,{data:g,error:b,isFetching:m,fetchNextPage:j}=(e=>{const{data:t,notifications:{toasts:i}}=Object(w.a)().services;return Object(r.useInfiniteQuery)(["csp_findings",{params:e}],(async({pageParam:i})=>{const{rawResponse:{hits:a,aggregations:n}}=await Object(de.lastValueFrom)(t.search.search({params:Oo(e,i)}));if(!n)throw new Error("expected aggregations to be an defined");if(!Array.isArray(n.count.buckets))throw new Error("expected buckets to be an array");return{page:a.hits.map((e=>function(e,t,i){return{id:vo(e),raw:e,flattened:yo(e,t,{includeIgnoredValues:!0}),isAnchor:i}}(e))),total:lt.number.is(a.total)?a.total:0,count:fe(n.count.buckets)}}),{enabled:e.enabled,keepPreviousData:!0,onError:e=>be(i,e),getNextPageParam:e=>{if(0!==e.page.length)return e.page[e.page.length-1].raw.sort}})})({query:o,sort:l,enabled:!u}),x=Object(s.useMemo)((()=>p(null==g?void 0:g.pages)),[null==g?void 0:g.pages,p]),f=b||u,h=(null==g?void 0:g.pages[0].count.passed)||0,y=(null==g?void 0:g.pages[0].count.failed)||0,v=(null==g?void 0:g.pages[0].total)||0;return{cloudPostureTable:n,rows:x,error:f,isFetching:m,fetchNextPage:j,passed:h,failed:y,total:v,canShowDistributionBar:a&&v>0,onDistributionBarClick:t=>{c({filters:xe({filters:d,dataView:e,field:"result.evaluation",value:t,negate:!1})})}}},So=({row:e,children:t})=>{const i=e.raw._source,a=(e=>{var t;return void 0!==(null==e||null===(t=e.result)||void 0===t?void 0:t.evaluation)})(i)&&i;return a?t({finding:a}):Object(g.jsx)(o.a.Fragment,null)},wo=(e,t)=>Object(g.jsx)(So,{row:e},(({finding:e})=>Object(g.jsx)(ai,{findings:e,onClose:t}))),Eo=I.i18n.translate("xpack.csp.findings.latestFindings.tableRowTypeLabel",{defaultMessage:"Findings"}),Io=e=>({"result.evaluation":({rowIndex:t})=>Object(g.jsx)(So,{row:e[t]},(({finding:e})=>Object(g.jsx)(Le,{type:e.result.evaluation}))),"@timestamp":({rowIndex:t})=>Object(g.jsx)(So,{row:e[t]},(({finding:e})=>Object(g.jsx)(_e,{timestamp:e["@timestamp"]})))}),Fo=({dataView:e,groupSelectorComponent:t,height:i,showDistributionBar:a=!0,nonPersistedFilters:n})=>{const{cloudPostureTable:s,rows:r,error:l,isFetching:u,fetchNextPage:c,passed:d,failed:p,total:b,canShowDistributionBar:m,onDistributionBarClick:j}=Co({dataView:e,getDefaultQuery:Va,nonPersistedFilters:n,showDistributionBar:a});return Object(g.jsx)(M.EuiFlexItem,{"data-test-subj":"latest_findings_container"},l?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiSpacer,{size:"m"}),Object(g.jsx)(oi,{error:l})):Object(g.jsx)(o.a.Fragment,null,m&&Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiSpacer,{size:"m"}),Object(g.jsx)(ui,{distributionOnClick:j,passed:d,failed:p}),Object(g.jsx)(M.EuiSpacer,{size:"m"})),Object(g.jsx)(fo,{"data-test-subj":"latest_findings_table",dataView:e,isLoading:u,defaultColumns:Ga,rows:r,total:b,flyoutComponent:wo,cloudPostureTable:s,loadMore:c,title:Eo,customCellRenderer:Io,groupSelectorComponent:t,height:i})))};function No(e){if(null!==e){if(!Array.isArray(e))return e;for(const t of e)if(null!==t)return t}}var _o={name:"1lv1yo7",styles:"display:inline-flex"};const Do=({title:e,field:t,unit:i=za})=>Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(g.jsx)("strong",null,e),Object(g.jsx)(M.EuiIconTip,{anchorProps:{css:_o},content:Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.grouping.nullGroupTooltip",defaultMessage:"The selected {groupingTitle} field, {field} is missing a value for this group of {unit}.",values:{groupingTitle:Object(g.jsx)("strong",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.grouping.nullGroupTooltip.groupingTitle",defaultMessage:"group by"})),field:Object(g.jsx)("code",null,t),unit:i}})),position:"right"}));var Lo={name:"1m5hyg0",styles:"word-break:break-all"},zo={name:"1u4hpl4",styles:"display:inline"};const Ao=(e,t,i,a)=>{var n,s,o,r,l,u,c,d,p,b,m,j,x,f,h,y,v,O,k,C,S,w,E,I,F;if(a)return Object(g.jsx)(M.EuiSkeletonTitle,{size:"s",isLoading:!0},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.grouping.loadingGroupPanelTitle",defaultMessage:"Loading"}));const N=No(null===(n=t.benchmarkId)||void 0===n||null===(s=n.buckets)||void 0===s||null===(o=s[0])||void 0===o?void 0:o.key);switch(e){case Na:return i?Object(g.jsx)(Do,{title:Aa.RESOURCE_NAME,field:e}):Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(g.jsx)(M.EuiFlexItem,{css:zo},Object(g.jsx)(M.EuiText,{size:"s"},Object(g.jsx)(M.EuiTextBlockTruncate,{lines:2,css:Lo,title:null===(r=t.resourceName)||void 0===r||null===(l=r.buckets)||void 0===l?void 0:l[0].key},Object(g.jsx)("strong",null,t.key_as_string)," ",null===(u=t.resourceName)||void 0===u||null===(c=u.buckets)||void 0===c?void 0:c[0].key))),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{size:"xs",color:"subdued"},null===(d=t.resourceSubType)||void 0===d||null===(p=d.buckets)||void 0===p?void 0:p[0].key)))));case _a:return i?Object(g.jsx)(Do,{title:Aa.RULE_NAME,field:e}):Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{size:"s"},Object(g.jsx)("strong",null,t.key_as_string))),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{size:"xs",color:"subdued"},No(null===(b=t.benchmarkName)||void 0===b||null===(m=b.buckets)||void 0===m?void 0:m[0].key)," ",No(null===(j=t.benchmarkVersion)||void 0===j||null===(x=j.buckets)||void 0===x?void 0:x[0].key))))));case Da:return i?Object(g.jsx)(Do,{title:Aa.CLOUD_ACCOUNT_NAME,field:e}):Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},N&&Object(g.jsx)(M.EuiFlexItem,{grow:0},Object(g.jsx)(qt,{type:N,name:No(null===(f=t.benchmarkName)||void 0===f||null===(h=f.buckets)||void 0===h||null===(y=h[0])||void 0===y?void 0:y.key)})),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{size:"s"},Object(g.jsx)("strong",null,t.key_as_string))),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{size:"xs",color:"subdued"},null===(v=t.benchmarkName)||void 0===v||null===(O=v.buckets)||void 0===O||null===(k=O[0])||void 0===k?void 0:k.key)))));case La:return i?Object(g.jsx)(Do,{title:Aa.ORCHESTRATOR_CLUSTER_NAME,field:e}):Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center",gutterSize:"m"},N&&Object(g.jsx)(M.EuiFlexItem,{grow:0},Object(g.jsx)(qt,{type:N,name:No(null===(C=t.benchmarkName)||void 0===C||null===(S=C.buckets)||void 0===S||null===(w=S[0])||void 0===w?void 0:w.key)})),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{size:"s"},Object(g.jsx)("strong",null,t.key_as_string))),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{size:"xs",color:"subdued"},null===(E=t.benchmarkName)||void 0===E||null===(I=E.buckets)||void 0===I||null===(F=I[0])||void 0===F?void 0:F.key)))));default:return i?Object(g.jsx)(Do,{title:Aa.DEFAULT,field:e}):Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{size:"s"},Object(g.jsx)("strong",null,t.key_as_string))))))}},Ro=({bucket:e})=>{const{euiTheme:t}=Object(M.useEuiTheme)();return Object(g.jsx)(M.EuiToolTip,{content:e.doc_count},Object(g.jsx)(M.EuiBadge,{css:Object(g.css)("margin-left:",t.size.s,";",""),color:"hollow","data-test-subj":"findings_grouping_counter"},ri(e.doc_count)))},Po=o.a.memo(Ro),Vo=({bucket:e})=>{var t;const{euiTheme:i}=Object(M.useEuiTheme)(),a=(null===(t=e.failedFindings)||void 0===t?void 0:t.doc_count)||0,n=e.doc_count-a;return Object(g.jsx)(Ee,{size:"l",overrideCss:Object(g.css)("width:104px;margin-left:",i.size.s,";",""),totalFailed:a,totalPassed:n})},Go=o.a.memo(Vo),Bo=(e,t)=>[{title:I.i18n.translate("xpack.csp.findings.grouping.stats.badges.findings",{defaultMessage:"Findings"}),renderer:Object(g.jsx)(Po,{bucket:t})},{title:I.i18n.translate("xpack.csp.findings.grouping.stats.badges.compliance",{defaultMessage:"Compliance"}),renderer:Object(g.jsx)(Go,{bucket:t})}],Uo=({dataView:e})=>{const t=Object(s.useCallback)((t=>Object(g.jsx)(Fo,{dataView:e,nonPersistedFilters:t,height:512,showDistributionBar:!1})),[e]),{isGroupSelected:i,groupData:a,grouping:n,isFetching:l,activePageIndex:u,pageSize:c,selectedGroup:d,onChangeGroupsItemsPerPage:p,onChangeGroupsPage:b,setUrlQuery:m,isGroupLoading:j,onResetFilters:x,error:f,totalPassedFindings:h,onDistributionBarClick:y,totalFailedFindings:v,isEmptyResults:O}=(({dataView:e,groupPanelRenderer:t,groupStatsRenderer:i})=>{var a,n,o;const{activePageIndex:l,grouping:u,pageSize:c,query:d,selectedGroup:p,onChangeGroupsItemsPerPage:g,onChangeGroupsPage:b,setUrlQuery:m,uniqueValue:j,isNoneSelected:x,onResetFilters:f,error:h,filters:y}=(({dataView:e,groupingTitle:t,defaultGroupingOptions:i,getDefaultQuery:a,unit:n,groupPanelRenderer:o,groupStatsRenderer:r})=>{const l=Sa(a),{urlQuery:u,setUrlQuery:c}=hi(l),[d,p]=Object(s.useState)(0),[g,b]=Object(s.useState)(10),{query:m,error:j}=Ca({dataView:e,filters:u.filters,query:u.query});Object(s.useEffect)((()=>{p(0)}),[u.filters,u.query]);const x=ka({componentProps:{unit:n,groupPanelRenderer:o,groupStatsRenderer:r},defaultGroupingOptions:i,fields:e.fields,groupingId:"cspLatestFindings",maxGroupingLevels:1,title:t,onGroupChange:()=>{p(0)}}),f=x.selectedGroups[0],h=Object(s.useMemo)((()=>`${f}-${Ma.v4()}`),[f]),y=xa(x.selectedGroups),v=Object(s.useCallback)((()=>{c({filters:[],query:{query:"",language:"kuery"}})}),[c]);return{activePageIndex:d,grouping:x,pageSize:g,query:m,error:j,selectedGroup:f,setUrlQuery:c,uniqueValue:h,isNoneSelected:y,onChangeGroupsItemsPerPage:e=>{p(0),b(e)},onChangeGroupsPage:e=>p(e),onResetFilters:v,filters:u.filters}})({dataView:e,groupingTitle:Pa,defaultGroupingOptions:Ra,getDefaultQuery:Va,unit:Fa,groupPanelRenderer:t,groupStatsRenderer:i}),v=(({additionalFilters:e=[],from:t,groupByField:i,pageNumber:a,rootAggregations:n,runtimeMappings:s,size:o=10,sort:r,statsAggregations:l,to:u,uniqueValue:c})=>({size:0,runtime_mappings:{...s,groupByField:{type:"keyword",script:{source:"if (doc[params['selectedGroup']].size()==0) { emit(params['uniqueValue']) } else { emit(doc[params['selectedGroup']].join(params['uniqueValue']))}",params:{selectedGroup:i,uniqueValue:c}}}},aggs:{groupByFields:{terms:{field:"groupByField",size:1e4},aggs:{bucket_truncate:{bucket_sort:{sort:r,from:a,size:o}},...l?l.reduce(((e,t)=>Object.assign(e,t)),{}):{}}},unitsCount:{value_count:{field:"groupByField"}},groupsCount:{cardinality:{field:"groupByField"}},...n?n.reduce(((e,t)=>Object.assign(e,t)),{}):{}},query:{bool:{filter:[...e,{range:{"@timestamp":{gte:t,lte:u}}}]}},_source:!1}))({additionalFilters:d?[d]:[],groupByField:p,uniqueValue:j,from:`now-${S.K}`,to:"now",pageNumber:l*c,size:c,sort:[{groupByField:{order:"desc"}},{complianceScore:{order:"asc"}}],statsAggregations:Wa(p),rootAggregations:[{failedFindings:{filter:{term:{"result.evaluation":{value:"failed"}}}},passedFindings:{filter:{term:{"result.evaluation":{value:"passed"}}}}}]}),{data:O,isFetching:k}=(({query:e,enabled:t=!0})=>{const{data:i,notifications:{toasts:a}}=Object(w.a)().services;return Object(r.useQuery)(["csp_grouped_findings",{query:e}],(async()=>{const{rawResponse:{aggregations:t}}=await Object(de.lastValueFrom)(i.search.search({params:Ba(e)}));if(!t)throw new Error("Failed to aggregate by, missing resource id");return t}),{onError:e=>be(a,e),enabled:t,keepPreviousData:!0})})({query:v,enabled:!x}),M=Object(s.useMemo)((()=>((e,t,i)=>{var a,n,s,o;if(!i)return{};const r=null==i||null===(a=i.groupByFields)||void 0===a||null===(n=a.buckets)||void 0===n?void 0:n.map((i=>{if(i.key===t)return{...i,key:["â€”"],selectedGroup:e,key_as_string:"â€”",isNullGroup:!0};const a=(Array.isArray(i.key)?i.key[0]:i.key).split(t);return{...i,key:a,selectedGroup:e,key_as_string:a.join(", ")}}));return{...i,groupByFields:{buckets:r},groupsCount:{value:null!==(s=null===(o=i.groupsCount)||void 0===o?void 0:o.value)&&void 0!==s?s:0}}})(p,j,O)),[O,p,j]),T=Ha(M)&&(null==M||null===(a=M.passedFindings)||void 0===a?void 0:a.doc_count)||0,C=Ha(M)&&(null==M||null===(n=M.failedFindings)||void 0===n?void 0:n.doc_count)||0,E=!k&&Ha(M)&&!(null!==(o=M.unitsCount)&&void 0!==o&&o.value);return{groupData:M,grouping:u,isFetching:k,activePageIndex:l,pageSize:c,selectedGroup:p,onChangeGroupsItemsPerPage:g,onChangeGroupsPage:b,setUrlQuery:m,isGroupSelected:!x,isGroupLoading:!O,onResetFilters:f,filters:y,error:h,onDistributionBarClick:t=>{m({filters:xe({filters:y,dataView:e,field:"result.evaluation",value:t,negate:!1})})},totalPassedFindings:T,totalFailedFindings:C,isEmptyResults:E}})({dataView:e,groupPanelRenderer:Ao,groupStatsRenderer:Bo});return f||O?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(le,{dataView:e,setQuery:m,loading:l}),Object(g.jsx)(M.EuiSpacer,{size:"m"}),f&&Object(g.jsx)(oi,{error:f}),O&&Object(g.jsx)(Je,{onResetFilters:x})):i?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(le,{dataView:e,setQuery:m,loading:l}),Object(g.jsx)("div",null,Object(g.jsx)(M.EuiSpacer,{size:"m"}),Object(g.jsx)(ui,{distributionOnClick:y,passed:h,failed:v}),Object(g.jsx)(Ia,{data:a,grouping:n,renderChildComponent:t,onChangeGroupsItemsPerPage:p,onChangeGroupsPage:b,activePageIndex:u,isFetching:l,pageSize:c,selectedGroup:d,isGroupLoading:j}))):Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(le,{dataView:e,setQuery:m,loading:l}),Object(g.jsx)(Fo,{dataView:e,groupSelectorComponent:n.groupSelector}))},Wo=()=>{const e=Object(l.useLocation)(),t=re(S.J),{data:i}=E(),a="indexed"===(null==i?void 0:i.kspm.status)||"indexed"===(null==i?void 0:i.cspm.status),n="not-installed"!==(null==i?void 0:i.cspm.status)?"cspm":"kspm";return a?Object(g.jsx)(Y,{query:t},Object(g.jsx)(f,null,Object(g.jsx)(b,{exact:!0,path:h.c.findings.path,render:()=>Object(g.jsx)(l.Redirect,{to:{pathname:h.e.findings_default.path,search:e.search}})}),Object(g.jsx)(b,{path:h.e.findings_default.path,render:()=>Object(g.jsx)(C.TrackApplicationView,{viewId:h.e.findings_default.id},Object(g.jsx)(Uo,{dataView:t.data}))}),Object(g.jsx)(b,{path:h.e.findings_by_resource.path,render:()=>Object(g.jsx)(Ei,{dataView:t.data})}),Object(g.jsx)(b,{path:"*",render:()=>Object(g.jsx)(l.Redirect,{to:h.e.findings_default.path})}))):Object(g.jsx)(se,{posturetype:n})},Ho=({query:e,sort:t,pageIndex:i,pageSize:a})=>({index:S.L,query:e,from:i*a,size:a,sort:t}),Qo=e=>{const{data:t,notifications:{toasts:i}}=Object(w.a)().services;return Object(r.useQuery)([S.L,e],(async()=>{const{rawResponse:{hits:i}}=await Object(de.lastValueFrom)(t.search.search({params:Ho(e)}));return{page:i.hits.map((e=>e._source)),total:lt.number.is(i.total)?i.total:0}}),{staleTime:5e3,keepPreviousData:!0,enabled:e.enabled,onError:e=>be(i,e)})},Zo=e=>{switch(e){case S.ab.LOW:return Ie.euiThemeVars.euiColorVis0;case S.ab.MEDIUM:return Ie.euiThemeVars.euiColorVis5_behindText;case S.ab.HIGH:return Ie.euiThemeVars.euiColorVis9_behindText;case S.ab.CRITICAL:return Ie.euiThemeVars.euiColorDanger;default:return"#aaa"}};var Yo={name:"1tv0ws",styles:"width:1px;border:0 none;background-color:rgba(255, 255, 255, 0.2);margin:0px 6px"},Jo={name:"1xszn7y",styles:"border:none;.euiBadge__text{display:flex;}width:62px"};const qo=({score:e,version:t})=>{const i=(e=>e<=4?Ie.euiThemeVars.euiColorVis0:e>=4&&e<=7?Ie.euiThemeVars.euiColorVis7:e>=7&&e<=9?Ie.euiThemeVars.euiColorVis9:e>=9?Ie.euiThemeVars.euiColorDanger:void 0)(e),a=t?`v${t.split(".")[0]}`:null;return Object(g.jsx)(M.EuiBadge,{color:i,css:Jo,"data-test-subj":"vulnerabilities_cvss_score_badge"},a&&Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiTextColor,{color:"ghost"},e<10?e.toFixed(1):e),Object(g.jsx)("hr",{css:Yo}),Object(g.jsx)(M.EuiTextColor,{color:"ghost"},a)))};var Ko={name:"fhxb3m",styles:"display:flex;flex-direction:row;align-items:center"};const $o=({severity:e})=>{const t=Zo(e);return Object(g.jsx)("div",{css:Ko},Object(g.jsx)(M.EuiIcon,{type:"dot",color:t,css:Object(g.css)("opacity:",e?1:0,";","")}),e)};var Xo=i(152),er=i.n(Xo);const tr="vulnerability.severity",ir={field_names:["resource.name","resource.id"]};var ar,nr;!function(e){e.Low="low",e.Medium="medium",e.High="high",e.Critical="critical"}(ar||(ar={})),function(e){e.DoNotSuppress="doNotSuppress",e.Suppress="suppress"}(nr||(nr={}));const sr=["Cloud Security","CNVM","Data Source: Cloud Native Vulnerability Management","Use Case: Vulnerability","OS: Linux"],or=e=>[...sr,e.id],rr=e=>I.i18n.translate("xpack.csp.vulnerabilities.detectionRuleNamePrefix",{defaultMessage:"Vulnerability: {vulnerabilityId}",values:{vulnerabilityId:e.id}}),lr=e=>{const t=(new Date).toISOString();return`vulnerability.id: "${e.id}" AND event.ingested >= "${t}"`},ur=async(e,t)=>await Et({http:e,rule:{type:"query",language:"kuery",license:"Elastic License v2",author:["Elastic"],filters:[],false_positives:[],risk_score:0,risk_score_mapping:[],severity:"low",severity_mapping:[{field:tr,value:S.ab.LOW,operator:"equals",severity:ar.Low},{field:tr,value:S.ab.MEDIUM,operator:"equals",severity:ar.Medium},{field:tr,value:S.ab.HIGH,operator:"equals",severity:ar.High},{field:tr,value:S.ab.CRITICAL,operator:"equals",severity:ar.Critical},{field:tr,value:S.ab.UNKNOWN,operator:"equals",severity:ar.Low}],threat:[],interval:"1h",from:`now-${S.M}`,to:"now",max_signals:100,timestamp_override:"event.ingested",timestamp_override_fallback_disabled:!1,actions:[],enabled:!0,alert_suppression:{group_by:["resource.id"],missing_fields_strategy:nr.Suppress},index:[S.Z],query:lr(t),references:t.reference?[t.reference]:[],name:rr(t),description:t.description,tags:or(t),investigation_fields:ir}}),cr=({vulnerability:e})=>Object(g.jsx)(wt,{tags:["CNVM",e.id],createRuleFn:async t=>await ur(t,e)}),dr={nvd:"NVD",redhat:"Red Hat",ghsa:"GHSA"},pr={redhat:er.a,ghsa:"logoGithub"};var gr={name:"1qx4gu9",styles:"margin-right:30px"},br={name:"10vbjov",styles:"width:116px;font-weight:600;display:flex;flex-direction:row;align-items:center"};const mr=({vectorBaseScore:e,vendor:t})=>{var i;const a=null!==(i=dr[t])&&void 0!==i?i:I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilityOverviewTab.cvsScore.unknownVendorName",{defaultMessage:"Unknown vendor"}),n=(e=>{const t=[],i=null==e?void 0:e.V2Vector,a=null==e?void 0:e.V2Score,n=null==e?void 0:e.V3Vector,s=null==e?void 0:e.V3Score;return i&&t.push({version:"2.0",vector:i,score:a}),n&&t.push({version:"3.0",vector:n,score:s}),t})(e);return Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center",css:Object(g.css)("border:1px solid #d3dae6;border-radius:6px;padding:",Ie.euiThemeVars.euiSizeM,";","")},Object(g.jsx)(M.EuiFlexItem,{grow:!1,css:br},Object(g.jsx)("span",{css:gr},"nvd"===t?Object(g.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"42px",height:"10px",viewBox:"0 0 41 11",version:"1.1"},Object(g.jsx)("path",{fill:Ie.euiThemeVars.euiColorFullShade,d:"M 2.558594 8.402344 C 2.5625 6.628906 2.5625 4.855469 2.5625 3.078125 C 2.5625 3.074219 2.5625 3.074219 2.5625 3.070312 C 2.558594 2.910156 2.558594 2.746094 2.722656 2.671875 C 2.863281 2.609375 2.945312 2.710938 3.019531 2.804688 C 3.035156 2.828125 3.050781 2.847656 3.070312 2.867188 C 5.023438 4.996094 7.027344 7.105469 8.835938 9.367188 C 9.546875 10.257812 10.371094 10.777344 11.554688 10.742188 C 12.894531 10.703125 14.144531 9.625 14.171875 8.09375 C 14.207031 6.375 14.199219 4.652344 14.195312 2.929688 C 14.191406 2.058594 14.1875 1.1875 14.191406 0.316406 C 14.191406 0.0820312 14.109375 0.0078125 13.890625 0.0117188 C 13.265625 0.0195312 12.644531 0.03125 12.023438 0.0078125 C 11.710938 -0.00390625 11.628906 0.0976562 11.628906 0.414062 C 11.636719 2.199219 11.636719 3.984375 11.636719 5.765625 C 11.636719 6.402344 11.683594 7.054688 11.632812 7.691406 C 11.617188 7.867188 11.546875 8.027344 11.375 8.082031 C 11.25 8.117188 11.183594 8.023438 11.117188 7.9375 C 10.800781 7.507812 10.40625 7.125 10.054688 6.722656 C 8.910156 5.425781 7.757812 4.140625 6.597656 2.855469 C 6 2.195312 5.402344 1.53125 4.832031 0.847656 C 4.050781 -0.0898438 2.3125 -0.242188 1.367188 0.347656 C 0.621094 0.8125 0.046875 1.460938 0.0273438 2.359375 C -0.0078125 4.183594 0 6.011719 0.00390625 7.835938 C 0.00390625 8.695312 0.0078125 9.558594 0.0078125 10.421875 C 0.00390625 10.652344 0.0859375 10.730469 0.308594 10.726562 C 0.949219 10.71875 1.59375 10.714844 2.234375 10.730469 C 2.492188 10.734375 2.570312 10.644531 2.566406 10.386719 C 2.554688 9.730469 2.558594 9.074219 2.558594 8.402344 Z M 2.558594 8.402344 "}),Object(g.jsx)("path",{fill:Ie.euiThemeVars.euiColorFullShade,d:"M 22.050781 10.714844 C 22.941406 10.605469 23.636719 10.164062 24.042969 9.285156 C 25.1875 7.234375 26.230469 5.117188 27.308594 3.027344 C 27.472656 2.707031 27.691406 2.558594 28.058594 2.5625 C 30.578125 2.574219 33.097656 2.558594 35.617188 2.574219 C 36.417969 2.578125 37.136719 2.894531 37.6875 3.488281 C 38.433594 4.296875 38.667969 5.28125 38.277344 6.324219 C 37.851562 7.460938 36.976562 8.109375 35.800781 8.152344 C 34.171875 8.214844 32.539062 8.171875 30.90625 8.167969 C 30.464844 8.167969 30.34375 8.03125 30.339844 7.585938 C 30.339844 6.332031 30.335938 5.074219 30.347656 3.820312 C 30.347656 3.554688 30.28125 3.449219 30.003906 3.457031 C 29.382812 3.476562 28.757812 3.480469 28.136719 3.457031 C 27.84375 3.449219 27.785156 3.566406 27.785156 3.839844 C 27.792969 6.003906 27.796875 8.167969 27.78125 10.332031 C 27.777344 10.660156 27.886719 10.730469 28.183594 10.730469 C 30.210938 10.722656 32.238281 10.722656 34.265625 10.722656 C 34.972656 10.722656 35.738281 10.824219 36.445312 10.71875 C 37.734375 10.519531 38.828125 9.960938 39.699219 8.945312 C 40.890625 7.5625 41.203125 5.957031 40.878906 4.195312 C 40.667969 3.046875 40.101562 2.089844 39.242188 1.3125 C 38.371094 0.527344 37.359375 0.0390625 36.207031 0.0273438 C 33.074219 -0.0117188 29.945312 0.015625 26.8125 0.0117188 C 26.296875 0.0117188 25.921875 0.261719 25.671875 0.714844 C 24.382812 3.046875 23.355469 5.570312 21.941406 7.828125 C 21.765625 8.105469 21.605469 8.109375 21.433594 7.84375 C 19.898438 5.476562 18.742188 2.777344 17.414062 0.289062 C 17.3125 0.101562 17.183594 0.00390625 16.953125 0.0078125 C 16.480469 0.0195312 16.007812 0.0195312 15.535156 0.015625 C 15.265625 0.015625 14.988281 0.0351562 14.714844 0.0117188 C 14.640625 0.0078125 14.5625 0 14.5 0.0664062 C 14.484375 0.148438 14.519531 0.210938 14.554688 0.273438 C 14.839844 0.785156 15.097656 1.3125 15.371094 1.832031 C 16.171875 3.367188 16.96875 4.90625 17.757812 6.445312 C 18.234375 7.367188 18.707031 8.285156 19.179688 9.203125 C 19.359375 9.542969 19.582031 9.847656 19.882812 10.101562 C 20.519531 10.644531 21.257812 10.8125 22.050781 10.714844 Z M 22.050781 10.714844 "})):Object(g.jsx)(M.EuiIcon,{type:pr[t],size:"xl"})),Object(g.jsx)("span",null,a)),Object(g.jsx)(M.EuiFlexGroup,{direction:"column",gutterSize:"s"},n.length>0&&n.map(((e,t)=>Object(g.jsx)(jr,{key:`${e}-${t}`,vectorScore:e})))))},jr=({vectorScore:e})=>{const{score:t,vector:i,version:a}=e;return Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiFlexGroup,{alignItems:"center",css:Object(g.css)("background:",Ie.euiThemeVars.euiColorLightestShade,";padding:",Ie.euiThemeVars.euiSizeXS," ",Ie.euiThemeVars.euiSizeS,";border-radius:6px;","")},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiText,{css:Object(g.css)("font-size:",Ie.euiThemeVars.euiFontSizeM,";color:",Ie.euiThemeVars.euiColorFullShade,";","")},i," ")),Object(g.jsx)(M.EuiFlexItem,{grow:!1},t&&Object(g.jsx)(qo,{score:t,version:a}))))};var xr={name:"tnote4",styles:"line-height:20px;margin-bottom:6px"};const fr=({vulnerabilityRecord:e})=>{var t,i,a,n;const{vulnerability:s}=e,o=Object(g.css)("padding:",Ie.euiThemeVars.euiFontSizeM,";background:",Ie.euiThemeVars.euiColorLightestShade,";border-radius:6px;height:74px;",""),r=xr,l=Ne()(null==s?void 0:s.published_date).format("LL").toString();return Object(g.jsx)(M.EuiFlexGroup,{"data-test-subj":"vulnerability_overview_tab_flyout"},(null==s||null===(t=s.score)||void 0===t?void 0:t.version)&&(null==s||null===(i=s.score)||void 0===i?void 0:i.base)&&Object(g.jsx)(M.EuiFlexItem,{css:o},Object(g.jsx)(M.EuiText,{css:r},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTile.cvsScore",defaultMessage:"CVSS"})),Object(g.jsx)("div",null,Object(g.jsx)(qo,{version:s.score.version,score:s.score.base}))),Object(g.jsx)(M.EuiFlexItem,{css:o},Object(g.jsx)(M.EuiText,{css:r},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTile.dataSource",defaultMessage:"Data Source"})),Object(g.jsx)(M.EuiLink,{href:null==s||null===(a=s.data_source)||void 0===a?void 0:a.URL,target:"_blank"},null==s||null===(n=s.data_source)||void 0===n?void 0:n.ID)),Object(g.jsx)(M.EuiFlexItem,{css:o},Object(g.jsx)(M.EuiText,{css:r},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTile.publishedDate",defaultMessage:"Published Date"})),Object(g.jsx)("strong",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTile.publishedDateText",defaultMessage:"{date}",values:{date:l}}))))};var hr={name:"xctmr2",styles:"margin-block:12px"};const yr=({vulnerabilityRecord:e})=>{var t,i,a;const{vulnerability:n}=e,s=I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilityOverviewTab.emptyFixesMessage",{defaultMessage:"No available fixes yet."}),o=null!=e&&null!==(t=e.package)&&void 0!==t&&t.fixed_version?`${null==e||null===(i=e.package)||void 0===i?void 0:i.name} ${null==e||null===(a=e.package)||void 0===a?void 0:a.fixed_version}`:s,r=null!=n&&n.cvss?Object.entries(n.cvss).map((([e,t])=>Object(g.jsx)(M.EuiFlexItem,{key:`${e}`},Object(g.jsx)(mr,{vectorBaseScore:t,vendor:e})))):[],l=hr,u=Object(g.css)("font-size:",Ie.euiThemeVars.euiFontSizeM,";line-height:24px;margin-bottom:",Ie.euiThemeVars.euiSizeS,";font-weight:600;","");return Object(g.jsx)(M.EuiFlexGroup,{direction:"column"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(fr,{vulnerabilityRecord:e})),Object(g.jsx)(M.EuiHorizontalRule,{css:l}),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)("h4",{css:u},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTab.alertsTitle",defaultMessage:"Alerts"})),Object(g.jsx)(cr,{vulnerability:n})),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)("h4",{css:u},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTab.descriptionTitle",defaultMessage:"Description"})),Object(g.jsx)(ei,null,(null==n?void 0:n.description)||"")),Object(g.jsx)(M.EuiHorizontalRule,{css:l}),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)("h4",{css:u},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTab.fixes",defaultMessage:"Fixes"})),Object(g.jsx)(M.EuiText,null,o)),Object(g.jsx)(M.EuiHorizontalRule,{css:l}),(null==r?void 0:r.length)>0&&Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)("h4",{css:u},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityOverviewTab.vulnerabilityScores",defaultMessage:"Vulnerability Scores"})),Object(g.jsx)(M.EuiFlexGroup,{direction:"column",gutterSize:"l",css:Object(g.css)("margin-top:",Ie.euiThemeVars.euiSizeS,";","")},r)))},vr=({vulnerabilityRecord:e})=>Object(g.jsx)("div",{style:{position:"absolute",inset:0,top:188,bottom:60},"data-test-subj":"vulnerability_json_tab_flyout"},Object(g.jsx)(A.CodeEditor,{isCopyable:!0,allowFullScreen:!0,languageId:Ot.XJsonLang.ID,value:JSON.stringify(e,null,2),options:{readOnly:!0,lineNumbers:"on",folding:!0}})),Or={box:{incremental:!0}},kr={sort:{field:"key",direction:"asc"}},Mr={initialPageSize:100,showPerPageOptions:!1},Tr=[{field:"key",name:I.i18n.translate("xpack.csp.vulnerabilities.flyoutTabs.fieldLabel",{defaultMessage:"Field"}),width:"25%"},{field:"value",name:I.i18n.translate("xpack.csp.vulnerabilities.flyoutTabs.fieldValueLabel",{defaultMessage:"Value"}),render:e=>Object(g.jsx)("div",{style:{width:"100%"}},(e=>void 0===e?"undefined":"boolean"==typeof e||null===e?Object(g.jsx)(M.EuiCode,null,JSON.stringify(e)):"object"==typeof e?Object(g.jsx)(M.EuiCodeBlock,{isCopyable:!0,overflowHeight:300},JSON.stringify(e,null,2)):Object(g.jsx)(M.EuiText,{size:"s"},e))(e))}],Cr=e=>Object.entries(Object(pt.getFlattenedObject)(e)).map((([e,t])=>({key:e,value:t}))),Sr=({vulnerabilityRecord:e})=>Object(g.jsx)(M.EuiInMemoryTable,{items:Cr(e),columns:Tr,sorting:kr,search:Or,pagination:Mr}),wr="vuln-flyout-overview-tab",Er=e=>{var t,i;return[(null===(t=e.resource)||void 0===t?void 0:t.id)&&{title:I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesFindingFlyout.flyoutDescriptionList.resourceId",{defaultMessage:"Resource ID"}),description:e.resource.id},(null===(i=e.resource)||void 0===i?void 0:i.name)&&{title:I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesFindingFlyout.flyoutDescriptionList.resourceName",{defaultMessage:"Resource Name"}),description:e.resource.name},{title:I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesFindingFlyout.flyoutDescriptionList.packageTitle",{defaultMessage:"Package"}),description:e.package.name},{title:I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesFindingFlyout.flyoutDescriptionList.versionTitle",{defaultMessage:"Version"}),description:e.package.version}].filter(pe.e)},Ir=({closeFlyout:e,onPaginate:t,totalVulnerabilitiesCount:i,flyoutIndex:a,vulnerabilityRecord:n,isLoading:o})=>{const[r,l]=Object(s.useState)(wr),u=null==n?void 0:n.vulnerability,c=Object(s.useMemo)((()=>[{id:wr,name:Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityFindingFlyout.overviewTabLabel",defaultMessage:"Overview"}),content:Object(g.jsx)(yr,{vulnerabilityRecord:n})},{id:"vuln-flyout-table-tab",name:Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityFindingFlyout.tableTabLabel",defaultMessage:"Table"}),content:Object(g.jsx)(Sr,{vulnerabilityRecord:n})},{id:"vuln-flyout-json-tab",name:Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.vulnerabilityFindingFlyout.jsonTabLabel",defaultMessage:"JSON"}),content:Object(g.jsx)(vr,{vulnerabilityRecord:n})}]),[n]),d=Object(s.useMemo)((()=>{var e;return null===(e=c.find((e=>e.id===r)))||void 0===e?void 0:e.content}),[r,c]),p=I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilityFindingFlyout.loadingAriaLabel",{defaultMessage:"Loading"}),b=null==u?void 0:u.reference;return Object(g.jsx)(M.EuiFlyout,{onClose:e},Object(g.jsx)(M.EuiFlyoutHeader,null,Object(g.jsx)(M.EuiSkeletonText,{lines:10,size:"m",isLoading:o,contentAriaLabel:p},Object(g.jsx)(M.EuiFlexGroup,{direction:"column",css:Object(g.css)("gap:",Ie.euiThemeVars.euiSizeS,";","")},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)($o,{severity:null==u?void 0:u.severity})),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiFlexGroup,{direction:"column",css:Object(g.css)("gap:",Ie.euiThemeVars.euiSizeS,";","")},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiTitle,{size:"m",css:Object(g.css)("color:",Ie.euiThemeVars.euiColorPrimaryText,";line-height:32px;","")},b?Object(g.jsx)(M.EuiLink,{target:"_blank",href:b},null==u?void 0:u.id):Object(g.jsx)(M.EuiText,null,null==u?void 0:u.id))),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)("div",{css:Object(g.css)("line-height:20px;margin-bottom:",Ie.euiThemeVars.euiSizeM,";","")},Object(g.jsx)(ot,{testId:"vulnerability-flyout-description-list",listItems:Er(n)}))))),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiTabs,null,c.map(((e,t)=>{return Object(g.jsx)(M.EuiTab,{"data-test-subj":(i=e.id,`vulnerability-finding-flyout-tab-${i}`),onClick:()=>{return t=e.id,l(t);var t},isSelected:e.id===r,key:t},e.name);var i}))))))),Object(g.jsx)(M.EuiFlyoutBody,null,Object(g.jsx)(M.EuiSkeletonText,{lines:10,size:"m",isLoading:o,contentAriaLabel:p},d)),Object(g.jsx)(M.EuiFlyoutFooter,null,Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:t?"spaceBetween":"flexEnd"},t&&Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiPagination,{pageCount:i,activePage:a,onPageClick:t,compressed:!0})),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(jt,{createRuleFn:async e=>await ur(e,n.vulnerability)})))))},Fr=()=>Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"scanning-vulnerabilities-empty-prompt",color:"plain",icon:Object(g.jsx)(M.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}),title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.scanningVulnerabilitiesEmptyPrompt.indexingButtonTitle",defaultMessage:"Scanning your environment"})),body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.scanningVulnerabilitiesEmptyPrompt.indexingDescription",defaultMessage:"Results will appear here as soon as they are available."}))}),Nr=({vulnMgmtIntegrationLink:e})=>Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"cnvm-integration-not-installed",icon:Object(g.jsx)(M.EuiImage,{size:"fullWidth",src:q.a,alt:"no-data-illustration"}),title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedHTMLMessage,{tagName:"h2",id:"xpack.csp.cloudPosturePage.vulnerabilitiesInstalledEmptyPrompt.promptTitle",defaultMessage:"Detect vulnerabilities in your <br/> cloud assets"})),layout:"horizontal",color:"plain",body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.vulnerabilitiesInstalledEmptyPrompt.promptDescription",defaultMessage:"Add the Cloud Native Vulnerability Management integration to begin"})),actions:Object(g.jsx)(M.EuiFlexGroup,null,Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiButton,{color:"primary",fill:!0,href:e,"data-test-subj":"cnvm-not-installed-action"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.vulnerabilitiesInstalledEmptyPrompt.addVulMngtIntegrationButtonTitle",defaultMessage:"Install Cloud Native Vulnerability Management"}))),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiButtonEmpty,{color:"primary",href:"https://ela.st/cnvm",target:"_blank"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.vulnerabilitiesInstalledEmptyPrompt.learnMoreButtonTitle",defaultMessage:"Learn more"}))))}),_r=()=>Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"vulnerabilities-timeout",color:"plain",icon:Object(g.jsx)(M.EuiLoadingLogo,{logo:"logoSecurity",size:"xl"}),title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.indexTimeout.indexTimeoutTitle",defaultMessage:"Findings Delayed"})),body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.indexTimeout.indexTimeoutDescription",defaultMessage:"Scanning workloads is taking longer than expected. Please check {docs}",values:{docs:Object(g.jsx)(M.EuiLink,{href:"https://ela.st/cnvm-faq",target:"_blank"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.indexTimeout.indexTimeoutDocLink",defaultMessage:"CNVM FAQ"}))}}))});var Dr={name:"1b7vz4z",styles:"text-align:initial"};const Lr=({unprivilegedIndices:e})=>Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"status-api-vuln-mgmt-unprivileged",color:"plain",icon:Object(g.jsx)(M.EuiIcon,{type:"logoSecurity",size:"xl"}),title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.unprivileged.unprivilegedTitle",defaultMessage:"Privileges required"})),body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.unprivileged.unprivilegedDescription",defaultMessage:"To view cloud posture data, you must update privileges. For more information, contact your Kibana administrator."})),footer:Object(g.jsx)(M.EuiMarkdownFormat,{css:Dr,children:I.i18n.translate("xpack.csp.noVulnerabilitiesStates.unprivileged.unprivilegedFooterMarkdown",{defaultMessage:"Required Elasticsearch index privilege `read` for the following indices:"})+e.map((e=>`\n- \`${e}\``))})}),zr=({postureType:e})=>{const t=z({postureType:e});return Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"agent-not-deployed-vuln-mgmt",color:"plain",iconType:"fleetApp",title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.noAgentsDeployed.noAgentsDeployedTitle",defaultMessage:"No Agents Installed"})),body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.noAgentsDeployed.noAgentsDeployedDescription",defaultMessage:"In order to begin detecting vulnerabilities, you'll need to deploy elastic-agent into the cloud account or Kubernetes cluster you want to monitor."})),actions:[Object(g.jsx)(M.EuiButton,{fill:!0,href:t,isDisabled:!t},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.noVulnerabilitiesStates.noAgentsDeployed.noAgentsDeployedButtonTitle",defaultMessage:"Install Agent"}))]})},Ar=()=>{var e,t,i;const a=E({refetchInterval:2e4}),n=K(S.bb),s=null===(e=a.data)||void 0===e||null===(t=e.vuln_mgmt)||void 0===t?void 0:t.status,o=null===(i=a.data)||void 0===i?void 0:i.indicesDetails,r=o&&o.filter((e=>"unprivileged"===e.status)).map((e=>e.index)).sort(((e,t)=>e.localeCompare(t)));return Object(g.jsx)(Y,{query:a},Object(g.jsx)(F.a,null,"indexing"===s||"waiting_for_results"===s?Object(g.jsx)(Fr,null):"index-timeout"===s?Object(g.jsx)(_r,null):"not-installed"===s?Object(g.jsx)(Nr,{vulnMgmtIntegrationLink:n}):"not-deployed"===s?Object(g.jsx)(zr,{postureType:S.bb}):"unprivileged"===s?Object(g.jsx)(Lr,{unprivilegedIndices:r||[]}):void 0))},Rr={type:"severitySchema",detector:()=>0,sortTextAsc:I.i18n.translate("xpack.csp.vulnerabilityTable.column.sortAscending",{defaultMessage:"Low -> Critical"}),sortTextDesc:I.i18n.translate("xpack.csp.vulnerabilityTable.column.sortDescending",{defaultMessage:"Critical -> Low"}),icon:"dot",color:""},Pr=e=>({_script:{type:"number",script:{lang:"painless",inline:"if(doc.containsKey('vulnerability.severity') && !doc['vulnerability.severity'].empty && doc['vulnerability.severity'].size()!=0 && doc['vulnerability.severity'].value!=null && params.scores.containsKey(doc['vulnerability.severity'].value)) { return params.scores[doc['vulnerability.severity'].value];} return 0;",params:{scores:{LOW:1,MEDIUM:2,HIGH:3,CRITICAL:4}}},order:e}}),Vr=(e,t)=>({_script:{type:"string",order:t,script:{source:`doc["${e}"].value.toLowerCase()`,lang:"painless"}}}),Gr={actions:"actions",vulnerability:"vulnerability.id",cvss:"vulnerability.score.base",resourceName:"resource.name",resourceId:"resource.id",severity:"vulnerability.severity",package:"package.name",version:"package.version",fixedVersion:"package.fixed_version"},Br=e=>[{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1},id:Gr.actions,initialWidth:40,display:[],actions:!1,isSortable:!1,isResizable:!1,cellActions:[]},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1},id:Gr.vulnerability,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityTable.column.vulnerability",{defaultMessage:"Vulnerability"}),initialWidth:130,cellActions:e},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1},id:Gr.cvss,displayAsText:"CVSS",initialWidth:80,isResizable:!1,cellActions:e},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1},id:Gr.resourceId,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityTable.column.resourceId",{defaultMessage:"Resource ID"}),cellActions:e},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1},id:Gr.resourceName,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityTable.column.resourceName",{defaultMessage:"Resource Name"}),cellActions:e},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1},id:Gr.severity,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityTable.column.severity",{defaultMessage:"Severity"}),initialWidth:100,cellActions:e,schema:Rr.type},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1},id:Gr.package,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityTable.column.package",{defaultMessage:"Package"}),cellActions:e},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1},id:Gr.version,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityTable.column.version",{defaultMessage:"Version"}),cellActions:e},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1},id:Gr.fixedVersion,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityTable.column.fixVersion",{defaultMessage:"Fix Version"}),cellActions:e}],Ur=I.i18n.translate("xpack.csp.vulnerabilities.table.filterIn",{defaultMessage:"Filter in"}),Wr=I.i18n.translate("xpack.csp.vulnerabilities.table.filterOut",{defaultMessage:"Filter out"}),Hr=I.i18n.translate("xpack.csp.vulnerabilities.searchBar.placeholder",{defaultMessage:'Search vulnerabilities (eg. vulnerability.severity : "CRITICAL" )'}),Qr=I.i18n.translate("xpack.csp.vulnerabilities",{defaultMessage:"Vulnerabilities"}),Zr=()=>{const{euiTheme:e}=Object(M.useEuiTheme)(),t=Object(us.keyframes)("0%{background-color:",e.colors.warning,";}50%{background-color:",e.colors.emptyShade,";}75%{background-color:",e.colors.warning,";}100%{background-color:",e.colors.emptyShade,";}",""),i=Object(us.css)("& .euiDataGrid__content{background:transparent;}& .euiDataGridHeaderCell__icon{display:none;}& .euiDataGrid__controls{border-bottom:none;margin-bottom:",e.size.s,";& .euiButtonEmpty{font-weight:",e.font.weight.bold,";}}& .euiDataGrid__leftControls{>.euiButtonEmpty:hover:not(:disabled),.euiButtonEmpty:focus{text-decoration:none;cursor:default;}}& .euiButtonIcon{color:",e.colors.primary,";}& .euiDataGridRowCell{font-size:",e.size.m,";}& .euiDataGridRowCell__actions>[data-test-subj='euiDataGridCellExpandButton']{display:none;}& .euiDataGridRowCell__actions--overlay{padding:0;}& .euiDataGridRowCell__contentWrapper{display:flex;align-items:center;}& .euiDataGridRowCell.euiDataGridRowCell--numeric{text-align:left;}","");return{highlightStyle:Object(us.css)("& [data-test-subj='dataGridColumnSortingButton'] .euiButtonEmpty__text{animation:",t," 1s ease-out infinite;color:",e.colors.darkestShade,";}",""),gridStyle:i,groupBySelector:Object(us.css)({name:"1cj19g3",styles:"width:188px;display:inline-block;margin-left:8px"})}},Yr=e=>{const[t]=e;return"resource"===(null==t?void 0:t.value)?h.e.vulnerabilities_by_resource.path:h.e.vulnerabilities.path},Jr={resourceId:"resource.id",resourceName:"resource.name",region:"cloud.region",vulnerabilities_count:"vulnerabilities_count",severity_map:"severity_map"},qr=e=>[{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1,showSortAsc:!1,showSortDesc:!1},isSortable:!1,id:Jr.resourceId,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityByResourceTable.column.resourceId",{defaultMessage:"Resource ID"}),cellActions:e},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1,showSortAsc:!1,showSortDesc:!1},isSortable:!1,id:Jr.resourceName,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityByResourceTable.column.resourceName",{defaultMessage:"Resource Name"}),cellActions:e},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1,showSortAsc:!1,showSortDesc:!1},isSortable:!1,id:Jr.region,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityByResourceTable.column.region",{defaultMessage:"Region"}),cellActions:e,initialWidth:150},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1,showSortAsc:!1,showSortDesc:!1},isSortable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1,showSortAsc:!0,showSortDesc:!0},id:Jr.vulnerabilities_count,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityByResourceTable.column.vulnerabilities",{defaultMessage:"Vulnerabilities"}),initialWidth:140,isResizable:!1,isSortable:!0},{isExpandable:!1,actions:{showHide:!1,showMoveLeft:!1,showMoveRight:!1,showSortAsc:!1,showSortDesc:!1},isSortable:!1,id:Jr.severity_map,displayAsText:I.i18n.translate("xpack.csp.vulnerabilityByResourceTable.column.severityMap",{defaultMessage:"Severity Map"}),cellActions:e,initialWidth:110,isResizable:!1}],Kr=({query:e,sortOrder:t="desc",pageIndex:i,pageSize:a})=>({index:S.L,query:e,aggs:{total:{cardinality:{field:"resource.id"}},resources:{terms:{field:"resource.id",size:3*$.m,order:[{_count:t},{critical:"desc"},{high:"desc"},{medium:"desc"}]},aggs:{vulnerabilitiesCountBucketSort:{bucket_sort:{sort:[{_count:{order:t}}],from:i*a,size:a}},name:{terms:{field:"resource.name",size:1}},region:{terms:{field:"cloud.region",size:1}},critical:{filter:{term:{"vulnerability.severity":{value:S.ab.CRITICAL}}}},high:{filter:{term:{"vulnerability.severity":{value:S.ab.HIGH}}}},medium:{filter:{term:{"vulnerability.severity":{value:S.ab.MEDIUM}}}},low:{filter:{term:{"vulnerability.severity":{value:S.ab.LOW}}}}}}},size:0}),$r=e=>Array.isArray(e)&&e.length?e[0].key:"",Xr=e=>({resource:{id:e.key,name:$r(e.name.buckets)},cloud:{region:$r(e.region.buckets)},vulnerabilities_count:e.doc_count,severity_map:{critical:e.critical.doc_count,high:e.high.doc_count,medium:e.medium.doc_count,low:e.low.doc_count}}),el=({severityMap:e,total:t})=>{const{euiTheme:i}=Object(M.useEuiTheme)(),a=[],n=[];if(t>0){const i=Math.max(.08*t,1);let s=0;["low","medium","high","critical"].forEach((o=>{e[o]>0&&(s+=Math.max(e[o],i),a.push({stop:s,color:Zo(o.toUpperCase())})),n.push({severity:o,count:e[o],percentage:e[o]/t*100})}))}return Object(g.jsx)(M.EuiToolTip,{className:Object(us.css)({name:"qhpvho",styles:"width:256px"}),anchorClassName:Object(us.css)("height:",i.size.xl,";display:flex;align-items:center;",""),position:"left",title:I.i18n.translate("xpack.csp.vulnerabilitiesByResource.severityMap.tooltipTitle",{defaultMessage:"Severity map"}),content:Object(g.jsx)(tl,{severityMapTooltip:n})},Object(g.jsx)(M.EuiColorPaletteDisplay,{type:"fixed",palette:a,className:Object(us.css)({name:"1d3w5wq",styles:"width:100%"})}))},tl=({severityMapTooltip:e})=>{const{euiTheme:t}=Object(M.useEuiTheme)();return Object(g.jsx)(o.a.Fragment,null,e.map((e=>{return Object(g.jsx)(M.EuiFlexGroup,{justifyContent:"spaceBetween",key:e.severity,alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiText,{size:"s"},Object(g.jsx)($o,{severity:e.severity.toUpperCase()}))),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiText,{size:"s"},e.count)),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiText,{textAlign:"right",size:"s",className:Object(us.css)("width:",t.size.xxxl,";color:",t.colors.mediumShade,";","")},0===(i=e.percentage)?"0%":100===i?"100%":`${i.toFixed(1)}%`)))));var i})))},il={negate:!1},al=({filters:e,dataView:t,field:i,value:a,negate:n})=>{const s=t.fields.find((e=>e.spec.name===i));if(!s)return e;const o=Object(me.buildFilter)(t,s,me.FILTERS.PHRASE,n,!1,a,null,me.FilterStateStore.APP_STATE);return[...e.filter((e=>!Object(me.compareFilters)(e,o,il))),o]},nl=({data:e,columns:t,columnGridFn:i,pageSize:a,setUrlQuery:n,filters:s,dataView:o})=>{const r=(i,a)=>{const n=e[i];return n?((e,t,i)=>{var a,n,s,o,r,l,u,c,d,p;return i===t.vulnerability?null===(a=e.vulnerability)||void 0===a?void 0:a.id:i===t.cvss?null===(n=e.vulnerability)||void 0===n||null===(s=n.score)||void 0===s?void 0:s.base:i===t.resourceId?null===(o=e.resource)||void 0===o?void 0:o.id:i===t.resourceName?null===(r=e.resource)||void 0===r?void 0:r.name:i===t.severity?null===(l=e.vulnerability)||void 0===l?void 0:l.severity:i===t.package?null===(u=e.package)||void 0===u?void 0:u.name:i===t.version?null===(c=e.package)||void 0===c?void 0:c.version:i===t.fixedVersion?null===(d=e.package)||void 0===d?void 0:d.fixed_version:i===t.region?null===(p=e.cloud)||void 0===p?void 0:p.region:void 0})(n,t,a):null};return i([({Component:e,rowIndex:t,columnId:i})=>{const l=r(t>a-1?t%a:t,i);return l?Object(g.jsx)(M.EuiToolTip,{position:"top",content:I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesTableCell.addFilterButtonTooltip",{defaultMessage:"Add {columnId} filter",values:{columnId:i}})},Object(g.jsx)(e,{iconType:"plusInCircle","aria-label":I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesTableCell.addFilterButton",{defaultMessage:"Add {columnId} filter",values:{columnId:i}}),onClick:()=>{n({pageIndex:0,filters:al({filters:s,dataView:o,field:i,value:l,negate:!1})})}},Ur)):null},({Component:e,rowIndex:t,columnId:i})=>{const l=r(t>a-1?t%a:t,i);return l?Object(g.jsx)(M.EuiToolTip,{position:"top",content:I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesTableCell.addNegatedFilterButtonTooltip",{defaultMessage:"Add {columnId} negated filter",values:{columnId:i}})},Object(g.jsx)(e,{iconType:"minusInCircle","aria-label":I.i18n.translate("xpack.csp.vulnerabilities.vulnerabilitiesTableCell.addNegateFilterButton",{defaultMessage:"Add {columnId} negated filter",values:{columnId:i}}),onClick:()=>{n({pageIndex:0,filters:al({filters:s,dataView:o,field:i,value:l,negate:!0})})}},Wr)):null}])},sl=({query:e,filters:t})=>({query:e,filters:t,sort:[{id:Jr.vulnerabilities_count,direction:"desc"}],pageIndex:0}),ol=({dataView:e,data:t,isFetching:i,pageIndex:a,sort:n,pageSize:r,onChangeItemsPerPage:u,onChangePage:c,onSort:d,urlQuery:p,setUrlQuery:b,onResetFilters:m})=>{const j=Zr(),{isLastLimitedPage:x,limitedTotalItemCount:f}=Mi({total:null==t?void 0:t.total,pageIndex:a,pageSize:r}),y=Object(s.useMemo)((()=>null!=t&&t.page?nl({columnGridFn:qr,columns:Jr,dataView:e,pageSize:r,data:t.page,setUrlQuery:b,filters:p.filters}):[]),[t,e,r,b,p.filters]),v=Object(s.useMemo)((()=>({columnId:e,rowIndex:a})=>{var n;const s=a>r-1?a%r:a,u=null==t?void 0:t.page[s];return i?null:null!=u&&null!==(n=u.resource)&&void 0!==n&&n.id?e===Jr.resourceId?Object(g.jsx)(l.Link,{to:Object(l.generatePath)(h.e.resource_vulnerabilities.path,{resourceId:encodeURIComponent(null==u||null===(c=u.resource)||void 0===c?void 0:c.id)}),className:"eui-textTruncate",title:null==u||null===(d=u.resource)||void 0===d?void 0:d.id},null==u||null===(p=u.resource)||void 0===p?void 0:p.id):e===Jr.resourceName?Object(g.jsx)(o.a.Fragment,null,null==u||null===(b=u.resource)||void 0===b?void 0:b.name):e===Jr.region?Object(g.jsx)(o.a.Fragment,null,null==u||null===(m=u.cloud)||void 0===m?void 0:m.region):e===Jr.vulnerabilities_count?Object(g.jsx)(M.EuiBadge,{color:"hollow","data-test-subj":"vulnerability_resource_count"},u.vulnerabilities_count):e===Jr.severity_map?Object(g.jsx)(el,{total:u.vulnerabilities_count,severityMap:u.severity_map}):null:null;var c,d,p,b,m}),[null==t?void 0:t.page,r,i]);return 0===(null==t?void 0:t.page.length)?Object(g.jsx)(Je,{onResetFilters:m}):Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiProgress,{size:"xs",color:"accent",style:{opacity:i?1:0}}),Object(g.jsx)(M.EuiDataGrid,{className:j.gridStyle,"aria-label":Qr,columns:y,columnVisibility:{visibleColumns:y.map((({id:e})=>e)),setVisibleColumns:()=>{}},rowCount:f,toolbarVisibility:{showColumnSelector:!1,showDisplaySelector:!1,showKeyboardShortcuts:!1,showSortSelector:!1,showFullScreenSelector:!1,additionalControls:{left:{prepend:Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiButtonEmpty,{size:"xs",color:"text"},I.i18n.translate("xpack.csp.vulnerabilitiesByResource.totalResources",{defaultMessage:"{total, plural, one {# Resource} other {# Resources}}",values:{total:null==t?void 0:t.total}})),Object(g.jsx)(M.EuiButtonEmpty,{size:"xs",color:"text"},I.i18n.translate("xpack.csp.vulnerabilitiesByResource.totalVulnerabilities",{defaultMessage:"{total, plural, one {# Vulnerability} other {# Vulnerabilities}}",values:{total:null==t?void 0:t.total_vulnerabilities}})))},right:Object(g.jsx)(M.EuiFlexItem,{grow:!1,className:j.groupBySelector},Object(g.jsx)(at,{type:"resource",pathnameHandler:Yr}))}},gridStyle:{border:"horizontal",cellPadding:"l",stripes:!1,rowHover:"none",header:"underline"},renderCellValue:v,inMemory:{level:"enhancements"},sorting:{columns:n,onSort:d},pagination:{pageIndex:a,pageSize:r,pageSizeOptions:[10,25,100],onChangeItemsPerPage:u,onChangePage:c}}),x&&Object(g.jsx)(He,null))},rl=({dataView:e})=>{var t;const{pageIndex:i,onChangeItemsPerPage:a,onChangePage:n,pageSize:s,query:l,sort:u,onSort:c,queryError:d,urlQuery:p,setUrlQuery:b,onResetFilters:m}=ki({dataView:e,defaultQuery:sl,paginationLocalStorageKey:$.k}),{data:j,isLoading:x,isFetching:f}=(e=>{const{data:t,notifications:{toasts:i}}=Object(w.a)().services;return Object(r.useQuery)([S.L,"resource",e],(async()=>{const{rawResponse:{hits:i,aggregations:a}}=await Object(de.lastValueFrom)(t.search.search({params:Kr(e)}));if(!a)throw new Error("Failed to aggregate by resource");if(!Array.isArray(a.resources.buckets))throw new Error("Failed to group by, missing resource id");return{page:a.resources.buckets.map(Xr),total:a.total.value,total_vulnerabilities:i.total}}),{staleTime:5e3,keepPreviousData:!0,enabled:e.enabled,onError:e=>be(i,e)})})({query:l,sortOrder:null===(t=u[0])||void 0===t?void 0:t.direction,enabled:!d,pageIndex:i,pageSize:s}),h=d||null;return x&&!h?H():null!=j&&j.page||h?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(le,{dataView:e,setQuery:e=>{b({...e,pageIndex:0})},loading:f,placeholder:Hr}),Object(g.jsx)(M.EuiSpacer,{size:"m"}),h&&Object(g.jsx)(oi,{error:h}),!h&&Object(g.jsx)(ol,{dataView:e,data:j,isFetching:f,pageIndex:i,sort:u,pageSize:s,onChangeItemsPerPage:a,onChangePage:n,onSort:c,urlQuery:p,setUrlQuery:b,onResetFilters:m})):Z()},ll=({query:e,filters:t})=>({query:e,filters:t,sort:[{id:Gr.severity,direction:"desc"},{id:Gr.cvss,direction:"desc"}],pageIndex:0}),ul=({dataView:e,data:t,isFetching:i,pageIndex:a,sort:n,pageSize:r,onChangeItemsPerPage:l,onChangePage:u,onSort:c,urlQuery:d,setUrlQuery:p,onResetFilters:b})=>{const{euiTheme:m}=Object(M.useEuiTheme)(),j=Zr(),[x,f]=Object(s.useState)(!1),h=Object(s.useCallback)((e=>{c(e),e.length!==n.length&&(f(!0),setTimeout((()=>{f(!1)}),2e3))}),[c,n]),y=Object(s.useMemo)((()=>null==t?void 0:t.page[d.vulnerabilityIndex]),[null==t?void 0:t.page,d.vulnerabilityIndex]),v=Object(s.useCallback)((e=>{const i=null==t?void 0:t.page.findIndex((t=>{var i,a,n,s;return(null===(i=t.vulnerability)||void 0===i?void 0:i.id)===(null===(a=e.vulnerability)||void 0===a?void 0:a.id)&&(null===(n=t.resource)||void 0===n?void 0:n.id)===(null===(s=e.resource)||void 0===s?void 0:s.id)&&t.package.name===e.package.name&&t.package.version===e.package.version}));p({vulnerabilityIndex:i})}),[p,null==t?void 0:t.page]),{isLastLimitedPage:O,limitedTotalItemCount:k}=Mi({total:null==t?void 0:t.total,pageIndex:a,pageSize:r}),T=Object(s.useMemo)((()=>null!=t&&t.page?nl({columnGridFn:Br,columns:Gr,dataView:e,pageSize:r,data:t.page,setUrlQuery:p,filters:d.filters}).filter((e=>e.id!==Gr.resourceName&&e.id!==Gr.resourceId)):[]),[null==t?void 0:t.page,e,r,p,d.filters]),C=null==d?void 0:d.vulnerabilityIndex,S=C+a*r,w=Object(s.useMemo)((()=>({columnId:e,rowIndex:a,setCellProps:n})=>{var l;const u=a>r-1?a%r:a,c=null==t?void 0:t.page[u];return Object(s.useEffect)((()=>{n(S===a?{style:{backgroundColor:m.colors.highlight}}:{style:{backgroundColor:"inherit"}})}),[a,n]),i?null:c&&null!==(l=c.vulnerability)&&void 0!==l&&l.id?e===Gr.actions?Object(g.jsx)(M.EuiButtonIcon,{iconType:"expand","aria-label":"View",onClick:()=>{v(c)}}):e===Gr.vulnerability?Object(g.jsx)(o.a.Fragment,null,null===(d=c.vulnerability)||void 0===d?void 0:d.id):e===Gr.cvss?null!==(p=c.vulnerability.score)&&void 0!==p&&p.base&&null!==(b=c.vulnerability.score)&&void 0!==b&&b.version?Object(g.jsx)(qo,{score:c.vulnerability.score.base,version:c.vulnerability.score.version}):null:e===Gr.severity?c.vulnerability.severity?Object(g.jsx)($o,{severity:c.vulnerability.severity}):null:e===Gr.package?Object(g.jsx)(o.a.Fragment,null,null==c||null===(j=c.package)||void 0===j?void 0:j.name):e===Gr.version?Object(g.jsx)(o.a.Fragment,null,null==c||null===(x=c.package)||void 0===x?void 0:x.version):e===Gr.fixedVersion?Object(g.jsx)(o.a.Fragment,null,null==c||null===(f=c.package)||void 0===f?void 0:f.fixed_version):null:null;var d,p,b,j,x,f}),[null==t?void 0:t.page,m.colors.highlight,v,r,S,i]),E=Object(s.useCallback)((e=>{const t=e%r,i=Math.floor(e/r);p({pageIndex:i,vulnerabilityIndex:t})}),[r,p]),F=C>-1;return 0===t.page.length?Object(g.jsx)(Je,{onResetFilters:b}):Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiProgress,{size:"xs",color:"accent",style:{opacity:i?1:0}}),Object(g.jsx)(M.EuiDataGrid,{className:Object(us.cx)({[j.gridStyle]:!0},{[j.highlightStyle]:x}),"aria-label":Qr,columns:T,columnVisibility:{visibleColumns:T.map((({id:e})=>e)),setVisibleColumns:()=>{}},height:void 0,width:void 0,schemaDetectors:[Rr],rowCount:k,rowHeightsOptions:{defaultHeight:40},toolbarVisibility:{showColumnSelector:!1,showDisplaySelector:!1,showKeyboardShortcuts:!1,showFullScreenSelector:!1,additionalControls:{left:{prepend:Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiButtonEmpty,{size:"xs",color:"text"},I.i18n.translate("xpack.csp.vulnerabilities.totalVulnerabilities",{defaultMessage:"{total, plural, one {# Vulnerability} other {# Vulnerabilities}}",values:{total:null==t?void 0:t.total}})))}}},gridStyle:{border:"horizontal",cellPadding:"l",stripes:!1,rowHover:"none",header:"underline"},renderCellValue:w,inMemory:{level:"enhancements"},sorting:{columns:n,onSort:h},pagination:{pageIndex:a,pageSize:r,pageSizeOptions:[10,25,100],onChangeItemsPerPage:l,onChangePage:u}}),O&&Object(g.jsx)(He,null),F&&y&&Object(g.jsx)(Ir,{flyoutIndex:S,vulnerabilityRecord:y,totalVulnerabilitiesCount:k,onPaginate:E,closeFlyout:()=>{p({vulnerabilityIndex:-1})},isLoading:i}))},cl=({dataView:e})=>{var t,i,a,n,r,u,c,d,p;const b=Object(l.useParams)(),m=decodeURIComponent(b.resourceId),{pageIndex:j,pageSize:x,onChangeItemsPerPage:f,onChangePage:y,query:v,sort:O,onSort:k,queryError:C,urlQuery:S,setUrlQuery:w,onResetFilters:E}=ki({dataView:e,defaultQuery:ll,paginationLocalStorageKey:$.k}),F=Object(s.useMemo)((()=>O.map((({id:e,direction:t})=>e===Gr.severity?Pr(t):e===Gr.package?Vr(e,t):{[e]:t}))),[O]),{data:N,isLoading:_,isFetching:D}=Qo({query:{...v,bool:{...null==v?void 0:v.bool,filter:[...(null==v||null===(t=v.bool)||void 0===t?void 0:t.filter)||[],{term:{"resource.id":m}}]}},sort:F,enabled:!C,pageIndex:j,pageSize:x}),L=C||null;return _?H():null!=N&&N.page?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(le,{dataView:e,setQuery:e=>{w({...e,pageIndex:0})},loading:D,placeholder:Hr}),Object(g.jsx)(l.Link,{to:Object(l.generatePath)(h.e.vulnerabilities_by_resource.path)},Object(g.jsx)(M.EuiButtonEmpty,{iconType:"arrowLeft",flush:"both"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilities.resourceVulnerabilities.backToResourcesPageButtonLabel",defaultMessage:"Back to resources"}))),Object(g.jsx)(M.EuiSpacer,{size:"xs"}),Object(g.jsx)(ze,null,Object(g.jsx)(Ae,{title:I.i18n.translate("xpack.csp.vulnerabilities.resourceVulnerabilities.vulnerabilitiesPageTitle",{defaultMessage:"{resourceName} {hyphen} Vulnerabilities",values:{resourceName:null==N||null===(i=N.page[0])||void 0===i||null===(a=i.resource)||void 0===a?void 0:a.name,hyphen:null!=N&&null!==(n=N.page[0])&&void 0!==n&&null!==(r=n.resource)&&void 0!==r&&r.name?"-":""}})})),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(ot,{listItems:[{title:I.i18n.translate("xpack.csp.vulnerabilities.resourceVulnerabilities.resourceIdTitle",{defaultMessage:"Resource ID"}),description:(null==N||null===(u=N.page[0])||void 0===u||null===(c=u.resource)||void 0===c?void 0:c.id)||""},{title:I.i18n.translate("xpack.csp.vulnerabilities.resourceVulnerabilities.regionTitle",{defaultMessage:"Region"}),description:(null==N||null===(d=N.page[0])||void 0===d||null===(p=d.cloud)||void 0===p?void 0:p.region)||""}]}),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(M.EuiSpacer,{size:"m"}),L&&Object(g.jsx)(oi,{error:L}),!L&&Object(g.jsx)(ul,{dataView:e,data:N,isFetching:D,pageIndex:j,pageSize:x,urlQuery:S,setUrlQuery:w,onChangeItemsPerPage:f,onChangePage:y,onResetFilters:E,onSort:k,sort:O})):Z()},dl=({query:e,filters:t})=>({query:e,filters:t,sort:[{id:Gr.severity,direction:"desc"},{id:Gr.cvss,direction:"desc"}],pageIndex:0}),pl=({dataView:e,data:t,isFetching:i,onChangeItemsPerPage:a,onChangePage:n,onSort:r,urlQuery:l,onResetFilters:u,pageSize:c,setUrlQuery:d,pageIndex:p,sort:b})=>{const{euiTheme:m}=Object(M.useEuiTheme)(),j=Zr(),[x,f]=Object(s.useState)(!1),h=Object(s.useMemo)((()=>{if(void 0!==l.vulnerabilityIndex)return null==t?void 0:t.page[l.vulnerabilityIndex]}),[null==t?void 0:t.page,l.vulnerabilityIndex]),y=Object(s.useCallback)((e=>{r(e),e.length!==b.length&&(f(!0),setTimeout((()=>{f(!1)}),2e3))}),[r,b]),{isLastLimitedPage:v,limitedTotalItemCount:O}=Mi({total:null==t?void 0:t.total,pageIndex:p,pageSize:c}),k=Object(s.useCallback)((e=>{const i=null==t?void 0:t.page.findIndex((t=>{var i,a,n,s;return(null===(i=t.vulnerability)||void 0===i?void 0:i.id)===(null===(a=e.vulnerability)||void 0===a?void 0:a.id)&&(null===(n=t.resource)||void 0===n?void 0:n.id)===(null===(s=e.resource)||void 0===s?void 0:s.id)&&t.package.name===e.package.name&&t.package.version===e.package.version}));d({vulnerabilityIndex:i})}),[d,null==t?void 0:t.page]),T=Object(s.useMemo)((()=>null!=t&&t.page?nl({columnGridFn:Br,columns:Gr,dataView:e,pageSize:c,data:t.page,setUrlQuery:d,filters:l.filters}):[]),[null==t?void 0:t.page,e,c,d,l.filters]),[C,S]=Object(s.useState)(T.map((({id:e})=>e))),w=null==l?void 0:l.vulnerabilityIndex,E=w?w+p*c:void 0,F=Object(s.useMemo)((()=>({columnId:e,rowIndex:a,setCellProps:n})=>{var r;const l=a>c-1?a%c:a,u=null==t?void 0:t.page[l];return Object(s.useEffect)((()=>{n(E===a?{style:{backgroundColor:m.colors.highlight}}:{style:{backgroundColor:"inherit"}})}),[a,n]),i?null:u&&null!==(r=u.vulnerability)&&void 0!==r&&r.id?e===Gr.actions?Object(g.jsx)(M.EuiButtonIcon,{iconType:"expand","aria-label":"View",onClick:()=>{k(u)}}):e===Gr.vulnerability?Object(g.jsx)(o.a.Fragment,null,null===(d=u.vulnerability)||void 0===d?void 0:d.id):e===Gr.cvss?null!==(p=u.vulnerability.score)&&void 0!==p&&p.base&&null!==(b=u.vulnerability.score)&&void 0!==b&&b.version?Object(g.jsx)(qo,{score:u.vulnerability.score.base,version:u.vulnerability.score.version}):null:e===Gr.resourceName?Object(g.jsx)(o.a.Fragment,null,null===(j=u.resource)||void 0===j?void 0:j.name):e===Gr.resourceId?Object(g.jsx)(o.a.Fragment,null,null===(x=u.resource)||void 0===x?void 0:x.id):e===Gr.severity?u.vulnerability.severity?Object(g.jsx)($o,{severity:u.vulnerability.severity}):null:e===Gr.package?Object(g.jsx)(o.a.Fragment,null,null==u||null===(f=u.package)||void 0===f?void 0:f.name):e===Gr.version?Object(g.jsx)(o.a.Fragment,null,null==u||null===(h=u.package)||void 0===h?void 0:h.version):e===Gr.fixedVersion?Object(g.jsx)(o.a.Fragment,null,null==u||null===(y=u.package)||void 0===y?void 0:y.fixed_version):null:null;var d,p,b,j,x,f,h,y}),[null==t?void 0:t.page,m.colors.highlight,k,c,E,i]),N=w>-1;if(0===(null==t?void 0:t.page.length))return Object(g.jsx)(Je,{onResetFilters:u});const _={height:`calc(100vh - ${l.filters.length>0?403:363}px)`,minHeight:400};return Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiProgress,{size:"xs",color:"accent",style:{opacity:i?1:0}}),Object(g.jsx)("div",{style:_},Object(g.jsx)(M.EuiDataGrid,{className:Object(us.cx)({[j.gridStyle]:!0},{[j.highlightStyle]:x}),"aria-label":Qr,columns:T,columnVisibility:{visibleColumns:C,setVisibleColumns:S},schemaDetectors:[Rr],rowCount:O,toolbarVisibility:{showColumnSelector:!1,showDisplaySelector:!1,showKeyboardShortcuts:!1,showFullScreenSelector:!1,additionalControls:{left:{append:Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiButtonEmpty,{size:"xs",color:"text"},I.i18n.translate("xpack.csp.vulnerabilities.totalVulnerabilities",{defaultMessage:"{total, plural, one {# Vulnerability} other {# Vulnerabilities}}",values:{total:null==t?void 0:t.total}})))},right:Object(g.jsx)(M.EuiFlexItem,{grow:!1,className:j.groupBySelector},Object(g.jsx)(at,{type:"default",pathnameHandler:Yr}))}},gridStyle:{border:"horizontal",cellPadding:"l",stripes:!1,rowHover:"none",header:"underline"},renderCellValue:F,inMemory:{level:"enhancements"},sorting:{columns:b,onSort:y},pagination:{pageIndex:p,pageSize:c,pageSizeOptions:[10,25,100],onChangeItemsPerPage:a,onChangePage:n},virtualizationOptions:{overscanRowCount:20}}),v&&Object(g.jsx)(He,null)),N&&h&&Object(g.jsx)(Ir,{flyoutIndex:E,vulnerabilityRecord:h,totalVulnerabilitiesCount:O,closeFlyout:()=>{d({vulnerabilityIndex:-1})},isLoading:i}))},gl=({dataView:e})=>{const{sort:t,query:i,queryError:a,pageSize:n,pageIndex:r,onChangeItemsPerPage:l,onChangePage:u,onSort:c,urlQuery:d,setUrlQuery:p,onResetFilters:b}=ki({dataView:e,defaultQuery:dl,paginationLocalStorageKey:$.k}),m=Object(s.useMemo)((()=>t.map((({id:e,direction:t})=>e===Gr.severity?Pr(t):e===Gr.package?Vr(e,t):{[e]:t}))),[t]),{data:j,isLoading:x,isFetching:f}=Qo({query:i,sort:m,enabled:!a,pageIndex:r,pageSize:n}),h=a||null;return x&&!h?H():null!=j&&j.page||h?Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(le,{dataView:e,setQuery:e=>{p({...e,pageIndex:0})},loading:f,placeholder:Hr}),Object(g.jsx)(M.EuiSpacer,{size:"m"}),h&&Object(g.jsx)(oi,{error:h}),!h&&Object(g.jsx)(pl,{dataView:e,data:j,isFetching:f,pageIndex:r,sort:t,pageSize:n,onChangeItemsPerPage:l,onChangePage:u,onSort:c,urlQuery:d,onResetFilters:b,setUrlQuery:p})):Z()},bl=()=>{var e,t;const{data:i,isLoading:a,error:n}=re(S.L),s=E();return"indexed"!==(null==s||null===(e=s.data)||void 0===e||null===(t=e.vuln_mgmt)||void 0===t?void 0:t.status)?Object(g.jsx)(Ar,null):n?Object(g.jsx)(oi,{error:n}):a?H():i?Object(g.jsx)(f,null,Object(g.jsx)(b,{exact:!0,path:h.e.resource_vulnerabilities.path,render:()=>Object(g.jsx)(cl,{dataView:i})}),Object(g.jsx)(b,{exact:!0,path:h.e.vulnerabilities_by_resource.path,render:()=>Object(g.jsx)(rl,{dataView:i})}),Object(g.jsx)(b,{path:h.e.vulnerabilities.path,render:()=>Object(g.jsx)(gl,{dataView:i})})):Z()},ml=({lastTabSelected:e})=>{const t=Object(l.useLocation)(),i=E();if(!i.data)return null;const a=Object(pe.d)(S.Y,i.data),n=Object(pe.d)(S.A,i.data);return"configurations"===e||!e&&"not-empty"!==a&&"not-empty"===n?Object(g.jsx)(l.Redirect,{to:{search:t.search,pathname:h.e.findings_default.path}}):Object(g.jsx)(l.Redirect,{to:{search:t.search,pathname:h.e.vulnerabilities.path}})},jl=()=>{var e,t;const i=Object(l.useHistory)(),a=Object(l.useLocation)(),[n,s]=k()($.i),r=null===(e=Object(l.matchPath)(a.pathname,{path:h.e.resource_vulnerabilities.path}))||void 0===e?void 0:e.isExact,u=null===(t=Object(l.matchPath)(a.pathname,{path:h.e.resource_findings.path}))||void 0===t?void 0:t.isExact,c=!r&&!u,d=e=>e===h.e.vulnerabilities.path||e===h.e.vulnerabilities_by_resource.path;return Object(g.jsx)(o.a.Fragment,null,c&&Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiTitle,{size:"l"},Object(g.jsx)("h1",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.title",defaultMessage:"Findings"}))),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(M.EuiTabs,{size:"l"},Object(g.jsx)(M.EuiTab,{key:"configurations",onClick:()=>{s("configurations"),i.push({pathname:h.e.findings_default.path})},isSelected:!d(a.pathname)},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.tabs.misconfigurations",defaultMessage:"Misconfigurations"})),Object(g.jsx)(M.EuiTab,{key:"vuln_mgmt",onClick:()=>{s("vuln_mgmt"),i.push({pathname:h.e.vulnerabilities.path})},isSelected:d(a.pathname)},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.findings.tabs.vulnerabilities",defaultMessage:"Vulnerabilities"})))),Object(g.jsx)(f,null,Object(g.jsx)(b,{exact:!0,path:h.c.findings.path,render:()=>Object(g.jsx)(ml,{lastTabSelected:n})}),Object(g.jsx)(b,{path:h.e.findings_default.path,component:Wo}),Object(g.jsx)(b,{path:h.e.findings_by_resource.path,component:Wo}),Object(g.jsx)(b,{path:h.e.vulnerabilities.path,component:bl}),Object(g.jsx)(b,{path:h.e.vulnerabilities_by_resource.path,component:bl}),Object(g.jsx)(b,{path:"*",render:()=>Object(g.jsx)(l.Redirect,{to:h.e.findings_default.path})})))},xl=["csp_cspm_dashboard_stats"],fl=["csp_kspm_dashboard_stats"],hl=e=>S.S.replace("{policy_template}",e),yl=e=>{const{http:t}=Object(w.a)().services;return Object(r.useQuery)(xl,(()=>t.get(hl(S.v),{version:"2"})),e)},vl=e=>{const{http:t}=Object(w.a)().services;return Object(r.useQuery)(fl,(()=>t.get(hl(S.H),{version:"2"})),e)},Ol=({id:e,button:t,title:i,titleColor:a,description:n})=>{const{euiTheme:s}=Object(M.useEuiTheme)();return Object(g.jsx)(M.EuiPanel,{hasBorder:!0,paddingSize:"m","data-test-subj":e},Object(g.jsx)(M.EuiStat,{css:Object(g.css)({height:"60%",display:"flex",flexDirection:"column",justifyContent:"space-around",".euiText h6":{textTransform:"capitalize",fontSize:s.size.m}},"",""),titleSize:"s",title:i,titleColor:a,descriptionElement:"h6",description:n}),Object(g.jsx)(M.EuiHorizontalRule,{margin:"xs"}),t)},kl=({number:e,abbreviateAbove:t=999999})=>e||0===e?e<=t?Object(g.jsx)("span",null,e.toLocaleString()):Object(g.jsx)(M.EuiToolTip,{content:e.toLocaleString()},Object(g.jsx)("span",null,e.toLocaleString(void 0,{notation:"compact",maximumFractionDigits:1}))):Object(g.jsx)("span",null,I.i18n.translate("xpack.csp.compactFormattedNumber.naTitle",{defaultMessage:"N/A"})),Ml=()=>Object(g.jsx)(M.EuiFlexGroup,{justifyContent:"center",alignItems:"center","data-test-subj":"chart_is_loading"},Object(g.jsx)(M.EuiLoadingChart,{size:"m"})),Tl=()=>Object(g.jsx)(M.EuiFlexGroup,{justifyContent:"center",alignItems:"center","data-test-subj":"chart_is_error"},Object(g.jsx)(M.EuiText,{size:"xs",color:"subdued"},"Error")),Cl=({title:e,hasBorder:t=!0,isLoading:i,isError:a,children:n,rightSideItems:s,styles:o})=>{const{euiTheme:r}=Object(M.useEuiTheme)();return Object(g.jsx)(M.EuiPanel,{hasBorder:t,hasShadow:!1,style:o,"data-test-subj":"chart-panel"},Object(g.jsx)(M.EuiFlexGroup,{direction:"column",gutterSize:"m",style:{height:"100%"}},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(g.jsx)(M.EuiFlexItem,{grow:!1,style:{justifyContent:"center"}},e&&Object(g.jsx)(M.EuiTitle,{size:"s"},Object(g.jsx)("h3",{style:{lineHeight:"initial",paddingLeft:r.size.s}},e))),Object(g.jsx)(M.EuiFlexItem,{grow:!1,style:{flexDirection:"row",gap:r.size.s}},s))),Object(g.jsx)(M.EuiFlexItem,{style:{height:"100%"}},i?Object(g.jsx)(Ml,null):a?Object(g.jsx)(Tl,null):n)))};var Sl=i(42),wl={name:"3xdkux",styles:"display:flex;&:hover{text-decoration:none;}"};const El=({text:e,count:t,color:i,onClick:a})=>{const{euiTheme:n}=Object(M.useEuiTheme)();return Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiText,{size:"s",style:{fontWeight:n.font.weight.bold,marginBottom:n.size.xs}},e),Object(g.jsx)(M.EuiLink,{color:"text",onClick:a,css:wl},Object(g.jsx)(M.EuiText,{color:i,css:Object(g.css)("&:hover{border-bottom:2px solid ",i,";padding-bottom:4px;}",""),style:{fontWeight:n.font.weight.medium,fontSize:"18px"},size:"s"},Object(g.jsx)(kl,{number:t,abbreviateAbove:999}),"Â ")))},Il=({onEvalCounterClick:e,stats:t})=>Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(zl,{text:"passed",count:t.totalPassed,color:$.q.passed,onClick:()=>e(S.O),tooltipContent:I.i18n.translate("xpack.csp.complianceScoreChart.counterLink.passedFindingsTooltip",{defaultMessage:"Passed findings"})}),Object(g.jsx)(M.EuiText,{size:"s"},"Â -Â "),Object(g.jsx)(zl,{text:"failed",count:t.totalFailed,color:$.q.failed,onClick:()=>e(S.N),tooltipContent:I.i18n.translate("xpack.csp.complianceScoreChart.counterButtonLink.failedFindingsTooltip",{defaultMessage:"Failed findings"})})),Fl=({onEvalCounterClick:e,stats:t})=>{const{euiTheme:i}=Object(M.useEuiTheme)(),a={borderLeft:i.border.thin,paddingLeft:i.size.m};return Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"l",justifyContent:"spaceBetween"},Object(g.jsx)(M.EuiFlexItem,{grow:!1,style:a},Object(g.jsx)(El,{text:"Passed Findings",count:t.totalPassed,color:$.q.passed,onClick:()=>e(S.O)})),Object(g.jsx)(M.EuiFlexItem,{grow:!1,style:a},Object(g.jsx)(El,{text:"Failed Findings",count:t.totalFailed,color:$.q.failed,onClick:()=>e(S.N)})))},Nl=({compact:e,postureScore:t})=>{const{euiTheme:i}=Object(M.useEuiTheme)(),a=(e=>`${Math.round(e)}%`)(t);return Object(g.jsx)(M.EuiTitle,{css:Object(g.css)({fontSize:e?i.size.l:i.size.xxl,paddingLeft:e?i.size.s:i.size.xs,marginBottom:e?i.size.s:"none"},"",""),"data-test-subj":"dashboard-summary-section-compliance-score"},Object(g.jsx)("h3",null,a))},_l=e=>({...e,timestamp:Ne()(e.timestamp).valueOf()}),Dl=({trend:e})=>{const t=e.map(_l),{services:{charts:i}}=Object(w.a)();return Object(g.jsx)(Sl.Chart,null,Object(g.jsx)(Sl.Tooltip,{headerFormatter:({value:e})=>Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(T.FormattedDate,{value:e,month:"short",day:"numeric"}),", ",Object(g.jsx)(T.FormattedTime,{value:e}))}),Object(g.jsx)(Sl.Settings,{theme:i.theme.useChartsTheme(),baseTheme:i.theme.useChartsBaseTheme(),showLegend:!1,legendPosition:"right",locale:I.i18n.getLocale()}),Object(g.jsx)(Sl.AreaSeries,{id:"Posture Score",data:t,xScaleType:"time",xAccessor:"timestamp",yAccessors:["postureScore"]}),Object(g.jsx)(Sl.Axis,{id:"bottom-axis",position:"bottom",tickFormat:Object(Sl.timeFormatter)(Object(Sl.niceTimeFormatByDay)(2)),ticks:4}),Object(g.jsx)(Sl.Axis,{ticks:3,id:"left-axis",position:"left",gridLine:{visible:!0},domain:{min:0,max:100}}))};var Ll={name:"zjik7",styles:"display:flex"};const zl=({text:e,count:t,color:i,onClick:a,tooltipContent:n})=>{const{euiTheme:s}=Object(M.useEuiTheme)();return Object(g.jsx)(M.EuiToolTip,{content:n},Object(g.jsx)(M.EuiLink,{color:"text",onClick:a,css:Ll},Object(g.jsx)(M.EuiText,{color:i,style:{fontWeight:s.font.weight.medium},size:"s"},Object(g.jsx)(kl,{number:t,abbreviateAbove:999}),"Â "),Object(g.jsx)(M.EuiText,{size:"s"},e)))},Al=({data:e,trend:t,onEvalCounterClick:i,compact:a})=>{const{euiTheme:s}=Object(M.useEuiTheme)();return Object(g.jsx)(M.EuiFlexGroup,{direction:"column",justifyContent:"spaceBetween",style:{height:"100%"},gutterSize:"none"},Object(g.jsx)(M.EuiFlexItem,{grow:2},Object(g.jsx)(M.EuiFlexGroup,{direction:"row",justifyContent:"spaceBetween",gutterSize:"none"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(Nl,n()({},e,{compact:a}))),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none",alignItems:"flexStart",style:{paddingRight:s.size.xl}},a?Object(g.jsx)(Il,{stats:{totalPassed:e.totalPassed,totalFailed:e.totalFailed},onEvalCounterClick:i}):Object(g.jsx)(Fl,{stats:{totalPassed:e.totalPassed,totalFailed:e.totalFailed},onEvalCounterClick:i}))))),Object(g.jsx)(M.EuiFlexItem,{grow:6},Object(g.jsx)(Dl,{trend:t})))};var Rl={name:"20jspu",styles:"thead{.euiTableCellContent{padding:0;}}.euiTable .euiTableRow .euiTableRowCell{border-top:none;}"};const Pl=({data:e,maxItems:t,onCellClick:i,onViewAllClick:a,viewAllButtonTitle:n,compact:o})=>{const r=Object(s.useMemo)((()=>[{field:"name",truncateText:!0,name:o?"":I.i18n.translate("xpack.csp.dashboard.risksTable.cisSectionColumnLabel",{defaultMessage:"CIS Section"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>i(e),className:"eui-textTruncate",color:"text"},e)},{field:"postureScore",width:"115px",name:o?"":I.i18n.translate("xpack.csp.dashboard.risksTable.complianceColumnLabel",{defaultMessage:"Compliance"}),render:(e,t)=>Object(g.jsx)(Ee,{totalPassed:t.totalPassed,totalFailed:t.totalFailed})}]),[o,i]),l=((e,t)=>e.slice().sort(((e,t)=>e.postureScore-t.postureScore)).slice(0,t))(e,t);return Object(g.jsx)(M.EuiFlexGroup,{direction:"column",justifyContent:"spaceBetween",gutterSize:"none"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiInMemoryTable,{className:"risk-table",css:o?Rl:void 0,items:l,columns:r})),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)("div",null,Object(g.jsx)(M.EuiButtonEmpty,{onClick:a,iconType:"search"},n))))},Vl=(e,t=S.P)=>{const i=Object(l.useHistory)(),{services:a}=Object(w.a)();return Object(s.useCallback)(((n={})=>{const s=Object.entries(n).map((([e,i])=>((e,t,i)=>{let a=!1,n=t;return"object"==typeof t&&(a=t.negate,n=t.value),"*"===n?{query:{exists:{field:e}},meta:{type:"exists",index:i}}:{meta:{alias:null,negate:a,disabled:!1,type:"phrase",key:e,index:i},query:{match_phrase:{[e]:n}}}})(e,i,t)));i.push({pathname:e,search:xi({query:a.data.query.queryString.getDefaultQuery(),filters:s})})}),[e,i,a.data.query.queryString,t])},Gl=()=>{const{data:e}=re(S.J);return Vl(h.e.findings_default.path,null==e?void 0:e.id)},Bl=()=>Vl(h.e.vulnerabilities.path),Ul=[{type:S.e,name:"Amazon Web Services (AWS)",provider:"aws"},{type:S.h,name:"Google Cloud Platform (GCP)",provider:"gcp"},{type:S.f,name:"Azure",provider:"azure"},{type:S.i,name:"Kubernetes",benchmarkId:"cis_k8s"},{type:S.g,name:"Amazon Elastic Kubernetes Service (EKS)",benchmarkId:"cis_eks"}],Wl=({benchmarkAssets:e,benchmarkAbbreviateAbove:t=999})=>{const{euiTheme:i}=Object(M.useEuiTheme)(),a=Gl(),n=Ul.map((n=>{var s,o;const r=(null===(l=n.type,s=null==e?void 0:e.find((e=>(null==e?void 0:e.meta.benchmarkId)===l)))||void 0===s||null===(o=s.meta)||void 0===o?void 0:o.assetCount)||0;var l;return r>0&&Object(g.jsx)(M.EuiFlexItem,{key:n.type,onClick:()=>{var e,t;n.provider&&(e=n.provider,a({"cloud.provider":e})),n.benchmarkId&&(t=n.benchmarkId,a({"rule.benchmark.id":t}))},css:Object(g.css)("transition:",i.animation.normal," ease-in;border-bottom:",i.border.thick,";border-color:transparent;text-wrap:nowrap;:hover{cursor:pointer;border-color:",i.colors.darkestShade,";}","")},Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(qt,{type:n.type,name:n.name,size:"l"})),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(kl,{number:r,abbreviateAbove:t}))))}));return Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"m"},n)},Hl=e=>e===S.v?{"rule.benchmark.posture_type":S.v}:{"rule.benchmark.posture_type":{value:S.v,negate:!0}};var Ql={name:"llma2z",styles:"height:310px"};const Zl=({dashboardType:e,complianceData:t})=>{const i=Gl(),a=K(S.v),n=K(S.H),{euiTheme:o}=Object(M.useEuiTheme)(),r=Object(s.useMemo)((()=>[{id:"dashboard-counter-card-clusters-evaluated",description:e===S.H?I.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.clustersEvaluatedDescription",{defaultMessage:"Clusters Evaluated"}):I.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.accountsEvaluatedDescription",{defaultMessage:"Accounts Evaluated"}),title:Object(g.jsx)(Wl,{benchmarkAssets:t.benchmarks}),button:Object(g.jsx)(M.EuiButtonEmpty,{iconType:"listAdd",target:"_blank",href:e===S.H?n:a},e===S.H?I.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.clustersEvaluatedButtonTitle",{defaultMessage:"Enroll more clusters"}):I.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.accountsEvaluatedButtonTitle",{defaultMessage:"Enroll more accounts"}))},{id:"dashboard-counter-card-resources-evaluated",description:I.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.resourcesEvaluatedDescription",{defaultMessage:"Resources Evaluated"}),title:Object(g.jsx)(kl,{number:t.stats.resourcesEvaluated||0}),button:Object(g.jsx)(M.EuiButtonEmpty,{iconType:"search",onClick:()=>{i(Hl(e))}},I.i18n.translate("xpack.csp.dashboard.summarySection.counterCard.resourcesEvaluatedButtonTitle",{defaultMessage:"View all resources"}))}]),[t.benchmarks,t.stats.resourcesEvaluated,a,e,n,i]),l=I.i18n.translate("xpack.csp.dashboard.summarySection.complianceScorePanelTitle",{defaultMessage:"Compliance Score"});return Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"l",css:Ql,"data-test-subj":"dashboard-summary-section"},Object(g.jsx)(M.EuiFlexItem,{grow:3},Object(g.jsx)(M.EuiFlexGroup,{direction:"column"},r.map((e=>Object(g.jsx)(M.EuiFlexItem,{key:e.id},Object(g.jsx)(Ol,e)))))),Object(g.jsx)(M.EuiFlexItem,{grow:8},Object(g.jsx)(Cl,{title:l},Object(g.jsx)(Al,{id:"cloud_posture_score_chart",data:t.stats,trend:t.trend,onEvalCounterClick:t=>{i({"result.evaluation":t,...Hl(e)})}}))),Object(g.jsx)(M.EuiFlexItem,{grow:8},Object(g.jsx)(Cl,{styles:{padding:`${o.size.m} ${o.size.m} ${o.size.s} ${o.size.m}`},title:I.i18n.translate("xpack.csp.dashboard.summarySection.complianceByCisSectionPanelTitle",{defaultMessage:"Compliance By CIS Section"})},Object(g.jsx)(Pl,{data:t.groupedFindingsEvaluation,maxItems:5,onCellClick:t=>{i({"rule.section":t,"result.evaluation":S.N,...Hl(e)})},onViewAllClick:()=>{i({"result.evaluation":S.N,...Hl(e)})},viewAllButtonTitle:I.i18n.translate("xpack.csp.dashboard.risksTable.viewAllButtonTitle",{defaultMessage:"View all failed findings"})}))))};var Yl={name:"14is9qy",styles:"font-size:20px"};const Jl=({benchmark:e})=>{const t=Gl(),i=()=>t(ql(e)),a=I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisBenchmarkTooltip",{defaultMessage:"Center of Internet Security"}),n=((e,t)=>({cis_gcp:{name:I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisGcpBenchmarkName",{defaultMessage:"CIS GCP"}),assetType:I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisGcpBenchmarkAssetType",{defaultMessage:"{count, plural, one {# Project} other {# Projects}}",values:{count:t}})},cis_aws:{name:I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisAwsBenchmarkName",{defaultMessage:"CIS AWS"}),assetType:I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisAwsBenchmarkAssetType",{defaultMessage:"{count, plural, one {# Account} other {# Accounts}}",values:{count:t}})},cis_azure:{name:I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisAzureBenchmarkName",{defaultMessage:"CIS Azure"}),assetType:I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisAzureBenchmarkAssetType",{defaultMessage:"{count, plural, one {# Subscription} other {# Subscriptions}}",values:{count:t}})},cis_k8s:{name:I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisK8sBenchmarkName",{defaultMessage:"CIS Kubernetes"}),assetType:I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisK8sBenchmarkAssetType",{defaultMessage:"{count, plural, one {# Cluster} other {# Clusters}}",values:{count:t}})},cis_eks:{name:I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisEksBenchmarkName",{defaultMessage:"CIS EKS"}),assetType:I.i18n.translate("xpack.csp.dashboard.benchmarkSection.benchmarkName.cisEksBenchmarkAssetType",{defaultMessage:"{count, plural, one {# Cluster} other {# Clusters}}",values:{count:t}})}}[e]))(e.meta.benchmarkId,e.meta.assetCount),s=e.meta.benchmarkId,o=e.meta.benchmarkVersion,r=e.meta.benchmarkName;return Object(g.jsx)(M.EuiFlexGroup,{direction:"column",gutterSize:"none",justifyContent:"spaceBetween"},Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiToolTip,{position:"top",content:Object(g.jsx)(M.EuiText,null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.benchmarkTitleTooltip.benchmarkPrefixTitle",defaultMessage:"Show all findings for "}),Object(g.jsx)("strong",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.benchmarkTitleTooltip.benchmarkTitle",defaultMessage:"{benchmark}",values:{benchmark:r}})))},Object(g.jsx)(M.EuiLink,{onClick:i,color:"text"},Object(g.jsx)(M.EuiTitle,{css:Yl},Object(g.jsx)("h5",null,n.name)))),Object(g.jsx)(M.EuiLink,{onClick:i,color:"text"},Object(g.jsx)(M.EuiText,{size:"xs"},n.assetType))),Object(g.jsx)(M.EuiFlexItem,{grow:!1,style:{justifyContent:"flex-end"}},Object(g.jsx)(M.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(g.jsx)(qt,{type:s,name:`${r}`}),Object(g.jsx)(M.EuiToolTip,{content:a},Object(g.jsx)(M.EuiIcon,{type:bt.a,size:"xxl"})),Object(g.jsx)(M.EuiText,{size:"xs",color:"subdued"},o))))},ql=e=>({"rule.benchmark.id":e.meta.benchmarkId,"rule.benchmark.version":e.meta.benchmarkVersion}),Kl=({complianceData:e,dashboardType:t})=>{const{euiTheme:i}=Object(M.useEuiTheme)(),a=Gl(),[n,o]=k()($.f,"asc"),r="asc"===n,l=r?"sortUp":"sortDown",u=(e,i)=>{a({...Hl(t),...ql(e),"result.evaluation":i})},c=Object(s.useMemo)((()=>[...e.benchmarks].sort(((e,t)=>r?e.stats.postureScore-t.stats.postureScore:t.stats.postureScore-e.stats.postureScore))),[e.benchmarks,r]);return Object(g.jsx)(M.EuiPanel,{hasBorder:!0},Object(g.jsx)(M.EuiFlexGroup,{css:Object(g.css)("border-bottom:",i.border.thin,";border-bottom-color:",i.colors.lightShade,";padding-bottom:",i.size.s,";.euiTitle{font-weight:",i.font.weight.semiBold,";}button{text-align:left;}","")},Object(g.jsx)(M.EuiFlexItem,{grow:3},Object(g.jsx)(M.EuiTitle,{size:"xxs"},Object(g.jsx)("div",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.columnsHeader.benchmarks",defaultMessage:"Benchmarks"})))),Object(g.jsx)(M.EuiFlexItem,{grow:8},Object(g.jsx)("button",{"data-test-subj":"csp:dashboard-sections-table-header-score",onClick:()=>{o(r?"desc":"asc")}},Object(g.jsx)(M.EuiTitle,{size:"xxs"},Object(g.jsx)("div",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.columnsHeader.complianceScoreTitle",defaultMessage:"Compliance Score"}),Object(g.jsx)(M.EuiIcon,{className:"euiTableSortIcon",type:l}))))),Object(g.jsx)(M.EuiFlexItem,{grow:8},Object(g.jsx)(M.EuiTitle,{size:"xxs"},Object(g.jsx)("div",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.dashboard.benchmarkSection.columnsHeader.complianceByCisSectionTitle",defaultMessage:"Compliance by CIS Section"}))))),c.map((e=>Object(g.jsx)(M.EuiFlexGroup,{key:`${e.meta.benchmarkId}_${e.meta.benchmarkVersion}`,css:Object(g.css)("height:200px;padding:",i.size.base," 0 ",i.size.l,";&:not(:last-of-type){border-bottom:",i.border.thin,";}","")},Object(g.jsx)(M.EuiFlexItem,{grow:3},Object(g.jsx)(Jl,{benchmark:e})),Object(g.jsx)(M.EuiFlexItem,{grow:8,css:Object(g.css)("margin-left:-",i.size.s,";",""),"data-test-subj":"csp:dashboard-sections-table-column-score"},Object(g.jsx)(Al,{compact:!0,id:`${e.meta.benchmarkId}_score_chart`,data:e.stats,trend:e.trend,onEvalCounterClick:t=>u(e,t)})),Object(g.jsx)(M.EuiFlexItem,{grow:8},Object(g.jsx)("div",{style:{paddingRight:i.size.base}},Object(g.jsx)(Pl,{compact:!0,data:e.groupedFindingsEvaluation,maxItems:3,onCellClick:i=>((e,i)=>{a({...Hl(t),...ql(e),"rule.section":i,"result.evaluation":S.N})})(e,i),viewAllButtonTitle:I.i18n.translate("xpack.csp.dashboard.risksTable.benchmarkCardViewAllButtonTitle",{defaultMessage:"View all failed findings for this benchmark"}),onViewAllClick:()=>(e=>{u(e,S.N)})(e)})))))))},$l=S.v,Xl=S.H,eu={kspm:{testId:"cloud_posture_page_kspm_not_installed",docsLink:h.d.kspm.overviewPath,actionTitle:I.i18n.translate("xpack.csp.cloudPosturePage.kspmIntegration.packageNotInstalled.buttonLabel",{defaultMessage:"Add a KSPM integration"}),actionDescription:Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.kspmIntegration.packageNotInstalled.description",defaultMessage:"Use our {integrationFullName} (KSPM) integration to detect security misconfigurations in your Kubernetes clusters.",values:{integrationFullName:Object(g.jsx)(M.EuiLink,{href:h.d.kspm.overviewPath,target:"_blank"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.kspmIntegration.packageNotInstalled.integrationNameLabel",defaultMessage:"Kubernetes Security Posture Management"}))}})},cspm:{testId:"cloud_posture_page_cspm_not_installed",docsLink:h.d.cspm.overviewPath,actionTitle:I.i18n.translate("xpack.csp.cloudPosturePage.cspmIntegration.packageNotInstalled.buttonLabel",{defaultMessage:"Add a CSPM integration"}),actionDescription:Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.cspmIntegration.packageNotInstalled.description",defaultMessage:"Use our {integrationFullName} (CSPM) integration to detect security misconfigurations in your cloud infrastructure.",values:{integrationFullName:Object(g.jsx)(M.EuiLink,{href:h.d.cspm.overviewPath,target:"_blank"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.cloudPosturePage.cspmIntegration.packageNotInstalled.integrationNameLabel",defaultMessage:"Cloud Security Posture Management"}))}})}},tu=(e,t)=>{const i=eu[e];return{pageTitle:I.i18n.translate("xpack.csp.cloudPosturePage.packageNotInstalled.pageTitle",{defaultMessage:"Install Integration to get started"}),docsLink:i.docsLink,actionHref:t,actionTitle:i.actionTitle,actionDescription:i.actionDescription,testId:i.testId}},iu=({complianceData:e,notInstalledConfig:t,isIntegrationInstalled:i,dashboardType:a})=>{const n=!e||0===e.stats.totalFindings;return n&&!i?Object(g.jsx)(W,t):n&&i?Object(g.jsx)("div",{style:{height:"calc(100vh - 265px)",display:"flex",justifyContent:"center"}},Object(g.jsx)(M.EuiEmptyPrompt,{"data-test-subj":"no-findings-found",color:"plain",icon:Object(g.jsx)(M.EuiIcon,{type:"logoSecurity",size:"xl"}),title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.integrationDashboard.noFindings.promptTitle",defaultMessage:"Findings Evaluation Status"})),body:Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.integrationDashboard.noFindingsPrompt.promptDescription",defaultMessage:"Waiting for data to be collected and indexed. If this process is taking longer than expected then please reach out our support"}))})):Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(Zl,{complianceData:e,dashboardType:a}),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(Kl,{complianceData:e,dashboardType:a}),Object(g.jsx)(M.EuiSpacer,null))},au=e=>0===(null==e?void 0:e.stats.totalFindings)&&$.o,nu=({posturetype:e})=>{var t;const{data:i}=E({refetchInterval:t=>{var i;return"indexed"!==(null==t||null===(i=t[e])||void 0===i?void 0:i.status)&&$.o}}),a=!(null==i||!i.installedPackageVersion),n=yl({enabled:a&&e===$l,refetchInterval:au}),s=vl({enabled:a&&e===Xl,refetchInterval:au}),o=null==i||null===(t=i[e])||void 0===t?void 0:t.status,r=!a||!("indexed"===o||"not-installed"===o),l=K(S.v),u=K(S.H);let c,d,p,b;switch(e){case $l:c=l,d="cloud-dashboard-container",p=S.v,b=n;break;case Xl:c=u,d="kubernetes-dashboard-container",p=S.H,b=s}return r?Object(g.jsx)(se,{posturetype:e}):Object(g.jsx)(Y,{query:b},Object(g.jsx)("div",{"data-test-subj":d},Object(g.jsx)(iu,{dashboardType:p,complianceData:b.data,notInstalledConfig:tu(p,c),isIntegrationInstalled:"not-installed"!==o})))};var su={name:"xegb6z",styles:"margin-left:auto;margin-right:auto;height:100%"};const ou=()=>{var e,t,i,a,n;const[o,r]=Object(s.useState)($l),[l,u]=Object(s.useState)(!1),{data:c}=E(),d=!(null==c||!c.installedPackageVersion),p=yl({enabled:d}),b=vl({enabled:d});Object(s.useEffect)((()=>{if(l)return;const e=((e,t,i)=>{var a,n;const s=null==t?void 0:t.stats.totalFindings,o=null==i?void 0:i.stats.totalFindings,r=null==e||null===(a=e.cspm)||void 0===a?void 0:a.status,l=null==e||null===(n=e.kspm)||void 0===n?void 0:n.status;let u=$l;return s?u=$l:o?u=Xl:"unprivileged"!==r&&"not-installed"!==r?u=$l:"unprivileged"!==l&&"not-installed"!==l&&(u=Xl),u})(c,p.data,b.data);r(e)}),[p.data,null===(e=p.data)||void 0===e?void 0:e.stats.totalFindings,b.data,null===(t=b.data)||void 0===t?void 0:t.stats.totalFindings,c,null==c||null===(i=c.cspm)||void 0===i?void 0:i.status,null==c||null===(a=c.kspm)||void 0===a?void 0:a.status,l]);const m=Object(s.useMemo)((()=>d?[{label:I.i18n.translate("xpack.csp.dashboardTabs.cloudTab.tabTitle",{defaultMessage:"Cloud"}),"data-test-subj":"cloud-dashboard-tab",isSelected:o===$l,onClick:()=>{r($l),u(!0)},content:Object(g.jsx)(nu,{posturetype:$l})},{label:I.i18n.translate("xpack.csp.dashboardTabs.kubernetesTab.tabTitle",{defaultMessage:"Kubernetes"}),"data-test-subj":"kubernetes-dashboard-tab",isSelected:o===Xl,onClick:()=>{r(Xl),u(!0)},content:Object(g.jsx)(nu,{posturetype:Xl})}]:[]),[o,d]);return Object(g.jsx)(Y,null,Object(g.jsx)(M.EuiPageHeader,{"data-test-subj":"cloud-posture-dashboard-page-header",bottomBorder:!0,pageTitle:Object(g.jsx)(rt,{title:I.i18n.translate("xpack.csp.dashboard.cspPageTemplate.pageTitle",{defaultMessage:"Cloud Security Posture"})}),tabs:m.map((({content:e,...t})=>t))}),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)("div",{"data-test-subj":"dashboard-container",css:su},null===(n=m.find((e=>e.isSelected)))||void 0===n?void 0:n.content,!d&&Object(g.jsx)(se,{posturetype:$l})))};var ru=i(88),lu=i.n(ru);const uu=e=>{const t=null==e?void 0:e.inputs.find((e=>e.enabled));if(!t||"string"!=typeof(i=t.policy_template)||!(i in $.p)||!S.V.includes(t.type))return null;var i;const a=$.p[t.policy_template],n=a.options.find((e=>e.type===t.type));return{integration:a,enabledIntegrationOption:n}},cu=({name:e,id:t})=>{const{http:i}=Object(w.a)().services,[a,n]=N.pagePathGetters.policy_details({policyId:t});return Object(g.jsx)(M.EuiLink,{href:i.basePath.prepend([a,n].join(""))},e)},du=({packageName:e,policyId:t,packagePolicyId:i})=>{const{application:a}=Object(w.a)().services;return Object(g.jsx)(M.EuiLink,{href:a.getUrlForApp("security",{path:Object(l.generatePath)(h.b.rules.path,{packagePolicyId:i,policyId:t})})},e)},pu=e=>Object(g.jsx)(F.a,null,Object(g.jsx)(M.EuiEmptyPrompt,{color:"danger",iconType:"warning","data-test-subj":"benchmark_page_error",title:Object(g.jsx)("h2",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarksTable.errorRenderer.errorTitle",defaultMessage:"We couldn't fetch your cloud security posture benchmark data"})),body:B(e)?Object(g.jsx)("p",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarksTable.errorRenderer.errorDescription",defaultMessage:"{error} {statusCode}: {body}",values:{error:e.body.error,statusCode:e.body.statusCode,body:e.body.message}})):void 0})),gu=[{field:"package_policy.name",name:I.i18n.translate("xpack.csp.benchmarks.benchmarksTable.integrationNameColumnTitle",{defaultMessage:"Integration Name"}),render:(e,t)=>Object(g.jsx)(du,{packageName:e,packagePolicyId:t.package_policy.id,policyId:t.package_policy.policy_id}),truncateText:!0,sortable:!0,"data-test-subj":"benchmarks-table-column-integration-name"},{field:"rules_count",name:I.i18n.translate("xpack.csp.benchmarks.benchmarksTable.rulesColumnTitle",{defaultMessage:"Rules"}),truncateText:!0,"data-test-subj":"benchmarks-table-column-rules"},{field:"package_policy",name:I.i18n.translate("xpack.csp.benchmarks.benchmarksTable.integrationColumnTitle",{defaultMessage:"Integration"}),dataType:"string",truncateText:!0,"data-test-subj":"benchmarks-table-column-integration",render:e=>{var t;const i=uu(e);return(null==i||null===(t=i.integration)||void 0===t?void 0:t.shortName)||" "}},{field:"package_policy",name:I.i18n.translate("xpack.csp.benchmarks.benchmarksTable.monitoringColumnTitle",{defaultMessage:"Monitoring"}),dataType:"string",truncateText:!0,"data-test-subj":"benchmarks-table-column-monitoring",render:e=>{var t;const i=uu(e);return(null==i||null===(t=i.enabledIntegrationOption)||void 0===t?void 0:t.name)||" "}},{field:"agent_policy.name",name:I.i18n.translate("xpack.csp.benchmarks.benchmarksTable.agentPolicyColumnTitle",{defaultMessage:"Agent Policy"}),render:(e,t)=>Object(g.jsx)(cu,{name:e,id:t.agent_policy.id}),truncateText:!0,"data-test-subj":"benchmarks-table-column-agent-policy"},{field:"agent_policy.agents",name:I.i18n.translate("xpack.csp.benchmarks.benchmarksTable.numberOfAgentsColumnTitle",{defaultMessage:"Number of Agents"}),truncateText:!0,"data-test-subj":"benchmarks-table-column-number-of-agents"},{field:"package_policy.created_by",name:I.i18n.translate("xpack.csp.benchmarks.benchmarksTable.createdByColumnTitle",{defaultMessage:"Created by"}),dataType:"string",truncateText:!0,sortable:!0,"data-test-subj":"benchmarks-table-column-created-by",render:e=>Object(g.jsx)(M.EuiToolTip,{position:"top",content:e,anchorClassName:"eui-textTruncate"},Object(g.jsx)("span",null,Object(g.jsx)(M.EuiAvatar,{size:"s",name:e})," ",e))},{field:"package_policy.created_at",name:I.i18n.translate("xpack.csp.benchmarks.benchmarksTable.createdAtColumnTitle",{defaultMessage:"Created"}),dataType:"date",truncateText:!0,render:e=>Object(g.jsx)(_e,{timestamp:e}),sortable:!0,"data-test-subj":"benchmarks-table-column-created-at"}],bu=({benchmarks:e,pageIndex:t,pageSize:i,totalItemCount:a,loading:n,error:s,setQuery:o,noItemsMessage:r,sorting:l,...u})=>{const c={pageIndex:Math.max(t-1,0),pageSize:i,totalItemCount:a};return s?Object(g.jsx)(pu,{error:s}):Object(g.jsx)(M.EuiBasicTable,{"data-test-subj":u["data-test-subj"],items:e,columns:gu,itemId:e=>[e.agent_policy.id,e.package_policy.id].join("/"),pagination:c,onChange:({page:e,sort:t})=>{o({page:{...e,index:e.index+1},sort:t})},tableLayout:"fixed",loading:n,noItemsMessage:r,error:s,sorting:l})},mu=()=>{const{http:e}=Object(w.a)().services,t=N.pagePathGetters.integrations_all({searchTerm:S.t}).join("");return Object(g.jsx)(M.EuiButton,{"data-test-subj":"csp_add_integration",fill:!0,iconType:"plusInCircle",href:e.basePath.prepend(t)},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarksPageHeader.addIntegrationButtonLabel",defaultMessage:"Add Integration"}))},ju=({name:e})=>Object(g.jsx)("div",null,Object(g.jsx)(M.EuiSpacer,{size:"l"}),Object(g.jsx)(M.EuiText,null,Object(g.jsx)("strong",null,Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarkEmptyState.rulesNotFoundTitle",defaultMessage:"No benchmark rules found"}),e&&Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarkEmptyState.integrationsNotFoundForNameTitle",defaultMessage:' for "{name}"',values:{name:e}}))),Object(g.jsx)(M.EuiSpacer,{size:"s"}),Object(g.jsx)(M.EuiText,null,Object(g.jsx)(M.EuiTextColor,{color:"subdued"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.benchmarks.benchmarkEmptyState.rulesNotFoundWithFiltersTitle",defaultMessage:"We weren't able to find any benchmark rules with the above filters."}))),Object(g.jsx)(M.EuiSpacer,{size:"l"})),xu=({pageCount:e,totalCount:t})=>Object(g.jsx)(M.EuiText,{size:"xs",style:{marginLeft:8}},Object(g.jsx)(M.EuiTextColor,{color:"subdued"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.benchmarks.totalIntegrationsCountMessage",defaultMessage:"Showing {pageCount} of {totalCount, plural, one {# integration} other {# integrations}}",values:{pageCount:e,totalCount:t}}))),fu=({onSearch:e,isLoading:t})=>{const[i,a]=Object(s.useState)("");return lu()((()=>e(i)),300,[i]),Object(g.jsx)(M.EuiFlexGroup,null,Object(g.jsx)(M.EuiFlexItem,{grow:!0,style:{alignItems:"flex-end"}},Object(g.jsx)(M.EuiFieldSearch,{fullWidth:!0,onSearch:a,isLoading:t,placeholder:I.i18n.translate("xpack.csp.benchmarks.benchmarkSearchField.searchPlaceholder",{defaultMessage:"Search by Integration Name"}),incremental:!0})))},hu=()=>{var e,t,i;const{pageSize:a,setPageSize:n}=yi($.j),[o,r]=Object(s.useState)({name:"",page:1,perPage:a,sortField:"package_policy.name",sortOrder:"asc"}),l=L(o),u=(null===(e=l.data)||void 0===e?void 0:e.total)||0;return Object(g.jsx)(Y,null,Object(g.jsx)(M.EuiPageHeader,{"data-test-subj":"benchmarks-page-header",pageTitle:Object(g.jsx)(rt,{title:I.i18n.translate("xpack.csp.benchmarks.benchmarksPageHeader.benchmarkRulesTitle",{defaultMessage:"Benchmark Rules"})}),rightSideItems:[Object(g.jsx)(mu,null)],bottomBorder:!0}),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(fu,{isLoading:l.isFetching,onSearch:e=>r((t=>({...t,name:e})))}),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(xu,{pageCount:((null===(t=l.data)||void 0===t?void 0:t.items)||[]).length,totalCount:u}),Object(g.jsx)(M.EuiSpacer,{size:"s"}),Object(g.jsx)(bu,{benchmarks:(null===(i=l.data)||void 0===i?void 0:i.items)||[],"data-test-subj":"csp_benchmarks_table",error:l.error?Object(pe.c)(l.error):void 0,loading:l.isFetching,pageIndex:o.page,pageSize:a||o.perPage,sorting:{sort:{field:o.sortField,direction:o.sortOrder},allowNeutralSort:!1},totalItemCount:u,setQuery:({page:e,sort:t})=>{n(e.size),r((i=>({...i,page:e.index,perPage:e.size,sortField:(null==t?void 0:t.field)||i.sortField,sortOrder:(null==t?void 0:t.direction)||i.sortOrder})))},noItemsMessage:l.isSuccess&&!l.data.total?Object(g.jsx)(ju,{name:o.name}):void 0}))},yu="csp_rules_table_row_item_name",vu=({setPagination:e,setSelectedRuleId:t,perPage:i,rules_page:a,page:n,total:o,loading:r,error:l,selectedRuleId:u})=>{const{euiTheme:c}=Object(M.useEuiTheme)(),d=Object(s.useMemo)((()=>Ou({setSelectedRuleId:t})),[t]),p={pageIndex:n,pageSize:i,totalItemCount:o,pageSizeOptions:[10,25,100]};return Object(g.jsx)(M.EuiBasicTable,{"data-test-subj":"csp_rules_table",loading:r,error:l,items:a,columns:d,pagination:p,onChange:({page:t})=>{t&&e({page:t.index,perPage:t.size})},itemId:e=>e.metadata.id,rowProps:e=>{return{"data-test-subj":(t=e.metadata.id,`${yu}_${t}`),style:{background:e.metadata.id===u?c.colors.highlight:void 0}};var t}})},Ou=({setSelectedRuleId:e})=>[{field:"metadata.benchmark.rule_number",name:I.i18n.translate("xpack.csp.rules.rulesTable.ruleNumberColumnLabel",{defaultMessage:"Rule Number"}),width:"10%"},{field:"metadata.name",name:I.i18n.translate("xpack.csp.rules.rulesTable.nameColumnLabel",{defaultMessage:"Name"}),width:"60%",truncateText:!0,render:(t,i)=>Object(g.jsx)(M.EuiButtonEmpty,{className:"eui-textTruncate",title:t,onClick:t=>{t.stopPropagation(),e(i.metadata.id)},"data-test-subj":yu},t)},{field:"metadata.section",name:I.i18n.translate("xpack.csp.rules.rulesTable.cisSectionColumnLabel",{defaultMessage:"CIS Section"}),width:"15%"}];var ku={name:"1hetg88",styles:"max-width:300px"};const Mu=({search:e,searchValue:t,isSearching:i,totalRulesCount:a,pageSize:n,onSectionChange:o,sectionSelectOptions:r})=>{const[l,u]=Object(s.useState)([]),c=r.map((e=>({label:e})));return Object(g.jsx)(M.EuiFlexGroup,null,Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(Tu,{isSearching:i,searchValue:t,search:e,totalRulesCount:a,pageSize:n})),Object(g.jsx)(M.EuiFlexItem,{css:ku},Object(g.jsx)(M.EuiComboBox,{placeholder:I.i18n.translate("xpack.csp.rules.rulesTableHeader.sectionSelectPlaceholder",{defaultMessage:"Select CIS Section"}),singleSelection:{asPlainText:!0},options:c,selectedOptions:l,onChange:e=>{u(e),o(e.length?e[0].label:void 0)}})))},Tu=({search:e,isSearching:t,searchValue:i,totalRulesCount:a,pageSize:n})=>{const[o,r]=Object(s.useState)(i);return lu()((()=>e(o)),300,[o]),Object(g.jsx)("div",null,Object(g.jsx)(M.EuiFlexItem,{grow:!0,style:{alignItems:"flex-end"}},Object(g.jsx)(M.EuiFieldSearch,{isLoading:t,placeholder:I.i18n.translate("xpack.csp.rules.rulesTable.searchPlaceholder",{defaultMessage:"Search by Rule Name"}),value:o,onChange:e=>r(e.target.value),style:{minWidth:150},fullWidth:!0})),Object(g.jsx)(Cu,{pageSize:n,total:a}))},Cu=({pageSize:e,total:t})=>Object(g.jsx)(M.EuiFlexItem,{grow:!0},Object(g.jsx)(M.EuiSpacer,{size:"xl"}),Object(g.jsx)(M.EuiText,{size:"xs",textAlign:"left",color:"subdued",style:{marginLeft:"8px"}},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.rules.rulesTable.showingPageOfTotalLabel",defaultMessage:"Showing {pageSize} of of {total, plural, one {# rule} other {# rules}}",values:{pageSize:e,total:t}}))),Su=({search:e,page:t,perPage:i,section:a},n)=>{const{http:s}=Object(w.a)().services;return Object(r.useQuery)([S.x,{section:a,search:e,page:t,perPage:i,packagePolicyId:n}],(()=>s.get(S.D,{query:{packagePolicyId:n,page:t,perPage:i,search:e,section:a},version:S.C})))},wu=[{label:I.i18n.translate("xpack.csp.rules.ruleFlyout.overviewTabLabel",{defaultMessage:"Overview"}),id:"overview",disabled:!1},{label:I.i18n.translate("xpack.csp.rules.ruleFlyout.remediationTabLabel",{defaultMessage:"Remediation"}),id:"remediation",disabled:!1}],Eu=({onClose:e,rule:t})=>{const[i,a]=Object(s.useState)("overview");return Object(g.jsx)(M.EuiFlyout,{ownFocus:!1,onClose:e,"data-test-subj":"csp_rules_flyout_container",outsideClickCloses:!0},Object(g.jsx)(M.EuiFlyoutHeader,null,Object(g.jsx)(M.EuiTitle,{size:"l"},Object(g.jsx)("h2",null,t.metadata.name)),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(M.EuiTabs,null,wu.map((e=>Object(g.jsx)(M.EuiTab,{key:e.id,isSelected:i===e.id,onClick:()=>a(e.id),disabled:e.disabled},e.label))))),Object(g.jsx)(M.EuiFlyoutBody,null,"overview"===i&&Object(g.jsx)(Iu,{rule:t.metadata}),"remediation"===i&&Object(g.jsx)(M.EuiDescriptionList,{compressed:!1,listItems:Vt(t.metadata)})))},Iu=({rule:e})=>Object(g.jsx)(M.EuiFlexGroup,{direction:"column"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiDescriptionList,{listItems:Ut(e)}))),Fu=()=>{const e=Object(l.useParams)(),[t,i]=Object(s.useState)(null),{pageSize:a,setPageSize:n}=yi($.l),[o,r]=Object(s.useState)({section:void 0,search:"",page:0,perPage:a||10}),{data:u,status:c,error:d}=Su({section:o.section,search:o.search,page:1,perPage:1e4},e.packagePolicyId),p=Object(s.useMemo)((()=>(({status:e,data:t,error:i},a)=>{const n=(null==t?void 0:t.items)||[],s=((e,{page:t,perPage:i})=>e.slice(t*i,(t+1)*i))(n,a);return{loading:"loading"===e,error:i?Object(pe.c)(i):void 0,all_rules:n,rules_map:new Map(n.map((e=>[e.metadata.id,e]))),rules_page:s,total:(null==t?void 0:t.total)||0}})({data:u,error:d,status:c},o)),[u,d,c,o]),b=Su({page:1,perPage:1e4},e.packagePolicyId),m=Object(s.useMemo)((()=>{var e;return null===(e=b.data)||void 0===e?void 0:e.items.map((e=>e.metadata.section))}),[b.data]),j=[...new Set(m)];return Object(g.jsx)("div",{"data-test-subj":"csp_rules_container"},Object(g.jsx)(M.EuiPanel,{hasBorder:!1,hasShadow:!1},Object(g.jsx)(Mu,{onSectionChange:e=>r((t=>({...t,section:e}))),sectionSelectOptions:j,search:e=>r((t=>({...t,search:e}))),searchValue:o.search||"",totalRulesCount:p.all_rules.length,pageSize:p.rules_page.length,isSearching:"loading"===c}),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(vu,{rules_page:p.rules_page,total:p.total,error:p.error,loading:p.loading,perPage:a||o.perPage,page:o.page,setPagination:e=>{n(e.perPage),r((t=>({...t,...e})))},setSelectedRuleId:i,selectedRuleId:t})),t&&Object(g.jsx)(Eu,{rule:p.rules_map.get(t),onClose:()=>i(null)}))},Nu=({match:{params:e}})=>{var t;const{http:i}=Object(w.a)().services,a=(({packagePolicyId:e,policyId:t})=>{const{http:i}=Object(w.a)().services;return Object(r.useQuery)(["cspRulesInfo",{packagePolicyId:e,policyId:t}],(()=>Promise.all([i.get(_.packagePolicyRouteService.getInfoPath(e),{version:_.API_VERSIONS.public.v1}).then((e=>e.item)),i.get(_.agentPolicyRouteService.getInfoPath(t),{version:_.API_VERSIONS.public.v1}).then((e=>e.item))])))})(e),n=null===(t=v())||void 0===t?void 0:t.getSpyRouteComponent(),[s]=a.data||[],o=(e=>{var t;const i=uu(e),a=[];return null!=i&&null!==(t=i.integration)&&void 0!==t&&t.shortName&&a.push({title:I.i18n.translate("xpack.csp.rules.rulesPageSharedValues.integrationTitle",{defaultMessage:"Integration"}),description:null==i?void 0:i.integration.shortName}),null!=i&&i.enabledIntegrationOption?(a.push({title:I.i18n.translate("xpack.csp.rules.rulesPageSharedValues.deploymentTypeTitle",{defaultMessage:"Deployment Type"}),description:null==i?void 0:i.enabledIntegrationOption.name},{title:I.i18n.translate("xpack.csp.rules.rulesPageSharedValues.benchmarkTitle",{defaultMessage:"Benchmark"}),description:null==i?void 0:i.enabledIntegrationOption.benchmark}),a):a})(s);return Object(g.jsx)(Y,{query:a},Object(g.jsx)(M.EuiPageHeader,{alignItems:"bottom",bottomBorder:!0,pageTitle:Object(g.jsx)(M.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(g.jsx)(M.EuiFlexItem,{style:{width:"fit-content"}},Object(g.jsx)(l.Link,{to:Object(l.generatePath)(h.c.benchmarks.path)},Object(g.jsx)(M.EuiButtonEmpty,{iconType:"arrowLeft",contentProps:{style:{padding:0}}},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.rules.rulesPageHeader.benchmarkRulesButtonLabel",defaultMessage:"Benchmark Rules"})))),Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(rt,{title:I.i18n.translate("xpack.csp.rules.rulePageHeader.pageHeaderTitle",{defaultMessage:"Rules - {integrationName}",values:{integrationName:null==s?void 0:s.name}})}))),description:o.length&&Object(g.jsx)("div",{"data-test-subj":"csp_rules_shared_values"},Object(g.jsx)(ot,{listItems:o})),rightSideItems:[Object(g.jsx)(M.EuiButtonEmpty,{iconType:"gear",size:"xs",href:i.basePath.prepend(N.pagePathGetters.edit_integration(e).join(""))},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.rules.manageIntegrationButtonLabel",defaultMessage:"Manage Integration"}))]}),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(Fu,null),n&&Object(g.jsx)(n,{pageName:h.c.benchmarks.id,state:{ruleName:null==s?void 0:s.name}}))},_u=e=>{const{http:t}=Object(w.a)().services;return Object(r.useQuery)(["use-vulnerability-dashboard-api-key"],(()=>t.get(S.X)),e)},Du=[S.ab.CRITICAL,S.ab.HIGH,S.ab.MEDIUM,S.ab.LOW],Lu="all",zu={width:"100%",height:300},Au={scales:{barsPadding:.05},legend:{spacingBuffer:45}},Ru=()=>{const e=Bl();return Object(g.jsx)(M.EuiButton,{onClick:()=>e(),size:"s"},Object(g.jsx)(T.FormattedMessage,{id:"xpack.csp.vulnerabilityDashboard.viewAllButton.buttonTitle",defaultMessage:"View All"}))},Pu=({selectedAccount:e,setSelectedAccount:t,options:i=[]})=>Object(g.jsx)(M.EuiComboBox,{style:{width:320},compressed:!0,prepend:I.i18n.translate("xpack.csp.vulnerabilityDashboard.trendGraphChart.accountsDropDown.prepend.accountsTitle",{defaultMessage:"Accounts"}),options:i,singleSelection:{asPlainText:!0},isClearable:!1,selectedOptions:i.filter((t=>t.value===e)),onChange:e=>{t(e[0].value||Lu)}}),Vu=e=>{const t=[];return e.forEach((e=>{Object.values(e.vulnerabilities_stats_by_cloud_account||{}).forEach((e=>{t.find((t=>t.value===e.cloudAccountId))||t.push({label:e.cloudAccountName,value:e.cloudAccountId})}))})),t.unshift({label:I.i18n.translate("xpack.csp.vulnerabilityDashboard.trendGraphChart.accountsDropDown.option.allTitle",{defaultMessage:"All"}),value:Lu}),t},Gu=()=>{var e;const t=(null===(e=_u().data)||void 0===e?void 0:e.vulnTrends)||[],[i,a]=Object(s.useState)(Lu),n=((e,t)=>t===Lu?e.map((e=>{const{vulnerabilities_stats_by_cloud_account:t,policy_template:i,...a}=e;return a})):e.map((e=>{var i;const a=null===(i=e.vulnerabilities_stats_by_cloud_account)||void 0===i?void 0:i[t];if(a)return{"@timestamp":e["@timestamp"],...a}})).filter(pe.e))(t,i),o=Object(s.useMemo)((()=>[{id:S.ab.LOW,yAccessors:["low"],color:Zo(S.ab.LOW)},{id:S.ab.MEDIUM,yAccessors:["medium"],color:Zo(S.ab.MEDIUM)},{id:S.ab.HIGH,yAccessors:["high"],color:Zo(S.ab.HIGH)},{id:S.ab.CRITICAL,yAccessors:["critical"],color:Zo(S.ab.CRITICAL)}]),[]);return Object(g.jsx)(Cl,{title:I.i18n.translate("xpack.csp.vulnerabilityDashboard.trendGraphChart.trendBySeverityTitle",{defaultMessage:"Trend by severity"}),rightSideItems:[Object(g.jsx)(Pu,{key:"vulnerability-trend-graph-account-drop-down",options:Vu(t),selectedAccount:i,setSelectedAccount:a}),Object(g.jsx)(Ru,{key:"vulnerability-trend-graph-view-all-button"})]},Object(g.jsx)("div",{style:zu},Object(g.jsx)(Sl.Chart,null,Object(g.jsx)(Sl.Settings,{legendPosition:"right",showLegend:!0,theme:Au,locale:I.i18n.getLocale()}),Object(g.jsx)(Sl.Axis,{id:"bottom",position:"bottom",tickFormat:Object(Sl.timeFormatter)(Object(Sl.niceTimeFormatByDay)(2))}),Object(g.jsx)(Sl.Axis,{id:"left",position:"left",tickFormat:e=>e.toLocaleString()}),o.map((e=>Object(g.jsx)(Sl.BarSeries,{key:e.id,id:e.id,xAccessor:"@timestamp",yAccessors:e.yAccessors,stackAccessors:Du,data:n,color:e.color,minBarHeight:5,barSeriesStyle:{rect:{widthPixel:n.length<25?50:void 0}}}))))))},Bu=({id:e,title:t,titleColor:i,description:a,onClick:n})=>{const{euiTheme:s}=Object(M.useEuiTheme)();return Object(g.jsx)(M.EuiPanel,{hasBorder:!0,onClick:n,paddingSize:"m",css:Object(g.css)("position:relative;display:flex;align-items:center;:hover .euiIcon{color:",s.colors.primary,";transition:",s.animation.normal,";}",""),"data-test-subj":e},Object(g.jsx)(M.EuiStat,{css:Object(g.css)({height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-around",".euiText h6":{textTransform:"capitalize",fontSize:s.size.m}},"",""),titleSize:"s",title:t,titleColor:i,descriptionElement:"h6",description:a}),n&&Object(g.jsx)(M.EuiIcon,{type:"pivot",css:Object(g.css)("color:",s.colors.lightShade,";position:absolute;top:",s.size.s,";right:",s.size.s,";","")}))},Uu=()=>{const e=Bl(),t=_u(),i=Object(s.useMemo)((()=>{var i,a,n,s,o;return[{id:"critical-count-stat",title:Object(g.jsx)(kl,{number:null===(i=t.data)||void 0===i?void 0:i.cnvmStatistics.criticalCount}),description:Object(g.jsx)(M.EuiHealth,{color:Zo(S.ab.CRITICAL),textSize:"xs"},I.i18n.translate("xpack.csp.cnvmDashboard.statistics.criticalTitle",{defaultMessage:"Critical"})),onClick:()=>{e({"vulnerability.severity":S.ab.CRITICAL})}},{id:"high-count-stat",title:Object(g.jsx)(kl,{number:null===(a=t.data)||void 0===a?void 0:a.cnvmStatistics.highCount}),description:Object(g.jsx)(M.EuiHealth,{color:Zo(S.ab.HIGH),textSize:"xs"},I.i18n.translate("xpack.csp.cnvmDashboard.statistics.highTitle",{defaultMessage:"High"})),onClick:()=>{e({"vulnerability.severity":S.ab.HIGH})}},{id:"medium-count-stat",title:Object(g.jsx)(kl,{number:null===(n=t.data)||void 0===n?void 0:n.cnvmStatistics.mediumCount}),description:Object(g.jsx)(M.EuiHealth,{color:Zo(S.ab.MEDIUM),textSize:"xs"},I.i18n.translate("xpack.csp.cnvmDashboard.statistics.mediumTitle",{defaultMessage:"Medium"})),onClick:()=>{e({"vulnerability.severity":S.ab.MEDIUM})}},{id:"cloud-regions-stat",title:Object(g.jsx)(kl,{number:null===(s=t.data)||void 0===s?void 0:s.cnvmStatistics.cloudRegions}),description:I.i18n.translate("xpack.csp.cnvmDashboard.statistics.cloudRegionTitle",{defaultMessage:"Cloud Regions"})},{id:"assets-scanned-stat",title:Object(g.jsx)(kl,{number:null===(o=t.data)||void 0===o?void 0:o.cnvmStatistics.resourcesScanned}),description:I.i18n.translate("xpack.csp.cnvmDashboard.statistics.resourcesScannedTitle",{defaultMessage:"Resources Scanned"})}]}),[t.data,e]);return Object(g.jsx)(M.EuiFlexGroup,null,i.map((e=>Object(g.jsx)(M.EuiFlexItem,{key:e.id},Object(g.jsx)(Bu,e)))))};let Wu;!function(e){e.TOP_VULNERABLE_RESOURCES="topVulnerableResources",e.TOP_PATCH_VULNERABILITIES="topPatchVulnerabilities",e.TOP_VULNERABILITIES="topVulnerabilities"}(Wu||(Wu={}));const Hu={[Wu.TOP_VULNERABLE_RESOURCES]:{title:I.i18n.translate("xpack.csp.cnvmDashboardTable.panel.topVulnerableResources.title",{defaultMessage:"Top 10 vulnerable resources"})},[Wu.TOP_PATCH_VULNERABILITIES]:{title:I.i18n.translate("xpack.csp.cnvmDashboardTable.panel.topPatchVulnerabilities.title",{defaultMessage:"Top 10 patchable vulnerabilities"})},[Wu.TOP_VULNERABILITIES]:{title:I.i18n.translate("xpack.csp.cnvmDashboardTable.panel.topVulnerabilities.title",{defaultMessage:"Top 10 vulnerabilities"})}};var Qu={name:"1tjylrs",styles:"width:fit-content"};const Zu=({items:e,columns:t,tableType:i,onViewVulnerabilitiesClick:a})=>{const{euiTheme:n}=Object(M.useEuiTheme)(),{title:s}=Hu[i];return Object(g.jsx)(Cl,{title:s},Object(g.jsx)(M.EuiFlexGroup,{direction:"column","justify-content":"space-between"},Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(M.EuiBasicTable,{className:"vulnerabilityTable",css:Object(g.css)("& .euiTableHeaderCell{border-bottom:",n.border.width.thick," solid ",n.colors.darkestShade,";}",""),items:e,columns:t}),Object(g.jsx)(M.EuiSpacer,{size:"s"})),Object(g.jsx)(M.EuiFlexItem,{grow:!1},Object(g.jsx)(M.EuiButtonEmpty,{css:Qu,iconType:"search",onClick:a,size:"s"},I.i18n.translate("xpack.csp.vulnerabilityTable.panel.buttonText",{defaultMessage:"View all vulnerabilities"})))))},Yu=()=>{var e,t,i,a,n,r,l,u,c;const d=_u(),{euiTheme:p}=Object(M.useEuiTheme)(),b=Bl(),m=Vl(h.e.vulnerabilities_by_resource.path),j=Object(s.useCallback)((e=>{b(e)}),[b]),x=Object(s.useCallback)((()=>{m()}),[m]),f=Object(s.useCallback)((()=>{b()}),[b]),y=Object(s.useMemo)((()=>[{field:"resource.id",truncateText:!0,name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.resourceId",{defaultMessage:"Resource ID"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>j({"resource.id":e}),className:"eui-textTruncate"},e)},{field:"resource.name",truncateText:!0,name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.resourceName",{defaultMessage:"Resource Name"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>j({"resource.name":e}),className:"eui-textTruncate",color:"text"},e)},{field:"cloudRegion",name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.region",{defaultMessage:"Region"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>j({"cloud.region":e}),className:"eui-textTruncate",color:"text"},e),width:"140"},{field:"vulnerabilityCount",name:Object(g.jsx)("span",null,Object(g.jsx)(M.EuiIcon,{type:"sortDown",style:{marginRight:p.size.xs}}),I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.vulnerabilities",{defaultMessage:"Vulnerabilities"})),width:"120",align:"right"}]),[j,p.size.xs]),v=Object(s.useMemo)((()=>[{field:"cve",name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.cve",{defaultMessage:"CVE"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>j({"vulnerability.id":e,"package.fixed_version":"*"}),className:"eui-textTruncate"},e)},{field:"cvss",name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.version",{defaultMessage:"CVSS"}),render:e=>{if(!e.score||!e.version)return null;const t={"vulnerability.score.base":e.score};return Object(g.jsx)(M.EuiLink,{onClick:()=>j(t)},Object(g.jsx)(qo,{version:e.version,score:e.score}))}},{field:"packageFixVersion",truncateText:!0,name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topPatchableVulnerabilities.column.fixedVersion",{defaultMessage:"Fix Version"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>j({"package.fixed_version":e}),className:"eui-textTruncate",color:"text"},e)},{field:"vulnerabilityCount",name:Object(g.jsx)("span",null,Object(g.jsx)(M.EuiIcon,{type:"sortDown",style:{marginRight:p.size.xs}}),I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerableResources.column.vulnerabilityCount",{defaultMessage:"Vulnerabilities"})),align:"right"}]),[j,p.size.xs]),O=Object(s.useMemo)((()=>[{field:"cve",name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.cve",{defaultMessage:"CVE"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>j({"vulnerability.id":e}),className:"eui-textTruncate"},e)},{field:"cvss",name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.version",{defaultMessage:"CVSS"}),render:e=>{if(!e.score||!e.version)return null;const t={"vulnerability.score.base":e.score};return Object(g.jsx)(M.EuiLink,{onClick:()=>j(t)},Object(g.jsx)(qo,{version:e.version,score:e.score}))}},{field:"severity",name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.severity",{defaultMessage:"Severity"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>j({"vulnerability.severity":e}),color:"text"},Object(g.jsx)($o,{severity:e}))},{field:"packageName",truncateText:!0,name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.packageName",{defaultMessage:"Package Name"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>j({"package.name":e}),className:"eui-textTruncate",color:"text"},e)},{field:"packageVersion",truncateText:!0,name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.packageVersion",{defaultMessage:"Package Version"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>j({"package.version":e}),className:"eui-textTruncate",color:"text"},e)},{field:"packageFixVersion",truncateText:!0,name:I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.fixedVersion",{defaultMessage:"Fix Version"}),render:e=>Object(g.jsx)(M.EuiLink,{onClick:()=>j({"package.fixed_version":e}),className:"eui-textTruncate",color:"text"},e)},{field:"vulnerabilityCount",name:Object(g.jsx)("span",null,Object(g.jsx)(M.EuiIcon,{type:"sortDown",style:{marginRight:p.size.xs}}),I.i18n.translate("xpack.csp.cnvmDashboardTable.section.topVulnerability.column.vulnerabilities",{defaultMessage:"Vulnerabilities"})),align:"right"}]),[j,p.size.xs]);return Object(g.jsx)(o.a.Fragment,null,Object(g.jsx)(M.EuiFlexGroup,{direction:"row"},!(null===(e=d.data)||void 0===e||null===(t=e.topVulnerableResources)||void 0===t||!t.length)&&Object(g.jsx)(M.EuiFlexItem,null,Object(g.jsx)(Zu,{items:null===(i=d.data)||void 0===i?void 0:i.topVulnerableResources,columns:y,tableType:Wu.TOP_VULNERABLE_RESOURCES,onViewVulnerabilitiesClick:x})),Object(g.jsx)(M.EuiFlexItem,null,!(null===(a=d.data)||void 0===a||null===(n=a.topPatchableVulnerabilities)||void 0===n||!n.length)&&Object(g.jsx)(Zu,{items:null===(r=d.data)||void 0===r?void 0:r.topPatchableVulnerabilities,columns:v,tableType:Wu.TOP_PATCH_VULNERABILITIES,onViewVulnerabilitiesClick:f}))),Object(g.jsx)(M.EuiSpacer,null),!(null===(l=d.data)||void 0===l||null===(u=l.topVulnerabilities)||void 0===u||!u.length)&&Object(g.jsx)(Zu,{items:null===(c=d.data)||void 0===c?void 0:c.topVulnerabilities,columns:O,tableType:Wu.TOP_VULNERABILITIES,onViewVulnerabilitiesClick:f}))},Ju=()=>{var e,t;const i=E(),a=_u();return Object(g.jsx)(Y,{query:i},Object(g.jsx)(M.EuiPageHeader,{"data-test-subj":"vulnerability-dashboard-page-header",bottomBorder:!0,pageTitle:Object(g.jsx)(rt,{title:I.i18n.translate("xpack.csp.vulnerability_dashboard.cspPageTemplate.pageTitle",{defaultMessage:"Cloud Native Vulnerability Management"})})}),"indexed"!==(null==i||null===(e=i.data)||void 0===e||null===(t=e.vuln_mgmt)||void 0===t?void 0:t.status)?Object(g.jsx)(Ar,null):Object(g.jsx)(Y,{query:a},Object(g.jsx)("div",{"data-test-subj":"vulnerability-dashboard-container"},Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(Uu,null),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(Gu,null),Object(g.jsx)(M.EuiSpacer,null),Object(g.jsx)(Yu,null))))},qu=Object.fromEntries(Object.values(h.c).map((({id:e})=>[e,!0]))),Ku=({id:e,children:t,component:i,disabled:a=!1,...n})=>{var s;const o=null===(s=v())||void 0===s?void 0:s.getSpyRouteComponent();if(a)return null;const r={...n,...i&&{render:t=>Object(g.jsx)(C.TrackApplicationView,{viewId:e},qu[e]&&o&&Object(g.jsx)(o,{pageName:e}),Object(g.jsx)(i,t))}};return Object(g.jsx)(b,r,t)},$u=new r.QueryClient({defaultOptions:{queries:{refetchOnWindowFocus:!1}}}),Xu=({securitySolutionContext:e})=>{const t=Object(g.jsx)(r.QueryClientProvider,{client:$u},Object(g.jsx)(f,null,Object(g.jsx)(Ku,n()({},h.c.findings,{component:jl})),Object(g.jsx)(Ku,n()({},h.c.dashboard,{component:ou})),Object(g.jsx)(Ku,n()({},h.c.vulnerability_dashboard,{component:Ju})),Object(g.jsx)(Ku,h.c.benchmarks,Object(g.jsx)(f,null,Object(g.jsx)(Ku,n()({},h.b.rules,{component:Nu})),Object(g.jsx)(Ku,n()({},h.c.benchmarks,{component:hu})))),Object(g.jsx)(b,null,Object(g.jsx)(l.Redirect,{to:h.c.dashboard.path}))));return e?Object(g.jsx)(y.Provider,{value:e},t):Object(g.jsx)(o.a.Fragment,null,t)}}])]);