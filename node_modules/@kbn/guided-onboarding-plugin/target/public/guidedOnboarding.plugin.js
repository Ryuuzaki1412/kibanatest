!function(e){var t={};function i(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(n,s,function(t){return e[t]}.bind(null,s));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=16)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t,i){e.exports=i(18)(2)},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,i){i.r(t);var n=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,i){e.exports=i.p+"a8b605caa04feac6eab34454bb10435c.svg"},function(e,t,i){e.exports=i.p+"8cd9b6092e305a0cf45d0fdb3a3775f8.svg"},function(e,t,i){e.exports=i.p+"0bffeba020402fbadb3811d6aa1c7604.svg"},function(e,t,i){e.exports=i.p+"ddc7adc1a070b4a20d66ebd9676ff0c8.svg"},function(e,t,i){e.exports=i.p+"f7b0198ee3a27c5aa138358d190f60fb.gif"},function(e,t,i){e.exports=i.p+"4ca3a211c5c89ca7d5d9b33353d75938.gif"},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(19),s=i(2),a=n.__importDefault(i(20));t.default=function(e,t){var i=s.useState(t),n=i[0],o=i[1];return a.default((function(){var t=e.subscribe(o);return function(){return t.unsubscribe()}}),[e]),n}},function(e,t,i){i(17),__kbnBundles__.define("plugin/guidedOnboarding/public",i,21)},function(e,t,i){i.p=window.__kbnPublicPath__.guidedOnboarding},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t){e.exports=__kbnSharedDeps__.TsLib},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(2),s="undefined"!=typeof window?n.useLayoutEffect:n.useEffect;t.default=s},function(e,t,i){"use strict";i.r(t),i.d(t,"plugin",(function(){return ne}));var n=i(6),s=i.n(n),a=i(2),o=i.n(a),u=i(7),r=i(8);const d="/internal/guided_onboarding";var l=i(15),c=i.n(l),p=i(1),g=i(3),b=i(5),f=i.n(b),j=i(4);const h=e=>{const t=e.steps.find((e=>"in_progress"===e.status));return t?t.id:void 0},m=(e,t)=>{if(!e||"in_progress"!==e.status||!e.activeGuide)return!1;if(t){const{activeGuide:i}=e;return!(!i.isActive||i.guideId!==t)}return!0},x=(e,t,i,n)=>{if(!e||!e.isActive||e.guideId!==i)return!1;const s=e.steps.find((e=>e.id===n));return!!s&&s.status===t},O=(e,t,i)=>x(e,"in_progress",t,i),v=(e,t,i)=>x(e,"ready_to_complete",t,i);class config_service_ConfigService{constructor(){f()(this,"client",void 0),f()(this,"configs",void 0),f()(this,"isConfigInitialized",void 0)}setup(e){this.client=e,this.configs={},this.isConfigInitialized={}}async getGuideConfig(e){if(!this.client)throw new Error("ConfigService has not be initialized.");if(!this.isConfigInitialized||!this.isConfigInitialized[e])try{const{config:t}=await this.client.get(`${d}/configs/${e}`);this.isConfigInitialized||(this.isConfigInitialized={}),this.isConfigInitialized[e]=!0,this.configs||(this.configs={}),this.configs[e]=t}catch(t){this.isConfigInitialized||(this.isConfigInitialized={}),this.isConfigInitialized[e]=!0}return((e,t)=>{if(e&&t&&Object.keys(e).includes(t))return e[t]})(this.configs,e)}async getGuideStatusOnStepCompletion({isLastStepInGuide:e,isManualCompletion:t,isStepReadyToComplete:i}){return e&&!t||e&&t&&i?"ready_to_complete":"in_progress"}async isIntegrationInGuideStep(e,t){if(!e||!e.isActive)return!1;const i=((e,t)=>{const i=h(t);if(i&&e)return e.steps.find((e=>e.id===i))})(await this.getGuideConfig(e.guideId),e);return!!i&&i.integration===t}}const y=new class api_service_ApiService{constructor(){f()(this,"_isEnabled",!1),f()(this,"client",void 0),f()(this,"pluginState$",void 0),f()(this,"isLoading$",new j.BehaviorSubject(!1)),f()(this,"isGuidePanelOpen$",new j.BehaviorSubject(!1)),f()(this,"configService",new config_service_ConfigService)}setup(e,t){this._isEnabled=t,this.client=e,this.pluginState$=new j.BehaviorSubject(void 0),this.isGuidePanelOpen$=new j.BehaviorSubject(!1),this.isLoading$=new j.BehaviorSubject(!1),this.configService.setup(e)}createGetPluginStateObservable(){return new j.Observable((e=>{const t=new AbortController,i=t.signal;return this.isLoading$.next(!0),this.client.get(`${d}/state`,{signal:i}).then((({pluginState:t})=>{this.isLoading$.next(!1),e.next(t),this.pluginState$.next(t),e.complete()})).catch((t=>{this.isLoading$.next(!1),e.next({status:"error",isActivePeriod:!1}),this.pluginState$.next({status:"error",isActivePeriod:!1}),e.complete()})),()=>{this.isLoading$.next(!1),t.abort()}}))}fetchPluginState$(){if(!this._isEnabled)return Object(j.of)(void 0);if(!this.client)throw new Error("ApiService has not be initialized.");return this.pluginState$.value||this.isLoading$.value?this.pluginState$:(this.isLoading$.next(!0),Object(j.concat)(this.createGetPluginStateObservable(),this.pluginState$))}async fetchAllGuidesState(){if(this._isEnabled){if(!this.client)throw new Error("ApiService has not be initialized.");try{return await this.client.get(`${d}/guides`)}catch(e){throw e}}}async updatePluginState(e,t){if(this._isEnabled){if(!this.client)throw new Error("ApiService has not be initialized.");try{this.isLoading$.next(!0);const i=await this.client.put(`${d}/state`,{body:JSON.stringify(e)});return this.isLoading$.next(!1),this.pluginState$.next(i.pluginState),this.isGuidePanelOpen$.next(t),i}catch(e){throw this.isLoading$.next(!1),e}}}async activateGuide(e,t){if(t)return await this.updatePluginState({status:"in_progress",guide:{...t,isActive:!0}},!0);const i=await this.configService.getGuideConfig(e);if(i){const t={guideId:e,isActive:!0,status:"not_started",steps:i.steps.map(((e,t)=>{const i=0===t;return{id:e.id,status:i?"active":"inactive"}}))};return await this.updatePluginState({status:"in_progress",guide:t},!0)}}async deactivateGuide(e){return await this.updatePluginState({status:"quit",guide:{...e,isActive:!1}},!1)}async completeGuide(e){const t=await Object(j.firstValueFrom)(this.fetchPluginState$());if(!m(t,e))return;const{activeGuide:i}=t;if(Boolean(i.steps.find((e=>"complete"===e.status)))){const e={...i,isActive:!1,status:"complete"};return await this.updatePluginState({status:"complete",guide:e},!1)}}isGuideStepActive$(e,t){return this.fetchPluginState$().pipe(Object(j.map)((i=>!!m(i,e)&&O(i.activeGuide,e,t))))}isGuideStepReadyToComplete$(e,t){return this.fetchPluginState$().pipe(Object(j.map)((i=>!!m(i,e)&&v(i.activeGuide,e,t))))}async startGuideStep(e,t){const i=await Object(j.firstValueFrom)(this.fetchPluginState$());if(!m(i,e))return;const{activeGuide:n}=i,s={guideId:e,isActive:!0,status:"in_progress",steps:n.steps.map((e=>e.id===t?{id:e.id,status:"in_progress"}:e))};return await this.updatePluginState({guide:s},!1)}async completeGuideStep(e,t,i){const n=await Object(j.firstValueFrom)(this.fetchPluginState$());if(!m(n,e))return;const{activeGuide:s}=n,a=O(s,e,t),o=v(s,e,t),u=await this.configService.getGuideConfig(e),r=((e,t,i)=>null==e?void 0:e.steps.find((e=>e.id===i)))(u,s.guideId,t),d=!!r&&!!r.manualCompletion,l=((e,t,i)=>{const n=((e,t,i)=>e?e.steps.findIndex((e=>e.id===i)):-1)(e,0,i),s=(null==e?void 0:e.steps.length)||0;return s>0&&n===s-1})(u,0,t);if(a||o){const n=((e,t,i)=>{const n=e.steps.findIndex((e=>e.id===t)),s=e.steps[n];return e.steps.map(((e,t)=>{const a=e.id===s.id,o=t===n+1;return a?{id:e.id,status:i?"ready_to_complete":"complete"}:o?i?e:{id:e.id,status:"active"}:e}))})(s,t,d&&a),u={guideId:e,isActive:!0,status:await this.configService.getGuideStatusOnStepCompletion({isLastStepInGuide:l,isManualCompletion:d,isStepReadyToComplete:o}),steps:n,params:i};return await this.updatePluginState({guide:u},!d||o)}}isGuidedOnboardingActiveForIntegration$(e){return this.fetchPluginState$().pipe(Object(j.concatMap)((t=>Object(j.from)(this.configService.isIntegrationInGuideStep(null==t?void 0:t.activeGuide,e)))))}async completeGuidedOnboardingForIntegration(e){if(!e)return;const t=await Object(j.firstValueFrom)(this.fetchPluginState$());if(!m(t))return;const{activeGuide:i}=t,n=h(i);return n&&await this.configService.isIntegrationInGuideStep(i,e)?await this.completeGuideStep(i.guideId,n):void 0}async skipGuidedOnboarding(){return await this.updatePluginState({status:"skipped"},!1)}async getGuideConfig(e){if(!this._isEnabled)return;if(!this.client)throw new Error("ApiService has not be initialized.");this.isLoading$.next(!0);const t=await this.configService.getGuideConfig(e);return this.isLoading$.next(!1),t}get isEnabled(){return this._isEnabled}};var S=i(0);const E=({closeModal:e,currentGuide:t,telemetryGuideId:i,notifications:n})=>{const[s,o]=Object(a.useState)(!1);return Object(S.jsx)(p.EuiModal,{"aria-label":"quitGuideModal","data-test-subj":"onboarding--quitGuideModal",maxWidth:448,onClose:e},Object(S.jsx)(p.EuiModalHeader,null,Object(S.jsx)(p.EuiModalHeaderTitle,null,g.i18n.translate("guidedOnboarding.quitGuideModal.modalTitle",{defaultMessage:"Quit this guide?"}))),Object(S.jsx)(p.EuiModalBody,null,Object(S.jsx)(p.EuiText,null,Object(S.jsx)("p",null,g.i18n.translate("guidedOnboarding.quitGuideModal.modalDescription",{defaultMessage:"You can restart the setup guide any time from the Help menu."})))),Object(S.jsx)(p.EuiModalFooter,null,Object(S.jsx)(p.EuiButtonEmpty,{"data-test-subj":`onboarding--cancelQuitGuideButton--${i}`,onClick:e},g.i18n.translate("guidedOnboarding.quitGuideModal.cancelButtonLabel",{defaultMessage:"Cancel"})),Object(S.jsx)(p.EuiButton,{"data-test-subj":`onboarding--quitGuideButton--${i}`,onClick:async()=>{try{o(!0),await y.deactivateGuide(t),e()}catch(e){o(!1),n.toasts.addDanger({title:g.i18n.translate("guidedOnboarding.quitGuideModal.deactivateGuideError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}},isLoading:s,fill:!0,color:"warning"},g.i18n.translate("guidedOnboarding.quitGuideModal.quitButtonLabel",{defaultMessage:"Quit guide"}))))};var G=i(9),_=i.n(G),w=i(10),C=i.n(w),k=i(11),P=i.n(k),T=i(12),I=i.n(T),L={name:"3ifei",styles:">li{list-style-type:none;}margin-inline-start:0!important"},B={name:"fwdmq1",styles:"height:600px"},M={name:"eep2zz",styles:"display:flex;block-size:100%;justify-content:space-between;flex-direction:column"},$={name:"1aot8k0",styles:"flex-grow:0;padding:8px 0 0"},z={name:"3vaow",styles:"flex-grow:0;padding:16px 16px 0"},F={name:"1flj9lk",styles:"text-align:left"};const D=({button:e,isGuidePanelOpen:t,title:i,description:n})=>{const s=Object(a.useRef)(!0);Object(a.useEffect)((()=>{s.current=!1}),[]);const[o,u]=Object(a.useState)(!0);return Object(a.useEffect)((()=>{t&&!s.current&&u(!1)}),[t]),Object(S.jsx)(p.EuiPopover,{"data-test-subj":"manualCompletionPopover",button:e,isOpen:o,repositionOnScroll:!0,closePopover:()=>{}},i&&Object(S.jsx)(p.EuiTitle,{size:"xxs"},Object(S.jsx)("h3",null,i)),Object(S.jsx)(p.EuiSpacer,null),Object(S.jsx)(p.EuiText,{size:"s",style:{width:300}},n&&Object(S.jsx)("p",null,n)))},A=({pluginState:e,guideConfig:t,toggleGuidePanel:i,isGuidePanelOpen:n,navigateToLandingPage:s,isLoading:a})=>{var o;const u=(e=>{let t;return null==e||e.steps.forEach(((e,i)=>{"in_progress"!==e.status&&"ready_to_complete"!==e.status||(t=i+1),"active"===e.status&&(t=i)})),t})(null==e?void 0:e.activeGuide),r=null==e||null===(o=e.activeGuide)||void 0===o?void 0:o.steps.find((e=>"ready_to_complete"===e.status)),d=Object(S.jsx)(p.EuiButton,{isLoading:a,onClick:i,color:"success",fill:!0,size:"s","data-test-subj":"guideButton"},Boolean(u)?g.i18n.translate("guidedOnboarding.guidedSetupStepButtonLabel",{defaultMessage:"Setup guide: step {stepNumber}",values:{stepNumber:u}}):g.i18n.translate("guidedOnboarding.guidedSetupButtonLabel",{defaultMessage:"Setup guide"}));if(!e||!e.activeGuide||!e.activeGuide.isActive||"not_started"===e.activeGuide.status)return null==e||!e.isActivePeriod||"not_started"!==(null==e?void 0:e.status)&&"skipped"!==(null==e?void 0:e.status)&&"in_progress"!==e.status?"error"===(null==e?void 0:e.status)?d:null:Object(S.jsx)(p.EuiButton,{onClick:s,color:"success",fill:!0,size:"s","data-test-subj":"guideButtonRedirect"},g.i18n.translate("guidedOnboarding.guidedSetupRedirectButtonLabel",{defaultMessage:"Setup guides"}));if(r){const e=null==t?void 0:t.steps.find((e=>e.id===r.id));if(e&&e.manualCompletion)return Object(S.jsx)(D,{button:d,isGuidePanelOpen:n,title:e.manualCompletion.title,description:e.manualCompletion.description})}return d},R=({styles:e,titleId:t,toggleGuide:i,hasError:n,isGuideReadyToComplete:s,guideConfig:a,backButton:o})=>{const u=Object(S.jsx)(p.EuiButtonIcon,{iconType:"cross","aria-label":g.i18n.translate("guidedOnboarding.dropdownPanel.closeButton.ariaLabel",{defaultMessage:"Close modal"}),onClick:i,onKeyDown:e=>{e.key===p.keys.ESCAPE&&(e.preventDefault(),e.stopPropagation(),i())},color:"text",css:e.flyoutOverrides.flyoutCloseButtonIcon});return n?Object(S.jsx)("div",{css:e.flyoutOverrides.flyoutHeaderError},o,u):Object(S.jsx)("div",{css:e.flyoutOverrides.flyoutHeader},Object(S.jsx)(p.EuiSpacer,{size:"s"}),o,Object(S.jsx)(p.EuiSpacer,{size:"s"}),Object(S.jsx)(p.EuiTitle,{size:"m"},Object(S.jsx)("h2",{id:t,"data-test-subj":"guideTitle"},s?g.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideFlyoutTitle",{defaultMessage:"Well done!"}):a?a.title:"")),u,Object(S.jsx)(p.EuiHorizontalRule,null))};var q=i(13),N=i.n(q),W={name:"1se9e8c",styles:"p{margin-left:32px;margin-block-end:0;}ul{padding-left:28px;}"};const H=e=>{if("string"==typeof e)return e;const{descriptionText:t,linkText:i,linkUrl:n,isLinkExternal:s}=e;return Object(S.jsx)(o.a.Fragment,null,t,Object(S.jsx)("br",null),Object(S.jsx)(p.EuiLink,{"data-test-subj":"guidePanelStepDescriptionLink",href:n,target:s?"_blank":""},i))},Q=({accordionId:e,stepStatus:t,stepNumber:i,stepConfig:n,handleButtonClick:s,telemetryGuideId:a,isLoading:u})=>{const{euiTheme:r}=Object(p.useEuiTheme)(),d=((e,t)=>({stepNumber:Object(S.css)("width:24px;height:24px;border-radius:50%;border:2px solid ","inactive"===t?e.colors.lightShade:e.colors.success,";font-weight:",e.font.weight.medium,";text-align:center;line-height:1.4;color:","inactive"===t?e.colors.subduedText:e.colors.text,";",""),stepTitle:Object(S.css)("font-weight:",e.font.weight.semiBold,";color:","inactive"===t?e.colors.subduedText:e.colors.text,";.euiAccordion-isOpen &{color:",e.colors.title,";}",""),description:W}))(r,t),l=Object(S.jsx)(p.EuiFlexGroup,{gutterSize:"s",responsive:!1},Object(S.jsx)(p.EuiFlexItem,{grow:!1},"complete"===t?Object(S.jsx)(p.EuiIcon,{type:"checkInCircleFilled",size:"l",color:r.colors.success}):Object(S.jsx)("span",{css:d.stepNumber},i)),Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiText,{size:"m",css:d.stepTitle},n.title))),c="in_progress"===t||"active"===t||"ready_to_complete"===t;return Object(S.jsx)("div",{"data-test-subj":"guidePanelStep"},"complete"===t?Object(S.jsx)(o.a.Fragment,null,l):Object(S.jsx)(p.EuiAccordion,{id:e,buttonContent:l,arrowDisplay:"right",initialIsOpen:c},Object(S.jsx)(o.a.Fragment,null,Object(S.jsx)(p.EuiSpacer,{size:"s"}),Object(S.jsx)(p.EuiText,{size:"s","data-test-subj":"guidePanelStepDescription",css:d.description},n.description&&Object(S.jsx)("p",null,H(n.description)),n.descriptionList&&Object(S.jsx)("ul",null,n.descriptionList.map(((e,t)=>Object(S.jsx)("li",{key:`description-${t}`},H(e)))))),Object(S.jsx)(p.EuiSpacer,null),c&&Object(S.jsx)(p.EuiFlexGroup,{justifyContent:"flexEnd"},Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiButton,{isLoading:u,onClick:s,fill:!0,"data-test-subj":`onboarding--stepButton--${a}--step${i}`},(()=>{switch(t){case"active":return g.i18n.translate("guidedOnboarding.dropdownPanel.startStepButtonLabel",{defaultMessage:"Start"});case"in_progress":return g.i18n.translate("guidedOnboarding.dropdownPanel.continueStepButtonLabel",{defaultMessage:"Continue"});case"ready_to_complete":return g.i18n.translate("guidedOnboarding.dropdownPanel.markDoneStepButtonLabel",{defaultMessage:"Mark done"})}return""})()))))),Object(S.jsx)(p.EuiHorizontalRule,{margin:"l"}))},U=({guideConfig:e,styles:t,pluginState:i,isLoading:n,stepsCompleted:s,isGuideReadyToComplete:a,handleStepButtonClick:u})=>{const{flyoutStepsWrapper:r}=t.flyoutOverrides;return Object(S.jsx)(o.a.Fragment,null,s>0&&Object(S.jsx)(o.a.Fragment,null,Object(S.jsx)(p.EuiSpacer,{size:"xl"}),Object(S.jsx)(p.EuiProgress,{"data-test-subj":"guideProgress",label:a?g.i18n.translate("guidedOnboarding.dropdownPanel.completedLabel",{defaultMessage:"Completed"}):g.i18n.translate("guidedOnboarding.dropdownPanel.progressLabel",{defaultMessage:"Progress"}),value:s,valueText:g.i18n.translate("guidedOnboarding.dropdownPanel.progressValueLabel",{defaultMessage:"{stepCount} steps",values:{stepCount:`${s} / ${e.steps.length}`}}),max:e.steps.length,size:"l"}),Object(S.jsx)(p.EuiSpacer,{size:"s"})),Object(S.jsx)(p.EuiHorizontalRule,null),Object(S.jsx)("ol",{css:r},null==e?void 0:e.steps.map(((t,s)=>{var a;const o=Object(p.htmlIdGenerator)(`accordion${s}`)(),r=null==i||null===(a=i.activeGuide)||void 0===a?void 0:a.steps[s];if(r)return Object(S.jsx)("li",{key:o},Object(S.jsx)(Q,{isLoading:n,accordionId:o,stepStatus:r.status,stepConfig:t,stepNumber:s+1,handleButtonClick:()=>u(r,t),telemetryGuideId:e.telemetryId}))}))))};var V=i(14),K=i.n(V);const Y=({styles:e,guideConfig:t,isDarkTheme:i,stepsCompleted:n,isGuideReadyToComplete:s,pluginState:a,handleStepButtonClick:u,isLoading:r,completeGuide:d})=>{const l=()=>t&&t.docs?Object(S.jsx)(o.a.Fragment,null,Object(S.jsx)(p.EuiSpacer,{size:"m"}),Object(S.jsx)(p.EuiText,{size:"m"},Object(S.jsx)(p.EuiLink,{external:!0,target:"_blank",href:t.docs.url},t.docs.text))):null;return!t||!a||a&&"error"===a.status?Object(S.jsx)(p.EuiEmptyPrompt,{"data-test-subj":"guideErrorSection",iconType:"alert",color:"danger",title:Object(S.jsx)("h2",null,g.i18n.translate("guidedOnboarding.dropdownPanel.errorSectionTitle",{defaultMessage:"Unable to load the guide"})),body:Object(S.jsx)(o.a.Fragment,null,Object(S.jsx)(p.EuiText,{color:"subdued"},g.i18n.translate("guidedOnboarding.dropdownPanel.errorSectionDescription",{defaultMessage:"Wait a moment and try again. If the problem persists, contact your administrator."})),Object(S.jsx)(p.EuiSpacer,null),Object(S.jsx)(p.EuiButton,{iconSide:"right",onClick:()=>window.location.reload(),iconType:"refresh",color:"danger"},g.i18n.translate("guidedOnboarding.dropdownPanel.errorSectionReloadButton",{defaultMessage:"Reload"})))}):s?Object(S.jsx)(o.a.Fragment,null,Object(S.jsx)(p.EuiImage,{size:"l",src:i?N.a:K.a,alt:g.i18n.translate("guidedOnboarding.dropdownPanel.wellDoneAnimatedGif",{defaultMessage:"Guide completed animated gif"})}),Object(S.jsx)(p.EuiSpacer,null),Object(S.jsx)(p.EuiText,{size:"m"},Object(S.jsx)("p",{"data-test-subj":"guideDescription"},g.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideFlyoutDescription",{defaultMessage:"You've completed the Elastic {guideName} guide. Feel free to come back to the Guides for more onboarding help or a refresher.",values:{guideName:t.guideName}}))),l(),Object(S.jsx)(p.EuiSpacer,null),Object(S.jsx)(p.EuiFlexGroup,{justifyContent:"flexStart"},Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiButton,{isLoading:r,onClick:()=>d(t.completedGuideRedirectLocation),fill:!0,"data-test-subj":`onboarding--completeGuideButton--${t.telemetryId}`},g.i18n.translate("guidedOnboarding.dropdownPanel.elasticButtonLabel",{defaultMessage:"Continue using Elastic"})))),Object(S.jsx)(p.EuiSpacer,null)):Object(S.jsx)(o.a.Fragment,null,Object(S.jsx)("div",null,Object(S.jsx)(p.EuiText,{size:"m"},Object(S.jsx)("p",{"data-test-subj":"guideDescription"},t.description)),l(),Object(S.jsx)(U,{guideConfig:t,styles:e,pluginState:a,isLoading:r,handleStepButtonClick:u,isGuideReadyToComplete:s,stepsCompleted:n})))},J=({styles:e,euiTheme:t,openQuitGuideModal:i})=>Object(S.jsx)("div",{css:e.flyoutOverrides.flyoutFooter},Object(S.jsx)(p.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"xs",responsive:!1,wrap:!0},Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiButtonEmpty,{iconType:"questionInCircle",iconSide:"right",href:"https://cloud.elastic.co/support ",target:"_blank",css:e.flyoutOverrides.flyoutFooterLink,iconSize:"m"},g.i18n.translate("guidedOnboarding.dropdownPanel.footer.support",{defaultMessage:"Need help?"}))),Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiText,{size:"xs",color:t.colors.disabled},"|")),Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiButtonEmpty,{iconType:"faceHappy",iconSide:"right",href:"https://www.elastic.co/kibana/feedback",target:"_blank",css:e.flyoutOverrides.flyoutFooterLink,iconSize:"s"},g.i18n.translate("guidedOnboarding.dropdownPanel.footer.feedback",{defaultMessage:"Give feedback"}))),Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiText,{size:"xs",color:t.colors.disabled},"|")),Object(S.jsx)(p.EuiFlexItem,{grow:!1},Object(S.jsx)(p.EuiButtonEmpty,{iconType:"exit",iconSide:"right",onClick:i,"data-test-subj":"quitGuideButton",css:e.flyoutOverrides.flyoutFooterLink,iconSize:"s"},g.i18n.translate("guidedOnboarding.dropdownPanel.footer.exitGuideButtonLabel",{defaultMessage:"Quit guide"}))))),X=({isOpen:e,isDarkTheme:t,toggleGuide:i,isGuideReadyToComplete:n,guideConfig:s,styles:a,navigateToLandingPage:o,stepsCompleted:u,pluginState:r,handleStepButtonClick:d,isLoading:l,euiTheme:c,openQuitGuideModal:b,completeGuide:f})=>{if(!e)return null;const j="onboarding-guide",h=Object(S.jsx)(p.EuiButtonEmpty,{onClick:o,iconSide:"left",iconType:"arrowLeft",flush:"left",color:"text"},g.i18n.translate("guidedOnboarding.dropdownPanel.backToGuidesLink",{defaultMessage:"Back to guides"})),m=!s||!r||r&&"error"===r.status,{flyoutContentWrapper:x,flyoutBody:O,flyoutBodyWrapper:v,flyoutContainerError:y,flyoutContainer:E}=a.flyoutOverrides;return Object(S.jsx)(p.EuiPortal,null,Object(S.jsx)(p.EuiOverlayMask,null,Object(S.jsx)(p.EuiFocusTrap,{onClickOutside:i},Object(S.jsx)(p.EuiPanel,{"data-test-subj":"guidePanel","aria-labelledby":j,role:"dialog",css:m?y:E},Object(S.jsx)("div",{css:x},Object(S.jsx)(R,{styles:a,titleId:j,toggleGuide:i,guideConfig:s,isGuideReadyToComplete:n,backButton:h,hasError:m}),Object(S.jsx)("div",{css:v},Object(S.jsx)("div",{css:O},Object(S.jsx)(Y,{styles:a,guideConfig:s,pluginState:r,handleStepButtonClick:d,isLoading:l,isDarkTheme:t,stepsCompleted:u,isGuideReadyToComplete:n,completeGuide:f}))),!m&&Object(S.jsx)(J,{styles:a,euiTheme:c,openQuitGuideModal:b}))))))},Z=/\{(.*?)\}/g,ee=/[\{\}]/g,te=(e,t)=>{var i;if(null!==(i=t.activeGuide)&&void 0!==i&&i.params){let i=e;const s=e.match(Z);if(s){for(const e of s){var n;const s=e.replace(ee,"");i=i.replace(`${e}`,null===(n=t.activeGuide)||void 0===n?void 0:n.params[s])}return i}}return e},ie=({api:e,application:t,notifications:i,theme$:n})=>{var s;const u=Object(p.useEuiTheme)(),r=u.euiTheme,[d,l]=Object(a.useState)(!1),[b,f]=Object(a.useState)(!1),[j,h]=Object(a.useState)(void 0),[m,x]=Object(a.useState)(void 0),[O,v]=Object(a.useState)(!1),{darkMode:y}=c()(n,{darkMode:!1}),G=(({euiThemeContext:e,isDarkTheme:t})=>{const i=e.euiTheme,n=Object(S.css)("position:fixed;height:100%;max-height:76vh;max-inline-size:480px;max-block-size:auto;inset-inline-end:0;inset-block-start:",i.size.xxxl,";",p.euiCanAnimate,"{animation:",p.euiFlyoutSlideInRight," ",i.animation.normal," ",i.animation.resistance,";}@media (max-width: ",i.breakpoint.m,"px){max-height:85vh;})@media (min-width: ",i.breakpoint.m,"px){right:calc(",i.size.s," + 128px);}","");return{setupButton:Object(S.css)("margin-right:",i.size.m,";",""),wellDoneAnimatedPrompt:F,flyoutOverrides:{flyoutContainer:Object(S.css)(n,";background:",i.colors.emptyShade," url(",t?C.a:_.a,") top right no-repeat;padding:0;",""),flyoutContainerError:Object(S.css)(n,";padding:24px;",""),flyoutHeader:z,flyoutHeaderError:$,flyoutContentWrapper:M,flyoutCloseButtonIcon:Object(S.css)("position:absolute;inset-block-start:",i.size.base,";inset-inline-end:",i.size.base,";",""),flyoutBodyWrapper:Object(S.css)(Object(p.logicalCSS)("height","100%")," ",Object(p.logicalCSSWithFallback)("overflow-y","hidden")," flex-grow:1;",""),flyoutBody:Object(S.css)(Object(p.euiYScroll)(e)," padding:16px 10px 0 16px;",""),flyoutBodyError:B,flyoutStepsWrapper:L,flyoutFooter:Object(S.css)("border-radius:0 0 6px 6px;background:url(",t?I.a:P.a,") 0 36px no-repeat;padding:24px 30px;height:125px;flex-grow:0;",""),flyoutFooterLink:Object(S.css)("color:",i.colors.darkShade,";font-weight:400;","")}}})({euiThemeContext:u,isDarkTheme:y}),w=()=>{l((e=>!e))},k=Object(a.useCallback)((async(n,s)=>{if(j){const{id:o,status:u}=n,r=j.activeGuide.guideId;try{if("ready_to_complete"===u)return await e.completeGuideStep(r,o);var a;"active"!==u&&"in_progress"!==u||(await e.startGuideStep(r,o),s.location&&(await t.navigateToApp(s.location.appID,{path:te(s.location.path,j)}),null!==(a=s.manualCompletion)&&void 0!==a&&a.readyToCompleteOnNavigation&&await e.completeGuideStep(r,o)))}catch(e){i.toasts.addDanger({title:g.i18n.translate("guidedOnboarding.dropdownPanel.stepHandlerError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}}}),[e,t,i.toasts,j]),T=()=>{l(!1),t.navigateToApp("home",{path:"#getting_started"})};Object(a.useEffect)((()=>{const t=e.fetchPluginState$().subscribe((e=>{h(e)}));return()=>t.unsubscribe()}),[e]),Object(a.useEffect)((()=>{const t=e.isLoading$.subscribe((e=>{v(e)}));return()=>t.unsubscribe()}),[e]),Object(a.useEffect)((()=>{const t=e.isGuidePanelOpen$.subscribe((e=>{l(e)}));return()=>t.unsubscribe()}),[e]);const D=Object(a.useCallback)((async()=>{var t;if(null!=j&&null!==(t=j.activeGuide)&&void 0!==t&&t.guideId){const t=await e.getGuideConfig(j.activeGuide.guideId);t&&x(t)}}),[e,j]);Object(a.useEffect)((()=>{D()}),[D]);const R=(q=null==j?void 0:j.activeGuide)?q.steps.reduce(((e,t)=>("complete"===t.status&&(e+=1),e)),0):0;var q;const N="ready_to_complete"===(null==j||null===(s=j.activeGuide)||void 0===s?void 0:s.status);return Object(S.jsx)(o.a.Fragment,null,Object(S.jsx)("div",{css:G.setupButton},Object(S.jsx)(A,{isLoading:O,pluginState:j,guideConfig:m,toggleGuidePanel:w,isGuidePanelOpen:d,navigateToLandingPage:T})),Object(S.jsx)(X,{isOpen:d,isLoading:O,styles:G,toggleGuide:w,isDarkTheme:y,stepsCompleted:R,isGuideReadyToComplete:N,guideConfig:m,navigateToLandingPage:T,pluginState:j,handleStepButtonClick:k,openQuitGuideModal:()=>{l(!1),f(!0)},euiTheme:r,completeGuide:async n=>{try{if(await e.completeGuide(j.activeGuide.guideId),n){const{appID:e,path:i}=n;t.navigateToApp(e,{path:i})}}catch(e){i.toasts.addDanger({title:g.i18n.translate("guidedOnboarding.dropdownPanel.completeGuideError",{defaultMessage:"Unable to update the guide. Wait a moment and try again."}),text:e.message})}}}),b&&Object(S.jsx)(E,{closeModal:()=>{f(!1)},currentGuide:j.activeGuide,telemetryGuideId:m.telemetryId,notifications:i}))};class plugin_GuidedOnboardingPlugin{constructor(){}setup(e,{cloud:t}){return{cloud:t}}start(e,{cloud:t}){const{chrome:i,http:n,theme:s,application:a,notifications:o}=e,u=!(null==t||!t.isCloudEnabled||!a.capabilities.guidedOnboardingFeature.enabled);return y.setup(n,u),u&&i.navControls.registerExtension({order:1e3,mount:e=>this.mount({targetDomElement:e,theme$:s.theme$,api:y,application:a,notifications:o})}),{guidedOnboardingApi:y}}stop(){}mount({targetDomElement:e,theme$:t,api:i,application:n,notifications:a}){return s.a.render(Object(S.jsx)(r.KibanaThemeProvider,{theme$:t},Object(S.jsx)(u.I18nProvider,null,Object(S.jsx)(ie,{api:i,application:n,notifications:a,theme$:t}))),e),()=>s.a.unmountComponentAtNode(e)}}function ne(){return new plugin_GuidedOnboardingPlugin}}]);