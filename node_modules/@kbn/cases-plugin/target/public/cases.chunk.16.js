/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[16],{149:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const s={jira:["jira"],resilient:["resilient"],servicenow:["servicenow"],jiraGetFieldsByIssueType:(e,t)=>[...s.jira,e,"getFields",t],jiraGetIssueTypes:e=>[...s.jira,e,"getIssueType"],jiraGetIssues:(e,t)=>[...s.jira,e,"getIssues",t],resilientGetIncidentTypes:e=>[...s.resilient,e,"getIncidentTypes"],resilientGetSeverity:e=>[...s.resilient,e,"getSeverity"],servicenowGetChoices:(e,t)=>[...s.servicenow,e,"getChoices",t]}},151:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));const s=({connector_id:e,service_message:t,...n})=>({...n,actionId:e,...t&&{serviceMessage:t}})},185:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return l}));var s=n(84);n(89),n(94),n(3);var i=n(151);async function a({http:e,connectorId:t,signal:n}){const a=await e.post(Object(s.b)(t),{body:JSON.stringify({params:{subAction:"issueTypes",subActionParams:{}}}),signal:n});return Object(i.a)(a)}async function r({http:e,connectorId:t,id:n,signal:a}){const r=await e.post(Object(s.b)(t),{body:JSON.stringify({params:{subAction:"fieldsByIssueType",subActionParams:{id:n}}}),signal:a});return Object(i.a)(r)}async function l({http:e,connectorId:t,title:n,signal:a}){const r=await e.post(Object(s.b)(t),{body:JSON.stringify({params:{subAction:"issues",subActionParams:{title:n}}}),signal:a});return Object(i.a)(r)}},225:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var s=n(46),i=n(47),a=n(149),r=n(185),l=n(160);const o=({http:e,connector:t})=>{var n;const{showErrorToast:o}=Object(i.a)();return Object(s.useQuery)(a.a.jiraGetIssueTypes(null!==(n=null==t?void 0:t.id)&&void 0!==n?n:""),(({signal:n})=>{var s;return Object(r.b)({http:e,signal:n,connectorId:null!==(s=null==t?void 0:t.id)&&void 0!==s?s:""})}),{enabled:Boolean(t),staleTime:6e4,onSuccess:e=>{var t;e.status&&"error"===e.status&&o(new Error(l.d),{title:l.d,toastMessage:`${null!==(t=e.serviceMessage)&&void 0!==t?t:e.message}`})},onError:e=>{o(e,{title:l.d})}})}},341:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return I}));var s=n(1),i=n.n(s),a=n(26),r=n(5),l=n(27),o=n(24),c=n(88),u=n(12),d=n(160),p=n(6),v=n(225),b=n(46),g=n(47),m=n(185),y=n(149),j=n(178),h=n.n(j);const E=({actionConnector:e})=>{var t;const[n,a]=Object(s.useState)(null),[l,c]=Object(s.useState)([]),{http:v}=Object(p.g)().services,{isFetching:j,data:E}=(({http:e,actionConnector:t,query:n})=>{var i;const[a,r]=Object(s.useState)(n);h()((()=>{r(n)}),500,[n]);const{showErrorToast:l}=Object(g.a)();return Object(b.useQuery)(y.a.jiraGetIssues(null!==(i=null==t?void 0:t.id)&&void 0!==i?i:"",null!=a?a:""),(({signal:s})=>{var i;return Object(m.c)({http:e,signal:s,connectorId:null!==(i=null==t?void 0:t.id)&&void 0!==i?i:"",title:null!=n?n:""})}),{enabled:Boolean(t)&&!Object(u.isEmpty)(n),staleTime:6e4,onSuccess:e=>{var t;e.status&&"error"===e.status&&l(new Error(d.b),{title:d.b,toastMessage:`${null!==(t=e.serviceMessage)&&void 0!==t?t:e.message}`})},onError:e=>{l(e,{title:d.b})}})})({http:v,actionConnector:e,query:n}),f=(null!==(t=null==E?void 0:E.data)&&void 0!==t?t:[]).map((e=>({label:e.title,value:e.key})));return i.a.createElement(o.UseField,{path:"fields.parent"},(e=>{const{isInvalid:t,errorMessage:n}=Object(o.getFieldValidityAndErrorMessage)(e);return i.a.createElement(r.EuiFormRow,{id:"indexConnectorSelectSearchBox",fullWidth:!0,label:d.f,isInvalid:t,error:n},i.a.createElement(r.EuiComboBox,{fullWidth:!0,singleSelection:!0,async:!0,placeholder:d.i,"aria-label":d.h,isLoading:j,isInvalid:t,noSuggestions:!f.length,options:f,"data-test-subj":"search-parent-issues","data-testid":"search-parent-issues",selectedOptions:l,onChange:t=>{var n;c(t),e.setValue(null!==(n=t[0].value)&&void 0!==n?n:"")},onSearchChange:e=>{a(e)}}))}))};E.displayName="SearchIssues";const f=Object(s.memo)(E),{emptyField:O}=c.fieldValidators,I=({connector:e})=>{var t;const[{fields:n}]=Object(o.useFormData)(),{http:c}=Object(p.g)().services,{issueType:j}=null!=n?n:{},{isLoading:h,isFetching:E,data:I}=Object(v.a)({connector:e,http:c}),S=(null!==(t=null==I?void 0:I.data)&&void 0!==t?t:[]).map((e=>{var t,n;return{text:null!==(t=e.name)&&void 0!==t?t:"",value:null!==(n=e.id)&&void 0!==n?n:""}})),{isLoading:F,isFetching:T,data:w}=(({http:e,connector:t,issueType:n})=>{var s;const{showErrorToast:i}=Object(g.a)();return Object(b.useQuery)(y.a.jiraGetFieldsByIssueType(null!==(s=null==t?void 0:t.id)&&void 0!==s?s:"",null!=n?n:""),(({signal:s})=>{var i;return Object(m.a)({http:e,signal:s,connectorId:null!==(i=null==t?void 0:t.id)&&void 0!==i?i:"",id:null!=n?n:""})}),{enabled:Boolean(t)&&!Object(u.isEmpty)(n),staleTime:6e4,onSuccess:e=>{var t;e.status&&"error"===e.status&&i(new Error(d.a),{title:d.a,toastMessage:`${null!==(t=e.serviceMessage)&&void 0!==t?t:e.message}`})},onError:e=>{i(e,{title:d.a})}})})({connector:e,http:c,issueType:j}),G=null==w?void 0:w.data,x=null!=(null==G?void 0:G.priority),C=null!=(null==G?void 0:G.parent),M=h||E,B=F||T,A=Object(s.useMemo)((()=>{var e,t;const n=null!==(e=null==G||null===(t=G.priority)||void 0===t?void 0:t.allowedValues)&&void 0!==e?e:[];return Object(a.map)((e=>({text:e.name,value:e.name})),n)}),[G]);return i.a.createElement("div",{"data-test-subj":"connector-fields-jira"},i.a.createElement(o.UseField,{path:"fields.issueType",component:l.SelectField,config:{label:d.c,validations:[{validator:O(d.e)}]},componentProps:{euiFieldProps:{"data-test-subj":"issueTypeSelect",options:S,fullWidth:!0,disabled:M,isLoading:M,hasNoInitialSelection:!0}}}),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiSkeletonText,{lines:5,size:"m",isLoading:B&&!M&&!Object(u.isEmpty)(j),"data-test-subj":"fields-by-issue-type-loading"},i.a.createElement("div",{style:{display:C?"block":"none"}},i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(f,{actionConnector:e}))),i.a.createElement(r.EuiSpacer,{size:"m"})),i.a.createElement("div",{style:{display:x?"block":"none"}},i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(o.UseField,{path:"fields.priority",component:l.SelectField,config:{label:d.g},componentProps:{euiFieldProps:{"data-test-subj":"prioritySelect",options:A,fullWidth:!0,disabled:M||B,isLoading:B}}}))))))};I.displayName="JiraFields"}}]);