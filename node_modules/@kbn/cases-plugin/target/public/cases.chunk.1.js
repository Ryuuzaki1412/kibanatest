/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[1],{150:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"m",(function(){return c})),n.d(t,"I",(function(){return l})),n.d(t,"x",(function(){return o})),n.d(t,"Y",(function(){return u})),n.d(t,"S",(function(){return d})),n.d(t,"B",(function(){return f})),n.d(t,"R",(function(){return b})),n.d(t,"n",(function(){return m})),n.d(t,"kb",(function(){return p})),n.d(t,"P",(function(){return g})),n.d(t,"jb",(function(){return v})),n.d(t,"F",(function(){return k})),n.d(t,"o",(function(){return w})),n.d(t,"J",(function(){return E})),n.d(t,"Q",(function(){return h})),n.d(t,"E",(function(){return j})),n.d(t,"u",(function(){return x})),n.d(t,"v",(function(){return y})),n.d(t,"bb",(function(){return M})),n.d(t,"j",(function(){return O})),n.d(t,"p",(function(){return C})),n.d(t,"l",(function(){return S})),n.d(t,"H",(function(){return V})),n.d(t,"G",(function(){return P})),n.d(t,"cb",(function(){return T})),n.d(t,"eb",(function(){return I})),n.d(t,"A",(function(){return L})),n.d(t,"z",(function(){return N})),n.d(t,"y",(function(){return A})),n.d(t,"a",(function(){return F})),n.d(t,"e",(function(){return R})),n.d(t,"K",(function(){return z})),n.d(t,"d",(function(){return $})),n.d(t,"Z",(function(){return B})),n.d(t,"D",(function(){return D})),n.d(t,"N",(function(){return _})),n.d(t,"g",(function(){return U})),n.d(t,"ab",(function(){return q})),n.d(t,"h",(function(){return J})),n.d(t,"hb",(function(){return G}));var a=n(2),s=n(23);n.d(t,"c",(function(){return s.b})),n.d(t,"i",(function(){return s.m})),n.d(t,"k",(function(){return s.p})),n.d(t,"q",(function(){return s.z})),n.d(t,"r",(function(){return s.A})),n.d(t,"s",(function(){return s.E})),n.d(t,"t",(function(){return s.F})),n.d(t,"w",(function(){return s.G})),n.d(t,"L",(function(){return s.N})),n.d(t,"O",(function(){return s.Z})),n.d(t,"U",(function(){return s.bb})),n.d(t,"V",(function(){return s.db})),n.d(t,"W",(function(){return s.eb})),n.d(t,"db",(function(){return s.jb})),n.d(t,"fb",(function(){return s.mb})),n.d(t,"gb",(function(){return s.qb})),n.d(t,"ib",(function(){return s.rb}));var i=n(83);n.d(t,"f",(function(){return i.a})),n.d(t,"C",(function(){return i.b})),n.d(t,"M",(function(){return i.e})),n.d(t,"T",(function(){return i.i})),n.d(t,"X",(function(){return i.k}));const r=a.i18n.translate("xpack.cases.caseView.actionLabel.addedField",{defaultMessage:"added"}),c=a.i18n.translate("xpack.cases.caseView.actionLabel.changededField",{defaultMessage:"changed"}),l=a.i18n.translate("xpack.cases.caseView.actionLabel.enabledSetting",{defaultMessage:"enabled"}),o=a.i18n.translate("xpack.cases.caseView.actionLabel.disableSetting",{defaultMessage:"disabled"}),u=e=>a.i18n.translate("xpack.cases.caseView.actionLabel.selectedThirdParty",{values:{thirdParty:e},defaultMessage:"selected { thirdParty } as incident management system"}),d=a.i18n.translate("xpack.cases.caseView.actionLabel.removedThirdParty",{defaultMessage:"removed external incident management system"}),f=a.i18n.translate("xpack.cases.caseView.actionLabel.editedField",{defaultMessage:"edited"}),b=a.i18n.translate("xpack.cases.caseView.actionLabel.removedField",{defaultMessage:"removed"}),m=e=>a.i18n.translate("xpack.cases.caseView.actionLabel.changeFieldToEmpty",{values:{field:e},defaultMessage:'changed {field} to "None"'}),p=e=>a.i18n.translate("xpack.cases.caseView.actionLabel.viewIncident",{defaultMessage:"View {incidentNumber}",values:{incidentNumber:e}}),g=a.i18n.translate("xpack.cases.caseView.actionLabel.pushedNewIncident",{defaultMessage:"pushed as new incident"}),v=a.i18n.translate("xpack.cases.caseView.actionLabel.updateIncident",{defaultMessage:"updated incident"}),k=(a.i18n.translate("xpack.cases.caseView.actionLabel.addDescription",{defaultMessage:"added description"}),a.i18n.translate("xpack.cases.caseView.edit.description",{defaultMessage:"Edit description"})),w=a.i18n.translate("xpack.cases.caseView.description.collapse",{defaultMessage:"Collapse description"}),E=a.i18n.translate("xpack.cases.caseView.description.expand",{defaultMessage:"Expand description"}),h=a.i18n.translate("xpack.cases.caseView.edit.quote",{defaultMessage:"Quote"}),j=a.i18n.translate("xpack.cases.caseView.edit.comment",{defaultMessage:"Edit comment"}),x=a.i18n.translate("xpack.cases.caseView.delete.comment",{defaultMessage:"Delete comment"}),y=a.i18n.translate("xpack.cases.caseView.deleteTitle.comment",{defaultMessage:"Delete this comment?"}),M=(a.i18n.translate("xpack.cases.caseView.actionLabel.on",{defaultMessage:"on"}),a.i18n.translate("xpack.cases.caseView.statusLabel",{defaultMessage:"Status"})),O=a.i18n.translate("xpack.cases.caseView.case",{defaultMessage:"case"}),C=a.i18n.translate("xpack.cases.caseView.comment",{defaultMessage:"comment"}),S=a.i18n.translate("xpack.cases.caseView.caseRefresh",{defaultMessage:"Refresh case"}),V=(a.i18n.translate("xpack.cases.caseView.activity",{defaultMessage:"Activity"}),e=>a.i18n.translate("xpack.cases.caseView.emailSubject",{values:{caseTitle:e},defaultMessage:"Security Case - {caseTitle}"})),P=e=>a.i18n.translate("xpack.cases.caseView.emailBody",{values:{caseUrl:e},defaultMessage:"Case reference: {caseUrl}"}),T=(a.i18n.translate("xpack.cases.caseView.fieldChanged",{defaultMessage:"changed connector field"}),a.i18n.translate("xpack.cases.caseView.syncAlertsLabel",{defaultMessage:"Sync alerts"})),I=a.i18n.translate("xpack.cases.caseView.syncAlertsLowercaseLabel",{defaultMessage:"sync alerts"}),L=a.i18n.translate("xpack.cases.caseView.doesNotExist.title",{defaultMessage:"This case does not exist"}),N=e=>a.i18n.translate("xpack.cases.caseView.doesNotExist.description",{values:{caseId:e},defaultMessage:"A case with id {caseId} could not be found. This likely means the case has been deleted, or the id is incorrect."}),A=a.i18n.translate("xpack.cases.caseView.doesNotExist.button",{defaultMessage:"Back to Cases"}),F=a.i18n.translate("xpack.cases.caseView.tabs.activity",{defaultMessage:"Activity"}),R=a.i18n.translate("xpack.cases.caseView.tabs.alerts",{defaultMessage:"Alerts"}),z=a.i18n.translate("xpack.cases.caseView.tabs.files",{defaultMessage:"Files"}),$=a.i18n.translate("xpack.cases.caseView.tabs.alerts.emptyDescription",{defaultMessage:"No alerts have been added to this case."}),B=e=>a.i18n.translate("xpack.cases.caseView.sendEmalLinkAria",{values:{user:e},defaultMessage:"click to send an email to {user}"}),D=a.i18n.translate("xpack.cases.caseView.editAssigneesAriaLabel",{defaultMessage:"click to edit assignees"}),_=a.i18n.translate("xpack.cases.caseView.noAssignees",{defaultMessage:"No users are assigned"}),U=a.i18n.translate("xpack.cases.caseView.assignUser",{defaultMessage:"Assign a user"}),q=a.i18n.translate("xpack.cases.caseView.spacedOrText",{defaultMessage:" or "}),J=a.i18n.translate("xpack.cases.caseView.assignYourself",{defaultMessage:"assign yourself"}),G=e=>a.i18n.translate("xpack.cases.caseView.totalUsersAssigned",{defaultMessage:"{total} assigned",values:{total:e}})},155:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(3),s=n(6),i=n(159);const r=(e=i.a)=>{const{capabilities:t}=Object(s.g)().services.application;return Object.entries(t).reduce(((t,[n,a])=>{if(!n.endsWith("Cases"))return t;for(const n of e)if(!a[`${n}_cases`])return t;return t.push(c(n)),t}),[])},c=e=>e===a.M?a.c:e.replace("Cases","")},159:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i}));const a=e=>!e.all&&!e.create&&!e.update&&!e.delete&&!e.push&&e.read,s=["create","read","update","delete","push"],i=e=>s.filter((t=>t!==e))},175:function(e,t,n){"use strict";n.d(t,"c",(function(){return F})),n.d(t,"b",(function(){return H})),n.d(t,"d",(function(){return Y})),n.d(t,"a",(function(){return se}));var a=n(57),s=n.n(a),i=n(1),r=n.n(i),c=n(26),l=n(5);const o=({disableLinks:e,href:t,target:n,children:a,...s})=>r.a.createElement(l.EuiToolTip,{content:t},r.a.createElement(l.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},a));o.displayName="MarkdownLink";const u=Object(i.memo)(o);var d=n(213),f=n(6),b=n(141),m=n(2),p=n(136),g=n(20),v=n(56),k=n.n(v),w=n(143),E=n(85);const h=r.a.createContext(null),j=k()(l.EuiFlexGroup).withConfig({displayName:"ModalContainer",componentId:"sc-9s2pc6-0"})(["width:",";height:100%;.euiModalBody{min-height:300px;}"],(({theme:e})=>e.eui.euiBreakpoints.m));var x=n(215),y=n(181),M=n(3),O=n(35);const C=k.a.span.withConfig({displayName:"BetaBadgeWrapper",componentId:"sc-qn1ptv-0"})(["display:inline-flex;.euiToolTipAnchor{display:inline-flex;}"]),S={from:"now-7d",to:"now",mode:"relative"},V=({node:e,onCancel:t,onSave:n})=>{const a=Object(g.useLocation)(),{application:{currentAppId$:s},embeddable:c,lens:o,storage:u,contentManagement:d,uiSettings:v,data:{query:{timefilter:{timefilter:k}}}}=Object(f.g)().services,[y,V]=Object(i.useState)(void 0),{draftComment:P,clearDraftComment:T}=Object(x.a)(),I=Object(i.useContext)(h),L=Object(i.useContext)(l.EuiMarkdownContext),N=(()=>{const{appId:e}=Object(O.a)();return e===M.Pb})(),A=Object(i.useCallback)((()=>{y&&(null==c||c.getStateTransfer().getIncomingEmbeddablePackage(y,!0),T()),t()}),[T,y,c,t]),F=Object(i.useCallback)(((e,t)=>{n(`!{${E.b}${JSON.stringify({timeRange:t,attributes:e})}}`,{block:!0}),A()}),[A,n]),R=Object(i.useCallback)(((e,t,n)=>{L.replaceNode(n,`!{${E.b}${JSON.stringify({timeRange:t,attributes:e})}}`),A()}),[A,L]),z=Object(i.useMemo)((()=>N?`/insightsAndAlerting/cases${a.pathname}${a.search}`:`${a.pathname}${a.search}`),[N,a.pathname,a.search]),$=Object(i.useCallback)((()=>{u.set(E.a,{commentId:null==I?void 0:I.editorId,comment:null==I?void 0:I.value,position:null==e?void 0:e.position,caseTitle:null==I?void 0:I.caseTitle,caseTags:null==I?void 0:I.caseTags}),null==o||o.navigateToPrefilledEditor(void 0,{originatingApp:y,originatingPath:z})}),[u,null==I?void 0:I.editorId,null==I?void 0:I.value,null==I?void 0:I.caseTitle,null==I?void 0:I.caseTags,null==e?void 0:e.position,o,y,z]),B=Object(i.useCallback)(((t,n=S)=>{u.set(E.a,{commentId:null==I?void 0:I.editorId,comment:null==I?void 0:I.value,position:null==e?void 0:e.position,caseTitle:null==I?void 0:I.caseTitle,caseTags:null==I?void 0:I.caseTags}),null==o||o.navigateToPrefilledEditor(t||null!=e&&e.attributes?{id:"",timeRange:n,attributes:t||(null==e?void 0:e.attributes)}:void 0,{originatingApp:y,originatingPath:z})}),[u,null==I?void 0:I.editorId,null==I?void 0:I.value,null==I?void 0:I.caseTitle,null==I?void 0:I.caseTags,null==e?void 0:e.position,null==e?void 0:e.attributes,o,y,z]),D=Object(i.useCallback)(((e,t,n,a)=>{B({...a.attributes,title:"",references:a.references})}),[B]),_=Object(i.useMemo)((()=>[{type:"lens",getIconForSavedObject:()=>"lensApp",name:m.i18n.translate("xpack.cases.markdownEditor.plugins.lens.insertLensSavedObjectModal.searchSelection.savedObjectType.lens",{defaultMessage:"Lens"}),includeFields:["*"]}]),[]);Object(i.useEffect)((()=>{null!=e&&e.attributes&&y&&B(e.attributes,e.timeRange)}),[B,e,y]),Object(i.useEffect)((()=>{(async()=>{const e=await s.pipe(Object(b.first)()).toPromise();V(e)})()}),[s]),Object(i.useEffect)((()=>{var e,t,n;let a;if(y&&(a=null==c?void 0:c.getStateTransfer().getIncomingEmbeddablePackage(y,!0)),"lens"===(null===(e=a)||void 0===e?void 0:e.type)&&null!==(t=a)&&void 0!==t&&null!==(n=t.input)&&void 0!==n&&n.attributes){const e=k.getTime(),t=null!=e&&e.from&&null!=e&&e.to?{from:e.from,to:e.to,mode:[e.from,e.to].join("").includes("now")?"relative":"absolute"}:void 0;var s,i;if(null!=P&&P.position)return void R(null===(s=a)||void 0===s?void 0:s.input.attributes,t,P.position);P&&F(null===(i=a)||void 0===i?void 0:i.input.attributes,t)}}),[c,u,k,y,F,R,P]);const U=r.a.createElement(l.EuiButton,{onClick:$,iconType:"plusInCircle"},r.a.createElement(p.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.createVisualizationButtonLabel",defaultMessage:"Create new"}));return r.a.createElement(j,{direction:"column",gutterSize:"none"},r.a.createElement(l.EuiModalHeader,null,r.a.createElement(l.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiModalHeaderTitle,null,r.a.createElement(p.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.addVisualizationModalTitle",defaultMessage:"Add visualization"}))),r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(C,null,r.a.createElement(l.EuiBetaBadge,{label:m.i18n.translate("xpack.cases.markdownEditor.plugins.lens.betaLabel",{defaultMessage:"Beta"}),tooltipContent:m.i18n.translate("xpack.cases.markdownEditor.plugins.lens.betaDescription",{defaultMessage:"This module is not GA. You can only insert one lens per comment for now. Please help us by reporting bugs."})}))))),r.a.createElement(l.EuiModalBody,null,r.a.createElement(w.SavedObjectFinder,{key:"searchSavedObjectFinder",onChoose:D,showFilter:!1,noItemsMessage:r.a.createElement(p.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.insertLensSavedObjectModal.searchSelection.notFoundLabel",defaultMessage:"No matching lens found."}),savedObjectMetaData:_,fixedPageSize:10,services:{contentClient:d.client,uiSettings:v},leftChildren:U,helpText:m.i18n.translate("xpack.cases.markdownEditor.plugins.lens.savedObjects.finder.searchInputHelpText",{defaultMessage:"Insert an existing lens visualization or create a new one. Any changes or new visualizations will only apply to this comment."})})),r.a.createElement(l.EuiModalFooter,null,r.a.createElement(l.EuiButton,{onClick:A,fill:!0},r.a.createElement(p.FormattedMessage,{id:"xpack.cases.markdownEditor.plugins.lens.closeButtonLabel",defaultMessage:"Close"}))))};V.displayName="LensEditor";const P=r.a.memo(V),T={name:E.b,button:{label:y.a,iconType:"lensApp"},helpText:r.a.createElement(l.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"!{lens<config>}"),editor:P},I=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.lens=function(e,t,n){if(!1===t.startsWith(E.c))return!1;const a=t[6];if("{"!==a&&"}"!==a)return!1;if(n)return!0;const s="{"===a;let i=E.c,r={};if(s){let n="",a=0;for(let e=6;e<t.length;e++){const s=t[e];if("{"===s)a++,n+=s;else if("}"===s){if(a--,-1===a)break;n+=s}else n+=s}i+=n;try{r=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse lens JSON configuration: ${t}`,{line:n.line,column:n.column+6})}}return i+="}",e(i)({type:E.b,...r})},n.splice(n.indexOf("text"),0,E.b)};var L=n(97);const N=e=>{var t,n;const a=f.b.getConfig(),s=null===(t=Object(d.a)())||void 0===t?void 0:t.editor_plugins,r=Object(f.c)();return Object(i.useMemo)((()=>{var t;const n=Object(l.getDefaultEuiMarkdownUiPlugins)(),i=Object(l.getDefaultEuiMarkdownParsingPlugins)(),c=Object(l.getDefaultEuiMarkdownProcessingPlugins)();return s&&(n.push(s.uiPlugin),i.push(s.parsingPlugin),c[1][1].components.timeline=s.processingPluginRenderer),null==a||null===(t=a.markdownPlugins)||void 0===t||!t.lens||null!=e&&e.includes(E.b)||null==r||!r.visualize.crud||n.push(T),i.push(I),c[1][1].components.lens=L.a,{uiPlugins:n,parsingPlugins:i,processingPlugins:c}}),[null==r?void 0:r.visualize.crud,e,null==a||null===(n=a.markdownPlugins)||void 0===n?void 0:n.lens,s])},A=({children:e,disableLinks:t,textSize:n})=>{const{processingPlugins:a,parsingPlugins:o}=N(),d=Object(c.cloneDeep)(a);return d[1][1].components.a=Object(i.useMemo)((()=>(e=>{const t=Object(i.memo)((t=>r.a.createElement(u,s()({},t,{disableLinks:e}))));return t.displayName="MarkdownLinkProcessingComponent",t})(t)),[t]),r.a.createElement(l.EuiMarkdownFormat,{parsingPluginList:o,processingPluginList:d,grow:!0,textSize:n},e)};A.displayName="MarkdownRenderer";const F=Object(i.memo)(A);var R=n(12),z=n(178),$=n.n(z);const B="euiButtonIcon-isDisabled",D=Object(i.forwardRef)((({ariaLabel:e,dataTestSubj:t,editorId:n,height:a,onChange:s,value:c,disabledUiPlugins:o},u)=>{const d=Object(i.useRef)(void 0),[f,b]=Object(i.useState)([]),m=Object(i.useCallback)(((e,{messages:t,ast:n})=>{b(e?[e]:t),d.current=n}),[]),{parsingPlugins:p,processingPlugins:g,uiPlugins:v}=N(o),k=Object(i.useRef)(null);return(({astRef:e,editorRef:t,uiPlugins:n,value:a})=>{const s=Object(i.useRef)(!1),[r,c]=Object(i.useState)(!1),l=Object(i.useCallback)((()=>{var e,n;if(null!=t&&null!==(e=t.current)&&void 0!==e&&e.textarea&&null!==(n=t.current)&&void 0!==n&&n.toolbar){var a,s;const e=null===(a=t.current)||void 0===a||null===(s=a.toolbar)||void 0===s?void 0:s.querySelector(`[aria-label="${y.a}"]`);if(e){const t=e.className.includes(B),n=e.getAttribute("style");t&&n&&(e.className=e.className.replace(B,""),e.setAttribute("style",n.replace("pointer-events: none;","")))}}}),[t]),o=Object(i.useCallback)((()=>{var e;if(null!=t&&null!==(e=t.current)&&void 0!==e&&e.textarea&&t.current.toolbar){var n;const e=null===(n=t.current.toolbar)||void 0===n?void 0:n.querySelector(`[aria-label="${y.a}"]`);e&&(e.className.includes(B)||(e.className+=` ${B}`,e.setAttribute("style","pointer-events: none;")))}}),[t]);Object(i.useEffect)((()=>{s.current=Object(R.some)(n,["name","lens"])}),[n]),$()((()=>{r||null==a||!a.includes(E.c)?l():o()}),100,[a,r]),Object(i.useEffect)((()=>{var n,a;if(null==(null==t||null===(n=t.current)||void 0===n?void 0:n.textarea)||null==(null==e?void 0:e.current)||!s.current)return;const i=()=>{var n;const{selectionStart:a}=null===(n=t.current)||void 0===n?void 0:n.textarea;let s=e.current;e:for(;;){if(s.children)for(let e=0;e<s.children.length;e++){const t=s.children[e];if(t.position&&t.position.start.offset<a&&a<t.position.end.offset){if("text"===t.type)break e;s=t;continue e}}break}c("lens"===s.type)},r=null===(a=t.current)||void 0===a?void 0:a.textarea;return r.addEventListener("keyup",i),r.addEventListener("mouseup",i),()=>{r.removeEventListener("keyup",i),r.removeEventListener("mouseup",i)}}),[e,t])})({astRef:d,uiPlugins:v,editorRef:u,value:c}),Object(i.useImperativeHandle)(u,(()=>{var e,t;if(!k.current)return null;const n=null===(e=k.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...k.current,toolbar:null==n?void 0:n.querySelector(".euiMarkdownEditorToolbar")}})),r.a.createElement(l.EuiMarkdownEditor,{ref:k,"aria-label":e,editorId:n,onChange:s,value:c,uiPlugins:v,parsingPluginList:p,processingPluginList:g,onParse:m,errors:f,"data-test-subj":t,height:a})}));D.displayName="MarkdownEditor";const _=Object(i.memo)(D);var U=n(24),q=n(23),J=n(266),G=n.n(J);const W=k()(l.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-1vq2db5-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),H=r.a.memo(Object(i.forwardRef)((({id:e,field:t,dataTestSubj:n,idAria:a,bottomRightContent:s,caseTitle:c,caseTags:o,draftStorageKey:u,disabledUiPlugins:d,initialValue:f},b)=>{const{isInvalid:m,errorMessage:p}=Object(U.getFieldValidityAndErrorMessage)(t),{hasConflicts:g}=(({field:e,sessionKey:t,initialValue:n})=>{const[a,s]=Object(i.useState)(!1),r=Object(i.useRef)(!0),c=Object(i.useRef)(n),[l,o]=G()(t,"",!0);return!Object(R.isEmpty)(l)&&r.current&&e.setValue(l),r.current&&(r.current=!1),n!==c.current&&n!==e.value&&(c.current=n,s(!0)),$()((()=>{o(e.value)}),500,[e.value]),{hasConflicts:a}})({field:t,sessionKey:u,initialValue:f}),v=q.tb("description"===e?e:"comment"),k=Object(i.useMemo)((()=>({editorId:e,value:t.value,caseTitle:c,caseTags:o})),[e,t.value,c,o]);return r.a.createElement(h.Provider,{value:k},r.a.createElement(l.EuiFormRow,{"data-test-subj":n,describedByIds:a?[a]:void 0,fullWidth:!0,error:p,helpText:t.helpText,isInvalid:m,label:t.label,labelAppend:t.labelAppend},r.a.createElement(_,{ref:b,ariaLabel:a,editorId:e,onChange:t.setValue,value:t.value,disabledUiPlugins:d,"data-test-subj":`${n}-markdown-editor`})),s&&r.a.createElement(W,{justifyContent:"flexEnd"},r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiText,{color:"danger",size:"s"},g&&v),r.a.createElement(l.EuiSpacer,{size:"s"}),s)))})));H.displayName="MarkdownEditorForm";const K=k.a.div.withConfig({displayName:"ContentWrapper",componentId:"sc-1fjx19m-0"})(["padding:",";text-overflow:ellipsis;word-break:break-word;display:-webkit-box;-webkit-box-orient:vertical;"],(({theme:e})=>`${e.eui.euiSizeM} ${e.eui.euiSizeL}`)),Q=({content:e})=>r.a.createElement(K,{className:"eui-xScroll","data-test-subj":"scrollable-markdown"},r.a.createElement(F,null,e));Q.displayName="ScrollableMarkdownRenderer";const Y=r.a.memo(Q);var Z=n(61),X=n(182),ee=n(150);const te=({handleSaveAction:e,handleCancelAction:t,isSaveDisabled:n})=>r.a.createElement(l.EuiFlexGroup,{gutterSize:"s",justifyContent:"flexEnd",responsive:!1},r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"editable-cancel-markdown",size:"s",onClick:t,iconType:"cross"},ee.i)),r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiButton,{"data-test-subj":"editable-save-markdown",color:"success",fill:!0,iconType:"save",onClick:e,disabled:n,size:"s"},ee.W)));te.displayName="EditableMarkdownFooterComponent";const ne=r.a.memo(te),ae=Object(i.forwardRef)((({id:e,content:t,caseId:n,fieldName:a,onChangeEditable:s,onSaveContent:c,editorRef:l,formSchema:o},u)=>{const{appId:d}=Object(O.a)(),f=Object(X.a)(d,n,e),b={content:t},{form:m}=Object(U.useForm)({defaultValue:b,options:{stripEmptyFields:!1},schema:o}),{submit:p,setFieldValue:g,isValid:v}=m,k=Object(i.useCallback)((e=>{g(a,e)}),[g,a]);Object(i.useImperativeHandle)(u,(()=>({setComment:k,editor:l.current})));const w=Object(i.useCallback)((()=>{s(e),Object(Z.k)(f)}),[e,s,f]),E=Object(i.useCallback)((async()=>{const{isValid:n,data:a}=await p();n&&a.content!==t&&c(a.content),s(e),Object(Z.k)(f)}),[t,e,s,c,p,f]);return r.a.createElement(U.Form,{form:m,"data-test-subj":"editable-markdown-form"},r.a.createElement(U.UseField,{path:a,component:H,componentProps:{ref:l,"aria-label":"Cases markdown editor",value:t,id:e,draftStorageKey:f,bottomRightContent:r.a.createElement(ne,{handleSaveAction:E,handleCancelAction:w,isSaveDisabled:void 0!==v&&!v}),initialValue:t}}))}));ae.displayName="EditableMarkDownRenderer";const se=r.a.memo(ae)},177:function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(3);const s=async({http:e,name:t,size:n=a.K,owners:s,signal:i})=>await e.post(a.ab,{body:JSON.stringify({name:t,size:n,owners:s}),signal:i}),i=async({security:e,uids:t})=>0===t.length?[]:e.userProfiles.bulkGet({uids:new Set(t),dataPath:"avatar"}),r=async({security:e})=>e.userProfiles.getCurrent({dataPath:"avatar"})},178:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(76),s=n(1),i=a.__importDefault(n(204));t.default=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var a=i.default(e,t),r=a[0],c=a[1],l=a[2];return s.useEffect(l,n),[r,c]}},180:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(46),s=n(48),i=n(6),r=n(80),c=n(177);const l=()=>{const{security:e}=Object(i.g)().services,t=Object(i.j)();return Object(a.useQuery)(r.d.currentUser(),(()=>Object(c.b)({security:e})),{retry:!1,onError:e=>{var n;"AbortError"!==e.name&&404!==(null===(n=e.body)||void 0===n?void 0:n.statusCode)&&t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.e})}})}},181:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(2).i18n.translate("xpack.cases.markdownEditor.plugins.lens.visualizationButtonLabel",{defaultMessage:"Visualization"})},182:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t,n)=>`cases.${""!==e?e:"cases"}.${""!==t?t:"case"}.${""!==n?n:"comment"}.markdownEditor`},204:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef(!1),s=a.useRef(),i=a.useRef(e),r=a.useCallback((function(){return n.current}),[]),c=a.useCallback((function(){n.current=!1,s.current&&clearTimeout(s.current),s.current=setTimeout((function(){n.current=!0,i.current()}),t)}),[t]),l=a.useCallback((function(){n.current=null,s.current&&clearTimeout(s.current)}),[]);return a.useEffect((function(){i.current=e}),[e]),a.useEffect((function(){return c(),l}),[t]),[r,l,c]}},213:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1),s=n(214);const i=()=>Object(a.useContext)(s.a)},214:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(1),s=n.n(a);const i=s.a.createContext(null),r=({children:e,timelineIntegration:t})=>{const[n]=Object(a.useState)(null!=t?t:null);return s.a.createElement(i.Provider,{value:n},e)}},215:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(1),s=n(141),i=n(6),r=n(85),c=n(181);const l=()=>{const{application:{currentAppId$:e},embeddable:t,storage:n}=Object(i.g)().services,[l,o]=Object(a.useState)(null),[u,d]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{(async()=>{const a=await e.pipe(Object(s.first)()).toPromise();if(!a)return;const i=null==t?void 0:t.getStateTransfer().getIncomingEmbeddablePackage(a),c=n.get(r.a);d(!!i),c&&o(c)})()}),[e,t,n]),{draftComment:l,hasIncomingLensState:u,openLensModal:Object(a.useCallback)((({editorRef:e})=>{if(e&&e.textarea&&e.toolbar){var t;const n=null===(t=e.toolbar)||void 0===t?void 0:t.querySelector(`[aria-label="${c.a}"]`);n&&n.click()}}),[]),clearDraftComment:Object(a.useCallback)((()=>{n.remove(r.a),o(null)}),[n])}}},266:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),s=n(113);t.default=function(e,t,n){if(!s.isClient)return[t,function(){}];var i=a.useState((function(){try{var a=sessionStorage.getItem(e);return"string"!=typeof a?(sessionStorage.setItem(e,n?String(t):JSON.stringify(t)),t):n?a:JSON.parse(a||"null")}catch(e){return t}})),r=i[0],c=i[1];return a.useEffect((function(){try{var t=n?String(r):JSON.stringify(r);sessionStorage.setItem(e,t)}catch(e){}})),[r,c]}}}]);