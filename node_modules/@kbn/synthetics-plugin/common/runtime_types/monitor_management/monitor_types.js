"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ThrottlingConfigValueCodec = exports.ThrottlingConfigCodec = exports.TLSSensitiveFieldsCodec = exports.TLSFieldsCodec = exports.TLSCodec = exports.TCPSimpleFieldsCodec = exports.TCPSensitiveAdvancedFieldsCodec = exports.TCPFieldsCodec = exports.TCPAdvancedFieldsCodec = exports.TCPAdvancedCodec = exports.SyntheticsMonitorWithSecretsCodec = exports.SyntheticsMonitorWithIdCodec = exports.SyntheticsMonitorCodec = exports.MonitorOverviewResultCodec = exports.MonitorOverviewItemCodec = exports.MonitorManagementListResultCodec = exports.MonitorFieldsCodec = exports.MonitorDefaultsCodec = exports.ICMPSimpleFieldsCodec = exports.ICMPFieldsCodec = exports.ICMPAdvancedFieldsCodec = exports.HeartbeatConfigCodec = exports.HTTPSimpleFieldsCodec = exports.HTTPSensitiveAdvancedFieldsCodec = exports.HTTPFieldsCodec = exports.HTTPAdvancedFieldsCodec = exports.HTTPAdvancedCodec = exports.EncryptedTCPFieldsCodec = exports.EncryptedSyntheticsSavedMonitorCodec = exports.EncryptedSyntheticsMonitorCodec = exports.EncryptedHTTPFieldsCodec = exports.EncryptedBrowserSimpleFieldsCodec = exports.EncryptedBrowserFieldsCodec = exports.EncryptedBrowserAdvancedFieldsCodec = exports.CommonFieldsCodec = exports.BrowserSimpleFieldsCodec = exports.BrowserSensitiveSimpleFieldsCodec = exports.BrowserSensitiveAdvancedFieldsCodec = exports.BrowserFieldsCodec = exports.BrowserAdvancedFieldsCodec = void 0;
var t = _interopRequireWildcard(require("io-ts"));
var _alert_config = require("./alert_config");
var _config_key = require("./config_key");
var _locations = require("./locations");
var _monitor_configs = require("./monitor_configs");
var _monitor_meta_data = require("./monitor_meta_data");
var _synthetics_private_locations = require("./synthetics_private_locations");
function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function (nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }
function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || typeof obj !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }
/*
 * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one
 * or more contributor license agreements. Licensed under the Elastic License
 * 2.0; you may not use this file except in compliance with the Elastic License
 * 2.0.
 */

const ScheduleCodec = t.interface({
  number: t.string,
  unit: _monitor_configs.ScheduleUnitCodec
});

// TLSFields
const TLSFieldsCodec = t.partial({
  [_config_key.ConfigKey.TLS_CERTIFICATE_AUTHORITIES]: t.string,
  [_config_key.ConfigKey.TLS_CERTIFICATE]: t.string,
  [_config_key.ConfigKey.TLS_VERIFICATION_MODE]: _monitor_configs.VerificationModeCodec,
  [_config_key.ConfigKey.TLS_VERSION]: t.array(_monitor_configs.TLSVersionCodec)
});
exports.TLSFieldsCodec = TLSFieldsCodec;
const TLSSensitiveFieldsCodec = t.partial({
  [_config_key.ConfigKey.TLS_KEY]: t.string,
  [_config_key.ConfigKey.TLS_KEY_PASSPHRASE]: t.string
});
exports.TLSSensitiveFieldsCodec = TLSSensitiveFieldsCodec;
const TLSCodec = t.intersection([TLSFieldsCodec, TLSSensitiveFieldsCodec]);
exports.TLSCodec = TLSCodec;
const MonitorLocationsCodec = t.array(t.union([_locations.MonitorServiceLocationCodec, _synthetics_private_locations.PrivateLocationCodec]));
// CommonFields
const CommonFieldsCodec = t.intersection([t.interface({
  [_config_key.ConfigKey.NAME]: t.string,
  [_config_key.ConfigKey.NAMESPACE]: t.string,
  [_config_key.ConfigKey.MONITOR_TYPE]: _monitor_configs.MonitorTypeCodec,
  [_config_key.ConfigKey.ENABLED]: t.boolean,
  [_config_key.ConfigKey.SCHEDULE]: ScheduleCodec,
  [_config_key.ConfigKey.APM_SERVICE_NAME]: t.string,
  [_config_key.ConfigKey.TAGS]: t.array(t.string),
  [_config_key.ConfigKey.LOCATIONS]: MonitorLocationsCodec,
  [_config_key.ConfigKey.MONITOR_QUERY_ID]: t.string,
  [_config_key.ConfigKey.CONFIG_ID]: t.string,
  [_config_key.ConfigKey.MAX_ATTEMPTS]: t.number
}), t.partial({
  [_config_key.ConfigKey.FORM_MONITOR_TYPE]: _monitor_configs.FormMonitorTypeCodec,
  [_config_key.ConfigKey.TIMEOUT]: t.union([t.string, t.null]),
  [_config_key.ConfigKey.REVISION]: t.number,
  [_config_key.ConfigKey.MONITOR_SOURCE_TYPE]: _monitor_configs.SourceTypeCodec,
  [_config_key.ConfigKey.CONFIG_HASH]: t.string,
  [_config_key.ConfigKey.JOURNEY_ID]: t.string,
  [_config_key.ConfigKey.PROJECT_ID]: t.string,
  [_config_key.ConfigKey.ORIGINAL_SPACE]: t.string,
  [_config_key.ConfigKey.CUSTOM_HEARTBEAT_ID]: t.string,
  [_config_key.ConfigKey.ALERT_CONFIG]: _alert_config.AlertConfigsCodec,
  [_config_key.ConfigKey.PARAMS]: t.string
})]);

// TCP Simple Fields
exports.CommonFieldsCodec = CommonFieldsCodec;
const TCPSimpleFieldsCodec = t.intersection([t.interface({
  [_config_key.ConfigKey.METADATA]: _monitor_meta_data.MetadataCodec,
  [_config_key.ConfigKey.HOSTS]: t.string,
  [_config_key.ConfigKey.PORT]: t.union([t.number, t.null])
}), t.partial({
  [_config_key.ConfigKey.URLS]: t.string
}), CommonFieldsCodec]);

// TCPAdvancedFields
exports.TCPSimpleFieldsCodec = TCPSimpleFieldsCodec;
const TCPAdvancedFieldsCodec = t.intersection([t.interface({
  [_config_key.ConfigKey.PROXY_URL]: t.string,
  [_config_key.ConfigKey.PROXY_USE_LOCAL_RESOLVER]: t.boolean
}), t.partial({
  [_config_key.ConfigKey.MODE]: _monitor_configs.ModeCodec,
  [_config_key.ConfigKey.IPV4]: t.boolean,
  [_config_key.ConfigKey.IPV6]: t.boolean
})]);
exports.TCPAdvancedFieldsCodec = TCPAdvancedFieldsCodec;
const TCPSensitiveAdvancedFieldsCodec = t.interface({
  [_config_key.ConfigKey.RESPONSE_RECEIVE_CHECK]: t.string,
  [_config_key.ConfigKey.REQUEST_SEND_CHECK]: t.string
});
exports.TCPSensitiveAdvancedFieldsCodec = TCPSensitiveAdvancedFieldsCodec;
const TCPAdvancedCodec = t.intersection([TCPAdvancedFieldsCodec, TCPSensitiveAdvancedFieldsCodec]);
exports.TCPAdvancedCodec = TCPAdvancedCodec;
// TCPFields
const EncryptedTCPFieldsCodec = t.intersection([TCPSimpleFieldsCodec, TCPAdvancedFieldsCodec, TLSFieldsCodec]);
exports.EncryptedTCPFieldsCodec = EncryptedTCPFieldsCodec;
const TCPFieldsCodec = t.intersection([EncryptedTCPFieldsCodec, TCPSensitiveAdvancedFieldsCodec, TLSSensitiveFieldsCodec]);
exports.TCPFieldsCodec = TCPFieldsCodec;
// ICMP SimpleFields
const ICMPSimpleFieldsCodec = t.intersection([t.interface({
  [_config_key.ConfigKey.HOSTS]: t.string,
  [_config_key.ConfigKey.WAIT]: t.string
}), CommonFieldsCodec]);
exports.ICMPSimpleFieldsCodec = ICMPSimpleFieldsCodec;
// ICMPAdvancedFields
const ICMPAdvancedFieldsCodec = t.partial({
  [_config_key.ConfigKey.MODE]: _monitor_configs.ModeCodec,
  [_config_key.ConfigKey.IPV4]: t.boolean,
  [_config_key.ConfigKey.IPV6]: t.boolean
});

// ICMPFields
exports.ICMPAdvancedFieldsCodec = ICMPAdvancedFieldsCodec;
const ICMPFieldsCodec = t.intersection([ICMPSimpleFieldsCodec, ICMPAdvancedFieldsCodec]);
exports.ICMPFieldsCodec = ICMPFieldsCodec;
// HTTPSimpleFields
const HTTPSimpleFieldsCodec = t.intersection([t.interface({
  [_config_key.ConfigKey.METADATA]: _monitor_meta_data.MetadataCodec,
  [_config_key.ConfigKey.MAX_REDIRECTS]: t.string,
  [_config_key.ConfigKey.URLS]: t.string,
  [_config_key.ConfigKey.PORT]: t.union([t.number, t.null])
}), CommonFieldsCodec]);
exports.HTTPSimpleFieldsCodec = HTTPSimpleFieldsCodec;
// HTTPAdvancedFields
const HTTPAdvancedFieldsCodec = t.intersection([t.interface({
  [_config_key.ConfigKey.PROXY_URL]: t.string,
  [_config_key.ConfigKey.RESPONSE_BODY_INDEX]: _monitor_configs.ResponseBodyIndexPolicyCodec,
  [_config_key.ConfigKey.RESPONSE_HEADERS_INDEX]: t.boolean,
  [_config_key.ConfigKey.RESPONSE_STATUS_CHECK]: t.array(t.string),
  [_config_key.ConfigKey.REQUEST_METHOD_CHECK]: t.string
}), t.partial({
  [_config_key.ConfigKey.MODE]: _monitor_configs.ModeCodec,
  [_config_key.ConfigKey.RESPONSE_BODY_MAX_BYTES]: t.string,
  [_config_key.ConfigKey.IPV4]: t.boolean,
  [_config_key.ConfigKey.IPV6]: t.boolean
})]);
exports.HTTPAdvancedFieldsCodec = HTTPAdvancedFieldsCodec;
const HTTPSensitiveAdvancedFieldsCodec = t.intersection([t.interface({
  [_config_key.ConfigKey.PASSWORD]: t.string,
  [_config_key.ConfigKey.RESPONSE_BODY_CHECK_NEGATIVE]: t.array(t.string),
  [_config_key.ConfigKey.RESPONSE_BODY_CHECK_POSITIVE]: t.array(t.string),
  [_config_key.ConfigKey.RESPONSE_HEADERS_CHECK]: t.record(t.string, t.string),
  [_config_key.ConfigKey.REQUEST_BODY_CHECK]: _monitor_configs.RequestBodyCheckCodec,
  [_config_key.ConfigKey.REQUEST_HEADERS_CHECK]: t.record(t.string, t.string),
  [_config_key.ConfigKey.USERNAME]: t.string
}), t.partial({
  [_config_key.ConfigKey.PROXY_HEADERS]: t.record(t.string, t.string),
  [_config_key.ConfigKey.RESPONSE_JSON_CHECK]: t.array(_monitor_configs.ResponseCheckJSONCodec)
})]);
exports.HTTPSensitiveAdvancedFieldsCodec = HTTPSensitiveAdvancedFieldsCodec;
const HTTPAdvancedCodec = t.intersection([HTTPAdvancedFieldsCodec, HTTPSensitiveAdvancedFieldsCodec]);

// HTTPFields
exports.HTTPAdvancedCodec = HTTPAdvancedCodec;
const EncryptedHTTPFieldsCodec = t.intersection([HTTPSimpleFieldsCodec, HTTPAdvancedFieldsCodec, TLSFieldsCodec]);
exports.EncryptedHTTPFieldsCodec = EncryptedHTTPFieldsCodec;
const HTTPFieldsCodec = t.intersection([EncryptedHTTPFieldsCodec, HTTPSensitiveAdvancedFieldsCodec, TLSSensitiveFieldsCodec]);
exports.HTTPFieldsCodec = HTTPFieldsCodec;
const EncryptedBrowserSimpleFieldsCodec = t.intersection([t.intersection([t.interface({
  [_config_key.ConfigKey.METADATA]: _monitor_meta_data.MetadataCodec
}), t.partial({
  [_config_key.ConfigKey.PLAYWRIGHT_OPTIONS]: t.string,
  [_config_key.ConfigKey.TEXT_ASSERTION]: t.string
})]), CommonFieldsCodec]);
exports.EncryptedBrowserSimpleFieldsCodec = EncryptedBrowserSimpleFieldsCodec;
const BrowserSensitiveSimpleFieldsCodec = t.intersection([t.interface({
  [_config_key.ConfigKey.SOURCE_INLINE]: t.string,
  [_config_key.ConfigKey.SOURCE_PROJECT_CONTENT]: t.string,
  [_config_key.ConfigKey.URLS]: t.union([t.string, t.null]),
  [_config_key.ConfigKey.PORT]: t.union([t.number, t.null])
}), CommonFieldsCodec]);
exports.BrowserSensitiveSimpleFieldsCodec = BrowserSensitiveSimpleFieldsCodec;
const ThrottlingConfigValueCodec = t.interface({
  download: t.string,
  upload: t.string,
  latency: t.string
});
exports.ThrottlingConfigValueCodec = ThrottlingConfigValueCodec;
const ThrottlingConfigCodec = t.interface({
  value: t.union([ThrottlingConfigValueCodec, t.null]),
  label: t.string,
  id: t.string
});
exports.ThrottlingConfigCodec = ThrottlingConfigCodec;
const EncryptedBrowserAdvancedFieldsCodec = t.interface({
  [_config_key.ConfigKey.SCREENSHOTS]: t.string,
  [_config_key.ConfigKey.JOURNEY_FILTERS_MATCH]: t.string,
  [_config_key.ConfigKey.JOURNEY_FILTERS_TAGS]: t.array(t.string),
  [_config_key.ConfigKey.IGNORE_HTTPS_ERRORS]: t.boolean,
  [_config_key.ConfigKey.THROTTLING_CONFIG]: ThrottlingConfigCodec
});
exports.EncryptedBrowserAdvancedFieldsCodec = EncryptedBrowserAdvancedFieldsCodec;
const BrowserSimpleFieldsCodec = t.intersection([EncryptedBrowserSimpleFieldsCodec, BrowserSensitiveSimpleFieldsCodec]);
exports.BrowserSimpleFieldsCodec = BrowserSimpleFieldsCodec;
const BrowserSensitiveAdvancedFieldsCodec = t.interface({
  [_config_key.ConfigKey.SYNTHETICS_ARGS]: t.array(t.string)
});
exports.BrowserSensitiveAdvancedFieldsCodec = BrowserSensitiveAdvancedFieldsCodec;
const BrowserAdvancedFieldsCodec = t.intersection([EncryptedBrowserAdvancedFieldsCodec, BrowserSensitiveAdvancedFieldsCodec]);
exports.BrowserAdvancedFieldsCodec = BrowserAdvancedFieldsCodec;
const EncryptedBrowserFieldsCodec = t.intersection([EncryptedBrowserSimpleFieldsCodec, EncryptedBrowserAdvancedFieldsCodec, TLSFieldsCodec]);
exports.EncryptedBrowserFieldsCodec = EncryptedBrowserFieldsCodec;
const BrowserFieldsCodec = t.intersection([BrowserSimpleFieldsCodec, BrowserAdvancedFieldsCodec, TLSCodec]);

// MonitorFields, represents any possible monitor type
exports.BrowserFieldsCodec = BrowserFieldsCodec;
const MonitorFieldsCodec = t.intersection([HTTPFieldsCodec, TCPFieldsCodec, ICMPSimpleFieldsCodec, BrowserFieldsCodec]);

// Monitor, represents one of (Icmp | Tcp | Http | Browser)
exports.MonitorFieldsCodec = MonitorFieldsCodec;
const SyntheticsMonitorCodec = t.union([HTTPFieldsCodec, TCPFieldsCodec, ICMPSimpleFieldsCodec, BrowserFieldsCodec]);
exports.SyntheticsMonitorCodec = SyntheticsMonitorCodec;
const EncryptedSyntheticsMonitorCodec = t.union([EncryptedHTTPFieldsCodec, EncryptedTCPFieldsCodec, ICMPSimpleFieldsCodec, EncryptedBrowserFieldsCodec]);
exports.EncryptedSyntheticsMonitorCodec = EncryptedSyntheticsMonitorCodec;
const SyntheticsMonitorWithIdCodec = t.intersection([SyntheticsMonitorCodec, t.interface({
  id: t.string
})]);
exports.SyntheticsMonitorWithIdCodec = SyntheticsMonitorWithIdCodec;
const HeartbeatFieldsCodec = t.intersection([t.interface({
  config_id: t.string
}), t.partial({
  run_once: t.boolean,
  test_run_id: t.string,
  'monitor.project.name': t.string,
  'monitor.id': t.string,
  'monitor.project.id': t.string,
  'monitor.fleet_managed': t.boolean,
  meta: t.record(t.string, t.string)
})]);
const HeartbeatConfigCodec = t.intersection([SyntheticsMonitorWithIdCodec, t.partial({
  fields_under_root: t.boolean,
  fields: HeartbeatFieldsCodec
})]);
exports.HeartbeatConfigCodec = HeartbeatConfigCodec;
const EncryptedSyntheticsSavedMonitorCodec = t.intersection([EncryptedSyntheticsMonitorCodec, t.interface({
  id: t.string,
  updated_at: t.string,
  created_at: t.string
})]);
exports.EncryptedSyntheticsSavedMonitorCodec = EncryptedSyntheticsSavedMonitorCodec;
const MonitorDefaultsCodec = t.interface({
  [_monitor_configs.MonitorTypeEnum.HTTP]: HTTPFieldsCodec,
  [_monitor_configs.MonitorTypeEnum.TCP]: TCPFieldsCodec,
  [_monitor_configs.MonitorTypeEnum.ICMP]: ICMPSimpleFieldsCodec,
  [_monitor_configs.MonitorTypeEnum.BROWSER]: BrowserFieldsCodec
});
exports.MonitorDefaultsCodec = MonitorDefaultsCodec;
const MonitorManagementListResultCodec = t.type({
  monitors: t.array(EncryptedSyntheticsSavedMonitorCodec),
  page: t.number,
  perPage: t.number,
  total: t.union([t.number, t.null]),
  absoluteTotal: t.union([t.number, t.null]),
  syncErrors: t.union([_locations.ServiceLocationErrors, t.null])
});
exports.MonitorManagementListResultCodec = MonitorManagementListResultCodec;
const MonitorOverviewItemCodec = t.intersection([t.interface({
  name: t.string,
  id: t.string,
  configId: t.string,
  location: _locations.MonitorServiceLocationCodec,
  isEnabled: t.boolean,
  isStatusAlertEnabled: t.boolean,
  type: t.string,
  tags: t.array(t.string),
  schedule: t.string
}), t.partial({
  projectId: t.string
})]);
exports.MonitorOverviewItemCodec = MonitorOverviewItemCodec;
const MonitorOverviewResultCodec = t.type({
  total: t.number,
  allMonitorIds: t.array(t.string),
  monitors: t.array(MonitorOverviewItemCodec)
});
exports.MonitorOverviewResultCodec = MonitorOverviewResultCodec;
const SyntheticsMonitorWithSecretsCodec = t.intersection([EncryptedSyntheticsMonitorCodec, t.interface({
  secrets: t.string
})]);
exports.SyntheticsMonitorWithSecretsCodec = SyntheticsMonitorWithSecretsCodec;