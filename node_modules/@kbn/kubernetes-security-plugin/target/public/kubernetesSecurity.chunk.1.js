/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.kubernetesSecurity_bundle_jsonpfunction=window.kubernetesSecurity_bundle_jsonpfunction||[]).push([[1],[,,,,,,,,,,,,,,,,,function(e,t,r){e.exports=r(16)(3)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var n=r(11).__importDefault(r(21));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.removeEventListener.apply(e,t)},t.isDeepEqual=n.default},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),a=r(18),s=function(){};t.default=function(e,t,r){if(!a.isClient)return[t,s,s];if(!e)throw new Error("useLocalStorage key may not be falsy");var i=r?r.raw?function(e){return e}:r.deserializer:JSON.parse,o=n.useState((function(){try{var n=r?r.raw?String:r.serializer:JSON.stringify,a=localStorage.getItem(e);return null!==a?i(a):(t&&localStorage.setItem(e,n(t)),t)}catch(e){return t}})),l=o[0],u=o[1],c=n.useCallback((function(t){try{var n="function"==typeof t?t(l):t;if(void 0===n)return;var a;a=r?r.raw?"string"==typeof n?n:JSON.stringify(n):r.serializer?r.serializer(n):JSON.stringify(n):JSON.stringify(n),localStorage.setItem(e,a),u(i(a))}catch(e){}}),[e,u]),d=n.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[l,c,d]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),a=r(18),s=n.__importDefault(r(22));t.default=function(e,t){s.default(e,t,a.isDeepEqual)}},function(e,t,r){"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,a,s;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(a=n;0!=a--;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(s=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(a=n;0!=a--;)if(!Object.prototype.hasOwnProperty.call(r,s[a]))return!1;for(a=n;0!=a--;){var i=s[a];if(!("_owner"===i&&t.$$typeof||e(t[i],r[i])))return!1}return!0}return t!=t&&r!=r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.default=function(e,t,r){var a=n.useRef(void 0);a.current&&r(t,a.current)||(a.current=t),n.useEffect(e,a.current)}},function(e,t,r){e.exports=r.p+"94cccf20036d014924e63d4d595e88e1.svg"},function(e,t,r){"use strict";r.r(t),r.d(t,"KubernetesSecurityRoutes",(function(){return Le})),r.d(t,"default",(function(){return Le}));var n=r(1),a=r.n(n),s=r(17),i=r.n(s),o=r(10);const l={services:{}},u=Object(n.createContext)(l);var c=r(20),d=r.n(c),b=r(0);const p=({children:e,component:t,render:r,...s})=>{const l=Object(n.useMemo)((()=>{if(t)return e=>Object(b.jsx)(a.a.Fragment,null,Object(b.jsx)(g,null),Object(b.jsx)(t,e))}),[t]);if(l)return Object(b.jsx)(o.Route,i()({},s,{component:l}));if(r||"function"==typeof e){const t="function"==typeof e?e:r;return Object(b.jsx)(o.Route,i()({},s,{render:e=>Object(b.jsx)(a.a.Fragment,null,Object(b.jsx)(g,null),t(e))}))}return Object(b.jsx)(o.Route,s,Object(b.jsx)(g,null),e)},g=()=>{const{executionContext:e}=Object(n.useContext)(u).services,t=Object(o.useRouteMatch)();return function(e,t){d()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null};var m=r(12),j=r(13),x=r.n(j);const f=({legacySwitch:e=!0,children:t})=>{const r=Object(o.useRouteMatch)();return e?Object(b.jsx)(o.Switch,null,t):Object(b.jsx)(m.Routes,null,n.Children.map(t,(e=>{if(a.a.isValidElement(e)&&e.type===p){var n;const s=Object(j.replace)(null==e?void 0:e.props.path,r.url+"/",""),i="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(b.jsx)(m.Route,{path:s,element:Object(b.jsx)(a.a.Fragment,null,Object(b.jsx)(g,null),(null==e||null===(n=e.props)||void 0===n?void 0:n.component)&&Object(b.jsx)(e.props.component,null)||i&&i()||t)})}return e})))};var y=r(19),O=r.n(y),h=r(4),k=r(9),v=r(14),w=r(15),S=r(2);const I=(...e)=>{const t=Object(h.useEuiTheme)(...e),r=Object(n.useMemo)((()=>{const e="DARK"===t.colorMode?w.euiDarkVars:w.euiLightVars,r={euiColorVis6_asText:Object(h.shade)(e.euiColorVis6,.335),buttonsBackgroundNormalDefaultPrimary:"#006DE4"};return{...e,...r}}),[t.colorMode]);return{...t,euiVars:r}};var M=r(8);const T=()=>{const{data:e,timelines:t}=Object(M.useKibana)().services,{getFilterForValueButton:r,getFilterOutValueButton:a,getCopyButton:s}=t.getHoverActions();return{getFilterForValueButton:r,getFilterOutValueButton:a,getCopyButton:s,filterManager:Object(n.useMemo)((()=>e.query.filterManager),[e.query.filterManager])}},B=20,E=500;const N=(e,t,r)=>{if(!e||isNaN(Date.parse(t))||isNaN(Date.parse(r)))return S.l;try{const n=JSON.parse(e);if(!n.bool)throw new Error("Field 'bool' does not exist in query.");const a={range:{"@timestamp":{gte:t,lte:r}}};return n.bool.filter?n.bool.filter=[S.k,...n.bool.filter,a]:n.bool.filter=[a],JSON.stringify(n)}catch{return S.l}};var C=r(3);const F=({title:e,dataValueMap:t,widgetKey:r,indexPattern:a,globalFilter:s,groupedBy:i,countBy:o,onReduce:l})=>{const[u,c]=Object(n.useState)(null),d=(()=>{const{euiTheme:e}=I();return Object(n.useMemo)((()=>{const{size:t,colors:r,font:n,border:a}=e;return{container:{padding:t.base,border:a.thin,borderRadius:a.radius.medium,overflow:"auto",position:"relative"},title:{marginBottom:t.m},dataInfo:{marginBottom:t.xs,display:"flex",alignItems:"center",height:"18px"},dataValue:{fontWeight:n.weight.semiBold,marginLeft:"auto"},filters:{marginLeft:t.s},percentageBackground:{position:"relative",backgroundColor:r.lightShade,height:t.xs,borderRadius:a.radius.small},percentageBar:{position:"absolute",height:t.xs,borderRadius:a.radius.small},loadingSpinner:{alignItems:"center",margin:`${t.xs} auto ${t.xl} auto`}}}),[e])})(),p=Object(n.useMemo)((()=>N(s.filterQuery,s.startDate,s.endDate)),[s.filterQuery,s.startDate,s.endDate]),{data:g,isLoading:m}=((e,t,r,n,a,s)=>{const{http:i}=Object(M.useKibana)().services,o=[S.A,r,t,n,a,s];return Object(C.useQuery)(o,(async()=>{const r=await i.get(S.a,{version:S.j,query:{query:t,groupBy:n,countBy:a,page:0,index:s}});return e(r)}))})(l,p,r,i,o,null==a?void 0:a.title),{getFilterForValueButton:j,getFilterOutValueButton:x,filterManager:f}=T(),y=Object(n.useMemo)((()=>g?Object.keys(g).reduce(((e,t)=>e+g[t]),0):0),[g]),O=Object(n.useMemo)((()=>{const e={filterForButtons:[],filterOutButtons:[]};return Object.keys(t).forEach((r=>{t[r].shouldHideFilter||(e.filterForButtons.push(j({field:t[r].fieldName,filterManager:f,size:"xs",onClick:()=>{},onFilterAdded:()=>{},ownFocus:!1,showTooltip:!0,value:[r]})),e.filterOutButtons.push(x({field:t[r].fieldName,filterManager:f,size:"xs",onClick:()=>{},onFilterAdded:()=>{},ownFocus:!1,showTooltip:!0,value:[r]})))})),e}),[t,f,j,x]);return Object(b.jsx)("div",{css:d.container},m&&Object(b.jsx)(h.EuiProgress,{size:"xs",color:"accent",position:"absolute","data-test-subj":"kubernetesSecurity:percentWidgetLoading"}),Object(b.jsx)("div",{css:d.title},e),Object(b.jsx)(h.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object.keys(t).map(((e,r)=>{const n=(null==g?void 0:g[e])||0;return Object(b.jsx)(h.EuiFlexItem,{key:`percentage-widget--${t[e].name}`,onMouseEnter:()=>c(r),onMouseLeave:()=>c(null),"data-test-subj":"kubernetesSecurity:percentWidgetData"},Object(b.jsx)(h.EuiText,{size:"xs",css:d.dataInfo},t[e].name,u===r&&Object(b.jsx)("div",{css:d.filters},O.filterForButtons[r],O.filterOutButtons[r]),Object(b.jsx)("span",{css:d.dataValue},n)),Object(b.jsx)("div",{css:d.percentageBackground},Object(b.jsx)("div",{css:Object(b.css)({...d.percentageBar,width:100*(n/y||0)+"%",backgroundColor:t[e].color},"","")})))}))))};function V(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}const P=({title:e,widgetKey:t,indexPattern:r,globalFilter:a,groupedBy:s})=>{const i=(()=>{const{euiTheme:e}=I();return Object(n.useMemo)((()=>{const{size:t,font:r,border:n}=e;return{container:{padding:t.base,border:n.thin,borderRadius:n.radius.medium,overflow:"auto",position:"relative",height:"100%"},title:{marginBottom:t.s,fontSize:t.m,fontWeight:r.weight.bold,whiteSpace:"nowrap"},dataInfo:{fontSize:`calc(${t.l} - ${t.xxs})`,lineHeight:t.l,fontWeight:r.weight.bold},dataValue:{fontWeight:r.weight.semiBold,marginLeft:"auto"},filters:{marginLeft:t.s},loadingSpinner:{alignItems:"center",margin:`${t.xs} auto ${t.xl} auto`}}}),[e])})(),o=Object(n.useMemo)((()=>{let e=a.filterQuery;return t===S.i&&(e=((e,t)=>{let r=S.l;try{var n;const t=JSON.parse(e||"{}");if(null==t||null===(n=t.bool)||void 0===n||!n.filter||!Array.isArray(t.bool.filter))throw new Error("Invalid filter query");t.bool.filter.push({bool:{should:[{match_phrase:{"orchestrator.resource.type":"pod"}}]}}),r=JSON.stringify(t)}catch{}return r})(a.filterQuery)),N(e,a.startDate,a.endDate)}),[a.filterQuery,a.startDate,a.endDate,t]),{data:l,isLoading:u}=((e,t,r,n)=>{const{http:a}=Object(M.useKibana)().services,s=[S.z,e,t,r,n];return Object(C.useInfiniteQuery)(s,(async()=>await a.get(S.d,{version:S.j,query:{query:t,field:r,index:n}})),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1})})(t,o,s,null==r?void 0:r.title),c=Object(n.useMemo)((()=>l?null==l?void 0:l.pages[0]:0),[l]),d=Object(n.useMemo)((()=>(e=>{if(Number.isFinite(e)&&e>=0){if(e>=999999999999999){const t=1e12*Math.floor(e/1e12);return new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(t)}if(e>=999999999999){const t=1e9*Math.floor(e/1e9);return new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(t)}if(e>=999999999){const t=1e6*Math.floor(e/1e6);return new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(t)}if(e>=999999){const t=1e3*Math.floor(e/1e3);return new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(t)}if(e>=999){const t=1e3*Math.floor(e/1e3);return new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(t)}return e<1e3?e.toString():new Intl.NumberFormat("en-GB",{notation:"compact",compactDisplay:"short"}).format(e)}return"NaN"})(c)),[c]);return Object(b.jsx)("div",{css:i.container},Object(b.jsx)("div",{css:i.title},e),Object(b.jsx)(h.EuiToolTip,{content:u?null:V(c),"data-test-subj":"kubernetesSecurity:countWidgetTooltip","aria-label":"Info",position:"top"},Object(b.jsx)(h.EuiText,{css:i.dataInfo,"data-test-subj":"kubernetesSecurity:countWidgetValue"},u?Object(b.jsx)(h.EuiLoadingSpinner,{size:"l","data-test-subj":"kubernetesSecurity:countWidgetLoading"}):d)))},_=(k.i18n.translate("xpack.kubernetesSecurity.searchGroup.cluster",{defaultMessage:"Cluster"}),k.i18n.translate("xpack.kubernetesSecurity.searchGroup.groupBy",{defaultMessage:"Group by"}),k.i18n.translate("xpack.kubernetesSecurity.searchGroup.sortBy",{defaultMessage:"Sort by"}),k.i18n.translate("xpack.kubernetesSecurity.treeView.logicalView",{defaultMessage:"Logical view"})),R=k.i18n.translate("xpack.kubernetesSecurity.treeView.infrastructureView",{defaultMessage:"Infrastructure view"}),W=k.i18n.translate("xpack.kubernetesSecurity.treeView.switherLegend",{defaultMessage:"You can switch between the Logical and Infrastructure view"}),D=k.i18n.translate("xpack.kubernetesSecurity.treeNavigation.loading",{defaultMessage:"Loading"}),z=e=>k.i18n.translate("xpack.kubernetesSecurity.treeNavigation.loadMore",{values:{name:e},defaultMessage:"Show more {name}"}),L=k.i18n.translate("xpack.kubernetesSecurity.treeNavigation.collapse",{defaultMessage:"Collapse tree navigation"}),$=k.i18n.translate("xpack.kubernetesSecurity.treeNavigation.expand",{defaultMessage:"Expand tree navigation"}),A=k.i18n.translate("xpack.kubernetesSecurity.chartsToggle.show",{defaultMessage:"Show charts"}),G=k.i18n.translate("xpack.kubernetesSecurity.chartsToggle.hide",{defaultMessage:"Hide charts"}),q=k.i18n.translate("xpack.kubernetesSecurity.countWidget.clusters",{defaultMessage:"Clusters"}),K=k.i18n.translate("xpack.kubernetesSecurity.countWidget.namespace",{defaultMessage:"Namespace"}),H=k.i18n.translate("xpack.kubernetesSecurity.countWidget.nodes",{defaultMessage:"Nodes"}),Q=k.i18n.translate("xpack.kubernetesSecurity.countWidget.pods",{defaultMessage:"Pods"}),J=k.i18n.translate("xpack.kubernetesSecurity.countWidget.containerImages",{defaultMessage:"Container images"}),U=k.i18n.translate("xpack.kubernetesSecurity.containerNameWidget.containerImage",{defaultMessage:"Container image"}),Y=k.i18n.translate("xpack.kubernetesSecurity.containerNameWidget.containerImageCountColumn",{defaultMessage:"Session count"}),X=k.i18n.translate("xpack.kubernetesSecurity.containerNameWidget.containerImageAriaLabel",{defaultMessage:"Container name session widget"}),Z={clusterId:S.u,clusterName:S.v,namespace:S.w,node:S.b,pod:S.x,containerImage:S.c},ee={clusterId:{type:"cluster",euiVarColor:"euiColorVis0"},clusterName:{type:"cluster",euiVarColor:"euiColorVis0"},namespace:{type:"namespace",euiVarColor:"euiColorVis1"},node:{type:"kubernetesNode",euiVarColor:"euiColorVis3"},pod:{type:"kubernetesPod",euiVarColor:"euiColorVis9"},containerImage:{type:"container",euiVarColor:"euiColorVis8"}},te=e=>{const{euiTheme:t}=I();return Object(n.useMemo)((()=>{const{size:r,colors:n}=t;return{loadMoreButton:{position:"relative",cursor:"pointer",zIndex:2},loadMoreButtonWrapper:{position:"relative",textAlign:"center",width:`calc(100% + ${24*e}px)`,marginLeft:`-${24*e}px`,"&:after":{content:"''",position:"absolute",top:"50%",width:"100%",border:`1px dashed ${n.mediumShade}`,left:0}},loadMoreText:{marginRight:r.s},loadMoreTextLeft:{marginLeft:r.s},leafNodeButton:{marginLeft:r.l,width:`calc(100% - ${r.l})`,paddingLeft:0},labelIcon:{marginRight:r.s,marginLeft:r.s},treeViewWrapper:e=>({display:e?"inherit":"none",".euiTreeView__node--selected > .euiTreeView__nodeInner":{backgroundColor:Object(h.transparentize)(n.darkestShade,.1)},".euiTreeView__node--expanded":{maxHeight:"100%"},".euiTreeView__nodeInner .euiToolTipAnchor":{maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordWrap:"normal"}})}}),[t,e])},re=e=>{e.preventDefault(),e.stopPropagation()},ne=(e,t,r)=>{const n=Array.from(document.querySelectorAll(t)),a=n.indexOf(e.currentTarget);if(a>-1){const t=n[a+("next"===r?1:-1)];t&&(re(e),t.focus())}},ae=({globalFilter:e,indexPattern:t})=>{const[r,a]=Object(n.useState)(!1),[s={},i]=O()(S.s,{}),o=Object(n.useMemo)((()=>JSON.parse(N(e.filterQuery,e.startDate,e.endDate))),[e.filterQuery,e.startDate,e.endDate]),l=Object(n.useCallback)((e=>{i(e)}),[i]),u=Object(n.useMemo)((()=>((e,t)=>{let r=S.l;try{var n;const a=JSON.parse(e||"{}");if(null==a||null===(n=a.bool)||void 0===n||!n.filter||!Array.isArray(a.bool.filter))throw new Error("Invalid filter query");a.bool.filter.push(...Object.entries(t).filter((([e])=>"clusterName"!==e)).map((e=>{const[t,r]=e;return{bool:{should:[{match:{[Z[t]]:r}}]}}}))),r=JSON.stringify(a)}catch{}return r})(e.filterQuery,s)),[e.filterQuery,s]);return{noResults:r,setNoResults:a,filterQueryWithTimeRange:o,indexPattern:(null==t?void 0:t.title)||"",onTreeNavSelect:l,treeNavSelection:s,setTreeNavSelection:i,sessionViewFilter:u}},se=Object(n.createContext)(null),ie=()=>{const e=Object(n.useContext)(se);if(!e)throw new Error("useTreeViewContext must be called within an TreeViewContextProvider");return e},oe=({children:e,...t})=>Object(b.jsx)(se.Provider,{value:ae(t)},e),le=({euiVarColor:e,...t})=>{const{euiVars:r}=I(),n=r[e]?{style:{color:r[e]}}:{};return Object(b.jsx)(h.EuiIcon,i()({},t,n))},ue={clusterId:k.i18n.translate("xpack.kubernetesSecurity.treeView.breadcrumb.clusterId",{defaultMessage:"Cluster"}),clusterName:k.i18n.translate("xpack.kubernetesSecurity.treeView.breadcrumb.clusterName",{defaultMessage:"Cluster"}),namespace:k.i18n.translate("xpack.kubernetesSecurity.treeView.breadcrumb.namespace",{defaultMessage:"Namespace"}),node:k.i18n.translate("xpack.kubernetesSecurity.treeView.breadcrumb.node",{defaultMessage:"Node"}),pod:k.i18n.translate("xpack.kubernetesSecurity.treeView.breadcrumb.pod",{defaultMessage:"Pod"}),containerImage:k.i18n.translate("xpack.kubernetesSecurity.treeView.breadcrumb.containerImage",{defaultMessage:"Container Image"})},ce="kubernetesSecurity:dynamicTreeViewButton",de=e=>{ne(e,`[data-test-subj="${ce}"]`,"next")},be=e=>{ne(e,`[data-test-subj="${ce}"]`,"prev")},pe=({defaultExpanded:e=!1,children:t})=>{const[r,a]=Object(n.useState)(e);return t({isExpanded:r,onToggleExpand:()=>{a((e=>!e))}})},ge=({tree:e,depth:t=0,selectionDepth:r={},query:a,onSelect:s,selected:i="",expanded:o=!0,...l})=>{var u;const c=te(t),{indexPattern:d,setNoResults:p,setTreeNavSelection:g}=ie(),{data:m,fetchNextPage:j,isFetchingNextPage:x,hasNextPage:f,isLoading:y}=((e,t,r,n)=>{const{http:a}=Object(M.useKibana)().services,s=[S.B,e,t,r];return Object(C.useInfiniteQuery)(s,(async({pageParam:n=0})=>{if(t===Z.clusterId){const{buckets:s}=await a.get(S.t,{version:"1",query:{query:JSON.stringify(e),groupBys:JSON.stringify([{field:t},{field:S.v,missing:""}]),page:n,perPage:50,index:r}});return{buckets:s.map((e=>({...e,key_as_string:e.key[1],key:e.key[0]})))}}return await a.get(S.a,{version:S.j,query:{query:JSON.stringify(e),groupBy:t,page:n,perPage:50,index:r}})}),{enabled:n,getNextPageParam:(e,t)=>e.hasNextPage?t.length:void 0})})(a,e[t].key,d,o),O=l["aria-label"];Object(n.useEffect)((()=>{if(0===t&&m){var e;const t=0===(null===(e=m.pages)||void 0===e?void 0:e[0].buckets.length);p(t),t&&g({})}}),[m,t,p,g]),Object(n.useEffect)((()=>{o&&j()}),[j,o]),Object(n.useEffect)((()=>{var r,n,a;!i&&!t&&m&&null!==(r=m.pages)&&void 0!==r&&null!==(n=r[0].buckets)&&void 0!==n&&null!==(a=n[0])&&void 0!==a&&a.key&&s({},e[t].type,m.pages[0].buckets[0].key,m.pages[0].buckets[0].key_as_string)}),[m,t,i,s,e]);const k=Object(n.useMemo)((()=>{var e;return(null==m||null===(e=m.pages)||void 0===e?void 0:e.map((e=>null==e?void 0:e.buckets)).flat())||[]}),[null==m?void 0:m.pages]);return Object(b.jsx)(h.EuiText,{size:"s",className:"euiTreeView__wrapper "+(o?"":"euiTreeView__wrapper--hidden"),css:c.treeViewWrapper(o)},y&&Object(b.jsx)("div",null,Object(b.jsx)(h.EuiLoadingSpinner,{size:"s"}),Object(b.jsx)("span",{css:c.loadMoreTextLeft},D)),0===t&&Object(b.jsx)(h.EuiI18n,{token:"euiTreeView.listNavigationInstructions",default:"You can quickly navigate this list using arrow keys."},(e=>Object(b.jsx)(h.EuiScreenReaderOnly,null,Object(b.jsx)("p",{id:"dynamicTreeViewInstructionId"},e)))),Object(b.jsx)("ul",{className:"euiTreeView","aria-describedby":null!=m&&null!==(u=m.pages)&&void 0!==u&&u.length?"dynamicTreeViewInstructionId":void 0,"aria-label":O},k.map((n=>{const l={...a,bool:{...a.bool,filter:[...a.bool.filter,{term:{[e[t].key]:n.key}}]}},u=i.indexOf(""+n.key)>0;return Object(b.jsx)(pe,{key:n.key,defaultExpanded:u},(({isExpanded:a,onToggleExpand:u})=>Object(b.jsx)(me,{aggData:n,"aria-label":O,depth:t,expanded:o,isExpanded:a,onSelect:s,onToggleExpand:u,query:l,selected:i,selectionDepth:r,tree:e})))})),f&&Object(b.jsx)("li",{key:"load_more",className:"euiTreeView__node",css:c.loadMoreButtonWrapper},Object(b.jsx)(h.EuiBadge,{css:c.loadMoreButton,onClickAriaLabel:z(e[t].namePlural),"data-test-subj":ce,onKeyDown:e=>(e=>{switch(e.key){case h.keys.ARROW_DOWN:de(e);break;case h.keys.ARROW_UP:be(e);break;case h.keys.ARROW_RIGHT:re(e),j()}})(e),onClick:()=>{j()}},Object(b.jsx)("span",{css:c.loadMoreText},x?D:z(e[t].namePlural)),x?Object(b.jsx)(h.EuiLoadingSpinner,{size:"s"}):Object(b.jsx)(h.EuiIcon,{size:"s",type:"arrowDown"})))))},me=({depth:e,tree:t,onToggleExpand:r,onSelect:a,aggData:s,selectionDepth:o,isExpanded:l,selected:u,expanded:c,query:d,...p})=>{const g=e===t.length-1,m=te(e),j=Object(n.useRef)({}),x=()=>{"clusterId"===t[e].type?a(o,t[e].type,s.key,s.key_as_string):a(o,t[e].type,s.key)},f=()=>{g||r(),x()},y=Object(n.useMemo)((()=>u===Object.entries({...o,[t[e].type]:s.key,..."clusterId"===t[e].type&&s.key_as_string&&{clusterName:s.key_as_string}}).map((([e,t])=>`${e}.${t}`)).join()),[s.key,s.key_as_string,e,u,o,t]),O=ue[t[e].type];return Object(b.jsx)("li",{className:`euiTreeView__node\n        ${l?"euiTreeView__node--expanded":""}\n        ${y?"euiTreeView__node--selected":""}\n      `},Object(b.jsx)("button",{"data-test-subj":c?ce:"",className:"euiTreeView__nodeInner euiTreeView__nodeInner--withArrows",onClick:()=>{g||l||r(),x()},onKeyDown:e=>{switch(e.key){case h.keys.ARROW_DOWN:de(e);break;case h.keys.ARROW_UP:be(e);break;case h.keys.ARROW_RIGHT:l||g||(re(e),f());break;case h.keys.ARROW_LEFT:l&&(re(e),f())}},ref:e=>j.current[s.key]=e,css:g?m.leafNodeButton:void 0},!g&&Object(b.jsx)(h.EuiIcon,{className:"euiTreeView__expansionArrow",type:l?"arrowDown":"arrowRight",onClick:e=>{re(e),g||r()}}),Object(b.jsx)(le,i()({},t[e].iconProps,{css:m.labelIcon})),Object(b.jsx)(h.EuiToolTip,{content:`${O}: ${s.key}`},Object(b.jsx)("span",{className:"euiTreeView__nodeLabel"},s.key_as_string||s.key))),Object(b.jsx)("div",{onKeyDown:e=>((e,t)=>{e.key===h.keys.ARROW_LEFT&&(re(e),j.current[t].focus())})(e,s.key.toString())},!g&&Object(b.jsx)(ge,{expanded:l,query:d,depth:e+1,selectionDepth:{...o,[t[e].type]:s.key,..."clusterId"===t[e].type&&{clusterName:s.key_as_string}},tree:t,onSelect:a,selected:u,"aria-label":`${s.key} child of ${p["aria-label"]}`})))},je=(e=!1)=>k.i18n.translate("xpack.kubernetesSecurity.treeNav.cluster",{defaultMessage:"{isPlural, plural, =true {clusters} other {cluster}}",values:{isPlural:e}}),xe=(e=!1)=>k.i18n.translate("xpack.kubernetesSecurity.treeNav.namespace",{defaultMessage:"{isPlural, plural, =true {namespaces} other {namespace}}",values:{isPlural:e}}),fe=(e=!1)=>k.i18n.translate("xpack.kubernetesSecurity.treeNav.pod",{defaultMessage:"{isPlural, plural, =true {pods} other {pod}}",values:{isPlural:e}}),ye=(e=!1)=>k.i18n.translate("xpack.kubernetesSecurity.treeNav.containerImage",{defaultMessage:"{isPlural, plural, =true {container images} other { container image}}",values:{isPlural:e}}),Oe=(e=!1)=>k.i18n.translate("xpack.kubernetesSecurity.treeNav.node",{defaultMessage:"{isPlural, plural, =true {nodes} other {node}}",values:{isPlural:e}}),he=[{key:Z.clusterId,iconProps:ee.clusterId,type:"clusterId",name:je(),namePlural:je(!0)},{key:Z.namespace,iconProps:ee.namespace,type:"namespace",name:xe(),namePlural:xe(!0)},{key:Z.pod,iconProps:ee.pod,type:"pod",name:fe(),namePlural:fe(!0)},{key:Z.containerImage,iconProps:ee.containerImage,type:"containerImage",name:ye(),namePlural:ye(!0)}],ke=he.map(((e,t)=>1===t?{key:Z.node,iconProps:ee.node,type:"node",name:Oe(),namePlural:Oe(!0)}:e)),ve={logical:he,infrastructure:ke},we="infrastructure",Se="logical",Ie=()=>{const e=(()=>{const{euiTheme:e}=I();return Object(n.useMemo)((()=>{const{size:t}=e;return{treeViewSwitcher:{".euiButton__text":{fontSize:t.m}},treeViewContainer:{height:"600px",width:"288px",overflowY:"auto"},treeViewLegend:{textTransform:"capitalize"}}}),[e])})(),[t,r]=Object(n.useState)(ve.logical),{filterQueryWithTimeRange:s,onTreeNavSelect:i,treeNavSelection:o,setTreeNavSelection:l}=ie(),[u,c]=Object(n.useState)(!1),d=Object(h.useGeneratedHtmlId)({prefix:"treeNavType"}),p=`${d}${Se}`,[g,m]=Object(n.useState)(p),j=Object(n.useMemo)((()=>Object.entries(o).map((([e,t])=>`${e}.${t}`)).join()),[o]),x=()=>{c(!u)},f=Object(n.useMemo)((()=>[{id:p,label:_,value:Se},{id:`${d}${we}`,label:R,value:we}]),[p,d]),y=Object(n.useMemo)((()=>f.find((e=>e.id===g)).label),[f,g]),O=Object(n.useCallback)(((e,t)=>{m(e),r(ve[t]),l({})}),[l]);return Object(b.jsx)(a.a.Fragment,null,u&&Object(b.jsx)(h.EuiToolTip,{content:$},Object(b.jsx)(h.EuiButtonIcon,{onClick:x,iconType:"menuRight","aria-label":$})),Object(b.jsx)("div",{style:{display:u?"none":"inherit"}},Object(b.jsx)(h.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},Object(b.jsx)(h.EuiFlexItem,null,Object(b.jsx)(h.EuiButtonGroup,{name:"coarsness",legend:W,options:f,idSelected:g,onChange:O,buttonSize:"compressed",isFullWidth:!0,color:"primary",css:e.treeViewSwitcher})),Object(b.jsx)(h.EuiFlexItem,{grow:!1},Object(b.jsx)(h.EuiToolTip,{content:L},Object(b.jsx)(h.EuiButtonIcon,{onClick:x,iconType:"menuLeft","aria-label":L})))),Object(b.jsx)(h.EuiSpacer,{size:"xs"}),Object(b.jsx)(h.EuiText,{color:"subdued",size:"xs",css:e.treeViewLegend},t.map((e=>e.name)).join(" / ")),Object(b.jsx)(h.EuiSpacer,{size:"s"}),Object(b.jsx)("div",{css:e.treeViewContainer,className:"eui-scrollBar"},Object(b.jsx)(ge,{query:s,tree:t,"aria-label":y,selected:j,onSelect:(e,t,r,n)=>{const a={...e,[t]:r,...n&&{clusterName:n}};i(a)}}))))};let Me;!function(e){e.clusterId="clusterId",e.clusterName="clusterName",e.namespace="namespace",e.node="node",e.pod="pod",e.containerImage="containerImage"}(Me||(Me={}));const Te=({treeNavSelection:e,onSelect:t})=>{const r=(()=>{const{euiTheme:e}=I();return Object(n.useMemo)((()=>{const{colors:t,size:r,font:n,border:a}=e,s={borderBottom:a.thin,borderColor:t.lightShade,paddingBottom:r.s,marginBottom:r.m},i={height:"fit-content",maxWidth:"248px",fontSize:r.m,fontWeight:n.weight.regular,".euiButtonEmpty":{paddingInline:r.xs}};return{breadcrumb:s,breadcrumbButton:i,breadcrumbButtonBold:{...i,fontWeight:n.weight.semiBold},breadcrumbRightIcon:{marginRight:r.xs},breadcrumbsWrapper:{flexDirection:"row",alignItems:"center"},breadcrumbIconColor:e=>({color:e})}}),[e])})(),{euiVars:s}=I(),i=Object(n.useCallback)((r=>async()=>{const n={...e};switch(r){case Me.clusterId:t({clusterId:e.clusterId,clusterName:e.clusterName});break;case Me.namespace:case Me.node:delete n.pod,delete n.containerImage,t(n);break;case Me.pod:delete n.containerImage,t(n)}}),[t,e]),o=Object(n.useCallback)(((t,n,o,l=!0)=>{const u=ue[t],c=t===Me.clusterId?e.clusterName||e.clusterId:e[t],d=`${u}: ${c}`,p=((e,t)=>{const r=Object.keys(e),n=r[r.length-1];return n===Me.clusterName&&t===Me.clusterId||t===n})(e,t),{type:g,euiVarColor:m}=n;return Object(b.jsx)(a.a.Fragment,null,l&&Object(b.jsx)(h.EuiIcon,{css:r.breadcrumbRightIcon,type:"arrowRight",size:"s"}),Object(b.jsx)(h.EuiToolTip,{content:d},Object(b.jsx)(h.EuiButtonIcon,{"data-test-subj":`kubernetesSecurityBreadcrumbIcon-${t}`,iconType:g,css:r.breadcrumbIconColor(s[m]),"aria-label":`Click ${u} breadcrumb`,onClick:i(t)})),p&&Object(b.jsx)(h.EuiToolTip,{content:d},Object(b.jsx)(h.EuiButtonEmpty,{css:o?r.breadcrumbButtonBold:r.breadcrumbButton,color:"text",onClick:i(t)},c)))}),[i,r,e,s]);return e.clusterId?Object(b.jsx)("div",{css:r.breadcrumb},Object(b.jsx)(h.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(b.jsx)(h.EuiFlexItem,{css:r.breadcrumbsWrapper},o(Me.clusterId,ee.clusterId,!(e.namespace||e.node),!1),e.namespace&&o(Me.namespace,ee.namespace,!e.pod),e.node&&o(Me.node,ee.node,!e.pod),e.pod&&o(Me.pod,ee.pod,!e.containerImage),e.containerImage&&o(Me.containerImage,ee.containerImage,!0)))):null};var Be=r(23),Ee=r.n(Be);const Ne={maxWidth:500},Ce={height:262},Fe=()=>Object(b.jsx)(h.EuiPanel,{color:"subdued","data-test-subj":"kubernetesSecurity:treeEmptyState"},Object(b.jsx)(h.EuiFlexGroup,{css:Ce,alignItems:"center",justifyContent:"center"},Object(b.jsx)(h.EuiFlexItem,{grow:!1},Object(b.jsx)(h.EuiPanel,{hasBorder:!0,css:Ne},Object(b.jsx)(h.EuiFlexGroup,null,Object(b.jsx)(h.EuiFlexItem,null,Object(b.jsx)(h.EuiText,{size:"s"},Object(b.jsx)(h.EuiTitle,null,Object(b.jsx)("h3",null,Object(b.jsx)(v.FormattedMessage,{id:"xpack.kubernetesSecurity.treeView.empty.title",defaultMessage:"No results match your search criteria"}))),Object(b.jsx)("p",null,Object(b.jsx)(v.FormattedMessage,{id:"xpack.kubernetesSecurity.treeView.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),Object(b.jsx)(h.EuiFlexItem,{grow:!1},Object(b.jsx)(h.EuiImage,{size:"200",alt:"",url:Ee.a}))))))),Ve=({globalFilter:e,renderSessionsView:t,indexPattern:r})=>Object(b.jsx)(oe,{indexPattern:r,globalFilter:e},Object(b.jsx)(Pe,{renderSessionsView:t})),Pe=({renderSessionsView:e})=>{const t=(()=>{const{euiTheme:e}=I();return Object(n.useMemo)((()=>{const{border:t}=e;return{outerPanel:{minHeight:"262px"},navPanel:{borderRight:t.thin},sessionsPanel:{overflowX:"auto"}}}),[e])})(),{treeNavSelection:r,sessionViewFilter:a,onTreeNavSelect:s,noResults:i}=ie();return Object(b.jsx)(h.EuiSplitPanel.Outer,{direction:"row",hasBorder:!0,borderRadius:"m",css:t.outerPanel},i&&Object(b.jsx)(Fe,null),Object(b.jsx)(h.EuiSplitPanel.Inner,{hidden:i,color:"subdued",grow:!1,css:t.navPanel},Object(b.jsx)(h.EuiText,null,Object(b.jsx)(Ie,null))),Object(b.jsx)(h.EuiSplitPanel.Inner,{hidden:i,css:t.sessionsPanel},Object(b.jsx)(Te,{treeNavSelection:r,onSelect:s}),e(a)))},_e=({handleToggleHideCharts:e,shouldHideCharts:t=!1})=>Object(b.jsx)(h.EuiButtonEmpty,{onClick:e,iconType:t?"eye":"eyeClosed","data-test-subj":"kubernetesSecurity:chartToggle"},t?A:G),Re=()=>{const{euiTheme:e}=I();return Object(n.useMemo)((()=>{const{size:t,colors:r}=e;return{container:{paddingTop:t.s,paddingBottom:t.s,paddingRight:t.base,paddingLeft:t.base,border:e.border.thin,borderRadius:e.border.radius.medium,overflow:"auto",height:"228px",position:"relative",marginBottom:t.l},dataInfo:{display:"flex",alignItems:"center",height:t.base,position:"relative"},filters:{marginLeft:t.s,position:"absolute",left:"50%",backgroundColor:r.emptyShade,borderRadius:e.border.radius.small,border:e.border.thin,bottom:"-25px",boxShadow:`0 ${t.xs} ${t.xs} ${Object(h.transparentize)(e.colors.shadow,.04)}`,display:"flex",zIndex:1},countValue:{fontSize:t.m},truncate:{width:"100%",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},flexWidth:{width:"100%"},cellPad:{paddingBottom:"5px",paddingTop:"5px"}}}),[e])},We=({name:e,filterButtonIn:t,filterButtonOut:r,copyToClipboardButton:a})=>{const[s,i]=Object(n.useState)(!1),o=Re();return Object(b.jsx)(h.EuiFlexItem,{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),"data-test-subj":"kubernetesSecurity:containerNameSessionRow",css:o.flexWidth},Object(b.jsx)(h.EuiText,{size:"xs",css:o.dataInfo},Object(b.jsx)("div",{css:o.truncate},e),s&&Object(b.jsx)("div",{css:o.filters},t,r,a)))},De=({widgetKey:e,indexPattern:t,globalFilter:r,groupedBy:a,countBy:s})=>{const[i,o]=Object(n.useState)("count"),[l,u]=Object(n.useState)("desc"),c=Re(),d=Object(n.useMemo)((()=>N(r.filterQuery,r.startDate,r.endDate)),[r.filterQuery,r.startDate,r.endDate]),{data:p,fetchNextPage:g,isFetchingNextPage:m,isLoading:j}=((e,t,r,n,a,s,i)=>{const{http:o}=Object(M.useKibana)().services,l=[S.y,t,e,r,n,s,void 0];return Object(C.useInfiniteQuery)(l,(async({pageParam:t=0})=>await o.get(S.a,{version:S.j,query:{query:e,groupBy:r,countBy:n,page:t,index:a,sortByCount:s}})),{refetchOnWindowFocus:!1,refetchOnMount:!1,refetchOnReconnect:!1,getNextPageParam:(e,t)=>e.hasNextPage?t.length:void 0})})(d,e,a,s,null==t?void 0:t.title,l),f=Object(n.useCallback)((({sort:e={}})=>{const{field:t,direction:r}=e;o(t),u(r)}),[]),y={sort:{field:i,direction:l},enableAllColumns:!0},{getFilterForValueButton:O,getFilterOutValueButton:k,getCopyButton:v,filterManager:w}=T(),I=Object(n.useMemo)((()=>{var e,t;return{filterForButtons:(null==p||null===(e=p.pages)||void 0===e?void 0:e.map((e=>null==e?void 0:e.buckets.map((e=>O({field:S.c,filterManager:w,size:"xs",onClick:()=>{},onFilterAdded:()=>{},ownFocus:!1,showTooltip:!0,value:e.key}))))).flat())||[],filterOutButtons:(null==p||null===(t=p.pages)||void 0===t?void 0:t.map((e=>null==e?void 0:e.buckets.map((e=>k({field:S.c,filterManager:w,size:"xs",onClick:()=>{},onFilterAdded:()=>{},ownFocus:!1,showTooltip:!0,value:e.key}))))).flat())||[]}}),[p,O,k,w]),F=Object(n.useMemo)((()=>{var e;return{copyButtons:(null==p||null===(e=p.pages)||void 0===e?void 0:e.map((e=>null==e?void 0:e.buckets.map((e=>v({field:S.c,size:"xs",onClick:()=>{},ownFocus:!1,showTooltip:!0,value:e.key}))))).flat())||[]}}),[p,v]),P=Object(n.useMemo)((()=>{var e;return p?null==p||null===(e=p.pages)||void 0===e?void 0:e.map((e=>null==e?void 0:e.buckets.map((e=>{var t,r;return{name:e.key,count:V(null!==(t=null===(r=e.count_by_aggs)||void 0===r?void 0:r.value)&&void 0!==t?t:0)}})))).flat():[]}),[p]),_=Object(n.useMemo)((()=>[{field:"name",name:U,"data-test-subj":"kubernetesSecurity:containerImageNameSessionNameColumn",render:e=>{const t=P.findIndex((t=>t.name===e));return Object(b.jsx)(We,{name:e,filterButtonIn:I.filterForButtons[t],filterButtonOut:I.filterOutButtons[t],copyToClipboardButton:F.copyButtons[t]})},align:"left",width:"67%",sortable:!1},{field:"count",name:Y,width:"33%","data-test-subj":"kubernetesSecurity:containerImageNameSessionCountColumn",render:e=>Object(b.jsx)("span",{css:c.countValue},e),sortable:!0,align:"right"}]),[I.filterForButtons,I.filterOutButtons,F.copyButtons,P,c]),R=Object(n.useRef)(null);!function({div:e,handler:t}){Object(n.useEffect)((()=>{if(e){const r=x.a.debounce((()=>{const r=function(e){return e?e.scrollTop:document.documentElement.scrollTop||document.body.scrollTop}(e),n=r+e.offsetHeight>e.scrollHeight-B;t(r,n)}),E);return e.onscroll=r,()=>{r.cancel(),e.onscroll=null}}}),[e,t])}({div:R.current,handler:(e,t)=>{!m&&t&&g()}});const W=Object(n.useMemo)((()=>({css:c.cellPad})),[c.cellPad]);return Object(b.jsx)("div",{"data-test-subj":"kubernetesSecurity:containerNameSessionTable",className:"eui-yScroll",css:c.container,ref:R},j&&Object(b.jsx)(h.EuiProgress,{size:"xs",color:"accent",position:"absolute","data-test-subj":"kubernetesSecurity:containerNameWidgetLoading"}),Object(b.jsx)(h.EuiBasicTable,{"aria-label":X,items:P,columns:_,sorting:y,onChange:f,cellProps:W}))},ze=({filter:e,indexPattern:t,globalFilter:r,renderSessionsView:s})=>{const[i,o]=O()(S.r,!1),l=(()=>{const{euiTheme:e}=I();return Object(n.useMemo)((()=>{const{size:t,font:r}=e,n={marginBottom:t.l},a={marginRight:t.m},s={position:"absolute",bottom:t.base,left:t.base,width:`calc(100% - ${t.xl})`,fontSize:t.m,lineHeight:"18px",padding:`${t.xs} ${t.s}`,display:"flex"},i={position:"relative",border:e.border.thin,borderRadius:e.border.radius.medium,padding:t.base,height:"500px"},o={marginBottom:t.m};return{titleSection:n,titleText:{display:"flex",alignItems:"center"},titleActions:{marginLeft:"auto",flexDirection:"row",alignItems:"center"},updatedAt:a,widgetBadge:s,treeViewContainer:i,countWidgetsGroup:{...o,flexWrap:"wrap",[`@media (max-width:${e.breakpoint.xl}px)`]:{flexDirection:"column"}},leftWidgetsGroup:{[`@media (max-width:${e.breakpoint.xl}px)`]:{marginBottom:"0 !important"},minWidth:`calc(70% - ${t.xxxl})`},rightWidgetsGroup:{[`@media (max-width:${e.breakpoint.xl}px)`]:{marginTop:"0 !important"},minWidth:"30%"},widgetsBottomSpacing:o,percentageChartTitle:{marginRight:t.xs,display:"inline",fontWeight:r.weight.bold},widgetsGroup:{[`@media (max-width:${e.breakpoint.xl}px)`]:{flexDirection:"column"}}}}),[e])})(),u=(e=>{const{timelines:t}=Object(M.useKibana)().services,r=Object(n.useMemo)((()=>Date.now()),[e]);return t.getLastUpdated({updatedAt:r||Date.now()})})(r),c=Object(n.useCallback)((e=>e.buckets.reduce(((e,t)=>{var r,n;return e[t.key_as_string||t.key.toString()]=null!==(r=null===(n=t.count_by_aggs)||void 0===n?void 0:n.value)&&void 0!==r?r:0,e}),{})),[]),d=Object(n.useCallback)((e=>e.buckets.reduce(((e,t)=>{var r,n,a,s;return"0"===t.key.toString()?e[t.key]=null!==(r=null===(n=t.count_by_aggs)||void 0===n?void 0:n.value)&&void 0!==r?r:0:e.nonRoot=(e.nonRoot||0)+(null!==(a=null===(s=t.count_by_aggs)||void 0===s?void 0:s.value)&&void 0!==a?a:0),e}),{})),[]),g=Object(n.useCallback)((()=>{o(!i)}),[o,i]);return Object(b.jsx)(f,null,Object(b.jsx)(p,{strict:!0,exact:!0,path:S.p},e,Object(b.jsx)(h.EuiFlexGroup,{gutterSize:"none",css:l.titleSection},Object(b.jsx)(h.EuiFlexItem,null,Object(b.jsx)(h.EuiTitle,{size:"l"},Object(b.jsx)("h1",{css:l.titleText},S.q))),Object(b.jsx)(h.EuiFlexItem,{grow:!1,css:l.titleActions},Object(b.jsx)("div",{css:l.updatedAt},u),Object(b.jsx)(_e,{shouldHideCharts:i,handleToggleHideCharts:g}))),!i&&Object(b.jsx)(a.a.Fragment,null,Object(b.jsx)(h.EuiFlexGroup,{css:l.widgetsGroup},Object(b.jsx)(h.EuiFlexItem,{css:l.leftWidgetsGroup},Object(b.jsx)(h.EuiFlexGroup,{css:l.countWidgetsGroup},Object(b.jsx)(h.EuiFlexItem,null,Object(b.jsx)(P,{title:q,indexPattern:t,globalFilter:r,widgetKey:S.e,groupedBy:S.u})),Object(b.jsx)(h.EuiFlexItem,null,Object(b.jsx)(P,{title:K,indexPattern:t,globalFilter:r,widgetKey:S.g,groupedBy:S.w})),Object(b.jsx)(h.EuiFlexItem,null,Object(b.jsx)(P,{title:H,indexPattern:t,globalFilter:r,widgetKey:S.h,groupedBy:S.b})),Object(b.jsx)(h.EuiFlexItem,null,Object(b.jsx)(P,{title:Q,indexPattern:t,globalFilter:r,widgetKey:S.h,groupedBy:S.x})),Object(b.jsx)(h.EuiFlexItem,null,Object(b.jsx)(P,{title:J,indexPattern:t,globalFilter:r,widgetKey:S.f,groupedBy:S.c}))),Object(b.jsx)(h.EuiFlexGroup,{css:l.widgetsBottomSpacing},Object(b.jsx)(h.EuiFlexItem,null,Object(b.jsx)(F,{title:Object(b.jsx)(a.a.Fragment,null,Object(b.jsx)(h.EuiText,{size:"xs",css:l.percentageChartTitle},Object(b.jsx)(v.FormattedMessage,{id:"xpack.kubernetesSecurity.sessionChart.title",defaultMessage:"Session interactivity"})),Object(b.jsx)(h.EuiIconTip,{content:Object(b.jsx)(v.FormattedMessage,{id:"xpack.kubernetesSecurity.sessionChart.tooltip",defaultMessage:"Interactive sessions have a controlling terminal and often imply that a human is entering the commands."})})),widgetKey:"sessionsPercentage",indexPattern:t,globalFilter:r,dataValueMap:{true:{name:k.i18n.translate("xpack.kubernetesSecurity.sessionChart.interactive",{defaultMessage:"Interactive"}),fieldName:S.n,color:w.euiThemeVars.euiColorVis0},false:{name:k.i18n.translate("xpack.kubernetesSecurity.sessionChart.nonInteractive",{defaultMessage:"Non-interactive"}),fieldName:S.n,color:w.euiThemeVars.euiColorVis1,shouldHideFilter:!0}},groupedBy:S.n,countBy:S.m,onReduce:c})),Object(b.jsx)(h.EuiFlexItem,null,Object(b.jsx)(F,{title:Object(b.jsx)(a.a.Fragment,null,Object(b.jsx)(h.EuiText,{size:"xs",css:l.percentageChartTitle},Object(b.jsx)(v.FormattedMessage,{id:"xpack.kubernetesSecurity.entryUserChart.title",defaultMessage:"Entry session users"})),Object(b.jsx)(h.EuiIconTip,{content:Object(b.jsx)(v.FormattedMessage,{id:"xpack.kubernetesSecurity.entryUserChart.tooltip",defaultMessage:"The entry session user is the initial Linux user associated with the session. This user may be set from authentication of a remote login or automatically for service sessions started by init."})})),widgetKey:"rootLoginPercentage",indexPattern:t,globalFilter:r,dataValueMap:{0:{name:k.i18n.translate("xpack.kubernetesSecurity.entryUserChart.root",{defaultMessage:"Root"}),fieldName:S.o,color:w.euiThemeVars.euiColorVis2},nonRoot:{name:k.i18n.translate("xpack.kubernetesSecurity.entryUserChart.nonRoot",{defaultMessage:"Non-root"}),fieldName:S.o,color:w.euiThemeVars.euiColorVis3,shouldHideFilter:!0}},groupedBy:S.o,countBy:S.m,onReduce:d})))),Object(b.jsx)(h.EuiFlexItem,{grow:!1,css:l.rightWidgetsGroup},Object(b.jsx)(De,{widgetKey:"containerNameSessions",indexPattern:t,globalFilter:r,groupedBy:S.c,countBy:S.m})))),Object(b.jsx)(Ve,{globalFilter:r,renderSessionsView:s,indexPattern:t})))},Le=a.a.memo(ze)}]]);