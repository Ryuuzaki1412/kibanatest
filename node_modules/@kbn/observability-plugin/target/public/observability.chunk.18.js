/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.observability_bundle_jsonpfunction=window.observability_bundle_jsonpfunction||[]).push([[18],{103:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(1),i=n(125);function s(){return Object(a.useContext)(i.a)}},125:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(1);const i=Object(a.createContext)({})},192:function(e,t,n){"use strict";n.r(t),n.d(t,"COMMON_SLO_GROUPING",(function(){return L})),n.d(t,"SloOverviewEmbeddableFactoryDefinition",(function(){return slo_embeddable_factory_SloOverviewEmbeddableFactoryDefinition}));var a=n(2),i=n.n(a),s=n(0),l=n(82),r=n(1),o=n.n(r),d=n(81),c=n.n(d),u=n(13),b=n(78),h=n(26),v=n(12),p=n(14),m=n(102),f=n(154),y=n(127),E=n(126),g=n(139),S=n(133),I=n(158),O=n(172),w=n(129);function j({sloId:e,sloInstanceId:t,onRenderComplete:n,reloadSubject:a}){var i,l,d;const c=Object(r.useRef)(null),[u,b]=Object(r.useState)(void 0);Object(r.useEffect)((()=>(null==a||a.subscribe((()=>{b(Date.now())})),()=>{null==a||a.unsubscribe()})),[a]);const{isLoading:h,data:p,refetch:j,isRefetching:C}=Object(w.a)({sloId:e,instanceId:t}),{data:L}=Object(S.a)({sloIds:e?[e]:[]}),{data:D}=Object(g.a)({sloIdsAndInstanceIds:p?[[p.id,null!==(i=p.instanceId)&&void 0!==i?i:m.a]]:[]}),{data:R=[]}=Object(E.a)({list:p?[{sloId:p.id,instanceId:null!==(l=p.instanceId)&&void 0!==l?l:m.a}]:[]});Object(r.useEffect)((()=>{j()}),[u,j]),Object(r.useEffect)((()=>{n&&(h||n())}),[h,n]);const M=!h&&void 0===p;if(C||h||!p)return o.a.createElement(_,null,o.a.createElement(x,null,o.a.createElement(v.EuiLoadingChart,null)));if(M)return o.a.createElement(_,null,o.a.createElement(x,null,s.i18n.translate("xpack.observability.sloEmbeddable.overview.sloNotFoundText",{defaultMessage:"The SLO has been deleted. You can safely delete the widget from the dashboard."})));const N=null==L?void 0:L[null==p?void 0:p.id],T=D.get(p),B=Boolean(p.groupBy&&p.groupBy!==m.a),G=null===(d=R.find((e=>{var t;return e.sloId===p.id&&e.instanceId===(null!==(t=p.instanceId)&&void 0!==t?t:m.a)})))||void 0===d?void 0:d.data,P=Object(y.a)(G,"sli_value");return o.a.createElement("div",{ref:c,style:{width:"100%"}},o.a.createElement(O.a,{slo:p,historicalSliData:null!=P?P:[]}),o.a.createElement(f.a,{containerRef:c},o.a.createElement(I.a,{slo:p,rules:N,activeAlerts:T,hasGroupBy:B})))}const _=p.euiStyled.div`
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  width: 100%;
  height: 100%;
`,x=p.euiStyled.div`
  flex: 0 0 auto;
  align-self: center;
  text-align: center;
`,C="SLO_EMBEDDABLE";class slo_embeddable_SLOEmbeddable extends l.Embeddable{constructor(e,t,n){super(t,{},n),i()(this,"type",C),i()(this,"node",void 0),i()(this,"reloadSubject",void 0),this.deps=e,this.reloadSubject=new h.Subject,this.setTitle(this.input.title||s.i18n.translate("xpack.observability.sloEmbeddable.displayTitle",{defaultMessage:"SLO Overview"}))}setTitle(e){this.updateInput({title:e})}onRenderComplete(){this.renderComplete.dispatchComplete()}render(e){super.render(e),this.node=e,this.node.setAttribute("data-shared-item","");const{sloId:t,sloInstanceId:n}=this.getInput(),a=new b.QueryClient,i=this.deps.i18n.Context;c.a.render(o.a.createElement(i,null,o.a.createElement(u.KibanaContextProvider,{services:this.deps},o.a.createElement(b.QueryClientProvider,{client:a},o.a.createElement(j,{onRenderComplete:()=>this.onRenderComplete(),sloId:t,sloInstanceId:n,reloadSubject:this.reloadSubject})))),e)}reload(){this.reloadSubject.next(!0)}destroy(){super.destroy(),this.node&&c.a.unmountComponentAtNode(this.node)}}const L=[{id:"slos",getDisplayName:()=>"SLOs",getIconType:()=>"visGauge"}];class slo_embeddable_factory_SloOverviewEmbeddableFactoryDefinition{constructor(e){i()(this,"type",C),i()(this,"grouping",L),i()(this,"getPanelPlacementSettings",(()=>({width:12,height:8}))),this.getStartServices=e}async isEditable(){return!0}async getExplicitInput(){const[e,t]=await this.getStartServices();try{const{resolveEmbeddableSloUserInput:a}=await n.e(13).then(n.bind(null,230));return await a(e,t)}catch(e){return Promise.reject()}}async create(e,t){try{const[{uiSettings:n,application:a,http:i,i18n:s}]=await this.getStartServices();return new slo_embeddable_SLOEmbeddable({uiSettings:n,application:a,http:i,i18n:s},e,t)}catch(n){return new l.ErrorEmbeddable(n,e,t)}}getDescription(){return s.i18n.translate("xpack.observability.sloEmbeddable.description",{defaultMessage:"Get an overview of your SLO health"})}getDisplayName(){return s.i18n.translate("xpack.observability.sloEmbeddable.displayName",{defaultMessage:"SLO Overview"})}getIconType(){return"visGauge"}}}}]);