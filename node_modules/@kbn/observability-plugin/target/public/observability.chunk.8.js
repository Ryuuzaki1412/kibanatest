/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.observability_bundle_jsonpfunction=window.observability_bundle_jsonpfunction||[]).push([[8,18],{103:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(1),a=n(125);function s(){return Object(r.useContext)(a.a)}},125:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(1);const a=Object(r.createContext)({})},130:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(4);const a="SLO_ALERTS_EMBEDDABLE",s=`${r.ob.SLO}-embeddable-alerts-table`},146:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(66),a=n(147),s=r.__importDefault(n(149));t.default=function(e,t){s.default(e,t,a.isDeepEqual)}},147:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var r=n(66).__importDefault(n(148));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.removeEventListener.apply(e,t)},t.isDeepEqual=r.default},148:function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,a,s;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(a=r;0!=a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(s=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=r;0!=a--;)if(!Object.prototype.hasOwnProperty.call(n,s[a]))return!1;for(a=r;0!=a--;){var o=s[a];if(!("_owner"===o&&t.$$typeof||e(t[o],n[o])))return!1}return!0}return t!=t&&n!=n}},149:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1);t.default=function(e,t,n){var a=r.useRef(void 0);a.current&&n(t,a.current)||(a.current=t),r.useEffect(e,a.current)}},164:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(0),a=n(95),s=n(130);const o="editSloAlertsPanelAction";function i(e){return{id:o,type:o,getIconType:e=>"pencil",getDisplayName:()=>r.i18n.translate("xpack.observability.actions.editSloAlertsEmbeddableTitle",{defaultMessage:"Edit configuration"}),async execute({embeddable:t}){if(!t)throw new Error("Not possible to execute an action without the embeddable context");const[r,a]=await e();try{const{resolveEmbeddableSloUserInput:e}=await Promise.all([n.e(0),n.e(2),n.e(12)]).then(n.bind(null,171)),s=await e(r,a,t.getInput());t.updateInput(s)}catch(e){return Promise.reject()}},isCompatible:async({embeddable:e})=>e.type===s.a&&e.getInput().viewMode===a.ViewMode.EDIT}}},169:function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return g}));var r=n(65),a=n.n(r),s=n(1),o=n.n(s),i=n(23);const l={services:{}},c=Object(s.createContext)(l);var u=n(146),d=n.n(u),b=n(77);const p=({children:e,component:t,render:n,...r})=>{const l=Object(s.useMemo)((()=>{if(t)return e=>Object(b.jsx)(o.a.Fragment,null,Object(b.jsx)(m,null),Object(b.jsx)(t,e))}),[t]);if(l)return Object(b.jsx)(i.Route,a()({},r,{component:l}));if(n||"function"==typeof e){const t="function"==typeof e?e:n;return Object(b.jsx)(i.Route,a()({},r,{render:e=>Object(b.jsx)(o.a.Fragment,null,Object(b.jsx)(m,null),t(e))}))}return Object(b.jsx)(i.Route,r,Object(b.jsx)(m,null),e)},m=()=>{const{executionContext:e}=Object(s.useContext)(c).services,t=Object(i.useRouteMatch)();return function(e,t){d()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null};var f=n(88);const h=({children:e,...t})=>Object(b.jsx)(i.Router,t,Object(b.jsx)(f.CompatRouter,null,e));var v=n(16);const g=({legacySwitch:e=!0,children:t})=>{const n=Object(i.useRouteMatch)();return e?Object(b.jsx)(i.Switch,null,t):Object(b.jsx)(f.Routes,null,s.Children.map(t,(e=>{if(o.a.isValidElement(e)&&e.type===p){var r;const a=Object(v.replace)(null==e?void 0:e.props.path,n.url+"/",""),s="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(b.jsx)(f.Route,{path:a,element:Object(b.jsx)(o.a.Fragment,null,Object(b.jsx)(m,null),(null==e||null===(r=e.props)||void 0===r?void 0:r.component)&&Object(b.jsx)(e.props.component,null)||s&&s()||t)})}return e})))}},192:function(e,t,n){"use strict";n.r(t),n.d(t,"COMMON_SLO_GROUPING",(function(){return C})),n.d(t,"SloOverviewEmbeddableFactoryDefinition",(function(){return slo_embeddable_factory_SloOverviewEmbeddableFactoryDefinition}));var r=n(2),a=n.n(r),s=n(0),o=n(82),i=n(1),l=n.n(i),c=n(81),u=n.n(c),d=n(13),b=n(78),p=n(26),m=n(12),f=n(14),h=n(102),v=n(154),g=n(127),y=n(126),E=n(139),j=n(133),O=n(158),S=n(172),x=n(129);function w({sloId:e,sloInstanceId:t,onRenderComplete:n,reloadSubject:r}){var a,o,c;const u=Object(i.useRef)(null),[d,b]=Object(i.useState)(void 0);Object(i.useEffect)((()=>(null==r||r.subscribe((()=>{b(Date.now())})),()=>{null==r||r.unsubscribe()})),[r]);const{isLoading:p,data:f,refetch:w,isRefetching:R}=Object(x.a)({sloId:e,instanceId:t}),{data:C}=Object(j.a)({sloIds:e?[e]:[]}),{data:L}=Object(E.a)({sloIdsAndInstanceIds:f?[[f.id,null!==(a=f.instanceId)&&void 0!==a?a:h.a]]:[]}),{data:A=[]}=Object(y.a)({list:f?[{sloId:f.id,instanceId:null!==(o=f.instanceId)&&void 0!==o?o:h.a}]:[]});Object(i.useEffect)((()=>{w()}),[d,w]),Object(i.useEffect)((()=>{n&&(p||n())}),[p,n]);const T=!p&&void 0===f;if(R||p||!f)return l.a.createElement(I,null,l.a.createElement(_,null,l.a.createElement(m.EuiLoadingChart,null)));if(T)return l.a.createElement(I,null,l.a.createElement(_,null,s.i18n.translate("xpack.observability.sloEmbeddable.overview.sloNotFoundText",{defaultMessage:"The SLO has been deleted. You can safely delete the widget from the dashboard."})));const M=null==C?void 0:C[null==f?void 0:f.id],D=L.get(f),k=Boolean(f.groupBy&&f.groupBy!==h.a),F=null===(c=A.find((e=>{var t;return e.sloId===f.id&&e.instanceId===(null!==(t=f.instanceId)&&void 0!==t?t:h.a)})))||void 0===c?void 0:c.data,N=Object(g.a)(F,"sli_value");return l.a.createElement("div",{ref:u,style:{width:"100%"}},l.a.createElement(S.a,{slo:f,historicalSliData:null!=N?N:[]}),l.a.createElement(v.a,{containerRef:u},l.a.createElement(O.a,{slo:f,rules:M,activeAlerts:D,hasGroupBy:k})))}const I=f.euiStyled.div`
  position: relative;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  justify-content: center;
  width: 100%;
  height: 100%;
`,_=f.euiStyled.div`
  flex: 0 0 auto;
  align-self: center;
  text-align: center;
`,R="SLO_EMBEDDABLE";class slo_embeddable_SLOEmbeddable extends o.Embeddable{constructor(e,t,n){super(t,{},n),a()(this,"type",R),a()(this,"node",void 0),a()(this,"reloadSubject",void 0),this.deps=e,this.reloadSubject=new p.Subject,this.setTitle(this.input.title||s.i18n.translate("xpack.observability.sloEmbeddable.displayTitle",{defaultMessage:"SLO Overview"}))}setTitle(e){this.updateInput({title:e})}onRenderComplete(){this.renderComplete.dispatchComplete()}render(e){super.render(e),this.node=e,this.node.setAttribute("data-shared-item","");const{sloId:t,sloInstanceId:n}=this.getInput(),r=new b.QueryClient,a=this.deps.i18n.Context;u.a.render(l.a.createElement(a,null,l.a.createElement(d.KibanaContextProvider,{services:this.deps},l.a.createElement(b.QueryClientProvider,{client:r},l.a.createElement(w,{onRenderComplete:()=>this.onRenderComplete(),sloId:t,sloInstanceId:n,reloadSubject:this.reloadSubject})))),e)}reload(){this.reloadSubject.next(!0)}destroy(){super.destroy(),this.node&&u.a.unmountComponentAtNode(this.node)}}const C=[{id:"slos",getDisplayName:()=>"SLOs",getIconType:()=>"visGauge"}];class slo_embeddable_factory_SloOverviewEmbeddableFactoryDefinition{constructor(e){a()(this,"type",R),a()(this,"grouping",C),a()(this,"getPanelPlacementSettings",(()=>({width:12,height:8}))),this.getStartServices=e}async isEditable(){return!0}async getExplicitInput(){const[e,t]=await this.getStartServices();try{const{resolveEmbeddableSloUserInput:r}=await n.e(13).then(n.bind(null,230));return await r(e,t)}catch(e){return Promise.reject()}}async create(e,t){try{const[{uiSettings:n,application:r,http:a,i18n:s}]=await this.getStartServices();return new slo_embeddable_SLOEmbeddable({uiSettings:n,application:r,http:a,i18n:s},e,t)}catch(n){return new o.ErrorEmbeddable(n,e,t)}}getDescription(){return s.i18n.translate("xpack.observability.sloEmbeddable.description",{defaultMessage:"Get an overview of your SLO health"})}getDisplayName(){return s.i18n.translate("xpack.observability.sloEmbeddable.displayName",{defaultMessage:"SLO Overview"})}getIconType(){return"visGauge"}}},227:function(e,t,n){"use strict";n.r(t),n.d(t,"SloAlertsEmbeddableFactoryDefinition",(function(){return slo_alerts_embeddable_factory_SloAlertsEmbeddableFactoryDefinition}));var r=n(2),a=n.n(r),s=n(0),o=n(82),i=n(192),l=n(1),c=n.n(l),u=n(81),d=n.n(u),b=n(78),p=n(9),m=n(100),f=n(13),h=n(169),v=n(26),g=n(79),y=n.n(g),E=n(43),j=n(12),O=n(4),S=n(102),x=n(130);const w=10,I="xpack.observability.sloAlertsEmbeddable.alert.table",_=(e,t)=>Object(l.useMemo)((()=>({bool:{filter:[{range:{"@timestamp":{gte:t.from}}},{term:{"kibana.alert.rule.rule_type_id":"slo.rules.burnRate"}},{bool:{should:e.map((e=>{return{bool:{must:[{term:{"slo.id":e.id}},...(t=e.instanceId)!==S.a?[{term:{"slo.instanceId":t}}]:[]]}};var t}))}}]}})),[e,t]);function R({slos:e,deps:t,timeRange:n,onLoaded:r,lastReloadRequestTime:a}){const{triggersActionsUi:{alertsTableConfigurationRegistry:s,getAlertsStateTable:o}}=t;return c.a.createElement(o,{query:_(e,n),alertsTableConfigurationRegistry:s,configurationId:x.b,featureIds:[O.ob.SLO,O.ob.OBSERVABILITY],hideLazyLoader:!0,id:I,pageSize:w,showAlertStatusWithFlapping:!0,onLoaded:()=>{r&&r()},lastReloadRequestTime:a})}var C=n(50),L=n(31),A=n(51),T=n(52);const M="60s",D="YYYY-MM-DD HH:mm";function k({slos:e,deps:t,timeRange:n,onLoaded:r}){const{charts:a,triggersActionsUi:{getAlertSummaryWidget:s}}=t,o=_(e,n),i=Object(A.a)(),u=Object(l.useMemo)((()=>Object(T.b)({from:n.from,to:n.to},i)),[n.from,n.to,i]),d=Object(l.useMemo)((()=>{var e,t;return Object(C.b)({from:n.from,to:n.to},null!==(e=null==u?void 0:u.intervalString)&&void 0!==e?e:M,null!==(t=null==u?void 0:u.dateFormat)&&void 0!==t?t:D)}),[n.from,n.to,u]),b={theme:a.theme.useChartsTheme(),baseTheme:a.theme.useChartsBaseTheme()};return c.a.createElement(s,{featureIds:L.h,filter:o,timeRange:d,chartProps:b,fullSize:!0,onLoaded:()=>{r&&r()}})}var F=n(164),N=n(7);function P({embeddable:e,slos:t,deps:n,timeRange:r,onRenderComplete:a,reloadSubject:i}){const{application:{navigateToUrl:u},http:{basePath:d}}=n,[b,p]=Object(l.useState)(r),[m,f]=Object(l.useState)(t),[h,v]=Object(l.useState)(void 0);Object(l.useEffect)((()=>{const e=null==i?void 0:i.subscribe((e=>{if(e){const{timeRange:t,slos:n}=e;f(n),!t||t.from===b.from&&t.to===b.to||p(t)}v(Date.now())}));return()=>{null==e||e.unsubscribe()}}),[i,b.from,b.to]),Object(l.useEffect)((()=>{p(r)}),[r]);const[g,y]=Object(l.useState)(!1),[O,S]=Object(l.useState)(!1);return Object(l.useEffect)((()=>{a&&g&&O&&a()}),[g,O,a]),c.a.createElement(G,null,c.a.createElement(B,{justifyContent:"flexEnd",wrap:!0},c.a.createElement(j.EuiFlexItem,{grow:!1},c.a.createElement(j.EuiLink,{onClick:()=>{const t=n.uiActions.getTrigger(o.CONTEXT_MENU_TRIGGER);n.uiActions.getAction(F.a).execute({trigger:t,embeddable:e})},"data-test-subj":"o11ySloAlertsWrapperSlOsIncludedLink"},s.i18n.translate("xpack.observability.sloAlertsWrapper.sLOsIncludedFlexItemLabel",{defaultMessage:"{numOfSlos} SLOs included",values:{numOfSlos:m.length}}))),c.a.createElement(j.EuiFlexItem,{grow:!1},c.a.createElement(j.EuiLink,{"data-test-subj":"o11ySloAlertsWrapperGoToAlertsLink",onClick:()=>{let e="";m.map(((t,n)=>{const r=n<m.length-1;e+=`(slo.id:"${t.id}" and slo.instanceId:"${t.instanceId}")`,r&&(e+=" or ")})),u(`${d.prepend(N.r.observability.alerts)}?_a=(kuery:'${e}',rangeFrom:${b.from},rangeTo:${b.to})`)}},c.a.createElement(E.FormattedMessage,{id:"xpack.observability.sloAlertsWrapper.goToAlertsFlexItemLabel",defaultMessage:"Go to alerts"})))),c.a.createElement(j.EuiFlexGroup,{direction:"column",style:{margin:"10px"},responsive:!0},c.a.createElement(j.EuiFlexItem,null,c.a.createElement(k,{slos:m,deps:n,timeRange:b,onLoaded:()=>y(!0)})),c.a.createElement(j.EuiFlexItem,{grow:!0},c.a.createElement(R,{slos:m,deps:n,timeRange:b,onLoaded:()=>S(!0),lastReloadRequestTime:h}))))}const G=y.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1bsympw-0"})(["width:100%;"]);var B=y()(j.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1bsympw-1"})(["margin:0 35px;"]);const $="SLO_ALERTS_EMBEDDABLE",U=Object(m.createBrowserHistory)();class slo_alerts_embeddable_SLOAlertsEmbeddable extends o.Embeddable{constructor(e,t,n,r){super(t,{},r),a()(this,"type",$),a()(this,"reloadSubject",void 0),a()(this,"node",void 0),a()(this,"kibanaVersion",void 0),a()(this,"subscription",void 0),this.deps=e,this.deps=e,this.kibanaVersion=n,this.reloadSubject=new v.Subject,this.subscription=this.getInput$().subscribe((e=>{this.reloadSubject.next(e)})),this.setTitle(this.input.title||s.i18n.translate("xpack.observability.sloAlertsEmbeddable.displayTitle",{defaultMessage:"SLO Alerts"}))}onRenderComplete(){this.renderComplete.dispatchComplete()}setTitle(e){this.updateInput({title:e})}render(e){super.render(e),this.node=e,this.node.setAttribute("data-shared-item","");const t=new b.QueryClient,n=this.deps.i18n.Context,{slos:r,timeRange:a={from:"now-15m/m",to:"now"}}=this.getInput(),s=this.deps,o=this.kibanaVersion;d.a.render(c.a.createElement(n,null,c.a.createElement(f.KibanaContextProvider,{services:{...this.deps,storage:new p.Storage(localStorage),isServerless:!!s.serverless,kibanaVersion:o}},c.a.createElement(h.b,{history:U},c.a.createElement(b.QueryClientProvider,{client:t},c.a.createElement(P,{onRenderComplete:()=>this.onRenderComplete(),embeddable:this,deps:s,slos:r,timeRange:a,reloadSubject:this.reloadSubject}))))),e)}reload(){var e;null===(e=this.reloadSubject)||void 0===e||e.next(void 0)}destroy(){super.destroy(),this.subscription.unsubscribe(),this.node&&d.a.unmountComponentAtNode(this.node)}}class slo_alerts_embeddable_factory_SloAlertsEmbeddableFactoryDefinition{constructor(e,t){a()(this,"type",$),a()(this,"grouping",i.COMMON_SLO_GROUPING),this.getStartServices=e,this.kibanaVersion=t}async isEditable(){return!0}async getExplicitInput(){const[e,t]=await this.getStartServices();try{const{resolveEmbeddableSloUserInput:r}=await n.e(11).then(n.bind(null,171));return await r(e,t)}catch(e){return Promise.reject()}}async create(e,t){try{const[n,r]=await this.getStartServices(),a={...n,...r};return new slo_alerts_embeddable_SLOAlertsEmbeddable(a,e,this.kibanaVersion,t)}catch(n){return new o.ErrorEmbeddable(n,e,t)}}getDescription(){return s.i18n.translate("xpack.observability.sloAlertsEmbeddable.description",{defaultMessage:"Get an overview of your SLO alerts"})}getDisplayName(){return s.i18n.translate("xpack.observability.sloAlertsEmbeddable.displayName",{defaultMessage:"SLO Alerts"})}getIconType(){return"alert"}}}}]);