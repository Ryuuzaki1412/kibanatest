(window.unifiedSearch_bundle_jsonpfunction=window.unifiedSearch_bundle_jsonpfunction||[]).push([[5],{114:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(115);case"v8light":return n(117)}},115:function(e,t,n){var r=n(21),o=n(116);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);r(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},116:function(e,t,n){(t=n(22)(!1)).push([e.i,".kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid{background-image:linear-gradient(0deg,#f86b63,#f86b63 2px,#0000 0,#0000)}.kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid:focus{background-color:#16171c;background-image:linear-gradient(0deg,#36a2ef,#36a2ef 2px,#0000 0,#0000);color:#dfe5ef}",""]),e.exports=t},117:function(e,t,n){var r=n(21),o=n(118);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);r(o,{insert:"head",singleton:!1}),e.exports=o.locals||{}},118:function(e,t,n){(t=n(22)(!1)).push([e.i,".kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid{background-image:linear-gradient(0deg,#bd271e,#bd271e 2px,#0000 0,#0000)}.kbnQueryBar__datePickerWrapper .euiDatePopoverButton-isInvalid:focus{background-color:#fbfcfd;background-image:linear-gradient(0deg,#07c,#07c 2px,#0000 0,#0000);color:#343741}",""]),e.exports=t},119:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(43),o=n(0),a=r.__importDefault(n(120));t.default=function(e,t){var n=o.useState(t),r=n[0],i=n[1];return a.default((function(){var t=e.subscribe(i);return function(){return t.unsubscribe()}}),[e]),r}},120:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o="undefined"!=typeof window?r.useLayoutEffect:r.useEffect;t.default=o},139:function(e,t,n){"use strict";n.r(t),n.d(t,"strings",(function(){return Q})),n.d(t,"SharingMetaFields",(function(){return M})),n.d(t,"QueryBarTopRow",(function(){return U}));var r=n(7),o=n.n(r),a=n(16),i=n.n(a),s=n(40),u=n.n(s),l=n(0),c=n.n(l),d=n(81),g=n.n(d),b=n(119),f=n.n(b),p=n(20),j=n(49),m=n(9),y=n(28),O=n(4),v=n(19),h=n(5),x=n(23),S=n(11),F=n(12),P=n(138),T=n(1);const B="data.noDataPopover",D={getNoDataPopoverContent:()=>h.i18n.translate("unifiedSearch.noDataPopover.content",{defaultMessage:"This time range doesn't contain any data. Increase or adjust the time range to see more fields and create charts."}),getNoDataPopoverSubtitle:()=>h.i18n.translate("unifiedSearch.noDataPopover.subtitle",{defaultMessage:"Tip"}),getNoDataPopoverTitle:()=>h.i18n.translate("unifiedSearch.noDataPopover.title",{defaultMessage:"Empty dataset"}),getNoDataPopoverDismissAction:()=>h.i18n.translate("unifiedSearch.noDataPopover.dismissAction",{defaultMessage:"Don't show again"})};function E({showNoDataPopover:e,storage:t,children:n}){const[r,o]=Object(l.useState)((()=>Boolean(t.get(B)))),[a,i]=Object(l.useState)(!1);return Object(l.useEffect)((()=>{e&&!r&&i(!0)}),[r,e]),Object(T.jsx)(v.EuiTourStep,{onFinish:()=>{},closePopover:()=>{i(!1)},content:Object(T.jsx)(v.EuiText,{size:"s"},Object(T.jsx)("p",{style:{maxWidth:300}},D.getNoDataPopoverContent())),minWidth:300,anchorPosition:"downCenter",anchorClassName:"eui-displayBlock",step:1,stepsTotal:1,isStepOpen:a,subtitle:D.getNoDataPopoverSubtitle(),title:D.getNoDataPopoverTitle(),footerAction:Object(T.jsx)(v.EuiButtonEmpty,{size:"xs",flush:"right",color:"text","data-test-subj":"noDataPopoverDismissButton",onClick:()=>{t.set(B,!0),o(!0),i(!1)}},D.getNoDataPopoverDismissAction())},Object(T.jsx)("div",{onFocus:()=>{i(!1)}},n))}var w=n(63),k=n(73),R=n(78),C=n(61);const L=()=>h.i18n.translate("unifiedSearch.filter.filterBar.addFilterButtonLabel",{defaultMessage:"Add filter"}),I=c.a.memo((function({indexPatterns:e,filters:t,timeRangeForSuggestionsOverride:n,filtersForSuggestions:r,onFiltersUpdated:a,buttonProps:i,isDisabled:s,onCloseFilterPopover:u,onLocalFilterUpdate:c,onLocalFilterCreate:d,suggestionsAbstraction:g}){const b=Object(v.useEuiTheme)(),[f,p]=Object(l.useState)(!1),j=Object(T.jsx)(v.EuiToolTip,{delay:"long",content:L()},Object(T.jsx)(v.EuiButtonIcon,o()({display:"base",iconType:"plusInCircleFilled","aria-label":L(),"data-test-subj":"addFilter",onClick:()=>p((e=>!e)),size:"m",disabled:s},i,{style:{borderTopLeftRadius:0,borderBottomLeftRadius:0}}))),m=Object(l.useCallback)((()=>{u([()=>p(!1)])}),[u]);return Object(T.jsx)(v.EuiFlexItem,{grow:!1},Object(T.jsx)(v.EuiPopover,{id:"addFilterPopover",button:j,isOpen:f,closePopover:m,anchorPosition:"downLeft",panelPaddingSize:"none",panelProps:{"data-test-subj":"addFilterPopover",css:Object(R.a)(b)},initialFocus:".filterEditor__hiddenItem",ownFocus:!0,repositionOnScroll:!0},Object(T.jsx)(k.a,{indexPatterns:e,filters:t,timeRangeForSuggestionsOverride:n,filtersForSuggestions:r,onFiltersUpdated:a,onLocalFilterUpdate:c,onLocalFilterCreate:d,closePopoverOnAdd:()=>{p(!1)},closePopoverOnCancel:()=>{p(!1)},suggestionsAbstraction:g})))})),_=Object(C.m)(I);var q=n(13),A=n(72);n(114);const Q={getNeedsUpdatingLabel:()=>h.i18n.translate("unifiedSearch.queryBarTopRow.submitButton.update",{defaultMessage:"Needs updating"}),getRefreshQueryLabel:()=>h.i18n.translate("unifiedSearch.queryBarTopRow.submitButton.refresh",{defaultMessage:"Refresh query"}),getRunQueryLabel:()=>h.i18n.translate("unifiedSearch.queryBarTopRow.submitButton.run",{defaultMessage:"Run query"}),getDisabledDatePickerLabel:()=>h.i18n.translate("unifiedSearch.queryBarTopRow.datePicker.disabledLabel",{defaultMessage:"All time"})},N=c.a.memo(v.EuiSuperDatePicker),M=c.a.memo((function({from:e,to:t,dateFormat:n}){function r(e,t=!1){const n=i.a.parse(e,{roundUp:t});return n?n.toISOString():e}try{const o=Object(v.usePrettyDuration)({timeFrom:r(e),timeTo:r(t),quickRanges:[],dateFormat:n});return Object(T.jsx)("div",{"data-shared-timefilter-duration":o,"data-test-subj":"dataSharedTimefilterDuration"})}catch(e){return Object(T.jsx)("div",{"data-test-subj":"dataSharedTimefilterDuration"})}})),U=c.a.memo((function(e){var t,n;const r=Object(v.useIsWithinBreakpoints)(["xs","s"]),[a,i]=Object(l.useState)(!1),[s,d]=Object(l.useState)(!1),g=null!==(t=e.submitButtonStyle)&&void 0!==t?t:"auto",b="auto"===g?!a:"iconOnly"===g;Object(l.useEffect)((()=>{if("auto"!==g)return;const e=Object(O.throttle)((()=>{i(window.innerWidth>=1440)}),50);return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[g]);const{showQueryInput:B=!0,showDatePicker:D=!0,showAutoRefreshOnly:w=!1,showSubmitButton:k=!0}=e,[R,C]=Object(l.useState)(!1),[L,I]=Object(l.useState)(!1),U=Object(S.useKibana)(),{uiSettings:W,storage:z,appName:K,data:V,usageCollection:G,unifiedSearch:Y,notifications:H,docLinks:J,http:$,dataViews:X}=U.services,Z=e.query&&!Object(p.isOfQueryType)(e.query),ee=e.query&&Object(p.isOfQueryType)(e.query)&&e.query.language,te=Object(l.useRef)(e.query);te.current=e.query;const ne=c.a.useMemo((()=>ee&&W&&z&&K?Object(x.getQueryLog)(W,z,K,ee):void 0),[K,ee,W,z]),re=function(){const t=W.get(F.UI_SETTINGS.TIMEPICKER_TIME_DEFAULTS);return{from:e.dateRangeFrom||t.from,to:e.dateRangeTo||t.to}}(),oe=Object(l.useRef)(re);oe.current=re;const ae=e.onSubmit,ie=e=>e.map((({from:e,to:t})=>({start:e,end:t}))),se=e.timeHistory,ue=Object(l.useMemo)((()=>{var e;return null!==(e=null==se?void 0:se.get$().pipe(Object(y.map)(ie)))&&void 0!==e?e:m.EMPTY}),[se]),le=f()(ue,ie(null!==(n=null==se?void 0:se.get())&&void 0!==n?n:[])),[ce]=Object(l.useState)((()=>{var e,t;return null!==(e=null==W||null===(t=W.get(F.UI_SETTINGS.TIMEPICKER_QUICK_RANGES))||void 0===t?void 0:t.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n}))))&&void 0!==e?e:[]})),de=Object(l.useCallback)((({query:e,dateRange:t})=>{se&&se.add(t),ae({query:e,dateRange:t})}),[se,ae]),ge=Object(l.useCallback)((e=>{ne&&te.current&&Object(p.isOfQueryType)(te.current)&&ne.add(te.current.query),e.preventDefault(),de({query:te.current,dateRange:oe.current})}),[ne,de]),be=e.onChange,fe=Object(l.useCallback)((e=>be({query:e,dateRange:oe.current})),[be]),pe=Object(l.useCallback)((e=>{I(e)}),[]),je=Object(l.useCallback)((({start:e,end:t,isInvalid:n,isQuickSelection:r})=>{C(n);const o={query:te.current,dateRange:{from:e,to:t}};r?de(o):be(o)}),[be,de]),me=e.onRefresh,ye=Object(l.useCallback)((({start:e,end:t})=>{me&&me({dateRange:{from:e,to:t}})}),[me]),Oe=Object(l.useCallback)((e=>{de({query:e,dateRange:oe.current})}),[de]);function ve(){return Boolean(B&&e.query&&z)}function he(){return Boolean(D||w)}function xe(){return!Boolean(e.showAddFilter)&&Boolean(e.prepend)}function Se(){return Boolean(k)&&Boolean(B||D||w)}function Fe(){return Boolean(e.showDatePickerAsBadge)&&!ve()}function Pe(){return(Boolean(e.showAddFilter)||Boolean(e.prepend))&&Object(T.jsx)(v.EuiFlexItem,{grow:!1},Object(T.jsx)(A.a,{items:[e.prepend,Boolean(e.showAddFilter)&&Object(T.jsx)(v.EuiFlexItem,{grow:!1},Object(T.jsx)(_,{indexPatterns:e.indexPatterns,filters:e.filters,timeRangeForSuggestionsOverride:e.timeRangeForSuggestionsOverride,filtersForSuggestions:e.filtersForSuggestions,onFiltersUpdated:e.onFiltersUpdated,buttonProps:{size:Fe()?"s":"m",display:"empty"},isDisabled:e.isDisabled,suggestionsAbstraction:e.suggestionsAbstraction}))],attached:xe(),size:Fe()?"s":"m"}))}function Te(){var t;const n=null===(t=e.indexPatterns)||void 0===t?void 0:t[0];let r=!1;return n&&"string"!=typeof n&&(r=Boolean(null==n?void 0:n.timeFieldName)),Z&&e.query&&Object(p.isOfAggregateQueryType)(e.query)&&Object(T.jsx)(j.TextBasedLangEditor,{query:e.query,onTextLangQueryChange:e.onTextLangQueryChange,expandCodeEditor:e=>d(e),isCodeEditorExpanded:s,errors:e.textBasedLanguageModeErrors,warning:e.textBasedLanguageModeWarning,detectTimestamp:r,onTextLangQuerySubmit:()=>de({query:te.current,dateRange:oe.current}),isDisabled:e.isDisabled,hideRunQueryText:e.hideTextBasedRunQueryLabel,"data-test-subj":"unifiedTextLangEditor"})}const Be=!0===e.isScreenshotMode;return Object(T.jsx)(c.a.Fragment,null,Object(T.jsx)(M,{from:re.from,to:re.to,dateFormat:W.get("dateFormat")}),!Be&&Object(T.jsx)(c.a.Fragment,null,Object(T.jsx)(v.EuiFlexGroup,{className:"kbnQueryBar",direction:r&&!Fe()?"column":"row",responsive:!1,gutterSize:"s",justifyContent:Fe()?"flexStart":"flexEnd",wrap:!0},e.dataViewPickerOverride||function(){if(!e.dataViewPickerComponentProps)return;let t;if(Boolean(Z)){const n=e.query;t=Object(p.getAggregateQueryMode)(n)}return Object(T.jsx)(v.EuiFlexItem,{style:{maxWidth:"100%"},grow:r},Object(T.jsx)(q.a,o()({},e.dataViewPickerComponentProps,{trigger:{fullWidth:r,...e.dataViewPickerComponentProps.trigger},onTextLangQuerySubmit:e.onTextLangQuerySubmit,textBasedLanguage:t,onSaveTextLanguageQuery:e.onTextBasedSavedAndExit,isDisabled:e.isDisabled})))}(),Object(T.jsx)(v.EuiFlexItem,{grow:!Fe(),style:{minWidth:Fe()?"auto":320,maxWidth:"100%"}},Z?s?null:Te():Object(T.jsx)(v.EuiFlexGroup,{gutterSize:"s",responsive:!1},!xe()&&Pe(),ve()&&Object(T.jsx)(v.EuiFlexItem,{"data-test-subj":"unifiedQueryInput"},Object(T.jsx)(P.default,{disableAutoFocus:e.disableAutoFocus,indexPatterns:e.indexPatterns,query:e.query,screenTitle:e.screenTitle,onChange:fe,onChangeQueryInputFocus:pe,onSubmit:Oe,persistedLog:ne,dataTestSubj:e.dataTestSubj,placeholder:e.placeholder,isClearable:e.isClearable,iconType:e.iconType,nonKqlMode:e.nonKqlMode,timeRangeForSuggestionsOverride:e.timeRangeForSuggestionsOverride,filtersForSuggestions:e.filtersForSuggestions,disableLanguageSwitcher:!0,prepend:xe()&&Pe(),size:e.suggestionsSize,suggestionsAbstraction:e.suggestionsAbstraction,isDisabled:e.isDisabled,appName:K,submitOnBlur:e.submitOnBlur,deps:{unifiedSearch:Y,data:V,storage:z,usageCollection:G,notifications:H,docLinks:J,http:$,uiSettings:W,dataViews:X}})))),Fe()&&e.filterBar,function(){if(!Se()&&!he())return null;const t=Q.getNeedsUpdatingLabel(),n=Q.getRefreshQueryLabel(),o=Q.getRunQueryLabel(),a=Boolean(Z)?"play":"kqlFunction",i=Boolean(Z)?o:t,s=e.customSubmitButton?c.a.cloneElement(e.customSubmitButton,{onClick:ge}):Object(T.jsx)(v.EuiFlexItem,{grow:!1},Object(T.jsx)(v.EuiSuperUpdateButton,{iconType:e.isDirty?a:"refresh",iconOnly:b,"aria-label":e.isLoading?t:n,isDisabled:R||e.isDisabled,isLoading:e.isLoading,onClick:ge,size:Fe()?"s":"m",color:e.isDirty?"success":"primary",fill:e.isDirty,needsUpdate:e.isDirty,"data-test-subj":"querySubmitButton",toolTipProps:{content:e.isDirty?i:n,delay:"long",position:"bottom"}}));return!he()&&Se()?s:Object(T.jsx)(v.EuiFlexItem,{grow:!1},Object(T.jsx)(E,{storage:z,showNoDataPopover:e.indicateNoData},Object(T.jsx)(v.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},he()?function(){if(!he())return null;let t=Boolean(e.isDisabled),n=!1;if(Boolean(Z)&&!e.isDirty){var o;const r=null===(o=e.indexPatterns)||void 0===o?void 0:o[0];r&&"string"!=typeof r&&(r.timeFieldName||(t={display:Object(T.jsx)("span",{"data-test-subj":"kbnQueryBar-datePicker-disabled"},Q.getDisabledDatePickerLabel())}),n=!Boolean(r.timeFieldName))}const a=u()("kbnQueryBar__datePickerWrapper"),i=((e,t,n)=>{if(t&&n&&Object(p.isOfAggregateQueryType)(n)){const t=Object(p.getAggregateQueryMode)(n),r=Object(p.getLanguageDisplayName)(t);return Object(T.jsx)(v.EuiToolTip,{position:"top",content:h.i18n.translate("unifiedSearch.query.queryBar.textBasedNonTimestampWarning",{defaultMessage:"Date range selection for {language} queries requires an @timestamp field in the dataset.",values:{language:r}})},e)}return e})(Object(T.jsx)(N,{isDisabled:t,start:e.dateRangeFrom,end:e.dateRangeTo,isPaused:e.isRefreshPaused,refreshInterval:e.refreshInterval,onTimeChange:je,onRefresh:ye,onRefreshChange:e.onRefreshChange,showUpdateButton:!1,recentlyUsedRanges:le,locale:h.i18n.getLocale(),commonlyUsedRanges:ce,dateFormat:W.get("dateFormat"),isAutoRefreshOnly:w,className:"kbnQueryBar__datePicker",isQuickSelectOnly:!r&&L,width:r?"full":"auto",compressed:Fe()}),n,e.query);return Object(T.jsx)(v.EuiFlexItem,{className:a},i)}():null,Se()?s:null)))}()),!Fe()&&e.filterBar,s&&Te()))}),(({query:e,...t},{query:n,...r})=>{let o=!0;return e!==n&&(g()(e,n)||(o=!1)),o&&Object(w.a)(t,r)}));t.default=U},73:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var r=n(0),o=n.n(r),a=n(20),i=n(10),s=n(11),u=n(12),l=n(42),c=n(61),d=n(70),g=n(1);const b=o.a.memo((function({indexPatterns:e,filters:t,timeRangeForSuggestionsOverride:n,filtersForSuggestions:o,closePopoverOnAdd:b,closePopoverOnCancel:f,onFiltersUpdated:p,onLocalFilterUpdate:j,onLocalFilterCreate:m,suggestionsAbstraction:y}){const O=Object(r.useRef)(),v=Object(s.useKibana)(),{uiSettings:h,data:x,usageCollection:S,appName:F,docLinks:P}=v.services,T=null==S?void 0:S.reportUiCounter.bind(S,F),[B,D]=Object(r.useState)([]),[E,w]=Object(r.useState)(void 0),k=h.get(u.UI_SETTINGS.FILTERS_PINNED_BY_DEFAULT);return Object(r.useEffect)((()=>(O.current=new AbortController,()=>{var e;null===(e=O.current)||void 0===e||e.abort()})),[]),Object(r.useEffect)((()=>{e&&(async()=>{var t;const n=null==e?void 0:e.filter((e=>"string"==typeof e)),r=null==e?void 0:e.filter((e=>"string"!=typeof e));null===(t=O.current)||void 0===t||t.abort(),O.current=new AbortController;const o=O.current,i=await Object(d.a)(x.dataViews,n.map((e=>({type:"title",value:e}))));if(!o.signal.aborted){D([...r,...i]);const[e]=[...r,...i],t=e&&e.id,n=Object(a.buildEmptyFilter)(k,t);w(n)}})()}),[x.dataViews,e,m,j,k]),Object(g.jsx)("div",{style:{width:l.FILTER_EDITOR_WIDTH,maxWidth:"100%"}},E&&Object(g.jsx)(c.a,{mode:"add",filter:E,indexPatterns:B,key:JSON.stringify(E),onSubmit:function(e){null==T||T(i.METRIC_TYPE.CLICK,"filter:added"),null==b||b();const n=[...t,e];null==p||p(n)},onCancel:()=>null==f?void 0:f(),onLocalFilterUpdate:j,onLocalFilterCreate:m,timeRangeForSuggestionsOverride:n,filtersForSuggestions:o,suggestionsAbstraction:y,docLinks:P}))}))},78:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(19),o=n(1);const a=e=>Object(o.css)("transform:none!important;transition:none!important;filter:none!important;",Object(r.euiShadowMedium)(e),";","")},81:function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,o,a;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(o=r;0!=o--;)if(!e(t[o],n[o]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(a=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(o=r;0!=o--;)if(!Object.prototype.hasOwnProperty.call(n,a[o]))return!1;for(o=r;0!=o--;){var i=a[o];if(!e(t[i],n[i]))return!1}return!0}return t!=t&&n!=n}}}]);