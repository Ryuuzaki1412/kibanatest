/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.reporting_bundle_jsonpfunction=window.reporting_bundle_jsonpfunction||[]).push([[2],{41:function(e,t,n){"use strict";var i,s=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),o=[];function a(e){for(var t=-1,n=0;n<o.length;n++)if(o[n].identifier===e){t=n;break}return t}function r(e,t){for(var n={},i=[],s=0;s<e.length;s++){var r=e[s],l=t.base?r[0]+t.base:r[0],c=n[l]||0,u="".concat(l," ").concat(c);n[l]=c+1;var p=a(u),d={css:r[1],media:r[2],sourceMap:r[3]};-1!==p?(o[p].references++,o[p].updater(d)):o.push({identifier:u,updater:b(d,t),references:1}),i.push(u)}return i}function l(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var o=n.nc;o&&(i.nonce=o)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var a=s(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function p(e,t,n,i){var s=n?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=u(t,s);else{var o=document.createTextNode(s),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(o,a[t]):e.appendChild(o)}}function d(e,t,n){var i=n.css,s=n.media,o=n.sourceMap;if(s?e.setAttribute("media",s):e.removeAttribute("media"),o&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var g=null,f=0;function b(e,t){var n,i,s;if(t.singleton){var o=f++;n=g||(g=l(t)),i=p.bind(null,n,o,!1),s=p.bind(null,n,o,!0)}else n=l(t),i=d.bind(null,n,t),s=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else s()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i));var n=r(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<n.length;i++){var s=a(n[i]);o[s].references--}for(var l=r(e,t),c=0;c<n.length;c++){var u=a(n[c]);0===o[u].references&&(o[u].updater(),o.splice(u,1))}n=l}}}},42:function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n,i,s,o=e[1]||"",a=e[3];if(!a)return o;if(t&&"function"==typeof btoa){var r=(n=a,i=btoa(unescape(encodeURIComponent(JSON.stringify(n)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(i),"/*# ".concat(s," */")),l=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[o].concat(l).concat([r]).join("\n")}return[o].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var s={};if(i)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(s[a]=!0)}for(var r=0;r<e.length;r++){var l=[].concat(e[r]);i&&s[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),t.push(l))}},t}},43:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(40),s=n(3),o=i.__importDefault(n(45));t.default=function(e,t){var n=s.useState(t),i=n[0],a=n[1];return o.default((function(){var t=e.subscribe(a);return function(){return t.unsubscribe()}}),[e]),i}},44:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3);t.default=function(){var e=i.useRef(!1),t=i.useCallback((function(){return e.current}),[]);return i.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(3),s="undefined"!=typeof window?i.useLayoutEffect:i.useEffect;t.default=s},46:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n(47);Object.keys(i).forEach((function(e){"default"!==e&&"__esModule"!==e&&(e in t&&t[e]===i[e]||Object.defineProperty(t,e,{enumerable:!0,get:function(){return i[e]}}))}))},47:function(e,t,n){"use strict";function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.useIsNestedEuiProvider=t.EuiProviderNestedCheck=t.EuiNestedProviderContext=void 0;var s=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==i(e)&&"function"!=typeof e)return{default:e};var n=a(t);if(n&&n.has(e))return n.get(e);var s={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in e)if("default"!==r&&Object.prototype.hasOwnProperty.call(e,r)){var l=o?Object.getOwnPropertyDescriptor(e,r):null;l&&(l.get||l.set)?Object.defineProperty(s,r,l):s[r]=e[r]}return s.default=e,n&&n.set(e,s),s}(n(3)),o=n(0);function a(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(a=function(e){return e?n:t})(e)}var r=(0,s.createContext)(!1);t.EuiNestedProviderContext=r,t.EuiProviderNestedCheck=function(e){var t=e.children;return(0,o.jsx)(r.Provider,{value:!0},t)},t.useIsNestedEuiProvider=function(){return!!(0,s.useContext)(r)}},48:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setEuiDevProviderWarning=t.getEuiDevProviderWarning=t.emitEuiProviderWarning=void 0;var i=void 0;t.setEuiDevProviderWarning=function(e){return i=e},t.getEuiDevProviderWarning=function(){return i},t.emitEuiProviderWarning=function(e){switch(i){case"log":console.log(e);break;case"warn":console.warn(e);break;case"error":throw new Error(e)}}},49:function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(50);case"v8light":return n(52)}},50:function(e,t,n){var i=n(41),s=n(51);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);i(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},51:function(e,t,n){(t=n(42)(!1)).push([e.i,".kbnReporting__reportListing__typeIcon{padding-left:8px}",""]),e.exports=t},52:function(e,t,n){var i=n(41),s=n(53);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[e.i,s,""]]);i(s,{insert:"head",singleton:!1}),e.exports=s.locals||{}},53:function(e,t,n){(t=n(42)(!1)).push([e.i,".kbnReporting__reportListing__typeIcon{padding-left:8px}",""]),e.exports=t},54:function(e,t,n){var i,s=function(){var e=String.fromCharCode,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function s(e,t){if(!i[e]){i[e]={};for(var n=0;n<e.length;n++)i[e][e.charAt(n)]=n}return i[e][t]}var o={compressToBase64:function(e){if(null==e)return"";var n=o._compress(e,6,(function(e){return t.charAt(e)}));switch(n.length%4){default:case 0:return n;case 1:return n+"===";case 2:return n+"==";case 3:return n+"="}},decompressFromBase64:function(e){return null==e?"":""==e?null:o._decompress(e.length,32,(function(n){return s(t,e.charAt(n))}))},compressToUTF16:function(t){return null==t?"":o._compress(t,15,(function(t){return e(t+32)}))+" "},decompressFromUTF16:function(e){return null==e?"":""==e?null:o._decompress(e.length,16384,(function(t){return e.charCodeAt(t)-32}))},compressToUint8Array:function(e){for(var t=o.compress(e),n=new Uint8Array(2*t.length),i=0,s=t.length;i<s;i++){var a=t.charCodeAt(i);n[2*i]=a>>>8,n[2*i+1]=a%256}return n},decompressFromUint8Array:function(t){if(null==t)return o.decompress(t);for(var n=new Array(t.length/2),i=0,s=n.length;i<s;i++)n[i]=256*t[2*i]+t[2*i+1];var a=[];return n.forEach((function(t){a.push(e(t))})),o.decompress(a.join(""))},compressToEncodedURIComponent:function(e){return null==e?"":o._compress(e,6,(function(e){return n.charAt(e)}))},decompressFromEncodedURIComponent:function(e){return null==e?"":""==e?null:(e=e.replace(/ /g,"+"),o._decompress(e.length,32,(function(t){return s(n,e.charAt(t))})))},compress:function(t){return o._compress(t,16,(function(t){return e(t)}))},_compress:function(e,t,n){if(null==e)return"";var i,s,o,a={},r={},l="",c="",u="",p=2,d=3,g=2,f=[],b=0,h=0;for(o=0;o<e.length;o+=1)if(l=e.charAt(o),Object.prototype.hasOwnProperty.call(a,l)||(a[l]=d++,r[l]=!0),c=u+l,Object.prototype.hasOwnProperty.call(a,c))u=c;else{if(Object.prototype.hasOwnProperty.call(r,u)){if(u.charCodeAt(0)<256){for(i=0;i<g;i++)b<<=1,h==t-1?(h=0,f.push(n(b)),b=0):h++;for(s=u.charCodeAt(0),i=0;i<8;i++)b=b<<1|1&s,h==t-1?(h=0,f.push(n(b)),b=0):h++,s>>=1}else{for(s=1,i=0;i<g;i++)b=b<<1|s,h==t-1?(h=0,f.push(n(b)),b=0):h++,s=0;for(s=u.charCodeAt(0),i=0;i<16;i++)b=b<<1|1&s,h==t-1?(h=0,f.push(n(b)),b=0):h++,s>>=1}0==--p&&(p=Math.pow(2,g),g++),delete r[u]}else for(s=a[u],i=0;i<g;i++)b=b<<1|1&s,h==t-1?(h=0,f.push(n(b)),b=0):h++,s>>=1;0==--p&&(p=Math.pow(2,g),g++),a[c]=d++,u=String(l)}if(""!==u){if(Object.prototype.hasOwnProperty.call(r,u)){if(u.charCodeAt(0)<256){for(i=0;i<g;i++)b<<=1,h==t-1?(h=0,f.push(n(b)),b=0):h++;for(s=u.charCodeAt(0),i=0;i<8;i++)b=b<<1|1&s,h==t-1?(h=0,f.push(n(b)),b=0):h++,s>>=1}else{for(s=1,i=0;i<g;i++)b=b<<1|s,h==t-1?(h=0,f.push(n(b)),b=0):h++,s=0;for(s=u.charCodeAt(0),i=0;i<16;i++)b=b<<1|1&s,h==t-1?(h=0,f.push(n(b)),b=0):h++,s>>=1}0==--p&&(p=Math.pow(2,g),g++),delete r[u]}else for(s=a[u],i=0;i<g;i++)b=b<<1|1&s,h==t-1?(h=0,f.push(n(b)),b=0):h++,s>>=1;0==--p&&(p=Math.pow(2,g),g++)}for(s=2,i=0;i<g;i++)b=b<<1|1&s,h==t-1?(h=0,f.push(n(b)),b=0):h++,s>>=1;for(;;){if(b<<=1,h==t-1){f.push(n(b));break}h++}return f.join("")},decompress:function(e){return null==e?"":""==e?null:o._decompress(e.length,32768,(function(t){return e.charCodeAt(t)}))},_decompress:function(t,n,i){var s,o,a,r,l,c,u,p=[],d=4,g=4,f=3,b="",h=[],m={val:i(0),position:n,index:1};for(s=0;s<3;s+=1)p[s]=s;for(a=0,l=Math.pow(2,2),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;switch(a){case 0:for(a=0,l=Math.pow(2,8),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;u=e(a);break;case 1:for(a=0,l=Math.pow(2,16),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;u=e(a);break;case 2:return""}for(p[3]=u,o=u,h.push(u);;){if(m.index>t)return"";for(a=0,l=Math.pow(2,f),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;switch(u=a){case 0:for(a=0,l=Math.pow(2,8),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;p[g++]=e(a),u=g-1,d--;break;case 1:for(a=0,l=Math.pow(2,16),c=1;c!=l;)r=m.val&m.position,m.position>>=1,0==m.position&&(m.position=n,m.val=i(m.index++)),a|=(r>0?1:0)*c,c<<=1;p[g++]=e(a),u=g-1,d--;break;case 2:return h.join("")}if(0==d&&(d=Math.pow(2,f),f++),p[u])b=p[u];else{if(u!==g)return null;b=o+o.charAt(0)}h.push(b),p[g++]=o+b.charAt(0),o=b,0==--d&&(d=Math.pow(2,f),f++)}}};return o}();void 0===(i=function(){return s}.call(t,n,t,e))||(e.exports=i)},68:function(e,t,n){"use strict";n.r(t),n.d(t,"mountManagementSection",(function(){return ke}));var i=n(3),s=n.n(i),o=n(38),a=n(4),r=n(7),l=n(17),c=n.n(l),u=n(43),p=n.n(u),d=n(6),g=n(46),f=n(48),b=n(39),h=n.n(b);let m;!function(e){e.preboot="preboot",e.standard="standard"}(m||(m={}));const j="eui-global",x="eui-utilities",v=e=>e.darkMode?d.COLOR_MODES_STANDARD.dark:d.COLOR_MODES_STANDARD.light,y={darkMode:!1};var O=n(0);const k=[d.euiStylisPrefixer],M=h()({key:"css",stylisPlugins:k,container:document.querySelector('meta[name="emotion"]')}),w=h()({key:j,stylisPlugins:k,container:document.querySelector(`meta[name="${j}"]`)}),C=h()({key:x,stylisPlugins:k,container:document.querySelector(`meta[name="${x}"]`)});M.compat=!0,w.compat=!0,C.compat=!0;const I={default:M,global:w,utility:C},T=({theme:{theme$:e},globalStyles:t,colorMode:n,children:s})=>{const o=p()(e,y),a=Object(i.useMemo)((()=>v(o)),[o]),r=n||a,l=!1!==t&&void 0;return Object(O.jsx)(d.EuiProvider,{cache:I,colorMode:r,globalStyles:l,utilityClasses:l},s)},S=({theme:{theme$:e},euiTheme:t,children:n,...s})=>{const o=p()(e,y),a=Object(i.useMemo)((()=>v(o)),[o]);return Object(O.jsx)(d.EuiThemeProvider,c()({colorMode:a,theme:t},s),n)},E=({theme:e,children:t,...n})=>Object(g.useIsNestedEuiProvider)()?Object(O.jsx)(S,c()({theme:e},n),t):(Object(f.emitEuiProviderWarning)("KibanaThemeProvider requires a parent KibanaRenderContextProvider.  Check your React tree and ensure that they are wrapped in a KibanaRenderContextProvider."),Object(O.jsx)(T,{theme:e,globalStyles:!1},t));var P=n(24),_=n(16);n(49);const F=Object(i.createContext)(void 0),L=({children:e})=>{const{isLoading:t,data:n,resendRequest:i}=Object(P.c)();return Object(O.jsx)(F.Provider,{value:{isLoading:t,status:null==n?void 0:n.status,recheckStatus:i}},e)},A=()=>{const e=Object(i.useContext)(F);if(!e)throw new Error('"useIlmPolicyStatus" can only be used inside of "IlmPolicyStatusContext"');return e};var R=n(2),D=n(5),B=n(44),q=n.n(B);const z={title:R.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrationNeededTitle",{defaultMessage:"Apply new lifecycle policy for reports"}),description:Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.ilmPolicyCallout.migrationNeededDescription",defaultMessage:"To ensure your reports are managed consistently, all reporting indices should use the {ilmPolicyName} policy.",values:{ilmPolicyName:Object(O.jsx)(d.EuiCode,null,D.a)}}),buttonLabel:R.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrateIndicesButtonLabel",{defaultMessage:"Apply {ilmPolicyName} policy",values:{ilmPolicyName:D.a}}),migrateErrorTitle:R.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrateIndicesErrorTitle",{defaultMessage:"Could not migrate reporting indices"}),migrateSuccessTitle:R.i18n.translate("xpack.reporting.listing.ilmPolicyCallout.migrateIndicesSuccessTitle",{defaultMessage:"Reporting policy active for all reporting indices"})},N=({toasts:e,onMigrationDone:t})=>{const[n,s]=Object(i.useState)(!1),o=q()(),{apiClient:a}=Object(P.d)();return Object(O.jsx)(d.EuiCallOut,{"data-test-subj":"migrateReportingIndicesPolicyCallOut",title:z.title},Object(O.jsx)("p",null,z.description),Object(O.jsx)(d.EuiButton,{"data-test-subj":"migrateReportingIndicesButton",isLoading:n,onClick:async()=>{try{s(!0),await a.migrateReportingIndicesIlmPolicy(),t(),e.addSuccess({title:z.migrateSuccessTitle})}catch(t){var n;e.addError(t,{title:z.migrateErrorTitle,toastMessage:null===(n=t.body)||void 0===n?void 0:n.message})}finally{o()&&s(!1)}}},z.buttonLabel))},U=({toasts:e})=>{const{isLoading:t,recheckStatus:n,status:i}=A();return t||!i||"ok"===i?null:Object(O.jsx)(s.a.Fragment,null,Object(O.jsx)(d.EuiSpacer,{size:"m"}),Object(O.jsx)(d.EuiFlexItem,null,Object(O.jsx)(N,{toasts:e,onMigrationDone:n})))},J={buttonLabel:R.i18n.translate("xpack.reporting.listing.reports.ilmPolicyLinkText",{defaultMessage:"Edit reporting ILM policy"})},W=({locator:e,navigateToUrl:t})=>Object(O.jsx)(d.EuiButtonEmpty,{"data-test-subj":"ilmPolicyLink",size:"xs",onClick:()=>{const n=e.getRedirectUrl({page:"policy_edit",policyName:D.a});t(n)}},J.buttonLabel);class report_delete_button_ReportDeleteButton extends i.PureComponent{constructor(e){super(e),this.state={showConfirm:!1}}hideConfirm(){this.setState({showConfirm:!1})}showConfirm(){this.setState({showConfirm:!0})}renderConfirm(){const{jobsToDelete:e}=this.props,t=e.length>1?R.i18n.translate("xpack.reporting.listing.table.deleteNumConfirmTitle",{defaultMessage:"Delete {num} reports?",values:{num:e.length}}):R.i18n.translate("xpack.reporting.listing.table.deleteConfirmTitle",{defaultMessage:'Delete the "{name}" report?',values:{name:e[0].title}}),n=R.i18n.translate("xpack.reporting.listing.table.deleteConfirmMessage",{defaultMessage:"You can't recover deleted reports."}),i=R.i18n.translate("xpack.reporting.listing.table.deleteConfirmButton",{defaultMessage:"Delete"}),s=R.i18n.translate("xpack.reporting.listing.table.deleteCancelButton",{defaultMessage:"Cancel"});return Object(O.jsx)(d.EuiConfirmModal,{title:t,onCancel:()=>this.hideConfirm(),onConfirm:()=>this.props.performDelete(),confirmButtonText:i,cancelButtonText:s,defaultFocusedButton:"confirm",buttonColor:"danger"},n)}render(){const{jobsToDelete:e}=this.props;return 0===e.length?null:Object(O.jsx)(i.Fragment,null,Object(O.jsx)(d.EuiButton,{onClick:()=>this.showConfirm(),iconType:"trash",color:"danger","data-test-subj":"deleteReportButton"},R.i18n.translate("xpack.reporting.listing.table.deleteReportButton",{defaultMessage:"Delete {num, plural, one {report} other {reports} }",values:{num:e.length}})),this.state.showConfirm?this.renderConfirm():null)}}var K;!function(e){e.chromeStatus="chromeStatus",e.screenshotStatus="screenshotStatus"}(K||(K={}));const $={[K.chromeStatus]:"incomplete",isFlyoutVisible:!1,help:[],logs:"",isBusy:!1,success:!0},H=({apiClient:e,clientConfig:t})=>{const[n,s]=Object(i.useState)($),o=e=>s({...n,...e}),{isBusy:r,chromeStatus:l,isFlyoutVisible:c}=n,u=t.export_types.pdf.enabled||t.export_types.png.enabled,p=()=>o({...$,isFlyoutVisible:!1});let g;if(c){let t;n.success&&"complete"===l?t=Object(O.jsx)(d.EuiCallOut,{id:"xpack.reporting.listing.diagnosticSuccessMessage",color:"success",title:R.i18n.translate("xpack.reporting.listing.diagnosticSuccessMessage",{defaultMessage:"Everything looks good for reporting to function."})}):n.success||"complete"!==l||(t=Object(O.jsx)(d.EuiCallOut,{id:"xpack.reporting.listing.diagnosticFailureTitle",iconType:"warning",color:"danger",title:R.i18n.translate("xpack.reporting.listing.diagnosticFailureTitle",{defaultMessage:"Something isn't working properly."})})),g=Object(O.jsx)(d.EuiFlyout,{onClose:p,"aria-labelledby":"reportingHelperTitle",size:"m"},Object(O.jsx)(d.EuiFlyoutHeader,{hasBorder:!0},Object(O.jsx)(d.EuiTitle,{size:"m"},Object(O.jsx)("h2",null,Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.diagnosticTitle",defaultMessage:"Screenshotting Diagnostics"}))),Object(O.jsx)(d.EuiSpacer,{size:"s"}),Object(O.jsx)(d.EuiText,{color:"subdued"},Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.diagnosticDescription",defaultMessage:"Run diagnostics to automatically troubleshoot common reporting problems."}))),Object(O.jsx)(d.EuiFlyoutBody,{banner:t},Object(O.jsx)(d.EuiTitle,{size:"s"},Object(O.jsx)("h2",null,Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.diagnosticBrowserTitle",defaultMessage:"Check browser"}))),Object(O.jsx)(d.EuiSpacer,{size:"s"}),Object(O.jsx)(d.EuiText,{color:"subdued"},Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.diagnosticBrowserMessage",defaultMessage:"Reporting uses a headless browser to generate PDF and PNGs. Validate that the browser can launch successfully."})),Object(O.jsx)(d.EuiSpacer,null),Object(O.jsx)(d.EuiButton,{disabled:r||"complete"===l,onClick:(f=()=>e.verifyBrowser(),b=K.chromeStatus,()=>{o({isBusy:!0,[b]:"incomplete"}),f().then((e=>{o({isBusy:!1,help:e.help,logs:e.logs,success:e.success,[b]:e.success?"complete":"danger"})})).catch((e=>{o({isBusy:!1,help:[R.i18n.translate("xpack.reporting.listing.diagnosticApiCallFailure",{defaultMessage:"There was a problem running the diagnostic: {error}",values:{error:e}})],logs:`${e.message}`,success:!1,[b]:"danger"})}))}),isLoading:r&&"incomplete"===l,iconType:"complete"===l?"check":void 0},Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.diagnosticBrowserButton",defaultMessage:"Check browser"}))))}var f,b;return Object(O.jsx)("div",null,u&&Object(O.jsx)("div",null,g,Object(O.jsx)(d.EuiButtonEmpty,{"data-test-subj":"screenshotDiagnosticLink",size:"xs",flush:"left",onClick:()=>o({isFlyoutVisible:!0})},Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.diagnosticButton",defaultMessage:"Run screenshot diagnostics"}))))};var G=n(26);const V=e=>{switch(e){case"search":return"discoverApp";case"dashboard":return"dashboardApp";case"visualization":return"visualizeApp";case"canvas workpad":return"canvasApp";case"lens":return"lensApp";default:return"apps"}},Q={completed:R.i18n.translate("xpack.reporting.statusIndicator.completedLabel",{defaultMessage:"Done"}),completedWithWarnings:R.i18n.translate("xpack.reporting.statusIndicator.completedWithWarningsLabel",{defaultMessage:"Done, warnings detected"}),pending:R.i18n.translate("xpack.reporting.statusIndicator.pendingLabel",{defaultMessage:"Pending"}),processing:({attempt:e,of:t})=>void 0!==t?R.i18n.translate("xpack.reporting.statusIndicator.processingMaxAttemptsLabel",{defaultMessage:"Processing, attempt {attempt} of {of}",values:{attempt:e,of:t}}):R.i18n.translate("xpack.reporting.statusIndicator.processingLabel",{defaultMessage:"Processing, attempt {attempt}",values:{attempt:e}}),failed:R.i18n.translate("xpack.reporting.statusIndicator.failedLabel",{defaultMessage:"Failed"}),unknown:R.i18n.translate("xpack.reporting.statusIndicator.unknownLabel",{defaultMessage:"Unknown"}),lastStatusUpdate:({date:e})=>R.i18n.translate("xpack.reporting.statusIndicator.lastStatusUpdateLabel",{defaultMessage:"Updated at {date}",values:{date:e}})},Y=({job:e})=>{const t=Object(i.useMemo)((()=>(e=>Boolean(e.getWarnings())||[D.c.WARNINGS,D.c.FAILED].some((t=>e.status===t)))(e)),[e]);let n,s;switch(e.status){case G.c.COMPLETED:if(t){n=Object(O.jsx)(d.EuiIcon,{type:"warning",color:"warning"}),s=Q.completedWithWarnings;break}n=Object(O.jsx)(d.EuiIcon,{type:"checkInCircleFilled",color:"success"}),s=Q.completed;break;case G.c.WARNINGS:n=Object(O.jsx)(d.EuiIcon,{type:"warning",color:"warning"}),s=Q.completedWithWarnings;break;case G.c.PENDING:n=Object(O.jsx)(d.EuiLoadingSpinner,null),s=Q.pending;break;case G.c.PROCESSING:n=Object(O.jsx)(d.EuiLoadingSpinner,null),s=Q.processing({attempt:e.attempts,of:e.max_attempts});break;case G.c.FAILED:n=Object(O.jsx)(d.EuiIcon,{type:"error",color:"danger"}),s=Q.failed;break;default:n=Object(O.jsx)(d.EuiIcon,{type:"cross",color:"subdued"}),s=Q.unknown}return Object(O.jsx)(d.EuiToolTip,{content:Q.lastStatusUpdate({date:e.getPrettyStatusTimestamp()})},Object(O.jsx)(d.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1,"aria-label":s},Object(O.jsx)(d.EuiFlexItem,{grow:!1},n),Object(O.jsx)(d.EuiFlexItem,{grow:!1},s)))};var X=n(54),Z=n(9);const ee=e=>{const{csvConfig:t,job:n,searchSourceStart:s,locators:o}=e,{title:a}=n,r=n.payload.searchSource,l=Object(i.useCallback)((async()=>{const e=await s.create(r),n=e.getField("index");if(!n)throw new Error("The search must have a reference to an index pattern!");const i=n.getIndexPattern(),l=R.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.examplePitId",{defaultMessage:"[ID returned from first request]",description:"This gets used in place of an ID string that is sent in a request body."}),c=Object(Z.g)(e,t,l),u=Object(X.compressToEncodedURIComponent)(ne(a,i,c,t)),p=o.get("CONSOLE_APP_LOCATOR");null==p||p.navigate({loadFrom:`data:text/plain,${u}`})}),[s,r,a,t,o]);return Object(O.jsx)(d.EuiContextMenuItem,{"data-test-subj":"reportInfoFlyoutOpenInConsoleButton",key:"download",icon:"wrench",onClick:l},R.i18n.translate("xpack.reporting.reportInfoFlyout.openInConsole",{defaultMessage:"Inspect query in Console",description:"An option in a menu of actions."}))},te=e=>{const{config:t,job:n}=e,{services:i}=Object(r.useKibana)(),{application:s,data:o,share:a}=i,{capabilities:l}=s,{locators:c}=a.url;return"search"===n.objectType&&l.dev_tools.show?Object(O.jsx)(ee,{searchSourceStart:o.search.searchSource,locators:c,job:n,csvConfig:t.csv}):null},ne=(e,t,n,i)=>{const{requestBody:s}=n,o=JSON.stringify(s,null,"  "),a=`POST /${t}/_pit?keep_alive=${i.scroll.duration}&ignore_unavailable=true`,r=`DELETE /_pit\n${JSON.stringify({id:"[ID returned from latest request]"})}`;return(R.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.introText",{description:"Script used in the Console app",defaultMessage:'\n# Report title: {jobTitle}\n# These are the queries used when exporting data for\n# the CSV report.\n#\n# For reference about the Elasticsearch Point-In-Time\n# API, see\n# https://www.elastic.co/guide/en/elasticsearch/reference/current/point-in-time-api.html\n\n# The first query opens a Point-In-Time (PIT) context\n# and receive back the ID reference. The "keep_alive"\n# value is taken from the\n# "xpack.reporting.csv.scroll.duration" setting.\n#\n# The response will include an "id" value, which is\n# needed for the second query.\n{pitRequest}',values:{jobTitle:e,pitRequest:a}})+R.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.queryText",{description:"Script used in the Console app",defaultMessage:'\n# The second query executes a search using the PIT ID.\n# The "keep_alive" and "size" values come from the\n# "xpack.reporting.csv.scroll.duration" and\n# "xpack.reporting.csv.scroll.size" settings in\n# kibana.yml.\n#\n# The reponse will include new a PIT ID, which might\n# not be the same as the ID returned from the first\n# query.\n{queryRequest}\n{queryAsString}',values:{queryRequest:"POST /_search",queryAsString:o}})+R.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.pagingText",{description:"Script used in the Console app",defaultMessage:"# The first request retrieves the first page of search\n# results. If you want to retrieve more hits, use PIT\n# with search_after. Always use the PIT ID from the\n# latest search response. See\n# https://www.elastic.co/guide/en/elasticsearch/reference/current/paginate-search-results.html"})+R.i18n.translate("xpack.reporting.reportInfoFlyout.devToolsContent.closingText",{description:"Script used in the Console app",defaultMessage:"\n# Finally, release the resources held in Elasticsearch\n# memory by clearing the PIT.\n{closePitRequest}\n  ",values:{closePitRequest:r}})).trim()};var ie=n(14),se=n.n(ie),oe=n(18),ae=n(8),re=n(29);const le=R.i18n.translate("xpack.reporting.listing.infoPanel.notApplicableLabel",{defaultMessage:"N/A"}),ce=R.i18n.translate("xpack.reporting.listing.infoPanel.unknownLabel",{defaultMessage:"unknown"}),ue=({info:e})=>{var t,n,i,o,a,r,l,c,u,p,g,f,b,h,m,j,x,v,y,k,M,w,C,I;const{services:{uiSettings:T,docLinks:S}}=Object(_.a)(),E="Browser"===T.get("dateFormat:tz")?se.a.tz.guess():T.get("dateFormat:tz"),P=(F=T.get("dateFormat"),L=E,e=>{const t=se.a.tz(e,L);return t.isValid()?t.format(F):le});var F,L;const A=e=>R.i18n.translate("xpack.reporting.listing.infoPanel.msToSeconds",{defaultMessage:"{seconds} seconds",values:{seconds:(e/1e3).toFixed(3)}}),D=null!=e.started_at,B=null!=e.completed_at,q=null!==(t=null===(n=e.metrics)||void 0===n||null===(i=n.pdf)||void 0===i?void 0:i.cpuInPercentage)&&void 0!==t?t:null===(o=e.metrics)||void 0===o||null===(a=o.png)||void 0===a?void 0:a.cpuInPercentage,z=null!==(r=null===(l=e.metrics)||void 0===l||null===(c=l.pdf)||void 0===c?void 0:c.memoryInMegabytes)&&void 0!==r?r:null===(u=e.metrics)||void 0===u||null===(p=u.png)||void 0===p?void 0:p.memoryInMegabytes,N=null!=(null===(g=e.metrics)||void 0===g||null===(f=g.csv)||void 0===f?void 0:f.rows),U=ae.e.includes(e.jobtype),J=null!=(null===(b=e.metrics)||void 0===b||null===(h=b.pdf)||void 0===h?void 0:h.pages),W=[{title:R.i18n.translate("xpack.reporting.listing.infoPanel.statusInfo",{defaultMessage:"Status"}),description:e.prettyStatus},Boolean(e.version)&&{title:R.i18n.translate("xpack.reporting.listing.infoPanel.kibanaVersion",{defaultMessage:"Kibana version"}),description:e.version},Boolean(e.spaceId)&&{title:R.i18n.translate("xpack.reporting.listing.infoPanel.space",{defaultMessage:"Kibana space"}),description:e.spaceId},{title:R.i18n.translate("xpack.reporting.listing.infoPanel.attemptsInfo",{defaultMessage:"Attempts"}),description:e.max_attempts?R.i18n.translate("xpack.reporting.listing.infoPanel.attempts",{defaultMessage:"{attempts} of {maxAttempts}",values:{attempts:e.attempts,maxAttempts:e.max_attempts}}):e.attempts},{title:R.i18n.translate("xpack.reporting.listing.infoPanel.contentTypeInfo",{defaultMessage:"Content type"}),description:e.content_type||le},{title:R.i18n.translate("xpack.reporting.listing.infoPanel.sizeInfo",{defaultMessage:"Size in bytes"}),description:(null===(m=e.size)||void 0===m?void 0:m.toString())||le},N&&{title:R.i18n.translate("xpack.reporting.listing.infoPanel.csvRows",{defaultMessage:"CSV rows"}),description:(null===(j=e.metrics)||void 0===j||null===(x=j.csv)||void 0===x||null===(v=x.rows)||void 0===v?void 0:v.toString())||le},U&&{title:R.i18n.translate("xpack.reporting.listing.infoPanel.dimensionsInfoHeight",{defaultMessage:"Height in pixels"}),description:null!=(null===(y=e.layout)||void 0===y||null===(k=y.dimensions)||void 0===k?void 0:k.height)?Math.ceil(e.layout.dimensions.height):ce},U&&{title:R.i18n.translate("xpack.reporting.listing.infoPanel.dimensionsInfoWidth",{defaultMessage:"Width in pixels"}),description:null!=(null===(M=e.layout)||void 0===M||null===(w=M.dimensions)||void 0===w?void 0:w.width)?Math.ceil(e.layout.dimensions.width):ce},J&&{title:R.i18n.translate("xpack.reporting.listing.infoPanel.pdfPagesInfo",{defaultMessage:"Pages count"}),description:null===(C=e.metrics)||void 0===C||null===(I=C.pdf)||void 0===I?void 0:I.pages},{title:R.i18n.translate("xpack.reporting.listing.infoPanel.jobId",{defaultMessage:"Report job ID"}),description:e.id},{title:R.i18n.translate("xpack.reporting.listing.infoPanel.processedByInfo",{defaultMessage:"Processed by"}),description:e.kibana_name&&e.kibana_id?`${e.kibana_name} (${e.kibana_id})`:le},{title:R.i18n.translate("xpack.reporting.listing.infoPanel.timeoutInfo",{defaultMessage:"Timeout"}),description:e.prettyTimeout},null!=q&&{title:R.i18n.translate("xpack.reporting.listing.infoPanel.cpuInfo",{defaultMessage:"CPU usage"}),description:`${q}%`},null!=z&&{title:R.i18n.translate("xpack.reporting.listing.infoPanel.memoryInfo",{defaultMessage:"RAM usage"}),description:`${z}MB`}].filter(Boolean),K=[{title:R.i18n.translate("xpack.reporting.listing.infoPanel.tzInfo",{defaultMessage:"Time zone"}),description:e.browserTimezone||le},{title:R.i18n.translate("xpack.reporting.listing.infoPanel.createdAtInfo",{defaultMessage:"Created at"}),description:e.created_at?P(e.created_at):le},{title:R.i18n.translate("xpack.reporting.listing.infoPanel.startedAtInfo",{defaultMessage:"Started at"}),description:e.started_at?P(e.started_at):le},{title:R.i18n.translate("xpack.reporting.listing.infoPanel.completedAtInfo",{defaultMessage:"Completed at"}),description:e.completed_at?P(e.completed_at):le},D&&{title:R.i18n.translate("xpack.reporting.listing.infoPanel.queueTime",{defaultMessage:"Queue time"}),description:e.queue_time_ms?A(e.queue_time_ms):le},B&&{title:R.i18n.translate("xpack.reporting.listing.infoPanel.executionTime",{defaultMessage:"Execution time"}),description:e.execution_time_ms?A(e.execution_time_ms):le}].filter(Boolean),$=e.getWarnings(),H=e.error_code===oe.a.code?re.a.cloud.insufficientMemoryError(S.links.reporting.cloudMinimumRequirements):e.getError();return Object(O.jsx)(s.a.Fragment,null,Boolean(H)&&Object(O.jsx)(s.a.Fragment,null,Object(O.jsx)(d.EuiCallOut,{title:R.i18n.translate("xpack.reporting.listing.infoPanel.callout.failedReportTitle",{defaultMessage:"No report generated"}),color:"danger"},H),Object(O.jsx)(d.EuiSpacer,null)),Boolean($)&&Object(O.jsx)(s.a.Fragment,null,Boolean(H)&&Object(O.jsx)(d.EuiSpacer,{size:"s"}),Object(O.jsx)(d.EuiCallOut,{title:R.i18n.translate("xpack.reporting.listing.infoPanel.callout.warningsTitle",{defaultMessage:"Report contains warnings"}),color:"warning"},$)),Object(O.jsx)(d.EuiTitle,{size:"s"},Object(O.jsx)("h3",null,R.i18n.translate("xpack.reporting.listing.infoPanel.outputSectionTitle",{defaultMessage:"Output"}))),Object(O.jsx)(d.EuiSpacer,{size:"s"}),Object(O.jsx)(d.EuiDescriptionList,{listItems:W,type:"column",align:"center",compressed:!0}),Object(O.jsx)(d.EuiSpacer,null),Object(O.jsx)(d.EuiTitle,{size:"s"},Object(O.jsx)("h3",null,R.i18n.translate("xpack.reporting.listing.infoPanel.timestampSectionTitle",{defaultMessage:"Timestamps"}))),Object(O.jsx)(d.EuiSpacer,{size:"s"}),Object(O.jsx)(d.EuiDescriptionList,{listItems:K,type:"column",align:"center",compressed:!0}))},pe=({config:e,onClose:t,job:n})=>{var s;const o=q()(),{apiClient:a}=Object(P.d)(),[r,l]=Object(i.useState)(!0),[c,u]=Object(i.useState)(),[p,g]=Object(i.useState)(!1),[f,b]=Object(i.useState)();Object(i.useEffect)((()=>{!async function(){if(r)try{const e=await a.getInfo(n.id);o()&&b(e)}catch(e){o()&&u(e)}finally{o()&&l(!1)}}()}),[r,a,n.id,o]);const h=Object(O.jsx)(d.EuiButton,{"data-test-subj":"reportInfoFlyoutActionsButton",iconType:"arrowUp",onClick:()=>g((e=>!e))},R.i18n.translate("xpack.reporting.reportInfoFlyout.actionsButtonLabel",{defaultMessage:"Actions"})),m=[Object(O.jsx)(d.EuiContextMenuItem,{"data-test-subj":"reportInfoFlyoutDownloadButton",key:"download",icon:"download",disabled:!n.isDownloadReady,onClick:()=>{a.downloadReport(n.id)}},R.i18n.translate("xpack.reporting.reportInfoFlyout.downloadButtonLabel",{defaultMessage:"Download"})),Object(O.jsx)(te,{job:n,config:e}),Object(O.jsx)(d.EuiContextMenuItem,{"data-test-subj":"reportInfoFlyoutOpenInKibanaButton",disabled:!n.canLinkToKibanaApp,key:"openInKibanaApp",icon:"popout",onClick:()=>{window.open(a.getKibanaAppHref(n),"_blank"),window.focus()}},R.i18n.translate("xpack.reporting.reportInfoFlyout.openInKibanaAppButtonLabel",{defaultMessage:"Open in Kibana"}))].filter(Boolean);return Object(O.jsx)(d.EuiPortal,null,Object(O.jsx)(d.EuiFlyout,{ownFocus:!0,onClose:t,size:"s","aria-labelledby":"flyoutTitle","data-test-subj":"reportInfoFlyout"},Object(O.jsx)(d.EuiFlyoutHeader,{hasBorder:!0},Object(O.jsx)(d.EuiTitle,{size:"m"},Object(O.jsx)("h2",{id:"flyoutTitle"},c?R.i18n.translate("xpack.reporting.listing.table.reportInfoUnableToFetch",{defaultMessage:"Unable to fetch report info."}):null!==(s=null==f?void 0:f.title)&&void 0!==s?s:R.i18n.translate("xpack.reporting.listing.table.untitledReport",{defaultMessage:"Untitled report"})))),Object(O.jsx)(d.EuiFlyoutBody,null,r?Object(O.jsx)(d.EuiLoadingSpinner,null):c?void 0:f?Object(O.jsx)(ue,{info:f}):void 0),!r&&Object(O.jsx)(d.EuiFlyoutFooter,null,Object(O.jsx)(d.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},Object(O.jsx)(d.EuiFlexItem,{grow:!1},Object(O.jsx)(d.EuiButtonEmpty,{iconType:"cross",flush:"left",onClick:t},R.i18n.translate("xpack.reporting.listing.flyout.closeButtonLabel",{defaultMessage:"Close"}))),Object(O.jsx)(d.EuiFlexItem,{grow:!1},Object(O.jsx)(d.EuiPopover,{id:"reportInfoFlyoutActionsPopover",button:h,isOpen:p,closePopover:()=>g(!1),panelPaddingSize:"none"},Object(O.jsx)(d.EuiContextMenuPanel,{items:m})))))))};var de=n(1),ge=n.n(de),fe=n(30),be=n(27),he=n.n(be);class poller_Poller{constructor(e){ge()(this,"functionToPoll",void 0),ge()(this,"successFunction",void 0),ge()(this,"errorFunction",void 0),ge()(this,"_isRunning",void 0),ge()(this,"_timeoutId",void 0),ge()(this,"pollFrequencyInMillis",void 0),ge()(this,"trailing",void 0),ge()(this,"continuePollingOnError",void 0),ge()(this,"pollFrequencyErrorMultiplier",void 0),this.functionToPoll=e.functionToPoll,this.successFunction=e.successFunction||he.a.noop,this.errorFunction=e.errorFunction||he.a.noop,this.pollFrequencyInMillis=e.pollFrequencyInMillis,this.trailing=e.trailing||!1,this.continuePollingOnError=e.continuePollingOnError||!1,this.pollFrequencyErrorMultiplier=e.pollFrequencyErrorMultiplier||1,this._timeoutId=null,this._isRunning=!1}getPollFrequency(){return this.pollFrequencyInMillis}_poll(){return this.functionToPoll().then(this.successFunction).then((()=>{this._isRunning&&(this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis))})).catch((e=>{this.errorFunction(e),this._isRunning&&(this.continuePollingOnError?this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis*this.pollFrequencyErrorMultiplier):this.stop())}))}start(){this._isRunning||(this._isRunning=!0,this.trailing?this._timeoutId=setTimeout(this._poll.bind(this),this.pollFrequencyInMillis):this._poll())}stop(){this._isRunning&&(this._isRunning=!1,this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=null)}isRunning(){return this._isRunning}}var me=n(15);class report_listing_table_ReportListingTable extends i.Component{constructor(e){super(e),ge()(this,"isInitialJobsFetch",void 0),ge()(this,"licenseSubscription",void 0),ge()(this,"mounted",void 0),ge()(this,"poller",void 0),ge()(this,"licenseHandler",(e=>{const{enableLinks:t,showLinks:n,message:i}=Object(me.a)(e.check("reporting","basic"));this.setState({enableLinks:t,showLinks:n,badLicenseMessage:i})})),ge()(this,"onSelectionChange",(e=>{this.setState((t=>({...t,selectedJobs:e})))})),ge()(this,"removeJob",(e=>{const{jobs:t}=this.state,n=t.filter((t=>t.id!==e.id));this.setState((e=>({...e,jobs:n})))})),ge()(this,"renderDeleteButton",(()=>{const{selectedJobs:e}=this.state;if(0!==e.length)return Object(O.jsx)(report_delete_button_ReportDeleteButton,c()({jobsToDelete:e,performDelete:async()=>{for(const t of e)try{await this.props.apiClient.deleteReport(t.id),this.removeJob(t),this.props.toasts.addSuccess(R.i18n.translate("xpack.reporting.listing.table.deleteConfim",{defaultMessage:"The {reportTitle} report was deleted",values:{reportTitle:t.title}}))}catch(e){throw this.props.toasts.addDanger(R.i18n.translate("xpack.reporting.listing.table.deleteFailedErrorMessage",{defaultMessage:"The report was not deleted: {error}",values:{error:e}})),e}}},this.props))})),ge()(this,"onTableChange",(({page:e})=>{const{index:t}=e;this.setState((()=>({page:t})),this.fetchJobs)})),ge()(this,"fetchJobs",(async()=>{let e,t;this.isInitialJobsFetch&&this.setState((()=>({isLoading:!0})));try{e=await this.props.apiClient.list(this.state.page),t=await this.props.apiClient.total(),this.isInitialJobsFetch=!1}catch(e){return this.licenseAllowsToShowThisPage()?("Failed to fetch"===e.message&&this.props.toasts.addDanger(e.message||R.i18n.translate("xpack.reporting.listing.table.requestFailedErrorMessage",{defaultMessage:"Request failed"})),void(this.mounted&&this.setState((()=>({isLoading:!1,jobs:[],total:0}))))):(this.props.toasts.addDanger(this.state.badLicenseMessage),void this.props.redirect("management"))}this.mounted&&this.setState((()=>({isLoading:!1,total:t,jobs:e})))})),ge()(this,"licenseAllowsToShowThisPage",(()=>this.state.showLinks&&this.state.enableLinks)),ge()(this,"tableColumnWidths",{type:"5%",title:"30%",status:"20%",createdAt:"25%",content:"10%",actions:"10%"}),this.state={page:0,total:0,jobs:[],selectedJobs:[],isLoading:!1,showLinks:!1,enableLinks:!1,badLicenseMessage:"",selectedJob:void 0},this.isInitialJobsFetch=!0}componentWillUnmount(){var e;this.mounted=!1,null===(e=this.poller)||void 0===e||e.stop(),this.licenseSubscription&&this.licenseSubscription.unsubscribe()}componentDidMount(){this.mounted=!0;const{config:e,license$:t}=this.props,n=Object(D.g)(e.poll.jobsRefresh.interval);this.poller=new poller_Poller({functionToPoll:()=>this.fetchJobs(),pollFrequencyInMillis:n,trailing:!1,continuePollingOnError:!0,pollFrequencyErrorMultiplier:e.poll.jobsRefresh.intervalErrorMultiplier}),this.poller.start(),this.licenseSubscription=t.subscribe(this.licenseHandler)}render(){const{tableColumnWidths:e}=this,t=[{field:"type",width:e.type,name:R.i18n.translate("xpack.reporting.listing.tableColumns.typeTitle",{defaultMessage:"Type"}),render:(e,t)=>Object(O.jsx)("div",{className:"kbnReporting__reportListing__typeIcon"},Object(O.jsx)(d.EuiIconTip,{type:V(t.objectType),size:"s","data-test-subj":"reportJobType",content:t.objectType})),mobileOptions:{show:!0,render:e=>Object(O.jsx)("div",{"data-test-subj":"reportJobType"},e.objectType)}},{field:"title",name:R.i18n.translate("xpack.reporting.listing.tableColumns.reportTitle",{defaultMessage:"Title"}),width:e.title,render:(e,t)=>Object(O.jsx)("div",{"data-test-subj":"reportingListItemObjectTitle"},Object(O.jsx)(d.EuiLink,{"data-test-subj":`viewReportingLink-${t.id}`,onClick:()=>this.setState({selectedJob:t})},e||R.i18n.translate("xpack.reporting.listing.table.noTitleLabel",{defaultMessage:"Untitled"}))),mobileOptions:{header:!1,width:"100%"}},{field:"status",width:e.status,name:R.i18n.translate("xpack.reporting.listing.tableColumns.statusTitle",{defaultMessage:"Status"}),render:(e,t)=>Object(O.jsx)(d.EuiFlexGroup,{gutterSize:"none",responsive:!1,alignItems:"center","data-test-subj":"reportJobStatus"},Object(O.jsx)(Y,{job:t})),mobileOptions:{show:!1}},{field:"created_at",width:e.createdAt,name:R.i18n.translate("xpack.reporting.listing.tableColumns.createdAtTitle",{defaultMessage:"Created at"}),render:(e,t)=>Object(O.jsx)("div",{"data-test-subj":"reportJobCreatedAt"},t.getCreatedAtDate()),mobileOptions:{show:!1}},{field:"content",width:e.content,name:R.i18n.translate("xpack.reporting.listing.tableColumns.content",{defaultMessage:"Content"}),render:(e,t)=>Object(fe.b)(t.jobtype),mobileOptions:{show:!1}},{name:R.i18n.translate("xpack.reporting.listing.tableColumns.actionsTitle",{defaultMessage:"Actions"}),width:e.actions,actions:[{isPrimary:!0,"data-test-subj":"reportDownloadLink",type:"icon",icon:"download",name:R.i18n.translate("xpack.reporting.listing.table.downloadReportButtonLabel",{defaultMessage:"Download report"}),description:R.i18n.translate("xpack.reporting.listing.table.downloadReportDescription",{defaultMessage:"Download this report in a new tab."}),onClick:e=>this.props.apiClient.downloadReport(e.id),enabled:e=>e.isDownloadReady},{name:R.i18n.translate("xpack.reporting.listing.table.viewReportingInfoActionButtonLabel",{defaultMessage:"View report info"}),description:R.i18n.translate("xpack.reporting.listing.table.viewReportingInfoActionButtonDescription",{defaultMessage:"View additional information about this report."}),type:"icon",icon:"iInCircle",onClick:e=>this.setState({selectedJob:e})},{name:R.i18n.translate("xpack.reporting.listing.table.openInKibanaAppLabel",{defaultMessage:"Open in Kibana"}),"data-test-subj":"reportOpenInKibanaApp",description:R.i18n.translate("xpack.reporting.listing.table.openInKibanaAppDescription",{defaultMessage:"Open the Kibana app where this report was generated."}),available:e=>e.canLinkToKibanaApp,type:"icon",icon:"popout",onClick:e=>{const t=this.props.apiClient.getKibanaAppHref(e);window.open(t,"_blank"),window.focus()}}]}],n={pageIndex:this.state.page,pageSize:10,totalItemCount:this.state.total,showPerPageOptions:!1},s={itemId:"id",onSelectionChange:this.onSelectionChange};return Object(O.jsx)(i.Fragment,null,this.state.selectedJobs.length>0&&Object(O.jsx)("div",null,Object(O.jsx)(d.EuiFlexGroup,{alignItems:"center",justifyContent:"flexStart",gutterSize:"m"},Object(O.jsx)(d.EuiFlexItem,{grow:!1},this.renderDeleteButton())),Object(O.jsx)(d.EuiSpacer,{size:"l"})),Object(O.jsx)(d.EuiBasicTable,{tableCaption:R.i18n.translate("xpack.reporting.listing.table.captionDescription",{defaultMessage:"Reports generated in Kibana applications"}),itemId:"id",items:this.state.jobs,loading:this.state.isLoading,columns:t,noItemsMessage:this.state.isLoading?R.i18n.translate("xpack.reporting.listing.table.loadingReportsDescription",{defaultMessage:"Loading reports"}):R.i18n.translate("xpack.reporting.listing.table.noCreatedReportsDescription",{defaultMessage:"No reports have been created"}),pagination:n,selection:s,isSelectable:!0,onChange:this.onTableChange,"data-test-subj":ae.c,rowProps:()=>({"data-test-subj":ae.d})}),!!this.state.selectedJob&&Object(O.jsx)(pe,{config:this.props.config,onClose:()=>this.setState({selectedJob:void 0}),job:this.state.selectedJob}))}}const je=e=>{var t,n;const{apiClient:i,capabilities:o,config:r,navigateToUrl:l,toasts:u,urlService:p,...g}=e,f=p.locators.get("ILM_LOCATOR_ID"),b=A(),h="policy-not-found"!==(null==b?void 0:b.status),m=Boolean(f&&h);return Object(O.jsx)(s.a.Fragment,null,Object(O.jsx)(d.EuiPageHeader,{"data-test-subj":"reportingPageHeader",bottomBorder:!0,pageTitle:Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.reports.titleStateful",defaultMessage:"Reports"}),description:Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.reports.subtitleStateful",defaultMessage:"Get reports generated in Kibana applications."})}),Object(O.jsx)(U,{toasts:u}),Object(O.jsx)(d.EuiSpacer,{size:"l"}),Object(O.jsx)(report_listing_table_ReportListingTable,c()({},g,{apiClient:i,capabilities:o,config:r,toasts:u,navigateToUrl:l,urlService:p})),Object(O.jsx)(d.EuiSpacer,{size:"s"}),Object(O.jsx)(d.EuiFlexGroup,{justifyContent:"flexEnd"},(null==o||null===(t=o.management)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.index_lifecycle_management)&&Object(O.jsx)(d.EuiFlexItem,{grow:!1},null!=b&&b.isLoading?Object(O.jsx)(d.EuiLoadingSpinner,null):m&&Object(O.jsx)(W,{navigateToUrl:l,locator:f})),Object(O.jsx)(d.EuiFlexItem,{grow:!1},Object(O.jsx)(H,{clientConfig:r,apiClient:i}))))},xe=e=>{const{apiClient:t,capabilities:n,config:i,navigateToUrl:o,toasts:r,urlService:l,...u}=e;return Object(O.jsx)(s.a.Fragment,null,Object(O.jsx)(d.EuiPageHeader,{"data-test-subj":"reportingPageHeader",bottomBorder:!0,pageTitle:Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.reportstitle",defaultMessage:"Reports"}),description:Object(O.jsx)(a.FormattedMessage,{id:"xpack.reporting.listing.reports.subtitle",defaultMessage:"Get reports generated in Kibana applications."})}),Object(O.jsx)(d.EuiSpacer,{size:"l"}),Object(O.jsx)(report_listing_table_ReportListingTable,c()({},u,{apiClient:t,capabilities:n,config:i,toasts:r,navigateToUrl:o,urlService:l})))},ve=e=>{const{apiClient:t}=Object(P.d)(),{services:{application:{capabilities:n}}}=Object(_.a)();return e.config.statefulSettings.enabled?Object(O.jsx)(je,c()({},e,{apiClient:t,capabilities:n})):Object(O.jsx)(xe,c()({},e,{apiClient:t,capabilities:n}))},ye=Object(i.createContext)(void 0),Oe=({children:e,...t})=>t.config.statefulSettings.enabled?Object(O.jsx)(L,null,e):Object(O.jsx)(ye.Provider,{value:void 0},e);async function ke(e,t,n,i,s,l,c){const u={http:e.http,application:e.application,uiSettings:e.uiSettings,docLinks:e.docLinks,data:n,share:i};return Object(o.render)(Object(O.jsx)(E,{theme:{theme$:c.theme$}},Object(O.jsx)(a.I18nProvider,null,Object(O.jsx)(r.KibanaContextProvider,{services:u},Object(O.jsx)(P.a,{apiClient:l},Object(O.jsx)(Oe,{config:s},Object(O.jsx)(ve,{apiClient:l,toasts:e.notifications.toasts,license$:t,config:s,redirect:e.application.navigateToApp,navigateToUrl:e.application.navigateToUrl,urlService:i.url})))))),c.element),()=>{Object(o.unmountComponentAtNode)(c.element)}}}}]);