/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */!function(e){function t(t){for(var r,i,o=t[0],a=t[1],s=0,u=[];s<o.length;s++)i=o[s],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&u.push(n[i][0]),n[i]=0;for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r]);for(c&&c(t);u.length;)u.shift()()}var r={},n={1:0};function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],r=n[e];if(0!==r)if(r)t.push(r[2]);else{var o=new Promise((function(t,i){r=n[e]=[t,i]}));t.push(r[2]=o);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,i.nc&&s.setAttribute("nonce",i.nc),s.src=function(e){return i.p+"reporting.chunk."+e+".js"}(e);var c=new Error;a=function(t){s.onerror=s.onload=null,clearTimeout(u);var r=n[e];if(0!==r){if(r){var i=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",c.name="ChunkLoadError",c.type=i,c.request=o,r[1](c)}n[e]=void 0}};var u=setTimeout((function(){a({type:"timeout",target:s})}),12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},i.m=e,i.c=r,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i.oe=function(e){throw console.error(e),e};var o=window.reporting_bundle_jsonpfunction=window.reporting_bundle_jsonpfunction||[],a=o.push.bind(o);o.push=t,o=o.slice();for(var s=0;s<o.length;s++)t(o[s]);var c=a;i(i.s=32)}([function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t,r){e.exports=r(25)(2)},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact},function(e,t,r){"use strict";r.d(t,"e",(function(){return n.e})),r.d(t,"b",(function(){return n.b})),r.d(t,"h",(function(){return n.f})),r.d(t,"a",(function(){return n.a})),r.d(t,"d",(function(){return n.d})),r.d(t,"c",(function(){return n.c})),r.d(t,"g",(function(){return i})),r.d(t,"f",(function(){return o}));var n=r(26);r(18),r(14);const i=e=>"number"==typeof e?e:e.asMilliseconds();r(1),r(27);const o=({basePath:e,appPath:t,spaceId:r})=>void 0===r||"default"===r.toLowerCase()?`${e}${t}`:`${e}/s/${r}${t}`},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t,r){r.r(t);var n=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a})),r.d(t,"e",(function(){return l})),r.d(t,"c",(function(){return p})),r.d(t,"d",(function(){return d}));const n="/internal/reporting",i={MIGRATE:{MIGRATE_ILM_POLICY:n+"/deprecations/migrate_ilm_policy",GET_ILM_POLICY_STATUS:n+"/ilm_policy_status"},DIAGNOSE:{BROWSER:n+"/diagnose/browser",SCREENSHOT:n+"/diagnose/screenshot"},JOBS:{COUNT:n+"/jobs/count",LIST:n+"/jobs/list",INFO_PREFIX:n+"/jobs/info",DELETE_PREFIX:n+"/jobs/delete",DOWNLOAD_PREFIX:n+"/jobs/download"},DOWNLOAD_CSV:n+"/generate/immediate/csv_searchsource",GENERATE_PREFIX:n+"/generate"},o="/api/reporting",a={GENERATE_PREFIX:o+"/generate",JOBS:{DOWNLOAD_PREFIX:o+"/jobs/download",DELETE_PREFIX:o+"/jobs/delete"}};var s=r(9),c=r(10),u=r(12);s.e,s.f,c.c,c.d,u.c,u.d,s.a,s.c,c.a,c.b,u.a,u.b;const l=[c.a,u.a,c.b,u.b],p=(s.b,"reportJobListing"),d="reportJobRow"},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"e",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"f",(function(){return a})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return l})),r.d(t,"g",(function(){return c}));const n="csv_searchsource",i="csv_searchsource",o="csv_v2",a="csv_v2";var s=r(5);const c=(e,{scroll:t},r)=>(e.setField("size",Object(s.g)(t.size)),e.setField("timeout",t.duration),e.setField("trackTotalHits",!0),r&&e.setField("pit",{id:r,keep_alive:t.duration}),{requestBody:e.getSearchRequestBody()}),u="downloadCsvReport",l="csv"},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return a}));const n="printable_pdf",i="printable_pdf_v2",o="printablePdf",a="printablePdfV2"},function(e,t){e.exports=__kbnSharedDeps__.Rxjs},function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return a}));const n="PNG",i="pngV2",o="PNG",a="PNGV2"},function(e,t){e.exports=__kbnSharedDeps__.RxjsOperators},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n=e=>{switch(e.state){case"valid":default:return{showLinks:!0,enableLinks:!0,message:""};case"invalid":return{showLinks:!1,enableLinks:!1,message:"Your license does not support Reporting. Please upgrade your license."};case"unavailable":return{showLinks:!0,enableLinks:!1,message:"You cannot use Reporting because license information is not available at this time."};case"expired":return{showLinks:!0,enableLinks:!1,message:"You cannot use Reporting because your license has expired."}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r(19);var n=r(28);r.d(t,"b",(function(){return n.useRequest}));var i=r(7);const o=()=>Object(i.useKibana)()},function(e,t,r){e.exports=r(25)(3)},function(e,t,r){"use strict";r.d(t,"a",(function(){return VisualReportingSoftDisabledError}));var n=r(1),i=r.n(n),o=r(2);class ReportingError extends Error{constructor(e){super(),this.details=e}get message(){const e="ReportingError";return this.details?`${e}(code: ${this.code}) "${this.details}"`:`${e}(code: ${this.code})`}toString(){return this.message}}class InvalidLayoutParametersError extends ReportingError{get code(){return InvalidLayoutParametersError.code}}i()(InvalidLayoutParametersError,"code","invalid_layout_parameters_error");class DisallowedOutgoingUrl extends ReportingError{get code(){return DisallowedOutgoingUrl.code}}i()(DisallowedOutgoingUrl,"code","disallowed_outgoing_url_error");class AuthenticationExpiredError extends ReportingError{get code(){return AuthenticationExpiredError.code}}i()(AuthenticationExpiredError,"code","authentication_expired_error");class QueueTimeoutError extends ReportingError{get code(){return QueueTimeoutError.code}}i()(QueueTimeoutError,"code","queue_timeout_error");class UnknownError extends ReportingError{get code(){return UnknownError.code}}i()(UnknownError,"code","unknown_error");class PdfWorkerOutOfMemoryError extends ReportingError{get code(){return PdfWorkerOutOfMemoryError.code}humanFriendlyMessage(){return o.i18n.translate("reporting.common.pdfWorkerOutOfMemoryErrorMessage",{defaultMessage:"Can't generate a PDF due to insufficient memory. Try making a smaller PDF and retrying this report."})}}i()(PdfWorkerOutOfMemoryError,"code","pdf_worker_out_of_memory_error");class BrowserCouldNotLaunchError extends ReportingError{get code(){return BrowserCouldNotLaunchError.code}humanFriendlyMessage(){return o.i18n.translate("reporting.common.browserCouldNotLaunchErrorMessage",{defaultMessage:"Can't generate screenshots because the browser did not launch. See the server logs for more information."})}}i()(BrowserCouldNotLaunchError,"code","browser_could_not_launch_error");class BrowserUnexpectedlyClosedError extends ReportingError{get code(){return BrowserUnexpectedlyClosedError.code}}i()(BrowserUnexpectedlyClosedError,"code","browser_unexpectedly_closed_error");class BrowserScreenshotError extends ReportingError{get code(){return BrowserScreenshotError.code}}i()(BrowserScreenshotError,"code","browser_screenshot_error");class KibanaShuttingDownError extends ReportingError{get code(){return KibanaShuttingDownError.code}}i()(KibanaShuttingDownError,"code","kibana_shutting_down_error");class VisualReportingSoftDisabledError extends ReportingError{get code(){return VisualReportingSoftDisabledError.code}humanFriendlyMessage(){return o.i18n.translate("reporting.common.cloud.insufficientSystemMemoryError",{defaultMessage:"Can't generate this report due to insufficient memory."})}}i()(VisualReportingSoftDisabledError,"code","visual_reporting_soft_disabled_error")},function(e,t,r){r.r(t);var n=__kbnBundles__.get("entry/core/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,r){r.r(t);var n=__kbnBundles__.get("plugin/embeddable/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,r){"use strict";const n=r(34),i=r(35),o=r(36);function a(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function s(e,t){return t.encode?t.strict?n(e):encodeURIComponent(e):e}function c(e,t){return t.decode?i(e):e}function u(e){return Array.isArray(e)?e.sort():"object"==typeof e?u(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function l(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function p(e){const t=(e=l(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function d(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function g(e,t){a((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,n)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===n[e]&&(n[e]={}),n[e][t[1]]=r):n[e]=r};case"bracket":return(e,r,n)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==n[e]?n[e]=[].concat(n[e],r):n[e]=[r]:n[e]=r};case"comma":case"separator":return(t,r,n)=>{const i="string"==typeof r&&r.split("").indexOf(e.arrayFormatSeparator)>-1?r.split(e.arrayFormatSeparator).map((t=>c(t,e))):null===r?r:c(r,e);n[t]=i};default:return(e,t,r)=>{void 0!==r[e]?r[e]=[].concat(r[e],t):r[e]=t}}}(t),n=Object.create(null);if("string"!=typeof e)return n;if(!(e=e.trim().replace(/^[?#&]/,"")))return n;for(const i of e.split("&")){let[e,a]=o(t.decode?i.replace(/\+/g," "):i,"=");a=void 0===a?null:["comma","separator"].includes(t.arrayFormat)?a:c(a,t),r(c(e,t),a,n)}for(const e of Object.keys(n)){const r=n[e];if("object"==typeof r&&null!==r)for(const e of Object.keys(r))r[e]=d(r[e],t);else n[e]=d(r,t)}return!1===t.sort?n:(!0===t.sort?Object.keys(n).sort():Object.keys(n).sort(t.sort)).reduce(((e,t)=>{const r=n[t];return Boolean(r)&&"object"==typeof r&&!Array.isArray(r)?e[t]=u(r):e[t]=r,e}),Object.create(null))}t.extract=p,t.parse=g,t.stringify=(e,t)=>{if(!e)return"";a((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],n=function(e){switch(e.arrayFormat){case"index":return t=>(r,n)=>{const i=r.length;return void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[s(t,e),"[",i,"]"].join("")]:[...r,[s(t,e),"[",s(i,e),"]=",s(n,e)].join("")]};case"bracket":return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,[s(t,e),"[]"].join("")]:[...r,[s(t,e),"[]=",s(n,e)].join("")];case"comma":case"separator":return t=>(r,n)=>null==n||0===n.length?r:0===r.length?[[s(t,e),"=",s(n,e)].join("")]:[[r,s(n,e)].join(e.arrayFormatSeparator)];default:return t=>(r,n)=>void 0===n||e.skipNull&&null===n||e.skipEmptyString&&""===n?r:null===n?[...r,s(t,e)]:[...r,[s(t,e),"=",s(n,e)].join("")]}}(t),i={};for(const t of Object.keys(e))r(t)||(i[t]=e[t]);const o=Object.keys(i);return!1!==t.sort&&o.sort(t.sort),o.map((r=>{const i=e[r];return void 0===i?"":null===i?s(r,t):Array.isArray(i)?i.reduce(n(r),[]).join("&"):s(r,t)+"="+s(i,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[r,n]=o(e,"#");return Object.assign({url:r.split("?")[0]||"",query:g(p(e),t)},t&&t.parseFragmentIdentifier&&n?{fragmentIdentifier:c(n,t)}:{})},t.stringifyUrl=(e,r)=>{r=Object.assign({encode:!0,strict:!0},r);const n=l(e.url).split("?")[0]||"",i=t.extract(e.url),o=t.parse(i,{sort:!1}),a=Object.assign(o,e.query);let c=t.stringify(a,r);c&&(c=`?${c}`);let u=function(e){let t="";const r=e.indexOf("#");return-1!==r&&(t=e.slice(r)),t}(e.url);return e.fragmentIdentifier&&(u=`#${s(e.fragmentIdentifier,r)}`),`${n}${c}${u}`}},function(e,t){e.exports=__kbnSharedDeps__.KbnRison},function(e,t,r){r.r(t);var n=__kbnBundles__.get("plugin/discover/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return p})),r.d(t,"b",(function(){return reporting_api_client_ReportingAPIClient}));var n=r(3),i=r.n(n),o=r(16),a=r(0);const s=Object(n.createContext)(void 0),c=({apiClient:e,children:t})=>{const{services:{http:r}}=Object(o.a)();return Object(a.jsx)(s.Provider,{value:{http:r,apiClient:e}},t)},u=()=>{const e=Object(n.useContext)(s);if(!e)throw new Error('"useInternalApiClient" can only be used inside of "InternalApiClientContext"');return e};var l=r(8);const p=()=>{const{services:{http:e}}=Object(o.a)();return Object(o.b)(e,{path:l.a.MIGRATE.GET_ILM_POLICY_STATUS,method:"get"})};var d=r(1),g=r.n(d),h=r(2),b=r(5),f=r(22),m=r.n(f),j=r(14),_=r.n(j),y=r(21);var v=r(6);const{COMPLETED:x,FAILED:O,PENDING:S,PROCESSING:w,WARNINGS:k}=b.c;class job_Job{constructor(e){var t,r,n,i,o,a;g()(this,"payload",void 0),g()(this,"id",void 0),g()(this,"index",void 0),g()(this,"objectType",void 0),g()(this,"title",void 0),g()(this,"isDeprecated",void 0),g()(this,"spaceId",void 0),g()(this,"browserTimezone",void 0),g()(this,"layout",void 0),g()(this,"version",void 0),g()(this,"jobtype",void 0),g()(this,"created_by",void 0),g()(this,"created_at",void 0),g()(this,"started_at",void 0),g()(this,"completed_at",void 0),g()(this,"status",void 0),g()(this,"attempts",void 0),g()(this,"max_attempts",void 0),g()(this,"timeout",void 0),g()(this,"kibana_name",void 0),g()(this,"kibana_id",void 0),g()(this,"size",void 0),g()(this,"content_type",void 0),g()(this,"csv_contains_formulas",void 0),g()(this,"max_size_reached",void 0),g()(this,"metrics",void 0),g()(this,"warnings",void 0),g()(this,"error_code",void 0),g()(this,"locatorParams",void 0),g()(this,"queue_time_ms",void 0),g()(this,"execution_time_ms",void 0),this.id=e.id,this.index=e.index,this.payload=e.payload,this.jobtype=e.jobtype,this.objectType=e.payload.objectType,this.title=e.payload.title,this.layout=e.payload.layout,this.version=e.payload.version,this.created_by=e.created_by,this.created_at=e.created_at,this.started_at=e.started_at,this.completed_at=e.completed_at,this.status=e.status,this.attempts=e.attempts,this.max_attempts=e.max_attempts,this.timeout=e.timeout,this.kibana_name=e.kibana_name,this.kibana_id=e.kibana_id,this.browserTimezone=e.payload.browserTimezone,this.size=null===(t=e.output)||void 0===t?void 0:t.size,this.content_type=null===(r=e.output)||void 0===r?void 0:r.content_type,this.isDeprecated=e.payload.isDeprecated||!1,this.spaceId=e.payload.spaceId,this.csv_contains_formulas=null===(n=e.output)||void 0===n?void 0:n.csv_contains_formulas,this.max_size_reached=null===(i=e.output)||void 0===i?void 0:i.max_size_reached,this.warnings=null===(o=e.output)||void 0===o?void 0:o.warnings,this.error_code=null===(a=e.output)||void 0===a?void 0:a.error_code,this.locatorParams=e.payload.locatorParams,this.metrics=e.metrics,this.queue_time_ms=e.queue_time_ms,this.execution_time_ms=e.execution_time_ms}isSearch(){return"search"===this.objectType}getStatusMessage(){const e=this.status;let t,r;return e===S?t=h.i18n.translate("xpack.reporting.jobStatusDetail.pendingStatusReachedText",{defaultMessage:"Waiting for job to process."}):e===w?t=h.i18n.translate("xpack.reporting.jobStatusDetail.attemptXofY",{defaultMessage:"Attempt {attempts} of {max_attempts}.",values:{attempts:this.attempts,max_attempts:this.max_attempts}}):this.getWarnings()?t=h.i18n.translate("xpack.reporting.jobStatusDetail.warningsText",{defaultMessage:"See report info for warnings."}):this.getError()&&(t=h.i18n.translate("xpack.reporting.jobStatusDetail.errorText",{defaultMessage:"See report info for error details."})),this.isDeprecated&&(r=Object(a.jsx)(v.EuiText,{size:"s"}," ",Object(a.jsx)(v.EuiTextColor,{color:"warning"},h.i18n.translate("xpack.reporting.jobStatusDetail.deprecatedText",{defaultMessage:"This is a deprecated export type. Automation of this report will need to be re-created for compatibility with future versions of Kibana."})))),t?Object(a.jsx)(i.a.Fragment,null,Object(a.jsx)(v.EuiText,{size:"s"},Object(a.jsx)(v.EuiTextColor,{color:"subdued"},t)),r||null):null}get prettyStatus(){var e;return null!==(e=E.get(this.status))&&void 0!==e?e:h.i18n.translate("xpack.reporting.jobStatusDetail.unknownText",{defaultMessage:"Unknown"})}get canLinkToKibanaApp(){return Boolean(this.locatorParams)}get isDownloadReady(){return this.status===b.c.COMPLETED||this.status===b.c.WARNINGS}get prettyJobTypeName(){switch(this.jobtype){case"printable_pdf":case"printable_pdf_v2":return h.i18n.translate("xpack.reporting.jobType.pdfOutputName",{defaultMessage:"PDF"});case"PNG":case"PNGV2":return h.i18n.translate("xpack.reporting.jobType.pngOutputName",{defaultMessage:"PNG"});case"csv_v2":case"csv_searchsource":return h.i18n.translate("xpack.reporting.jobType.csvOutputName",{defaultMessage:"CSV"});default:return}}get prettyTimeout(){if(null==this.timeout)return h.i18n.translate("xpack.reporting.jobStatusDetail.timeoutSecondsUnknown",{defaultMessage:"Unknown"});const e=this.timeout/1e3;return h.i18n.translate("xpack.reporting.jobStatusDetail.timeoutSeconds",{defaultMessage:"{timeout} seconds",values:{timeout:e}})}getCreatedAtDate(){return this.formatDate(this.created_at)}getCreatedBy(){return this.created_by||h.i18n.translate("xpack.reporting.jobCreatedBy.unknownUserPlaceholderText",{defaultMessage:"Unknown"})}getCreatedAtLabel(){return this.created_by?Object(a.jsx)(i.a.Fragment,null,Object(a.jsx)("div",null,this.formatDate(this.created_at)),Object(a.jsx)("span",null,this.created_by)):this.formatDate(this.created_at)}getError(){if(this.status===O)return this.warnings}getDeprecatedMessage(){if(this.isDeprecated)return h.i18n.translate("xpack.reporting.jobWarning.exportTypeDeprecated",{defaultMessage:"This is a deprecated export type. Automation of this report will need to be re-created for compatibility with future versions of Kibana."})}getWarnings(){var e;const t=[],r=this.getDeprecatedMessage();if(r&&t.push(r),this.csv_contains_formulas&&t.push(h.i18n.translate("xpack.reporting.jobWarning.csvContainsFormulas",{defaultMessage:"Your CSV contains characters that spreadsheet applications might interpret as formulas."})),this.max_size_reached&&t.push(h.i18n.translate("xpack.reporting.jobWarning.maxSizeReachedTooltip",{defaultMessage:"Your search reached the max size and contains partial data."})),this.status!==O&&null!==(e=this.warnings)&&void 0!==e&&e.length&&t.push(...this.warnings),t.length)return Object(a.jsx)("ul",null,t.map(((e,t)=>Object(a.jsx)("li",{key:`warning-key-${t}`},e))))}getPrettyStatusTimestamp(){return this.formatDate(this.getStatusTimestamp())}formatDate(e){try{return _()(e).format("YYYY-MM-DD @ hh:mm A")}catch(t){return e}}getStatusTimestamp(){const e=this.status;return e===w&&this.started_at?this.started_at:this.completed_at&&[x,O,k].includes(e)?this.completed_at:this.created_at}}const E=new Map([[S,h.i18n.translate("xpack.reporting.jobStatuses.pendingText",{defaultMessage:"Pending"})],[w,h.i18n.translate("xpack.reporting.jobStatuses.processingText",{defaultMessage:"Processing"})],[x,h.i18n.translate("xpack.reporting.jobStatuses.completedText",{defaultMessage:"Completed"})],[k,h.i18n.translate("xpack.reporting.jobStatuses.warningText",{defaultMessage:"Completed"})],[O,h.i18n.translate("xpack.reporting.jobStatuses.failedText",{defaultMessage:"Failed"})]]);class reporting_api_client_ReportingAPIClient{constructor(e,t,r){g()(this,"http",void 0),g()(this,"getManagementLink",(()=>this.http.basePath.prepend(b.d))),g()(this,"getDownloadLink",(e=>this.getReportURL(e))),g()(this,"getServerBasePath",(()=>this.http.basePath.serverBasePath)),this.uiSettings=t,this.kibanaVersion=r,this.http=e}getKibanaAppHref(e){const t=Object(y.stringify)({jobId:e.id});return`${Object(b.f)({basePath:this.http.basePath.serverBasePath,spaceId:e.spaceId,appPath:Object(b.h)()})}?${t}`}getReportURL(e){return this.http.basePath.prepend(`${l.a.JOBS.DOWNLOAD_PREFIX}/${e}?elasticInternalOrigin=true`)}downloadReport(e){const t=this.getReportURL(e);window.open(t)}async deleteReport(e){return await this.http.delete(`${l.a.JOBS.DELETE_PREFIX}/${e}`)}async list(e=0,t=[]){const r={page:e};return t.length>0&&(r.ids=t.slice(0,10).join(",")),(await this.http.get(l.a.JOBS.LIST,{query:r,asSystemRequest:!0})).map((e=>new job_Job(e)))}async total(){return await this.http.get(l.a.JOBS.COUNT,{asSystemRequest:!0})}async getError(e){var t;const r=await this.getInfo(e);return null!==(t=r.warnings)&&void 0!==t&&t[0]?r.warnings[0]:h.i18n.translate("xpack.reporting.apiClient.unknownError",{defaultMessage:"Report job {job} failed. Error unknown.",values:{job:e}})}async getInfo(e){const t=await this.http.get(`${l.a.JOBS.INFO_PREFIX}/${e}`);return new job_Job(t)}async findForJobIds(e){return(await this.http.fetch(l.a.JOBS.LIST,{query:{page:0,ids:e.join(",")},method:"GET"})).map((e=>new job_Job(e)))}getReportingPublicJobPath(e,t){const r=Object(y.stringify)({jobParams:m.a.encode(t)});return`${this.http.basePath.prepend(l.b.GENERATE_PREFIX)}/${e}?${r}`}async createReportingJob(e,t){const r=m.a.encode(t),n=await this.http.post(`${l.a.GENERATE_PREFIX}/${e}`,{method:"POST",body:JSON.stringify({jobParams:r})});return(e=>{const t=(()=>{const e=sessionStorage.getItem(b.b);return e?JSON.parse(e):[]})();t.push(e),(e=>{sessionStorage.setItem(b.b,JSON.stringify(e))})(t)})(n.job.id),new job_Job(n.job)}async createImmediateReport(e){const{objectType:t,...r}=e;return this.http.post(l.a.DOWNLOAD_CSV,{asResponse:!0,body:JSON.stringify(r)})}getDecoratedJobParams(e){return{browserTimezone:"Browser"===this.uiSettings.get("dateFormat:tz")?_.a.tz.guess():this.uiSettings.get("dateFormat:tz"),version:this.kibanaVersion,...e}}verifyBrowser(){return this.http.post(l.a.DIAGNOSE.BROWSER)}verifyScreenCapture(){return this.http.post(l.a.DIAGNOSE.SCREENSHOT)}migrateReportingIndicesIlmPolicy(){return this.http.put(l.a.MIGRATE.MIGRATE_ILM_POLICY)}}},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,r){"use strict";r.d(t,"e",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return s})),r.d(t,"c",(function(){return c}));const n="__REPORTING_REDIRECT_LOCATOR_STORE_KEY__",i="xpack.reporting.jobCompletionNotifications",o=()=>"/app/reportingRedirect",a="kibana-reporting",s="/app/management/insightsAndAlerting/reporting";let c;!function(e){e.PENDING="pending",e.PROCESSING="processing",e.COMPLETED="completed",e.FAILED="failed",e.WARNINGS="completed_with_warnings"}(c||(c={}))},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,r){r.r(t);var n=__kbnBundles__.get("plugin/esUiShared/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r(3);var n=r(2),i=r(4),o=r(6),a=r(0);const s={cloud:{insufficientMemoryError:e=>Object(a.jsx)(i.FormattedMessage,{id:"xpack.reporting.listing.infoPanel.callout.cloud.insufficientMemoryError",defaultMessage:"Kibana needs more memory to generate this report. Check {link}.",values:{link:Object(a.jsx)(o.EuiLink,{href:e},n.i18n.translate("xpack.reporting.listing.infoPanel.callout.cloud.insufficientMemoryError.urlLink",{defaultMessage:"RAM requirements"}))}})}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return s}));var n=r(9),i=r(10),o=r(12);const a=({sharingData:e})=>null!=e.locatorParams,s=e=>{switch(e){case i.a:case i.b:return"PDF";case n.a:case n.b:return"CSV";case o.a:case o.b:return"PNG";default:return e}}},function(e,t,r){r.r(t);var n=__kbnBundles__.get("plugin/uiActions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(n))},function(e,t,r){r(33),__kbnBundles__.define("plugin/reporting/public",r,37)},function(e,t,r){r.p=window.__kbnPublicPath__.reporting},function(e,t,r){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},function(e,t,r){"use strict";var n="%[a-f0-9]{2}",i=new RegExp("("+n+")|([^%]+?)","gi"),o=new RegExp("("+n+")+","gi");function a(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],a(r),a(n))}function s(e){try{return decodeURIComponent(e)}catch(n){for(var t=e.match(i)||[],r=1;r<t.length;r++)t=(e=a(t,r).join("")).match(i)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},r=o.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var n=s(r[0]);n!==r[0]&&(t[r[0]]=n)}r=o.exec(e)}t["%C2"]="�";for(var i=Object.keys(t),a=0;a<i.length;a++){var c=i[a];e=e.replace(new RegExp(c,"g"),t[c])}return e}(e)}}},function(e,t,r){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const r=e.indexOf(t);return-1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]}},function(e,t,r){"use strict";r.r(t),r.d(t,"plugin",(function(){return J}));var n=r(1),i=r.n(n),o=r(11),a=r(13),s=r(19),c=r(20),u=r(2),l=r(5),p=r(24),d=r(6),g=r(4),h=r(3),b=r.n(h),f=r(7),m=r(18),j=r(29),_=r(0);const y=(e,t,r,n,i)=>({title:Object(f.toMountPoint)(Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.couldNotCreateReportTitle",defaultMessage:"Cannot create {reportType} report for '{reportObjectTitle}'.",values:{reportType:t.jobtype,reportObjectTitle:t.title}}),{theme$:n.theme$}),text:Object(f.toMountPoint)(Object(_.jsx)(b.a.Fragment,null,Object(_.jsx)(d.EuiCallOut,{size:"m",color:"danger","data-test-errorText":e},t.errorCode===m.a.code?j.a.cloud.insufficientMemoryError(i.links.reporting.cloudMinimumRequirements):e),Object(_.jsx)(d.EuiSpacer,null),Object(_.jsx)("p",null,Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.checkManagement",defaultMessage:"Go to {path} for details.",values:{path:Object(_.jsx)("a",{href:r()},Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.reportingSectionUrlLinkLabel",defaultMessage:"Stack Management > Kibana > Reporting"}))}}))),{theme$:n.theme$}),iconType:void 0,"data-test-subj":"completeReportFailure"}),v=(e,t,r)=>({text:Object(f.toMountPoint)(Object(_.jsx)(b.a.Fragment,null,Object(_.jsx)(d.EuiCallOut,{title:e,color:"danger",iconType:"warning"},t.toString()),Object(_.jsx)(d.EuiSpacer,null),Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.error.tryRefresh",defaultMessage:"Try refreshing the page."})),{theme$:r.theme$}),iconType:void 0}),x=({getUrl:e,job:t})=>Object(_.jsx)(d.EuiButton,{size:"s","data-test-subj":"downloadCompletedReportButton",href:e(t.id),target:"_blank"},Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.downloadReportButtonLabel",defaultMessage:"Download report"})),O=({getUrl:e})=>Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.reportLinkDescription",defaultMessage:"Download it now, or get it later in {path}.",values:{path:Object(_.jsx)("a",{href:e()},Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.reportLink.reportingSectionUrlLinkLabel",defaultMessage:"Stack Management > Reporting"}))}}),S=(e,t,r,n)=>({title:Object(f.toMountPoint)(Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.successfullyCreatedReportNotificationTitle",defaultMessage:"{reportType} created for '{reportObjectTitle}'",values:{reportType:e.jobtype,reportObjectTitle:e.title}}),{theme$:n.theme$}),color:"success",text:Object(f.toMountPoint)(Object(_.jsx)(b.a.Fragment,null,Object(_.jsx)("p",null,Object(_.jsx)(O,{getUrl:t})),Object(_.jsx)(x,{getUrl:r,job:e})),{theme$:n.theme$}),"data-test-subj":"completeReportSuccess"}),w=(e,t,r,n)=>({title:Object(f.toMountPoint)(Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.csvContainsFormulas.formulaReportTitle",defaultMessage:"{reportType} may contain formulas",values:{reportType:e.jobtype}}),{theme$:n.theme$}),text:Object(f.toMountPoint)(Object(_.jsx)(b.a.Fragment,null,Object(_.jsx)("p",null,Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.csvContainsFormulas.formulaReportMessage",defaultMessage:"The report '{reportObjectTitle}' contains characters which spreadsheet applications can interpret as formulas.",values:{reportObjectTitle:e.title}})),Object(_.jsx)("p",null,Object(_.jsx)(O,{getUrl:t})),Object(_.jsx)(x,{getUrl:r,job:e})),{theme$:n.theme$}),"data-test-subj":"completeReportCsvFormulasWarning"}),k=(e,t,r,n)=>({title:Object(f.toMountPoint)(Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.maxSizeReached.partialReportTitle",defaultMessage:"Created partial {reportType} for '{reportObjectTitle}'",values:{reportType:e.jobtype,reportObjectTitle:e.title}}),{theme$:n.theme$}),text:Object(f.toMountPoint)(Object(_.jsx)(b.a.Fragment,null,Object(_.jsx)("p",null,Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.maxSizeReached.partialReportDescription",defaultMessage:"The report reached the max size and contains partial data."})),Object(_.jsx)("p",null,Object(_.jsx)(O,{getUrl:t})),Object(_.jsx)(x,{getUrl:r,job:e})),{theme$:n.theme$}),"data-test-subj":"completeReportMaxSizeWarning"}),E=(e,t,r,n)=>({title:Object(f.toMountPoint)(Object(_.jsx)(g.FormattedMessage,{id:"xpack.reporting.publicNotifier.warning.title",defaultMessage:"{reportType} completed with issues",values:{reportType:e.jobtype}}),{theme$:n.theme$}),text:Object(f.toMountPoint)(Object(_.jsx)(b.a.Fragment,null,Object(_.jsx)("p",null,Object(_.jsx)(O,{getUrl:t})),Object(_.jsx)(x,{getUrl:r,job:e})),{theme$:n.theme$}),"data-test-subj":"completeReportWarning"});function C(e){var t;return{id:e.id,status:e.status,title:e.title,jobtype:null!==(t=e.prettyJobTypeName)&&void 0!==t?t:e.jobtype,maxSizeReached:e.max_size_reached,csvContainsFormulas:e.csv_contains_formulas,errorCode:e.error_code}}class stream_handler_ReportingNotifierStreamHandler{constructor(e,t,r,n){this.notifications=e,this.apiClient=t,this.theme=r,this.docLinks=n}showNotifications({completed:e,failed:t}){return o.from((async()=>{const r={toastLifeTimeMs:864e5};for(const t of e)t.csvContainsFormulas?this.notifications.toasts.addWarning(w(t,this.apiClient.getManagementLink,this.apiClient.getDownloadLink,this.theme),r):t.maxSizeReached?this.notifications.toasts.addWarning(k(t,this.apiClient.getManagementLink,this.apiClient.getDownloadLink,this.theme),r):t.status===l.c.WARNINGS?this.notifications.toasts.addWarning(E(t,this.apiClient.getManagementLink,this.apiClient.getDownloadLink,this.theme),r):this.notifications.toasts.addSuccess(S(t,this.apiClient.getManagementLink,this.apiClient.getDownloadLink,this.theme),r);for(const e of t){const t=await this.apiClient.getError(e.id);this.notifications.toasts.addDanger(y(t,e,this.apiClient.getManagementLink,this.theme,this.docLinks))}return{completed:e,failed:t}})())}findChangedStatusJobs(e){return o.from(this.apiClient.findForJobIds(e)).pipe(Object(a.map)((t=>{const r=[],n=[],i=[];for(const o of t){const{id:t,status:a}=o;e.includes(t)&&(a===l.c.COMPLETED||a===l.c.WARNINGS?r.push(C(o)):a===l.c.FAILED?n.push(C(o)):i.push(t))}var o;return o=i,sessionStorage.setItem(l.b,JSON.stringify(o)),{completed:r,failed:n}})),Object(a.catchError)((e=>(this.notifications.toasts.addDanger(v(u.i18n.translate("xpack.reporting.publicNotifier.httpErrorMessage",{defaultMessage:"Could not check Reporting job status!"}),e,this.theme)),window.console.error(e),o.of({completed:[],failed:[]})))))}}var R=r(23),M=r(9),P=r(31),T=r(15);class get_csv_panel_action_ReportingCsvPanelAction{constructor({core:e,apiClient:t,startServices$:r,usesUiCapabilities:n}){i()(this,"isDownloading",void 0),i()(this,"type",""),i()(this,"id",M.d),i()(this,"notifications",void 0),i()(this,"apiClient",void 0),i()(this,"startServices$",void 0),i()(this,"usesUiCapabilities",void 0),i()(this,"isCompatible",(async e=>{var t;const{embeddable:r}=e;if("search"!==r.type)return!1;const[{application:n},{licensing:i}]=await Object(o.firstValueFrom)(this.startServices$),a=await Object(o.firstValueFrom)(i.license$),s=Object(T.a)(a.check("reporting","basic")).showLinks,u=!this.usesUiCapabilities||!0===(null===(t=n.capabilities.dashboard)||void 0===t?void 0:t.downloadCsv);if(!s||!u)return!1;const l=r.getSavedSearch(),p=null==l?void 0:l.searchSource.getField("query");return!(p&&Boolean(p&&"sql"in p)||r.getInput().viewMode===c.ViewMode.EDIT)})),i()(this,"execute",(async e=>{const{embeddable:t}=e;if(!function(e){return e.type===R.SEARCH_EMBEDDABLE_TYPE}(t)||!await this.isCompatible(e))throw new P.IncompatibleActionError;const r=t.getSavedSearch();if(!r||this.isDownloading)return;const{columns:n,getSearchSource:i}=await this.getSharingData(r),o=this.apiClient.getDecoratedJobParams({searchSource:i({addGlobalTimeFilter:!t.hasTimeRange(),absoluteTime:!0}),columns:n,title:r.title||"",objectType:"downloadCsv"});this.isDownloading=!0,this.notifications.toasts.addSuccess({title:u.i18n.translate("xpack.reporting.dashboard.csvDownloadStartedTitle",{defaultMessage:"CSV Download Started"}),text:u.i18n.translate("xpack.reporting.dashboard.csvDownloadStartedMessage",{defaultMessage:"Your CSV will download momentarily."}),"data-test-subj":"csvDownloadStarted"}),await this.apiClient.createImmediateReport(o).then((({body:e,response:t})=>{this.isDownloading=!1;const n=`${r.title}.csv`,i=new Blob([e],{type:(null==t?void 0:t.headers.get("content-type"))||void 0});if(window.navigator.msSaveOrOpenBlob)return window.navigator.msSaveOrOpenBlob(i,n);const o=window.document.createElement("a"),a=window.URL.createObjectURL(i);o.href=a,o.download=n,document.body.appendChild(o),o.click(),window.URL.revokeObjectURL(a),document.body.removeChild(o)})).catch(this.onGenerationFail.bind(this))})),this.isDownloading=!1,this.notifications=e.notifications,this.apiClient=t,this.startServices$=r,this.usesUiCapabilities=n}getIconType(){return"document"}getDisplayName(){return u.i18n.translate("xpack.reporting.dashboard.downloadCsvPanelTitle",{defaultMessage:"Download CSV"})}async getSharingData(e){const[{uiSettings:t},{data:r}]=await Object(o.firstValueFrom)(this.startServices$),{getSharingData:n}=await Object(R.loadSharingDataHelpers)();return await n(e.searchSource,e,{uiSettings:t,data:r})}onGenerationFail(e){this.isDownloading=!1,this.notifications.toasts.addDanger({title:u.i18n.translate("xpack.reporting.dashboard.failedCsvDownloadTitle",{defaultMessage:"CSV download failed"}),text:u.i18n.translate("xpack.reporting.dashboard.failedCsvDownloadMessage",{defaultMessage:"We couldn't generate your CSV at this time."}),"data-test-subj":"downloadCsvFail"})}}const D=e=>Object(_.jsx)(h.Fragment,null,Object(_.jsx)(d.EuiSpacer,null),Object(_.jsx)(d.EuiFlexGroup,{justifyContent:"spaceAround"},Object(_.jsx)(d.EuiFlexItem,{grow:!1},Object(_.jsx)(d.EuiLoadingSpinner,{size:"l"}))),Object(_.jsx)(d.EuiSpacer,null)),I=Object(h.lazy)((()=>r.e(0).then(r.bind(null,66)).then((({ReportingPanelContent:e})=>({default:e}))))),F=e=>Object(_.jsx)(h.Suspense,{fallback:Object(_.jsx)(D,null)},Object(_.jsx)(I,e));var N=r(30);const L=Object(h.lazy)((()=>Promise.all([r.e(0),r.e(4)]).then(r.bind(null,67)).then((({ScreenCapturePanelContent:e})=>({default:e}))))),A=e=>Object(_.jsx)(h.Suspense,{fallback:Object(_.jsx)(D,null)},Object(_.jsx)(L,e)),$=(e,t,r)=>()=>{const{objectType:n,sharingData:{title:i,layout:o,locatorParams:a}}=t,s={objectType:n,layout:o,title:i};if("printablePdfV2"===r)return{...s,locatorParams:[a]};if("pngV2"===r)return{...s,locatorParams:a};const c=t.shareableUrl.replace(window.location.origin+e.getServerBasePath(),"");return"printablePdf"===r?{...s,relativeUrls:[c]}:{...s,relativeUrl:c}};var U=r(17),B=r.n(U),G=r(10),V=r(12);function z(e,t){return{ReportingPanelPDF:r=>Object(_.jsx)(A,B()({requiresSavedState:!1,reportType:G.c,apiClient:t,toasts:e.notifications.toasts,uiSettings:e.uiSettings,theme:e.theme},r)),ReportingPanelPDFV2:r=>Object(_.jsx)(A,B()({requiresSavedState:!1,reportType:G.d,apiClient:t,toasts:e.notifications.toasts,uiSettings:e.uiSettings,theme:e.theme},r)),ReportingPanelPNGV2:r=>Object(_.jsx)(A,B()({requiresSavedState:!1,reportType:V.d,apiClient:t,toasts:e.notifications.toasts,uiSettings:e.uiSettings,theme:e.theme},r))}}class plugin_ReportingPublicPlugin{constructor(e){i()(this,"kibanaVersion",void 0),i()(this,"apiClient",void 0),i()(this,"stop$",new o.ReplaySubject(1)),i()(this,"title",u.i18n.translate("xpack.reporting.management.reportingTitle",{defaultMessage:"Reporting"})),i()(this,"breadcrumbText",u.i18n.translate("xpack.reporting.breadcrumb",{defaultMessage:"Reporting"})),i()(this,"config",void 0),i()(this,"contract",void 0),this.config=e.config.get(),this.kibanaVersion=e.env.packageInfo.version}getApiClient(e,t){return this.apiClient||(this.apiClient=new p.b(e,t,this.kibanaVersion)),this.apiClient}getContract(e){if(e&&(this.contract={usesUiCapabilities:()=>{var e;return!1===(null===(e=this.config.roles)||void 0===e?void 0:e.enabled)},components:z(e,this.getApiClient(e.http,e.uiSettings))}),!this.contract)throw new Error("Setup error in Reporting plugin!");return this.contract}setup(e,t){const{getStartServices:n,uiSettings:i}=e,{home:a,management:l,screenshotMode:p,share:d,uiActions:g}=t,h=o.from(n()),b=!this.config.roles.enabled,f=this.getApiClient(e.http,e.uiSettings);a.featureCatalogue.register({id:"reporting",title:u.i18n.translate("xpack.reporting.registerFeature.reportingTitle",{defaultMessage:"Reporting"}),description:u.i18n.translate("xpack.reporting.registerFeature.reportingDescription",{defaultMessage:"Manage your reports generated from Discover, Visualize, and Dashboard."}),icon:"reportingApp",path:"/app/management/insightsAndAlerting/reporting",showOnHomePage:!1,category:"admin"}),l.sections.section.insightsAndAlerting.registerApp({id:"reporting",title:this.title,order:3,mount:async e=>{e.setBreadcrumbs([{text:this.breadcrumbText}]);const[[t,i],{mountManagementSection:o}]=await Promise.all([n(),r.e(2).then(r.bind(null,68))]),{licensing:a,data:s,share:c}=i,{docTitle:u}=t.chrome;u.change(this.title);const l=await o(t,a.license$,s,c,this.config,f,e);return()=>{u.reset(),l()}}}),e.application.register({id:"reportingRedirect",mount:async e=>{const{mountRedirectApp:t}=await r.e(3).then(r.bind(null,69));return t({...e,apiClient:f,screenshotMode:p,share:d})},title:"Reporting redirect app",searchable:!1,chromeless:!0,exactRoute:!0,navLinkStatus:s.AppNavLinkStatus.hidden}),g.addTriggerAction(c.CONTEXT_MENU_TRIGGER,new get_csv_panel_action_ReportingCsvPanelAction({core:e,apiClient:f,startServices$:h,usesUiCapabilities:b}));const m=this.getContract(e),{toasts:j}=e.notifications;return h.subscribe((([{application:t},{licensing:r}])=>{r.license$.subscribe((r=>{d.register((({apiClient:e,toasts:t,uiSettings:r,application:n,license:i,usesUiCapabilities:o,theme:a})=>({id:"csvReports",getShareMenuItems:({objectType:s,objectId:c,sharingData:l,onClose:p})=>{if("search"!==s)return[];const d=l.getSearchSource,g={title:l.title,objectType:s,columns:l.columns},h=e=>({...g,searchSource:d({addGlobalTimeFilter:!0,absoluteTime:!e})}),b=[],f=Object(T.a)(i.check("reporting","basic")),m=f.message,j=f.showLinks,y=!f.enableLinks;let v=!1;var x;if(v=!o||!0===(null===(x=n.capabilities.discover)||void 0===x?void 0:x.generateCsv),j&&v){const n=u.i18n.translate("xpack.reporting.shareContextMenu.csvReportsButtonLabel",{defaultMessage:"CSV Reports"});b.push({shareMenuItem:{name:n,icon:"document",toolTipContent:m,disabled:y,"data-test-subj":"CSVReports",sortOrder:1},panel:{id:"csvReportingPanel",title:n,content:Object(_.jsx)(F,{requiresSavedState:!1,apiClient:e,toasts:t,uiSettings:r,reportType:M.a,layoutId:void 0,objectId:c,getJobParams:h,onClose:p,theme:a})}})}return b}}))({apiClient:f,toasts:j,uiSettings:i,license:r,application:t,usesUiCapabilities:b,theme:e.theme})),(this.config.export_types.pdf.enabled||this.config.export_types.png.enabled)&&d.register((({apiClient:e,toasts:t,uiSettings:r,license:n,application:i,usesUiCapabilities:o,theme:a})=>({id:"screenCaptureReports",getShareMenuItems:({objectType:s,objectId:c,isDirty:l,onClose:p,shareableUrl:d,shareableUrlForSavedObject:g,...h})=>{const{enableLinks:b,showLinks:f,message:m}=Object(T.a)(n.check("reporting","gold")),j=m,y=f,v=!b;let x=!1,O=!1;var S,w;if(o?(x=!0===(null===(S=i.capabilities.dashboard)||void 0===S?void 0:S.generateScreenshot),O=!0===(null===(w=i.capabilities.visualize)||void 0===w?void 0:w.generateScreenshot)):(x=!0,O=!0),!y)return[];const k=["dashboard","visualization","lens"].includes(s);if(!k)return[];if("dashboard"===s&&!x)return[];if(k&&!O&&!x)return[];const{sharingData:E}=h,C=[],R=u.i18n.translate("xpack.reporting.shareContextMenu.pngReportsButtonLabel",{defaultMessage:"PNG Reports"}),M={shareableUrl:l?d:null!=g?g:d,objectType:s,sharingData:E},P=Object(N.a)(M),D=!P,I=P?"pngV2":"png",F={shareMenuItem:{name:R,icon:"document",toolTipContent:j,disabled:v||E.reportingDisabled,"data-test-subj":"PNGReports",sortOrder:10},panel:{id:"reportingPngPanel",title:R,content:Object(_.jsx)(A,{apiClient:e,toasts:t,uiSettings:r,reportType:I,objectId:c,requiresSavedState:D,getJobParams:$(e,M,I),isDirty:l,onClose:p,theme:a})}},L=u.i18n.translate("xpack.reporting.shareContextMenu.pdfReportsButtonLabel",{defaultMessage:"PDF Reports"}),U=P?"printablePdfV2":"printablePdf",B={shareMenuItem:{name:L,icon:"document",toolTipContent:j,disabled:v||E.reportingDisabled,"data-test-subj":"PDFReports",sortOrder:10},panel:{id:"reportingPdfPanel",title:L,content:Object(_.jsx)(A,{apiClient:e,toasts:t,uiSettings:r,reportType:U,objectId:c,requiresSavedState:D,layoutOption:"dashboard"===s?"print":void 0,getJobParams:$(e,M,U),isDirty:l,onClose:p,theme:a})}};return C.push(F),C.push(B),C}}))({apiClient:f,toasts:j,uiSettings:i,license:r,application:t,usesUiCapabilities:b,theme:e.theme}))}))})),m}start(e){const{notifications:t,docLinks:r}=e,n=this.getApiClient(e.http,e.uiSettings),i=new stream_handler_ReportingNotifierStreamHandler(t,n,e.theme,r),s=Object(l.g)(this.config.poll.jobsRefresh.interval);return o.timer(0,s).pipe(Object(a.takeUntil)(this.stop$),Object(a.map)((()=>function(){const e=sessionStorage.getItem(l.b);return e?JSON.parse(e):[]}())),Object(a.filter)((e=>e.length>0)),Object(a.mergeMap)((e=>i.findChangedStatusJobs(e))),Object(a.mergeMap)((({completed:e,failed:t})=>i.showNotifications({completed:e,failed:t}))),Object(a.catchError)((r=>function(e,t,r){return e.toasts.addDanger(v(u.i18n.translate("xpack.reporting.publicNotifier.pollingErrorMessage",{defaultMessage:"Reporting notifier error!"}),t,r)),window.console.error(t),o.of({completed:[],failed:[]})}(t,r,e.theme)))).subscribe(),this.getContract()}stop(){this.stop$.next()}}function J(e){return new plugin_ReportingPublicPlugin(e)}},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t){e.exports=__kbnSharedDeps__.EmotionCache},function(e,t){e.exports=__kbnSharedDeps__.TsLib}]);