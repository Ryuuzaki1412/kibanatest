(window.expressionMetricVis_bundle_jsonpfunction=window.expressionMetricVis_bundle_jsonpfunction||[]).push([[1],{22:function(e,t,i){e.exports=i(19)(3)},24:function(e,t,i){"use strict";i.r(t),i.d(t,"defaultColor",(function(){return g})),i.d(t,"MetricVis",(function(){return O}));var n=i(22),r=i.n(n),o=i(15),c=i(0),s=i(7),l=i(1),a=i(6),d=i(20),u=i(21),m=i(9),v=i(2),h=i(8),b=i(11);const g=d.euiThemeVars.euiColorLightestShade,j=(e,t,i)=>{var n,r;let o,c;i.dimensions.secondaryMetric&&(o=Object(l.getColumnByAccessor)(i.dimensions.secondaryMetric,e),c=f(i.dimensions.secondaryMetric,e));const s=null!==(n=i.metric.secondaryPrefix)&&void 0!==n?n:null===(r=o)||void 0===r?void 0:r.name;return Object(a.jsx)("span",null,s,o?`${s?" ":""}${c(t[o.id])}`:void 0)},f=(e,t)=>{const i=function(e){var t;const i=(null==e?void 0:e.id)||"number";return"duration"!==i||null!=e&&null!==(t=e.params)&&void 0!==t&&t.formatOverride?null!=e?e:{id:i}:{...e,params:{outputFormat:"humanizePrecise",outputPrecision:1,useShortSuffix:!0,...e.params}}}(Object(l.getFormatByAccessor)(e,t));return Object(h.a)().deserialize(i).getConverterFor("text")},p=(e,t,i,n,r)=>{var o,c;const{min:s,max:l}=Object(b.a)(i,n,r);return null===(o=Object(h.b)().get("custom"))||void 0===o||null===(c=o.getColorForValue)||void 0===c?void 0:c.call(o,e,t,{min:s,max:l})},x=e=>({width:t,height:i,color:n})=>Object(a.jsx)(u.EuiIcon,{type:e,width:t,height:i,fill:n,style:{width:t,height:i}}),O=({data:e,config:t,renderComplete:i,fireEvent:n,renderMode:b,filterable:O,overrides:y})=>{var w,C,B;const M=Object(h.c)().useChartsTheme(),A=Object(o.useCallback)((e=>{e&&i()}),[i]),[T,S]=Object(o.useState)("100%"),k=Object(o.useRef)(null),E=Object(u.useResizeObserver)(k.current),V=Object(h.c)().useChartsBaseTheme(),F=Object(l.getColumnByAccessor)(t.dimensions.metric,e.columns),D=f(t.dimensions.metric,e.columns);let $,z;t.dimensions.breakdownBy&&($=Object(l.getColumnByAccessor)(t.dimensions.breakdownBy,e.columns),z=Object(h.a)().deserialize(Object(l.getFormatByAccessor)(t.dimensions.breakdownBy,e.columns)).getConverterFor("text"));const I=t.dimensions.max?null===(w=Object(l.getColumnByAccessor)(t.dimensions.max,e.columns))||void 0===w?void 0:w.id:void 0,_=($?e.rows:e.rows.slice(0,1)).map(((i,n)=>{var r,o,s,l,a;const d=null!==i[F.id]?i[F.id]:NaN,u=$?z(i[$.id]):F.name,m=$?F.name:t.metric.subtitle;var h,b,f;if("number"!=typeof d)return{value:D(d),title:String(u),subtitle:m,icon:null!==(h=t.metric)&&void 0!==h&&h.icon?x(null===(b=t.metric)||void 0===b?void 0:b.icon):void 0,extra:j(e.columns,i,t),color:null!==(f=t.metric.color)&&void 0!==f?f:g};const O={value:d,valueFormatter:D,title:String(u),subtitle:m,icon:null!==(r=t.metric)&&void 0!==r&&r.icon?x(null===(o=t.metric)||void 0===o?void 0:o.icon):void 0,extra:j(e.columns,i,t),color:t.metric.palette&&null!=d?null!==(s=p(d,t.metric.palette,{metric:F.id,max:I,breakdownBy:null===(l=$)||void 0===l?void 0:l.id},e,n))&&void 0!==s?s:g:null!==(a=t.metric.color)&&void 0!==a?a:g},y=$?i[$.id]:v.a;return t.metric.trends&&t.metric.trends[y]?{...O,trend:t.metric.trends[y],trendShape:"area",trendA11yTitle:c.i18n.translate("expressionMetricVis.trendA11yTitle",{defaultMessage:"{dataTitle} over time.",values:{dataTitle:F.name}}),trendA11yDescription:c.i18n.translate("expressionMetricVis.trendA11yDescription",{defaultMessage:"A line chart showing the trend of the primary metric over time."})}:I&&t.metric.progressDirection?{...O,domainMax:i[I],progressBarDirection:t.metric.progressDirection}:O}));if(t.metric.minTiles)for(;_.length<t.metric.minTiles;)_.push(void 0);const{metric:{maxCols:L}}=t,P=_.length/L,R=null!==(C=null===(B=M.metric)||void 0===B?void 0:B.minHeight)&&void 0!==C?C:V.metric.minHeight;Object(o.useEffect)((()=>{var e;const t=R*P;S((null!==(e=E.height)&&void 0!==e?e:-1/0)>t?"100%":`${t}px`)}),[P,R,E.height]);const{theme:H={},...N}=Object(m.c)(y,"settings"),q=[];for(let e=0;e<_.length;e+=L)q.push(_.slice(e,e+L));let G,J;if("edit"===b){var K;const e=_.flat().length>1?200:300;G=q.length*e,J=(null===(K=q[0])||void 0===K?void 0:K.length)*e}return Object(a.jsx)("div",{ref:k,css:Object(a.css)("height:",G?`${G}px`:"100%",";width:",J?`${J}px`:"100%",";max-height:100%;max-width:100%;overflow-y:auto;",Object(u.useEuiScrollBar)(),";","")},Object(a.jsx)("div",{css:Object(a.css)("height:",T,";","")},Object(a.jsx)(s.Chart,Object(m.c)(y,"chart"),Object(a.jsx)(s.Settings,r()({locale:c.i18n.getLocale(),theme:[{background:{color:"transparent"},metric:{background:g,barBackground:d.euiThemeVars.euiColorLightShade},...M},...Array.isArray(H)?H:[H]],baseTheme:V,onRenderChange:A,onElementClick:O?t=>{var i;const r=null!==(i=$)&&void 0!==i?i:F,o=q[0].length;t.forEach((t=>{if(Object(s.isMetricElementEvent)(t)){const i=e.columns.findIndex((e=>e===r));n(((e,t,i)=>{const n=i.columns[t];return{name:"filter",data:{data:[{table:i,column:t,row:e,value:i.rows[e][n.id]}]}}})(t.rowIndex*o+t.columnIndex,i,e))}}))}:void 0},N)),Object(a.jsx)(s.Metric,{id:"metric",data:q}))))}}}]);