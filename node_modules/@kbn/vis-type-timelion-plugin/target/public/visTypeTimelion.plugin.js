!function(e){function t(t){for(var n,r,o=t[0],s=t[1],a=0,u=[];a<o.length;a++)r=o[a],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(l&&l(t);u.length;)u.shift()()}var n={},i={1:0};function r(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise((function(t,r){n=i[e]=[t,r]}));t.push(n[2]=o);var s,a=document.createElement("script");a.charset="utf-8",a.timeout=120,r.nc&&a.setAttribute("nonce",r.nc),a.src=function(e){return r.p+"visTypeTimelion.chunk."+e+".js"}(e);var l=new Error;s=function(t){a.onerror=a.onload=null,clearTimeout(u);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+r+": "+o+")",l.name="ChunkLoadError",l.type=r,l.request=o,n[1](l)}i[e]=void 0}};var u=setTimeout((function(){s({type:"timeout",target:a})}),12e4);a.onerror=a.onload=s,document.head.appendChild(a)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r.oe=function(e){throw console.error(e),e};var o=window.visTypeTimelion_bundle_jsonpfunction=window.visTypeTimelion_bundle_jsonpfunction||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var a=0;a<o.length;a++)t(o[a]);var l=s;r(r.s=18)}([function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return a})),n.d(t,"a",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"h",(function(){return p})),n.d(t,"e",(function(){return d})),n.d(t,"j",(function(){return f}));var i=n(4);const[r,o]=Object(i.createGetterSetter)("dataViews"),[s,a]=Object(i.createGetterSetter)("Search"),[l,u]=Object(i.createGetterSetter)("Charts"),[c,p]=Object(i.createGetterSetter)("FieldFormats"),[d,f]=Object(i.createGetterSetter)("UsageCollection",!1)},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/data/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.EmotionReact},function(e,t){e.exports=__kbnSharedDeps__.Lodash},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaUtils/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.KbnI18n},function(e,t){e.exports=__kbnSharedDeps__.React},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/visualizations/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/dataViews/common");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/kibanaReact/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/expressions/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.ReactDom},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/visDefaultEditor/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));const i=async e=>{const{parseTimelionExpression:t}=await n.e(3).then(n.bind(null,29));return t(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var i=n(3),r=n(8),o=n(1),s=n(0);function a(){const e=Object(s.d)();async function t(t){const n=t.find((({name:e})=>"index"===e));if(!n)return;const r=Object(i.get)(n,"value.text");return(await e.find(r,1)).find((e=>e.title===r))}function n(e,t){return!e||t.name.includes(e)}const a={es:{async index(t){const n=t?`${t}*`:"*";return(await e.find(n,25)).map((({title:e})=>({name:e,insertText:e})))},async metric(e,i){if(!e||!e.includes(":"))return[{name:"avg:"},{name:"cardinality:"},{name:"count"},{name:"max:"},{name:"min:"},{name:"percentiles:"},{name:"sum:"}];const s=await t(i);if(!s)return[];const a=e.split(":");return s.fields.getByType(o.KBN_FIELD_TYPES.NUMBER).filter((e=>e.aggregatable&&n(a[1],e)&&!Object(r.isNestedField)(e))).map((e=>{const t=e.name.replaceAll(":","\\:");return{name:`${a[0]}:${t}`,help:e.type,insertText:t}}))},async split(e,i){const s=await t(i);return s?s.fields.getAll().filter((t=>t.aggregatable&&[o.KBN_FIELD_TYPES.NUMBER,o.KBN_FIELD_TYPES.BOOLEAN,o.KBN_FIELD_TYPES.DATE,o.KBN_FIELD_TYPES.IP,o.KBN_FIELD_TYPES.STRING].includes(t.type)&&n(e,t)&&!Object(r.isNestedField)(t))).map((e=>({name:e.name,help:e.type,insertText:e.name}))):[]},async timefield(e,i){const s=await t(i);return s?s.fields.getByType(o.KBN_FIELD_TYPES.DATE).filter((t=>n(e,t)&&!Object(r.isNestedField)(t))).map((e=>({name:e.name,insertText:e.name}))):[]}}};return{hasDynamicSuggestionsForArgument:(e,t)=>a[e]&&a[e][t],getDynamicSuggestionsForArgument:async(e,t,n,i="")=>await a[e][t](i,n),getStaticSuggestionsForInput:(e="",t=[])=>e?t.filter((t=>t.name.includes(e))):t}}},function(e,t,n){e.exports=n(17)(3)},function(e,t){e.exports=__kbnSharedDeps__.KbnAnalytics},function(e,t){e.exports=__kbnSharedDeps_npm__},function(e,t,n){n(19),__kbnBundles__.define("plugin/visTypeTimelion/public",n,20)},function(e,t,n){n.p=window.__kbnPublicPath__.visTypeTimelion},function(e,t,n){"use strict";n.r(t),n.d(t,"plugin",(function(){return x}));var i=n(3),r=n(5);const o="timelion";var s=n(15),a=n.n(s),l=n(6),u=n(12),c=n(7),p=n(10);const d=e=>{const{expression:t,interval:n}=e.params,i=Object(p.buildExpressionFunction)("timelion_vis",{expression:t,interval:n});return Object(p.buildExpression)([i]).toAst()};var f=n(0),b=n(13),_=n(2);const m=Object(l.lazy)((()=>n.e(2).then(n.bind(null,46))));function g(e){return{name:o,title:"Timelion",icon:"visTimelion",description:r.i18n.translate("timelion.timelionDescription",{defaultMessage:"Show time series data on a graph."}),visConfig:{defaults:{expression:".es(*)",interval:"auto"}},editorConfig:{optionsTemplate:t=>Object(_.jsx)(m,a()({services:e},t)),defaultSize:u.DefaultEditorSize.MEDIUM},toExpressionAst:d,inspectorAdapters:{},getSupportedTriggers:()=>[c.VIS_EVENT_TO_TRIGGER.applyFilter],getUsedIndexPattern:async e=>{try{var t,n;const i=(null!==(t=null===(n=await Object(b.a)(e.expression))||void 0===n?void 0:n.args)&&void 0!==t?t:[]).find((({type:e,name:t,function:n})=>"namedArg"===e&&"es"===n&&"index"===t));if(null!=i&&i.value.text)return Object(f.d)().find(i.value.text,1)}catch{}return[]},options:{showIndexSelection:!1,showFilterBar:!1,showQueryInput:!1},requiresSearch:!0}}var v=n(14),y=n(11),h=n(9),O=n(16);const j=Object(l.lazy)((()=>n.e(0).then(n.bind(null,45)).then((({TimelionVisComponent:e})=>({default:e})))));class plugin_TimelionVisPlugin{constructor(e){this.initializerContext=e}setup({uiSettings:e,http:t,theme:s},{expressions:a,visualizations:l,data:u,charts:p}){const d={http:t,uiSettings:e,timefilter:u.query.timefilter.timefilter,theme:s};var b;a.registerFunction((()=>(e=>({name:"timelion_vis",type:"render",inputTypes:["kibana_context","null"],help:r.i18n.translate("timelion.function.help",{defaultMessage:"Timelion visualization"}),args:{expression:{types:["string"],aliases:["_"],default:'".es(*)"',help:""},interval:{types:["string"],default:"auto",help:""},ariaLabel:{types:["string"],help:r.i18n.translate("timelion.function.args.ariaLabelHelpText",{defaultMessage:"Specifies the aria label of the timelion"}),required:!1}},async fn(t,r,{getSearchSessionId:s,getExecutionContext:a,variables:l,abortSignal:u,isSyncTooltipsEnabled:c,isSyncCursorEnabled:p}){var d,f,b,_,m;const{getTimelionRequestHandler:g}=await n.e(0).then(n.bind(null,45)),v={expression:r.expression,interval:r.interval,ariaLabel:null!==(d=null!==(f=r.ariaLabel)&&void 0!==f?f:null==l?void 0:l.embeddableTitle)&&void 0!==d?d:null==a||null===(b=a())||void 0===b?void 0:b.description};let y;if(!u.aborted){const n=g({...e,expressionAbortSignal:u});y=await n({timeRange:Object(i.get)(t,"timeRange"),query:Object(i.get)(t,"query"),filters:Object(i.get)(t,"filters"),visParams:v,searchSessionId:s(),executionContext:a()}),y.visType=o}return{type:"render",as:"timelion_vis",value:{visParams:v,visType:o,visData:y,syncTooltips:null!==(_=null==c?void 0:c())&&void 0!==_&&_,syncCursor:null===(m=null==c?void 0:c())||void 0===m||m}}}}))(d))),a.registerRenderer((b=d,{name:"timelion_vis",displayName:"Timelion visualization",reuseDomNode:!0,render:(e,{visData:t,visParams:n,syncTooltips:i,syncCursor:r},o)=>{o.onDestroy((()=>{Object(y.unmountComponentAtNode)(e)}));const s=null==t?void 0:t.sheet[0],a=!s||!s.list.length,l=()=>{const e=Object(f.e)(),t=(e=>{if(e){var t;const n=e=>e.type?e:e.child?n(e.child):void 0;return null===(t=n(e))||void 0===t?void 0:t.type}})(o.getExecutionContext());e&&t&&e.reportUiCounter(t,O.METRIC_TYPE.COUNT,"render_agg_based_timelion"),o.done()};Object(y.render)(Object(_.jsx)(c.VisualizationContainer,{renderComplete:l,handlers:o,showNoResult:a},Object(_.jsx)(h.KibanaThemeProvider,{theme$:b.theme.theme$},Object(_.jsx)(h.KibanaContextProvider,{services:{...b}},s&&Object(_.jsx)(j,{interval:n.interval,ariaLabel:n.ariaLabel,seriesList:s,renderComplete:l,onBrushEvent:e=>{o.event({name:"applyFilter",data:{timeFieldName:"*",filters:[{query:{range:{"*":e}}}]}})},syncTooltips:i,syncCursor:r})))),e)}}));const{readOnly:m}=this.initializerContext.config.get();l.createBaseVisualization({...g(d),disableCreate:Boolean(m),disableEdit:Boolean(m)})}start(e,{data:t,charts:n,dataViews:i,fieldFormats:r,usageCollection:o}){return Object(f.i)(i),Object(f.g)(t.search),Object(f.f)(n),Object(f.h)(r),o&&Object(f.j)(o),{getArgValueSuggestions:v.a}}}function x(e){return new plugin_TimelionVisPlugin(e)}},function(e,t){e.exports=__kbnSharedDeps__.ElasticCharts},function(e,t){e.exports=__kbnSharedDeps__.ElasticEui},function(e,t){e.exports=__kbnSharedDeps__.MomentTimezone},function(e,t){e.exports=__kbnSharedDeps__.Moment},function(e,t){e.exports=__kbnSharedDeps__.KbnMonaco},function(e,t){e.exports=__kbnSharedDeps__.KbnEsQuery},function(e,t,n){n.r(t);var i=__kbnBundles__.get("plugin/charts/public");Object.defineProperties(t,Object.getOwnPropertyDescriptors(i))},function(e,t){e.exports=__kbnSharedDeps__.KbnI18nReact}]);