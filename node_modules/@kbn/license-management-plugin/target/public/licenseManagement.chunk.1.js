/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.licenseManagement_bundle_jsonpfunction=window.licenseManagement_bundle_jsonpfunction||[]).push([[1],Array(32).concat([function(e,t,s){"use strict";t.__esModule=!0;var n=l(s(54));t.combineActions=n.default;var a=l(s(39));t.createAction=a.default;var i=l(s(57));t.createActions=i.default;var r=l(s(66));t.createCurriedAction=r.default;var o=l(s(49));t.handleAction=o.default;var c=l(s(69));function l(e){return e&&e.__esModule?e:{default:e}}t.handleActions=c.default},function(e,t,s){e.exports=s(7)(3)},function(e,t,s){"use strict";e.exports=function(e,t,s,n,a,i,r,o){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[s,n,a,i,r,o],u=0;(c=new Error(t.replace(/%s/g,(function(){return l[u++]})))).name="Invariant Violation"}throw c.framesToPop=1,c}}},function(e,t,s){"use strict";t.__esModule=!0,t.ACTION_TYPE_DELIMITER=t.DEFAULT_NAMESPACE=void 0,t.DEFAULT_NAMESPACE="/",t.ACTION_TYPE_DELIMITER="||"},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return"function"==typeof e}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return"undefined"!=typeof Map&&e instanceof Map}},function(e,t,s){"use strict";t.__esModule=!0,t.default=function(e,t,s){void 0===t&&(t=i.default),(0,n.default)((0,a.default)(t)||(0,r.default)(t),"Expected payloadCreator to be a function, undefined or null");var o=(0,r.default)(t)||t===i.default?i.default:function(e){for(var s=arguments.length,n=new Array(s>1?s-1:0),a=1;a<s;a++)n[a-1]=arguments[a];return e instanceof Error?e:t.apply(void 0,[e].concat(n))},c=(0,a.default)(s),l=e.toString(),u=function(){var t=o.apply(void 0,arguments),n={type:e};return t instanceof Error&&(n.error=!0),void 0!==t&&(n.payload=t),c&&(n.meta=s.apply(void 0,arguments)),n};return u.toString=function(){return l},u};var n=o(s(34)),a=o(s(37)),i=o(s(40)),r=o(s(56));function o(e){return e&&e.__esModule?e:{default:e}}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return e}},function(e,t,s){"use strict";t.__esModule=!0,t.default=function(e){if((0,a.default)(e))return Array.from(e.keys());if("undefined"!=typeof Reflect&&"function"==typeof Reflect.ownKeys)return Reflect.ownKeys(e);var t=Object.getOwnPropertyNames(e);return"function"==typeof Object.getOwnPropertySymbols&&(t=t.concat(Object.getOwnPropertySymbols(e))),t};var n,a=(n=s(38))&&n.__esModule?n:{default:n}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return 0===e.length}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return e.toString()}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return"string"==typeof e}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return null==e}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0;var n,a=(n=s(60))&&n.__esModule?n:{default:n};t.default=function(e){return-1===e.indexOf("/")?(0,a.default)(e):e.split("/").map(a.default).join("/")}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0;var n=s(35),a=r(s(41)),i=r(s(48));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){return function t(s,r,o,c){var l=void 0===r?{}:r,u=l.namespace,d=void 0===u?n.DEFAULT_NAMESPACE:u,p=l.prefix;return void 0===o&&(o={}),void 0===c&&(c=""),(0,a.default)(s).forEach((function(a){var r=function(e){return c||!p||p&&new RegExp("^"+p+d).test(e)?e:""+p+d+e}(function(e){var t;if(!c)return e;var s=e.toString().split(n.ACTION_TYPE_DELIMITER),a=c.split(n.ACTION_TYPE_DELIMITER);return(t=[]).concat.apply(t,a.map((function(e){return s.map((function(t){return""+e+d+t}))}))).join(n.ACTION_TYPE_DELIMITER)}(a)),l=(0,i.default)(a,s);e(l)?t(l,{namespace:d,prefix:p},o,r):o[r]=l})),o}}},function(e,t,s){"use strict";t.__esModule=!0,t.default=function(e,t){return(0,a.default)(t)?t.get(e):t[e]};var n,a=(n=s(38))&&n.__esModule?n:{default:n}},function(e,t,s){"use strict";t.__esModule=!0,t.default=function(e,t,s){void 0===t&&(t=r.default);var d=(0,l.default)(e).split(u.ACTION_TYPE_DELIMITER);(0,n.default)(!(0,c.default)(s),"defaultState for reducer handling "+d.join(", ")+" should be defined"),(0,n.default)((0,a.default)(t)||(0,i.default)(t),"Expected reducer to be a function or object with next and throw reducers");var p=(0,a.default)(t)?[t,t]:[t.next,t.throw].map((function(e){return(0,o.default)(e)?r.default:e})),f=p[0],j=p[1];return function(e,t){void 0===e&&(e=s);var n=t.type;return n&&-1!==d.indexOf((0,l.default)(n))?(!0===t.error?j:f)(e,t):e}};var n=d(s(34)),a=d(s(37)),i=d(s(36)),r=d(s(40)),o=d(s(45)),c=d(s(68)),l=d(s(43)),u=s(35);function d(e){return e&&e.__esModule?e:{default:e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(23),a=s(51),i=n.__importDefault(s(53));t.default=function(e,t){i.default(e,t,a.isDeepEqual)}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var n=s(23).__importDefault(s(52));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],s=1;s<arguments.length;s++)t[s-1]=arguments[s];return e.removeEventListener.apply(e,t)},t.isDeepEqual=n.default},function(e,t,s){"use strict";e.exports=function e(t,s){if(t===s)return!0;if(t&&s&&"object"==typeof t&&"object"==typeof s){if(t.constructor!==s.constructor)return!1;var n,a,i;if(Array.isArray(t)){if((n=t.length)!=s.length)return!1;for(a=n;0!=a--;)if(!e(t[a],s[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===s.source&&t.flags===s.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===s.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===s.toString();if((n=(i=Object.keys(t)).length)!==Object.keys(s).length)return!1;for(a=n;0!=a--;)if(!Object.prototype.hasOwnProperty.call(s,i[a]))return!1;for(a=n;0!=a--;){var r=i[a];if(!("_owner"===r&&t.$$typeof||e(t[r],s[r])))return!1}return!0}return t!=t&&s!=s}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(16);t.default=function(e,t,s){var a=n.useRef(void 0);a.current&&s(t,a.current)||(a.current=t),n.useEffect(e,a.current)}},function(e,t,s){"use strict";t.__esModule=!0,t.default=function(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];var a;(0,n.default)((a=t,!(0,r.default)(a)&&a.every(d)),"Expected action types to be strings, symbols, or action creators");var i=t.map(o.default).join(l.ACTION_TYPE_DELIMITER);return{toString:function(){return i}}};var n=u(s(34)),a=u(s(37)),i=u(s(55)),r=u(s(42)),o=u(s(43)),c=u(s(44)),l=s(35);function u(e){return e&&e.__esModule?e:{default:e}}function d(e){return(0,c.default)(e)||(0,a.default)(e)||(0,i.default)(e)}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return"symbol"==typeof e||"object"==typeof e&&"[object Symbol]"===Object.prototype.toString.call(e)}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return null===e}},function(e,t,s){"use strict";t.__esModule=!0,t.default=function(e){for(var t=arguments.length,s=new Array(t>1?t-1:0),i=1;i<t;i++)s[i-1]=arguments[i];var r=(0,a.default)((0,u.default)(s))?s.pop():{};return(0,n.default)(s.every(c.default)&&((0,c.default)(e)||(0,a.default)(e)),"Expected optional object followed by string action types"),(0,c.default)(e)?h([e].concat(s),r):x({},function(e,t){var s=M((0,f.default)(e,t));return(0,j.default)(s,t)}(e,r),h(s,r))};var n=m(s(34)),a=m(s(36)),i=m(s(37)),r=m(s(40)),o=m(s(58)),c=m(s(44)),l=m(s(45)),u=m(s(59)),d=m(s(46)),p=m(s(63)),f=m(s(64)),j=m(s(65)),b=m(s(39)),g=s(35);function m(e){return e&&e.__esModule?e:{default:e}}function x(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},n=Object.keys(s);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),n.forEach((function(t){O(e,t,s[t])}))}return e}function O(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function M(e,t){var s=void 0===t?{}:t,a=s.prefix,c=s.namespace,u=void 0===c?g.DEFAULT_NAMESPACE:c;return(0,p.default)(Object.keys(e),(function(t,s){var c,d=e[s];(0,n.default)(function(e){if((0,i.default)(e)||(0,l.default)(e))return!0;if((0,o.default)(e)){var t=e[0],s=void 0===t?r.default:t,n=e[1];return(0,i.default)(s)&&(0,i.default)(n)}return!1}(d),"Expected function, undefined, null, or array with payload and meta functions for "+s);var p=a?""+a+u+s:s,f=(0,o.default)(d)?b.default.apply(void 0,[p].concat(d)):(0,b.default)(p,d);return x({},t,((c={})[s]=f,c))}))}function h(e,t){var s=M((0,p.default)(e,(function(e,t){var s;return x({},e,((s={})[t]=r.default,s))})),t);return(0,p.default)(Object.keys(s),(function(e,t){var n;return x({},e,((n={})[(0,d.default)(t)]=s[t],n))}))}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return Array.isArray(e)}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return e[e.length-1]}},function(e,t,s){var n=s(61);e.exports=function(e){return n(e).replace(/\s(\w)/g,(function(e,t){return t.toUpperCase()}))}},function(e,t,s){var n=s(62);e.exports=function(e){return n(e).replace(/[\W_]+(.|$)/g,(function(e,t){return t?" "+t:""})).trim()}},function(e,t){e.exports=function(e){return s.test(e)?e.toLowerCase():n.test(e)?(function(e){return e.replace(i,(function(e,t){return t?" "+t:""}))}(e)||e).toLowerCase():a.test(e)?function(e){return e.replace(r,(function(e,t,s){return t+" "+s.toLowerCase().split("").join(" ")}))}(e).toLowerCase():e.toLowerCase()};var s=/\s/,n=/(_|-|\.|:)/,a=/([a-z][A-Z]|[A-Z][a-z])/,i=/[\W_]+(.|$)/g,r=/(.)([A-Z]+)/g},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e,t){return e.reduce((function(e,s){return t(e,s)}),{})}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0;var n=a(s(36));function a(e){return e&&e.__esModule?e:{default:e}}var i=(0,a(s(47)).default)(n.default);t.default=i},function(e,t,s){"use strict";t.__esModule=!0,t.default=function(e,t){var s=void 0===t?{}:t,r=s.namespace,o=void 0===r?n.DEFAULT_NAMESPACE:r,c=s.prefix;function l(t,s,n){var r=(0,i.default)(n.shift());(0,a.default)(n)?s[r]=e[t]:(s[r]||(s[r]={}),l(t,s[r],n))}var u={};return Object.getOwnPropertyNames(e).forEach((function(e){var t=c?e.replace(""+c+o,""):e;return l(e,u,t.split(o))})),u};var n=s(35),a=r(s(42)),i=r(s(46));function r(e){return e&&e.__esModule?e:{default:e}}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0;var n=i(s(67)),a=i(s(39));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t){return(0,n.default)((0,a.default)(e,t),t.length)}},function(e,t){e.exports=function(e,t){return function s(){null==t&&(t=e.length);var n=[].slice.call(arguments);return n.length>=t?e.apply(this,n):function(){return s.apply(this,n.concat([].slice.call(arguments)))}}}},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0,t.default=function(e){return void 0===e}},function(e,t,s){"use strict";t.__esModule=!0,t.default=function(e,t,s){void 0===s&&(s={}),(0,a.default)((0,i.default)(e)||(0,r.default)(e),"Expected handlers to be a plain object.");var d=(0,c.default)(e,s),p=(0,o.default)(d).map((function(e){return(0,l.default)(e,(0,u.default)(e,d),t)})),f=n.default.apply(void 0,p.concat([t]));return function(e,s){return void 0===e&&(e=t),f(e,s)}};var n=d(s(70)),a=d(s(34)),i=d(s(36)),r=d(s(38)),o=d(s(41)),c=d(s(71)),l=d(s(49)),u=d(s(48));function d(e){return e&&e.__esModule?e:{default:e}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];var n="function"!=typeof t[t.length-1]&&t.pop(),a=t;if(void 0===n)throw new TypeError("The initial state may not be undefined. If you do not want to set a value for this reducer, you can use null instead of undefined.");return function(e,t){for(var s=arguments.length,i=Array(s>2?s-2:0),r=2;r<s;r++)i[r-2]=arguments[r];var o=void 0===e,c=void 0===t;return o&&c&&n?n:a.reduce((function(e,s){return s.apply(void 0,[e,t].concat(i))}),o&&!c&&n?n:e)}},e.exports=t.default},function(e,t,s){"use strict";t.__esModule=!0,t.default=void 0;var n=r(s(36)),a=r(s(38)),i=r(s(72));function r(e){return e&&e.__esModule?e:{default:e}}var o=(0,r(s(47)).default)((function(e){return((0,n.default)(e)||(0,a.default)(e))&&!(0,i.default)(e)}));t.default=o},function(e,t,s){"use strict";t.__esModule=!0,t.default=function(e){var t=(0,a.default)(e),s=t.every((function(e){return"next"===e||"throw"===e}));return t.length&&t.length<=2&&s};var n,a=(n=s(41))&&n.__esModule?n:{default:n}},function(e,t,s){"use strict";function n(e){return function(t){var s=t.dispatch,n=t.getState;return function(t){return function(a){return"function"==typeof a?a(s,n,e):t(a)}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n();a.withExtraArgument=n;var i=a;t.default=i},function(e,t,s){"use strict";s.r(t),s.d(t,"renderApp",(function(){return qe}));var n=s(16),a=s.n(n),i=s(28),r=s(33),o=s.n(r),c=s(22);const l={services:{}},u=Object(n.createContext)(l);var d=s(50),p=s.n(d),f=s(17);const j=({children:e,component:t,render:s,...i})=>{const r=Object(n.useMemo)((()=>{if(t)return e=>Object(f.jsx)(a.a.Fragment,null,Object(f.jsx)(b,null),Object(f.jsx)(t,e))}),[t]);if(r)return Object(f.jsx)(c.Route,o()({},i,{component:r}));if(s||"function"==typeof e){const t="function"==typeof e?e:s;return Object(f.jsx)(c.Route,o()({},i,{render:e=>Object(f.jsx)(a.a.Fragment,null,Object(f.jsx)(b,null),t(e))}))}return Object(f.jsx)(c.Route,i,Object(f.jsx)(b,null),e)},b=()=>{const{executionContext:e}=Object(n.useContext)(u).services,t=Object(c.useRouteMatch)();return function(e,t){p()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null};var g=s(24);const m=({children:e,...t})=>Object(f.jsx)(c.Router,t,Object(f.jsx)(g.CompatRouter,null,e));var x=s(25);const O=({legacySwitch:e=!0,children:t})=>{const s=Object(c.useRouteMatch)();return e?Object(f.jsx)(c.Switch,null,t):Object(f.jsx)(g.Routes,null,n.Children.map(t,(e=>{if(a.a.isValidElement(e)&&e.type===j){var n;const i=Object(x.replace)(null==e?void 0:e.props.path,s.url+"/",""),r="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(f.jsx)(g.Route,{path:i,element:Object(f.jsx)(a.a.Fragment,null,Object(f.jsx)(b,null),(null==e||null===(n=e.props)||void 0===n?void 0:n.component)&&Object(f.jsx)(e.props.component,null)||r&&r()||t)})}return e})))};var M=s(19),h=s(26),y=s(21);const v=Object(n.createContext)(void 0),E=({children:e,value:t})=>Object(f.jsx)(v.Provider,{value:t},e),T=v.Consumer;var _=s(27),S=s(73),L=s.n(S),k=s(2),w=s(29),A=s(32);const C=Object(A.createAction)("LICENSE_MANAGEMENT_ADD_LICENSE"),I=Object(A.handleActions)({[C]:(e,{payload:t})=>t},{});var D=s(1);const F=Object(A.createAction)("LICENSE_MANAGEMENT_ADD_UPLOAD_ERROR_MESSAGE"),P=Object(A.createAction)("LICENSE_MANAGEMENT_UPLOAD_LICENSE_STATUS"),B=k.i18n.translate("xpack.licenseMgmt.uploadLicense.genericUploadErrorMessage",{defaultMessage:"Error encountered uploading license:"}),N=Object(A.handleActions)({[P]:(e,{payload:t})=>t},{}),R=Object(A.createAction)("LICENSE_MANAGEMENT_START_BASIC_LICENSE_STATUS"),U=Object(A.createAction)("LICENSE_MANAGEMENT_CANCEL_START_BASIC_LICENSE"),Y=Object(A.handleActions)({[R]:(e,{payload:t})=>t,[U]:()=>({})},{}),q=Object(A.handleActions)({[F]:(e,{payload:t})=>t},""),G=Object(A.createAction)("LICENSE_MANAGEMENT_TRIAL_STATUS_LOADED"),z=Object(A.handleActions)({[G]:(e,{payload:t})=>({canStartTrial:t})},{}),$=Object(A.createAction)("LICENSE_MANAGEMENT_PERMISSIONS_LOADING"),H=Object(A.createAction)("LICENSE_MANAGEMENT_PERMISSIONS_SUCCESS"),K=Object(A.createAction)("LICENSE_MANAGEMENT_PERMISSIONS_ERROR"),X=Object(A.handleActions)({[$]:(e,{payload:t})=>({loading:t}),[H]:(e,{payload:t})=>({hasPermission:t}),[K]:(e,{payload:t})=>({error:t})},{});var W=s(30),J=s.n(W);const V=Object(_.combineReducers)({license:I,uploadStatus:N,uploadErrorMessage:q,trialStatus:z,startBasicStatus:Y,permissions:X}),Z=e=>e.permissions.hasPermission,Q=e=>e.permissions.loading,ee=e=>e.permissions.error,te=e=>e.license,se=e=>te(e).type,ne=e=>te(e).expiryDateInMillis,ae=e=>"basic"===se(e)?null:ne(e)?J.a.tz(ne(e),J.a.tz.guess()):null,ie=e=>(new Date).getTime()>ne(e),re=e=>{const{type:t}=te(e);return"trial"===t||(e=>{const t=new Date,s=ae(e);return s&&s.isAfter(t)&&s.diff(t,"days")<=25})(e)||ie(e)},oe=e=>!!e.uploadStatus.acknowledge,ce=e=>!!e.uploadStatus.applying,le=e=>e.uploadStatus.messages,ue=e=>!!e.uploadStatus.invalid,de=e=>e.uploadErrorMessage,pe=e=>{const t=se(e);return e.trialStatus.canStartTrial&&"trial"!==t&&("platinum"!==t&&"enterprise"!==t||ie(e))},fe=e=>{if(e.trialStatus.canStartTrial)return!1;const{type:t}=te(e);return"platinum"!==t&&"enterprise"!==t||ie(e)},je=e=>!!e.startBasicStatus.acknowledge,be=e=>e.startBasicStatus.messages,ge=Object(w.createSelector)(te,(e=>{const t=ae(e);return t?t.format("LLL z"):null}),ie,((e,t,s)=>{const{isActive:n,type:a}=e;return{type:Object(x.capitalize)(a),isExpired:s,expirationDate:t,status:n?k.i18n.translate("xpack.licenseMgmt.licenseDashboard.licenseStatus.activeLicenseStatusText",{defaultMessage:"active"}):k.i18n.translate("xpack.licenseMgmt.licenseDashboard.licenseStatus.inactiveLicenseStatusText",{defaultMessage:"inactive"})}})),me=({appDependencies:e,children:t})=>{const{core:s,plugins:n,services:a,store:{initialLicense:i},theme$:r}=e,{http:o,notifications:{toasts:c},i18n:{Context:l}}=s,u=((e={},t={})=>{const s=[Object(_.applyMiddleware)(L.a.withExtraArgument(t))];return window.__REDUX_DEVTOOLS_EXTENSION__&&s.push(window.__REDUX_DEVTOOLS_EXTENSION__()),Object(_.createStore)(V,e,Object(_.compose)(...s))})({license:i},{history:e.services.history,toasts:c,http:o,telemetry:n.telemetry,licensing:n.licensing,breadcrumbService:a.breadcrumbService});return Object(f.jsx)(l,null,Object(f.jsx)(y.KibanaThemeProvider,{theme$:r},Object(f.jsx)(M.Provider,{store:u},Object(f.jsx)(E,{value:e},t))))};var xe=s(20),Oe=s(18),Me=s(0),he=s.n(Me),ye=s(31);class telemetry_opt_in_TelemetryOptIn extends a.a.Component{constructor(...e){super(...e),he()(this,"state",{showMoreTelemetryInfo:!1,showExample:!1}),he()(this,"closeReadMorePopover",(()=>{this.setState({showMoreTelemetryInfo:!1})})),he()(this,"onClickReadMore",(()=>{const{showMoreTelemetryInfo:e}=this.state;this.setState({showMoreTelemetryInfo:!e})})),he()(this,"onClickExample",(()=>{this.setState({showExample:!0}),this.closeReadMorePopover()})),he()(this,"onChangeOptIn",(e=>{const t=e.target.checked,{onOptInChange:s}=this.props;s(t)}))}render(){const{showMoreTelemetryInfo:e,showExample:t}=this.state,{isStartTrial:s,isOptingInToTelemetry:i,telemetry:r}=this.props;let o,c=null;t&&(c=Object(f.jsx)(a.a.Suspense,{fallback:Object(f.jsx)(Oe.EuiLoadingSpinner,null)},Object(f.jsx)(ye.LazyOptInExampleFlyout,{onClose:()=>this.setState({showExample:!1}),fetchExample:r.telemetryService.fetchExample}))),s||(o=Object(f.jsx)(n.Fragment,null,Object(f.jsx)(Oe.EuiSpacer,{size:"s"}),Object(f.jsx)(Oe.EuiTitle,{size:"s"},Object(f.jsx)("h4",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.telemetryOptIn.customersHelpSupportDescription",defaultMessage:"Help Elastic support provide better service"}))),Object(f.jsx)(Oe.EuiSpacer,{size:"s"})));const l=Object(f.jsx)(Oe.EuiLink,{onClick:this.onClickReadMore},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.telemetryOptIn.readMoreLinkText",defaultMessage:"Read more"})),u=Object(f.jsx)(Oe.EuiPopover,{ownFocus:!0,id:"readMorePopover",button:l,isOpen:e,closePopover:this.closeReadMorePopover,className:"eui-AlignBaseline"},Object(f.jsx)(Oe.EuiText,{className:"licManagement__narrowText"},Object(f.jsx)("p",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.telemetryOptIn.featureUsageWarningMessage",defaultMessage:"This feature periodically sends basic feature usage statistics. This information will not be shared outside of Elastic. See an {exampleLink} or read our {telemetryPrivacyStatementLink}. You can disable this feature any time.",values:{exampleLink:Object(f.jsx)(Oe.EuiLink,{onClick:this.onClickExample},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.telemetryOptIn.exampleLinkText",defaultMessage:"example"})),telemetryPrivacyStatementLink:Object(f.jsx)(Oe.EuiLink,{href:r.telemetryConstants.getPrivacyStatementUrl(),target:"_blank"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.telemetryOptIn.telemetryPrivacyStatementLinkText",defaultMessage:"telemetry privacy statement"}))}}))));return Object(f.jsx)(n.Fragment,null,c,o,Object(f.jsx)(Oe.EuiCheckbox,{label:Object(f.jsx)("span",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.telemetryOptIn.sendBasicFeatureStatisticsLabel",defaultMessage:"Send basic feature usage statistics to Elastic periodically. {popover}",values:{popover:u}})),id:"isOptingInToTelemetry",checked:i,onChange:this.onChangeOptIn}))}}function ve(e){if(e){const{telemetryService:t}=e,s=t.getIsOptedIn();return t.getCanChangeOptInStatus()&&!s}return!1}class start_trial_StartTrial extends n.Component{constructor(...e){super(...e),he()(this,"cancelRef",void 0),he()(this,"confirmRef",void 0),he()(this,"state",{showConfirmation:!1,isOptingInToTelemetry:!1}),he()(this,"onOptInChange",(e=>{this.setState({isOptingInToTelemetry:e})})),he()(this,"onStartLicenseTrial",(()=>{const{telemetry:e,startLicenseTrial:t}=this.props;this.state.isOptingInToTelemetry&&e&&e.telemetryService.setOptIn(!0),t()})),he()(this,"cancel",(()=>{this.setState({showConfirmation:!1})}))}UNSAFE_componentWillMount(){this.props.loadTrialStatus()}acknowledgeModal(e){const{showConfirmation:t,isOptingInToTelemetry:s}=this.state,{telemetry:n}=this.props;return t?Object(f.jsx)(Oe.EuiModal,{className:"licManagement__modal",onClose:this.cancel},Object(f.jsx)(Oe.EuiModalHeader,null,Object(f.jsx)(Oe.EuiModalHeaderTitle,{"data-test-subj":"confirmModalTitleText"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalTitle",defaultMessage:"Start your free 30-day trial"}))),Object(f.jsx)(Oe.EuiModalBody,null,Object(f.jsx)(Oe.EuiText,{"data-test-subj":"confirmModalBodyText"},Object(f.jsx)("div",null,Object(f.jsx)(Oe.EuiText,null,Object(f.jsx)("p",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalDescription",defaultMessage:"This trial is for the full set of {subscriptionFeaturesLinkText} of the Elastic Stack. You'll get immediate access to:",values:{subscriptionFeaturesLinkText:Object(f.jsx)(Oe.EuiLink,{href:D.EXTERNAL_LINKS.SUBSCRIPTIONS,target:"_blank"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalDescription.subscriptionFeaturesLinkText",defaultMessage:"subscription features"}))}})),Object(f.jsx)("ul",null,Object(f.jsx)("li",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalDescription.mashingLearningFeatureTitle",defaultMessage:"Machine learning"})),Object(f.jsx)("li",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalDescription.alertingFeatureTitle",defaultMessage:"Alerting"})),Object(f.jsx)("li",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalDescription.graphCapabilitiesFeatureTitle",defaultMessage:"Graph capabilities"})),Object(f.jsx)("li",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalDescription.dataBaseConnectivityFeatureTitle",defaultMessage:"{jdbcStandard} and {odbcStandard} connectivity for {sqlDataBase}",values:{jdbcStandard:"JDBC",odbcStandard:"ODBC",sqlDataBase:"SQL"}}))),Object(f.jsx)("p",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalDescription.securityFeaturesConfigurationDescription",defaultMessage:"Advanced security features, such as authentication ({authenticationTypeList}), field- and document-level security, and auditing, require configuration. See the {securityDocumentationLinkText} for instructions.",values:{authenticationTypeList:"AD/LDAP, SAML, PKI, SAML/SSO",securityDocumentationLinkText:Object(f.jsx)(Oe.EuiLink,{href:e.security,target:"_blank"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalDescription.securityDocumentationLinkText",defaultMessage:"documentation"}))}})),Object(f.jsx)("p",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalDescription.termsAndConditionsDescription",defaultMessage:"By starting this trial, you agree that it is subject to these {termsAndConditionsLinkText}.",values:{termsAndConditionsLinkText:Object(f.jsx)(Oe.EuiLink,{href:D.EXTERNAL_LINKS.TRIAL_LICENSE,target:"_blank"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModalDescription.termsAndConditionsLinkText",defaultMessage:"terms and conditions"}))}})))))),Object(f.jsx)(Oe.EuiModalFooter,null,Object(f.jsx)(Oe.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(f.jsx)(Oe.EuiFlexItem,{grow:!1},ve(n)&&Object(f.jsx)(telemetry_opt_in_TelemetryOptIn,{telemetry:n,isStartTrial:!0,onOptInChange:this.onOptInChange,isOptingInToTelemetry:s})),Object(f.jsx)(Oe.EuiFlexItem,{grow:!1,className:"licManagement__ieFlex"},Object(f.jsx)(Oe.EuiFlexGroup,{responsive:!1},Object(f.jsx)(Oe.EuiFlexItem,{grow:!1,className:"licManagement__ieFlex"},Object(f.jsx)(Oe.EuiButtonEmpty,{"data-test-subj":"confirmModalCancelButton",onClick:this.cancel,buttonRef:this.cancelRef},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(f.jsx)(Oe.EuiFlexItem,{grow:!1,className:"licManagement__ieFlex"},Object(f.jsx)(Oe.EuiButton,{"data-test-subj":"confirmModalConfirmButton",onClick:this.onStartLicenseTrial,fill:!0,buttonRef:this.confirmRef,color:"primary"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.confirmModal.startTrialButtonLabel",defaultMessage:"Start my trial"})))))))):null}render(){const{shouldShowStartTrial:e}=this.props;if(!e)return null;const t=Object(f.jsx)("span",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.subscriptionFeaturesExperienceDescription",defaultMessage:"Experience what machine learning, advanced security, and all our other {subscriptionFeaturesLinkText} have to offer.",values:{subscriptionFeaturesLinkText:Object(f.jsx)(Oe.EuiLink,{href:D.EXTERNAL_LINKS.SUBSCRIPTIONS,target:"_blank"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.subscriptionFeaturesLinkText",defaultMessage:"subscription features"}))}})),s=Object(f.jsx)(Oe.EuiButton,{"data-test-subj":"startTrialButton",onClick:()=>this.setState({showConfirmation:!0})},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrial.startTrialButtonLabel",defaultMessage:"Start trial"}));return Object(f.jsx)(T,null,(e=>Object(f.jsx)(Oe.EuiFlexItem,null,this.acknowledgeModal(e.docLinks),Object(f.jsx)(Oe.EuiCard,{hasBorder:!0,title:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.startTrialTitle",defaultMessage:"Start a 30-day trial"}),description:t,footer:s}))))}}const Ee={loadTrialStatus:()=>async(e,t,{http:s})=>{const n=await function(e){return e.get(`${D.API_BASE_PATH}/start_trial`,{headers:{contentType:"application/json"},cache:"no-cache"})}(s);e(G(n))},startLicenseTrial:()=>async(e,t,{licensing:s,toasts:n,http:a})=>{const{trial_was_started:i,error_message:r}=await function(e){return e.post(`${D.API_BASE_PATH}/start_trial`,{headers:{contentType:"application/json"},cache:"no-cache"})}(a);if(!i)return n.addDanger(r);await s.refresh(),window.location.reload()}},Te=Object(M.connect)((e=>({shouldShowStartTrial:pe(e)})),Ee)(start_trial_StartTrial),_e=({license:e,...t})=>Object(f.jsx)(Oe.EuiPageHeader,o()({},t,{pageTitle:Object(f.jsx)("span",{"data-test-subj":"licenseText"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.licenseStatus.activeLicenseStatusTitle",defaultMessage:"Your {licenseType} license is {status}",values:{licenseType:e.type,status:e.status}})),description:Object(f.jsx)("span",{"data-test-subj":"licenseSubText"},e.expirationDate?Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.licenseStatus.activeLicenseStatusDescription",defaultMessage:"Your license will expire on {licenseExpirationDate}",values:{licenseExpirationDate:Object(f.jsx)("strong",null,e.expirationDate)}}):Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.licenseStatus.permanentActiveLicenseStatusDescription",defaultMessage:"Your license will never expire."}))})),Se=({license:e,...t})=>Object(f.jsx)(Oe.EuiPageHeader,o()({},t,{pageTitle:Object(f.jsx)("span",{"data-test-subj":"licenseText"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.licenseStatus.expiredLicenseStatusTitle",defaultMessage:"Your {licenseType} license has expired",values:{licenseType:e.type}})),description:Object(f.jsx)("span",{"data-test-subj":"licenseSubText"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.licenseStatus.expiredLicenseStatusDescription",defaultMessage:"Your license expired on {licenseExpirationDate}",values:{licenseExpirationDate:Object(f.jsx)("strong",null,e.expirationDate)}}))})),Le=()=>{const e=Object(M.useSelector)(ge);return Object(f.jsx)(a.a.Fragment,null,e.isExpired?Object(f.jsx)(Se,{license:e,bottomBorder:!0,iconType:"warning",iconProps:{color:"danger"}}):Object(f.jsx)(_e,{license:e,bottomBorder:!0,iconType:"checkInCircleFilled",iconProps:{color:"success"}}),Object(f.jsx)(Oe.EuiSpacer,{size:"l"}))},ke=({uploadPath:e="/upload_license"})=>{const{services:t}=(()=>{const e=Object(n.useContext)(v);if(!e)throw new Error('"useAppContext" can only be called inside of AppContext.Provider!');return e})();return Object(f.jsx)(Oe.EuiCard,{hasBorder:!0,title:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.addLicense.updateLicenseTitle",defaultMessage:"Update your license"}),description:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.addLicense.useAvailableLicenseDescription",defaultMessage:"If you already have a new license, upload it now."}),footer:Object(f.jsx)(Oe.EuiButton,o()({"data-test-subj":"updateLicenseButton"},Object(y.reactRouterNavigate)(t.history,e)),Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.addLicense.updateLicenseButtonLabel",defaultMessage:"Update license"}))})};class revert_to_basic_RevertToBasic extends a.a.PureComponent{constructor(...e){super(...e),he()(this,"cancel",(()=>{this.props.uploadLicenseStatus({})}))}acknowledgeModal(){const{needsAcknowledgement:e,messages:[t,...s]=[],startBasicLicense:n,cancelStartBasicLicense:a,licenseType:i}=this.props;return e?Object(f.jsx)(Oe.EuiConfirmModal,{title:k.i18n.translate("xpack.licenseMgmt.licenseDashboard.revertToBasic.confirmModalTitle",{defaultMessage:"Confirm Revert to Basic License"}),onCancel:a,onConfirm:()=>n(i,!0),cancelButtonText:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.revertToBasic.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.revertToBasic.confirmModal.confirmButtonLabel",defaultMessage:"Confirm"})},Object(f.jsx)("div",null,Object(f.jsx)(Oe.EuiText,null,t),Object(f.jsx)(Oe.EuiText,null,Object(f.jsx)("ul",null,s.map((e=>Object(f.jsx)("li",{key:e},e))))))):null}render(){const{licenseType:e,shouldShowRevertToBasicLicense:t,startBasicLicense:s}=this.props;if(!t)return null;const n=Object(f.jsx)("span",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.revertToBasic.revertToFreeFeaturesDescription",defaultMessage:"You’ll revert to our free features and lose access to machine learning, advanced security, and other {subscriptionFeaturesLinkText}.",values:{subscriptionFeaturesLinkText:Object(f.jsx)(Oe.EuiLink,{href:D.EXTERNAL_LINKS.SUBSCRIPTIONS,target:"_blank"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.revertToBasic.subscriptionFeaturesLinkText",defaultMessage:"subscription features"}))}}));return Object(f.jsx)(Oe.EuiFlexItem,null,this.acknowledgeModal(),Object(f.jsx)(Oe.EuiCard,{hasBorder:!0,title:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.revertToBasic.acknowledgeModalTitle",defaultMessage:"Revert to Basic license"}),description:n,footer:Object(f.jsx)(Oe.EuiButton,{"data-test-subj":"revertToBasicButton",onClick:()=>s(e)},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.revertToBasic.acknowledgeModal.revertToBasicButtonLabel",defaultMessage:"Revert to Basic"}))}))}}const we={startBasicLicense:(e,t)=>async(s,n,{licensing:a,toasts:i,http:r})=>{const{acknowledged:o,basic_was_started:c,error_message:l,acknowledge:u}=await function(e,t){return e.post(`${D.API_BASE_PATH}/start_basic`,{query:{acknowledge:t?"true":""},headers:{contentType:"application/json"},body:null,cache:"no-cache"})}(r,t);if(o){if(!c)return i.addDanger(l);await a.refresh(),window.location.reload()}else{const t=Object.values(u).slice(1).map((e=>e[0])),n=k.i18n.translate("xpack.licenseMgmt.replacingCurrentLicenseWithBasicLicenseWarningMessage",{defaultMessage:"Some functionality will be lost if you replace your {currentLicenseType} license with a BASIC license. Review the list of features below.",values:{currentLicenseType:e.toUpperCase()}});s(R({acknowledge:!0,messages:[n,...t]}))}},cancelStartBasicLicense:U},Ae=Object(M.connect)((e=>({shouldShowRevertToBasicLicense:re(e),licenseType:se(e),needsAcknowledgement:je(e),messages:be(e)})),we)(revert_to_basic_RevertToBasic),Ce=Object(M.connect)((e=>({shouldShowRequestTrialExtension:fe(e)})))((({shouldShowRequestTrialExtension:e})=>{if(!e)return null;const t=Object(f.jsx)("span",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.requestTrialExtension.howToContinueUsingPluginsDescription",defaultMessage:"If you’d like to continue using machine learning, advanced security, and our other awesome {subscriptionFeaturesLinkText}, request an extension now.",values:{subscriptionFeaturesLinkText:Object(f.jsx)(Oe.EuiLink,{href:D.EXTERNAL_LINKS.SUBSCRIPTIONS,target:"_blank"},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.requestTrialExtension.subscriptionFeaturesLinkText",defaultMessage:"subscription features"}))}}));return Object(f.jsx)(Oe.EuiFlexItem,null,Object(f.jsx)(Oe.EuiCard,{hasBorder:!0,title:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.requestTrialExtension.extendYourTrialTitle",defaultMessage:"Extend your trial"}),description:t,footer:Object(f.jsx)(Oe.EuiButton,{"data-test-subj":"extendTrialButton",target:"_blank",href:D.EXTERNAL_LINKS.TRIAL_EXTENSION},Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.licenseDashboard.requestTrialExtension.extendTrialButtonLabel",defaultMessage:"Extend trial"}))}))})),Ie=e=>(t,s,{breadcrumbService:n})=>{n.setBreadcrumbs(e)},De={setBreadcrumb:Ie},Fe=Object(M.connect)(null,De)((({setBreadcrumb:e,telemetry:t}={setBreadcrumb:()=>{}})=>(Object(n.useEffect)((()=>{e("dashboard")})),Object(f.jsx)(a.a.Fragment,null,Object(f.jsx)(Le,null),Object(f.jsx)(Oe.EuiPageSection,null,Object(f.jsx)(Oe.EuiFlexGroup,{justifyContent:"spaceAround"},Object(f.jsx)(Oe.EuiFlexItem,null,Object(f.jsx)(ke,null)),Object(f.jsx)(Te,{telemetry:t}),Object(f.jsx)(Ce,null),Object(f.jsx)(Ae,null)))))));class upload_license_UploadLicense extends a.a.PureComponent{constructor(...e){super(...e),he()(this,"state",{isOptingInToTelemetry:!1}),he()(this,"onOptInChange",(e=>{this.setState({isOptingInToTelemetry:e})})),he()(this,"send",(e=>{const t=this.file,s=new FileReader;s.onload=({target:{result:t}})=>{var s;this.state.isOptingInToTelemetry&&(null===(s=this.props.telemetry)||void 0===s||s.telemetryService.setOptIn(!0)),this.props.uploadLicense(t,this.props.currentLicenseType,e)},s.readAsText(t)})),he()(this,"cancel",(()=>{this.props.uploadLicenseStatus({})})),he()(this,"handleFile",(([e])=>{e&&this.props.addUploadErrorMessage(""),this.file=e})),he()(this,"submit",(e=>{e.preventDefault(),this.file?this.send():this.props.addUploadErrorMessage(Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.licenseFileNotSelectedErrorMessage",defaultMessage:"You must select a license file."}))}))}componentDidMount(){this.props.setBreadcrumb("upload"),this.props.addUploadErrorMessage("")}acknowledgeModal(){const{needsAcknowledgement:e,messages:[t,...s]=[]}=this.props;return e?Object(f.jsx)(Oe.EuiConfirmModal,{title:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.confirmModalTitle",defaultMessage:"Confirm License Upload"}),onCancel:this.cancel,onConfirm:()=>this.send(!0),cancelButtonText:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.confirmModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.confirmModal.confirmButtonLabel",defaultMessage:"Confirm"})},Object(f.jsx)("div",null,Object(f.jsx)(Oe.EuiText,null,t),Object(f.jsx)(Oe.EuiText,null,Object(f.jsx)("ul",null,s.map((e=>Object(f.jsx)("li",{key:e},e))))))):null}errorMessage(){const{errorMessage:e}=this.props;return e?[e]:null}render(){const{currentLicenseType:e,applying:t,telemetry:s,history:n}=this.props;return Object(f.jsx)(Oe.EuiPageSection,{alignment:"center",grow:!0},Object(f.jsx)(Oe.EuiPanel,{color:"subdued",paddingSize:"l"},Object(f.jsx)(Oe.EuiTitle,{size:"m"},Object(f.jsx)("h1",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.uploadLicenseTitle",defaultMessage:"Upload your license"}))),Object(f.jsx)(Oe.EuiSpacer,null),this.acknowledgeModal(),Object(f.jsx)(Oe.EuiText,null,Object(f.jsx)("p",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.licenseKeyTypeDescription",defaultMessage:"Your license key is a JSON file with a signature attached."})),Object(f.jsx)("p",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.replacingCurrentLicenseWarningMessage",defaultMessage:"Uploading a license will replace your current {currentLicenseType} license.",values:{currentLicenseType:Object(f.jsx)("strong",null,e.toUpperCase())}}))),Object(f.jsx)(Oe.EuiSpacer,null),Object(f.jsx)(Oe.EuiForm,{isInvalid:!!this.errorMessage(),error:this.errorMessage()},Object(f.jsx)(Oe.EuiFilePicker,{fullWidth:!0,id:"licenseFile",initialPromptText:Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.selectLicenseFileDescription",defaultMessage:"Select or drag your license file"}),onChange:this.handleFile}),Object(f.jsx)(Oe.EuiSpacer,{size:"m"}),ve(s)&&Object(f.jsx)(telemetry_opt_in_TelemetryOptIn,{isOptingInToTelemetry:this.state.isOptingInToTelemetry,onOptInChange:this.onOptInChange,telemetry:s}),Object(f.jsx)(Oe.EuiSpacer,{size:"m"}),Object(f.jsx)(Oe.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(f.jsx)(Oe.EuiFlexItem,{grow:!1},Object(f.jsx)(Oe.EuiButtonEmpty,o()({"data-test-subj":"cancelUploadButton"},Object(y.reactRouterNavigate)(n,"/home")),Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(f.jsx)(Oe.EuiFlexItem,{grow:!1},Object(f.jsx)(Oe.EuiButton,{"data-test-subj":"uploadLicenseButton",fill:!0,isLoading:t,onClick:this.submit},t?Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.uploadingButtonLabel",defaultMessage:"Uploading…"}):Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.uploadLicense.uploadButtonLabel",defaultMessage:"Upload"})))))))}}const Pe={addUploadErrorMessage:F,uploadLicense:(e,t,s)=>async(n,a,i)=>{n(P({applying:!0}));let r=null;try{({type:r}=JSON.parse(e).license)}catch(e){return n(P({})),n(F(k.i18n.translate("xpack.licenseMgmt.uploadLicense.checkLicenseFileErrorMessage",{defaultMessage:"{genericUploadError} Check your license file.",values:{genericUploadError:B}})))}try{const a=await function(e,t,s){return e.put(D.API_BASE_PATH,{query:{acknowledge:s?"true":""},body:t,headers:{contentType:"application/json"},cache:"no-cache"})}(i.http,e,s);await(async(e,t,s,n,{history:a,licensing:i})=>{const{error:r,acknowledged:o,license_status:c,acknowledge:l}=e;if(r)t(P({})),t(F(`${B} ${r.reason}`));else if(o)if("invalid"===c)t(P({})),t(F(k.i18n.translate("xpack.licenseMgmt.uploadLicense.invalidLicenseErrorMessage",{defaultMessage:"The supplied license is not valid for this product."})));else if("expired"===c)t(P({})),t(F(k.i18n.translate("xpack.licenseMgmt.uploadLicense.expiredLicenseErrorMessage",{defaultMessage:"The supplied license has expired."})));else{const e=await i.refresh();t(C(e)),t(P({})),a.replace("/home"),window.location.reload()}else{const e=Object.values(l).slice(1),a=k.i18n.translate("xpack.licenseMgmt.uploadLicense.problemWithUploadedLicenseDescription",{defaultMessage:"Some functionality will be lost if you replace your {currentLicenseType} license with a {newLicenseType} license. Review the list of features below.",values:{currentLicenseType:s.toUpperCase(),newLicenseType:n.toUpperCase()}});t(P({acknowledge:!0,messages:[a,...e]}))}})(a,n,t,r,i)}catch(e){const t=e.responseJSON&&e.responseJSON.error.reason?e.responseJSON.error.reason:k.i18n.translate("xpack.licenseMgmt.uploadLicense.unknownErrorErrorMessage",{defaultMessage:"Unknown error."});n(P({})),n(F(`${B} ${t}`))}},uploadLicenseStatus:P,setBreadcrumb:Ie},Be=Object(M.connect)((e=>({isInvalid:ue(e),needsAcknowledgement:oe(e),messages:le(e),errorMessage:de(e),applying:ce(e),currentLicenseType:se(e)||""})),Pe)(upload_license_UploadLicense);var Ne=s(3);const Re={loadPermissions:()=>async(e,t,{http:s})=>{e($(!0));try{const t=await function(e){return e.post(`${D.API_BASE_PATH}/permissions`,{headers:{contentType:"application/json"},cache:"no-cache"})}(s);e($(!1)),e(H(t.hasPermission))}catch(t){e($(!1)),e(K(t))}}},Ue=Object(c.withRouter)(Object(M.connect)((e=>({hasPermission:Z(e),permissionsLoading:Q(e),permissionsError:ee(e)})),Re)((({hasPermission:e,permissionsLoading:t,permissionsError:s,telemetry:a,loadPermissions:i,executionContext:r})=>{if(Object(y.useExecutionContext)(r,{type:"application",page:"licenseManagement"}),Object(n.useEffect)((()=>{i()}),[i]),t)return Object(f.jsx)(Oe.EuiPageSection,{alignment:"center",grow:!0},Object(f.jsx)(h.SectionLoading,null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.app.loadingPermissionsDescription",defaultMessage:"Checking permissions…"})));if(s){var c;const e=null==s||null===(c=s.data)||void 0===c?void 0:c.message;return Object(f.jsx)(Oe.EuiPageSection,{alignment:"center",grow:!0},Object(f.jsx)(Oe.EuiEmptyPrompt,{color:"danger",iconType:"warning",title:Object(f.jsx)("h1",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.app.checkingPermissionsErrorMessage",defaultMessage:"Error checking permissions"})),body:e?Object(f.jsx)("p",null,e):null}))}if(!e)return Object(f.jsx)(Oe.EuiPageSection,{alignment:"center",grow:!0},Object(f.jsx)(Oe.EuiEmptyPrompt,{color:"subdued",iconType:"securityApp",title:Object(f.jsx)("h1",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.app.deniedPermissionTitle",defaultMessage:"Cluster privileges required"})),body:Object(f.jsx)("p",null,Object(f.jsx)(xe.FormattedMessage,{id:"xpack.licenseMgmt.app.deniedPermissionDescription",defaultMessage:"To use License Management, you must have {permissionType} privileges.",values:{permissionType:Object(f.jsx)("strong",null,D.APP_PERMISSION)}}))}));const l=e=>t=>Object(f.jsx)(e,o()({},t,{telemetry:a}));return Object(f.jsx)(Oe.EuiPageBody,null,Object(f.jsx)(O,null,Object(f.jsx)(j,{path:`/${Ne.b}`,component:l(Be)}),Object(f.jsx)(j,{path:["/"],component:l(Fe)})))}))),Ye=e=>Object(f.jsx)(m,{history:e.history},Object(f.jsx)(Ue,e)),qe=(e,t)=>(Object(i.render)(Object(f.jsx)(me,{appDependencies:t},Object(f.jsx)(Ye,{telemetry:t.plugins.telemetry,history:t.services.history,executionContext:t.core.executionContext})),e),()=>{Object(i.unmountComponentAtNode)(e)})}])]);