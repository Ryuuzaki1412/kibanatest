(window.imageEmbeddable_bundle_jsonpfunction=window.imageEmbeddable_bundle_jsonpfunction||[]).push([[4],{31:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return s}));var i=a(0),l=a(1);const o=Object(i.createContext)(null),s=()=>{const e=Object(i.useContext)(o);if(!e)throw new Error("FilesContext is not found!");return e},n=({client:e,children:t})=>Object(l.jsx)(o.Provider,{value:{client:e}},t)},32:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var i=a(0),l=a(17),o=a(1);const s=Object(i.lazy)((()=>a.e(5).then(a.bind(null,51)))),n=e=>{var t;return Object(o.jsx)(i.Suspense,{fallback:null!==(t=e.lazyLoadFallback)&&void 0!==t?t:Object(o.jsx)(l.EuiLoadingSpinner,{size:"xl"})},Object(o.jsx)(s,e))}},52:function(e,t,a){"use strict";a.r(t),a.d(t,"configureImage",(function(){return h}));var i=a(0),l=a.n(i),o=a(22),s=a(31),n=a(23),d=a(18),r=a(17),u=a(1),c=a(32);const g=Object(i.lazy)((()=>a.e(2).then(a.bind(null,50)))),b=e=>Object(u.jsx)(i.Suspense,{fallback:Object(u.jsx)(r.EuiLoadingSpinner,{size:"xl"})},Object(u.jsx)(g,e));var m=a(2),j=a(21),x=a(7),E=a(19),O=a(33);const f=Object(u.css)({aspectRatio:"21 / 9",width:"100%",height:"auto",maxHeight:"max(20vh, 180px)"},"","");function v(e){var t;const a=!!e.initialImageConfig,{euiTheme:o}=Object(r.useEuiTheme)(),[s,n]=Object(i.useState)((()=>{var t,a;return"file"===(null===(t=e.initialImageConfig)||void 0===t||null===(a=t.src)||void 0===a?void 0:a.type)?e.initialImageConfig.src.fileId:void 0})),[d,g]=Object(i.useState)((()=>{var t,a;return"file"===(null===(t=e.initialImageConfig)||void 0===t||null===(a=t.src)||void 0===a?void 0:a.type)?e.initialImageConfig.src.fileImageMeta:void 0})),[v,p]=Object(i.useState)((()=>{var t,a,i;return null!==(t=null===(a=e.initialImageConfig)||void 0===a||null===(i=a.src)||void 0===i?void 0:i.type)&&void 0!==t?t:"file"})),[h,F]=Object(i.useState)((()=>{var t,a;return"url"===(null===(t=e.initialImageConfig)||void 0===t||null===(a=t.src)||void 0===a?void 0:a.type)?e.initialImageConfig.src.url:""})),[C,M]=Object(i.useState)((()=>{var t,a;return h&&null!==(t=null===(a=e.validateUrl(h))||void 0===a?void 0:a.error)&&void 0!==t?t:null})),[I,S]=Object(i.useState)(!1),[y,k]=Object(i.useState)((()=>{var t,a,i;return null!==(t=null===(a=e.initialImageConfig)||void 0===a||null===(i=a.sizing)||void 0===i?void 0:i.objectFit)&&void 0!==t?t:"contain"})),[T,w]=Object(i.useState)((()=>{var t,a;return null!==(t=null===(a=e.initialImageConfig)||void 0===a?void 0:a.altText)&&void 0!==t?t:""})),[L,U,z]=Object(r.useColorPickerState)(null==e||null===(t=e.initialImageConfig)||void 0===t?void 0:t.backgroundColor),P=!!L&&!!z,B={...e.initialImageConfig,src:"url"===v?{type:"url",url:h}:{type:"file",fileId:s,fileImageMeta:d},altText:T,backgroundColor:z?void 0:L,sizing:{objectFit:y}},R=Object(O.a)(B,{validateUrl:e.validateUrl});return Object(u.jsx)(l.a.Fragment,null,Object(u.jsx)(r.EuiFlyoutHeader,{hasBorder:!0},Object(u.jsx)(r.EuiTitle,{size:"m"},Object(u.jsx)("h2",null,a?Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.editImagetitle",defaultMessage:"Edit image"}):Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.addImagetitle",defaultMessage:"Add image"}))),Object(u.jsx)(r.EuiSpacer,{size:"s"}),Object(u.jsx)(r.EuiTabs,{style:{marginBottom:"-25px"}},Object(u.jsx)(r.EuiTab,{onClick:()=>p("file"),isSelected:"file"===v},Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.uploadTabLabel",defaultMessage:"Upload"})),Object(u.jsx)(r.EuiTab,{onClick:()=>p("url"),isSelected:"url"===v},Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.useLinkTabLabel",defaultMessage:"Use link"})))),Object(u.jsx)(r.EuiFlyoutBody,null,"file"===v&&Object(u.jsx)(l.a.Fragment,null,R?Object(u.jsx)(E.ImageViewer,{css:f,imageConfig:B,onChange:()=>S(!0),onClear:()=>{n(void 0),g(void 0)},containerCSS:Object(u.css)("border:",o.border.thin,";background-color:",o.colors.lightestShade,";","")}):Object(u.jsx)(r.EuiFormRow,{fullWidth:!0,css:Object(u.css)(".lazy-load-fallback,.euiFilePicker__prompt{height:auto;",f,";}.lazy-load-fallback{display:flex;justify-content:center;align-items:center;}","")},Object(u.jsx)(l.a.Fragment,null,Object(u.jsx)(c.a,{kind:x.a.id,onDone:e=>{var t;return n(null===(t=e[0])||void 0===t?void 0:t.id)},immediate:!0,initialPromptText:m.i18n.translate("imageEmbeddable.imageEditor.uploadImagePromptText",{defaultMessage:"Select or drag and drop an image"}),fullWidth:!0,lazyLoadFallback:Object(u.jsx)("div",{className:"lazy-load-fallback"},Object(u.jsx)(r.EuiLoadingSpinner,{size:"xl"}))}),Object(u.jsx)("p",{style:{textAlign:"center"}},Object(u.jsx)(r.EuiLink,{onClick:()=>S(!0),"data-test-subj":"imageEmbeddableEditorSelectFiles"},Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.selectImagePromptText",defaultMessage:"Use a previously uploaded image"})))))),"url"===v&&Object(u.jsx)(l.a.Fragment,null,R?Object(u.jsx)(E.ImageViewer,{css:f,imageConfig:B,onError:()=>{M(m.i18n.translate("imageEmbeddable.imageEditor.urlFailedToLoadImageErrorMessage",{defaultMessage:"Unable to load image."}))},containerCSS:Object(u.css)("border:",o.border.thin,";background-color:",o.colors.lightestShade,";","")}):Object(u.jsx)(r.EuiEmptyPrompt,{css:Object(u.css)("max-width:none;",f," .euiEmptyPrompt__main{height:100%;}",""),iconType:"image",color:"subdued",title:Object(u.jsx)("p",null,Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.byURLNoImageTitle",defaultMessage:"No Image"})),titleSize:"s"}),Object(u.jsx)(r.EuiSpacer,null),Object(u.jsx)(r.EuiFormRow,{label:Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.imageURLInputLabel",defaultMessage:"Link to image"}),helpText:Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.imageURLHelpText",defaultMessage:"Supported file types: png, jpeg, webp, and avif."}),fullWidth:!0,isInvalid:!!C,error:C},Object(u.jsx)(r.EuiTextArea,{"data-test-subj":"imageEmbeddableEditorUrlInput",fullWidth:!0,compressed:!0,placeholder:m.i18n.translate("imageEmbeddable.imageEditor.imageURLPlaceholderText",{defaultMessage:"Example: https://elastic.co/my-image.png"}),value:h,onChange:t=>{const a=t.target.value,{isValid:i,error:l}=e.validateUrl(a);M(i?null:l),F(t.target.value)}}))),Object(u.jsx)(r.EuiSpacer,null),Object(u.jsx)(r.EuiFormRow,{label:Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.imageFillModeLabel",defaultMessage:"Fill mode"}),fullWidth:!0},Object(u.jsx)(r.EuiSelect,{fullWidth:!0,options:[{value:"contain",text:m.i18n.translate("imageEmbeddable.imageEditor.imageFillModeContainOptionText",{defaultMessage:"Fit maintaining aspect ratio"})},{value:"cover",text:m.i18n.translate("imageEmbeddable.imageEditor.imageFillModeCoverOptionText",{defaultMessage:"Fill maintaining aspect ratio"})},{value:"fill",text:m.i18n.translate("imageEmbeddable.imageEditor.imageFillModeFillOptionText",{defaultMessage:"Stretch to fill"})},{value:"none",text:m.i18n.translate("imageEmbeddable.imageEditor.imageFillModeNoneOptionText",{defaultMessage:"Don't resize"})}],value:y,onChange:e=>k(e.target.value)})),Object(u.jsx)(r.EuiSpacer,null),Object(u.jsx)(r.EuiFormRow,{label:Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.imageBackgroundColorLabel",defaultMessage:"Background color"}),fullWidth:!0,isInvalid:P,error:z},Object(u.jsx)(r.EuiColorPicker,{fullWidth:!0,onChange:U,color:L,isInvalid:P,isClearable:!0,placeholder:m.i18n.translate("imageEmbeddable.imageEditor.imageBackgroundColorPlaceholderText",{defaultMessage:"Transparent"})})),Object(u.jsx)(r.EuiSpacer,null),Object(u.jsx)(r.EuiFormRow,{label:Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.imageBackgroundDescriptionLabel",defaultMessage:"Description"}),fullWidth:!0},Object(u.jsx)(r.EuiTextArea,{"data-test-subj":"imageEmbeddableEditorAltInput",fullWidth:!0,compressed:!0,value:T,maxLength:1e3,placeholder:m.i18n.translate("imageEmbeddable.imageEditor.imageAltInputPlaceholderText",{defaultMessage:"Alt text that describes the image"}),onChange:e=>{w(e.target.value)}}))),Object(u.jsx)(r.EuiFlyoutFooter,null,Object(u.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiButtonEmpty,{iconType:"cross",onClick:e.onCancel,flush:"left"},Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.imageBackgroundCloseButtonText",defaultMessage:"Close"}))),Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiButton,{onClick:()=>{R&&e.onSave(B)},fill:!0,isDisabled:!R,"data-test-subj":"imageEmbeddableEditorSave"},Object(u.jsx)(j.FormattedMessage,{id:"imageEmbeddable.imageEditor.imageBackgroundSaveImageButtonText",defaultMessage:"Save"}))))),I&&Object(u.jsx)(b,{kind:x.a.id,shouldAllowDelete:t=>{var a;return!!e.user&&e.user.profile_uid===(null===(a=t.user)||void 0===a?void 0:a.id)},multiple:!1,onClose:()=>{S(!1)},onDone:([e])=>{n(e.id),g(e.meta),S(!1)}}))}var p=a(4);async function h(e,t){return new Promise(((a,i)=>{const l=new d.Subject;e.currentAppId$.pipe(Object(n.takeUntil)(l),Object(n.skip)(1),Object(n.take)(1)).subscribe((()=>{r.close()}));const r=e.overlays.openFlyout(Object(o.toMountPoint)(Object(u.jsx)(s.a,{client:e.files},Object(u.jsx)(p.b.Provider,{value:{getImageDownloadHref:e.getImageDownloadHref,validateUrl:e.validateUrl}},Object(u.jsx)(v,{onCancel:()=>{i(),r.close()},onSave:e=>{a(e),r.close()},initialImageConfig:t,validateUrl:e.validateUrl,user:e.user}))),{theme$:e.theme.theme$}),{ownFocus:!0,"data-test-subj":"createImageEmbeddableFlyout"});r.onClose.then((()=>{l.next(!0)}))}))}}}]);