/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.enterpriseSearch_bundle_jsonpfunction=window.enterpriseSearch_bundle_jsonpfunction||[]).push([[16],{148:function(e,t,a){e.exports=a.p+"ccfbdf9dd2556f3e236cc2c77a775852.svg"},50:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var s=a(15);const n=(e,t)=>Object(s.generatePath)(e,(e=>{const t={};return Object.entries(e).map((([e,a])=>{t[e]=encodeURIComponent(a)})),t})(t)),i=()=>{const e={},t=Object(s.useParams)();return Object.entries(t).map((([t,a])=>{e[t]=decodeURIComponent(a)})),e}},55:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var s=a(37);const n=Object(s.kea)({path:["enterprise_search","licensing_logic"],actions:{setLicense:e=>e,setLicenseSubscription:e=>e},reducers:({props:e})=>({license:[null,{setLicense:(e,t)=>t}],licenseSubscription:[null,{setLicenseSubscription:(e,t)=>t}],canManageLicense:[e.canManageLicense||!1,{}]}),selectors:{hasPlatinumLicense:[e=>[e.license],e=>(null==e?void 0:e.isActive)&&["platinum","enterprise","trial"].includes(null==e?void 0:e.type)],hasGoldLicense:[e=>[e.license],e=>(null==e?void 0:e.isActive)&&["gold","platinum","enterprise","trial"].includes(null==e?void 0:e.type)],isTrial:[e=>[e.license],e=>(null==e?void 0:e.isActive)&&"trial"===(null==e?void 0:e.type)]},events:({props:e,actions:t,values:a})=>({afterMount:()=>{const a=e.license$.subscribe((e=>{t.setLicense(e)}));t.setLicenseSubscription(a)},beforeUnmount:()=>{a.licenseSubscription&&a.licenseSubscription.unsubscribe()}})}),i=e=>(n(e),n.mount());a(47),a(11),a(13),a(2),a(5),a(44),a(12)},69:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));const s=(e,t)=>{if(!e||!t)return!1;const[a,s]=e.split("."),[n,i]=t.split(".");return a!==n||s!==i}},71:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var s=a(11),n=a.n(s),i=a(77),l=a(13),c=a(2),r=a(12);const o=({enterpriseSearchVersion:e,kibanaVersion:t})=>Object(r.jsx)(l.EuiEmptyPrompt,{iconType:"warning",iconColor:"danger",title:Object(r.jsx)("h2",null,c.i18n.translate("xpack.enterpriseSearch.versionMismatch.title",{defaultMessage:"Incompatible version error"})),titleSize:"l",body:Object(r.jsx)(n.a.Fragment,null,c.i18n.translate("xpack.enterpriseSearch.versionMismatch.body",{defaultMessage:"Your Kibana and Enterprise Search versions do not match. To access Enterprise Search, use the same major and minor version for each service."}),Object(r.jsx)(l.EuiSpacer,null),Object(r.jsx)("div",null,c.i18n.translate("xpack.enterpriseSearch.versionMismatch.enterpriseSearchVersionText",{defaultMessage:"Enterprise Search version: {enterpriseSearchVersion}",values:{enterpriseSearchVersion:e}})),Object(r.jsx)("div",null,c.i18n.translate("xpack.enterpriseSearch.versionMismatch.kibanaVersionText",{defaultMessage:"Kibana version: {kibanaVersion}",values:{kibanaVersion:t}})))}),u=e=>Object(r.jsx)(i.a,{isEmptyState:!0},Object(r.jsx)(o,e))},754:function(e,t,a){e.exports=a(7)(3293)},82:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var s=a(37),n=a(41);const i=()=>{const{cloud:e}=Object(s.useValues)(n.a);return{cloudId:null==e?void 0:e.cloudId,deploymentUrl:null==e?void 0:e.deploymentUrl,elasticsearchUrl:null==e?void 0:e.elasticsearchUrl,kibanaUrl:null==e?void 0:e.kibanaUrl}}},98:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return r})),a(11);var s=a(13),n=a(2),i=a(6),l=a(12);let c;!function(e){e.NATIVE_CONNECTOR="nativeConnector",e.CRAWLER="crawler",e.INFERENCE="inference",e.PIPELINES="pipelines",e.SEARCH_APPLICATIONS="searchApplications",e.ANALYTICS="analytics"}(c||(c={}));const r=({feature:e})=>{const t={[c.NATIVE_CONNECTOR]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.nativeConnector.contentOne",{defaultMessage:"Built-in connectors require a Platinum license or higher and are not available to Standard license self-managed deployments. You need to upgrade to use this feature."}),[c.CRAWLER]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.crawler.contentOne",{defaultMessage:"The web crawler requires a Platinum license or higher and is not available to Standard license self-managed deployments. You need to upgrade to use this feature."}),[c.INFERENCE]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.inference.contentOne",{defaultMessage:"Inference processors require a Platinum license or higher and are not available to Standard license self-managed deployments. You need to upgrade to use this feature."}),[c.PIPELINES]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.pipelines.contentOne",{defaultMessage:"Custom pipelines require a Platinum license or higher and are not available to Standard license self-managed deployments. You need to upgrade to use this feature."}),[c.SEARCH_APPLICATIONS]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.searchApplications.contentOne",{defaultMessage:"Search Applications require a Platinum license or higher and are not available to Standard license self-managed deployments. You need to upgrade to use this feature."}),[c.ANALYTICS]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.analytics.contentOne",{defaultMessage:"Behavioral Analytics require a Platinum license or higher and are not available to Standard license self-managed deployments. You need to upgrade to use this feature."})},a={[c.NATIVE_CONNECTOR]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.contentTwo",{defaultMessage:"Did you know that built-in connectors are available with a Standard Elastic Cloud license? Elastic Cloud gives you the flexibility to run where you want. Deploy our managed service on Google Cloud, Microsoft Azure, or Amazon Web Services, and we'll handle the maintenance and upkeep for you."}),[c.CRAWLER]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.crawler.contentTwo",{defaultMessage:"Did you know that web crawlers are available with a Standard Elastic Cloud license? Elastic Cloud gives you the flexibility to run where you want. Deploy our managed service on Google Cloud, Microsoft Azure, or Amazon Web Services, and we'll handle the maintenance and upkeep for you."}),[c.INFERENCE]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.inference.contentTwo",{defaultMessage:"Did you know that inference processors are available with a Standard Elastic Cloud license? Elastic Cloud gives you the flexibility to run where you want. Deploy our managed service on Google Cloud, Microsoft Azure, or Amazon Web Services, and we'll handle the maintenance and upkeep for you."}),[c.PIPELINES]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.pipelines.contentTwo",{defaultMessage:"Did you know that custom pipelines are available with a Standard Elastic Cloud license? Elastic Cloud gives you the flexibility to run where you want. Deploy our managed service on Google Cloud, Microsoft Azure, or Amazon Web Services, and we'll handle the maintenance and upkeep for you."}),[c.SEARCH_APPLICATIONS]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.searchApplications.contentTwo",{defaultMessage:"Did you know that Search Applications are available with a Standard Elastic Cloud license? Elastic Cloud gives you the flexibility to run where you want. Deploy our managed service on Google Cloud, Microsoft Azure, or Amazon Web Services and we'll handle the maintenance and upkeep for you."}),[c.ANALYTICS]:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.analytics.contentTwo",{defaultMessage:"Did you know that Behavioral Analytics are available with a Standard Elastic Cloud license? Elastic Cloud gives you the flexibility to run where you want. Deploy our managed service on Google Cloud, Microsoft Azure, or Amazon Web Services and we'll handle the maintenance and upkeep for you."})};return Object(l.jsx)(s.EuiCallOut,{title:n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.title",{defaultMessage:"Platinum features"})},Object(l.jsx)("p",null,t[e]),Object(l.jsx)("p",null,a[e]),Object(l.jsx)(s.EuiFlexGroup,null,Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)(s.EuiLink,{external:!0,href:i.a.licenseManagement},n.i18n.translate("xpack.enterpriseSearch.workplaceSearch.explorePlatinumFeatures.link",{defaultMessage:"Explore Platinum features"}))),Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)(s.EuiLink,{href:"https://www.elastic.co/subscriptions/cloud",external:!0},n.i18n.translate("xpack.enterpriseSearch.content.licensingCallout.contentCloudTrial",{defaultMessage:"Explore Enterprise Search on Elastic Cloud "})))))}},985:function(e,t,a){"use strict";a.r(t),a.d(t,"Analytics",(function(){return vt}));var s=a(11),n=a.n(s),i=a(54),l=a(69),c=a(71),r=a(15),o=a(37),u=a(13),d=a(2);const p="/collections/:name",m=`${p}/overview`,b=`${p}/integrate`,g=`${p}/explorer`;var h=a(49),j=a(50),y=a(43),x=a(41),f=a(46),O=a(38);const S=Object(f.a)(["analytics","add_analytics_collections_api_logic"],(async({name:e})=>{const{http:t}=O.a.values;return await t.post("/internal/enterprise_search/analytics/collections",{body:JSON.stringify({name:e})})}),{showErrorFlash:!1}),v=new RegExp(/^[a-z0-9\-]+$/),k=Object(o.kea)({actions:{createAnalyticsCollection:()=>{},setInputError:e=>({inputError:e}),setNameValue:e=>({name:e})},connect:{actions:[S,["apiError","apiSuccess","makeRequest"]],values:[S,["status","error"]]},listeners:({values:e,actions:t})=>({apiError:async a=>{var s,n;e.isSystemError?null!=a&&null!==(s=a.body)&&void 0!==s&&s.message?y.b.actions.setFlashMessages([{description:a.body.message,message:d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsCreate.action.systemErrorMessage",{defaultMessage:"Sorry, there was an error creating your collection."}),type:"error"}]):Object(y.e)(a):t.setInputError((null==a||null===(n=a.body)||void 0===n?void 0:n.message)||null)},apiSuccess:async({name:e})=>{Object(y.g)(d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsCreate.action.successMessage",{defaultMessage:"Successfully added collection '{name}'",values:{name:e}})),x.a.values.navigateToUrl(Object(j.a)(m,{name:e}))},createAnalyticsCollection:()=>{const{name:a}=e;t.makeRequest({name:a})},setNameValue:({name:e})=>{v.test(e)||t.setInputError(d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsCreate.invalidName",{defaultMessage:"Collection name can only contain lowercase letters, numbers, and hyphens"}))}}),path:["enterprise_search","analytics","add_analytics_collection"],reducers:{inputError:[null,{setInputError:(e,{inputError:t})=>t,setNameValue:()=>null}],name:["",{setNameValue:(e,{name:t})=>t}]},selectors:({selectors:e})=>({canSubmit:[()=>[e.isLoading,e.name,e.inputError],(e,t,a)=>!e&&t.length>0&&!a],isLoading:[()=>[e.status],e=>e===h.a.LOADING],isSuccess:[()=>[e.status],e=>e===h.a.SUCCESS],isSystemError:[()=>[e.status,e.error],(e,t)=>{var a;return Boolean(e===h.a.ERROR&&((null==t||null===(a=t.body)||void 0===a?void 0:a.statusCode)||0)>=500)}]})});var C=a(12);const E=({formId:e,collectionNameField:t})=>{const{createAnalyticsCollection:a,setNameValue:s}=Object(o.useActions)(k),{name:n,isLoading:i,canSubmit:l,inputError:c}=Object(o.useValues)(k);return Object(C.jsx)(u.EuiForm,{id:e,component:"form",onSubmit:e=>{e.preventDefault(),l&&a()}},Object(C.jsx)(u.EuiFormRow,{label:d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsCreate.form.label",{defaultMessage:"Collection name"}),isInvalid:!!c,error:c},Object(C.jsx)(u.EuiFieldText,{name:t,fullWidth:!0,autoFocus:!0,value:n,isLoading:i,isInvalid:!!c,onChange:e=>{s(e.target.value)}})))},w="collection-name",T=({onClose:e})=>{const{isLoading:t,isSuccess:a,isSystemError:n,canSubmit:i}=Object(o.useValues)(k),l=Object(u.useGeneratedHtmlId)({prefix:"createAnalyticsCollection"});return Object(s.useEffect)((()=>{(a||n)&&e()}),[a,n]),Object(C.jsx)(u.EuiModal,{onClose:e,maxWidth:400,initialFocus:`[name=${w}]`},Object(C.jsx)(u.EuiModalHeader,null,Object(C.jsx)(u.EuiFlexItem,null,Object(C.jsx)(u.EuiModalHeaderTitle,null,d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsCreate.form.title",{defaultMessage:"Name your Collection"})),Object(C.jsx)(u.EuiSpacer,{size:"s"}),Object(C.jsx)(u.EuiText,{size:"s",color:"subdued"},Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsCreate.form.subtitle",{defaultMessage:"Consider carefully what you want to name your Collection. You can't rename it later."}))))),Object(C.jsx)(u.EuiModalBody,null,Object(C.jsx)(E,{formId:l,collectionNameField:w})),Object(C.jsx)(u.EuiModalFooter,null,Object(C.jsx)(u.EuiButtonEmpty,{onClick:e},d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsCreate.form.cancelButton",{defaultMessage:"Cancel"})),Object(C.jsx)(u.EuiButton,{fill:!0,type:"submit",form:l,iconType:"plusInCircle",isLoading:t,isDisabled:!i},d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsCreate.form.createButton",{defaultMessage:"Create"}))))},M=({render:e,disabled:t})=>{const[a,i]=Object(s.useState)(!1),l=()=>i(!0);return Object(C.jsx)(n.a.Fragment,null,e?e(l):Object(C.jsx)(u.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:l,disabled:t,"data-test-subj":"create-analytics-collection-btn"},d.i18n.translate("xpack.enterpriseSearch.analytics.collections.create.buttonTitle",{defaultMessage:"Create collection"})),a&&Object(C.jsx)(T,{onClose:()=>i(!1)}))};var A=a(47),I=a.n(A),V=a(1),R=a(60),F=a(58),L=a(143),N=a(52);const _=({children:e,analyticsName:t,pageChrome:a,pageViewTelemetry:s,...n})=>Object(C.jsx)(F.a,I()({},n,{solutionNav:{items:Object(L.a)(t,t?{explorer:Object(j.a)(g,{name:t}),integration:Object(j.a)(b,{name:t}),overview:Object(j.a)(m,{name:t})}:void 0),name:V.n.NAME},setPageChrome:a&&Object(C.jsx)(R.b,{trail:a})}),s&&Object(C.jsx)(N.b,{action:"viewed",metric:s}),e);var P=a(74);const z=async e=>(await P.a.values.data.dataViews.find(e.events_datastream,1)).find((t=>t.title===e.events_datastream))||await P.a.values.data.dataViews.createAndSave({allowNoIndex:!0,name:`behavioral_analytics.events-${e.name}`,timeFieldName:"@timestamp",title:e.events_datastream},!0),B=Object(f.a)(["analytics","analytics_collection_api_logic"],(async({name:e})=>{const{http:t}=O.a.values,a=`/internal/enterprise_search/analytics/collections/${e}`;return await t.get(a)})),q=Object(o.kea)({actions:{fetchAnalyticsCollection:e=>({name:e})},connect:{actions:[B,["makeRequest","apiSuccess"]],values:[B,["data","status"]]},listeners:({actions:e})=>({fetchAnalyticsCollection:({name:t})=>{e.makeRequest({name:t})}}),path:["enterprise_search","analytics","collection"],selectors:({selectors:e})=>({analyticsCollection:[()=>[e.data],e=>e||null],isLoading:[()=>[e.status],e=>[h.a.LOADING,h.a.IDLE].includes(e)]})}),D=Object(o.kea)({actions:{setDataView:e=>({dataView:e})},connect:{actions:[q,["apiSuccess as fetchedAnalyticsCollection"]]},listeners:({actions:e})=>({fetchedAnalyticsCollection:async t=>{e.setDataView(await z(t))}}),path:["enterprise_search","analytics","collection","dataView"],reducers:()=>({dataView:[null,{setDataView:(e,{dataView:t})=>t}]})});var K=a(33);const G=(e,t)=>{return{regexp:{[e]:{value:(a=t,`.*${a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}.*`)}}};var a},$=e=>({totalCount:{cardinality:{field:e}}}),W=(e,t)=>({size:(e+1)*t}),U=(e,t)=>({aggs:{sort:{bucket_sort:{from:e*t,size:t}}}}),H=(e,t,{search:a,timeRange:s,eventType:n},i)=>({params:{index:e.title,aggs:i,query:{bool:{must:[{range:{"@timestamp":{gte:s.from,lt:s.to}}},...n?[{term:{"event.action":n}}]:[],...a?[G(t,a)]:[]]}},size:0,track_total_hits:!1}});let Y,J;!function(e){e[e.SearchTerms=0]="SearchTerms",e[e.WorsePerformers=1]="WorsePerformers",e[e.Clicked=2]="Clicked",e[e.Referrers=3]="Referrers",e[e.Locations=4]="Locations"}(Y||(Y={})),function(e){e.count="count",e.searchTerms="searchTerms",e.query="query",e.location="location",e.page="page",e.sessions="sessions"}(J||(J={}));const X={from:"now-7d",to:"now"},Q={pause:!0,value:1e4},Z=Object(o.kea)({actions:{onTimeRefresh:!0,setRefreshInterval:({pause:e,value:t})=>({pause:e,value:t}),setSearchSessionId:e=>({searchSessionId:e}),setTimeRange:({from:e,to:t})=>({from:e,to:t})},listeners:({actions:e})=>({onTimeRefresh(){e.setSearchSessionId(P.a.values.data.search.session.start())},setRefreshInterval(t){t.pause&&e.setSearchSessionId(null)},setTimeRange(){e.setSearchSessionId(null)}}),path:["enterprise_search","analytics","collection","toolbar"],reducers:()=>({_searchSessionId:[null,{setSearchSessionId:(e,{searchSessionId:t})=>t}],refreshInterval:[Q,{setRefreshInterval:(e,{pause:t,value:a})=>({pause:t,value:a})}],timeRange:[X,{setTimeRange:(e,{from:t,to:a})=>({...e,from:t,to:a})}]}),selectors:()=>({searchSessionId:[e=>[e._searchSessionId],e=>e||void 0]})}),ee={[Y.SearchTerms]:{parseResponse:e=>{var t,a;return{items:(null===(t=e.rawResponse.aggregations)||void 0===t?void 0:t.searches.buckets.map((e=>({[J.count]:e.doc_count,[J.searchTerms]:e.key}))))||[],totalCount:(null===(a=e.rawResponse.aggregations)||void 0===a?void 0:a.totalCount.value)||0}},requestParams:(e,{timeRange:t,sorting:a,pageIndex:s,pageSize:n,search:i},l="search.query")=>H(e,l,{eventType:"search",search:i,timeRange:t},{searches:{terms:{...W(s,n),field:l,order:a?{[a.field===J.count?"_count":"_key"]:a.direction}:void 0},...U(s,n)},...$(l)})},[Y.WorsePerformers]:{parseResponse:e=>{var t,a;return{items:(null===(t=e.rawResponse.aggregations)||void 0===t?void 0:t.formula.searches.buckets.map((e=>({[J.count]:e.doc_count,[J.query]:e.key}))))||[],totalCount:(null===(a=e.rawResponse.aggregations)||void 0===a?void 0:a.formula.totalCount.value)||0}},requestParams:(e,{timeRange:t,sorting:a,pageIndex:s,pageSize:n,search:i},l="search.query")=>H(e,l,{eventType:"search",search:i,timeRange:t},{formula:{aggs:{...$(l),searches:{terms:{...W(s,n),field:l,order:a?{[(null==a?void 0:a.field)===J.count?"_count":"_key"]:null==a?void 0:a.direction}:void 0},...U(s,n)}},filter:{term:{"search.results.total_results":"0"}}}})},[Y.Clicked]:{parseResponse:e=>{var t,a;return{items:(null===(t=e.rawResponse.aggregations)||void 0===t?void 0:t.formula.searches.buckets.map((e=>({[J.count]:e.doc_count,[J.page]:e.key}))))||[],totalCount:(null===(a=e.rawResponse.aggregations)||void 0===a?void 0:a.formula.totalCount.value)||0}},requestParams:(e,{timeRange:t,sorting:a,pageIndex:s,pageSize:n,search:i},l="page.url.original")=>H(e,l,{eventType:"search_click",search:i,timeRange:t},{formula:{aggs:{...$(l),searches:{terms:{...W(s,n),field:l,order:a?{[a.field===J.count?"_count":"_key"]:a.direction}:void 0},...U(s,n)}},filter:{term:{"event.action":"search_click"}}}})},[Y.Referrers]:{parseResponse:e=>{var t,a;return{items:(null===(t=e.rawResponse.aggregations)||void 0===t?void 0:t.formula.searches.buckets.map((e=>({[J.sessions]:e.doc_count,[J.page]:e.key}))))||[],totalCount:(null===(a=e.rawResponse.aggregations)||void 0===a?void 0:a.formula.totalCount.value)||0}},requestParams:(e,{timeRange:t,sorting:a,pageIndex:s,pageSize:n,search:i},l="page.referrer.original")=>H(e,l,{eventType:"page_view",search:i,timeRange:t},{formula:{aggs:{...$(l),searches:{terms:{...W(s,n),field:l,order:a?{[(null==a?void 0:a.field)===J.sessions?"_count":"_key"]:null==a?void 0:a.direction}:void 0},...U(s,n)}},filter:{term:{"event.action":"page_view"}}}})},[Y.Locations]:{parseResponse:e=>{var t,a;return{items:(null===(t=e.rawResponse.aggregations)||void 0===t?void 0:t.formula.searches.buckets.map((e=>({[J.sessions]:e.doc_count,[J.location]:e.key[0],countryISOCode:e.key[1]}))))||[],totalCount:(null===(a=e.rawResponse.aggregations)||void 0===a?void 0:a.formula.totalCount.value)||0}},requestParams:(e,{timeRange:t,sorting:a,pageIndex:s,pageSize:n,search:i},l="session.location.country_name")=>H(e,l,{search:i,timeRange:t},{formula:{aggs:{...$(l),searches:{multi_terms:{...W(s,n),order:a?{[(null==a?void 0:a.field)===J.sessions?"_count":"_key"]:null==a?void 0:a.direction}:void 0,terms:[{field:l},{field:"session.location.country_iso_code"}]},...U(s,n)}},filter:{term:{"event.action":"page_view"}}}})}},te=Object(o.kea)({actions:{onTableChange:({page:e,sort:t})=>({page:e,sort:t}),reset:!0,setItems:e=>({items:e}),setSearch:e=>({search:e}),setSelectedTable:(e,t)=>({id:e,sorting:t}),setTotalItemsCount:e=>({count:e})},connect:{actions:[Z,["setTimeRange","setSearchSessionId"],D,["setDataView"]],values:[D,["dataView"],Z,["timeRange","searchSessionId"]]},listeners:({actions:e,values:t})=>{const a=()=>{if(null===t.selectedTable||!(t.selectedTable in ee)||!t.dataView)return e.setItems([]),void e.setTotalItemsCount(0);const{requestParams:a,parseResponse:s}=ee[t.selectedTable],n=t.timeRange,i=P.a.values.data.search.search(a(t.dataView,{pageIndex:t.pageIndex,pageSize:t.pageSize,search:t.search,sorting:t.sorting,timeRange:n}),{indexPattern:t.dataView,sessionId:t.searchSessionId}).subscribe({error:e=>{P.a.values.data.search.showError(e)},next:t=>{if(!Object(K.isRunningResponse)(t)){const{items:a,totalCount:n}=s(t);e.setItems(a),e.setTotalItemsCount(n),i.unsubscribe()}}})};return{onTableChange:a,setDataView:a,setSearch:async(e,t)=>{await t(200),a()},setSearchSessionId:a,setSelectedTable:a,setTimeRange:a}},path:["enterprise_search","analytics","collection","explore","table"],reducers:()=>({isLoading:[!1,{onTableChange:()=>!0,setItems:()=>!1,setSearch:()=>!0,setSearchSessionId:()=>!0,setSelectedTable:()=>!0,setTableState:()=>!0,setTimeRange:()=>!0}],items:[[],{setItems:(e,{items:t})=>t}],pageIndex:[0,{onTableChange:(e,{page:t})=>(null==t?void 0:t.index)||0,reset:()=>0,setSearch:()=>0,setSelectedTable:()=>0}],pageSize:[10,{onTableChange:(e,{page:t})=>(null==t?void 0:t.size)||10,reset:()=>10}],search:["",{reset:()=>"",setSearch:(e,{search:t})=>t,setSelectedTable:()=>""}],selectedTable:[null,{setSelectedTable:(e,{id:t})=>t}],sorting:[null,{onTableChange:(e,{sort:t=null})=>t,setSelectedTable:(e,{sorting:t=null})=>t}],totalItemsCount:[0,{setTotalItemsCount:(e,{count:t})=>t}]})});var ae=a(14),se=a(165);const ne=Object(f.a)(["analytics","delete_analytics_collection_api_logic"],(async({name:e})=>{const{http:t}=O.a.values,a=`/internal/enterprise_search/analytics/collections/${e}`;await t.delete(a)}),{showSuccessFlashFn:()=>d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsDelete.action.successMessage",{defaultMessage:"The collection has been successfully deleted"})}),ie=Object(o.kea)({actions:{deleteAnalyticsCollection:e=>({name:e})},connect:{actions:[ne,["makeRequest","apiSuccess"]],values:[ne,["status"]]},listeners:({actions:e})=>({apiSuccess:async(e,t)=>{await t(1e3),x.a.values.navigateToUrl("/")},deleteAnalyticsCollection:({name:t})=>{e.makeRequest({name:t})}}),path:["enterprise_search","analytics","collection","delete"],selectors:({selectors:e})=>({isLoading:[()=>[e.status],e=>[h.a.LOADING,h.a.IDLE].includes(e)]})}),le=()=>{const{application:e}=Object(o.useValues)(x.a),{dataView:t}=Object(o.useValues)(D),{refreshInterval:a,timeRange:s}=Object(o.useValues)(Z);return t?e.getUrlForApp("discover",{path:`#/?_a=(index:'${t.id}')&_g=(filters:!(),refreshInterval:(pause:!${a.pause.toString().charAt(0)},value:${a.value}),time:(from:${s.from},to:${s.to}))`}):null},ce=[{end:"now",label:d.i18n.translate("xpack.enterpriseSearch.analytics..units.quickRange.last7Days",{defaultMessage:"Last 7 days"}),start:"now-7d"},{end:"now",label:d.i18n.translate("xpack.enterpriseSearch.analytics..units.quickRange.last2Weeks",{defaultMessage:"Last 2 weeks"}),start:"now-14d"},{end:"now",label:d.i18n.translate("xpack.enterpriseSearch.analytics..units.quickRange.last30Days",{defaultMessage:"Last 30 days"}),start:"now-30d"},{end:"now",label:d.i18n.translate("xpack.enterpriseSearch.analytics..units.quickRange.last90Days",{defaultMessage:"Last 90 days"}),start:"now-90d"},{end:"now",label:d.i18n.translate("xpack.enterpriseSearch.analytics..units.quickRange.last1Year",{defaultMessage:"Last 1 year"}),start:"now-1y"}],re=()=>{const e=le(),[t,a]=Object(s.useState)(!1),{application:n,navigateToUrl:i}=Object(o.useValues)(x.a),{analyticsCollection:l}=Object(o.useValues)(q),{setTimeRange:c,setRefreshInterval:r,onTimeRefresh:d}=Object(o.useActions)(Z),{refreshInterval:p,timeRange:m}=Object(o.useValues)(Z),{deleteAnalyticsCollection:g}=Object(o.useActions)(ie),{isLoading:h}=Object(o.useValues)(ie),y=n.getUrlForApp("management",{path:"/data/index_management/data_streams/"+l.events_datastream});return Object(C.jsx)(u.EuiFlexGroup,{gutterSize:"m"},Object(C.jsx)(u.EuiFlexItem,{grow:!1},Object(C.jsx)(u.EuiSuperDatePicker,{start:m.from,end:m.to,refreshInterval:p.value,isPaused:p.pause,onTimeChange:({start:e,end:t})=>{c({from:e,to:t})},onRefresh:d,onRefreshChange:({isPaused:e,refreshInterval:t})=>{r({pause:e,value:t})},showUpdateButton:"iconOnly",updateButtonProps:{fill:!1},width:"full",commonlyUsedRanges:ce})),Object(C.jsx)(se.a,{coreStart:{application:n}},Object(C.jsx)(u.EuiFlexItem,{grow:!1},Object(C.jsx)(u.EuiPopover,{button:Object(C.jsx)(u.EuiButton,{iconType:"arrowDown",iconSide:"right",onClick:()=>{a(!t)}},Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collectionsView.manageButton",defaultMessage:"Manage"})),isOpen:t,closePopover:()=>{a(!1)},anchorPosition:"downRight",panelPaddingSize:"none"},Object(C.jsx)(u.EuiContextMenuPanel,null,Object(C.jsx)(u.EuiContextMenuItem,{icon:"link",size:"s","data-telemetry-id":"entSearch-analytics-overview-toolbar-integrate-tracker-link",onClick:()=>i(Object(j.a)(b,{name:l.name}))},Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collectionsView.integrateTracker",defaultMessage:"Integrate JS tracker"})),Object(C.jsx)(u.EuiContextMenuItem,{icon:"database",size:"s",href:y,"data-telemetry-id":"entSearch-analytics-overview-toolbar-manage-datastream-link"},Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collectionsView.manageEventsDatastream",defaultMessage:"Manage events datastream"})),e&&Object(C.jsx)(u.EuiContextMenuItem,{icon:"visArea",href:e,size:"s","data-telemetry-id":"entSearch-analytics-overview-toolbar-manage-discover-link"},Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collectionsView.openInDiscover",defaultMessage:"Create dashboards in Discover"})),Object(C.jsx)(u.EuiPopoverFooter,{paddingSize:"m"},Object(C.jsx)(u.EuiButton,{type:"submit",color:"danger",fullWidth:!0,isLoading:!h,disabled:!h,"data-telemetry-id":"entSearch-analytics-overview-toolbar-delete-collection-button",size:"s",onClick:()=>{g(l.name)}},Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collections.collectionsView.delete.buttonTitle",defaultMessage:"Delete collection"}))))))))},oe=e=>e&&2===e.length?e.toUpperCase().replace(/./g,(e=>String.fromCharCode(55356,56741+e.charCodeAt(0)))):null,ue=()=>{const{application:e}=Object(o.useValues)(x.a),t=le();return t?Object(C.jsx)(u.EuiCallOut,{title:d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.explorer.callout.title",{defaultMessage:"Need a deeper analysis?"}),iconType:"inspect"},Object(C.jsx)("p",null,Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collectionsView.explorer.callout.description",defaultMessage:"Review your event logs in Discover to get more insights about your application metrics."})),Object(C.jsx)(se.a,{coreStart:{application:e}},Object(C.jsx)(u.EuiButton,{fill:!0,href:t,"data-telemetry-id":"entSearch-analytics-explorer-callout-exploreLink"},Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collectionsView.explorer.callout.button",defaultMessage:"Explore"})))):null},de=[{id:Y.SearchTerms,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.explorer.searchTermsTab",{defaultMessage:"Search terms"})},{id:Y.Clicked,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.explorer.topClickedTab",{defaultMessage:"Top clicked results"})},{id:Y.WorsePerformers,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.explorer.noResultsTab",{defaultMessage:"No results"})},{id:Y.Locations,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.explorer.locationsTab",{defaultMessage:"Locations"})},{id:Y.Referrers,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.explorer.referrersTab",{defaultMessage:"Referrers"})}],pe={[Y.SearchTerms]:{columns:[{field:J.searchTerms,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.searchTerms",{defaultMessage:"Search Terms"}),sortable:!0,truncateText:!0},{align:"right",field:J.count,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.count",{defaultMessage:"Count"}),sortable:!0,truncateText:!0}],sorting:{sort:{direction:"desc",field:J.count}}},[Y.WorsePerformers]:{columns:[{field:J.query,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.query",{defaultMessage:"Query"}),sortable:!0,truncateText:!0},{align:"right",field:J.count,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.count",{defaultMessage:"Count"}),sortable:!0,truncateText:!0}],sorting:{sort:{direction:"desc",field:J.count}}},[Y.Clicked]:{columns:[{field:J.page,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.page",{defaultMessage:"Page"}),render:e=>t=>Object(C.jsx)(u.EuiText,{size:"s",color:e.colors.primaryText},Object(C.jsx)("p",null,t)),sortable:!0,truncateText:!0},{align:"right",field:J.count,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.count",{defaultMessage:"Count"}),sortable:!0,truncateText:!0}],sorting:{sort:{direction:"desc",field:J.count}}},[Y.Referrers]:{columns:[{field:J.page,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.page",{defaultMessage:"Page"}),render:e=>t=>Object(C.jsx)(u.EuiText,{size:"s",color:e.colors.primaryText},Object(C.jsx)("p",null,t)),sortable:!0,truncateText:!0},{align:"right",field:J.sessions,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.session",{defaultMessage:"Session"}),sortable:!0,truncateText:!0}],sorting:{sort:{direction:"desc",field:J.sessions}}},[Y.Locations]:{columns:[{field:J.location,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.location",{defaultMessage:"Location"}),render:e=>(t,a)=>Object(C.jsx)(u.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(C.jsx)(u.EuiText,null,Object(C.jsx)("h3",null,oe(a.countryISOCode))),Object(C.jsx)(u.EuiText,{size:"s",color:e.colors.primaryText},Object(C.jsx)("p",null,t))),sortable:!0,truncateText:!0},{align:"right",field:J.sessions,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.session",{defaultMessage:"Session"}),sortable:!0,truncateText:!0}],sorting:{sort:{direction:"desc",field:J.sessions}}}},me=1e4,be=()=>{const{euiTheme:e}=Object(u.useEuiTheme)(),{onTableChange:t,setSelectedTable:a,setSearch:n}=Object(o.useActions)(te),{items:i,isLoading:l,pageIndex:c,pageSize:r,search:p,selectedTable:m,sorting:b,totalItemsCount:g}=Object(o.useValues)(te);let h=null!==m&&pe[m];h&&(h={...h,columns:h.columns.map((t=>{var a;return{...t,render:null===(a=t.render)||void 0===a?void 0:a.call(t,e)}})),sorting:{...h.sorting,sort:b||void 0}});const j=r*c+(i.length?1:0),y=r*c+i.length;return Object(s.useEffect)((()=>{if(!m){var e,t;const s=de[0].id;a(s,null===(e=pe[s])||void 0===e||null===(t=e.sorting)||void 0===t?void 0:t.sort)}}),[]),Object(C.jsx)(u.EuiFlexGroup,{direction:"column",gutterSize:"l"},Object(C.jsx)(u.EuiTabs,null,null==de?void 0:de.map((({id:e,name:t})=>Object(C.jsx)(u.EuiTab,{key:e,onClick:()=>{var t,s;return a(e,null===(t=pe[e])||void 0===t||null===(s=t.sorting)||void 0===s?void 0:s.sort)},isSelected:e===m},t)))),h&&Object(C.jsx)(u.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(C.jsx)(u.EuiFieldSearch,{placeholder:d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.explorer.searchPlaceholder",{defaultMessage:"Search"}),value:p,onChange:e=>n(e.target.value),isClearable:!0,isLoading:l,incremental:!0,fullWidth:!0}),Object(C.jsx)(u.EuiSpacer,{size:"xl"}),Object(C.jsx)(u.EuiText,{size:"xs"},g>me?Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collectionsView.explorer.tableSummaryIndeterminate",defaultMessage:"Showing {items} of first {maxItemsCount} results",values:{items:Object(C.jsx)("strong",null,j,"-",y),maxItemsCount:Object(C.jsx)(u.EuiI18nNumber,{value:me})}}):Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collectionsView.explorer.tableSummary",defaultMessage:"Showing {items} of {totalItemsCount}",values:{items:Object(C.jsx)("strong",null,j,"-",y),totalItemsCount:g}})),Object(C.jsx)(u.EuiSpacer,{size:"m"}),Object(C.jsx)(u.EuiHorizontalRule,{margin:"none"}),Object(C.jsx)(u.EuiBasicTable,{columns:h.columns,itemId:m||void 0,items:i,loading:l,sorting:h.sorting,pagination:{pageIndex:c,pageSize:r,pageSizeOptions:[10,20,50],showPerPageOptions:!0,totalItemCount:Math.min(g,me)},onChange:({sort:e,page:a})=>{t({page:a,sort:e})}})),Object(C.jsx)(ue,null))},ge=({})=>{const{analyticsCollection:e}=Object(o.useValues)(q),{reset:t}=Object(o.useActions)(te);return Object(s.useEffect)((()=>()=>{t()}),[]),Object(C.jsx)(_,{restrictWidth:!0,pageChrome:[null==e?void 0:e.name],analyticsName:null==e?void 0:e.name,pageViewTelemetry:"View Analytics Collection - explorer",pageHeader:{bottomBorder:!1,pageTitle:d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.explorerView.title",{defaultMessage:"Explorer"}),rightSideItems:[Object(C.jsx)(re,null)]}},Object(C.jsx)(be,null))};var he=a(82),je=a(5);const ye=e=>[{title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.stepOne.title",{defaultMessage:"Install client"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,{grow:!1},Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.stepOne.description",{defaultMessage:"Download the behavioral analytics javascript tracker client from NPM."})),Object(C.jsx)(u.EuiCodeBlock,{language:"bash",isCopyable:!0},"npm install @elastic/behavioral-analytics-javascript-tracker")))},{title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.stepTwo.title",{defaultMessage:"Import the client"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,{grow:!1},Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.stepTwo.description",{defaultMessage:"Import the client in your application."})),Object(C.jsx)(u.EuiCodeBlock,{language:"bash",isCopyable:!0},'import {\n  createTracker,\n  trackPageView,\n  trackSearch,\n  trackSearchClick\n} from "@elastic/behavioral-analytics-javascript-tracker";')))},{title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.stepThree.title",{defaultMessage:"Initialize the client"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,{grow:!1},Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.stepThree.description",{defaultMessage:"Use createTracker method to initialize the tracker with your Configuration. You will then be able to use the tracker to send events to Behavioral Analytics."})),Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.stepThree.descriptionTwo",{defaultMessage:"Once you have called createTracker, you can use the tracker methods such as trackPageView to send events to Behavioral Analytics."})),Object(C.jsx)(u.EuiCodeBlock,{language:"javascript",isCopyable:!0},`createTracker({\n  endpoint: "${e.endpoint}",\n  collectionName: "${e.collectionName}",\n  apiKey: "${e.apiKey}"\n});`)))},{title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.stepFour.title",{defaultMessage:"Dispatch Pageview and search behavior events"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,{grow:!1},Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.stepFour.descriptionTwo",{defaultMessage:"Once initialized, you will be able to track page views in your application."})),Object(C.jsx)(u.EuiCodeBlock,{language:"javascript",isCopyable:!0},"import { useEffect } from 'react';\n\n// track a page view in React\n\nconst SearchPage = (props) => {\n  useEffect(() => {\n    trackPageView();\n  }, []);\n\n  return (\n    <div>\n      <h1>Search Page</h1>\n    </div>\n  );\n};"),Object(C.jsx)(u.EuiSpacer,{size:"m"}),Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.stepFour.descriptionThree",{defaultMessage:"You can also use trackSearch and trackSearchClick to track what your customers are searching and clicking on in your application."})),Object(C.jsx)(u.EuiCodeBlock,{language:"javascript",isCopyable:!0},'\nimport { trackSearch } from \'@elastic/behavioral-analytics-javascript-tracker\';\n\nconst SearchResult = ({ hit }) => {\n\n  const clickHandler = () => {\n    trackSearchClick({\n      document: { id: hit.id, index: "products" },\n      page: {\n        url: "http://my-website.com/products/123"\n      },\n      search: {\n        query: "search term",\n        filters: {},\n        page: { current: 1, size: 10 },\n        results: {\n          items: [\n            {\n              document: {\n                id: "123",\n                index: "products",\n              },\n              page: {\n                url: "http://my-website.com/products/123",\n              },\n            },\n          ],\n          total_results: 10\n        },\n        sort: {\n          name: "relevance",\n        },\n        search_application: "website",\n      }\n    })\n  }\n\n  return (\n    <a onClick={clickHandler}>\n      <h2>{hit.title}</h2>\n    </a>\n  )\n}')))}],xe=(e,t)=>[{title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptEmbed.stepOne.title",{defaultMessage:"Embed onto site"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,{grow:!1},Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptEmbed.stepOne.description",{defaultMessage:"Embed the behavioral analytics JavaScript snippet on every page of the website or application youâ€™d like to track."})),Object(C.jsx)(u.EuiCodeBlock,{language:"html",isCopyable:!0},`<script src="${e}"><\/script>`)))},{title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptEmbed.stepTwo.title",{defaultMessage:"Initialize the client"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,{grow:!1},Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptEmbed.stepTwo.description",{defaultMessage:"You must initialize the client before you can track events. We recommend initializing just below the script tag."})),Object(C.jsx)(u.EuiCodeBlock,{language:"html",isCopyable:!0},`<script type="text/javascript">\nwindow.elasticAnalytics.createTracker({\n  endpoint: "${t.endpoint}",\n  collectionName: "${t.collectionName}",\n  apiKey: "${t.apiKey}",\n  // Optional: sampling rate percentage: 0-1, 0 = no events, 1 = all events\n  // sampling: 1,\n});\n<\/script>`)))},{title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptEmbed.stepThree.title",{defaultMessage:"Track search events"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,{grow:!1},Object(C.jsx)("p",null,Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptEmbed.stepThree.description",defaultMessage:"Track individual search events, like result clicks and searches, by using the trackSearch or trackSearchClick methods."})),Object(C.jsx)(u.EuiCodeBlock,{language:"javascript",isCopyable:!0},'window.elasticAnalytics.trackSearch({\n  search: {\n    query: "laptop",\n    filters: {\n      brand: ["apple"],\n      price: ["1000-2000"],\n    },\n    page: {\n      current: 1,\n      size: 10,\n    },\n    results: {\n      items: [\n        {\n          document: {\n            id: "123",\n            index: "products",\n          },\n          page: {\n            url: "http://my-website.com/products/123",\n          },\n        },\n      ],\n      total_results: 100,\n    },\n    sort: {\n      name: "relevance",\n    },\n    search_application: "website",\n  }\n});')))}],fe=e=>[{title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchuiEmbed.stepOne.title",{defaultMessage:"Embed Behavioral Analytics"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,{grow:!1},Object(C.jsx)("p",null,Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchui.stepOne.description",defaultMessage:"Follow the instructions to embed Behavioral Analytics into your site via {embedLink} or {clientLink}.",values:{embedLink:Object(C.jsx)(u.EuiLink,{"data-telemetry-id":"entSearch-analytics-integrate-javascriptEmbed-tab",onClick:()=>{e("javascriptEmbed")}},d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchui.stepOne.embedLink",{defaultMessage:"Javascript Embed"})),clientLink:Object(C.jsx)(u.EuiLink,{"data-telemetry-id":"entSearch-analytics-integrate-javascriptClientEmbed-tab",onClick:()=>{e("javascriptClientEmbed")}},d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchui.stepOne.clientLink",{defaultMessage:"Javascript Client"}))}}))))},{title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchuiEmbed.stepTwo.title",{defaultMessage:"Install Search UI Behavioral Analytics Plugin"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,{grow:!1},Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchui.stepTwo.description",{defaultMessage:"Download the Behavioral Analytics plugin from NPM."})),Object(C.jsx)(u.EuiCodeBlock,{language:"bash",isCopyable:!0},"npm install @elastic/search-ui-analytics-plugin"),Object(C.jsx)(u.EuiSpacer,{size:"m"}),Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchui.stepTwo.importDescription",{defaultMessage:"Then import the Behavioral Analytics plugin into your app."})),Object(C.jsx)(u.EuiCodeBlock,{language:"javascript",isCopyable:!0},'import AnalyticsPlugin from "@elastic/search-ui-analytics-plugin";'),Object(C.jsx)(u.EuiSpacer,{size:"m"}),Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchui.stepTwo.setupDescription",{defaultMessage:"Finally, add the plugin to your Search UI configuration. Depending on how you have embedded Behavioral Analytics, you may need to pass in the client. The example below shows how to pass in the client when using the Javascript client."})),Object(C.jsx)(u.EuiCodeBlock,{language:"javascript",isCopyable:!0},'\nimport { getTracker } from "@elastic/behavioral-analytics-javascript-tracker";\n\nconst searchUIConfig = {\n...\nplugins: [\n  AnalyticsPlugin({\n    client: getTracker()\n  })\n],\n...\n}'),Object(C.jsx)(u.EuiSpacer,{size:"m"}),Object(C.jsx)("p",null,Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchui.stepTwo.moreInfoDescription",defaultMessage:"See the {link} for more information on initializing the tracker and firing events.",values:{link:Object(C.jsx)(u.EuiLink,{href:"https://docs.elastic.co/search-ui/api/core/plugins/analytics-plugin",target:"_blank","data-telemetry-id":"entSearch-analytics-integrate-javascriptEmbed-analyticsPluginDocumentationLink"},d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchui.stepTwo.analyticsPluginDoc",{defaultMessage:"Analytics Plugin Documentation"}))}}))))}],Oe=Object(f.a)(["generate_analytics_api_key_logic"],(async({collectionName:e,keyName:t})=>{const a=`/internal/enterprise_search/analytics/collections/${e}/api_key`;return await O.a.values.http.post(a,{body:JSON.stringify({keyName:t})})})),Se=Object(o.kea)({actions:{setKeyName:e=>({keyName:e})},connect:{values:[Oe,["data","status"]]},path:["enterprise_search","analytics","integration","generate_api_key_modal"],reducers:()=>({keyName:["",{setKeyName:(e,{keyName:t})=>t}]}),selectors:({selectors:e})=>({apiKey:[()=>[e.data],e=>{var t;return(null==e||null===(t=e.apiKey)||void 0===t?void 0:t.encoded)||""}],isLoading:[()=>[e.status],e=>e===h.a.LOADING],isSuccess:[()=>[e.status],e=>e===h.a.SUCCESS]})}),ve=({collectionName:e,onClose:t})=>{const{keyName:a,apiKey:i,isLoading:l,isSuccess:c}=Object(o.useValues)(Se),{setKeyName:r}=Object(o.useActions)(Se),{makeRequest:p}=Object(o.useActions)(Oe);return Object(s.useEffect)((()=>{r(`${e} API key`)}),[e]),Object(C.jsx)(u.EuiModal,{onClose:t},Object(C.jsx)(u.EuiModalHeader,null,Object(C.jsx)(u.EuiModalHeaderTitle,null,d.i18n.translate("xpack.enterpriseSearch.content.analytics.api.generateAnalyticsApiKeyModal.title",{defaultMessage:"Create analytics API Key"}))),Object(C.jsx)(u.EuiModalBody,null,Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiPanel,{hasShadow:!1,color:"primary"},Object(C.jsx)(u.EuiFlexGroup,{direction:"column"},Object(C.jsx)(u.EuiFlexItem,null,Object(C.jsx)(u.EuiFlexGroup,{direction:"row",alignItems:"flexEnd"},c?Object(C.jsx)(u.EuiFlexItem,null,Object(C.jsx)(u.EuiFormLabel,null,a),Object(C.jsx)(u.EuiSpacer,{size:"xs"}),Object(C.jsx)(u.EuiFlexGroup,{alignItems:"center"},Object(C.jsx)(u.EuiFlexItem,null,Object(C.jsx)(u.EuiCodeBlock,{"aria-label":a,fontSize:"m",paddingSize:"m",color:"dark",isCopyable:!0},i)),Object(C.jsx)(u.EuiFlexItem,{grow:!1},Object(C.jsx)(u.EuiButtonIcon,{"data-telemetry-id":"entSearchContent-analyticss-api-generateAnalyticsApiKeyModal-csvDownloadButton","aria-label":d.i18n.translate("xpack.enterpriseSearch.content.analytics.api.generateAnalyticsApiKeyModal.csvDownloadButton",{defaultMessage:"Download API key"}),iconType:"download",href:encodeURI(`data:text/csv;charset=utf-8,${i}`),download:`${a}.csv`})))):Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiFlexItem,null,Object(C.jsx)(u.EuiFormRow,{label:"Name your API key",fullWidth:!0},Object(C.jsx)(u.EuiFieldText,{"data-telemetry-id":"entSearchContent-analyticss-api-generateAnalyticsApiKeyModal-editName",fullWidth:!0,placeholder:"Type a name for your API key",onChange:e=>r(e.currentTarget.value),value:a,isLoading:l}))),Object(C.jsx)(u.EuiFlexItem,{grow:!1},Object(C.jsx)(u.EuiButton,{"data-telemetry-id":"entSearchContent-analyticss-api-generateAnalyticsApiKeyModal-generateApiKeyButton","data-test-subj":"generateApiKeyButton",iconSide:"left",iconType:"plusInCircle",fill:!0,onClick:()=>{p({collectionName:e,keyName:a.trim()})},disabled:a.trim().length<=0},d.i18n.translate("xpack.enterpriseSearch.content.analytics.api.generateAnalyticsApiKeyModal.generateButton",{defaultMessage:"Generate key"})))))),Object(C.jsx)(u.EuiFlexItem,null,Object(C.jsx)(u.EuiFlexGroup,{direction:"row"},Object(C.jsx)(u.EuiFlexItem,null,Object(C.jsx)(u.EuiText,{size:"s",color:"#006bb8"},Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.content.analytics.api.generateAnalyticsApiKeyModal.apiKeyWarning",{defaultMessage:"Elastic does not store API keys. Once generated, you'll only be able to view the key one time. Make sure you save it somewhere secure. If you lose access to it you'll need to generate a new API key from this screen."})))))))))),Object(C.jsx)(u.EuiModalFooter,null,i?Object(C.jsx)(u.EuiButton,{"data-telemetry-id":"entSearchContent-analyticss-api-generateAnalyticsApiKeyModal-done",fill:!0,onClick:t},d.i18n.translate("xpack.enterpriseSearch.content.analytics.api.generateAnalyticsApiKeyModal.done",{defaultMessage:"Done"})):Object(C.jsx)(u.EuiButtonEmpty,{"data-telemetry-id":"entSearchContent-analyticss-api-generateAnalyticsApiKeyModal-cancel",onClick:t},d.i18n.translate("xpack.enterpriseSearch.content.analytics.api.generateAnalyticsApiKeyModal.cancel",{defaultMessage:"Cancel"}))))},ke=()=>({title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.corsStep.title",{defaultMessage:"Configure CORS"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,null,Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.integration.corsStep.description",{defaultMessage:"You must configure CORS to allow requests from your website's domain to the Analytics API endpoint. You can do this by adding the following to your Elasticsearch configuration file:"})),Object(C.jsx)(u.EuiCodeBlock,{language:"yaml",isCopyable:!0},'# http.cors.allow-origin: "https://my-website-domain.example"\nhttp.cors.allow-origin: "*"\nhttp.cors.enabled: true\nhttp.cors.allow-credentials: true\nhttp.cors.allow-methods: OPTIONS, POST\nhttp.cors.allow-headers: X-Requested-With, X-Auth-Token, Content-Type, Content-Length, Authorization, Access-Control-Allow-Headers, Accept'),Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.integration.corsStep.descriptionTwo",{defaultMessage:"Alternatively you can use a proxy server to route analytic requests from your website's domain to the Analytics API endpoint which will allow you to avoid configuring CORS."})),Object(C.jsx)(u.EuiLink,{href:je.a.behavioralAnalyticsCORS,"data-telemetry-id":"entSearchContent-analytics-cors-learnMoreLink",external:!0,target:"_blank"},d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.integration.corsStep.learnMoreLink",{defaultMessage:"Learn more about CORS for Behavioral Analytics."})))))}),Ce=({analyticsCollection:e})=>{const[t,a]=Object(s.useState)("javascriptEmbed"),[i,l]=Object(s.useState)(!1),{navigateToUrl:c}=Object(o.useValues)(x.a),{apiKey:r}=Object(o.useValues)(Se),p=Object(he.a)().elasticsearchUrl||"https://localhost:9200",m={apiKey:r||"########",collectionName:null==e?void 0:e.name,endpoint:p},b=[{key:"javascriptEmbed",title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptEmbed.title",{defaultMessage:"Javascript Embed"})},{key:"javascriptClientEmbed",title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.javascriptClientEmbed.title",{defaultMessage:"Javascript Client"})},{key:"searchuiEmbed",title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.integrateTab.searchuiEmbed.title",{defaultMessage:"Search UI"})}],g=((e,t)=>({title:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.apiKey.title",{defaultMessage:"Create an API Key"}),children:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiText,null,Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.integration.apiKeyStep.apiKeyWarning",{defaultMessage:"Elastic does not store API keys. Once generated, you'll only be able to view the key one time. Make sure you save it somewhere secure. If you lose access to it you'll need to generate a new API key from this screen."})," ",Object(C.jsx)(u.EuiLink,{href:je.a.apiKeys,"data-telemetry-id":"entSearchContent-analytics-apiKey-learnMoreLink",external:!0,target:"_blank"},d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.integration.apiKeyStep.learnMoreLink",{defaultMessage:"Learn more about API keys."})))),Object(C.jsx)(u.EuiSpacer,{size:"l"}),Object(C.jsx)(u.EuiFlexGroup,{gutterSize:"s"},Object(C.jsx)(u.EuiFlexItem,{grow:!1},Object(C.jsx)(u.EuiButton,{iconSide:"left",iconType:"plusInCircleFilled",onClick:()=>l(!0),"data-telemetry-id":"entSearchContent-analytics-apiKey-createApiKeyButton"},d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.integration.apiKeyStep.createAPIKeyButton",{defaultMessage:"Create API Key"}))),Object(C.jsx)(u.EuiFlexItem,{grow:!1},Object(C.jsx)(u.EuiButton,{iconSide:"left",iconType:"popout","data-telemetry-id":"entSearchContent-analytics-apiKey-viewKeysButton",onClick:()=>t("/app/management/security/api_keys",{shouldNotCreateHref:!0})},d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.integration.apiKeyStep.viewKeysButton",{defaultMessage:"View Keys"})))))}))(0,c),h={javascriptClientEmbed:[g,ke(),...ye(m)],javascriptEmbed:[g,ke(),...xe("https://cdn.jsdelivr.net/npm/@elastic/behavioral-analytics-browser-tracker@2",m)],searchuiEmbed:fe(a)};return Object(C.jsx)(_,{restrictWidth:!0,pageChrome:[null==e?void 0:e.name],analyticsName:null==e?void 0:e.name,pageViewTelemetry:"View Analytics Collection - integrate",pageHeader:{bottomBorder:!1,pageTitle:d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.integration.title",{defaultMessage:"Tracker Integration"}),description:d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.integration.description",{defaultMessage:"Easily install our tracker on your application or website to receive in-depth analytics data."}),rightSideItems:[]}},Object(C.jsx)(n.a.Fragment,null,i?Object(C.jsx)(ve,{collectionName:e.name,onClose:()=>{l(!1)}}):null,Object(C.jsx)(u.EuiTabs,null,b.map((e=>Object(C.jsx)(u.EuiTab,{key:e.key,onClick:()=>{a(e.key)},isSelected:t===e.key,"data-test-subj":e.key,"data-telemetry-id":`entSearch-analytics-integrate-${e.key}-tab`},e.title)))),Object(C.jsx)(u.EuiSpacer,{size:"xxl"}),Object(C.jsx)(u.EuiSteps,{steps:h[t]})))};let Ee;!function(e){e.Searches="Searches",e.NoResults="NoResults",e.Clicks="Clicks",e.Sessions="Sessions"}(Ee||(Ee={}));const we=(e,t)=>({[Ee.Searches]:"count(search.query, kql='event.action: search'",[Ee.NoResults]:"count(kql='search.results.total_results : 0 and event.action: search'",[Ee.Clicks]:"count(kql='event.action: search_click'",[Ee.Sessions]:"unique_count(session.id"}[e]+(t?`, shift='${t}'`:"")+")"),Te=Object(f.a)(["analytics","analytics_events_exist_api_logic"],(async({indexName:e})=>{const{http:t}=O.a.values,a=`/internal/enterprise_search/analytics/collection/${e}/events/exist`;return await t.get(a)})),Me=Object(o.kea)({actions:{analyticsEventsExist:e=>({indexName:e})},connect:{actions:[Te,["makeRequest","apiSuccess","apiError"]],values:[Te,["status","data"]]},listeners:({actions:e})=>({analyticsEventsExist:({indexName:t})=>{e.makeRequest({indexName:t})}}),path:["enterprise_search","analytics","collection","events_exist"],selectors:({selectors:e})=>({hasEvents:[()=>[e.data],e=>!0===(null==e?void 0:e.exists)],isLoading:[()=>[e.status],e=>e===h.a.LOADING]})}),Ae=({analyticsCollection:e})=>{const{navigateToUrl:t}=Object(o.useValues)(x.a),{analyticsEventsExist:a}=Object(o.useActions)(Me),{hasEvents:n,isLoading:i}=Object(o.useValues)(Me);return Object(s.useEffect)((()=>{a(e.events_datastream)}),[]),n||i?null:Object(C.jsx)(u.EuiCallOut,{color:"primary",iconType:"download",title:d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.noEventsCallout.title",{defaultMessage:"Install our tracker"})},Object(C.jsx)(u.EuiText,null,d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.noEventsCallout.description",{defaultMessage:"Start receiving metric data in this Collection by installing our tracker in your search application."})),Object(C.jsx)(u.EuiSpacer,null),Object(C.jsx)(u.EuiButton,{fill:!0,type:"submit",onClick:()=>t(Object(j.a)(b,{name:e.name}))},d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.noEventsCallout.button",{defaultMessage:"Learn how"})))};var Ie=a(18),Ve=a.n(Ie),Re=a(24),Fe=a(754),Le=a(34),Ne=a.n(Le),_e=a(21),Pe={name:"eivff4",styles:"display:none"};const ze=(e,{dataLoadTransform:t,getAttributes:a,initialValues:i})=>{const l=l=>{const{lens:{EmbeddableComponent:c,stateHelperApi:r}}=Object(o.useValues)(x.a),[d,p]=Object(s.useState)(null),[m,b]=Object(s.useState)(i),[g,h]=Object(s.useState)(null),j=Object(s.useMemo)((()=>d&&g&&a(d,g,l)),[d,g,l]);return Object(s.useEffect)((()=>{(async()=>{p(await z(l.collection))})()}),[l]),Object(s.useEffect)((()=>{(async()=>{const e=await r();h(e.formula)})()}),[]),Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(e,I()({},l,m)),j&&Object(C.jsx)(u.EuiFlexItem,{css:Pe},Object(C.jsx)(c,{id:l.id,timeRange:l.timeRange,attributes:j,searchSessionId:null==l?void 0:l.searchSessionId,onBrushEnd:({range:e})=>{var t;const[a,s]=e;null===(t=l.setTimeRange)||void 0===t||t.call(l,{from:new Date(a).toISOString(),mode:"absolute",to:new Date(s).toISOString()})},onLoad:(e,a)=>{t&&b(t(e,a))}})))};return l.displayName=`withLensDataHOC(${e.displayName||e.name})`,l},Be={data:{},isLoading:!0},qe=Object.values(Ee).map((e=>({formula:we(e),id:e,x:"timeline",y:"values"}))),De=ze((({data:e,timeRange:t,isLoading:a,selectedChart:n,setSelectedChart:i})=>{const[l,c]=Object(s.useState)(e),[r,p]=Object(s.useState)(null),{uiSettings:m,charts:b}=Object(o.useValues)(x.a),g=Ne.a.parse(t.from),h=Ne.a.parse(t.to),j=b.theme.useChartsTheme(),y=b.theme.useChartsBaseTheme(),f=Object(s.useMemo)((()=>[{chartColor:_e.euiThemeVars.euiColorVis0,data:l[Ee.Searches]||[],id:Ee.Searches,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.charts.searches",{defaultMessage:"Searches"})},{chartColor:_e.euiThemeVars.euiColorVis2,data:l[Ee.NoResults]||[],id:Ee.NoResults,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.charts.noResults",{defaultMessage:"No results"})},{chartColor:_e.euiThemeVars.euiColorVis3,data:l[Ee.Clicks]||[],id:Ee.Clicks,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.charts.clicks",{defaultMessage:"Click"})},{chartColor:_e.euiThemeVars.euiColorVis5,data:l[Ee.Sessions]||[],id:Ee.Sessions,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.charts.sessions",{defaultMessage:"Sessions"})}]),[l]);return Object(s.useEffect)((()=>{0!==Object.keys(e).length&&c(e)}),[e]),a&&0===Object.keys(l).length?Object(C.jsx)(u.EuiFlexGroup,{alignItems:"center",justifyContent:"center",css:Object(C.css)({height:490},"","")},Object(C.jsx)(u.EuiLoadingChart,{size:"l"})):Object(C.jsx)(Re.Chart,{size:["100%",490]},Object(C.jsx)(Re.Settings,{theme:j,baseTheme:y,showLegend:!1,onElementClick:e=>{var t;const a=null===(t=e[0][1])||void 0===t?void 0:t.specId;a&&i(a)},onElementOver:e=>{var t;const a=null===(t=e[0][1])||void 0===t?void 0:t.specId;a&&p(a)},onElementOut:()=>p(null),locale:d.i18n.getLocale()}),f.map((({data:e,id:t,name:a,chartColor:s})=>Object(C.jsx)(Re.AreaSeries,{id:t,key:t,name:a,data:e,color:s,xAccessor:0,yAccessors:[1],areaSeriesStyle:{area:{opacity:.2,visible:n===t},line:{opacity:n===t?1:.5,strokeWidth:[r,n].includes(t)?3:1}},yNice:!0,xScaleType:Re.ScaleType.Time,yScaleType:Re.ScaleType.Sqrt,curve:Re.CurveType.CURVE_MONOTONE_X}))),Object(C.jsx)(Re.Axis,{id:"bottom-axis",position:Re.Position.Bottom,tickFormat:g&&h?Object(Fe.niceTimeFormatter)([g.valueOf(),h.valueOf()]):void 0,gridLine:{visible:!0}}),Object(C.jsx)(Re.Axis,{gridLine:{dash:[],visible:!0},hide:!0,id:"left-axis",position:Re.Position.Left}),Object(C.jsx)(Re.Tooltip,{headerFormatter:e=>Ve()(e.value).format(m.get("dateFormat")),maxTooltipItems:1,type:Re.TooltipType.VerticalCursor}))}),{dataLoadTransform:(e,t)=>e||!t?Be:{data:qe.reduce(((e,{id:a,x:s,y:n})=>{var i,l,c;return{...e,[a]:(null===(i=t.tables)||void 0===i||null===(l=i.tables[a])||void 0===l||null===(c=l.rows)||void 0===c?void 0:c.map((e=>[e[s],e[n]])))||[]}}),{}),isLoading:!1},getAttributes:(e,t)=>({references:[{id:e.id,name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},...qe.map((({id:t})=>({id:e.id,name:`indexpattern-datasource-layer-${t}`,type:"index-pattern"})))],state:{datasourceStates:{formBased:{layers:qe.reduce(((a,{id:s,x:n,y:i,formula:l})=>({...a,[s]:t.insertOrReplaceFormulaColumn(i,{formula:l},{columnOrder:[],columns:{[n]:{dataType:"date",isBucketed:!1,label:"Timestamp",operationType:"date_histogram",params:{includeEmptyRows:!0,interval:"auto"},scale:"ordinal",sourceField:null==e?void 0:e.timeFieldName}}},e)})),{})}},filters:[],query:{language:"kuery",query:""},visualization:{axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!1},curveType:"CURVE_MONOTONE_X",fittingFunction:"None",gridlinesVisibilitySettings:{x:!0,yLeft:!0,yRight:!0},layers:qe.map((({id:e,x:t,y:a})=>({accessors:[a],layerId:[e],layerType:"data",seriesType:"area",xAccessor:t,yConfig:[{forAccessor:a}]}))),legend:{isVisible:!1},preferredSeriesType:"area",valueLabels:"hide"}},title:"",visualizationType:"lnsXY"}),initialValues:Be});var Ke;!function(e){e.INCREASE="increase",e.DECREASE="decrease",e.CONSTANT="constant"}(Ke||(Ke={}));var Ge={name:"vabva8",styles:"position:relative;overflow:hidden"};const $e="hitsTotal",We="metrics",Ue="percentage",He={isLoading:!0,metric:null,secondaryMetric:null},Ye=ze((({isLoading:e,isSelected:t,metric:a,name:i,onClick:l,secondaryMetric:c})=>{const{euiTheme:r}=Object(u.useEuiTheme)(),[o,p]=Object(s.useState)(a),[m,b]=Object(s.useState)(c);Object(s.useEffect)((()=>{null!==a&&p(a)}),[a]),Object(s.useEffect)((()=>{null!==c&&b(a)}),[c]);const{icon:g,color:h}=((e,t)=>({[Ke.DECREASE]:{color:_e.euiThemeVars.euiColorVis7,icon:"sortDown"},[Ke.CONSTANT]:{color:e.colors.darkShade,icon:"minus"},[Ke.INCREASE]:{color:_e.euiThemeVars.euiColorVis0,icon:"sortUp"}}[t]))(r,(e=>e>0?Ke.INCREASE:e<0?Ke.DECREASE:Ke.CONSTANT)(m||0));return Object(C.jsx)(u.EuiPanel,{grow:!0,hasBorder:!0,hasShadow:!1,onClick:l,color:t?"primary":"plain",css:t?Object(C.css)("border:1px solid ",r.colors.primary,";position:relative;overflow:hidden;",""):Ge},e&&Object(C.jsx)(u.EuiProgress,{size:"xs",color:"success",position:"absolute"}),Object(C.jsx)(u.EuiFlexGroup,{direction:"column"},Object(C.jsx)(u.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween"},Object(C.jsx)(u.EuiText,{size:"s"},Object(C.jsx)("p",null,i)),Object(C.jsx)(u.EuiText,{size:"s",color:h},Object(C.jsx)("span",null,null===m?d.i18n.translate("xpack.enterpriseSearch.analytics.collection.notAvailableLabel",{defaultMessage:"N/A"}):Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiIcon,{type:g}),m+"%")))),e&&null===o?Object(C.jsx)(u.EuiSkeletonRectangle,{height:r.size.xl,width:"100%"}):Object(C.jsx)(u.EuiText,{color:t?r.colors.primaryText:h},Object(C.jsx)("h2",null,null===o?d.i18n.translate("xpack.enterpriseSearch.analytics.collection.notAvailableLabel",{defaultMessage:"N/A"}):Object(C.jsx)(u.EuiI18nNumber,{value:o})))))}),{dataLoadTransform:(e,t)=>{var a,s,n,i,l,c,r,o,u,d;return e||!t?He:{isLoading:e,metric:null!==(a=null===(s=t.tables)||void 0===s||null===(n=s.tables[We])||void 0===n||null===(i=n.rows)||void 0===i||null===(l=i[0])||void 0===l?void 0:l[$e])&&void 0!==a?a:null,secondaryMetric:null!==(c=null===(r=t.tables)||void 0===r||null===(o=r.tables[We])||void 0===o||null===(u=o.rows)||void 0===u||null===(d=u[0])||void 0===d?void 0:d[Ue])&&void 0!==c?c:null}},getAttributes:(e,t,a)=>{let s=t.insertOrReplaceFormulaColumn(Ue,{formula:`round((${a.getFormula()}/${a.getFormula("previous")}-1) * 100)`},{columnOrder:[],columns:{}},e);return s=t.insertOrReplaceFormulaColumn($e,{formula:a.getFormula()},s,e),{references:[{id:e.id,name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:e.id,name:`indexpattern-datasource-layer-${We}`,type:"index-pattern"}],state:{datasourceStates:{formBased:{layers:{[We]:s}}},filters:[],query:{language:"kuery",query:""},visualization:{layerId:[We],layerType:"data",layers:[],metricAccessor:$e,secondaryMetricAccessor:Ue}},title:"",visualizationType:"lnsMetric"}},initialValues:He}),Je={[Ee.Searches]:[{id:Y.SearchTerms,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTab.searchTerms",{defaultMessage:"Popular search terms"})}],[Ee.NoResults]:[{id:Y.WorsePerformers,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTab.worsePerformers",{defaultMessage:"Worse performers"})}],[Ee.Clicks]:[{id:Y.Clicked,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTab.topClicked",{defaultMessage:"Top clicked results"})}],[Ee.Sessions]:[{id:Y.Locations,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTab.topLocations",{defaultMessage:"Top locations"})},{id:Y.Referrers,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTab.topReferrers",{defaultMessage:"Top referrers"})}]},Xe={[Y.SearchTerms]:{columns:[{field:J.searchTerms,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.searchTerms",{defaultMessage:"Search Terms"}),truncateText:!0},{align:"right",field:J.count,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.count",{defaultMessage:"Count"}),sortable:!0,truncateText:!0}],sorting:{readOnly:!0,sort:{direction:"desc",field:J.count}}},[Y.WorsePerformers]:{columns:[{field:J.query,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.query",{defaultMessage:"Query"}),truncateText:!0},{align:"right",field:J.count,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.count",{defaultMessage:"Count"}),sortable:!0,truncateText:!0}],sorting:{readOnly:!0,sort:{direction:"desc",field:J.count}}},[Y.Clicked]:{columns:[{field:J.page,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.page",{defaultMessage:"Page"}),render:e=>t=>Object(C.jsx)(u.EuiText,{size:"s",color:e.colors.primaryText},Object(C.jsx)("p",null,t)),truncateText:!0},{align:"right",field:J.count,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.count",{defaultMessage:"Count"}),sortable:!0,truncateText:!0}],sorting:{readOnly:!0,sort:{direction:"desc",field:J.count}}},[Y.Referrers]:{columns:[{field:J.page,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.page",{defaultMessage:"Page"}),render:e=>t=>Object(C.jsx)(u.EuiText,{size:"s",color:e.colors.primaryText},Object(C.jsx)("p",null,t)),truncateText:!0},{align:"right",field:J.sessions,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.session",{defaultMessage:"Session"}),sortable:!0,truncateText:!0}],sorting:{readOnly:!0,sort:{direction:"desc",field:J.sessions}}},[Y.Locations]:{columns:[{field:J.location,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.location",{defaultMessage:"Location"}),render:e=>(t,a)=>Object(C.jsx)(u.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(C.jsx)(u.EuiText,null,Object(C.jsx)("h3",null,oe(a.countryISOCode))),Object(C.jsx)(u.EuiText,{size:"s",color:e.colors.primaryText},Object(C.jsx)("p",null,t))),truncateText:!0},{align:"right",field:J.sessions,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.exploreTable.session",{defaultMessage:"Session"}),sortable:!0,truncateText:!0}],sorting:{readOnly:!0,sort:{direction:"desc",field:J.sessions}}}},Qe=({filterBy:e})=>{const{euiTheme:t}=Object(u.useEuiTheme)(),{navigateToUrl:a}=Object(o.useValues)(x.a),{analyticsCollection:n}=Object(o.useValues)(q),{onTableChange:i,setSelectedTable:l}=Object(o.useActions)(te),{items:c,isLoading:r,selectedTable:d,sorting:p}=Object(o.useValues)(te),m=Je[e];return Object(s.useEffect)((()=>{var e,t;const a=m[0].id;l(a,null===(e=Xe[a])||void 0===e||null===(t=e.sorting)||void 0===t?void 0:t.sort)}),[m]),Object(C.jsx)(u.EuiFlexGroup,{direction:"column",gutterSize:"l"},Object(C.jsx)(u.EuiTabs,null,null==m?void 0:m.map((({id:e,name:t})=>Object(C.jsx)(u.EuiTab,{key:e,onClick:()=>{var t,a;return l(e,null===(t=Xe[e])||void 0===t||null===(a=t.sorting)||void 0===a?void 0:a.sort)},isSelected:e===d},t)))),Object(s.useMemo)((()=>{const e=null!==d&&Xe[d];return e&&Object(C.jsx)(u.EuiBasicTable,{columns:e.columns.map((e=>{var a;return{...e,render:null===(a=e.render)||void 0===a?void 0:a.call(e,t)}})),itemId:d,items:c,loading:r,sorting:e.sorting,onChange:({sort:e})=>{i({sort:e})}})}),[d,p,c,r]),Object(C.jsx)(u.EuiFlexGroup,null,Object(C.jsx)(u.EuiButton,{fill:!0,onClick:()=>a(Object(j.a)(g,{name:n.name}))},Object(C.jsx)(ae.FormattedMessage,{id:"xpack.enterpriseSearch.analytics.collections.collectionsView.list.exploreButton",defaultMessage:"Explore all"}))))},Ze=[{id:Ee.Searches,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.charts.searches",{defaultMessage:"Searches"})},{id:Ee.NoResults,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.charts.noResults",{defaultMessage:"No results"})},{id:Ee.Clicks,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.charts.clicks",{defaultMessage:"Click"})},{id:Ee.Sessions,name:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.charts.sessions",{defaultMessage:"Sessions"})}],et=({analyticsCollection:e})=>{const{setTimeRange:t}=Object(o.useActions)(Z),{timeRange:a,searchSessionId:n}=Object(o.useValues)(Z),[i,l]=Object(s.useState)(Ee.Searches);return Object(C.jsx)(_,{restrictWidth:!0,pageChrome:[null==e?void 0:e.name],analyticsName:null==e?void 0:e.name,pageViewTelemetry:"View Analytics Collection - Overview",pageHeader:{bottomBorder:!1,pageTitle:d.i18n.translate("xpack.enterpriseSearch.analytics.collectionsView.title",{defaultMessage:"Overview"}),rightSideItems:[Object(C.jsx)(re,null)]}},Object(C.jsx)(Ae,{analyticsCollection:e}),Object(C.jsx)(u.EuiSpacer,null),Object(C.jsx)(u.EuiFlexGroup,{direction:"column"},Object(C.jsx)(u.EuiFlexGroup,{gutterSize:"m"},Ze.map((({name:t,id:s})=>Object(C.jsx)(Ye,{key:s,id:`analytics-collection-metric-${e.name}-${s}`,isSelected:i===s,name:t,onClick:e=>{var t;null===(t=e.currentTarget)||void 0===t||t.blur(),l(s)},collection:e,timeRange:a,searchSessionId:n,getFormula:we.bind(null,s)})))),Object(C.jsx)(De,{id:"analytics-collection-chart-"+e.name,collection:e,timeRange:a,setTimeRange:t,searchSessionId:n,selectedChart:i,setSelectedChart:l}),Object(C.jsx)(Qe,{filterBy:i})))},tt=()=>{Object(o.useMountedLogic)(Z),Object(o.useMountedLogic)(D);const{fetchAnalyticsCollection:e}=Object(o.useActions)(q),{analyticsCollection:t,isLoading:a}=Object(o.useValues)(q),{name:n}=Object(r.useParams)();return Object(s.useEffect)((()=>{e(n)}),[]),t?Object(C.jsx)(i.c,null,Object(C.jsx)(i.a,{exact:!0,path:m},Object(C.jsx)(et,{analyticsCollection:t})),Object(C.jsx)(i.a,{exact:!0,path:b},Object(C.jsx)(Ce,{analyticsCollection:t})),Object(C.jsx)(i.a,{exact:!0,path:g},Object(C.jsx)(ge,null))):Object(C.jsx)(_,{pageChrome:[],restrictWidth:!0,isLoading:a},Object(C.jsx)(u.EuiEmptyPrompt,{iconType:"search",title:Object(C.jsx)("h2",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.collectionNotFoundState.headingTitle",{defaultMessage:"You may have deleted this analytics collection"})),body:Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.collectionsView.collectionNotFoundState.subHeading",{defaultMessage:"An analytics collection provides a place to store the analytics events for any given search application you are building. Create a new collection to get started."})),actions:[Object(C.jsx)(M,null)]}))};var at,st=a(55),nt=a(98),it=a(27);!function(e){e.INCREASE="increase",e.DECREASE="decrease",e.CONSTANT="constant"}(at||(at={}));const lt="hitsTotal",ct="metrics",rt="percentage",ot="trend",ut="timeline",dt="values",pt={data:[],isLoading:!0,metric:null,secondaryMetric:null},mt=ze((({collection:e,isLoading:t,isCreatedByEngine:a,subtitle:s,data:i,metric:l,secondaryMetric:c})=>{const{euiTheme:r}=Object(u.useEuiTheme)(),{history:p,navigateToUrl:b}=Object(o.useValues)(x.a),g=(e=>({badge:{".euiBadge__text":{color:e.colors.mediumShade},color:e.colors.subduedText,cursor:"inherit"},card:{"& .euiCard__titleAnchor":{alignItems:"start",display:"flex",gap:e.size.s,justifyContent:"space-between"},"&:hover":{"&__text":{color:e.colors.subduedText},".euiBadge":{color:e.colors.text},".euiCard__titleAnchor":{textDecoration:"none !important"}},height:200,overflow:"hidden",position:"relative",width:"100%"},chart:{".euiPanel:hover &":{transform:"scale(1.03)"},bottom:0,left:0,position:"absolute !important",right:0,transition:`transform ${e.animation.normal}`},footer:{position:"relative",zIndex:1},subtitle:{fontWeight:e.font.weight.light,position:"relative",zIndex:1},title:Object(C.css)(Object(u.euiTextTruncate)(),";","")}))(r),h=(e=>e&&e>0?at.INCREASE:e&&e<0?at.DECREASE:at.CONSTANT)(c),y=(e=>({[at.DECREASE]:{area:_e.euiThemeVars.euiColorVis7_behindText,areaOpacity:.2,icon:"sortDown",line:_e.euiThemeVars.euiColorVis7,lineOpacity:.5,text:"#996130"},[at.CONSTANT]:{area:e.colors.mediumShade,areaOpacity:.2,icon:"minus",line:e.colors.mediumShade,lineOpacity:.5,text:e.colors.darkShade},[at.INCREASE]:{area:_e.euiThemeVars.euiColorVis0_behindText,areaOpacity:.2,icon:"sortUp",line:_e.euiThemeVars.euiColorVis0,lineOpacity:.5,text:"#387765"}}))(r)[h],f=Object(j.a)(m,{name:e.name});return Object(C.jsx)(u.EuiCard,{titleSize:"s",titleElement:"h4",title:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)("span",{css:g.title},e.name),a&&Object(C.jsx)(u.EuiBadge,{color:"hollow",iconType:"link",css:g.badge},d.i18n.translate("xpack.enterpriseSearch.analytics.collection.badge",{defaultMessage:"Engine"}))),textAlign:"left",css:g.card,description:Object(C.jsx)("span",{css:g.subtitle},s),href:p.createHref(Object(it.parsePath)(f)),onClick:e=>{null==e||e.preventDefault(),b(f)},footer:t?Object(C.jsx)(u.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},Object(C.jsx)(u.EuiLoadingChart,{size:"m"})):Object(C.jsx)(u.EuiFlexGroup,{direction:"column",gutterSize:"s",alignItems:"flexEnd",justifyContent:"flexEnd",css:g.footer},Object(C.jsx)(u.EuiText,{size:"s",color:y.text},null===c?d.i18n.translate("xpack.enterpriseSearch.analytics.collection.notAvailableLabel",{defaultMessage:"N/A"}):Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiIcon,{type:y.icon}),c,"%")),Object(C.jsx)(u.EuiText,{color:y.text},Object(C.jsx)("h2",null,null===l?d.i18n.translate("xpack.enterpriseSearch.analytics.collection.notAvailableLabel",{defaultMessage:"N/A"}):Object(C.jsx)(u.EuiI18nNumber,{value:l}))))},!t&&(null==i?void 0:i.some((([,e])=>e&&0!==e)))&&Object(C.jsx)(Re.Chart,{size:["100%",130],css:g.chart},Object(C.jsx)(Re.Settings,{theme:{areaSeriesStyle:{area:{fill:y.area,opacity:y.areaOpacity},line:{opacity:y.lineOpacity,stroke:y.line,strokeWidth:2}},chartMargins:{bottom:0,left:0,right:0,top:0}},showLegend:!1,locale:d.i18n.getLocale()}),Object(C.jsx)(Re.Tooltip,{type:"none"}),Object(C.jsx)(Re.AreaSeries,{id:e.name,data:i,xAccessor:0,yAccessors:[1],xScaleType:Re.ScaleType.Time,yScaleType:Re.ScaleType.Linear,curve:Re.CurveType.CURVE_BASIS,yNice:!0})))}),{dataLoadTransform:(e,t)=>{var a,s,n,i,l,c,r,o,u,d,p,m,b;return e||!t?pt:{data:(null===(a=t.tables)||void 0===a||null===(s=a.tables[ot])||void 0===s||null===(n=s.rows)||void 0===n?void 0:n.map((e=>[e[ut],e[dt]])))||[],isLoading:!1,metric:null!==(i=null===(l=t.tables)||void 0===l||null===(c=l.tables[ct])||void 0===c||null===(r=c.rows)||void 0===r||null===(o=r[0])||void 0===o?void 0:o[lt])&&void 0!==i?i:null,secondaryMetric:null!==(u=null===(d=t.tables)||void 0===d||null===(p=d.tables[ct])||void 0===p||null===(m=p.rows)||void 0===m||null===(b=m[0])||void 0===b?void 0:b[rt])&&void 0!==u?u:null}},getAttributes:(e,t,{filterBy:a})=>{let s=t.insertOrReplaceFormulaColumn(rt,{formula:`round(((${we(a)}/${we(a,"previous")})-1) * 100)`,label:" "},{columnOrder:[],columns:{}},e);return s=t.insertOrReplaceFormulaColumn(lt,{formula:we(a),label:" "},s,e),{references:[{id:e.id,name:"indexpattern-datasource-current-indexpattern",type:"index-pattern"},{id:e.id,name:`indexpattern-datasource-layer-${ot}`,type:"index-pattern"},{id:e.id,name:`indexpattern-datasource-layer-${ct}`,type:"index-pattern"}],state:{datasourceStates:{formBased:{layers:{[ot]:t.insertOrReplaceFormulaColumn(dt,{formula:we(a)},{columnOrder:[],columns:{[ut]:{dataType:"date",isBucketed:!1,label:"Timestamp",operationType:"date_histogram",params:{includeEmptyRows:!0,interval:"auto"},scale:"ordinal",sourceField:null==e?void 0:e.timeFieldName}}},e),[ct]:s}}},filters:[],query:{language:"kuery",query:""},visualization:{layerId:[ct],layerType:"data",metricAccessor:lt,secondaryMetricAccessor:rt,trendlineLayerId:ot,trendlineMetricAccessor:dt,trendlineTimeAccessor:ut}},title:"",visualizationType:"lnsMetric"}},initialValues:pt});var bt=a(148),gt=a.n(bt);const ht=({query:e})=>Object(C.jsx)(u.EuiEmptyPrompt,{icon:Object(C.jsx)(u.EuiImage,{size:294,src:gt.a,alt:"icon"}),title:Object(C.jsx)("h2",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.notFound.headingTitle",{defaultMessage:"No results found for â€œ{query}â€",values:{query:e}})),body:Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.notFound.subHeading",{defaultMessage:"Try searching for another term."}))}),jt=[{end:"now",label:d.i18n.translate("xpack.enterpriseSearch.analytics..units.quickRange.last7Days",{defaultMessage:"Last 7 days"}),start:"now-7d"},{end:"now",label:d.i18n.translate("xpack.enterpriseSearch.analytics..units.quickRange.last2Weeks",{defaultMessage:"Last 2 weeks"}),start:"now-14d"},{end:"now",label:d.i18n.translate("xpack.enterpriseSearch.analytics..units.quickRange.last30Days",{defaultMessage:"Last 30 days"}),start:"now-30d"},{end:"now",label:d.i18n.translate("xpack.enterpriseSearch.analytics..units.quickRange.last90Days",{defaultMessage:"Last 90 days"}),start:"now-90d"},{end:"now",label:d.i18n.translate("xpack.enterpriseSearch.analytics..units.quickRange.last1Year",{defaultMessage:"Last 1 year"}),start:"now-1y"}],yt=({collections:e,isSearching:t,onSearch:a})=>{var n;const{euiTheme:i}=Object(u.useEuiTheme)(),l=(e=>({button:{"&.euiButtonGroupButton":{"&:focus-within":{outline:"none !important",textDecoration:"none !important"},height:38}},buttonGroup:{".euiButtonGroup__buttons":{backgroundColor:e.colors.emptyShade,height:40}},newCollection:{background:"none",border:e.border.thin}}))(i),c=Object(s.useMemo)((()=>[{css:[l.button],id:Ee.Searches,label:d.i18n.translate("xpack.enterpriseSearch.analytics.filtering.searches",{defaultMessage:"Searches"})},{css:[l.button],id:Ee.NoResults,label:d.i18n.translate("xpack.enterpriseSearch.analytics.filtering.noResults",{defaultMessage:"No results"})},{css:[l.button],id:Ee.Clicks,label:d.i18n.translate("xpack.enterpriseSearch.analytics.filtering.clicks",{defaultMessage:"Clicks"})},{css:[l.button],id:Ee.Sessions,label:d.i18n.translate("xpack.enterpriseSearch.analytics.filtering.sessions",{defaultMessage:"Sessions"})}]),[l.button]),[r,o]=Object(s.useState)(c[0].id),[p,m]=Object(s.useState)(""),[b,g]=Object(s.useState)({from:jt[0].start,to:jt[0].end}),h=null===(n=c.find((({id:e})=>e===r)))||void 0===n?void 0:n.label;return Object(C.jsx)(u.EuiFlexGroup,{direction:"column"},Object(C.jsx)(u.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},Object(C.jsx)(u.EuiFlexGroup,null,Object(C.jsx)(u.EuiFlexItem,null,Object(C.jsx)(u.EuiFieldSearch,{placeholder:d.i18n.translate("xpack.enterpriseSearch.analytics.searchPlaceholder",{defaultMessage:"Search collection names"}),value:p,onChange:e=>{m(e.target.value)},isLoading:t,onSearch:a,incremental:!0,fullWidth:!0}))),Object(C.jsx)(u.EuiSpacer,null),Object(C.jsx)(u.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(C.jsx)(u.EuiFlexItem,{grow:!1},Object(C.jsx)(u.EuiButtonGroup,{css:l.buttonGroup,onChange:e=>o(e),color:"primary",buttonSize:"compressed",idSelected:r,isFullWidth:!0,options:c,legend:"Filter Collection"})),Object(C.jsx)(u.EuiFlexItem,{grow:!1},Object(C.jsx)(u.EuiSuperDatePicker,{start:b.from,end:b.to,onTimeChange:({start:e,end:t})=>{g({from:e,to:t})},showUpdateButton:!1,width:"full",commonlyUsedRanges:jt})))),e.length?Object(C.jsx)(u.EuiFlexGrid,{columns:3},e.map((e=>Object(C.jsx)(mt,{key:e.name,id:`collection-card-${e.name}`,collection:e,subtitle:h,filterBy:r,timeRange:b})))):Object(C.jsx)(ht,{query:p}),Object(C.jsx)(M,{render:e=>Object(C.jsx)(u.EuiButton,{iconType:"plusInCircleFilled",css:l.newCollection,onClick:e},d.i18n.translate("xpack.enterpriseSearch.analytics.createNewCollection",{defaultMessage:"Create new collection"}))}))},xt=Object(f.a)(["analytics","analytics_collections_api_logic"],(async({query:e=""})=>{const{http:t}=O.a.values;return await t.get("/internal/enterprise_search/analytics/collections",{query:{query:e}})})),ft=Object(o.kea)({actions:{fetchAnalyticsCollections:!0,searchAnalyticsCollections:e=>({query:e})},connect:{actions:[xt,["makeRequest"]],values:[xt,["data","status"]]},listeners:({actions:e})=>({fetchAnalyticsCollections:()=>{e.makeRequest({})},searchAnalyticsCollections:async({query:t},a)=>{t&&await a(200),e.makeRequest({query:t})}}),path:["enterprise_search","analytics","collections"],reducers:{isSearchRequest:[!1,{searchAnalyticsCollections:()=>!0}],searchQuery:["",{searchAnalyticsCollections:(e,{query:t})=>t}]},selectors:({selectors:e})=>({analyticsCollections:[()=>[e.data],e=>e||[]],hasNoAnalyticsCollections:[()=>[e.analyticsCollections,e.searchQuery],(e,t)=>0===e.length&&!t],isFetching:[()=>[e.status,e.isSearchRequest],(e,t)=>[h.a.LOADING,h.a.IDLE].includes(e)&&!t],isSearching:[()=>[e.status,e.isSearchRequest],(e,t)=>h.a.LOADING===e&&t]})}),Ot=()=>Object(C.jsx)(u.EuiEmptyPrompt,{icon:Object(C.jsx)(u.EuiImage,{size:294,src:gt.a,alt:"icon"}),layout:"horizontal",color:"plain",title:Object(C.jsx)("h2",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.emptyState.headingTitle",{defaultMessage:"Create your first Collection"})),body:Object(C.jsx)("p",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.emptyState.subHeading",{defaultMessage:"Collections are required to store analytics events for your search application."})),actions:[Object(C.jsx)(M,null)],footer:Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiTitle,{size:"xxs"},Object(C.jsx)("span",null,d.i18n.translate("xpack.enterpriseSearch.analytics.collections.emptyState.footerText",{defaultMessage:"Want to learn more?"})))," ",Object(C.jsx)(u.EuiLink,{href:je.a.behavioralAnalytics,target:"_blank",external:!0},d.i18n.translate("xpack.enterpriseSearch.analytics.collections.emptyState.footerLink",{defaultMessage:"Read documentation"})))}),St=()=>{const{fetchAnalyticsCollections:e,searchAnalyticsCollections:t}=Object(o.useActions)(ft),{analyticsCollections:a,hasNoAnalyticsCollections:i,isFetching:l,isSearching:c}=Object(o.useValues)(ft),{isCloud:r}=Object(o.useValues)(x.a),{hasPlatinumLicense:p}=Object(o.useValues)(st.a),m=!r&&!p;return Object(s.useEffect)((()=>{m||e()}),[]),Object(C.jsx)(_,{pageChrome:[],restrictWidth:!0,isLoading:l&&!m,pageViewTelemetry:"Analytics Collections Overview",pageHeader:{description:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.pageDescription",{defaultMessage:"Dashboards and tools for visualizing end-user behavior and measuring the performance of your search applications. Track trends over time, identify and investigate anomalies, and make optimizations."}),pageTitle:d.i18n.translate("xpack.enterpriseSearch.analytics.collections.pageTitle",{defaultMessage:"Behavioral Analytics"}),rightSideItems:[Object(C.jsx)(M,{disabled:m})]}},m?Object(C.jsx)(u.EuiFlexItem,null,Object(C.jsx)(nt.b,{feature:nt.a.ANALYTICS})):i&&!c?Object(C.jsx)(n.a.Fragment,null,Object(C.jsx)(u.EuiSpacer,{size:"l"}),Object(C.jsx)(Ot,null)):Object(C.jsx)(yt,{collections:a,isSearching:c,onSearch:t}))},vt=e=>{const{enterpriseSearchVersion:t,kibanaVersion:a}=e,s=Object(l.a)(t,a);return Object(C.jsx)(i.c,null,Object(C.jsx)(i.a,{exact:!0,path:"/"},s?Object(C.jsx)(c.a,{enterpriseSearchVersion:t,kibanaVersion:a}):Object(C.jsx)(St,null)),Object(C.jsx)(i.a,{path:p},Object(C.jsx)(tt,null)))}}}]);