/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.osquery_bundle_jsonpfunction=window.osquery_bundle_jsonpfunction||[]).push([[6],{119:function(e,t,a){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},120:function(e,t,a){e.exports=a.p+"1cbd62546f764080f7071e03889e9de3.svg"},121:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(46),i=a(1),l=s.__importDefault(a(173));t.default=function(e,t){var a=i.useState(t),s=a[0],n=a[1];return l.default((function(){var t=e.subscribe(n);return function(){return t.unsubscribe()}}),[e]),s}},129:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(46),i=a(130),l=s.__importDefault(a(132));t.default=function(e,t){l.default(e,t,i.isDeepEqual)}},130:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var s=a(46).__importDefault(a(131));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=s.default},131:function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var s,i,l;if(Array.isArray(t)){if((s=t.length)!=a.length)return!1;for(i=s;0!=i--;)if(!e(t[i],a[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((s=(l=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(i=s;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,l[i]))return!1;for(i=s;0!=i--;){var n=l[i];if(!("_owner"===n&&t.$$typeof||e(t[n],a[n])))return!1}return!0}return t!=t&&a!=a}},132:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1);t.default=function(e,t,a){var i=s.useRef(void 0);i.current&&a(t,i.current)||(i.current=t),s.useEffect(e,i.current)}},133:function(e,t,a){"use strict";const s=a(134),i=a(135),l=a(136);function n(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function o(e,t){return t.encode?t.strict?s(e):encodeURIComponent(e):e}function r(e,t){return t.decode?i(e):e}function u(e){return Array.isArray(e)?e.sort():"object"==typeof e?u(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function c(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){const t=(e=c(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function b(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function j(e,t){n((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const a=function(e){let t;switch(e.arrayFormat){case"index":return(e,a,s)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===s[e]&&(s[e]={}),s[e][t[1]]=a):s[e]=a};case"bracket":return(e,a,s)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==s[e]?s[e]=[].concat(s[e],a):s[e]=[a]:s[e]=a};case"comma":case"separator":return(t,a,s)=>{const i="string"==typeof a&&a.split("").indexOf(e.arrayFormatSeparator)>-1?a.split(e.arrayFormatSeparator).map((t=>r(t,e))):null===a?a:r(a,e);s[t]=i};default:return(e,t,a)=>{void 0!==a[e]?a[e]=[].concat(a[e],t):a[e]=t}}}(t),s=Object.create(null);if("string"!=typeof e)return s;if(!(e=e.trim().replace(/^[?#&]/,"")))return s;for(const i of e.split("&")){let[e,n]=l(t.decode?i.replace(/\+/g," "):i,"=");n=void 0===n?null:["comma","separator"].includes(t.arrayFormat)?n:r(n,t),a(r(e,t),n,s)}for(const e of Object.keys(s)){const a=s[e];if("object"==typeof a&&null!==a)for(const e of Object.keys(a))a[e]=b(a[e],t);else s[e]=b(a,t)}return!1===t.sort?s:(!0===t.sort?Object.keys(s).sort():Object.keys(s).sort(t.sort)).reduce(((e,t)=>{const a=s[t];return Boolean(a)&&"object"==typeof a&&!Array.isArray(a)?e[t]=u(a):e[t]=a,e}),Object.create(null))}t.extract=d,t.parse=j,t.stringify=(e,t)=>{if(!e)return"";n((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const a=a=>t.skipNull&&null==e[a]||t.skipEmptyString&&""===e[a],s=function(e){switch(e.arrayFormat){case"index":return t=>(a,s)=>{const i=a.length;return void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?a:null===s?[...a,[o(t,e),"[",i,"]"].join("")]:[...a,[o(t,e),"[",o(i,e),"]=",o(s,e)].join("")]};case"bracket":return t=>(a,s)=>void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?a:null===s?[...a,[o(t,e),"[]"].join("")]:[...a,[o(t,e),"[]=",o(s,e)].join("")];case"comma":case"separator":return t=>(a,s)=>null==s||0===s.length?a:0===a.length?[[o(t,e),"=",o(s,e)].join("")]:[[a,o(s,e)].join(e.arrayFormatSeparator)];default:return t=>(a,s)=>void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?a:null===s?[...a,o(t,e)]:[...a,[o(t,e),"=",o(s,e)].join("")]}}(t),i={};for(const t of Object.keys(e))a(t)||(i[t]=e[t]);const l=Object.keys(i);return!1!==t.sort&&l.sort(t.sort),l.map((a=>{const i=e[a];return void 0===i?"":null===i?o(a,t):Array.isArray(i)?i.reduce(s(a),[]).join("&"):o(a,t)+"="+o(i,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[a,s]=l(e,"#");return Object.assign({url:a.split("?")[0]||"",query:j(d(e),t)},t&&t.parseFragmentIdentifier&&s?{fragmentIdentifier:r(s,t)}:{})},t.stringifyUrl=(e,a)=>{a=Object.assign({encode:!0,strict:!0},a);const s=c(e.url).split("?")[0]||"",i=t.extract(e.url),l=t.parse(i,{sort:!1}),n=Object.assign(l,e.query);let r=t.stringify(n,a);r&&(r=`?${r}`);let u=function(e){let t="";const a=e.indexOf("#");return-1!==a&&(t=e.slice(a)),t}(e.url);return e.fragmentIdentifier&&(u=`#${o(e.fragmentIdentifier,a)}`),`${s}${r}${u}`}},134:function(e,t,a){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},135:function(e,t,a){"use strict";var s="%[a-f0-9]{2}",i=new RegExp("("+s+")|([^%]+?)","gi"),l=new RegExp("("+s+")+","gi");function n(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var a=e.slice(0,t),s=e.slice(t);return Array.prototype.concat.call([],n(a),n(s))}function o(e){try{return decodeURIComponent(e)}catch(s){for(var t=e.match(i)||[],a=1;a<t.length;a++)t=(e=n(t,a).join("")).match(i)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},a=l.exec(e);a;){try{t[a[0]]=decodeURIComponent(a[0])}catch(e){var s=o(a[0]);s!==a[0]&&(t[a[0]]=s)}a=l.exec(e)}t["%C2"]="�";for(var i=Object.keys(t),n=0;n<i.length;n++){var r=i[n];e=e.replace(new RegExp(r,"g"),t[r])}return e}(e)}}},136:function(e,t,a){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const a=e.indexOf(t);return-1===a?[e]:[e.slice(0,a),e.slice(a+t.length)]}},155:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(156);case"v8light":return a(158)}},156:function(e,t,a){var s=a(19),i=a(157);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},157:function(e,t,a){(t=a(20)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#141519}.kbnSolutionNav{background:linear-gradient(160deg,#3437414d,#3437414d 32px,#f000 0),linear-gradient(175deg,#3437414d,#3437414d 16px,#f000 0);display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#98a2b380 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#98a2b380;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px) and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px) and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav__title{align-items:center;display:inline-flex}.kbnSolutionNav__titleAvatar{align-self:flex-start;margin-right:12px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},158:function(e,t,a){var s=a(19),i=a(159);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},159:function(e,t,a){(t=a(20)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#fafbfd}.kbnSolutionNav{background:linear-gradient(160deg,#d3dae64d,#d3dae64d 32px,#f000 0),linear-gradient(175deg,#d3dae64d,#d3dae64d 16px,#f000 0);display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#69707d80 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#69707d80;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px) and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px) and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav__title{align-items:center;display:inline-flex}.kbnSolutionNav__titleAvatar{align-self:flex-start;margin-right:12px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},160:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(161);case"v8light":return a(163)}},161:function(e,t,a){var s=a(19),i=a(162);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},162:function(e,t,a){var s=a(20),i=a(119),l=a(120);t=s(!1);var n=i(l);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px rgba(0,0,0,.175),0 1.9px 4px rgba(0,0,0,.125),0 4.5px 10px rgba(0,0,0,.125)}.kbnSolutionAvatar--xxl{background:#1d1e24 url("+n+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #0003,0 2.6px 8px -1px #00000026,0 5.7px 12px -1px rgba(0,0,0,.125),0 15px 15px -1px #0000001a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},163:function(e,t,a){var s=a(19),i=a(164);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},164:function(e,t,a){var s=a(20),i=a(119),l=a(120);t=s(!1);var n=i(l);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px #00000012,0 1.9px 4px #0000000d,0 4.5px 10px #0000000d}.kbnSolutionAvatar--xxl{background:#fff url("+n+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #00000014,0 2.6px 8px -1px #0000000f,0 5.7px 12px -1px #0000000d,0 15px 15px -1px #0000000a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},165:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(166);case"v8light":return a(168)}},166:function(e,t,a){var s=a(19),i=a(167);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},167:function(e,t,a){(t=a(20)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#1d1e24!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},168:function(e,t,a){var s=a(19),i=a(169);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);s(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},169:function(e,t,a){(t=a(20)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#fff!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},170:function(e,t,a){"use strict";e.exports=a(171)},171:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(172);a(54),a(83),a(82);var i=s.default({key:"css"}),l=i.flush,n=i.hydrate,o=i.cx,r=i.merge,u=i.getRegisteredStyles,c=i.injectGlobal,d=i.keyframes,b=i.css,j=i.sheet,p=i.cache;t.cache=p,t.css=b,t.cx=o,t.flush=l,t.getRegisteredStyles=u,t.hydrate=n,t.injectGlobal=c,t.keyframes=d,t.merge=r,t.sheet=j},172:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(54),i=a(83),l=a(82);function n(e){return e&&e.__esModule?e:{default:e}}var o=n(s);function r(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function u(e,t,a){var s=[],i=l.getRegisteredStyles(e,s,a);return s.length<2?a:i+t(s)}var c=function e(t){for(var a="",s=0;s<t.length;s++){var i=t[s];if(null!=i){var l=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))l=e(i);else for(var n in l="",i)i[n]&&n&&(l&&(l+=" "),l+=n);break;default:l=i}l&&(a&&(a+=" "),a+=l)}}return a};t.default=function(e){var t=o.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var a=function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];var n=i.serializeStyles(a,t.registered,void 0);return l.insertStyles(t,n,!1),t.key+"-"+n.name};return{css:a,cx:function(){for(var e=arguments.length,s=new Array(e),i=0;i<e;i++)s[i]=arguments[i];return u(t.registered,a,c(s))},injectGlobal:function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];var l=i.serializeStyles(a,t.registered);r(t,l)},keyframes:function(){for(var e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];var l=i.serializeStyles(a,t.registered),n="animation-"+l.name;return r(t,{name:l.name,styles:"@keyframes "+n+"{"+l.styles+"}"}),n},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:l.getRegisteredStyles.bind(null,t.registered),merge:u.bind(null,t.registered,a)}}},173:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=a(1),i="undefined"!=typeof window?s.useLayoutEffect:s.useEffect;t.default=i},174:function(e,t,a){e.exports=a.p+"baad30acfe492601d08a0e839c9bb3f5.svg"},196:function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return ws}));var s=a(5),i=a(1),l=a.n(i),n=a(55),o=a.n(n),r=a(7),u=a.n(r),c=a(18);const d={services:{}},b=Object(i.createContext)(d);var j=a(129),p=a.n(j),x=a(0);const m=({children:e,component:t,render:a,...s})=>{const n=Object(i.useMemo)((()=>{if(t)return e=>Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(O,null),Object(x.jsx)(t,e))}),[t]);if(n)return Object(x.jsx)(c.Route,u()({},s,{component:n}));if(a||"function"==typeof e){const t="function"==typeof e?e:a;return Object(x.jsx)(c.Route,u()({},s,{render:e=>Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(O,null),t(e))}))}return Object(x.jsx)(c.Route,s,Object(x.jsx)(O,null),e)},O=()=>{const{executionContext:e}=Object(i.useContext)(b).services,t=Object(c.useRouteMatch)();return function(e,t){p()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null};var g=a(50);const v=({children:e,...t})=>Object(x.jsx)(c.Router,t,Object(x.jsx)(g.CompatRouter,null,e));var f=a(15);const y=({legacySwitch:e=!0,children:t})=>{const a=Object(c.useRouteMatch)();return e?Object(x.jsx)(c.Switch,null,t):Object(x.jsx)(g.Routes,null,i.Children.map(t,(e=>{if(l.a.isValidElement(e)&&e.type===m){var s;const i=Object(f.replace)(null==e?void 0:e.props.path,a.url+"/",""),n="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(x.jsx)(g.Route,{path:i,element:Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(O,null),(null==e||null===(s=e.props)||void 0===s?void 0:s.component)&&Object(x.jsx)(e.props.component,null)||n&&n()||t)})}return e})))};var k=a(14),h=a(11),E=a(56),S=a(6),C=a(121),M=a.n(C),q=a(47);const F=({euiTheme:e})=>({minHeight:`calc(100vh - ${2*parseFloat(e.size.xxxl)}px)`,background:e.colors.emptyShade,display:"flex",flexDirection:"column"}),T={display:"flex",flexDirection:"column",flex:1},w=({euiTheme:e})=>({background:e.colors.emptyShade,borderBottom:e.border.thin,padding:`${e.size.base} ${e.size.l} ${e.size.base} ${e.size.l}`,".euiTabs":{paddingLeft:"3px",marginLeft:"-3px"}});var _=a(8),I=a(2),P=a(62),N=a(4);const L={href:P.a.overview(),text:_.i18n.translate("xpack.osquery.breadcrumbs.appTitle",{defaultMessage:"Osquery"})},B={base:()=>[L],overview:()=>[L,{text:_.i18n.translate("xpack.osquery.breadcrumbs.overviewPageTitle",{defaultMessage:"Overview"})}],live_queries:()=>[L,{text:_.i18n.translate("xpack.osquery.breadcrumbs.liveQueriesPageTitle",{defaultMessage:"Live queries"})}],live_query_new:()=>[L,{href:P.a.live_queries(),text:_.i18n.translate("xpack.osquery.breadcrumbs.liveQueriesPageTitle",{defaultMessage:"Live queries"})},{text:_.i18n.translate("xpack.osquery.breadcrumbs.newLiveQueryPageTitle",{defaultMessage:"New"})}],live_query_details:({liveQueryId:e})=>[L,{href:P.a.live_queries(),text:_.i18n.translate("xpack.osquery.breadcrumbs.liveQueriesPageTitle",{defaultMessage:"Live queries"})},{text:e}],saved_queries:()=>[L,{text:_.i18n.translate("xpack.osquery.breadcrumbs.savedQueriesPageTitle",{defaultMessage:"Saved queries"})}],saved_query_new:()=>[L,{href:P.a.saved_queries(),text:_.i18n.translate("xpack.osquery.breadcrumbs.savedQueriesPageTitle",{defaultMessage:"Saved queries"})},{text:_.i18n.translate("xpack.osquery.breadcrumbs.newSavedQueryPageTitle",{defaultMessage:"New"})}],saved_query_edit:({savedQueryName:e})=>[L,{href:P.a.saved_queries(),text:_.i18n.translate("xpack.osquery.breadcrumbs.savedQueriesPageTitle",{defaultMessage:"Saved queries"})},{text:e}],packs:()=>[L,{text:_.i18n.translate("xpack.osquery.breadcrumbs.packsPageTitle",{defaultMessage:"Packs"})}],pack_add:()=>[L,{href:P.a.packs(),text:_.i18n.translate("xpack.osquery.breadcrumbs.packsPageTitle",{defaultMessage:"Packs"})},{text:_.i18n.translate("xpack.osquery.breadcrumbs.addpacksPageTitle",{defaultMessage:"Add"})}],pack_details:({packName:e})=>[L,{href:P.a.packs(),text:_.i18n.translate("xpack.osquery.breadcrumbs.packsPageTitle",{defaultMessage:"Packs"})},{text:e}],pack_edit:({packName:e,packId:t})=>[L,{href:P.a.packs(),text:_.i18n.translate("xpack.osquery.breadcrumbs.packsPageTitle",{defaultMessage:"Packs"})},{href:P.a.pack_details({packId:t}),text:e},{text:_.i18n.translate("xpack.osquery.breadcrumbs.editpacksPageTitle",{defaultMessage:"Edit"})}]};function A(e,t={}){var a;const{chrome:s,http:i,application:l}=Object(N.e)().services,n=(null===(a=B[e])||void 0===a?void 0:a.call(B,t).map((e=>{const t=e.href?i.basePath.prepend(`${I.b}${e.href}`):void 0;return{...e,href:t,onClick:t?e=>{e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||(e.preventDefault(),l.navigateToUrl(t))}:void 0}})))||[],o=[...n].reverse().map((e=>e.text));s.docTitle.change(o),s.setBreadcrumbs(n)}var Q=a(69),z=a(30),D=a(70);const R=[],G=({actionId:e})=>{const t=Object(N.f)(`live_queries/${e}`),a=_.i18n.translate("xpack.osquery.liveQueryActions.table.viewDetailsActionButton",{defaultMessage:"Details"});return Object(x.jsx)(s.EuiToolTip,{position:"top",content:a},Object(x.jsx)(s.EuiButtonIcon,u()({iconType:"visTable"},t,{"aria-label":a})))};G.displayName="ActionTableResultsButton";const $=()=>{var e,t;const a=Object(N.e)().services.application.capabilities.osquery,{push:n}=Object(c.useHistory)(),[o,r]=Object(i.useState)(0),[u,d]=Object(i.useState)(20),{data:b}=Object(D.a)({}),{data:j}=Object(z.a)({activePage:o,limit:u,kuery:"user_id: *"}),p=Object(i.useCallback)((({page:e={}})=>{const{index:t,size:a}=e;r(t),d(a)}),[]),m=Object(i.useCallback)(((e,t)=>{if(t._source.pack_name)return Object(x.jsx)(s.EuiFlexGroup,{gutterSize:"s",alignItems:"center",justifyContent:"center"},Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiIcon,{type:"package"})),Object(x.jsx)(s.EuiFlexItem,null,t._source.pack_name));const a=t._source.queries[0].query,i=Object(Q.a)(a),l=i.length>90?`${null==i?void 0:i.substring(0,90)}...`:i;return Object(x.jsx)(s.EuiCodeBlock,{language:"sql",fontSize:"s",paddingSize:"none",transparentBackground:!0},l)}),[]),O=Object(i.useCallback)(((e,t)=>{var a,s;return Object(x.jsx)(l.a.Fragment,null,null!==(a=null===(s=t.fields.agents)||void 0===s?void 0:s.length)&&void 0!==a?a:0)}),[]),g=Object(i.useCallback)((e=>Object(f.isArray)(e)?e[0]:"-"),[]),v=Object(i.useCallback)(((e,t)=>Object(x.jsx)(l.a.Fragment,null,Object(s.formatDate)(t.fields["@timestamp"][0]))),[]),y=Object(i.useCallback)((e=>Object(x.jsx)(G,{actionId:e.fields.action_id[0]})),[]),k=Object(i.useCallback)((e=>()=>{var t;if(e._source.pack_id)return n("/live_queries/new",{form:Object(f.pickBy)({packId:e._source.pack_id,agentSelection:{agents:e._source.agent_ids,allAgentsSelected:e._source.agent_all,platformsSelected:e._source.agent_platforms,policiesSelected:e._source.agent_policy_ids}},(e=>!Object(f.isEmpty)(e)))});n("/live_queries/new",{form:Object(f.pickBy)({query:e._source.queries[0].query,ecs_mapping:e._source.queries[0].ecs_mapping,savedQueryId:e._source.queries[0].saved_query_id,timeout:null!==(t=e._source.queries[0].timeout)&&void 0!==t?t:I.g.DEFAULT,agentSelection:{agents:e._source.agent_ids,allAgentsSelected:e._source.agent_all,platformsSelected:e._source.agent_platforms,policiesSelected:e._source.agent_policy_ids}},(e=>!Object(f.isEmpty)(e)||Object(f.isNumber)(e)))})}),[n]),h=Object(i.useCallback)(((e,t)=>{const a=_.i18n.translate("xpack.osquery.liveQueryActions.table.runActionAriaLabel",{defaultMessage:"Run query"});return Object(x.jsx)(s.EuiToolTip,{position:"top",content:a},Object(x.jsx)(s.EuiButtonIcon,{iconType:"play",onClick:k(e),isDisabled:!t,"aria-label":a}))}),[k]),E=Object(i.useMemo)((()=>{var e;return Object(f.map)(null!==(e=null==b?void 0:b.data)&&void 0!==e?e:[],"id")}),[b]),S=Object(i.useCallback)((e=>{var t;return null!==(t=e.fields.pack_id)&&void 0!==t&&t.length?E.includes(e.fields.pack_id[0])&&a.runSavedQueries&&a.readPacks:!(!a.runSavedQueries&&!a.writeLiveQueries)}),[a,E]),C=Object(i.useMemo)((()=>[{field:"query",name:_.i18n.translate("xpack.osquery.liveQueryActions.table.queryColumnTitle",{defaultMessage:"Query"}),truncateText:!0,width:"60%",render:m},{field:"agents",name:_.i18n.translate("xpack.osquery.liveQueryActions.table.agentsColumnTitle",{defaultMessage:"Agents"}),width:"100px",render:O},{field:"created_at",name:_.i18n.translate("xpack.osquery.liveQueryActions.table.createdAtColumnTitle",{defaultMessage:"Created at"}),width:"200px",render:v},{field:"fields.user_id",name:_.i18n.translate("xpack.osquery.liveQueryActions.table.createdByColumnTitle",{defaultMessage:"Run by"}),width:"200px",render:g},{name:_.i18n.translate("xpack.osquery.liveQueryActions.table.viewDetailsColumnTitle",{defaultMessage:"View details"}),actions:[{available:S,render:h},{render:y}]}]),[S,y,O,g,h,m,v]),M=Object(i.useMemo)((()=>{var e,t;return{pageIndex:o,pageSize:u,totalItemCount:null!==(e=null==j||null===(t=j.data)||void 0===t?void 0:t.total)&&void 0!==e?e:0,pageSizeOptions:[20,50,100]}}),[j,o,u]),q=Object(i.useCallback)((e=>({"data-test-subj":`row-${e._source.action_id}`})),[]);return Object(x.jsx)(s.EuiBasicTable,{items:null!==(e=null==j||null===(t=j.data)||void 0===t?void 0:t.items)&&void 0!==e?e:R,columns:C,pagination:M,onChange:p,rowProps:q,"data-test-subj":"liveQueryActionsTable"})},U=l.a.memo($),V=({euiTheme:e})=>({borderBottom:e.border.thin,backgroundColor:e.colors.body}),W={top:"1px","&:before":{height:"0px"}},H=Object(i.memo)((({leftColumn:e,rightColumn:t,rightColumnGrow:a})=>Object(x.jsx)(s.EuiFlexGroup,{alignItems:"center"},e?Object(x.jsx)(s.EuiFlexItem,null,e):null,t?Object(x.jsx)(s.EuiFlexItem,{grow:a},t):null)));H.displayName="HeaderColumns";const X=({children:e,leftColumn:t,rightColumn:a,rightColumnGrow:l,tabs:n,maxWidth:o,tabsClassName:r,"data-test-subj":c})=>{const d=Object(i.useCallback)((({euiTheme:e})=>Object(x.css)("max-width:",o||1200,"px;margin-left:auto;margin-right:auto;padding-top:",e.size.xl,";padding-left:",e.size.m,";padding-right:",e.size.m,";","")),[o]);return Object(x.jsx)("div",{css:V,"data-test-subj":c},Object(x.jsx)("div",{css:d},Object(x.jsx)(H,{leftColumn:t,rightColumn:a,rightColumnGrow:l}),e,Object(x.jsx)(s.EuiFlexGroup,null,n?Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiSpacer,{size:"s"}),Object(x.jsx)(s.EuiTabs,{className:r,css:W},n.map((e=>Object(x.jsx)(s.EuiTab,u()({},e,{key:e.id}),e.name))))):Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiSpacer,{size:"l"})))))},K=l.a.memo(X),Y=({euiTheme:e})=>({background:e.colors.emptyShade,width:"100%",alignSelf:"center",marginLeft:0,marginRight:0,flex:1}),J={height:"100%"},Z=({restrictWidth:e,restrictHeaderWidth:t,children:a,headerChildren:l,"data-test-subj":n,...o})=>Object(x.jsx)(i.Fragment,null,Object(x.jsx)(K,u()({maxWidth:t,"data-test-subj":n?`${n}_header`:void 0},o),l),Object(x.jsx)(s.EuiPage,{css:Y,restrictWidth:e||1200,"data-test-subj":n?`${n}_page`:void 0},Object(x.jsx)(s.EuiPageBody,null,Object(x.jsx)("div",{css:J},Object(x.jsx)(s.EuiSpacer,{size:"l"}),a)))),ee=()=>{A("live_queries");const e=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{direction:"column",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,null,Object(x.jsx)("h1",null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.liveQueriesHistory.pageTitle",defaultMessage:"Live queries history"})))))),[]);return Object(x.jsx)(Z,{leftColumn:e,rightColumn:Object(x.jsx)(ae,null),rightColumnGrow:!1},Object(x.jsx)(U,null))},te=l.a.memo(ee),ae=l.a.memo((()=>{const e=Object(N.e)().services.application.capabilities.osquery,t=Object(N.f)("live_queries/new");return Object(x.jsx)(s.EuiButton,u()({fill:!0},t,{iconType:"plusInCircle",isDisabled:!(e.writeLiveQueries||e.runSavedQueries&&(e.readSavedQueries||e.readPacks))}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.liveQueriesHistory.newLiveQueryButtonLabel",defaultMessage:"New live query"}))}));ae.displayName="NewLiveQueryButton";var se=a(133),ie=a.n(se),le=a(99);const ne=()=>{var e;A("live_query_new");const{replace:t}=Object(c.useHistory)(),a=Object(c.useLocation)(),l=Object(N.f)("live_queries"),[n,o]=Object(i.useState)({}),r=Object(i.useMemo)((()=>{const e=ie.a.parse(a.search);return null!=e&&e.agentPolicyId?[null==e?void 0:e.agentPolicyId]:void 0}),[a.search]);Object(i.useEffect)((()=>{var e,s;null!==(e=a.state)&&void 0!==e&&e.form&&(o(null===(s=a.state)||void 0===s?void 0:s.form),t({state:null}))}),[null===(e=a.state)||void 0===e?void 0:e.form,t]);const d=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiButtonEmpty,u()({iconType:"arrowLeft"},l,{flush:"left",size:"xs"}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.newLiveQuery.viewLiveQueriesHistoryTitle",defaultMessage:"View live queries history"}))),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,null,Object(x.jsx)("h1",null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.newLiveQuery.pageTitle",defaultMessage:"New live query"})))))),[l]);return Object(x.jsx)(Z,{leftColumn:d},Object(x.jsx)(le.a,u()({agentPolicyIds:r},n)))},oe=l.a.memo(ne);var re=a(72),ue=a(75);const ce={paddingLeft:"10px"},de=()=>{const{actionId:e}=Object(c.useParams)();A("live_query_details",{liveQueryId:e});const t=Object(N.f)("live_queries"),[a,l]=Object(i.useState)(!1),{data:n}=Object(re.a)({actionId:e,isLive:a}),o=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiButtonEmpty,u()({iconType:"arrowLeft"},t,{flush:"left",size:"xs"}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.liveQueryDetails.viewLiveQueriesHistoryTitle",defaultMessage:"View live queries history"}))),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,null,Object(x.jsx)("h1",null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.liveQueryDetails.pageTitle",defaultMessage:"Live query details"})))))),[t]);return Object(i.useLayoutEffect)((()=>{l((()=>!("completed"===(null==n?void 0:n.status))))}),[null==n?void 0:n.status]),Object(x.jsx)(Z,{leftColumn:o,rightColumnGrow:!1},Object(x.jsx)(s.EuiFlexItem,{css:ce},Object(x.jsx)(ue.a,{actionId:e,data:null==n?void 0:n.queries,startDate:null==n?void 0:n["@timestamp"],expirationDate:null==n?void 0:n.expiration,agentIds:null==n?void 0:n.agents,showResultsHeader:!0})))},be=l.a.memo(de);var je=a(78);const pe=()=>{const e=Object(N.e)().services.application.capabilities.osquery;A("live_queries");const t=Object(c.useRouteMatch)();return e.readLiveQueries?Object(x.jsx)(y,null,Object(x.jsx)(m,{path:`${t.url}/new`},e.runSavedQueries&&(e.readSavedQueries||e.readPacks)||e.writeLiveQueries?Object(x.jsx)(oe,null):Object(x.jsx)(je.a,null)),Object(x.jsx)(m,{path:`${t.url}/:actionId`},Object(x.jsx)(be,null)),Object(x.jsx)(m,{path:`${t.url}`},Object(x.jsx)(te,null))):Object(x.jsx)(je.a,null)},xe=l.a.memo(pe);var me=a(44),Oe=a.n(me),ge=a(61),ve=a.n(ge),fe=a(21),ye=a(73);const ke=({disabled:e=!1,savedQuery:t})=>{const{push:a}=Object(c.useHistory)(),l=Object(i.useCallback)((()=>{var e;return a("/live_queries/new",{form:{savedQueryId:t.id,query:t.query,ecs_mapping:t.ecs_mapping,timeout:null!==(e=t.timeout)&&void 0!==e?e:I.g.DEFAULT}})}),[a,t]),n=Object(i.useMemo)((()=>_.i18n.translate("xpack.osquery.savedQueryList.queriesTable.runActionAriaLabel",{defaultMessage:"Run {savedQueryName}",values:{savedQueryName:t.id}})),[t]);return Object(x.jsx)(s.EuiToolTip,{position:"top",content:n},Object(x.jsx)(s.EuiButtonIcon,{color:"primary",iconType:"play",isDisabled:e,onClick:l,"aria-label":n}))},he=l.a.memo(ke,ve.a),Ee=({disabled:e=!1,savedQueryId:t,savedQueryName:a})=>{const l=Object(N.f)(`saved_queries/${t}`),n=Object(i.useMemo)((()=>_.i18n.translate("xpack.osquery.savedQueryList.queriesTable.editActionAriaLabel",{defaultMessage:"Edit {savedQueryName}",values:{savedQueryName:a}})),[a]);return Object(x.jsx)(s.EuiToolTip,{position:"top",content:n},Object(x.jsx)(s.EuiButtonIcon,u()({color:"primary"},l,{iconType:"pencil",isDisabled:e,"aria-label":n})))},Se=l.a.memo(Ee),Ce=()=>{const e=Object(N.e)().services.application.capabilities.osquery;A("saved_queries");const t=Object(N.f)("saved_queries/new"),[a,n]=Object(i.useState)(0),[o,r]=Object(i.useState)(20),[c,d]=Object(i.useState)("updated_at"),[b,j]=Object(i.useState)(fe.a.desc),{data:p}=Object(ye.a)({isLive:!0}),m=Object(i.useCallback)((e=>Object(x.jsx)(Se,{savedQueryId:e.saved_object_id,savedQueryName:e.id})),[]),O=Object(i.useCallback)((t=>e.runSavedQueries||e.writeLiveQueries?Object(x.jsx)(he,{savedQuery:t,disabled:!1}):Object(x.jsx)(l.a.Fragment,null)),[e.runSavedQueries,e.writeLiveQueries]),g=Object(i.useCallback)(((e,t)=>{if(!e)return"-";const a=t.updated_by!==t.created_by?` @ ${t.updated_by}`:"";return e?`${Oe()(e).fromNow()}${a}`:"-"}),[]),v=Object(i.useCallback)((e=>{const t=e&&e.length>80?`${null==e?void 0:e.substring(0,80)}...`:e;return Object(x.jsx)(s.EuiToolTip,{content:Object(x.jsx)(s.EuiFlexItem,null,e)},Object(x.jsx)(s.EuiFlexItem,{grow:!1},t))}),[]),f=Object(i.useMemo)((()=>[{field:"id",name:_.i18n.translate("xpack.osquery.savedQueries.table.queryIdColumnTitle",{defaultMessage:"Query ID"}),sortable:e=>e.id.toLowerCase(),truncateText:!0,width:"15%"},{field:"description",name:_.i18n.translate("xpack.osquery.savedQueries.table.descriptionColumnTitle",{defaultMessage:"Description"}),render:v,width:"50%"},{field:"created_by",name:_.i18n.translate("xpack.osquery.savedQueries.table.createdByColumnTitle",{defaultMessage:"Created by"}),width:"15%",sortable:!0,truncateText:!0},{field:"updated_at",name:_.i18n.translate("xpack.osquery.savedQueries.table.updatedAtColumnTitle",{defaultMessage:"Last updated at"}),width:"10%",sortable:e=>e.updated_at?Date.parse(e.updated_at):0,truncateText:!0,render:g},{name:_.i18n.translate("xpack.osquery.savedQueries.table.actionsColumnTitle",{defaultMessage:"Actions"}),actions:[{render:O},{render:m}]}]),[v,m,O,g]),y=Object(i.useCallback)((({page:e={},sort:t={}})=>{n(e.index),r(e.size),d(t.field),j(t.direction)}),[]),h=Object(i.useMemo)((()=>{var e;return{pageIndex:a,pageSize:o,totalItemCount:null!==(e=null==p?void 0:p.total)&&void 0!==e?e:0,pageSizeOptions:[10,20,50,100]}}),[a,o,null==p?void 0:p.total]),E=Object(i.useMemo)((()=>({sort:{field:c,direction:b}})),[b,c]),S=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,null,Object(x.jsx)("h1",null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.savedQueryList.pageTitle",defaultMessage:"Saved queries"})))))),[]),C=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiButton,u()({fill:!0},t,{iconType:"plusInCircle",isDisabled:!e.writeSavedQueries}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.savedQueryList.addSavedQueryButtonLabel",defaultMessage:"Add saved query"}))),[e.writeSavedQueries,t]);return Object(x.jsx)(Z,{leftColumn:S,rightColumn:C,rightColumnGrow:!1},(null==p?void 0:p.data)&&Object(x.jsx)(s.EuiInMemoryTable,{items:null==p?void 0:p.data,itemId:"id",columns:f,pagination:h,sorting:E,onChange:y,rowHeader:"id"}))},Me=l.a.memo(Ce);var qe=a(16),Fe=a(101),Te=a(76);const we=({defaultValue:e,handleSubmit:t})=>{const a=Object(N.f)("saved_queries"),i=Object(Te.b)({defaultValue:e}),{serializer:l,idSet:n,handleSubmit:o,formState:{isSubmitting:r,errors:c}}=i;return Object(x.jsx)(qe.FormProvider,i,Object(x.jsx)(Fe.a,{hasPlayground:!0,isValid:Object(f.isEmpty)(c),idSet:n}),Object(x.jsx)(s.EuiBottomBar,null,Object(x.jsx)(s.EuiFlexGroup,{justifyContent:"flexEnd"},Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiFlexGroup,{gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiButtonEmpty,u()({color:"text"},a),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.addSavedQuery.form.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiButton,{isLoading:r,color:"primary",fill:!0,size:"m",iconType:"save",onClick:o((async e=>{const a=l(e);await t(a)}))},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.addSavedQuery.form.saveQueryButtonLabel",defaultMessage:"Save query"}))))))),Object(x.jsx)(s.EuiSpacer,{size:"xxl"}),Object(x.jsx)(s.EuiSpacer,{size:"xxl"}),Object(x.jsx)(s.EuiSpacer,{size:"xxl"}))},_e=l.a.memo(we);var Ie=a(116);const Pe=()=>{A("saved_query_new");const e=Object(N.f)("saved_queries"),{mutateAsync:t}=Object(Ie.a)({withRedirect:!0}),a=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiButtonEmpty,u()({iconType:"arrowLeft"},e,{flush:"left",size:"xs"}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.addSavedQuery.viewSavedQueriesListTitle",defaultMessage:"View all saved queries"}))),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,null,Object(x.jsx)("h1",null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.addSavedQuery.pageTitle",defaultMessage:"Add saved query"})))))),[e]),l=Object(i.useCallback)((async e=>{await t(e)}),[t]);return Object(x.jsx)(Z,{leftColumn:a},Object(x.jsx)(_e,{handleSubmit:l}))},Ne=l.a.memo(Pe);var Le=a(42);const Be=({defaultValue:e,handleSubmit:t,viewMode:a})=>{const i=Object(N.f)("saved_queries"),n=Object(Te.b)({defaultValue:e}),{serializer:o,idSet:r,handleSubmit:c,formState:{isSubmitting:d}}=n;return Object(x.jsx)(qe.FormProvider,n,Object(x.jsx)(Fe.a,{viewMode:a,hasPlayground:!0,idSet:r}),!a&&Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(s.EuiBottomBar,null,Object(x.jsx)(s.EuiFlexGroup,{justifyContent:"flexEnd"},Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiFlexGroup,{gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiButtonEmpty,u()({color:"text"},i),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.editSavedQuery.form.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiButton,{"data-test-subj":"update-query-button",isLoading:d,color:"primary",fill:!0,size:"m",iconType:"save",onClick:c((async e=>{const a=o(e);try{await t(a)}catch(e){}}))},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.editSavedQuery.form.updateQueryButtonLabel",defaultMessage:"Update query"}))))))),Object(x.jsx)(s.EuiSpacer,{size:"xxl"}),Object(x.jsx)(s.EuiSpacer,{size:"xxl"}),Object(x.jsx)(s.EuiSpacer,{size:"xxl"})))},Ae=l.a.memo(Be);var Qe=a(125);const ze={margin:"10px"},De=()=>{var e;const t=Object(N.e)().services.application.capabilities.osquery,[a,n]=Object(i.useState)(!1),{savedQueryId:o}=Object(c.useParams)(),r=Object(N.f)("saved_queries"),{isLoading:d,data:b}=Object(Qe.c)({savedQueryId:o}),j=Object(Qe.d)({savedQueryId:o}),p=Object(Qe.b)({savedQueryId:o});A("saved_query_edit",{savedQueryName:null!==(e=null==b?void 0:b.saved_object_id)&&void 0!==e?e:""});const m=Object(i.useMemo)((()=>!(null==b||!b.prebuilt)),[b]),O=Object(i.useMemo)((()=>!t.writeSavedQueries||m),[t.writeSavedQueries,m]),g=Object(i.useCallback)((()=>{n(!1)}),[]),v=Object(i.useCallback)((()=>{n(!0)}),[]),f=Object(i.useCallback)((()=>{p.mutateAsync().then((()=>{g()}))}),[p,g]),y=Object(i.useMemo)((()=>{var e,t;return Object(x.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiButtonEmpty,u()({iconType:"arrowLeft"},r,{flush:"left",size:"xs"}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.editSavedQuery.viewSavedQueriesListTitle",defaultMessage:"View all saved queries"}))),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,null,Object(x.jsx)("h1",null,O?Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.viewSavedQuery.pageTitle",defaultMessage:'"{savedQueryId}" details',values:{savedQueryId:null!==(e=null==b?void 0:b.id)&&void 0!==e?e:""}}),m&&Object(x.jsx)(s.EuiCallOut,{css:ze,size:"s"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.viewSavedQuery.prebuiltInfo",defaultMessage:"This is a prebuilt Elastic query, and it cannot be edited."}))):Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.editSavedQuery.pageTitle",defaultMessage:'Edit "{savedQueryId}"',values:{savedQueryId:null!==(t=null==b?void 0:b.id)&&void 0!==t?t:""}})))))}),[m,null==b?void 0:b.id,r,O]),h=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiButton,{color:"danger",onClick:v,iconType:"trash"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.editSavedQuery.deleteSavedQueryButtonLabel",defaultMessage:"Delete query"}))),[v]),E=Object(i.useCallback)((async e=>{await j.mutateAsync(e)}),[j]);return d?null:Object(x.jsx)(Z,{leftColumn:y,rightColumn:O?void 0:h,rightColumnGrow:!1},!d&&!Object(Le.isEmpty)(b)&&Object(x.jsx)(Ae,{defaultValue:b,handleSubmit:E,viewMode:O}),a?Object(x.jsx)(s.EuiConfirmModal,{title:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.deleteSavedQuery.confirmationModal.title",defaultMessage:"Are you sure you want to delete this query?"}),onCancel:g,onConfirm:f,cancelButtonText:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.deleteSavedQuery.confirmationModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.deleteSavedQuery.confirmationModal.confirmButtonLabel",defaultMessage:"Confirm"}),buttonColor:"danger",defaultFocusedButton:"confirm"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.deleteSavedQuery.confirmationModal.body",defaultMessage:"You're about to delete this query. Are you sure you want to do this?"})):null)},Re=l.a.memo(De),Ge=()=>{const e=Object(N.e)().services.application.capabilities.osquery;A("saved_queries");const t=Object(c.useRouteMatch)();return e.readSavedQueries?Object(x.jsx)(y,null,Object(x.jsx)(m,{path:`${t.url}/new`},e.writeSavedQueries?Object(x.jsx)(Ne,null):Object(x.jsx)(je.a,null)),Object(x.jsx)(m,{path:`${t.url}/:savedQueryId`},Object(x.jsx)(Re,null)),Object(x.jsx)(m,{path:`${t.url}`},Object(x.jsx)(Me,null))):Object(x.jsx)(je.a,null)},$e=l.a.memo(Ge);var Ue=a(90);const Ve=({onConfirm:e,onCancel:t,agentCount:a,agentPolicyCount:i})=>Object(x.jsx)(s.EuiConfirmModal,{title:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.agentPolicy.confirmModalTitle",defaultMessage:"Save and deploy changes"}),onCancel:t,onConfirm:e,cancelButtonText:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.agentPolicy.confirmModalCancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.agentPolicy.confirmModalConfirmButtonLabel",defaultMessage:"Save and deploy changes"}),buttonColor:"primary"},Object(x.jsx)(s.EuiCallOut,{iconType:"iInCircle",title:_.i18n.translate("xpack.osquery.agentPolicy.confirmModalCalloutTitle",{defaultMessage:"This action will update {agentCount, plural, one {# agent} other {# agents}}",values:{agentCount:a}})},Object(x.jsx)("div",{className:"eui-textBreakWord"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.agentPolicy.confirmModalCalloutDescription",defaultMessage:"Fleet has detected that the selected {agentPolicyCount, plural, one {agent policy} other {agent policies}}, is already in use by some of your agents. As a result of this action, Fleet will deploy updates to all agents that use this {agentPolicyCount, plural, one {agent policy} other {agent policies}}.",values:{agentPolicyCount:i}}))),Object(x.jsx)(s.EuiSpacer,{size:"l"}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.agentPolicy.confirmModalDescription",defaultMessage:"Are you sure you wish to continue?"})),We=l.a.memo(Ve);var He=a(17),Xe=a(9),Ke=a(64);const Ye=({withRedirect:e,options:t})=>{const a=Object(h.useQueryClient)(),{application:{navigateToApp:s},http:i,notifications:{toasts:l}}=Object(N.e)().services,n=Object(He.a)();return Object(h.useMutation)((({id:e,...t})=>i.put(`/api/osquery/packs/${e}`,{version:I.a.public.v1,body:JSON.stringify(t)})),{onError:e=>{var t,a;n(e,{title:null==e||null===(t=e.body)||void 0===t?void 0:t.error,toastMessage:null==e||null===(a=e.body)||void 0===a?void 0:a.message})},onSuccess:t=>{var i,n;a.invalidateQueries([Ke.a]),e&&s(Xe.PLUGIN_ID,{path:P.a.packs()}),l.addSuccess(_.i18n.translate("xpack.osquery.updatePack.successToastMessageText",{defaultMessage:'Successfully updated "{packName}" pack',values:{packName:null!==(i=null==t||null===(n=t.data)||void 0===n?void 0:n.name)&&void 0!==i?i:""}}))},...t})},Je=({euiTheme:e})=>({marginRight:e.size.s}),Ze=({item:e})=>{const t=Object(h.useQueryClient)(),{application:{capabilities:{osquery:a}},notifications:{toasts:n}}=Object(N.e)().services,o=Object(He.a)(),[r,u]=Object(i.useState)(!1),c=Object(i.useCallback)((()=>u(!1)),[]),{data:d}=Object(Ue.a)(),b=Object(i.useMemo)((()=>e.policy_ids.reduce(((e,t)=>{var a;return e+((null==d||null===(a=d.agentPoliciesById[t])||void 0===a?void 0:a.agents)||0)}),0)),[null==d?void 0:d.agentPoliciesById,e.policy_ids]),{isLoading:j,mutateAsync:p}=Ye({options:{onSuccess:e=>{var a,s,i;t.invalidateQueries([Ke.a]),o(),n.addSuccess(null!=e&&null!==(a=e.data)&&void 0!==a&&a.enabled?_.i18n.translate("xpack.osquery.pack.table.activatedSuccessToastMessageText",{defaultMessage:'Successfully activated "{packName}" pack',values:{packName:null==e||null===(s=e.data)||void 0===s?void 0:s.name}}):_.i18n.translate("xpack.osquery.pack.table.deactivatedSuccessToastMessageText",{defaultMessage:'Successfully deactivated "{packName}" pack',values:{packName:null==e||null===(i=e.data)||void 0===i?void 0:i.name}}))}}}),m=Object(i.useCallback)((()=>{p({id:e.saved_object_id,enabled:!e.enabled}),c()}),[c,e,p]),O=Object(i.useCallback)((()=>{if(b)return u(!0);m()}),[b,m]);return Object(x.jsx)(l.a.Fragment,null,j&&Object(x.jsx)(s.EuiLoadingSpinner,{css:Je}),Object(x.jsx)(s.EuiSwitch,{checked:!!e.enabled,disabled:!a.writePacks||j,showLabel:!1,"aria-label":e.name,label:"",onChange:O}),r&&b&&Object(x.jsx)(We,{onConfirm:m,onCancel:c,agentCount:b,agentPolicyCount:e.policy_ids.length}))},et=l.a.memo(Ze);var tt=a(45),at=a(43),st=a(91);const it={whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden"},lt=({policyId:e})=>{var t;const{application:{getUrlForApp:a,navigateToApp:l}}=Object(N.e)().services,{data:n}=Object(st.a)({policyId:e}),o=Object(i.useMemo)((()=>a(tt.PLUGIN_ID,{path:at.pagePathGetters.policy_details({policyId:e})[1]})),[a,e]),r=Object(i.useCallback)((t=>{if(!Object(N.d)(t)&&Object(N.c)(t))return t.preventDefault(),l(tt.PLUGIN_ID,{path:at.pagePathGetters.policy_details({policyId:e})[1]})}),[l,e]);return Object(x.jsx)(s.EuiLink,{href:o,onClick:r,css:it},null!==(t=null==n?void 0:n.name)&&void 0!==t?t:e)},nt=l.a.memo(lt),ot={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},rt=[],ut=({id:e,name:t})=>Object(x.jsx)(s.EuiLink,Object(N.f)(`packs/${e}`),t),ct=l.a.memo(ut),dt=(e,t)=>Object(x.jsx)(ct,{id:t.saved_object_id,name:t.name}),bt=({agentPolicyIds:e=[]})=>{const[t,a]=Object(i.useState)(!1),n=Object(i.useCallback)((()=>a((e=>!e))),[]),o=Object(i.useCallback)((()=>a(!1)),[]),r=Object(i.useMemo)((()=>{var t;return Object(x.jsx)(s.EuiButtonEmpty,{size:"s",flush:"both",onClick:n},Object(x.jsx)(l.a.Fragment,null,null!==(t=null==e?void 0:e.length)&&void 0!==t?t:0))}),[null==e?void 0:e.length,n]);var u;return null!=e&&e.length?Object(x.jsx)(s.EuiPopover,{button:r,isOpen:t,closePopover:o},Object(x.jsx)(s.EuiText,{size:"s"},null==e?void 0:e.map((e=>Object(x.jsx)("div",{key:e},Object(x.jsx)(nt,{policyId:e})))))):Object(x.jsx)(l.a.Fragment,null,null!==(u=null==e?void 0:e.length)&&void 0!==u?u:0)},jt=()=>{var e;const t=Object(N.e)().services.application.capabilities.osquery,{push:a}=Object(c.useHistory)(),{data:n,isLoading:o}=Object(D.a)({}),r=Object(i.useCallback)((e=>Object(x.jsx)(bt,{agentPolicyIds:e})),[]),u=Object(i.useCallback)((e=>{var t;return Object(x.jsx)(l.a.Fragment,null,null!==(t=e&&Object.keys(e).length)&&void 0!==t?t:0)}),[]),d=Object(i.useCallback)(((e,t)=>Object(x.jsx)(et,{item:t})),[]),b=Object(i.useCallback)(((e,t)=>{if(!e)return"-";const a=t.updated_by!==t.created_by?` @ ${t.updated_by}`:"";return e?Object(x.jsx)(s.EuiToolTip,{content:`${Oe()(e).fromNow()}${a}`},Object(x.jsx)("span",{css:ot},`${Oe()(e).fromNow()}${a}`)):"-"}),[]),j=Object(i.useCallback)((e=>()=>a("/live_queries/new",{form:{packId:e.saved_object_id}})),[a]),p=Object(i.useCallback)(((e,t)=>{const a=_.i18n.translate("xpack.osquery.packs.table.runActionAriaLabel",{defaultMessage:"Run {packName}",values:{packName:e.name}});return Object(x.jsx)(s.EuiToolTip,{position:"top",content:a},Object(x.jsx)(s.EuiButtonIcon,{iconType:"play",onClick:j(e),isDisabled:!t,"data-test-subj":`play-${e.name}-button`}))}),[j]),m=Object(i.useMemo)((()=>[{field:"name",name:_.i18n.translate("xpack.osquery.packs.table.nameColumnTitle",{defaultMessage:"Name"}),sortable:e=>e.name.toLowerCase(),render:dt},{field:"policy_ids",name:_.i18n.translate("xpack.osquery.packs.table.policyColumnTitle",{defaultMessage:"Scheduled policies"}),truncateText:!0,render:r},{field:"queries",name:_.i18n.translate("xpack.osquery.packs.table.numberOfQueriesColumnTitle",{defaultMessage:"Number of queries"}),render:u,width:"150px"},{field:"created_by",name:_.i18n.translate("xpack.osquery.packs.table.createdByColumnTitle",{defaultMessage:"Created by"}),sortable:!0,truncateText:!0},{field:"updated_at",name:"Last updated",sortable:e=>e.updated_at?Date.parse(e.updated_at):0,truncateText:!0,render:b},{field:"enabled",name:_.i18n.translate("xpack.osquery.packs.table.activeColumnTitle",{defaultMessage:"Active"}),sortable:!0,align:"right",width:"80px",render:d},{name:_.i18n.translate("xpack.osquery.pack.queriesTable.actionsColumnTitle",{defaultMessage:"Actions"}),width:"80px",actions:[{render:p,enabled:()=>t.writeLiveQueries||t.runSavedQueries}]}]),[t.runSavedQueries,t.writeLiveQueries,d,r,p,u,b]),O=Object(i.useMemo)((()=>({sort:{field:"name",direction:"asc"}})),[]);return o?Object(x.jsx)(s.EuiSkeletonText,{lines:10}):Object(x.jsx)(s.EuiInMemoryTable,{items:null!==(e=null==n?void 0:n.data)&&void 0!==e?e:rt,columns:m,pagination:!0,sorting:O})},pt=l.a.memo(jt),xt=({fill:e=!0})=>{const t=Object(N.e)().services.application.capabilities.osquery,a=Object(N.f)("packs/add");return Object(x.jsx)(s.EuiButton,u()({fill:!!e},a,{iconType:"plusInCircle",isDisabled:!t.writePacks,"data-test-subj":"add-pack-button"}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.packList.addPackButtonLabel",defaultMessage:"Add pack"}))},mt=l.a.memo(xt),Ot="integrationAssetsStatus",gt=()=>{const{http:e}=Object(N.e)().services;return Object(h.useQuery)([Ot],(()=>e.get("/internal/osquery/assets",{version:I.a.internal.v1})),{keepPreviousData:!0,retry:!1})},vt=_.i18n.translate("xpack.osquery.packList.prePackagedPacks.emptyPromptTitle",{defaultMessage:"Load Elastic prebuilt packs"}),ft=_.i18n.translate("xpack.osquery.packList.prePackagedPacks.loadButtonLabel",{defaultMessage:"Load Elastic prebuilt packs"}),yt=_.i18n.translate("xpack.osquery.packList.prePackagedPacks.updateButtonLabel",{defaultMessage:"Update Elastic prebuilt packs"}),kt=_.i18n.translate("xpack.osquery.packList.integrationAssets.loadSuccessToastMessageText",{defaultMessage:"Successfully loaded prebuilt packs"}),ht=_.i18n.translate("xpack.osquery.packList.integrationAssets.updateSuccessToastMessageText",{defaultMessage:"Successfully updated prebuilt packs"}),Et=_.i18n.translate("xpack.osquery.packList.prePackagedPacks.emptyPromptTitle.emptyPromptMessage",{defaultMessage:"A pack is a set of queries that you can schedule. Load prebuilt packs or create your own."}),St=({fill:e})=>{var t;const{data:a}=gt(),{isLoading:l,mutateAsync:n}=(({successToastText:e})=>{const t=Object(h.useQueryClient)(),{http:a,notifications:{toasts:s}}=Object(N.e)().services,i=Object(He.a)();return Object(h.useMutation)((()=>a.post("/internal/osquery/assets/update",{version:I.a.internal.v1})),{onSuccess:()=>{i(),t.invalidateQueries([Ke.a]),t.invalidateQueries([Ot]),s.addSuccess(e)},onError:e=>{i(e)}})})({successToastText:null!=a&&null!==(t=a.upToDate)&&void 0!==t&&t.length?ht:kt}),o=Object(i.useCallback)((()=>n()),[n]);var r;return null!=a&&a.install.length||null!=a&&a.update.length?Object(x.jsx)(s.EuiButton,{fill:!!e,isLoading:l,onClick:o,iconType:"plusInCircle"},null!=a&&null!==(r=a.upToDate)&&void 0!==r&&r.length?yt:ft):null},Ct=l.a.memo(St);var Mt=a(63);const qt=()=>{const e=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,null,Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(Ct,{fill:!0})),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(mt,{fill:!1})))),[]);return Object(x.jsx)(s.EuiEmptyPrompt,{icon:Object(x.jsx)(Mt.a,null),color:"transparent",title:Object(x.jsx)("h2",null,vt),body:Object(x.jsx)("p",null,Et),actions:e})},Ft=l.a.memo(qt),Tt=()=>{var e;const{data:t,isLoading:a}=gt(),{data:l,isLoading:n}=Object(D.a)({}),o=Object(i.useMemo)((()=>{var e;return!(null!=l&&l.total)&&(null==t||null===(e=t.install)||void 0===e?void 0:e.length)}),[null==t||null===(e=t.install)||void 0===e?void 0:e.length,null==l?void 0:l.total]),r=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{direction:"column",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,null,Object(x.jsx)("h1",null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.packList.pageTitle",defaultMessage:"Packs"})))),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,{color:"subdued"},Object(x.jsx)("p",null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.packList.pageSubtitle",defaultMessage:"Create packs to organize sets of queries and to schedule queries for agent policies."})))))),[]),u=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{direction:"row",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(Ct,{fill:!!o})),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(mt,{fill:!o})))),[o]),c=Object(i.useMemo)((()=>a||n?Object(x.jsx)(s.EuiSkeletonText,{lines:10}):o?Object(x.jsx)(Ft,null):Object(x.jsx)(pt,null)),[a,n,o]);return Object(x.jsx)(Z,{leftColumn:r,rightColumn:u,rightColumnGrow:!1},c)},wt=l.a.memo(Tt);var _t=a(92),It=a(74);const Pt=({index:e,control:t,hideLabel:a,options:l})=>{const{data:{agentPoliciesById:n}={}}=Object(It.a)(),o=Object(i.useCallback)((e=>e?void 0:_.i18n.translate("xpack.osquery.pack.form.shardsPolicyFieldMissingErrorMessage",{defaultMessage:"Policy is a required field"})),[]),{field:{onChange:r,value:u},fieldState:{error:c}}=Object(qe.useController)({control:t,name:`shardsArray.${e}.policy`,rules:{validate:o}}),d=Object(i.useMemo)((()=>!(null==c||!c.message)),[null==c?void 0:c.message]),[b,j]=Object(i.useState)([]),p=Object(i.useCallback)((e=>{j(e),r(e[0])}),[r]);Object(i.useEffect)((()=>{const e=null==n?void 0:n[u.key];u&&e&&j([{label:u.label||e.name,value:u.key}])}),[n,u]);const m=Object(i.useMemo)((()=>({asPlainText:!0})),[]);return Object(x.jsx)(s.EuiFormRow,{label:a?"":_.i18n.translate("xpack.osquery.pack.form.policyFieldLabel",{defaultMessage:"Policy"}),error:null==c?void 0:c.message,isInvalid:d,fullWidth:!0},Object(x.jsx)(s.EuiComboBox,{fullWidth:!0,singleSelection:m,isInvalid:d,options:l,selectedOptions:b,onChange:p,"data-test-subj":"shards-field-policy",rowHeight:32,isClearable:!0}))},Nt=l.a.memo(Pt),Lt=({index:e,control:t,euiFieldProps:a,hideLabel:l})=>{const{field:{onChange:n,value:o},fieldState:{error:r}}=Object(qe.useController)({control:t,name:`shardsArray.${e}.percentage`,defaultValue:100}),c=Object(i.useCallback)((e=>{const t=e.target.valueAsNumber?e.target.valueAsNumber:0;n(t)}),[n]),d=Object(i.useMemo)((()=>!(null==r||!r.message)),[null==r?void 0:r.message]);return Object(x.jsx)(s.EuiFormRow,{label:l?"":_.i18n.translate("xpack.osquery.pack.form.percentageFieldLabel",{defaultMessage:"Shard"}),error:null==r?void 0:r.message,isInvalid:d,fullWidth:!0},Object(x.jsx)(s.EuiFlexGroup,{gutterSize:"s"},Object(x.jsx)(s.EuiFlexItem,{grow:10},Object(x.jsx)(s.EuiRange,u()({"data-test-subj":"shards-field-percentage",id:"shardsPercentage"+e,min:0,max:100,step:1,value:o,fullWidth:!0,showInput:!0,showLabels:!1,append:"%",onChange:c},a)))))},Bt=l.a.memo(Lt);var At=a(66);const Qt=({onDelete:e,index:t,isLastItem:a,control:n,options:o})=>{const r=Object(i.useCallback)((()=>{e&&e(t)}),[t,e]),u=Object(i.useCallback)((({euiTheme:e})=>0===t?{marginTop:e.size.base}:{}),[t]);return Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(s.EuiFlexGroup,{"data-test-subj":`packShardsForm-${t}`,alignItems:"flexStart",gutterSize:"s"},Object(x.jsx)(s.EuiFlexItem,{css:At.a},Object(x.jsx)(Nt,{index:t,control:n,hideLabel:0!==t,options:o})),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(x.jsx)(s.EuiFlexItem,{grow:!0},Object(x.jsx)(Bt,{index:t,control:n,hideLabel:0!==t})),Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)("div",{css:u},Object(x.jsx)(s.EuiButtonIcon,{"aria-label":_.i18n.translate("xpack.osquery.pack.form.deleteShardsRowButtonAriaLabel",{defaultMessage:"Delete shards row"}),iconType:"trash",color:"text",disabled:a,onClick:r})))))),Object(x.jsx)(s.EuiSpacer,{size:"s"}))},zt=l.a.memo(Qt),Dt={policy:{label:"",key:""},percentage:100},Rt=({options:e})=>{const{watch:t,register:a,setValue:n,formState:{errors:o}}=Object(qe.useFormContext)(),{data:{agentPoliciesById:r}={}}=Object(It.a)(),u=t("shards"),c=Object(i.useMemo)((()=>{const e=Object(_t.c)(u,r);return Object(f.isEmpty)(e)?[Dt]:e[e.length-1].policy.key?[...e,Dt]:e}),[r,u]),{control:d,watch:b,getFieldState:j,formState:p,resetField:m,setValue:O}=Object(qe.useForm)({mode:"all",shouldUnregister:!0,defaultValues:{shardsArray:c}}),{fields:g,remove:v,append:y}=Object(qe.useFieldArray)({control:d,name:"shardsArray"}),k=b(),h=j("shardsArray",p);return Object(i.useEffect)((()=>{a("shards",{validate:()=>!Object(f.reject)(h.error,f.isEmpty).length})}),[h.error,o,a]),Object(i.useEffect)((()=>{const e=b(((e,t)=>{if(null!=e&&e.shardsArray){var a,s;const l=(null==e||null===(a=e.shardsArray)||void 0===a?void 0:a.length)-1;if(null!==(s=t.name)&&void 0!==s&&s.startsWith(`shardsArray.${l}.`)){var i;const t=Object(f.last)(e.shardsArray);null!=t&&null!==(i=t.policy)&&void 0!==i&&i.key&&y(Dt)}}}));return()=>e.unsubscribe()}),[k,y,b]),Object(i.useEffect)((()=>{const e=Object(_t.d)(k.shardsArray);h.isDirty&&!ve()(e,u)&&n("shards",e,{shouldTouch:!0})}),[n,k,h.isDirty,u,m,O]),Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(s.EuiSpacer,{size:"s"}),g.map(((t,a,i)=>Object(x.jsx)(s.EuiFlexItem,{key:t.id},Object(x.jsx)(zt,{index:a,onDelete:v,isLastItem:a===i.length-1,control:d,options:e}),Object(x.jsx)(s.EuiSpacer,{size:"xs"})))))},Gt=l.a.memo(Rt);var $t=a(81),Ut=a.n($t);const Vt=Ut()(s.EuiFlexItem,{target:"e1ami9i00"})("max-width:",(({grow:e})=>e/9*100),";overflow:hidden;"),Wt=({euiFieldProps:e,options:t})=>{const{data:{agentPoliciesById:a}={}}=Object(It.a)(),{field:{onChange:l,value:n},fieldState:{error:o}}=Object(qe.useController)({name:"policy_ids",defaultValue:[],rules:{}}),r=Object(i.useMemo)((()=>a?Object(f.castArray)(n).map((e=>{var t,s;return{key:e,label:null!==(t=null===(s=a[e])||void 0===s?void 0:s.name)&&void 0!==t?t:e}})):[]),[a,n]),c=Object(i.useCallback)((e=>{l(e.map((e=>e.key||e.label)))}),[l]),d=Object(i.useCallback)((e=>{var t,i,l,n,o;return Object(x.jsx)(s.EuiFlexGroup,null,Object(x.jsx)(Vt,{grow:2},Object(x.jsx)("span",{className:"eui-textTruncate"},null!==(t=e.key&&(null==a||null===(i=a[e.key])||void 0===i?void 0:i.name))&&void 0!==t?t:e.label)),Object(x.jsx)(Vt,{grow:5},Object(x.jsx)(s.EuiTextColor,{className:"eui-textTruncate",color:"subdued"},null!==(l=e.key&&(null==a?void 0:a[e.key].description))&&void 0!==l?l:"")),Object(x.jsx)(s.EuiFlexItem,{grow:2,className:"eui-textRight"},Object(x.jsx)(s.EuiTextColor,{color:"subdued"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.createScheduledQuery.agentPolicyAgentsCountText",defaultMessage:"{count, plural, one {# agent} other {# agents}} enrolled",values:{count:null!==(n=e.key&&(null==a||null===(o=a[e.key])||void 0===o?void 0:o.agents))&&void 0!==n?n:0}}))))}),[a]),b=Object(i.useMemo)((()=>{if(null==n||!n.length||!n[0].length||!a)return Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.pack.form.agentPoliciesFieldHelpText",defaultMessage:"Queries in this pack are scheduled for agents in the selected policies."});const e=Object(f.reduce)(n,((e,t)=>{var s;const i=a&&a[t];return e+(null!==(s=null==i?void 0:i.agents)&&void 0!==s?s:0)}),0);return Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.createScheduledQuery.agentPolicyAgentsCountText",defaultMessage:"{count, plural, one {# agent} other {# agents}} enrolled",values:{count:e}})}),[a,n]),j=Object(i.useMemo)((()=>!(null==o||!o.message)),[null==o?void 0:o.message]);return Object(x.jsx)(s.EuiFormRow,{label:_.i18n.translate("xpack.osquery.pack.form.agentPoliciesFieldLabel",{defaultMessage:"Scheduled agent policies (optional)"}),helpText:b,error:null==o?void 0:o.message,isInvalid:j,fullWidth:!0},Object(x.jsx)(s.EuiComboBox,u()({isInvalid:j,selectedOptions:r,fullWidth:!0,"data-test-subj":"policyIdsComboBox",isClearable:!0,options:t,renderOption:d,onChange:c},e)))},Ht=l.a.memo(Wt,ve.a);var Xt=a(49),Kt=a(110),Yt=a(108);const Jt=({platform:e})=>{const[t,a]=Object(i.useState)(Kt.a);Object(i.useEffect)((()=>{a((t=>{if(e){let a;try{a=null==e?void 0:e.split(",").map((e=>e.trim()))}catch(e){return t}return a}return Kt.a}))}),[e]);const l=Object(i.useMemo)((()=>t.map((e=>Object(x.jsx)(s.EuiFlexItem,{key:e,grow:!1},Object(x.jsx)(Yt.a,{platform:e}))))),[t]);return Object(x.jsx)(s.EuiFlexGroup,{gutterSize:"s"},l)},Zt=l.a.memo(Jt),ea=({data:e,isReadOnly:t,onDeleteClick:a,onEditClick:l,selectedItems:n,setSelectedItems:o})=>{const r=Object(i.useCallback)((e=>Object(x.jsx)(s.EuiButtonIcon,{color:"danger",onClick:()=>a&&a(e),iconType:"trash","aria-label":_.i18n.translate("xpack.osquery.pack.queriesTable.deleteActionAriaLabel",{defaultMessage:"Delete {queryName}",values:{queryName:e.id}})})),[a]),c=Object(i.useCallback)((e=>Object(x.jsx)(s.EuiButtonIcon,{color:"primary",onClick:()=>l&&l(e),iconType:"pencil","aria-label":_.i18n.translate("xpack.osquery.pack.queriesTable.editActionAriaLabel",{defaultMessage:"Edit {queryName}",values:{queryName:e.id}})})),[l]),d=Object(i.useCallback)((e=>Object(x.jsx)(s.EuiCodeBlock,{language:"sql",fontSize:"s",paddingSize:"none",transparentBackground:!0},e)),[]),b=Object(i.useCallback)((e=>Object(x.jsx)(Zt,{platform:e})),[]),j=Object(i.useCallback)((e=>e?`${e}`:_.i18n.translate("xpack.osquery.pack.queriesTable.osqueryVersionAllLabel",{defaultMessage:"ALL"})),[]),p=Object(i.useMemo)((()=>[{field:"id",name:_.i18n.translate("xpack.osquery.pack.queriesTable.idColumnTitle",{defaultMessage:"ID"}),width:"20%"},{field:"interval",name:_.i18n.translate("xpack.osquery.pack.queriesTable.intervalColumnTitle",{defaultMessage:"Interval (s)"}),width:"100px"},{field:"query",name:_.i18n.translate("xpack.osquery.pack.queriesTable.queryColumnTitle",{defaultMessage:"Query"}),render:d},{field:"platform",name:_.i18n.translate("xpack.osquery.pack.queriesTable.platformColumnTitle",{defaultMessage:"Platform"}),render:b},{field:"version",name:_.i18n.translate("xpack.osquery.pack.queriesTable.versionColumnTitle",{defaultMessage:"Min Osquery version"}),render:j},...t?[]:[{name:_.i18n.translate("xpack.osquery.pack.queriesTable.actionsColumnTitle",{defaultMessage:"Actions"}),width:"120px",actions:[{render:c},{render:r}]}]]),[t,r,c,b,d,j]),m=Object(i.useMemo)((()=>({sort:{field:"id",direction:"asc"}})),[]),O=Object(i.useCallback)((e=>{var t;return null!==(t=e.id)&&void 0!==t?t:""}),[]),g=Object(i.useMemo)((()=>({onSelectionChange:o,initialSelected:n})),[n,o]);return Object(x.jsx)(s.EuiBasicTable,u()({items:e,itemId:O,columns:p,sorting:m},t?{}:{selection:g,isSelectable:!0}))},ta=l.a.memo(ea);var aa=a(124),sa=a(113),ia=a(107),la=a(112);const na=e=>Object(Xt.produce)(e,(e=>(Object(f.isArray)(e.platform)&&(e.platform.length?e.platform.join(","):delete e.platform),Object(f.isArray)(e.version)&&(e.version.length?e.version=e.version[0]:delete e.version),e.interval&&(e.interval=e.interval+""),Object(f.isEmpty)(e.ecs_mapping)&&delete e.ecs_mapping,e)));var oa=a(118),ra=a(88);const ua=({uniqueQueryIds:e,defaultValue:t,onSave:a,onClose:n})=>{const o=Object(N.e)().services.application.capabilities.osquery,[r]=Object(i.useState)(!!t),{serializer:u,idSet:c,...d}=(({uniqueQueryIds:e,defaultValue:t})=>{const a=Object(i.useMemo)((()=>new Set(Object(f.xor)(e,null!=t&&t.id?[t.id]:[]))),[e,t]);return{serializer:na,idSet:a,...Object(qe.useForm)({defaultValues:t?(s=t,{id:s.id,query:s.query,interval:s.interval?parseInt(s.interval,10):3600,timeout:s.timeout||I.g.DEFAULT,snapshot:s.snapshot,removed:s.removed,platform:s.platform,version:s.version?[s.version]:[],ecs_mapping:null!==(l=s.ecs_mapping)&&void 0!==l?l:{}}):{id:"",query:"",interval:3600,snapshot:!0,removed:!1}})};var s,l})({uniqueQueryIds:e,defaultValue:t}),{handleSubmit:b,formState:{isSubmitting:j},resetField:p}=d,m=Object(i.useCallback)((e=>{var t,a;e&&(p("id",{defaultValue:e.id}),p("query",{defaultValue:e.query}),p("platform",{defaultValue:e.platform?e.platform:I.e}),p("version",{defaultValue:e.version?[e.version]:[]}),p("interval",{defaultValue:e.interval?e.interval:3600}),p("timeout",{defaultValue:e.timeout?e.timeout:I.g.DEFAULT}),p("snapshot",{defaultValue:null===(t=e.snapshot)||void 0===t||t}),p("removed",{defaultValue:e.removed}),p("ecs_mapping",{defaultValue:null!==(a=e.ecs_mapping)&&void 0!==a?a:{}}))}),[p]);return Object(x.jsx)(s.EuiFlyout,{size:"m",onClose:n,"aria-labelledby":"flyoutTitle",ownFocus:!0,outsideClickCloses:!1},Object(x.jsx)(s.EuiFlyoutHeader,{hasBorder:!0},Object(x.jsx)(s.EuiTitle,{size:"s"},Object(x.jsx)("h2",{id:"flyoutTitle"},r?Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.queryFlyoutForm.editFormTitle",defaultMessage:"Edit query"}):Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.queryFlyoutForm.addFormTitle",defaultMessage:"Attach next query"})))),Object(x.jsx)(s.EuiFlyoutBody,null,Object(x.jsx)(qe.FormProvider,d,!r&&o.readSavedQueries?Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(oa.a,{onChange:m}),Object(x.jsx)(s.EuiSpacer,null)):null,Object(x.jsx)(aa.c,{idSet:c}),Object(x.jsx)(s.EuiSpacer,null),Object(x.jsx)(sa.a,null),Object(x.jsx)(s.EuiSpacer,null),Object(x.jsx)(s.EuiFlexGroup,null,Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(aa.a,{euiFieldProps:{append:"s"}}),Object(x.jsx)(s.EuiSpacer,null),Object(x.jsx)(aa.f,{euiFieldProps:{noSuggestions:!1,singleSelection:{asPlainText:!0},placeholder:_.i18n.translate("xpack.osquery.queriesTable.osqueryVersionAllLabel",{defaultMessage:"ALL"}),options:la.a,onCreateOption:void 0}}),Object(x.jsx)(s.EuiSpacer,null),Object(x.jsx)(aa.d,null)),Object(x.jsx)(s.EuiFlexGroup,{direction:"column",justifyContent:"spaceBetween"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(ia.a,null)),Object(x.jsx)(s.EuiFlexItem,{grow:0},Object(x.jsx)(aa.e,null)))),Object(x.jsx)(s.EuiSpacer,null),Object(x.jsx)(s.EuiFlexGroup,null,Object(x.jsx)(s.EuiFlexItem,{css:At.a},Object(x.jsx)(ra.a,null))))),Object(x.jsx)(s.EuiFlyoutFooter,null,Object(x.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiButtonEmpty,{"data-test-subj":"query-flyout-cancel-button",iconType:"cross",onClick:n,flush:"left"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.queryFlyoutForm.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiButton,{"data-test-subj":"query-flyout-save-button",isLoading:j,onClick:b((async e=>{const t=u(e);await a(t),n()})),fill:!0},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.queryFlyoutForm.saveButtonLabel",defaultMessage:"Save"}))))))},ca=l.a.memo(ua),da=["application/json","text/plain"],ba=l.a.memo((()=>Object(x.jsx)(s.EuiLink,{href:"https://github.com/osquery/osquery/tree/master/packs",target:"_blank"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.packUploader.examplePacksLinkLabel",defaultMessage:"Example packs"}))));ba.displayName="ExamplePackLink";const ja=({onChange:e})=>{const t=Object(i.useRef)(""),a=Object(i.useRef)(null),[n,o]=Object(i.useState)(null);let r;const u=()=>{var s,i;const l=r.result;let n;try{n=JSON.parse(l.replaceAll("\\\n",""),((e,t)=>"query"===e?t.replaceAll(/\s(?=\s)/gm,""):"interval"===e?`${t}`:t)),o(null)}catch(e){var u;o(e),null===(u=a.current)||void 0===u||u.removeFiles(new Event("fake"))}null!==(s=n)&&void 0!==s&&s.queries&&(e(n,t.current),null===(i=a.current)||void 0===i||i.removeFiles(new Event("fake")))},c=e=>{r=new FileReader,r.onloadend=u,r.readAsText(e)},d=Object(i.useCallback)((e=>{var s;if(e.length){var i;if(e.length&&(null!==(s=!!e[0].type.length&&!da.includes(e[0].type))&&void 0!==s?s:!e[0].name.endsWith(".conf")))return t.current="",o(_.i18n.translate("xpack.osquery.packUploader.unsupportedFileTypeText",{defaultMessage:"File type {fileType} is not supported, please upload {supportedFileTypes} config file",values:{fileType:e[0].type,supportedFileTypes:da.join(" or ")}})),void(null===(i=a.current)||void 0===i||i.removeFiles(new Event("fake")));t.current=Object(f.kebabCase)(e[0].name.split(".")[0]),c(e[0])}else t.current=""}),[c]);return Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(s.EuiSpacer,{size:"xl"}),Object(x.jsx)(s.EuiFormRow,{fullWidth:!0,labelAppend:Object(x.jsx)(ba,null),isInvalid:!!n,error:Object(x.jsx)(l.a.Fragment,null,`${n}`)},Object(x.jsx)(s.EuiFilePicker,{ref:a,id:"osquery_pack_picker",initialPromptText:_.i18n.translate("xpack.osquery.packUploader.initialPromptTextLabel",{defaultMessage:"Select or drag and drop osquery pack config file"}),onChange:d,display:"large",fullWidth:!0,isInvalid:!!n,accept:da.join(",")})))},pa=l.a.memo(ja);var xa=a(109);const ma=({euiFieldProps:e})=>{const{field:{value:t}}=Object(qe.useController)({name:"queries",defaultValue:[],rules:{}}),{append:a,remove:n,update:o,replace:r}=Object(qe.useFieldArray)({name:"queries"}),{setValue:u}=Object(qe.useFormContext)(),{name:c}=Object(qe.useWatch)(),d=Object(i.useCallback)((e=>Object(f.isEmpty)(c)&&u("name",e)),[c,u]),b=!(null==e||!e.isDisabled),[j,p]=Object(i.useState)(!1),[m,O]=Object(i.useState)(-1),[g,v]=Object(i.useState)([]),y=Object(i.useCallback)((()=>p(!0)),[]),h=Object(i.useCallback)((()=>p(!1)),[]),E=Object(i.useCallback)((()=>O(-1)),[]),S=Object(i.useCallback)((e=>{const a=Object(f.findIndex)(t,["id",e.id]);a>-1&&n(a)}),[t,n]),C=Object(i.useCallback)((e=>{const a=Object(f.findIndex)(t,["id",e.id]);O(a)}),[t]),M=Object(i.useCallback)((e=>new Promise((t=>{m>=0&&o(m,Object(Xt.produce)({},(t=>{var a,s;return t.id=e.id,t.interval=e.interval,t.query=e.query,t.timeout=e.timeout,null!==(a=e.platform)&&void 0!==a&&a.length&&(t.platform=e.platform),null!==(s=e.version)&&void 0!==s&&s.length&&(t.version=e.version),e.ecs_mapping&&(t.ecs_mapping=e.ecs_mapping),t.snapshot=e.snapshot,t.removed=e.removed,t}))),E(),t()}))),[E,o,m]),q=Object(i.useCallback)((e=>new Promise((t=>{a(e),h(),t()}))),[h,a]),F=Object(i.useCallback)((()=>{const e=Object(f.map)(g,(e=>Object(f.indexOf)(t,e)));n(e),v([])}),[t,n,g]),T=Object(i.useCallback)(((e,t)=>{r(Object(f.map)(e.queries,((t,a)=>{var s,i,l,n,o,r,u,c;return Object(f.pickBy)({id:a,interval:null!==(s=null!==(i=t.interval)&&void 0!==i?i:e.interval)&&void 0!==s?s:"3600",timeout:null!==(l=null!==(n=t.timeout)&&void 0!==n?n:e.timeout)&&void 0!==l?l:I.g.DEFAULT,query:t.query,version:null!==(o=t.version)&&void 0!==o?o:e.version,snapshot:null!==(r=t.snapshot)&&void 0!==r?r:e.snapshot,removed:null!==(u=t.removed)&&void 0!==u?u:e.removed,platform:Object(xa.b)(null!==(c=t.platform)&&void 0!==c?c:e.platform)},(e=>!Object(f.isEmpty)(e)||!1===e))}))),d(t)}),[d,r]),w=Object(i.useMemo)((()=>null!=t&&t.length?t:[]),[t]),_=Object(i.useMemo)((()=>Object(f.uniq)(Object(f.map)(t,"id"))),[t]);return Object(x.jsx)(l.a.Fragment,null,!b&&Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(s.EuiFlexGroup,{justifyContent:"flexEnd"},Object(x.jsx)(s.EuiFlexItem,{grow:!1},g.length?Object(x.jsx)(s.EuiButton,{color:"danger",onClick:F,iconType:"trash"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.pack.table.deleteQueriesButtonLabel",defaultMessage:"Delete {queriesCount, plural, one {# query} other {# queries}}",values:{queriesCount:g.length}})):Object(x.jsx)(s.EuiButton,{"data-test-subj":"add-query-button",fill:!0,onClick:y,iconType:"plusInCircle"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.pack.queriesForm.addQueryButtonLabel",defaultMessage:"Add query"})))),Object(x.jsx)(s.EuiSpacer,null)),null!=t&&t.length?Object(x.jsx)(ta,{data:w,isReadOnly:b,onEditClick:C,onDeleteClick:S,selectedItems:g,setSelectedItems:v}):null,Object(x.jsx)(s.EuiSpacer,null),!b&&Object(x.jsx)(pa,{onChange:T}),j&&Object(x.jsx)(ca,{uniqueQueryIds:_,onSave:q,onClose:h}),null!=m&&m>=0&&Object(x.jsx)(ca,{uniqueQueryIds:_,defaultValue:t[m],onSave:M,onClose:E}))},Oa=l.a.memo(ma,ve.a),ga=e=>Object(f.reduce)(e,((e,{id:t,...a})=>(e[t]=a,e)),{}),va=({euiFieldProps:e})=>{const{field:{onChange:t,value:a,name:l},fieldState:{error:n}}=Object(qe.useController)({name:"name",defaultValue:"",rules:{pattern:{value:/^[a-zA-Z0-9-_]+$/,message:_.i18n.translate("xpack.osquery.pack.queryFlyoutForm.invalidIdError",{defaultMessage:"Characters must be alphanumeric, _, or -"})},required:_.i18n.translate("xpack.osquery.pack.form.nameFieldRequiredErrorMessage",{defaultMessage:"Name is a required field"})}}),o=Object(i.useMemo)((()=>!(null==n||!n.message)),[null==n?void 0:n.message]);return Object(x.jsx)(s.EuiFormRow,{label:_.i18n.translate("xpack.osquery.pack.form.nameFieldLabel",{defaultMessage:"Name"}),error:null==n?void 0:n.message,isInvalid:o,fullWidth:!0},Object(x.jsx)(s.EuiFieldText,u()({isInvalid:o,onChange:t,value:a,name:l,fullWidth:!0,"data-test-subj":"input"},e)))},fa=l.a.memo(va),ya=({euiFieldProps:e})=>{const{field:{onChange:t,value:a,name:l},fieldState:{error:n}}=Object(qe.useController)({name:"description",defaultValue:""}),o=Object(i.useMemo)((()=>!(null==n||!n.message)),[null==n?void 0:n.message]);return Object(x.jsx)(s.EuiFormRow,{label:_.i18n.translate("xpack.osquery.pack.form.descriptionFieldLabel",{defaultMessage:"Description (optional)"}),error:null==n?void 0:n.message,isInvalid:o,fullWidth:!0},Object(x.jsx)(s.EuiFieldText,u()({isInvalid:o,onChange:t,value:a,name:l,fullWidth:!0,"data-test-subj":"input"},e)))},ka=l.a.memo(ya),ha=Ut()(s.EuiCard,{target:"e2j9yjr0"})("padding:16px 92px 16px 16px!important;border:",(({theme:e,selectable:t})=>{if(null!=t&&t.isSelected)return`${e.euiTheme.border.width.thin} solid ${e.euiTheme.colors.success}`}),";.euiTitle{font-size:1rem;}.euiSpacer{display:none;}.euiText{margin-top:0;margin-left:25px;color:",(({theme:e})=>e.euiTheme.colors.subduedText),";}>button[role='switch']{display:none;}"),Ea=({packType:e,setPackType:t,resetFormFields:a})=>{const l=Object(i.useCallback)((e=>{t(e),a&&a()}),[a,t]),n=Object(i.useMemo)((()=>({onClick:()=>l("policy"),isSelected:"policy"===e})),[e,l]),o=Object(i.useMemo)((()=>({onClick:()=>l("global"),isSelected:"global"===e})),[e,l]);return Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiFormRow,{label:"Type",fullWidth:!0},Object(x.jsx)(s.EuiFlexGroup,{gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(ha,u()({layout:"horizontal",title:Object(x.jsx)(s.EuiRadio,{id:"osquery_pack_type_policy",label:_.i18n.translate("xpack.osquery.pack.form.policyLabel",{defaultMessage:"Policy"}),onChange:f.noop,checked:"policy"===e}),titleSize:"xs",hasBorder:!0,description:_.i18n.translate("xpack.osquery.pack.form.policyDescription",{defaultMessage:"Schedule pack for specific policy."}),"data-test-subj":"osqueryPackTypePolicy",selectable:n},"policy"===e&&{color:"primary"}))),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(ha,u()({layout:"horizontal",title:Object(x.jsx)(s.EuiRadio,{id:"osquery_pack_type_global",label:_.i18n.translate("xpack.osquery.pack.form.globalLabel",{defaultMessage:"Global"}),onChange:f.noop,checked:"global"===e}),titleSize:"xs",description:_.i18n.translate("xpack.osquery.pack.form.globalDescription",{defaultMessage:"Use pack across all policies"}),selectable:o,"data-test-subj":"osqueryPackTypeGlobal"},"global"===e&&{color:"primary"}))))))},Sa=l.a.memo(Ea),Ca=({euiTheme:e})=>({".euiAccordion__button":{color:e.colors.primary}}),Ma=({defaultValue:e,editMode:t=!1,isReadOnly:a=!1})=>{const[n,o]=Object(i.useState)("closed"),r=Object(i.useCallback)((e=>{o(e?"open":"closed")}),[]),[c,d]=Object(i.useState)("policy"),[b,j]=Object(i.useState)(!1),p=Object(i.useCallback)((()=>j(!1)),[]),{data:{agentPoliciesById:m}={}}=Object(It.a)(),O=Object(N.f)(`packs/${t?null==e?void 0:e.id:""}`),{mutateAsync:g}=(({withRedirect:e})=>{const t=Object(h.useQueryClient)(),{application:{navigateToApp:a},http:s,notifications:{toasts:i}}=Object(N.e)().services,l=Object(He.a)();return Object(h.useMutation)((e=>s.post("/api/osquery/packs",{version:I.a.public.v1,body:JSON.stringify(e)})),{onError:e=>{l(e,{title:e.body.error,toastMessage:e.body.message})},onSuccess:s=>{var l,n;t.invalidateQueries([Ke.a]),e&&a(Xe.PLUGIN_ID,{path:P.a.packs()}),i.addSuccess(_.i18n.translate("xpack.osquery.newPack.successToastMessageText",{defaultMessage:'Successfully created "{packName}" pack',values:{packName:null!==(l=null===(n=s.data)||void 0===n?void 0:n.name)&&void 0!==l?l:""}}))}})})({withRedirect:!0}),{mutateAsync:v}=Ye({withRedirect:!0}),y=Object(qe.useForm)({defaultValues:e?(e=>{var t;const a=Object(f.filter)(e.policy_ids,(t=>{var a;return null==(null===(a=e.shards)||void 0===a?void 0:a[t])}));return{...e,policy_ids:null!=a?a:[],queries:(s=e.queries,Object(f.reduce)(s,((e,t,a)=>(e.push({id:a,...Object(f.pick)(t,["query","interval","timeout","snapshot","removed","platform","version","ecs_mapping"])}),e)),[])),shards:null!==(t=Object(f.omit)(e.shards,"*"))&&void 0!==t?t:{}};var s})(e):{name:"",description:"",policy_ids:[],enabled:!0,queries:[]}});Object(i.useEffect)((()=>{var t;Object(f.isEmpty)(null==e?void 0:e.shards)||(null!=e&&null!==(t=e.shards)&&void 0!==t&&t["*"]?d("global"):o("open"))}),[e,null==e?void 0:e.shards]);const{handleSubmit:E,watch:S,formState:{isSubmitting:C}}=y,{policy_ids:M,shards:q}=S(),F=Object(i.useCallback)((()=>"global"===c?{"*":100}:Object(f.reduce)(q,((e,t,a)=>Object(f.isEmpty)(a)?e:{...e,[a]:t}),{})),[c,q]),T=Object(i.useCallback)((async a=>{const s=({shards:e,policy_ids:t,queries:a,...s})=>{var i;const l=[...t,...Object(f.isEmpty)(q)?[]:Object(f.filter)(Object(f.map)(q,((e,t)=>{if(!Object(f.isEmpty)(t))return t})))];return{...s,policy_ids:null!=l?l:[],queries:ga(a),shards:null!==(i=F())&&void 0!==i?i:{}}};try{t&&null!=e&&e.saved_object_id?await v({id:null==e?void 0:e.saved_object_id,...s(a)}):await g(s(a))}catch(e){}}),[g,null==e?void 0:e.saved_object_id,t,F,q,v]),w=Object(i.useMemo)((()=>E(T)),[E,T]),L=Object(i.useMemo)((()=>Object(f.reduce)(M,((e,t)=>{var a;const s=m&&m[t];return e+(null!==(a=null==s?void 0:s.agents)&&void 0!==a?a:0)}),0)),[M,m]),B=Object(i.useCallback)((()=>{L?j(!0):w()}),[L,w]),A=Object(i.useCallback)((()=>{w(),j(!1)}),[w]),Q=Object(i.useMemo)((()=>({isDisabled:a})),[a]),z=Object(i.useCallback)((e=>{d(e)}),[d]),D=Object(i.useMemo)((()=>Object.entries(null!=m?m:{}).map((([e,t])=>({key:e,label:t.name})))),[m]),R=Object(i.useMemo)((()=>{const e=[...Object(f.map)(q,((e,t)=>t)),...Object(f.map)(M,(e=>e))];return D.filter((({key:t})=>!e.includes(t)))}),[q,M,D]);return Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(qe.FormProvider,y,Object(x.jsx)(s.EuiFlexGroup,null,Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(fa,{euiFieldProps:Q}))),Object(x.jsx)(s.EuiSpacer,{size:"m"}),Object(x.jsx)(s.EuiFlexGroup,null,Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(ka,{euiFieldProps:Q}))),Object(x.jsx)(s.EuiSpacer,{size:"m"}),Object(x.jsx)(s.EuiFlexGroup,null,Object(x.jsx)(Sa,{packType:c,setPackType:z})),Object(x.jsx)(s.EuiSpacer,{size:"m"}),"policy"===c&&Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(s.EuiFlexGroup,null,Object(x.jsx)(s.EuiFlexItem,{css:At.a},Object(x.jsx)(Ht,{options:R}))),Object(x.jsx)(s.EuiSpacer,{size:"m"}),Object(x.jsx)(s.EuiFlexGroup,null,Object(x.jsx)(s.EuiFlexItem,{css:At.a},Object(x.jsx)(s.EuiAccordion,{css:Ca,id:"shardsToggle",forceState:n,onToggle:r,buttonContent:"Partial deployment (shards)"},Object(x.jsx)(s.EuiSpacer,{size:"xs"}),Object(x.jsx)(Gt,{options:R})))),Object(x.jsx)(s.EuiSpacer,{size:"m"})),Object(x.jsx)(s.EuiSpacer,{size:"xl"}),Object(x.jsx)(s.EuiHorizontalRule,null),Object(x.jsx)(Oa,{euiFieldProps:Q})),Object(x.jsx)(s.EuiSpacer,{size:"xxl"}),Object(x.jsx)(s.EuiSpacer,{size:"xxl"}),Object(x.jsx)(s.EuiSpacer,{size:"xxl"}),Object(x.jsx)(s.EuiBottomBar,null,Object(x.jsx)(s.EuiFlexGroup,{justifyContent:"flexEnd"},Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiFlexGroup,{gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiButtonEmpty,u()({color:"text"},O),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.pack.form.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiButton,{isLoading:C,color:"primary",fill:!0,size:"m",iconType:"save",onClick:B,"data-test-subj":(t?"update":"save")+"-pack-button"},t?Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.pack.form.updatePackButtonLabel",defaultMessage:"Update pack"}):Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.pack.form.savePackButtonLabel",defaultMessage:"Save pack"}))))))),b&&Object(x.jsx)(We,{onCancel:p,onConfirm:A,agentCount:L,agentPolicyCount:M.length}))},qa=l.a.memo(Ma,ve.a),Fa=()=>{A("pack_add");const e=Object(N.f)("packs"),t=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiButtonEmpty,u()({iconType:"arrowLeft"},e,{flush:"left",size:"xs"}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.addPack.viewPacksListTitle",defaultMessage:"View all packs"}))),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,null,Object(x.jsx)("h1",null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.addPack.pageTitle",defaultMessage:"Add pack"})))))),[e]);return Object(x.jsx)(Z,{leftColumn:t},Object(x.jsx)(qa,null))},Ta=l.a.memo(Fa);var wa=a(79);const _a=()=>{var e,t;const{packId:a}=Object(c.useParams)(),n=Object(N.f)(`packs/${a}`),[o,r]=Object(i.useState)(!1),{isLoading:d,data:b}=Object(wa.a)({packId:a}),j=(({packId:e,withRedirect:t})=>{const a=Object(h.useQueryClient)(),{application:{navigateToApp:s},http:i,notifications:{toasts:l}}=Object(N.e)().services,n=Object(He.a)();return Object(h.useMutation)((()=>i.delete(`/api/osquery/packs/${e}`,{version:I.a.public.v1})),{onError:e=>{n(e,{title:e.body.error,toastMessage:e.body.message})},onSuccess:()=>{a.invalidateQueries([Ke.a]),t&&s(Xe.PLUGIN_ID,{path:P.a.packs()}),l.addSuccess(_.i18n.translate("xpack.osquery.deletePack.successToastMessageText",{defaultMessage:"Successfully deleted pack"}))}})})({packId:a,withRedirect:!0}),p=Object(i.useMemo)((()=>!(null==b||!b.read_only)),[b]);A("pack_edit",{packId:null!==(e=null==b?void 0:b.id)&&void 0!==e?e:"",packName:null!==(t=null==b?void 0:b.name)&&void 0!==t?t:""});const m=Object(i.useCallback)((()=>{r(!1)}),[]),O=Object(i.useCallback)((()=>{r(!0)}),[]),g=Object(i.useCallback)((()=>{j.mutateAsync().then((()=>{m()}))}),[j,m]),v=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiButtonEmpty,u()({iconType:"arrowLeft"},n,{flush:"left",size:"xs"}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.editPack.viewPackListTitle",defaultMessage:"View {queryName} details",values:{queryName:null==b?void 0:b.name}}))),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,null,Object(x.jsx)("h1",null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.editPack.pageTitle",defaultMessage:"Edit {queryName}",values:{queryName:null==b?void 0:b.name}})))))),[null==b?void 0:b.name,n]),f=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiButton,{color:"danger",onClick:O,iconType:"trash"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.editPack.deletePackButtonLabel",defaultMessage:"Delete pack"}))),[O]),y=Object(i.useMemo)((()=>p?Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)(s.EuiSpacer,null),Object(x.jsx)(s.EuiCallOut,null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.editPack.prebuiltPackModeDescription",defaultMessage:"This is a prebuilt Elastic pack. You can modify the scheduled agent policies, but you cannot edit queries in the pack."}))):null),[p]);return d?null:Object(x.jsx)(Z,{leftColumn:v,rightColumn:f,rightColumnGrow:!1,headerChildren:y},b?Object(x.jsx)(qa,{editMode:!0,defaultValue:b,isReadOnly:p}):Object(x.jsx)(s.EuiSkeletonText,{lines:10}),o?Object(x.jsx)(s.EuiConfirmModal,{title:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.deletePack.confirmationModal.title",defaultMessage:"Are you sure you want to delete this pack?"}),onCancel:m,onConfirm:g,confirmButtonDisabled:j.isLoading,cancelButtonText:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.deletePack.confirmationModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.deletePack.confirmationModal.confirmButtonLabel",defaultMessage:"Confirm"}),buttonColor:"danger",defaultFocusedButton:"confirm"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.deletePack.confirmationModal.body",defaultMessage:"You're about to delete this pack. Are you sure you want to do this?"})):null)},Ia=l.a.memo(_a);var Pa=a(127);const Na=({euiTheme:e})=>({width:0,height:"100%",borderLeft:e.border.thin}),La=()=>{var e,t;const a=Object(N.e)().services.application.capabilities.osquery,{packId:l}=Object(c.useParams)(),n=Object(N.f)("packs"),o=Object(N.f)(`packs/${l}/edit`),{data:r}=Object(wa.a)({packId:l}),{data:d}=(({agentPolicyId:e,silent:t,skip:a})=>{const{http:s}=Object(N.e)().services,i=Object(He.a)();return Object(h.useQuery)(["agentPolicyAgentIds",e],(()=>{const t=`${tt.AGENTS_PREFIX}.policy_id:${e}`;return s.get("/internal/osquery/fleet_wrapper/agents",{version:I.a.internal.v1,query:{kuery:t,perPage:1e4}})}),{select:e=>Object(f.map)(null==e?void 0:e.agents,"id")||[],enabled:!a||!e,onSuccess:()=>i(),onError:e=>!t&&i(e,{title:_.i18n.translate("xpack.osquery.agents.fetchError",{defaultMessage:"Error while fetching agents"})}),refetchOnReconnect:!1,refetchOnWindowFocus:!1})})({agentPolicyId:null==r||null===(e=r.policy_ids)||void 0===e?void 0:e[0],skip:!r});A("pack_details",{packName:null!==(t=null==r?void 0:r.name)&&void 0!==t?t:""});const b=Object(i.useMemo)((()=>{var e;return null!==(e=(null==r?void 0:r.queries)&&Object.entries(r.queries).map((([e,t])=>({...t,id:e}))))&&void 0!==e?e:[]}),[r]),j=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"m"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiButtonEmpty,u()({iconType:"arrowLeft"},n,{flush:"left",size:"xs"}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.packDetails.viewAllPackListTitle",defaultMessage:"View all packs"}))),Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiText,null,Object(x.jsx)("h1",null,Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.packDetails.pageTitle",defaultMessage:"{queryName} details",values:{queryName:null==r?void 0:r.name}})))),(null==r?void 0:r.description)&&Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiSpacer,{size:"s"}),Object(x.jsx)(s.EuiText,{color:"subdued",size:"s"},r.description)))),[null==r?void 0:r.description,null==r?void 0:r.name,n]),p=Object(i.useMemo)((()=>Object(x.jsx)(s.EuiFlexGroup,{justifyContent:"flexEnd",direction:"row"},Object(x.jsx)(s.EuiFlexItem,{grow:!1,key:"agents_failed_count"},Object(x.jsx)(s.EuiDescriptionList,{compressed:!0,textStyle:"reverse",style:{textAlign:"right"}},Object(x.jsx)(s.EuiDescriptionListTitle,{className:"eui-textNoWrap"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.packDetailsPage.kpis.policiesLabelText",defaultMessage:"Policies"})),Object(x.jsx)(s.EuiDescriptionListDescription,{className:"eui-textNoWrap"},Object(x.jsx)(bt,{agentPolicyIds:null==r?void 0:r.policy_ids})))),Object(x.jsx)(s.EuiFlexItem,{grow:!1,key:"agents_failed_count_divider"},Object(x.jsx)("div",{css:Na})),Object(x.jsx)(s.EuiFlexItem,{grow:!1,key:"edit_button"},Object(x.jsx)(s.EuiButton,u()({"data-test-subj":"edit-pack-button",fill:!0},o,{iconType:"pencil",isDisabled:!a.writePacks}),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.packDetailsPage.editQueryButtonLabel",defaultMessage:"Edit"}))))),[null==r?void 0:r.policy_ids,o,a]);return Object(x.jsx)(Z,{leftColumn:j,rightColumn:p,rightColumnGrow:!1},r&&Object(x.jsx)(Pa.a,{agentIds:d,packName:r.name,data:b}))},Ba=l.a.memo(La),Aa=()=>{const e=Object(N.e)().services.application.capabilities.osquery;A("packs");const t=Object(c.useRouteMatch)();return e.readPacks?Object(x.jsx)(y,null,Object(x.jsx)(m,{path:`${t.url}/add`},e.writePacks?Object(x.jsx)(Ta,null):Object(x.jsx)(je.a,null)),Object(x.jsx)(m,{path:`${t.url}/:packId/edit`},e.writePacks?Object(x.jsx)(Ia,null):Object(x.jsx)(je.a,null)),Object(x.jsx)(m,{path:`${t.url}/:packId`},Object(x.jsx)(Ba,null)),Object(x.jsx)(m,{path:`${t.url}`},Object(x.jsx)(wt,null))):Object(x.jsx)(je.a,null)},Qa=l.a.memo(Aa),za=()=>(A("base"),Object(x.jsx)(y,null,Object(x.jsx)(m,{path:"/packs"},Object(x.jsx)(Qa,null)),Object(x.jsx)(m,{path:"/saved_queries"},Object(x.jsx)($e,null)),Object(x.jsx)(m,{path:"/live_queries"},Object(x.jsx)(xe,null)),Object(x.jsx)(c.Redirect,{to:"/live_queries"}))),Da=l.a.memo(za);a(48);var Ra=a(12),Ga=a.n(Ra);a(155),a(160);const $a=e=>{const{className:t,size:a,...i}=e,l={};return(e=>void 0===e.iconType)(e)&&(l.iconType=`logo${e.name.replace(/\s+/g,"")}`),Object(x.jsx)(s.EuiAvatar,u()({className:Ga()("kbnSolutionAvatar",{[`kbnSolutionAvatar--${a}`]:a},t),size:"xxl"===a?"xl":a,iconSize:a,color:"plain"},i,l))};a(165);const Ua=_.i18n.translate("sharedUXPackages.solutionNav.collapsibleLabel",{defaultMessage:"Collapse side navigation"}),Va=_.i18n.translate("sharedUXPackages.solutionNav.openLabel",{defaultMessage:"Open side navigation"}),Wa=({className:e,isCollapsed:t,...a})=>{const i=Ga()("kbnSolutionNavCollapseButton",{"kbnSolutionNavCollapseButton-isCollapsed":t},e);return Object(x.jsx)(s.EuiButtonIcon,u()({className:i,size:"s",color:"text",iconType:t?"menuRight":"menuLeft","aria-label":t?Va:Ua,title:t?Va:Ua},a))},Ha=(e,t)=>e.map((e=>(e.tabIndex=t?-1:void 0,e.items=e.items&&Ha(e.items,t),e))),Xa=Object(s.htmlIdGenerator)("SolutionNav"),Ka=({children:e,headingProps:t,icon:a,isOpenOnDesktop:n=!1,items:o,mobileBreakpoints:r=["xs","s"],closeFlyoutButtonPosition:c="outside",name:d,onCollapse:b,canBeCollapsed:j=!0,...p})=>{const m=Object(s.useIsWithinBreakpoints)(r),O=Object(s.useIsWithinBreakpoints)(["m"]),g=Object(s.useIsWithinMinBreakpoint)("l"),[v,f]=Object(i.useState)(!1),y=g&&!n&&j,h=!!e,E=Ga()("kbnSolutionNav",{"kbnSolutionNav--hidden":y}),S=(null==t?void 0:t.id)||Xa("heading"),C=(null==t?void 0:t.element)||"h2",M=Object(x.jsx)(s.EuiTitle,{size:"xs",id:S,"data-test-subj":null==t?void 0:t["data-test-subj"],className:"kbnSolutionNav__title"},Object(x.jsx)(C,null,a&&Object(x.jsx)($a,{className:"kbnSolutionNav__titleAvatar",iconType:a,name:d}),Object(x.jsx)("strong",null,Object(x.jsx)(k.FormattedMessage,{id:"sharedUXPackages.solutionNav.mobileTitleText",defaultMessage:"{solutionName} {menuText}",values:{solutionName:d||"Navigation",menuText:m?_.i18n.translate("sharedUXPackages.solutionNav.menuText",{defaultMessage:"menu"}):""}})))),q=Object(i.useMemo)((()=>h?e:o?Object(x.jsx)(s.EuiSideNav,u()({"aria-labelledby":S,"aria-hidden":y,items:Ha(o,y),mobileBreakpoints:[]},p)):null),[e,S,h,y,o,p]);return Object(x.jsx)(l.a.Fragment,null,m&&Object(x.jsx)(s.EuiCollapsibleNavGroup,{className:E,paddingSize:"none",background:"none",title:M,titleElement:"span",isCollapsible:j,initialIsOpen:!1},Object(x.jsx)(s.EuiPanel,{color:"transparent",paddingSize:"s"},q)),O&&Object(x.jsx)(l.a.Fragment,null,(v||!j)&&Object(x.jsx)(s.EuiFlyout,{ownFocus:!1,outsideClickCloses:!0,onClose:()=>f(!1),side:"left",size:248,closeButtonPosition:c,className:"kbnSolutionNav__flyout",hideCloseButton:!j},Object(x.jsx)("div",{className:E},M,Object(x.jsx)(s.EuiSpacer,{size:"l"}),q)),j&&Object(x.jsx)(Wa,{isCollapsed:!0,onClick:()=>{f(!v)}})),g&&Object(x.jsx)(l.a.Fragment,null,Object(x.jsx)("div",{className:E},M,Object(x.jsx)(s.EuiSpacer,{size:"l"}),q),j&&Object(x.jsx)(Wa,{isCollapsed:!n,onClick:b})))};var Ya=a(170);const Ja="solutionNavIsCollapsed",Za=e=>{const t=t=>{var a;const l=Object(s.useIsWithinBreakpoints)(["m"]),n=Object(s.useIsWithinMinBreakpoint)("l"),[o,r]=Object(i.useState)(!JSON.parse(String(localStorage.getItem(Ja)))),{solutionNav:c,children:d,...b}=t,{euiTheme:j}=Object(s.useEuiTheme)(),{canBeCollapsed:p=!0}=c,m=l||p&&n&&!o,O=(e=>Object(Ya.css)("flex:0 1 0;overflow:hidden;",s.euiCanAnimate,"{transition:min-width ",e.animation.fast," ",e.animation.resistance,";}",""))(j),g=Ga()("kbnSolutionNav__sidebar",{"kbnSolutionNav__sidebar--shrink":m},null===(a=t.pageSideBarProps)||void 0===a?void 0:a.className,O),v=Object(x.jsx)(Ka,u()({isOpenOnDesktop:o,onCollapse:()=>{r(!o),localStorage.setItem(Ja,JSON.stringify(o))}},c)),f={paddingSize:"none",...t.pageSideBarProps,minWidth:m?j.size.xxl:void 0,className:g};return Object(x.jsx)(e,u()({},b,{pageSideBar:v,pageSideBarProps:f}),d)};var a;return t.displayName=`WithSolutionNavBar(${a=e,a.displayName||a.name||"UnnamedComponent"})`,t},es=l.a.createContext(null);a(59);const ts={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},as=({children:e,navigateToUrl:t,currentAppId:a,...s})=>{const l=Object(i.useRef)(null),n=Object(i.useCallback)((e=>(({event:e,container:t,navigateToUrl:a,currentAppId:s})=>{if(!t||!s)return;const i=((e,t)=>{let a=e;do{var s,i;if("a"===(null===(s=a)||void 0===s?void 0:s.tagName.toLowerCase()))return a;const e=null===(i=a)||void 0===i?void 0:i.parentElement;if(!e||e===document.body||e===t)break;a=e}while(parent||parent!==document.body||parent!==t)})(e.target,t);if(!i)return;const l=i.href,n=""===i.target||"_self"===i.target,o=0===e.button;l&&n&&o&&!e.defaultPrevented&&!(e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)(e)&&(e.preventDefault(),a(i.href))})({event:e,currentAppId:a,navigateToUrl:t,container:l.current})),[a,t]);return Object(x.jsx)("div",u()({onClick:n,ref:l,css:ts,"data-test-subj":"kbnRedirectAppLink"},s),e)},ss=({children:e,...t})=>Object(x.jsx)(as,u()({},function(){const e=Object(i.useContext)(es);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t),e);var is=a(174),ls=a.n(is);const ns=_.i18n.translate("sharedUXPackages.card.noData.noPermission.title",{defaultMessage:"Contact your administrator"}),os=_.i18n.translate("sharedUXPackages.card.noData.noPermission.description",{defaultMessage:"This integration is not yet enabled. Your administrator has the required permissions to turn it on."}),rs=_.i18n.translate("sharedUXPackages.card.noData.title",{defaultMessage:"Add Elastic Agent"}),us=_.i18n.translate("sharedUXPackages.card.noData.description",{defaultMessage:"Use Elastic Agent for a simple, unified way to collect data from your machines."}),cs=()=>Object(x.jsx)(s.EuiImage,{size:"fullWidth",style:{width:"max(100%, 360px)",height:240,objectFit:"cover",background:"aliceblue"},url:ls.a,alt:""}),ds=({title:e,description:t,canAccessFleet:a,button:i,...l})=>Object(x.jsx)(s.EuiCard,u()({css:{maxWidth:400,marginInline:"auto"},paddingSize:"l",title:a?Object(x.jsx)(s.EuiScreenReaderOnly,null,Object(x.jsx)("span",null,e||rs)):Object(x.jsx)(s.EuiTextColor,{color:"default"},ns),description:a?t||us:Object(x.jsx)(s.EuiTextColor,{color:"default"},os),footer:(()=>{if(a)return i&&"string"!=typeof i?i:Object(x.jsx)(s.EuiButton,{fill:!0},i||e||rs)})(),isDisabled:!a,image:Object(x.jsx)(cs,null)},l)),bs=l.a.createContext(null),js=({href:e,category:t,description:a,...s})=>{var l;const{canAccessFleet:n,addBasePath:o}=function(){const e=Object(i.useContext)(bs);if(!e)throw new Error("NoDataCard Context is missing.  Ensure your component or React root is wrapped with NoDataCardContext.");return e}(),r=Object(i.useMemo)((()=>{if(e)return e;const a="/app/integrations/browse";return o(t?`${a}/${t}`:a)}),[o,e,t]);return Object(x.jsx)(ss,null,Object(x.jsx)(ds,u()({},s,{href:r,canAccessFleet:null!==(l=s.canAccessFleet)&&void 0!==l?l:n,description:a})))},ps=({action:e})=>{const t=Object.keys(e);if(1!==t.length)return null;const a=t[0],s="elasticAgent"===a?"empty-page-agent-action":`empty-page-${a}-action`;return Object(x.jsx)(js,u()({key:s},e[a]))},xs=({solution:e,logo:t,action:a,docsLink:i,pageTitle:l,pageDescription:n,className:o})=>{const r=l||_.i18n.translate("sharedUXPackages.noDataPage.welcomeTitle",{defaultMessage:"Welcome to Elastic {solution}!",values:{solution:e}}),u=i?Object(x.jsx)(s.EuiLink,{href:i,target:"_blank"},Object(x.jsx)(k.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro.link",defaultMessage:"learn more"})):null,c=null!=n?n:u?Object(x.jsx)(k.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro",defaultMessage:"Add your data to get started, or {link} about {solution}.",values:{solution:e,link:u}}):Object(x.jsx)(k.FormattedMessage,{id:"sharedUXPackages.noDataPage.introNoDocLink",defaultMessage:"Add your data to get started."});return Object(x.jsx)(s.EuiPageTemplate.Section,{alignment:"center",grow:!0,className:Ga()("kbnNoDataPageContents",o),"data-test-subj":"kbnNoDataPage"},Object(x.jsx)(s.EuiText,{textAlign:"center"},Object(x.jsx)($a,{name:e,iconType:t||`logo${e}`,size:"xxl"}),Object(x.jsx)(s.EuiSpacer,{size:"l"}),Object(x.jsx)("h1",null,r),Object(x.jsx)(s.EuiTextColor,{color:"subdued"},Object(x.jsx)("p",null,c))),Object(x.jsx)(s.EuiSpacer,{size:"xxl"}),Object(x.jsx)(ps,{action:a}))},ms=e=>{const{className:t,noDataConfig:a,pageSideBar:i,pageSideBarProps:l,...n}=e;if(!a)return null;let o;i&&(o=Object(x.jsx)(s.EuiPageTemplate.Sidebar,l,i));const r=((e,t)=>Ga()("kbnPageTemplate","",t||""))(0,t);return Object(x.jsx)(s.EuiPageTemplate,u()({className:r,restrictWidth:950,panelled:!1,offset:0,minHeight:0},n),o,Object(x.jsx)(xs,a))},Os=Za(ms),gs=({className:e,pageHeader:t,children:a,isEmptyState:i,pageSideBar:l,pageSideBarProps:n,...o})=>{let r,c;if(i&&t&&!a){const{iconType:e,pageTitle:i,description:l,rightSideItems:n}=t,o=i?Object(x.jsx)("h1",null,i):void 0,r=l?Object(x.jsx)("p",null,l):void 0;a=Object(x.jsx)(s.EuiPageTemplate.EmptyPrompt,{iconType:e,iconColor:"",title:o,body:r,actions:n})}else t&&(r=Object(x.jsx)(s.EuiPageTemplate.Header,t));if(l){const e={...n};e.sticky=!0,c=Object(x.jsx)(s.EuiPageTemplate.Sidebar,e,l)}const d=((e,t)=>Ga()("kbnPageTemplate","",t||""))(0,e);return Object(x.jsx)(s.EuiPageTemplate,u()({className:d,offset:0,minHeight:r?"calc(100vh - var(--euiFixedHeadersOffset, 0))":0,grow:!r&&void 0},o),c,r,a)},vs=Za(gs),fs=Object.assign((({className:e,children:t,solutionNav:a,noDataConfig:s,...i})=>s&&a?Object(x.jsx)(Os,{"data-test-subj":i["data-test-subj"],className:e,noDataConfig:s,solutionNav:a}):s?Object(x.jsx)(ms,{"data-test-subj":i["data-test-subj"],className:e,noDataConfig:s}):a?Object(x.jsx)(vs,u()({className:e,solutionNav:a,children:t},i)):Object(x.jsx)(gs,u()({className:e,children:t},i))),{Sidebar:s.EuiPageTemplate.Sidebar,Header:s.EuiPageTemplate.Header,Section:s.EuiPageTemplate.Section,BottomBar:s.EuiPageTemplate.BottomBar,EmptyPrompt:s.EuiPageTemplate.EmptyPrompt}),ys=()=>{A("base");const{application:{getUrlForApp:e,navigateToApp:t}}=Object(N.e)().services,a=Object(i.useMemo)((()=>e(tt.INTEGRATIONS_PLUGIN_ID,{path:at.pagePathGetters.integration_details_overview({pkgkey:Xe.OSQUERY_INTEGRATION_NAME})[1]})),[e]),l=Object(i.useCallback)((e=>{if(!Object(N.d)(e)&&Object(N.c)(e))return e.preventDefault(),t(tt.INTEGRATIONS_PLUGIN_ID,{path:at.pagePathGetters.integration_details_overview({pkgkey:Xe.OSQUERY_INTEGRATION_NAME})[1]})}),[t]),n=Object(i.useMemo)((()=>({iconType:Mt.a,pageTitle:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.emptyState.pageTitle",defaultMessage:"Add Osquery Manager"}),description:Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.emptyState.pageDescription",defaultMessage:"Add this integration to run and schedule queries for Elastic Agent."}),rightSideItems:[Object(x.jsx)(s.EuiButton,{key:"button",fill:!0,href:a,onClick:l,iconType:"plusInCircleFilled","data-test-subj":"osquery-add-integration-button"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.emptyState.addOsqueryManagerButton",defaultMessage:"Add Osquery Manager"}))]})),[l,a]);return Object(x.jsx)(fs,{isEmptyState:!0,pageHeader:n})},ks=l.a.memo(ys),hs=()=>{const{application:{getUrlForApp:e,navigateToApp:t}}=Object(N.e)().services,a=Object(i.useMemo)((()=>e(tt.INTEGRATIONS_PLUGIN_ID,{path:at.pagePathGetters.integration_details_policies({pkgkey:Xe.OSQUERY_INTEGRATION_NAME})[1]})),[e]),l=Object(i.useCallback)((e=>{if(!Object(N.d)(e)&&Object(N.c)(e))return e.preventDefault(),t(tt.INTEGRATIONS_PLUGIN_ID,{path:at.pagePathGetters.integration_details_policies({pkgkey:Xe.OSQUERY_INTEGRATION_NAME})[1]})}),[t]);return a?Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiButtonEmpty,{iconType:"gear",href:a,onClick:l},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.appNavigation.manageIntegrationButton",defaultMessage:"Manage integration"}))):null},Es=l.a.memo(hs);var Ss;!function(e){e.LiveQueries="live_queries",e.Packs="packs",e.SavedQueries="saved_queries"}(Ss||(Ss={}));const Cs=()=>{const e=Object(c.useLocation)(),t=Object(i.useMemo)((()=>{var t;return null!==(t=e.pathname.split("/")[1])&&void 0!==t?t:"overview"}),[e.pathname]);return Object(x.jsx)("div",{css:w},Object(x.jsx)(s.EuiFlexGroup,{gutterSize:"l",alignItems:"center"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiTabs,{bottomBorder:!1},Object(x.jsx)(s.EuiTab,u()({isSelected:t===Ss.LiveQueries},Object(N.f)(Ss.LiveQueries)),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.appNavigation.liveQueriesLinkText",defaultMessage:"Live queries"})),Object(x.jsx)(s.EuiTab,u()({isSelected:t===Ss.Packs},Object(N.f)(Ss.Packs)),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.appNavigation.packsLinkText",defaultMessage:"Packs"})),Object(x.jsx)(s.EuiTab,u()({isSelected:t===Ss.SavedQueries},Object(N.f)(Ss.SavedQueries)),Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.appNavigation.savedQueriesLinkText",defaultMessage:"Saved queries"})))),Object(x.jsx)(s.EuiFlexItem,{grow:!1},Object(x.jsx)(s.EuiFlexGroup,{gutterSize:"s",direction:"row"},Object(x.jsx)(s.EuiFlexItem,null,Object(x.jsx)(s.EuiButtonEmpty,{iconType:"popout",href:"https://ela.st/osquery-feedback",target:"_blank"},Object(x.jsx)(k.FormattedMessage,{id:"xpack.osquery.appNavigation.sendFeedbackButton",defaultMessage:"Send feedback"}))),Object(x.jsx)(Es,null)))))},Ms=()=>{const{customBranding:e}=Object(S.useKibana)().services,{data:t,isFetched:a}=(()=>{const{http:e}=Object(N.e)().services,t=Object(He.a)();return Object(h.useQuery)(["integration"],(()=>e.get("/internal/osquery/status",{version:I.a.internal.v1})),{onError:e=>t(e,{title:_.i18n.translate("xpack.osquery.osquery_integration.fetchError",{defaultMessage:"Error while fetching osquery integration"})}),refetchOnReconnect:!1,refetchOnWindowFocus:!1})})(),i=M()((null==e?void 0:e.hasCustomBranding$)||Object(q.of)(!1),!1);return a?a&&"installed"!==(null==t?void 0:t.install_status)?Object(x.jsx)(ks,null):Object(x.jsx)("div",{css:F,id:"osquery-app"},Object(x.jsx)("div",{css:T},Object(x.jsx)(Cs,null),Object(x.jsx)(Da,null))):Object(x.jsx)(s.EuiPage,{paddingSize:"none"},Object(x.jsx)(s.EuiPageBody,null,Object(x.jsx)(s.EuiPageSection,{paddingSize:"none",color:"subdued"},i?Object(x.jsx)(s.EuiLoadingSpinner,{size:"xxl"}):Object(x.jsx)(s.EuiLoadingElastic,{size:"xxl"}))))},qs=l.a.memo(Ms);var Fs=a(23),Ts=a(24);const ws=(e,t,{element:a,history:i,theme$:l},n,r)=>(o.a.render(Object(x.jsx)(Ts.d,{theme$:l},Object(x.jsx)(N.b,{services:{appName:Xe.PLUGIN_NAME,kibanaVersion:r,...e,...t,storage:n}},Object(x.jsx)(s.EuiErrorBoundary,null,Object(x.jsx)(v,{history:i},Object(x.jsx)(k.I18nProvider,null,Object(x.jsx)(h.QueryClientProvider,{client:Fs.a},Object(x.jsx)(qs,null),Object(x.jsx)(E.ReactQueryDevtools,{initialIsOpen:!1}))))))),a),()=>o.a.unmountComponentAtNode(a))},78:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var s=a(1),i=a.n(s),l=a(5),n=a(14),o=a(0);const r={maxWidth:"500px",marginRight:"auto",marginLeft:"auto"},u=()=>Object(o.jsx)("div",null,Object(o.jsx)(l.EuiSpacer,null),Object(o.jsx)(l.EuiPanel,{css:r},Object(o.jsx)(l.EuiEmptyPrompt,{iconType:"securityApp",title:Object(o.jsx)("h2",null,Object(o.jsx)(n.FormattedMessage,{id:"xpack.osquery.permissionDeniedErrorTitle",defaultMessage:"Permission denied"})),body:Object(o.jsx)("p",null,Object(o.jsx)(n.FormattedMessage,{id:"xpack.osquery.permissionDeniedErrorMessage",defaultMessage:"You are not authorized to access this page."}))})),Object(o.jsx)(l.EuiSpacer,null)),c=i.a.memo(u)},79:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));var s=a(11),i=a(2),l=a(4);const n=({packId:e,skip:t=!1})=>{const{http:a}=Object(l.e)().services;return Object(s.useQuery)(["pack",{packId:e}],(()=>a.get(`/api/osquery/packs/${e}`,{version:i.a.public.v1})),{select:e=>null==e?void 0:e.data,keepPreviousData:!0,enabled:!(t||!e)})}},92:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return o}));var s=a(15);const i=e=>Object(s.reduce)(e,((e,t)=>{var a,i;return Object(s.isEmpty)(null==t?void 0:t.key)||Object(s.isEmpty)(null===(a=t.result)||void 0===a?void 0:a.type)||Object(s.isEmpty)(null===(i=t.result)||void 0===i?void 0:i.value)||(e[t.key]={[t.result.type]:t.result.value}),e}),{}),l=e=>Object(s.reduce)(e,((e,t,a)=>(t&&e.push({key:a,result:{type:Object.keys(t)[0],value:Object.values(t)[0]}}),e)),[]),n=e=>Object(s.reduce)(e,((e,t)=>(Object(s.isEmpty)(null==t?void 0:t.policy)||(e[t.policy.key]=t.percentage),e)),{}),o=(e,t)=>Object(s.reduce)(e,((e,a,s)=>{var i,l;return null!=a&&e.push({policy:{key:s,label:null!==(i=null==t||null===(l=t[s])||void 0===l?void 0:l.name)&&void 0!==i?i:""},percentage:a}),e}),[])}}]);