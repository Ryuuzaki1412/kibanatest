/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.observabilityAIAssistant_bundle_jsonpfunction=window.observabilityAIAssistant_bundle_jsonpfunction||[]).push([[6],{112:function(e,t,s){"use strict";s.r(t),s.d(t,"Insight",(function(){return P}));var i=s(12),n=s(26),a=s(0),o=s.n(a),l=s(4),c=s(16),r=s(51),u=s(48),b=s(54),j=s(14),d=s(44),x=s(13),O=s(49),g=s(53),p=s(71),m=s(2),h=s.n(m),v=s(5),f=s(1);function A(e){return Object(f.jsx)(i.EuiButton,h()({"data-test-subj":"observabilityAiAssistantStartChatButton",fill:!0,iconType:"discuss",size:"s"},e),v.i18n.translate("xpack.observabilityAiAssistant.insight.response.startChat",{defaultMessage:"Start chat"}))}var E=s(72),y=s(61),C=s(67),k=s(70),I=s(73);function S(e){return Object(f.jsx)(o.a.Fragment,null,e.body,e.error?Object(f.jsx)(o.a.Fragment,null,e.body?Object(f.jsx)(i.EuiSpacer,{size:"xs"}):null,Object(f.jsx)(I.a,null)):null,e.controls?Object(f.jsx)(o.a.Fragment,null,Object(f.jsx)(i.EuiSpacer,{size:"m"}),Object(f.jsx)(i.EuiHorizontalRule,{margin:"none"}),Object(f.jsx)(i.EuiSpacer,{size:"s"}),e.controls):null)}var w=s(76);function F(e){return Object(f.jsx)(i.EuiCallOut,{title:v.i18n.translate("xpack.observabilityAiAssistant.missingCredentialsCallout.title",{defaultMessage:"Missing credentials"}),color:"primary",iconType:"iInCircle"},v.i18n.translate("xpack.observabilityAiAssistant.missingCredentialsCallout.description",{defaultMessage:"You havenâ€™t authorised OpenAI in order to generate responses from the Elastic Assistant. Authorise the model in order to proceed."}),Object(f.jsx)(i.EuiSpacer,{size:"m"}),Object(f.jsx)(i.EuiButton,{"data-test-subj":"observabilityAiAssistantMissingCredentialsCalloutConnectAssistantButton",fill:!0,color:"primary",href:e.connectorsManagementHref},v.i18n.translate("xpack.observabilityAiAssistant.missingCredentialsCallout.buttonLabel",{defaultMessage:"Connect Assistant"})))}var M=s(52),z={name:"1lztzw8",styles:"margin-top:2px;margin-bottom:1px"},T={name:"xyzkeb",styles:"align-self:flex-start"};function L({title:e,description:t=v.i18n.translate("xpack.observabilityAiAssistant.insight.defaultDescription",{defaultMessage:"Get helpful insights from our Elastic AI Assistant."}),controls:s,children:n,actions:o,onToggle:l,loading:c,dataTestSubj:r="obsAiAssistantInsightButton"}){const{euiTheme:u}=Object(i.useEuiTheme)(),[b,j]=Object(a.useState)(!1),d=()=>{j(!b)};return Object(f.jsx)(i.EuiPanel,{hasBorder:!0,hasShadow:!1},Object(f.jsx)(i.EuiAccordion,{id:"obsAiAssistantInsight",arrowProps:{css:{alignSelf:"flex-start"}},buttonContent:Object(f.jsx)(i.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"m","data-test-subj":r},Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(i.EuiSpacer,{size:"xs"}),Object(f.jsx)(M.a,{size:"xs"})),Object(f.jsx)(i.EuiFlexItem,null,Object(f.jsx)(i.EuiText,{css:z},Object(f.jsx)("h5",null,e)),Object(f.jsx)(i.EuiText,{size:"s",css:Object(f.css)({color:u.colors.subduedText},"","")},Object(f.jsx)("span",null,t)))),isLoading:c,isDisabled:c,extraAction:null!=o&&o.length||s?Object(f.jsx)(i.EuiFlexGroup,{direction:"row",gutterSize:"s",responsive:!1},s&&Object(f.jsx)(i.EuiFlexItem,{grow:!1},s),null!=o&&o.length?Object(f.jsx)(i.EuiFlexItem,null,Object(f.jsx)(i.EuiPopover,{anchorPosition:"downLeft",button:Object(f.jsx)(i.EuiButtonIcon,{"aria-label":v.i18n.translate("xpack.observabilityAiAssistant.insight.actions",{defaultMessage:"Actions"}),color:"text",css:T,"data-test-subj":"observabilityAiAssistantInsightBaseButtonIcon",disabled:0===(null==o?void 0:o.length),display:"empty",iconType:"boxesHorizontal",size:"s",onClick:d}),panelPaddingSize:"s",closePopover:d,isOpen:b},Object(f.jsx)(i.EuiContextMenuPanel,{size:"s",items:null==o?void 0:o.map((({id:e,icon:t,label:s,handler:n})=>Object(f.jsx)(i.EuiContextMenuItem,{key:e,icon:t,onClick:n},s)))}))):null):null,onToggle:l},Object(f.jsx)(i.EuiSpacer,{size:"m"}),Object(f.jsx)(i.EuiPanel,{hasBorder:!1,hasShadow:!1,color:"subdued"},n)))}function B({title:e,initialMessages:t,connectorId:s}){var r;const u=Object(O.a)(),j=Object(a.useRef)(t),{messages:d,next:x,state:g,stop:m}=Object(b.b)({chatService:u,connectorId:s,initialMessages:t,persist:!1}),h=Object(n.last)(d.filter((e=>e.message.role===l.c.Assistant)));Object(a.useEffect)((()=>{x(j.current)}),[x]);const[v,C]=Object(a.useState)(!1);return Object(f.jsx)(o.a.Fragment,null,Object(f.jsx)(S,{body:Object(f.jsx)(w.a,{content:null!==(r=null==h?void 0:h.message.content)&&void 0!==r?r:"",loading:g===b.a.Loading,onActionClick:async()=>{}}),error:g===b.a.Error,controls:g===b.a.Loading?Object(f.jsx)(E.a,{onClick:()=>{m()}}):Object(f.jsx)(i.EuiFlexGroup,{direction:"row"},Object(f.jsx)(k.a,{onClickFeedback:e=>{h&&Object(c.c)(u.analytics,{type:c.a.observability_ai_assistant_insight_feedback,payload:{feedback:e,message:h}})}}),Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(p.a,{onClick:()=>{x(t)}})),Object(f.jsx)(i.EuiFlexItem,{grow:!1},Object(f.jsx)(A,{onClick:()=>{C((()=>!0))}})))}),Object(f.jsx)(y.a,{isOpen:v,onClose:()=>{C(!1)},initialMessages:d,initialTitle:e,startedFrom:"contextualInsight"}))}function P({messages:e,title:t,dataTestSubj:s}){var i;const[n,o]=Object(a.useState)(!1),l=Object(j.a)(),c=Object(x.a)(),b=Object(u.a)((({signal:e})=>c.start({signal:e})),[c]),{services:{http:O}}=Object(d.a)();let p=null;return n&&l.selectedConnector?p=Object(f.jsx)(B,{title:t,initialMessages:e,connectorId:l.selectedConnector}):l.loading||null!==(i=l.connectors)&&void 0!==i&&i.length||(p=Object(f.jsx)(F,{connectorsManagementHref:Object(g.a)(O)})),Object(f.jsx)(L,{title:t,onToggle:e=>{o((t=>t||e))},controls:Object(f.jsx)(C.a,l),loading:l.loading||b.loading,dataTestSubj:s},b.value?Object(f.jsx)(r.b,{value:b.value},p):null)}},61:function(e,t,s){"use strict";s.d(t,"a",(function(){return p}));var i=s(12),n=s(43),a=s(5),o=s(0),l=s(58),c=s(14),r=s(44),u=s(59),b=s(60),j=s(53),d=s(62),x=s(1);const O=Object(n.css)({name:"1hs1hlf",styles:"max-height:100%"}),g=Object(n.css)({name:"umwchj",styles:"overflow-y:auto"});function p({initialTitle:e,initialMessages:t,onClose:s,isOpen:p,startedFrom:m}){const{services:{http:h}}=Object(r.a)(),{euiTheme:v}=Object(i.useEuiTheme)(),f=Object(l.a)(),A=Object(c.a)(),E=Object(b.a)(),y=Object(u.a)(),[C,k]=Object(o.useState)(void 0),I=Object(n.css)("padding-top:12px;padding-bottom:12px;border-bottom:solid 1px ",v.border.color,";","");return p?Object(x.jsx)(i.EuiFlyout,{onClose:s},Object(x.jsx)(i.EuiFlexGroup,{responsive:!1,gutterSize:"none",direction:"column",className:O},Object(x.jsx)(i.EuiFlexItem,{grow:!1},Object(x.jsx)(i.EuiPanel,{hasShadow:!1,hasBorder:!1,borderRadius:"none",className:I},C?Object(x.jsx)(i.EuiLink,{"data-test-subj":"observabilityAiAssistantChatFlyoutOpenConversationLink",href:E.link("/conversations/{conversationId}",{path:{conversationId:C}})},a.i18n.translate("xpack.observabilityAiAssistant.conversationDeepLinkLabel",{defaultMessage:"Open conversation"})):Object(x.jsx)(i.EuiLink,{"data-test-subj":"observabilityAiAssistantChatFlyoutGoToConversationsLink",href:E.link("/conversations/new")},a.i18n.translate("xpack.observabilityAiAssistant.conversationListDeepLinkLabel",{defaultMessage:"Go to conversations"})))),Object(x.jsx)(i.EuiFlexItem,{grow:!0,className:g},Object(x.jsx)(d.a,{connectors:A,initialTitle:e,initialMessages:t,currentUser:f,connectorsManagementHref:Object(j.a)(h),knowledgeBase:y,startedFrom:m,onConversationUpdate:e=>{k(e.conversation.id)}})))):null}}}]);