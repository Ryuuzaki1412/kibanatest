/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[23],Array(121).concat([function(e,t,n){"use strict";n.d(t,"c",(function(){return x})),n.d(t,"d",(function(){return S})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return C}));var a=n(2),i=n(48),s=n(5),r=n(49),o=n(149),l=n(116),u=n(213),c=n(118),d=n(4),m=n(151),p=n(112),f=n(392),b=n(117),g=n(477),v=n(334),y=n(241),h=n(157),j=n(218),E=n(295),O=n(110);const x=(e=l.SourcererScopeName.default)=>{const t=Object(i.useDispatch)(),{data:{dataViews:n}}=Object(O.i)().services,r=Object(a.useRef)(new AbortController),d=Object(a.useRef)(!0),y=Object(a.useRef)(!0),{loading:E,isSignalIndexExists:x,signalIndexName:k}=Object(u.c)(),w=Object(h.d)(j.a.sourcerer),T=Object(a.useMemo)((()=>o.d.getSourcererDataViewsSelector()),[]),{defaultDataView:C,signalIndexName:M}=Object(p.a)((e=>T(e))),{addError:I,addWarning:A}=Object(b.a)();Object(a.useEffect)((()=>{null!=C.error&&A({title:s.i18n.translate("xpack.securitySolution.sourcerer.permissions.title",{defaultMessage:"Write role required to generate data"}),text:s.i18n.translate("xpack.securitySolution.sourcerer.permissions.toastMessage",{defaultMessage:"Users with write permission need to access the Elastic Security app to initialize the app source data."})})}),[A,C.error]);const P=Object(a.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),_=Object(p.a)((e=>P(e,m.f.active))),D=Object(a.useMemo)((()=>o.d.getSourcererScopeSelector()),[]),{sourcererScope:{selectedDataViewId:R,selectedPatterns:F,missingPatterns:N}}=Object(p.a)((t=>D(t,e))),{selectedDataView:L,sourcererScope:{selectedDataViewId:z,selectedPatterns:B,missingPatterns:q}}=Object(p.a)((e=>D(e,l.SourcererScopeName.timeline))),{indexFieldsSearch:V}=Object(v.b)(),$=Object(a.useCallback)((n=>{null!=n?Object.keys(n).forEach((a=>{var i,s,r,u;a===l.SourcererScopeName.default&&e===l.SourcererScopeName.detections||t(o.a.setSelectedDataView({id:a,selectedDataViewId:null!==(i=null===(s=n[a])||void 0===s?void 0:s.id)&&void 0!==i?i:null,selectedPatterns:null!==(r=null===(u=n[a])||void 0===u?void 0:u.selectedPatterns)&&void 0!==r?r:[]}))})):R&&w({[l.SourcererScopeName.default]:{id:R,selectedPatterns:F}})}),[t,R,e,F,w]);Object(h.b)(j.a.sourcerer,$);const U=Object(a.useRef)([]);Object(a.useEffect)((()=>{[...new Set([R,z])].forEach(((e,t)=>{if(null!=e&&e.length>0&&!U.current.includes(e)){U.current=[...U.current,e];const n=0===t?l.SourcererScopeName.default:l.SourcererScopeName.timeline,a=e===R?0===F.length&&0===N.length:z===e&&0===q.length&&0===(null==L?void 0:L.patternList.length);V({dataViewId:e,scopeId:n,needToBeInit:a,...a&&n===l.SourcererScopeName.timeline?{skipScopeUpdate:B.length>0}:{}})}}))}),[V,N.length,R,F.length,z,q.length,L,B.length]),Object(a.useEffect)((()=>{!E&&null!=k&&null==M&&(null==_||null==_.savedObjectId)&&d.current&&C.id.length>0?(d.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:C.id,selectedPatterns:Object(f.b)(C,l.SourcererScopeName.timeline,k,!0)}))):null!=M&&(null==_||null==_.savedObjectId)&&d.current&&C.id.length>0&&(d.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:C.id,selectedPatterns:Object(f.b)(C,l.SourcererScopeName.timeline,M,!0)})))}),[_,C,t,E,k,M]);const{dataViewId:Q}=S(e),H=Object(a.useCallback)((e=>{-1===C.title.indexOf(e)&&(r.current.abort(),(async a=>{r.current=new AbortController,t(o.a.setSourcererScopeLoading({loading:!0}));try{const i=await Object(g.a)({body:{patternList:a},signal:r.current.signal,dataViewService:n,dataViewId:Q});null!=i&&i.defaultDataView.patternList.includes(e)&&(V({dataViewId:i.defaultDataView.id}),t(o.a.setSourcererDataViews(i))),t(o.a.setSourcererScopeLoading({loading:!1}))}catch(e){"AbortError"===e.name||I(e,{title:s.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:s.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})}),t(o.a.setSourcererScopeLoading({loading:!1}))}})([...C.title.split(","),e]))}),[C.title,t,n,Q,V,I]),G=Object(a.useCallback)((()=>{!E&&null!=k&&null==M&&C.id.length>0&&(H(k),t(o.a.setSignalIndexName({signalIndexName:k})))}),[C.id.length,t,E,k,M,H]);Object(a.useEffect)((()=>{G()}),[k]),Object(a.useEffect)((()=>{e===l.SourcererScopeName.detections&&x&&null!=k&&y.current&&C.id.length>0?(y.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:C.id,selectedPatterns:Object(f.b)(C,l.SourcererScopeName.detections,k,!0)}))):e===l.SourcererScopeName.detections&&null!=M&&d.current&&C.id.length>0&&(y.current=!1,o.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:C.id,selectedPatterns:Object(f.b)(C,l.SourcererScopeName.detections,M,!0)}))}),[C,t,x,e,k,M])},S=(e=l.SourcererScopeName.default)=>{const{getDataViewsSelector:t,getSourcererDataViewSelector:n,getScopeSelector:i}=Object(a.useMemo)((()=>({getDataViewsSelector:o.d.getSourcererDataViewsSelector(),getSourcererDataViewSelector:o.d.sourcererDataViewSelector(),getScopeSelector:o.d.scopeIdSelector()})),[]),{defaultDataView:s,signalIndexName:r,selectedDataView:u,sourcererScope:{missingPatterns:c,selectedPatterns:d,loading:m}}=Object(p.a)((a=>{const s=i(a,e);return{...t(a),selectedDataView:n(a,s.selectedDataViewId),sourcererScope:s}})),b=Object(a.useMemo)((()=>Object(E.b)(d)),[d]),[g,h]=Object(a.useState)([]),[j,O]=Object(y.b)(g),x=Object(a.useMemo)((()=>{var e,t,n,a,i,s,r;return{...O,dataView:O.dataView,runtimeMappings:null!==(e=null===(t=O.dataView)||void 0===t?void 0:t.runtimeFieldMap)&&void 0!==e?e:{},title:null!==(n=null===(a=O.dataView)||void 0===a?void 0:a.title)&&void 0!==n?n:"",id:null!==(i=null===(s=O.dataView)||void 0===s?void 0:s.id)&&void 0!==i?i:null,loading:j,patternList:O.indexes,indexFields:O.indexPatterns.fields,fields:null===(r=O.dataView)||void 0===r?void 0:r.fields}}),[O,j]);Object(a.useEffect)((()=>{null==u||c.length>0?h(b):h([])}),[c,u,b]);const S=Object(a.useMemo)((()=>null==u||c.length>0?x:u),[x,c.length,u]),k=Object(a.useMemo)((()=>!(!m&&!S.loading)||Object(f.a)({scopeId:e,signalIndexName:r,patternList:S.patternList,isDefaultDataViewSelected:S.id===s.id})),[s.id,m,e,r,S.id,S.loading,S.patternList]),w=Object(a.useCallback)((()=>{const{browserFields:e}=Object(v.a)(S.patternList.join(","),S.fields);return e}),[S.fields,S.patternList]);return Object(a.useMemo)((()=>({browserFields:w(),dataViewId:S.id,indexPattern:{fields:S.indexFields,title:b.join(","),getName:()=>b.join(",")},indicesExist:k,loading:m||S.loading,runtimeMappings:S.runtimeMappings,patternList:S.title.split(","),selectedPatterns:b,...g.length>0?{activePatterns:S.patternList}:{},sourcererDataView:S.dataView})),[w,S,b,k,m,g.length])},k=[d.d,`${d.oc}/id/:id`,`${d.s}/:detailName`],w=e=>null==Object(r.matchPath)(e,{path:k,strict:!1})?l.SourcererScopeName.default:l.SourcererScopeName.detections,T=[d.d,d.v,`${d.oc}/id/:id`,d.Ab,d.Lc,d.Ob,d.Wb],C=e=>null!=Object(r.matchPath)(e,{path:T,strict:!1})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return v}));var a=n(45),i=n(2),s=n.n(i),r=n(704),o=n(168),l=n(492),u=n(249),c=n(250);const d=[{id:"default-system-prompt",content:c.b,name:c.a,promptType:"system"},{id:"CB9FA555-B59F-4F71-AFF9-8A891AC5BC28",content:c.d,name:c.c,promptType:"system"}],m={alerts:!1,assistantLangChain:!1,latestAlerts:20};var p=n(259),f=n(13);const b=s.a.createContext(void 0),g=({actionTypeRegistry:e,alertsIndexPattern:t,assistantAvailability:n,assistantStreamingEnabled:s=!1,assistantTelemetry:c,augmentMessageCodeBlocks:g,baseAllow:v,baseAllowReplacement:y,defaultAllow:h,defaultAllowReplacement:j,docLinks:E,basePath:O,basePromptContexts:x=[],baseQuickPrompts:S=[],baseSystemPrompts:k=d,children:w,getComments:T,http:C,getInitialConversations:M,modelEvaluatorEnabled:I=!1,nameSpace:A="elasticAssistantDefault",setConversations:P,setDefaultAllow:_,setDefaultAllowReplacement:D,title:R=u.c,toasts:F})=>{const[N,L]=Object(r.useLocalStorage)(`${A}.quickPrompts`,S),[z,B]=Object(r.useLocalStorage)(`${A}.systemPrompts`,k),[q,V]=Object(r.useLocalStorage)(`${A}.lastConversationId`),[$,U]=Object(r.useLocalStorage)(`${A}.knowledgeBase`,m),[Q,H]=Object(i.useState)({}),G=Object(i.useCallback)((e=>{H((t=>null!=e&&null==t[e.id]?Object(l.b)({prevPromptContexts:t,promptContext:e}):t))}),[]),W=Object(i.useCallback)((e=>H((t=>null==t[e]?t:Object(a.omit)(e,t)))),[]),[K,J]=Object(i.useState)((e=>{})),[Y,X]=Object(i.useState)(p.b),[Z,ee]=Object(i.useState)(M()),te=Object(i.useMemo)((()=>Object.keys(Z).sort()),[Z]);Object(i.useEffect)((()=>{ee(M())}),[M]);const ne=Object(i.useCallback)((e=>{if("function"==typeof e){const t=e;ee((e=>{const n=t(e);return P(n),n}))}else P(e),ee(e)}),[P]),ae=Object(i.useCallback)((e=>{var t;return null!==(t=null!=e?e:q)&&void 0!==t?t:o.d}),[q]),ie=Object(i.useMemo)((()=>({actionTypeRegistry:e,alertsIndexPattern:t,assistantAvailability:n,assistantStreamingEnabled:s,assistantTelemetry:c,augmentMessageCodeBlocks:g,allQuickPrompts:null!=N?N:[],allSystemPrompts:null!=z?z:[],baseAllow:Object(a.uniq)(v),baseAllowReplacement:Object(a.uniq)(y),basePath:O,basePromptContexts:x,baseQuickPrompts:S,baseSystemPrompts:k,conversationIds:te,conversations:Z,defaultAllow:Object(a.uniq)(h),defaultAllowReplacement:Object(a.uniq)(j),docLinks:E,getComments:T,http:C,knowledgeBase:null!=$?$:m,modelEvaluatorEnabled:I,promptContexts:Q,nameSpace:A,registerPromptContext:G,selectedSettingsTab:Y,setAllQuickPrompts:L,setAllSystemPrompts:B,setConversations:ne,setDefaultAllow:_,setDefaultAllowReplacement:D,setKnowledgeBase:U,setSelectedSettingsTab:X,setShowAssistantOverlay:J,showAssistantOverlay:K,title:R,toasts:F,unRegisterPromptContext:W,getConversationId:ae,setLastConversationId:V})),[e,t,n,s,c,g,v,y,O,x,S,k,te,Z,h,j,E,T,C,$,ae,N,z,I,A,ne,Q,G,Y,_,D,U,V,L,B,K,R,F,W]);return Object(f.jsx)(b.Provider,{value:ie},w)},v=()=>{const e=s.a.useContext(b);if(null==e)throw new Error("useAssistantContext must be used within a AssistantProvider");return e}},,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var a=n(38).__importDefault(n(774));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.removeEventListener.apply(e,t)},t.isDeepEqual=a.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"m",(function(){return m})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return f})),n.d(t,"q",(function(){return b})),n.d(t,"p",(function(){return g})),n.d(t,"y",(function(){return v})),n.d(t,"A",(function(){return y})),n.d(t,"B",(function(){return h})),n.d(t,"C",(function(){return j})),n.d(t,"D",(function(){return E})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return x})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return k})),n.d(t,"E",(function(){return w})),n.d(t,"F",(function(){return T})),n.d(t,"G",(function(){return C})),n.d(t,"H",(function(){return M})),n.d(t,"J",(function(){return I})),n.d(t,"K",(function(){return A})),n.d(t,"L",(function(){return P})),n.d(t,"M",(function(){return _})),n.d(t,"Y",(function(){return D})),n.d(t,"Z",(function(){return R})),n.d(t,"ab",(function(){return F})),n.d(t,"bb",(function(){return N})),n.d(t,"z",(function(){return L})),n.d(t,"cb",(function(){return z})),n.d(t,"db",(function(){return B})),n.d(t,"N",(function(){return q})),n.d(t,"O",(function(){return V})),n.d(t,"Q",(function(){return $})),n.d(t,"T",(function(){return U})),n.d(t,"U",(function(){return Q})),n.d(t,"R",(function(){return H})),n.d(t,"S",(function(){return G})),n.d(t,"X",(function(){return W})),n.d(t,"W",(function(){return K})),n.d(t,"s",(function(){return J})),n.d(t,"r",(function(){return Y})),n.d(t,"w",(function(){return X})),n.d(t,"P",(function(){return Z})),n.d(t,"x",(function(){return ee})),n.d(t,"I",(function(){return te})),n.d(t,"V",(function(){return ne})),n.d(t,"t",(function(){return ae})),n.d(t,"v",(function(){return ie})),n.d(t,"u",(function(){return se}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.open.timeline.batchActionsTitle",{defaultMessage:"Bulk actions"}),s=a.i18n.translate("xpack.securitySolution.open.timeline.cancelButton",{defaultMessage:"Cancel"}),r=a.i18n.translate("xpack.securitySolution.open.timeline.collapseButton",{defaultMessage:"Collapse"}),o=a.i18n.translate("xpack.securitySolution.open.timeline.deleteButton",{defaultMessage:"Delete"}),l=a.i18n.translate("xpack.securitySolution.open.timeline.deleteSelectedButton",{defaultMessage:"Delete selected"}),u=a.i18n.translate("xpack.securitySolution.open.timeline.deleteWarningLabel",{defaultMessage:"You will not be able to recover this timeline or its notes once deleted."}),c=a.i18n.translate("xpack.securitySolution.open.timeline.deleteTemplateWarningLabel",{defaultMessage:"You will not be able to recover this timeline template or its notes once deleted."}),d=a.i18n.translate("xpack.securitySolution.open.timeline.descriptionTableHeader",{defaultMessage:"Description"}),m=a.i18n.translate("xpack.securitySolution.open.timeline.expandButton",{defaultMessage:"Expand"}),p=a.i18n.translate("xpack.securitySolution.open.timeline.exportFileNameTitle",{defaultMessage:"timelines_export"}),f=a.i18n.translate("xpack.securitySolution.open.timeline.exportSelectedButton",{defaultMessage:"Export selected"}),b=a.i18n.translate("xpack.securitySolution.open.timeline.favoriteSelectedButton",{defaultMessage:"Favorite selected"}),g=a.i18n.translate("xpack.securitySolution.open.timeline.favoritesTooltip",{defaultMessage:"Favorites"}),v=a.i18n.translate("xpack.securitySolution.open.timeline.lastModifiedTableHeader",{defaultMessage:"Last modified"}),y=a.i18n.translate("xpack.securitySolution.open.timeline.missingSavedObjectIdTooltip",{defaultMessage:"Missing savedObjectId"}),h=a.i18n.translate("xpack.securitySolution.open.timeline.modifiedByTableHeader",{defaultMessage:"Modified by"}),j=a.i18n.translate("xpack.securitySolution.open.timeline.notesTooltip",{defaultMessage:"Notes"}),E=a.i18n.translate("xpack.securitySolution.open.timeline.onlyFavoritesButtonLabel",{defaultMessage:"Only favorites"}),O=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineTooltip",{defaultMessage:"Create query rule from timeline"}),x=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineEqlTooltip",{defaultMessage:"Create EQL rule from timeline"}),S=a.i18n.translate("xpack.securitySolution.open.timeline.createTemplateFromTimelineTooltip",{defaultMessage:"Create template from timeline"}),k=a.i18n.translate("xpack.securitySolution.open.timeline.createTimelineFromTemplateTooltip",{defaultMessage:"Create timeline from template"}),w=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTooltip",{defaultMessage:"Duplicate timeline"}),T=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTemplateTooltip",{defaultMessage:"Duplicate template"}),C=a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineButton",{defaultMessage:"Open Timeline…"}),M=a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineTitle",{defaultMessage:"Open"}),I=a.i18n.translate("xpack.securitySolution.open.timeline.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),A=a.i18n.translate("xpack.securitySolution.open.timeline.refreshTitle",{defaultMessage:"Refresh"}),P=a.i18n.translate("xpack.securitySolution.open.timeline.searchPlaceholder",{defaultMessage:"e.g. timeline name, or description"}),_=a.i18n.translate("xpack.securitySolution.open.timeline.searchTemplatePlaceholder",{defaultMessage:"e.g. template name, or description"}),D=a.i18n.translate("xpack.securitySolution.open.timeline.timelineNameTableHeader",{defaultMessage:"Timeline name"}),R=a.i18n.translate("xpack.securitySolution.open.timeline.timelineTemplateNameTableHeader",{defaultMessage:"Template name"}),F=a.i18n.translate("xpack.securitySolution.open.timeline.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),N=a.i18n.translate("xpack.securitySolution.open.timeline.withLabel",{defaultMessage:"with"}),L=a.i18n.translate("xpack.securitySolution.open.timeline.loadingLabel",{defaultMessage:"Loading..."}),z=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelinesMatchLabel",{defaultMessage:"0 timelines match the search criteria"}),B=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelineTemplatesMatchLabel",{defaultMessage:"0 timeline templates match the search criteria"}),q=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTemplatesTitle",{values:{selectedTemplates:e},defaultMessage:"Selected {selectedTemplates} {selectedTemplates, plural, =1 {template} other {templates}}"}),V=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTimelinesTitle",{values:{selectedTimelines:e},defaultMessage:"Selected {selectedTimelines} {selectedTimelines, plural, =1 {timeline} other {timelines}}"}),$=a.i18n.translate("xpack.securitySolution.open.timeline.showingLabel",{defaultMessage:"Showing:"}),U=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully exported {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),Q=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully exported {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),H=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully deleted {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),G=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully deleted {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),W=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.timelinesTitle",{defaultMessage:"Timelines"}),K=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.templatesTitle",{defaultMessage:"Templates"}),J=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.elasticTitle",{defaultMessage:"Elastic templates"}),Y=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.customizedTitle",{defaultMessage:"Custom templates"}),X=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTimelineTitle",{defaultMessage:"Import"}),Z=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.selectTimelineDescription",{defaultMessage:"Select a timeline or timeline template file to import"}),ee=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid timelines_export.ndjson file"}),te=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.overwriteDescription",{defaultMessage:"Automatically overwrite saved objects with the same timeline ID"}),ne=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.successfullyImportedTimelinesTitle",{values:{totalCount:e},defaultMessage:"Successfully imported {totalCount} {totalCount, plural, =1 {item} other {items}}"}),ae=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedTitle",{values:{totalTimelines:e},defaultMessage:"Failed to import {totalTimelines} {totalTimelines, plural, =1 {timeline} other {timelines}}"}),ie=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTitle",{defaultMessage:"Import…"}),se=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return _})),n.d(t,"a",(function(){return T}));var a=n(23),i=n.n(a),s=n(2),r=n(17);const o=Object(s.createContext)(void 0),l=()=>{const e=Object(s.useContext)(o);if(!e)throw new Error("ExpandableFlyoutContext can only be used within ExpandableFlyoutContext provider");return e};var u=n(13),c=n(9);const d="previewSection";var m=n(5);const p=m.i18n.translate("expandableFlyout.previewSection.backButton",{defaultMessage:"Back"}),f=m.i18n.translate("expandableFlyout.previewSection.closeButton",{defaultMessage:"Close"}),b=e=>Object(c.has)(e,"title")||Object(c.has)(e,"backgroundColor")||Object(c.has)(e,"textColor"),g=({component:e,showBackButton:t,leftPosition:n,banner:a})=>{const{euiTheme:i}=Object(r.useEuiTheme)(),{closePreviewPanel:s,previousPreviewPanel:o}=l(),c=n+4,m=Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiButtonIcon,{iconType:"cross",onClick:()=>s(),"data-test-subj":"previewSectionCloseButton","aria-label":f})),g=t?Object(u.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween",responsive:!1},Object(u.jsx)(r.EuiFlexItem,{grow:!1},Object(u.jsx)(r.EuiButtonEmpty,{size:"xs",iconType:"arrowLeft",iconSide:"left",onClick:()=>o(),"data-test-subj":"previewSectionBackButton","aria-label":p},p)),m):Object(u.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd",responsive:!1},m);return Object(u.jsx)("div",{css:Object(u.css)("position:absolute;top:4px;bottom:12px;right:4px;left:",c,"px;z-index:1000;","")},Object(u.jsx)(r.EuiSplitPanel.Outer,{css:Object(u.css)("margin:",i.size.xs,";box-shadow:0 0 4px 4px ",i.colors.darkShade,";",""),className:"eui-yScroll","data-test-subj":d},b(a)&&Object(u.jsx)(r.EuiSplitPanel.Inner,{grow:!1,color:a.backgroundColor,paddingSize:"none","data-test-subj":`${d}BannerPanel`},Object(u.jsx)(r.EuiText,{textAlign:"center",color:a.textColor,size:"s","data-test-subj":`${d}BannerText`},a.title)),Object(u.jsx)(r.EuiSplitPanel.Inner,{grow:!1,paddingSize:"s","data-test-subj":"previewSectionHeader"},g),Object(u.jsx)(r.EuiSplitPanel.Inner,{paddingSize:"none"},e)))};g.displayName="PreviewSection";const v=({component:e,width:t})=>{const n=Object(s.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(u.jsx)(r.EuiFlexItem,{grow:!1,style:n,"data-test-subj":"rightSection"},e)};v.displayName="RightSection";const y=({component:e,width:t})=>{const n=Object(s.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(u.jsx)(r.EuiFlexItem,{grow:!0,"data-test-subj":"leftSection",style:n},e)};y.displayName="LeftSection";const h={height:"100%"},j=({registeredPanels:e,...t})=>{var n,a;const o=(()=>{const[e,t]=Object(s.useState)(0);return Object(s.useLayoutEffect)((()=>{function e(){t(window.innerWidth)}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]),e})(),{closeFlyout:c,panels:d}=l(),{left:m,right:p,preview:f}=d,j=Object(s.useMemo)((()=>e.find((e=>e.key===(null==m?void 0:m.id)))),[m,e]),E=Object(s.useMemo)((()=>e.find((e=>e.key===(null==p?void 0:p.id)))),[p,e]),O=f?f[f.length-1]:void 0,x=b(null==O||null===(n=O.params)||void 0===n?void 0:n.banner)?null==O||null===(a=O.params)||void 0===a?void 0:a.banner:void 0,S=!!f&&f.length>1,k=Object(s.useMemo)((()=>e.find((e=>e.key===(null==O?void 0:O.id)))),[O,e]),w=null!=E&&null!=p,T=null!=j&&null!=m,C=null!=k&&null!=f,{rightSectionWidth:M,leftSectionWidth:I,flyoutWidth:A,previewSectionLeft:P}=(({windowWidth:e,showRight:t,showLeft:n,showPreview:a})=>{let i=0;if(t)if(e<992)i=Math.min(380,e);else{const t=(e-992)/928*370;i=Math.min(380+t,750)}let s=0;n&&(s=e<=1600?e-i-48:Math.min(80*(e-i)/100,1500));let r=0;return a&&(r=s),{rightSectionWidth:i,leftSectionWidth:s,flyoutWidth:t&&n?`${i+s}px`:`${i}px`,previewSectionLeft:r}})({windowWidth:o,showRight:w,showLeft:T,showPreview:C});return m||p||null!=f&&f.length?Object(u.jsx)(r.EuiFlyout,i()({},t,{size:A,ownFocus:!1,onClose:c}),Object(u.jsx)(r.EuiFlexGroup,{direction:j?"row":"column",wrap:!1,gutterSize:"none",style:h,responsive:!1},T?Object(u.jsx)(y,{component:j.component({...m}),width:I}):null,w?Object(u.jsx)(v,{component:E.component({...p}),width:M}):null),C?Object(u.jsx)(g,{component:k.component({...O}),showBackButton:S,leftPosition:P,banner:x}):null):null};j.displayName="ExpandableFlyout";var E=n(60),O=n(310);const x={namespaces:{},timeoutHandle:0},S="url:update",k=["popstate",S],w=(e,t)=>{x.namespaces[e]||(x.namespaces[e]={});const[n,a]=Object(s.useState)(void 0);return Object(s.useEffect)((()=>{const n=()=>{const n=new URLSearchParams(window.location.search).get(e),i=n?Object(E.decode)(n):{},s=null==i?void 0:i[t];x.namespaces[e][t]=s,a(s)};return n(),k.forEach((e=>window.addEventListener(e,n))),()=>k.forEach((e=>window.removeEventListener(e,n)))}),[t,e]),[n,Object(s.useCallback)((n=>{const a=x.namespaces[e][t],i="object"==typeof n&&"object"==typeof a&&!Array.isArray(n)&&!Array.isArray(a);x.namespaces[e][t]=i?{...a,...n}:n,x.timeoutHandle&&window.clearTimeout(x.timeoutHandle),x.timeoutHandle=window.setTimeout((()=>{const e=Object(O.parse)(location.search);for(const t in x.namespaces)Object.prototype.hasOwnProperty.call(x.namespaces,t)&&(e[t]=encodeURIComponent(Object(E.encode)(x.namespaces[t])));const t=Object(O.stringify)(e,{encode:!1});if(window.location.search===t)return;const n=`${window.location.hash}?${t}`;window.history.pushState({},"",n),window.dispatchEvent(new Event(S))}),0)}),[t,e])]},T="eventFlyout",C=({children:e})=>{const{setRightPanelState:t,rightPanelState:n}=(()=>{const[e,t]=w(T,"rightPanel");return{rightPanelState:e,setRightPanelState:t}})(),{setLeftPanelState:a,leftPanelState:i}=(()=>{const[e,t]=w(T,"leftPanel");return{leftPanelState:e,setLeftPanelState:t}})(),{previewState:r,setPreviewState:l}=(()=>{const[e,t]=w(T,"preview");return{previewState:e,setPreviewState:t}})(),c=Object(s.useMemo)((()=>({left:i,right:n,preview:r||[]})),[i,r,n]),d=Object(s.useCallback)((({right:e,left:n,preview:i})=>{t(e),a(n),l(i?[i]:[])}),[t,a,l]),m=Object(s.useCallback)((e=>{t(e)}),[t]),p=Object(s.useCallback)((e=>a(e)),[a]),f=Object(s.useCallback)((e=>l([...null!=r?r:[],e])),[r,l]),b=Object(s.useCallback)((()=>t(void 0)),[t]),g=Object(s.useCallback)((()=>a(void 0)),[a]),v=Object(s.useCallback)((()=>l([])),[l]),y=Object(s.useCallback)((()=>l(null==r?void 0:r.slice(0,r.length-1))),[r,l]),h=Object(s.useCallback)((()=>{t(void 0),a(void 0),l([])}),[t,a,l]),j=Object(s.useMemo)((()=>({panels:c,openFlyout:d,openRightPanel:m,openLeftPanel:p,openPreviewPanel:f,closeRightPanel:b,closeLeftPanel:g,closePreviewPanel:v,closeFlyout:h,previousPreviewPanel:y})),[c,d,m,p,f,b,g,v,h,y]);return Object(u.jsx)(o.Provider,{value:j},e)};let M;!function(e){e.openFlyout="open_flyout",e.openRightPanel="open_right_panel",e.openLeftPanel="open_left_panel",e.openPreviewPanel="open_preview_panel",e.closeRightPanel="close_right_panel",e.closeLeftPanel="close_left_panel",e.closePreviewPanel="close_preview_panel",e.previousPreviewPanel="previous_preview_panel",e.closeFlyout="close_flyout"}(M||(M={}));const I={left:void 0,right:void 0,preview:[]};function A(e,t){switch(t.type){case M.openFlyout:{const{left:e,right:n,preview:a}=t.payload;return{left:e,right:n,preview:a?[a]:[]}}case M.openRightPanel:return{...e,right:t.payload};case M.openLeftPanel:return{...e,left:t.payload};case M.openPreviewPanel:return{...e,preview:[...e.preview,t.payload]};case M.closeRightPanel:return{...e,right:void 0};case M.closeLeftPanel:return{...e,left:void 0};case M.closePreviewPanel:return{...e,preview:[]};case M.previousPreviewPanel:{const t=[...e.preview];return t.pop(),{...e,preview:t}}case M.closeFlyout:return{left:void 0,right:void 0,preview:[]};default:return e}}const P=({children:e})=>{const[t,n]=Object(s.useReducer)(A,I),a=Object(s.useCallback)((({right:e,left:t,preview:a})=>n({type:M.openFlyout,payload:{left:t,right:e,preview:a}})),[n]),i=Object(s.useCallback)((e=>n({type:M.openRightPanel,payload:e})),[]),r=Object(s.useCallback)((e=>n({type:M.openLeftPanel,payload:e})),[]),l=Object(s.useCallback)((e=>n({type:M.openPreviewPanel,payload:e})),[]),c=Object(s.useCallback)((()=>n({type:M.closeRightPanel})),[]),d=Object(s.useCallback)((()=>n({type:M.closeLeftPanel})),[]),m=Object(s.useCallback)((()=>n({type:M.closePreviewPanel})),[]),p=Object(s.useCallback)((()=>n({type:M.previousPreviewPanel})),[]),f=Object(s.useCallback)((()=>{n({type:M.closeFlyout})}),[]),b=Object(s.useMemo)((()=>({panels:t,openFlyout:a,openRightPanel:i,openLeftPanel:r,openPreviewPanel:l,closeRightPanel:c,closeLeftPanel:d,closePreviewPanel:m,closeFlyout:f,previousPreviewPanel:p})),[t,a,i,r,l,c,d,m,f,p]);return Object(u.jsx)(o.Provider,{value:b},e)},_=({children:e,storage:t="url"})=>"memory"===t?Object(u.jsx)(P,null,e):Object(u.jsx)(C,null,e)},,function(e,t,n){"use strict";var a=n(52);n.d(t,"j",(function(){return a.getUseField})),n.d(t,"i",(function(){return a.getFieldValidityAndErrorMessage})),n.d(t,"a",(function(){return a.FIELD_TYPES})),n.d(t,"c",(function(){return a.Form})),n.d(t,"e",(function(){return a.UseField})),n.d(t,"f",(function(){return a.UseMultiFields})),n.d(t,"k",(function(){return a.useForm})),n.d(t,"l",(function(){return a.useFormContext})),n.d(t,"m",(function(){return a.useFormData})),n.d(t,"g",(function(){return a.VALIDATION_TYPES}));var i=n(71);n.d(t,"b",(function(){return i.Field})),n.d(t,"d",(function(){return i.SelectField}));var s=n(81);n.d(t,"h",(function(){return s.fieldValidators}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(45),i=n(2),s=n(48),r=n(119),o=n(112),l=n(128),u=n(181);const c=()=>{const e=Object(s.useDispatch)(),{from:t,to:n}=Object(o.a)((e=>Object(a.pick)(["from","to"],l.d.globalTimeRangeSelector(e)))),[c,d]=Object(i.useState)(!0),m=Object(i.useRef)([]),p=Object(i.useCallback)((({id:t,inspect:n,loading:a,refetch:i,searchSessionId:s})=>{m.current=[...m.current,t],e(u.c.setQuery({inputId:r.a.global,id:t,inspect:n,loading:a,refetch:i,searchSessionId:s}))}),[e]),f=Object(i.useCallback)((({id:t})=>e(u.c.deleteOneQuery({inputId:r.a.global,id:t}))),[e]);return Object(i.useEffect)((()=>{d(!1)}),[]),Object(i.useEffect)((()=>()=>{m.current.length>0&&m.current.forEach((e=>f({id:e})))}),[f]),Object(i.useMemo)((()=>({isInitializing:c,from:t,to:n,setQuery:p,deleteQuery:f})),[f,t,c,p,n])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return Ge})),n.d(t,"c",(function(){return We})),n.d(t,"f",(function(){return Ke})),n.d(t,"d",(function(){return Je})),n.d(t,"e",(function(){return Ye}));var a=n(111),i=n(141),s=n(363),r=n(365),o=n(362),l=n(323),u=n(366),c=n(367),d=n(368),m=n(369);const p=a.z.object({name:i.I,description:i.z,risk_score:i.p,severity:i.V}),f=a.z.object({rule_name_override:i.J.optional(),timestamp_override:i.ab.optional(),timestamp_override_fallback_disabled:i.bb.optional(),timeline_id:i.Y.optional(),timeline_title:i.Z.optional(),outcome:i.S.optional(),alias_target_id:i.R.optional(),alias_purpose:i.Q.optional(),license:i.G.optional(),note:i.h.optional(),building_block_type:i.d.optional(),output_index:i.b.optional(),namespace:i.c.optional(),meta:i.H.optional(),investigation_fields:i.g.optional(),throttle:i.x.optional()}),b=a.z.object({version:i.P.optional(),tags:i.O.optional(),enabled:i.i.optional(),risk_score_mapping:i.q.optional(),severity_mapping:i.W.optional(),interval:i.D.optional(),from:i.E.optional(),to:i.F.optional(),actions:a.z.array(i.r).optional(),exceptions_list:a.z.array(i.A).optional(),author:i.y.optional(),false_positives:i.B.optional(),references:i.M.optional(),max_signals:i.l.optional(),threat:i.X.optional()}),g=p.merge(f).merge(b),v=p.partial().merge(f).merge(b),y=p.merge(f).merge(b.required()),h=a.z.object({id:i.K,rule_id:i.N,immutable:i.j,updated_at:a.z.string().datetime(),updated_by:a.z.string(),created_at:a.z.string().datetime(),created_by:a.z.string(),revision:a.z.number().int().min(0),related_integrations:i.n,required_fields:i.o,setup:i.U,execution_summary:s.a.optional()}),j=g.merge(a.z.object({rule_id:i.N.optional()})),E=g.merge(a.z.object({id:i.K.optional(),rule_id:i.N.optional()})),O=v.merge(a.z.object({id:i.K.optional(),rule_id:i.N.optional()})),x=y.merge(h),S=a.z.literal("eql"),k=a.z.object({type:a.z.literal("eql"),query:i.L,language:S}),w=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),event_category_override:r.a.optional(),tiebreaker_field:r.b.optional(),timestamp_field:r.c.optional()}),T=k.merge(w),C=k.merge(w),M=k.partial().merge(w),I=x.merge(C),A=j.merge(T),P=E.merge(T),_=O.merge(M),D=a.z.object({type:a.z.literal("query")}),R=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),response_actions:a.z.array(o.a).optional(),alert_suppression:l.a.optional()}),F=a.z.object({query:i.L.optional(),language:i.k.optional()}),N=D.merge(R).merge(F),L=D.partial().merge(R).merge(F),z=D.merge(R).merge(F.required()),B=x.merge(z),q=j.merge(N),V=E.merge(N),$=O.merge(L),U=a.z.object({type:a.z.literal("saved_query"),saved_id:i.T}),Q=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),response_actions:a.z.array(o.a).optional(),alert_suppression:l.a.optional(),query:i.L.optional()}),H=a.z.object({language:i.k.optional()}),G=U.merge(Q).merge(H),W=U.partial().merge(Q).merge(H),K=U.merge(Q).merge(H.required()),J=x.merge(K),Y=j.merge(G),X=E.merge(G),Z=O.merge(W),ee=a.z.object({type:a.z.literal("threshold"),query:i.L,threshold:u.a}),te=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),alert_suppression:u.b.optional()}),ne=a.z.object({language:i.k.optional()}),ae=ee.merge(te).merge(ne),ie=ee.partial().merge(te).merge(ne),se=ee.merge(te).merge(ne.required()),re=x.merge(se),oe=j.merge(ae),le=E.merge(ae),ue=O.merge(ie),ce=a.z.object({type:a.z.literal("threat_match"),query:i.L,threat_query:c.g,threat_mapping:c.f,threat_index:c.d}),de=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),threat_filters:c.c.optional(),threat_indicator_path:c.e.optional(),threat_language:i.k.optional(),concurrent_searches:c.a.optional(),items_per_search:c.b.optional()}),me=a.z.object({language:i.k.optional()}),pe=ce.merge(de).merge(me),fe=ce.partial().merge(de).merge(me),be=ce.merge(de).merge(me.required()),ge=x.merge(be),ve=j.merge(pe),ye=E.merge(pe),he=O.merge(fe),je=a.z.object({type:a.z.literal("machine_learning"),anomaly_threshold:d.a,machine_learning_job_id:d.b}),Ee=je.partial(),Oe=je,xe=je,Se=x.merge(Oe),ke=j.merge(xe),we=E.merge(xe),Te=O.merge(Ee),Ce=a.z.object({type:a.z.literal("new_terms"),query:i.L,new_terms_fields:m.b,history_window_start:m.a}),Me=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional()}),Ie=a.z.object({language:i.k.optional()}),Ae=Ce.partial().merge(Me).merge(Ie),Pe=Ce.merge(Me).merge(Ie.required()),_e=Ce.merge(Me).merge(Ie),De=x.merge(Pe),Re=j.merge(_e),Fe=E.merge(_e),Ne=O.merge(Ae),Le=a.z.literal("esql"),ze=a.z.object({type:a.z.literal("esql"),language:Le,query:i.L}),Be=ze.partial(),qe=ze,Ve=ze,$e=x.merge(qe),Ue=j.merge(Ve),Qe=E.merge(Ve),He=O.merge(Be.partial()),Ge=a.z.discriminatedUnion("type",[T,N,G,ae,pe,xe,_e,Ve]),We=(a.z.union([M,L,W,ie,fe,Ee,Ae,Be]),a.z.discriminatedUnion("type",[C,z,K,se,be,Oe,Pe,qe]),a.z.discriminatedUnion("type",[A,q,Y,oe,ve,ke,Re,Ue])),Ke=a.z.discriminatedUnion("type",[P,V,X,le,ye,we,Fe,Qe]),Je=a.z.union([_,$,Z,ue,he,Te,Ne,He]),Ye=a.z.discriminatedUnion("type",[I,B,J,re,ge,Se,De,$e])},,,,,,function(e,t,n){"use strict";n.d(t,"cc",(function(){return i})),n.d(t,"Lb",(function(){return s})),n.d(t,"Nb",(function(){return r})),n.d(t,"ad",(function(){return o})),n.d(t,"Zc",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"bc",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"Bb",(function(){return m})),n.d(t,"dc",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"r",(function(){return b})),n.d(t,"p",(function(){return g})),n.d(t,"s",(function(){return v})),n.d(t,"q",(function(){return y})),n.d(t,"m",(function(){return h})),n.d(t,"t",(function(){return j})),n.d(t,"w",(function(){return E})),n.d(t,"g",(function(){return O})),n.d(t,"n",(function(){return x})),n.d(t,"i",(function(){return S})),n.d(t,"o",(function(){return k})),n.d(t,"j",(function(){return w})),n.d(t,"h",(function(){return T})),n.d(t,"v",(function(){return C})),n.d(t,"u",(function(){return M})),n.d(t,"W",(function(){return I})),n.d(t,"U",(function(){return A})),n.d(t,"V",(function(){return P})),n.d(t,"Y",(function(){return _})),n.d(t,"A",(function(){return D})),n.d(t,"l",(function(){return R})),n.d(t,"y",(function(){return F})),n.d(t,"k",(function(){return N})),n.d(t,"z",(function(){return L})),n.d(t,"X",(function(){return z})),n.d(t,"S",(function(){return B})),n.d(t,"K",(function(){return q})),n.d(t,"B",(function(){return V})),n.d(t,"M",(function(){return $})),n.d(t,"C",(function(){return U})),n.d(t,"E",(function(){return Q})),n.d(t,"F",(function(){return H})),n.d(t,"D",(function(){return G})),n.d(t,"L",(function(){return W})),n.d(t,"N",(function(){return K})),n.d(t,"O",(function(){return J})),n.d(t,"G",(function(){return Y})),n.d(t,"P",(function(){return X})),n.d(t,"H",(function(){return Z})),n.d(t,"T",(function(){return ee})),n.d(t,"J",(function(){return te})),n.d(t,"I",(function(){return ne})),n.d(t,"Q",(function(){return ae})),n.d(t,"R",(function(){return ie})),n.d(t,"Gb",(function(){return se})),n.d(t,"Pc",(function(){return re})),n.d(t,"Oc",(function(){return oe})),n.d(t,"Uc",(function(){return le})),n.d(t,"Sc",(function(){return ue})),n.d(t,"ab",(function(){return ce})),n.d(t,"Rc",(function(){return de})),n.d(t,"Cb",(function(){return me})),n.d(t,"Qb",(function(){return pe})),n.d(t,"Rb",(function(){return fe})),n.d(t,"Ab",(function(){return be})),n.d(t,"Hb",(function(){return ge})),n.d(t,"xb",(function(){return ve})),n.d(t,"mb",(function(){return ye})),n.d(t,"lb",(function(){return he})),n.d(t,"nb",(function(){return je})),n.d(t,"gb",(function(){return Ee})),n.d(t,"ib",(function(){return Oe})),n.d(t,"hb",(function(){return xe})),n.d(t,"pb",(function(){return Se})),n.d(t,"bb",(function(){return ke})),n.d(t,"ob",(function(){return we})),n.d(t,"eb",(function(){return Te})),n.d(t,"fb",(function(){return Ce})),n.d(t,"jb",(function(){return Me})),n.d(t,"kb",(function(){return Ie})),n.d(t,"cb",(function(){return Ae})),n.d(t,"db",(function(){return Pe})),n.d(t,"Eb",(function(){return _e})),n.d(t,"zb",(function(){return De})),n.d(t,"rb",(function(){return Re})),n.d(t,"Db",(function(){return Fe})),n.d(t,"Xc",(function(){return Ne})),n.d(t,"Qc",(function(){return Le})),n.d(t,"Fc",(function(){return ze})),n.d(t,"Yb",(function(){return Be})),n.d(t,"Hc",(function(){return qe})),n.d(t,"Sb",(function(){return Ve})),n.d(t,"Xb",(function(){return $e})),n.d(t,"Tb",(function(){return Ue})),n.d(t,"Ub",(function(){return Qe})),n.d(t,"Vb",(function(){return He})),n.d(t,"Wb",(function(){return Ge})),n.d(t,"sb",(function(){return We})),n.d(t,"b",(function(){return Ke})),n.d(t,"Nc",(function(){return Je})),n.d(t,"Gc",(function(){return Ye})),n.d(t,"tb",(function(){return Xe})),n.d(t,"a",(function(){return Ze})),n.d(t,"Mc",(function(){return et})),n.d(t,"c",(function(){return tt})),n.d(t,"Zb",(function(){return nt})),n.d(t,"qb",(function(){return at})),n.d(t,"ub",(function(){return it})),n.d(t,"Mb",(function(){return st})),n.d(t,"Tc",(function(){return rt})),n.d(t,"Ob",(function(){return ot})),n.d(t,"ac",(function(){return lt})),n.d(t,"Wc",(function(){return ut})),n.d(t,"Jb",(function(){return ct})),n.d(t,"Kb",(function(){return dt})),n.d(t,"x",(function(){return mt})),n.d(t,"Vc",(function(){return pt})),n.d(t,"wb",(function(){return ft})),n.d(t,"vb",(function(){return bt})),n.d(t,"ec",(function(){return gt})),n.d(t,"Z",(function(){return vt})),n.d(t,"Dc",(function(){return yt})),n.d(t,"Ec",(function(){return ht})),n.d(t,"Cc",(function(){return jt})),n.d(t,"Ac",(function(){return Et})),n.d(t,"Bc",(function(){return Ot})),n.d(t,"pc",(function(){return xt})),n.d(t,"qc",(function(){return St})),n.d(t,"nc",(function(){return kt})),n.d(t,"oc",(function(){return wt})),n.d(t,"hc",(function(){return Tt})),n.d(t,"ic",(function(){return Ct})),n.d(t,"fc",(function(){return Mt})),n.d(t,"gc",(function(){return It})),n.d(t,"yc",(function(){return At})),n.d(t,"zc",(function(){return Pt})),n.d(t,"wc",(function(){return _t})),n.d(t,"xc",(function(){return Dt})),n.d(t,"lc",(function(){return Rt})),n.d(t,"mc",(function(){return Ft})),n.d(t,"jc",(function(){return Nt})),n.d(t,"kc",(function(){return Lt})),n.d(t,"tc",(function(){return zt})),n.d(t,"vc",(function(){return Bt})),n.d(t,"uc",(function(){return qt})),n.d(t,"rc",(function(){return Vt})),n.d(t,"sc",(function(){return $t})),n.d(t,"Lc",(function(){return Ut})),n.d(t,"Ic",(function(){return Qt})),n.d(t,"Fb",(function(){return Ht})),n.d(t,"yb",(function(){return Gt})),n.d(t,"Jc",(function(){return Wt})),n.d(t,"Pb",(function(){return Kt})),n.d(t,"Yc",(function(){return Jt})),n.d(t,"Ib",(function(){return Yt})),n.d(t,"Kc",(function(){return Xt}));var a=n(5);const i=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.popoverTooltip.ariaLabel",{defaultMessage:"Tooltip for column: {columnName}",values:{columnName:e}}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.importRuleTitle",{defaultMessage:"Import rules"}),r=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.importValueListsButton",{defaultMessage:"Import value lists"}),o=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonTooltip",{defaultMessage:"Use value lists to create an exception when a field value matches a value found in a list"}),l=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonPrivilegesTooltip",{defaultMessage:"A user with manage cluster privileges must visit the Rules page before you can import value lists."}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addNewRuleTitle",{defaultMessage:"Create new rule"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.pageTitle",{defaultMessage:"Rules"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addPageTitle",{defaultMessage:"Create"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.editPageTitle",{defaultMessage:"Edit"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.refreshTitle",{defaultMessage:"Refresh"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActionsTitle",{defaultMessage:"Bulk actions"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enableTitle",{defaultMessage:"Enable"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disableTitle",{defaultMessage:"Disable"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.exportTitle",{defaultMessage:"Export"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicateTitle",{defaultMessage:"Duplicate"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTitle",{defaultMessage:"Delete"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.indexPatternsTitle",{defaultMessage:"Index patterns"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.tagsTitle",{defaultMessage:"Tags"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addTagsTitle",{defaultMessage:"Add tags"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTagsTitle",{defaultMessage:"Delete tags"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.applyTimelineTemplateTitle",{defaultMessage:"Apply Timeline template"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addRuleActionsTitle",{defaultMessage:"Add rule actions"}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.setScheduleTitle",{defaultMessage:"Update rule schedules"}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.contextMenuTitle",{defaultMessage:"Options"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastTitle",{defaultMessage:"Rules updates are in progress"}),A=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} updating."}),P=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastNotifyButtonLabel",{defaultMessage:"Notify me when done"}),_=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkExportConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be exported"}),D=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be edited"}),R=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkActionConfirmationPartlyTitle",{values:{customRulesCount:e},defaultMessage:"This action can only be applied to {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),F=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmationCancelButtonLabel",{defaultMessage:"Cancel"}),N=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkActionConfirmationCloseButtonLabel",{defaultMessage:"Close"}),L=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Edit {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),z=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkExportConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Export {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),B=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.saveButtonLabel",{defaultMessage:"Save"}),q=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.cancelButtonLabel",{defaultMessage:"Cancel"}),V=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to add. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),$=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to delete. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),U=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxLabel",{defaultMessage:"Add index patterns for selected rules"}),Q=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.indexPatternsRequiredErrorMessage",{defaultMessage:"A minimum of one index pattern is required."}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),G=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' index patterns"}),W=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.dataViewsOverwriteCheckboxLabel",{defaultMessage:"Apply changes to rules configured with data views"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxLabel",{defaultMessage:"Delete index patterns for selected rules"}),J=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),Y=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxHelpText",{defaultMessage:"Add one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),X=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxHelpText",{defaultMessage:"Delete one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxLabel",{defaultMessage:"Add tags for selected rules"}),ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.tagsComoboxRequiredErrorMessage",{defaultMessage:"A minimum of one tag is required."}),te=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsTitle",{defaultMessage:"Add tags"}),ne=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' tags"}),ae=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxLabel",{defaultMessage:"Delete tags for selected rules"}),ie=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsTitle",{defaultMessage:"Delete tags"}),se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.exportFilenameTitle",{defaultMessage:"rules_export"}),re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchAriaLabel",{defaultMessage:"Search rules"}),oe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchPlaceholder",{defaultMessage:'Rule name, index pattern (e.g., "filebeat-*"), or MITRE ATT&CK™ tactic or technique (e.g., "Defense Evasion" or "TA0005")'}),le=(e,t,n)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.showingRulesTitle",{values:{firstInPage:e,lastOfPage:t,totalRules:n},defaultMessage:"Showing {firstInPage}-{lastOfPage} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ue=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectAllRulesTitle",{values:{totalRules:e},defaultMessage:"Select all {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.clearSelectionTitle",{defaultMessage:"Clear selection"}),de=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectedRulesTitle",{values:{selectedRules:e},defaultMessage:"Selected {selectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.editRuleSettingsDescription",{defaultMessage:"Edit rule settings"}),pe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaActionsFeaturePrivileges",{defaultMessage:"You do not have Kibana Actions privileges"}),fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaSecurityPrivileges",{defaultMessage:"You do not have Kibana Security privileges"}),be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.duplicateRuleDescription",{defaultMessage:"Duplicate rule"}),ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.exportRuleDescription",{defaultMessage:"Export rule"}),ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.deleteRuleDescription",{defaultMessage:"Delete rule"}),ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.ruleTitle",{defaultMessage:"Rule"}),he=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.riskScoreTitle",{defaultMessage:"Risk score"}),je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.severityTitle",{defaultMessage:"Severity"}),Ee=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastRunTitle",{defaultMessage:"Last run"}),Oe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastUpdateTitle",{defaultMessage:"Last updated"}),xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastResponseTitle",{defaultMessage:"Last response"}),Se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.tagsTitle",{defaultMessage:"Tags"}),ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.enabledTitle",{defaultMessage:"Enabled"}),we=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.snoozeTitle",{defaultMessage:"Notify"}),Te=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimes",{defaultMessage:"Indexing Time (ms)"}),Ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimesTooltip",{defaultMessage:"Total time spent indexing alerts during last Rule execution"}),Me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimes",{defaultMessage:"Query Time (ms)"}),Ie=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimesTooltip",{defaultMessage:"Total time spent querying source indices during last Rule execution"}),Ae=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gap",{defaultMessage:"Last Gap (if any)"}),Pe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),_e=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.rules",{defaultMessage:"Rules"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.enabledRulesTitle",{defaultMessage:"Enabled rules"})),De=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.disabledRulesTitle",{defaultMessage:"Disabled rules"}),Re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.customRulesTitle",{defaultMessage:"Custom rules"}),Fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.elasticRulesTitle",{defaultMessage:"Elastic rules"}),Ne=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.tagsLabel",{defaultMessage:"Tags"}),Le=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.searchTagsPlaceholder",{defaultMessage:"Search tags"}),ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.rulesTagSearchText",{defaultMessage:"Rules tag search"}),Be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noTagsAvailableDescription",{defaultMessage:"No tags available"}),qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.ruleExecutionStatusFilter",{defaultMessage:"Select rule execution status to filter by"}),Ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesTitle",{defaultMessage:"No rules found"}),$e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesBodyTitle",{defaultMessage:"We weren't able to find any rules with the above filters."}),Ue=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesTitle",{defaultMessage:"All Elastic rules have been installed"}),Qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesBodyTitle",{defaultMessage:"There are no prebuilt detection rules available for installation"}),He=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesTitle",{defaultMessage:"All Elastic rules are up to date"}),Ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesBodyTitle",{defaultMessage:"There are currently no available updates to your installed Elastic rules."}),We=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.defineRuleTitle",{defaultMessage:"Define rule"}),Ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.aboutRuleTitle",{defaultMessage:"About rule"}),Je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.scheduleRuleTitle",{defaultMessage:"Schedule rule"}),Ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleActionsTitle",{defaultMessage:"Rule actions"}),Xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepDefinitionTitle",{defaultMessage:"Definition"}),Ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepAboutTitle",{defaultMessage:"About"}),et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepScheduleTitle",{defaultMessage:"Schedule"}),tt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepActionsTitle",{defaultMessage:"Actions"}),nt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.optionalFieldDescription",{defaultMessage:"Optional"}),at=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.continueButtonTitle",{defaultMessage:"Continue"}),it=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.updateButtonTitle",{defaultMessage:"Update"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.deleteDescription",{defaultMessage:"Delete"})),st=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importRuleTitle",{defaultMessage:"Import"}),rt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.selectRuleDescription",{defaultMessage:"Select rules to import. Associated rule actions and exceptions can be included."}),ot=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid rules_export.ndjson file"}),lt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteDescription",{defaultMessage:'Overwrite existing detection rules with conflicting "rule_id"'}),ut=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.successfullyImportedRulesTitle",{values:{totalRules:e},defaultMessage:"Successfully imported {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ct=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedTitle",{values:{totalRules:e},defaultMessage:"Failed to import {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),dt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"}),mt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkDeleteConfirmationTitle",{defaultMessage:"Confirm bulk deletion"}),pt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.singleDeleteConfirmationTitle",{defaultMessage:"Confirm deletion"}),ft=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationConfirm",{defaultMessage:"Delete"}),bt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationCancel",{defaultMessage:"Cancel"}),gt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverDescription",{defaultMessage:"Automatically refresh table"}),vt=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverLabel",{defaultMessage:"Refresh settings"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.clearRulesTableFilters",{defaultMessage:"Clear filters"})),yt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastTitle",{defaultMessage:"Rules exported"}),ht=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastDescription",{values:{totalRules:t,exportedRules:e},defaultMessage:"Successfully exported {exportedRules} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}."}),jt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.prebuiltRulesExcludedToastDescription",{defaultMessage:"Prebuilt rules were excluded from the resulting file."}),Et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastTitle",{defaultMessage:"Error exporting rules"}),Ot=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to export."}),xt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastTitle",{defaultMessage:"Rules duplicated"}),St=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully duplicated {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),kt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastTitle",{defaultMessage:"Error duplicating rule"}),wt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to duplicate."}),Tt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastTitle",{defaultMessage:"Rules deleted"}),Ct=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully deleted {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Mt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastTitle",{defaultMessage:"Error deleting rules"}),It=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to delete."}),At=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.successToastTitle",{defaultMessage:"Rules enabled"}),Pt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkAction.enable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully enabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),_t=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastTitle",{defaultMessage:"Error enabling rules"}),Dt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to enable."}),Rt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastTitle",{defaultMessage:"Rules disabled"}),Ft=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully disabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Nt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastTitle",{defaultMessage:"Error disabling rules"}),Lt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to disable."}),zt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastTitle",{defaultMessage:"Rules updated"}),Bt=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastDescription",{values:{succeededRulesCount:e,skippedRulesCount:t},defaultMessage:"{succeededRulesCount, plural, =0 {} =1 {You've successfully updated # rule. } other {You've successfully updated # rules. }}\n        {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}\n        "}),qt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successIndexEditToastDescription",{defaultMessage:"If you did not select to apply changes to rules using Kibana data views, those rules were not updated and will continue using data views."}),Vt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastTitle",{defaultMessage:"Error updating rules"}),$t=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastDescription",{values:{failedRulesCount:e,skippedRulesCount:t},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to update. {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}"}),Ut=(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.hooks.useGetSavedQuery.errorToastMessage",{defaultMessage:"Failed to load the saved query"})),Qt=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextDescription",{defaultMessage:"Selected Detection Rules"}),Ht=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.explainThenSummarizeRuleDetails",{defaultMessage:"Please explain the selected rules above. For each rule, highlight why they are relevant, the query as published on Elastic's detection rules repository and an in-depth explanation of it, and what they typically mean for an organization if detected."}),Gt=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.detectionRulesConversationId",{defaultMessage:"Detection Rules"}),Wt=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextTooltip",{defaultMessage:"Add this alert as context"}),Kt=a.i18n.translate("xpack.securitySolution.addRules.installRuleButton",{defaultMessage:"Install rule"}),Jt=a.i18n.translate("xpack.securitySolution.addRules.upgradeRuleButton",{defaultMessage:"Update rule"}),Yt=a.i18n.translate("xpack.securitySolution.addRules.goBackToRulesTableButton",{defaultMessage:"Go back to installed Elastic rules"}),Xt=a.i18n.translate("xpack.securitySolution.ruleUpdates.documentationLink",{defaultMessage:"See what's new in Prebuilt Security Detection Rules"})},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(17),i=n(2),s=n.n(i),r=n(119),o=n(276),l=n(381),u=n(465),c=n(382);const d="inspectButtonComponent",m=({children:e,show:t=!0})=>s.a.createElement(o.a,{show:t,targetClassNames:[d]},e),p=({compact:e=!1,inputId:t=r.a.global,inspectIndex:n=0,isDisabled:i,multiple:o=!1,onCloseInspect:m,queryId:p="",showInspectButton:f=!0,title:b=""})=>{const{additionalRequests:g,additionalResponses:v,handleClick:y,handleCloseModal:h,isButtonDisabled:j,isShowingModal:E,loading:O,request:x,response:S}=Object(u.a)({inputId:t,inspectIndex:n,isDisabled:i,multiple:o,onCloseInspect:m,queryId:p});return s.a.createElement(s.a.Fragment,null,t===r.a.timeline&&!e&&f&&s.a.createElement(a.EuiButtonEmpty,{className:d,"aria-label":c.d,"data-test-subj":"inspect-empty-button",isDisabled:j,isLoading:O,onClick:y},c.d),(t===r.a.global||e)&&f&&s.a.createElement(a.EuiButtonIcon,{className:d,"aria-label":c.d,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:j,title:c.d,onClick:y}),E&&null!==x&&null!==S&&s.a.createElement(l.a,{additionalRequests:g,additionalResponses:v,closeModal:h,"data-test-subj":"inspect-modal",inputId:t,request:x,response:S,title:b}))};p.displayName="InspectButtonComponent";const f=s.a.memo(p)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(110),s=n(202);const r=e=>{var t;const[{pageName:n}]=Object(s.a)(),{services:{storage:r}}=Object(i.i)(),o=((e,t)=>t&&e.length>0?`kibana.siem:${t}.query.toggle:${e}`:null)(n,e),[l,u]=Object(a.useState)(null==o||null===(t=r.get(o))||void 0===t||t);Object(a.useEffect)((()=>{var e;null!=o&&u(null===(e=r.get(o))||void 0===e||e)}),[r,o]);const c=Object(a.useCallback)((e=>{null!=o&&(r.set(o,e),u(e))}),[r,o]);return e?{toggleStatus:l,setToggleStatus:c}:{toggleStatus:!0,setToggleStatus:()=>{}}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return k})),n.d(t,"d",(function(){return w})),n.d(t,"f",(function(){return T})),n.d(t,"g",(function(){return M})),n.d(t,"c",(function(){return V})),n.d(t,"h",(function(){return $})),n.d(t,"b",(function(){return U}));var a=n(448),i=n(45),s=n(51),r=n(324),o=n.n(r),l=n(119),u=n(122),c=n(113),d=n(208),m=n(158),p=n(14),f=n(134),b=n(196),g=n(204),v=n(590),y=n(153),h=n(335),j=n(149),E=n(116),O=n(281),x=n(193);const S="open-timeline",k=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,w=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,n)=>t+e[n].length),0):0)+(null!=t?t.length:0),T=({title:e})=>null==e||0===e.trim().length,C=(e,t)=>"__typename"===e?void 0:t,M=e=>JSON.parse(JSON.stringify(e),C),I=e=>{try{return JSON.parse(e)}catch{return e}},A=e=>Object.entries(e).reduce(((e,[t,n])=>"id"!==t&&null!=n?{...e,[t]:n}:e),{columnHeaderType:b.a,id:null!=e.id?e.id:"unknown",initialWidth:"@timestamp"===e.id?g.b:g.a}),P=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:I(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:I(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:I(e.meta.value)}:{}},...null!=e.exists?{exists:I(e.exists)}:{},...null!=e.match_all?{exists:I(e.match_all)}:{},...null!=e.missing?{exists:I(e.missing)}:{},...null!=e.query?{query:I(e.query)}:{},...null!=e.range?{range:I(e.range)}:{},...null!=e.script?{exists:I(e.script)}:{}}),_=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(i.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):{},D=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},R=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},F=(e,t,n)=>n===c.l.default&&e.timelineType===c.l.template?e.templateTimelineId:t&&e.timelineType===c.l.template?Object(s.v4)():e.templateTimelineId,N=({and:e,...t})=>t.type===c.a.template?o()(t,{type:c.a.default,enabled:t.queryMatch.operator!==y.d,queryMatch:{value:t.queryMatch.operator===y.d?"":t.queryMatch.value}}):t,L=(e,t,n)=>e&&t&&n===c.l.default?t.map((e=>{var t,n;return{...N(e),and:null!==(t=null===(n=e.and)||void 0===n?void 0:n.map(N))&&void 0!==t?t:[]}})):t,z=(e,t,n)=>n&&e.timelineType!==n?"":t?`${e.title} - Duplicate`:e.title||"",B=(e,t,n)=>n&&e.timelineType!==n?c.k.draft:t?c.k.active:e.status,q=(e,t,n)=>{const i=e.timelineType===c.l.template,s={...e,columns:null!=e.columns?e.columns.map(A):b.b,defaultColumns:b.b,dateRange:e.status===c.k.immutable&&e.timelineType===c.l.template?{start:O.a.toISOString(),end:O.b.toISOString()}:e.dateRange,dataProviders:L(t,e.dataProviders,n),eventIdToNoteIds:_(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(P):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:R(t,e.pinnedEventIds),pinnedEventsSaveObject:D(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:B(e,t,n),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=n?n:e.timelineType,title:z(e,t,n),templateTimelineId:F(e,t,n),templateTimelineVersion:t&&i?1:e.templateTimelineVersion};return Object.entries(s).reduce(((e,[t,n])=>null!=n?Object(a.set)(t,n,e):e),{...f.b,id:""})},V=(e,t=!1,n)=>{const{notes:a,...i}=e;return{notes:a,timeline:q(i,t,n)}},$=({activeTimelineTab:e=u.d.query,duplicate:t=!1,graphEventId:n="",timelineId:a,timelineType:s,onError:r,onOpenTimeline:o,openTimeline:l=!0,updateIsLoading:c,updateTimeline:d,savedSearchId:m})=>{c({id:u.c.active,isLoading:!0}),null==a?(d({id:u.c.active,duplicate:!1,notes:[],from:O.a.toISOString(),to:O.b.toISOString(),timeline:{...f.b,id:u.c.active,activeTab:e,show:l,initialized:!0,savedSearchId:null!=m?m:null}})(),c({id:u.c.active,isLoading:!1})):Promise.resolve(Object(x.j)(a)).then((a=>{const r=Object(i.getOr)(null,"data",a);if(!r)return;const c=M(r.timeline),{timeline:m,notes:p}=V(c,t,s);if(null!=o)o(m);else if(d){const{from:a,to:s}=Object(h.a)({from:Object(i.getOr)(null,"dateRange.start",m),to:Object(i.getOr)(null,"dateRange.end",m)});d({duplicate:t,from:a,id:u.c.active,notes:p,resolveTimelineConfig:{outcome:r.outcome,alias_target_id:r.alias_target_id,alias_purpose:r.alias_purpose},timeline:{...m,activeTab:e,graphEventId:n,show:l,dateRange:{start:a,end:s},savedSearchId:m.savedSearchId},to:s,preventSettingQuery:!0})()}})).catch((e=>{null!=r&&r(e,a)})).finally((()=>{c({id:u.c.active,isLoading:!1})}))},U=e=>({duplicate:t,id:n,forceNotes:a=!1,from:s,notes:r,resolveTimelineConfig:o,timeline:u,to:f,ruleNote:b,ruleAuthor:g,preventSettingQuery:y})=>()=>{let h=u;var x;if(t&&(h={...u,updated:void 0,changed:void 0,version:null}),Object(i.isEmpty)(h.indexNames)||e(j.a.setSelectedDataView({id:E.SourcererScopeName.timeline,selectedDataViewId:h.dataViewId,selectedPatterns:h.indexNames})),h.status===c.k.immutable&&h.timelineType===c.l.template?e(Object(m.setRelativeRangeDatePicker)({id:l.a.timeline,fromStr:"now-24h",toStr:"now",from:O.a.toISOString(),to:O.b.toISOString()})):e(Object(m.setTimelineRangeDatePicker)({from:s,to:f})),e(Object(p.addTimeline)({id:n,timeline:h,resolveTimelineConfig:o,savedTimeline:t})),y||null==h.kqlQuery||null==h.kqlQuery.filterQuery||null==h.kqlQuery.filterQuery.kuery||""===h.kqlQuery.filterQuery.kuery.expression||e(Object(p.applyKqlFilterQuery)({id:n,filterQuery:{kuery:{kind:null!==(x=h.kqlQuery.filterQuery.kuery.kind)&&void 0!==x?x:"kuery",expression:h.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:h.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=b&&!Object(i.isEmpty)(b)){const t=Object(v.a)({newNote:b,user:g||"elastic"});e(Object(d.updateNote)({note:t})),e(Object(p.addNote)({noteId:t.id,id:n}))}t&&!a||e(Object(d.addNotes)({notes:null!=r?r.map((e=>{var t,n;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(n=e.timelineId)&&void 0!==n?n:null}})):[]}))}},function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"y",(function(){return p})),n.d(t,"p",(function(){return f})),n.d(t,"v",(function(){return b})),n.d(t,"j",(function(){return g})),n.d(t,"h",(function(){return v})),n.d(t,"k",(function(){return y})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return j})),n.d(t,"e",(function(){return E})),n.d(t,"q",(function(){return O})),n.d(t,"b",(function(){return x})),n.d(t,"n",(function(){return S})),n.d(t,"i",(function(){return k})),n.d(t,"l",(function(){return w})),n.d(t,"a",(function(){return T})),n.d(t,"o",(function(){return C})),n.d(t,"c",(function(){return M})),n.d(t,"m",(function(){return I})),n.d(t,"x",(function(){return A})),n.d(t,"w",(function(){return P})),n.d(t,"r",(function(){return _})),n.d(t,"s",(function(){return D})),n.d(t,"t",(function(){return R})),n.d(t,"u",(function(){return F}));var a=n(29),i=n(72),s=n(70),r=n(663),o=n(191),l=n(4),u=n(341),c=n(389),d=n(110);n(154);const m=async({rule:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),p=async({rule:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"PUT",version:"2023-10-31",body:JSON.stringify(e),signal:t}),f=async({ruleProperties:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"PATCH",version:"2023-10-31",body:JSON.stringify(e),signal:t}),b=async({rule:e,signal:t})=>d.b.get().http.fetch(l.ib,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),g=async({filterOptions:e={filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:t={field:"enabled",order:"desc"},pagination:n={page:1,perPage:20},signal:a})=>{const i=Object(r.a)(e),s={page:n.page,per_page:n.perPage,sort_field:t.field,sort_order:t.order,...""!==i?{filter:i}:{}};return d.b.get().http.fetch(l.kb,{method:"GET",version:"2023-10-31",query:s,signal:a})},v=async({id:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"GET",version:"2023-10-31",query:{id:e},signal:t}),y=async({ids:e,signal:t})=>{var n;return null===(n=(await d.b.get().http.fetch(a.INTERNAL_ALERTING_API_FIND_RULES_PATH,{method:"GET",query:{filter:e.map((e=>`alert.id:"alert:${e}"`)).join(" or "),fields:JSON.stringify(["muteAll","activeSnoozes","isSnoozedUntil","snoozeSchedule"]),per_page:e.length},signal:t})).data)||void 0===n?void 0:n.reduce(((e,{id:t,...n})=>{var a,i;return e[t]={muteAll:null!==(a=n.mute_all)&&void 0!==a&&a,activeSnoozes:null!==(i=n.active_snoozes)&&void 0!==i?i:[],isSnoozedUntil:n.is_snoozed_until?new Date(n.is_snoozed_until):void 0,snoozeSchedule:n.snooze_schedule},e}),{})},h=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connectors`,{method:"GET",signal:e}),j=async({filter:e,signal:t})=>d.b.get().http.fetch(o.f,{method:"POST",version:"1",body:JSON.stringify({filter:e}),signal:t}),E=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connector_types`,{method:"GET",signal:e,query:{feature_id:"siem"}});async function O({bulkAction:e,dryRun:t=!1}){const n={action:e.type,query:e.query,ids:e.ids,edit:e.type===o.b.edit?e.editPayload:void 0,duplicate:e.type===o.b.duplicate?e.duplicatePayload:void 0};return d.b.get().http.fetch(l.hb,{method:"POST",version:"2023-10-31",body:JSON.stringify(n),query:{dry_run:t}})}async function x(e){const t={action:o.b.export,query:e.query,ids:e.ids};return d.b.get().http.fetch(l.hb,{method:"POST",version:"2023-10-31",body:JSON.stringify(t)})}const S=async({fileToImport:e,overwrite:t=!1,overwriteExceptions:n=!1,overwriteActionConnectors:a=!1,signal:i})=>{const s=new FormData;return s.append("file",e),d.b.get().http.fetch(`${l.jb}/_import`,{method:"POST",version:"2023-10-31",headers:{"Content-Type":void 0},query:{overwrite:t,overwrite_exceptions:n,overwrite_action_connectors:a},body:s,signal:i})},k=async({signal:e})=>d.b.get().http.fetch(o.g,{method:"GET",version:"1",signal:e}),w=async({lists:e,signal:t})=>{const n=e.some((({id:e})=>void 0===e))?{namespace_types:e.map((({namespaceType:e})=>e)).join(",")}:{ids:e.map((({id:e})=>e)).join(","),list_ids:e.map((({listId:e})=>e)).join(","),namespace_types:e.map((({namespaceType:e})=>e)).join(",")};return d.b.get().http.fetch(c.a,{method:"GET",version:"1",query:n,signal:t})},T=async({ruleId:e,items:t,signal:n})=>d.b.get().http.fetch(`${l.jb}/${e}/exceptions`,{method:"POST",version:"2023-10-31",body:JSON.stringify({items:t}),signal:n}),C=({packageName:e,packageVersion:t,prerelease:n=!1,force:a=!0})=>d.b.get().http.post(s.epmRouteService.getInstallPath(e,t),{query:{prerelease:n},version:"2023-10-31",body:JSON.stringify({force:a})}),M=({packages:e,prerelease:t=!1})=>d.b.get().http.post(s.epmRouteService.getBulkInstallPath(),{query:{prerelease:t},version:"2023-10-31",body:JSON.stringify({packages:e})}),I=async({signal:e})=>d.b.get().http.fetch(u.a,{method:"GET",version:"1",signal:e}),A=async({signal:e})=>d.b.get().http.fetch(u.f,{method:"POST",version:"1",signal:e}),P=async({signal:e})=>d.b.get().http.fetch(u.e,{method:"POST",version:"1",signal:e}),_=async()=>d.b.get().http.fetch(u.b,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES"})}),D=async e=>d.b.get().http.fetch(u.b,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e})}),R=async()=>d.b.get().http.fetch(u.c,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES",pick_version:"TARGET"})}),F=async e=>d.b.get().http.fetch(u.c,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e,pick_version:"TARGET"})})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y}));var a=n(17),i=n(2),s=n.n(i),r=n(44),o=n.n(r),l=n(544),u=n(174),c=n(126),d=n(153),m=n(564);const p=({field:e,tooltipContent:t})=>null!=t?t:e,f=s.a.memo((({children:e,field:t,tooltipContent:n,tooltipPosition:i,value:r})=>(e=>null===e)(n)?s.a.createElement(s.a.Fragment,null,e||r):s.a.createElement(a.EuiToolTip,{"data-test-subj":`${t}-tooltip`,position:i,content:p({tooltipContent:n,field:t})},s.a.createElement(s.a.Fragment,null,e||r))));f.displayName="Content";const b=s.a.memo((({hideTopN:e=!1,id:t,isDraggable:n=!0,field:a,fieldType:r="",isAggregatable:o=!1,value:c,name:p,children:b,scopeId:g,tooltipContent:v,tooltipPosition:y,queryValue:h,truncate:j})=>{const E=Object(i.useMemo)((()=>{var e;return{and:[],enabled:!0,id:Object(u.i)(t),name:p||(null!==(e=null==c?void 0:c.toString())&&void 0!==e?e:""),excluded:!1,kqlQuery:"",queryMatch:{field:a,value:h||(null!=c?c:""),operator:d.d}}}),[a,t,p,h,c]),O=Object(i.useCallback)(((e,t,n)=>n.isDragging?s.a.createElement(l.a,null,s.a.createElement(m.a,{dataProvider:e})):s.a.createElement(f,{field:a,tooltipContent:v,tooltipPosition:y,value:c},b)),[b,a,v,y,c]);return null==c?null:s.a.createElement(l.b,{dataProvider:E,fieldType:r,isAggregatable:o,hideTopN:e,isDraggable:n,render:O,scopeId:g,truncate:j})}));b.displayName="DefaultDraggable";const g=o()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1g0jgxk-0"})(["vertical-align:top;"]);g.displayName="Badge";const v=({contextId:e,eventId:t,field:n,value:a,iconType:i,isDraggable:r,isAggregatable:o,fieldType:l,name:u,color:d="hollow",children:m,scopeId:p,tooltipContent:f,queryValue:v})=>null!=a?s.a.createElement(b,{id:`draggable-badge-default-draggable-${e}-${t}-${n}-${a}`,isDraggable:r,isAggregatable:o,fieldType:l,field:n,name:u,value:a,scopeId:p,tooltipContent:f,queryValue:v},s.a.createElement(g,{iconType:i,color:d,title:""},m||(""!==a?a:Object(c.c)()))):null;v.displayName="DraggableBadgeComponent";const y=s.a.memo(v);y.displayName="DraggableBadge"},,function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.welcomeConversationTitle",{defaultMessage:"Welcome"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.defaultConversationTitle",{defaultMessage:"Default"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.elasticAiAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.elasticAiAssistantName",{defaultMessage:"Assistant"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(17),i=n(2),s=n.n(i),r=n(44),o=n.n(r),l=n(59),u=n.n(l),c=n(159),d=n(716),m=n(717);const p=o.a.header.withConfig({displayName:"Header",componentId:"sc-1q9aiyj-0"})(["&.toggle-expand{margin-bottom:",";}.no-margin{margin-top:0 !important;margin-bottom:0 !important;}"," margin-bottom:0;user-select:text;",""],(({theme:e})=>e.eui.euiSizeL),(({height:e})=>e&&Object(r.css)(["height:","px;"],e)),(({border:e})=>e&&Object(r.css)(["border-bottom:",";padding-bottom:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeL))));p.displayName="Header";const f=({alignHeader:e,stackHeader:t})=>null!=e?e:t?void 0:"center",b=({alignHeader:e,border:t,children:n,outerDirection:r="column",growLeftSplit:o=!0,headerFilters:l,height:b,hideSubtitle:g=!1,id:v,inspectMultiple:y=!1,inspectTitle:h,isInspectDisabled:j,showInspectButton:E=!0,split:O,stackHeader:x,subtitle:S,title:k,titleSize:w="l",toggleQuery:T,toggleStatus:C=!0,tooltip:M,tooltipTitle:I})=>{const A=Object(i.useCallback)((()=>{T&&T(!C)}),[T,C]),P=u()({"toggle-expand":C,siemHeaderSection:!0});return s.a.createElement(p,{"data-test-subj":"header-section",border:t,height:b,className:P,$hideSubtitle:g},s.a.createElement(a.EuiFlexGroup,{"data-test-subj":"headerSectionOuterFlexGroup",direction:r,gutterSize:"xs",responsive:!1},s.a.createElement(a.EuiFlexItem,{grow:o},s.a.createElement(a.EuiFlexGroup,{alignItems:f({alignHeader:e,stackHeader:x}),"data-test-subj":"headerSectionInnerFlexGroup",direction:x?"column":"row",gutterSize:"s"},s.a.createElement(a.EuiFlexItem,{grow:o,className:C?"":"no-margin"},s.a.createElement(a.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},s.a.createElement(a.EuiFlexItem,null,s.a.createElement(a.EuiFlexGroup,{responsive:!1,gutterSize:"none",className:"header-section-titles"},T&&s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiButtonIcon,{"data-test-subj":"query-toggle-header","aria-label":m.a(C),color:"text",display:"empty",iconType:C?"arrowDown":"arrowRight",onClick:A,size:"s",title:m.a(C)})),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(a.EuiTitle,{size:w},s.a.createElement("h4",{"data-test-subj":"header-section-title"},s.a.createElement("span",{className:"eui-textBreakNormal"},k),M&&s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiIconTip,{color:"subdued",title:I,content:M,size:"l",type:"iInCircle"}))))))),v&&C&&s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(c.b,{isDisabled:j,queryId:v,multiple:y,showInspectButton:E,title:null!=h?h:k})),l&&C&&s.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-filters",grow:!1},l))),n&&C&&s.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-supplements",grow:!!O},n))),!g&&C&&s.a.createElement(a.EuiFlexItem,null,s.a.createElement(d.a,{"data-test-subj":"header-section-subtitle",items:S}))))},g=s.a.memo(b)},,,function(e,t,n){const a=n(314),{MAX_LENGTH:i,MAX_SAFE_INTEGER:s}=n(315),{safeRe:r,t:o}=n(316),l=n(412),{compareIdentifiers:u}=n(514);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?r[o.LOOSE]:r[o.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>s||this.major<0)throw new TypeError("Invalid major version");if(this.minor>s||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>s||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<s)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let a=this.prerelease.length;for(;--a>=0;)"number"==typeof this.prerelease[a]&&(this.prerelease[a]++,a=-2);if(-1===a){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let a=[t,e];!1===n&&(a=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=SemVer},function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"n",(function(){return f}));var a=n(45),i=n(114),s=n(124),r=n(204),o=n(127),l=n(181),u=n(424);n.d(t,"f",(function(){return i.g})),n.d(t,"h",(function(){return i.i})),n.d(t,"g",(function(){return i.h})),n.d(t,"l",(function(){return i.m})),n.d(t,"k",(function(){return i.l})),n.d(t,"p",(function(){return i.r})),n.d(t,"o",(function(){return i.q})),n.d(t,"m",(function(){return i.n})),n.d(t,"i",(function(){return i.j})),n.d(t,"q",(function(){return i.w})),n.d(t,"r",(function(){return i.x})),n.d(t,"j",(function(){return i.k})),n.d(t,"a",(function(){return i.b})),n.d(t,"b",(function(){return i.e}));const c=({activeTimelineDataProviders:e,dataProviders:t,dispatch:n,result:a,timelineId:s,noProviderFound:r=l.b.noProviderFound,onAddedToTimeline:o})=>{const c=Object(i.p)(a),d=t[c];d?Object(u.b)({dataProviders:e,destination:a.destination,dispatch:n,onAddedToTimeline:o,providerToAdd:d,timelineId:s}):n(r({id:c}))},d=({isAggregatable:e,fieldType:t,fieldName:n,hideTopN:a})=>{const i=["boolean","geo-point","geo-shape","ip","keyword","number","numeric","string"].includes(t),s=["kibana.alert.ancestors.depth","kibana.alert.ancestors.id","kibana.alert.ancestors.rule","kibana.alert.ancestors.type","kibana.alert.original_event.action","kibana.alert.original_event.category","kibana.alert.original_event.code","kibana.alert.original_event.created","kibana.alert.original_event.dataset","kibana.alert.original_event.duration","kibana.alert.original_event.end","kibana.alert.original_event.hash","kibana.alert.original_event.id","kibana.alert.original_event.kind","kibana.alert.original_event.module","kibana.alert.original_event.original","kibana.alert.original_event.outcome","kibana.alert.original_event.provider","kibana.alert.original_event.risk_score","kibana.alert.original_event.risk_score_norm","kibana.alert.original_event.sequence","kibana.alert.original_event.severity","kibana.alert.original_event.start","kibana.alert.original_event.timezone","kibana.alert.original_event.type","kibana.alert.original_time","kibana.alert.rule.created_by","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.false_positives","kibana.alert.rule.from","kibana.alert.rule.uuid","kibana.alert.rule.immutable","kibana.alert.rule.interval","kibana.alert.rule.max_signals","kibana.alert.rule.name","kibana.alert.rule.note","kibana.alert.rule.references","kibana.alert.risk_score","kibana.alert.rule.rule_id","kibana.alert.severity","kibana.alert.rule.size","kibana.alert.rule.tags","kibana.alert.rule.threat","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.timeline_id","kibana.alert.rule.timeline_title","kibana.alert.rule.to","kibana.alert.rule.type","kibana.alert.rule.updated_by","kibana.alert.rule.version","kibana.alert.workflow_status"].includes(n);return!a&&(s||e&&i)},m={"kibana.alert.rule.name":"kibana.alert.rule.uuid","event.module":"rule.reference"},p=({browserFields:e,dispatch:t,result:n,scopeId:l,defaultsHeader:u})=>{var c;const d=Object(i.o)(n),p=(e=>Object(a.keyBy)("name",(e=>Object.values(e).reduce(((e,t)=>[...e,...Object.values(null!=t.fields?t.fields:{})]),[]))(e)))(e)[d],f=l!==s.e.alertsOnAlertsPage&&l!==s.e.alertsOnRuleDetailsPage||null===(c=u.find((e=>e.id===d)))||void 0===c?{}:c,b=Object(o.getScopedActions)(l);var g;null!=p&&b?t(b.upsertColumn({column:{category:p.category,columnHeaderType:"not-filtered",description:Object(a.isString)(p.description)?p.description:void 0,example:Object(a.isString)(p.example)?p.example:void 0,id:d,linkField:null!==(g=m[d])&&void 0!==g?g:void 0,type:p.type,aggregatable:p.aggregatable,initialWidth:r.a,...f},id:l,index:null!=n.destination?n.destination.index:0})):b&&t(b.upsertColumn({column:{columnHeaderType:"not-filtered",id:d,initialWidth:r.a},id:l,index:null!=n.destination?n.destination.index:0}))},f=e=>e.slice(e.lastIndexOf(".")+1)},,,function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"o",(function(){return s})),n.d(t,"r",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"k",(function(){return b})),n.d(t,"j",(function(){return g})),n.d(t,"i",(function(){return v})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return h})),n.d(t,"p",(function(){return j})),n.d(t,"q",(function(){return E}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.connectors.useLoadActionTypes.errorMessage",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into your Elastic Life. "}),s=a.i18n.translate("xpack.elasticAssistant.connectors.useLoadConnectors.errorMessage",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into your Elastic Life. "}),r=(a.i18n.translate("xpack.elasticAssistant.content.prompts.welcome.welcomeSecurityPrompt",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into Elastic Security. "}),a.i18n.translate("xpack.elasticAssistant.assistant.connectors.preconfiguredTitle",{defaultMessage:"Preconfigured"})),o=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.ariaLabel",{defaultMessage:"Conversation Selector"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.newConnectorOptions",{defaultMessage:"Add new Connector..."}),u=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelectorInline.connectorLabel",{defaultMessage:"Connector:"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelectorInline.connectorPlaceholder",{defaultMessage:"Select a Connector"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.title",{defaultMessage:"Add Generative AI Connector"}),m=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.description",{defaultMessage:"Configure a connector to continue the conversation"}),p=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.missingPrivilegesTitle",{defaultMessage:"Generative AI Connector Required"}),f=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.missingPrivilegesDescription",{defaultMessage:"Please contact your administrator to enable a Generative AI Connector."}),b=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.userYouTitle",{defaultMessage:"You"}),g=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.userAssistantTitle",{defaultMessage:"Assistant"}),v=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.timestampAtTitle",{defaultMessage:"at"}),y=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.skipTitle",{defaultMessage:"Click to skip..."}),h=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.complete",{defaultMessage:"Connector setup complete!"}),j=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.calloutTitle",{defaultMessage:"The current conversation is missing a connector configuration"}),E=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.conversationSettingsLink",{defaultMessage:"Conversation Settings"})},,function(e,t,n){"use strict";e.exports=n(611)},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(2),i=n(110);const s={managed:!0},r=()=>{const{services:{apm:e}}=Object(i.i)();return{startTransaction:Object(a.useCallback)((({name:t,type:n="user-interaction",options:a})=>e.startTransaction(t,n,null!=a?a:s)),[e])}},o=e=>`Timeline search ${e}`},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return m}));var a=n(4);const i="histogram-actions-trigger",s={[a.yc.hosts]:"host",[a.yc.users]:"user"},r=(e,t)=>{const n=s[e];return n&&t?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:`${n}.name`,params:{query:t}},query:{match_phrase:{[`${n}.name`]:t}}}]:[]},o=e=>{const t=s[e];return t&&e?[{query:{bool:{should:[{exists:{field:`${t}.name`}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:`{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "${t}.name"}}],"minimum_should_match": 1}}]}}}`}}]:[]},l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"source.ip",params:{query:e}},query:{bool:{should:[{match_phrase:{"source.ip":e}},{match_phrase:{"destination.ip":e}}],minimum_should_match:1}}}]:[],u=[{query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],c=e=>e.length>=1?[{meta:{type:"phrases",key:"_index",params:e,alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({match_phrase:{_index:e}}))),minimum_should_match:1}}}]:[],d=e=>(null!=e?e:[]).reduce(((e,t)=>{var n,a,i,s,r,o;return{requests:[...e.requests,JSON.stringify({body:null==t?void 0:t.json,index:(null!==(n=null==t||null===(a=t.stats)||void 0===a||null===(i=a.indexFilter)||void 0===i?void 0:i.value)&&void 0!==n?n:"").split(",")},null,2)],responses:[...e.responses,JSON.stringify(null!==(s=null==t||null===(r=t.response)||void 0===r||null===(o=r.json)||void 0===o?void 0:o.rawResponse)&&void 0!==s?s:{},null,2)]}}),{requests:[],responses:[]}),m=e=>e.reduce(((e,t)=>{try{return[...e,JSON.parse(t)]}catch(t){return e}}),[])},function(e,t,n){"use strict";n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return F})),n.d(t,"d",(function(){return L})),n.d(t,"e",(function(){return G})),n.d(t,"g",(function(){return J.b})),n.d(t,"f",(function(){return J.a}));var a=n(111),i=n(182),s=n(148),r=n(141);const o=a.z.literal("RULE_NOT_MODIFIED"),l=a.z.object({id:a.z.string(),name:a.z.string().optional(),skip_reason:o}),u=a.z.object({id:a.z.string(),name:a.z.string().optional()}),c=a.z.enum(["IMMUTABLE","MACHINE_LEARNING_AUTH","MACHINE_LEARNING_INDEX_PATTERN","ESQL_INDEX_PATTERN"]),d=(c.enum,a.z.object({message:a.z.string(),status_code:a.z.number().int(),err_code:c.optional(),rules:a.z.array(u)})),m=a.z.object({updated:a.z.array(s.e),created:a.z.array(s.e),deleted:a.z.array(s.e),skipped:a.z.array(l)}),p=a.z.object({failed:a.z.number().int(),skipped:a.z.number().int(),succeeded:a.z.number().int(),total:a.z.number().int()}),f=a.z.object({success:a.z.boolean().optional(),status_code:a.z.number().int().optional(),message:a.z.string().optional(),rules_count:a.z.number().int().optional(),attributes:a.z.object({results:m,summary:p,errors:a.z.array(d).optional()})}),b=a.z.string(),g=a.z.object({query:a.z.string().optional(),ids:a.z.array(a.z.string()).min(1).optional()}),v=g.merge(a.z.object({action:a.z.literal("delete")})),y=g.merge(a.z.object({action:a.z.literal("disable")})),h=g.merge(a.z.object({action:a.z.literal("enable")})),j=g.merge(a.z.object({action:a.z.literal("export")})),E=g.merge(a.z.object({action:a.z.literal("duplicate"),duplicate:a.z.object({include_exceptions:a.z.boolean(),include_expired_exceptions:a.z.boolean()}).optional()})),O=a.z.enum(["rule","1h","1d","7d"]),x=(O.enum,a.z.enum(["enable","disable","export","delete","duplicate","edit"]).enum),S=a.z.enum(["add_tags","delete_tags","set_tags","add_index_patterns","delete_index_patterns","set_index_patterns","set_timeline","add_rule_actions","set_rule_actions","set_schedule"]).enum,k=a.z.object({group:r.u,id:r.v,params:r.w,frequency:r.t.optional(),alerts_filter:r.s.optional()}).strict(),w=a.z.object({type:a.z.enum(["add_rule_actions","set_rule_actions"]),value:a.z.object({throttle:O.optional(),actions:a.z.array(k)})}),T=a.z.object({type:a.z.literal("set_schedule"),value:a.z.object({interval:a.z.string().regex(/^[1-9]\d*[smh]$/),lookback:a.z.string().regex(/^[1-9]\d*[smh]$/)})}),C=a.z.object({type:a.z.enum(["add_index_patterns","delete_index_patterns","set_index_patterns"]),value:r.f,overwrite_data_views:a.z.boolean().optional()}),M=a.z.object({type:a.z.enum(["add_tags","delete_tags","set_tags"]),value:r.O}),I=a.z.object({type:a.z.literal("set_timeline"),value:a.z.object({timeline_id:r.Y,timeline_title:r.Z})}),A=a.z.union([M,C,I,w,T]),P=g.merge(a.z.object({action:a.z.literal("edit"),edit:a.z.array(A).min(1)}));a.z.object({dry_run:i.b.optional()}),a.z.union([v,y,h,j,E,P]),a.z.union([f,b]);var _=n(299);a.z.array(a.z.union([s.e,_.a])),a.z.array(s.c),a.z.array(a.z.object({id:r.K.optional(),rule_id:r.N.optional()})),a.z.array(s.d),a.z.array(s.f);var D=n(46),R=n(120);let F;!function(e){e.Enabled="enabled",e.Disabled="disabled"}(F||(F={}));const N=Object(R.r)("CoverageOverviewRuleActivity",F);let L;!function(e){e.Prebuilt="prebuilt",e.Custom="custom"}(L||(L={}));const z=Object(R.r)("CoverageOverviewRuleSource",L),B=D.partial({search_term:R.j,activity:Object(R.i)(N),source:Object(R.i)(z)}),q=(D.exact(D.partial({filter:B})),D.type({name:D.string,activity:N}));D.exact(D.type({coverage:D.record(D.string,Object(R.i)(D.string)),unmapped_rule_ids:D.array(D.string),rules_data:D.record(D.string,q)})),s.c,s.e,a.z.object({id:r.K.optional(),rule_id:r.N.optional()}),s.e,s.d,s.e,a.z.object({id:r.K.optional(),rule_id:r.N.optional()}),s.e,s.f,s.e;var V=n(139);const $={exported_count:D.number,exported_rules_count:D.number,missing_rules:D.array(D.exact(D.type({rule_id:R.j}))),missing_rules_count:D.number},U=D.intersection([D.exact(D.type({id:R.j,type:R.j})),D.exact(D.partial({reason:D.string}))]),Q={exported_action_connector_count:D.number,missing_action_connection_count:D.number,missing_action_connections:D.array(D.exact(D.type({id:R.j,type:R.j}))),excluded_action_connection_count:D.number,excluded_action_connections:D.array(U)};D.intersection([D.exact(D.type($)),D.exact(D.partial(V.p)),D.exact(D.partial(Q))]),a.z.object({exclude_export_details:i.b.optional().default(!1),file_name:a.z.string().optional().default("export.ndjson")}),a.z.object({objects:a.z.array(a.z.object({rule_id:r.N}))}).nullable();var H=n(248);const G=a.z.enum(["created_at","createdAt","enabled","execution_summary.last_execution.date","execution_summary.last_execution.metrics.execution_gap_duration_s","execution_summary.last_execution.metrics.total_indexing_duration_ms","execution_summary.last_execution.metrics.total_search_duration_ms","execution_summary.last_execution.status","name","risk_score","riskScore","severity","updated_at","updatedAt"]);G.enum,a.z.object({fields:Object(i.a)(a.z.string()).optional(),filter:a.z.string().optional(),sort_field:G.optional(),sort_order:H.a.optional(),page:a.z.coerce.number().int().min(1).optional().default(1),per_page:a.z.coerce.number().int().min(0).optional().default(20)}),a.z.object({page:a.z.number().int(),perPage:a.z.number().int(),total:a.z.number().int(),data:a.z.array(s.e)}),D.exact(D.type({rules_summary:D.type({custom_count:R.m,prebuilt_installed_count:R.m}),aggregated_fields:D.type({tags:D.array(D.string)})}));var W=n(371);a.z.object({overwrite:i.b.optional().default(!1),overwrite_exceptions:i.b.optional().default(!1),overwrite_action_connectors:i.b.optional().default(!1),as_new_list:i.b.optional().default(!1)}),a.z.object({exceptions_success:a.z.boolean(),exceptions_success_count:a.z.number().int().min(0),exceptions_errors:a.z.array(_.a),rules_count:a.z.number().int().min(0),success:a.z.boolean(),success_count:a.z.number().int().min(0),errors:a.z.array(_.a),action_connectors_errors:a.z.array(_.a),action_connectors_warnings:a.z.array(W.a),action_connectors_success:a.z.boolean(),action_connectors_success_count:a.z.number().int().min(0)}).strict();var K=n(247);K.b.and(K.f).and(K.c.partial().extend({rule_id:K.d,immutable:a.literal(!1).default(!1)})),r.O;var J=n(410)},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return a.a})),n.d(t,"j",(function(){return a.b})),n.d(t,"c",(function(){return St})),n.d(t,"a",(function(){return Et})),n.d(t,"f",(function(){return Mt})),n.d(t,"g",(function(){return Pt})),n.d(t,"k",(function(){return wt})),n.d(t,"i",(function(){return E.a})),n.d(t,"b",(function(){return J})),n.d(t,"e",(function(){return re.c})),n.d(t,"h",(function(){return re.d}));var a=n(123),i=n(2),s=n.n(i),r=n(17),o=n(302),l=n.n(o),u=n(44),c=n.n(u),d=n(67),m=n(13),p=n(253),f=n(221),b=n(388),g=n(250),v=n(45),y=n(51);const h=({currentReplacements:e,rawValue:t})=>{if(null!=e){const n=Object(v.invert)(e)[t];return null!=n?n:Object(y.v4)()}return Object(y.v4)()};var j=n(374),E=n(222);var O=n(249),x={name:"a4hmbt",styles:"position:absolute"};const S=({isDisabled:e,isLoading:t,onChatCleared:n,onSendMessage:a})=>Object(m.jsx)(r.EuiFlexGroup,{css:x,direction:"column",gutterSize:"xs"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiToolTip,{position:"right",content:O.b},Object(m.jsx)(r.EuiButtonIcon,{"aria-label":O.b,color:"danger","data-test-subj":"clear-chat",display:"base",iconType:"cross",isDisabled:e,onClick:n}))),Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiToolTip,{position:"right",content:O.g},Object(m.jsx)(r.EuiButtonIcon,{"aria-label":O.g,"data-test-subj":"submit-chat",color:"primary",display:"base",iconType:"returnKey",isDisabled:e,isLoading:t,onClick:a}))));var k=n(5);const w=k.i18n.translate("xpack.elasticAssistant.assistant.promptPlaceholder",{defaultMessage:"Ask me anything from 'summarize this alert' to 'help me build a query...'"}),T=c()(r.EuiTextArea)`
  min-height: 125px;
  padding-right: 42px;
`,C=Object(i.forwardRef)((({isDisabled:e=!1,value:t,onPromptSubmit:n,handlePromptChange:a,...s},r)=>{const o=Object(i.useCallback)((e=>{a(e.target.value)}),[a]),l=Object(i.useCallback)((e=>{var i;"Enter"===e.key&&!e.shiftKey&&t.trim().length>0?(e.preventDefault(),n(null===(i=e.target.value)||void 0===i?void 0:i.trim()),a("")):"Enter"!==e.key||e.shiftKey||0!==t.trim().length||(e.preventDefault(),e.stopPropagation())}),[t,n,a]);return Object(i.useEffect)((()=>{a(t)}),[a,t]),Object(m.jsx)(T,{className:"eui-scrollBar",inputRef:r,id:"prompt-textarea","data-test-subj":"prompt-textarea",fullWidth:!0,autoFocus:!0,disabled:e,placeholder:w,value:t,onChange:o,onKeyDown:l})}));C.displayName="PromptTextArea";var M={name:"zyunh5",styles:"left:-34px;position:relative;top:11px"},I={name:"1d3w5wq",styles:"width:100%"};const A=({handleButtonSendMessage:e,handleOnChatCleared:t,handlePromptChange:n,handleSendMessage:a,isDisabled:s,isLoading:o,shouldRefocusPrompt:l,userPrompt:u})=>{const c=Object(i.useRef)(null);Object(i.useEffect)((()=>{l&&c.current&&(null==c||c.current.focus())}),[l]);const d=Object(i.useMemo)((()=>s?"":null!=u?u:""),[s,u]),p=Object(i.useCallback)((()=>{var t,n,a;e(null!==(t=null===(n=c.current)||void 0===n||null===(a=n.value)||void 0===a?void 0:a.trim())&&void 0!==t?t:"")}),[e,c]);return Object(m.jsx)(r.EuiFlexGroup,{gutterSize:"none",css:I},Object(m.jsx)(r.EuiFlexItem,null,Object(m.jsx)(C,{onPromptSubmit:a,ref:c,handlePromptChange:n,value:d,isDisabled:s})),Object(m.jsx)(r.EuiFlexItem,{css:M,grow:!1},Object(m.jsx)(S,{onChatCleared:t,isDisabled:s,isLoading:o,onSendMessage:p})))},P=k.i18n.translate("xpack.elasticAssistant.components.upgrade.upgradeTitle",{defaultMessage:"Manage license"}),_=k.i18n.translate("xpack.elasticAssistant.components.upgrade.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),D=({basePath:e})=>Object(m.jsx)(r.EuiFlexGroup,{gutterSize:"s",wrap:!0,"data-test-subj":"upgrade-buttons"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},_)),Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiButton,{href:`${e}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},P))),R=s.a.memo(D);R.displayName="UpgradeButtons";var F={name:"1d3w5wq",styles:"width:100%"},N={name:"1d3w5wq",styles:"width:100%"};const L=({connectorPrompt:e,http:t,isAssistantEnabled:n,isWelcomeSetup:a})=>{const i=t.basePath.get();return n?a?Object(m.jsx)(r.EuiFlexGroup,{css:F},Object(m.jsx)(r.EuiFlexItem,{"data-test-subj":"connector-prompt"},e)):null:Object(m.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround",css:N},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(R,{basePath:i})))};var z=n(47),B=n(179),q=n(496),V=n(220),$=n(177),U=n(252);const Q=Object(B.css)({name:"1azv1pg",styles:"height:32px;.euiSuperSelect{width:400px;}.euiSuperSelectControl{border:none;box-shadow:none;background:none;padding-left:0;}.euiFormControlLayoutIcons{right:14px;top:2px;}"}),H=Object(B.css)({name:"94g3yr",styles:"overflow:hidden;text-overflow:ellipsis;max-width:400px"}),G=Object(B.css)({name:"gexgj1",styles:"overflow:hidden;text-overflow:ellipsis;max-width:400px;font-weight:normal;padding-bottom:5px;padding-left:0;padding-top:2px"}),W=s.a.memo((({isDisabled:e=!1,selectedConnectorId:t,selectedConversation:n})=>{var s,o;const[l,u]=Object(i.useState)(!1),{actionTypeRegistry:c,assistantAvailability:d,http:p}=Object(a.b)(),{setApiConfig:b}=Object(f.a)(),{data:g}=Object(V.a)({http:p}),v=null!==(s=null===(o=Object(i.useMemo)((()=>g?g.map((e=>({...e,connectorTypeTitle:Object(U.a)(c.get(e.actionTypeId))}))):[]),[c,g]).find((e=>e.id===t)))||void 0===o?void 0:o.name)&&void 0!==s?s:$.m,y=e||!d.hasConnectorsReadPrivilege,h=Object(i.useCallback)((()=>{u(!l)}),[l]),j=Object(i.useCallback)((e=>{const t=e.id;if("ADD_NEW_CONNECTOR"===t)return;const a=Object(U.b)(e),i=null==a?void 0:a.apiProvider,s=null==a?void 0:a.defaultModel;u(!1),null!=n&&b({conversationId:n.id,apiConfig:{...n.apiConfig,connectorId:t,connectorTypeTitle:e.connectorTypeTitle,provider:null!=i?i:null==a?void 0:a.apiProvider,model:null!=s?s:null==a?void 0:a.defaultModel}})}),[n,b]);return Object(m.jsx)(r.EuiFlexGroup,{alignItems:"center",className:Q,direction:"row",gutterSize:"xs",justifyContent:"flexStart",responsive:!1},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiText,{size:"xs",color:"subdued"},$.l)),Object(m.jsx)(r.EuiFlexItem,null,l?Object(m.jsx)(q.a,{displayFancy:e=>Object(m.jsx)(r.EuiText,{className:H,size:"xs"},e),isOpen:!0,isDisabled:y,selectedConnectorId:t,setIsOpen:u,onConnectorSelectionChange:j}):Object(m.jsx)("span",null,Object(m.jsx)(r.EuiButtonEmpty,{className:G,color:"text","data-test-subj":"connectorSelectorPlaceholderButton",iconSide:"right",iconType:"arrowDown",isDisabled:y,onClick:h,size:"xs"},v))))}));W.displayName="ConnectorSelectorInline";const K={xl:64,l:48,m:32,s:24,xs:16},J=({size:e="s"})=>Object(m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:K[e],height:K[e],viewBox:"0 0 64 64",fill:"none"},Object(m.jsx)("path",{fill:"#F04E98",d:"M36 28h24v36H36V28Z"}),Object(m.jsx)("path",{fill:"#00BFB3",d:"M4 46c0-9.941 8.059-18 18-18h6v36h-6c-9.941 0-18-8.059-18-18Z"}),Object(m.jsx)("path",{fill:"#343741",d:"M60 12c0 6.627-5.373 12-12 12s-12-5.373-12-12S41.373 0 48 0s12 5.373 12 12Z"}),Object(m.jsx)("path",{fill:"#FA744E",d:"M6 23C6 10.85 15.85 1 28 1v22H6Z"}));var Y={name:"1y0ex1",styles:"max-width:400px"};const X=({isDisabled:e=!1,title:t,docLinks:n,selectedConversation:a})=>{var s;const o=null==a||null===(s=a.apiConfig)||void 0===s?void 0:s.connectorId,{ELASTIC_WEBSITE_URL:l,DOC_LINK_VERSION:u}=n,c=`${l}guide/en/security/${u}/security-assistant.html`,d=Object(i.useMemo)((()=>Object(m.jsx)(r.EuiLink,{"aria-label":O.h,"data-test-subj":"externalDocumentationLink",external:!0,href:c,target:"_blank"},O.d)),[c]),p=Object(i.useMemo)((()=>Object(m.jsx)(z.FormattedMessage,{defaultMessage:"Responses from AI systems may not always be entirely accurate. For more information on the assistant feature and its usage, please reference the {documentationLink}.",id:"xpack.elasticAssistant.assistant.technicalPreview.tooltipContent",values:{documentationLink:d}})),[d]),[f,b]=Object(i.useState)(!1),g=Object(i.useCallback)((()=>b((e=>!e))),[]),v=Object(i.useCallback)((()=>b(!1)),[]);return Object(m.jsx)(r.EuiModalHeaderTitle,null,Object(m.jsx)(r.EuiFlexGroup,{gutterSize:"m"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(J,{"data-test-subj":"titleIcon",size:"m"})),Object(m.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none",justifyContent:"center"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiTitle,{size:"s"},Object(m.jsx)("h3",null,t))),Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiPopover,{button:Object(m.jsx)(r.EuiButtonIcon,{"aria-label":O.h,"data-test-subj":"tooltipIcon",iconType:"iInCircle",onClick:g}),isOpen:f,closePopover:v,anchorPosition:"rightUp"},Object(m.jsx)(r.EuiText,{"data-test-subj":"tooltipContent",grow:!1,css:Y},Object(m.jsx)(r.EuiText,{size:"s"},Object(m.jsx)("p",null,p))))))),Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(W,{isDisabled:e||void 0===a,selectedConnectorId:o,selectedConversation:a})))))},Z=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.defaultConversationTitle",{defaultMessage:"Conversations"}),ee=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.ariaLabel",{defaultMessage:"Conversation selector"}),te=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.placeholderTitle",{defaultMessage:"Select or type to create new..."}),ne=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.CustomOptionTextTitle",{defaultMessage:"Create new conversation:"}),ae=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.previousConversationTitle",{defaultMessage:"Previous conversation"}),ie=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.nextConversationTitle",{defaultMessage:"Next conversation"}),se=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.deleteConversationTitle",{defaultMessage:"Delete conversation"});var re=n(168);const oe=navigator.platform.toLowerCase().indexOf("mac")>=0,le=(e,t)=>0===e.indexOf(t)?e[e.length-1]:e[e.indexOf(t)-1];var ue={name:"1v0pok0",styles:"min-width:300px"},ce={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},de={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},me={name:"1e5733u",styles:"width:calc(100% - 60px)"};const pe=s.a.memo((({selectedConversationId:e=re.a,defaultConnectorId:t,defaultProvider:n,onConversationSelected:s,shouldDisableKeyboardShortcut:o=(()=>!1),isDisabled:u=!1})=>{const{allSystemPrompts:c,conversations:d}=Object(a.b)(),{deleteConversation:p,setConversation:b}=Object(f.a)(),g=Object(i.useMemo)((()=>Object.keys(d)),[d]),v=Object(i.useMemo)((()=>Object.values(d).map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.id}}))),[d]),[y,h]=Object(i.useState)((()=>{var t;return null!==(t=v.filter((t=>t.label===e)))&&void 0!==t?t:[]})),j=Object(i.useCallback)(((e,a=[])=>{if(!e||!e.trim().toLowerCase())return;const i=e.trim().toLowerCase(),r=c.find((e=>e.isNewConversationDefault));if(-1===a.findIndex((e=>e.label.trim().toLowerCase()===i))){const a={id:e,messages:[],apiConfig:{connectorId:t,provider:n,defaultSystemPromptId:null==r?void 0:r.id}};b({conversation:a})}s(e)}),[c,t,n,b,s]),E=Object(i.useCallback)((t=>{e===t&&s(le(g,t)),setTimeout((()=>{p(t)}),0)}),[g,p,e,s]),O=Object(i.useCallback)((e=>{0===e.length?h([]):-1!==v.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&s(null==e?void 0:e[0].label)}),[v,s]),x=Object(i.useCallback)((()=>{const t=le(g,e);s(t)}),[g,e,s]),S=Object(i.useCallback)((()=>{const t=((e,t)=>e.indexOf(t)+1>=e.length?e[0]:e[e.indexOf(t)+1])(g,e);s(t)}),[g,e,s]),k=Object(i.useCallback)((e=>{u||g.length<=1||("ArrowLeft"===e.key&&(oe?e.metaKey:e.ctrlKey)&&!o()&&(e.preventDefault(),x()),"ArrowRight"===e.key&&(oe?e.metaKey:e.ctrlKey)&&!o()&&(e.preventDefault(),S()))}),[g.length,u,x,S,o]);return l()("keydown",k),Object(i.useEffect)((()=>{h(v.filter((t=>t.label===e)))}),[v,e]),Object(m.jsx)(r.EuiFormRow,{label:Z,display:"rowCompressed",css:ue},Object(m.jsx)(r.EuiComboBox,{"data-test-subj":"conversation-selector","aria-label":ee,customOptionText:`${ne} {searchValue}`,placeholder:te,singleSelection:{asPlainText:!0},options:v,selectedOptions:y,onChange:O,onCreateOption:j,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(m.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween","data-test-subj":`convo-option-${a}`},Object(m.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:me},Object(m.jsx)(r.EuiHighlight,{search:t,css:de},a)),!(null!=i&&i.isDefault)&&Object(m.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(m.jsx)(r.EuiToolTip,{position:"right",content:se},Object(m.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":se,color:"danger",onClick:e=>{e.stopPropagation(),E(a)},"data-test-subj":"delete-option",css:ce}))))},compressed:!0,isDisabled:u,prepend:Object(m.jsx)(r.EuiToolTip,{content:`${ae} (⌘ + ←)`,display:"block"},Object(m.jsx)(r.EuiButtonIcon,{iconType:"arrowLeft","aria-label":ae,onClick:x,disabled:u||g.length<=1})),append:Object(m.jsx)(r.EuiToolTip,{content:`${ie} (⌘ + →)`,display:"block"},Object(m.jsx)(r.EuiButtonIcon,{iconType:"arrowRight","aria-label":ie,onClick:S,disabled:u||g.length<=1}))}))}));pe.displayName="ConversationSelector";var fe=n(259),be=n(493);const ge=s.a.memo((({defaultConnectorId:e,defaultProvider:t,isDisabled:n=!1,isSettingsModalVisible:o,setIsSettingsModalVisible:l,selectedConversation:u,setSelectedConversationId:c})=>{const{toasts:d,setSelectedSettingsTab:p}=Object(a.b)(),f=Object(i.useCallback)((()=>{l(!1)}),[l]),b=Object(i.useCallback)((()=>{f()}),[f]),g=Object(i.useCallback)((()=>{f(),null==d||d.addSuccess({iconType:"check",title:be.j})}),[f,d]),v=Object(i.useCallback)((()=>{p(fe.b),l(!0)}),[l,p]);return Object(m.jsx)(s.a.Fragment,null,Object(m.jsx)(r.EuiToolTip,{position:"right",content:be.i},Object(m.jsx)(r.EuiButtonIcon,{"aria-label":be.h,"data-test-subj":"settings",onClick:v,isDisabled:n,iconType:"gear",size:"xs"})),o&&Object(m.jsx)(fe.a,{defaultConnectorId:e,defaultProvider:t,selectedConversation:u,setSelectedConversationId:c,onClose:b,onSave:g}))}));ge.displayName="AssistantSettingsButton";var ve={name:"1h6p4mk",styles:"width:335px"},ye={name:"1d3w5wq",styles:"width:100%"};const he=({currentConversation:e,defaultConnectorId:t,defaultProvider:n,docLinks:a,isDisabled:o,isSettingsModalVisible:l,onConversationSelected:u,onToggleShowAnonymizedValues:c,selectedConversationId:d,setIsSettingsModalVisible:p,setSelectedConversationId:f,shouldDisableKeyboardShortcut:b,showAnonymizedValues:g,title:v})=>{const y=Object(i.useMemo)((()=>null!=e.replacements&&Object.keys(e.replacements).length>0&&g),[e.replacements,g]);return Object(m.jsx)(s.a.Fragment,null,Object(m.jsx)(r.EuiFlexGroup,{css:ye,alignItems:"center",justifyContent:"spaceBetween"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(X,{isDisabled:o,docLinks:a,selectedConversation:e,title:v})),Object(m.jsx)(r.EuiFlexItem,{grow:!1,css:ve},Object(m.jsx)(pe,{defaultConnectorId:t,defaultProvider:n,selectedConversationId:d,onConversationSelected:u,shouldDisableKeyboardShortcut:b,isDisabled:o}),Object(m.jsx)(s.a.Fragment,null,Object(m.jsx)(r.EuiSpacer,{size:"s"}),Object(m.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiToolTip,{content:O.f,position:"left",repositionOnScroll:!0},Object(m.jsx)(r.EuiSwitch,{"data-test-subj":"showAnonymizedValues",checked:y,compressed:!0,disabled:null==e.replacements,label:O.e,onChange:c}))),Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(ge,{defaultConnectorId:t,defaultProvider:n,isDisabled:o,isSettingsModalVisible:l,selectedConversation:e,setIsSettingsModalVisible:p,setSelectedConversationId:f})))))),Object(m.jsx)(r.EuiHorizontalRule,{margin:"m"}))};async function je({defaultAllow:e,defaultAllowReplacement:t,promptContext:n}){const a=await n.getPromptContext();return"string"==typeof a?{allow:[],allowReplacement:[],promptContextId:n.id,rawData:a}:{allow:[...e],allowReplacement:[...t],promptContextId:n.id,rawData:a}}const Ee=c()(r.EuiButton)`
  margin-right: ${({theme:e})=>e.eui.euiSizeXS};
`,Oe=({defaultAllow:e,defaultAllowReplacement:t,promptContexts:n,selectedPromptContexts:a,setSelectedPromptContexts:s})=>{const o=Object(i.useMemo)((()=>Object(v.sortBy)("description",Object.values(n))),[n]),l=Object(i.useCallback)((async i=>{if(null==a[i]&&null!=n[i]){const a=await je({defaultAllow:e,defaultAllowReplacement:t,promptContext:n[i]});s((e=>({...e,[i]:a})))}}),[e,t,n,a,s]);return Object(m.jsx)(r.EuiFlexGroup,{gutterSize:"none",wrap:!0},o.map((({description:e,id:t,getPromptContext:n,tooltip:i})=>{const s=Object(m.jsx)(Ee,{"data-test-subj":`pillButton-${t}`,disabled:null!=a[t],iconSide:"left",iconType:"plus",onClick:()=>l(t)},e);return Object(m.jsx)(r.EuiFlexItem,{grow:!1,key:t},null!=a[t]?s:Object(m.jsx)(r.EuiToolTip,{content:i},s))})))},xe=s.a.memo(Oe);var Se=n(373),ke=n(551),we={name:"1m5oqbf",styles:"white-space:pre-line;&:hover{cursor:pointer;text-decoration:underline;}"};const Te=({conversation:e,editingSystemPromptId:t,isSettingsModalVisible:n,onSystemPromptSelectionChange:o,setIsSettingsModalVisible:l})=>{const{allSystemPrompts:u}=Object(a.b)(),c=Object(i.useMemo)((()=>{var n;return void 0!==t?null!==(n=null==u?void 0:u.find((e=>e.id===t)))&&void 0!==n?n:null==u?void 0:u.find((t=>t.id===(null==e?void 0:e.apiConfig.defaultSystemPromptId))):void 0}),[u,null==e?void 0:e.apiConfig.defaultSystemPromptId,t]),[d,p]=s.a.useState(!1),f=Object(i.useCallback)((()=>{e&&o(void 0)}),[e,o]),b=Object(i.useCallback)((()=>p(!0)),[]);return Object(m.jsx)("div",null,null==c||d?Object(m.jsx)(ke.a,{allSystemPrompts:u,clearSelectedSystemPrompt:f,conversation:e,"data-test-subj":"systemPrompt",isClearable:!0,isEditing:d,isOpen:d,isSettingsModalVisible:n,onSystemPromptSelectionChange:o,selectedPrompt:c,setIsEditing:p,setIsSettingsModalVisible:l}):Object(m.jsx)(r.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none"},Object(m.jsx)(r.EuiFlexItem,{grow:!0},Object(m.jsx)(r.EuiText,{color:"subdued","data-test-subj":"systemPromptText",onClick:b,css:we},Object(v.isEmpty)(null==c?void 0:c.content)?Se.d:null==c?void 0:c.content)),Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiFlexGroup,{gutterSize:"none"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiToolTip,{content:Se.e},Object(m.jsx)(r.EuiButtonIcon,{"aria-label":Se.e,"data-test-subj":"edit",iconType:"documentEdit",onClick:b}))),Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiToolTip,{content:Se.c},Object(m.jsx)(r.EuiButtonIcon,{"aria-label":Se.c,"data-test-subj":"clear",iconType:"cross",onClick:f})))))))};Te.displayName="SystemPromptComponent";const Ce=s.a.memo(Te),Me=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.commentsListAriaLabel",{defaultMessage:"List of comments"}),Ie=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.editingPromptLabel",{defaultMessage:"editing prompt"}),Ae=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.youLabel",{defaultMessage:"You"});var Pe=n(543),_e=n(494);const De=({rawData:e})=>Object(m.jsx)(r.EuiCodeBlock,{"data-test-subj":"readOnlyContextViewer",isCopyable:!0},Object(g.e)(e));De.displayName="ReadOnlyContextViewerComponent";const Re=s.a.memo(De);var Fe=n(552),Ne=n(547),Le=n(372);const ze=k.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableDescription",{defaultMessage:"Available"}),Be=({total:e})=>{const t=Object(i.useMemo)((()=>(e=>k.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableTooltip",{values:{total:e},defaultMessage:"{total} fields in this context are available to be included in the conversation"}))(e)),[e]);return Object(m.jsx)(r.EuiToolTip,{content:t},Object(m.jsx)(r.EuiStat,{"data-test-subj":"availableStat",description:ze,reverse:!0,title:e,titleSize:Le.a}))};Be.displayName="AvailableStatComponent";const qe=s.a.memo(Be),Ve=c()(r.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeL};
`,$e=({isDataAnonymizable:e,selectedPromptContext:t})=>{const{allowed:n,anonymized:a,total:s}=Object(i.useMemo)((()=>(({allow:e,allowReplacement:t,rawData:n})=>{const a={allowed:0,anonymized:0,denied:0,total:0};if("string"==typeof n)return a;{const i=Object.keys(n),s=new Set(t),r=new Set(e);return i.reduce(((e,t)=>({allowed:e.allowed+(Object(b.a)({allowSet:r,field:t})?1:0),anonymized:e.anonymized+(Object(b.a)({allowSet:r,field:t})&&Object(b.b)({allowReplacementSet:s,field:t})?1:0),denied:e.denied+(Object(b.c)({allowSet:r,field:t})?1:0),total:e.total+1})),a)}})(t)),[t]);return Object(m.jsx)(r.EuiFlexGroup,{alignItems:"center","data-test-subj":"stats",gutterSize:"none"},e&&Object(m.jsx)(Ve,{grow:!1},Object(m.jsx)(Fe.a,{allowed:n,total:s})),Object(m.jsx)(Ve,{grow:!1},Object(m.jsx)(Ne.a,{anonymized:a,isDataAnonymizable:e})),e&&Object(m.jsx)(Ve,{grow:!1},Object(m.jsx)(qe,{total:s})))};$e.displayName="StatsComponent";const Ue=s.a.memo($e),Qe=c.a.div`
  overflow-x: auto;
`,He=({selectedPromptContext:e,setSelectedPromptContexts:t})=>{const{defaultAllow:n,defaultAllowReplacement:s,setDefaultAllow:o,setDefaultAllowReplacement:l}=Object(a.b)(),u=Object(i.useMemo)((()=>Object(_e.a)(e.rawData)),[e]),c=Object(i.useCallback)((a=>{const i=a.reduce(((e,{field:t,operation:n,update:a})=>Object(_e.c)({field:t,operation:n,selectedPromptContext:e,update:a})),e);t((t=>({...t,[e.promptContextId]:i}))),Object(_e.b)({defaultAllow:n,defaultAllowReplacement:s,setDefaultAllow:o,setDefaultAllowReplacement:l,updates:a})}),[n,s,e,o,l,t]);return Object(m.jsx)(Qe,{"data-test-subj":"dataAnonymizationEditor"},Object(m.jsx)(Ue,{isDataAnonymizable:u,selectedPromptContext:e}),Object(m.jsx)(r.EuiSpacer,{size:"s"}),"string"==typeof e.rawData?Object(m.jsx)(Re,{rawData:e.rawData}):Object(m.jsx)(Pe.a,{allow:e.allow,allowReplacement:e.allowReplacement,onListUpdated:c,rawData:e.rawData}))},Ge=s.a.memo(He),We=k.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.selectedPromotContexts.removeContextTooltip",{defaultMessage:"Remove context"}),Ke=c.a.div`
  ${({$accordionState:e})=>"closed"===e?"height: 0px;":""}
  ${({$accordionState:e})=>"closed"===e?"overflow: hidden;":""}
  ${({$accordionState:e})=>"closed"===e?"position: absolute;":""}
`,Je=({isNewConversation:e,promptContexts:t,selectedPromptContexts:n,setSelectedPromptContexts:a})=>{const[o,l]=s.a.useState("closed"),u=Object(i.useCallback)((()=>l((e=>"open"===e?"closed":"open"))),[]),c=Object(i.useCallback)((e=>{a((t=>Object(v.omit)(e,t)))}),[a]);return Object(v.isEmpty)(t)?null:Object(m.jsx)(r.EuiFlexGroup,{"data-test-subj":"selectedPromptContexts",direction:"column",gutterSize:"none"},Object.keys(n).sort().map((i=>{var s;return Object(m.jsx)(r.EuiFlexItem,{"data-test-subj":`selectedPromptContext-${i}`,grow:!1,key:i},e||Object.keys(n).length>1?Object(m.jsx)(r.EuiSpacer,{"data-test-subj":"spacer"}):null,Object(m.jsx)(r.EuiAccordion,{buttonContent:null===(s=t[i])||void 0===s?void 0:s.description,forceState:o,extraAction:Object(m.jsx)(r.EuiToolTip,{content:We},Object(m.jsx)(r.EuiButtonIcon,{"aria-label":We,"data-test-subj":`removePromptContext-${i}`,iconType:"cross",onClick:()=>c(i)})),id:i,onToggle:u,paddingSize:"s"},Object(m.jsx)(Ke,{$accordionState:o},Object(m.jsx)(Ge,{selectedPromptContext:n[i],setSelectedPromptContexts:a}))))})))},Ye=s.a.memo(Je),Xe=c()(r.EuiText)`
  white-space: pre-line;
`,Ze=({conversation:e,editingSystemPromptId:t,isNewConversation:n,isSettingsModalVisible:a,promptContexts:o,promptTextPreview:l,onSystemPromptSelectionChange:u,selectedPromptContexts:c,setIsSettingsModalVisible:d,setSelectedPromptContexts:p})=>{const f=Object(i.useMemo)((()=>Object(m.jsx)(s.a.Fragment,null,n&&Object(m.jsx)(Ce,{conversation:e,editingSystemPromptId:t,onSystemPromptSelectionChange:u,isSettingsModalVisible:a,setIsSettingsModalVisible:d}),Object(m.jsx)(Ye,{isNewConversation:n,promptContexts:o,selectedPromptContexts:c,setSelectedPromptContexts:p}),Object(m.jsx)(Xe,{color:"subdued","data-test-subj":"previewText"},l))),[e,t,n,a,u,o,l,c,d,p]),b=Object(i.useMemo)((()=>[{children:f,event:Object(m.jsx)(r.EuiText,{"data-test-subj":"eventText",size:"xs"},Object(m.jsx)("i",null,Ie)),timelineAvatar:Object(m.jsx)(r.EuiAvatar,{"data-test-subj":"userAvatar",name:"user",size:"l",color:"subdued",iconType:"userAvatar"}),timelineAvatarAriaLabel:Ae,username:Ae}]),[f]);return Object(m.jsx)(r.EuiCommentList,{"aria-label":Me,comments:b})};Ze.displayName="PromptEditorComponent";const et=s.a.memo(Ze),tt=k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.addQuickPromptTitle",{defaultMessage:"Add quick prompt..."}),nt=k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.overflowAriaTitle",{defaultMessage:"Show overflow Quick Prompts"}),at=(k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"}),c()(r.EuiFlexGroup)`
  margin: 16px;
`),it=s.a.memo((({setInput:e,setIsSettingsModalVisible:t,trackPrompt:n})=>{const{allQuickPrompts:s,knowledgeBase:o,promptContexts:l,setSelectedSettingsTab:u}=Object(a.b)(),c=Object(i.useMemo)((()=>{const e=Object.values(l).map((e=>e.category));return o.assistantLangChain&&e.push("knowledge-base"),s.filter((t=>null==t.categories||0===t.categories.length||t.categories.some((t=>e.includes(t)))))}),[s,o.assistantLangChain,l]),[d,p]=Object(i.useState)(!1),f=Object(i.useCallback)((()=>p(!d)),[d]),b=Object(i.useCallback)((()=>p(!1)),[]),g=Object(i.useCallback)((t=>{e(t.prompt),t.isDefault?n(t.title):n("Custom")}),[e,n]),v=Object(i.useCallback)((e=>{g(e),b()}),[b,g]),y=Object(i.useCallback)((()=>{t(!0),u(fe.c)}),[t,u]);return Object(m.jsx)(at,{gutterSize:"s",alignItems:"center"},c.slice(0,5).map(((e,t)=>Object(m.jsx)(r.EuiFlexItem,{key:t,grow:!1},Object(m.jsx)(r.EuiBadge,{color:e.color,onClick:()=>g(e),onClickAriaLabel:e.title},e.title)))),c.length>5&&Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiPopover,{button:Object(m.jsx)(r.EuiBadge,{color:"hollow",iconType:"boxesHorizontal",onClick:f,onClickAriaLabel:nt}),isOpen:d,closePopover:b,anchorPosition:"rightUp"},Object(m.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"s"},c.slice(5).map(((e,t)=>Object(m.jsx)(r.EuiFlexItem,{key:t,grow:!1},Object(m.jsx)(r.EuiBadge,{color:e.color,onClick:()=>v(e),onClickAriaLabel:e.title},e.title))))))),Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiButtonEmpty,{"data-test-subj":"addQuickPrompt",onClick:y,iconType:"plus",size:"xs"},tt)))}));it.displayName="QuickPrompts";var st=n(548),rt=n(549),ot=n(497);const lt=s.a.memo((({text:e,children:t,chunkSize:n=5,delay:a=100,onStreamingComplete:s})=>{const[r,o]=Object(i.useState)(a>0?"":e),[l,u]=Object(i.useState)(null==a||0===a);return Object(i.useEffect)((()=>{0===a&&(null==s||s())}),[]),Object(i.useEffect)((()=>{if(l||0===a)return void o(e);let t=0;u(!1);const i=setInterval((()=>{if(t>=e.length)return null==s||s(),u(!0),void clearInterval(i);const a=e.substring(t,t+n);o((e=>e+a)),t+=n}),a);return()=>{clearInterval(i)}}),[e,n,a,s,l]),t?Object(m.jsx)("div",null,t(r,l)):Object(m.jsx)("div",null,r)}));lt.displayName="StreamingText";var ut=n(73);const ct=s.a.memo((({setIsConnectorModalVisible:e})=>{const{assistantAvailability:t}=Object(a.b)(),n=t.hasConnectorsAllPrivilege?$.d:$.c,s=t.hasConnectorsAllPrivilege?$.a:$.b,o=Object(i.useCallback)((()=>{null==e||e(!0)}),[e]);return Object(m.jsx)(r.EuiFlexGroup,{gutterSize:"l",justifyContent:"spaceAround"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiCard,{"data-test-subj":"connectorButton",layout:"horizontal",icon:Object(m.jsx)(r.EuiIcon,{size:"xl",type:ut.OpenAILogo}),title:n,description:s,onClick:t.hasConnectorsAllPrivilege?o:void 0})))}));ct.displayName="ConnectorButton";const dt=e=>{const{messages:t,...n}=e;return{...n,messages:t.map((e=>{const{presentation:t,...n}=e;return{...n,presentation:void 0}}))}},mt=e=>!e.messages.some((e=>void 0!==e.presentation)),pt=c.a.div`
  margin-bottom: 10px;
`,ft=c()(r.EuiText)`
  margin-top: 20px;
`,bt=s.a.memo((({isConnectorConfigured:e,isSettingsModalVisible:t,setIsSettingsModalVisible:n})=>{const{assistantAvailability:o,setSelectedSettingsTab:l}=Object(a.b)(),u=Object(i.useCallback)((()=>{t||(n(!0),l(fe.b))}),[t,n,l]),c=o.hasConnectorsAllPrivilege||o.hasConnectorsReadPrivilege&&e;return Object(m.jsx)(s.a.Fragment,null,c?Object(m.jsx)(r.EuiCallOut,{"data-test-subj":"connectorMissingCallout",color:"danger",iconType:"controlsVertical",size:"m",title:$.p},Object(m.jsx)("p",null," ",Object(m.jsx)(z.FormattedMessage,{defaultMessage:"Select a connector above or from the {link} to continue",id:"xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.calloutDescription",values:{link:Object(m.jsx)(r.EuiLink,{onClick:u},$.q)}}))):Object(m.jsx)(ct,null))}));bt.displayName="ConnectorMissingCallout";var gt={name:"hbng6e",styles:"align-items:flex-start;flex-direction:column"},vt={name:"hbng6e",styles:"align-items:flex-start;flex-direction:column"},yt={name:"r5hahk",styles:"margin-right:20px"},ht={name:"r5hahk",styles:"margin-right:20px"};const jt=({conversationId:e,embeddedLayout:t=!1,promptContextId:n="",shouldRefocusPrompt:o=!1,showTitle:l=!0,setConversationId:u})=>{var c,v;const{assistantTelemetry:y,augmentMessageCodeBlocks:O,assistantAvailability:{isAssistantEnabled:x},conversations:S,defaultAllow:k,defaultAllowReplacement:w,docLinks:T,getComments:C,http:M,promptContexts:I,setLastConversationId:P,getConversationId:_,title:D,allSystemPrompts:R}=Object(a.b)(),[F,N]=Object(i.useState)({}),z=Object(i.useMemo)((()=>Object.keys(F).length),[F]),{amendMessage:B,createConversation:q}=Object(f.a)(),{data:Q,isSuccess:H}=Object(V.a)({http:M}),G=Object(i.useMemo)((()=>{var e;return null===(e=Object(j.b)(Q))||void 0===e?void 0:e.id}),[Q]),W=Object(i.useMemo)((()=>{var e,t;return null===(e=Object(j.b)(Q))||void 0===e||null===(t=e.config)||void 0===t?void 0:t.apiProvider}),[Q]),[K,Y]=Object(i.useState)(x?_(e):re.d);Object(i.useEffect)((()=>{u&&u(K)}),[K,u]);const X=Object(i.useMemo)((()=>{var e;return null!==(e=S[K])&&void 0!==e?e:q({conversationId:K})}),[S,q,K]),Z=Object(i.useMemo)((()=>{var e;return!Object.keys(S).some((e=>null!=S[e].apiConfig.connectorId))&&0===(null!==(e=null==Q?void 0:Q.length)&&void 0!==e?e:0)}),[null==Q?void 0:Q.length,S]),ee=Z||!x,te=Object(i.useMemo)((()=>Object(j.a)(X,x)),[X,x]),[ne,ae]=Object(i.useState)(!1);Object(i.useEffect)((()=>{if(H&&(null==Q||!Q.length))return P(re.d);X.excludeFromLastConversationStorage||P(X.id)}),[H,null==Q?void 0:Q.length,X,P]);const{comments:ie,prompt:se}=(({conversation:e=rt.a,onSetupComplete:t})=>{var n,s,o,l;const{appendMessage:u,setApiConfig:c,setConversation:d}=Object(f.a)(),p=Object(i.useRef)(null),{actionTypeRegistry:b,conversations:g,http:v}=Object(a.b)(),{data:y,isSuccess:h,refetch:j}=Object(V.a)({http:v}),E=h&&!(null==y||!y.length),[O,x]=Object(i.useState)(!1),[S,k]=Object(i.useState)((()=>mt(e))),{data:w}=Object(ot.a)({http:v}),[T,C]=Object(i.useState)(null),M=Object(i.useMemo)((()=>{var t,n,a;return null!==(t=null===(n=e.theme)||void 0===n||null===(a=n.user)||void 0===a?void 0:a.name)&&void 0!==t?t:$.k}),[null===(n=e.theme)||void 0===n||null===(s=n.user)||void 0===s?void 0:s.name]),I=Object(i.useMemo)((()=>{var t,n,a;return null!==(t=null===(n=e.theme)||void 0===n||null===(a=n.assistant)||void 0===a?void 0:a.name)&&void 0!==t?t:$.j}),[null===(o=e.theme)||void 0===o||null===(l=o.assistant)||void 0===l?void 0:l.name]),A=Object(i.useMemo)((()=>e.messages.length-1),[e.messages.length]),[P,_]=Object(i.useState)(E||mt(e)?A:0),D=Object(i.useRef)(void 0),R=Object(i.useCallback)((()=>{var t,n,a;if(P!==A)return D.current=window.setTimeout((()=>{var e;return null===(e=p.current)||void 0===e||e.scrollIntoView({block:"end"}),_(P+1)}),null!==(t=null===(n=e.messages[P])||void 0===n||null===(a=n.presentation)||void 0===a?void 0:a.delay)&&void 0!==t?t:0),()=>clearTimeout(D.current);clearTimeout(D.current)}),[e.messages,P,A]),F=Object(i.useCallback)((()=>{var n;k(!0),null===(n=p.current)||void 0===n||n.scrollIntoView({block:"end"}),null==t||t(),d({conversation:dt(e)})}),[e,t,d]),N=Object(i.useCallback)((()=>{_(A)}),[A]),L=Object(i.useCallback)(((t,n,a)=>{var i,s,o;null!=e.messages[n].timestamp&&0!==e.messages[n].timestamp.length||(e.messages[n].timestamp=(new Date).toLocaleString());const l=n===a-1,u=null!==(i=null==t||null===(s=t.presentation)||void 0===s?void 0:s.stream)&&void 0!==i&&i&&P!==a-1;return Object(m.jsx)(lt,{text:null!==(o=t.content)&&void 0!==o?o:"",delay:u?50:0,onStreamingComplete:l?F:R},((e,t)=>Object(m.jsx)(r.EuiText,null,Object(m.jsx)(r.EuiMarkdownFormat,{className:`message-${n}`},e),Object(m.jsx)("span",{ref:p}))))}),[e.messages,P,F,R]),z=Object(i.useMemo)((()=>e.messages.slice(0,P+1).map(((t,n)=>({username:"user"===t.role?M:I,children:L(t,n,e.messages.length),timelineAvatar:Object(m.jsx)(r.EuiAvatar,{name:$.j,size:"l",color:"subdued",iconType:J}),timestamp:`${$.i}: ${t.timestamp}`})))),[I,L,e.messages,P,M]),B=Object(i.useCallback)((t=>{const n=Object(U.b)(t),a=Object(U.a)(b.get(t.actionTypeId));Object.values(g).forEach((e=>{c({conversationId:e.id,apiConfig:{...e.apiConfig,connectorId:t.id,connectorTypeTitle:a,provider:null==n?void 0:n.apiProvider,model:null==n?void 0:n.defaultModel}})})),null==j||j(),x(!1),u({conversationId:e.id,message:{role:"assistant",content:$.g,timestamp:(new Date).toLocaleString()}})}),[b,u,e.id,g,j,c]);return{comments:z,prompt:Object(m.jsx)("div",{"data-test-subj":"prompt"},S&&Object(m.jsx)(pt,null,Object(m.jsx)(ct,{setIsConnectorModalVisible:x})),!S&&Object(m.jsx)(ft,{color:"subdued",size:"xs"},Object(m.jsx)(r.EuiTextAlign,{textAlign:"center"},Object(m.jsx)(r.EuiBadge,{color:"hollow","data-test-subj":"skip-setup-button",onClick:N,onClickAriaLabel:$.h},$.h))),O&&Object(m.jsx)(st.a,{actionTypeRegistry:b,actionTypes:w,onClose:()=>x(!1),onSaveConnector:B,onSelectActionType:e=>C(e),selectedActionType:T}))}})({conversation:te}),oe=Z&&null!==(c=te.theme)&&void 0!==c&&c.title?null===(v=te.theme)||void 0===v?void 0:v.title:D,[le,ue]=Object(i.useState)(""),[ce,de]=Object(i.useState)(!1),[me,pe]=Object(i.useState)(null),[fe,be]=Object(i.useState)(!1),[ge,ve]=Object(i.useState)(!1),[ye,Ee]=Object(i.useState)(),[Oe,Se]=Object(i.useState)(!1);Object(i.useLayoutEffect)((()=>{setTimeout((()=>{Ee(O(X))}),0)}),[O,X]);const ke=Object(i.useMemo)((()=>ee||fe),[fe,ee]);Object(i.useEffect)((()=>{const e=()=>{const e=document.querySelectorAll(".euiCodeBlock__controls");Se(e.length>0)};e();const t=new MutationObserver(e);return t.observe(document.body,{subtree:!0,childList:!0}),()=>{t.disconnect()}}),[]);const we=Object(i.useRef)(null);Object(i.useEffect)((()=>{var e;const t=null===(e=we.current)||void 0===e?void 0:e.parentElement;t&&(t.scrollTop=t.scrollHeight)}));const Te=(e,t)=>t?Object(m.jsx)("span",{ref:we},e):Object(m.jsx)(s.a.Fragment,null,e),Ce=Object(i.useMemo)((()=>Object(E.b)({allSystemPrompts:R,conversation:X})),[R,X]),[Me,Ie]=Object(i.useState)(null==Ce?void 0:Ce.id),Ae=Object(i.useCallback)((e=>{var t;Y(e),Ie(null===(t=Object(E.b)({allSystemPrompts:R,conversation:S[e]}))||void 0===t?void 0:t.id)}),[R,S]),Pe=Object(i.useCallback)((e=>{Ie(e)}),[]);[...document.getElementsByClassName("euiCodeBlock")].forEach((e=>e.style.minHeight="75px"));const _e=Object(i.useCallback)((e=>{null!=ve&&ve(e.target.checked)}),[ve]);Object(i.useEffect)((()=>{if(X.messages.length||e!==K)return;if(ce)return;const t=I[n];null!=t&&(de(!0),Object.keys(F).includes(t.id)||(async()=>{const e=await je({defaultAllow:k,defaultAllowReplacement:w,promptContext:t});N((n=>({...n,[t.id]:e})))})(),null!=t.suggestedUserPrompt&&pe(t.suggestedUserPrompt))}),[X.messages,I,n,e,K,F,ce,k,w]),Object(i.useEffect)((()=>{var e;const t=null!==(e=null==Q?void 0:Q.some((e=>{var t;return e.id===(null===(t=X.apiConfig)||void 0===t?void 0:t.connectorId)})))&&void 0!==e&&e;be(!t)}),[Q,X]);const De=Object(i.useCallback)((()=>null==ye?void 0:ye.map(((e,t)=>Object(m.jsx)("span",{key:`${t}`},e.map(((e,n)=>{const a=e.getControlContainer,i=null==a?void 0:a();return Object(m.jsx)("span",{key:`${t}+${n}`},i?Object(d.createPortal)(e.button,i):Object(m.jsx)(s.a.Fragment,null))})))))),[ye]),{handleButtonSendMessage:Re,handleOnChatCleared:Fe,handlePromptChange:Ne,handleSendMessage:Le,handleRegenerateResponse:ze,isLoading:Be}=(({allSystemPrompts:e,currentConversation:t,editingSystemPromptId:n,http:s,selectedPromptContexts:r,setEditingSystemPromptId:o,setPromptTextPreview:l,setSelectedPromptContexts:u,setUserPrompt:c})=>{const{isLoading:d,sendMessages:m}=(()=>{const{alertsIndexPattern:e,assistantStreamingEnabled:t,defaultAllow:n,defaultAllowReplacement:s,knowledgeBase:r}=Object(a.b)(),[o,l]=Object(i.useState)(!1);return{isLoading:o,sendMessages:Object(i.useCallback)((async({apiConfig:a,http:i,messages:o,onNewReplacements:u,replacements:c})=>{l(!0);try{return await Object(p.b)({alerts:r.alerts,alertsIndexPattern:e,allow:n,allowReplacement:s,apiConfig:a,assistantLangChain:r.assistantLangChain,assistantStreamingEnabled:t,http:i,replacements:c,messages:o,size:r.latestAlerts,onNewReplacements:u})}finally{l(!1)}}),[e,t,n,s,r.alerts,r.assistantLangChain,r.latestAlerts])}})(),{appendMessage:v,appendReplacements:y,clearConversation:O,removeLastMessage:x}=Object(f.a)(),S=Object(i.useCallback)((async a=>{var i;const o=e=>y({conversationId:t.id,replacements:e}),c=e.find((e=>e.id===n)),d=await async function({currentReplacements:e,getAnonymizedValue:t=h,isNewChat:n,onNewReplacements:a,promptText:i,selectedPromptContexts:s,selectedSystemPrompt:r}){var o;const l=Object.keys(s).sort().map((n=>{const i=Object(b.d)({allow:s[n].allow,allowReplacement:s[n].allowReplacement,currentReplacements:e,getAnonymizedValue:t,onNewReplacements:a,rawData:s[n].rawData});return`${Object(g.e)(i)}`}));return{content:`${n?`${null!==(o=null==r?void 0:r.content)&&void 0!==o?o:""}\n\n`:""}${l}\n\n${i}`,role:"user",timestamp:(new Date).toLocaleString()}}({isNewChat:0===t.messages.length,currentReplacements:t.replacements,onNewReplacements:o,promptText:a,selectedPromptContexts:r,selectedSystemPrompt:c}),p=v({conversationId:t.id,message:d});u({}),l("");const f=await m({apiConfig:t.apiConfig,http:s,messages:p,onNewReplacements:o,replacements:null!==(i=t.replacements)&&void 0!==i?i:{}}),E=Object(j.d)(f);v({conversationId:t.id,message:E})}),[e,v,y,t.apiConfig,t.id,t.messages.length,t.replacements,n,s,r,m,l,u]),k=Object(i.useCallback)((async()=>{var e;const n=x(t.id),a=await m({apiConfig:t.apiConfig,http:s,messages:n,onNewReplacements:e=>y({conversationId:t.id,replacements:e}),replacements:null!==(e=t.replacements)&&void 0!==e?e:{}}),i=Object(j.d)(a);v({conversationId:t.id,message:i})}),[v,y,t.apiConfig,t.id,t.replacements,s,x,m]);return{handleButtonSendMessage:Object(i.useCallback)((e=>{S(e),c("")}),[S,c]),handleOnChatCleared:Object(i.useCallback)((()=>{var n;const a=null===(n=Object(E.b)({allSystemPrompts:e,conversation:t}))||void 0===n?void 0:n.id;l(""),c(""),u({}),O(t.id),o(a)}),[e,O,t,o,l,u,c]),handlePromptChange:e=>{l(e),c(e)},handleSendMessage:S,handleRegenerateResponse:k,isLoading:d}})({allSystemPrompts:R,currentConversation:X,setPromptTextPreview:ue,setUserPrompt:pe,editingSystemPromptId:Me,http:M,setEditingSystemPromptId:Ie,selectedPromptContexts:F,setSelectedPromptContexts:N}),qe=Object(i.useMemo)((()=>Object(m.jsx)(s.a.Fragment,null,Object(m.jsx)(r.EuiCommentList,{comments:C({currentConversation:X,showAnonymizedValues:ge,amendMessage:B,regenerateMessage:ze,isFetchingResponse:Be}),css:ht}),0!==X.messages.length&&z>0&&Object(m.jsx)(r.EuiSpacer,{size:"m"}),(0===X.messages.length||z>0)&&Object(m.jsx)(et,{conversation:X,editingSystemPromptId:Me,isNewConversation:0===X.messages.length,isSettingsModalVisible:ne,promptContexts:I,promptTextPreview:le,onSystemPromptSelectionChange:Pe,selectedPromptContexts:F,setIsSettingsModalVisible:ae,setSelectedPromptContexts:N}))),[B,X,Me,C,Pe,ze,Be,ne,I,le,F,z,ge]),Ve=Object(i.useMemo)((()=>ee?Object(m.jsx)(r.EuiCommentList,{comments:ie,css:yt}):qe),[ie,ee,qe]),$e=Object(i.useCallback)((e=>{null==y||y.reportAssistantQuickPrompt({conversationId:K,promptTitle:e})}),[y,K]);return Te(Object(m.jsx)(s.a.Fragment,null,Object(m.jsx)(r.EuiModalHeader,{css:vt},l&&Object(m.jsx)(he,{currentConversation:X,defaultConnectorId:G,defaultProvider:W,docLinks:T,isDisabled:ee,isSettingsModalVisible:ne,onConversationSelected:Ae,onToggleShowAnonymizedValues:_e,selectedConversationId:K,setIsSettingsModalVisible:ae,setSelectedConversationId:Y,showAnonymizedValues:ge,title:oe}),De(),!ee&&Object(m.jsx)(s.a.Fragment,null,Object(m.jsx)(xe,{defaultAllow:k,defaultAllowReplacement:w,promptContexts:I,selectedPromptContexts:F,setSelectedPromptContexts:N}),Object.keys(I).length>0&&Object(m.jsx)(r.EuiSpacer,{size:"s"}))),Object(m.jsx)(r.EuiModalBody,null,Te(Object(m.jsx)(s.a.Fragment,null,Ve,!ee&&fe&&H&&Object(m.jsx)(s.a.Fragment,null,Object(m.jsx)(r.EuiSpacer,null),Object(m.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(bt,{isConnectorConfigured:(null==Q?void 0:Q.length)>0,isSettingsModalVisible:ne,setIsSettingsModalVisible:ae}))))),!t)),Object(m.jsx)(r.EuiModalFooter,{css:gt},Object(m.jsx)(L,{connectorPrompt:se,http:M,isAssistantEnabled:x,isWelcomeSetup:Z}),Object(m.jsx)(A,{isDisabled:ke,shouldRefocusPrompt:o,userPrompt:me,handleButtonSendMessage:Re,handleOnChatCleared:Fe,handlePromptChange:Ne,handleSendMessage:Le,handleRegenerateResponse:ze,isLoading:Be}),!ee&&Object(m.jsx)(it,{setInput:pe,setIsSettingsModalVisible:ae,trackPrompt:$e}))),t)};jt.displayName="AssistantComponent";const Et=s.a.memo(jt),Ot=navigator.platform.toLowerCase().indexOf("mac")>=0,xt=c()(r.EuiModal)`
  ${({theme:e})=>`margin-top: ${e.eui.euiSizeXXL};`}
  min-width: 95vw;
  min-height: 25vh;
`,St=s.a.memo((()=>{const[e,t]=Object(i.useState)(!1),[n,r]=Object(i.useState)(re.d),[o,u]=Object(i.useState)(),{assistantTelemetry:c,setShowAssistantOverlay:d,getConversationId:p}=Object(a.b)(),f=Object(i.useCallback)((()=>({showOverlay:e,promptContextId:n,conversationId:a})=>{const i=p(a);e&&(null==c||c.reportAssistantInvoked({conversationId:i,invokedBy:"click"})),t(e),u(n),r(i)}),[c,p]);Object(i.useEffect)((()=>{d(f)}),[d,f]);const b=Object(i.useCallback)((()=>{e||(r(p()),null==c||c.reportAssistantInvoked({invokedBy:"shortcut",conversationId:p()})),t(!e)}),[c,e,p]),g=Object(i.useCallback)((e=>{";"===e.key&&(Ot?e.metaKey:e.ctrlKey)&&(e.preventDefault(),b())}),[b]);l()("keydown",g);const v=Object(i.useCallback)((()=>{t(!1),u(void 0),r(n)}),[n]),y=Object(i.useCallback)((()=>{v()}),[v]);return Object(m.jsx)(s.a.Fragment,null,e&&Object(m.jsx)(xt,{onClose:y,"data-test-subj":"ai-assistant-modal"},Object(m.jsx)(Et,{conversationId:n,promptContextId:o})))}));St.displayName="AssistantOverlay";var kt=n(492);const wt=(e,t,n,s,r,o,l)=>{const u=Object(i.useMemo)((()=>e),[e]),c=Object(i.useMemo)((()=>n),[n]),d=Object(i.useMemo)((()=>s),[s]),m=Object(i.useMemo)((()=>null!=r?r:Object(kt.a)()),[r]),p=Object(i.useMemo)((()=>null!=o?o:void 0),[o]),f=Object(i.useMemo)((()=>l),[l]),{registerPromptContext:b,showAssistantOverlay:g,unRegisterPromptContext:v}=Object(a.b)(),y=Object(i.useCallback)((e=>{null!=m&&g({showOverlay:e,promptContextId:m,conversationId:null!=t?t:void 0})}),[g,t,m]);return Object(i.useEffect)((()=>(v(m),b({category:u,description:c,getPromptContext:d,id:m,suggestedUserPrompt:p,tooltip:f}),()=>v(m))),[u,c,d,p,f,m,b,v]),{promptContextId:m,showAssistantOverlay:y}},Tt=k.i18n.translate("xpack.elasticAssistant.assistant.newChat.newChatButton",{defaultMessage:"Chat"}),Ct=({category:e,color:t="primary",children:n=Tt,conversationId:a,description:s,getPromptContext:o,iconType:l,promptContextId:u,suggestedUserPrompt:c,tooltip:d})=>{const{showAssistantOverlay:p}=wt(e,null!=a?a:null,s,o,null!=u?u:null,c,d),f=Object(i.useCallback)((()=>{p(!0)}),[p]),b=Object(i.useMemo)((()=>{if(null!==l)return null!=l?l:"discuss"}),[l]);return Object(i.useMemo)((()=>Object(m.jsx)(r.EuiButtonEmpty,{color:t,"data-test-subj":"newChat",onClick:f,iconType:b},n)),[n,b,f,t])};Ct.displayName="NewChatComponent";const Mt=s.a.memo(Ct),It=k.i18n.translate("xpack.elasticAssistant.assistant.newChatById.newChatByIdButton",{defaultMessage:"Chat"}),At=({children:e=It,conversationId:t,iconType:n,promptContextId:s,iconOnly:o=!1})=>{const{showAssistantOverlay:l}=Object(a.b)(),u=Object(i.useCallback)((()=>l({conversationId:t,promptContextId:s,showOverlay:!0})),[t,s,l]),c=Object(i.useMemo)((()=>{if(null!==n)return null!=n?n:"discuss"}),[n]);return Object(i.useMemo)((()=>o?Object(m.jsx)(r.EuiToolTip,{content:It},Object(m.jsx)(r.EuiButtonIcon,{"data-test-subj":"newChatById",iconType:null!=c?c:"discuss",onClick:u,color:"text","aria-label":It})):Object(m.jsx)(r.EuiButtonEmpty,{"data-test-subj":"newChatById",iconType:c,onClick:u,"aria-label":It},e)),[e,c,u,o])};At.displayName="NewChatByIdComponent";const Pt=s.a.memo(At);k.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.user.thenSummarizeSuggestedKqlAndEqlQueries",{defaultMessage:"Evaluate the event from the context above and format your output neatly in markdown syntax for my Elastic Security case."}),k.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.user.finallySuggestInvestigationGuideAndFormatAsMarkdown",{defaultMessage:"Add your description, recommended actions and bulleted triage steps. Use the MITRE ATT&CK data provided to add more context and recommendations from MITRE, and hyperlink to the relevant pages on MITRE's website. Be sure to include the user and host risk score data from the context. Your response should include steps that point to Elastic Security specific features, including endpoint response actions, the Elastic Agent OSQuery manager integration (with example osquery queries), timelines and entity analytics and link to all the relevant Elastic Security documentation."})},,,,function(e,t,n){"use strict";n.d(t,"l",(function(){return i})),n.d(t,"k",(function(){return s})),n.d(t,"m",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"n",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"o",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"q",(function(){return g})),n.d(t,"p",(function(){return v})),n.d(t,"g",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"a",(function(){return j}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.visualizationActions.moreActions",{defaultMessage:"More actions"}),s=a.i18n.translate("xpack.securitySolution.visualizationActions.inspect",{defaultMessage:"Inspect"}),r=a.i18n.translate("xpack.securitySolution.visualizationActions.openInLens",{defaultMessage:"Open in Lens"}),o=a.i18n.translate("xpack.securitySolution.visualizationActions.addToNewCase",{defaultMessage:"Add to new case"}),l=a.i18n.translate("xpack.securitySolution.visualizationActions.addToExistingCase",{defaultMessage:"Add to existing case"}),u=a.i18n.translate("xpack.securitySolution.visualizationActions.addToCaseSuccessContent",{defaultMessage:"Successfully added visualization to the case"}),c=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),d=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),m=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),p=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.successChartLabel",{defaultMessage:"Success"}),f=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),b=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.failureChartLabel",{defaultMessage:"Failure"}),g=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueCountLabel",{values:{field:e},defaultMessage:"Unique count of {field}"}),v=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.topValueLabel",{values:{field:e},defaultMessage:"Top values of {field}"}),y=a.i18n.translate("xpack.securitySolution.visualizationActions.countLabel",{defaultMessage:"Count of records"}),h=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.countOfFieldLabel",{values:{field:e},defaultMessage:"Count of {field}"}),j=a.i18n.translate("xpack.securitySolution.visualizationActions.addedToLibrary",{defaultMessage:"Added to library"})},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(45);const i=e=>Object(a.isString)(e)?e:JSON.stringify(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(749);const s=()=>Object(a.useContext)(i.a)},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return p}));var a=n(45),i=n(2),s=n.n(i),r=n(262),o=n(322);const l={canUserCRUD:null,canUserREAD:null,hasIndexManage:null,hasIndexMaintenance:null,hasIndexWrite:null,hasIndexRead:null,hasIndexUpdateDelete:null,isSignalIndexExists:null,isAuthenticated:null,hasEncryptionKey:null,loading:!0,signalIndexName:null,signalIndexMappingOutdated:null},u=(e,t)=>{switch(t.type){case"updateLoading":return{...e,loading:t.loading};case"updateHasIndexManage":return{...e,hasIndexManage:t.hasIndexManage};case"updateHasIndexMaintenance":return{...e,hasIndexMaintenance:t.hasIndexMaintenance};case"updateHasIndexWrite":return{...e,hasIndexWrite:t.hasIndexWrite};case"updateHasIndexRead":return{...e,hasIndexRead:t.hasIndexRead};case"updateHasIndexUpdateDelete":return{...e,hasIndexUpdateDelete:t.hasIndexUpdateDelete};case"updateIsSignalIndexExists":return{...e,isSignalIndexExists:t.isSignalIndexExists};case"updateIsAuthenticated":return{...e,isAuthenticated:t.isAuthenticated};case"updateHasEncryptionKey":return{...e,hasEncryptionKey:t.hasEncryptionKey};case"updateSignalIndexName":return{...e,signalIndexName:t.signalIndexName};case"updateSignalIndexMappingOutdated":return{...e,signalIndexMappingOutdated:t.signalIndexMappingOutdated};case"updateCanUserCRUD":return{...e,canUserCRUD:t.canUserCRUD};case"updateCanUserREAD":return{...e,canUserREAD:t.canUserREAD};default:return e}},c=Object(i.createContext)([l,()=>a.noop]),d=()=>Object(i.useContext)(c),m=({children:e})=>s.a.createElement(c.Provider,{value:Object(i.useReducer)(u,l)},e),p=()=>{const[{canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:a,hasIndexWrite:s,hasIndexRead:l,hasIndexUpdateDelete:u,isSignalIndexExists:c,isAuthenticated:m,hasEncryptionKey:p,loading:f,signalIndexName:b,signalIndexMappingOutdated:g},v]=d(),{loading:y,isAuthenticated:h,hasEncryptionKey:j,hasIndexManage:E,hasIndexMaintenance:O,hasIndexUpdateDelete:x,hasIndexWrite:S,hasIndexRead:k,hasKibanaCRUD:w,hasKibanaREAD:T}=Object(r.a)(),{loading:C,signalIndexExists:M,signalIndexName:I,signalIndexMappingOutdated:A,createDeSignalIndex:P}=Object(o.a)();return Object(i.useEffect)((()=>{f||e===w||v({type:"updateCanUserCRUD",canUserCRUD:w})}),[v,f,e,w]),Object(i.useEffect)((()=>{f||t===T||v({type:"updateCanUserREAD",canUserREAD:T})}),[v,f,t,T]),Object(i.useEffect)((()=>{f!==(y||C)&&v({type:"updateLoading",loading:y||C})}),[v,f,y,C]),Object(i.useEffect)((()=>{f||n===E||null==E||v({type:"updateHasIndexManage",hasIndexManage:E})}),[v,f,n,E]),Object(i.useEffect)((()=>{f||s===S||null==S||v({type:"updateHasIndexWrite",hasIndexWrite:S})}),[v,f,s,S]),Object(i.useEffect)((()=>{f||l===k||null==k||v({type:"updateHasIndexRead",hasIndexRead:k})}),[v,f,l,k]),Object(i.useEffect)((()=>{f||u===x||null==x||v({type:"updateHasIndexUpdateDelete",hasIndexUpdateDelete:x})}),[v,f,u,x]),Object(i.useEffect)((()=>{f||a===O||null==O||v({type:"updateHasIndexMaintenance",hasIndexMaintenance:O})}),[v,f,a,O]),Object(i.useEffect)((()=>{f||c===M||null==M||v({type:"updateIsSignalIndexExists",isSignalIndexExists:M})}),[v,f,c,M]),Object(i.useEffect)((()=>{f||m===h||null==h||v({type:"updateIsAuthenticated",isAuthenticated:h})}),[v,f,m,h]),Object(i.useEffect)((()=>{f||p===j||null==j||v({type:"updateHasEncryptionKey",hasEncryptionKey:j})}),[v,f,p,j]),Object(i.useEffect)((()=>{f||b===I||null==I||v({type:"updateSignalIndexName",signalIndexName:I})}),[v,f,b,I]),Object(i.useEffect)((()=>{f||g===A||null==A||v({type:"updateSignalIndexMappingOutdated",signalIndexMappingOutdated:A})}),[v,f,g,A]),Object(i.useEffect)((()=>{m&&p&&n&&(null!=c&&!c||null!=g&&g)&&null!=P&&P()}),[P,m,p,c,n,g]),{loading:f,isSignalIndexExists:c,isAuthenticated:m,hasEncryptionKey:p,canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:a,hasIndexWrite:s,hasIndexRead:l,hasIndexUpdateDelete:u,signalIndexName:b,signalIndexMappingOutdated:g}}},,function(e,t,n){"use strict";n.d(t,"C",(function(){return i})),n.d(t,"q",(function(){return s})),n.d(t,"v",(function(){return r})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return l})),n.d(t,"p",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"n",(function(){return d})),n.d(t,"B",(function(){return m})),n.d(t,"r",(function(){return p})),n.d(t,"u",(function(){return f})),n.d(t,"y",(function(){return b})),n.d(t,"k",(function(){return g})),n.d(t,"E",(function(){return v})),n.d(t,"w",(function(){return y})),n.d(t,"b",(function(){return h})),n.d(t,"x",(function(){return j})),n.d(t,"z",(function(){return E})),n.d(t,"t",(function(){return O})),n.d(t,"s",(function(){return x})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return k})),n.d(t,"F",(function(){return w})),n.d(t,"g",(function(){return T})),n.d(t,"A",(function(){return C})),n.d(t,"D",(function(){return M})),n.d(t,"e",(function(){return I})),n.d(t,"d",(function(){return A})),n.d(t,"f",(function(){return P})),n.d(t,"i",(function(){return _})),n.d(t,"h",(function(){return D})),n.d(t,"j",(function(){return R}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.alertDetails.threatIntel",{defaultMessage:"Threat Intel"}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview.investigationGuide",{defaultMessage:"Investigation guide"}),r=a.i18n.translate("xpack.securitySolution.alertDetails.overview",{defaultMessage:"Overview"}),o=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields",{defaultMessage:"Highlighted fields"}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.field",{defaultMessage:"Field"}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.value",{defaultMessage:"Value"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalence",{defaultMessage:"Alert prevalence"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalenceTooltip",{defaultMessage:"The total count of alerts with the same value within the currently selected timerange. This value is not affected by additional filters."}),m=a.i18n.translate("xpack.securitySolution.eventDetails.table",{defaultMessage:"Table"}),p=a.i18n.translate("xpack.securitySolution.eventDetails.jsonView",{defaultMessage:"JSON"}),f=a.i18n.translate("xpack.securitySolution.eventDetails.osqueryView",{defaultMessage:"Osquery Results"}),b=a.i18n.translate("xpack.securitySolution.eventDetails.responseActionsView",{defaultMessage:"Response Results"}),g=a.i18n.translate("xpack.securitySolution.eventDetails.field",{defaultMessage:"Field"}),v=a.i18n.translate("xpack.securitySolution.eventDetails.value",{defaultMessage:"Value"}),y=(a.i18n.translate("xpack.securitySolution.eventDetails.description",{defaultMessage:"Description"}),a.i18n.translate("xpack.securitySolution.eventDetails.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."})),h=a.i18n.translate("xpack.securitySolution.detections.alerts.agentStatus",{defaultMessage:"Agent status"}),j=a.i18n.translate("xpack.securitySolution.detections.alerts.quarantinedFilePath",{defaultMessage:"Quarantined file path"}),E=a.i18n.translate("xpack.securitySolution.detections.alerts.ruleType",{defaultMessage:"Rule type"}),O=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldTooltipContent",{defaultMessage:"Multi-fields can have multiple values per field"}),x=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldBadge",{defaultMessage:"multi-field"}),S=a.i18n.translate("xpack.securitySolution.eventDetails.table.actions",{defaultMessage:"Actions"}),k=a.i18n.translate("xpack.securitySolution.eventDetails.alertReason",{defaultMessage:"Alert reason"}),w=a.i18n.translate("xpack.securitySolution.eventDetails.viewAllFields",{defaultMessage:"View all fields in table"}),T=Object.freeze({tried:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.tried",{values:{command:e},defaultMessage:"tried to execute {command} command"}),executed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.executed",{values:{command:e},defaultMessage:"executed {command} command"}),pending:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.pending",{values:{command:e},defaultMessage:"is executing {command} command"}),failed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.failed",{values:{command:e},defaultMessage:"failed to execute {command} command"})}),C=a.i18n.translate("xpack.securitySolution.eventDetails.summaryView",{defaultMessage:"summary"}),M=a.i18n.translate("xpack.securitySolution.eventDetails.timelineView",{defaultMessage:"Timeline"}),I=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewConversationId",{defaultMessage:"Alert summary"}),A=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextDescription",{defaultMessage:"Alert (from {view})",values:{view:e}}),P=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextTooltip",{defaultMessage:"Add this alert as context"}),_=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewConversationId",{defaultMessage:"Event summary"}),D=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextDescription",{defaultMessage:"Event (from {view})",values:{view:e}}),R=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextTooltip",{defaultMessage:"Add this event as context"})},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return M}));var a=n(144),i=n(157),s=n(48),r=n(2),o=n(119),l=n(110),u=n(128),c=n(138),d=n(45),m=n(130),p=n(335),f=n(360);var b=n(235),g=n.n(b),v=n(203),y=n(202);var h=n(60),j=n(151),E=n(162),O=n(118),x=n(112),S=n(49);const k=({search:e,urlKey:t})=>Object(v.c)(Object(v.d)(e),t);var w=n(124),T=n(4);const C=()=>{Object(i.c)(),(()=>{const e=Object(s.useDispatch)(),{filterManager:t,savedQueries:n}=Object(l.i)().services.data.query,a=Object(r.useMemo)((()=>u.d.globalFiltersQuerySelector()),[]),d=Object(s.useSelector)(a),m=Object(r.useCallback)((t=>{null!=t&&e(c.b.setFilterQuery({id:o.a.global,query:t.query,language:t.language}))}),[e]),p=Object(r.useCallback)((n=>{null!=n?(t.setFilters(n),e(c.b.setSearchBarFilter({id:o.a.global,filters:n}))):(t.setAppFilters(d),e(c.b.setSearchBarFilter({id:o.a.global,filters:t.getFilters()})))}),[t,e,d]),f=Object(r.useCallback)((a=>{null!=a&&""!==a&&n.getSavedQuery(a).then((n=>{const a=n.attributes.filters||[],i=n.attributes.query;t.setFilters(a),e(c.b.setSearchBarFilter({id:o.a.global,filters:a})),e(c.b.setFilterQuery({id:o.a.global,...i})),e(c.b.setSavedQuery({id:o.a.global,savedQuery:n}))}))}),[e,t,n]);Object(i.b)(M.appQuery,m),Object(i.b)(M.filters,p),Object(i.b)(M.savedQuery,f)})(),(()=>{const e=Object(s.useDispatch)(),t=Object(m.a)("socTrendsEnabled"),n=Object(r.useCallback)((n=>((e,t,n)=>{if(null!=e){const a={linkTo:Object(d.get)("global.linkTo",e)},i=Object(d.get)("global.timerange.kind",e),s={linkTo:Object(d.get)("timeline.linkTo",e)},r=Object(d.get)("timeline.timerange.kind",e),l={linkTo:Object(d.get)("socTrends.linkTo",e)},u=Object(d.get)("socTrends.timerange.kind",e);if(n&&(Object(d.isEmpty)(l.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.socTrends])):t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(d.isEmpty)(a.linkTo)?(t(c.b.removeLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.removeLinkTo([o.a.global,o.a.socTrends]))):(t(c.b.addLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(d.isEmpty)(s.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.timeline])):t(c.b.addLinkTo([o.a.global,o.a.timeline])),r){if("absolute"===r){const n=Object(p.a)(Object(d.get)("timeline.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.timeline}))}if("relative"===r){const n=Object(p.a)(Object(d.get)("timeline.timerange",e));n.from=Object(f.c)(n.fromStr),n.to=Object(f.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.timeline}))}}if(i){if("absolute"===i){const n=Object(p.a)(Object(d.get)("global.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.global}))}if("relative"===i){const n=Object(p.a)(Object(d.get)("global.timerange",e));n.from=Object(f.c)(n.fromStr),n.to=Object(f.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.global}))}}if(n&&u){if("absolute"===u){const n=Object(p.a)(Object(d.get)("socTrends.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.socTrends}))}if("relative"===u){const n=Object(p.a)(Object(d.get)("socTrends.timerange",e));n.from=Object(f.c)(n.fromStr),n.to=Object(f.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.socTrends}))}}}})(n,e,t)),[e,t]);Object(i.b)(M.timerange,n)})(),(()=>{const[{pageName:e}]=Object(y.a)(),t=Object(s.useDispatch)(),n=g()(e),a=Object(r.useMemo)((()=>u.d.inputsSelector()),[]),i=Object(s.useSelector)(a),{timerange:l}=i.global,{timerange:d}=i.timeline;Object(r.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(v.e)(e))(e,n)&&("relative"===d.kind&&t(c.b.setRelativeRangeDatePicker({...d,from:Object(f.c)(d.fromStr),to:Object(f.c)(d.toStr,{roundUp:!0}),id:o.a.timeline})),"relative"===l.kind&&t(c.b.setRelativeRangeDatePicker({...l,from:Object(f.c)(l.fromStr),to:Object(f.c)(l.toStr,{roundUp:!0}),id:o.a.global})))}),[e,n,t,d,l])})(),(()=>{const e=Object(s.useDispatch)(),t=Object(m.a)("timelineEsqlTabDisabled"),n=Object(r.useCallback)((n=>{null!=n&&Object(E.h)({activeTimelineTab:n.activeTab===j.g.esql&&t?j.g.query:n.activeTab,duplicate:!1,graphEventId:n.graphEventId,timelineId:n.id,openTimeline:n.isOpen,updateIsLoading:t=>e(O.a.updateIsLoading(t)),updateTimeline:Object(E.b)(e),savedSearchId:n.savedSearchId})}),[e,t]);Object(r.useEffect)((()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get(M.timeline);if(!e)return;const t=Object(h.safeDecode)(e);n(t)};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[n]),Object(i.b)(M.timeline,n)})(),(()=>{const e=Object(i.d)(M.timeline),t=Object(r.useMemo)((()=>O.b.getTimelineByIdSelector()),[]),{activeTab:n,graphEventId:a,show:s,savedObjectId:o,savedSearchId:l}=Object(x.b)((e=>{var n;return null!==(n=t(e,j.f.active))&&void 0!==n?n:{}}));Object(r.useEffect)((()=>{const t={...o?{id:o}:{},isOpen:s,activeTab:n,graphEventId:null!=a?a:"",savedSearchId:l||void 0};e(t)}),[n,a,o,s,e,l])})(),(()=>{var e;const t=Object(r.useMemo)((()=>O.b.getTimelineByIdSelector()),[]),n=Object(x.b)((e=>t(e,j.f.active))),{search:a}=Object(S.useLocation)(),i=g()(a),o=null!==(e=null==n?void 0:n.savedObjectId)&&void 0!==e?e:"",l=Object(s.useDispatch)(),[u,c]=Object(r.useMemo)((()=>{const e=k({urlKey:M.timeline,search:null!=i?i:""}),t=k({urlKey:M.timeline,search:a});return null!=e&&null!=t?[Object(h.safeDecode)(e),Object(h.safeDecode)(t)]:[null,null]}),[i,a]),d=null==u?void 0:u.id,{id:m,activeTab:p,graphEventId:f}=c||{};Object(r.useEffect)((()=>{m&&m!==d&&m!==o&&Object(E.h)({activeTimelineTab:null!=p?p:j.g.query,duplicate:!1,graphEventId:f,timelineId:m,openTimeline:!0,updateIsLoading:e=>l(O.a.updateIsLoading(e)),updateTimeline:Object(E.b)(l)})}),[o,l,d,m,p,f])})(),(()=>{const[e]=Object(l.o)(T.nb),[t,n]=Object(r.useState)(null),[a,o]=Object(r.useState)(!1),u=Object(s.useDispatch)(),c=w.j.getTableByIdSelector(),d=Object(x.b)((e=>{var t;return null!==(t=c(e,w.e.alertsOnAlertsPage))&&void 0!==t?t:w.q})),m=Object(r.useCallback)((t=>{!e&&null!=t&&t.panelView&&n(t)}),[e]),p=Object(r.useCallback)((()=>{const{initialized:n,isLoading:a,totalCount:i,additionalFilters:s}=d,r=n&&!a&&i>0;!e&&t&&(s&&s.showBuildingBlockAlerts||u(w.h.updateShowBuildingBlockAlertsFilter({id:w.e.alertsOnAlertsPage,showBuildingBlockAlerts:!0})),r&&(o(!0),u(w.h.toggleDetailPanel({id:w.e.alertsOnAlertsPage,...t}))))}),[d,u,e,t]);Object(r.useEffect)((()=>{a||p()}),[a,p]);const f=e?"":M.eventFlyout;Object(i.b)(f,m)})(),(()=>{const e=Object(i.d)(M.eventFlyout),{pathname:t}=Object(S.useLocation)(),n=Object(s.useDispatch)(),a=w.j.getTableByIdSelector(),{expandedDetail:o}=Object(x.b)((e=>{var t;return null!==(t=a(e,w.e.alertsOnAlertsPage))&&void 0!==t?t:w.q}));Object(r.useEffect)((()=>{var a;const i=t===T.d;i&&null!=o&&null!=o&&o.query?e(o.query.panelView?o.query:null):!i&&null!=o&&null!==(a=o.query)&&void 0!==a&&a.panelView&&(n(w.h.toggleDetailPanel({id:w.e.alertsOnAlertsPage})),e(null))}),[n,o,t,e])})()},M={appQuery:"query",eventFlyout:a.a,filters:"filters",savedQuery:"savedQuery",sourcerer:"sourcerer",timeline:"timeline",timerange:"timerange",pageFilter:"pageFilters",rulesTable:"rulesTable"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return r}));var a=n(111);const i=a.z.enum(["going to run","running","partial failure","failed","succeeded"]),s=i.enum,r=a.z.number().int()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(50),i=n(76),s=n(177);const r=["elastic-assistant, load-connectors"],o=({http:e,toasts:t})=>Object(a.useQuery)(r,(async()=>(await Object(i.loadAllActions)({http:e})).filter((e=>!e.isMissingSecrets&&[".bedrock",".gen-ai"].includes(e.actionTypeId)))),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.o}))}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(123),s=n(168),r=n(222);const o={id:s.a,messages:[],apiConfig:{},theme:{title:s.c,titleIcon:"logoSecurity",assistant:{name:s.b,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}}},l=()=>{const{allSystemPrompts:e,assistantTelemetry:t,setConversations:n}=Object(i.b)(),s=Object(a.useCallback)((e=>{let t=[];return n((n=>{const a=n[e];if(null!=a){t=a.messages.slice(0,a.messages.length-1);const i={...a,messages:t};return{...n,[e]:i}}return n})),t}),[n]);return{amendMessage:Object(a.useCallback)((({conversationId:e,content:t})=>{n((n=>{const a=n[e];if(null!=a){const{messages:i,...s}=a,r=i[i.length-1],o={...s,messages:r?[...i.slice(0,-1),{...r,content:t}]:[...i]};return{...n,[e]:o}}return n}))}),[n]),appendMessage:Object(a.useCallback)((({conversationId:e,message:a})=>{null==t||t.reportAssistantMessageSent({conversationId:e,role:a.role});let i=[];return n((t=>{const n=t[e];if(null!=n){i=[...n.messages,a];const s={...n,messages:i};return{...t,[e]:s}}return t})),i}),[t,n]),appendReplacements:Object(a.useCallback)((({conversationId:e,replacements:t})=>{let a=t;return n((n=>{const i=n[e];if(null!=i){a={...i.replacements,...t};const s={...i,replacements:a};return{...n,[e]:s}}return n})),a}),[n]),clearConversation:Object(a.useCallback)((t=>{n((n=>{var a;const i=n[t],s=null===(a=Object(r.b)({allSystemPrompts:e,conversation:i}))||void 0===a?void 0:a.id;if(null!=i){const e={...i,apiConfig:{...i.apiConfig,defaultSystemPromptId:s},messages:[],replacements:void 0};return{...n,[t]:e}}return n}))}),[e,n]),createConversation:Object(a.useCallback)((({conversationId:t,messages:a})=>{var i;const s=null===(i=Object(r.b)({allSystemPrompts:e,conversation:void 0}))||void 0===i?void 0:i.id,l={...o,apiConfig:{...o.apiConfig,defaultSystemPromptId:s},id:t,messages:null!=a?a:[]};return n((e=>{if(null!=e[t])throw new Error("Conversation already exists!");return{...e,[t]:{...l}}})),l}),[e,n]),deleteConversation:Object(a.useCallback)((e=>{let t;return n((n=>{const{[e]:a,...i}=n;return t=a,null!=a?i:n})),t}),[n]),removeLastMessage:s,setApiConfig:Object(a.useCallback)((({conversationId:e,apiConfig:t})=>{n((n=>{const a=n[e];if(null!=a){const i={...a,apiConfig:t};return{...n,[e]:i}}return n}))}),[n]),setConversation:Object(a.useCallback)((({conversation:e})=>{n((t=>({...t,[e.id]:e})))}),[n])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));const a=e=>{const t=[...e.matchAll(/```(\w+)?\s([\s\S]*?)```/g)],n={eql:["Event Query Language","EQL sequence query","EQL"],esql:["Elasticsearch Query Language","ESQL","ES|QL","SQL"],kql:["Kibana Query Language","KQL Query","KQL"],dsl:["Elasticsearch QueryDSL","Elasticsearch Query DSL","Elasticsearch DSL","Query DSL","DSL"]};return t.map((t=>{let a=t[1]||"no-type";if("no-type"===a||"json"===a){const i=t.index||0,s=e.slice(0,i);for(const[e,t]of Object.entries(n))if(t.some((e=>s.toLowerCase().includes(e.toLowerCase())))){a=e;break}}const i=t[2].trim(),s=t.index||0;return{type:a,content:i,start:s,end:s+t[0].length}}))},i=({allSystemPrompts:e,conversation:t})=>{var n;const a=e.find((e=>{var n;return e.id===(null==t||null===(n=t.apiConfig)||void 0===n?void 0:n.defaultSystemPromptId)})),i=e.find((e=>e.isNewConversationDefault));return null!==(n=null!=a?a:i)&&void 0!==n?n:null==e?void 0:e[0]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e){return(e+1)%1e6};t.default=function(){return a.useReducer(i,0)[1]}},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u}));var a=n(4);const i={ENABLE:`${a.l} singleRuleActions enable`,DISABLE:`${a.l} singleRuleActions disable`,DUPLICATE:`${a.l} singleRuleActions duplicate`,EXPORT:`${a.l} singleRuleActions export`,DELETE:`${a.l} singleRuleActions delete`,PREVIEW:`${a.l} singleRuleActions preview`,SAVE:`${a.l} singleRuleActions save`},s={ENABLE:`${a.l} bulkRuleActions enable`,DISABLE:`${a.l} bulkRuleActions disable`,DUPLICATE:`${a.l} bulkRuleActions duplicate`,EXPORT:`${a.l} bulkRuleActions export`,DELETE:`${a.l} bulkRuleActions delete`,EDIT:`${a.l} bulkRuleActions edit`},r={REFRESH:`${a.l} rulesTable refresh`,FILTER:`${a.l} rulesTable filter`,LOAD_PREBUILT:`${a.l} rulesTable loadPrebuilt`},o={SAVE:`${a.l} timeline save`,DUPLICATE:`${a.l} timeline duplicate`,DELETE:`${a.l} timeline delete`,BULK_DELETE:`${a.l} timeline bulkDelete`},l={OPEN_ANALYZER:`${a.l} alerts openAnalyzer`,OPEN_SESSION_VIEW:`${a.l} alerts openSessionView`,INVESTIGATE_IN_TIMELINE:`${a.l} alerts investigateInTimeline`},u={FIELD_SAVED:`${a.l} fieldBrowser fieldSaved`,FIELD_DELETED:`${a.l} fieldBrowser fieldDeleted`}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return O}));var a=n(23),i=n.n(a),s=n(2),r=n.n(s),o=n(48),l=n(17),u=n(119),c=n(196),d=n(118),m=n(189),p=n(122),f=n(113),b=n(112),g=n(138),v=n(149),y=n(116),h=n(167),j=n(460);const E=({timelineId:e,timelineType:t,onClick:n})=>{const a=Object(o.useDispatch)(),i=Object(s.useMemo)((()=>v.d.defaultDataViewSelector()),[]),{id:r,patternList:l}=Object(b.a)(i),{timelineFullScreen:f,setTimelineFullScreen:E}=Object(m.c)(),O=Object(b.a)(g.d.globalTimeRangeSelector),{resetDiscoverAppState:x}=Object(j.a)(),S=Object(s.useCallback)((({id:e,show:n,timeRange:i})=>{const s=null!=i?i:O;e===p.c.active&&f&&E(!1),a(v.a.setSelectedDataView({id:y.SourcererScopeName.timeline,selectedDataViewId:r,selectedPatterns:l})),a(d.a.createTimeline({columns:c.b,dataViewId:r,id:e,indexNames:l,show:n,timelineType:t,updated:void 0})),a(g.b.addLinkTo([u.a.global,u.a.timeline])),a(h.a.addNotes({notes:[]})),i&&a(g.b.removeLinkTo([u.a.timeline,u.a.global])),"absolute"===s.kind?a(g.b.setAbsoluteRangeDatePicker({...s,id:u.a.timeline})):"relative"===s.kind&&a(g.b.setRelativeRangeDatePicker({...s,id:u.a.timeline}))}),[a,O,r,l,E,f,t]);return Object(s.useCallback)((a=>{S({id:e,show:!0,timelineType:t,timeRange:null==a?void 0:a.timeRange}),"function"==typeof n&&n(),x()}),[S,e,t,n,x])},O=({timelineId:e,timelineType:t,onClick:n})=>{const a=E({timelineId:e,timelineType:t,onClick:n});return{getButton:Object(s.useCallback)((({outline:e,title:n,iconType:s="plusInCircle",fill:o=!0})=>{const u={iconType:s,onClick:()=>a(),fill:o},c=t===f.l.template?"template-timeline-new":"timeline-new",{fill:d,...m}=u;return e?r.a.createElement(l.EuiButton,i()({"data-test-subj":`${c}-with-border`},u),n):r.a.createElement(l.EuiButtonEmpty,i()({"data-test-subj":c,color:"text"},m),n)}),[a,t])}}},,function(e,t,n){"use strict";let a,i;n.r(t),n.d(t,"HostsType",(function(){return a})),n.d(t,"HostsTableType",(function(){return i})),function(e){e.page="page",e.details="details"}(a||(a={})),function(e){e.authentications="authentications",e.hosts="allHosts",e.events="events",e.uncommonProcesses="uncommonProcesses",e.anomalies="anomalies",e.risk="hostRisk",e.sessions="sessions"}(i||(i={}))},,function(e,t,n){"use strict";n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u}));const a=["started","opened"],i=["starting","stopping","opening","closing"],s=["deleted","failed"],r=(e,t)=>a.includes(e)&&a.includes(t),o=(e,t)=>i.includes(e)||i.includes(t),l=(e,t)=>s.includes(e)||s.includes(t),u=e=>"machine_learning"===e},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(17),i=n(5),s=n(47),r=n(2),o=n.n(r);const l=({count:e})=>{const[t,n,l]=Object(r.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const n=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),a={compactThousands:i.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},s=new Map([[1,""],[1e3,a.compactThousands],[1e6,a.compactMillions],[1e9,a.compactBillions],[1e12,a.compactTrillions]]),r=i.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),o=null!==(t=s.get(n))&&void 0!==t?t:"";return[Math.floor(e/n),o,e/n%1>Number.EPSILON?r:""]}(e||0)),[e]);return null==e?null:0===e?o.a.createElement(o.a.Fragment,null,0):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:o.a.createElement(a.EuiI18nNumber,{value:t}),scale:n,hasRemainder:l}})},u=o.a.memo(l)},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var a=n(45),i=n(234),s=n.n(i),r=n(2),o=n(110),l=n(555),u=n(334),c=n(117);const d=e=>Object(a.keyBy)("name",function(e){const t=[];for(const n of Object.values(e))n.fields&&t.push(...Object.values(n.fields));return t}(e)),m=s()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(a.pick)(["name","searchable","type","aggregatable","esTypes","subType","conflictDescriptions"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),p={},f={fields:[],title:""},b=(e,t=!1,n="indexFields")=>{const{data:i}=Object(o.i)().services,s=Object(r.useRef)(new AbortController),d=Object(r.useRef)([]),[b,g]=Object(r.useState)({browserFields:p,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),{addError:v}=Object(c.a)(),y=Object(r.useCallback)((t=>{(async()=>{try{g({...b,loading:!0}),s.current=new AbortController;const e=await i.dataViews.create({title:t.join(","),allowNoIndex:!0}),n=e.toSpec(),{browserFields:a}=Object(u.a)(t,n.fields);d.current=e.getIndexPattern().split(","),g({loading:!1,dataView:n,browserFields:a,indexes:e.getIndexPattern().split(","),indexExists:e.getIndexPattern().split(",").length>0,indexPatterns:m(e.getIndexPattern(),e.fields)})}catch(t){g({browserFields:p,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),v(null==t?void 0:t.message,{title:l.a})}})()}),[v,i.dataViews,e,b]);return Object(r.useEffect)((()=>(Object(a.isEmpty)(e)||Object(a.isEqual)(d.current,e)||y(e),()=>{s.current.abort()})),[e,d]),[b.loading,b]}},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"j",(function(){return s})),n.d(t,"l",(function(){return r})),n.d(t,"k",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return b}));var a=n(5);a.i18n.translate("xpack.securitySolution.timeline.properties.timelineDescription",{defaultMessage:"Timeline Description"});const i=a.i18n.translate("xpack.securitySolution.timeline.properties.addToFavoriteButtonLabel",{defaultMessage:"Add to favorites"}),s=a.i18n.translate("xpack.securitySolution.timeline.properties.removeFromFavoritesButtonLabel",{defaultMessage:"Remove from favorites"}),r=a.i18n.translate("xpack.securitySolution.timeline.properties.untitledTimelinePlaceholder",{defaultMessage:"Untitled timeline"}),o=a.i18n.translate("xpack.securitySolution.timeline.properties.untitledTemplatePlaceholder",{defaultMessage:"Untitled template"}),l=a.i18n.translate("xpack.securitySolution.timeline.properties.descriptionPlaceholder",{defaultMessage:"Add a description"}),u=a.i18n.translate("xpack.securitySolution.timeline.properties.notesButtonLabel",{defaultMessage:"Notes"}),c=a.i18n.translate("xpack.securitySolution.timeline.properties.newTimelineButtonLabel",{defaultMessage:"Create new Timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.properties.newTemplateTimelineButtonLabel",{defaultMessage:"Create new Timeline template"}),m=a.i18n.translate("xpack.securitySolution.timeline.properties.addTimelineButtonLabel",{defaultMessage:"Add new timeline or template"}),p=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToCaseButtonLabel",{defaultMessage:"Attach to case"}),f=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToNewCaseButtonLabel",{defaultMessage:"Attach to new case"}),b=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToExistingCaseButtonLabel",{defaultMessage:"Attach to existing case"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return y}));var a=n(23),i=n.n(a),s=n(2),r=n.n(s),o=n(49);const l={services:{}},u=Object(s.createContext)(l);var c=n(664),d=n.n(c),m=n(13);const p=({children:e,component:t,render:n,...a})=>{const l=Object(s.useMemo)((()=>{if(t)return e=>Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(f,null),Object(m.jsx)(t,e))}),[t]);if(l)return Object(m.jsx)(o.Route,i()({},a,{component:l}));if(n||"function"==typeof e){const t="function"==typeof e?e:n;return Object(m.jsx)(o.Route,i()({},a,{render:e=>Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(f,null),t(e))}))}return Object(m.jsx)(o.Route,a,Object(m.jsx)(f,null),e)},f=()=>{const{executionContext:e}=Object(s.useContext)(u).services,t=Object(o.useRouteMatch)();return function(e,t){d()((()=>(null==e||e.set(t),()=>{null==e||e.clear()})),[t])}(e,{type:"application",page:t.path,id:Object.keys(t.params).length>0?JSON.stringify(t.params):void 0}),null};var b=n(91);const g=({children:e,...t})=>Object(m.jsx)(o.Router,t,Object(m.jsx)(b.CompatRouter,null,e));var v=n(9);const y=({legacySwitch:e=!0,children:t})=>{const n=Object(o.useRouteMatch)();return e?Object(m.jsx)(o.Switch,null,t):Object(m.jsx)(b.Routes,null,s.Children.map(t,(e=>{if(r.a.isValidElement(e)&&e.type===p){var a;const i=Object(v.replace)(null==e?void 0:e.props.path,n.url+"/",""),s="function"==typeof(null==e?void 0:e.props.children)?null==e?void 0:e.props.children:null==e?void 0:e.props.render;return Object(m.jsx)(b.Route,{path:i,element:Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(f,null),(null==e||null===(a=e.props)||void 0===a?void 0:a.component)&&Object(m.jsx)(e.props.component,null)||s&&s()||t)})}return e})))}},function(e,t,n){"use strict";var a=n(141);n.d(t,"d",(function(){return a.N}));var i=n(148);n.d(t,"b",(function(){return i.a})),n.d(t,"c",(function(){return i.b})),n.d(t,"e",(function(){return i.g})),n.d(t,"f",(function(){return i.h})),n(365),n(368),n(369);var s=n(323);n.d(t,"a",(function(){return s.b})),n(367),n(366)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(111).z.enum(["asc","desc"]);a.enum},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return d}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.clearChat",{defaultMessage:"Clear chat"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.defaultAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedToggleLabel",{defaultMessage:"Show anonymized"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedTooltip",{defaultMessage:"Show the anonymized values sent to and from the assistant"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.submitMessage",{defaultMessage:"Submit message"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.apiErrorTitle",{defaultMessage:"An error occurred sending your message."}),c=a.i18n.translate("xpack.elasticAssistant.documentationLinks.ariaLabel",{defaultMessage:"Click to open Elastic Assistant documentation in a new tab"}),d=a.i18n.translate("xpack.elasticAssistant.documentationLinks.documentation",{defaultMessage:"documentation"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return m}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.youAreAHelpfulExpertAssistant",{defaultMessage:"You are a helpful, expert assistant who answers questions about Elastic Security."}),s=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.useTheFollowingContextToAnswer",{defaultMessage:"Use the following context to answer questions:"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.ifYouDontKnowTheAnswer",{defaultMessage:"Do not answer questions unrelated to Elastic Security."}),o=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroPersonality",{defaultMessage:"Provide the most detailed and relevant answer possible, as if you were relaying this information back to a cyber security expert."}),l=`${i} ${r}\n${s}`,u=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.defaultSystemPromptName",{defaultMessage:"Default system prompt"}),c=`${i} ${r}\n${o}\n${s}`,d=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroSystemPromptName",{defaultMessage:"Enhanced system prompt"}),m=e=>`CONTEXT:\n"""\n${e}\n"""`},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={SYSTEM_PROMPT_SELECTOR:"systemPromptSelector",CONVERSATIONS_MULTISELECTOR:"conversationMultiSelector",ADD_SYSTEM_PROMPT:"addSystemPrompt",PROMPT_SUPERSELECT:"promptSuperSelect",CONVERSATIONS_MULTISELECTOR_OPTION:e=>`conversationMultiSelectorOption-${e}`,SETTINGS_MODAL:"settingsModal",SYSTEM_PROMPT_MODAL:{ID:"systemPromptModal",PROMPT_TEXT:"systemPromptModalPromptText",TOGGLE_ALL_DEFAULT_CONVERSATIONS:"systemPromptModalToggleDefaultConversations",SAVE:"systemPromptModalSave",CANCEL:"systemPromptModalCancel"}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a=e=>{if(null==e||!e.isPreconfigured)return null==e?void 0:e.config},i=e=>{var t;return null!==(t=e.actionTypeTitle)&&void 0!==t?t:e.id}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return d}));var a=n(73),i=n(249),s=n(498),r=n(374);const o=async({alerts:e,alertsIndexPattern:t,allow:n,allowReplacement:o,assistantLangChain:l,assistantStreamingEnabled:u,http:c,messages:d,onNewReplacements:m,replacements:p,apiConfig:f,signal:b,size:g})=>{var v;const y=d.map((e=>({role:e.role,content:e.content}))),h=(null==f?void 0:f.provider)===a.OpenAiProviderType.OpenAi?{model:null!==(v=f.model)&&void 0!==v?v:s.a,messages:y,n:1,stop:null,temperature:.2}:{messages:y},j=u&&!l,E=Object(r.e)({alerts:e,alertsIndexPattern:t,allow:n,allowReplacement:o,replacements:p,size:g}),O=j?{params:{subActionParams:h,subAction:"invokeStream"},assistantLangChain:l,...E}:{params:{subActionParams:h,subAction:"invokeAI"},assistantLangChain:l,...E};try{var x,S,k,w,T;if(j){var C,M;const e=await c.fetch(`/internal/elastic_assistant/actions/connector/${null==f?void 0:f.connectorId}/_execute`,{method:"POST",body:JSON.stringify(O),signal:b,asResponse:j,rawResponse:j}),t=null==e||null===(C=e.response)||void 0===C||null===(M=C.body)||void 0===M?void 0:M.getReader();return t?{response:t,isStream:!0,isError:!1}:{response:`${i.a}\n\nCould not get reader from response`,isError:!0,isStream:!1}}const t=await c.fetch(`/internal/elastic_assistant/actions/connector/${null==f?void 0:f.connectorId}/_execute`,{method:"POST",body:JSON.stringify(O),headers:{"Content-Type":"application/json"},signal:b});if("ok"!==t.status||!t.data)return t.service_message?{response:`${i.a}\n\n${t.service_message}`,isError:!0,isStream:!1}:{response:i.a,isError:!0,isStream:!1};const n=null!=(null===(x=t.trace_data)||void 0===x?void 0:x.trace_id)&&null!=(null===(S=t.trace_data)||void 0===S?void 0:S.transaction_id)?{traceId:null===(k=t.trace_data)||void 0===k?void 0:k.trace_id,transactionId:null===(w=t.trace_data)||void 0===w?void 0:w.transaction_id}:void 0;return m(null!==(T=t.replacements)&&void 0!==T?T:{}),{response:Object(r.f)({alerts:e,assistantLangChain:l})?Object(r.c)(t.data):t.data,isError:!1,isStream:!1,traceData:n}}catch(e){var I,A;const t=null==e||null===(I=e.response)||void 0===I||null===(A=I.body)||void 0===A?void 0:A.getReader,n=j&&"function"==typeof t?t.call(e.response.body):null;var P,_;return n?{response:n,isStream:!0,isError:!0}:{response:`${i.a}\n\n${null!==(P=null==e||null===(_=e.body)||void 0===_?void 0:_.message)&&void 0!==P?P:null==e?void 0:e.message}`,isError:!0,isStream:!1}}},l=async({http:e,resource:t,signal:n})=>{try{const a=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(a,{method:"GET",signal:n})}catch(e){return e}},u=async({http:e,resource:t,signal:n})=>{try{const a=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(a,{method:"POST",signal:n})}catch(e){return e}},c=async({http:e,resource:t,signal:n})=>{try{const a=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(a,{method:"DELETE",signal:n})}catch(e){return e}},d=async({http:e,evalParams:t,signal:n})=>{try{var a,i,s,r,o,l;const u="/internal/elastic_assistant/evaluate",c={agents:null==t||null===(a=t.agents.sort())||void 0===a?void 0:a.join(","),datasetName:null==t?void 0:t.datasetName,evaluationType:null==t||null===(i=t.evaluationType.sort())||void 0===i?void 0:i.join(","),evalModel:null==t||null===(s=t.evalModel.sort())||void 0===s?void 0:s.join(","),outputIndex:null==t?void 0:t.outputIndex,models:null==t||null===(r=t.models.sort())||void 0===r?void 0:r.join(","),projectName:null==t?void 0:t.projectName,runName:null==t?void 0:t.runName};return await e.fetch(u,{method:"POST",body:JSON.stringify({dataset:JSON.parse(null!==(o=null==t?void 0:t.dataset)&&void 0!==o?o:"[]"),evalPrompt:null!==(l=null==t?void 0:t.evalPrompt)&&void 0!==l?l:""}),headers:{"Content-Type":"application/json"},query:c,signal:n})}catch(e){return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(300);t.default=function(e,t){var n=i.useFirstMountState();a.useEffect((function(){if(!n)return e()}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){void 0===e&&(e={});var t=a.useState(e),n=t[0],i=t[1];return[n,a.useCallback((function(e){i((function(t){return Object.assign({},t,e instanceof Function?e(t):e)}))}),[i])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect(e,[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(303));t.default=function(e){var t=i.useRef(0),n=i.useState(e),a=n[0],r=n[1],o=i.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){r(e)}))}),[]);return s.default((function(){cancelAnimationFrame(t.current)})),[a,o]}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return on})),n.d(t,"c",(function(){return ln})),n.d(t,"d",(function(){return un})),n.d(t,"a",(function(){return En}));var a=n(2),i=n.n(a),s=n(17),r=n(44),o=n.n(r),l=n(13),u=n(493),c=n(123),d=n(251),m=n(543),p=n(494),f=n(552),b=n(547),g=n(5);g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph1",{defaultMessage:"The fields below are allowed by default"}),g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph2",{defaultMessage:"Optionally enable anonymization for these fields"}),g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutTitle",{defaultMessage:"Anonymization defaults"});const v=g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsTitle",{defaultMessage:"Anonymization"}),y=g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsDescription",{defaultMessage:"When adding Prompt Context throughout the Security App that may contain sensitive information, you can choose which fields are sent, and whether to enable anonymization for these fields. This will replace the field's value with a random string before sending the conversation. Helpful defaults are provided below."}),h=o()(s.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeL};
`,j=({defaultAllow:e,defaultAllowReplacement:t,pageSize:n,setUpdatedDefaultAllow:r,setUpdatedDefaultAllowReplacement:o})=>{const{baseAllow:u,baseAllowReplacement:d}=Object(c.b)(),g=Object(a.useCallback)((n=>{Object(p.b)({defaultAllow:e,defaultAllowReplacement:t,setDefaultAllow:r,setDefaultAllowReplacement:o,updates:n})}),[e,t,r,o]),j=Object(a.useCallback)((()=>{r(u),o(d)}),[u,d,r,o]),E=Object(a.useMemo)((()=>{const n=new Set(e);return t.reduce(((e,t)=>n.has(t)?e+1:e),0)}),[e,t]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,v)),Object(l.jsx)(s.EuiSpacer,{size:"xs"}),Object(l.jsx)(s.EuiText,{size:"xs"},y),Object(l.jsx)(s.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(s.EuiFlexGroup,{alignItems:"center","data-test-subj":"summary",gutterSize:"none"},Object(l.jsx)(h,{grow:!1},Object(l.jsx)(f.a,{allowed:e.length,total:e.length})),Object(l.jsx)(h,{grow:!1},Object(l.jsx)(b.a,{anonymized:E,isDataAnonymizable:!0}))),Object(l.jsx)(s.EuiSpacer,{size:"s"}),Object(l.jsx)(m.a,{allow:e,allowReplacement:t,onListUpdated:g,onReset:j,rawData:null,pageSize:n}))};j.displayName="AnonymizationSettingsComponent";const E=i.a.memo(j);var O=n(47),x=n(73),S=n(45);const k=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsTitle",{defaultMessage:"Conversations"}),w=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsDescription",{defaultMessage:"Create and manage conversations with the Elastic AI Assistant."}),T=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.connectorTitle",{defaultMessage:"Connector"}),C=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptTitle",{defaultMessage:"System Prompt"}),M=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptHelpTextTitle",{defaultMessage:"Context provided as part of every conversation"});var I=n(495),A=n(496),P=n(551),_=n(498);const D=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.defaultConversationTitle",{defaultMessage:"Conversations"}),R=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.ariaLabel",{defaultMessage:"Conversation selector"}),F=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.placeholderTitle",{defaultMessage:"Select or type to create new..."}),N=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.CustomOptionTextTitle",{defaultMessage:"Create new conversation:"}),L=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.previousConversationTitle",{defaultMessage:"Previous conversation"}),z=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.nextConversationTitle",{defaultMessage:"Next conversation"}),B=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.deleteConversationTitle",{defaultMessage:"Delete conversation"});var q={name:"1v0pok0",styles:"min-width:300px"},V={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},$={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},U={name:"1e5733u",styles:"width:calc(100% - 60px)"};const Q=i.a.memo((({conversations:e,onConversationDeleted:t,onConversationSelectionChange:n,selectedConversationId:i})=>{const r=Object(a.useMemo)((()=>Object.keys(e)),[e]),[o,u]=Object(a.useState)((()=>Object.values(e).map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.id,"data-test-subj":e.id}})))),c=Object(a.useMemo)((()=>{var e;return i&&null!==(e=o.filter((e=>e.label===i)))&&void 0!==e?e:[]}),[o,i]),d=Object(a.useCallback)((t=>{var a,i;const s=0===t.length?void 0:null!==(a=Object.values(e).find((e=>{var n;return e.id===(null===(n=t[0])||void 0===n?void 0:n.label)})))&&void 0!==a?a:null===(i=t[0])||void 0===i?void 0:i.label;n(s)}),[n,e]),m=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||u([...o,a]),d([a])}),[o,d]),p=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[o,d]),f=Object(a.useCallback)((e=>{var n;u(o.filter((t=>t.label!==e))),(null==c||null===(n=c[0])||void 0===n?void 0:n.label)===e&&d([]),t(e)}),[o,d,t,c]),b=Object(a.useCallback)((()=>{const e=((e,t="")=>0===e.indexOf(t)?e[e.length-1]:e[e.indexOf(t)-1])(r,i),t=o.filter((t=>t.label===e));d(t)}),[r,o,d,i]),g=Object(a.useCallback)((()=>{const e=((e,t="")=>e.indexOf(t)+1>=e.length?e[0]:e[e.indexOf(t)+1])(r,i),t=o.filter((t=>t.label===e));d(t)}),[r,o,d,i]);return Object(l.jsx)(s.EuiFormRow,{label:D,display:"rowCompressed",css:q},Object(l.jsx)(s.EuiComboBox,{"aria-label":R,customOptionText:`${N} {searchValue}`,placeholder:F,singleSelection:{asPlainText:!0},options:o,selectedOptions:c,onChange:p,onCreateOption:m,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(l.jsx)(s.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(l.jsx)(s.EuiFlexItem,{component:"span",grow:!1,css:U},Object(l.jsx)(s.EuiHighlight,{search:t,css:$},a)),!(null!=i&&i.isDefault)&&Object(l.jsx)(s.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(s.EuiToolTip,{position:"right",content:B},Object(l.jsx)(s.EuiButtonIcon,{iconType:"cross","aria-label":B,color:"danger","data-test-subj":"delete-conversation",onClick:e=>{e.stopPropagation(),f(a)},css:V}))))},compressed:!0,prepend:Object(l.jsx)(s.EuiButtonIcon,{iconType:"arrowLeft","data-test-subj":"arrowLeft","aria-label":L,onClick:b,disabled:r.length<=1}),append:Object(l.jsx)(s.EuiButtonIcon,{iconType:"arrowRight","data-test-subj":"arrowRight","aria-label":z,onClick:g,disabled:r.length<=1})}))}));Q.displayName="ConversationSelectorSettings";var H=n(222),G=n(220),W=n(252);const K=i.a.memo((({allSystemPrompts:e,defaultConnectorId:t,defaultProvider:n,selectedConversation:r,onSelectedConversationChange:o,conversationSettings:u,http:c,setUpdatedConversationSettings:d,isDisabled:m=!1})=>{const p=Object(a.useMemo)((()=>Object(H.b)({allSystemPrompts:e,conversation:void 0})),[e]),f=Object(a.useMemo)((()=>Object(H.b)({allSystemPrompts:e,conversation:r})),[e,r]),{data:b,isSuccess:g}=Object(G.a)({http:c}),v=Object(a.useCallback)((e=>{const a="string"==typeof e?{id:null!=e?e:"",messages:[],apiConfig:{connectorId:t,provider:n,defaultSystemPromptId:null==p?void 0:p.id}}:e;null!=a&&d((e=>({...e,[a.id]:a}))),o(a)}),[t,n,null==p?void 0:p.id,o,d]),y=Object(a.useCallback)((e=>{d((t=>{const{[e]:n,...a}=t;return null!=n?a:t}))}),[d]),h=Object(a.useCallback)((e=>{null!=r&&d((t=>({...t,[r.id]:{...r,apiConfig:{...r.apiConfig,defaultSystemPromptId:e}}})))}),[r,d]),j=Object(a.useMemo)((()=>{const e=null==r?void 0:r.apiConfig.connectorId;if(g)return null==b?void 0:b.find((t=>t.id===e))}),[g,b,null==r?void 0:r.apiConfig.connectorId]),E=Object(a.useMemo)((()=>null==r?void 0:r.apiConfig.provider),[null==r?void 0:r.apiConfig.provider]),D=Object(a.useCallback)((e=>{if(null!=r){const t=Object(W.b)(e);d((n=>({...n,[r.id]:{...r,apiConfig:{...r.apiConfig,connectorId:null==e?void 0:e.id,provider:null==t?void 0:t.apiProvider,model:null==t?void 0:t.defaultModel}}})))}}),[r,d]),R=Object(a.useMemo)((()=>{var e,t;const n=null===(e=Object(W.b)(j))||void 0===e?void 0:e.defaultModel;return null!==(t=null==r?void 0:r.apiConfig.model)&&void 0!==t?t:n}),[j,null==r?void 0:r.apiConfig.model]),F=Object(a.useCallback)((e=>{null!=r&&d((t=>({...t,[r.id]:{...r,apiConfig:{...r.apiConfig,model:e}}})))}),[r,d]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,k)),Object(l.jsx)(s.EuiSpacer,{size:"xs"}),Object(l.jsx)(s.EuiText,{size:"s"},w),Object(l.jsx)(s.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(Q,{selectedConversationId:null==r?void 0:r.id,conversations:u,onConversationDeleted:y,onConversationSelectionChange:v}),Object(l.jsx)(s.EuiFormRow,{"data-test-subj":"prompt-field",display:"rowCompressed",fullWidth:!0,label:C,helpText:M},Object(l.jsx)(P.a,{allSystemPrompts:e,compressed:!0,conversation:r,isEditing:!0,isDisabled:m,onSystemPromptSelectionChange:h,selectedPrompt:f,showTitles:!0,isSettingsModalVisible:!0,setIsSettingsModalVisible:S.noop})),Object(l.jsx)(s.EuiFormRow,{"data-test-subj":"connector-field",display:"rowCompressed",label:T,helpText:Object(l.jsx)(s.EuiLink,{href:`${c.basePath.get()}/app/management/insightsAndAlerting/triggersActionsConnectors/connectors`,target:"_blank",external:!0},Object(l.jsx)(O.FormattedMessage,{id:"xpack.elasticAssistant.assistant.settings.connectorHelpTextTitle",defaultMessage:"Kibana Connector to make requests with"}))},Object(l.jsx)(A.a,{isDisabled:m,onConnectorSelectionChange:D,selectedConnectorId:null==j?void 0:j.id})),!1===(null==j?void 0:j.isPreconfigured)&&E===x.OpenAiProviderType.OpenAi&&Object(l.jsx)(s.EuiFormRow,{"data-test-subj":"model-field",display:"rowCompressed",label:I.c,helpText:I.b},Object(l.jsx)(_.b,{onModelSelectionChange:F,selectedModel:R})))}));K.displayName="ConversationSettings";const J=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsTitle",{defaultMessage:"Evaluation"}),Y=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsDescription",{defaultMessage:"Run predictions and evaluations against test data sets using different models (connectors), agents, and evaluation schemes."}),X=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsTitle",{defaultMessage:"🏃 Run Details"}),Z=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsDescription",{defaultMessage:"Configure test run details like project, run name, dataset, and output index"}),ee=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsTitle",{defaultMessage:"🔮 Predictions"}),te=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsDescription",{defaultMessage:"Choose models (connectors) and corresponding agents the dataset should run against"}),ne=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsTitle",{defaultMessage:"🧮 Evaluation (Optional)"}),ae=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsDescription",{defaultMessage:"Evaluate prediction results using a specific model (connector) and evaluation criterion"}),ie=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectLabel",{defaultMessage:"Project"}),se=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectDescription",{defaultMessage:"LangSmith project to write results to"}),re=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectPlaceholder",{defaultMessage:"8.12 Testing"}),oe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameLabel",{defaultMessage:"Run name"}),le=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameDescription",{defaultMessage:"Name for this specific test run"}),ue=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNamePlaceholder",{defaultMessage:"8.12 ESQL Query Generation"}),ce=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsLabel",{defaultMessage:"Connectors / Models"}),de=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsDescription",{defaultMessage:"Select whichever models you want to evaluate the dataset against"}),me=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsLabel",{defaultMessage:"Agents"}),pe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsDescription",{defaultMessage:"Select the agents (i.e. RAG algos) to evaluate the dataset against"}),fe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelLabel",{defaultMessage:"Evaluator Model"}),be=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelDescription",{defaultMessage:"Model to perform the final evaluation with"}),ge=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeLabel",{defaultMessage:"Evaluation type"}),ve=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeDescription",{defaultMessage:'Type of evaluation to perform, e.g. "correctness" "esql-validator", or "custom" and provide your own evaluation prompt'}),ye=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptLabel",{defaultMessage:"Evaluation prompt"}),he=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptDescription",{defaultMessage:"Prompt template given `input`, `reference` and `prediction` template variables"}),je=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexLabel",{defaultMessage:"Output index"}),Ee=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexDescription",{defaultMessage:'Index to write results to. Must be prefixed with ".kibana-elastic-ai-assistant-"'}),Oe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorDatasetLabel",{defaultMessage:"Dataset"}),xe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetLabel",{defaultMessage:"LangSmith"}),Se=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetDescription",{defaultMessage:"Name of dataset hosted on LangSmith to evaluate"}),ke=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetPlaceholder",{defaultMessage:"ESQL Query Generation"}),we=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetLabel",{defaultMessage:"Custom"}),Te=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetDescription",{defaultMessage:'Custom dataset to evaluate. Array of objects with "input" and "references" properties'}),Ce=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.performEvaluationTitle",{defaultMessage:"Perform evaluation..."}),Me=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactDiscoverLinkText",{defaultMessage:"Discover"}),Ie=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactApmLinkText",{defaultMessage:"APM"});var Ae=n(177),Pe=n(50),_e=n(253);const De=["elastic-assistant","perform-evaluation"],Re=["DefaultAgentExecutor","OpenAIFunctionsExecutor"],Fe=[{label:"correctness"},{label:"esql-validator",disabled:!0},{label:"custom",disabled:!0}];var Ne={name:"1sl5m7u",styles:"min-height:330px"},Le={name:"vc763q",styles:"min-height:300px"},ze={name:"1bs7qd7",styles:"&:hover{text-decoration:none;}"},Be={name:"yz1nei",styles:"margin-top:16px"};const qe=i.a.memo((({onEvaluationSettingsChange:e})=>{var t,n;const{actionTypeRegistry:r,basePath:o,http:u}=Object(c.b)(),{data:d}=Object(G.a)({http:u}),{data:m,mutate:p,isLoading:f}=(({http:e,toasts:t})=>Object(Pe.useMutation)(De,(t=>Object(_e.d)({http:e,evalParams:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.evaluation.evaluationError",{defaultMessage:"Error performing evaluation..."})}))}}))({http:u}),[b,v]=Object(a.useState)(),y=Object(a.useCallback)((e=>{v(e.target.value)}),[v]),[h,j]=Object(a.useState)(),E=Object(a.useCallback)((e=>{j(e.target.value)}),[j]),[x,S]=Object(a.useState)(".kibana-elastic-ai-assistant-evaluation-results"),k=Object(a.useCallback)((e=>{S(e.target.value)}),[S]),[w,T]=Object(a.useState)(!0),C=Object(a.useMemo)((()=>Object(l.jsx)(s.EuiText,{size:"xs",css:Be},Oe," (",Object(l.jsx)(s.EuiLink,{color:w?"primary":"text",onClick:()=>T(!0)},xe)," / ",Object(l.jsx)(s.EuiLink,{color:w?"text":"primary",onClick:()=>T(!1)},we),")")),[w]),[M,I]=Object(a.useState)(),A=Object(a.useCallback)((e=>{I(e.target.value)}),[I]),[P,_]=Object(a.useState)(JSON.stringify([{input:"As an expert user of Elastic Security, please generate an accurate and valid ESQL query to detect the use case below. Your response should be formatted to be able to use immediately in an Elastic Security timeline or detection rule. Take your time with the answer, and really make sure you check your knowledge really well on all the functions I am asking for. check it multiple times if you need to. I cannot afford for queries to be inaccurate. Assume I am using the Elastic Common Schema. Ensure the answers are formatted in a way which is easily copyable.\n\nWrite an ESQL query for detecting cryptomining activity on an AWS EC2 instance.",reference:'FROM metrics-apm*\n| WHERE metricset.name == ""transaction"" AND metricset.interval == ""1m""\n| EVAL bucket = AUTO_BUCKET(transaction.duration.histogram, 50, <start-date>, <end-date>)\n| STATS avg_duration = AVG(transaction.duration.histogram) BY bucket'}],null,2)),D=Object(a.useCallback)((e=>{_(e.target.value)}),[_]),[R,F]=Object(a.useState)([]),N=Object(a.useCallback)((e=>{F(e)}),[F]),L=Object(s.euiPaletteComplementary)(null!==(t=null==d?void 0:d.length)&&void 0!==t?t:0),z=Object(a.useMemo)((()=>{var e;return null!==(e=null==d?void 0:d.map(((e,t)=>{var n;const a=null===(n=Object(W.b)(e))||void 0===n?void 0:n.apiProvider,i=null!=a?a:Object(W.a)(r.get(e.actionTypeId)),s=e.isPreconfigured?Ae.r:i;return{key:e.id,label:`${e.name} (${s})`,color:L[t]}})))&&void 0!==e?e:[]}),[r,d,L]),[B,q]=Object(a.useState)([]),V=Object(a.useCallback)((e=>{q(e)}),[q]),$=Object(a.useCallback)((e=>{const t=e.trim();t&&q([...B,{label:t}])}),[B]),U=Object(a.useMemo)((()=>Re.map((e=>({label:e})))),[]),[Q,H]=Object(a.useState)([]),K=Object(a.useCallback)((e=>{H(e)}),[H]),qe=Object(a.useCallback)((e=>{const t=e.trim();t&&H([{label:t}])}),[H]),Ve=Object(a.useMemo)((()=>Fe),[]),[$e,Ue]=Object(a.useState)([]),Qe=Object(a.useCallback)((e=>{Ue(e)}),[Ue]),[He,Ge]=Object(a.useState)("For the below input: \n\n{{input}} \n\na prediction: \n\n{{prediction}} \n\nwas made. How's it stack up against this reference: \n\n{{reference}} \n\nReturn output in a succinct sentence ranking on a simple grading rubric focused on correctness."),We=Object(a.useCallback)((e=>{Ge(e.target.value)}),[Ge]),Ke=0===R.length||0===B.length||0===x.length,Je=Object(a.useCallback)((async()=>{const e={models:R.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),agents:B.map((e=>e.label)),dataset:w?void 0:P,datasetName:w?M:void 0,evalModel:$e.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),evalPrompt:He,evaluationType:Q.map((e=>e.label)),outputIndex:x,projectName:b,runName:h};p(e)}),[M,P,He,x,p,b,h,B,Q,$e,R,w]),Ye=Object(a.useMemo)((()=>{var e;return((e,t)=>`${e}/app/discover#/?_g=(filters:!(),refreshInterval:(pause:!t,value:60000),time:(from:now-1y%2Fd,to:now))&_a=(columns:!(evaluationId,runName,totalAgents,totalInput,totalRequests,input,reference,prediction,evaluation.value,evaluation.reasoning,connectorName,connectorName.keyword,evaluation.__run.runId,evaluation.__run.runId.keyword,evaluation.score,evaluationEnd,evaluationId.keyword,evaluationStart,input.keyword,inputExampleId,inputExampleId.keyword,evaluationDuration,prediction.keyword,predictionResponse.reason.sendToLLM,predictionResponse.status,ConnectorId,predictionResponse.value.data,predictionResponse.value.data.keyword,predictionResponse.value.status,predictionResponse.value.trace_data.trace_id,predictionResponse.value.trace_data.trace_id.keyword,predictionResponse.value.trace_data.transaction_id,predictionResponse.value.trace_data.transaction_id.keyword,reference.keyword,runName.keyword),filters:!(),grid:(columns:('@timestamp':(width:212),ConnectorId:(width:133),connectorName:(width:181),connectorName.keyword:(width:229),evaluation.__run.runId:(width:282),evaluation.__run.runId.keyword:(width:245),evaluation.reasoning:(width:336),evaluation.reasoning.keyword:(width:232),evaluation.score:(width:209),evaluation.value:(width:156),evaluationDuration:(width:174),evaluationEnd:(width:151),evaluationId:(width:130),evaluationId.keyword:(width:186),evaluationStart:(width:202),input:(width:347),input.keyword:(width:458),prediction:(width:264),prediction.keyword:(width:313),predictionResponse.value.connector_id:(width:294),predictionResponse.value.trace_data.trace_id:(width:278),predictionResponse.value.trace_data.transaction_id.keyword:(width:177),reference:(width:305),reference.keyword:(width:219),runName:(width:405),totalAgents:(width:125),totalInput:(width:111),totalRequests:(width:138))),hideChart:!t,index:ce1b41cb-6298-4612-a33c-ba85b3c18ec7,interval:auto,query:(esql:'from%20.kibana-elastic-ai-assistant-evaluation-results%20%0A%7C%20keep%20@timestamp,%20evaluationId,%20runName,%20totalAgents,%20totalInput,%20totalRequests,%20input,%20reference,%20prediction,%20evaluation.value,%20evaluation.reasoning,%20connectorName,%20*%0A%7C%20drop%20evaluation.reasoning.keyword%0A%7C%20rename%20predictionResponse.value.connector_id%20as%20ConnectorId%0A%7C%20where%20evaluationId%20%3D%3D%20%22${t}%22%0A%7C%20sort%20@timestamp%20desc%0A%7C%20limit%20100%0A%0A%0A'),rowHeight:15,sort:!(!('@timestamp',desc)))`)(o,null!==(e=null==m?void 0:m.evaluationId)&&void 0!==e?e:"")}),[o,m]),Xe=Object(a.useMemo)((()=>{var e;return((e,t)=>`${e}/app/apm/traces/explorer/waterfall?comparisonEnabled=false&detailTab=timeline&environment=ENVIRONMENT_ALL&kuery=&query=%22labels.evaluationId%22:%20%22${t}%22&rangeFrom=now-1y&rangeTo=now&showCriticalPath=false&traceId=451662121b1f5e6c44084ad7415b9409&transactionId=5f1392fa04766025&type=kql&waterfallItemId=`)(o,null!==(e=null==m?void 0:m.evaluationId)&&void 0!==e?e:"")}),[o,m]),Ze=(e,t)=>Object(l.jsx)("div",null,Object(l.jsx)(s.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)(s.EuiTitle,{size:"xs"},Object(l.jsx)("h3",null,e)))),Object(l.jsx)(s.EuiText,{size:"s"},Object(l.jsx)("p",null,Object(l.jsx)(s.EuiTextColor,{color:"subdued"},t)))),et=Object(a.useMemo)((()=>Ze(X,Z)),[]),tt=Object(a.useMemo)((()=>Ze(ee,te)),[]),nt=Object(a.useMemo)((()=>Ze(ne,ae)),[]),at=ze;return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,J)),Object(l.jsx)(s.EuiSpacer,{size:"xs"}),Object(l.jsx)(s.EuiText,{size:"s"},Y),Object(l.jsx)(s.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(s.EuiAccordion,{id:X,arrowDisplay:"right",buttonContent:et,buttonProps:{paddingSize:"s",css:at},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(l.jsx)(s.EuiFlexGroup,null,Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:ie,helpText:se},Object(l.jsx)(s.EuiFieldText,{"aria-label":"project-textfield",compressed:!0,onChange:y,placeholder:re,value:b}))),Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:oe,helpText:le},Object(l.jsx)(s.EuiFieldText,{"aria-label":"run-name-textfield",compressed:!0,onChange:E,placeholder:ue,value:h})))),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:C,fullWidth:!0,helpText:w?Se:Te},w?Object(l.jsx)(s.EuiFieldText,{"aria-label":"dataset-name-textfield",compressed:!0,onChange:A,placeholder:ke,value:M}):Object(l.jsx)(s.EuiTextArea,{"aria-label":"evaluation-dataset-textarea",compressed:!0,css:Le,fullWidth:!0,onChange:D,value:P})),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:je,fullWidth:!0,helpText:Ee},Object(l.jsx)(s.EuiFieldText,{value:x,onChange:k,"aria-label":"evaluation-output-index-textfield"}))),Object(l.jsx)(s.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(s.EuiAccordion,{id:ee,arrowDisplay:"right",buttonContent:tt,buttonProps:{paddingSize:"s",css:at},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:ce,helpText:de},Object(l.jsx)(s.EuiComboBox,{"aria-label":"model-selector",compressed:!0,options:z,selectedOptions:R,onChange:N})),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:me,helpText:pe},Object(l.jsx)(s.EuiComboBox,{"aria-label":"agent-selector",compressed:!0,onCreateOption:$,options:U,selectedOptions:B,onChange:V}))),Object(l.jsx)(s.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(s.EuiAccordion,{id:ne,arrowDisplay:"right",element:"fieldset",buttonProps:{paddingSize:"s",css:at},buttonContent:nt,paddingSize:"s"},Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:fe,helpText:be},Object(l.jsx)(s.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,options:z,selectedOptions:$e,singleSelection:{asPlainText:!0},onChange:Qe})),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:ge,helpText:ve},Object(l.jsx)(s.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,onChange:K,onCreateOption:qe,options:Ve,selectedOptions:Q,singleSelection:{asPlainText:!0}})),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:ye,fullWidth:!0,helpText:he},Object(l.jsx)(s.EuiTextArea,{"aria-label":"evaluation-prompt-textarea",compressed:!0,css:Ne,disabled:"custom"!==(null===(n=Q[0])||void 0===n?void 0:n.label),fullWidth:!0,onChange:We,value:He}))),Object(l.jsx)(s.EuiHorizontalRule,null),Object(l.jsx)(s.EuiFlexGroup,{alignItems:"center"},Object(l.jsx)(s.EuiFlexItem,{grow:!1},Object(l.jsx)(s.EuiButton,{size:"s",type:"submit",isDisabled:Ke,isLoading:f,onClick:Je,fill:!0},Ce)),Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)(s.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)(O.FormattedMessage,{defaultMessage:"Fun Facts: Watch the Kibana server logs for progress, and view results in {discover} / {apm} once complete. Will take (many) minutes depending on dataset, and closing this dialog will cancel the evaluation!",id:"xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactText",values:{discover:Object(l.jsx)(s.EuiLink,{external:!0,href:Ye,target:"_blank"},Me),apm:Object(l.jsx)(s.EuiLink,{external:!0,href:Xe,target:"_blank"},Ie)}})))),Object(l.jsx)(s.EuiSpacer,{size:"s"}))}));qe.displayName="EvaluationSettings";const Ve=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsLabel",{defaultMessage:"Alerts"}),$e=(g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.askQuestionsAboutLabel",{defaultMessage:"Ask questions about the"}),g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.yourAnonymizationSettingsLabel",{defaultMessage:"Your anonymization settings will apply to these alerts."})),Ue=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.selectFewerAlertsLabel",{defaultMessage:"Send fewer alerts if the model's context window is too small."}),Qe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsRangeSliderLabel",{defaultMessage:"Alerts range"}),He=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsTitle",{defaultMessage:"Knowledge Base"}),Ge=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsBadgeTitle",{defaultMessage:"Experimental"}),We=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsDescription",{defaultMessage:"Powered by ELSER, the Knowledge Base enables the ability to recall documents and other relevant context within your conversation."}),Ke=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseLabel",{defaultMessage:"Knowledge Base"}),Je=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseTooltip",{defaultMessage:"ELSER must be configured to enable the Knowledge Base"}),Ye=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseDescription",{defaultMessage:"Index where Knowledge Base docs are stored"}),Xe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.initializeKnowledgeBaseButton",{defaultMessage:"Initialize"}),Ze=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.deleteKnowledgeBaseButton",{defaultMessage:"Delete"}),et=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserLabel",{defaultMessage:"ELSER Configured"}),tt=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserMachineLearningDescription",{defaultMessage:"Machine Learning"}),nt=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserSeeDocsDescription",{defaultMessage:"See docs"}),at=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlLabel",{defaultMessage:"ES|QL Knowledge Base Documents"}),it=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlDescription",{defaultMessage:"Knowledge Base docs for generating ES|QL queries"}),st=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlInstalledDescription",{defaultMessage:"ES|QL Knowledge Base docs loaded"}),rt=({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{const n=Object(s.useGeneratedHtmlId)({prefix:"inputRangeSlider"}),r=Object(a.useCallback)((n=>{t({...e,alerts:n.target.checked})}),[e,t]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiFormRow,{display:"columnCompressedSwitch",label:Ve,css:Object(l.css)(".euiFormRow__labelWrapper{min-width:",95,"px!important;}","")},Object(l.jsx)(s.EuiSwitch,{checked:e.alerts,compressed:!0,"data-test-subj":"alertsSwitch",label:Ve,onChange:r,showLabel:!1})),Object(l.jsx)(s.EuiSpacer,{size:"xs"}),Object(l.jsx)(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(l.jsx)(s.EuiFlexItem,{css:Object(l.css)("width:",300,"px;",""),grow:!1},Object(l.jsx)(s.EuiSpacer,{size:"xs"}),Object(l.jsx)(s.EuiRange,{"aria-label":Qe,compressed:!0,"data-test-subj":"alertsRange",disabled:!e.alerts,id:n,max:100,min:10,onChange:n=>t({...e,latestAlerts:Number(n.currentTarget.value)}),showTicks:!0,step:10,value:e.latestAlerts}),Object(l.jsx)(s.EuiSpacer,{size:"s"})),Object(l.jsx)(s.EuiFlexItem,{grow:!1},Object(l.jsx)(s.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,(o=e.latestAlerts,g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.latestAndRiskiestOpenAlertsLabel",{defaultMessage:"Send AI Assistant information about your {alertsCount} newest and riskiest open or acknowledged alerts.",values:{alertsCount:o}}))))),Object(l.jsx)(s.EuiFlexItem,{grow:!1},Object(l.jsx)(s.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,$e))),Object(l.jsx)(s.EuiFlexItem,{grow:!1},Object(l.jsx)(s.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,Ue)))));var o},ot=i.a.memo(rt),lt=["elastic-assistant","knowledge-base-status"],ut=()=>{const e=Object(Pe.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(lt,{refetchType:"active"})}),[e])},ct=["elastic-assistant","delete-knowledge-base"],dt=["elastic-assistant","post-knowledge-base"],mt="esql";var pt={name:"1tyyxc3",styles:"padding-left:20px"},ft={name:"1tyyxc3",styles:"padding-left:20px"},bt={name:"1tyyxc3",styles:"padding-left:20px"},gt={name:"nvudtm",styles:"padding-left:5px"},vt={name:"1xr0ypo",styles:".euiFormRow__labelWrapper{min-width:95px!important;}"};const yt=i.a.memo((({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{var n,r,o;const{http:u}=Object(c.b)(),{data:d,isLoading:m,isFetching:p}=(({http:e,resource:t,toasts:n})=>Object(Pe.useQuery)(lt,(async({signal:n})=>Object(_e.c)({http:e,resource:t,signal:n})),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==n||n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.knowledgeBase.statusError",{defaultMessage:"Error fetching Knowledge Base Status"})}))}}))({http:u,resource:mt}),{mutate:f,isLoading:b}=(({http:e,toasts:t})=>{const n=ut();return Object(Pe.useMutation)(dt,(t=>Object(_e.e)({http:e,resource:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.knowledgeBase.setupError",{defaultMessage:"Error setting up Knowledge Base"})}))},onSettled:()=>{n()}})})({http:u}),{mutate:v,isLoading:y}=(({http:e,toasts:t})=>{const n=ut();return Object(Pe.useMutation)(ct,(t=>Object(_e.a)({http:e,resource:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.knowledgeBase.deleteError",{defaultMessage:"Error deleting Knowledge Base"})}))},onSettled:()=>{n()}})})({http:u}),h=null!==(n=null==d?void 0:d.elser_exists)&&void 0!==n&&n,j=null!==(r=(null==d?void 0:d.index_exists)&&(null==d?void 0:d.pipeline_exists))&&void 0!==r&&r,E=null!==(o=null==d?void 0:d.esql_exists)&&void 0!==o&&o,x=m||p||b||y,S=e.assistantLangChain&&(null==d?void 0:d.elser_exists),k=e.assistantLangChain&&S&&j,w=!(null!=d&&d.elser_exists||e.assistantLangChain),T=h?"success":"subdued",C=j?"success":"subdued",M=E?"success":"subdued",I=Object(a.useCallback)((n=>{t({...e,assistantLangChain:n.target.checked}),n.target.checked&&null!=d&&d.elser_exists&&f(mt)}),[null==d?void 0:d.elser_exists,e,t,f]),A=Object(a.useMemo)((()=>x?Object(l.jsx)(s.EuiLoadingSpinner,{size:"s"}):Object(l.jsx)(s.EuiToolTip,{content:w&&Je,position:"right"},Object(l.jsx)(s.EuiSwitch,{showLabel:!1,"data-test-subj":"assistantLangChainSwitch",disabled:w,checked:e.assistantLangChain,onChange:I,label:Ke,compressed:!0}))),[x,w,e.assistantLangChain,I]),P=Object(a.useCallback)((e=>{e?f():v()}),[v,f]),_=Object(a.useMemo)((()=>x||!S?Object(l.jsx)(i.a.Fragment,null):Object(l.jsx)(s.EuiButtonEmpty,{color:j?"danger":"primary",flush:"left","data-test-subj":"knowledgeBaseActionButton",onClick:()=>P(!j),size:"xs"},j?Ze:Xe)),[S,j,x,P]),D=Object(a.useMemo)((()=>j?Object(l.jsx)("span",{"data-test-subj":"kb-installed"},(".kibana-elastic-ai-assistant-kb",g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseInstalledDescription",{defaultMessage:"Initialized to `{kbIndexPattern}`",values:{kbIndexPattern:".kibana-elastic-ai-assistant-kb"}}))," ",_):Object(l.jsx)("span",{"data-test-subj":"install-kb"},Ye," ",_)),[j,_]),R=Object(a.useCallback)((e=>{e?f(mt):v(mt)}),[v,f]),F=Object(a.useMemo)((()=>x||!k?Object(l.jsx)(i.a.Fragment,null):Object(l.jsx)(s.EuiButtonEmpty,{color:E?"danger":"primary",flush:"left","data-test-subj":"esqlEnableButton",onClick:()=>R(!E),size:"xs"},E?Ze:Xe)),[x,k,E,R]),N=Object(a.useMemo)((()=>E?Object(l.jsx)("span",{"data-test-subj":"esql-installed"},st," ",F):Object(l.jsx)("span",{"data-test-subj":"install-esql"},it," ",F)),[F,E]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,He," ",Object(l.jsx)(s.EuiBetaBadge,{iconType:"beaker",label:Ge,size:"s",color:"hollow"}))),Object(l.jsx)(s.EuiSpacer,{size:"xs"}),Object(l.jsx)(s.EuiText,{size:"s"},We),Object(l.jsx)(s.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(s.EuiFormRow,{display:"columnCompressedSwitch",label:Ke,css:vt},A),Object(l.jsx)(s.EuiSpacer,{size:"s"}),Object(l.jsx)(s.EuiFlexGroup,{direction:"column",gutterSize:"s",css:gt},Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)("div",null,Object(l.jsx)(s.EuiHealth,{color:T},et),Object(l.jsx)(s.EuiText,{size:"xs",color:"subdued",css:bt},Object(l.jsx)(O.FormattedMessage,{defaultMessage:"Configure ELSER within {machineLearning} to get started. {seeDocs}",id:"xpack.elasticAssistant.assistant.settings.knowledgeBasedSettings.knowledgeBaseDescription",values:{machineLearning:Object(l.jsx)(s.EuiLink,{external:!0,href:u.basePath.prepend("/app/ml/trained_models"),target:"_blank"},tt),seeDocs:Object(l.jsx)(s.EuiLink,{external:!0,href:"https://www.elastic.co/guide/en/machine-learning/current/ml-nlp-elser.html#download-deploy-elser",target:"_blank"},nt)}})))),Object(l.jsx)(s.EuiFlexItem,null,Object(l.jsx)("div",null,Object(l.jsx)(s.EuiHealth,{color:C},Ke),Object(l.jsx)(s.EuiText,{size:"xs",color:"subdued",css:ft},D))),Object(l.jsx)(s.EuiFlexItem,{grow:!1},Object(l.jsx)("span",null,Object(l.jsx)(s.EuiHealth,{color:M},at),Object(l.jsx)(s.EuiText,{size:"xs",color:"subdued",css:pt},N)))),Object(l.jsx)(s.EuiSpacer,{size:"s"}),Object(l.jsx)(ot,{knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t}))}));yt.displayName="KnowledgeBaseSettings";const ht=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsTitle",{defaultMessage:"Quick Prompts"}),jt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsDescription",{defaultMessage:"Create and manage Quick Prompts. Quick Prompts are shortcuts to common actions."}),Et=(g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.modalTitle",{defaultMessage:"Quick Prompts"}),g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.nameLabel",{defaultMessage:"Name"})),Ot=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptLabel",{defaultMessage:"Prompt"}),xt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptPlaceholder",{defaultMessage:"Enter a Quick Prompt"}),St=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.badgeColorLabel",{defaultMessage:"Badge color"}),kt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsLabel",{defaultMessage:"Contexts"}),wt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsHelpText",{defaultMessage:"Select the Prompt Contexts that this Quick Prompt will be available for. Selecting none will make this Quick Prompt available at all times."}),Tt=(g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"}),g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."})),Ct=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.deletePromptTitle",{defaultMessage:"Delete Quick Prompt"}),Mt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.customOptionText",{defaultMessage:"Create new Quick Prompt named"});var It={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},At={name:"d3v9zr",styles:"overflow:hidden"},Pt={name:"1e5733u",styles:"width:calc(100% - 60px)"};const _t=i.a.memo((({isDisabled:e=!1,quickPrompts:t,onQuickPromptDeleted:n,onQuickPromptSelectionChange:i,selectedQuickPrompt:r})=>{const[o,u]=Object(a.useState)(t.map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.title,"data-test-subj":e.title,color:e.color}}))),c=Object(a.useMemo)((()=>r?[{value:{isDefault:!0},label:r.title,color:r.color}]:[]),[r]),d=Object(a.useCallback)((e=>{var n,a;const s=0===e.length?void 0:null!==(n=t.find((t=>{var n;return t.title===(null===(n=e[0])||void 0===n?void 0:n.label)})))&&void 0!==n?n:null===(a=e[0])||void 0===a?void 0:a.label;i(s)}),[i,t]),m=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||u([...o,a]),d([a])}),[d,o]),p=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[d,o]),f=Object(a.useCallback)((e=>{var t;u(o.filter((t=>t.label!==e))),(null==c||null===(t=c[0])||void 0===t?void 0:t.label)===e&&d([]),n(e)}),[d,n,o,c]);return Object(l.jsx)(s.EuiComboBox,{"data-test-subj":"quickPromptSelector","aria-label":Tt,compressed:!0,isDisabled:e,placeholder:Tt,customOptionText:`${Mt} {searchValue}`,singleSelection:!0,options:o,selectedOptions:c,onChange:p,onCreateOption:m,renderOption:(e,t,n)=>{const{color:a,label:i,value:r}=e;return Object(l.jsx)(s.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(l.jsx)(s.EuiFlexItem,{component:"span",grow:!1,css:Pt},Object(l.jsx)(s.EuiHealth,{color:a,css:At},Object(l.jsx)(s.EuiHighlight,{search:t},i))),!(null!=r&&r.isDefault)&&Object(l.jsx)(s.EuiFlexItem,{grow:!1},Object(l.jsx)(s.EuiToolTip,{position:"right",content:Ct},Object(l.jsx)(s.EuiButtonIcon,{iconType:"cross","aria-label":Ct,"data-test-subj":"delete-quick-prompt",color:"danger",onClick:e=>{e.stopPropagation(),f(i)},css:It}))))},fullWidth:!0})}));_t.displayName="QuickPromptSelector";const Dt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.ariaLabel",{defaultMessage:"Select Prompt Context categories this Quick Prompt will be available for."}),Rt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.placeholderLabel",{defaultMessage:"(Quick Prompt will always be visible)."}),Ft=i.a.memo((({isDisabled:e,onPromptContextSelectionChange:t,promptContexts:n,selectedPromptContexts:i=[]})=>{const r=Object(a.useMemo)((()=>n.map((e=>({value:{category:e.category},label:e.description,"data-test-subj":e.description})))),[n]),o=Object(a.useMemo)((()=>null!=i?i.map((e=>({value:{category:e.category},label:e.description}))):[]),[i]),u=Object(a.useCallback)((e=>{const a=n.filter((t=>e.some((e=>t.description===e.label))));t(a)}),[t,n]),c=Object(a.useCallback)((e=>{0===e.length?u([]):-1!==r.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&u(e)}),[u,r]);return Object(l.jsx)(s.EuiComboBox,{"aria-label":Dt,compressed:!0,fullWidth:!0,isDisabled:e,placeholder:Rt,options:r,selectedOptions:o,onChange:c,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(l.jsx)("span",{className:n},Object(l.jsx)(s.EuiHighlight,{search:t},a),Object(l.jsx)("span",null,` / (${null==i?void 0:i.category})`))}})}));Ft.displayName="PromptContextSelector";const Nt="#D36086";var Lt={name:"xpz1vu",styles:"min-height:150px"};const zt=i.a.memo((({onSelectedQuickPromptChange:e,quickPromptSettings:t,selectedQuickPrompt:n,setUpdatedQuickPromptSettings:r})=>{const{basePromptContexts:o}=Object(c.b)(),u=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.prompt)&&void 0!==e?e:""}),[null==n?void 0:n.prompt]),d=Object(a.useCallback)((e=>{null!=n&&r((t=>t.some((e=>e.title===n.title))?t.map((t=>t.title===n.title?{...t,prompt:e.target.value}:t)):t))}),[n,r]),m=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.color)&&void 0!==e?e:Nt}),[null==n?void 0:n.color]),p=Object(a.useCallback)(((e,{hex:t,isValid:a})=>{null!=n&&r((t=>t.some((e=>e.title===n.title))?t.map((t=>t.title===n.title?{...t,color:e}:t)):t))}),[n,r]),f=Object(a.useMemo)((()=>{var e;return null!==(e=o.filter((e=>{var t;return null==n||null===(t=n.categories)||void 0===t?void 0:t.some((t=>(null==e?void 0:e.category)===t))})))&&void 0!==e?e:[]}),[o,null==n?void 0:n.categories]),b=Object(a.useCallback)((e=>{null!=n&&r((t=>t.some((e=>e.title===n.title))?t.map((t=>t.title===n.title?{...t,categories:e.map((e=>e.category))}:t)):t))}),[n,r]),g=Object(a.useCallback)((t=>{const n="string"==typeof t?{title:null!=t?t:"",prompt:"",color:Nt,categories:[]}:t;null!=n&&r((e=>e.some((e=>e.title===n.title))?e:[...e,n])),e(n)}),[e,r]),v=Object(a.useCallback)((e=>{r((t=>t.filter((t=>t.title!==e))))}),[r]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,ht)),Object(l.jsx)(s.EuiSpacer,{size:"xs"}),Object(l.jsx)(s.EuiText,{size:"s"},jt),Object(l.jsx)(s.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(s.EuiFormRow,{label:Et,display:"rowCompressed",fullWidth:!0},Object(l.jsx)(_t,{onQuickPromptDeleted:v,onQuickPromptSelectionChange:g,quickPrompts:t,selectedQuickPrompt:n})),Object(l.jsx)(s.EuiFormRow,{label:Ot,display:"rowCompressed",fullWidth:!0},Object(l.jsx)(s.EuiTextArea,{compressed:!0,disabled:null==n,fullWidth:!0,"data-test-subj":"quick-prompt-prompt",onChange:d,placeholder:xt,value:u,css:Lt})),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",fullWidth:!0,label:kt,helpText:wt},Object(l.jsx)(Ft,{isDisabled:null==n,onPromptContextSelectionChange:b,promptContexts:o,selectedPromptContexts:f})),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:St},Object(l.jsx)(s.EuiColorPicker,{color:m,compressed:!0,disabled:null==n,onChange:p})))}));zt.displayName="AddQuickPromptModal";const Bt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsTitle",{defaultMessage:"System Prompts"}),qt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsDescription",{defaultMessage:"Create and manage System Prompts. System Prompts are configurable chunks of context that are always sent for a given conversation."}),Vt=(g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.modalTitle",{defaultMessage:"System Prompts"}),g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.nameLabel",{defaultMessage:"Name"})),$t=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptLabel",{defaultMessage:"Prompt"}),Ut=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptPlaceholder",{defaultMessage:"Enter a System Prompt"}),Qt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsLabel",{defaultMessage:"Default conversations"}),Ht=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultNewConversationTitle",{defaultMessage:"Use as default for all new conversations"}),Gt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsHelpText",{defaultMessage:"Conversations that should use this System Prompt by default"}),Wt=(g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"}),g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"}),i.a.memo((({conversations:e,isDisabled:t=!1,onConversationSelectionChange:n,selectedConversations:i=[]})=>{const r=Object(a.useMemo)((()=>e.map((e=>({label:e.id,"data-test-subj":d.a.CONVERSATIONS_MULTISELECTOR_OPTION(e.id)})))),[e]),o=Object(a.useMemo)((()=>null!=i?i.map((e=>({label:e.id}))):[]),[i]),u=Object(a.useCallback)((t=>{const a=e.filter((e=>t.some((t=>e.id===t.label))));n(a)}),[n,e]),c=Object(a.useCallback)((e=>{0===e.length?u([]):-1!==r.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&u(e)}),[u,r]);return Object(l.jsx)(s.EuiComboBox,{"aria-label":Qt,compressed:!0,"data-test-subj":d.a.CONVERSATIONS_MULTISELECTOR,isDisabled:t,fullWidth:!0,options:r,selectedOptions:o,onChange:c})})));Wt.displayName="ConversationMultiSelector";const Kt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."}),Jt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.deletePromptTitle",{defaultMessage:"Delete System Prompt"}),Yt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.customOptionText",{defaultMessage:"Create new System Prompt named"});var Xt={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},Zt={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},en={name:"qhxz92",styles:"max-width:100%"},tn={name:"1e5733u",styles:"width:calc(100% - 60px)"};const nn=i.a.memo((({autoFocus:e=!1,systemPrompts:t,onSystemPromptDeleted:n,onSystemPromptSelectionChange:i,selectedSystemPrompt:r})=>{const[o,u]=Object(a.useState)(t.map((e=>{var t,n;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t,isNewConversationDefault:null!==(n=e.isNewConversationDefault)&&void 0!==n&&n},label:e.name,"data-test-subj":`${d.a.SYSTEM_PROMPT_SELECTOR}-${e.id}`}}))),c=Object(a.useMemo)((()=>{var e,t;return r?[{value:{isDefault:null!==(e=r.isDefault)&&void 0!==e&&e,isNewConversationDefault:null!==(t=r.isNewConversationDefault)&&void 0!==t&&t},label:r.name}]:[]}),[r]),m=Object(a.useCallback)((e=>{var n,a;const s=0===e.length?void 0:null!==(n=t.find((t=>{var n;return t.name===(null===(n=e[0])||void 0===n?void 0:n.label)})))&&void 0!==n?n:null===(a=e[0])||void 0===a?void 0:a.label;i(s)}),[i,t]),p=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||u([...o,a]),m([a])}),[m,o]),f=Object(a.useCallback)((e=>{0===e.length?m([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&m(e)}),[m,o]),b=Object(a.useCallback)((e=>{var t;u(o.filter((t=>t.label!==e))),(null==c||null===(t=c[0])||void 0===t?void 0:t.label)===e&&m([]),n(e)}),[m,n,o,c]);return Object(l.jsx)(s.EuiComboBox,{"aria-label":Kt,className:"systemPromptSelector",compressed:!0,"data-test-subj":d.a.SYSTEM_PROMPT_SELECTOR,fullWidth:!0,placeholder:Kt,customOptionText:`${Yt} {searchValue}`,singleSelection:{asPlainText:!0},options:o,selectedOptions:c,onChange:f,onCreateOption:p,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(l.jsx)(s.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween","data-test-subj":"systemPromptOptionSelector"},Object(l.jsx)(s.EuiFlexItem,{grow:!1,component:"span",css:tn},Object(l.jsx)(s.EuiFlexGroup,{alignItems:"center",component:"span",gutterSize:"s"},Object(l.jsx)(s.EuiFlexItem,{component:"span",grow:!1,css:en},Object(l.jsx)(s.EuiHighlight,{search:t,css:Zt},a)),(null==i?void 0:i.isNewConversationDefault)&&Object(l.jsx)(s.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(s.EuiToolTip,{position:"right",content:Ht},Object(l.jsx)(s.EuiIcon,{type:"starFilled"}))))),!(null!=i&&i.isDefault)&&Object(l.jsx)(s.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(s.EuiToolTip,{position:"right",content:Jt},Object(l.jsx)(s.EuiButtonIcon,{iconType:"cross","aria-label":Jt,color:"danger","data-test-subj":"delete-prompt",onClick:e=>{e.stopPropagation(),b(a)},css:Xt}))))},autoFocus:e})}));nn.displayName="SystemPromptSelector";var an={name:"xpz1vu",styles:"min-height:150px"};const sn=i.a.memo((({conversationSettings:e,onSelectedSystemPromptChange:t,selectedSystemPrompt:n,setUpdatedSystemPromptSettings:r,setUpdatedConversationSettings:o,systemPromptSettings:u})=>{const c=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.content)&&void 0!==e?e:""}),[null==n?void 0:n.content]),m=Object(a.useCallback)((e=>{null!=n&&r((t=>t.some((e=>e.id===n.id))?t.map((t=>t.id===n.id?{...t,content:e.target.value}:t)):t))}),[n,r]),p=Object(a.useMemo)((()=>Object.values(e)),[e]),f=Object(a.useMemo)((()=>null!=n?Object.values(e).filter((e=>e.apiConfig.defaultSystemPromptId===n.id)):[]),[e,n]),b=Object(a.useCallback)((e=>{const t=e.map((e=>e.id));null!=n&&o((e=>Object(S.keyBy)("id",Object.values(e).map((e=>({...e,apiConfig:{...e.apiConfig,defaultSystemPromptId:t.includes(e.id)?null==n?void 0:n.id:e.apiConfig.defaultSystemPromptId===(null==n?void 0:n.id)?void 0:e.apiConfig.defaultSystemPromptId}}))))))}),[n,o]),g=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.isNewConversationDefault)&&void 0!==e&&e}),[null==n?void 0:n.isNewConversationDefault]),v=Object(a.useCallback)((e=>{const t=e.target.checked;null!=n&&r((e=>e.map((e=>({...e,isNewConversationDefault:n.id===e.id&&t})))))}),[n,r]),y=Object(a.useCallback)((e=>{const n="string"==typeof e?{id:null!=e?e:"",content:"",name:null!=e?e:"",promptType:"system"}:e;null!=n&&r((e=>e.some((e=>e.id===n.id))?e:[...e,n])),t(n)}),[t,r]),h=Object(a.useCallback)((e=>{r((t=>t.filter((t=>t.id!==e))))}),[r]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,Bt)),Object(l.jsx)(s.EuiSpacer,{size:"xs"}),Object(l.jsx)(s.EuiText,{size:"s"},qt),Object(l.jsx)(s.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:Vt,fullWidth:!0},Object(l.jsx)(nn,{onSystemPromptDeleted:h,onSystemPromptSelectionChange:y,systemPrompts:u,selectedSystemPrompt:n})),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",label:$t,fullWidth:!0},Object(l.jsx)(s.EuiTextArea,{"data-test-subj":d.a.SYSTEM_PROMPT_MODAL.PROMPT_TEXT,disabled:null==n,onChange:m,placeholder:Ut,value:c,compressed:!0,fullWidth:!0,css:an})),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed",fullWidth:!0,helpText:Gt,label:Qt},Object(l.jsx)(Wt,{conversations:p,isDisabled:null==n,onConversationSelectionChange:b,selectedConversations:f})),Object(l.jsx)(s.EuiFormRow,{display:"rowCompressed"},Object(l.jsx)(s.EuiCheckbox,{"data-test-subj":d.a.SYSTEM_PROMPT_MODAL.TOGGLE_ALL_DEFAULT_CONVERSATIONS,disabled:null==n,id:"defaultNewConversation",label:Object(l.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(l.jsx)(s.EuiFlexItem,null,Ht),Object(l.jsx)(s.EuiFlexItem,{grow:!1},Object(l.jsx)(s.EuiIcon,{type:g?"starFilled":"starEmpty"}))),checked:g,onChange:v,compressed:!0})))}));sn.displayName="SystemPromptSettings";const rn=o()(s.EuiModal)`
  width: 800px;
  height: 575px;
`,on="CONVERSATION_TAB",ln="QUICK_PROMPTS_TAB",un="SYSTEM_PROMPTS_TAB",cn="ANONYMIZATION_TAB",dn="KNOWLEDGE_BASE_TAB",mn="EVALUATION_TAB";var pn={name:"1r962iv",styles:"padding:4px"},fn={name:"1tk8yx0",styles:"padding:8px"},bn={name:"zd35ug",styles:"max-height:550px;overflow-y:scroll"},gn={name:"16zl6ct",styles:"position:absolute;top:11px;left:14px"},vn={name:"16zl6ct",styles:"position:absolute;top:11px;left:14px"},yn={name:"57t0bw",styles:"position:relative;transform:rotateY(180deg);top:-7px"},hn={name:"15ag9ng",styles:"position:relative;top:-10px"},jn={name:"18wygtw",styles:"min-inline-size:unset!important;max-width:104px"};const En=i.a.memo((({defaultConnectorId:e,defaultProvider:t,onClose:n,onSave:r,selectedConversation:o,setSelectedConversationId:m})=>{const{modelEvaluatorEnabled:p,http:f,selectedSettingsTab:b,setSelectedSettingsTab:g}=Object(c.b)(),{conversationSettings:v,defaultAllow:y,defaultAllowReplacement:h,knowledgeBase:j,quickPromptSettings:O,systemPromptSettings:x,setUpdatedConversationSettings:S,setUpdatedDefaultAllow:k,setUpdatedDefaultAllowReplacement:w,setUpdatedKnowledgeBaseSettings:T,setUpdatedQuickPromptSettings:C,setUpdatedSystemPromptSettings:M,saveSettings:I}=(()=>{const{allQuickPrompts:e,allSystemPrompts:t,conversations:n,defaultAllow:i,defaultAllowReplacement:s,knowledgeBase:r,setAllQuickPrompts:o,setAllSystemPrompts:l,setConversations:u,setDefaultAllow:d,setDefaultAllowReplacement:m,setKnowledgeBase:p}=Object(c.b)(),[f,b]=Object(a.useState)(n),[g,v]=Object(a.useState)(e),[y,h]=Object(a.useState)(t),[j,E]=Object(a.useState)(i),[O,x]=Object(a.useState)(s),[S,k]=Object(a.useState)(r),w=Object(a.useCallback)((()=>{b(n),v(e),k(r),h(t),E(i),x(s)}),[e,t,n,i,s,r]),T=Object(a.useCallback)((()=>{o(g),l(y),u(f),p(S),d(j),m(O)}),[o,l,u,d,m,p,f,j,O,S,g,y]);return{conversationSettings:f,defaultAllow:j,defaultAllowReplacement:O,knowledgeBase:S,quickPromptSettings:g,resetSettings:w,systemPromptSettings:y,saveSettings:T,setUpdatedDefaultAllow:E,setUpdatedDefaultAllowReplacement:x,setUpdatedConversationSettings:b,setUpdatedKnowledgeBaseSettings:k,setUpdatedQuickPromptSettings:v,setUpdatedSystemPromptSettings:h}})(),[A,P]=Object(a.useState)((()=>v[o.id])),_=Object(a.useCallback)((e=>{P(e)}),[]);Object(a.useEffect)((()=>{null!=A&&P(v[A.id])}),[v,A]);const[D,R]=Object(a.useState)(),F=Object(a.useCallback)((e=>{R(e)}),[]);Object(a.useEffect)((()=>{null!=D&&R(O.find((e=>e.title===D.title)))}),[O,D]);const[N,L]=Object(a.useState)(),z=Object(a.useCallback)((e=>{L(e)}),[]);Object(a.useEffect)((()=>{null!=N&&L(x.find((e=>e.id===N.id)))}),[N,x]);const B=Object(a.useCallback)((()=>{const e=null==v[o.id],t=Object.keys(v)[0];e&&null!=t&&m(v[t].id),I(),r()}),[v,o.id,r,I,m]);return Object(l.jsx)(rn,{"data-test-subj":d.a.SETTINGS_MODAL,onClose:n},Object(l.jsx)(s.EuiPage,{paddingSize:"none"},Object(l.jsx)(s.EuiPageSidebar,{paddingSize:"xs",css:jn},Object(l.jsx)(s.EuiKeyPadMenu,null,Object(l.jsx)(s.EuiKeyPadMenuItem,{id:on,label:u.c,isSelected:b===on,onClick:()=>g(on),"data-test-subj":`${on}-button`},Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiIcon,{type:"editorComment",size:"xl",css:hn}),Object(l.jsx)(s.EuiIcon,{type:"editorComment",size:"l",css:yn}))),Object(l.jsx)(s.EuiKeyPadMenuItem,{id:ln,label:u.f,isSelected:b===ln,onClick:()=>g(ln),"data-test-subj":`${ln}-button`},Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiIcon,{type:"editorComment",size:"xxl"}),Object(l.jsx)(s.EuiIcon,{type:"bolt",size:"s",color:"warning",css:vn}))),Object(l.jsx)(s.EuiKeyPadMenuItem,{id:un,label:u.k,isSelected:b===un,onClick:()=>g(un),"data-test-subj":`${un}-button`},Object(l.jsx)(s.EuiIcon,{type:"editorComment",size:"xxl"}),Object(l.jsx)(s.EuiIcon,{type:"storage",size:"s",color:"success",css:gn})),Object(l.jsx)(s.EuiKeyPadMenuItem,{id:cn,label:u.a,isSelected:b===cn,onClick:()=>g(cn),"data-test-subj":`${cn}-button`},Object(l.jsx)(s.EuiIcon,{type:"eyeClosed",size:"l"})),Object(l.jsx)(s.EuiKeyPadMenuItem,{id:dn,label:u.e,isSelected:b===dn,onClick:()=>g(dn),"data-test-subj":`${dn}-button`},Object(l.jsx)(s.EuiIcon,{type:"notebookApp",size:"l"})),p&&Object(l.jsx)(s.EuiKeyPadMenuItem,{id:mn,label:u.d,isSelected:b===mn,onClick:()=>g(mn),"data-test-subj":`${mn}-button`},Object(l.jsx)(s.EuiIcon,{type:"crossClusterReplicationApp",size:"l"})))),Object(l.jsx)(s.EuiPageBody,{paddingSize:"none",panelled:!0},Object(l.jsx)(s.EuiSplitPanel.Outer,{grow:!0},Object(l.jsx)(s.EuiSplitPanel.Inner,{className:"eui-scrollBar",grow:!0,css:bn},b===on&&Object(l.jsx)(K,{defaultConnectorId:e,defaultProvider:t,conversationSettings:v,setUpdatedConversationSettings:S,allSystemPrompts:x,selectedConversation:A,isDisabled:null==A,onSelectedConversationChange:_,http:f}),b===ln&&Object(l.jsx)(zt,{quickPromptSettings:O,onSelectedQuickPromptChange:F,selectedQuickPrompt:D,setUpdatedQuickPromptSettings:C}),b===un&&Object(l.jsx)(sn,{conversationSettings:v,systemPromptSettings:x,onSelectedSystemPromptChange:z,selectedSystemPrompt:N,setUpdatedConversationSettings:S,setUpdatedSystemPromptSettings:M}),b===cn&&Object(l.jsx)(E,{defaultAllow:y,defaultAllowReplacement:h,pageSize:5,setUpdatedDefaultAllow:k,setUpdatedDefaultAllowReplacement:w}),b===dn&&Object(l.jsx)(yt,{knowledgeBase:j,setUpdatedKnowledgeBaseSettings:T}),b===mn&&Object(l.jsx)(qe,null)),Object(l.jsx)(s.EuiSplitPanel.Inner,{grow:!1,color:"subdued",css:fn},Object(l.jsx)(s.EuiModalFooter,{css:pn},Object(l.jsx)(s.EuiButtonEmpty,{size:"s","data-test-subj":"cancel-button",onClick:n},u.b),Object(l.jsx)(s.EuiButton,{size:"s",type:"submit","data-test-subj":"save-button",onClick:B,fill:!0},u.g)))))))}));En.displayName="AssistantSettings"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(135);const s=()=>{const[e,t]=Object(a.useState)({isAuthenticated:null,hasEncryptionKey:null,hasIndexManage:null,hasIndexRead:null,hasIndexWrite:null,hasIndexUpdateDelete:null,hasIndexMaintenance:null,hasKibanaCRUD:!1,hasKibanaREAD:!1}),{detectionEnginePrivileges:n,kibanaSecuritySolutionsPrivileges:{crud:s,read:r}}=Object(i.a)();return Object(a.useEffect)((()=>{null!=n.error&&t({isAuthenticated:!1,hasEncryptionKey:!1,hasIndexManage:!1,hasIndexRead:!1,hasIndexWrite:!1,hasIndexUpdateDelete:!1,hasIndexMaintenance:!1,hasKibanaCRUD:s,hasKibanaREAD:r})}),[n.error,s,r]),Object(a.useEffect)((()=>{if(null!=n.result){const e=n.result;if(null!=e.index&&Object.keys(e.index).length>0){const n=Object.keys(e.index)[0];t({isAuthenticated:e.is_authenticated,hasEncryptionKey:e.has_encryption_key,hasIndexManage:e.index[n].manage&&e.cluster.manage,hasIndexMaintenance:e.index[n].maintenance,hasIndexRead:e.index[n].read,hasIndexWrite:e.index[n].create||e.index[n].create_doc||e.index[n].index||e.index[n].write,hasIndexUpdateDelete:e.index[n].write,hasKibanaCRUD:s,hasKibanaREAD:r})}}}),[n.result,s,r]),{loading:n.loading,...e}}},,function(e,t,n){"use strict";var a=n(362);n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return a.c}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return j})),n.d(t,"d",(function(){return E})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return x}));var a=n(62),i=n(17),s=n(2),r=n.n(s),o=n(44),l=n.n(o),u=n(4),c=n(110);const d="100%",m=l.a.div.withConfig({displayName:"WrappedByAutoSizerComponent",componentId:"sc-1gxuxf9-0"})([""," position:relative;&:hover{z-index:100;}"],(e=>`\n    height: ${null!=e.height?e.height:d};\n  `));m.displayName="WrappedByAutoSizer";const p=r.a.memo(m);let f;!function(e){e.BAR="bar",e.AREA="area",e.LINE="line"}(f||(f={}));const b={chartMargins:{left:0,right:0,top:4,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.05}},g=()=>({baseTheme:Object(c.n)(u.C)?a.DARK_THEME:a.LIGHT_THEME,theme:b}),v={rotation:0,rendering:"canvas",showLegend:!1,showLegendExtra:!1,debug:!1,legendPosition:a.Position.Bottom},y=(e,t)=>{const n=e||t;return n?`${n}px`:d},h=(e,t)=>{const n=e||t;return n?`${n}px`:"100%"},j=e=>Array.isArray(e)&&e.every((e=>Array.isArray(e.value)&&e.value.every((({y:e})=>0===e)))),E=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1gxuxf9-1"})(["position:relative;"]),O=l()(i.EuiFlexGroup).withConfig({displayName:"ChartWrapper",componentId:"sc-1gxuxf9-2"})(["z-index:0;"]),x=l()(i.EuiFlexGroup).withConfig({displayName:"BarChartWrapper",componentId:"sc-1gxuxf9-3"})(["z-index:0;padding-right:20px;"])},,,function(e,t,n){"use strict";e.exports=n(613)},function(e,t,n){"use strict";e.exports=n(619)},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),s=n(44),r=n.n(s),o=n(45);const l=r.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-we8ln-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}",""],(({targetClassNames:e})=>Object(s.css)(["","{pointer-events:none;opacity:0;transition:opacity "," ease;}","{pointer-events:auto;opacity:1;}"],e.map((e=>`.${e}`)).join(", "),(e=>Object(o.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),e.map((e=>`&:hover .${e}`)).join(", ")))),u=i.a.memo((({show:e=!0,targetClassNames:t,children:n})=>e?i.a.createElement(l,{"data-test-subj":"hoverVisibilityContainer",targetClassNames:t},n):i.a.createElement(i.a.Fragment,null,n)));u.displayName="HoverVisibilityContainer"},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m}));var a=n(45),i=n(2),s=n(873),r=n.n(s),o=n(62),l=n(78),u=n.n(l);const c=(e,t)=>{const n=null!=t?t:((e,t)=>{const n=t.diff(e,"days");return n<=1&&!e.isSame(t)?2:n})(u()(e[0]),u()(e[1])),a=Object(o.niceTimeFormatByDay)(n);return Object(o.timeFormatter)(a)},d=(e=100)=>{const[t,n]=Object(i.useState)({width:0,height:0}),s=Object(i.useMemo)((()=>Object(a.throttle)(e,n)),[e]),{ref:o}=r()({onResize:s});return{ref:o,...t}},m=(e,t,n,a)=>{Object(i.useEffect)((()=>{!async function(){const i=await(null==e?void 0:e.getVariation(t,n));i&&a(i)}()}),[e,t,n,a])}},,,,,,function(e,t,n){"use strict";n.d(t,"g",(function(){return c.a})),n.d(t,"a",(function(){return d.b})),n.d(t,"b",(function(){return d.c})),n.d(t,"c",(function(){return d.d})),n.d(t,"d",(function(){return d.f})),n.d(t,"e",(function(){return m.f})),n.d(t,"f",(function(){return m.g}));var a=n(111),i=n(141);const s=a.z.object({add:a.z.array(i.m),remove:a.z.array(i.m)}),r=a.z.array(i.m).min(1);a.z.object({assignees:s,ids:r});var o=n(46),l=(n(264),n(247)),u=(n(299),n(370),n(273)),c=n(248);n(371),o.exact(o.type({tags:u.b,ids:u.a})),n(481),n(341),n(389);var d=n(191),m=n(290);l.e.and(l.f).and(a.object({invocationCount:a.number(),timeframeEnd:a.string()}));var p=n(120);o.exact(o.partial({query:o.object,aggs:o.object,size:p.m,track_total_hits:o.boolean,_source:o.union([o.boolean,o.string,o.array(o.string)]),fields:o.array(o.string),runtime_mappings:o.unknown,sort:o.object})),o.intersection([o.type({status:u.h}),o.partial({conflicts:u.d,signal_ids:u.f,query:u.g})]);const f=o.partial({requests_per_second:o.number,size:p.n,slices:p.m});o.intersection([o.exact(o.type({index:o.array(o.string)})),o.exact(f)]),o.exact(o.type({migration_ids:o.array(o.string)})),o.exact(o.type({migration_ids:o.array(o.string)}));var b=n(277);o.exact(o.type({from:b.f}))},function(e,t,n){"use strict";n.d(t,"h",(function(){return E})),n.d(t,"i",(function(){return O})),n.d(t,"j",(function(){return x})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return S})),n.d(t,"f",(function(){return v.a})),n.d(t,"g",(function(){return v.b})),n.d(t,"a",(function(){return k}));var a=n(46),i=n(120);let s,r;!function(e){e.last_hour="last_hour",e.last_day="last_day",e.last_week="last_week",e.last_month="last_month",e.last_year="last_year",e.custom_range="custom_range"}(s||(s={})),function(e){e.minute="minute",e.hour="hour",e.day="day",e.week="week",e.month="month"}(r||(r={}));const o=a.union([a.exact(a.type({type:a.literal(s.last_hour),granularity:a.literal(r.minute)})),a.exact(a.type({type:a.literal(s.last_day),granularity:a.union([a.literal(r.minute),a.literal(r.hour)])})),a.exact(a.type({type:a.literal(s.last_week),granularity:a.union([a.literal(r.hour),a.literal(r.day)])})),a.exact(a.type({type:a.literal(s.last_month),granularity:a.union([a.literal(r.day),a.literal(r.week)])})),a.exact(a.type({type:a.literal(s.last_year),granularity:a.union([a.literal(r.week),a.literal(r.month)])})),a.exact(a.type({type:a.literal(s.custom_range),granularity:a.union([a.literal(r.minute),a.literal(r.hour),a.literal(r.day),a.literal(r.week),a.literal(r.month)]),from:i.g,to:i.g}))]);a.exact(a.partial({interval:o,debug:a.boolean})),a.exact(a.intersection([a.type({rule_id:i.j}),a.partial({interval:o,debug:a.boolean})])),a.exact(a.partial({interval:o,debug:a.boolean})),a.exact(a.type({}));var l=n(111),u=n(182);const c=l.z.enum(["trace","debug","info","warn","error"]),d=c.enum,m=l.z.enum(["message","status-change","execution-metrics"]),p=m.enum,f=l.z.object({timestamp:l.z.string().datetime(),sequence:l.z.number().int(),level:c,type:m,execution_id:l.z.string().min(1),message:l.z.string()});var b=n(248),g=n(370);l.z.object({search_term:l.z.string().optional(),event_types:Object(u.a)(m).optional().default([]),log_levels:Object(u.a)(c).optional().default([]),date_start:l.z.string().datetime().optional(),date_end:l.z.string().datetime().optional(),sort_order:b.a.optional().default("desc"),page:l.z.coerce.number().int().optional().default(1),per_page:l.z.coerce.number().int().optional().default(20)}),l.z.object({ruleId:l.z.string().min(1)}),l.z.object({events:l.z.array(f),pagination:g.a});var v=n(219);const y=l.z.object({execution_uuid:l.z.string(),timestamp:l.z.string().datetime(),duration_ms:l.z.number().int(),status:l.z.string(),message:l.z.string(),num_active_alerts:l.z.number().int(),num_new_alerts:l.z.number().int(),num_recovered_alerts:l.z.number().int(),num_triggered_actions:l.z.number().int(),num_succeeded_actions:l.z.number().int(),num_errored_actions:l.z.number().int(),total_search_duration_ms:l.z.number().int(),es_search_duration_ms:l.z.number().int(),schedule_delay_ms:l.z.number().int(),timed_out:l.z.boolean(),indexing_duration_ms:l.z.number().int(),search_duration_ms:l.z.number().int(),gap_duration_s:l.z.number().int(),security_status:l.z.string(),security_message:l.z.string()}),h=l.z.enum(["timestamp","duration_ms","gap_duration_s","indexing_duration_ms","search_duration_ms","schedule_delay_ms"]);h.enum,l.z.object({start:l.z.string().datetime(),end:l.z.string().datetime(),query_text:l.z.string().optional().default(""),status_filters:Object(u.a)(v.a).optional().default([]),sort_field:h.optional().default("timestamp"),sort_order:b.a.optional().default("desc"),page:l.z.coerce.number().int().optional().default(1),per_page:l.z.coerce.number().int().optional().default(20)}),l.z.object({ruleId:l.z.string().min(1)}),l.z.object({events:l.z.array(y).optional(),total:l.z.number().int().optional()});var j=n(4);j.Db,j.Db,j.Db;const E=`${j.Db}/health/_setup`,O=(j.Db,e=>`${j.Db}/rules/${e}/execution/events`),x=(j.Db,e=>`${j.Db}/rules/${e}/execution/results`);let S;n(364),function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.off="off"}(S||(S={})),n(143),n(363);const k=c.options},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="row-renderer-example"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m}));var a=n(17),i=n(2),s=n.n(i),r=n(47),o=n(113),l=n(151),u=n(516);const c={ACTION_MENU:"timeline-action-menu",DATA_VIEW:"timeline-data-view",DATA_PROVIDER:"toggle-data-provider",SAVE_TIMELINE:"save-timeline-action",ADD_TO_FAVORITES:"add-to-favorites"},d=[{title:u.o,content:s.a.createElement(a.EuiText,null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.newTimeline.description",defaultMessage:"Click {newButton} to create a new Timeline. Click {openButton} to open an existing one.",values:{newButton:s.a.createElement(a.EuiCode,null,u.i),openButton:s.a.createElement(a.EuiCode,null,u.k)}})),anchor:c.ACTION_MENU},{title:u.a,content:s.a.createElement(a.EuiText,null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.addToFavorites.description",defaultMessage:"Click to favorite your Timeline so you can quickly find it later."})),anchor:c.ADD_TO_FAVORITES},{timelineTab:l.g.query,title:u.b,content:s.a.createElement(a.EuiText,null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.changeDataView.description",defaultMessage:"Click the {dataViewButton} menu to choose the event or alert data that you want to display.",values:{dataViewButton:s.a.createElement(a.EuiCode,null," ",u.e)}})),anchor:c.DATA_VIEW},{timelineType:o.l.default,timelineTab:l.g.query,title:u.d,content:s.a.createElement(a.EuiText,null,u.c),anchor:c.DATA_PROVIDER},{title:u.m,content:s.a.createElement(a.EuiText,null,s.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.saveTimeline.description",defaultMessage:"Click {saveButton} to manually save new changes. While saving your Timeline, you can {editButton} its name and description or save it as a new Timeline.",values:{saveButton:s.a.createElement(a.EuiCode,null,u.l),editButton:s.a.createElement(a.EuiCode,null,u.f)}})),anchor:c.SAVE_TIMELINE}],m={currentTourStep:1,isTourActive:!0,tourPopoverWidth:300,tourSubtitle:u.n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return r}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.chart.dataAllValuesZerosTitle",{defaultMessage:"All values returned zero"}),s=a.i18n.translate("xpack.securitySolution.chart.dataNotAvailableTitle",{defaultMessage:"Chart Data Not Available"}),r=a.i18n.translate("xpack.securitySolution.chart.emptyValueLabel",{defaultMessage:"empty value"})},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i={ADD_EXCEPTION_FLYOUT:`${a.l} fetchAlerts addExceptionFlyout`,ALERTS_COUNT_BY_STATUS:`${a.l} fetchAlerts byRulebyCount`,ALERTS_GROUPING:`${a.l} fetchAlerts grouping`,BY_ID:`${a.l} fetchAlerts byId`,BY_RULE_BY_STATUS:`${a.l} fetchAlerts byRulebyStatus`,BY_RULE_ID:`${a.l} fetchAlerts byRuleId`,BY_SEVERITY:`${a.l} fetchAlerts bySeverity`,BY_STATUS:`${a.l} fetchAlerts byStatus`,CASES:`${a.l} fetchAlerts cases`,COUNT:`${a.l} fetchAlerts count`,HISTOGRAM:`${a.l} fetchAlerts histogram`,PREVALENCE:`${a.l} fetchAlerts prevalence`,SOC_TRENDS:`${a.l} fetchAlerts socTrends`,TREE_MAP:`${a.l} fetchAlerts treeMap`,VULNERABLE_HOSTS:`${a.l} fetchAlerts vulnerableHosts`,VULNERABLE_USERS:`${a.l} fetchAlerts vulnerableUsers`}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(9),i=n(2),s=n(311),r=n(336);const o=({fetchMethod:e=s.e,query:t,indexName:n,skip:o,queryName:l})=>{const[u,c]=Object(i.useState)(t),[d,m]=Object(i.useState)({data:null,response:"",request:"",setQuery:c,refetch:null}),[p,f]=Object(i.useState)(!1),b=((e,t)=>{const{startTracking:n}=Object(r.a)();return Object(i.useMemo)((()=>async a=>{const{endTracking:i}=n({name:t});let s;try{s=await e(a),i("success")}catch(e){throw i(a.signal.aborted?"aborted":"error"),e}return s}),[e,t,n])})(e,l);return Object(i.useEffect)((()=>{let e=!0;const t=new AbortController,i=async()=>{try{f(!0);const s=await b({query:u,signal:t.signal});var a;e&&m({data:s,response:JSON.stringify(s,null,2),request:JSON.stringify({index:null!==(a=[n])&&void 0!==a?a:[""],body:u},null,2),setQuery:c,refetch:i})}catch(t){e&&m({data:null,response:"",request:"",setQuery:c,refetch:i})}e&&f(!1)};return Object(a.isEmpty)(u)||o||i(),o&&(f(!1),e=!1,t.abort()),()=>{e=!1,t.abort()}}),[u,n,o,b]),{loading:p,...d}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(111),i=n(141);const s=a.z.object({id:a.z.string().optional(),rule_id:i.N.optional(),list_id:a.z.string().min(1).optional(),item_id:a.z.string().min(1).optional(),error:a.z.object({status_code:a.z.number().int().min(400),message:a.z.string()})}).strict()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var a=n(2);t.useFirstMountState=function(){var e=a.useRef(!0);return e.current?(e.current=!1,!0):e.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveHookState=void 0,t.resolveHookState=function(e,t){return"function"==typeof e?e(t):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131).isClient?window:null,s=function(e){return!!e.addEventListener},r=function(e){return!!e.on};t.default=function(e,t,n,o){void 0===n&&(n=i),a.useEffect((function(){if(t&&n)return s(n)?n.addEventListener(e,t,o):r(n)&&n.on(e,t,o),function(){s(n)?n.removeEventListener(e,t,o):r(n)&&n.off(e,t,o)}}),[e,t,n,JSON.stringify(o)])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(256));t.default=function(e){var t=i.useRef(e);t.current=e,s.default((function(){return function(){return t.current()}}))}},function(e,t,n){const a=n(173);e.exports=(e,t,n=!1)=>{if(e instanceof a)return e;try{return new a(e,t)}catch(e){if(!n)return null;throw e}}},,,,,,,,,,function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(391))},function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:s}=n(315),r=n(314),o=(t=e.exports={}).re=[],l=t.safeRe=[],u=t.src=[],c=t.t={};let d=0;const m="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",s],[m,i]],f=(e,t,n)=>{const a=(e=>{for(const[t,n]of p)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=d++;r(e,i,t),c[e]=i,u[i]=t,o[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(a,n?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${m}*`),f("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${m}+`),f("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),f("FULL",`^${u[c.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),f("LOOSE",`^${u[c.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),f("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),f("COERCE",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?(?:$|[^\\d])`),f("COERCERTL",u[c.COERCE],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u}));var a=n(2),i=n(11),s=n.n(i),r=n(438);const o=e=>{const t=Object(r.b)(),n=s()(t.sections$,t.getSectionsValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},l=e=>{const t=Object(r.b)(),n=s()(t.messages$,t.getMessagesValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},u=e=>{const t=Object(r.b)(),n=Object(a.useMemo)((()=>t.getPageUpselling(e)),[e,t]);return null!=n?n:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return v})),n.d(t,"b",(function(){return y}));var a=n(142),i=n(124),s=n(122),r=n(116),o=n(521);const l=[i.e.alertsOnAlertsPage,i.e.alertsOnRuleDetailsPage,i.e.alertsOnCasePage,s.c.casePage],u=[{value:"all",inputDisplay:o.b,"data-test-subj":"option-all"}],c=[{value:"raw",inputDisplay:o.d,"data-test-subj":"option-raw"}],d=[{value:"alert",inputDisplay:o.a,"data-test-subj":"option-alert"}],m=[...c,...d],p=e=>{switch(e){case"all":return u;case"raw":return c;case"alert":return d;default:return m}},f=e=>!!e&&l.includes(e),b=[a.a,a.b,a.e,a.f,a.g,a.h,a.o,a.r,a.H,a.w,a.K,a.s,a.t,a.Z,a.nb,a.ob,a.rb,a.u,a.x,a.y,a.z,a.A,a.D,a.E,a.F,a.G,a.I,a.J,a.L,a.N,a.O,a.P,a.Q,a.R,a.S,a.T,a.U,a.V,a.v,a.W,a.X,a.Y,a.ib,a.lb,"signal.rule.building_block_type","signal.rule.id","signal.rule.name","signal.rule.threat_mapping","signal.status"],g=({tableId:e,view:t})=>"raw"===t&&f(e),v=({filters:e,tableId:t,view:n})=>g({tableId:t,view:n})?e.filter((e=>!b.includes(`${e.meta.key}`))):e,y=({scopeId:e,view:t})=>g({tableId:e,view:t})?r.SourcererScopeName.default:f(e)?r.SourcererScopeName.detections:e===s.c.active?r.SourcererScopeName.timeline:r.SourcererScopeName.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(48),s=n(128),r=n(167),o=n(117),l=n(112);const u=({id:e,filterQuery:t,kqlError:n,query:u,startDate:c,endDate:d})=>{const{addError:m}=Object(o.a)(),p=Object(i.useDispatch)(),f=Object(a.useMemo)((()=>s.a.errorsSelector()),[]),b=Object(l.a)(f),g=null==n?void 0:n.name,v=null==n?void 0:n.message;Object(a.useEffect)((()=>{if(!t&&v&&g){const t=v.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0).toString();p(r.a.addErrorHash({id:e,hash:t,title:g,message:[v]}))}}),[e,t,m,u,c,d,p,v,g]),Object(a.useEffect)((()=>{const t=b.find((t=>t.id===e));null!=t&&t.displayError&&null!=n&&(delete n.stack,m(n,{title:n.name}))}),[m,b,e,n])}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(114),s=n(117),r=n(311),o=n(553),l=n(262);const u=()=>{const[e,t]=Object(a.useState)(!0),[n,u]=Object(a.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:null}),{addError:c}=Object(s.a)(),{hasIndexRead:d}=Object(l.a)();return Object(a.useEffect)((()=>{let e=!0;const n=new AbortController,a=async()=>{try{t(!0);const a=await Object(r.h)({signal:n.signal});e&&null!=a&&u({signalIndexExists:!0,signalIndexName:a.name,signalIndexMappingOutdated:a.index_mapping_outdated,createDeSignalIndex:s})}catch(t){e&&(u({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:s}),Object(i.v)(t)&&404!==t.body.status_code&&c(t,{title:o.c}))}e&&t(!1)},s=async()=>{let l=!1;try{t(!0),await Object(r.d)({signal:n.signal}),e&&(l=!0,a())}catch(t){e&&(Object(i.v)(t)&&409===t.body.status_code?a():(u({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:s}),c(t,{title:o.d})))}e&&!l&&t(!1)};return d?a():t(!1),()=>{e=!1,n.abort()}}),[c,d]),{loading:e,...n}}},,function(e,t,n){"use strict";var a=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function s(e,t){return!1!==t.clone&&t.isMergeableObject(e)?u((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function r(e,t,n){return e.concat(t).map((function(e){return s(e,n)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function l(e,t){try{return t in e}catch(e){return!1}}function u(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||r,n.isMergeableObject=n.isMergeableObject||a,n.cloneUnlessOtherwiseSpecified=s;var i=Array.isArray(t);return i===Array.isArray(e)?i?n.arrayMerge(e,t,n):function(e,t,n){var a={};return n.isMergeableObject(e)&&o(e).forEach((function(t){a[t]=s(e[t],n)})),o(t).forEach((function(i){(function(e,t){return l(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(l(e,i)&&n.isMergeableObject(t[i])?a[i]=function(e,t){if(!t.customMerge)return u;var n=t.customMerge(e);return"function"==typeof n?n:u}(i,n)(e[i],t[i],n):a[i]=s(t[i],n))})),a}(e,t,n):s(t,n)}u.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return u(e,n,t)}),{})};var c=u;e.exports=c},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(9);const i=(e,t=!1)=>{if(Array.isArray(e))return e;const n={};return Object.entries(e).forEach((([e,i])=>{const s=t&&Array.isArray(i)&&1===i.length;Object(a.merge)(n,Object(a.setWith)({},e,s?i[0]:i,Object))})),n}},function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(4);const i=`${a.jb}/prepackaged`,s=`${a.Db}/prebuilt_rules`,r=`${i}/_status`,o=`${s}/status`,l=`${s}/upgrade/_review`,u=`${s}/upgrade/_perform`,c=`${s}/installation/_review`,d=`${s}/installation/_perform`},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return E}));var a=n(17),i=n(2),s=n.n(i),r=n(44),o=n.n(r),l=n(48),u=n(113),c=n(118),d=n(112),m=n(244),p=n(228),f=n(134),b=n(292);o()(a.EuiBadge).withConfig({displayName:"NotesCountBadge",componentId:"sc-v4xtfs-0"})(["margin-left:5px;"]).displayName="NotesCountBadge";const g=({timelineId:e,compact:t})=>{const n=Object(l.useDispatch)(),r=Object(i.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),o=Object(d.b)((t=>{var n;return(null!==(n=r(t,e))&&void 0!==n?n:f.b).isFavorite})),p=Object(d.b)((t=>{var n;return(null!==(n=r(t,e))&&void 0!==n?n:f.b).status}))===u.k.immutable,g=Object(i.useCallback)((()=>n(c.a.updateIsFavorite({id:e,isFavorite:!o}))),[n,e,o]),v=o?m.j:m.b;return t?s.a.createElement(a.EuiButtonIcon,{id:b.a.ADD_TO_FAVORITES,iconType:o?"starFilled":"starEmpty",iconSize:"m",isSelected:o,onClick:g,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,disabled:p,"aria-label":v,title:v}):s.a.createElement(a.EuiButton,{id:b.a.ADD_TO_FAVORITES,isSelected:o,fill:o,iconType:o?"starFilled":"starEmpty",onClick:g,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,disabled:p,"aria-label":v,title:v},v)};g.displayName="AddToFavoritesButtonComponent";const v=s.a.memo(g),y=s.a.memo((({onClick:e,outline:t=!1,timelineId:n,title:a=m.h})=>{const{getButton:i}=Object(p.b)({timelineId:n,timelineType:u.l.default,onClick:e});return i({outline:t,title:a})}));y.displayName="NewTimeline";const h="notes-button",j=s.a.memo((({ariaLabel:e=m.i,isDisabled:t,toggleShowNotes:n,timelineType:i})=>{const r=i===u.l.template;return s.a.createElement(a.EuiButtonIcon,{"aria-label":e,className:h,"data-test-subj":"timeline-notes-button-small",disabled:t,iconType:"editorComment",onClick:n,size:"s",isDisabled:r})}));j.displayName="SmallNotesButton";const E=s.a.memo((({ariaLabel:e,isDisabled:t,showNotes:n,timelineType:i,toggleShowNotes:r,toolTip:o})=>n?s.a.createElement(j,{ariaLabel:e,isDisabled:t,toggleShowNotes:r,timelineType:i}):s.a.createElement(a.EuiToolTip,{content:o||"","data-test-subj":"timeline-notes-tool-tip"},s.a.createElement(j,{ariaLabel:e,isDisabled:t,toggleShowNotes:r,timelineType:i}))));E.displayName="NotesButton"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var a=n(23),i=n.n(a),s=n(2),r=n.n(s),o=n(48),l=n(44),u=n.n(l),c=n(595),d=n(112),m=n(138),p=n(596),f=n(119),b=n(396),g=n(47),v=n(75),y=n(17),h=n(158),j=n(110),E=n(522),O=n(212),x=n(523),S=n(524),k=n(550),w=n(198),T=n(382);const C=({callback:e})=>({id:"openInLens",getDisplayName:e=>w.m,getIconType:e=>"visArea",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},order:0}),M=({callback:e,disabled:t})=>({id:"saveToLibrary",getDisplayName:e=>w.a,getIconType:e=>"save",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:1}),I=({callback:e,disabled:t})=>({id:"addToExistingCase",getDisplayName:e=>w.c,getIconType:e=>"casesApp",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:2}),A=({callback:e,disabled:t})=>({id:"addToNewCase",getDisplayName:e=>w.d,getIconType:e=>"casesApp",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:3}),P=({callback:e,disabled:t})=>({id:"inspect",getDisplayName:e=>T.d,getIconType:e=>"inspect",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:4});var _=n(128),D=n(381),R=n(190),F=n(116),N=n(339);const L=[v.ACTION_CUSTOMIZE_PANEL],z=u.a.div.withConfig({displayName:"LensComponentWrapper",componentId:"sc-1ajgxgj-0"})(["height:",";width:",";"," .embPanel__header{z-index:2;position:absolute;right:0;}.expExpressionRenderer__expression{padding:2px 0 0 0 !important;}.legacyMtrVis__container{padding:0;}"],(({$height:e})=>e?`${e}px`:"auto"),(({width:e})=>null!=e?e:"auto"),(({$addHoverActionsPadding:e})=>e?".embPanel__header { top: -24px; }":"")),B={requests:void 0,responses:void 0,isLoading:!0},q=({applyGlobalQueriesAndFilters:e=!0,extraActions:t,extraOptions:n,getLensAttributes:a,height:i,id:l,inputsModelId:u=f.a.global,inspectTitle:c,lensAttributes:m,onLoad:p,scopeId:b=F.SourcererScopeName.default,stackByField:w,timerange:T,width:q,withActions:$=!0,disableOnClickFilter:U=!1})=>{var Q,H,G,W;const K=Object(s.useMemo)((()=>({height:null!=i?i:"100%",minWidth:"100px",width:null!=q?q:"100%"})),[i,q]),{lens:J,data:{actions:{createFiltersFromValueClickAction:Y}}}=Object(j.i)().services,X=Object(o.useDispatch)(),[Z,ee]=Object(s.useState)(!1),[te,ne]=Object(s.useState)(B),ae=_.d.globalQueryByIdSelector(),{searchSessionId:ie}=Object(d.a)((e=>ae(e,l))),se=Object(E.a)({applyGlobalQueriesAndFilters:e,extraOptions:n,getLensAttributes:a,lensAttributes:m,scopeId:b,stackByField:w,title:""}),re=null==se||null===(Q=se.state)||void 0===Q||null===(H=Q.visualization)||void 0===H?void 0:H.preferredSeriesType,oe="lnsLegacyMetric"!==(null==se?void 0:se.visualizationType)&&"lnsPie"!==(null==se?void 0:se.visualizationType),le=J.EmbeddableComponent,ue=Object(s.useMemo)((()=>({onInspectActionClicked:()=>{ee(!0)},isDisabled:te.isLoading})),[te.isLoading]),ce=(({attributes:e,extraActions:t,inspectActionProps:n,timeRange:a,withActions:i})=>{const{lens:r}=Object(O.b)().services,{navigateToPrefilledEditor:o}=r,[l,u]=Object(s.useState)(["inspect","addToNewCase","addToExistingCase","saveToLibrary","openInLens"]);Object(s.useEffect)((()=>{!1===i&&u([])}),[i]);const c=Object(s.useCallback)((()=>{a&&e&&o({id:"",timeRange:a,attributes:e},{openInNewTab:!0})}),[e,o,a]),{disabled:d,onAddToExistingCaseClicked:m}=Object(x.a)({lensAttributes:e,timeRange:a}),{onAddToNewCaseClicked:p,disabled:f}=Object(S.a)({timeRange:a,lensAttributes:e}),{openSaveVisualizationFlyout:b,disableVisualizations:g}=Object(k.a)({attributes:e});return Object(s.useMemo)((()=>null==l?void 0:l.reduce(((e,t)=>"inspect"===t&&null!=n?[...e,P({callback:null==n?void 0:n.onInspectActionClicked,disabled:null==n?void 0:n.isDisabled})]:"addToExistingCase"===t?[...e,I({callback:m,disabled:d})]:"addToNewCase"===t?[...e,A({callback:p,disabled:f})]:"openInLens"===t?[...e,C({callback:c})]:"saveToLibrary"===t?[...e,M({callback:b,disabled:g})]:e),[])),[l,n,m,d,p,f,c,b,g]).concat(null!=t?t:[]).map(((e,t,n)=>({...e,order:Math.max(n.length-(1+t),0)})))})({attributes:se,extraActions:t,inspectActionProps:ue,timeRange:T,withActions:$}),de=Object(s.useCallback)((()=>{ee(!1)}),[]),me=Object(s.useCallback)((({range:e})=>{const[t,n]=e;X(Object(h.setAbsoluteRangeDatePicker)({id:u,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[X,u]),pe=Object(s.useMemo)((()=>{var e;const[t,...n]=null!==(e=te.requests)&&void 0!==e?e:[];return{request:t,additionalRequests:n}}),[te.requests]),fe=Object(s.useMemo)((()=>{var e;const[t,...n]=null!==(e=te.responses)&&void 0!==e?e:[];return{response:t,additionalResponses:n}}),[te.responses]),be=Object(s.useCallback)(((e,t)=>{var n;if(!t)return;const a=Object(R.f)(null==t||null===(n=t.requests)||void 0===n?void 0:n.getRequests());ne({requests:a.requests,responses:a.responses,isLoading:e}),null!=p&&p({requests:a.requests,responses:a.responses,isLoading:e})}),[p]),ge=Object(s.useCallback)((()=>async e=>{if(!V(e)||"area"!==re||U)return void e.preventDefault();const[{query:t}]=await Y({data:e.data,negate:e.negate}),n=null==t?void 0:t.range["@timestamp"];null!=n&&n.gte&&null!=n&&n.lt&&me({range:[n.gte,n.lt]})}),[Y,me,re,U]),ve=Object(s.useMemo)((()=>{var e,t;return null!=(null==se||null===(e=se.state)||void 0===e?void 0:e.adHocDataViews)?Object.values(null==se||null===(t=se.state)||void 0===t?void 0:t.adHocDataViews).reduce(((e,t)=>(null!=(null==t?void 0:t.name)&&e.push(null==t?void 0:t.name),e)),[]):null}),[null==se||null===(G=se.state)||void 0===G?void 0:G.adHocDataViews]);return ie?!se||null!=(null==te?void 0:te.responses)&&0===(null==te||null===(W=te.responses)||void 0===W?void 0:W.length)?r.a.createElement(y.EuiFlexGroup,null,r.a.createElement(y.EuiFlexItem,{grow:1},r.a.createElement(y.EuiEmptyPrompt,{body:r.a.createElement(y.EuiText,{size:"xs"},r.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.lensEmbeddable.NoDataToDisplay.title",defaultMessage:"No data to display"}))})),r.a.createElement(y.EuiFlexItem,{grow:!1},r.a.createElement(N.a,{extraActions:t,getLensAttributes:a,inputId:u,isInspectButtonDisabled:!0,lensAttributes:se,queryId:l,stackByField:w,timerange:T,title:c,withDefaultActions:!1}))):r.a.createElement(r.a.Fragment,null,se&&ie&&r.a.createElement(z,{$height:i,width:q,$addHoverActionsPadding:oe},r.a.createElement(le,{id:l,style:K,timeRange:T,attributes:se,disabledActions:L,onLoad:be,onBrushEnd:me,onFilter:ge,viewMode:v.ViewMode.VIEW,withDefaultActions:!1,extraActions:ce,searchSessionId:ie,showInspector:!1,syncTooltips:!1,syncCursor:!1})),Z&&null!=pe.request&&null!=fe.response&&r.a.createElement(D.a,{adHocDataViews:ve,additionalRequests:pe.additionalRequests,additionalResponses:fe.additionalResponses,closeModal:de,"data-test-subj":"inspect-modal",inputId:u,request:pe.request,response:fe.response,title:c})):null},V=e=>Array.isArray(e.data)&&"column"in e.data[0],$=r.a.memo(q);var U=n(121),Q=n(347);const H=e=>{var t,n;const a=Object(o.useDispatch)(),{inputId:u=f.a.global,id:g,isDonut:v,label:y,donutTextWrapperClassName:h,onLoad:j,...E}=e,{session:O,refetchByRestartingSession:x,refetchByDeletingSession:S}=Object(b.a)({inputId:u,queryId:g}),{indicesExist:k}=Object(U.d)(E.scopeId),w=Object(s.useRef)(E.timerange),T=m.d.globalQueryByIdSelector(),{searchSessionId:C}=Object(d.a)((e=>T(e,g))),M=Object(Q.a)({visualizationId:g}),I=null!=M&&0!==(null===(t=M[0])||void 0===t||null===(n=t.hits)||void 0===n?void 0:n.total),A=I?Object(l.css)(["top:40%;right:12%;"]):Object(l.css)(["top:66%;right:12%;"]),P=Object(s.useCallback)((({requests:e,responses:t,isLoading:n})=>{a(m.b.setQuery({inputId:u,id:g,searchSessionId:O.current.start(),refetch:x,loading:n,inspect:{dsl:e,response:t}})),"function"==typeof j&&j({requests:e,responses:t,isLoading:n})}),[a,u,g,O,x,j]);return Object(s.useEffect)((()=>{var e,t;(!k&&(null===(e=w.current)||void 0===e?void 0:e.from)!==E.timerange.from||(null===(t=w.current)||void 0===t?void 0:t.to)!==E.timerange.to)&&(w.current=E.timerange,a(m.b.deleteOneQuery({inputId:u,id:g})))}),[a,g,k,u,E.timerange]),Object(s.useEffect)((()=>{C||setTimeout((()=>{a(m.b.setQuery({inputId:u,id:g,searchSessionId:O.current.start(),refetch:I?x:S,loading:!1,inspect:null}))}),200)}),[a,u,g,O,I,x,C,S]),Object(s.useEffect)((()=>()=>{a(m.b.deleteOneQuery({inputId:u,id:g}))}),[a,g,u]),(E.getLensAttributes||E.lensAttributes)&&E.timerange?v?r.a.createElement(p.b,{isChartEmbeddablesEnabled:!0,dataExists:I,label:y,title:I?r.a.createElement(c.a,{count:null===(_=M[0])||void 0===_||null===(D=_.hits)||void 0===D?void 0:D.total}):null,donutTextWrapperClassName:h,donutTextWrapperStyles:A},r.a.createElement($,i()({},E,{id:g,onLoad:P}))):r.a.createElement($,i()({},E,{id:g,onLoad:P})):null;var _,D},G=r.a.memo(H)},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(184);const s=()=>{const{startTransaction:e}=Object(i.b)();return{startTracking:Object(a.useCallback)((({name:t,spanName:n="fetch"})=>{const a=e({name:t,type:"http-request",options:{managed:!1}}),i=null==a?void 0:a.startSpan(n,"http-request",{blocking:!0});return{endTracking:e=>{null==a||a.addLabels({result:e}),null==i||i.end()}}}),[e])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={refetchIntervalInBackground:!1,staleTime:3e5}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(17),i=n(2),s=n.n(i),r=n(44),o=n.n(r),l=n(119),u=n(212),c=n(381),d=n(465),m=n(522),p=n(523),f=n(524),b=n(550),g=n(198),v=n(190),y=n(116),h=n(117);const j=o.a.div.withConfig({displayName:"Wrapper",componentId:"sc-9cci34-0"})(["&.viz-actions{position:absolute;top:0;right:0;z-index:1;}&.histogram-viz-actions{padding:",";}"],(({theme:e})=>e.eui.euiSizeS)),E=({applyGlobalQueriesAndFilters:e=!0,className:t,extraActions:n,extraOptions:r,getLensAttributes:o,inputId:E=l.a.global,inspectIndex:O=0,isInspectButtonDisabled:x,isMultipleQuery:S,lensAttributes:k,onCloseInspect:w,queryId:T,timerange:C,title:M,scopeId:I=y.SourcererScopeName.default,stackByField:A,withDefaultActions:P=!0})=>{const{lens:_}=Object(u.b)().services,{canUseEditor:D,navigateToPrefilledEditor:R,SaveModalComponent:F}=_,[N,L]=Object(i.useState)(!1),[z,B]=Object(i.useState)(!1),[q,V]=Object(i.useState)(!1),{addSuccess:$}=Object(h.a)(),U=Object(i.useCallback)((()=>{V(!1),$(g.a)}),[$]),Q=Object(i.useCallback)((()=>{V(!1)}),[]),H=D(),G=Object(i.useCallback)((()=>{L(!N)}),[N]),W=()=>{L(!1)},K=Object(m.a)({applyGlobalQueriesAndFilters:e,extraOptions:r,getLensAttributes:o,lensAttributes:k,scopeId:I,stackByField:A,title:""}),J=`stat-${T}`,{disabled:Y,onAddToExistingCaseClicked:X}=Object(p.a)({onAddToCaseClicked:W,lensAttributes:K,timeRange:C}),{onAddToNewCaseClicked:Z,disabled:ee}=Object(f.a)({onClick:W,timeRange:C,lensAttributes:K}),te=Object(i.useCallback)((()=>{W(),C&&K&&R({id:"",timeRange:C,attributes:K},{openInNewTab:!0})}),[K,R,C]),{openSaveVisualizationFlyout:ne,disableVisualizations:ae}=Object(b.a)({attributes:K}),ie=Object(i.useCallback)((()=>{W(),B(!0)}),[]),se=Object(i.useCallback)((()=>{B(!1),w&&w()}),[w]),{additionalRequests:re,additionalResponses:oe,handleClick:le,handleCloseModal:ue,isButtonDisabled:ce,request:de,response:me}=Object(d.a)({inputId:E,inspectIndex:O,isDisabled:x,multiple:S,onCloseInspect:se,onClick:ie,queryId:T}),pe=Object(i.useMemo)((()=>{var e;const t={};return[...(null!==(e=null==n?void 0:n.map((e=>s.a.createElement(a.EuiContextMenuItem,{icon:null==e?void 0:e.getIconType(t),key:e.id,onClick:()=>e.execute(t),"data-test-subj":`viz-actions-${e.id}`},e.getDisplayName(t)))))&&void 0!==e?e:[])||[],...P?[s.a.createElement(a.EuiContextMenuItem,{icon:"inspect",key:"visualizationActionsInspect",onClick:le,disabled:ce,"data-test-subj":"viz-actions-inspect"},g.k),s.a.createElement(a.EuiContextMenuItem,{disabled:ee,icon:"plusInCircle",key:"visualizationActionsAddToNewCase",onClick:Z,"data-test-subj":"viz-actions-add-to-new-case"},g.d),s.a.createElement(a.EuiContextMenuItem,{disabled:Y,"data-test-subj":"viz-actions-add-to-existing-case",icon:"plusInCircle",key:"visualizationActionsAddToExistingCase",onClick:X},g.c),...H?[s.a.createElement(a.EuiContextMenuItem,{icon:"visArea",key:"visualizationActionsSaveVisualization","data-test-subj":"viz-actions-save-visualization",disabled:ae,onClick:ne},g.a)]:[],s.a.createElement(a.EuiContextMenuItem,{icon:"visArea",key:"visualizationActionsOpenInLens","data-test-subj":"viz-actions-open-in-lens",disabled:ae,onClick:te},g.m)]:[]]}),[H,ce,ae,n,le,Y,ee,X,Z,te,ne,P]),fe=Object(i.useMemo)((()=>s.a.createElement(a.EuiButtonIcon,{"aria-label":g.l,className:v.a,"data-test-subj":J,iconType:"boxesHorizontal",onClick:G})),[J,G]);return s.a.createElement(j,{className:t},pe.length>0&&s.a.createElement(a.EuiPopover,{button:fe,isOpen:N,closePopover:W,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover","data-test-subj":"viz-actions-popover"},s.a.createElement(a.EuiContextMenuPanel,{"data-test-subj":"viz-actions-panel",size:"s",items:pe})),z&&null!==de&&null!==me&&s.a.createElement(c.a,{additionalRequests:re,additionalResponses:oe,closeModal:ue,inputId:E,request:de,response:me,title:M}),q&&H&&s.a.createElement(F,{initialInput:K,onSave:U,onClose:Q}))};E.displayName="VisualizationActionsComponent";const O=s.a.memo(E)},,function(e,t,n){"use strict";n.d(t,"d",(function(){return g.d})),n.d(t,"a",(function(){return g.a})),n.d(t,"f",(function(){return g.f})),n.d(t,"c",(function(){return g.c})),n.d(t,"e",(function(){return g.e})),n.d(t,"b",(function(){return g.b}));var a=n(111);a.z.object({rules_custom_installed:a.z.number().int().min(0),rules_installed:a.z.number().int().min(0),rules_not_installed:a.z.number().int().min(0),rules_not_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_not_installed:a.z.number().int().min(0),timelines_not_updated:a.z.number().int().min(0)}).strict(),a.z.object({rules_installed:a.z.number().int().min(0),rules_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_updated:a.z.number().int().min(0)}).strict();var i=n(46);const s=i.exact(i.type({rule_id:i.string,version:i.number})),r=i.exact(i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(s)})),o=i.exact(i.type({mode:i.literal("ALL_RULES")}));let l;i.union([o,r]),function(e){e.ALREADY_INSTALLED="ALREADY_INSTALLED"}(l||(l={}));var u=n(120);let c;!function(e){e.BASE="BASE",e.CURRENT="CURRENT",e.TARGET="TARGET"}(c||(c={}));const d=Object(u.r)("PickVersionValues",c),m=i.exact(i.intersection([i.type({rule_id:i.string,revision:i.number,version:i.number}),i.partial({pick_version:d})])),p=i.exact(i.intersection([i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(m)}),i.partial({pick_version:d})])),f=i.exact(i.intersection([i.type({mode:i.literal("ALL_RULES")}),i.partial({pick_version:d})]));let b;i.union([f,p]),function(e){e.RULE_UP_TO_DATE="RULE_UP_TO_DATE"}(b||(b={}));var g=n(326),v=n(278);const y=e=>i.intersection([i.exact(i.type(e.required)),i.exact(i.type(Object(v.N)(e.optional)))]);var h=n(273);let j;!function(e){e.index_patterns="index_patterns",e.data_view="data_view"}(j||(j={}));const E=i.exact(i.type({type:i.literal(j.index_patterns),index_patterns:v.g})),O=i.exact(i.type({type:i.literal(j.data_view),data_view_id:v.c})),x=i.union([E,O]);let S;!function(e){e.inline_query="inline_query",e.saved_query="saved_query"}(S||(S={}));const k=i.exact(i.type({type:i.literal(S.inline_query),query:v.w,language:v.i,filters:v.q})),w=i.exact(i.type({type:i.literal(S.saved_query),saved_query_id:h.e})),T=i.union([k,w]),C=i.exact(i.type({query:v.w,language:i.literal("eql"),filters:v.q})),M=i.exact(i.type({query:v.w,language:i.literal("esql")})),I=i.exact(i.type({interval:Object(u.p)({allowedUnits:["s","m","h"]}),lookback:Object(u.p)({allowedUnits:["s","m","h"]})})),A=i.exact(i.type({field_name:v.u})),P=i.exact(i.type({field_name:v.L,fallback_disabled:v.M})),_=i.exact(i.type({timeline_id:v.I,timeline_title:v.J})),D=i.exact(i.type({type:v.b}));var R=n(277);const F=y({required:{rule_id:v.y,version:v.A,meta:v.s,name:v.t,tags:v.z,description:v.o,severity:R.h,severity_mapping:R.i,risk_score:R.a,risk_score_mapping:R.b,references:v.x,false_positives:v.p,threat:v.F,note:v.h,setup:v.E,related_integrations:v.l,required_fields:v.m,author:v.n,license:v.r,rule_schedule:I,actions:R.c,throttle:R.d,exceptions_list:v.e,max_signals:v.j},optional:{rule_name_override:A,timestamp_override:P,timeline_template:_,building_block:D}}),N=y({required:{type:i.literal("query"),kql_query:T},optional:{data_source:x,alert_suppression:v.a}}),L=y({required:{type:i.literal("saved_query"),kql_query:T},optional:{data_source:x,alert_suppression:v.a}}),z=y({required:{type:i.literal("eql"),eql_query:C},optional:{data_source:x,event_category_override:v.d,timestamp_field:v.K,tiebreaker_field:v.H}}),B=y({required:{type:i.literal("esql"),esql_query:M},optional:{}}),q=y({required:{type:i.literal("threat_match"),kql_query:T,threat_query:k,threat_index:R.q,threat_mapping:R.s},optional:{data_source:x,threat_indicator_path:R.r,concurrent_searches:R.j,items_per_search:R.k}}),V=y({required:{type:i.literal("threshold"),kql_query:T,threshold:v.G},optional:{data_source:x}}),$=y({required:{type:i.literal("machine_learning"),machine_learning_job_id:R.l,anomaly_threshold:h.c},optional:{}}),U=y({required:{type:i.literal("new_terms"),kql_query:k,new_terms_fields:v.k,history_window_start:v.f},optional:{data_source:x}});let Q,H;i.intersection([F,i.union([N,L,z,B,q,V,$,U])]),n(9),Symbol("MissingVersion"),function(e){e.StockValueNoUpdate="BASE=A, CURRENT=A, TARGET=A",e.StockValueCanUpdate="BASE=A, CURRENT=A, TARGET=B",e.CustomizedValueNoUpdate="BASE=A, CURRENT=B, TARGET=A",e.CustomizedValueSameUpdate="BASE=A, CURRENT=B, TARGET=B",e.CustomizedValueCanUpdate="BASE=A, CURRENT=B, TARGET=C"}(Q||(Q={})),function(e){e.Current="CURRENT",e.Target="TARGET",e.Merged="MERGED",e.Conflict="CONFLICT"}(H||(H={}))},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(190),s=n(112),r=n(128);const o=({visualizationId:e})=>{const t=r.d.globalQueryByIdSelector(),{inspect:n}=Object(s.a)((n=>t(n,e)));return Object(a.useMemo)((()=>n?Object(i.g)(null==n?void 0:n.response):null),[n])}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(17),i=n(345),s=n(2),r=n.n(s),o=n(44),l=n.n(o),u=n(61),c=n.n(u),d=n(4),m=n(166),p=n(110),f=n(293),b=n(226);const g=l()(a.EuiFlexItem).withConfig({displayName:"CountFlexItem",componentId:"sc-1yje3m6-0"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeS};`)),v=r.a.memo((({value:e})=>Object(b.a)(e)?r.a.createElement(r.a.Fragment,null,e):r.a.createElement("em",{"data-test-subj":"value-wrapper-empty"},f.c)));v.displayName="ValueWrapper";const y=({legendItem:e})=>{const[t]=Object(p.o)(d.P),{color:n,count:i,dataProviderId:s,field:o,scopeId:l,value:u}=e;return r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=n&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiHealth,{"data-test-subj":"legend-color",color:n})),r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(m.b,{"data-test-subj":`legend-item-${s}`,field:o,hideTopN:!0,id:s,isDraggable:!1,scopeId:l,value:u},null==e.render?r.a.createElement(v,{value:u}):e.render({field:o,value:u}))),null!=i&&r.a.createElement(g,{"data-test-subj":"legendItemCount",grow:!1},c()(i).format(t))))))};y.displayName="DraggableLegendItemComponent";const h=r.a.memo(y),j=l.a.div.withConfig({displayName:"DraggableLegendContainer",componentId:"sc-94chus-0"})(["height:",";overflow:auto;scrollbar-width:thin;width:100%;@media only screen and (min-width:","){width:165px;}min-width:",";&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({height:e})=>`${e}px`),(({theme:e})=>e.eui.euiBreakpoints.m),(({$minWidth:e})=>`${e}px`),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),E=({className:e,height:t=0,legendItems:n,minWidth:i=165})=>0===n.length?null:r.a.createElement(j,{className:e,"data-test-subj":"draggable-legend",height:0===t?175:t,$minWidth:i},r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},n.map((e=>r.a.createElement(a.EuiFlexItem,{key:e.dataProviderId,grow:!1},r.a.createElement(h,{legendItem:e}),r.a.createElement(a.EuiSpacer,{"data-test-subj":"draggable-legend-spacer",size:"s"})))))));E.displayName="DraggableLegendComponent";const O=r.a.memo(E)},,,,,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return x}));var a=n(65),i=n.n(a),s=n(17),r=n(45),o=n(2),l=n.n(o),u=n(48),c=n(136),d=n.n(c),m=n(581),p=n(4),f=n(118),b=n(110),g=n(181),v=n(119),y=n(361);const h={fill:!1},j=l.a.memo((({duration:e,end:t,fromStr:n,id:a,isLoading:i,kqlQuery:u,policy:c,queries:d,setDuration:m,showUpdateButton:f=!0,start:g,startAutoReload:v,stopAutoReload:y,timelineId:j,toStr:O,updateReduxTime:x,disabled:S,width:k="restricted",compressed:w=!1})=>{const[T,C]=Object(o.useState)([]),M=Object(o.useCallback)((({start:e,end:n})=>{const i=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:s}=x({end:n,id:a,isInvalid:!1,isQuickSelection:i,kql:u,start:e,timelineId:j,hasRangeChanged:!1}),r=E(e),o=i?E(n,{roundUp:!0}):E(n);!d||s||i&&(g!==r||t!==o)||A(d)}),[t,a,u,d,g,j,x]),I=Object(o.useCallback)((({isPaused:t,refreshInterval:i})=>{const s=null!=n&&n.includes("now")||null!=O&&O.includes("now");e!==i&&m({id:a,duration:i}),t&&"interval"===c?y({id:a}):t||"manual"!==c||v({id:a}),d&&!t&&(!s||s&&"now"!==O)&&A(d)}),[n,O,e,c,m,a,y,v,d]),A=e=>{e.forEach((e=>e.refetch&&e.refetch()))},P=Object(o.useCallback)((({start:e,end:t,isInvalid:n})=>{const i=e.includes("now")||t.includes("now");if(!n){x({end:t,id:a,isInvalid:n,isQuickSelection:i,kql:u,start:e,timelineId:j,hasRangeChanged:!0});const s=[{start:e,end:t},...Object(r.take)(9,T.filter((n=>!(n.start===e&&n.end===t))))];C(s)}}),[x,a,u,j,T]),_=null!=O?O:new Date(t).toISOString(),D=null!=n?n:new Date(g).toISOString(),[R]=Object(b.o)(p.W),F=Object(r.isEmpty)(R)?[]:R.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return l.a.createElement(s.EuiSuperDatePicker,{commonlyUsedRanges:F,end:_,isLoading:i,isPaused:"manual"===c,onRefresh:M,onRefreshChange:I,onTimeChange:P,recentlyUsedRanges:T,refreshInterval:e,showUpdateButton:f,start:D,isDisabled:S,width:k,compressed:w,updateButtonProps:h})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),E=(e,t)=>{const n=i.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},O=e=>({end:t,id:n,isQuickSelection:a,kql:i,start:s,timelineId:r,hasRangeChanged:o})=>{const l=E(s);let u=E(t,{roundUp:!0});var c;return a?e(t===s?g.c.setAbsoluteRangeDatePicker({id:n,fromStr:s,toStr:t,from:l,to:u}):g.c.setRelativeRangeDatePicker({id:n,fromStr:s,toStr:t,from:l,to:u})):(u=E(t),e(g.c.setAbsoluteRangeDatePicker({id:n,from:E(s),to:E(t)}))),null!=r&&o&&e(f.a.updateRange({id:r,start:l,end:u})),i&&i.refetch?{kqlHaveBeenUpdated:null!==(c=i.refetch(e))&&void 0!==c&&c}:{kqlHaveBeenUpdated:!1}};j.displayName="SuperDatePickerComponent";const x=Object(u.connect)((()=>{const e=Object(y.a)(),t=Object(y.b)(),n=Object(y.c)(),a=Object(y.d)(),i=Object(y.e)(),s=Object(y.f)(),o=Object(y.g)(),l=Object(y.h)(),u=Object(y.i)(),c=Object(y.j)();return(d,{id:p})=>{const f=Object(r.getOr)({},`inputs.${p}`,d);return{duration:e(f),end:t(f),fromStr:n(f),kind:i(f),policy:o(f),start:u(f),toStr:c(f),isLoading:!1,...Object(m.c)(f)&&(p===v.a.timeline||p===v.a.global)&&{isLoading:a(f),kqlQuery:s(f),queries:l(d,p)}}}}),(e=>({startAutoReload:({id:t})=>e(g.c.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(g.c.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(g.c.setDuration({id:t,duration:n})),updateReduxTime:O(e)})))(j)},function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"j",(function(){return g})),n.d(t,"d",(function(){return v})),n.d(t,"h",(function(){return y})),n.d(t,"f",(function(){return h}));var a=n(9),i=n(57),s=n(119);const r=e=>e.policy,o=e=>e.timerange,l=e=>e.queries,u=(e,t)=>{const n=e.inputs[t];return Object(a.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>{if(n===s.a.socTrends)return t;const a=e.inputs[n];return[...t,...a.queries]}),n.queries)},c=()=>Object(i.createSelector)(r,(e=>e.kind)),d=()=>Object(i.createSelector)(r,(e=>e.duration)),m=()=>Object(i.createSelector)(o,(e=>e.kind)),p=()=>Object(i.createSelector)(o,(e=>e.from)),f=()=>Object(i.createSelector)(o,(e=>e.to)),b=()=>Object(i.createSelector)(o,(e=>e.fromStr)),g=()=>Object(i.createSelector)(o,(e=>e.toStr)),v=()=>Object(i.createSelector)(l,(e=>e.some((e=>!0===e.loading)))),y=()=>Object(i.createSelector)(u,(e=>e.filter((e=>"kql"!==e.id)))),h=()=>Object(i.createSelector)(l,(e=>e.find((e=>"kql"===e.id))))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return b}));var a=n(111);const i=a.z.enum([".osquery",".endpoint"]),s=i.enum,r=a.z.object({}).catchall(a.z.object({field:a.z.string().optional(),value:a.z.union([a.z.string(),a.z.array(a.z.string())]).optional()})),o=a.z.object({id:a.z.string(),query:a.z.string(),ecs_mapping:r.optional(),version:a.z.string().optional(),platform:a.z.string().optional(),removed:a.z.boolean().optional(),snapshot:a.z.boolean().optional()}),l=a.z.object({query:a.z.string().optional(),ecs_mapping:r.optional(),queries:a.z.array(o).optional(),pack_id:a.z.string().optional(),saved_query_id:a.z.string().optional(),timeout:a.z.number().optional()}),u=a.z.object({query:a.z.string().optional(),ecsMapping:r.optional(),queries:a.z.array(o).optional(),packId:a.z.string().optional(),savedQueryId:a.z.string().optional(),timeout:a.z.number().optional()}),c=a.z.object({action_type_id:a.z.literal(".osquery"),params:l}),d=a.z.object({actionTypeId:a.z.literal(".osquery"),params:u}),m=a.z.object({command:a.z.literal("isolate"),comment:a.z.string().optional()}),p=a.z.object({action_type_id:a.z.literal(".endpoint"),params:m}),f=a.z.object({actionTypeId:a.z.literal(".endpoint"),params:m}),b=a.z.union([c,p]);a.z.union([d,f])},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(111),i=n(219),s=n(364);const r=a.z.object({last_execution:a.z.object({date:a.z.string().datetime(),status:i.a,status_order:i.c,message:a.z.string(),metrics:s.a})})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(111);const i=a.z.object({total_search_duration_ms:a.z.number().int().min(0).optional(),total_indexing_duration_ms:a.z.number().int().min(0).optional(),total_enrichment_duration_ms:a.z.number().int().min(0).optional(),execution_gap_duration_s:a.z.number().int().min(0).optional()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return r}));var a=n(111);const i=a.z.string(),s=a.z.string(),r=a.z.string()},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(111),i=n(141);const s=a.z.array(a.z.object({field:a.z.string(),value:a.z.number().int().min(0)})),r=a.z.number().int().min(1),o=a.z.union([a.z.string(),a.z.array(a.z.string())]),l=a.z.array(a.z.string()),u=a.z.object({field:o,value:r,cardinality:s.optional()}),c=(a.z.object({field:l,value:r,cardinality:s.optional()}),a.z.object({field:l,value:r,cardinality:s}),a.z.object({duration:i.a}))},function(e,t,n){"use strict";n.d(t,"g",(function(){return s})),n.d(t,"f",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(111),i=n(141);const s=a.z.string(),r=a.z.array(a.z.object({entries:a.z.array(a.z.object({field:i.m,type:a.z.literal("mapping"),value:i.m}))})).min(1),o=a.z.array(a.z.string()),l=a.z.array(a.z.unknown()),u=a.z.string(),c=a.z.number().int().min(1),d=a.z.number().int().min(1)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var a=n(111);const i=a.z.number().int().min(0),s=a.z.union([a.z.string(),a.z.array(a.z.string()).min(1)])},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return r}));var a=n(111),i=n(141);const s=a.z.array(a.z.string()).min(1).max(3),r=i.m},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(111);const i=a.z.number().int().min(1),s=a.z.number().int().min(0),r=a.z.object({page:i,per_page:s,total:a.z.number().int().min(0)})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(111);const i=a.z.object({type:a.z.string(),message:a.z.string(),actionPath:a.z.string(),buttonLabel:a.z.string().optional()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="xs"},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return l}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addSystemPromptTooltip",{defaultMessage:"Add system prompt"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.clearSystemPrompt",{defaultMessage:"Clear system prompt"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.selectASystemPromptPlaceholder",{defaultMessage:"Select a system prompt"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addNewSystemPrompt",{defaultMessage:"Add new system prompt..."}),l=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.emptyPrompt",{defaultMessage:"(empty prompt)"})},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return u}));var a=n(549);const i=e=>{const{response:t,isStream:n,isError:a}=e,i=(new Date).toLocaleString();return e?{role:"assistant",...n?{reader:t}:{content:t},timestamp:i,isError:a,traceData:e.traceData}:{role:"assistant",content:"Error: Response from LLM API is empty or undefined.",timestamp:i,isError:!0}},s=(e,t)=>t?{...e,messages:[...e.messages,...a.a.messages]}:0===e.messages.length||e.messages[e.messages.length-1].content!==a.b[0].content?{...e,messages:[...e.messages,...a.b]}:e,r=e=>1===(null==e?void 0:e.length)?e[0]:void 0,o=e=>{const t=e.match(/```json\n([\s\S]+)\n```/);if(t)try{var n;return null!==(n=JSON.parse(t[1]).action_input)&&void 0!==n?n:e}catch{}return e},l=({alerts:e,alertsIndexPattern:t,allow:n,allowReplacement:a,replacements:i,size:s})=>e?{...t?{alertsIndexPattern:t}:void 0,...n?{allow:n}:void 0,...a?{allowReplacement:a}:void 0,...i?{replacements:i}:void 0,...s?{size:s}:void 0}:{},u=({alerts:e,assistantLangChain:t})=>t||e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){var i=a.useRef(void 0);i.current&&n(t,i.current)||(i.current=t),a.useEffect(e,i.current)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef(!1),i=a.useRef(),s=a.useRef(e),r=a.useCallback((function(){return n.current}),[]),o=a.useCallback((function(){n.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){n.current=!0,s.current()}),t)}),[t]),l=a.useCallback((function(){n.current=null,i.current&&clearTimeout(i.current)}),[]);return a.useEffect((function(){s.current=e}),[e]),a.useEffect((function(){return o(),l}),[t]),[r,l,o]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(18),i=n(110),s=n(4);const r=()=>{var e,t,n,r,o;const l=Object(a.b)().isEnterprise(),u=Object(i.i)().services.application.capabilities,c=!0===(null===(e=u[s.n])||void 0===e?void 0:e["ai-assistant"]),d=!0===(null===(t=u.actions)||void 0===t?void 0:t.show)&&!0===(null===(n=u.actions)||void 0===n?void 0:n.execute);return{hasAssistantPrivilege:c,hasConnectorsAllPrivilege:d&&!0===(null===(r=u.actions)||void 0===r?void 0:r.delete)&&!0===(null===(o=u.actions)||void 0===o?void 0:o.save),hasConnectorsReadPrivilege:d,isAssistantEnabled:l}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=(a=n(2))&&"object"==typeof a&&"default"in a?a:{default:a},s=e=>"checkbox"===e.type,r=e=>e instanceof Date,o=e=>null==e;const l=e=>"object"==typeof e;var u=e=>!o(e)&&!Array.isArray(e)&&l(e)&&!r(e),c=e=>u(e)&&e.target?s(e.target)?e.target.checked:e.target.value:e,d=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),m="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function p(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(m&&(e instanceof Blob||e instanceof FileList)||!n&&!u(e))return e;if(t=n?[]:{},n||(e=>{const t=e.constructor&&e.constructor.prototype;return u(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)e.hasOwnProperty(n)&&(t[n]=p(e[n]));else t=e}return t}var f=e=>Array.isArray(e)?e.filter(Boolean):[],b=e=>void 0===e,g=(e,t,n)=>{if(!t||!u(e))return n;const a=f(t.split(/[,[\].]+?/)).reduce(((e,t)=>o(e)?e:e[t]),e);return b(a)||a===e?b(e[t])?n:e[t]:a};const v="blur",y="focusout",h="change",j="onChange",E="onSubmit",O="all",x="pattern",S="required",k=i.default.createContext(null),w=()=>i.default.useContext(k);var T=(e,t,n,a=!0)=>{const i={defaultValues:t._defaultValues};for(const s in e)Object.defineProperty(i,s,{get:()=>{const i=s;return t._proxyFormState[i]!==O&&(t._proxyFormState[i]=!a||O),n&&(n[i]=!0),e[i]}});return i},C=e=>u(e)&&!Object.keys(e).length,M=(e,t,n,a)=>{n(e);const{name:i,...s}=e;return C(s)||Object.keys(s).length>=Object.keys(t).length||Object.keys(s).find((e=>t[e]===(!a||O)))},I=e=>Array.isArray(e)?e:[e],A=(e,t,n)=>n&&t?e===t:!e||!t||e===t||I(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function P(e){const t=i.default.useRef(e);t.current=e,i.default.useEffect((()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}}),[e.disabled])}function _(e){const t=w(),{control:n=t.control,disabled:a,name:s,exact:r}=e||{},[o,l]=i.default.useState(n._formState),u=i.default.useRef(!0),c=i.default.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=i.default.useRef(s);return d.current=s,P({disabled:a,next:e=>u.current&&A(d.current,e.name,r)&&M(e,c.current,n._updateFormState)&&l({...n._formState,...e}),subject:n._subjects.state}),i.default.useEffect((()=>(u.current=!0,c.current.isValid&&n._updateValid(!0),()=>{u.current=!1})),[n]),T(o,n,c.current,!1)}var D=e=>"string"==typeof e,R=(e,t,n,a,i)=>D(e)?(a&&t.watch.add(e),g(n,e,i)):Array.isArray(e)?e.map((e=>(a&&t.watch.add(e),g(n,e)))):(a&&(t.watchAll=!0),n);function F(e){const t=w(),{control:n=t.control,name:a,defaultValue:s,disabled:r,exact:o}=e||{},l=i.default.useRef(a);l.current=a,P({disabled:r,subject:n._subjects.values,next:e=>{A(l.current,e.name,o)&&c(p(R(l.current,n._names,e.values||n._formValues,!1,s)))}});const[u,c]=i.default.useState(n._getWatch(a,s));return i.default.useEffect((()=>n._removeUnmounted())),u}var N=e=>/^\w*$/.test(e),L=e=>f(e.replace(/["|']|\]/g,"").split(/\.|\[/));function z(e,t,n){let a=-1;const i=N(t)?[t]:L(t),s=i.length,r=s-1;for(;++a<s;){const t=i[a];let s=n;if(a!==r){const n=e[t];s=u(n)||Array.isArray(n)?n:isNaN(+i[a+1])?{}:[]}e[t]=s,e=e[t]}return e}function B(e){const t=w(),{name:n,control:a=t.control,shouldUnregister:s}=e,r=d(a._names.array,n),o=F({control:a,name:n,defaultValue:g(a._formValues,n,g(a._defaultValues,n,e.defaultValue)),exact:!0}),l=_({control:a,name:n}),u=i.default.useRef(a.register(n,{...e.rules,value:o}));return u.current=a.register(n,e.rules),i.default.useEffect((()=>{const e=a._options.shouldUnregister||s,t=(e,t)=>{const n=g(a._fields,e);n&&(n._f.mount=t)};if(t(n,!0),e){const e=p(g(a._options.defaultValues,n));z(a._defaultValues,n,e),b(g(a._formValues,n))&&z(a._formValues,n,e)}return()=>{(r?e&&!a._state.action:e)?a.unregister(n):t(n,!1)}}),[n,a,r,s]),{field:{name:n,value:o,onChange:i.default.useCallback((e=>u.current.onChange({target:{value:c(e),name:n},type:h})),[n]),onBlur:i.default.useCallback((()=>u.current.onBlur({target:{value:g(a._formValues,n),name:n},type:v})),[n,a]),ref:e=>{const t=g(a._fields,n);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!g(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!g(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!g(l.touchedFields,n)},error:{enumerable:!0,get:()=>g(l.errors,n)}})}}const q="post";var V=(e,t,n,a,i)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[a]:i||!0}}:{};const $=(e,t,n)=>{for(const a of n||Object.keys(e)){const n=g(e,a);if(n){const{_f:e,...a}=n;if(e&&t(e.name)){if(e.ref.focus){e.ref.focus();break}if(e.refs&&e.refs[0].focus){e.refs[0].focus();break}}else u(a)&&$(a,t)}}};var U=()=>{const e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=(16*Math.random()+e)%16|0;return("x"==t?n:3&n|8).toString(16)}))},Q=(e,t,n={})=>n.shouldFocus||b(n.shouldFocus)?n.focusName||`${e}.${b(n.focusIndex)?t:n.focusIndex}.`:"",H=e=>({isOnSubmit:!e||e===E,isOnBlur:"onBlur"===e,isOnChange:e===j,isOnAll:e===O,isOnTouch:"onTouched"===e}),G=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),W=(e,t,n)=>{const a=f(g(e,n));return z(a,"root",t[n]),z(e,n,a),e},K=e=>"boolean"==typeof e,J=e=>"file"===e.type,Y=e=>"function"==typeof e,X=e=>{if(!m)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Z=e=>D(e),ee=e=>"radio"===e.type,te=e=>e instanceof RegExp;const ne={value:!1,isValid:!1},ae={value:!0,isValid:!0};var ie=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!b(e[0].attributes.value)?b(e[0].value)||""===e[0].value?ae:{value:e[0].value,isValid:!0}:ae:ne}return ne};const se={isValid:!1,value:null};var re=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),se):se;function oe(e,t,n="validate"){if(Z(e)||Array.isArray(e)&&e.every(Z)||K(e)&&!e)return{type:n,message:Z(e)?e:"",ref:t}}var le=e=>u(e)&&!te(e)?e:{value:e,message:""},ue=async(e,t,n,a,i)=>{const{ref:r,refs:l,required:c,maxLength:d,minLength:m,min:p,max:f,pattern:v,validate:y,name:h,valueAsNumber:j,mount:E,disabled:O}=e._f,k=g(t,h);if(!E||O)return{};const w=l?l[0]:r,T=e=>{a&&w.reportValidity&&(w.setCustomValidity(K(e)?"":e||""),w.reportValidity())},M={},I=ee(r),A=s(r),P=I||A,_=(j||J(r))&&b(r.value)&&b(k)||X(r)&&""===r.value||""===k||Array.isArray(k)&&!k.length,R=V.bind(null,h,n,M),F=(e,t,n,a="maxLength",i="minLength")=>{const s=e?t:n;M[h]={type:e?a:i,message:s,ref:r,...R(e?a:i,s)}};if(i?!Array.isArray(k)||!k.length:c&&(!P&&(_||o(k))||K(k)&&!k||A&&!ie(l).isValid||I&&!re(l).isValid)){const{value:e,message:t}=Z(c)?{value:!!c,message:c}:le(c);if(e&&(M[h]={type:S,message:t,ref:w,...R(S,t)},!n))return T(t),M}if(!(_||o(p)&&o(f))){let e,t;const a=le(f),i=le(p);if(o(k)||isNaN(k)){const n=r.valueAsDate||new Date(k),s=e=>new Date((new Date).toDateString()+" "+e),o="time"==r.type,l="week"==r.type;D(a.value)&&k&&(e=o?s(k)>s(a.value):l?k>a.value:n>new Date(a.value)),D(i.value)&&k&&(t=o?s(k)<s(i.value):l?k<i.value:n<new Date(i.value))}else{const n=r.valueAsNumber||(k?+k:k);o(a.value)||(e=n>a.value),o(i.value)||(t=n<i.value)}if((e||t)&&(F(!!e,a.message,i.message,"max","min"),!n))return T(M[h].message),M}if((d||m)&&!_&&(D(k)||i&&Array.isArray(k))){const e=le(d),t=le(m),a=!o(e.value)&&k.length>+e.value,i=!o(t.value)&&k.length<+t.value;if((a||i)&&(F(a,e.message,t.message),!n))return T(M[h].message),M}if(v&&!_&&D(k)){const{value:e,message:t}=le(v);if(te(e)&&!k.match(e)&&(M[h]={type:x,message:t,ref:r,...R(x,t)},!n))return T(t),M}if(y)if(Y(y)){const e=oe(await y(k,t),w);if(e&&(M[h]={...e,...R("validate",e.message)},!n))return T(e.message),M}else if(u(y)){let e={};for(const a in y){if(!C(e)&&!n)break;const i=oe(await y[a](k,t),w,a);i&&(e={...i,...R(a,i.message)},T(i.message),n&&(M[h]=e))}if(!C(e)&&(M[h]={ref:w,...e},!n))return M}return T(!0),M};function ce(e,t){return[...e,...I(t)]}var de=e=>Array.isArray(e)?e.map((()=>{})):void 0;function me(e,t,n){return[...e.slice(0,t),...I(n),...e.slice(t)]}var pe=(e,t,n)=>Array.isArray(e)?(b(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[];function fe(e,t){return[...I(t),...I(e)]}var be=(e,t)=>b(t)?[]:function(e,t){let n=0;const a=[...e];for(const e of t)a.splice(e-n,1),n++;return f(a).length?a:[]}(e,I(t).sort(((e,t)=>e-t))),ge=(e,t,n)=>{e[t]=[e[n],e[n]=e[t]][0]};function ve(e,t){const n=Array.isArray(t)?t:N(t)?[t]:L(t),a=1===n.length?e:function(e,t){const n=t.slice(0,-1).length;let a=0;for(;a<n;)e=b(e)?a++:e[t[a++]];return e}(e,n),i=n.length-1,s=n[i];return a&&delete a[s],0!==i&&(u(a)&&C(a)||Array.isArray(a)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!b(e[t]))return!1;return!0}(a))&&ve(e,n.slice(0,-1)),e}var ye=(e,t,n)=>(e[t]=n,e);function he(){let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next&&n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var je=e=>o(e)||!l(e);function Ee(e,t){if(je(e)||je(t))return e===t;if(r(e)&&r(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const i of n){const n=e[i];if(!a.includes(i))return!1;if("ref"!==i){const e=t[i];if(r(n)&&r(e)||u(n)&&u(e)||Array.isArray(n)&&Array.isArray(e)?!Ee(n,e):n!==e)return!1}}return!0}var Oe=e=>"select-multiple"===e.type,xe=e=>X(e)&&e.isConnected,Se=e=>{for(const t in e)if(Y(e[t]))return!0;return!1};function ke(e,t={}){const n=Array.isArray(e);if(u(e)||n)for(const n in e)Array.isArray(e[n])||u(e[n])&&!Se(e[n])?(t[n]=Array.isArray(e[n])?[]:{},ke(e[n],t[n])):o(e[n])||(t[n]=!0);return t}function we(e,t,n){const a=Array.isArray(e);if(u(e)||a)for(const a in e)Array.isArray(e[a])||u(e[a])&&!Se(e[a])?b(t)||je(n[a])?n[a]=Array.isArray(e[a])?ke(e[a],[]):{...ke(e[a])}:we(e[a],o(t)?{}:t[a],n[a]):n[a]=!Ee(e[a],t[a]);return n}var Te=(e,t)=>we(e,t,ke(t)),Ce=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:a})=>b(e)?e:t?""===e?NaN:e?+e:e:n&&D(e)?new Date(e):a?a(e):e;function Me(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return J(t)?t.files:ee(t)?re(e.refs).value:Oe(t)?[...t.selectedOptions].map((({value:e})=>e)):s(t)?ie(e.refs).value:Ce(b(t.value)?e.ref.value:t.value,e)}var Ie=e=>b(e)?e:te(e)?e.source:u(e)?te(e.value)?e.value.source:e.value:e;function Ae(e,t,n){const a=g(e,n);if(a||N(n))return{error:a,name:n};const i=n.split(".");for(;i.length;){const a=i.join("."),s=g(t,a),r=g(e,a);if(s&&!Array.isArray(s)&&n!==a)return{name:n};if(r&&r.type)return{name:a,error:r};i.pop()}return{name:n}}const Pe={mode:E,reValidateMode:j,shouldFocusError:!0};function _e(e={},t){let n,a={...Pe,...e},i={submitCount:0,isDirty:!1,isLoading:Y(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},l={},h=(u(a.defaultValues)||u(a.values))&&p(a.defaultValues||a.values)||{},j=a.shouldUnregister?{}:p(h),E={action:!1,mount:!1,watch:!1},x={mount:new Set,unMount:new Set,array:new Set,watch:new Set},S=0;const k={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},w={values:he(),array:he(),state:he()},T=e.resetOptions&&e.resetOptions.keepDirtyValues,M=H(a.mode),A=H(a.reValidateMode),P=a.criteriaMode===O,_=async e=>{if(k.isValid||e){const e=a.resolver?C((await q()).errors):await V(l,!0);e!==i.isValid&&w.state.next({isValid:e})}},F=e=>k.isValidating&&w.state.next({isValidating:e}),N=(e,t,n,a)=>{const i=g(l,e);if(i){const s=g(j,e,b(n)?g(h,e):n);b(s)||a&&a.defaultChecked||t?z(j,e,t?s:Me(i._f)):Z(e,s),E.mount&&_()}},L=(e,t,n,a,s)=>{let r=!1,o=!1;const l={name:e};if(!n||a){k.isDirty&&(o=i.isDirty,i.isDirty=l.isDirty=U(),r=o!==l.isDirty);const n=Ee(g(h,e),t);o=g(i.dirtyFields,e),n?ve(i.dirtyFields,e):z(i.dirtyFields,e,!0),l.dirtyFields=i.dirtyFields,r=r||k.dirtyFields&&o!==!n}if(n){const t=g(i.touchedFields,e);t||(z(i.touchedFields,e,n),l.touchedFields=i.touchedFields,r=r||k.touchedFields&&t!==n)}return r&&s&&w.state.next(l),r?l:{}},B=(t,a,s,r)=>{const o=g(i.errors,t),l=k.isValid&&K(a)&&i.isValid!==a;var u;if(e.delayError&&s?(u=()=>((e,t)=>{z(i.errors,e,t),w.state.next({errors:i.errors})})(t,s),n=e=>{clearTimeout(S),S=setTimeout(u,e)},n(e.delayError)):(clearTimeout(S),n=null,s?z(i.errors,t,s):ve(i.errors,t)),(s?!Ee(o,s):o)||!C(r)||l){const e={...r,...l&&K(a)?{isValid:a}:{},errors:i.errors,name:t};i={...i,...e},w.state.next(e)}F(!1)},q=async e=>a.resolver(j,a.context,((e,t,n,a)=>{const i={};for(const n of e){const e=g(t,n);e&&z(i,n,e._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:a}})(e||x.mount,l,a.criteriaMode,a.shouldUseNativeValidation)),V=async(e,t,n={valid:!0})=>{for(const s in e){const r=e[s];if(r){const{_f:e,...s}=r;if(e){const s=x.array.has(e.name),o=await ue(r,j,P,a.shouldUseNativeValidation&&!t,s);if(o[e.name]&&(n.valid=!1,t))break;!t&&(g(o,e.name)?s?W(i.errors,o,e.name):z(i.errors,e.name,o[e.name]):ve(i.errors,e.name))}s&&await V(s,t,n)}}return n.valid},U=(e,t)=>(e&&t&&z(j,e,t),!Ee(se(),h)),Q=(e,t,n)=>R(e,x,{...E.mount?j:b(t)?h:D(e)?{[e]:t}:t},n,t),Z=(e,t,n={})=>{const a=g(l,e);let i=t;if(a){const n=a._f;n&&(!n.disabled&&z(j,e,Ce(t,n)),i=X(n.ref)&&o(t)?"":t,Oe(n.ref)?[...n.ref.options].forEach((e=>e.selected=i.includes(e.value))):n.refs?s(n.ref)?n.refs.length>1?n.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(i)?!!i.find((t=>t===e.value)):i===e.value))):n.refs[0]&&(n.refs[0].checked=!!i):n.refs.forEach((e=>e.checked=e.value===i)):J(n.ref)?n.ref.value="":(n.ref.value=i,n.ref.type||w.values.next({name:e,values:{...j}})))}(n.shouldDirty||n.shouldTouch)&&L(e,i,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&ie(e)},te=(e,t,n)=>{for(const a in t){const i=t[a],s=`${e}.${a}`,o=g(l,s);!x.array.has(e)&&je(i)&&(!o||o._f)||r(i)?Z(s,i,n):te(s,i,n)}},ne=(e,n,a={})=>{const s=g(l,e),r=x.array.has(e),u=p(n);z(j,e,u),r?(w.array.next({name:e,values:{...j}}),(k.isDirty||k.dirtyFields)&&a.shouldDirty&&w.state.next({name:e,dirtyFields:Te(h,j),isDirty:U(e,u)})):!s||s._f||o(u)?Z(e,u,a):te(e,u,a),G(e,x)&&w.state.next({...i}),w.values.next({name:e,values:{...j}}),!E.mount&&t()},ae=async e=>{const t=e.target;let s=t.name,r=!0;const o=g(l,s);if(o){let d,m;const p=t.type?Me(o._f):c(e),f=e.type===v||e.type===y,b=!((u=o._f).mount&&(u.required||u.min||u.max||u.maxLength||u.minLength||u.pattern||u.validate)||a.resolver||g(i.errors,s)||o._f.deps)||((e,t,n,a,i)=>!i.isOnAll&&(!n&&i.isOnTouch?!(t||e):(n?a.isOnBlur:i.isOnBlur)?!e:!(n?a.isOnChange:i.isOnChange)||e))(f,g(i.touchedFields,s),i.isSubmitted,A,M),h=G(s,x,f);z(j,s,p),f?(o._f.onBlur&&o._f.onBlur(e),n&&n(0)):o._f.onChange&&o._f.onChange(e);const E=L(s,p,f,!1),O=!C(E)||h;if(!f&&w.values.next({name:s,type:e.type,values:{...j}}),b)return k.isValid&&_(),O&&w.state.next({name:s,...h?{}:E});if(!f&&h&&w.state.next({...i}),F(!0),a.resolver){const{errors:e}=await q([s]),t=Ae(i.errors,l,s),n=Ae(e,l,t.name||s);d=n.error,s=n.name,m=C(e)}else d=(await ue(o,j,P,a.shouldUseNativeValidation))[s],r=isNaN(p)||p===g(j,s,p),r&&(d?m=!1:k.isValid&&(m=await V(l,!0)));r&&(o._f.deps&&ie(o._f.deps),B(s,m,d,E))}var u},ie=async(e,t={})=>{let n,s;const r=I(e);if(F(!0),a.resolver){const t=await(async e=>{const{errors:t}=await q();if(e)for(const n of e){const e=g(t,n);e?z(i.errors,n,e):ve(i.errors,n)}else i.errors=t;return t})(b(e)?e:r);n=C(t),s=e?!r.some((e=>g(t,e))):n}else e?(s=(await Promise.all(r.map((async e=>{const t=g(l,e);return await V(t&&t._f?{[e]:t}:t)})))).every(Boolean),(s||i.isValid)&&_()):s=n=await V(l);return w.state.next({...!D(e)||k.isValid&&n!==i.isValid?{}:{name:e},...a.resolver||!e?{isValid:n}:{},errors:i.errors,isValidating:!1}),t.shouldFocus&&!s&&$(l,(e=>e&&g(i.errors,e)),e?r:x.mount),s},se=e=>{const t={...h,...E.mount?j:{}};return b(e)?t:D(e)?g(t,e):e.map((e=>g(t,e)))},re=(e,t)=>({invalid:!!g((t||i).errors,e),isDirty:!!g((t||i).dirtyFields,e),isTouched:!!g((t||i).touchedFields,e),error:g((t||i).errors,e)}),oe=(e,t,n)=>{const a=(g(l,e,{_f:{}})._f||{}).ref;z(i.errors,e,{...t,ref:a}),w.state.next({name:e,errors:i.errors,isValid:!1}),n&&n.shouldFocus&&a&&a.focus&&a.focus()},le=(e,t={})=>{for(const n of e?I(e):x.mount)x.mount.delete(n),x.array.delete(n),t.keepValue||(ve(l,n),ve(j,n)),!t.keepError&&ve(i.errors,n),!t.keepDirty&&ve(i.dirtyFields,n),!t.keepTouched&&ve(i.touchedFields,n),!a.shouldUnregister&&!t.keepDefaultValue&&ve(h,n);w.values.next({values:{...j}}),w.state.next({...i,...t.keepDirty?{isDirty:U()}:{}}),!t.keepIsValid&&_()},ce=(e,t={})=>{let n=g(l,e);const i=K(t.disabled);return z(l,e,{...n||{},_f:{...n&&n._f?n._f:{ref:{name:e}},name:e,mount:!0,...t}}),x.mount.add(e),n?i&&z(j,e,t.disabled?void 0:g(j,e,Me(n._f))):N(e,!0,t.value),{...i?{disabled:t.disabled}:{},...a.progressive?{required:!!t.required,min:Ie(t.min),max:Ie(t.max),minLength:Ie(t.minLength),maxLength:Ie(t.maxLength),pattern:Ie(t.pattern)}:{},name:e,onChange:ae,onBlur:ae,ref:i=>{if(i){ce(e,t),n=g(l,e);const a=b(i.value)&&i.querySelectorAll&&i.querySelectorAll("input,select,textarea")[0]||i,r=(e=>ee(e)||s(e))(a),o=n._f.refs||[];if(r?o.find((e=>e===a)):a===n._f.ref)return;z(l,e,{_f:{...n._f,...r?{refs:[...o.filter(xe),a,...Array.isArray(g(h,e))?[{}]:[]],ref:{type:a.type,name:e}}:{ref:a}}}),N(e,!1,void 0,a)}else n=g(l,e,{}),n._f&&(n._f.mount=!1),(a.shouldUnregister||t.shouldUnregister)&&(!d(x.array,e)||!E.action)&&x.unMount.add(e)}}},de=()=>a.shouldFocusError&&$(l,(e=>e&&g(i.errors,e)),x.mount),me=(e,t)=>async n=>{n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let s=p(j);if(w.state.next({isSubmitting:!0}),a.resolver){const{errors:e,values:t}=await q();i.errors=e,s=t}else await V(l);ve(i.errors,"root"),C(i.errors)?(w.state.next({errors:{}}),await e(s,n)):(t&&await t({...i.errors},n),de(),setTimeout(de)),w.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:C(i.errors),submitCount:i.submitCount+1,errors:i.errors})},pe=(n,a={})=>{const s=n||h,r=p(s),o=n&&!C(n)?r:h;if(a.keepDefaultValues||(h=s),!a.keepValues){if(a.keepDirtyValues||T)for(const e of x.mount)g(i.dirtyFields,e)?z(o,e,g(j,e)):ne(e,g(o,e));else{if(m&&b(n))for(const e of x.mount){const t=g(l,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(X(e)){const t=e.closest("form");if(t){t.reset();break}}}}l={}}j=e.shouldUnregister?a.keepDefaultValues?p(h):{}:p(o),w.array.next({values:{...o}}),w.values.next({values:{...o}})}x={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!E.mount&&t(),E.mount=!k.isValid||!!a.keepIsValid,E.watch=!!e.shouldUnregister,w.state.next({submitCount:a.keepSubmitCount?i.submitCount:0,isDirty:a.keepDirty?i.isDirty:!(!a.keepDefaultValues||Ee(n,h)),isSubmitted:!!a.keepIsSubmitted&&i.isSubmitted,dirtyFields:a.keepDirtyValues?i.dirtyFields:a.keepDefaultValues&&n?Te(h,n):{},touchedFields:a.keepTouched?i.touchedFields:{},errors:a.keepErrors?i.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},fe=(e,t)=>pe(Y(e)?e(j):e,t);return{control:{register:ce,unregister:le,getFieldState:re,handleSubmit:me,setError:oe,_executeSchema:q,_getWatch:Q,_getDirty:U,_updateValid:_,_removeUnmounted:()=>{for(const e of x.unMount){const t=g(l,e);t&&(t._f.refs?t._f.refs.every((e=>!xe(e))):!xe(t._f.ref))&&le(e)}x.unMount=new Set},_updateFieldArray:(e,t=[],n,a,s=!0,r=!0)=>{if(a&&n){if(E.action=!0,r&&Array.isArray(g(l,e))){const t=n(g(l,e),a.argA,a.argB);s&&z(l,e,t)}if(r&&Array.isArray(g(i.errors,e))){const t=n(g(i.errors,e),a.argA,a.argB);s&&z(i.errors,e,t),((e,t)=>{!f(g(e,t)).length&&ve(e,t)})(i.errors,e)}if(k.touchedFields&&r&&Array.isArray(g(i.touchedFields,e))){const t=n(g(i.touchedFields,e),a.argA,a.argB);s&&z(i.touchedFields,e,t)}k.dirtyFields&&(i.dirtyFields=Te(h,j)),w.state.next({name:e,isDirty:U(e,t),dirtyFields:i.dirtyFields,errors:i.errors,isValid:i.isValid})}else z(j,e,t)},_getFieldArray:t=>f(g(E.mount?j:h,t,e.shouldUnregister?g(h,t,[]):[])),_reset:pe,_resetDefaultValues:()=>Y(a.defaultValues)&&a.defaultValues().then((e=>{fe(e,a.resetOptions),w.state.next({isLoading:!1})})),_updateFormState:e=>{i={...i,...e}},_subjects:w,_proxyFormState:k,get _fields(){return l},get _formValues(){return j},get _state(){return E},set _state(e){E=e},get _defaultValues(){return h},get _names(){return x},set _names(e){x=e},get _formState(){return i},set _formState(e){i=e},get _options(){return a},set _options(e){a={...a,...e}}},trigger:ie,register:ce,handleSubmit:me,watch:(e,t)=>Y(e)?w.values.subscribe({next:n=>e(Q(void 0,t),n)}):Q(e,t,!0),setValue:ne,getValues:se,reset:fe,resetField:(e,t={})=>{g(l,e)&&(b(t.defaultValue)?ne(e,g(h,e)):(ne(e,t.defaultValue),z(h,e,t.defaultValue)),t.keepTouched||ve(i.touchedFields,e),t.keepDirty||(ve(i.dirtyFields,e),i.isDirty=t.defaultValue?U(e,g(h,e)):U()),t.keepError||(ve(i.errors,e),k.isValid&&_()),w.state.next({...i}))},clearErrors:e=>{e&&I(e).forEach((e=>ve(i.errors,e))),w.state.next({errors:e?i.errors:{}})},unregister:le,setError:oe,setFocus:(e,t={})=>{const n=g(l,e),a=n&&n._f;if(a){const e=a.refs?a.refs[0]:a.ref;e.focus&&(e.focus(),t.shouldSelect&&e.select())}},getFieldState:re}}t.Controller=e=>e.render(B(e)),t.Form=function(e){const t=w(),[n,a]=i.default.useState(!1),{control:s=t.control,onSubmit:r,children:o,action:l,method:u=q,headers:c,encType:d,onError:m,render:p,onSuccess:f,validateStatus:b,...v}=e,y=async t=>{let n=!1,a="";await s.handleSubmit((async e=>{const i=new FormData;let o="";try{o=JSON.stringify(e)}catch(e){}for(const t of s._names.mount)i.append(t,g(e,t));if(r&&r({data:e,event:t,method:u,formData:i,formDataJson:o}),l)try{const e=[c&&c["Content-Type"],d].some((e=>e&&e.includes("json"))),t=await fetch(l,{method:u,headers:{...c,...d?{"Content-Type":d}:{}},body:e?o:i});t&&(b?!b(t.status):t.status<200||t.status>=300)?(n=!0,m&&m({response:t}),a=String(t.status)):f&&f({response:t})}catch(e){n=!0,m&&m({error:e})}}))(t),n&&e.control&&(e.control._subjects.state.next({isSubmitSuccessful:!1}),e.control.setError("root.server",{type:a}))};return i.default.useEffect((()=>{a(!0)}),[]),p?i.default.createElement(i.default.Fragment,null,p({submit:y})):i.default.createElement("form",{noValidate:n,action:l,method:u,encType:d,onSubmit:y,...v},o)},t.FormProvider=e=>{const{children:t,...n}=e;return i.default.createElement(k.Provider,{value:n},t)},t.appendErrors=V,t.get=g,t.set=z,t.useController=B,t.useFieldArray=function(e){const t=w(),{control:n=t.control,name:a,keyName:s="id",shouldUnregister:r}=e,[o,l]=i.default.useState(n._getFieldArray(a)),u=i.default.useRef(n._getFieldArray(a).map(U)),c=i.default.useRef(o),d=i.default.useRef(a),m=i.default.useRef(!1);d.current=a,c.current=o,n._names.array.add(a),e.rules&&n.register(a,e.rules),P({next:({values:e,name:t})=>{if(t===d.current||!t){const t=g(e,d.current);Array.isArray(t)&&(l(t),u.current=t.map(U))}},subject:n._subjects.array});const f=i.default.useCallback((e=>{m.current=!0,n._updateFieldArray(a,e)}),[n,a]);return i.default.useEffect((()=>{if(n._state.action=!1,G(a,n._names)&&n._subjects.state.next({...n._formState}),m.current&&(!H(n._options.mode).isOnSubmit||n._formState.isSubmitted))if(n._options.resolver)n._executeSchema([a]).then((e=>{const t=g(e.errors,a),i=g(n._formState.errors,a);(i?!t&&i.type||t&&(i.type!==t.type||i.message!==t.message):t&&t.type)&&(t?z(n._formState.errors,a,t):ve(n._formState.errors,a),n._subjects.state.next({errors:n._formState.errors}))}));else{const e=g(n._fields,a);e&&e._f&&ue(e,n._formValues,n._options.criteriaMode===O,n._options.shouldUseNativeValidation,!0).then((e=>!C(e)&&n._subjects.state.next({errors:W(n._formState.errors,e,a)})))}n._subjects.values.next({name:a,values:{...n._formValues}}),n._names.focus&&$(n._fields,(e=>!!e&&e.startsWith(n._names.focus||""))),n._names.focus="",n._updateValid()}),[o,a,n]),i.default.useEffect((()=>(!g(n._formValues,a)&&n._updateFieldArray(a),()=>{(n._options.shouldUnregister||r)&&n.unregister(a)})),[a,n,s,r]),{swap:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);ge(i,e,t),ge(u.current,e,t),f(i),l(i),n._updateFieldArray(a,i,ge,{argA:e,argB:t},!1)}),[f,a,n]),move:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);pe(i,e,t),pe(u.current,e,t),f(i),l(i),n._updateFieldArray(a,i,pe,{argA:e,argB:t},!1)}),[f,a,n]),prepend:i.default.useCallback(((e,t)=>{const i=I(p(e)),s=fe(n._getFieldArray(a),i);n._names.focus=Q(a,0,t),u.current=fe(u.current,i.map(U)),f(s),l(s),n._updateFieldArray(a,s,fe,{argA:de(e)})}),[f,a,n]),append:i.default.useCallback(((e,t)=>{const i=I(p(e)),s=ce(n._getFieldArray(a),i);n._names.focus=Q(a,s.length-1,t),u.current=ce(u.current,i.map(U)),f(s),l(s),n._updateFieldArray(a,s,ce,{argA:de(e)})}),[f,a,n]),remove:i.default.useCallback((e=>{const t=be(n._getFieldArray(a),e);u.current=be(u.current,e),f(t),l(t),n._updateFieldArray(a,t,be,{argA:e})}),[f,a,n]),insert:i.default.useCallback(((e,t,i)=>{const s=I(p(t)),r=me(n._getFieldArray(a),e,s);n._names.focus=Q(a,e,i),u.current=me(u.current,e,s.map(U)),f(r),l(r),n._updateFieldArray(a,r,me,{argA:e,argB:de(t)})}),[f,a,n]),update:i.default.useCallback(((e,t)=>{const i=p(t),s=ye(n._getFieldArray(a),e,i);u.current=[...s].map(((t,n)=>t&&n!==e?u.current[n]:U())),f(s),l([...s]),n._updateFieldArray(a,s,ye,{argA:e,argB:i},!0,!1)}),[f,a,n]),replace:i.default.useCallback((e=>{const t=I(p(e));u.current=t.map(U),f([...t]),l([...t]),n._updateFieldArray(a,[...t],(e=>e),{},!0,!1)}),[f,a,n]),fields:i.default.useMemo((()=>o.map(((e,t)=>({...e,[s]:u.current[t]||U()})))),[o,s])}},t.useForm=function(e={}){const t=i.default.useRef(),[n,a]=i.default.useState({isDirty:!1,isValidating:!1,isLoading:Y(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:Y(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={..._e(e,(()=>a((e=>({...e}))))),formState:n});const s=t.current.control;return s._options=e,P({subject:s._subjects.state,next:e=>{M(e,s._proxyFormState,s._updateFormState,!0)&&a({...s._formState})}}),i.default.useEffect((()=>{e.values&&!Ee(e.values,s._defaultValues)?s._reset(e.values,s._options.resetOptions):s._resetDefaultValues()}),[e.values,s]),i.default.useEffect((()=>{s._state.mount||(s._updateValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()})),t.current.formState=T(n,s),t.current},t.useFormContext=w,t.useFormState=_,t.useWatch=F},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(23),i=n.n(a),s=n(2),r=n.n(s),o=n(17),l=n(48),u=n(128),c=n(119),d=n(138),m=n(14),p=n(181),f=n(116),b=n(122),g=n(113),v=n(228),y=n(197),h=n(112);const j=({asEmptyButton:e,children:t,dataProviders:n,filters:a,timeRange:j,keepDataView:E,iconType:O,...x})=>{const S=Object(l.useDispatch)(),k=Object(s.useMemo)((()=>u.e.getSourcererDataViewsSelector()),[]),{defaultDataView:w,signalIndexName:T}=Object(h.a)((e=>k(e))),C=n&&n.find((e=>"template"===e.type)),M=Object(v.a)({timelineId:b.c.active,timelineType:C?g.l.template:g.l.default}),I=Object(s.useCallback)((()=>{(n||a)&&(j?M({timeRange:j}):M(),n&&S(Object(m.updateProviders)({id:b.c.active,providers:n})),a&&S(Object(m.setFilters)({id:b.c.active,filters:a})),E||S(p.d.setSelectedDataView({id:f.SourcererScopeName.timeline,selectedDataViewId:w.id,selectedPatterns:[T||""]})),S(d.b.removeLinkTo([c.a.timeline,c.a.global])))}),[n,M,S,w.id,T,a,j,E]);return e?r.a.createElement(o.EuiButtonEmpty,{"aria-label":y.i,onClick:I,flush:"right",size:"xs",iconType:O},t):r.a.createElement(o.EuiButton,i()({"aria-label":y.i,onClick:I},x),t)};j.displayName="InvestigateInTimelineButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),s=n(17),r=n(542),o=n(317);const l=Object(a.forwardRef)((({onChange:e,value:t,ariaLabel:n,editorId:l,dataTestSubj:u,height:c,autoFocusDisabled:d,setIsMarkdownInvalid:m},p)=>{const[f,b]=Object(a.useState)([]),g=Object(a.useCallback)(((e,{messages:t})=>{b(e?[e]:t),m(!!e)}),[m]),v=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e,t;d||null===(e=v.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus()}),[d]);const y=Object(o.b)("investigation_guide"),h=Object(a.useMemo)((()=>Object(r.d)({insightsUpsellingMessage:y})),[y]);return Object(a.useImperativeHandle)(p,(()=>{var e,t;if(!v.current)return null;const n=null===(e=v.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...v.current,toolbar:null==n?void 0:n.querySelector(".euiMarkdownEditorToolbar")}})),i.a.createElement(s.EuiMarkdownEditor,{ref:v,"aria-label":n,editorId:l,onChange:e,value:t,uiPlugins:h,parsingPluginList:r.a,processingPluginList:r.c,onParse:g,errors:f,"data-test-subj":u,height:c})}));l.displayName="MarkdownEditorComponent";const u=Object(a.memo)(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(17),i=n(61),s=n.n(i),r=n(2),o=n.n(r),l=n(44),u=n.n(l),c=n(49),d=n(4),m=n(382),p=n(121),f=n(116);const b=u()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-67qpo8-0"})(["width:min(768px,calc(100vw - 16px));min-height:41vh;.euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]);b.displayName="MyEuiModal";const g=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},v=(e=[])=>1===e.length&&e[0]===d.Vb?o.a.createElement("i",null,m.f):e.length>0?e.filter((e=>e!==d.Vb)).join(", "):m.k,y=({adHocDataViews:e,additionalRequests:t,additionalResponses:n,closeModal:i,inputId:l,request:u,response:d,title:y})=>{var h,j,E,O;const{pathname:x}=Object(c.useLocation)(),{selectedPatterns:S}=Object(p.d)("timeline"===l?f.SourcererScopeName.timeline:Object(p.a)(x)),k=[u,...null!=t?t:[]],w=[d,...null!=n?n:[]],T=g(k),C=g(w),M=Object(r.useMemo)((()=>{var e,t;return(null!==(e=null===(t=T[0])||void 0===t?void 0:t.index)&&void 0!==e?e:[]).every((e=>S.includes(e.trim())))}),[T,S]),I=[{title:o.a.createElement("span",{"data-test-subj":"index-pattern-title"},m.b," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.c,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"index-pattern-description"},o.a.createElement("p",null,v(null!=e&&e.length>0?e:null!==(h=null===(j=T[0])||void 0===j?void 0:j.index)&&void 0!==h?h:[])),!M&&o.a.createElement("p",null,o.a.createElement("small",null,o.a.createElement("i",{"data-test-subj":"not-sourcerer-msg"},m.e))))},{title:o.a.createElement("span",{"data-test-subj":"query-time-title"},m.g," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.h,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"query-time-description"},0===(null===(E=C[0])||void 0===E?void 0:E.took)?"0ms":null!==(O=C[0])&&void 0!==O&&O.took?`${s()(C[0].took).format("0,0")}ms`:m.k)},{title:o.a.createElement("span",{"data-test-subj":"request-timestamp-title"},m.i," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.j,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}],A=[{id:"statistics",name:"Statistics",content:o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiDescriptionList,{listItems:I,type:"responsiveColumn",columnWidths:[3,7]}))},{id:"request",name:"Request",content:T.length>0?T.map(((e,t)=>o.a.createElement(r.Fragment,{key:t},o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return m.k}})(e.body))))):o.a.createElement(a.EuiCodeBlock,null,m.k)},{id:"response",name:"Response",content:C.length>0?w.map(((e,t)=>o.a.createElement(r.Fragment,{key:t},o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},e)))):o.a.createElement(a.EuiCodeBlock,null,m.k)}];return o.a.createElement(b,{onClose:i,"data-test-subj":"modal-inspect-euiModal"},o.a.createElement(a.EuiModalHeader,null,o.a.createElement(a.EuiModalHeaderTitle,null,m.d," ",y)),o.a.createElement(a.EuiModalBody,null,o.a.createElement(a.EuiTabbedContent,{tabs:A,initialSelectedTab:A[0],autoFocus:"selected"})),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButton,{onClick:i,fill:!0,"data-test-subj":"modal-inspect-close"},m.a)))}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"k",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return f}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.inspectDescription",{defaultMessage:"Inspect"}),s=a.i18n.translate("xpack.securitySolution.inspect.modal.closeTitle",{defaultMessage:"Close"}),r=a.i18n.translate("xpack.securitySolution.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),o=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),l=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),u=a.i18n.translate("xpack.securitySolution.inspectPatternDifferent",{defaultMessage:"This element has a unique index pattern separate from the data view setting."}),c=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),d=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),m=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),p=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),f=a.i18n.translate("xpack.securitySolution.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(62),i=n(45),s=n(283);const r=e=>e.toLocaleString(),o=({chartHeight:e,from:t,legendPosition:n,to:i,onBrushEnd:o,yTickFormatter:l,showLegend:u})=>({series:{xScaleType:a.ScaleType.Time,yScaleType:a.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(s.a)([t,i]),yTickFormatter:null!=l?l:r,tickSize:8},settings:{legendPosition:null!=n?n:a.Position.Right,onBrushEnd:o,showLegend:null==u||u,showLegendExtra:!0,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:null!=e?e:174}),l=["#1EA593","#2B70F7","#CE0060","#38007E","#FCA5D3","#F37020","#E49E29","#B0916F","#7B000B","#34130C","#GGGGGG"],u=([e,t])=>({key:e,value:t}),c=(e,t)=>{if(!e)return[];const n=Object(i.groupBy)("g",e),a=Object(i.toPairs)(n);return Object(i.map)(u,a).map(((e,n)=>{var a;const s=Object(i.get)(e.key,t);return{...e,color:null!==(a=null==s?void 0:s.color)&&void 0!==a?a:l[n]}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"n",(function(){return g})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return y})),n.d(t,"f",(function(){return h}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.addToCaseSuccessToast",{defaultMessage:"Successfully added data quality results to the case"}),s=(a.i18n.translate("xpack.securitySolution.dataQualityDashboard.betaBadge",{defaultMessage:"Beta"}),a.i18n.translate("xpack.securitySolution.overview.ilmPhaseCold",{defaultMessage:"cold"})),r=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.pageTitle",{defaultMessage:"Data Quality"}),o=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.datePicker.tooltip",{defaultMessage:"Data quality checks are ran on data that was ingested during the Search Boost window. The default window range is 7 days."}),l=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.elasticCommonSchemaReferenceLink",{defaultMessage:"Elastic Common Schema (ECS)"}),u=(a.i18n.translate("xpack.securitySolution.overview.eventsTitle",{defaultMessage:"Event count"}),a.i18n.translate("xpack.securitySolution.overview.ilmPhaseFrozen",{defaultMessage:"frozen"})),c=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseHot",{defaultMessage:"hot"}),d=a.i18n.translate("xpack.securitySolution.overview.newsFeedSidebarTitle",{defaultMessage:"Security news"}),m=a.i18n.translate("xpack.securitySolution.overview.recentTimelinesSidebarTitle",{defaultMessage:"Recent timelines"}),p=a.i18n.translate("xpack.securitySolution.overview.signalCountTitle",{defaultMessage:"Alert trend"}),f=e=>a.i18n.translate("xpack.securitySolution.overview.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}),b=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseUnmanaged",{defaultMessage:"unmanaged"}),g=a.i18n.translate("xpack.securitySolution.overview.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),v=a.i18n.translate("xpack.securitySolution.overview.viewEventsButtonLabel",{defaultMessage:"View events"}),y=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseWarm",{defaultMessage:"warm"}),h=a.i18n.translate("xpack.securitySolution.detectionResponse.pageTitle",{defaultMessage:"Detection & Response"});a.i18n.translate("xpack.securitySolution.entityAnalytics.technicalPreviewLabel",{defaultMessage:"Technical Preview"})},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n(45),n(51);const a=({allowSet:e,field:t})=>e.has(t),i=({allowSet:e,field:t})=>!e.has(t),s=({allowReplacementSet:e,field:t})=>e.has(t),r=({allowSet:e,allowReplacementSet:t,currentReplacements:n,field:i,getAnonymizedValue:r,rawData:o})=>{var l;return(null!==(l=o[i])&&void 0!==l?l:[]).reduce(((o,l)=>{const u=`${l}`;if(a({allowSet:e,field:i})&&s({allowReplacementSet:t,field:i})){const e=`${r({currentReplacements:n,rawValue:u})}`;return{anonymizedValues:[...o.anonymizedValues,e],replacements:{...o.replacements,[e]:u}}}return a({allowSet:e,field:i})?{anonymizedValues:[...o.anonymizedValues,u],replacements:{...o.replacements}}:o}),{anonymizedValues:[],replacements:{}})},o=({allow:e,allowReplacement:t,currentReplacements:n,getAnonymizedValue:i,onNewReplacements:s,rawData:o})=>{if("string"==typeof o)return o;const l=(({allow:e,allowReplacement:t,currentReplacements:n,getAnonymizedValue:i,getAnonymizedValues:s,rawData:r})=>Object.keys(r).reduce(((o,l)=>{const u=new Set(t),c=new Set(e);if(a({allowSet:c,field:l})){const{anonymizedValues:e,replacements:t}=s({allowReplacementSet:u,allowSet:c,currentReplacements:n,field:l,getAnonymizedValue:i,rawData:r});return{anonymizedData:{...o.anonymizedData,[l]:e},replacements:{...o.replacements,...t}}}return o}),{anonymizedData:{},replacements:{}}))({allow:e,allowReplacement:t,currentReplacements:n,rawData:o,getAnonymizedValue:i,getAnonymizedValues:r});return null!=s&&s(l.replacements),u=l.anonymizedData,Object.keys(u).sort().map((e=>`${e},${u[e].join(",")}`)).join("\n");var u}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(46),i=n(139),s=n(120);a.exact(a.type({id:s.q})),a.exact(a.type({items:a.array(i.i)})),a.exact(a.type({name:a.string,description:a.string}));var r=n(278);a.intersection([a.exact(a.type({namespace_types:i.a})),a.exact(a.partial({ids:s.k,list_ids:s.k}))]);const o=a.exact(a.type({name:r.t,id:r.v,rule_id:r.y,exception_lists:i.y})),l=a.intersection([i.o,a.exact(a.type({referenced_rules:a.array(o)}))]),u=a.record(i.B,l);a.exact(a.type({references:a.array(u)}));var c=n(4);const d=`${c.Db}/rules`,m=(c.jb,`${d}/exceptions/_find_references`)},function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return O.a}));var a=n(23),i=n.n(a),s=n(2),r=n.n(s),o=n(45),l=n(17),u=n(461),c=n.n(u),d=n(47),m=n(542);const p=({disableLinks:e,href:t,target:n,children:a,...i})=>r.a.createElement(l.EuiToolTip,{content:t},r.a.createElement(l.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},a)),f=Object(s.memo)(p);var b=n(110),g=n(18),v=n(5);const y=v.i18n.translate("xpack.securitySolution.markdown.platinumWarning",{defaultMessage:"The following markdown may make use of subscription features"}),h=v.i18n.translate("xpack.securitySolution.markdown.invalid",{defaultMessage:"Invalid markdown detected"}),j=({children:e,disableLinks:t,textSize:n="m"})=>{const a=Object(s.useMemo)((()=>e=>r.a.createElement(f,i()({},e,{disableLinks:t}))),[t]),u=Object(o.cloneDeep)(m.c);u[1][1].components.a=a;const p=Object(g.b)().isAtLeast("platinum"),{application:v}=Object(b.i)().services,j=Object(s.useMemo)((()=>{if(!1===p){const t=String(e);return m.b.some((e=>new RegExp(e).test(t)))}return!1}),[e,p]),E=Object(s.useMemo)((()=>c()().use(m.a).use(u)),[u]),O=Object(s.useMemo)((()=>{try{return E.processSync(e),null}catch(e){return String(e.message)}}),[e,E]);return r.a.createElement(r.a.Fragment,null,j&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiCallOut,{title:y,color:"primary",iconType:"lock"},r.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkPrefix",defaultMessage:"To use these interactive markdown features, you must {link}.",values:{link:r.a.createElement(l.EuiLink,{href:v.getUrlForApp("management",{path:"stack/license_management/home"})},r.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkSuffix",defaultMessage:"start a trial or upgrade your subscription"}))}})),r.a.createElement(l.EuiSpacer,{size:"s"})),null!==O&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiCallOut,{title:h,color:"danger",iconType:"error"},O),r.a.createElement(l.EuiSpacer,{size:"s"})),r.a.createElement(l.EuiMarkdownFormat,{parsingPluginList:m.a,processingPluginList:u,textSize:n},e))};j.displayName="MarkdownRendererComponent";const E=Object(s.memo)(j);var O=n(380);n(463)},,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a,i=n(2),s=n(67),r=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o="html",l="svg",u=function(e,t){var n,a,i,s={};if(e===o)i=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');i=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var r=0,u=Object.entries(t.attributes);r<u.length;r++){var c=u[r],d=c[0],m=c[1];i.setAttribute(d,m)}var p={element:i,elementType:e,setPortalProps:function(e){s=e},getInitialPortalProps:function(){return s},mount:function(t,i){if(i!==a){if(p.unmount(),t!==n&&!function(e,t){if(t===o)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(p.element,i),n=t,a=i}},unmount:function(e){e&&e!==a||n&&a&&(n.replaceChild(a,p.element),n=void 0,a=void 0)}};return p},c=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return r(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,a=t.node;return s.createPortal(i.Children.map(n,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),a.element)},t}(i.PureComponent),d=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=i.createRef(),n.passPropsThroughPortal(),n}return r(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent),m=u.bind(null,o);u.bind(null,l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n(48),s=n(112),r=n(110),o=n(128),l=n(181),u=n(119);const c=({inputId:e,queryId:t,skip:n})=>{const c=Object(i.useDispatch)(),{data:d}=Object(r.i)().services,m=Object(a.useRef)(d.search.session),p=o.d.globalQueryByIdSelector(),f=o.d.timelineQueryByIdSelector(),{selectedInspectIndex:b}=Object(s.a)((n=>e===u.a.global?p(n,t):f(n,t))),g=Object(a.useCallback)((()=>{const e=m.current.start();c(l.c.setInspectionParameter({id:t,selectedInspectIndex:b,isInspected:!1,inputId:u.a.global,searchSessionId:n?void 0:e}))}),[c,t,b,n]),v=Object(a.useCallback)((()=>{c(l.c.deleteOneQuery({inputId:u.a.global,id:t}))}),[c,t]);return{session:m,refetchByRestartingSession:g,refetchByDeletingSession:v}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return m}));var a=n(2),i=n(49),s=n(5),r=n(117),o=n(121),l=n(241),u=n(728);const c=({setQuery:e,response:t,request:n,refetch:i,uniqueQueryId:s,deleteQuery:r,loading:o,searchSessionId:l})=>{Object(a.useEffect)((()=>(null!=i&&null!=e&&e({id:s,inspect:{dsl:[n],response:[t]},loading:o,refetch:i,searchSessionId:l}),()=>{r&&r({id:s})})),[e,o,t,n,i,s,r,l])};function d(e){var t;const n=null==e?void 0:e.subType;return!(null==n||null===(t=n.nested)||void 0===t||!t.path)}const m=e=>{const{pathname:t}=Object(i.useLocation)(),{addError:n}=Object(r.a)(),{browserFields:c}=Object(o.d)(Object(o.a)(t));return Object(a.useCallback)((()=>{try{return function(e,t){const n=[];for(const[a,i]of Object.entries(e))t?i.aggregatable&&Object(u.a)(i.type)&&!d(i)&&n.push({label:a,value:a}):!0===i.aggregatable&&n.push({label:a,value:a});return n}(Object(l.a)(c),e)}catch(e){return n(e,{title:s.i18n.translate("xpack.securitySolution.useStackByFields.error.title",{defaultMessage:"Error fetching fields"}),toastMessage:s.i18n.translate("xpack.securitySolution.useStackByFields.error.toastMessage",{defaultMessage:"This error indicates an exceedingly large number of fields in an index"})}),[]}}),[n,c,e])}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByLabel",{defaultMessage:"Group by"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByPlaceholder",{defaultMessage:"Select a field to stack by"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByAriaLabel",{defaultMessage:"Stack the alerts histogram by a field value"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByTopLabel",{defaultMessage:"Group by top"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return f}));var a=n(142),i=n(124),s=n(357);const r=e=>{const t="acknowledged"===e?{bool:{should:[{term:{[a.ob]:e}},{term:{[a.ob]:"in-progress"}}]}}:{term:{[a.ob]:e}};return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:a.ob,params:{query:e}},query:t}]},o=e=>[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({term:{[a.ob]:e}})))}}}],l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:a.N,params:{query:e}},query:{match_phrase:{[a.N]:e}}}]:[],u=e=>e?[]:[{meta:{alias:null,negate:!0,disabled:!1,type:"exists",key:a.b,value:"exists"},query:{exists:{field:a.b}}}],c=e=>e?[{meta:{alias:null,disabled:!1,negate:!1,key:"kibana.alert.rule.type",type:"term"},query:{term:{"kibana.alert.rule.type":"threat_match"}}}]:[],d=e=>e.length?[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>e?{term:{[a.mb]:e}}:{bool:{must_not:{exists:{field:a.mb}}}}))}}}]:[],m=e=>({...i.q,columns:Object(s.c)(e),showCheckboxes:!0}),p=e=>({...m(e),columns:Object(s.d)(e),defaultColumns:Object(s.d)(e),sort:[{columnId:"kibana.alert.original_time",columnType:"date",esTypes:["date"],sortDirection:"desc"}],showCheckboxes:!1}),f=["@timestamp","kibana.alert.workflow_status","kibana.alert.workflow_tags","kibana.alert.workflow_assignee_ids","kibana.alert.group.id","kibana.alert.original_time","kibana.alert.building_block_type","kibana.alert.rule.from","kibana.alert.rule.name","kibana.alert.rule.to","kibana.alert.rule.uuid","kibana.alert.rule.rule_id","kibana.alert.rule.type","kibana.alert.suppression.docs_count","kibana.alert.original_event.kind","kibana.alert.original_event.module","file.path","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.hash.sha256","host.os.family","event.code","process.entry_leader.entity_id"]},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return r})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"o",(function(){return p})),n.d(t,"n",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"q",(function(){return g})),n.d(t,"r",(function(){return v})),n.d(t,"u",(function(){return y})),n.d(t,"t",(function(){return h})),n.d(t,"v",(function(){return j})),n.d(t,"x",(function(){return E})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return x})),n.d(t,"w",(function(){return S})),n.d(t,"s",(function(){return k})),n.d(t,"m",(function(){return w})),n.d(t,"l",(function(){return T}));var a=n(5);a.i18n.translate("xpack.securitySolution.dataProviders.and",{defaultMessage:"AND"});const i=a.i18n.translate("xpack.securitySolution.dataProviders.deleteDataProvider",{defaultMessage:"Delete"}),s=a.i18n.translate("xpack.securitySolution.dataProviders.dropAnything",{defaultMessage:"Drop anything"}),r=(a.i18n.translate("xpack.securitySolution.dataProviders.edit",{defaultMessage:"Edit"}),a.i18n.translate("xpack.securitySolution.dataProviders.editMenuItem",{defaultMessage:"Edit filter"})),o=a.i18n.translate("xpack.securitySolution.dataProviders.editTitle",{defaultMessage:"EDIT FILTER"}),l=a.i18n.translate("xpack.securitySolution.dataProviders.excludeDataProvider",{defaultMessage:"Exclude results"}),u=a.i18n.translate("xpack.securitySolution.dataProviders.existsLabel",{defaultMessage:"exists"}),c=(a.i18n.translate("xpack.securitySolution.dataProviders.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dataProviders.filterForFieldPresentLabel",{defaultMessage:"Filter for field present"})),d=a.i18n.translate("xpack.securitySolution.dataProviders.convertToFieldLabel",{defaultMessage:"Convert to field"}),m=a.i18n.translate("xpack.securitySolution.dataProviders.convertToTemplateFieldLabel",{defaultMessage:"Convert to template field"}),p=a.i18n.translate("xpack.securitySolution.dataProviders.highlighted",{defaultMessage:"highlighted"}),f=a.i18n.translate("xpack.securitySolution.dataProviders.hereToBuildAn",{defaultMessage:"here to build an"}),b=a.i18n.translate("xpack.securitySolution.dataProviders.includeDataProvider",{defaultMessage:"Include results"}),g=a.i18n.translate("xpack.securitySolution.dataProviders.not",{defaultMessage:"NOT"}),v=(a.i18n.translate("xpack.securitySolution.dataProviders.or",{defaultMessage:"or"}),a.i18n.translate("xpack.securitySolution.dataProviders.query",{defaultMessage:"query"})),y=(a.i18n.translate("xpack.securitySolution.dataProviders.toggle",{defaultMessage:"toggle"}),a.i18n.translate("xpack.securitySolution.dataProviders.reEnableDataProvider",{defaultMessage:"Re-enable"})),h=a.i18n.translate("xpack.securitySolution.dataProviders.removeDataProvider",{defaultMessage:"Remove Data Provider"}),j=({field:e,value:t})=>a.i18n.translate("xpack.securitySolution.dataProviders.showOptionsDataProviderAriaLabel",{values:{field:e,value:t},defaultMessage:"{field} {value} Press enter for options, or press space to begin dragging"}),E=a.i18n.translate("xpack.securitySolution.dataProviders.temporaryDisableDataProvider",{defaultMessage:"Temporarily disable"}),O=(a.i18n.translate("xpack.securitySolution.dataProviders.valuePlaceholder",{defaultMessage:"value"}),a.i18n.translate("xpack.securitySolution.dataProviders.addFieldPopoverButtonLabel",{defaultMessage:"Add field"})),x=a.i18n.translate("xpack.securitySolution.dataProviders.addTemplateFieldPopoverButtonLabel",{defaultMessage:"Add template field"}),S=a.i18n.translate("xpack.securitySolution.dataProviders.templateFieldLabel",{defaultMessage:"Template field"}),k=a.i18n.translate("xpack.securitySolution.dataProviders.queryAreaAriaLabel",{defaultMessage:"You are in the timeline query area, which contains groups of data providers that query for events"}),w=e=>a.i18n.translate("xpack.securitySolution.dataProviders.groupAreaAriaLabel",{values:{group:e},defaultMessage:"You are in group {group}"}),T=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return E}));var a=n(17),i=n(2),s=n.n(i),r=n(44),o=n.n(r),l=n(215),u=n(390),c=n(5);const d=c.i18n.translate("xpack.securitySolution.alertDetails.summary.readMore",{defaultMessage:"Read More"}),m=c.i18n.translate("xpack.securitySolution.alertDetails.summary.readLess",{defaultMessage:"Read Less"}),p=o()(a.EuiButtonEmpty).withConfig({displayName:"ReadMore",componentId:"sc-1cdn95f-0"})(["span.euiButtonContent{padding:0;}"]),f=o.a.div.withConfig({displayName:"ExpandedContent",componentId:"sc-1cdn95f-1"})(["max-height:33vh;overflow-wrap:break-word;overflow-x:hidden;overflow-y:auto;"]),b=o.a.div.withConfig({displayName:"StyledLineClamp",componentId:"sc-1cdn95f-2"})(["display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;max-height:","em;height:","em;"],3,(({lineClampHeight:e})=>e),(({lineClampHeight:e})=>e)),g=({children:e,lineClampHeight:t=5.5})=>{const[n,a]=Object(i.useState)(null),[r,o]=(e=>{const[t,n]=Object(i.useState)(null),a=Object(i.useRef)(null);return Object(i.useEffect)((()=>{var e,t,i,s,r,o,l,u,c;null!=(null===(e=a.current)||void 0===e?void 0:e.clientHeight)&&((null!==(t=null==a||null===(i=a.current)||void 0===i?void 0:i.scrollHeight)&&void 0!==t?t:0)>(null!==(s=null==a||null===(r=a.current)||void 0===r?void 0:r.clientHeight)&&void 0!==s?s:0)&&n(!0),(null!==(o=null===(l=a.current)||void 0===l?void 0:l.scrollHeight)&&void 0!==o?o:0)<=(null!==(u=null==a||null===(c=a.current)||void 0===c?void 0:c.clientHeight)&&void 0!==u?u:0)&&n(!1))}),[a,e]),[t,a]})(e),l=Object(i.useCallback)((()=>{a((e=>!e))}),[]);return n?s.a.createElement(s.a.Fragment,null,s.a.createElement(f,{"data-test-subj":"expanded-line-clamp"},s.a.createElement("p",null,e)),r&&s.a.createElement(p,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},m)):s.a.createElement(s.a.Fragment,null,null==r||!0===r?s.a.createElement(b,{"data-test-subj":"styled-line-clamp",ref:o,lineClampHeight:t},e):e,r&&s.a.createElement(p,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},d))},v=s.a.memo(g),y=o.a.div.withConfig({displayName:"Indent",componentId:"sc-1pv3muo-0"})(["padding:0 8px;word-break:break-word;"]),h=Object(i.createContext)({}),j=({basicData:e,ruleNote:t,showFullView:n=!1,showTitle:i=!0})=>s.a.createElement(h.Provider,{value:e},i&&s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiSpacer,{size:"l"}),s.a.createElement(a.EuiTitle,{size:"xxxs","data-test-subj":"summary-view-guide"},s.a.createElement("h5",null,l.q)),s.a.createElement(a.EuiSpacer,{size:"s"})),s.a.createElement(y,null,n?s.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-full-view"},s.a.createElement(u.b,null,t)):s.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-clamped"},s.a.createElement(v,{lineClampHeight:4.5},s.a.createElement(u.b,null,t))))),E=s.a.memo(j)},function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return T})),n.d(t,"c",(function(){return M})),n.d(t,"b",(function(){return I}));var a=n(17),i=n(194),s=n(2),r=n.n(s),o=n(23),l=n.n(o),u=n(48),c=n(112),d=n(128),m=n(181),p=n(138),f=n(119),b=n(116),g=n(122),v=n(113),y=n(197),h=n(228),j=n(14),E=n(460),O=n(665),x=n(130);const S=({asEmptyButton:e,children:t,dataProviders:n,filters:o,timeRange:S,keepDataView:k,...w})=>{var T,C;const M=Object(u.useDispatch)(),{showAssistantOverlay:I}=Object(i.j)(),[A]=Object(O.a)(),{discoverStateContainer:P}=Object(E.a)(),_=Object(x.a)("timelineEsqlTabDisabled"),D=Object(s.useMemo)((()=>d.e.getSourcererDataViewsSelector()),[]),{defaultDataView:R,signalIndexName:F}=Object(c.a)((e=>D(e))),N=n&&n.find((e=>"template"===e.type)),L=Object(h.a)({timelineId:g.c.active,timelineType:N?v.l.template:v.l.default}),z=Object(s.useCallback)((()=>{if(I({showOverlay:!1}),n||o){var e,t,a;if("esql"===(null==n||null===(e=n[0])||void 0===e?void 0:e.queryType)||"sql"===(null==n||null===(t=n[0])||void 0===t?void 0:t.queryType))return null===(a=P.current)||void 0===a||a.appState.update({query:{esql:n[0].kqlQuery}}),M(Object(j.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.esql})),void M(Object(j.showTimeline)({id:g.c.active,show:!0}));if(S?L({timeRange:S}):L(),n)switch(M(Object(j.updateDataView)({id:g.c.active,dataViewId:"security-solution-default",indexNames:["logs-*"]})),n[0].queryType){case"eql":M(Object(j.updateEqlOptions)({id:g.c.active,field:"query",value:n[0].kqlQuery})),M(Object(j.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.eql}));break;case"kql":M(Object(j.applyKqlFilterQuery)({id:g.c.active,filterQuery:{kuery:{kind:"kuery",expression:n[0].kqlQuery},serializedQuery:n[0].kqlQuery}})),M(Object(j.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.query}));break;case"dsl":const e={meta:{type:"custom",disabled:!1,negate:!1,alias:n[0].name,key:"query",value:n[0].kqlQuery},query:JSON.parse(n[0].kqlQuery)};M(Object(j.setFilters)({id:g.c.active,filters:[e]})),M(Object(j.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.query}))}o&&M(Object(j.setFilters)({id:g.c.active,filters:o})),k||M(m.d.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:R.id,selectedPatterns:[F||""]})),M(p.b.removeLinkTo([f.a.timeline,f.a.global]))}}),[I,n,o,S,k,M,L,P,R.id,F]),B=A?y.i:y.h,q=!A;return"esql"!==(null==n||null===(T=n[0])||void 0===T?void 0:T.queryType)&&"sql"!==(null==n||null===(C=n[0])||void 0===C?void 0:C.queryType)||!_?e?r.a.createElement(a.EuiButtonEmpty,{"aria-label":B,onClick:z,isDisabled:q,color:"text",flush:"both",size:"xs"},r.a.createElement(a.EuiToolTip,{position:"right",content:B},r.a.createElement(r.a.Fragment,null,t))):r.a.createElement(a.EuiButton,l()({"aria-label":B,isDisabled:q,onClick:z},w),r.a.createElement(a.EuiToolTip,{position:"right",content:B},r.a.createElement(r.a.Fragment,null,t))):null};S.displayName="SendToTimelineButton";const k="securityAssistant",w=e=>e.map((e=>`Rule Name:${e.name}\nRule Description:${e.description}`)).join("\n\n"),T=e=>e.filter((({field:e})=>!e.startsWith("signal."))).reduce(((e,{field:t,values:n})=>({...e,[t]:null!=n?n:[]})),{}),C=["kql","dsl","eql","esql","sql"],M=({messageContent:e,replacements:t})=>null!=t?Object.keys(t).reduce(((e,n)=>e.replaceAll(n,t[n])),e):e,I=e=>e.messages.map((({content:t})=>Object(i.i)(M({messageContent:null!=t?t:"",replacements:e.replacements})))).map(((t,n)=>t.map(((t,i)=>{var s;return{...t,getControlContainer:()=>document.querySelectorAll(`.message-${n} .euiCodeBlock__controls`)[i],button:C.includes(t.type)?r.a.createElement(S,{asEmptyButton:!0,dataProviders:[{id:"assistant-data-provider",name:`Assistant Query from conversation ${e.id}`,enabled:!0,excluded:!1,queryType:t.type,kqlQuery:null!==(s=t.content)&&void 0!==s?s:"",queryMatch:{field:"host.name",operator:":",value:"test"},and:[]}],keepDataView:!0},r.a.createElement(a.EuiIcon,{type:"timeline"})):null}}))))},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return s}));var a=n(4);const i=`${a.Db}/rules/_rule_management_filters`,s=`${a.Db}/rules/_coverage_overview`},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.osquery=function(e,t,n){if(!1===t.startsWith("!{osquery"))return!1;const a=t[9];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i="!{osquery",s={};if("{"===a){let n="",a=0;for(let e=9;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}i+=n;try{s=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse osquery JSON configuration: ${t}`,{line:n.line,column:n.column+9})}}return i+="}",e(i)({type:"osquery",configuration:s})},n.splice(n.indexOf("text"),0,"osquery")}},function(e,t){const n=Object.freeze({loose:!0}),a=Object.freeze({});e.exports=e=>e?"object"!=typeof e?n:e:a},,,,,,function(e,t,n){"use strict";e.exports=n(618)},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.incompatibleTab.dataQualityDashboardConversationId",{defaultMessage:"Data Quality dashboard"})},function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),s=n(395);const r=Object(s.c)(),o=Object(s.c)(),l=()=>{const[e]=Object(a.useState)(r);return{portalNode:e}},u=i.a.memo((()=>{const{portalNode:e}=l();return i.a.createElement(s.b,{node:e})}));u.displayName="TimelineEventsCountBadge";const c=()=>{const[e]=Object(a.useState)(o);return{portalNode:e}},d=i.a.memo((()=>{const{portalNode:e}=c();return i.a.createElement(s.b,{node:e})}));d.displayName="EqlEventsCountBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(23),i=n.n(a),s=n(44),r=n.n(s),o=n(2),l=n.n(o),u=n(17);const c=r()((({loading:e,...t})=>l.a.createElement(u.EuiPanel,i()({},t,{hasBorder:!0})))).withConfig({displayName:"Panel",componentId:"sc-h09jgf-0"})(["position:relative;",""],(({loading:e})=>e&&"\n    overflow: hidden;\n  "));c.displayName="Panel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return r}));const a="kibana.alert.rule.name",i="host.name",s=300,r=500},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),s=n(47),r=n(17),o=n(205);const l=i.a.memo((()=>i.a.createElement(o.a,null,i.a.createElement(r.EuiPageTemplate,null,i.a.createElement(r.EuiPageTemplate.EmptyPrompt,{"data-test-subj":"notFoundPage",iconColor:"default",iconType:"logoElastic",title:i.a.createElement("p",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.pages.fourohfour.pageNotFoundDescription",defaultMessage:"Page not found"}))})))));l.displayName="NotFoundPage"},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}));var a=n(2),i=n.n(a);const s=i.a.createContext(null),r=Object(a.memo)((({upsellingService:e,children:t})=>i.a.createElement(s.Provider,{value:e},t)));r.displayName="UpsellingProvider";const o=()=>{const e=Object(a.useContext)(s);if(!e)throw new Error("UpsellingProviderContext not found");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(23),i=n.n(a),s=n(2),r=n.n(s),o=n(44),l=n.n(o),u=n(17);const c=l.a.span.withConfig({displayName:"EllipsisText",componentId:"sc-saif2w-0"})(["&,& *{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;}"]);function d({tooltipContent:e,children:t,dataTestSubj:n,...a}){return e?r.a.createElement(u.EuiToolTip,{display:"block",content:e},r.a.createElement(c,i()({"data-test-subj":n},a),t)):r.a.createElement(c,i()({"data-test-subj":n},a),t)}c.displayName="EllipsisText"},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"c",(function(){return d}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),s=a.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),r=a.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),o=a.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),l=a.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),u=a.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),c=e=>a.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=a.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(706);const s=()=>{const e=Object(a.useContext)(i.a);if(!e)throw new Error("useDiscoverInTimelineContext should only used within a tree with parent as DiscoverInTimelineContextProvider");return e}},function(e,t,n){e.exports=n(24)(1069)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),s=n(44),r=n.n(s),o=n(17),l=n(146),u=n(380);const c=r()(o.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-1819ayg-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),d=i.a.memo(Object(a.forwardRef)((({id:e,field:t,dataTestSubj:n,idAria:s,bottomRightContent:r},d)=>{const{isInvalid:m,errorMessage:p}=Object(l.i)(t),[f,b]=Object(a.useState)(!1);return i.a.createElement(o.EuiFormRow,{"data-test-subj":n,describedByIds:s?[s]:void 0,error:p,fullWidth:!0,helpText:t.helpText,isInvalid:m||f,label:t.label,labelAppend:t.labelAppend},i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{ref:d,ariaLabel:s,editorId:e,onChange:t.setValue,value:t.value,"data-test-subj":`${n}-markdown-editor`,setIsMarkdownInvalid:b}),r&&i.a.createElement(c,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},r))))})));d.displayName="MarkdownEditorForm"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(48),s=n(119),r=n(112),o=n(128),l=n(181);const u=({inputId:e=s.a.global,inspectIndex:t=0,isDisabled:n,multiple:u=!1,onClick:c,onCloseInspect:d,queryId:m})=>{const p=Object(i.useDispatch)(),f=o.d.globalQueryByIdSelector(),b=o.d.timelineQueryByIdSelector(),{loading:g,inspect:v,selectedInspectIndex:y,isInspected:h}=Object(r.a)((t=>e===s.a.global?f(t,m):b(t,m))),j=Object(a.useCallback)((()=>{c&&c(),p(l.c.setInspectionParameter({id:m,inputId:e,isInspected:!0,selectedInspectIndex:t}))}),[c,p,m,e,t]),E=Object(a.useCallback)((()=>{null!=d&&d(),p(l.c.setInspectionParameter({id:m,inputId:e,isInspected:!1,selectedInspectIndex:t}))}),[d,p,m,e,t]);let O=null,x=null;null!=v&&v.dsl.length>0&&(u?[O,...x]=v.dsl:O=v.dsl[t]);let S=null,k=null;null!=v&&v.response.length>0&&(u?[S,...k]=v.response:S=v.response[t]);const w=Object(a.useMemo)((()=>!g&&y===t&&h),[t,h,g,y]);return{additionalRequests:x,additionalResponses:k,handleClick:j,handleCloseModal:E,isButtonDisabled:Object(a.useMemo)((()=>g||n||null==O||null==S||null==m),[n,g,m,O,S]),isShowingModal:w,loading:g,request:O,response:S}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),s=n(122),r=n(113),o=n(228);const l=({onClick:e,outline:t,title:n,timelineId:a=s.c.active})=>{const{getButton:i}=Object(o.b)({timelineId:a,timelineType:r.l.template,onClick:e});return i({outline:t,title:n})},u=i.a.memo(l);u.displayName="NewTemplateTimeline"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(17),i=n(2),s=n.n(i),r=n(132),o=n(739);const l=s.a.memo((({hideActions:e=[],modalTitle:t,onClose:n,onOpen:i})=>s.a.createElement(a.EuiModal,{"data-test-subj":"open-timeline-modal",maxWidth:1100,onClose:n},s.a.createElement(o.a,{closeModalTimeline:n,hideActions:e,isModal:!0,defaultPageSize:10,onOpenTimeline:i,title:null!=t?t:r.H}))));l.displayName="OpenTimelineModal"},function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return f}));var a=n(45),i=n(113),s=n(592);const r=(e,t)=>"__typename"!==e&&null!=t?t:void 0,o=e=>!Object(a.isEmpty)(e),l=({isAlert:e,isPinned:t,eventHasNotes:n,timelineType:a})=>a===i.l.template?s.b(e):t&&n?s.d(e):t?s.c(e):s.g(e),u=({eventId:e,pinnedEventIds:t})=>!0===t[e],c=({allowUnpinning:e,eventId:t,onPinEvent:n,onUnPinEvent:a,isEventPinned:i})=>{e&&(i?a(t):n(t))},d=(e,t,n)=>e.reduce(((e,a)=>({...e,...t.includes(a._id)?{[a._id]:a.data.filter((e=>n.includes(e.field)))}:{}})),{}),m=e=>{var t;if(!Object(a.isEmpty)(null===(t=e.eql)||void 0===t?void 0:t.sequenceNumber))try{var n,i;const t=(null!==(n=null===(i=e.eql)||void 0===i?void 0:i.sequenceNumber)&&void 0!==n?n:"").split("-")[0];return parseInt(t,10)%2==0}catch{return!1}return!1},p=e=>{var t,n,i,s;return Object(a.isEmpty)(null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n||null===(i=n.rule)||void 0===i?void 0:i.uuid)?Object(a.isEmpty)(null===(s=e.eql)||void 0===s?void 0:s.parentId)?"raw":"eql":"signal"},f="note-content"},function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.flows="flows",e.dns="dns",e.anomalies="anomalies",e.tls="tls",e.http="http",e.events="events"}(a||(a={}))},,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return E}));var a=n(2),i=n.n(a),s=n(44),r=n.n(s);const o=r.a.aside.attrs({className:"siemUtilityBar"}).withConfig({displayName:"Bar",componentId:"sc-yj1vvr-0"})(["",""],(({border:e,theme:t})=>Object(s.css)([""," @media only screen and (min-width:","){display:flex;justify-content:space-between;}"],e&&Object(s.css)(["border-bottom:",";padding-bottom:",";align-items:center;"],t.eui.euiBorderThin,t.eui.euiSizeXS),t.eui.euiBreakpoints.l)));o.displayName="Bar";const l=r.a.div.attrs({className:"siemUtilityBar__section"}).withConfig({displayName:"BarSection",componentId:"sc-yj1vvr-1"})(["",""],(({grow:e,theme:t})=>Object(s.css)(["& + &{margin-top:",";align-items:center;}@media only screen and (min-width:","){display:flex;flex-wrap:wrap;}@media only screen and (min-width:","){& + &{margin-top:0;margin-left:",";}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBreakpoints.l,t.eui.euiSize,e&&Object(s.css)(["flex:1;"]))));l.displayName="BarSection";const u=r.a.div.attrs({className:"siemUtilityBar__group"}).withConfig({displayName:"BarGroup",componentId:"sc-yj1vvr-2"})(["",""],(({grow:e,theme:t})=>Object(s.css)(["align-items:flex-start;display:flex;flex-wrap:wrap;& + &{margin-top:",";}@media only screen and (min-width:","){border-right:",";flex-wrap:nowrap;margin-right:",";padding-right:",";& + &{margin-top:0;}&:last-child{border-right:none;margin-right:0;padding-right:0;}}& > *{margin-right:",";&:last-child{margin-right:0;}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBorderThin,t.eui.euiSizeM,t.eui.euiSizeM,t.eui.euiSize,e&&Object(s.css)(["flex:1;"]))));u.displayName="BarGroup";const c=r.a.p.attrs((({className:e})=>({className:e||"siemUtilityBar__text"}))).withConfig({displayName:"BarText",componentId:"sc-yj1vvr-3"})(["",""],(({shouldWrap:e,theme:t})=>Object(s.css)(["color:",";font-size:",";line-height:",";white-space:",";"],t.eui.euiTextSubduedColor,t.eui.euiFontSizeXS,t.eui.euiLineHeight,e?"normal":"nowrap")));c.displayName="BarText";const d=r.a.div.attrs({className:"siemUtilityBar__action"}).withConfig({displayName:"BarAction",componentId:"sc-yj1vvr-4"})(["",""],(({theme:e})=>Object(s.css)(["font-size:",";"],e.eui.euiFontSizeXS)));d.displayName="BarAction";const m=r.a.div.attrs({className:"siemUtilityBar__spacer"}).withConfig({displayName:"BarSpacer",componentId:"sc-yj1vvr-5"})(["",""],(()=>Object(s.css)(["flex:1;"])));m.displayName="BarSpacer";const p=i.a.memo((({border:e,children:t})=>i.a.createElement(o,{border:e},t)));p.displayName="UtilityBar";var f=n(17),b=n(713);const g=r()(f.EuiButtonEmpty).withConfig({displayName:"LoadingButtonEmpty",componentId:"sc-ou55gk-0"})(["",""],(({theme:e})=>Object(s.css)(["&.euiButtonEmpty{height:",";}"],e.eui.euiSize))),v=i.a.memo((({children:e,color:t,iconSide:n,iconSize:s,iconType:r,popoverContent:o,disabled:l,ownFocus:u,dataTestSubj:c,popoverPanelPaddingSize:d,onClick:m})=>{const[p,g]=Object(a.useState)(!1),v=Object(a.useCallback)((()=>g(!1)),[g]),y=Object(a.useCallback)((()=>{null==m||m(),g(!p)}),[p,m]);return i.a.createElement(f.EuiPopover,{ownFocus:u,panelPaddingSize:d,button:i.a.createElement(b.a,{dataTestSubj:c,color:t,iconSide:n,iconSize:s,iconType:r,disabled:l,onClick:y},e),closePopover:v,isOpen:p,repositionOnScroll:!0},null==o?void 0:o(v))}));v.displayName="Popover";const y=i.a.memo((({children:e,color:t,dataTestSubj:n,disabled:a,href:s,iconSide:r,iconSize:o,iconType:l,ownFocus:u,onClick:c,popoverContent:m,popoverPanelPaddingSize:p,inProgress:f})=>f?i.a.createElement(d,null,i.a.createElement(g,{"data-test-subj":`${n}-progress`,size:"xs",className:"eui-alignTop",isLoading:!0,iconSide:"right",flush:"both"},e)):i.a.createElement(d,{"data-test-subj":n},m?i.a.createElement(v,{dataTestSubj:`${n}-popover`,disabled:a,color:t,iconSide:r,iconSize:o,iconType:l,ownFocus:u,popoverPanelPaddingSize:p,popoverContent:m,onClick:c},e):i.a.createElement(b.a,{color:t,dataTestSubj:`${n}-linkIcon`,disabled:a,href:s,iconSide:r,iconSize:o,iconType:l,onClick:c},e))));y.displayName="UtilityBarAction";const h=i.a.memo((({grow:e,children:t})=>i.a.createElement(u,{grow:e},t)));h.displayName="UtilityBarGroup";const j=i.a.memo((({grow:e,children:t,dataTestSubj:n})=>i.a.createElement(l,{grow:e,"data-test-subj":n},t)));j.displayName="UtilityBarSection",i.a.memo((({dataTestSubj:e})=>i.a.createElement(m,{"data-test-subj":e}))).displayName="UtilityBarSpacer";const E=i.a.memo((({children:e,dataTestSubj:t,shouldWrap:n=!1,className:a})=>i.a.createElement(c,{"data-test-subj":t,shouldWrap:n,className:a},e)));E.displayName="UtilityBarText"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=`${n(4).Db}/fleet/integrations/installed`},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return g}));var a=n(61),i=n.n(a),s=n(294),r=n(198),o=n(51);const l=Object(o.v4)();var u,c,d=n(725);const m=(e,t)=>n=>`${d.g}: ${i()(n).format(e)} ${t?d.f(n):d.e(n)}`,p=[{text:"event.action",value:"event.action"},{text:"event.dataset",value:"event.dataset"},{text:"event.module",value:"event.module"}],f={defaultStackByOption:null!==(u=p.find((e=>"event.action"===e.text)))&&void 0!==u?u:p[0],errorMessage:d.c,histogramType:s.i.events,stackByOptions:p,subtitle:void 0,title:d.d,getLensAttributes:(e="event.action",t={})=>{var n;return{title:"Events",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:l,accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:null!==(n=t.filters)&&void 0!==n?n:[],datasourceStates:{formBased:{layers:{[l]:{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${l}`}]}}},b=[{text:"event.category",value:"event.category"},{text:"event.module",value:"event.module"}],g={defaultStackByOption:null!==(c=b.find((e=>"event.module"===e.text)))&&void 0!==c?c:b[0],errorMessage:d.b,histogramType:s.i.alerts,stackByOptions:b,subtitle:void 0,title:d.a,getLensAttributes:(e="event.module")=>({title:"External alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"a3c54471-615f-4ff9-9fda-69b5b2ea3eef",accessors:["0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"37bdf546-3c11-4b08-8c5d-e37debc44f1d",splitAccessor:"42334c6e-98d9-47a2-b4cb-a445abb44c93"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:[{meta:{index:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{match_phrase:{"event.kind":"alert"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"a3c54471-615f-4ff9-9fda-69b5b2ea3eef":{columns:{"37bdf546-3c11-4b08-8c5d-e37debc44f1d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"0a923af2-c880-4aa3-aa93-a0b9c2801f6d":{label:r.g,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"42334c6e-98d9-47a2-b4cb-a445abb44c93":{label:Object(r.p)(`${e}`),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"0a923af2-c880-4aa3-aa93-a0b9c2801f6d"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["42334c6e-98d9-47a2-b4cb-a445abb44c93","37bdf546-3c11-4b08-8c5d-e37debc44f1d","0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-a3c54471-615f-4ff9-9fda-69b5b2ea3eef"},{type:"index-pattern",name:"723c4653-681b-4105-956e-abef287bf025",id:"{dataViewId}"},{type:"index-pattern",name:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",id:"{dataViewId}"}]})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(45),i=n(429),s=n(2),r=n(561),o=n(405),l=n(194),u=n(154),c=n(215),d=n(720),m=n(520);const p={[c.e]:{id:c.e,isDefault:!0,messages:[],apiConfig:{}},[i.a]:{id:i.a,isDefault:!0,messages:[],apiConfig:{}},[u.yb]:{id:u.yb,isDefault:!0,messages:[],apiConfig:{}},[c.i]:{id:c.i,isDefault:!0,messages:[],apiConfig:{}},[m.a]:{excludeFromLastConversationStorage:!0,id:m.a,isDefault:!0,messages:[],apiConfig:{}},[l.h]:{id:l.h,isDefault:!0,theme:{title:l.e,titleIcon:"logoSecurity",assistant:{name:d.f,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}},messages:[],apiConfig:{}}};var f=n(20),b=n(39);const g=()=>{const e=Object(f.f)(b.SecurityPageName.dataQuality),t=Object(s.useMemo)((()=>e?p:Object(a.unset)(i.a,p)),[e]),[n,l]=Object(r.a)({defaultValue:t,key:o.a,isInvalidDefault:e=>!e});return{conversations:n,setConversations:l}}},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var a=n(51);const i=()=>Object(a.v4)(),s=({prevPromptContexts:e,promptContext:t})=>({...e,[t.id]:{...t}})},function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return s})),n.d(t,"j",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return f}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAriaLabel",{defaultMessage:"Settings"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsTooltip",{defaultMessage:"Settings"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsUpdatedToastTitle",{defaultMessage:"Settings updated"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsConversationsMenuItemTitle",{defaultMessage:"Conversations"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsQuickPromptsMenuItemTitle",{defaultMessage:"Quick Prompts"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsSystemPromptsMenuItemTitle",{defaultMessage:"System Prompts"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAnonymizationMenuItemTitle",{defaultMessage:"Anonymization"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsKnowledgeBaseMenuItemTitle",{defaultMessage:"Knowledge Base"}),m=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsEvaluationMenuItemTitle",{defaultMessage:"Evaluation"}),p=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.modalTitle",{defaultMessage:"System Prompts"}),a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"})),f=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o}));const a=e=>"string"!=typeof e,i=({field:e,list:t,operation:n})=>"add"===n?t.includes(e)?t:[...t,e]:t.filter((t=>t!==e)),s=({field:e,operation:t,selectedPromptContext:n,update:a})=>{const{allow:s,allowReplacement:r}=n;switch(a){case"allow":return{...n,allow:i({field:e,list:s,operation:t})};case"allowReplacement":return{...n,allowReplacement:i({field:e,list:r,operation:t})};default:return n}},r=({currentList:e,setDefaultList:t,update:n,updates:a})=>{const s=a.filter((e=>e.update===n));s.length>0&&t(s.reduce(((e,{field:t,operation:n})=>i({field:t,list:e,operation:n})),e))},o=({defaultAllow:e,defaultAllowReplacement:t,setDefaultAllow:n,setDefaultAllowReplacement:a,updates:i})=>{r({currentList:e,setDefaultList:n,update:"defaultAllow",updates:i}),r({currentList:t,setDefaultList:a,update:"defaultAllowReplacement",updates:i})}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.placeholderText",{defaultMessage:"Select or type to create new..."}),s=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.modelTitle",{defaultMessage:"Model"}),r=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.helpLabel",{defaultMessage:"Model to use for this connector"}),o=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.customOptionText",{defaultMessage:"Create new Model named"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(17),i=n(2),s=n.n(i),r=n(220),o=n(177),l=n(497),u=n(123),c=n(252),d=n(548),m=n(13);const p="ADD_NEW_CONNECTOR",f=s.a.memo((({isDisabled:e=!1,isOpen:t=!1,displayFancy:n,selectedConnectorId:f,onConnectorSelectionChange:b,setIsOpen:g})=>{const{actionTypeRegistry:v,http:y,assistantAvailability:h}=Object(u.b)(),[j,E]=Object(i.useState)(!1),{data:O}=Object(l.a)({http:y}),[x,S]=Object(i.useState)(null),{data:k,isLoading:w,isFetching:T,refetch:C}=Object(r.a)({http:y}),M=Object(i.useMemo)((()=>k?k.map((e=>({...e,connectorTypeTitle:Object(c.a)(v.get(e.actionTypeId))}))):[]),[v,k]),I=w||T,A=e||!h.hasConnectorsReadPrivilege,P=Object(i.useMemo)((()=>({value:p,inputDisplay:o.e,dropdownDisplay:Object(m.jsx)(a.EuiFlexGroup,{gutterSize:"none",key:p},Object(m.jsx)(a.EuiFlexItem,{grow:!0},Object(m.jsx)(a.EuiButtonEmpty,{"data-test-subj":"addNewConnectorButton",href:"#",iconType:"plus",size:"xs"},o.e)),Object(m.jsx)(a.EuiFlexItem,{grow:!1},Object(m.jsx)("div",{style:{width:"24px"}})))})),[]),_=Object(i.useMemo)((()=>M.map((e=>{var t,i;const r=null!==(t=null===(i=Object(c.b)(e))||void 0===i?void 0:i.apiProvider)&&void 0!==t?t:e.connectorTypeTitle,l=e.isPreconfigured?o.r:r;return{value:e.id,"data-test-subj":e.id,inputDisplay:n?n(e.name):e.name,dropdownDisplay:Object(m.jsx)(s.a.Fragment,{key:e.id},Object(m.jsx)("strong",null,e.name),l&&Object(m.jsx)(a.EuiText,{size:"xs",color:"subdued"},Object(m.jsx)("p",null,l)))}}))),[M,n]),D=Object(i.useMemo)((()=>h.hasConnectorsAllPrivilege?[..._,P]:[..._]),[P,h.hasConnectorsAllPrivilege,_]),R=Object(i.useCallback)((()=>{null==g||g(!1),E(!1),S(null)}),[g]),[F,N]=Object(i.useState)(t),L=Object(i.useCallback)((e=>{if(e===p)return N(!1),void E(!0);const t=M.find((t=>t.id===e));t&&b(t)}),[M,b]),z=Object(i.useCallback)((e=>{b({...e,connectorTypeTitle:Object(c.a)(v.get(e.actionTypeId))}),null==C||C(),R()}),[v,R,b,C]);return Object(m.jsx)(s.a.Fragment,null,Object(m.jsx)(a.EuiSuperSelect,{"aria-label":o.f,compressed:!0,"data-test-subj":"connector-selector",disabled:A,hasDividers:!0,isLoading:I,isOpen:F,onChange:L,options:D,valueOfSelected:null!=f?f:""}),j&&Object(m.jsx)(d.a,{actionTypeRegistry:v,actionTypes:O,onClose:()=>E(!1),onSaveConnector:z,onSelectActionType:e=>S(e),selectedActionType:x}))}));f.displayName="ConnectorSelector"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(50),i=n(76),s=n(72),r=n(177);const o=["elastic-assistant, load-action-types"],l=({http:e,toasts:t})=>Object(a.useQuery)(o,(async()=>(await Object(i.loadActionTypes)({http:e,featureId:s.GenerativeAIConnectorFeatureId})).sort(((e,t)=>e.name.localeCompare(t.name)))),{retry:!1,keepPreviousData:!0,staleTime:6e4,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:r.n}))}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(2),i=n.n(a),s=n(17),r=n(495),o=n(13);const l="gpt-3.5-turbo",u=[l,"gpt-4"],c=i.a.memo((({models:e=u,onModelSelectionChange:t,selectedModel:n=u[0]})=>{const[i,l]=Object(a.useState)(e.map((e=>({"data-test-subj":e,label:e})))),c=Object(a.useMemo)((()=>n?[{label:n}]:[]),[n]),d=Object(a.useCallback)((n=>{var a,i;const s=0===n.length?void 0:null!==(a=e.find((e=>{var t;return e===(null===(t=n[0])||void 0===t?void 0:t.label)})))&&void 0!==a?a:null===(i=n[0])||void 0===i?void 0:i.label;null==t||t(s)}),[t,e]),m=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||l([...i,a]),d([a])}),[d,i]),p=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==i.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[d,i]);return Object(o.jsx)(s.EuiComboBox,{"aria-label":r.b,compressed:!0,"data-test-subj":"model-selector",isClearable:!1,placeholder:r.d,customOptionText:`${r.a} {searchValue}`,singleSelection:{asPlainText:!0},options:i,selectedOptions:c,onChange:p,onCreateOption:m,fullWidth:!0})}));c.displayName="ModelSelector"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importStar(n(2)),s=n(2),r=a.__importDefault(n(255)),o=a.__importDefault(n(772));t.default=function(e){return function(t){var n,l;l=i.isValidElement(t)?(n=t).props:t;var u=r.default({buffered:[],time:0,duration:0,paused:!0,muted:!1,volume:1}),c=u[0],d=u[1],m=s.useRef(null),p=function(e,t){return function(n){try{t&&t(n)}finally{e&&e(n)}}},f=function(){return d({paused:!1})},b=function(){return d({paused:!0})},g=function(){var e=m.current;e&&d({muted:e.muted,volume:e.volume})},v=function(){var e=m.current;if(e){var t=e.duration,n=e.buffered;d({duration:t,buffered:o.default(n)})}},y=function(){var e=m.current;e&&d({time:e.currentTime})},h=function(){var e=m.current;e&&d({buffered:o.default(e.buffered)})};n=n?i.cloneElement(n,a.__assign(a.__assign({controls:!1},l),{ref:m,onPlay:p(l.onPlay,f),onPause:p(l.onPause,b),onVolumeChange:p(l.onVolumeChange,g),onDurationChange:p(l.onDurationChange,v),onTimeUpdate:p(l.onTimeUpdate,y),onProgress:p(l.onProgress,h)})):i.createElement(e,a.__assign(a.__assign({controls:!1},l),{ref:m,onPlay:p(l.onPlay,f),onPause:p(l.onPause,b),onVolumeChange:p(l.onVolumeChange,g),onDurationChange:p(l.onDurationChange,v),onTimeUpdate:p(l.onTimeUpdate,y),onProgress:p(l.onProgress,h)}));var j=!1,E={play:function(){var e=m.current;if(e&&!j){var t=e.play();if("object"==typeof t){j=!0;var n=function(){j=!1};t.then(n,n)}return t}},pause:function(){var e=m.current;if(e&&!j)return e.pause()},seek:function(e){var t=m.current;t&&void 0!==c.duration&&(e=Math.min(c.duration,Math.max(0,e)),t.currentTime=e)},volume:function(e){var t=m.current;t&&(e=Math.min(1,Math.max(0,e)),t.volume=e,d({volume:e}))},mute:function(){var e=m.current;e&&(e.muted=!0)},unmute:function(){var e=m.current;e&&(e.muted=!1)}};return s.useEffect((function(){var e=m.current;e&&(d({volume:e.volume,muted:e.muted,paused:e.paused}),l.autoPlay&&e.paused&&E.play())}),[l.src]),[n,c,E,m]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e,t){return"boolean"==typeof t?t:!e};t.default=function(e){return a.useReducer(i,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(502)),r=n(301);t.default=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=null),void 0===n&&(n=null);var a=r.resolveHookState(e);"number"!=typeof a&&console.error("initialValue has to be a number, got "+typeof e),"number"==typeof n?a=Math.max(a,n):null!==n&&console.error("min has to be a number, got "+typeof n),"number"==typeof t?a=Math.min(a,t):null!==t&&console.error("max has to be a number, got "+typeof t);var o=s.default(a),l=o[0],u=o[1];return[l(),i.useMemo((function(){var e=function(e){var a=l(),i=r.resolveHookState(e,a);a!==i&&("number"==typeof n&&(i=Math.max(i,n)),"number"==typeof t&&(i=Math.min(i,t)),a!==i&&u(i))};return{get:l,set:e,inc:function(t){void 0===t&&(t=1);var n=r.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e+n}))},dec:function(t){void 0===t&&(t=1);var n=r.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e-n}))},reset:function(t){void 0===t&&(t=a);var n=r.resolveHookState(t,l());"number"!=typeof n&&console.error("value has to be a number or function returning a number, got "+typeof n),a=n,e(n)}}}),[a,n,t])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(223)),r=n(301);t.default=function(e){var t=i.useRef(r.resolveHookState(e)),n=s.default();return i.useMemo((function(){return[function(){return t.current},function(e){t.current=r.resolveHookState(e,t.current),n()}]}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useState(!1),i=n[0],s=n[1];return a.useEffect((function(){var n=function(){return s(!0)},a=function(){return s(!1)};t&&e&&e.current&&(e.current.addEventListener("mouseover",n),e.current.addEventListener("mouseout",a));var i=e.current;return function(){t&&i&&(i.removeEventListener("mouseover",n),i.removeEventListener("mouseout",a))}}),[t,e]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(302)),r=function(){};t.default=function(e,t,n,a){void 0===t&&(t=r),void 0===n&&(n={}),void 0===a&&(a=[e]);var o=n.event,l=void 0===o?"keydown":o,u=n.target,c=n.options,d=i.useMemo((function(){var n,a="function"==typeof(n=e)?n:"string"==typeof n?function(e){return e.key===n}:n?function(){return!0}:function(){return!1};return function(e){if(a(e))return t(e)}}),a);s.default(l,d,u,c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(504));t.default=function(e){var t=i.useState([!1,null]),n=t[0],a=t[1];return s.default(e,(function(e){return a([!0,e])}),{event:"keydown"},[n]),s.default(e,(function(e){return a([!1,e])}),{event:"keyup"},[n]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef(e);return t.current=e,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){a.useEffect((function(){return e&&e(),function(){t&&t()}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(223)),r=n(301);t.default=function(e){void 0===e&&(e=[]);var t=i.useRef(r.resolveHookState(e)),n=s.default(),a=i.useMemo((function(){var i={set:function(e){t.current=r.resolveHookState(e,t.current),n()},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length&&a.set((function(t){return t.concat(e)}))},updateAt:function(e,t){a.set((function(n){var a=n.slice();return a[e]=t,a}))},insertAt:function(e,t){a.set((function(n){var a=n.slice();return e>a.length?a[e]=t:a.splice(e,0,t),a}))},update:function(e,t){a.set((function(n){return n.map((function(n){return e(n,t)?t:n}))}))},updateFirst:function(e,n){var i=t.current.findIndex((function(t){return e(t,n)}));i>=0&&a.updateAt(i,n)},upsert:function(e,n){var i=t.current.findIndex((function(t){return e(t,n)}));i>=0?a.updateAt(i,n):a.push(n)},sort:function(e){a.set((function(t){return t.slice().sort(e)}))},filter:function(e,t){a.set((function(n){return n.slice().filter(e,t)}))},removeAt:function(e){a.set((function(t){var n=t.slice();return n.splice(e,1),n}))},clear:function(){a.set([])},reset:function(){a.set(r.resolveHookState(e).slice())}};return i.remove=i.removeAt,i}),[]);return[t.current,a]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(256));t.default=function(e){a.default((function(){e()}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(257));t.default=function(e){var t=s.default({docX:0,docY:0,posX:0,posY:0,elX:0,elY:0,elH:0,elW:0}),n=t[0],a=t[1];return i.useEffect((function(){var t=function(t){if(e&&e.current){var n=e.current.getBoundingClientRect(),i=n.left,s=n.top,r=n.width,o=n.height,l=i+window.pageXOffset,u=s+window.pageYOffset,c=t.pageX-l,d=t.pageY-u;a({docX:t.pageX,docY:t.pageY,posX:l,posY:u,elX:c,elY:d,elH:o,elW:r})}};return document.addEventListener("mousemove",t),function(){document.removeEventListener("mousemove",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(40));t.default=function(e,t){void 0===e&&(e=1e12),void 0===t&&(t=0);var n=i.useState(0),a=n[0],r=n[1];return s.default((function(){var n,a,i,s=function(){var t=Math.min(1,(Date.now()-i)/e);r(t),o()},o=function(){n=requestAnimationFrame(s)},l=setTimeout((function(){a=setTimeout((function(){cancelAnimationFrame(n),r(1)}),e),i=Date.now(),o()}),t);return function(){clearTimeout(a),clearTimeout(l),cancelAnimationFrame(n)}}),[e,t]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=parseInt(i.version.substr(0,i.version.indexOf(".")))>15,r=function(e){return"function"==typeof e};t.default=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var l=e.render,u=e.children,c=void 0===u?l:u,d=e.component,m=e.comp,p=void 0===m?d:m;return r(c)?c.apply(void 0,a.__spreadArrays([t],n)):p?i.createElement(p,t):c instanceof Array?s?c:i.createElement.apply(void 0,a.__spreadArrays(["div",null],c)):c&&c instanceof Object?"string"==typeof c.type?c:i.cloneElement(c,Object.assign({},c.props,t)):c||null}},function(e,t,n){!function(e){"use strict";var t,n=[],a="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(t||(t={}));var i,s=function(e){return Object.freeze(e)},r=function(e,t){this.inlineSize=e,this.blockSize=t,s(this)},o=function(){function e(e,t,n,a){return this.x=e,this.y=t,this.width=n,this.height=a,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,s(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),l=function(e){return e instanceof SVGElement&&"getBBox"in e},u=function(e){if(l(e)){var t=e.getBBox(),n=t.width,a=t.height;return!n&&!a}var i=e,s=i.offsetWidth,r=i.offsetHeight;return!(s||r||e.getClientRects().length)},c=function(e){var t;if(e instanceof Element)return!0;var n=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(n&&e instanceof n.Element)},d="undefined"!=typeof window?window:{},m=new WeakMap,p=/auto|scroll/,f=/^tb|vertical/,b=/msie|trident/i.test(d.navigator&&d.navigator.userAgent),g=function(e){return parseFloat(e||"0")},v=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new r((n?t:e)||0,(n?e:t)||0)},y=s({devicePixelContentBoxSize:v(),borderBoxSize:v(),contentBoxSize:v(),contentRect:new o(0,0,0,0)}),h=function(e,t){if(void 0===t&&(t=!1),m.has(e)&&!t)return m.get(e);if(u(e))return m.set(e,y),y;var n=getComputedStyle(e),a=l(e)&&e.ownerSVGElement&&e.getBBox(),i=!b&&"border-box"===n.boxSizing,r=f.test(n.writingMode||""),c=!a&&p.test(n.overflowY||""),d=!a&&p.test(n.overflowX||""),h=a?0:g(n.paddingTop),j=a?0:g(n.paddingRight),E=a?0:g(n.paddingBottom),O=a?0:g(n.paddingLeft),x=a?0:g(n.borderTopWidth),S=a?0:g(n.borderRightWidth),k=a?0:g(n.borderBottomWidth),w=O+j,T=h+E,C=(a?0:g(n.borderLeftWidth))+S,M=x+k,I=d?e.offsetHeight-M-e.clientHeight:0,A=c?e.offsetWidth-C-e.clientWidth:0,P=i?w+C:0,_=i?T+M:0,D=a?a.width:g(n.width)-P-A,R=a?a.height:g(n.height)-_-I,F=D+w+A+C,N=R+T+I+M,L=s({devicePixelContentBoxSize:v(Math.round(D*devicePixelRatio),Math.round(R*devicePixelRatio),r),borderBoxSize:v(F,N,r),contentBoxSize:v(D,R,r),contentRect:new o(O,h,D,R)});return m.set(e,L),L},j=function(e,n,a){var i=h(e,a),s=i.borderBoxSize,r=i.contentBoxSize,o=i.devicePixelContentBoxSize;switch(n){case t.DEVICE_PIXEL_CONTENT_BOX:return o;case t.BORDER_BOX:return s;default:return r}},E=function(e){var t=h(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=s([t.borderBoxSize]),this.contentBoxSize=s([t.contentBoxSize]),this.devicePixelContentBoxSize=s([t.devicePixelContentBoxSize])},O=function(e){if(u(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},x=function(){var e=1/0,t=[];n.forEach((function(n){if(0!==n.activeTargets.length){var a=[];n.activeTargets.forEach((function(t){var n=new E(t.target),i=O(t.target);a.push(n),t.lastReportedSize=j(t.target,t.observedBox),i<e&&(e=i)})),t.push((function(){n.callback.call(n.observer,a,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var a=0,i=t;a<i.length;a++)(0,i[a])();return e},S=function(e){n.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(O(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},k=function(){var e,t=0;for(S(t);n.some((function(e){return e.activeTargets.length>0}));)t=x(),S(t);return n.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:a}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=a),window.dispatchEvent(e)),t>0},w=[],T=function(e){if(!i){var t=0,n=document.createTextNode("");new MutationObserver((function(){return w.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),i=function(){n.textContent="".concat(t?t--:t++)}}w.push(e),i()},C=0,M={attributes:!0,characterData:!0,childList:!0,subtree:!0},I=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],A=function(e){return void 0===e&&(e=0),Date.now()+e},P=!1,_=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t,n=this;if(void 0===e&&(e=250),!P){P=!0;var a=A(e);t=function(){var t=!1;try{t=k()}finally{if(P=!1,e=a-A(),!C)return;t?n.run(1e3):e>0?n.run(e):n.start()}},T((function(){requestAnimationFrame(t)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,M)};document.body?t():d.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),I.forEach((function(t){return d.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),I.forEach((function(t){return d.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),D=function(e){!C&&e>0&&_.start(),!(C+=e)&&_.stop()},R=function(){function e(e,n){this.target=e,this.observedBox=n||t.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=j(this.target,this.observedBox,!0);return e=this.target,!l(e)&&!function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)&&"inline"===getComputedStyle(e).display&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),F=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},N=new WeakMap,L=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},z=function(){function e(){}return e.connect=function(e,t){var n=new F(e,t);N.set(e,n)},e.observe=function(e,t,a){var i=N.get(e),s=0===i.observationTargets.length;L(i.observationTargets,t)<0&&(s&&n.push(i),i.observationTargets.push(new R(t,a&&a.box)),D(1),_.schedule())},e.unobserve=function(e,t){var a=N.get(e),i=L(a.observationTargets,t),s=1===a.observationTargets.length;i>=0&&(s&&n.splice(n.indexOf(a),1),a.observationTargets.splice(i,1),D(-1))},e.disconnect=function(e){var t=this,n=N.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),B=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");z.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!c(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");z.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!c(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");z.unobserve(this,e)},e.prototype.disconnect=function(){z.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();e.ResizeObserver=B,e.ResizeObserverEntry=E,e.ResizeObserverSize=r,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t){const n=/^[0-9]+$/,a=(e,t)=>{const a=n.test(e),i=n.test(t);return a&&i&&(e=+e,t=+t),e===t?0:a&&!i?-1:i&&!a?1:e<t?-1:1};e.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),s=n(44),r=n.n(s),o=n(145);const l=r.a.div.withConfig({displayName:"ProviderContainerComponent",componentId:"sc-11ewwh0-0"})([""," ",""],(({isDragging:e})=>!e&&Object(s.css)(["&{border-radius:2px;padding:0 4px 0 8px;position:relative;z-index:"," !important;&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );background-position:0 0,1px 0,1px -1px,0px 1px;background-size:2px 2px;bottom:2px;content:'';display:block;left:2px;position:absolute;top:2px;width:4px;}}&:hover{&,& .euiBadge,& .euiBadge__text{cursor:move;cursor:grab;}}.",":hover &,tr:hover &{&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}&:hover,&:focus,.",":hover &:hover,.",":focus &:focus,tr:hover &:hover,tr:hover &:focus{background-color:",";&,& a,& a:hover{color:",";}&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}"],(({theme:e})=>e.eui.euiZLevel0),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),o.f,(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),o.f,o.f,(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade))),(({isDragging:e})=>e&&Object(s.css)(["&{z-index:9999 !important;}"])));l.displayName="ProviderContainerComponent";const u=i.a.memo(l);u.displayName="ProviderContainer"},function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"o",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"m",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"i",(function(){return b})),n.d(t,"k",(function(){return g})),n.d(t,"f",(function(){return v})),n.d(t,"e",(function(){return y}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.timeline.tour.subTitle",{defaultMessage:"Recent Timeline improvements"}),s=a.i18n.translate("xpack.securitySolution.timeline.tour.newTimeline.title",{defaultMessage:"Actions are now easier to find"}),r=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.title",{defaultMessage:"The query builder is collapsed by default"}),o=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.description",{defaultMessage:"Click to expand or collapse the query builder."}),l=a.i18n.translate("xpack.securitySolution.timeline.tour.saveTimeline.title",{defaultMessage:"An easier way to save new changes"}),u=a.i18n.translate("xpack.securitySolution.timeline.tour.changeDataView.title",{defaultMessage:"The Data view menu has moved"}),c=a.i18n.translate("xpack.securitySolution.timeline.tour.addToFavorites.title",{defaultMessage:"A new and intuitive way to favorite your Timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.tour.next",{defaultMessage:"Next"}),m=a.i18n.translate("xpack.securitySolution.timeline.tour.finish",{defaultMessage:"Finish tour"}),p=a.i18n.translate("xpack.securitySolution.timeline.tour.exit",{defaultMessage:"Exit tour"}),f=a.i18n.translate("xpack.securitySolution.timeline.tour.save",{defaultMessage:"Save"}),b=a.i18n.translate("xpack.securitySolution.timeline.tour.new",{defaultMessage:"New"}),g=a.i18n.translate("xpack.securitySolution.timeline.tour.open",{defaultMessage:"Open"}),v=a.i18n.translate("xpack.securitySolution.timeline.tour.edit",{defaultMessage:"Edit"}),y=a.i18n.translate("xpack.securitySolution.timeline.tour.dataView",{defaultMessage:"Data view"})},function(e,t,n){"use strict";e.exports=n(869)},function(e,t,n){"use strict";e.exports=n(871)},function(e,t,n){"use strict";e.exports=n(872)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.assistant.conversations.timelineConversationTitle",{defaultMessage:"Timeline"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.topN.closeButtonLabel",{defaultMessage:"Close"}),s=a.i18n.translate("xpack.securitySolution.topN.allEventsSelectLabel",{defaultMessage:"Alerts and events"}),r=a.i18n.translate("xpack.securitySolution.topN.rawEventsSelectLabel",{defaultMessage:"Raw events"}),o=a.i18n.translate("xpack.securitySolution.topN.alertEventsSelectLabel",{defaultMessage:"Detection alerts"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n(4),s=n(469),r=n(121),o=n(112),l=n(128),u=n(116),c=n(202),d=n(190);const m=({applyGlobalQueriesAndFilters:e=!0,extraOptions:t,getLensAttributes:n,lensAttributes:m,scopeId:p=u.SourcererScopeName.default,stackByField:f,title:b})=>{var g,v;const{selectedPatterns:y,dataViewId:h,indicesExist:j}=Object(r.d)(p),E=Object(a.useMemo)((()=>l.d.globalQuerySelector()),[]),O=Object(a.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),x=Object(o.a)(E),S=Object(o.a)(O),[{detailName:k,pageName:w,tabName:T}]=Object(c.a)(),C=Object(a.useMemo)((()=>T===s.a.events?w===i.yc.network?d.h:Object(d.b)(w):[]),[w,T]),M=Object(a.useMemo)((()=>[i.yc.hosts,i.yc.users].indexOf(w)>=0&&null!=k?Object(d.c)(w,k):i.yc.network===w?Object(d.e)(k):[]),[k,w]),I=Object(a.useMemo)((()=>null!=m?m:n&&f&&n(f,t)),[t,n,m,f]),A=Object.values(null!==(g=null==I||null===(v=I.state)||void 0===v?void 0:v.adHocDataViews)&&void 0!==g?g:{}).length>0,P=Object(a.useMemo)((()=>{var t;if(null==m&&(null==n||null==f||0===(null==f?void 0:f.length)))return null;const a=A?[]:Object(d.d)(y);return{...I,...null!=b?{title:b}:{},state:{...I.state,...e?{query:x}:{},filters:[...I.state.filters,...M,...C,...a,...e?S:[]]},references:null==I||null===(t=I.references)||void 0===t?void 0:t.map((e=>({...e,id:h})))}}),[e,I,h,S,n,A,m,M,x,y,f,C,b]);return A||!A&&j?P:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(68),s=n(39),r=n(110),o=n(198);const l=({onAddToCaseClicked:e,lensAttributes:t,timeRange:n})=>{const{cases:l}=Object(r.i)().services,u=l.helpers.canUseCases([s.APP_ID]),c=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:t,timeRange:n},persistableStateAttachmentTypeId:i.LENS_ATTACHMENT_TYPE,type:i.AttachmentType.persistableState}]),[t,n]),d=l.hooks.useCasesAddToExistingCaseModal({onClose:e,successToaster:{title:o.b}});return{onAddToExistingCaseClicked:Object(a.useCallback)((()=>{e&&e(),d.open({getAttachments:()=>c})}),[c,e,d]),disabled:null==t||null==n||!u.create||!u.read}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(68),s=n(39),r=n(110),o=n(198);const l=({onClick:e,timeRange:t,lensAttributes:n})=>{const{cases:l}=Object(r.i)().services,u=l.helpers.canUseCases([s.APP_ID]),c=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:n,timeRange:t},persistableStateAttachmentTypeId:i.LENS_ATTACHMENT_TYPE,type:i.AttachmentType.persistableState}]),[n,t]),d=l.hooks.useCasesAddToNewCaseFlyout({toastContent:o.b});return{onAddToNewCaseClicked:Object(a.useCallback)((()=>{e&&e(),d.open({attachments:c})}),[c,d,e]),disabled:null==n||null==t||!u.create||!u.read}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),s=n(17),r=n(44);const o=n.n(r)()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1tb0fg5-0"})(["flex:1;"]),l=()=>i.a.createElement(o,{alignItems:"center",justifyContent:"center",gutterSize:"none"},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiLoadingSpinner,{size:"xl"}))),u=i.a.memo(l)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(17),i=n(44),s=n.n(i),r=n(2),o=n.n(r),l=n(432),u=n(398),c=n(399);const d=s()(a.EuiPanel).withConfig({displayName:"KpiPanel",componentId:"sc-12zc7xr-0"})(["display:flex;flex-direction:column;position:relative;overflow-x:hidden;overflow-y:",";@media only screen and (min-width:","){","}",""],(({$overflowY:e})=>null!=e?e:"hidden"),(e=>e.theme.eui.euiBreakpoints.m),(({height:e,$toggleStatus:t})=>t&&`\n      height: ${null!=e?e:l.d}px;\n  `),(({$toggleStatus:e})=>e&&`\n    height: ${l.c}px;\n  `)),m=s.a.div.withConfig({displayName:"StackByComboBoxWrapper",componentId:"sc-12zc7xr-1"})(["max-width:400px;width:","px;"],(({width:e})=>e)),p=o.a.forwardRef((({"aria-label":e=c.c,"data-test-subj":t,isDisabled:n=!1,onSelect:i,prepend:s=c.d,selected:l,inputRef:d,width:p=400,dropDownoptions:f,useLensCompatibleFields:b},g)=>{const v=Object(r.useCallback)((e=>{e&&e.length>0?i(e[0].value):i("")}),[i]),y=Object(r.useMemo)((()=>[{label:l,value:l}]),[l]),h=Object(u.b)(b),j=Object(r.useMemo)((()=>null!=f?f:h()),[f,h]),E=Object(r.useMemo)((()=>({asPlainText:!0})),[]);return o.a.createElement(m,{width:p},o.a.createElement(a.EuiComboBox,{"data-test-subj":t,"aria-label":e,inputRef:d,isDisabled:n,placeholder:c.e,prepend:s,ref:g,singleSelection:E,isClearable:!1,sortMatchesBy:"startsWith",options:j,selectedOptions:y,compressed:!0,onChange:v}))}));p.displayName="StackByComboBox"},,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Ce})),n.d(t,"c",(function(){return Me})),n.d(t,"b",(function(){return Ie})),n.d(t,"d",(function(){return Ae}));var a=n(17),i=n(747),s=n(378),r=n(2),o=n.n(r),l=n(9),u=n(47),c=n(5),d=n(23),m=n.n(d);const p=({euiFieldProps:e})=>{const{field:{onChange:t,value:n,name:i},fieldState:{error:l}}=Object(s.useController)({name:"label",defaultValue:""}),u=Object(r.useMemo)((()=>!(null==l||!l.message)),[null==l?void 0:l.message]);return o.a.createElement(a.EuiFormRow,{label:c.i18n.translate("xpack.securitySolution.markdown.osquery.labelFieldText",{defaultMessage:"Label"}),error:null==l?void 0:l.message,isInvalid:u,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({isInvalid:u,onChange:t,value:n,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},f=o.a.memo(p),b=c.i18n.translate("xpack.securitySolution.markdown.osquery.permissionDenied",{defaultMessage:"Permission denied"}),g=()=>o.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:o.a.createElement("h2",null,b),titleSize:"xs",body:o.a.createElement("p",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:o.a.createElement(a.EuiCode,null,"osquery")}}))});var v=n(110);const y=({node:e,onSave:t,onCancel:n})=>{var i,d,m;const p=null!=e,{osquery:b,application:{capabilities:{osquery:y}}}=Object(v.i)().services,h=Object(s.useForm)({defaultValues:{label:null==e||null===(i=e.configuration)||void 0===i?void 0:i.label,query:null==e||null===(d=e.configuration)||void 0===d?void 0:d.query,ecs_mapping:null==e||null===(m=e.configuration)||void 0===m?void 0:m.ecs_mapping}}),j=Object(r.useCallback)((e=>{t(`!{osquery${JSON.stringify(Object(l.pickBy)({query:e.query,label:e.label,ecs_mapping:e.ecs_mapping},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t]),E=Object(r.useMemo)((()=>!(y.runSavedQueries&&y.readSavedQueries||y.writeLiveQueries)),[y.readSavedQueries,y.runSavedQueries,y.writeLiveQueries]),O=Object(r.useMemo)((()=>{if(null!=b&&b.LiveQueryField){const{LiveQueryField:e}=b;return o.a.createElement(s.FormProvider,h,o.a.createElement(f,null),o.a.createElement(a.EuiSpacer,{size:"m"}),o.a.createElement(e,{formMethods:h}))}return null}),[h,b]);return E?o.a.createElement(g,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiModalHeader,null,o.a.createElement(a.EuiModalHeaderTitle,null,o.a.createElement("h1",null,p?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalTitle",defaultMessage:"Edit query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalTitle",defaultMessage:"Add query"})))),o.a.createElement(a.EuiModalBody,null,o.a.createElement(o.a.Fragment,null,O)),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButtonEmpty,{onClick:n},c.i18n.translate("xpack.securitySolution.markdown.osquery.modalCancelButtonLabel",{defaultMessage:"Cancel"})),o.a.createElement(a.EuiButton,{onClick:h.handleSubmit(j),fill:!0},p?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},h=o.a.memo(y),j={name:"osquery",button:{label:"Osquery",iconType:"logoOsquery"},helpText:o.a.createElement("div",null,o.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},"!{osquery{options}}"),o.a.createElement(a.EuiSpacer,{size:"s"})),editor:h};var E=n(411),O=n(44),x=n.n(O),S=n(404),k=n(325),w=n(868),T=n.n(w),C=n(695);const M=x()(a.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-14wavsd-0"})(["> span > img{margin-block-end:0;}"]);var I=n(56),A=n.n(I),P=n(61),_=n.n(P),D=(n(13),n(87)),R=n(53),F=n(117),N=n(54),L=n(122),z=n(172),B=n(559),q=n(121),V=n(116),$=n(113),U=n(153);const Q=e=>e===R.FILTERS.EXISTS?U.b:e===R.FILTERS.PHRASES?U.c:U.d,H={$state:{store:R.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:void 0}},G={and:[],enabled:!0,id:"",name:"",excluded:!1,kqlQuery:"",type:$.a.default,queryMatch:{field:"",value:"",operator:U.b}},W=e=>{const t={...H,meta:{...H.meta,negate:e.excluded,type:e.queryType}};if(e.queryType===R.FILTERS.EXISTS)return{...t,meta:{...t.meta,params:void 0,value:"exists"},query:{exists:{field:e.field}}};if(e.queryType===R.FILTERS.PHRASES){var n;let a=JSON.parse(String(e.value));return"number"===e.valueType?a=a.map(Number):"boolean"===e.valueType&&(a=a.map(Boolean)),{...t,meta:{...t.meta},query:{bool:{minimum_should_match:1,should:null===(n=a)||void 0===n?void 0:n.map((t=>({match_phrase:{[e.field]:t}})))}}}}var a;if(e.queryType===R.FILTERS.PHRASE)return{...t,meta:{...t.meta,params:{query:e.value},value:void 0},query:{match_phrase:{[e.field]:null!==(a=e.value)&&void 0!==a?a:""}}};if(e.queryType===R.FILTERS.RANGE){let n,a;try{const t=JSON.parse(String(e.value));n=t.gte,a=t.lt}catch{n="",a=""}const i={gte:n,lt:a};return{...t,meta:{...t.meta,params:i},query:{range:{[e.field]:i}}}}return t},K=({providers:e,alertData:t})=>{const n=Object(r.useMemo)((()=>e.some((e=>e.some((e=>"range"===e.queryType))))),[e]);return{dataProviders:Object(r.useMemo)((()=>n?[]:((e,t)=>e.map((e=>e.reduce(((e,n,a)=>{const{field:i,value:s,excluded:r,queryType:o}=n,{result:u,matchedBrackets:c}=((e,t)=>{if("number"==typeof e||"boolean"==typeof e)return{result:e,skipped:!0,matchedBrackets:null};const n=/\{{([^}]+)\}}/g,a=e.match(new RegExp(n));let i=e;a&&t&&Object(l.each)(a,(e=>{const n=e.replace(/{{|}}/g,"").trim();if(i.includes(e)){const a=t.find((({field:e})=>e===n));if(a&&a.values){const{values:[t]}=a;i=i.replace(e,t)}}}));const s=new RegExp(n).test(i);return{result:i,skipped:s,matchedBrackets:a}})(s,t),d=!t&&c;if(0===a)return{and:[],enabled:!0,id:JSON.stringify(i+s),name:i,excluded:r,kqlQuery:"",type:d?$.a.template:$.a.default,queryMatch:{field:i,value:u,operator:Q(o)}};{const t={enabled:!0,id:JSON.stringify(i+s),name:i,excluded:r,kqlQuery:"",type:d?$.a.template:$.a.default,queryMatch:{field:i,value:u,operator:Q(o)}};e.and.push(t)}return e}),G))))(e,t)),[t,e,n]),filters:Object(r.useMemo)((()=>n?((e,t)=>{const n=[];for(let t=0;t<e.length;t++){const a=e[t];if(a.length>1){const e=a.map((e=>W(e))),t={$state:{store:R.FilterStateStore.APP_STATE},meta:{type:R.FILTERS.COMBINED,relation:R.BooleanRelation.AND,params:e,index:void 0,disabled:!1,negate:!1}};n.push(t)}else{const e=a[0],t=W(e);n.push(t)}}return n})(e):[]),[n,e,t])}};var J=n(379),Y=n(281),X=n(4);const Z=e=>{var t,n,a,i,s,r;const o=null!==(t=null===(n=e.meta)||void 0===n?void 0:n.key)&&void 0!==t?t:"",l={field:o,excluded:null!==(a=null===(i=e.meta)||void 0===i?void 0:i.negate)&&void 0!==a&&a,queryType:null!==(s=null===(r=e.meta)||void 0===r?void 0:r.type)&&void 0!==s?s:R.FILTERS.PHRASE};if(Object(R.isRangeFilter)(e)){var u;const{gte:t,lt:n}=e.query.range[o],a=JSON.stringify({gte:t,lt:n});return{...l,value:a,queryType:null!==(u=e.meta.type)&&void 0!==u?u:R.FILTERS.RANGE}}if(Object(R.isPhrasesFilter)(e)){var c,d,m,p;const t=typeof(null===(c=e.meta)||void 0===c?void 0:c.params[0]);return{...l,value:JSON.stringify(null!==(d=null===(m=e.meta)||void 0===m?void 0:m.params)&&void 0!==d?d:[]),valueType:t,queryType:null!==(p=e.meta.type)&&void 0!==p?p:R.FILTERS.PHRASES}}var f;if(Object(R.isExistsFilter)(e))return{...l,value:"",queryType:null!==(f=e.meta.type)&&void 0!==f?f:R.FILTERS.EXISTS};if(Object(R.isPhraseFilter)(e)){var b,g,v,y,h,j;const t=typeof(null===(b=e.meta)||void 0===b||null===(g=b.params)||void 0===g?void 0:g.query);return{...l,value:null!==(v=null===(y=e.meta)||void 0===y||null===(h=y.params)||void 0===h?void 0:h.query)&&void 0!==v?v:"",valueType:t,queryType:null!==(j=e.meta.type)&&void 0!==j?j:R.FILTERS.PHRASE}}return{...l,value:"",queryType:R.FILTERS.PHRASE}},ee=e=>e.map((e=>Z(e))),te=e=>!1===e.some(R.isCombinedFilter)?[ee(e)]:e.reduce(((e,t)=>{if(Object(R.isCombinedFilter)(t)){const n=t.meta.params;if(t.meta.relation===R.BooleanRelation.OR){const t=n.map((e=>{const t=te([e]);return Object(l.flatten)(t)}));return[...e,...t]}{const t=te(n);return[...e,...t]}}return[...e,[Z(t)]]}),[]);var ne=n(18),ae=n(65),ie=n.n(ae),se=n(591),re=n.n(se),oe=n(328);function le(e,t,n){var a;if(void 0===t||"undefined"===n)return!1;switch(e.type){case"date":const n="string"==typeof t?ie.a.parse(t):null;return Boolean("string"==typeof t&&n&&n.isValid());case"ip":if("string"==typeof t||"number"==typeof t)try{return Boolean(new N.IpAddress(t))}catch(e){return!1}return!1;case"string":return"string"==typeof t&&null!==(a=e.esTypes)&&void 0!==a&&a.includes(oe.a.VERSION)?Boolean(re()(t)):"string"==typeof t&&t.trim().length>0;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t||"string"==typeof t&&!isNaN(parseFloat(t));default:return!0}}const ue=c.i18n.translate("xpack.securitySolution.markdown.insight.label",{defaultMessage:"Label"}),ce=c.i18n.translate("xpack.securitySolution.markdown.insight.title",{defaultMessage:"Investigate"}),de=c.i18n.translate("xpack.securitySolution.markdown.insight.labelText",{defaultMessage:"Label on the query button."}),me=c.i18n.translate("xpack.securitySolution.markdown.insight.description",{defaultMessage:"Description"}),pe=c.i18n.translate("xpack.securitySolution.markdown.insight.descriptionText",{defaultMessage:"Additional description of the query."}),fe=c.i18n.translate("xpack.securitySolution.markdown.insight.formDescription",{defaultMessage:"Create a query to investigate an alert in Timeline, using a clickable query button in the investigation guide. The button also displays a count of matching documents."}),be=c.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilder",{defaultMessage:"Filters"}),ge=c.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilderText",{defaultMessage:"Create filters to populate the Timeline query builder. To use a value from the alert document, enter the field name in double braces {example} as a custom option in the value field.",values:{example:"{{kibana.alert.example}}"}}),ve=c.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerange",{defaultMessage:"Relative time range"}),ye=c.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerangeText",{defaultMessage:"Select a time range to limit the query, relative to the alert's creation time (optional)."}),he=c.i18n.translate("xpack.securitySolution.markdown.insight.modalCancelButtonLabel",{defaultMessage:"Cancel"}),je=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightProviderError",{defaultMessage:"Unable to parse insight provider configuration"}),Ee="!{investigate",Oe=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:s})=>{const{addError:l}=Object(F.a)();let u=[];try{void 0!==n&&(u=JSON.parse(n))}catch(e){l(e,{title:je})}const{data:c,timestamp:d}=Object(r.useContext)(S.a),{dataProviders:m,filters:p}=K({providers:u,alertData:c}),f=Object(r.useMemo)((()=>{if(i&&s){const e=d?A()(d):A()();return{kind:"absolute",from:Object(Y.e)(i,Y.a,!1,A.a,e.toDate()).toISOString(),to:Object(Y.e)(s,Y.b,!0,A.a,e.toDate()).toISOString()}}return null}),[i,s,d]),{totalCount:b,isQueryLoading:g,oldestTimestamp:y,hasError:h}=(({dataProviders:e,filters:t,relativeTimerange:n})=>{const{uiSettings:a}=Object(v.i)().services,i=Object(r.useMemo)((()=>Object(N.getEsQueryConfig)(a)),[a]),{browserFields:s,selectedPatterns:o,indexPattern:l,dataViewId:u}=Object(q.d)(V.SourcererScopeName.timeline),[c,d]=Object(r.useState)(!1),m=Object(r.useMemo)((()=>{try{if(!1===c)return Object(z.d)({config:i,dataProviders:e,indexPattern:l,browserFields:s,filters:t,kqlQuery:{query:"",language:"kuery"},kqlMode:"filter"})}catch(e){return d(!0),null}}),[s,e,i,c,l,t]),[p,{events:f,totalCount:b}]=Object(B.a)({dataViewId:u,fields:["*"],filterQuery:null==m?void 0:m.filterQuery,id:L.c.active,indexNames:o,language:"kuery",limit:1,runtimeMappings:{},...n?{startDate:null==n?void 0:n.from,endDate:null==n?void 0:n.to}:{}}),[g]=f,y=g&&g.data&&g.data.find((e=>"@timestamp"===e.field));return{isQueryLoading:p,totalCount:b,oldestTimestamp:y&&y.value&&y.value[0],hasError:c}})({dataProviders:m,filters:p,relativeTimerange:f}),j=Object(r.useMemo)((()=>{if(f)return f;if(null!=y)return{kind:"absolute",from:y,to:(new Date).toISOString()};{const{to:e,from:t,fromStr:n,toStr:a}=Object(Y.d)();return{kind:"relative",to:e,from:t,fromStr:n,toStr:a}}}),[y,f]);return g?o.a.createElement(a.EuiLoadingSpinner,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(J.a,{asEmptyButton:!1,isDisabled:h,dataProviders:m,filters:p,timeRange:j,keepDataView:!0,"data-test-subj":"insight-investigate-in-timeline-button"},o.a.createElement(a.EuiIcon,{type:"timeline"}),` ${e} (${_()(b).format("0,0.[000]a")})`),o.a.createElement("div",null,t))},xe=({node:e,onSave:t,onCancel:n})=>{const i=null!=e,{sourcererDataView:c,indexPattern:d}=Object(q.d)(V.SourcererScopeName.default),{unifiedSearch:{ui:{FiltersBuilderLazy:p}},uiSettings:f,fieldFormats:b}=Object(v.i)().services,g=Object(r.useMemo)((()=>null!=c?new D.DataView({spec:c,fieldFormats:b}):null),[c,b]),[y,h]=Object(r.useState)([[]]),j=Object(r.useMemo)((()=>[{value:"0",text:""},...f.get(X.W).map((({display:e},t)=>({value:String(t),text:e})))]),[f]),E=Object(s.useForm)({defaultValues:{label:null==e?void 0:e.label,description:null==e?void 0:e.description,relativeTimerange:(null==e?void 0:e.relativeTimerange)||"0"},shouldUnregister:!0}),O=Object(s.useController)({name:"label",control:E.control}),x=Object(s.useController)({name:"description",control:E.control}),S=Object(s.useController)({name:"relativeTimerange",control:E.control}),k=Object(r.useCallback)((e=>{const t=j.find((t=>t.value===e));if(t&&"0"!==t.value){const e=Number(t.value),n=f.get(X.W);return{relativeFrom:n[e].from,relativeTo:n[e].to}}return{}}),[j,f]),w=Object(r.useCallback)((()=>{t(`${Ee}${JSON.stringify(Object(l.pickBy)({label:O.field.value,description:x.field.value,providers:y,...k(S.field.value)},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t,y,O.field.value,x.field.value,S.field.value,k]),T=Object(r.useCallback)((e=>{h(te(e))}),[]),C=Object(r.useCallback)((e=>{S.field.onChange(e.target.value)}),[S.field]),M=Object(r.useMemo)((()=>{var e;const t=null!==(e=O.field.value)&&void 0!==e?e:"",n=y.flat();return""===t.trim()||0===n.length||n.some((e=>!function(e,t){if(!t||!e.field)return!1;switch(e.queryType){case"phrase":return le(t,e.value,e.valueType);case"phrases":const n="string"==typeof e.value?JSON.parse(`${e.value}`):null;return!(!Array.isArray(n)||!n.length)&&n.every((n=>le(t,n,e.valueType)));case"range":const a=JSON.parse("string"==typeof e.value?e.value:"");return"object"==typeof a&&(!a.gte||le(t,a.gte,e.valueType))&&(!a.lt||le(t,a.lt,e.valueType));case"exists":return!0;default:throw new Error(`Unknown operator type: ${e.queryType}`)}}(e,null==g?void 0:g.getFieldByName(e.field))))}),[O.field.value,y,g]),I=Object(r.useMemo)((()=>{const e=d&&d.getName?d.getName():"*";return[{$state:{store:R.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:e}}]}),[d]),A=Object(ne.b)().isAtLeast("platinum");return o.a.createElement(o.a.Fragment,null,o.a.createElement(we,null,o.a.createElement(a.EuiModalHeaderTitle,null,o.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(a.EuiFlexItem,null,i?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalTitle",defaultMessage:"Edit investigation query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalTitle",defaultMessage:"Add investigation query"}))))),!1===A&&o.a.createElement(a.EuiCallOut,{title:"To add suggested queries to an investigation guide, please upgrade to platinum",iconType:"timeline"}),o.a.createElement(a.EuiModalBody,null,o.a.createElement(s.FormProvider,E,o.a.createElement(a.EuiForm,{fullWidth:!0},o.a.createElement(a.EuiFormRow,{label:fe,fullWidth:!0},o.a.createElement(o.a.Fragment,null)),o.a.createElement(a.EuiFormRow,{label:ue,helpText:de,isInvalid:void 0!==O.field.value&&0===O.field.value.trim().length,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({},E.register("label"),{ref:null,name:"label",onChange:O.field.onChange}))),o.a.createElement(a.EuiFormRow,{label:me,helpText:pe,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({},E.register("description"),{ref:null,name:"description",onChange:x.field.onChange}))),o.a.createElement(a.EuiFormRow,{label:be,helpText:ge,fullWidth:!0},g?o.a.createElement(p,{filters:I,onChange:T,dataView:g,maxDepth:1}):o.a.createElement(o.a.Fragment,null)),o.a.createElement(a.EuiFormRow,{label:ve,helpText:ye,fullWidth:!0},o.a.createElement(a.EuiSelect,m()({},E.register("relativeTimerange"),{ref:null,onChange:C,options:j})))))),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButtonEmpty,{onClick:n},he),o.a.createElement(a.EuiButton,{onClick:E.handleSubmit(w),fill:!0,disabled:M},i?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},Se=o.a.memo(xe),ke=`${Ee}{\n  "label": "Test action",\n  "description": "Click to investigate",\n  "providers": [\n    [\n      {"field": "event.id", "value": "{{kibana.alert.original_event.id}}", "queryType": "phrase", "excluded": "false"}\n    ],\n    [\n      {"field": "event.action", "value": "", "queryType": "exists", "excluded": "false"},\n      {"field": "process.pid", "value": "{{process.pid}}", "queryType": "phrase", "excluded":"false"}\n    ]\n  ]\n}}`;var we=x()(a.EuiModalHeader).withConfig({displayName:"_StyledEuiModalHeader",componentId:"sc-1kbgjgu-0"})(["min-width:700px;"]);const Te=Object(a.getDefaultEuiMarkdownUiPlugins)(),Ce=Object(a.getDefaultEuiMarkdownParsingPlugins)(),Me=Object(a.getDefaultEuiMarkdownProcessingPlugins)(),Ie=[Ee],Ae=({insightsUpsellingMessage:e})=>{const t=Te.map((e=>e.name)),n=(({insightsUpsellingMessage:e})=>({name:"insights",button:{label:null!=e?e:ce,iconType:"timelineWithArrow",isDisabled:!!e},helpText:o.a.createElement("div",null,o.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},ke),o.a.createElement(a.EuiSpacer,{size:"s"})),editor:Se}))({insightsUpsellingMessage:e});if(!1===t.includes(n.name))Te.push(i.b),Te.push(j),Te.push(n);else{const e=Te.findIndex((e=>e.name===n.name));Te[e]=n}return Te};Ce.push((function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){if(!1===t.startsWith(Ee))return!1;const a=t[Ee.length];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i={};if("{"===a){let n="",a=0;for(let e=Ee.length;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}try{return i=JSON.parse(n),e(t)({type:"insight",...i,providers:JSON.stringify(i.providers)})}catch(t){const n=e.now();this.file.fail((e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightConfigError",{values:{err:e},defaultMessage:"Unable to parse insight JSON configuration: {err}"}))(t),{line:n.line,column:n.column+Ee.length})}}return!1};a.locator=(e,t)=>e.indexOf(Ee,t),t.insight=a,n.splice(n.indexOf("text"),0,"insight")})),Ce.push(i.a),Ce.push(E.a),Me[1][1].components.insight=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:s})=>!1===Object(ne.b)().isPlatinumPlus()?o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiButton,{isDisabled:!0,iconSide:"left",iconType:"timeline","data-test-subj":"insight-investigate-in-timeline-button"},`${e}`),o.a.createElement("div",null,t)):o.a.createElement(Oe,{label:e,description:t,providers:n,relativeFrom:i,relativeTo:s}),Me[1][1].components.timeline=i.c,Me[1][1].components.osquery=({configuration:e})=>{var t;const[n,a]=Object(r.useState)(!1),{agentId:i,alertId:s,data:u}=Object(r.useContext)(S.a),d=Object(r.useCallback)((()=>a(!0)),[a]),m=Object(r.useCallback)((()=>a(!1)),[a]),p=Object(r.useMemo)((()=>{const e=Object(l.reduce)(u,((e,t)=>{var n;return{...e,[t.field]:null==t||null===(n=t.values)||void 0===n?void 0:n[0]}}),{});return Object(k.a)(e)}),[u]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(M,{iconType:T.a,onClick:d},null!==(t=e.label)&&void 0!==t?t:c.i18n.translate("xpack.securitySolution.markdown.osquery.runOsqueryButtonLabel",{defaultMessage:"Run Osquery"})),n&&o.a.createElement(C.a,{defaultValues:{...s?{alertIds:[s]}:{},query:e.query,ecs_mapping:e.ecs_mapping,queryField:!1},agentId:i,onClose:m,ecsData:p}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var a=n(17),i=n(2),s=n.n(i),r=n(44),o=n.n(r),l=n(5);const u=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allActionsTooltip",{defaultMessage:"All actions"}),c=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowAction",{defaultMessage:"Allow"}),d=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowByDefaultAction",{defaultMessage:"Allow by default"}),m=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowedColumnTitle",{defaultMessage:"Allowed"}),p=(l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.alwaysSubmenu",{defaultMessage:"Always"}),l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeAction",{defaultMessage:"Anonymize"})),f=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeByDefaultAction",{defaultMessage:"Anonymize by default"}),b=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizedColumnTitle",{defaultMessage:"Anonymized"}),g=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.bulkActions",{defaultMessage:"Bulk actions"}),v=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.defaultsSubmenu",{defaultMessage:"Defaults"}),y=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyAction",{defaultMessage:"Deny"}),h=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyByDefaultAction",{defaultMessage:"Deny by default"}),j=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.fieldColumnTitle",{defaultMessage:"Field"}),E=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.noButtonLabel",{defaultMessage:"No"}),O=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.resetButton",{defaultMessage:"Reset"}),x=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeAction",{defaultMessage:"Unanonymize"}),S=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeByDefaultAction",{defaultMessage:"Unanonymize by default"}),k=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.valuesColumnTitle",{defaultMessage:"Values"}),w=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.yesButtonLabel",{defaultMessage:"Yes"}),T="primary-panel-id",C="secondary-panel-id";var M=n(13);const I=({appliesTo:e,disabled:t,disableAllow:n=!1,disableAnonymize:s=!1,disableDeny:r=!1,disableUnanonymize:o=!1,onListUpdated:l,onlyDefaults:m,selected:b})=>{const[j,E]=Object(i.useState)(!1),O=Object(a.useGeneratedHtmlId)({prefix:"contextEditorBulkActions"}),k=Object(i.useCallback)((()=>E(!1)),[]),w=Object(i.useCallback)((()=>E((e=>!e))),[]),I=Object(i.useMemo)((()=>Object(M.jsx)(a.EuiToolTip,{content:"multipleRows"===e?void 0:u},Object(M.jsx)(a.EuiButtonEmpty,{"data-test-subj":"bulkActionsButton",disabled:t,iconType:"multipleRows"===e?"arrowDown":"boxesVertical",iconSide:"multipleRows"===e?"right":void 0,onClick:w,size:"xs"},"multipleRows"===e?g:null))),[e,t,w]),A=Object(i.useMemo)((()=>(({disableAllow:e,disableAnonymize:t,disableDeny:n,disableUnanonymize:a,closePopover:i,onListUpdated:s,onlyDefaults:r,selected:o})=>{const l=r?T:C,u=r?C:T,m=[r?[]:{icon:"check",name:d,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allow"}))),t=o.map((({field:e})=>({field:e,operation:"add",update:"defaultAllow"})));s([...e,...t])}}].flat(),b=[{id:l,title:v,items:[...m,{icon:"cross",name:h,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allow"}))),t=o.map((({field:e})=>({field:e,operation:"remove",update:"defaultAllow"})));s([...e,...t])}},{icon:"eyeClosed",name:f,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allowReplacement"}))),t=o.map((({field:e})=>({field:e,operation:"add",update:"defaultAllowReplacement"})));s([...e,...t])}},{icon:"eye",name:S,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allowReplacement"}))),t=o.map((({field:e})=>({field:e,operation:"remove",update:"defaultAllowReplacement"})));s([...e,...t])}}]}],g=[{id:u,items:[{disabled:e,icon:"check",name:c,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allow"})));s(e)}},{disabled:n,icon:"cross",name:y,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allow"})));s(e)}},{disabled:t,icon:"eyeClosed",name:p,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allowReplacement"})));s(e)}},{disabled:a,icon:"eye",name:x,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allowReplacement"})));s(e)}},{isSeparator:!0,key:"sep"},{name:v,panel:l}]},...b];return r?b:g})({disableAllow:n,disableAnonymize:s,disableDeny:r,disableUnanonymize:o,closePopover:k,onListUpdated:l,onlyDefaults:m,selected:b})),[k,n,s,r,o,l,m,b]);return Object(M.jsx)(a.EuiPopover,{anchorPosition:"downLeft",button:I,closePopover:k,"data-test-subj":"bulkActions",id:O,isOpen:j,panelPaddingSize:"none"},Object(M.jsx)(a.EuiContextMenu,{initialPanelId:T,panels:A,size:"s"}))},A=s.a.memo(I),P="allowed",_="anonymized",D="field",R=o()(a.EuiButtonEmpty)`
  max-height: 24px;
`;var F=n(388);const N=({onListUpdated:e,onlyDefaults:t,onReset:n,onSelectAll:i,selected:s,totalFields:r})=>Object(M.jsx)(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"toolbar",gutterSize:"none"},Object(M.jsx)(a.EuiFlexItem,{grow:!1},Object(M.jsx)(a.EuiText,{color:"subdued","data-test-subj":"selectedFields",size:"xs"},(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectedFields",{values:{selected:e},defaultMessage:"Selected {selected} fields"}))(s.length))),Object(M.jsx)(a.EuiFlexItem,{grow:!1},Object(M.jsx)(a.EuiButtonEmpty,{"data-test-subj":"selectAllFields",iconType:"pagesSelect",onClick:i,size:"xs"},(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectAllFields",{values:{totalFields:e},defaultMessage:"Select all {totalFields} fields"}))(r))),Object(M.jsx)(a.EuiFlexItem,{grow:!1},Object(M.jsx)(A,{appliesTo:"multipleRows",disabled:0===s.length,onListUpdated:e,onlyDefaults:t,selected:s})),null!=n&&Object(M.jsx)(a.EuiFlexItem,{grow:!0},Object(M.jsx)(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"toolbarTrailingActions",gutterSize:"none",justifyContent:"flexEnd"},Object(M.jsx)(a.EuiFlexItem,{grow:!1},Object(M.jsx)(a.EuiButtonEmpty,{"data-test-subj":"resetFields",iconType:"eraser",onClick:n,size:"xs"},O)))));N.displayName="ToolbarComponent";const L=s.a.memo(N),z={sort:{direction:"desc",field:P}},B={box:{incremental:!0},filters:[{field:P,type:"is",name:m},{field:_,type:"is",name:b}]},q=({allow:e,allowReplacement:t,onListUpdated:n,onReset:s,rawData:r,pageSize:o=10})=>{const[l,u]=Object(i.useState)([]),c=Object(i.useMemo)((()=>({selectable:()=>!0,onSelectionChange:e=>u(e),initialSelected:[]})),[]),d=Object(i.useRef)(null),p=Object(i.useMemo)((()=>(({onListUpdated:e,rawData:t})=>{const n={field:"actions",name:"",render:(n,a)=>Object(M.jsx)(A,{appliesTo:"singleRow",disabled:!1,disableAllow:a.allowed,disableDeny:!a.allowed,disableAnonymize:!a.allowed||a.allowed&&a.anonymized,disableUnanonymize:!a.allowed||a.allowed&&!a.anonymized,onListUpdated:e,onlyDefaults:null==t,selected:[a]}),sortable:!1,width:"36px"},i={field:"rawValues",name:k,render:e=>Object(M.jsx)(a.EuiCode,{"data-test-subj":"rawValues"},e.join(",")),sortable:!1},s=[{field:P,name:m,render:(n,{allowed:i,field:s})=>Object(M.jsx)(a.EuiSwitch,{"data-test-subj":"allowed",checked:i,label:"",showLabel:!1,onChange:()=>{e([{field:s,operation:i?"remove":"add",update:null==t?"defaultAllow":"allow"}]),null==t&&i&&e([{field:s,operation:"remove",update:"defaultAllowReplacement"}])}}),sortable:!0,width:"75px"},{field:_,name:b,render:(n,{allowed:i,anonymized:s,field:r})=>Object(M.jsx)(R,{"data-test-subj":"anonymized",disabled:!i,color:s?"primary":"text",flush:"both",iconType:s?"eyeClosed":"eye",isSelected:!!s,onClick:()=>e([{field:r,operation:s?"remove":"add",update:null==t?"defaultAllowReplacement":"allowReplacement"}])},Object(M.jsx)(a.EuiText,{size:"xs"},s?w:E)),sortable:!0,width:"102px"},{field:D,name:j,sortable:!0,width:"260px"}];return null==t?[...s,n]:[...s,i,n]})({onListUpdated:n,rawData:r})),[n,r]),f=Object(i.useMemo)((()=>(({allow:e,allowReplacement:t,rawData:n})=>{const a=new Set(t),i=new Set(e);return null!==n&&"object"==typeof n?Object.keys(n).sort().reduce(((e,t)=>[...e,{field:t,allowed:Object(F.a)({allowSet:i,field:t}),anonymized:Object(F.b)({allowReplacementSet:a,field:t}),denied:Object(F.c)({allowSet:i,field:t}),rawValues:n[t]}]),[]):e.sort().reduce(((e,t)=>[...e,{field:t,allowed:!0,anonymized:a.has(t),denied:!1,rawValues:[]}]),[])})({allow:e,allowReplacement:t,rawData:r})),[e,t,r]),g=Object(i.useCallback)((()=>{var e;null===(e=d.current)||void 0===e||e.setSelection(f),setTimeout((()=>u(f)),0)}),[f]),v=Object(i.useMemo)((()=>({initialPageSize:o,pageSizeOptions:[5,10,25,50]})),[o]),y=Object(i.useMemo)((()=>Object(M.jsx)(L,{onListUpdated:n,onlyDefaults:null==r,onReset:s,onSelectAll:g,selected:l,totalFields:f.length})),[n,s,g,r,f.length,l]);return Object(M.jsx)(a.EuiInMemoryTable,{allowNeutralSort:!1,childrenBetween:y,columns:p,compressed:!0,"data-test-subj":"contextEditor",isSelectable:!0,itemId:D,items:f,pagination:v,ref:d,search:B,selection:c,sorting:z})};q.displayName="ContextEditorComponent";const V=s.a.memo(q)},function(e,t,n){"use strict";n.d(t,"a",(function(){return W})),n.d(t,"c",(function(){return J})),n.d(t,"b",(function(){return ee}));var a=n(23),i=n.n(a),s=n(17),r=n(114),o=n(2),l=n.n(o),u=n(82),c=n(48),d=n(44),m=n.n(d),p=n(124),f=n(195),b=n(291),g=n(439),v=n(666),y=n(174),h=n(515),j=n(710),E=n(689),O=n(5),x=n(66),S=n(122),k=n(9),w=n(19),T=n(127),C=n(118),M=n(110),I=n(758),A=n(116),P=n(121),_=n(754);const D=({field:e,value:t})=>null==t?e:Array.isArray(t)?`${e} ${t.join(" ")}`:`${e} ${t}`;var R=n(318);const F=l.a.memo((({className:e,Component:t,enablePopOver:n,field:a,flush:i,iconSide:r,iconType:u,isExpandable:c,onClick:d,onFilterAdded:m,ownFocus:p,paddingSize:f,showLegend:b,showTooltip:g=!0,showTopN:v,scopeId:y,title:h,value:j,globalFilters:E})=>{const x=Object(T.isActiveTimeline)(null!=y?y:"")?A.SourcererScopeName.timeline:null!=y&&Object(R.c)(y)?A.SourcererScopeName.detections:A.SourcererScopeName.default,{browserFields:S,indexPattern:k}=Object(P.d)(x),w=null!=u?u:"visBarVertical",C=null!=r?r:"left",M=null!=h?h:(F=a,O.i18n.translate("xpack.securitySolution.hoverActions.showTopTooltip",{values:{fieldName:F},defaultMessage:"Show top {fieldName}"}));var F;const N=Object(o.useMemo)((()=>t?l.a.createElement(t,{"aria-label":M,className:e,"data-test-subj":"show-top-field",icon:w,iconType:w,iconSide:C,flush:i,onClick:d,title:M},M):l.a.createElement(s.EuiButtonIcon,{"aria-label":M,className:"securitySolution__hoverActionButton","data-test-subj":"show-top-field",iconSize:"s",iconType:w,onClick:d})),[t,M,e,i,w,d,C]),L=Object(o.useMemo)((()=>g&&!v?l.a.createElement(s.EuiToolTip,{content:l.a.createElement(_.a,{additionalScreenReaderOnlyContext:D({field:a,value:j}),content:M,shortcut:"t",showShortcut:p})},N):N),[N,M,a,p,g,v,j]),z=Object(o.useMemo)((()=>l.a.createElement(I.a,{browserFields:S,field:a,indexPattern:k,onFilterAdded:m,paddingSize:f,showLegend:b,scopeId:null!=y?y:void 0,toggleTopN:d,globalFilters:E})),[S,a,k,m,f,b,y,d,E]);return c?l.a.createElement(l.a.Fragment,null,N,v&&z):v?n?l.a.createElement(s.EuiPopover,{button:N,isOpen:v,closePopover:d,panelClassName:"withHoverActions__popover","data-test-subj":"showTopNContainer"},z):z:L}));F.displayName="ShowTopNButton";var N=n(14),L=n(112),z=n(129);const B=m.a.div.withConfig({displayName:"AdditionalContent",componentId:"sc-hbiy4s-0"})(["padding:2px;"]);B.displayName="AdditionalContent";const q=m.a.div.withConfig({displayName:"StyledHoverActionsContainer",componentId:"sc-hbiy4s-1"})(["display:flex;"," ",""],(e=>e.$isActive?"\n    .hoverActions-active {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n  ":""),(e=>e.$showOwnFocus?`\n    &:focus-within {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n    &:hover {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n  .timelines__hoverActionButton,\n  .securitySolution__hoverActionButton {\n    opacity: ${e.$showTopN?1:0};\n\n      &:focus {\n        opacity: 1;\n      }\n    }\n  `:"")),V=m()(q).withConfig({displayName:"StyledHoverActionsContainerWithPaddingsAndMinWidth",componentId:"sc-hbiy4s-2"})(["min-width:",";padding:",";position:relative;"],(({$hiddenActionsCount:e})=>138-26*e+"px"),(e=>`0 ${e.theme.eui.euiSizeS}`)),$=({ownFocus:e,showTopN:t})=>!t&&!e,U=l.a.memo((({additionalContent:e=null,closePopOver:t,closeTopN:n,dataProvider:a,dataType:i,draggableId:r,enableOverflowButton:u=!1,applyWidthAndPadding:d=!0,field:m,fieldType:p,isAggregatable:f,goGetTimelineId:b,isObjectArray:g,hideAddToTimeline:v=!1,hideTopN:h=!1,onFilterAdded:j,ownFocus:E,showOwnFocus:I=!0,showTopN:A,scopeId:P,toggleColumn:_,toggleTopN:D,values:R})=>{const[U,Q]=Object(o.useState)(),[H,G]=Object(o.useState)(!1),[W,K]=Object(o.useState)(!1),J=Object(o.useCallback)((()=>{G((e=>!e)),K(!W)}),[W,K]),Y=Object(o.useCallback)((()=>{n&&n(),G(!1),K(!1),t&&t()}),[t,n]),X=Object(o.useRef)(!0),Z=Object(o.useRef)(null);Object(o.useEffect)((()=>{X.current&&null!=b&&null==P&&(X.current=!1,b(!0))}),[b,P]),Object(o.useEffect)((()=>{E&&setTimeout((()=>{var e;null===(e=Z.current)||void 0===e||e.focus()}),0)}),[E]);const ee=Object(o.useCallback)((e=>{if(E)switch(e.key){case"t":Object(x.stopPropagationAndPreventDefault)(e),D();break;case"Enter":break;case"Escape":Object(x.stopPropagationAndPreventDefault)(e);break;default:Q(e)}}),[E,D]),te=P===S.c.casePage,ne=P===S.c.active,ae=P===z.a.entityAnalytics,ie=Object(o.useMemo)((()=>ae&&!ne),[ne,ae]),se=Object(o.useMemo)((()=>(h?1:0)+(ie?2:0)),[ie,h]),{overflowActionItems:re,allActionItems:oe}=(({dataProvider:e,dataType:t,defaultFocusedButtonRef:n,draggableId:a,enableOverflowButton:i,field:r,fieldType:u,isAggregatable:d,handleHoverActionClicked:m,hideFilters:p,hideTopN:f,hideAddToTimeline:b,isCaseView:g,isObjectArray:v,isOverflowPopoverOpen:h,itemsToShow:j=2,onFilterAdded:E,onOverflowButtonClick:O,ownFocus:x,showTopN:I,stKeyboardEvent:A,scopeId:P,toggleColumn:_,toggleTopN:D,values:R})=>{const z=Object(M.i)(),B=Object(c.useDispatch)(),{timelines:q,uiSettings:V}=z.services,{getAddToTimelineButton:$,getColumnToggleButton:U,getCopyButton:Q,getFilterForValueButton:H,getFilterOutValueButton:G,getOverflowButton:W}=q.getHoverActions(),K=Object(o.useMemo)((()=>z.services.data.query.filterManager),[z.services.data.query.filterManager]),J=Object(o.useMemo)((()=>C.b.getTimelineByIdSelector()),[]),Y=Object(L.a)((e=>{var t;return Object(T.isActiveTimeline)(null!=P?P:"")?null===(t=J(e,null!=P?P:""))||void 0===t?void 0:t.filterManager:void 0})),X=Object(o.useMemo)((()=>Object(T.isActiveTimeline)(null!=P?P:"")?null!=Y?Y:new w.FilterManager(V):K),[P,Y,V,K]),Z=Object(o.useCallback)((()=>{e&&!Object(k.isEmpty)(e)&&B(Object(N.addProvider)({id:S.c.active,providers:e instanceof Array?e:[e]}))}),[e,B]),ee=Object(o.useCallback)((()=>{m&&m(),Z()}),[m,Z]),te=Object(o.useMemo)((()=>!p&&null!=R&&(i||!I&&!i)&&!g),[i,p,g,I,R]),ne=v&&"geo_point"!==r||g,ae=Object(o.useMemo)((()=>l.a.createElement(F,{Component:i?s.EuiContextMenuItem:void 0,"data-test-subj":"hover-actions-show-top-n",enablePopOver:!i&&g,field:r,key:"hover-actions-show-top-n",onClick:D,onFilterAdded:E,ownFocus:x,showTopN:I,showTooltip:!i,scopeId:P,value:R})),[i,g,r,D,E,x,I,P,R]),ie=Object(o.useMemo)((()=>[te?l.a.createElement("div",{"data-test-subj":"hover-actions-filter-for",key:"hover-actions-filter-for"},H({defaultFocusedButtonRef:n,field:r,filterManager:X,keyboardEvent:A,onClick:m,onFilterAdded:E,ownFocus:x,showTooltip:!i,value:R})):null,te?l.a.createElement("div",{"data-test-subj":"hover-actions-filter-out",key:"hover-actions-filter-out"},G({field:r,filterManager:X,keyboardEvent:A,onFilterAdded:E,ownFocus:x,onClick:m,showTooltip:!i,value:R})):null,_&&!ne?l.a.createElement("div",{"data-test-subj":"hover-actions-toggle-column",key:"hover-actions-toggle-column"},U({Component:i?s.EuiContextMenuItem:void 0,field:r,isDisabled:v&&"geo_point"!==t,isObjectArray:v,keyboardEvent:A,ownFocus:x,onClick:m,showTooltip:!i,toggleColumn:_,value:R})):null,null==R||null==a&&Object(k.isEmpty)(e)||b?null:l.a.createElement("div",{"data-test-subj":"hover-actions-add-timeline",key:"hover-actions-add-timeline"},$({Component:i?s.EuiContextMenuItem:void 0,dataProvider:e,draggableId:a,field:r,keyboardEvent:A,ownFocus:x,onClick:ee,showTooltip:!i,value:R})),Object(y.e)({fieldType:u,isAggregatable:d,fieldName:r,hideTopN:f})?ae:null,null!=r?l.a.createElement("div",{"data-test-subj":"hover-actions-copy-button",key:"hover-actions-copy-button"},Q({Component:i?s.EuiContextMenuItem:void 0,field:r,isHoverAction:!0,keyboardEvent:A,ownFocus:x,onClick:m,showTooltip:!i,value:R})):null].filter((e=>null!=e))),[e,t,n,a,i,r,u,d,X,$,U,Q,H,G,m,ee,b,f,v,E,x,ne,te,ae,A,_,R]);return{overflowActionItems:Object(o.useMemo)((()=>[...ie.slice(0,j),...i&&j>0&&j<ie.length?[W({closePopOver:m,field:r,keyboardEvent:A,ownFocus:x,onClick:O,showTooltip:!i,value:R,items:I?[ae]:ie.slice(j),isOverflowPopoverOpen:!!h})]:[]].filter((e=>null!=e))),[ie,i,r,W,m,h,j,O,ae,x,I,A,R]),allActionItems:Object(o.useMemo)((()=>!I||i||g?ie:[ae]),[I,i,g,ae,ie])}})({dataProvider:a,dataType:i,defaultFocusedButtonRef:Z,draggableId:r,enableOverflowButton:u&&!te,field:m,fieldType:p,hideFilters:ie,isAggregatable:f,handleHoverActionClicked:Y,hideAddToTimeline:v,hideTopN:h,isCaseView:te,isObjectArray:g,isOverflowPopoverOpen:W,onFilterAdded:j,onOverflowButtonClick:J,ownFocus:E,showTopN:A,stKeyboardEvent:U,toggleColumn:_,toggleTopN:D,values:R,scopeId:P}),le=d?V:q;return l.a.createElement(s.EuiFocusTrap,{disabled:$({ownFocus:E,showTopN:A})},l.a.createElement(le,{"data-test-subj":"hover-actions-container",onKeyDown:ee,$showTopN:A,$showOwnFocus:I,$hiddenActionsCount:se,$isActive:H,className:H?"hoverActions-active":""},l.a.createElement(s.EuiScreenReaderOnly,null,l.a.createElement("p",null,(ue=m,O.i18n.translate("xpack.securitySolution.dragAndDrop.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:ue},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."})))),null!=e&&l.a.createElement(B,null,e),u&&!te?re:oe));var ue}));U.displayName="HoverActions";var Q=n(729);const H=({dataProvider:e,isAggregatable:t,fieldType:n,hideTopN:a,isDraggable:i,onFilterAdded:s,render:r,scopeId:u})=>{const{timelineId:c}=Object(o.useContext)(E.b),{tableId:d}=Object(o.useContext)(Q.b),m=Object(o.useRef)(null),p=Object(o.useRef)(null),[f,b]=Object(o.useState)(!1),[g,v]=Object(o.useState)(!1),h=Object(o.useMemo)((()=>u||(null!=c?c:d)),[u,d,c]),j=Object(o.useCallback)((()=>{b((e=>!e)),v((e=>(e&&setTimeout((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}),0),!1))),setTimeout((()=>{v(!1)}),0)}),[p]),{closeTopN:O,toggleTopN:x,isShowingTopN:S}=(e=>{const[t,n]=Object(o.useState)(!1),a=Object(o.useCallback)((()=>{n((t=>{const n=!t;return e&&e(n),n}))}),[e]);return{closeTopN:Object(o.useCallback)((()=>{n(!1)}),[]),toggleTopN:a,isShowingTopN:t}})(j),k=Object(o.useMemo)((()=>{const t=e.queryMatch.value;return"number"==typeof t||"boolean"==typeof t?t.toString():Array.isArray(t)?t.map((e=>String(e))):t}),[e.queryMatch.value]),w=Object(o.useMemo)((()=>{const o=g&&!S&&(null!==(c=null==(u=m.current)?void 0:u.querySelectorAll(".euiLink"))&&void 0!==c?c:[]).length>0?l.a.createElement(J,{"data-test-subj":`draggable-link-content-${e.queryMatch.field}`},r(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):null;var u,c;return l.a.createElement(U,{additionalContent:o,closeTopN:O,closePopOver:j,dataProvider:e,draggableId:i?Object(y.l)(e.id):void 0,field:e.queryMatch.field,isAggregatable:t,fieldType:n,hideTopN:a,isObjectArray:!1,onFilterAdded:s,ownFocus:g,showOwnFocus:!1,showTopN:S,scopeId:h,toggleTopN:x,values:k})}),[g,S,e,r,O,j,i,t,n,a,s,h,x,k]),T=Object(o.useCallback)((e=>{m.current=e}),[]),C=Object(o.useCallback)((()=>{var e;g||null===(e=p.current)||void 0===e||e.focus()}),[g,p]),M=Object(o.useCallback)((()=>{O(),g&&(v(!1),setTimeout((()=>{C()}),0))}),[C,g,O]),I=Object(o.useCallback)((()=>{v(!0)}),[]);return Object(o.useMemo)((()=>({closePopOverTrigger:f,handleClosePopOverTrigger:j,hoverActionsOwnFocus:g,hoverContent:w,keyboardHandlerRef:p,onCloseRequested:M,onFocus:C,openPopover:I,setContainerRef:T,isShowingTopN:S})),[f,j,g,w,M,C,I,T,S])};var G=n(694);const W=m.a.div.withConfig({displayName:"DragEffects",componentId:"sc-1n4vnmw-0"})([""]);W.displayName="DragEffects";class draggable_wrapper_DragDropErrorBoundary extends l.a.PureComponent{componentDidCatch(){this.forceUpdate()}render(){return this.props.children}}const K=m.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1n4vnmw-1"})(["display:inline-block;max-width:100%;[data-rbd-placeholder-context-id]{display:none !important;}",""],(({disabled:e})=>e&&"\n    [data-rbd-draggable-id]:hover,\n    .euiBadge:hover,\n    .euiBadge__text:hover {\n      cursor: default;\n    }\n  "));K.displayName="Wrapper";const J=m.a.span.withConfig({displayName:"ProviderContentWrapper",componentId:"sc-1n4vnmw-2"})(["> span.euiToolTipAnchor{display:block;}> span.euiToolTipAnchor.eui-textTruncate{display:inline-block;}"]),Y=(e,t)=>t.isDropAnimating?{...e,transitionDuration:"0.00000001s"}:e,X=({dataProvider:e,hideTopN:t=!1,onFilterAdded:n,render:a,fieldType:d="",isAggregatable:m=!1,scopeId:p,truncate:E})=>{const[O,x]=Object(o.useState)(!1),S=e.id.includes(`-${b.a}-`),k=Object(c.useDispatch)(),{closePopOverTrigger:w,handleClosePopOverTrigger:T,hoverActionsOwnFocus:C,hoverContent:M,keyboardHandlerRef:I,onCloseRequested:A,openPopover:P,onFocus:_,setContainerRef:D,isShowingTopN:R}=H({dataProvider:e,hideTopN:t,onFilterAdded:n,render:a,fieldType:d,isAggregatable:m,scopeId:p,truncate:E}),F=Object(o.useCallback)((()=>{S||(k(f.a.registerProvider({provider:e})),x(!0))}),[S,k,e]),N=Object(o.useCallback)((()=>O&&k(f.a.unRegisterProvider({id:e.id}))),[O,k,e.id]);Object(o.useEffect)((()=>()=>{N()}),[N]);const L=Object(o.useCallback)(((t,n)=>l.a.createElement(te,{registerProvider:F},l.a.createElement("div",i()({},t.draggableProps,t.dragHandleProps,{style:Y(t.draggableProps.style,n),ref:t.innerRef,"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(J,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},a(e,t,n))))),[e,F,a]),z=Object(o.useCallback)(((t,n)=>l.a.createElement(h.a,i()({},t.draggableProps,t.dragHandleProps,{ref:e=>{t.innerRef(e),D(e)},"data-test-subj":"providerContainer",isDragging:n.isDragging,registerProvider:F,tabIndex:-1}),l.a.createElement(s.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyField"},l.a.createElement("p",null,e.queryMatch.field)),E&&!n.isDragging?l.a.createElement(g.b,{"data-test-subj":"draggable-truncatable-content"},a(e,t,n)):l.a.createElement(J,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},a(e,t,n)),!n.isDragging&&l.a.createElement(s.EuiScreenReaderOnly,{"data-test-subj":"draggableKeyboardInstructionsNotDragging"},l.a.createElement("p",null,j.b)))),[e,F,a,D,E]),{onBlur:B,onKeyDown:q}=Object(G.a)({closePopover:T,draggableId:Object(y.l)(e.id),fieldName:e.queryMatch.field,keyboardHandlerRef:I,openPopover:P}),V=Object(o.useCallback)((t=>l.a.createElement("div",i()({ref:t.innerRef},t.droppableProps),l.a.createElement("div",{className:r.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:_,onBlur:B,onKeyDown:q,ref:I,role:"button",tabIndex:0},l.a.createElement(u.Draggable,{draggableId:Object(y.l)(e.id),index:0,key:Object(y.l)(e.id),isDragDisabled:S},z)),t.placeholder)),[z,e.id,S,I,B,_,q]),$=Object(o.useMemo)((()=>l.a.createElement(K,{"data-test-subj":"draggableWrapperDiv",disabled:S},l.a.createElement(draggable_wrapper_DragDropErrorBoundary,null,l.a.createElement(u.Droppable,{isDropDisabled:!0,droppableId:Object(y.m)(e.id),renderClone:L},V)))),[V,L,e.id,S]),U=Object(o.useCallback)((()=>$),[$]);return S?l.a.createElement(l.a.Fragment,null,$):l.a.createElement(v.a,{alwaysShow:R||C,closePopOverTrigger:w,hoverContent:M,onCloseRequested:A,render:U})},Z=({dataProvider:e,hideTopN:t=!1,isDraggable:n=!1,onFilterAdded:a,render:i,isAggregatable:s=!1,fieldType:r="",scopeId:u,truncate:c})=>{const{closePopOverTrigger:d,hoverActionsOwnFocus:m,hoverContent:f,onCloseRequested:h,setContainerRef:j,isShowingTopN:E}=H({dataProvider:e,hideTopN:t,isDraggable:n,isAggregatable:s,fieldType:r,onFilterAdded:a,render:i,scopeId:u,truncate:c}),O=Object(o.useCallback)((()=>l.a.createElement("div",{ref:e=>{j(e)},tabIndex:-1,"data-provider-id":Object(y.l)(e.id)},c?l.a.createElement(g.b,{"data-test-subj":"render-truncatable-content"},i(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):l.a.createElement(J,{"data-test-subj":`render-content-${e.queryMatch.field}`},i(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})))),[e,i,j,c]);return n?l.a.createElement(X,{dataProvider:e,hideTopN:t,onFilterAdded:a,fieldType:r,isAggregatable:s,render:i,scopeId:u,truncate:c}):l.a.createElement(v.a,{alwaysShow:E||m,closePopOverTrigger:d,hoverContent:(x=u,[p.e.rulePreview,b.a].includes(null!=x?x:"")?void 0:f),onCloseRequested:h,render:O});var x},ee=l.a.memo(Z);ee.displayName="DraggableWrapper";const te=l.a.memo((({children:e,registerProvider:t})=>(Object(o.useEffect)((()=>{t()}),[t]),l.a.createElement(l.a.Fragment,null,e))));te.displayName="ConditionalPortal"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a=n(2),i=n.n(a),s=n(44),r=n.n(s),o=n(17),l=n(48),u=n(45);const c=n(5).i18n.translate("xpack.securitySolution.components.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"});var d=n(170),m=n(431),p=n(383),f=n(759),b=n(158),g=n(119),v=n(276),y=n(339),h=n(160),j=n(130),E=n(190),O=n(330),x=n(598),S=n(525);const k=({isInitialLoading:e,barChart:t,configs:n,stackByField:a,scopeId:s})=>e?i.a.createElement(S.a,null):i.a.createElement(x.a,{barChart:t,configs:n,stackByField:a,scopeId:s}),w=i.a.memo(k);k.displayName="MatrixHistogramChartContentComponent";var T=n(347);const C=r()(m.a).withConfig({displayName:"HistogramPanel",componentId:"sc-cnfih-0"})(["display:flex;flex-direction:column;",""],(({height:e})=>null!=e?`min-height: ${e}px;`:"")),M=({chartHeight:e,defaultStackByOption:t,endDate:n,errorMessage:s,filterQuery:r,getLensAttributes:m,headerChildren:x,histogramType:S,hideHistogramIfEmpty:k=!1,id:M,indexNames:I,runtimeMappings:A,isPtrIncluded:P,legendPosition:_,lensAttributes:D,mapping:R,onError:F,paddingSize:N="m",panelHeight:L=300,setAbsoluteRangeDatePickerTarget:z=g.a.global,setQuery:B,showInspectButton:q=!1,showLegend:V,showSpacer:$=!0,stackByOptions:U,startDate:Q,subtitle:H,scopeId:G,sourcererScopeId:W,title:K,titleSize:J,yTickFormatter:Y,skip:X,hideQueryToggle:Z=!1,applyGlobalQueriesAndFilters:ee=!0})=>{const te=`${M}-embeddable`,ne=Object(l.useDispatch)(),ae=Object(a.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;ne(Object(b.setAbsoluteRangeDatePicker)({id:z,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[ne,z]),ie=Object(a.useMemo)((()=>Object(p.b)({chartHeight:e,from:Q,legendPosition:_,to:n,onBrushEnd:ae,yTickFormatter:Y,showLegend:V})),[e,Q,_,n,ae,Y,V]),[se,re]=Object(a.useState)(!0),[oe,le]=Object(a.useState)(t);Object(a.useEffect)((()=>{le(t)}),[t]);const ue=Object(a.useCallback)((e=>{var n;le(null!==(n=U.find((t=>t.value===e.target.value)))&&void 0!==n?n:t)}),[t,U]),{toggleStatus:ce,setToggleStatus:de}=Object(h.a)(M),[me,pe]=Object(a.useState)(X||!ce);Object(a.useEffect)((()=>{pe(X||!ce)}),[X,ce]);const fe=Object(a.useCallback)((e=>{de(e),pe(!e)}),[pe,de]),be=Object(j.a)("chartEmbeddablesEnabled"),ge={endDate:n,errorMessage:s,filterQuery:r,histogramType:S,indexNames:I,onError:F,startDate:Q,stackByField:oe.value,runtimeMappings:A,isPtrIncluded:P,skip:me||be},[ve,{data:ye,inspect:he,totalCount:je,refetch:Ee}]=Object(f.a)(ge),Oe=Object(a.useMemo)((()=>null!=K&&"function"==typeof K?K(oe):K),[K,oe]),xe=Object(T.a)({visualizationId:te}),Se=Object(a.useMemo)((()=>{if(se)return null;if("function"==typeof H){if(be){if(!xe||(e=xe[0],!Object.values(null!==(t=e.aggregations)&&void 0!==t?t:{}).some((({buckets:e})=>e.length>0))))return H(0);const n=xe[0].hits.total;return n>=0?H(n):null}return je>=0?H(je):null}var e,t;return H}),[be,se,H,je,xe]),ke=Object(a.useMemo)((()=>!!(je<=0&&k)),[je,k]),we=Object(a.useMemo)((()=>Object(p.c)(ye,R)),[ye,R]);Object(a.useEffect)((()=>{ve||se||B({id:M,inspect:he,loading:ve,refetch:Ee}),se&&we&&ye&&re(!1)}),[we,ye,M,he,be,se,ve,Ee,re,B]);const Te=Object(a.useMemo)((()=>({from:Q,to:n})),[Q,n]),Ce=Object(a.useMemo)((()=>({dnsIsPtrIncluded:null!=P&&P,filters:r?[{query:Object(u.isString)(r)?JSON.parse(r):r,meta:{}}]:void 0})),[P,r]);return ke?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(v.a,{show:!se,targetClassNames:[E.a]},i.a.createElement(C,{"data-test-subj":`${M}Panel`,height:ce?L:void 0,paddingSize:N},ve&&!se&&i.a.createElement(o.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),i.a.createElement(d.a,{id:M,height:ce?void 0:0,title:Oe,titleSize:J,toggleStatus:ce,toggleQuery:Z?void 0:fe,subtitle:Se,inspectMultiple:!0,showInspectButton:q&&!be,isInspectDisabled:void 0===r},i.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},(m||D)&&Te&&!be&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(y.a,{className:"histogram-viz-actions",extraOptions:Ce,getLensAttributes:m,isInspectButtonDisabled:void 0===r,lensAttributes:D,queryId:M,stackByField:oe.value,timerange:Te,title:K})),i.a.createElement(o.EuiFlexItem,{grow:!1},U.length>1&&i.a.createElement(o.EuiSelect,{onChange:ue,options:U,prepend:c,value:null==oe?void 0:oe.value})),i.a.createElement(o.EuiFlexItem,{grow:!1},x))),ce?be?i.a.createElement(O.a,{scopeId:W,applyGlobalQueriesAndFilters:ee,"data-test-subj":"embeddable-matrix-histogram",extraOptions:Ce,getLensAttributes:m,height:null!=e?e:150,id:te,inspectTitle:K,lensAttributes:D,stackByField:oe.value,timerange:Te}):i.a.createElement(w,{isInitialLoading:se,barChart:we,configs:ie,stackByField:oe.value,scopeId:G}):null)),$&&i.a.createElement(o.EuiSpacer,{"data-test-subj":"spacer",size:"l"}))},I=i.a.memo(M)},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(17),i=n(2),s=n.n(i),r=n(44),o=n.n(r),l=n(5);const u=l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.anonymizeFieldsdDescription",{defaultMessage:"Anonymized"});var c=n(372),d=n(13);const m=o()(a.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeS};
`,p=({anonymized:e,isDataAnonymizable:t,showIcon:n=!1})=>{const s=Object(i.useMemo)((()=>(e=>e?"default":"subdued")(t)),[t]),r=Object(i.useMemo)((()=>(({anonymized:e,isDataAnonymizable:t})=>t&&0!==e?(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.fieldsWillBeAnonymizedTooltip",{values:{anonymized:e},defaultMessage:"{anonymized} {anonymized, plural, =1 {field} other {fields}} in this context will be replaced with random values. Responses are automatically translated back to the original values."}))(e):(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.noneOfTheDataWillBeAnonymizedTooltip",{values:{isDataAnonymizable:e},defaultMessage:"{isDataAnonymizable, select, true {Select fields to be replaced with random values. Responses are automatically translated back to the original values.} other {This context cannot be anonymized}}"}))(t))({anonymized:e,isDataAnonymizable:t})),[e,t]),o=Object(i.useMemo)((()=>Object(d.jsx)(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n&&Object(d.jsx)(m,{grow:!1},Object(d.jsx)(a.EuiIcon,{color:s,"data-test-subj":"anonymizationIcon",size:"m",type:"eyeClosed"})),Object(d.jsx)(a.EuiFlexItem,{grow:!1},Object(d.jsx)(a.EuiText,{color:s,"data-test-subj":"description",size:"s"},u)))),[s,n]);return Object(d.jsx)(a.EuiToolTip,{content:r},Object(d.jsx)(a.EuiStat,{"data-test-subj":"anonymizedFieldsStat",description:o,reverse:!0,titleColor:s,title:e,titleSize:c.a}))};p.displayName="AnonymizedStatComponent";const f=s.a.memo(p)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),s=n(76),r=n(17),o=n(179),l=n(177),u=n(13);const c=Object(o.css)({name:"1les383",styles:".euiKeyPadMenuItem__label{white-space:nowrap;overflow:hidden;}"}),d=({actionTypes:e,actionTypeRegistry:t,onClose:n,onSelect:a})=>e&&e.length>0?Object(u.jsx)(r.EuiModal,{onClose:n,"data-test-subj":"action-type-selector-modal"},Object(u.jsx)(r.EuiModalHeader,null,Object(u.jsx)(r.EuiModalHeaderTitle,null,l.m)),Object(u.jsx)(r.EuiModalBody,null,Object(u.jsx)(r.EuiFlexGroup,null,e.map((e=>{const n=t.get(e.id);return Object(u.jsx)(r.EuiFlexItem,{"data-test-subj":"action-option",key:e.id,grow:!1},Object(u.jsx)(r.EuiKeyPadMenuItem,{className:c,key:e.id,isDisabled:!e.enabled,label:e.name,"data-test-subj":`action-option-${e.name}`,onClick:()=>a(e)},Object(u.jsx)(r.EuiIcon,{size:"xl",type:n.iconClass})))}))))):null,m=i.a.memo((({actionTypeRegistry:e,actionTypes:t,onClose:n,onSaveConnector:a,onSelectActionType:i,selectedActionType:r})=>r?Object(u.jsx)(s.ConnectorAddModal,{actionType:r,actionTypeRegistry:e,onClose:n,postSaveEventHandler:a}):Object(u.jsx)(d,{actionTypes:t,actionTypeRegistry:e,onClose:n,onSelect:i})));m.displayName="AddConnectorModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneralPrompt",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-code portal into your Elastic life. In time, I will be able to answer questions and provide assistance across all your information in Elastic, and oh-so much more. Till then, I hope this early preview will open your mind to the possibilities of what we can create when we work together, in the open. Cheers!"}),s=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneral2Prompt",{defaultMessage:"First things first, we'll need to set up a Generative AI Connector to get this chat experience going! With the Generative AI Connector, you'll be able to configure access to either an OpenAI service or an Amazon Bedrock service, but you better believe you'll be able to deploy your own models within your Elastic Cloud instance and use those here in the future... 😉"}),r=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneral3Prompt",{defaultMessage:"Go ahead and click the add connector button below to continue the conversation!"}),o=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.enterprisePrompt",{defaultMessage:"Elastic AI Assistant is available to Enterprise users only. Please upgrade your license to use this feature."});var l=n(168);const u={id:l.d,theme:{title:l.c,titleIcon:"logoSecurity",assistant:{name:l.b,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}},messages:[{role:"assistant",content:i,timestamp:"",presentation:{delay:2e3,stream:!0}},{role:"assistant",content:s,timestamp:"",presentation:{delay:1e3,stream:!0}},{role:"assistant",content:r,timestamp:"",presentation:{delay:1e3,stream:!0}}],apiConfig:{}},c=[{role:"assistant",content:o,timestamp:"",presentation:{delay:2e3,stream:!0}}]},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),s=n(743),r=n(67),o=n(110),l=n(39),u=n(164);const c=({attributes:e})=>{const{lens:t,theme:n,i18n:c}=Object(o.i)().services,{SaveModalComponent:d,canUseEditor:m}=t,p=Object(u.m)(),{redirectTo:f,getEditOrCreateDashboardPath:b}=(({getSecuritySolutionUrl:e})=>{const{navigateTo:t}=Object(o.j)(),n=Object(a.useMemo)((()=>`${e({deepLinkId:l.SecurityPageName.dashboards})}`),[e]),i=Object(a.useCallback)((e=>null!=e&&"new"!==e?`${e}/edit`:"/create"),[]),s=Object(a.useCallback)((t=>`${e({deepLinkId:l.SecurityPageName.dashboards,path:i(t)})}`),[i,e]);return{redirectTo:Object(a.useCallback)((e=>{"listing"===e.destination&&t({url:n}),"dashboard"===e.destination&&t({url:s(e.id)})}),[n,s,t]),getEditOrCreateDashboardPath:i,getEditOrCreateDashboardUrl:s,dashboardListingUrl:n}})({getSecuritySolutionUrl:p});return{openSaveVisualizationFlyout:Object(a.useCallback)((()=>{const t=document.createElement("div");Object(s.a)(i.a.createElement(d,{initialInput:e,onSave:e=>{Object(r.unmountComponentAtNode)(t)},onClose:()=>{Object(r.unmountComponentAtNode)(t)},originatingApp:l.APP_UI_ID,getOriginatingPath:e=>`${l.SecurityPageName.dashboards}/${b(e)}`,redirectTo:f}),{theme:n,i18n:c})(t)}),[d,e,b,c,f,n]),disableVisualizations:Object(a.useMemo)((()=>!m()||null==e),[e,m])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(13),i=n(17),s=n(2),r=n.n(s),o=n(55),l=n(44),u=n.n(l),c=n(45),d=n(373);const m=u.a.strong`
  margin-right: ${({theme:e})=>e.eui.euiSizeS};
`;var p={name:"16fopk3",styles:"overflow:hidden;&:hover{cursor:pointer;text-decoration:underline;}"};var f=n(123),b=n(221),g=n(259),v=n(251);const y="ADD_NEW_SYSTEM_PROMPT";var h={name:"1bxycju",styles:"min-width:100%"},j={name:"qhxz92",styles:"max-width:100%"};const E=({allSystemPrompts:e,compressed:t=!1,conversation:n,selectedPrompt:l,clearSelectedSystemPrompt:u,isClearable:E=!1,isEditing:O=!1,isDisabled:x=!1,isOpen:S=!1,isSettingsModalVisible:k,onSystemPromptSelectionChange:w,setIsEditing:T,setIsSettingsModalVisible:C,showTitles:M=!1})=>{var I;const{setSelectedSettingsTab:A}=Object(f.b)(),{setApiConfig:P}=Object(b.a)(),[_,D]=Object(s.useState)(S),R=Object(s.useCallback)((()=>D(!1)),[]),F=Object(s.useCallback)((e=>{n&&P({conversationId:n.id,apiConfig:{...n.apiConfig,defaultSystemPromptId:null==e?void 0:e.id}})}),[n,P]),N=Object(s.useMemo)((()=>({value:y,inputDisplay:d.a,dropdownDisplay:Object(a.jsx)(i.EuiFlexGroup,{gutterSize:"none",key:y},Object(a.jsx)(i.EuiFlexItem,{grow:!0},Object(a.jsx)(i.EuiButtonEmpty,{href:"#",iconType:"plus",size:"xs","data-test-subj":"addSystemPrompt"},d.a)),Object(a.jsx)(i.EuiFlexItem,{grow:!1},Object(a.jsx)("div",{style:{width:"24px"}})))})),[]),L=Object(s.useMemo)((()=>(({prompts:e,showTitles:t=!1})=>{var n;return null!==(n=null==e?void 0:e.map((e=>(({content:e,id:t,name:n,showTitles:s=!1})=>({value:t,inputDisplay:Object(a.jsx)(i.EuiText,{color:"subdued","data-test-subj":"systemPromptText",css:p},s?n:e),dropdownDisplay:Object(a.jsx)(r.a.Fragment,null,Object(a.jsx)(m,{"data-test-subj":"name"},n),Object(a.jsx)(i.EuiToolTip,{content:void 0},Object(a.jsx)(i.EuiText,{color:"subdued","data-test-subj":"content",size:"s"},Object(c.isEmpty)(e)?Object(a.jsx)("p",null,d.d):Object(a.jsx)("p",null,e))))}))({...e,showTitles:t}))))&&void 0!==n?n:[]})({prompts:e,showTitles:M})),[e,M]),z=Object(s.useCallback)((t=>{if(t===y)return C(!0),void A(g.d);null!=w?w(t):F(e.find((e=>e.id===t))),null==T||T(!1)}),[e,w,T,C,A,F]),B=Object(s.useCallback)((()=>{F(void 0),null==T||T(!1),null==u||u()}),[u,T,F]),q=Object(s.useCallback)((()=>{null==T||T(!0),D(!0)}),[T]);return Object(a.jsx)(i.EuiFlexGroup,{"data-test-subj":"selectSystemPrompt",gutterSize:"none"},Object(a.jsx)(i.EuiFlexItem,{css:j},O&&Object(a.jsx)(i.EuiFormRow,{css:h},Object(a.jsx)(i.EuiSuperSelect,{popoverProps:{zIndex:o.euiThemeVars.euiZLevel8},compressed:t,"data-test-subj":v.a.PROMPT_SUPERSELECT,fullWidth:!0,hasDividers:!0,itemLayoutAlign:"top",disabled:x,isOpen:_&&!k,onChange:z,onBlur:R,options:[...L,N],placeholder:d.e,valueOfSelected:null!==(I=null==l?void 0:l.id)&&void 0!==I?I:e[0].id}))),Object(a.jsx)(i.EuiFlexItem,{grow:!1},O&&E&&Object(a.jsx)(i.EuiToolTip,{content:d.c},Object(a.jsx)(i.EuiButtonIcon,{"aria-label":d.c,"data-test-subj":"clearSystemPrompt",iconType:"cross",onClick:B})),!O&&Object(a.jsx)(i.EuiToolTip,{content:d.b},Object(a.jsx)(i.EuiButtonIcon,{"aria-label":d.b,"data-test-subj":"addSystemPrompt",iconType:"plus",onClick:q}))))};E.displayName="SelectSystemPromptComponent";const O=r.a.memo(E)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(17),i=n(2),s=n.n(i),r=n(372),o=n(5);const l=o.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedDescription",{defaultMessage:"Allowed"});var u=n(13);const c=({allowed:e,total:t})=>{const n=Object(i.useMemo)((()=>(({allowed:e,total:t})=>o.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedTooltip",{values:{allowed:e,total:t},defaultMessage:"{allowed} of {total} fields in this context are allowed to be included in the conversation"}))({allowed:e,total:t})),[e,t]);return Object(u.jsx)(a.EuiToolTip,{content:n},Object(u.jsx)(a.EuiStat,{"data-test-subj":"allowedStat",description:l,reverse:!0,title:e,titleSize:r.a}))};c.displayName="AllowedStatComponent";const d=s.a.memo(c)},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorGetAlertDescription",{defaultMessage:"Failed to get signal index name"}),s=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorPostAlertDescription",{defaultMessage:"Failed to create signal index"}),r=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.failedToIsolate.title",{defaultMessage:"Failed to isolate host"}),o=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.casesFromAlerts.title",{defaultMessage:"Failed to find associated cases"});a.i18n.translate("xpack.securitySolution.containers.detectionEngine.users.userProfiles.title",{defaultMessage:"Failed to find users"})},,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return k}));var a=n(136),i=n.n(a),s=n(45),r=n(2),o=n(48),l=n(3),u=n(54),c=n(110),d=n(209),m=n(118),p=n(446),f=n(127),b=n(125),g=n(122),v=n(202),y=n(282),h=n(336),j=n(4);const E="timelineEventsQuery",O=[{field:"@timestamp",direction:b.b.asc,type:"date",esTypes:["date"]}],x=e=>({...Object(s.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(s.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(s.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(s.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),S=({dataViewId:e,endDate:t,eqlOptions:n,id:a=E,indexNames:S,fields:k,filterQuery:w,runtimeMappings:T,startDate:C,language:M="kuery",limit:I,sort:A=O,skip:P=!1,timerangeKind:_})=>{const[{pageName:D}]=Object(v.a)(),R=Object(o.useDispatch)(),{data:F}=Object(c.i)().services,N=Object(r.useRef)(s.noop),L=Object(r.useRef)(new AbortController),z=Object(r.useRef)(new l.Subscription),[B,q]=Object(r.useState)(!1),[V,$]=Object(r.useState)(a===g.c.active?y.a.getActivePage():0),[U,Q]=Object(r.useState)(null),H=Object(r.useRef)(null),{startTracking:G}=Object(h.a)(),W=Object(r.useCallback)((()=>{null!=a&&p.a.some((e=>e===a))&&(R(m.a.clearEventsLoading({id:a})),R(m.a.clearEventsDeleted({id:a})))}),[R,a]),K=Object(r.useCallback)((e=>{W(),a===g.c.active&&(y.a.setExpandedDetail({}),y.a.setActivePage(e)),$(e)}),[W,a]),J=Object(r.useCallback)((()=>{null!=N.current&&N.current(),K(0)}),[K]),[Y,X]=Object(r.useState)({id:a,inspect:{dsl:[],response:[]},refetch:J,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:K,refreshedAt:0}),Z=Object(r.useCallback)((async(t,n)=>{if(null==t||""===D||P)return;const i=async()=>{H.current=t,L.current=new AbortController,q(!0);const{endTracking:i}=G({name:`${j.l} timeline events search`});z.current=F.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:L.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(u.isRunningResponse)(e)||(i("success"),q(!1),X((i=>{const s={...i,events:(r=e.edges,r.map((e=>e.node))),inspect:Object(f.getInspectResponse)(e,i.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,refreshedAt:Date.now()};var r;return a===g.c.active&&(y.a.setExpandedDetail({}),y.a.setPageName(D),"eql"===t.language?(y.a.setEqlRequest(t),y.a.setEqlResponse(s)):(y.a.setRequest(t),y.a.setResponse(s))),n&&n(s),s})),z.current.unsubscribe())},error:e=>{i(L.current.signal.aborted?"aborted":"error"),q(!1),F.search.showError(e),z.current.unsubscribe()}})};if(a===g.c.active&&""!==y.a.getPageName()&&D!==y.a.getPageName()){if(y.a.setPageName(D),L.current.abort(),q(!1),"eql"===t.language?(H.current=y.a.getEqlRequest(),N.current=i.bind(null,y.a.getEqlRequest())):(H.current=y.a.getRequest(),N.current=i.bind(null,y.a.getRequest())),X((e=>{const n="eql"===t.language?y.a.getEqlResponse():y.a.getResponse();return null!=n?{...n,refetch:J,loadPage:K}:e})),"eql"!==t.language&&null!=y.a.getResponse())return;if("eql"===t.language&&null!=y.a.getEqlResponse())return}z.current.unsubscribe(),L.current.abort(),await i(),N.current=i}),[D,P,a,G,F.search,e,J,K]);Object(r.useEffect)((()=>{0!==S.length&&Q((e=>{var s,r,o,l,u,c,m;const p=e,f={defaultIndex:null!==(s=null==e?void 0:e.defaultIndex)&&void 0!==s?s:[],filterQuery:null!==(r=null==e?void 0:e.filterQuery)&&void 0!==r?r:"",querySize:null!==(o=null==e||null===(l=e.pagination)||void 0===l?void 0:l.querySize)&&void 0!==o?o:0,sort:null!==(u=null==e?void 0:e.sort)&&void 0!==u?u:O,timerange:null!==(c=null==e?void 0:e.timerange)&&void 0!==c?c:{},runtimeMappings:null!==(m=null==e?void 0:e.runtimeMappings)&&void 0!==m?m:{},...x(p)},v=C&&t?{timerange:{interval:"12h",from:C,to:t}}:{},h={defaultIndex:S,filterQuery:Object(d.a)(w),querySize:I,sort:A,runtimeMappings:T,...v,...x(n)},j=i()(f,h)?V:0,E={defaultIndex:S,factoryQueryType:b.y.all,fieldRequested:k,fields:k,filterQuery:Object(d.a)(w),pagination:{activePage:j,querySize:I},language:M,runtimeMappings:T,sort:A,...v,...n||{}};return V!==j&&($(j),a===g.c.active&&y.a.setActivePage(j)),i()(e,E)?e:E}))}),[R,S,V,t,n,w,a,M,I,C,A,k,T]);const ee=Object(r.useCallback)((async e=>{a===g.c.active&&"absolute"!==_&&i()(H.current,U)||await Z(U,e)}),[a,U,Z,_]);return Object(r.useEffect)((()=>{Object(s.isEmpty)(w)&&X({id:a,inspect:{dsl:[],response:[]},refetch:J,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:K,refreshedAt:0})}),[w,a,J,K]),[B,Y,ee]},k=({dataViewId:e,endDate:t,eqlOptions:n,id:a=E,indexNames:i,fields:s,filterQuery:o,runtimeMappings:l,startDate:u,language:c="kuery",limit:d,sort:m=O,skip:p=!1,timerangeKind:f})=>{const[b,g,v]=S({dataViewId:e,endDate:t,eqlOptions:n,id:a,indexNames:i,fields:s,filterQuery:o,runtimeMappings:l,startDate:u,language:c,limit:d,sort:m,skip:p,timerangeKind:f});return Object(r.useEffect)((()=>{v&&v()}),[v]),[b,g]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(19),s=n(110);const r=()=>{const e=Object(s.i)(),{http:t}=e.services,[n,r]=Object(a.useState)(Object(i.createSavedQueryService)(t));return Object(a.useEffect)((()=>{r(Object(i.createSavedQueryService)(t))}),[t]),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(4),s=n(110);const r=({defaultValue:e,key:t,plugin:n=i.i,isInvalidDefault:r})=>{const{storage:o}=Object(s.i)().services,[l,u]=Object(a.useState)(!1),[c,d]=Object(a.useState)(e),m=Object(a.useCallback)((()=>{const a=o.get(`${n}.${t}`),i=typeof a!=typeof e,s=null!=r&&r(a);d(i||s?e:a)}),[e,r,t,n,o]),p=Object(a.useCallback)((e=>{if("function"==typeof e){const a=e;d((e=>{const i=a(e);return o.set(`${n}.${t}`,i),i}))}else o.set(`${n}.${t}`,e),d(e)}),[t,n,o]);return Object(a.useEffect)((()=>{l||(m(),u(!0))}),[l,m]),[c,p,u]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(45),i=n(2),s=n.n(i),r=n(153),o=n(753);const l=s.a.memo((({dataProvider:e})=>{var t;const[n,l]=Object(i.useState)(!1);return s.a.createElement(o.a,{deleteProvider:a.noop,field:e.queryMatch.displayField||e.queryMatch.field,kqlQuery:e.kqlQuery,isEnabled:e.enabled,isExcluded:e.excluded,providerId:e.id,isPopoverOpen:n,setIsPopoverOpen:l,toggleExcludedProvider:a.noop,toggleEnabledProvider:a.noop,toggleTypeProvider:a.noop,displayValue:String(null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value),val:e.queryMatch.value,operator:e.queryMatch.operator||r.d,type:e.type||r.a.default})}));l.displayName="Provider"},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var a=n(17),i=n(56),s=n.n(i),r=n(2),o=n.n(r),l=n(44),u=n.n(l),c=n(51),d=n(459),m=n(214);d.f;const p=u.a.h3.withConfig({displayName:"TitleText",componentId:"sc-7x1zh4-0"})(["margin:0 5px;cursor:default;user-select:none;"]);p.displayName="TitleText",o.a.memo((({noteIds:e})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{color:"text",size:"l",type:"editorComment"})),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiTitle,{size:"s"},o.a.createElement(p,null,d.e))),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(m.c,{color:"hollow"},e.length))))).displayName="NotesCount";const f=({newNote:e,user:t})=>({created:s.a.utc().toDate(),id:Object(c.v4)(),lastEdit:null,note:e,saveObjectId:null,user:t,version:null}),b=({associateNote:e,newNote:t,updateNewNote:n,updateNote:a,user:i})=>{const s=f({newNote:t,user:i});a(s),e(s.id),n("")}},function(e,t,n){const a=n(304);e.exports=(e,t)=>{const n=a(e,t);return n?n.version:null}},function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var a=n(5);const i=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinTooltip",{values:{isAlert:e},defaultMessage:"Pin {isAlert, select, true{alert} other{event}}"}),s=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.unpinTooltip",{values:{isAlert:e},defaultMessage:"Unpin {isAlert, select, true{alert} other{event}}"}),r=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinnnedWithNotesTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} cannot be unpinned because it has notes"}),o=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),l=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),u=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.disablePinnnedTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} may not be pinned while editing a template timeline"}),c=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.attachAlertToCaseForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Attach the alert or event in row {ariaRowindex} to a case, with columns {columnValues}"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var a=n(17),i=n(2),s=n.n(i),r=n(562);const o="exit-full-screen",l=({fullScreen:e,setFullScreen:t})=>{const n=Object(i.useCallback)((()=>{t(!1)}),[t]),l=Object(i.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),n())}),[n]);return e?s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiWindowEvent,{event:"keydown",handler:l}),s.a.createElement(a.EuiButton,{className:o,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",fill:!0,isDisabled:!e,onClick:n},r.a)):null};l.displayName="ExitFullScreenComponent";const u=s.a.memo(l)},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return r}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.eventsViewer.showingLabel",{defaultMessage:"Showing"}),s=(a.i18n.translate("xpack.securitySolution.eventsViewer.eventsLabel",{defaultMessage:"Events"}),e=>a.i18n.translate("xpack.securitySolution.eventsViewer.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"})),r=a.i18n.translate("xpack.securitySolution.eventsViewer.actionsColumnLabel",{defaultMessage:"Actions"});a.i18n.translate("xpack.securitySolution.eventsViewer.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(17),i=n(2),s=n.n(i),r=n(44),o=n.n(r),l=n(236);const u=o.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-pcodem-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),c=({count:e,onClick:t})=>{const n=Object(i.useCallback)((()=>t&&t()),[t]);return e?t?s.a.createElement(a.EuiLink,{onClick:n},s.a.createElement("b",null,s.a.createElement(l.a,{count:e}))):s.a.createElement("b",null,s.a.createElement(l.a,{count:e})):s.a.createElement(u,null)};c.displayName="ChartLabelComponent";const d=s.a.memo(c)},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return h}));var a=n(17),i=n(2),s=n.n(i),r=n(62),o=n(9),l=n(44),u=n.n(l),c=n(5),d=n(265),m=n(351),p=n(597);const f={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},b=u()(a.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-g5h38u-0"})(["top:",";width:100%;max-width:77px;position:absolute;z-index:1;",""],(({$isChartEmbeddablesEnabled:e,$dataExists:t})=>e&&!t?"66%":"34%;"),(({className:e,$donutTextWrapperStyles:t})=>e&&t?`&.${e} {${t}}`:"")),g=u()(a.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-g5h38u-1"})(["position:relative;align-items:center;"]),v=({children:e,dataExists:t,donutTextWrapperClassName:n,donutTextWrapperStyles:r,isChartEmbeddablesEnabled:o,label:l,title:u})=>{const{euiTheme:c}=Object(a.useEuiTheme)(),d=Object(i.useMemo)((()=>({color:c.colors.disabled})),[c.colors.disabled]),m=o?void 0:"eui-textTruncate";return s.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},s.a.createElement(g,{grow:o},s.a.createElement(b,{$dataExists:t,$donutTextWrapperStyles:r,$isChartEmbeddablesEnabled:o,alignItems:"center",className:n,direction:"column",gutterSize:"none",justifyContent:"center"},s.a.createElement(a.EuiFlexItem,null,u),l&&s.a.createElement(a.EuiFlexItem,{className:m},s.a.createElement(a.EuiToolTip,{content:l},s.a.createElement(a.EuiText,{className:m,size:"s",style:t?void 0:d},l)))),e))},y=s.a.memo(v),h=({data:e,fillColor:t,height:n=90,label:l,legendItems:u,onPartitionClick:b,title:g,totalCount:v})=>{const{baseTheme:h,theme:j}=Object(d.i)(),E=Object(i.useCallback)((e=>{if(b){var t;const n=e.flat(2),a=n.length>0&&"groupByRollup"in n[0]&&null!=(null===(t=n[0])||void 0===t?void 0:t.groupByRollup)?`${n[0].groupByRollup}`:"";Object(o.isEmpty)(a.trim())||b(a.toLowerCase())}}),[b]);return s.a.createElement(y,{dataExists:null!=e&&e.length>0,label:l,title:g,isChartEmbeddablesEnabled:!1},s.a.createElement(s.a.Fragment,null,null==e||null==v||0===v?s.a.createElement(p.a,{size:n}):s.a.createElement(r.Chart,{size:n},s.a.createElement(r.Settings,{theme:[f,j],baseTheme:h,onElementClick:E,locale:c.i18n.getLocale()}),s.a.createElement(r.Partition,{id:"donut-chart",data:e,layout:r.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(r.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]})),u&&(null==u?void 0:u.length)>0&&s.a.createElement(a.EuiFlexItem,null,s.a.createElement(m.a,{legendItems:u,height:n}))))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),s=n(44),r=n.n(s),o=n(17);const l="#FAFBFD",u=r.a.div.withConfig({displayName:"BigRing",componentId:"sc-1m6sj8k-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${l};\n    text-align: center;\n    line-height: ${e}px;`)),c=r.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1m6sj8k-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: ${Object(o.useEuiBackgroundColor)("plain")};\n    display: inline-block;\n    vertical-align: middle;`)),d=({size:e=90,donutWidth:t=20})=>e-t>0?i.a.createElement(u,{size:e,"data-test-subj":"empty-donut"},i.a.createElement(c,{size:e-t,"data-test-subj":"empty-donut-small"})):null,m=i.a.memo(d)},function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n(23),i=n.n(a),s=n(17),r=n(2),o=n.n(r),l=n(5),u=n(62),c=n(45),d=n(324),m=n.n(d),p=n(51),f=n(44),b=n.n(f),g=n(136),v=n.n(g),y=n(174),h=n(110),j=n(383),E=n(283),O=n(226),x=n(293),S=n(724),k=n(265),w=n(351),T=n(339),C=n(276),M=n(190);const I=b()(s.EuiFlexItem).withConfig({displayName:"LegendFlexItem",componentId:"sc-1257qcd-0"})(["overview:hidden;"]),A=e=>null!=e&&!!Object(c.get)("value.length",e)&&(e.value||[]).every((({x:e,y:t})=>Object(c.isNumber)(t)&&t>=0)),P=["y"],_=[e=>Object(O.a)(e.g)?e.g:x.c],D=({data:e,forceHiddenLegend:t=!1,yAxisTitle:n,...a})=>{const s=Object(k.i)(),d=Object(h.l)(),p=Object(c.get)("configs.axis.xTickFormatter",a),f=Object(c.get)("configs.axis.yTickFormatter",a),b=Object(c.getOr)(0,"configs.axis.tickSize",a),g=`stat-items-barchart-${e[0].key}-x`,v=`stat-items-barchart-${e[0].key}-y`,y={...k.e,...m()(Object(c.get)("configs.settings",a),s)},j=Object(r.useMemo)((()=>m()({tickLine:{size:b}},Object(c.getOr)({},"configs.axis.bottom.style",a))),[a,b]),E=Object(r.useMemo)((()=>m()({tickLine:{size:b}},Object(c.getOr)({},"configs.axis.left.style",a))),[a,b]),O=Object(c.get)("configs.axis.bottom.labelFormat",a);return a.width&&a.height?o.a.createElement(u.Chart,null,o.a.createElement(u.Settings,i()({},y,{showLegend:y.showLegend&&!t,locale:l.i18n.getLocale()})),e.map((e=>{var t;const n=e.key;return A(e)?o.a.createElement(u.BarSeries,{id:n,key:n,name:e.key,xScaleType:Object(c.getOr)(u.ScaleType.Linear,"configs.series.xScaleType",a),yScaleType:Object(c.getOr)(u.ScaleType.Linear,"configs.series.yScaleType",a),xAccessor:"x",yAccessors:P,timeZone:d,splitSeriesAccessors:_,data:null!==(t=e.value)&&void 0!==t?t:[],stackAccessors:Object(c.get)("configs.series.stackAccessors",a),color:e.color?e.color:void 0,barSeriesStyle:Object(c.get)("configs.series.barSeriesStyle",a)}):null})),o.a.createElement(u.Axis,{id:g,position:u.Position.Bottom,showOverlappingTicks:!1,style:j,tickFormat:p,labelFormat:O}),o.a.createElement(u.Axis,{id:v,position:u.Position.Left,style:E,tickFormat:f,title:n})):null};D.displayName="BarChartBaseComponent";const R=o.a.memo(D);R.displayName="BarChartBase";const F=[],N=({barChart:e,configs:t,stackByField:n,scopeId:a,visualizationActionsOptions:l})=>{const{ref:u,width:d,height:m}=Object(E.b)(),f=Object(r.useMemo)((()=>null!=e&&null!=n?e.map(((e,t)=>{var i;return{color:null!==(i=e.color)&&void 0!==i?i:t<j.a.length?j.a[t]:void 0,dataProviderId:Object(y.i)(`draggable-legend-item-${Object(p.v4)()}-${n}-${e.key}`),scopeId:a,field:n,value:e.key}})):F),[e,n,a]),b=Object(c.get)("yAxisTitle",t),g=Object(c.get)("customHeight",t),v=Object(c.get)("customWidth",t),h=Object(k.g)(g,m),O=Object(k.h)(v,d),x=Object(r.useMemo)((()=>{return t=e,Array.isArray(t)&&!Object(k.f)(t)&&t.some(A);var t}),[e]);return o.a.createElement(k.d,null,o.a.createElement(C.a,{targetClassNames:[M.a]},x&&e&&o.a.createElement(k.a,{gutterSize:"none"},o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(k.c,{ref:u,height:h},o.a.createElement(R,{configs:t,data:e,yAxisTitle:b,forceHiddenLegend:null!=n,height:h,width:h}))),o.a.createElement(I,{grow:!1},o.a.createElement(w.a,{legendItems:f,height:m}))),!x&&o.a.createElement(S.a,{height:h,width:O,data:e}),null!=l&&o.a.createElement(T.a,i()({},l,{className:"viz-actions"}))))},L=o.a.memo(N,((e,t)=>e.stackByField===t.stackByField&&e.scopeId===t.scopeId&&v()(e.configs,t.configs)&&v()(e.barChart,t.barChart)))},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n(2),i=n(50),s=n(163),r=n(337);const o=["GET",n(341).a],l=e=>Object(i.useQuery)(o,(async({signal:e})=>(await Object(s.m)({signal:e})).stats),{...r.a,...e}),u=()=>{const e=Object(i.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(o,{refetchType:"active"})}),[e])}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(612);n(74),n(268),n(269);var i=a.default({key:"css"}),s=i.flush,r=i.hydrate,o=i.cx,l=i.merge,u=i.getRegisteredStyles,c=i.injectGlobal,d=i.keyframes,m=i.css,p=i.sheet,f=i.cache;t.cache=f,t.css=m,t.cx=o,t.flush=s,t.getRegisteredStyles=u,t.hydrate=r,t.injectGlobal=c,t.keyframes=d,t.merge=l,t.sheet=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(74),i=n(268),s=n(269);function r(e){return e&&e.__esModule?e:{default:e}}var o=r(a);function l(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function u(e,t,n){var a=[],i=s.getRegisteredStyles(e,a,n);return a.length<2?n:i+t(a)}var c=function e(t){for(var n="",a=0;a<t.length;a++){var i=t[a];if(null!=i){var s=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))s=e(i);else for(var r in s="",i)i[r]&&r&&(s&&(s+=" "),s+=r);break;default:s=i}s&&(n&&(n+=" "),n+=s)}}return n};t.default=function(e){var t=o.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered,void 0);return s.insertStyles(t,r,!1),t.key+"-"+r.name};return{css:n,cx:function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return u(t.registered,n,c(a))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var s=i.serializeStyles(n,t.registered);l(t,s)},keyframes:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var s=i.serializeStyles(n,t.registered),r="animation-"+s.name;return l(t,{name:s.name,styles:"@keyframes "+r+"{"+s.styles+"}"}),r},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:s.getRegisteredStyles.bind(null,t.registered),merge:u.bind(null,t.registered,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(614),i=n(616),s=n(418);function r(e){return e&&e.__esModule?e:{default:e}}var o=r(a),l=r(i),u=/[A-Z]|^ms/g,c=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},m=function(e){return null!=e&&"boolean"!=typeof e},p=r(s).default((function(e){return d(e)?e:e.replace(u,"-$&").toLowerCase()})),f=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(c,(function(e,t,n){return g={name:t,styles:n,next:g},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function b(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return g={name:n.name,styles:n.styles,next:g},n.name;if(void 0!==n.styles){var a=n.next;if(void 0!==a)for(;void 0!==a;)g={name:a.name,styles:a.styles,next:g},a=a.next;return n.styles+";"}return function(e,t,n){var a="";if(Array.isArray(n))for(var i=0;i<n.length;i++)a+=b(e,t,n[i])+";";else for(var s in n){var r=n[s];if("object"!=typeof r)null!=t&&void 0!==t[r]?a+=s+"{"+t[r]+"}":m(r)&&(a+=p(s)+":"+f(s,r)+";");else if(!Array.isArray(r)||"string"!=typeof r[0]||null!=t&&void 0!==t[r[0]]){var o=b(e,t,r);switch(s){case"animation":case"animationName":a+=p(s)+":"+o+";";break;default:a+=s+"{"+o+"}"}}else for(var l=0;l<r.length;l++)m(r[l])&&(a+=p(s)+":"+f(s,r[l])+";")}return a}(e,t,n);case"function":if(void 0!==e){var i=g,s=n(e);return g=i,b(e,t,s)}}if(null==t)return n;var r=t[n];return void 0!==r?r:n}var g,v=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var a=!0,i="";g=void 0;var s=e[0];null==s||void 0===s.raw?(a=!1,i+=b(n,t,s)):i+=s[0];for(var r=1;r<e.length;r++)i+=b(n,t,e[r]),a&&(i+=s[r]);v.lastIndex=0;for(var l,u="";null!==(l=v.exec(i));)u+="-"+l[1];return{name:o.default(i)+u,styles:i,next:g}}},function(e,t,n){"use strict";e.exports=n(615)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=0,a=0,i=e.length;i>=4;++a,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(a+2))<<16;case 2:n^=(255&e.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(a)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},function(e,t,n){"use strict";e.exports=n(617)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="undefined"!=typeof document,i=function(e,t,n){var i=e.key+"-"+t.name;(!1===n||!1===a&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,n){var a="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):a+=n+" "})),a},t.insertStyles=function(e,t,n){i(e,t,n);var s=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var r="",o=t;do{var l=e.insert(t===o?"."+s:"",o,e.sheet,!0);a||void 0===l||(r+=l),o=o.next}while(void 0!==o);if(!a&&0!==r.length)return r}},t.registerStyles=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(289),i=n(425),s=n(32);const r=`${s.c}: true`,o=`${s.c}: false`,l=`${s.a}: true`,u=`${s.a}: false`;function c({filter:e,showCustomRules:t,showElasticRules:n,enabled:c,tags:m,excludeRuleTypes:p=[],ruleExecutionStatus:f}){const b=[];var g;return null!=e&&e.length&&b.push(`(${function(e,t=d){return t.map((t=>`${t}: ${Object(i.b)(e)}`)).join(" OR ")}(e)})`),t&&n||(n?b.push(r):t&&b.push(o)),void 0!==c&&b.push(c?l:u),null!=m&&m.length&&b.push(function(e){return`${s.g}:(${e.map(i.b).join(" AND ")})`}(m)),p.length&&b.push("NOT "+(g=p,`${s.d}: (${g.map(i.b).join(" OR ")})`)),f===a.f.succeeded?b.push(`${s.b}: "succeeded"`):f===a.f["partial failure"]?b.push(`${s.b}: "warning"`):f===a.f.failed&&b.push(`${s.b}: "failed"`),b.join(" AND ")}const d=[s.e,s.f.INDEX,s.f.TACTIC_ID,s.f.TACTIC_NAME,s.f.TECHNIQUE_ID,s.f.TECHNIQUE_NAME,s.f.SUBTECHNIQUE_ID,s.f.SUBTECHNIQUE_NAME]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(131),s=a.__importDefault(n(375));t.default=function(e,t){s.default(e,t,i.isDeepEqual)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(49),s=n(707);const r=()=>{const{pathname:e}=Object(i.useLocation)(),t=Object(s.a)();return[Object(a.useMemo)((()=>t(e)),[e,t])]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(17),i=n(114),s=n(2),r=n.n(s),o=n(44);const l=n.n(o)()(a.EuiPopover).withConfig({displayName:"WithHoverActionsPopover",componentId:"sc-1w6un7x-0"})([".euiPopover__anchor{width:100%;}"]),u=r.a.memo((({alwaysShow:e=!1,closePopOverTrigger:t,hoverContent:n,onCloseRequested:a,render:o})=>{const[u,c]=Object(s.useState)(null!=n&&e),[d,m]=Object(s.useState)(!1),[,p]=Object(s.useState)(void 0),f=Object(s.useRef)(null),b=Object(s.useCallback)((()=>{p((e=>{clearTimeout(e)})),m(!1),null!=a&&setTimeout((()=>{a()}))}),[a]),g=Object(s.useCallback)((()=>{p(Number(setTimeout((()=>{document.body.classList.contains(i.d)||m(!0)}),100)))}),[p,m]),v=Object(s.useCallback)((()=>{e||b()}),[e,b]),y=Object(s.useCallback)((e=>{u&&"Escape"===e.key&&v()}),[u,v]),h=Object(s.useMemo)((()=>r.a.createElement("div",{"data-test-subj":"withHoverActionsButton",onMouseEnter:g},o(d))),[g,o,d]);return Object(s.useEffect)((()=>{c(null!=n&&(d||e))}),[n,d,e]),Object(s.useEffect)((()=>{m(!1)}),[t]),Object(s.useEffect)((()=>{var e;u&&(null==f||null===(e=f.current)||void 0===e||e.positionPopoverFluid())}),[n,u]),r.a.createElement("div",{className:e?i.c:"",onMouseLeave:v},r.a.createElement(l,{ref:f,anchorPosition:"downCenter",button:h,closePopover:b,hasArrow:!1,isOpen:u,ownFocus:!1,panelPaddingSize:"none",panelClassName:"withHoverActions__popover",repositionOnScroll:!0},u?r.a.createElement("div",{onKeyDown:y},n):null))}));u.displayName="WithHoverActions"},,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(2),i=n.n(a),s=n(50);class SecuritySolutionQueryClient extends s.QueryClient{constructor(e={}){var t,n,a;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(n=null==e||null===(a=e.defaultOptions)||void 0===a?void 0:a.queries)&&void 0!==n?n:{}}}})}}const r=new SecuritySolutionQueryClient,o=Object(a.memo)((({queryClient:e,children:t})=>{const n=Object(a.useMemo)((()=>e||r),[e]);return i.a.createElement(s.QueryClientProvider,{client:n},t)}));o.displayName="ReactQueryClientProvider"},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return ne}));var a=n(17),i=n(2),s=n.n(i),r=n(44),o=n.n(r),l=n(45),u=n(51),c=n(53),d=n(54),m=n(147),p=n(4),f=n(174),b=n(170),g=n(298),v=n(297),y=n(164),h=n(383),j=n(159),E=n(525),O=n(110),x=n(726),S=n(5),k=n(62),w=n(265),T=n(283),C=n(226),M=n(351),I=n(293);const A=s.a.memo((({chartHeight:e=174,data:t,from:n,legendItems:r,legendPosition:o=k.Position.Right,legendMinWidth:l,loading:u,showLegend:c,to:d,updateDateRange:m})=>{const{baseTheme:p,theme:f}=Object(w.i)(),b=Object(i.useMemo)((()=>["100%",e]),[e]),g=Object(i.useMemo)((()=>["y"]),[]),v=Object(i.useMemo)((()=>[e=>Object(C.a)(e.g)?e.g:I.c]),[]),y=Object(i.useMemo)((()=>Object(T.a)([n,d])),[n,d]);return s.a.createElement(s.a.Fragment,null,u&&s.a.createElement(a.EuiProgress,{"data-test-subj":"loadingPanelAlertsHistogram",size:"xs",position:"absolute",color:"accent"}),s.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!0},s.a.createElement(k.Chart,{size:b},s.a.createElement(k.Settings,{legendPosition:o,onBrushEnd:m,showLegend:c&&0===r.length,showLegendExtra:c,theme:f,baseTheme:p,locale:S.i18n.getLocale()}),s.a.createElement(k.Axis,{id:"alertsHistogramAxisX",position:k.Position.Bottom,tickFormat:y}),s.a.createElement(k.Axis,{id:"alertsHistogramAxisY",position:k.Position.Left}),s.a.createElement(k.HistogramBarSeries,{id:"alertsHistogram",xScaleType:k.ScaleType.Time,yScaleType:k.ScaleType.Linear,xAccessor:"x",yAccessors:g,splitSeriesAccessors:v,data:t}))),s.a.createElement(a.EuiFlexItem,{grow:!1},r.length>0&&s.a.createElement(M.a,{legendItems:r,height:e,minWidth:l}))))}));A.displayName="AlertsHistogram";const P=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.headerTitle",{defaultMessage:"Trend"}),_=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.notAvailableTooltip",{defaultMessage:"Not available for trend view"}),D=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),R=(e,t,n)=>S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.showingAlertsTitle",{values:{totalAlertsFormatted:e,totalAlerts:t,modifier:n},defaultMessage:"Showing: {modifier}{totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"});var F=n(137),N=n(129),L=n(432),z=n(528),B=n(398),q=n(160),V=n(399),$=n(130);const U=Object(u.v4)(),Q=(e="kibana.alert.rule.name",t)=>({title:"Alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:U,accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:null!=t&&t.filters?t.filters:[],datasourceStates:{formBased:{layers:{[U]:{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:e,isBucketed:!0,params:{size:1e3,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"},secondaryFields:[]}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}},internalReferences:[],adHocDataViews:{}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${U}`}]});var H=n(116),G=n(330),W=n(61),K=n.n(W),J=n(347);const Y={value:0,relation:"eq"},X="detections-histogram",Z=o()(a.EuiFlexItem).withConfig({displayName:"ViewAlertsFlexItem",componentId:"sc-tvqkga-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeL)),ee=o()(a.EuiFlexItem).withConfig({displayName:"OptionsFlexItem",componentId:"sc-tvqkga-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),te=[],ne=Object(i.memo)((({alignHeader:e,chartHeight:t=155,chartOptionsContextMenu:n,combinedQueries:r,comboboxRef:o,defaultStackByOption:k=L.a,extraActions:w,filters:T,headerChildren:C,inspectTitle:M,legendPosition:I="right",onFieldSelected:U,onlyField:W,paddingSize:ne="m",panelHeight:ae=L.d,query:ie,runtimeMappings:se,setComboboxInputRef:re,showCountsInLegend:oe=!1,showGroupByPlaceholder:le=!1,showLegend:ue=!0,showLinkToAlerts:ce=!1,showStackBy:de=!0,showTotalAlertsCount:me=!1,signalIndexName:pe,stackByLabel:fe,stackByWidth:be,timelineId:ge,title:ve=P,titleSize:ye="m",updateDateRange:he,hideQueryToggle:je=!1,isExpanded:Ee,setIsExpanded:Oe})=>{var xe;const{to:Se,from:ke,deleteQuery:we,setQuery:Te}=Object(m.a)(),Ce=Object(i.useMemo)((()=>`${X}-${Object(u.v4)()}`),[]),Me=`alerts-trend-embeddable-${Ce}`,[Ie,Ae]=Object(i.useState)(!0),[Pe,_e]=Object(i.useState)(!1),[De,Re]=Object(i.useState)(Y),[Fe,Ne]=Object(i.useState)(null==W?k:W),Le=Object($.a)("chartEmbeddablesEnabled"),ze=Object($.a)("alertsPageChartsEnabled"),Be=Object(i.useCallback)((e=>{Ne(e),null!=U&&U(e)}),[U]);Object(i.useEffect)((()=>{Ne(null==W?k:W)}),[k,W]);const{toggleStatus:qe,setToggleStatus:Ve}=Object(q.a)(X),$e=Object(i.useCallback)((e=>{ze&&void 0!==Oe?Oe(e):Ve(e)}),[Ve,Oe,ze]),Ue=Object(i.useMemo)((()=>ze&&void 0!==Oe?!Ee:!qe),[ze,Oe,Ee,qe]),Qe=Object(i.useMemo)((()=>({from:ke,to:Se})),[ke,Se]),{loading:He,data:Ge,setQuery:We,response:Ke,request:Je,refetch:Ye}=Object(g.a)({query:Object(x.d)(Fe,ke,Se,Object(x.a)(r),se),indexName:pe,skip:Ue||Le,queryName:v.a.HISTOGRAM}),Xe=Object(O.i)(),{navigateToApp:Ze}=Xe.services.application,{formatUrl:et,search:tt}=Object(y.l)(N.a.alerts),nt=(({totalAlertsObj:e,visualizationId:t,isChartEmbeddablesEnabled:n})=>{const[a]=Object(O.o)(p.P),s=Object(J.a)({visualizationId:t}),r=Object(i.useMemo)((()=>R(K()(e.value).format(a),e.value,"gte"===e.relation?">":"lte"===e.relation?"<":"")),[e.value,e.relation,a]),o=Object(i.useMemo)((()=>{const e=null!=s?s[0].hits.total:0;return R(K()(e).format(a),e,"")}),[a,s]);return n?o:r})({totalAlertsObj:De,visualizationId:Me,isChartEmbeddablesEnabled:Le}),at=Object(i.useCallback)((e=>{e.preventDefault(),Ze(p.l,{deepLinkId:N.a.alerts,path:Object(y.c)(tt)})}),[Ze,tt]),it=Object(i.useMemo)((()=>Object(x.c)(Ge)),[Ge]),st=Object(i.useMemo)((()=>{var e,t;return ue&&null!=(null==Ge||null===(e=Ge.aggregations)||void 0===e||null===(t=e.alertsByGrouping)||void 0===t?void 0:t.buckets)?Ge.aggregations.alertsByGrouping.buckets.map(((e,t)=>{var n;return{color:t<h.a.length?h.a[t]:void 0,count:oe?e.doc_count:void 0,dataProviderId:Object(f.i)(`draggable-legend-item-${Object(u.v4)()}-${Fe}-${e.key}`),field:Fe,timelineId:ge,value:null!==(n=null==e?void 0:e.key_as_string)&&void 0!==n?n:e.key}})):te}),[null==Ge||null===(xe=Ge.aggregations)||void 0===xe?void 0:xe.alertsByGrouping.buckets,Fe,oe,ue,ge]);Object(i.useEffect)((()=>{let e=!1;return e||Object(x.f)({isInitialLoading:Ie,isLoadingAlerts:He})||Ae(!1),()=>{e=!0}}),[Ie,He,Ae]),Object(B.a)({deleteQuery:we,loading:He,refetch:Ye,request:Je,response:Ke,setQuery:Te,uniqueQueryId:Ce}),Object(i.useEffect)((()=>{var e;Re(null!==(e=null==Ge?void 0:Ge.hits.total)&&void 0!==e?e:{value:0,relation:"eq"})}),[Ge]),Object(i.useEffect)((()=>{try{let t=null;var e;t=null!=r?Object(x.e)(r):Object(c.buildEsQuery)(void 0,null!=ie?[ie]:[],null!==(e=null==T?void 0:T.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[],{...Object(d.getEsQueryConfig)(Xe.services.uiSettings),dateFormatTZ:void 0}),_e(!1),We(Object(x.d)(Fe,ke,Se,Object(l.isEmpty)(t)?[]:[t],se))}catch(e){_e(!0),We(Object(x.d)(Fe,ke,Se,[],se))}}),[Fe,ke,Se,ie,T,r,se]);const rt=Object(i.useMemo)((()=>{if(ce)return s.a.createElement(Z,{grow:!1},s.a.createElement(F.g,{"data-test-subj":"alerts-histogram-panel-go-to-alerts-page",onClick:at,href:et(Object(y.c)())},D))}),[ce,at,et]),ot=Object(i.useMemo)((()=>{return null==W?ve:(e=W,S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}));var e}),[W,ve]),lt=Object(i.useMemo)((()=>ze&&void 0!==Ee?Ee:qe),[ze,Ee,qe]);return s.a.createElement(j.c,{show:!Ie&&lt},s.a.createElement(z.a,{height:ae,hasBorder:!0,paddingSize:ne,"data-test-subj":"alerts-histogram-panel",$toggleStatus:lt},s.a.createElement(b.a,{alignHeader:e,id:Ce,inspectTitle:M,outerDirection:"column",title:ot,titleSize:ye,toggleStatus:lt,toggleQuery:je?void 0:$e,showInspectButton:!Le&&null==n,subtitle:!Ie&&me&&nt,isInspectDisabled:Pe},s.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"panelFlexGroup",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},de&&s.a.createElement(s.a.Fragment,null,s.a.createElement(z.b,{"data-test-subj":"stackByComboBox",inputRef:re,onSelect:Be,prepend:fe,ref:o,selected:Fe,useLensCompatibleFields:Le,width:be}),le&&s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiSpacer,{"data-test-subj":"placeholderSpacer",size:"s"}),s.a.createElement(a.EuiToolTip,{"data-test-subj":"placeholderTooltip",content:_},s.a.createElement(z.b,{"data-test-subj":"stackByPlaceholder",isDisabled:!0,onSelect:l.noop,prepend:V.b,selected:"",useLensCompatibleFields:Le,width:be})))),null!=C&&C),null!=n&&!Le&&s.a.createElement(ee,{grow:!1},n(Ce)),rt)),lt?Le?s.a.createElement(G.a,{"data-test-subj":"embeddable-matrix-histogram",extraActions:w,extraOptions:{filters:T},getLensAttributes:Q,height:null!=t?t:155,id:Me,inspectTitle:null!=M?M:ve,scopeId:H.SourcererScopeName.detections,stackByField:Fe,timerange:Qe}):Ie?s.a.createElement(E.a,null):s.a.createElement(A,{chartHeight:t,data:it,from:ke,legendItems:st,legendPosition:I,legendMinWidth:oe?300:void 0,loading:He,to:Se,showLegend:ue,updateDateRange:he}):null))}));ne.displayName="AlertsHistogramPanel"},function(e,t,n){"use strict";n.d(t,"b",(function(){return we})),n.d(t,"a",(function(){return Ie}));var a=n(45),i=n(17),s=n(2),r=n.n(s),o=n(48),l=n(44),u=n.n(l),c=n(66),d=n(135),m=n(118),p=n(134),f=n(196),b=n(116),g=n(742),v=n(113),y=n(112),h=n(282),j=n(145),E=n(296),O=n(23),x=n.n(O),S=(n(13),n(194)),k=n(47),w=n(130),T=n(110),C=n(719),M=n(485),I=n(377),A=n(122),P=n(430),_=n(721),D=n(5);const R=D.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),F=D.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),N=D.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),L=D.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),z=D.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),B=D.i18n.translate("xpack.securitySolution.timeline.tabs.securityAssistantTimelineTitle",{defaultMessage:"Elastic AI Assistant"}),q=D.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline",{defaultMessage:"ES|QL"}),V=D.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline.technicalPreviewLabel",{defaultMessage:"Technical Preview"}),$=D.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"});var U=n(18),Q=n(520),H=n(14);const G=u.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-1ib7jds-0"})(["flex:1;"]);var W=u()(G).withConfig({displayName:"_StyledHideShowContainer",componentId:"sc-1ib7jds-1"})(["overflow:hidden !important;"]);const K=(e,t=r.a.createElement(i.EuiSkeletonText,{lines:10}))=>{var n;const a=r.a.forwardRef(((n,a)=>r.a.createElement(s.Suspense,{fallback:t},r.a.createElement(e,x()({},n,{ref:a})))));return a.displayName=`${null!==(n=e.displayName)&&void 0!==n?n:"Tab"}WithSuspense`,a},J=u.a.div.withConfig({displayName:"AssistantTabContainer",componentId:"sc-1ib7jds-2"})(["overflow-y:auto;width:100%;"]),Y=K(Object(s.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(15),n.e(16),n.e(44)]).then(n.bind(null,1724))))),X=K(Object(s.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(15),n.e(16),n.e(37)]).then(n.bind(null,1732))))),Z=K(Object(s.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(17),n.e(38)]).then(n.bind(null,1710))))),ee=K(Object(s.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(46)]).then(n.bind(null,1735))))),te=K(Object(s.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(15),n.e(50)]).then(n.bind(null,1711))))),ne=K(Object(s.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(47)]).then(n.bind(null,1712))))),ae=K(Object(s.lazy)((()=>n.e(43).then(n.bind(null,1726))))),ie=Object(s.memo)((({shouldRefocusPrompt:e,setConversationId:t})=>r.a.createElement(s.Suspense,{fallback:r.a.createElement(i.EuiSkeletonText,{lines:10})},r.a.createElement(J,null,r.a.createElement(S.a,{conversationId:Q.a,embeddedLayout:!0,setConversationId:t,shouldRefocusPrompt:e})))));ie.displayName="AssistantTab";const se=Object(s.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:n,timelineId:a,timelineType:i,setConversationId:o,showTimeline:l})=>{const{hasAssistantPrivilege:u}=Object(I.a)(),c=Object(T.i)().services.configSettings.ESQLEnabled,d=Object(s.useCallback)((e=>{switch(e){case A.d.graph:return r.a.createElement(Z,{timelineId:a});case A.d.notes:return r.a.createElement(ee,{timelineId:a});case A.d.session:return r.a.createElement(ne,{timelineId:a});default:return null}}),[a]),m=Object(s.useMemo)((()=>[A.d.graph,A.d.notes,A.d.session].includes(e)),[e]),{conversations:p}=Object(M.a)(),f=Object(s.useMemo)((()=>p[Q.a].messages.length>0),[p]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(G,{$isVisible:A.d.query===e,"data-test-subj":`timeline-tab-content-${A.d.query}`},r.a.createElement(Y,{renderCellValue:t,rowRenderers:n,timelineId:a})),l&&c&&e===A.d.esql&&r.a.createElement(G,{$isVisible:!0,"data-test-subj":`timeline-tab-content-${A.d.esql}`},r.a.createElement(ae,{timelineId:a})),r.a.createElement(G,{$isVisible:A.d.pinned===e,"data-test-subj":`timeline-tab-content-${A.d.pinned}`},r.a.createElement(te,{renderCellValue:t,rowRenderers:n,timelineId:a})),i===v.l.default&&r.a.createElement(G,{$isVisible:A.d.eql===e,"data-test-subj":`timeline-tab-content-${A.d.eql}`},r.a.createElement(X,{renderCellValue:t,rowRenderers:n,timelineId:a})),r.a.createElement(G,{$isVisible:m,isOverflowYScroll:e===A.d.session,"data-test-subj":`timeline-tab-content-${A.d.graph}-${A.d.notes}`},m&&d(e)),u&&r.a.createElement(W,{$isVisible:e===A.d.securityAssistant,isOverflowYScroll:e===A.d.securityAssistant,"data-test-subj":"timeline-tab-content-security-assistant"},(e===A.d.securityAssistant||f)&&r.a.createElement(ie,{setConversationId:o,shouldRefocusPrompt:l&&e===A.d.securityAssistant})))}));se.displayName="ActiveTimelineTab";const re=u()(i.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-1ib7jds-3"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),oe=u()(i.EuiBetaBadge).withConfig({displayName:"StyledEuiBetaBadge",componentId:"sc-1ib7jds-4"})(["vertical-align:middle;margin-left:",";&:hover{cursor:pointer;}"],(({theme:e})=>e.eui.euiSizeS)),le=u()(i.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-1ib7jds-5"})([".euiTab__content{align-items:center;display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),ue=u()(i.EuiTabs).withConfig({displayName:"StyledEuiTabs",componentId:"sc-1ib7jds-6"})(["padding-inline:",";"],(e=>e.theme.eui.euiSizeM)),ce=({renderCellValue:e,rowRenderers:t,timelineId:n,timelineFullScreen:l,timelineType:u,graphEventId:c,sessionViewConfig:d,timelineDescription:p})=>{const f=Object(w.a)("timelineEsqlTabDisabled"),b=Object(T.i)().services.configSettings.ESQLEnabled,{hasAssistantPrivilege:g}=Object(I.a)(),h=Object(o.useDispatch)(),j=Object(s.useMemo)((()=>Object(_.a)()),[]),E=Object(s.useMemo)((()=>Object(_.g)()),[]),O=Object(s.useMemo)((()=>Object(_.e)()),[]),x=Object(s.useMemo)((()=>Object(_.d)()),[]),S=Object(s.useMemo)((()=>Object(_.c)()),[]),M=Object(s.useMemo)((()=>Object(_.b)()),[]),D=Object(y.b)((e=>j(e,n))),G=Object(y.b)((e=>E(e,n))),W=Object(y.b)((e=>O(e,n))),K=Object(y.a)((e=>S(e,n))),J=Object(y.a)((e=>M(e,n))),Y=Object(y.a)((e=>x(e))),X=Object(U.b)().isEnterprise(),[Z,ee]=Object(s.useState)(Q.a),{reportAssistantInvoked:te}=Object(C.a)(),ne=Object(s.useMemo)((()=>{const e=Object.values(J).reduce(((e,t)=>[...e,...t]),[]);return[...K,...e]}),[K,J]),ae=Object(s.useMemo)((()=>Y.filter((e=>ne.includes(e.id))).length+(Object(a.isEmpty)(p)?0:1)),[Y,ne,p]),ie=Object(s.useCallback)((e=>{h(m.a.setActiveTabTimeline({id:n,activeTab:e}))}),[h,n]),ce=Object(s.useCallback)((()=>{ie(A.d.query)}),[ie]),de=Object(s.useCallback)((()=>{ie(A.d.eql)}),[ie]),me=Object(s.useCallback)((()=>{ie(A.d.graph)}),[ie]),pe=Object(s.useCallback)((()=>{ie(A.d.notes)}),[ie]),fe=Object(s.useCallback)((()=>{ie(A.d.pinned)}),[ie]),be=Object(s.useCallback)((()=>{ie(A.d.session)}),[ie]),ge=Object(s.useCallback)((()=>{ie(A.d.securityAssistant),D!==A.d.securityAssistant&&te({conversationId:Z,invokedBy:Q.a})}),[D,Z,te,ie]),ve=Object(s.useCallback)((()=>{h(Object(H.initializeTimelineSettings)({id:n})),ie(A.d.esql)}),[ie,h,n]);return Object(s.useEffect)((()=>{c||D!==A.d.graph||ce()}),[D,c,ce]),r.a.createElement(r.a.Fragment,null,!l&&r.a.createElement(ue,{className:"eui-scrollBar"},r.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.query}`,onClick:ce,isSelected:D===A.d.query,disabled:!1,key:A.d.query},r.a.createElement("span",null,R),G&&r.a.createElement(P.b,null)),!f&&b&&r.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.esql}`,onClick:ve,isSelected:D===A.d.esql,disabled:!1,key:A.d.esql},r.a.createElement("span",null,q),r.a.createElement(oe,{label:V,size:"s",iconType:"beaker",tooltipContent:r.a.createElement(k.FormattedMessage,{id:"xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline.technicalPreviewTooltip",defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."})})),u===v.l.default&&r.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.eql}`,onClick:de,isSelected:D===A.d.eql,disabled:!1,key:A.d.eql},r.a.createElement("span",null,F),G&&r.a.createElement(P.a,null)),r.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${A.d.graph}`,onClick:me,isSelected:D===A.d.graph,disabled:!c,key:A.d.graph},N),X&&r.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${A.d.session}`,onClick:be,isSelected:D===A.d.session,disabled:null===d,key:A.d.session},$),r.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.notes}`,onClick:pe,isSelected:D===A.d.notes,disabled:u===v.l.template,key:A.d.notes},r.a.createElement("span",null,L),G&&ae>0&&u===v.l.default&&r.a.createElement("div",null,r.a.createElement(re,null,ae))),r.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.pinned}`,onClick:fe,disabled:u===v.l.template,isSelected:D===A.d.pinned,key:A.d.pinned},r.a.createElement("span",null,z),G&&W>0&&u===v.l.default&&r.a.createElement("div",null,r.a.createElement(re,null,W))),g&&r.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.securityAssistant}`,onClick:ge,disabled:u===v.l.template,isSelected:D===A.d.securityAssistant,key:A.d.securityAssistant},r.a.createElement("span",null,B))),r.a.createElement(se,{activeTimelineTab:D,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:u,timelineDescription:p,setConversationId:ee,showTimeline:G}))},de=Object(s.memo)(ce);var me=n(243),pe=n(189),fe=n(593),be=n(49),ge=n(60),ve=n(218),ye=n(128),he=n(722),je=n(4),Ee=n(292),Oe=n(516);const xe=e=>{var t;const{activeTab:n,switchToTab:a,timelineType:o}=e,{services:{storage:l}}=Object(T.i)(),u=Object(s.useMemo)((()=>Ee.b.filter((e=>!e.timelineType||e.timelineType===o))),[o]),[c,d]=Object(s.useState)((()=>{const e=l.get(je.Qb.TIMELINE);return null!=e?e:Ee.c})),m=Object(s.useCallback)((()=>{d((e=>({...e,isTourActive:!1})))}),[]),p=Object(s.useCallback)((()=>{d((e=>({...e,currentTourStep:e.currentTourStep+1})))}),[]);Object(s.useEffect)((()=>{l.set(je.Qb.TIMELINE,c)}),[c,l]);const f=Object(s.useCallback)((e=>e===u.length?r.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:m},Oe.h):[r.a.createElement(i.EuiButtonEmpty,{size:"s",color:"text",onClick:m},Oe.g),r.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:p},Oe.j)]),[m,p,u.length]),b=null===(t=u[c.currentTourStep-1])||void 0===t?void 0:t.anchor,g=Object(he.a)(b),v=u[c.currentTourStep-1];return null!=v&&v.timelineTab&&v.timelineTab!==n&&a(v.timelineTab),c.isTourActive&&g?r.a.createElement(r.a.Fragment,null,u.map(((e,t)=>{const n=t+1;if(c.currentTourStep!==n)return null;const a={"data-test-subj":`timeline-tour-step-${t+1}`};return r.a.createElement(i.EuiTourStep,{panelProps:a,key:t,step:n,isStepOpen:c.isTourActive&&c.currentTourStep===t+1,minWidth:c.tourPopoverWidth,stepsTotal:u.length,onFinish:m,title:e.title,content:e.content,anchor:`#${e.anchor}`,subtitle:Ee.c.tourSubtitle,footerAction:f(n)})}))):null},Se=r.a.memo(xe),ke=u.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-4r2lej-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),we=Object(s.createContext)({timelineId:null}),Te=({timelineId:e})=>{const t=Object(s.useMemo)((()=>m.b.getTimelineByIdSelector()),[]);return Object(y.b)((n=>{var a;return(null!==(a=t(n,e))&&void 0!==a?a:p.b).isSaving}))?r.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},Ce=r.a.memo(Te),Me=({renderCellValue:e,rowRenderers:t,timelineId:n})=>{const l=Object(o.useDispatch)(),u=Object(s.useRef)(null),O=Object(s.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),x=Object(s.useMemo)((()=>ye.e.scopeIdSelector()),[]),{selectedPatterns:S,selectedDataViewId:k}=Object(y.a)((e=>x(e,b.SourcererScopeName.timeline))),{dataViewId:w,indexNames:C,graphEventId:M,savedObjectId:I,timelineType:P,description:_,sessionViewConfig:D,initialized:R,show:F,isLoading:N,activeTab:L}=Object(y.a)((e=>{var t;return Object(a.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig","initialized","show","isLoading","activeTab"],null!==(t=O(e,n))&&void 0!==t?t:p.b)})),{kibanaSecuritySolutionsPrivileges:{crud:z}}=Object(d.a)(),{timelineFullScreen:B}=Object(pe.c)();Object(s.useEffect)((()=>{I||R||l(m.a.createTimeline({id:n,columns:f.b,dataViewId:k,indexNames:S,expandedDetail:h.a.getExpandedDetail(),show:!1}))}),[]);const q=Object(s.useCallback)((()=>{!I||null==k||null===w&&0===C.length||w===k&&C.sort().join()===S.sort().join()||l(m.a.updateDataView({dataViewId:k,id:n,indexNames:S}))}),[l,I,k,w,S,C,n]);Object(s.useEffect)((()=>{q()}),[k,S]);const V=Object(s.useCallback)((()=>{var e;const t=null===(e=u.current)||void 0===e?void 0:e.querySelector(fe.a);var n,a;null!=t?t.focus():null===(n=u.current)||void 0===n||null===(a=n.querySelector(".globalFilterBar__addButton"))||void 0===a||a.focus()}),[u]),$=Object(s.useCallback)((()=>{var e,t;null===(e=u.current)||void 0===e||null===(t=e.querySelector(`.${j.d}`))||void 0===t||t.focus()}),[u]),U=Object(s.useCallback)((e=>{Object(c.isTab)(e)&&Object(j.l)({containerElement:u.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:V,onSkipFocusAfterEventsTable:$})}),[u,V,$]),Q=Object(s.useMemo)((()=>({timelineId:n})),[n]),H=(()=>{const{search:e,pathname:t}=Object(be.useLocation)(),{spaces:n}=Object(T.i)().services,a=Object(s.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:o,savedObjectId:l,show:u,graphEventId:c,activeTab:d}=Object(y.a)((e=>{var t;return null!==(t=a(e,A.c.active))&&void 0!==t?t:p.b})),f=Object(s.useCallback)((()=>{var a,s,m;const p=new URLSearchParams(e),f=null!==(a=p.get(ve.a.timeline))&&void 0!==a?a:void 0,b={id:null!=l?l:"",isOpen:!!u,activeTab:d,graphEventId:c},g=null!==(s=Object(ge.safeDecode)(null!=f?f:""))&&void 0!==s?s:b,v=null==g?void 0:g.id;if(!n||"conflict"!==(null==o?void 0:o.outcome)||null==(null==o?void 0:o.alias_target_id)||null==v)return null;const y=null!==(m=null==o?void 0:o.alias_target_id)&&void 0!==m?m:"",h={...g,id:y},j=Object(ge.encode)(h);p.set(ve.a.timeline,j);const E=`${t}?${p.toString()}${window.location.hash}`;return r.a.createElement(r.a.Fragment,null,n.ui.components.getLegacyUrlConflict({objectNoun:ve.a.timeline,currentObjectId:v,otherObjectId:y,otherObjectPath:E}),r.a.createElement(i.EuiSpacer,null))}),[d,c,t,null==o?void 0:o.alias_target_id,null==o?void 0:o.outcome,l,e,u,n]);return Object(s.useMemo)((()=>f()),[f])})(),G=F&&!N&&z,W=Object(s.useCallback)((e=>{l(m.a.setActiveTabTimeline({id:n,activeTab:e}))}),[n,l]);return r.a.createElement(we.Provider,{value:Q},r.a.createElement(me.B,{"data-test-subj":"timeline","data-timeline-id":n,onKeyDown:U,ref:u},r.a.createElement(Ce,{timelineId:n}),r.a.createElement("div",{className:"timeline-body","data-test-subj":"timeline-body"},P===v.l.template&&r.a.createElement(ke,{className:"timeline-template-badge"},E.f),H,r.a.createElement(me.y,{$isVisible:!B,"data-test-subj":"timeline-hide-show-container"},r.a.createElement(g.a,{timelineId:n})),r.a.createElement(de,{graphEventId:M,sessionViewConfig:D,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:P,timelineDescription:_,timelineFullScreen:B}))),G?r.a.createElement(Se,{activeTab:L,switchToTab:W,timelineType:P}):null)};Me.displayName="StatefulTimelineComponent";const Ie=r.a.memo(Me)},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(110),s=n(114),r=n(66);const o=({closePopover:e,draggableId:t,fieldName:n,keyboardHandlerRef:o,openPopover:l})=>{const{timelines:u}=Object(i.i)().services,c=u.getUseAddToTimeline(),{beginDrag:d,cancelDrag:m,dragToLocation:p,endDrag:f,hasDraggableLock:b}=c({draggableId:t,fieldName:n}),[g,v]=Object(a.useState)(null),y=Object(a.useCallback)((()=>{v((e=>e?(m(e),null):null))}),[m]),h=Object(a.useCallback)((n=>{const a=document.querySelector(`[data-rbd-drag-handle-draggable-id="${t}"]`);var i;a&&((b()||!b()&&" "===n.key)&&(n.preventDefault(),n.stopPropagation()),(({beginDrag:e,cancelDragActions:t,closePopover:n,draggableElement:a,dragActions:i,dragToLocation:o,endDrag:l,keyboardEvent:u,openPopover:c,setDragActions:d})=>{let m=null;switch(u.key){case" ":i?(l(i),d(null)):(null!=n&&n(),d(e()));break;case"Escape":t();break;case"Tab":(e=>{const t=e.querySelectorAll("a, button");t.forEach((e=>{e.setAttribute("tabindex","-1")})),setTimeout((()=>{t.forEach((e=>{e.setAttribute("tabindex","0")}))}),0)})(a);break;case"ArrowUp":m=a.getBoundingClientRect(),o({dragActions:i,position:{x:m.x,y:m.y-s.f}});break;case"ArrowDown":m=a.getBoundingClientRect(),o({dragActions:i,position:{x:m.x,y:m.y+s.f}});break;case"ArrowLeft":m=a.getBoundingClientRect(),o({dragActions:i,position:{x:m.x-s.f,y:m.y}});break;case"ArrowRight":m=a.getBoundingClientRect(),o({dragActions:i,position:{x:m.x+s.f,y:m.y}});break;case"Enter":Object(r.stopPropagationAndPreventDefault)(u),i||null==c||c()}})({beginDrag:d,cancelDragActions:y,closePopover:e,dragActions:g,draggableElement:a,dragToLocation:p,endDrag:f,keyboardEvent:n,openPopover:l,setDragActions:v}),null===(i=o.current)||void 0===i||i.focus())}),[d,y,e,g,t,p,f,b,o,l,v]);return Object(a.useMemo)((()=>({onBlur:y,onKeyDown:h})),[y,h])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),i=n.n(a),s=n(44),r=n.n(s),o=n(17),l=n(50),u=n(110),c=n(47);const d=({handleClick:e})=>i.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonEmpty,{onClick:e,"data-test-subj":"osquery-empty-button"},i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.footer.cancel",defaultMessage:"Cancel"})))),m=i.a.memo(d);var p=n(709);const f=r.a.div.withConfig({displayName:"OsqueryActionWrapper",componentId:"sc-flf6q3-0"})(["padding:8px;"]),b=({agentId:e,defaultValues:t,onClose:n,ecsData:s})=>{const{services:{osquery:r}}=Object(u.i)(),c=Object(l.useQueryClient)(),d=Object(a.useCallback)((()=>{var e;c.invalidateQueries({queryKey:["actions",{alertId:null==t||null===(e=t.alertIds)||void 0===e?void 0:e[0]}]})}),[null==t?void 0:t.alertIds,c]);return null!=r&&r.OsqueryAction?i.a.createElement(o.EuiFlyout,{size:"m",onClose:n},i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"flyout-header-osquery"},i.a.createElement(o.EuiTitle,null,i.a.createElement("h2",null,p.a))),i.a.createElement(o.EuiFlyoutBody,null,i.a.createElement(f,{"data-test-subj":"flyout-body-osquery"},i.a.createElement(r.OsqueryAction,{agentId:e,formType:"steps",defaultValues:t,ecsData:s,onSuccess:d}))),i.a.createElement(o.EuiFlyoutFooter,null,i.a.createElement(m,{handleClick:n,"data-test-subj":"flyout-footer-osquery"}))):null},g=i.a.memo(b)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return A})),n.d(t,"a",(function(){return N}));var a=n(45),i=n(17),s=n(47),r=n(2),o=n.n(r),l=n(44),u=n.n(l),c=n(48),d=n(50),m=n(126),p=n(390),f=n(118),b=n(167),g=n(468),v=n(5);const y=v.i18n.translate("xpack.securitySolution.timeline.toggleEventDetailsTitle",{defaultMessage:"Expand event details"}),h=v.i18n.translate("xpack.securitySolution.timeline.addedANoteLabel",{defaultMessage:"added a note"}),j=v.i18n.translate("xpack.securitySolution.timeline.addedADescriptionLabel",{defaultMessage:"added description"}),E=v.i18n.translate("xpack.securitySolution.timeline.anUnknownUserLabel",{defaultMessage:"an unknown user"}),O=v.i18n.translate("xpack.securitySolution.timeline.deleteNoteLabel",{defaultMessage:"Delete Note"}),x=v.i18n.translate("xpack.securitySolution.timeline.cancelDeleteNoteLabel",{defaultMessage:"Keep Note"}),S=v.i18n.translate("xpack.securitySolution.timeline.promptDeleteNoteLabel",{defaultMessage:"Delete timeline note?"});var k=n(122),w=n(112),T=n(116),C=n(121),M=n(110),I=n(117);const A=u.a.section.withConfig({displayName:"NotePreviewsContainer",componentId:"sc-16ieedj-0"})(["padding-top:",";"],(({theme:e})=>`${e.eui.euiSizeS}`));A.displayName="NotePreviewsContainer";const P=({eventId:e,timelineId:t})=>{const n=Object(c.useDispatch)(),{selectedPatterns:a}=Object(C.d)(T.SourcererScopeName.timeline),s=Object(r.useCallback)((()=>{n(f.a.toggleDetailPanel({panelView:"eventDetail",tabType:k.d.notes,id:t,params:{eventId:e,indexName:a.join(",")}}))}),[n,e,a,t]);return o.a.createElement(i.EuiButtonIcon,{title:y,"aria-label":y,color:"text",iconType:"arrowRight",onClick:s})},_=o.a.memo(P),D=o.a.memo((({closeModal:e,confirmModal:t})=>o.a.createElement(i.EuiConfirmModal,{title:S,onCancel:e,onConfirm:t,cancelButtonText:x,confirmButtonText:O,buttonColor:"danger",defaultFocusedButton:"confirm"})));D.displayName="DeleteNoteConfirm";const R=o.a.memo((({noteId:e})=>{const[t,n]=Object(r.useState)(null),{mutate:a,isLoading:s}=function(e){const{services:{http:t}}=Object(M.i)(),n=Object(c.useDispatch)(),{addError:a}=Object(I.a)();return Object(d.useMutation)({mutationFn:e=>t.fetch("/api/note",{method:"DELETE",body:JSON.stringify({noteId:e}),version:"2023-10-31"}),onSuccess:()=>{e&&n(b.a.deleteNote({id:e}))},onError:e=>{var t;a(e,{title:(t=e,v.i18n.translate("xpack.securitySolution.timeline.deleteNoteError",{defaultMessage:"An error occurred deleting note {error}",values:{error:t}}))})}})}(e),l=Object(r.useCallback)((async()=>{n(e)}),[e]),u=Object(r.useCallback)((()=>{n(null)}),[]),m=Object(r.useCallback)((()=>{a(e),n(null)}),[a,e]),p=Object(r.useMemo)((()=>s||null==e),[s,e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiButtonIcon,{title:O,"aria-label":O,"data-test-subj":"delete-note",color:"text",iconType:"trash",onClick:l,disabled:p}),null!=t&&o.a.createElement(D,{closeModal:u,confirmModal:m}))}));R.displayName="DeleteNoteButton";const F=o.a.memo((({eventId:e,timelineId:t,noteId:n})=>e&&t?o.a.createElement(o.a.Fragment,null,o.a.createElement(_,{eventId:e,timelineId:t}),o.a.createElement(R,{noteId:n})):o.a.createElement(R,{noteId:n})));F.displayName="NoteActions";const N=o.a.memo((({eventIdToNoteIds:e,notes:t,timelineId:n,showTimelineDescription:l})=>{const u=Object(r.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),c=Object(w.a)((e=>n?u(e,n):null)),d=Object(r.useMemo)((()=>l&&n&&null!=c&&c.description?[{username:Object(m.a)(c.updatedBy),event:j,"data-test-subj":"note-preview-description",id:"note-preview-description",timestamp:c.updated?o.a.createElement(s.FormattedRelative,{"data-test-subj":"updated",value:new Date(c.updated)}):Object(m.e)(),children:o.a.createElement(i.EuiText,{size:"s"},c.description),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=c.updatedBy?c.updatedBy:"?",size:"l"}),actions:null}]:[]),[c,n,l]),b=Object(r.useMemo)((()=>Object(a.uniqBy)("savedObjectId",t).map((t=>{var a,r,l;const u=null!=e?Object.entries(e).reduce(((e,[n,a])=>{var i;return a.includes(null!==(i=t.noteId)&&void 0!==i?i:"")?n:e}),null):null!==(a=t.eventId)&&void 0!==a?a:null;return{"data-test-subj":`note-preview-${t.savedObjectId}`,username:Object(m.a)(t.updatedBy),event:h,timestamp:t.updated?o.a.createElement(s.FormattedRelative,{"data-test-subj":"updated",value:new Date(t.updated)}):Object(m.e)(),children:o.a.createElement("div",{className:g.a,tabIndex:0},o.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyUserAddedANote"},o.a.createElement("p",null,`${null!==(r=t.updatedBy)&&void 0!==r?r:E} ${h}`)),o.a.createElement(p.b,null,null!==(l=t.note)&&void 0!==l?l:"")),actions:o.a.createElement(F,{eventId:u,timelineId:n,noteId:t.savedObjectId}),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=t.updatedBy?t.updatedBy:"?",size:"l"})}}))),[e,t,n]);return o.a.createElement(i.EuiCommentList,{"data-test-subj":"note-comment-list",comments:[...d,...b]})}));N.displayName="NotePreviews"},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(766);Object.defineProperty(t,"createMemo",{enumerable:!0,get:function(){return a.default}});var i=n(767);Object.defineProperty(t,"createReducerContext",{enumerable:!0,get:function(){return i.default}});var s=n(768);Object.defineProperty(t,"createReducer",{enumerable:!0,get:function(){return s.default}});var r=n(769);Object.defineProperty(t,"createStateContext",{enumerable:!0,get:function(){return r.default}});var o=n(407);Object.defineProperty(t,"useAsync",{enumerable:!0,get:function(){return o.default}});var l=n(419);Object.defineProperty(t,"useAsyncFn",{enumerable:!0,get:function(){return l.default}});var u=n(770);Object.defineProperty(t,"useAsyncRetry",{enumerable:!0,get:function(){return u.default}});var c=n(771);Object.defineProperty(t,"useAudio",{enumerable:!0,get:function(){return c.default}});var d=n(773);Object.defineProperty(t,"useBattery",{enumerable:!0,get:function(){return d.default}});var m=n(775);Object.defineProperty(t,"useBeforeUnload",{enumerable:!0,get:function(){return m.default}});var p=n(776);Object.defineProperty(t,"useBoolean",{enumerable:!0,get:function(){return p.default}});var f=n(777);Object.defineProperty(t,"useClickAway",{enumerable:!0,get:function(){return f.default}});var b=n(778);Object.defineProperty(t,"useCookie",{enumerable:!0,get:function(){return b.default}});var g=n(780);Object.defineProperty(t,"useCopyToClipboard",{enumerable:!0,get:function(){return g.default}});var v=n(501);Object.defineProperty(t,"useCounter",{enumerable:!0,get:function(){return v.default}});var y=n(781);Object.defineProperty(t,"useCss",{enumerable:!0,get:function(){return y.default}});var h=n(375);Object.defineProperty(t,"useCustomCompareEffect",{enumerable:!0,get:function(){return h.default}});var j=n(787);Object.defineProperty(t,"useDebounce",{enumerable:!0,get:function(){return j.default}});var E=n(664);Object.defineProperty(t,"useDeepCompareEffect",{enumerable:!0,get:function(){return E.default}});var O=n(788);Object.defineProperty(t,"useDefault",{enumerable:!0,get:function(){return O.default}});var x=n(789);Object.defineProperty(t,"useDrop",{enumerable:!0,get:function(){return x.default}});var S=n(790);Object.defineProperty(t,"useDropArea",{enumerable:!0,get:function(){return S.default}});var k=n(256);Object.defineProperty(t,"useEffectOnce",{enumerable:!0,get:function(){return k.default}});var w=n(791);Object.defineProperty(t,"useEnsuredForwardedRef",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"ensuredForwardRef",{enumerable:!0,get:function(){return w.ensuredForwardRef}});var T=n(302);Object.defineProperty(t,"useEvent",{enumerable:!0,get:function(){return T.default}});var C=n(792);Object.defineProperty(t,"useError",{enumerable:!0,get:function(){return C.default}});var M=n(793);Object.defineProperty(t,"useFavicon",{enumerable:!0,get:function(){return M.default}});var I=n(794);Object.defineProperty(t,"useFullscreen",{enumerable:!0,get:function(){return I.default}});var A=n(796);Object.defineProperty(t,"useGeolocation",{enumerable:!0,get:function(){return A.default}});var P=n(502);Object.defineProperty(t,"useGetSet",{enumerable:!0,get:function(){return P.default}});var _=n(797);Object.defineProperty(t,"useGetSetState",{enumerable:!0,get:function(){return _.default}});var D=n(798);Object.defineProperty(t,"useHarmonicIntervalFn",{enumerable:!0,get:function(){return D.default}});var R=n(800);Object.defineProperty(t,"useHover",{enumerable:!0,get:function(){return R.default}});var F=n(503);Object.defineProperty(t,"useHoverDirty",{enumerable:!0,get:function(){return F.default}});var N=n(801);Object.defineProperty(t,"useIdle",{enumerable:!0,get:function(){return N.default}});var L=n(803);Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return L.default}});var z=n(804);Object.defineProperty(t,"useInterval",{enumerable:!0,get:function(){return z.default}});var B=n(40);Object.defineProperty(t,"useIsomorphicLayoutEffect",{enumerable:!0,get:function(){return B.default}});var q=n(504);Object.defineProperty(t,"useKey",{enumerable:!0,get:function(){return q.default}});var V=n(805);Object.defineProperty(t,"createBreakpoint",{enumerable:!0,get:function(){return V.default}});var $=n(505);Object.defineProperty(t,"useKeyPress",{enumerable:!0,get:function(){return $.default}});var U=n(806);Object.defineProperty(t,"useKeyPressEvent",{enumerable:!0,get:function(){return U.default}});var Q=n(506);Object.defineProperty(t,"useLatest",{enumerable:!0,get:function(){return Q.default}});var H=n(507);Object.defineProperty(t,"useLifecycles",{enumerable:!0,get:function(){return H.default}});var G=n(508);Object.defineProperty(t,"useList",{enumerable:!0,get:function(){return G.default}});var W=n(807);Object.defineProperty(t,"useLocalStorage",{enumerable:!0,get:function(){return W.default}});var K=n(808);Object.defineProperty(t,"useLocation",{enumerable:!0,get:function(){return K.default}});var J=n(809);Object.defineProperty(t,"useLockBodyScroll",{enumerable:!0,get:function(){return J.default}});var Y=n(810);Object.defineProperty(t,"useLogger",{enumerable:!0,get:function(){return Y.default}});var X=n(811);Object.defineProperty(t,"useLongPress",{enumerable:!0,get:function(){return X.default}});var Z=n(705);Object.defineProperty(t,"useMap",{enumerable:!0,get:function(){return Z.default}});var ee=n(812);Object.defineProperty(t,"useMedia",{enumerable:!0,get:function(){return ee.default}});var te=n(813);Object.defineProperty(t,"useMediaDevices",{enumerable:!0,get:function(){return te.default}});var ne=n(814);Object.defineProperty(t,"useMediatedState",{enumerable:!0,get:function(){return ne.useMediatedState}});var ae=n(815);Object.defineProperty(t,"useMethods",{enumerable:!0,get:function(){return ae.default}});var ie=n(816);Object.defineProperty(t,"useMotion",{enumerable:!0,get:function(){return ie.default}});var se=n(509);Object.defineProperty(t,"useMount",{enumerable:!0,get:function(){return se.default}});var re=n(207);Object.defineProperty(t,"useMountedState",{enumerable:!0,get:function(){return re.default}});var oe=n(510);Object.defineProperty(t,"useMouse",{enumerable:!0,get:function(){return oe.default}});var le=n(817);Object.defineProperty(t,"useMouseHovered",{enumerable:!0,get:function(){return le.default}});var ue=n(818);Object.defineProperty(t,"useMouseWheel",{enumerable:!0,get:function(){return ue.default}});var ce=n(819);Object.defineProperty(t,"useNetwork",{enumerable:!0,get:function(){return ce.default}});var de=n(820);Object.defineProperty(t,"useNumber",{enumerable:!0,get:function(){return de.default}});var me=n(11);Object.defineProperty(t,"useObservable",{enumerable:!0,get:function(){return me.default}});var pe=n(821);Object.defineProperty(t,"useOrientation",{enumerable:!0,get:function(){return pe.default}});var fe=n(822);Object.defineProperty(t,"usePageLeave",{enumerable:!0,get:function(){return fe.default}});var be=n(823);Object.defineProperty(t,"usePermission",{enumerable:!0,get:function(){return be.default}});var ge=n(235);Object.defineProperty(t,"usePrevious",{enumerable:!0,get:function(){return ge.default}});var ve=n(824);Object.defineProperty(t,"usePreviousDistinct",{enumerable:!0,get:function(){return ve.default}});var ye=n(825);Object.defineProperty(t,"usePromise",{enumerable:!0,get:function(){return ye.default}});var he=n(826);Object.defineProperty(t,"useQueue",{enumerable:!0,get:function(){return he.default}});var je=n(511);Object.defineProperty(t,"useRaf",{enumerable:!0,get:function(){return je.default}});var Ee=n(827);Object.defineProperty(t,"useRafLoop",{enumerable:!0,get:function(){return Ee.default}});var Oe=n(257);Object.defineProperty(t,"useRafState",{enumerable:!0,get:function(){return Oe.default}});var xe=n(828);Object.defineProperty(t,"useSearchParam",{enumerable:!0,get:function(){return xe.default}});var Se=n(829);Object.defineProperty(t,"useScratch",{enumerable:!0,get:function(){return Se.default}});var ke=n(835);Object.defineProperty(t,"useScroll",{enumerable:!0,get:function(){return ke.default}});var we=n(836);Object.defineProperty(t,"useScrolling",{enumerable:!0,get:function(){return we.default}});var Te=n(837);Object.defineProperty(t,"useSessionStorage",{enumerable:!0,get:function(){return Te.default}});var Ce=n(255);Object.defineProperty(t,"useSetState",{enumerable:!0,get:function(){return Ce.default}});var Me=n(838);Object.defineProperty(t,"useShallowCompareEffect",{enumerable:!0,get:function(){return Me.default}});var Ie=n(840);Object.defineProperty(t,"useSize",{enumerable:!0,get:function(){return Ie.default}});var Ae=n(841);Object.defineProperty(t,"useSlider",{enumerable:!0,get:function(){return Ae.default}});var Pe=n(842);Object.defineProperty(t,"useSpeech",{enumerable:!0,get:function(){return Pe.default}});var _e=n(843);Object.defineProperty(t,"useStartTyping",{enumerable:!0,get:function(){return _e.default}});var De=n(844);Object.defineProperty(t,"useStateWithHistory",{enumerable:!0,get:function(){return De.useStateWithHistory}});var Re=n(845);Object.defineProperty(t,"useStateList",{enumerable:!0,get:function(){return Re.default}});var Fe=n(846);Object.defineProperty(t,"useThrottle",{enumerable:!0,get:function(){return Fe.default}});var Ne=n(847);Object.defineProperty(t,"useThrottleFn",{enumerable:!0,get:function(){return Ne.default}});var Le=n(848);Object.defineProperty(t,"useTimeout",{enumerable:!0,get:function(){return Le.default}});var ze=n(376);Object.defineProperty(t,"useTimeoutFn",{enumerable:!0,get:function(){return ze.default}});var Be=n(849);Object.defineProperty(t,"useTitle",{enumerable:!0,get:function(){return Be.default}});var qe=n(500);Object.defineProperty(t,"useToggle",{enumerable:!0,get:function(){return qe.default}});var Ve=n(850);Object.defineProperty(t,"useTween",{enumerable:!0,get:function(){return Ve.default}});var $e=n(303);Object.defineProperty(t,"useUnmount",{enumerable:!0,get:function(){return $e.default}});var Ue=n(851);Object.defineProperty(t,"useUnmountPromise",{enumerable:!0,get:function(){return Ue.default}});var Qe=n(223);Object.defineProperty(t,"useUpdate",{enumerable:!0,get:function(){return Qe.default}});var He=n(254);Object.defineProperty(t,"useUpdateEffect",{enumerable:!0,get:function(){return He.default}});var Ge=n(852);Object.defineProperty(t,"useUpsert",{enumerable:!0,get:function(){return Ge.default}});var We=n(853);Object.defineProperty(t,"useVibrate",{enumerable:!0,get:function(){return We.default}});var Ke=n(854);Object.defineProperty(t,"useVideo",{enumerable:!0,get:function(){return Ke.default}});var Je=n(855);Object.defineProperty(t,"useStateValidator",{enumerable:!0,get:function(){return Je.default}});var Ye=n(856);Object.defineProperty(t,"useScrollbarWidth",{enumerable:!0,get:function(){return Ye.useScrollbarWidth}});var Xe=n(858);Object.defineProperty(t,"useMultiStateValidator",{enumerable:!0,get:function(){return Xe.useMultiStateValidator}});var Ze=n(859);Object.defineProperty(t,"useWindowScroll",{enumerable:!0,get:function(){return Ze.default}});var et=n(860);Object.defineProperty(t,"useWindowSize",{enumerable:!0,get:function(){return et.default}});var tt=n(861);Object.defineProperty(t,"useMeasure",{enumerable:!0,get:function(){return tt.default}});var nt=n(862);Object.defineProperty(t,"useRendersCount",{enumerable:!0,get:function(){return nt.useRendersCount}});var at=n(300);Object.defineProperty(t,"useFirstMountState",{enumerable:!0,get:function(){return at.useFirstMountState}});var it=n(863);Object.defineProperty(t,"useSet",{enumerable:!0,get:function(){return it.default}});var st=n(864);Object.defineProperty(t,"createGlobalState",{enumerable:!0,get:function(){return st.createGlobalState}});var rt=n(865);Object.defineProperty(t,"useHash",{enumerable:!0,get:function(){return rt.useHash}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],s=t[1],r=i.useMemo((function(){return{set:function(e,t){s((function(n){var i;return a.__assign(a.__assign({},n),((i={})[e]=t,i))}))},setAll:function(e){s(e)},remove:function(e){s((function(t){var n=t,i=e;return n[i],a.__rest(n,["symbol"==typeof i?i:i+""])}))},reset:function(){return s(e)}}}),[s]),o=a.__assign({get:i.useCallback((function(e){return n[e]}),[n])},r);return[n,o]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=Object(a.createContext)(null)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(49),s=n(20),r=n(116),o=n(121),l=n(110);const u=()=>{const{indicesExist:e,dataViewId:t}=Object(o.d)(r.SourcererScopeName.timeline),n=Object(l.i)().services.application.capabilities.siem.show,u=Object(a.useMemo)((()=>n&&(e||null===t)),[e,t,n]);return Object(a.useCallback)((e=>{return!!u&&(t=e,!Object(s.c)().map((e=>e.path)).find((e=>Object(i.matchPath)(t,e))));var t}),[u])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(17),i=n(45),s=n(2),r=n.n(s),o=n(44),l=n.n(o),u=n(113),c=n(393),d=n(162),m=n(132),p=n(126),f=n(296),b=n(125);const g=l()(a.EuiFlexItem).withConfig({displayName:"TimelineContentItem",componentId:"sc-t3gz96-0"})(["max-width:calc(100% - 56px);"]),v=l()(a.EuiFilterButton).withConfig({displayName:"StyledEuiFilterButton",componentId:"sc-t3gz96-1"})(["border-top:0;border-bottom:0;"]),y=({hideUntitled:e=!1,getSelectableOptions:t,onClosePopover:n,onTimelineChange:o,timelineType:l,placeholder:y})=>{const[h,j]=Object(s.useState)(50),[E,O]=Object(s.useState)(0),[x,S]=Object(s.useState)(""),[k,w]=Object(s.useState)(!1),{fetchAllTimeline:T,timelines:C,loading:M,totalCount:I}=Object(c.b)(),A=Object(s.useRef)(null),P=Object(s.useRef)(null),_=Object(s.useMemo)((()=>Object(i.debounce)(500,S)),[]),D=Object(s.useCallback)((e=>{_(e)}),[_]),R=Object(s.useCallback)((()=>{w(!k)}),[k]),F=Object(s.useCallback)(((e,t,n)=>{if(e<t&&A.current&&P.current){const e=A.current.clientHeight,t=P.current.clientHeight;n>10&&t-n<1.2*e&&t>E&&(O(t),j(h+50))}}),[E,h]),N=Object(s.useCallback)(((e,t)=>{const n=Object(d.f)({...e,title:e.timelineTitle})?m.ab:e.timelineTitle,s=null!=e.description&&e.description.trim().length>0?e.description:null;return r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiIcon,{type:"on"===e.checked?"check":"empty",color:"primary"})),r.a.createElement(g,{grow:!0},r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",direction:"column",responsive:!1},r.a.createElement(a.EuiFlexItem,{"data-test-subj":"timeline"},r.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate eui-alignMiddle"},r.a.createElement(a.EuiHighlight,{search:t},n))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiToolTip,{content:s,anchorClassName:"eui-textTruncate eui-alignMiddle"},r.a.createElement(a.EuiTextColor,{color:"subdued",component:"span"},r.a.createElement("small",null,null!=s?s:Object(p.d)())))))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiIcon,{type:null!=e.favorite&&Object(i.isEmpty)(e.favorite)?"starEmpty":"starFilled"})))}),[]),L=Object(s.useCallback)((e=>{const t=e.filter((e=>"on"===e.checked));var a;null!=t&&t.length>0&&o(Object(i.isEmpty)(t[0].timelineTitle)?m.ab:t[0].timelineTitle,"-1"===t[0].id?null:t[0].id,null!==(a=t[0].graphEventId)&&void 0!==a?a:""),n()}),[n,o]),z=Object(s.useCallback)(((e,t)=>r.a.createElement(r.a.Fragment,null,t,e)),[]),B=Object(s.useMemo)((()=>({"data-test-subj":"timeline-super-select-search-box",placeholder:null!=y?y:f.e(l),onSearch:D,incremental:!1,append:r.a.createElement(v,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:k,onClick:R},m.D)})),[R,D,k,l,y]),q=Object(s.useMemo)((()=>({rowHeight:50,showIcons:!1,windowProps:{onScroll:({scrollOffset:t})=>F((null!=C?C:[]).filter((t=>!e||""!==t.title)).length,I,t),outerRef:A,innerRef:P}})),[F,e,I,C]);return Object(s.useEffect)((()=>{T({pageInfo:{pageIndex:1,pageSize:h},search:x,sort:{sortField:u.f.updated,sortOrder:b.b.desc},onlyUserFavorite:k,status:null,timelineType:l})}),[T,k,h,x,l]),r.a.createElement(a.EuiSelectable,{"data-test-subj":"selectable-input",height:260,isLoading:M&&null==C,listProps:q,renderOption:N,onChange:L,searchable:!0,searchProps:B,singleSelection:!0,options:(V=t({timelines:null!=C?C:[],onlyFavorites:k,searchTimelineValue:x,timelineType:l}),V.map((({title:e,...t})=>({...t,title:void 0,timelineTitle:e}))))},z);var V},h=Object(s.memo)(y)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.alertsView.osqueryAlertTitle",{defaultMessage:"Run Osquery"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.dragAndDrop.copyToClipboardTooltip",{defaultMessage:"Copy to Clipboard"}),s=a.i18n.translate("xpack.securitySolution.dragAndDrop.draggableKeyboardInstructionsNotDraggingScreenReaderOnly",{defaultMessage:"Press enter for options, or press space to begin dragging."});a.i18n.translate("xpack.securitySolution.dragAndDrop.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dragAndDrop.closeButtonLabel",{defaultMessage:"Close"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return h}));var a=n(45),i=n(2),s=n(48),r=n(5),o=n(172),l=n(14),u=n(117),c=n(121),d=n(149),m=n(162),p=n(203),f=n(145),b=n(712),g=n(116);const v="createRuleFromTimeline",y="createRuleFromEql",h=e=>{const t=Object(s.useDispatch)(),{addError:n}=Object(u.a)(),{browserFields:h,dataViewId:j,selectedPatterns:E}=Object(c.d)(g.SourcererScopeName.timeline),O=Object(i.useRef)(!1),[x,S]=Object(i.useState)(null),[k,w]=Object(i.useState)(!1),T=Object(i.useCallback)((e=>{w(!0),S(e),e.dataViewId===j||Object(a.isEmpty)(e.indexNames)||t(d.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:e.dataViewId,selectedPatterns:e.indexNames}))}),[j,t]),[C]=Object(i.useState)({dataViewId:j,selectedPatterns:E}),M=Object(i.useMemo)((()=>null==x||Object(a.isEmpty)(h)||null!==x.dataViewId&&null!==j&&j!==x.dataViewId?null:h),[h,j,x]),I=Object(p.f)(v),A=Object(i.useMemo)(I,[I]),P=Object(p.f)(y),_=Object(i.useMemo)(P,[P]),D=Object(i.useCallback)((()=>{if(null!=x&&null!=M){try{const t=()=>{var e,t,n,a,i,s,r;return{dataProviders:null!=x.dataProviders&&x.dataProviders.length>0?Object(o.f)(Object(f.g)(x.dataProviders,M),{fields:[],title:E.join(",")}):"",query:{query:null!==(e=null===(t=x.kqlQuery.filterQuery)||void 0===t||null===(n=t.kuery)||void 0===n?void 0:n.expression)&&void 0!==e?e:"",language:null!==(a=null===(i=x.kqlQuery.filterQuery)||void 0===i||null===(s=i.kuery)||void 0===s?void 0:s.kind)&&void 0!==a?a:"kuery"},filters:null!==(r=x.filters)&&void 0!==r?r:[],eqlOptions:{}}},n=()=>{var e;return{dataProviders:"",query:{query:null!==(e=x.eqlOptions.query)&&void 0!==e?e:"",language:"eql"},filters:[],eqlOptions:{eqlOptions:x.eqlOptions}}},a=O.current?n():t();w(!1),e({index:E,queryBar:{filters:""!==a.dataProviders?[...a.filters,Object(b.b)(a.dataProviders)]:a.filters,query:a.query,saved_id:null},...a.eqlOptions})}catch(e){w(!1),n(e,{toastMessage:r.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.toastMessage",{defaultMessage:"Failed to create rule from timeline with id: {id}",values:{id:x.id}}),title:r.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.title",{defaultMessage:"Failed to import rule from timeline"})})}O.current=!1,C.dataViewId!==j&&t(d.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:C.dataViewId,selectedPatterns:C.selectedPatterns}))}}),[n,j,t,C.dataViewId,C.selectedPatterns,M,E,x,e]);Object(i.useEffect)((()=>{null!=M&&D()}),[D,M]);const R=Object(i.useCallback)((e=>{null!=x&&e===x.id||Object(m.h)({timelineId:e,onOpenTimeline:T,updateIsLoading:({id:e,isLoading:n})=>t(Object(l.updateIsLoading)({id:e,isLoading:n})),updateTimeline:Object(m.b)(t)})}),[t,T,x]),[F,N]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{if(!F){let e=null;null!=A?e=A:null!=_&&(e=_,O.current=!0),null!=e&&(N(!0),R(e),w(!0))}}),[R,A,_,F]),{loading:k,onOpenTimeline:T}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return k}));var a=n(45),i=n(2),s=n.n(i),r=n(48),o=n(3),l=n(136),u=n.n(l),c=n(53),d=n(517),m=n.n(d),p=n(119),f=n(121),b=n(116),g=n(172),v=n(560),y=n(757),h=n(145),j=n(118);const E=m.a.div`
  /*
  *
  * hide search bar default filters as they are disturbing the layout  as shown below
  *
  * Filters are displayed with QueryBar so below is how is the layout with default filters.
  *
  *
  *                    --------------------------------
  *   -----------------|                              |------------
  *   | DataViewPicker |        QueryBar              | Date      |
  *   -------------------------------------------------------------
  *                    |      Filters                 |
  *                    --------------------------------
  *
  * The tree under this component makes sure that default filters are not rendered and we can separately display
  * them outside query component so that layout is as below:
  *
  *   -----------------------------------------------------------
  *   | DataViewPicker |      QueryBar              |   Date    |
  *   -----------------------------------------------------------
  *   |                       Filters                           |
  *   -----------------------------------------------------------
  *
  * */
  .uniSearchBar .filter-items-group {
    display: none;
  }

  .euiDataGrid__restrictBody & {
    .kbnQueryBar {
      display: flex;
    }
  }
`,O="timeline-filter-drop-area",x=(e=[])=>e.filter((e=>e.meta.controlledBy!==O)),S=Object(i.memo)((({dataProviders:e,filters:t,filterManager:n,filterQuery:a,from:l,fromStr:c,kqlMode:d,isRefreshPaused:m,savedQueryId:S,setFilters:w,setSavedQueryId:T,refreshInterval:C,timelineId:M,to:I,toStr:A,updateReduxTime:P})=>{const _=Object(r.useDispatch)(),[D,R]=Object(i.useState)(null!=c?c:new Date(l).toISOString()),[F,N]=Object(i.useState)(null!=A?A:new Date(I).toISOString()),{browserFields:L,indexPattern:z}=Object(f.d)(b.SourcererScopeName.timeline),[B,q]=Object(i.useState)(void 0),[V,$]=Object(i.useState)({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"}),[U,Q]=Object(i.useState)(x(t)),[H,G]=Object(i.useState)(Object(g.f)(Object(h.g)(e,L),z)),W=Object(v.a)(),K=Object(i.useCallback)(((e,t)=>_(j.a.applyKqlFilterQuery({id:M,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(g.f)(e,z)}}))),[_,z,M]);Object(i.useEffect)((()=>{let e=!0;const a=new o.Subscription;return n.setFilters(t),a.add(n.getUpdates$().subscribe({next:()=>{if(e){const e=x(n.getFilters());w(e),Q(e)}}})),()=>{e=!1,a.unsubscribe()}}),[]),Object(i.useEffect)((()=>{const e=x(n.getFilters());u()(t,e)||n.setFilters(t)}),[t]),Object(i.useEffect)((()=>{$({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"})}),[a]),Object(i.useEffect)((()=>{G(Object(g.f)(Object(h.g)(e,L),z))}),[e,L,z]),Object(i.useEffect)((()=>{null!=c&&null!=A?(R(c),N(A)):null!=l&&null!=I&&(R(new Date(l).toISOString()),N(new Date(I).toISOString()))}),[l,c,I,A]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=S&&null!=W)try{const n=await W.getSavedQuery(S);e&&null!=n&&q({...n,attributes:{...n.attributes,filters:x(t)}})}catch(e){q(void 0)}else e&&q(void 0)}(),()=>{e=!1}}),[S]);const J=Object(i.useCallback)(((e,t)=>{if((null==a||null!=a&&a.expression!==e.query||a.kind!==e.language)&&K(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");P({id:p.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:M,hasRangeChanged:!0})}}),[a,M]),Y=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==S&&T(e.id),null!=W&&""!==H){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===O)):-1;W.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),k(H),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,k(H)]:[]})}}else T(null)}),[H,S,W]);return s.a.createElement(E,{className:"search_bar_container"},s.a.createElement(y.a,{dateRangeFrom:D,dateRangeTo:F,hideSavedQuery:"search"===d,indexPattern:z,isRefreshPaused:m,filterQuery:V,filterManager:n,filters:U,onSubmitQuery:J,refreshInterval:C,savedQuery:B,onSavedQuery:Y,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"}))})),k=e=>{const t=JSON.parse(e),n=Object.keys(t);return{...t,meta:{alias:O,controlledBy:O,negate:!1,disabled:!1,type:"custom",key:Object(a.isEmpty)(n)?"bool":n[0],value:e},$state:{store:c.FilterStateStore.APP_STATE}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(17),i=n(2),s=n.n(i),r=n(44);const o=n.n(r)()((({iconSide:e,children:t,...n})=>s.a.createElement(a.EuiLink,n,t))).withConfig({displayName:"Link",componentId:"sc-z5mbxm-0"})(["",""],(({iconSide:e,theme:t})=>Object(r.css)(["align-items:center;display:inline-flex;vertical-align:top;white-space:nowrap;"," ",""],"left"===e&&Object(r.css)([".euiIcon{margin-right:",";}"],t.eui.euiSizeXS),"right"===e&&Object(r.css)(["flex-direction:row-reverse;.euiIcon{margin-left:",";}"],t.eui.euiSizeXS))));o.displayName="Link";const l=s.a.memo((({ariaLabel:e,children:t,color:n,dataTestSubj:r,disabled:l,href:u,iconSide:c="left",iconSize:d="s",iconType:m,onClick:p})=>{const f=Object(i.useCallback)((e=>"object"==typeof e&&null!=e&&"props"in e&&e.props&&e.props.children?f(e.props.children):null!=e&&Object.keys(e).length>0?e:""),[]),b=Object(i.useMemo)((()=>e||f(t)),[e,t,f]);return s.a.createElement(o,{className:"siemLinkIcon",color:n,"data-test-subj":r,disabled:l,href:u,iconSide:c,onClick:p,"aria-label":b},s.a.createElement(a.EuiIcon,{size:d,type:m}),s.a.createElement("span",{className:"siemLinkIcon__label"},t))}));l.displayName="LinkIcon"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>{const n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.click(),window.URL.revokeObjectURL(n),a.remove()}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),s=n(44);const r=n.n(s).a.div.withConfig({displayName:"Wrapper",componentId:"sc-4ssvqk-0"})(["",""],(({theme:e})=>Object(s.css)([".siemSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));r.displayName="Wrapper";const o=i.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?i.a.createElement("p",{className:"siemSubtitle__item siemSubtitle__item--text","data-test-subj":t},e):i.a.createElement("div",{className:"siemSubtitle__item siemSubtitle__item--node","data-test-subj":t},e)));o.displayName="SubtitleItem";const l=i.a.memo((({items:e})=>i.a.createElement(r,{className:"siemSubtitle"},Array.isArray(e)?e.map(((e,t)=>i.a.createElement(o,{key:t},e))):i.a.createElement(o,null,e))));l.displayName="Subtitle"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5);const i=e=>e?a.i18n.translate("xpack.securitySolution.toggleQuery.on",{defaultMessage:"Open"}):a.i18n.translate("xpack.securitySolution.toggleQuery.off",{defaultMessage:"Closed"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),s=n(17),r=n(113),o=n(132),l=n(193);const u=({timelineType:e,elasticTemplateTimelineCount:t,customTemplateTimelineCount:n})=>{const[u,c]=Object(a.useState)(null),d=Object(a.useMemo)((()=>e===r.l.template),[e]),m=Object(a.useMemo)((()=>d?u:null),[u,d]),p=Object(a.useMemo)((()=>null==m?null:m===r.g.elastic?r.k.immutable:r.k.active),[m]),f=Object(a.useMemo)((()=>[{id:r.g.elastic,name:o.s,disabled:!d,withNext:!0,count:null!=t?t:void 0},{id:r.g.custom,name:o.r,disabled:!d,withNext:!1,count:null!=n?n:void 0}]),[n,t,d]),b=Object(a.useCallback)((e=>{c(u===e?null:e)}),[c,u]),g=Object(a.useMemo)((()=>d?f.map((e=>i.a.createElement(s.EuiFilterButton,{hasActiveFilters:e.id===m,key:`template-timeline-filter-${e.id}`,numFilters:e.count,onClick:b.bind(null,e.id),withNext:e.withNext,isDisabled:e.disabled,"data-test-subj":e.name},e.name))):null),[m,f,d,b]),v=Object(a.useCallback)((async()=>{m!==r.g.custom&&await Object(l.g)()}),[m]);return{timelineStatus:p,templateTimelineType:m,templateTimelineFilter:g,installPrepackagedTimelines:v}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(485),s=n(110);const r=()=>{const{conversations:e}=Object(i.a)(),{services:{telemetry:t}}=Object(s.i)(),n=Object(a.useCallback)((t=>{var n;return(null!==(n=e[t])&&void 0!==n?n:{isDefault:!1}).isDefault?t:"Custom"}),[e]),r=Object(a.useCallback)((({fn:e,params:{conversationId:t,...a}})=>e({...a,conversationId:n(t)})),[n]);return{reportAssistantInvoked:e=>r({fn:t.reportAssistantInvoked,params:e}),reportAssistantMessageSent:e=>r({fn:t.reportAssistantMessageSent,params:e}),reportAssistantQuickPrompt:e=>r({fn:t.reportAssistantQuickPrompt,params:e})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return s})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return c}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addedNoteToTimelineToast",{defaultMessage:"Added note to timeline"}),s=a.i18n.translate("xpack.securitySolution.assistant.commentActions.viewAPMTraceLabel",{defaultMessage:"View APM Trace for this message"}),r=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addMessageContentAsTimelineNoteAriaLabel",{defaultMessage:"Add message content as a timeline note"}),o=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addNoteToTimelineTooltip",{defaultMessage:"Add note to timeline"}),l=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addToCaseExistingCase",{defaultMessage:"Add to existing case"}),u=a.i18n.translate("xpack.securitySolution.assistant.commentActions.elasticAiAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),c=a.i18n.translate("xpack.securitySolution.assistant.commentActions.copyToClipboard",{defaultMessage:"Copy to clipboard"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"f",(function(){return p}));var a=n(57),i=n(122),s=n(422),r=n(353);const o=()=>Object(a.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:i.d.query})),l=()=>Object(a.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),u=()=>Object(a.createSelector)(r.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),c=()=>Object(a.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(a.createSelector)(r.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),m=()=>Object(a.createSelector)(s.selectNotesById,(e=>Object.values(e))),p=()=>Object(a.createSelector)(r.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=e=>{const[t,n]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const a=new MutationObserver((()=>{const a=!!document.getElementById(e);a&&!t&&n(!0),!a&&t&&n(!1)}));return a.observe(document.body,{childList:!0,subtree:!0}),()=>a.disconnect()}),[t,e]),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var a=n(23),i=n.n(a),s=n(62),r=n(61),o=n.n(r),l=n(2),u=n.n(l),c=n(44),d=n.n(c),m=n(17),p=n(54),f=n(4),b=n(594),g=n(229),v=n(546),y=n(172),h=n(110),j=n(484),E=n(230),O=n(384),x=n(129),S=n(164),k=n(319);const w=e=>({text:e,value:e}),T=d()(m.EuiButton).withConfig({displayName:"StyledLinkButton",componentId:"sc-11itwu1-0"})(["margin-left:0;@media only screen and (min-width:","){margin-left:",";}"],(e=>e.theme.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiSizeL)),C=({combinedQueries:e,deleteQuery:t,filters:n,from:a,headerChildren:r,indexPattern:c,indexNames:d,runtimeMappings:m,onlyField:C,paddingSize:M,query:I,queryType:A,setAbsoluteRangeDatePickerTarget:P,setQuery:_,showLegend:D,showSpacer:R=!0,scopeId:F,sourcererScopeId:N,to:L,toggleTopN:z,hideQueryToggle:B=!1})=>{const q=Object(l.useMemo)((()=>`eventsByDatasetOverview-${A}`),[A]);Object(l.useEffect)((()=>()=>{t&&t({id:q})}),[t,q]);const V=Object(h.i)(),{formatUrl:$,search:U}=Object(S.l)(x.a.hosts),{navigateToApp:Q}=V.services.application,[H]=Object(h.o)(f.P),G=Object(l.useCallback)((e=>{e.preventDefault(),Q(f.l,{deepLinkId:x.a.hosts,path:Object(g.c)(E.HostsTableType.events,U)})}),[Q,U]),W=Object(l.useMemo)((()=>u.a.createElement(T,{onClick:G,href:$(Object(g.c)(E.HostsTableType.events))},O.o)),[G,$]),[K,J]=Object(l.useMemo)((()=>null==e?Object(y.i)({config:Object(p.getEsQueryConfig)(V.services.uiSettings),indexPattern:c,queries:[I],filters:n}):[e]),[e,V,c,I,n]);Object(k.a)({id:q,filterQuery:K,kqlError:J,query:I,startDate:a,endDate:L});const Y=Object(l.useMemo)((()=>{var e;return{...j.b,stackByOptions:null!=C?[w(C)]:j.b.stackByOptions,defaultStackByOption:null!=C?w(C):null!==(e=j.c.find((e=>"event.dataset"===e.text)))&&void 0!==e?e:j.c[0],legendPosition:s.Position.Right,subtitle:e=>`${b.b}: ${o()(e).format(H)} ${Object(b.c)(e)}`,titleSize:null==C?"m":"s"}}),[C,H]),X=Object(l.useMemo)((()=>null==C||null!=r?u.a.createElement(u.a.Fragment,null,r,null==C&&W):null),[C,r,W]);return u.a.createElement(v.a,i()({endDate:L,filterQuery:K,headerChildren:X,id:q,indexNames:d,runtimeMappings:m,onError:z,paddingSize:M,setAbsoluteRangeDatePickerTarget:P,setQuery:_,showSpacer:R,showLegend:D,skip:void 0===K,startDate:a,scopeId:F,sourcererScopeId:N},Y,{title:null!=C?O.l(C):Y.title,chartHeight:160,hideQueryToggle:B}))};C.displayName="EventsByDatasetComponent";const M=u.a.memo(C)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),s=n(17),r=n(44),o=n.n(r),l=n(265),u=n(293);const c=o()(s.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1719m3x-0"})(["height:",";width:",";position:relative;margin:0;"],(({height:e})=>e||"100%"),(({width:e})=>e||"100%"));c.displayName="FlexGroup";const d=({height:e="100%",width:t="100%",data:n})=>i.a.createElement(c,{justifyContent:"center",alignItems:"center",height:e,width:t},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiText,{size:"s",textAlign:"center",color:"subdued","data-test-subj":"chartHolderText"},Object(l.f)(n)?u.a:u.b)))},function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"g",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return d}));var a=n(5);const i=e=>a.i18n.translate("xpack.securitySolution.eventsTab.externalAlertsUnit",{values:{totalCount:e},defaultMessage:"external {totalCount, plural, =1 {alert} other {alerts}}"}),s=e=>a.i18n.translate("xpack.securitySolution.hosts.navigaton.eventsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"}),r=a.i18n.translate("xpack.securitySolution.eventsTab.showing",{defaultMessage:"Showing"}),o=a.i18n.translate("xpack.securitySolution.eventsTab.alertsGraphTitle",{defaultMessage:"External alert trend"}),l=a.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingAlertsData",{defaultMessage:"Failed to query alerts data"}),u=a.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingEventsData",{defaultMessage:"Failed to query events data"}),c=a.i18n.translate("xpack.securitySolution.eventsTab.showExternalAlerts",{defaultMessage:"Show only external alerts"}),d=a.i18n.translate("xpack.securitySolution.eventsGraphTitle",{defaultMessage:"Events"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var a=n(45),i=n(56),s=n.n(i),r=n(727);const o=[],l=e=>{var t,n,a;return(null!==(t=null==e||null===(n=e.aggregations)||void 0===n||null===(a=n.alertsByGrouping)||void 0===a?void 0:a.buckets)&&void 0!==t?t:[]).reduce(((e,{key_as_string:t,key:n,alerts:a})=>{var i;return[...e,...(null!==(i=a.buckets)&&void 0!==i?i:[]).map((({key:e,doc_count:a})=>({x:e,y:a,g:null!=t?t:n.toString()})))]}),o)},u=(e,t,n,a,i)=>({aggs:{alertsByGrouping:{terms:{field:e,order:{_count:"desc"},size:10},aggs:{alerts:{date_histogram:{field:"@timestamp",fixed_interval:`${Math.floor(s()(n).diff(s()(t))/32)}ms`,min_doc_count:0,extended_bounds:{min:t,max:n}}}}}},query:{bool:{filter:[...a,{range:{"@timestamp":{gte:t,lte:n}}}]}},runtime_mappings:i,_source:!1,size:0}),c=({isInitialLoading:e,isLoadingAlerts:t})=>e&&t,d=e=>{try{return null==e||Object(a.isEmpty)(e)?{}:JSON.parse(e)}catch{return{}}},m=e=>{try{return Object(a.isEmpty)(e)?[]:[d(e)]}catch{return[]}},p=({callback:e,order:t}={})=>({id:"resetGroupByField",getDisplayName:()=>r.b,getIconType:()=>"editorRedo",type:"actionButton",isCompatible:async()=>!0,async execute({embeddable:t}){null==e||e();const n=t.getInput(),{attributes:{state:{visualization:{columns:a}}}}=n;t.updateInput({...n,attributes:{...n.attributes,state:{...n.attributes.state,visualization:{...n.attributes.state.visualization,columns:a.map((e=>({...e,hidden:!1})))}}}})},order:t})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.inspectTitle",{defaultMessage:"Inspect"}),s=a.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.resetGroupByFieldsMenuItem",{defaultMessage:"Reset group by fields"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(328);const i=new Set([a.b.STRING,a.b.BOOLEAN,a.b.NUMBER,a.b.IP]),s=e=>!!e&&i.has(e)},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),s=n(17),r=n(47),o=n(63);const l={tall:490,short:250},u=Object(a.createContext)({tableId:null}),c=({height:e="tall"})=>i.a.createElement(s.EuiPanel,{color:"subdued"},i.a.createElement(s.EuiFlexGroup,{style:{height:l[e]},alignItems:"center",justifyContent:"center","data-test-subj":"loading-alerts-panel"},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiLoadingSpinner,{size:"xl"})))),d={maxWidth:500},m=()=>{const{http:e}=Object(o.useKibana)().services;return i.a.createElement(s.EuiPanel,{color:"subdued","data-test-subj":"tGridEmptyState"},i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiPanel,{hasBorder:!0,style:d},i.a.createElement(s.EuiFlexGroup,null,i.a.createElement(s.EuiFlexItem,null,i.a.createElement(s.EuiText,{size:"s"},i.a.createElement(s.EuiTitle,null,i.a.createElement("h3",null,i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.title",defaultMessage:"No results match your search criteria"}))),i.a.createElement("p",null,i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiImage,{size:"200",alt:"",url:e.basePath.prepend("/plugins/timelines/assets/illustration_product_no_results_magnifying_glass.svg")})))))))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.isPlatinumOrTrialLicense},,,,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return ge})),n.d(t,"b",(function(){return ve})),n.d(t,"a",(function(){return he}));var a=n(2),i=n.n(a),s=n(48),r=n(60),o=n(711),l=n(110),u=n(4),c=n(112),d=n(122),m=n(118),p=n(14),f=n(393),b=n(196),g=n(47),v=n(44),y=n.n(v),h=n(113),j=n(750),E=n(478),O=n(193),x=n(135),S=n(17),k=n(132),w=n(49),T=n(117),C=n(714);const M=({onComplete:e,isEnableDownloader:t,exportedIds:n})=>{const{tabName:i}=Object(w.useParams)(),{addSuccess:s}=Object(T.a)(),r=Object(a.useCallback)((t=>{null!=e&&e(),s({title:i===h.l.template?k.U(t):k.T(t),"data-test-subj":"addObjectToContainerSuccess"})}),[s,e,i]),o=Object(a.useCallback)((()=>{null!=e&&e()}),[e]);return Object(a.useEffect)((()=>{(async()=>{if(null!=n&&n.length&&t){const e=await Object(O.c)({ids:n});e instanceof Blob?(Object(C.a)(e,`${k.n}.ndjson`),r(n.length)):o()}})()}),[n,t]),null};M.displayName="ExportTimeline";const I=i.a.memo(M);var A=n(45);const P=i.a.memo((({title:e,closeModal:t,onDelete:n})=>{const{tabName:s}=Object(w.useParams)(),r=s===h.l.template?k.j:k.k,o=Object(a.useCallback)((()=>{const t=null!=e?e.trim():"",n=Object(A.isEmpty)(t)?k.ab:t;return i.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.open.timeline.deleteTimelineModalTitle",defaultMessage:'Delete "{title}"?',"data-test-subj":"title",values:{title:n}})}),[e]);return i.a.createElement(S.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:k.b,confirmButtonText:k.h,defaultFocusedButton:S.EUI_MODAL_CONFIRM_BUTTON,onCancel:t,onConfirm:n,title:o()},i.a.createElement("div",{"data-test-subj":"warning"},r))}));P.displayName="DeleteTimelineModal";const _=Object(v.createGlobalStyle)(["div[data-popover-open]{display:none;}"]),D=i.a.memo((({deleteTimelines:e,isModalOpen:t,savedObjectIds:n,title:s,onComplete:r,savedSearchIds:o})=>{const{addSuccess:l}=Object(T.a)(),{tabName:u}=Object(w.useParams)(),c=Object(a.useCallback)((()=>{null!=r&&r()}),[r]),d=Object(a.useCallback)((()=>{n.length>0&&null!=o&&o.length>0?(e(n,o),l({title:u===h.l.template?k.S(n.length):k.R(n.length)})):n.length>0&&(e(n),l({title:u===h.l.template?k.S(n.length):k.R(n.length)})),null!=r&&r()}),[e,n,r,l,u,o]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(_,{"data-test-subj":"remove-popover"}),t?i.a.createElement(S.EuiModal,{maxWidth:600,onClose:c},i.a.createElement(P,{"data-test-subj":"delete-timeline-modal",onDelete:d,title:s,closeModal:c})):null)}));D.displayName="DeleteTimelineModalOverlay";const R=({deleteTimelines:e,ids:t,savedSearchIds:n,isEnableDownloader:a,isDeleteTimelineModalOpen:s,onComplete:r,title:o})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(I,{"data-test-subj":"TimelineDownloader",exportedIds:t,isEnableDownloader:a,onComplete:r}),null!=e&&i.a.createElement(D,{"data-test-subj":"DeleteTimelineModalOverlay",deleteTimelines:e,isModalOpen:s,onComplete:r,savedObjectIds:t,savedSearchIds:n,title:o})),F=i.a.memo(R),N=()=>{const[e,t]=Object(a.useState)(null),[n,i]=Object(a.useState)(!1),[s,r]=Object(a.useState)(!1),o=Object(a.useCallback)((()=>{i(!1),t(null)}),[e]),l=Object(a.useCallback)((e=>{i(!0),null!=e&&t(e)}),[]),u=Object(a.useCallback)((e=>{r(!0),null!=e&&t(e)}),[]),c=Object(a.useCallback)((()=>{r(!1),t(null)}),[]);return{actionItem:e,onCompleteEditTimelineAction:Object(a.useCallback)((()=>{i(!1),r(!1),t(null)}),[]),isDeleteTimelineModalOpen:n,onCloseDeleteTimelineModal:o,onOpenDeleteTimelineModal:l,isEnableDownloader:s,enableExportTimelineDownloader:u,disableExportTimelineDownloader:c}},L=y.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-1dq1et8-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));L.displayName="SearchRowContainer";const z=y()(S.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-1dq1et8-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));z.displayName="SearchRowFlexGroup";const B=i.a.memo((({favoriteCount:e,onlyFavorites:t,onQueryChange:n,onToggleOnlyFavorites:s,children:r,timelineType:o})=>{const l=Object(a.useMemo)((()=>({placeholder:o===h.l.default?k.L:k.M,incremental:!1,"data-test-subj":"search-bar"})),[o]);return i.a.createElement(L,null,i.a.createElement(z,{gutterSize:"s"},i.a.createElement(S.EuiFlexItem,null,i.a.createElement(S.EuiSearchBar,{box:l,onChange:n})),i.a.createElement(S.EuiFlexItem,{grow:!1},i.a.createElement(S.EuiFilterGroup,{fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiFilterButton,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:t,onClick:s,numFilters:null!=e?e:void 0},k.D),!!r&&r)))))}));B.displayName="SearchRow";var q=n(23),V=n.n(q);const $=({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:a,onOpenTimeline:i,onCreateRule:s,onCreateRuleFromEql:r,hasCrudAccess:o})=>[{width:o?"80px":"150px",actions:[{name:k.g,icon:"timeline",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:h.l.default,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.g,"data-test-subj":"create-from-template",available:t=>t.timelineType===h.l.template&&e.includes("createFrom")},{name:k.f,icon:"visText",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:h.l.template,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.f,"data-test-subj":"create-template-from-timeline",available:t=>t.timelineType!==h.l.template&&e.includes("createFrom")},{name:k.E,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.E,"data-test-subj":"open-duplicate",available:t=>t.timelineType!==h.l.template&&e.includes("duplicate")},{name:k.F,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.F,"data-test-subj":"open-duplicate-template",available:t=>t.timelineType===h.l.template&&e.includes("duplicate")},{name:k.o,icon:"exportAction",onClick:e=>{null!=n&&n(e)},enabled:e=>null!=e.savedObjectId&&e.status!==h.k.immutable,description:k.o,"data-test-subj":"export-timeline",available:()=>e.includes("export")},{name:k.i,icon:"trash",onClick:e=>{null!=a&&a(e)},enabled:({savedObjectId:e,status:t})=>null!=e&&t!==h.k.immutable,description:k.i,"data-test-subj":"delete-timeline",available:()=>e.includes("delete")&&null!=t},{name:k.d,icon:"indexEdit",onClick:e=>{null!=s&&e.savedObjectId&&s(e.savedObjectId)},enabled:e=>null!=s&&null!=e.savedObjectId&&e.status!==h.k.immutable,description:k.d,"data-test-subj":"create-rule-from-timeline",available:({queryType:t})=>e.includes("createRule")&&null!=s&&null!=t&&t.hasQuery},{name:k.e,icon:"indexEdit",onClick:e=>{null!=r&&e.savedObjectId&&r(e.savedObjectId)},enabled:e=>null!=r&&null!=e.savedObjectId&&e.status!==h.k.immutable,description:k.d,"data-test-subj":"create-rule-from-eql",available:({queryType:t})=>e.includes("createRuleFromEql")&&null!=r&&null!=t&&t.hasEql}]}],U="45px";var Q=n(162),H=n(697),G=n(126),W=n(155);const K=y.a.span.withConfig({displayName:"LineClampTextContainer",componentId:"sc-4zme7l-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;"]),J=({itemIdToExpandedNotesRowMap:e,onOpenTimeline:t,onToggleShowNotes:n,timelineType:a})=>[{isExpander:!0,render:({notes:t,savedObjectId:a})=>null!=t&&t.length>0&&null!=a?i.a.createElement(S.EuiButtonIcon,{"data-test-subj":"expand-notes",onClick:()=>null!=e[a]?n(Object(A.omit)(a,e)):n({...e,[a]:i.a.createElement(H.a,{notes:t})}),"aria-label":e[a]?k.c:k.m,iconType:e[a]?"arrowDown":"arrowRight"}):null,width:U},{dataType:"string",field:"title",name:a===h.l.default?k.Y:k.Z,render:(e,n)=>null!=n.savedObjectId?i.a.createElement(S.EuiLink,{"data-test-subj":`timeline-title-${n.savedObjectId}`,onClick:()=>t({duplicate:!1,timelineId:`${n.savedObjectId}`})},Object(Q.f)(n)?k.ab:i.a.createElement(K,null,e)):i.a.createElement("div",{"data-test-subj":`title-no-saved-object-id-${e||"no-title"}`},Object(Q.f)(n)?k.ab:e),sortable:!1},{dataType:"string",field:"description",name:k.l,render:e=>i.a.createElement(K,{"data-test-subj":"description"},null!=e&&e.trim().length>0?e:Object(G.d)()),sortable:!1},{dataType:"date",field:"updated",name:k.y,render:(e,t)=>i.a.createElement("div",{"data-test-subj":"updated"},null!=t.updated?i.a.createElement(W.b,{value:e}):Object(G.d)()),sortable:!0}],Y=e=>e?[{dataType:"string",field:"updatedBy",name:k.B,render:e=>i.a.createElement("div",{"data-test-subj":"username"},Object(G.a)(e)),sortable:!1}]:[],X=({timelineType:e})=>{const t={note:{align:"center",field:"eventIdToNoteIds",name:i.a.createElement(S.EuiToolTip,{content:k.C},i.a.createElement(S.EuiIcon,{"data-test-subj":"notes-count-header-icon",size:"m",type:"editorComment"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"notes-count"},Object(Q.d)(t)),sortable:!1,width:U},pinnedEvent:{align:"center",field:"pinnedEventIds",name:i.a.createElement(S.EuiToolTip,{content:k.J},i.a.createElement(S.EuiIcon,{"data-test-subj":"pinned-event-header-icon",size:"m",type:"pin"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"pinned-event-count"},`${Object(Q.e)(t)}`),sortable:!1,width:U},favorite:{align:"center",field:"favorite",name:i.a.createElement(S.EuiToolTip,{content:k.p},i.a.createElement(S.EuiIcon,{"data-test-subj":"favorites-header-icon",size:"m",type:"starEmpty"})),render:e=>{const t=null!=e&&e.length>0?"starFilled":"starEmpty";return i.a.createElement(S.EuiIcon,{"data-test-subj":`favorite-${t}-star`,type:t,size:"m"})},sortable:!1,width:U}},n=[t.note,t.favorite],a=[t.pinnedEvent,t.note,t.favorite];return e===h.l.template?n:a},Z=S.EuiBasicTable,ee=y()(Z).withConfig({displayName:"BasicTable",componentId:"sc-1yfhyq7-0"})([".euiTableCellContent{animation:none;}.euiTableRow-isExpandedRow .euiTableCellContent__text{width:100%;}"]);ee.displayName="BasicTable";const te=i.a.memo((({actionTimelineToShow:e,deleteTimelines:t,defaultPageSize:n,loading:s,itemIdToExpandedNotesRowMap:r,enableExportTimelineDownloader:o,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:c,onOpenTimeline:d,onSelectionChange:m,onTableChange:p,onToggleShowNotes:f,pageIndex:b,pageSize:g,searchResults:v,showExtendedColumns:y,sortField:j,sortDirection:E,tableRef:O,timelineType:S,totalSearchResultsCount:w})=>{const T={showPerPageOptions:y,pageIndex:b,pageSize:g,pageSizeOptions:[Math.floor(Math.max(n,1)/2),n,2*n],totalItemCount:w},C={sort:{field:j,direction:E}},M={selectable:e=>null!=e.savedObjectId&&e.status!==h.k.immutable,selectableMessage:e=>e?void 0:k.A,onSelectionChange:m},I=null!=O?{ref:O}:{},{kibanaSecuritySolutionsPrivileges:A}=Object(x.a)(),P=Object(a.useMemo)((()=>(({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,itemIdToExpandedNotesRowMap:a,onCreateRule:i,onCreateRuleFromEql:s,onOpenDeleteTimelineModal:r,onOpenTimeline:o,onToggleShowNotes:l,showExtendedColumns:u,timelineType:c,hasCrudAccess:d})=>[...J({itemIdToExpandedNotesRowMap:a,onOpenTimeline:o,onToggleShowNotes:l,timelineType:c}),...Y(u),...X({timelineType:c}),...e.length?$({onCreateRule:i,onCreateRuleFromEql:s,actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:r,onOpenTimeline:o,hasCrudAccess:d}):[]])({actionTimelineToShow:e,deleteTimelines:t,itemIdToExpandedNotesRowMap:r,enableExportTimelineDownloader:o,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:c,onOpenTimeline:d,onSelectionChange:m,onToggleShowNotes:f,showExtendedColumns:y,timelineType:S,hasCrudAccess:A.crud})),[e,t,r,o,l,u,c,d,m,f,y,S,A]),_=s||null==v?k.z:S===h.l.template?k.db:k.cb;return i.a.createElement(ee,V()({columns:P,"data-test-subj":"timelines-table",isExpandable:!0,isSelectable:e.includes("selectable"),itemId:"savedObjectId",itemIdToExpandedRowMap:r,items:null!=v?v:[],loading:s,noItemsMessage:_,onChange:p,pagination:T,selection:e.includes("selectable")?M:void 0,sorting:C},I))}));te.displayName="TimelinesTable";const ne=y.a.span.withConfig({displayName:"QueryText",componentId:"sc-1qxahey-0"})(["white-space:normal;word-break:break-word;"]),ae=i.a.memo((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,isLoading:s,itemIdToExpandedNotesRowMap:r,importDataModalToggle:o,onCreateRule:l,onCreateRuleFromEql:u,onDeleteSelected:c,onlyFavorites:d,onOpenTimeline:m,onQueryChange:p,onSelectionChange:f,onTableChange:b,onToggleOnlyFavorites:v,onToggleShowNotes:y,pageIndex:w,pageSize:T,query:C,refetch:M,searchResults:I,selectedItems:A,sortDirection:P,setImportDataModalToggle:_,sortField:D,timelineType:R=h.l.default,timelineStatus:L,timelineFilter:z,templateTimelineFilter:q,totalSearchResultsCount:V})=>{var $;const U=Object(a.useRef)(),{actionItem:H,enableExportTimelineDownloader:G,isEnableDownloader:W,isDeleteTimelineModalOpen:K,onOpenDeleteTimelineModal:J,onCompleteEditTimelineAction:Y}=N(),{kibanaSecuritySolutionsPrivileges:X}=Object(x.a)(),{getBatchItemsPopoverContent:Z}=(({deleteTimelines:e,selectedItems:t,tableRef:n,timelineType:s=h.l.default})=>{const{enableExportTimelineDownloader:r,disableExportTimelineDownloader:o,isEnableDownloader:l,isDeleteTimelineModalOpen:u,onOpenDeleteTimelineModal:c,onCloseDeleteTimelineModal:d}=N(),m=Object(a.useCallback)((e=>{null!=e&&e(),null!=n&&null!=n.current&&n.current.changeSelection([]),o(),d()}),[o,d,n]),{timelineIds:p,searchIds:f}=Object(a.useMemo)((()=>null!=t?ve(ge(t)):{timelineIds:[],searchIds:void 0}),[t]),b=Object(a.useCallback)((()=>r()),[r]),g=Object(a.useCallback)((()=>c()),[c]),v=Object(a.useCallback)((n=>{var a,r,o,c;const d=null==t||0===t.length,v=[];return t&&v.push(i.a.createElement(S.EuiContextMenuItem,{"data-test-subj":"export-timeline-action",disabled:d,icon:"exportAction",key:"ExportItemKey",onClick:b},k.o)),e&&v.push(i.a.createElement(S.EuiContextMenuItem,{"data-test-subj":"delete-timeline-action",disabled:d,icon:"trash",key:"DeleteItemKey",onClick:g},k.i)),i.a.createElement(i.a.Fragment,null,i.a.createElement(F,{deleteTimelines:e,ids:p,savedSearchIds:f,isEnableDownloader:l,isDeleteTimelineModalOpen:u,onComplete:m.bind(null,n),title:1!==(null==t?void 0:t.length)?s===h.l.template?k.N(null!==(a=null==t?void 0:t.length)&&void 0!==a?a:0):k.O(null!==(r=null==t?void 0:t.length)&&void 0!==r?r:0):null!==(o=null===(c=t[0])||void 0===c?void 0:c.title)&&void 0!==o?o:""}),i.a.createElement(S.EuiContextMenuPanel,{items:v}))}),[t,e,p,f,l,u,m,s,b,g]);return{onCompleteBatchActions:m,getBatchItemsPopoverContent:v}})({deleteTimelines:X.crud?e:void 0,selectedItems:A,tableRef:U,timelineType:R}),ee=Object(a.useMemo)((()=>i.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTemplatesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {template} other {templates}} {with}",values:{totalSearchResultsCount:V,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},C.trim().length?`${k.bb} "${C.trim()}"`:"")}})),[V,C]),ae=Object(a.useMemo)((()=>i.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTimelinesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {timeline} other {timelines}} {with}",values:{totalSearchResultsCount:V,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},C.trim().length?`${k.bb} "${C.trim()}"`:"")}})),[V,C]),ie=Object(a.useMemo)((()=>null!=H&&null!=H.savedObjectId?[H.savedObjectId]:[]),[H]),se=Object(a.useMemo)((()=>null!=H&&null!=H.savedSearchId?[H.savedSearchId]:void 0),[H]),re=Object(a.useCallback)((()=>{null!=M&&M()}),[M]),oe=Object(a.useCallback)((()=>{null!=_&&_(!1)}),[_]),le=Object(a.useCallback)((()=>{null!=_&&_(!1),null!=M&&M()}),[_,M]),ue=Object(a.useMemo)((()=>{if(X.crud){const t=["createFrom","duplicate",...null!=l?["createRule"]:[],...null!=u?["createRuleFromEql"]:[]];return L!==h.k.immutable&&(t.push("export"),t.push("selectable")),null!=c&&null!=e&&L!==h.k.immutable&&t.push("delete"),t}return L!==h.k.immutable?["export","selectable"]:[]}),[l,u,L,c,e,X]),ce=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,q)),[q]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(F,{deleteTimelines:e,ids:ie,savedSearchIds:se,isDeleteTimelineModalOpen:K,isEnableDownloader:W,onComplete:Y,title:null!==($=null==H?void 0:H.title)&&void 0!==$?$:k.ab}),i.a.createElement(j.a,{checkBoxLabel:k.I,closeModal:oe,description:k.P,errorMessage:k.t,failedDetailed:k.u,importComplete:le,importData:O.f,successMessage:k.V,showCheckBox:!1,showModal:null!=o&&o,submitBtnText:k.w,subtitle:k.x,title:k.v}),i.a.createElement("div",{className:Q.a},!!z&&z,i.a.createElement(B,{"data-test-subj":"search-row",favoriteCount:n,onlyFavorites:d,onQueryChange:p,onToggleOnlyFavorites:v,query:C,timelineType:R},ce),i.a.createElement(E.a,{border:!0},i.a.createElement(E.d,null,i.a.createElement(E.c,null,i.a.createElement(E.e,{"data-test-subj":"query-message"},i.a.createElement(i.a.Fragment,null,k.Q," ",R===h.l.template?ee:ae))),i.a.createElement(E.c,null,L!==h.k.immutable&&i.a.createElement(i.a.Fragment,null,i.a.createElement(E.e,{"data-test-subj":"selected-count"},R===h.l.template?k.N(A.length):k.O(A.length)),i.a.createElement(E.b,{dataTestSubj:"batchActions",iconSide:"right",iconType:"arrowDown",popoverContent:Z,"data-test-subj":"utility-bar-action"},i.a.createElement("span",{"data-test-subj":"utility-bar-action-button"},k.a))),i.a.createElement(E.b,{dataTestSubj:"refreshButton",iconSide:"right",iconType:"refresh",onClick:re},k.K)))),i.a.createElement(te,{actionTimelineToShow:ue,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:s,itemIdToExpandedNotesRowMap:r,enableExportTimelineDownloader:G,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:J,onOpenTimeline:m,onSelectionChange:f,onTableChange:b,onToggleShowNotes:y,pageIndex:w,pageSize:T,searchResults:I,showExtendedColumns:!0,sortDirection:P,sortField:D,timelineType:R,tableRef:U,totalSearchResultsCount:V})))}));ae.displayName="OpenTimeline";var ie=n(170);const se=i.a.memo((({children:e,onAddTimelinesToFavorites:t,selectedTimelinesCount:n,title:a})=>i.a.createElement(ie.a,{title:a,split:!0,height:40},i.a.createElement(S.EuiFlexGroup,{gutterSize:"s",responsive:!1},t&&i.a.createElement(S.EuiFlexItem,{grow:!1},i.a.createElement(S.EuiButton,{"data-test-subj":"favorite-selected",iconSide:"left",iconType:"starEmptySpace",isDisabled:0===n,onClick:t},k.q)),e&&i.a.createElement(S.EuiFlexItem,null,e)))));se.displayName="TitleRow";const re=y.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-98e87t-0"})(["width:100%;"]);re.displayName="HeaderContainer";const oe=Object(a.memo)((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,hideActions:s=[],isLoading:r,itemIdToExpandedNotesRowMap:o,onAddTimelinesToFavorites:l,onDeleteSelected:u,onlyFavorites:c,onOpenTimeline:d,onQueryChange:m,onSelectionChange:p,onTableChange:f,onToggleOnlyFavorites:b,onToggleShowNotes:g,pageIndex:v,pageSize:y,searchResults:h,selectedItems:j,sortDirection:E,sortField:O,timelineFilter:x,timelineType:k,templateTimelineFilter:w,title:T,totalSearchResultsCount:C})=>{const M=Object(a.useMemo)((()=>{const t=["createFrom","duplicate"];return null!=u&&null!=e&&t.push("delete"),t.filter((e=>!s.includes(e)))}),[u,e,s]),I=Object(a.useMemo)((()=>i.a.createElement(a.Fragment,{key:"search-row-content"},!!w&&w)),[w]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiModalHeader,null,i.a.createElement(re,null,i.a.createElement(se,{"data-test-subj":"title-row",onAddTimelinesToFavorites:l,selectedTimelinesCount:j.length,title:T}))),i.a.createElement(S.EuiModalBody,null,i.a.createElement(i.a.Fragment,null,!!x&&i.a.createElement(i.a.Fragment,null,x,i.a.createElement(S.EuiSpacer,{size:"m"})),i.a.createElement(B,{"data-test-subj":"search-row",onlyFavorites:c,onQueryChange:m,onToggleOnlyFavorites:b,query:"",timelineType:k},I),i.a.createElement(te,{actionTimelineToShow:M,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:r,itemIdToExpandedNotesRowMap:o,onOpenTimeline:d,onSelectionChange:p,onTableChange:f,onToggleShowNotes:g,pageIndex:v,pageSize:y,searchResults:h,showExtendedColumns:!1,sortDirection:E,sortField:O,timelineType:k,totalSearchResultsCount:C}))))}));oe.displayName="OpenTimelineModalBody";var le=n(129),ue=n(164);let ce;!function(e){e.tab="tab",e.filter="filter"}(ce||(ce={}));var de=n(718),me=n(116),pe=n(121),fe=n(184),be=n(224);const ge=e=>e.reduce(((e,t)=>null!=t.savedObjectId&&null!=t.savedSearchId?[...e,{timelineId:t.savedObjectId,searchId:t.savedSearchId}]:null!=t.savedObjectId?[...e,{timelineId:t.savedObjectId}]:e),[]),ve=e=>e.reduce(((e,{timelineId:t,searchId:n})=>{let a=e;return null!=n&&(a={...a,searchIds:[...a.searchIds,n]}),null!=t&&(a={...a,timelineIds:[...a.timelineIds,t]}),a}),{timelineIds:[],searchIds:[]}),ye=i.a.memo((({closeModalTimeline:e,defaultPageSize:t,hideActions:n=[],isModal:g=!1,importDataModalToggle:v,onOpenTimeline:y,setImportDataModalToggle:j,title:E})=>{const x=Object(s.useDispatch)(),{startTransaction:T}=Object(fe.b)(),[C,M]=Object(a.useState)({}),[I,P]=Object(a.useState)(!1),[_,D]=Object(a.useState)(0),[R,F]=Object(a.useState)(t),[N,L]=Object(a.useState)(""),[z,B]=Object(a.useState)([]),[q,V]=Object(a.useState)("desc"),[$,U]=Object(a.useState)("updated"),H=Object(a.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),G=Object(c.b)((e=>{var t,n;return null!==(t=null===(n=H(e,d.c.active))||void 0===n?void 0:n.savedObjectId)&&void 0!==t?t:""})),{dataViewId:W,selectedPatterns:K}=Object(pe.d)(me.SourcererScopeName.timeline),J=Object(a.useMemo)((()=>Object(Q.b)(x)),[x]),Y=Object(a.useCallback)((e=>x(Object(p.updateIsLoading)(e))),[x]),{customTemplateTimelineCount:X,defaultTimelineCount:Z,elasticTemplateTimelineCount:ee,favoriteCount:te,fetchAllTimeline:ne,timelines:ie,loading:se,totalCount:re,templateTimelineCount:ye}=Object(f.b)(),{timelineType:he,timelineTabs:je,timelineFilters:Ee}=(({defaultTimelineCount:e,templateTimelineCount:t})=>{const{formatUrl:n,search:s}=Object(ue.l)(le.a.timelines),{navigateToUrl:r}=Object(l.i)().services.application,{tabName:o}=Object(w.useParams)(),[u,c]=Object(a.useState)(o===h.l.default||o===h.l.template?o:h.l.default),d=n(Object(ue.j)(h.l.default,s)),m=n(Object(ue.j)(h.l.template,s)),p=Object(a.useCallback)((e=>{e.preventDefault(),r(d)}),[r,d]),f=Object(a.useCallback)((e=>{e.preventDefault(),r(m)}),[r,m]),b=Object(a.useCallback)((e=>[{id:h.l.default,name:k.X,href:d,disabled:!1,onClick:e===ce.tab?p:A.noop},{id:h.l.template,name:k.W,href:m,disabled:!1,onClick:e===ce.tab?f:A.noop}]),[d,m,p,f]),g=Object(a.useCallback)(((e,t)=>{c((t=>(t!==e&&c(e),t)))}),[c]),v=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiTabs,{"data-test-subj":"open-timeline-subtabs"},b(ce.tab).map((e=>i.a.createElement(S.EuiTab,{"data-test-subj":`timeline-${ce.tab}-${e.id}`,isSelected:e.id===o,disabled:e.disabled,key:`timeline-${ce.tab}-${e.id}`,href:e.href,onClick:t=>{e.onClick(t),g(e.id,ce.tab)}},e.name)))),i.a.createElement(S.EuiSpacer,{size:"m"}))),[o]),y=Object(a.useMemo)((()=>i.a.createElement(S.EuiTabs,null,b(ce.filter).map((e=>i.a.createElement(S.EuiTab,{"data-test-subj":`open-timeline-modal-body-${ce.filter}-${e.id}`,isSelected:e.id===u,key:`timeline-${ce.filter}-${e.id}`,onClick:t=>{e.onClick(t),g(e.id,ce.filter)}},e.name))))),[u,b,g]);return{timelineType:u,timelineTabs:v,timelineFilters:y}})({defaultTimelineCount:Z,templateTimelineCount:ye}),{timelineStatus:Oe,templateTimelineFilter:xe,installPrepackagedTimelines:Se}=Object(de.a)({timelineType:he,customTemplateTimelineCount:X,elasticTemplateTimelineCount:ee}),ke=Object(a.useCallback)((()=>{ne({pageInfo:{pageIndex:_+1,pageSize:R},search:N,sort:{sortField:$,sortOrder:q},onlyUserFavorite:I,timelineType:he,status:Oe})}),[ne,_,R,N,$,q,he,Oe,I]),we=Object(a.useCallback)((e=>{L(e.queryText.trim())}),[]),Te=Object(a.useCallback)((async(e,t)=>{T({name:e.length>1?be.f.BULK_DELETE:be.f.DELETE}),e.includes(G)&&x(Object(p.createTimeline)({id:d.c.active,columns:b.b,dataViewId:W,indexNames:K,show:!1})),await Object(O.b)(e,t),ke()}),[T,G,ke,x,W,K]),Ce=Object(a.useCallback)((async(e,t)=>{await Te(e,t)}),[Te]),Me=Object(a.useCallback)((async()=>{const e=ge(z),{timelineIds:t,searchIds:n}=ve(e);await Te(t,n),Ne()}),[z,Te]),Ie=Object(a.useCallback)((e=>{B(e)}),[]),Ae=Object(a.useCallback)((({page:e,sort:t})=>{const{index:n,size:a}=e,{field:i,direction:s}=t;D(n),F(a),V(s),U(i)}),[]),Pe=Object(a.useCallback)((()=>{P(!I)}),[I]),_e=Object(a.useCallback)((e=>{M(e)}),[]),{navigateTo:De}=Object(l.k)(),Re=Object(a.useCallback)((e=>De({deepLinkId:u.yc.rulesCreate,path:`?${o.b}=${Object(r.encode)(e)}`})),[De]),Fe=Object(a.useCallback)((e=>De({deepLinkId:u.yc.rulesCreate,path:`?${o.a}=${Object(r.encode)(e)}`})),[De]),Ne=Object(a.useCallback)((()=>{B([])}),[]),Le=Object(a.useCallback)((({duplicate:t,timelineId:n,timelineType:a})=>{t&&T({name:be.f.DUPLICATE}),g&&null!=e&&e(),Object(Q.h)({duplicate:t,onOpenTimeline:y,timelineId:n,timelineType:a,updateIsLoading:Y,updateTimeline:J})}),[Y,J]);return Object(a.useEffect)((()=>{(()=>{const e=document.querySelector(`.${Q.a} input`);null!=e&&e.focus()})()}),[]),Object(a.useEffect)((()=>{(async()=>{await Se(),ke()})()}),[ke,Se]),g?i.a.createElement(oe,{"data-test-subj":"open-timeline-modal",deleteTimelines:Ce,defaultPageSize:t,favoriteCount:te,hideActions:n,isLoading:se,itemIdToExpandedNotesRowMap:C,onAddTimelinesToFavorites:void 0,onlyFavorites:I,onOpenTimeline:Le,onQueryChange:we,onSelectionChange:Ie,onTableChange:Ae,onToggleOnlyFavorites:Pe,onToggleShowNotes:_e,pageIndex:_,pageSize:R,query:N,searchResults:ie,selectedItems:z,sortDirection:q,sortField:$,templateTimelineFilter:xe,timelineType:he,timelineStatus:Oe,timelineFilter:Ee,title:E,totalSearchResultsCount:re}):i.a.createElement(ae,{"data-test-subj":"open-timeline",deleteTimelines:Ce,defaultPageSize:t,favoriteCount:te,isLoading:se,itemIdToExpandedNotesRowMap:C,importDataModalToggle:v,onAddTimelinesToFavorites:void 0,onCreateRule:Re,onCreateRuleFromEql:Fe,onDeleteSelected:Me,onlyFavorites:I,onOpenTimeline:Le,onQueryChange:we,onSelectionChange:Ie,onTableChange:Ae,onToggleOnlyFavorites:Pe,onToggleShowNotes:_e,pageIndex:_,pageSize:R,query:N,refetch:ke,searchResults:ie,setImportDataModalToggle:j,selectedItems:z,sortDirection:q,sortField:$,templateTimelineFilter:xe,timelineType:he,timelineStatus:Oe,timelineFilter:je,title:E,totalSearchResultsCount:re})})),he=i.a.memo(ye)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Le}));var a=n(17),i=n(2),s=n.n(i),r=n(45),o=n(48),l=n(44),u=n.n(l),c=n(54),d=n(69),m=n(203),p=n(112),f=n(118),b=n(110),g=n(121),v=n(145),y=n(172),h=n(116),j=n(113),E=n(430),O=n(244),x=n(5);const S=e=>x.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} false {template}}",values:{isTimeline:e}}),k=x.i18n.translate("xpack.securitySolution.timeline.properties.unsavedLabel",{defaultMessage:"Unsaved"}),w=(x.i18n.translate("xpack.securitySolution.timeline.properties.savedLabel",{defaultMessage:"Saved"}),x.i18n.translate("xpack.securitySolution.timeline.properties.hasChangesLabel",{defaultMessage:"Unsaved changes"})),T=(x.i18n.translate("xpack.securitySolution.timeline.properties.inspectTimelineTitle",{defaultMessage:"Timeline"}),x.i18n.translate("xpack.securitySolution.timeline.properties.readMore",{defaultMessage:"Read More"}),({isOpen:e,title:t})=>x.i18n.translate("xpack.securitySolution.timeline.properties.timelineToggleButtonAriaLabel",{values:{isOpen:e,title:t},defaultMessage:"{isOpen, select, false {Open} true {Close} other {Toggle}} timeline {title}"})),C=u()(a.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-m1giyi-0"})(["&:active,&:focus{background:transparent;}> span{padding:0;}"]),M=u()(a.EuiFlexItem).withConfig({displayName:"TitleConatiner",componentId:"sc-m1giyi-1"})(["overflow:hidden;display:inline-block;text-overflow:ellipsis;white-space:nowrap;"]),I=({timelineId:e,timelineType:t,timelineTitle:n,isOpen:l})=>{const u=Object(o.useDispatch)(),c=Object(i.useCallback)((()=>{u(f.a.showTimeline({id:e,show:!l})),Object(v.i)()}),[u,l,e]),d=Object(r.isEmpty)(n)?t===j.l.template?O.k:O.l:n,m=Object(i.useMemo)((()=>s.a.createElement(a.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"flexStart",responsive:!1},s.a.createElement(M,{"data-test-subj":"timeline-title",grow:!1},l?s.a.createElement(a.EuiText,{grow:!1},s.a.createElement("h3",null,d)):s.a.createElement(s.a.Fragment,null,d)),!l&&s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(E.b,null)))),[l,d]);return l?s.a.createElement(s.a.Fragment,null,m):s.a.createElement(C,{"aria-label":T({isOpen:l,title:d}),className:v.b,flush:"both","data-test-subj":"flyoutOverlay",size:"s",isSelected:l,onClick:c},m)},A=s.a.memo(I);var P=n(212),_=n(39),D=n(159),R=n(119),F=n(4),N=n(14),L=n(122),z=n(164),B=n(129),q=n(134);const V=({timelineId:e})=>{const t=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{cases:n,application:{navigateToApp:l}}=Object(b.i)().services,u=Object(o.useDispatch)(),{graphEventId:c,savedObjectId:d,status:m,title:g,timelineType:v}=Object(p.a)((n=>{var a;return Object(r.pick)(["graphEventId","savedObjectId","status","title","timelineType"],null!==(a=t(n,e))&&void 0!==a?a:q.b)})),[y,h]=Object(i.useState)(!1),[E,x]=Object(i.useState)(!1),S=Object(i.useCallback)((async t=>{x(!1),await l(F.l,{deepLinkId:B.a.case,path:null!=t?Object(z.a)({id:t.id}):Object(z.b)()}),u(Object(N.setInsertTimeline)({graphEventId:c,timelineId:e,timelineSavedObjectId:d,timelineTitle:g}))}),[u,c,l,d,e,g]),k=n.helpers.canUseCases([F.i]),w=Object(i.useCallback)((()=>{h((e=>!e))}),[]),T=Object(i.useCallback)((()=>h(!1)),[]),C=Object(i.useCallback)((()=>{T(),l(F.l,{deepLinkId:B.a.case,path:Object(z.b)()}).then((()=>{u(Object(N.setInsertTimeline)({graphEventId:c,timelineId:e,timelineSavedObjectId:d,timelineTitle:g.length>0?g:O.l})),u(Object(N.showTimeline)({id:L.c.active,show:!1}))}))}),[u,c,l,T,d,e,g]),M=Object(i.useCallback)((()=>{T(),x(!0)}),[x,T]),I=Object(i.useCallback)((()=>{x(!1)}),[x]),A=Object(i.useCallback)((()=>{h(!1)}),[]),P=Object(i.useMemo)((()=>s.a.createElement(a.EuiButtonEmpty,{size:"m","data-test-subj":"attach-timeline-case-button",iconType:"arrowDown",iconSide:"right",onClick:w,disabled:m===j.k.draft||v!==j.l.default},O.c)),[w,m,v]),_=Object(i.useMemo)((()=>[s.a.createElement(a.EuiContextMenuItem,{key:"new-case","data-test-subj":"attach-timeline-new-case",onClick:C},O.e),s.a.createElement(a.EuiContextMenuItem,{key:"existing-case","data-test-subj":"attach-timeline-existing-case",onClick:M},O.d)]),[M,C]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiPopover,{id:"singlePanel",button:P,isOpen:y,closePopover:A,panelPaddingSize:"none",anchorPosition:"downLeft"},s.a.createElement(a.EuiContextMenuPanel,{items:_})),E&&n.ui.getAllCasesSelectorModal({onRowClick:S,onClose:I,owner:[F.i],permissions:k}))};V.displayName="AddToCaseButtonComponent";const $=s.a.memo(V);var U=n(327),Q=n(466);const H=x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimelineBtn",{defaultMessage:"New"}),G=x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimeline",{defaultMessage:"New Timeline"}),W=x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.openTimelineBtn",{defaultMessage:"Open"}),K=x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.openTimelineBtnLabel",{defaultMessage:"Open Existing Timeline"}),J=(x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.saveTimelineBtn",{defaultMessage:"Save"}),x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.saveTimelineBtnLabel",{defaultMessage:"Save currently opened Timeline"}),x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimelineTemplate",{defaultMessage:"New Timeline template"})),Y=x.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),X=(x.i18n.translate("xpack.securitySolution.timeline.callOut.immutable.message.description",{defaultMessage:"This prebuilt timeline template cannot be modified. To make changes, please duplicate this template and make modifications to the duplicate template."}),x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"})),Z=x.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),ee=x.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),te=x.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),ne=x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),ae=x.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),ie=x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),se=x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),re=x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),oe=x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"}),le=(x.i18n.translate("xpack.securitySolution.timeline.flyout.saveTour.closeButton",{defaultMessage:"Close"}),x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.title",{defaultMessage:"Title"})),ue=(x.i18n.translate("xpack.securitySolution.timeline.flyout.saveTour.title",{defaultMessage:"Timeline changes now require manual saves"}),x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.saveAsNew",{defaultMessage:"Save as new timeline"})),ce={padding:0},de=s.a.memo((({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),r=Object(i.useCallback)((()=>{n(!1)}),[]),o=Object(i.useCallback)((()=>n((e=>!e))),[]),l=Object(i.useMemo)((()=>s.a.createElement(a.EuiButtonEmpty,{iconType:"arrowDown",size:"s",iconSide:"right",onClick:o},H)),[o]);return s.a.createElement(a.EuiPopover,{button:l,isOpen:t,closePopover:r,panelStyle:ce},s.a.createElement(a.EuiFlexGroup,{gutterSize:"xs",direction:"column",alignItems:"flexStart"},s.a.createElement(a.EuiFlexItem,null,s.a.createElement(U.c,{timelineId:e,title:G,onClick:r})),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(Q.a,{timelineId:e,title:J,onClick:r}))))}));de.displayName="NewTimelineAction";var me=n(135),pe=n(235),fe=n.n(pe),be=n(146),ge=n(184),ve=n(224),ye=n(228);const he={title:{type:be.a.TEXT,validations:[{validator:be.h.emptyField("")}]},description:{type:be.a.TEXTAREA,validations:[]}},je=Object(be.j)({component:be.b}),Ee=s.a.memo((({closeSaveTimeline:e,initialFocusOn:t,timelineId:n,showWarning:l})=>{const{startTransaction:u}=Object(ge.b)(),c=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{isSaving:d,description:m="",status:b,title:g="",timelineType:v}=Object(p.a)((e=>Object(r.pick)(["isSaving","description","status","title","timelineType"],c(e,n)))),y=b===j.k.draft,h=fe()(d),E=Object(o.useDispatch)(),S=Object(ye.a)({timelineId:L.c.active,timelineType:j.l.default}),[k,w]=Object(i.useState)(!1),T=Object(i.useCallback)((e=>w(e.target.checked)),[]),C=Object(i.useCallback)(((e,t)=>(t&&(E(f.a.updateTitleAndDescription({id:n,...e})),E(f.a.saveTimeline({id:n,saveAsNew:k}))),Promise.resolve())),[E,n,k]),M=Object(i.useMemo)((()=>({title:g,description:m})),[g,m]),{form:I}=Object(be.k)({id:"timelineTitleAndDescriptionForm",schema:he,onSubmit:C,options:{stripEmptyFields:!1},defaultValue:M}),{isSubmitted:A,isSubmitting:P,submit:_}=I,D=Object(i.useCallback)((()=>{u({name:ve.f.SAVE}),_()}),[_,u]),R=Object(i.useCallback)((()=>{l&&S(),e()}),[e,S,l]),F=Object(i.useMemo)((()=>b===j.k.draft&&l?v===j.l.template?ae:ne:ie),[l,b,v]),N=Object(i.useMemo)((()=>b===j.k.draft?v===j.l.template?Z:X:v===j.l.template?te:X),[b,v]),z=Object(i.useMemo)((()=>b===j.k.draft&&l?v===j.l.template?Z:X:ee),[l,b,v]),B=Object(i.useMemo)((()=>(e=>x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:e===j.l.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}))(v)),[v]),q=Object(i.useMemo)((()=>`${re} (${oe})`),[]),V=Object(i.useMemo)((()=>({"aria-label":se,autoFocus:"title"===t,"data-test-subj":"save-timeline-title",disabled:d,spellCheck:!0,placeholder:v===j.l.template?O.k:O.l})),[t,d,v]),$=Object(i.useMemo)((()=>({"aria-label":re,"data-test-subj":"save-timeline-description",disabled:d,placeholder:O.f})),[d]);return Object(i.useEffect)((()=>{A&&!d&&h&&e()}),[A,d,h,e]),s.a.createElement(a.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:e},d&&s.a.createElement(a.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),s.a.createElement(a.EuiModalHeader,{"data-test-subj":"modal-header"},N),s.a.createElement(a.EuiModalBody,null,l&&s.a.createElement(a.EuiFlexItem,{grow:!0},s.a.createElement(a.EuiCallOut,{title:B,color:"danger",iconType:"warning","data-test-subj":"edit-timeline-callout"}),s.a.createElement(a.EuiSpacer,{size:"m"})),s.a.createElement(be.c,{form:I},s.a.createElement(a.EuiFlexItem,{grow:!0},s.a.createElement(je,{path:"title",fullWidth:!0,label:le,euiFieldProps:V}),s.a.createElement(a.EuiSpacer,null)),s.a.createElement(a.EuiFlexItem,{grow:!0},s.a.createElement(je,{label:q,path:"description",fullWidth:!0,euiFieldProps:$}),s.a.createElement(a.EuiSpacer,null)),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiFlexGroup,{direction:"row",alignItems:"center"},y?null:s.a.createElement(a.EuiSwitch,{label:ue,checked:k,onChange:T,"data-test-subj":"save-as-new-switch"}),s.a.createElement(a.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},s.a.createElement(a.EuiFlexItem,{grow:!1,component:"span"},s.a.createElement(a.EuiButton,{size:"s",fill:!1,onClick:R,isDisabled:d,"data-test-subj":"close-button"},F)),s.a.createElement(a.EuiFlexItem,{grow:!1,component:"span"},s.a.createElement(a.EuiButton,{autoFocus:"save"===t,size:"s",isDisabled:d||P,fill:!0,onClick:D,"data-test-subj":"save-button"},z))))))))}));Ee.displayName="SaveTimelineModal";var Oe=n(57),xe=n(292);const Se=s.a.memo((({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),r=Object(i.useCallback)((()=>{n(!1)}),[]),o=Object(i.useCallback)((()=>{n(!0)}),[]),{kibanaSecuritySolutionsPrivileges:{crud:l}}=Object(me.a)(),u=Object(i.useMemo)((()=>Object(Oe.createSelector)(f.b.selectTimeline,(e=>{var t,n,a,i,s,r;return{status:null!==(t=null==e?void 0:e.status)&&void 0!==t?t:j.k.draft,updated:null!==(n=null==e?void 0:e.updated)&&void 0!==n?n:void 0,isSaving:null!==(a=null==e?void 0:e.isSaving)&&void 0!==a?a:void 0,isLoading:null!==(i=null==e?void 0:e.isLoading)&&void 0!==i?i:void 0,changed:null!==(s=null==e?void 0:e.changed)&&void 0!==s?s:void 0,show:null!==(r=null==e?void 0:e.show)&&void 0!==r?r:void 0}}))),[]),{status:c,isSaving:d}=Object(p.a)((t=>u(t,e))),m=l&&c!==j.k.immutable,b=c===j.k.draft,g=m?null:Y;return s.a.createElement(a.EuiToolTip,{content:g,position:"bottom","data-test-subj":"save-timeline-btn-tooltip"},s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiButton,{id:xe.a.SAVE_TIMELINE,fill:!0,color:"primary",onClick:o,size:"s",iconType:"save",isLoading:d,disabled:!m,"data-test-subj":"save-timeline-action-btn"},ee),t&&m?s.a.createElement(Ee,{closeSaveTimeline:r,initialFocusOn:b?"title":"save",timelineId:e,showWarning:!1}):null))}));Se.displayName="SaveTimelineButton";var ke=n(467);const we=["createFrom"],Te=s.a.memo((()=>{const[e,t]=Object(i.useState)(!1),n=Object(i.useCallback)((()=>t(!1)),[]),r=Object(i.useCallback)((()=>{t(!0)}),[]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiButtonEmpty,{"data-test-subj":"open-timeline-button",onClick:r,"aria-label":K},W),e?s.a.createElement(ke.a,{onClose:n,hideActions:we}):null)}));Te.displayName="OpenTimelineAction";const Ce=u.a.span.withConfig({displayName:"VerticalDivider",componentId:"sc-1qnxttj-0"})(["width:0px;height:20px;border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),Me=({mode:e="normal",timelineId:t,activeTab:n,isInspectButtonDisabled:i})=>{const{cases:r}=Object(P.b)().services,o=r.helpers.canUseCases([_.APP_ID]);return s.a.createElement(a.EuiFlexGroup,{id:xe.a.ACTION_MENU,gutterSize:"xs",justifyContent:"flexEnd",alignItems:"center",responsive:!1,"data-test-subj":"timeline-action-menu"},s.a.createElement(a.EuiFlexItem,{"data-test-subj":"new-timeline-action"},s.a.createElement(de,{timelineId:t})),s.a.createElement(a.EuiFlexItem,{"data-test-subj":"open-timeline-action"},s.a.createElement(Te,null)),s.a.createElement(a.EuiFlexItem,{"data-test-subj":"inspect-timeline-action"},s.a.createElement(D.b,{compact:"compact"===e,queryId:`${t}-${n}`,inputId:R.a.timeline,isDisabled:i,title:""})),o.create&&o.read?s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiFlexItem,null,s.a.createElement(Ce,null)),s.a.createElement(a.EuiFlexItem,null,s.a.createElement($,{timelineId:t}))):null,s.a.createElement(a.EuiFlexItem,{"data-test-subj":"save-timeline-action"},s.a.createElement(Se,{timelineId:t})))},Ie=s.a.memo(Me),Ae=u()(a.EuiText).withConfig({displayName:"NoWrapText",componentId:"sc-33d5ea-0"})(["white-space:nowrap;"]),Pe=s.a.memo((({status:e,updated:t,changed:n})=>{let i=null;return e!==j.k.draft&&t?n&&(i=s.a.createElement(a.EuiBadge,{color:"warning"},w)):i=s.a.createElement(a.EuiBadge,{color:"warning"},k),i?s.a.createElement(Ae,{size:"xs","data-test-subj":"timeline-status"},i):null}));Pe.displayName="TimelineStatusInfo";var _e=n(756);const De=u()(a.EuiFlexGroup).withConfig({displayName:"FlyoutHeaderPanelContentFlexGroupContainer",componentId:"sc-a6ccyo-0"})(["overflow-x:auto;"]),Re=u()(a.EuiFlexItem).withConfig({displayName:"ActiveTimelinesContainer",componentId:"sc-a6ccyo-1"})(["overflow:hidden;"]),Fe=Object(d.euiStyled)(a.EuiPanel)`
  backgroundColor: ${e=>e.theme.eui.euiColorEmptyShade};
  color: ${e=>e.theme.eui.euiTextColor};
  padding-inline: ${e=>e.theme.eui.euiSizeM};
  border-radius: ${({$isOpen:e,theme:t})=>e?t.eui.euiBorderRadius:"0px"};
`,Ne=({timelineId:e})=>{const t=Object(o.useDispatch)(),{browserFields:n,indexPattern:l}=Object(g.d)(h.SourcererScopeName.timeline),{uiSettings:u}=Object(b.i)().services,d=Object(i.useMemo)((()=>Object(c.getEsQueryConfig)(u)),[u]),j=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{activeTab:E,dataProviders:O,kqlQuery:x,title:k,timelineType:w,status:T,updated:C,show:M,filters:I,kqlMode:P,changed:_=!1}=Object(p.a)((t=>{var n;return Object(r.pick)(["activeTab","dataProviders","kqlQuery","status","title","timelineType","updated","show","filters","kqlMode","changed"],null!==(n=j(t,e))&&void 0!==n?n:q.b)})),D=Object(i.useMemo)((()=>!Object(r.isEmpty)(O)||!Object(r.isEmpty)(Object(r.get)("filterQuery.kuery.expression",x))),[O,x]),R=Object(i.useMemo)((()=>f.b.getKqlFilterQuerySelector()),[]),F=Object(o.useSelector)((t=>R(t,e))),N=Object(r.isEmpty)(O)&&Object(r.isEmpty)(F)&&"template"===w?" ":null!=F?F:"",L=Object(i.useMemo)((()=>({query:N,language:"kuery"})),[N]),z=Object(i.useMemo)((()=>Object(y.d)({config:d,dataProviders:O,indexPattern:l,browserFields:n,filters:I||[],kqlQuery:L,kqlMode:P})),[n,O,d,I,l,P,L]),B=Object(i.useCallback)((()=>{Object(m.a)(),t(f.a.showTimeline({id:e,show:!1})),Object(v.i)()}),[t,e]);return s.a.createElement(Fe,{$isOpen:M,grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-flyout-header-panel","data-show":M},s.a.createElement(De,{className:"eui-scrollBar",alignItems:"center",gutterSize:"s",responsive:!1,justifyContent:"spaceBetween"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},M?null:s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(_e.b,{timelineId:e})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(U.a,{timelineId:e,compact:!0})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(Re,{grow:!1},s.a.createElement(A,{timelineId:e,timelineType:w,timelineTitle:k,isOpen:M}))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(Pe,{status:T,updated:C,changed:_})))),M&&s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center",gutterSize:"s",responsive:!1},s.a.createElement(Ie,{timelineId:e,activeTab:E,isInspectButtonDisabled:!D||void 0===(null==z?void 0:z.filterQuery)}),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiToolTip,{content:S("default"===w)},s.a.createElement(a.EuiButtonIcon,{"aria-label":S("default"===w),"data-test-subj":"close-timeline",iconType:"cross",onClick:B})))))))},Le=s.a.memo(Ne)},function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a=n(2),i=n(67),s=n.n(i),r=n(23),o=n.n(r),l=n(11),u=n.n(l),c=n(74),d=n.n(c),m=n(17);let p;!function(e){e.preboot="preboot",e.standard="standard"}(p||(p={}));const f="eui-global",b="eui-utilities",g={darkMode:!1};var v=n(13);const y=[m.euiStylisPrefixer],h=d()({key:"css",stylisPlugins:y,container:document.querySelector('meta[name="emotion"]')}),j=d()({key:f,stylisPlugins:y,container:document.querySelector(`meta[name="${f}"]`)}),E=d()({key:b,stylisPlugins:y,container:document.querySelector(`meta[name="${b}"]`)});h.compat=!0,j.compat=!0,E.compat=!0;const O={default:h,global:j,utility:E},x=({theme:{theme$:e},globalStyles:t,colorMode:n,children:i})=>{const s=u()(e,g),r=Object(a.useMemo)((()=>(e=>e.darkMode?m.COLOR_MODES_STANDARD.dark:m.COLOR_MODES_STANDARD.light)(s)),[s]),o=n||r,l=!1!==t&&void 0;return Object(v.jsx)(m.EuiProvider,{cache:O,colorMode:o,globalStyles:l,utilityClasses:l},i)},S=({children:e,i18n:t,...n})=>Object(v.jsx)(x,n,Object(v.jsx)(t.Context,null,e));var k=n(84);const w=({children:e,...t})=>Object(v.jsx)(S,o()({globalStyles:!1},t),Object(v.jsx)(k.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(v.jsx)(k.KibanaErrorBoundary,null,e))),T=(e,t)=>n=>(s.a.render(Object(v.jsx)(w,t,e),n),()=>s.a.unmountComponentAtNode(n));n(0),n(5);class mount_point_portal_MountPointPortalErrorBoundary extends a.Component{constructor(...e){super(...e),definePropertyfrom_dll_reference_kbnSharedDeps_npm_default()(this,"state",{error:void 0})}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(){}render(){return this.state.error?Object(v.jsx)("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("reactPackages.mountPointPortal.errorMessage",{defaultMessage:"Error rendering portal content"})):this.props.children}}},,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return x})),n.d(t,"c",(function(){return M}));var a=n(2),i=n.n(a),s=n(17),r=n(113),o=n(708),l=n(164);const u="timeline";var c=n(5);const d=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.insertTimelineButtonLabel",{defaultMessage:"Insert timeline link"}),m=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineNameFoundErrorMsg",{defaultMessage:"No timeline name found"}),p=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineIdFoundErrorMsg",{defaultMessage:"No timeline id found"}),f=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),b=e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.failedRetrieveTimelineErrorMsg",{defaultMessage:"Failed to retrieve timeline id: { timelineId }",values:{timelineId:e}}),g=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.timelineErrorTitle",{defaultMessage:"Timeline Error"});var v=n(129);const y=({onClosePopover:e,onInsert:t})=>{const{formatUrl:n}=Object(l.l)(v.a.timelines),u=Object(a.useCallback)((({timelines:e})=>[...e.map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:void 0})))]),[]),c=Object(a.useCallback)(((e,a,i)=>{const s=n(Object(l.k)(null!=a?a:"",i),{absolute:!0,skipSearch:!0});t(`[${e}](${s})`,{block:!1})}),[n,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiModalHeader,null),i.a.createElement(s.EuiModalBody,null,i.a.createElement(o.a,{hideUntitled:!0,getSelectableOptions:u,onTimelineChange:c,onClosePopover:e,timelineType:r.l.default})))},h=Object(a.memo)(y),j={name:u,button:{label:d,iconType:"timeline"},helpText:i.a.createElement(s.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"[title](url)"),editor:function({node:e,onSave:t,onCancel:n}){return i.a.createElement(h,{onClosePopover:n,onInsert:t})}};var E=n(60),O=n(310);const x=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){let a=0;if("["!==t[a])return!1;if(n)return!0;function i(e,n){if(t[a]!==e)throw new Error(f);a++;let i="",s=0;for(;a<t.length;a++){const r=t[a];if(r===n&&0===s)return a++,i;r===n?s--:r===e&&s++,i+=r}return""}const s=i("[","]"),r=i("(",")"),o=e.now();if(!s)return this.file.info(m,{line:o.line,column:o.column}),!1;try{var l;const t=r.split("?"),n=Object(O.parse)(t[1]),a=Object(E.safeDecode)(null!==(l=n.timeline)&&void 0!==l?l:""),{id:i="",graphEventId:c=""}=null!=a?a:{id:null,graphEventId:""};return i?e(`[${s}](${r})`)({type:u,id:i,title:s,graphEventId:c}):(this.file.info(p,{line:o.line,column:o.column+r.indexOf("id")}),!1)}catch{this.file.info((e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineUrlIsNotValidErrorMsg",{defaultMessage:"Timeline URL is not valid => {timelineUrl}",values:{timelineUrl:e}}))(r),{line:o.line,column:o.column})}return!1},i=function(e,t,n){return!(!1===t.startsWith("[")||!0===t.startsWith("[")&&!t.includes("timelines?timeline=(id"))&&a.call(this,e,t,n)};i.locator=(e,t)=>e.indexOf("[",t),t.timeline=i,n.splice(n.indexOf("url"),0,u)};var S=n(48),k=n(162),w=n(14),T=n(117);const C=({id:e,title:t,graphEventId:n})=>{const{addError:r}=Object(T.a)(),o=(()=>{const e=Object(S.useDispatch)();return Object(a.useCallback)(((t,n,a)=>{Object(k.h)({graphEventId:a,timelineId:t,onError:n,updateIsLoading:({id:t,isLoading:n})=>e(Object(w.updateIsLoading)({id:t,isLoading:n})),updateTimeline:Object(k.b)(e)})}),[e])})(),l=Object(a.useCallback)(((e,t)=>{r(e,{title:g,toastMessage:b(t)})}),[r]),u=Object(a.useCallback)((()=>o(null!=e?e:"",l,n)),[e,n,o,l]);return i.a.createElement(s.EuiToolTip,{content:(d=null!=e?e:"",c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineId",{defaultMessage:"Timeline id: { timelineId }",values:{timelineId:d}}))},i.a.createElement(s.EuiLink,{onClick:u,"data-test-subj":`markdown-timeline-link-${e}`},t));var d},M=Object(a.memo)(C)},function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var a=n(45),i=n(17),s=n(2),r=n.n(s),o=n(44),l=n.n(o),u=n(153),c=n(113),d=n(241),m=n(5);const p=m.i18n.translate("xpack.securitySolution.editDataProvider.doesNotExistLabel",{defaultMessage:"does not exist"}),f=m.i18n.translate("xpack.securitySolution.editDataProvider.existsLabel",{defaultMessage:"exists"}),b=m.i18n.translate("xpack.securitySolution.editDataProvider.fieldLabel",{defaultMessage:"Field"}),g=m.i18n.translate("xpack.securitySolution.editDataProvider.placeholder",{defaultMessage:"Select a field"}),v=m.i18n.translate("xpack.securitySolution.editDataProvider.isLabel",{defaultMessage:"is"}),y=m.i18n.translate("xpack.securitySolution.editDataProvider.isOneOfLabel",{defaultMessage:"is one of"}),h=m.i18n.translate("xpack.securitySolution.editDataProvider.isNotLabel",{defaultMessage:"is not"}),j=m.i18n.translate("xpack.securitySolution.editDataProvider.isNotOneOfLabel",{defaultMessage:"is not one of"}),E=m.i18n.translate("xpack.securitySolution.editDataProvider.includesPlaceholder",{defaultMessage:"enter one or more values"}),O=m.i18n.translate("xpack.securitySolution.editDataProvider.operatorLabel",{defaultMessage:"Operator"}),x=m.i18n.translate("xpack.securitySolution.editDataProvider.saveButton",{defaultMessage:"Save"}),S=m.i18n.translate("xpack.securitySolution.editDataProvider.valuePlaceholder",{defaultMessage:"value"}),k=m.i18n.translate("xpack.securitySolution.editDataProvider.valueLabel",{defaultMessage:"Value"}),w=m.i18n.translate("xpack.securitySolution.editDataProvider.selectAnOperatorPlaceholder",{defaultMessage:"Select an operator"}),T=e=>m.i18n.translate("xpack.securitySolution.editDataProvider.unavailableOperator",{values:{operator:e},defaultMessage:"{operator} operator is unavailable with templates"}),C=[{label:v},{label:h},{label:y},{label:j},{label:f},{label:p}],M=[],I=e=>e?Object.keys(e).sort().map((t=>{return{label:t,options:(n=e[t],null!=n.fields&&Object.keys(n.fields).length>0?Object.keys(n.fields):M).map((e=>({label:e})))};var n})):M,A=({browserFields:e,selectedField:t,selectedOperator:n,type:i})=>{const s=t.length>0?t[0].label:"",r=n.length>0?n[0].label:"",o=e&&null!=Object(d.a)(e)[s],l=-1!==Object(a.findIndex)((e=>e.label===r),C),u=i===c.a.template&&(r===y||r===j);return o&&l&&!u},P=e=>{switch(e.length>0?e[0].label:""){case v:case h:return u.d;case y:case j:return u.c;case f:case p:return u.b;default:return u.d}},_=e=>{switch(e.length>0?e[0].label:""){case h:case j:case p:return!0;default:return!1}},D=e=>Array.isArray(e)?e.length?`${e[0]}`:"":`${e}`;var R=n(145);const F=({value:e,onChangeCallback:t})=>{const[n,a]=Object(s.useState)(N(e));Object(s.useEffect)((()=>{t(L(n))}),[n,t]);const o=Object(s.useCallback)(((e,t=n)=>{const i=e.trim().toLowerCase();i&&-1===t.findIndex((e=>e.label.trim().toLowerCase()===i))&&a([...n,{label:e}])}),[n]),l=Object(s.useCallback)((e=>{a(e)}),[]);return r.a.createElement(i.EuiComboBox,{noSuggestions:!0,isClearable:!0,"data-test-subj":"is-one-of-combobox-input",selectedOptions:n,placeholder:E,onCreateOption:o,onChange:l})},N=e=>Object(R.k)(e)?e.map((e=>({label:String(e)}))):[],L=e=>e.map((e=>e.label)),z=({value:e,onChangeCallback:t})=>{const[n,a]=Object(s.useState)(B(e));Object(s.useEffect)((()=>{t(D(n))}),[n,t]);const o=Object(s.useCallback)((e=>{a(e.target.value)}),[]);return r.a.createElement(i.EuiFieldText,{className:"edit-data-provider-value",onChange:o,placeholder:S,value:D(n)})},B=e=>{var t;return Object(R.k)(e)?null!==(t=e[0])&&void 0!==t?t:"":e},q="edit-data-provider-save";l.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-1dznxok-0"})(["width:",";"],400).displayName="HeaderContainer";const V=r.a.memo((({andProviderId:e,browserFields:t,field:n,isExcluded:o,onDataProviderEdited:l,operator:c,providerId:d,timelineId:m,value:E,type:S=u.a.default})=>{const[M,D]=Object(s.useState)([{label:n}]),[R,N]=Object(s.useState)(((e,t)=>":"===t?e?[{label:h}]:[{label:v}]:"includes"===t?e?[{label:j}]:[{label:y}]:e?[{label:p}]:[{label:f}])(o,c)),[L,B]=Object(s.useState)(E),V=Object(s.useMemo)((()=>R.length>0&&(R[0].label===y||R[0].label===j)),[R]),$=Object(s.useMemo)((()=>S!==u.a.template&&R.length>0&&R[0].label!==f&&R[0].label!==p&&!V),[V,S,R]),U=Object(s.useMemo)((()=>V&&Array.isArray(L)&&!L.length),[V,L]),Q=()=>{const e=document.getElementsByClassName("edit-data-provider-value");if(e.length>0)e[0].focus();else{const e=document.getElementsByClassName(q);e.length>0&&e[0].focus()}},H=Object(s.useCallback)((e=>{D(e),S===u.a.template&&B(`{${e[0].label}}`),Q()}),[S]),G=Object(s.useCallback)((e=>{N(e),Q()}),[]),W=Object(s.useCallback)((e=>{B(e)}),[]),K=Object(s.useCallback)((()=>{l({andProviderId:e,excluded:_(R),field:M.length>0?M[0].label:"",id:m,operator:P(R),providerId:d,value:L,type:S})}),[l,e,R,M,m,d,L,S]);return Object(s.useEffect)((()=>((()=>{const e=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;window.onscroll=()=>window.scrollTo(e,t)})(),()=>{window.onscroll=()=>a.noop})),[]),r.a.createElement(i.EuiPanel,{paddingSize:"s"},r.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiFormRow,{label:b},r.a.createElement(i.EuiComboBox,{autoFocus:!0,"data-test-subj":"field",isClearable:!1,onChange:H,options:I(t),placeholder:g,selectedOptions:M,singleSelection:{asPlainText:!0},fullWidth:!0}))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiSpacer,{size:"m"})),r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"row",justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiFormRow,{label:O},r.a.createElement(i.EuiComboBox,{"data-test-subj":"operator",isClearable:!1,onChange:G,options:C,placeholder:w,selectedOptions:R,singleSelection:{asPlainText:!0},style:{minWidth:152}}))))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiSpacer,{size:"m"})),r.a.createElement(i.EuiFlexItem,{grow:!1},$&&r.a.createElement(i.EuiFormRow,{label:k},r.a.createElement(z,{onChangeCallback:W,value:E})),V&&S!==u.a.template&&r.a.createElement(i.EuiFormRow,{label:k},r.a.createElement(F,{onChangeCallback:W,value:E}))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiSpacer,{size:"m"})),r.a.createElement(i.EuiFlexItem,{grow:!1},S===u.a.template&&V&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiCallOut,{color:"warning",iconType:"warning",size:"s",title:T(R[0].label)}),r.a.createElement(i.EuiSpacer,{size:"m"})),r.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{className:q,color:"primary","data-test-subj":"save",fill:!0,isDisabled:!A({type:S,browserFields:t,selectedField:M,selectedOperator:R})||U,onClick:K,size:"m"},x))))))}));V.displayName="StatefulEditDataProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var a=n(2),i=n.n(a),s=n(90);const r={capabilities:Object(s.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var o=n(117),l=n(110),u=n(152);const c=Object(u.d)((async({http:e,signal:t})=>e.fetch("/internal/ml/ml_capabilities",{method:"GET",version:"1",asSystemRequest:!0,signal:t}))),d=n(5).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),m={...r,capabilitiesFetched:!1},p=i.a.createContext(m);p.displayName="MlCapabilitiesContext";const f=i.a.memo((({children:e})=>{const[t,n]=Object(a.useState)(m),s=Object(l.h)(),{addError:r}=Object(o.a)(),{start:f,result:b,error:g}=Object(u.a)(c);return Object(a.useEffect)((()=>{f({http:s})}),[s,f]),Object(a.useEffect)((()=>{b&&n({...b,capabilitiesFetched:!0})}),[b]),Object(a.useEffect)((()=>{g&&r(g,{title:d})}),[r,g]),i.a.createElement(p.Provider,{value:t},e)}));f.displayName="MlCapabilitiesProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(2),i=n.n(a),s=n(17),r=n(117),o=n(5);const l=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.cancelTitle",{defaultMessage:"Cancel"}),u=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteExceptionLabel",{defaultMessage:'Overwrite existing exception lists with conflicting "list_id"'}),c=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteActionConnectorsLabel",{defaultMessage:'Overwrite existing connectors with conflicting action "id"'}),d=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importExceptionsFailedLabel",{values:{totalExceptions:e},defaultMessage:"Failed to import {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}"}),m=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importConnectorsFailedLabel",{values:{totalConnectors:e},defaultMessage:"Failed to import {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}"}),p=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningButton",{defaultMessage:"Go to connectors"}),f=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsAdditionalPrivilegesError",{defaultMessage:"You need additional privileges to import rules with actions."}),b=(e,t,n)=>{const a=n.map((t=>e(t.error.message))),i=new Error(a.join(". "));return i.stack=void 0,i.name="Network errors",i.raw_network_error=t,i};var g=n(212);const v=({actionConnectorsWarnings:e,importedActionConnectorsCount:t})=>{const{http:n}=Object(g.b)().services;if(!t||!e.length)return null;const{actionPath:a,message:r,buttonLabel:l}=e[0];return i.a.createElement(s.EuiCallOut,{"data-test-subj":"actionConnectorsWarningsCallOut",size:"m",heading:"h2",iconType:"warning",title:i.a.createElement("span",{"data-test-subj":"actionConnectorsWarningsCallOutTitle"},(u=t,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningTitle",{values:{totalConnectors:u},defaultMessage:"{totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}} imported"}))),color:"warning"},i.a.createElement(s.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(s.EuiFlexItem,{"data-test-subj":"actionConnectorsWarningsCallOutMessage"},i.a.createElement(s.EuiText,{size:"xs"},r)),i.a.createElement(s.EuiFlexItem,null,i.a.createElement(s.EuiFlexGroup,{gutterSize:"none",direction:"columnReverse",alignItems:"flexEnd"},i.a.createElement(s.EuiButton,{"data-test-subj":"actionConnectorsWarningsCallOutButton",color:"warning",href:n.basePath.prepend(a)},l||p)))));var u};v.displayName="ActionConnectorWarningsComponent";const y=i.a.memo(v);y.displayName="ActionConnectorWarnings";const h=({checkBoxLabel:e,closeModal:t,description:n,errorMessage:p,failedDetailed:g,importComplete:v,importData:h,showCheckBox:j=!0,showExceptionsCheckBox:E=!1,showActionConnectorsCheckBox:O=!1,showModal:x,submitBtnText:S,subtitle:k,successMessage:w,title:T})=>{const[C,M]=Object(a.useState)(null),[I,A]=Object(a.useState)(!1),[P,_]=Object(a.useState)(!1),[D,R]=Object(a.useState)(!1),[F,N]=Object(a.useState)(!1),{addError:L,addSuccess:z}=Object(r.a)(),[B,q]=Object(a.useState)([]),[V,$]=Object(a.useState)(0),U=Object(a.useCallback)((()=>{t(),_(!1),R(!1),N(!1),q([])}),[t,_,R]),Q=Object(a.useCallback)((e=>{A(!1),M(null),v(),e&&(v(),U())}),[U,v]),H=Object(a.useCallback)((async()=>{if(null!=C){A(!0);const e=new AbortController;try{const{action_connectors_warnings:t,...n}=await h({fileToImport:C[0],overwrite:P,overwriteExceptions:D,overwriteActionConnectors:F,signal:e.signal}),a=n.action_connectors_success_count;q(t),$(a),(({importResponse:e,exceptionsIncluded:t,actionConnectorsIncluded:n,successMessage:a,errorMessage:i,errorMessageDetailed:s,addError:r,addSuccess:l})=>{if(e.success)return e.success_count>0&&l(a(e.success_count)),t&&e.exceptions_success&&null!=e.exceptions_success_count&&e.exceptions_success_count>0&&l((c=e.exceptions_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.exceptionsSuccessLabel",{values:{totalExceptions:c},defaultMessage:"Successfully imported {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}."}))),void(n&&e.action_connectors_success&&null!=e.action_connectors_success_count&&e.action_connectors_success_count>0&&l((u=e.action_connectors_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.connectorsSuccessLabel",{values:{totalConnectors:u},defaultMessage:"Successfully imported {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}."}))));var u,c;if(e.errors.length>0){if(n&&null!=e.action_connectors_errors&&e.action_connectors_errors.length>0){const{mappedErrors:t,numberOfActions:n}=(e=>{let t="";return{mappedErrors:e.map((e=>{const{id:n,error:a}=e;t=t&&t!==n?`${t},${n}`:n;const{status_code:i,message:s}=a||{};let r;return r=403===i?f:s,{...e,error:{...a,message:r}}})),numberOfActions:new Set(t&&[...t.split(",")]).size}})(e.action_connectors_errors);return r(b(s,e,t),{title:m(n||t.length)})}r(b(s,e,e.errors),{title:i(e.errors.length)}),t&&null!=e.exceptions_errors&&e.exceptions_errors.length>0&&r(b(s,e,e.exceptions_errors),{title:d(e.exceptions_errors.length)})}})({importResponse:n,exceptionsIncluded:E,actionConnectorsIncluded:O,successMessage:w,errorMessage:p,errorMessageDetailed:g,addError:L,addSuccess:z}),Q(!(null!=t&&t.length))}catch(e){U(),L(e,{title:p(1)})}}}),[C,h,P,D,F,E,w,p,g,L,z,O,Q,U]),G=Object(a.useCallback)((()=>{U()}),[U]),W=Object(a.useCallback)((()=>{_((e=>!e))}),[]),K=Object(a.useCallback)((()=>{R((e=>!e))}),[]),J=Object(a.useCallback)((()=>{N((e=>!e))}),[]);return i.a.createElement(i.a.Fragment,null,x&&i.a.createElement(s.EuiModal,{onClose:G,maxWidth:"750px"},i.a.createElement(s.EuiModalHeader,null,i.a.createElement(s.EuiModalHeaderTitle,null,T)),i.a.createElement(s.EuiModalBody,null,i.a.createElement(s.EuiText,{size:"s"},i.a.createElement("h4",null,n)),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(s.EuiFilePicker,{"data-test-subj":"rule-file-picker",accept:".ndjson",id:"rule-file-picker",initialPromptText:k,onChange:e=>{M(e&&e.length>0?e:null)},display:"large",fullWidth:!0,isLoading:I}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(y,{actionConnectorsWarnings:B,importedActionConnectorsCount:V}),i.a.createElement(s.EuiSpacer,{size:"s"}),j&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiCheckbox,{"data-test-subj":"importDataModalCheckboxLabel",id:"importDataModalCheckboxLabel",label:e,checked:P,onChange:W}),E&&i.a.createElement(s.EuiCheckbox,{"data-test-subj":"importDataModalExceptionsCheckboxLabel",id:"importDataModalExceptionsCheckboxLabel",label:u,checked:D,onChange:K}),O&&i.a.createElement(s.EuiCheckbox,{"data-test-subj":"importDataModalActionConnectorsCheckbox",id:"importDataModalActionConnectorsCheckbox",label:c,checked:F,onChange:J}))),i.a.createElement(s.EuiModalFooter,null,i.a.createElement(s.EuiButtonEmpty,{onClick:G},l),i.a.createElement(s.EuiButton,{"data-test-subj":"import-data-modal-button",onClick:H,disabled:null==C||I,fill:!0},S))))};h.displayName="ImportDataModalComponent";const j=i.a.memo(h);j.displayName="ImportDataModal"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),s=n(48),r=n(688),o=n(322),l=n(158),u=n(119),c=n(384),d=n(400);const m=({combinedQueries:e,filters:t,headerChildren:n,onlyField:m,paddingSize:p,query:f,showLegend:b,setAbsoluteRangeDatePickerTarget:g=u.a.global,runtimeMappings:v,hideQueryToggle:y=!1})=>{const h=Object(s.useDispatch)(),{signalIndexName:j}=Object(o.a)(),E=(O=t,Object(a.useMemo)((()=>[...O,...Object(d.e)(!1)]),[O]));var O;const x=Object(a.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;h(Object(l.setAbsoluteRangeDatePicker)({id:g,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[h,g]);return i.a.createElement(r.a,{combinedQueries:e,filters:E,headerChildren:n,legendPosition:"right",onlyField:m,paddingSize:p,query:f,showLegend:b,showLinkToAlerts:null==m,showStackBy:null==m,showTotalAlertsCount:!0,signalIndexName:j,runtimeMappings:v,title:c.b,titleSize:null==m?"m":"s",updateDateRange:x,hideQueryToggle:y})};m.displayName="SignalsByCategoryComponent";const p=i.a.memo(m)},function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n(45),i=n(2),s=n.n(i),r=n(48),o=n(113),l=n(112),u=n(118),c=n(17),d=n(59),m=n.n(d),p=n(44),f=n.n(p),b=n(126),g=n(515),v=n(153),y=n(401);const h=f()(c.EuiBadge).withConfig({displayName:"ProviderBadgeStyled",componentId:"sc-l32wgy-0"})([".euiToolTipAnchor{&::after{font-style:normal;content:'|';padding:0px 3px;}}&.globalFilterItem{white-space:nowrap;min-width:",";display:flex;&.globalFilterItem-isDisabled{text-decoration:line-through;font-weight:400;font-style:italic;}&.globalFilterItem-isError{box-shadow:0 1px 1px -1px rgba(152,162,179,0.2),0 3px 2px -2px rgba(152,162,179,0.2),inset 0 0 0 1px #bd271e;}}"],(({$timelineType:e})=>e===o.l.template?"140px":"none"));h.displayName="ProviderBadgeStyled";const j=f.a.div.withConfig({displayName:"ProviderFieldBadge",componentId:"sc-l32wgy-1"})(["display:block;color:#fff;padding:6px 8px;font-size:0.6em;"]),E=f()(j).withConfig({displayName:"StyledTemplateFieldBadge",componentId:"sc-l32wgy-2"})(["background:",";text-transform:uppercase;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),O=f()(j).withConfig({displayName:"ConvertFieldBadge",componentId:"sc-l32wgy-3"})(["background:",";cursor:pointer;&:hover{text-decoration:underline;}"],(({theme:e})=>e.eui.euiColorDarkShade)),x=({type:e,toggleType:t})=>e!==v.a.template?s.a.createElement(O,{onClick:t},y.d):s.a.createElement(E,null,y.w),S=s.a.memo(x),k={tabIndex:-1},w=s.a.memo((({deleteProvider:e,field:t,isEnabled:n,isExcluded:r,operator:l,providerId:u,togglePopover:c,toggleType:d,displayValue:p,val:f,type:j,timelineType:E})=>{const O=Object(i.useCallback)((t=>{t.stopPropagation&&t.stopPropagation(),e()}),[e]),x=Object(i.useMemo)((()=>m()("globalFilterItem",{"globalFilterItem-isDisabled":!n,"globalFilterItem-isExcluded":r})),[n,r]),w=Object(i.useMemo)((()=>Object(a.isString)(f)&&""===f?Object(b.b)():f),[f]),T=Object(i.useMemo)((()=>r?s.a.createElement("span",null,y.q," "):null),[r]),C=Object(i.useMemo)((()=>s.a.createElement(s.a.Fragment,null,T,l!==v.b?s.a.createElement("span",{className:"field-value"},`${t}: "${"includes"===l?p:w}"`):s.a.createElement("span",{className:"field-value"},t," ",y.j))),[p,t,w,l,T]),M=Object(i.useMemo)((()=>y.v({field:t,value:`${w}`})),[t,w]);return s.a.createElement(g.a,{id:`${u}-${t}-${f}`},s.a.createElement(s.a.Fragment,null,s.a.createElement(h,{className:x,color:"hollow",title:"",iconOnClick:O,iconOnClickAriaLabel:y.t,iconType:"cross",iconSide:"right",onClick:c,onClickAriaLabel:M,closeButtonProps:k,"data-test-subj":"providerBadge",$timelineType:E},C),E===o.l.template&&l!==v.c&&s.a.createElement(S,{toggleType:d,type:j})))}));w.displayName="ProviderBadge";var T=n(0),C=n.n(T),M=n(748);const I="edit-data-provider",A="exclude-data-provider",P="enable-data-provider",_="filter-for-field-present-data-provider",D="delete-data-provider",R=f()(c.EuiPopover).withConfig({displayName:"MyEuiPopover",componentId:"sc-2zwix7-0"})(["height:100%;user-select:none;"]);R.displayName="MyEuiPopover";class provider_item_actions_ProviderItemActions extends s.a.PureComponent{constructor(...e){super(...e),C()(this,"onDataProviderEdited",(({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:s,value:r,type:o})=>{null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:s,value:r,type:o}),this.props.closePopover()})),C()(this,"onFilterForFieldPresent",(()=>{const{andProviderId:e,field:t,timelineId:n,providerId:a,value:i,type:s}=this.props;null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:!1,field:t,id:`${n}`,operator:v.b,providerId:a,value:i,type:s}),this.props.closePopover()}))}render(){const{andProviderId:e,browserFields:t,button:n,closePopover:a,deleteProvider:i,field:r,isEnabled:l,isExcluded:u,isLoading:d,isOpen:m,operator:p,providerId:f,timelineId:b,timelineType:g,toggleEnabledProvider:h,toggleExcludedProvider:j,toggleTypeProvider:E,value:O,type:x}=this.props,S=(({andProviderId:e,browserFields:t,deleteItem:n,field:a,isEnabled:i,isExcluded:r,isLoading:l,operator:u,onDataProviderEdited:c,onFilterForFieldPresent:d,providerId:m,timelineId:p,timelineType:f,toggleEnabled:b,toggleExcluded:g,toggleType:h,type:j,value:E})=>[{id:0,items:[{className:I,disabled:l,icon:"pencil",name:y.g,panel:1},{className:A,disabled:l,icon:r?"plusInCircle":"minusInCircle",name:r?y.p:y.i,onClick:g},{className:P,disabled:l,icon:i?"eyeClosed":"eye",name:i?y.x:y.u,onClick:b},{className:_,disabled:l,icon:"logstashFilter",name:y.k,onClick:d},f===o.l.template?{className:"convert-to-field-data-provider",disabled:l||u===v.c,icon:"visText",name:j===v.a.template?y.c:y.d,onClick:h}:{name:null},{className:D,disabled:l,icon:"trash",name:y.e,onClick:n}].filter((e=>null!=e.name))},{content:null!=t&&null!=p&&null!=c?s.a.createElement(M.a,{andProviderId:e,browserFields:t,field:a,isExcluded:r,onDataProviderEdited:c,operator:u,providerId:m,timelineId:p,value:E,type:j}):null,id:1,title:y.h,width:400}])({andProviderId:e,browserFields:t,deleteItem:i,field:r,isEnabled:l,isExcluded:u,isLoading:d,onDataProviderEdited:this.onDataProviderEdited,onFilterForFieldPresent:this.onFilterForFieldPresent,operator:p,providerId:f,timelineId:b,timelineType:g,toggleEnabled:h,toggleExcluded:j,toggleType:E,value:O,type:x});return s.a.createElement(R,{id:`popoverFor_${f}-${r}-${O}`,isOpen:m,closePopover:a,button:n,anchorPosition:"downCenter",panelPaddingSize:"none",ownFocus:!0},s.a.createElement("div",{style:{userSelect:"none"}},s.a.createElement(c.EuiContextMenu,{initialPanelId:0,panels:S,"data-test-subj":"providerActions"})))}}var F=n(195),N=n(134);const L=s.a.memo((({andProviderId:e,browserFields:t,deleteProvider:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,isPopoverOpen:f,onDataProviderEdited:b,operator:g,providerId:y,register:h,setIsPopoverOpen:j,timelineId:E,toggleEnabledProvider:O,toggleExcludedProvider:x,toggleTypeProvider:S,displayValue:k,val:T,type:C=v.a.default,wrapperRef:M})=>{const I=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),A=Object(l.b)((e=>{var t,n;return E&&null!==(t=null===(n=I(e,E))||void 0===n?void 0:n.timelineType)&&void 0!==t?t:o.l.default})),{isLoading:P}=Object(l.a)((e=>{var t;return null!==(t=I(e,null!=E?E:""))&&void 0!==t?t:N.b})),_=Object(i.useCallback)((()=>{j(!f)}),[f,j]),D=Object(i.useCallback)((()=>{var e;j(!1),null==M||null===(e=M.current)||void 0===e||e.focus()}),[M,j]),R=Object(i.useCallback)((()=>{O(),D()}),[D,O]),L=Object(i.useCallback)((()=>{x(),D()}),[x,D]),z=Object(i.useCallback)((()=>{S(),D()}),[S,D]),[B,q]=Object(i.useState)(!1),V=Object(r.useDispatch)();Object(i.useEffect)((()=>{null!=h&&(V(F.a.registerProvider({provider:{...h,and:[]}})),q(!0))}),[B,V,h,q]);const $=Object(i.useCallback)((()=>{B&&null!=h&&V(F.a.unRegisterProvider({id:h.id}))}),[B,V,h]);Object(i.useEffect)((()=>()=>{$()}),[$]);const U=Object(i.useMemo)((()=>s.a.createElement(w,{deleteProvider:P?a.noop:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,providerId:y,togglePopover:_,toggleType:z,displayValue:null!=k?k:String(T),val:T,operator:g,type:C,timelineType:A})),[n,k,c,m,p,P,d,z,g,y,A,_,C,T]);return s.a.createElement(provider_item_actions_ProviderItemActions,{andProviderId:e,browserFields:t,button:U,closePopover:D,deleteProvider:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,isLoading:P,isOpen:f,onDataProviderEdited:b,operator:g,providerId:y,timelineId:E,timelineType:A,toggleEnabledProvider:R,toggleExcludedProvider:L,toggleTypeProvider:z,value:T,type:C})}));L.displayName="ProviderItemBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(17),i=n(2),s=n.n(i);const r=n(5).i18n.translate("xpack.securitySolution.accessibility.tooltipWithKeyboardShortcut.pressTooltipLabel",{defaultMessage:"Press"}),o=({additionalScreenReaderOnlyContext:e="",content:t,shortcut:n,showShortcut:i})=>s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{"data-test-subj":"content"},t),""!==e&&s.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"additionalScreenReaderOnlyContext"},s.a.createElement("p",null,e)),i&&s.a.createElement(a.EuiText,{color:"subdued","data-test-subj":"shortcut",size:"s",textAlign:"center"},s.a.createElement("span",null,r)," ",s.a.createElement(a.EuiBadge,{color:"hollow"},n))),l=s.a.memo(o);l.displayName="TooltipWithKeyboardShortcut"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var a=n(17),i=n(2),s=n.n(i),r=n(132);const o=s.a.memo((({onClick:e})=>s.a.createElement(a.EuiButtonEmpty,{color:"text","data-test-subj":"open-timeline-button",iconSide:"left",iconType:"folderOpen",onClick:e},r.G)));o.displayName="OpenTimelineModalButton";var l=n(467),u=n(244),c=n(327),d=n(466);const m="add-timeline-button",p=["createFrom"],f=({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),[r,f]=Object(i.useState)(!1),b=Object(i.useCallback)((()=>n(!t)),[t]),g=Object(i.useCallback)((()=>n(!1)),[]),v=Object(i.useCallback)((()=>f(!1)),[]),y=Object(i.useCallback)((()=>{g(),f(!0)}),[g]),h=Object(i.useMemo)((()=>s.a.createElement(a.EuiButtonIcon,{className:m,"data-test-subj":"timeline-create-open-control",iconType:"plusInCircle",iconSize:"m",color:"primary",onClick:b,"aria-label":u.a})),[b]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiPopover,{anchorPosition:"downRight",button:h,id:"timelineSettingsPopover",panelProps:{"data-test-subj":"timeline-addPopupPanel"},isOpen:t,closePopover:g,ownFocus:!0,repositionOnScroll:!0},s.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"none"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(c.c,{timelineId:e,title:u.h,onClick:g})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(d.a,{onClick:g,timelineId:e,title:u.g})),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(o,{onClick:y}))))),r?s.a.createElement(l.a,{onClose:v,hideActions:p}):null)},b=s.a.memo(f)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),s=n(136),r=n.n(s),o=n(19),l=n(79),u=n(15),c=n(110);const d=e=>"esql"in e?{query:e.esql,language:"esql"}:"sql"in e?{query:e.sql,language:"sql"}:e,m=Object(a.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:n=!1,indexPattern:s,isLoading:m=!1,isRefreshPaused:p,filterQuery:f,filterManager:b,filters:g,onChangedQuery:v,onSubmitQuery:y,refreshInterval:h,savedQuery:j,onSavedQuery:E,dataTestSubj:O,displayStyle:x,isDisabled:S})=>{const{data:k}=Object(c.i)().services,[w,T]=Object(a.useState)(),[C,M]=Object(a.useState)(g),I=Object(a.useCallback)((e=>{if(null!=e.query&&!r()(e.query,f)){const t=d(e.query);y(t)}}),[f,y]),A=Object(a.useCallback)((e=>{if(v&&null!=e.query&&!r()(e.query,f)){const t=d(e.query);v(t)}}),[f,v]),P=Object(a.useCallback)((e=>{const{query:t,filters:n,timefilter:a}=e.attributes;y(t,a),b.setFilters(n||[]),E(e)}),[b,y,E]),_=Object(a.useCallback)((()=>{null!=j&&(y({query:"",language:j.attributes.query.language}),b.setFilters([]),E(void 0))}),[b,y,E,j]),D=Object(a.useCallback)((e=>{b.setFilters(e)}),[b]),R="esql"===(null==f?void 0:f.language),F=Object(a.useMemo)((()=>R&&"string"==typeof f.query?{esql:f.query}:f),[f,R]);Object(a.useEffect)((()=>{let e;var t;return null!=(t=s)&&"object"==typeof t&&Object.hasOwn(t,"getName")?T(s):R||(async()=>{e=await k.dataViews.create({id:s.title,title:s.title}),T(e);const t=[...g];t.forEach((e=>e.meta.index=s.title)),M(t)})(),()=>{var t,n;null!==(t=e)&&void 0!==t&&t.id&&k.dataViews.clearInstanceCache(null===(n=e)||void 0===n?void 0:n.id)}}),[k.dataViews,g,s,R]);const N=Object(a.useMemo)((()=>new o.TimeHistory(new u.Storage(localStorage))),[]),L=Object(a.useMemo)((()=>null!=w?[w]:[]),[w]);return i.a.createElement(l.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:C,indexPatterns:L,isLoading:m,isRefreshPaused:p,query:F,onClearSavedQuery:_,onFiltersUpdated:D,onQueryChange:A,onQuerySubmit:I,onSaved:E,onSavedQueryUpdated:P,refreshInterval:h,showAutoRefreshOnly:!1,showFilterBar:!n,showDatePicker:!1,showQueryInput:!0,showSaveQuery:!0,timeHistory:N,dataTestSubj:O,savedQuery:j,displayStyle:x,isDisabled:S})}));m.displayName="QueryBar"},function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var a=n(2),i=n.n(a),s=n(48),r=n(54),o=n(127),l=n(119),u=n(147),c=n(110),d=n(172),m=n(128),p=n(134),f=n(118),b=n(318),g=n(17),v=n(44),y=n.n(v),h=n(723),j=n(752),E=n(121),O=n(521);const x=y.a.div.withConfig({displayName:"TopNContainer",componentId:"sc-149y4ld-0"})(["min-width:600px;"]),S=y()(g.EuiButtonIcon).withConfig({displayName:"CloseButton",componentId:"sc-149y4ld-1"})(["position:absolute;right:4px;top:4px;"]),k=y()(g.EuiSuperSelect).withConfig({displayName:"ViewSelect",componentId:"sc-149y4ld-2"})(["width:170px;"]),w=y.a.div.withConfig({displayName:"TopNContent",componentId:"sc-149y4ld-3"})(["margin-top:4px;margin-right:",";.euiPanel{border:none;}"],(({theme:e})=>e.eui.euiSizeXS)),T=({combinedQueries:e,defaultView:t,deleteQuery:n,filters:s,field:r,from:o,indexPattern:l,options:u,paddingSize:c,query:d,showLegend:m,setAbsoluteRangeDatePickerTarget:p,setQuery:f,scopeId:g,to:v,toggleTopN:y})=>{const[T,C]=Object(a.useState)(t),M=Object(a.useCallback)((e=>C(e)),[C]),I=Object(b.b)({scopeId:g,view:T}),{selectedPatterns:A,runtimeMappings:P}=Object(E.d)(I);Object(a.useEffect)((()=>{C(t)}),[t]);const _=Object(a.useMemo)((()=>i.a.createElement(k,{"data-test-subj":"view-select",disabled:1===u.length,onChange:M,options:u,valueOfSelected:T})),[M,u,T]),D=Object(a.useMemo)((()=>Object(b.d)({filters:s,tableId:g,view:T})),[s,g,T]);return i.a.createElement(x,{"data-test-subj":"topN-container"},i.a.createElement(w,null,"raw"===T||"all"===T?i.a.createElement(h.a,{combinedQueries:e,deleteQuery:n,filters:D,from:o,headerChildren:_,indexPattern:l,indexNames:A,runtimeMappings:P,onlyField:r,paddingSize:c,query:d,queryType:"topN",showLegend:m,setAbsoluteRangeDatePickerTarget:p,setQuery:f,showSpacer:!1,toggleTopN:y,scopeId:g,sourcererScopeId:I,to:v,hideQueryToggle:!0}):i.a.createElement(j.a,{combinedQueries:e,filters:D,headerChildren:_,onlyField:r,paddingSize:c,query:d,showLegend:m,setAbsoluteRangeDatePickerTarget:p,runtimeMappings:P,hideQueryToggle:!0})),i.a.createElement(S,{"aria-label":O.c,"data-test-subj":"close",iconType:"cross",onClick:y}))};T.displayName="TopNComponent";const C=i.a.memo(T);var M=n(122);const I=[],A={query:"",language:"kuery"},P=Object(s.connect)((()=>{const e=m.d.globalQuerySelector(),t=m.d.globalFiltersQuerySelector(),n=f.b.getTimelineByIdSelector(),a=m.d.getTimelineSelector(),i=f.b.getKqlFilterQuerySelector();return(s,r)=>{var o,l;const u=null!==(o=n(s,M.c.active))&&void 0!==o?o:p.b,c=null!==(l=u.filters)&&void 0!==l?l:I,d=a(s),{globalFilters:m}=r;return{activeTimelineEventType:u.eventType,activeTimelineFilters:u.activeTab===M.d.query?c:I,activeTimelineFrom:d.timerange.from,activeTimelineKqlQueryExpression:u.activeTab===M.d.query?i(s,M.c.active):null,activeTimelineTo:d.timerange.to,dataProviders:u.activeTab===M.d.query?u.dataProviders:[],globalQuery:e(s),globalFilters:null!=m?m:t(s),kqlMode:u.kqlMode}}})),_=({activeTimelineEventType:e,activeTimelineFilters:t,activeTimelineFrom:n,activeTimelineKqlQueryExpression:s,activeTimelineTo:m,browserFields:p,dataProviders:f,field:g,indexPattern:v,globalFilters:y=I,globalQuery:h=A,kqlMode:j,onFilterAdded:E,paddingSize:O,showLegend:x,scopeId:S,toggleTopN:k})=>{const{uiSettings:w}=Object(c.i)().services,{from:T,deleteQuery:M,setQuery:P,to:_}=Object(u.a)(),D=Object(b.a)(Object(o.isActiveTimeline)(null!=S?S:"")?e:void 0),R=Object(a.useMemo)((()=>{var e;return Object(o.isActiveTimeline)(null!=S?S:"")?null===(e=Object(d.d)({browserFields:p,config:Object(r.getEsQueryConfig)(w),dataProviders:f,filters:t,indexPattern:v,kqlMode:j,kqlQuery:{language:"kuery",query:null!=s?s:""}}))||void 0===e?void 0:e.filterQuery:void 0}),[S,p,w,f,t,v,j,s]),F=Object(a.useMemo)((()=>Object(b.c)(S)?"alert":D[0].value),[D,S]);return i.a.createElement(C,{combinedQueries:R,"data-test-subj":"top-n",defaultView:F,deleteQuery:Object(o.isActiveTimeline)(null!=S?S:"")?void 0:M,field:g,filters:Object(o.isActiveTimeline)(null!=S?S:"")?I:y,from:Object(o.isActiveTimeline)(null!=S?S:"")?n:T,indexPattern:v,options:D,paddingSize:O,query:Object(o.isActiveTimeline)(null!=S?S:"")?A:h,showLegend:x,setAbsoluteRangeDatePickerTarget:Object(o.isActiveTimeline)(null!=S?S:"")?l.a.timeline:l.a.global,setQuery:P,scopeId:S,to:Object(o.isActiveTimeline)(null!=S?S:"")?m:_,toggleTopN:k,onFilterAdded:E})};_.displayName="StatefulTopNComponent";const D=P(i.a.memo(_))},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(136),i=n.n(a),s=n(45),r=n(2),o=n(3),l=n(54),u=n(209),c=n(110),d=n(294),m=n(127),p=n(5);p.i18n.translate("xpack.securitySolution.matrixHistogram.errorSearchDescription",{defaultMessage:"An error has occurred on matrix histogram search"});const f=p.i18n.translate("xpack.securitySolution.matrixHistogram.failSearchDescription",{defaultMessage:"Failed to run search on matrix histogram"});var b=n(117),g=n(336),v=n(4);const y=[],h=({endDate:e,errorMessage:t,filterQuery:n,histogramType:a,indexNames:p,isPtrIncluded:h,onError:j,stackByField:E,runtimeMappings:O,startDate:x,threshold:S,skip:k=!1,includeMissingData:w=!0})=>{const{data:T}=Object(c.i)().services,C=Object(r.useRef)(s.noop),M=Object(r.useRef)(new AbortController),I=Object(r.useRef)(new o.Subscription),[A,P]=Object(r.useState)(!1),{startTracking:_}=Object(g.a)(),[D,R]=Object(r.useState)({defaultIndex:p,factoryQueryType:d.h,filterQuery:Object(u.a)(n),histogramType:a,timerange:{interval:"12h",from:x,to:e},stackByField:E,runtimeMappings:O,threshold:S,...null!=h?{isPtrIncluded:h}:{},...null!=w?{includeMissingData:w}:{}}),{addError:F}=Object(b.a)(),[N,L]=Object(r.useState)({data:[],inspect:{dsl:[],response:[]},refetch:C.current,totalCount:-1,buckets:[]}),z=Object(r.useCallback)((e=>{const n=async()=>{M.current=new AbortController,P(!0);const{endTracking:n}=_({name:`${v.l} matrixHistogram ${a}`});I.current=T.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:M.current.signal}).subscribe({next:e=>{if(!Object(l.isRunningResponse)(e)){const t=Object(s.getOr)(y,d.j[a],e.rawResponse);P(!1),L((n=>({...n,data:e.matrixHistogramData,inspect:Object(m.getInspectResponse)(e,n.inspect),refetch:C.current,totalCount:t.reduce(((e,t)=>t.doc_count+e),0),buckets:t}))),n("success"),I.current.unsubscribe()}},error:e=>{P(!1),F(e,{title:null!=t?t:f}),n("error"),I.current.unsubscribe()}})};I.current.unsubscribe(),M.current.abort(),n(),C.current=n}),[T.search,a,F,t,_]);return Object(r.useEffect)((()=>{R((t=>{const s={...t,defaultIndex:p,filterQuery:Object(u.a)(n),histogramType:a,timerange:{interval:"12h",from:x,to:e},stackByField:E,threshold:S,...null!=h?{isPtrIncluded:h}:{}};return i()(t,s)?t:s}))}),[p,e,n,x,E,a,S,h]),Object(r.useEffect)((()=>(k||z(D),()=>{I.current.unsubscribe(),M.current.abort()})),[D,z,k]),Object(r.useEffect)((()=>{k&&(P(!1),I.current.unsubscribe(),M.current.abort())}),[k]),[A,N,Object(r.useCallback)(((e,t)=>{z({...D,timerange:{interval:"12h",from:t,to:e}})}),[D,z])]},j=e=>{const[t,n]=h({...e,includeMissingData:!0}),a=Object(r.useMemo)((()=>!e.stackByField.endsWith(".ip")),[e.stackByField]),[i,s]=h({...e,includeMissingData:!1,skip:a||void 0===e.filterQuery||e.skip}),o=Object(r.useMemo)((()=>t||i),[t,i]),l=Object(r.useMemo)((()=>{if(a)return n;const{data:e,inspect:t,totalCount:i,refetch:r,buckets:l}=n,{data:u,inspect:c,totalCount:d,refetch:m}=s,p=()=>{r(),m()};return o?{data:[],inspect:{dsl:[],response:[]},refetch:p,totalCount:-1,buckets:[]}:{data:[...e,...u],inspect:{dsl:[...t.dsl,...c.dsl],response:[...t.response,...c.response]},totalCount:i+d,refetch:p,buckets:l}}),[o,n,s,a]);return[o,l]}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return a.useMemo((function(){return e.apply(void 0,t)}),t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.createContext(void 0);return[function(){var e=a.useContext(n);if(null==e)throw new Error("useReducerContext must be used inside a ReducerProvider.");return e},function(i){var s=i.children,r=i.initialState;return function(e,t){return a.createElement(n.Provider,e,t)}({value:a.useReducer(e,void 0!==r?r:t)},s)},n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(254));t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,a=(n=e,function(e,t){return n.reduceRight((function(t,n){return n(e)(t)}),t)});return function(e,t,n){void 0===n&&(n=function(e){return e});var r=i.useRef(n(t)),o=i.useState(r.current)[1],l=i.useCallback((function(t){return r.current=e(r.current,t),o(r.current),t}),[e]),u=i.useRef(a({getState:function(){return r.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u.current.apply(u,e)}},l));return s.default((function(){u.current=a({getState:function(){return r.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u.current.apply(u,e)}},l)}),[l]),[r.current,u.current]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.createContext(void 0);return[function(){var e=a.useContext(t);if(null==e)throw new Error("useStateContext must be used inside a StateProvider.");return e},function(n){var i=n.children,s=n.initialValue;return function(e,n){return a.createElement(t.Provider,e,n)}({value:a.useState(void 0!==s?s:e)},i)},t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(407));t.default=function(e,t){void 0===t&&(t=[]);var n=i.useState(0),r=n[0],o=n[1],l=s.default(e,a.__spreadArrays(t,[r])),u=l.loading,c=i.useCallback((function(){u||o((function(e){return e+1}))}),a.__spreadArrays(t,[u]));return a.__assign(a.__assign({},l),{retry:c})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(499)).default("audio");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),s="object"==typeof navigator?navigator:void 0,r=s&&"function"==typeof s.getBattery;t.default=r?function(){var e=a.useState({isSupported:!0,fetched:!1}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,a=null,r=function(){if(e&&a){var s={isSupported:!0,fetched:!0,level:a.level,charging:a.charging,dischargingTime:a.dischargingTime,chargingTime:a.chargingTime};!i.isDeepEqual(t,s)&&n(s)}};return s.getBattery().then((function(t){e&&(a=t,i.on(a,"chargingchange",r),i.on(a,"chargingtimechange",r),i.on(a,"dischargingtimechange",r),i.on(a,"levelchange",r),r())})),function(){e=!1,a&&(i.off(a,"chargingchange",r),i.off(a,"chargingtimechange",r),i.off(a,"dischargingtimechange",r),i.off(a,"levelchange",r))}}),[]),t}:function(){return{isSupported:!1}}},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var a,i,s;if(Array.isArray(t)){if((a=t.length)!=n.length)return!1;for(i=a;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((a=(s=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=a;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=a;0!=i--;){var r=s[i];if(!("_owner"===r&&t.$$typeof||e(t[r],n[r])))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===e&&(e=!0);var n=a.useCallback((function(n){if("function"!=typeof e||e())return n.preventDefault(),t&&(n.returnValue=t),t}),[e,t]);a.useEffect((function(){if(e)return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}),[e,n])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(500));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),s=["mousedown","touchstart"];t.default=function(e,t,n){void 0===n&&(n=s);var r=a.useRef(t);a.useEffect((function(){r.current=t}),[t]),a.useEffect((function(){for(var t=function(t){var n=e.current;n&&!n.contains(t.target)&&r.current(t)},a=0,s=n;a<s.length;a++){var o=s[a];i.on(document,o,t)}return function(){for(var e=0,a=n;e<a.length;e++){var s=a[e];i.off(document,s,t)}}}),[n,e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(779));t.default=function(e){var t=i.useState((function(){return s.default.get(e)||null})),n=t[0],a=t[1];return[n,i.useCallback((function(t,n){s.default.set(e,t,n),a(t)}),[e]),i.useCallback((function(){s.default.remove(e),a(null)}),[e])]}},function(e,t,n){var a,i,s;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */s=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(a){function i(){}function s(t,n,s){if("undefined"!=typeof document){"number"==typeof(s=e({path:"/"},i.defaults,s)).expires&&(s.expires=new Date(1*new Date+864e5*s.expires)),s.expires=s.expires?s.expires.toUTCString():"";try{var r=JSON.stringify(n);/^[\{\[]/.test(r)&&(n=r)}catch(e){}n=a.write?a.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var o="";for(var l in s)s[l]&&(o+="; "+l,!0!==s[l]&&(o+="="+s[l].split(";")[0]));return document.cookie=t+"="+n+o}}function r(e,n){if("undefined"!=typeof document){for(var i={},s=document.cookie?document.cookie.split("; "):[],r=0;r<s.length;r++){var o=s[r].split("="),l=o.slice(1).join("=");n||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var u=t(o[0]);if(l=(a.read||a)(l,u)||t(l),n)try{l=JSON.parse(l)}catch(e){}if(i[u]=l,e===u)break}catch(e){}}return e?i[e]:i}}return i.set=s,i.get=function(e){return r(e,!1)},i.getJSON=function(e){return r(e,!0)},i.remove=function(t,n){s(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))},void 0===(i="function"==typeof(a=s)?a.call(t,n,t,e):a)||(e.exports=i),e.exports=s()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(487)),s=n(2),r=a.__importDefault(n(207)),o=a.__importDefault(n(255));t.default=function(){var e=r.default(),t=o.default({value:void 0,error:void 0,noUserInteraction:!0}),n=t[0],a=t[1];return[n,s.useCallback((function(t){var n,s;if(e())try{if("string"!=typeof t&&"number"!=typeof t){var r=new Error("Cannot copy typeof "+typeof t+" to clipboard, must be a string");return void a({value:t,error:r,noUserInteraction:!0})}if(""===t)return r=new Error("Cannot copy empty string to clipboard."),void a({value:t,error:r,noUserInteraction:!0});s=t.toString(),n=i.default(s),a({value:s,error:void 0,noUserInteraction:n})}catch(r){a({value:s,error:r,noUserInteraction:n})}}),[])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(782),s=n(783),r=n(784),o=n(786),l=n(2),u=a.__importDefault(n(40)),c=i.create();s.addon(c),r.addon(c);var d=0;t.default=function(e){var t=l.useMemo((function(){return"react-use-css-"+(d++).toString(36)}),[]),n=l.useMemo((function(){return new c.VSheet}),[]);return u.default((function(){var a={};return o.cssToTree(a,e,"."+t,""),n.diff(a),function(){n.diff({})}})),t}},function(e,t,n){"use strict";var a=/[A-Z]/g;t.create=function(e){var t=(e=e||{}).assign||Object.assign,n=t({raw:"",pfx:"_",client:"object"==typeof window,assign:t,stringify:JSON.stringify,kebab:function(e){return e.replace(a,"-$&").toLowerCase()},decl:function(e,t){return(e=n.kebab(e))+":"+t+";"},hash:function(e){return function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return"_"+(t>>>0).toString(36)}(n.stringify(e))},selector:function(e,t){return e+(":"===t[0]?"":" ")+t},putRaw:function(e){n.raw+=e}},e);return n.client&&(n.sh||document.head.appendChild(n.sh=document.createElement("style")),n.putRaw=function(e){var t=n.sh.sheet;try{t.insertRule(e,t.cssRules.length)}catch(e){}}),n.put=function(e,t,a){var i,s,r="",o=[];for(i in t)(s=t[i])instanceof Object&&!(s instanceof Array)?o.push(i):r+=n.decl(i,s,e,a);r&&(r=e+"{"+r+"}",n.putRaw(a?a+"{"+r+"}":r));for(var l=0;l<o.length;l++)"@"===(i=o[l])[0]&&"@font-face"!==i?n.putAt(e,t[i],i):n.put(n.selector(e,i),t[i],a)},n.putAt=n.put,n}},function(e,t,n){"use strict";t.addon=function(e){e.client&&(document.head.appendChild(e.msh=document.createElement("style")),e.createRule=function(t,n){var a=t+"{}";n&&(a=n+"{"+a+"}");var i=n?e.msh.sheet:e.sh.sheet,s=i.insertRule(a,i.cssRules.length),r=(i.cssRules||i.rules)[s];if(r.index=s,n){var o=(r.cssRules||r.rules)[0];r.style=o.style,r.styleMap=o.styleMap}return r})}},function(e,t,n){"use strict";var a=n(785).removeRule;t.addon=function(e){if(e.client){var t=e.kebab;n.prototype.diff=function(e){var n,a=this.decl,i=this.rule.style;for(n in a)void 0===e[n]&&i.removeProperty(n);for(n in e)e[n]!==a[n]&&i.setProperty(t(n),e[n]);this.decl=e},n.prototype.del=function(){a(this.rule)},i.prototype.diff=function(e){var t=this.tree;for(var a in t)if(void 0===e[a]){var i=t[a];for(var s in i)i[s].del()}for(var a in e)if(void 0===t[a])for(var s in e[a])(l=new n(s,a)).diff(e[a][s]),e[a][s]=l;else{var r=t[a],o=e[a];for(var s in r)o[s]||r[s].del();for(var s in o){var l;(l=r[s])?(l.diff(o[s]),o[s]=l):((l=new n(s,a)).diff(o[s]),o[s]=l)}}this.tree=e},e.VRule=n,e.VSheet=i}function n(t,n){this.rule=e.createRule(t,n),this.decl={}}function i(){this.tree={}}}},function(e,t){t.removeRule=function(e){var t=e.index,n=e.parentStyleSheet,a=n.cssRules||n.rules;for(t=Math.max(t,a.length-1);t>=0;){if(a[t]===e){n.deleteRule(t);break}t--}}},function(e,t){t.cssToTree=function e(t,n,a,i){var s,r,o={},l=!1;for(s in n)"object"!=typeof(r=n[s])&&(l=!0,o[s]=r);for(s in l&&(t[i]||(t[i]={}),t[i][a]=o),n)if("object"==typeof(r=n[s]))if("@"===s[0])e(t,r,a,s);else{var u=s.indexOf("&")>-1,c=a.split(",");if(u)for(var d=0;d<c.length;d++)c[d]=s.replace(/&/g,c[d]);else for(d=0;d<c.length;d++)c[d]=c[d]+" "+s;e(t,r,c.join(","),i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(376));t.default=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var a=s.default(e,t),r=a[0],o=a[1],l=a[2];return i.useEffect(l,n),[r,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(t),i=n[0],s=n[1];return null==i?[e,s]:[i,s]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=function(){};t.default=function(e,t){void 0===e&&(e={}),void 0===t&&(t=[]);var n=e.onFiles,r=e.onText,o=e.onUri,l=i.useState(!1),u=l[0],c=l[1],d=i.useCallback(c,[]),m=i.useMemo((function(){return function(e){return function(t,n){var a=t.getData("text/uri-list");if(a)(e.onUri||s)(a,n);else if(t.files&&t.files.length)(e.onFiles||s)(Array.from(t.files),n);else if(n.clipboardData){var i=n.clipboardData.getData("text");(e.onText||s)(i,n)}}}(e)}),[n,r,o]);return i.useEffect((function(){var e=function(e){e.preventDefault(),d(!0)},t=function(e){e.preventDefault(),d(!0)},n=function(){d(!1)},a=function(){d(!1)},i=function(e){e.preventDefault(),d(!1),m(e.dataTransfer,e)},s=function(e){m(e.clipboardData,e)};return document.addEventListener("dragover",e),document.addEventListener("dragenter",t),document.addEventListener("dragleave",n),document.addEventListener("dragexit",a),document.addEventListener("drop",i),r&&document.addEventListener("paste",s),function(){document.removeEventListener("dragover",e),document.removeEventListener("dragenter",t),document.removeEventListener("dragleave",n),document.removeEventListener("dragexit",a),document.removeEventListener("drop",i),document.removeEventListener("paste",s)}}),a.__spreadArrays([m],t)),{over:u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(207)),r=function(){};t.default=function(e){void 0===e&&(e={});var t=e.onFiles,n=e.onText,a=e.onUri,o=s.default(),l=i.useState(!1),u=l[0],c=l[1],d=i.useMemo((function(){return function(e,t){return function(n,a){var i=n.getData("text/uri-list");i?(e.onUri||r)(i,a):n.files&&n.files.length?(e.onFiles||r)(Array.from(n.files),a):n.items&&n.items.length&&n.items[0].getAsString((function(n){t&&(e.onText||r)(n,a)}))}}(e,o())}),[t,n,a]),m=i.useMemo((function(){return function(e,t){return{onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault(),t(!0)},onDragLeave:function(){t(!1)},onDrop:function(n){n.preventDefault(),n.persist(),t(!1),e(n.dataTransfer,n)},onPaste:function(t){t.persist(),e(t.clipboardData,t)}}}(d,c)}),[d,c]);return[m,{over:u}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensuredForwardRef=void 0;var a=n(2);function i(e){var t=a.useRef(e&&e.current);return a.useEffect((function(){e&&(e.current=t.current)}),[e]),t}t.default=i,t.ensuredForwardRef=function(e){return a.forwardRef((function(t,n){var a=i(n);return e(t,a)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(null),t=e[0],n=e[1];return a.useEffect((function(){if(t)throw t}),[t]),a.useCallback((function(e){n(e)}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect((function(){var t=document.querySelector("link[rel*='icon']")||document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(795)),r=a.__importDefault(n(40)),o=function(){};t.default=function(e,t,n){void 0===n&&(n={});var a=n.video,l=n.onClose,u=void 0===l?o:l,c=i.useState(t),d=c[0],m=c[1];return r.default((function(){if(t&&e.current){var n=function(){a.current.removeEventListener("webkitendfullscreen",n),u()},i=function(){if(s.default.isEnabled){var e=s.default.isFullscreen;m(e),e||u()}};if(s.default.isEnabled){try{s.default.request(e.current),m(!0)}catch(e){u(e),m(!1)}s.default.on("change",i)}else a&&a.current&&a.current.webkitEnterFullscreen?(a.current.webkitEnterFullscreen(),a.current.addEventListener("webkitendfullscreen",n),m(!0)):(u(),m(!1));return function(){if(m(!1),s.default.isEnabled)try{s.default.off("change",i),s.default.exit()}catch(e){}else a&&a.current&&a.current.webkitExitFullscreen&&(a.current.removeEventListener("webkitendfullscreen",n),a.current.webkitExitFullscreen())}}}),[t,a,e]),d}},function(e,t,n){
/*!
* screenfull
* v5.0.0 - 2019-09-09
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,a=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=0,i=n.length,s={};a<i;a++)if((e=n[a])&&e[1]in t){for(a=0;a<e.length;a++)s[n[0][a]]=e[a];return s}return!1}(),i={change:a.fullscreenchange,error:a.fullscreenerror},s={request:function(e){return new Promise(function(n,i){var s=function(){this.off("change",s),n()}.bind(this);this.on("change",s),e=e||t.documentElement,Promise.resolve(e[a.requestFullscreen]()).catch(i)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var i=function(){this.off("change",i),e()}.bind(this);this.on("change",i),Promise.resolve(t[a.exitFullscreen]()).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var a=i[e];a&&t.addEventListener(a,n,!1)},off:function(e,n){var a=i[e];a&&t.removeEventListener(a,n,!1)},raw:a};a?(Object.defineProperties(s,{isFullscreen:{get:function(){return Boolean(t[a.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[a.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[a.fullscreenEnabled])}}}),n?e.exports=s:window.screenfull=s):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){var t,n=i.useState({loading:!0,accuracy:null,altitude:null,altitudeAccuracy:null,heading:null,latitude:null,longitude:null,speed:null,timestamp:Date.now()}),s=n[0],r=n[1],o=!0,l=function(e){o&&r({loading:!1,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,latitude:e.coords.latitude,longitude:e.coords.longitude,speed:e.coords.speed,timestamp:e.timestamp})},u=function(e){return o&&r((function(t){return a.__assign(a.__assign({},t),{loading:!1,error:e})}))};return i.useEffect((function(){return navigator.geolocation.getCurrentPosition(l,u,e),t=navigator.geolocation.watchPosition(l,u,e),function(){o=!1,navigator.geolocation.clearWatch(t)}}),[]),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(223));t.default=function(e){void 0===e&&(e={});var t=s.default(),n=i.useRef(a.__assign({},e));return[i.useCallback((function(){return n.current}),[]),i.useCallback((function(e){e&&(Object.assign(n.current,e),t())}),[])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(799);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=i.setHarmonicInterval((function(){return n.current()}),t);return function(){return i.clearHarmonicInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0,i={};t.clearHarmonicInterval=function(e){var t=e.bucket,n=e.id;delete t.listeners[n];var a=!1;for(var s in t.listeners){a=!0;break}a||(clearInterval(t.timer),delete i[t.ms])},t.setHarmonicInterval=function(e,t){var n,s=a++;if(i[t])i[t].listeners[s]=e;else{var r=setInterval((function(){for(var e,n=i[t].listeners,a=!1,s=0,r=Object.values(n);s<r.length;s++){var o=r[s];try{o()}catch(t){a=!0,e=t}}if(a)throw e}),t);i[t]={ms:t,timer:r,listeners:(n={},n[s]=e,n)}}return{bucket:i[t],id:s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importStar(n(2)),i=a.useState,s=function(){};t.default=function(e){var t,n,r=i(!1),o=r[0],l=r[1];return"function"==typeof e&&(e=e(o)),[a.cloneElement(e,{onMouseEnter:(n=e.props.onMouseEnter,function(e){(n||s)(e),l(!0)}),onMouseLeave:(t=e.props.onMouseLeave,function(e){(t||s)(e),l(!1)})}),o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(802),s=n(131),r=["mousemove","mousedown","resize","keydown","touchstart","wheel"];t.default=function(e,t,n){void 0===e&&(e=6e4),void 0===t&&(t=!1),void 0===n&&(n=r);var o=a.useState(t),l=o[0],u=o[1];return a.useEffect((function(){for(var t,a=!0,r=l,o=function(e){a&&(r=e,u(e))},c=i.throttle(50,(function(){r&&o(!1),clearTimeout(t),t=setTimeout((function(){return o(!0)}),e)})),d=function(){document.hidden||c()},m=0;m<n.length;m++)s.on(window,n[m],c);return s.on(document,"visibilitychange",d),t=setTimeout((function(){return o(!0)}),e),function(){a=!1;for(var e=0;e<n.length;e++)s.off(window,n[e],c);s.off(document,"visibilitychange",d)}}),[e,n]),l}},function(e,t,n){"use strict";function a(e,t,n,a){var i,s=!1,r=0;function o(){i&&clearTimeout(i)}function l(){var l=this,u=Date.now()-r,c=arguments;function d(){r=Date.now(),n.apply(l,c)}s||(a&&!i&&d(),o(),void 0===a&&u>e?d():!0!==t&&(i=setTimeout(a?function(){i=void 0}:d,void 0===a?e-u:e)))}return"boolean"!=typeof t&&(a=n,n=t,t=void 0),l.cancel=function(){o(),s=!0},l}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=a,t.debounce=function(e,t,n){return void 0===n?a(e,t,!1):a(e,n,!1!==t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(null),i=n[0],s=n[1];return a.useEffect((function(){if(e.current&&"function"==typeof IntersectionObserver){var n=new IntersectionObserver((function(e){s(e[0])}),t);return n.observe(e.current),function(){s(null),n.disconnect()}}return function(){}}),[e.current,t.threshold,t.root,t.rootMargin]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=setInterval((function(){return n.current()}),t||0);return function(){return clearInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return void 0===e&&(e={laptopL:1440,laptop:1024,tablet:768}),function(){var t=a.useState(0),n=t[0],i=t[1];a.useEffect((function(){var e=function(){i(window.innerWidth)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}));var s=a.useMemo((function(){return Object.entries(e).sort((function(e,t){return e[1]>=t[1]?1:-1}))}),[e]),r=s.reduce((function(e,t){var a=t[0],i=t[1];return n>=i?a:e}),s[0][0]);return r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(505)),s=a.__importDefault(n(254));t.default=function(e,t,n,a){void 0===a&&(a=i.default);var r=a(e),o=r[0],l=r[1];s.default((function(){!o&&n?n(l):o&&t&&t(l)}),[o])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),s=function(){};t.default=function(e,t,n){if(!i.isClient)return[t,s,s];if(!e)throw new Error("useLocalStorage key may not be falsy");var r=n?n.raw?function(e){return e}:n.deserializer:JSON.parse,o=a.useState((function(){try{var a=n?n.raw?String:n.serializer:JSON.stringify,i=localStorage.getItem(e);return null!==i?r(i):(t&&localStorage.setItem(e,a(t)),t)}catch(e){return t}})),l=o[0],u=o[1],c=a.useCallback((function(t){try{var a="function"==typeof t?t(l):t;if(void 0===a)return;var i;i=n?n.raw?"string"==typeof a?a:JSON.stringify(a):n.serializer?n.serializer(a):JSON.stringify(a):JSON.stringify(a),localStorage.setItem(e,i),u(r(i))}catch(e){}}),[e,u]),d=a.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[l,c,d]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),s=function(e){var t=window.history,n=t[e];t[e]=function(t){var a=n.apply(this,arguments),i=new Event(e.toLowerCase());return i.state=t,window.dispatchEvent(i),a}};i.isClient&&(s("pushState"),s("replaceState"));var r=function(e){var t=window.history,n=t.state,a=t.length,i=window.location;return{trigger:e,state:n,length:a,hash:i.hash,host:i.host,hostname:i.hostname,href:i.href,origin:i.origin,pathname:i.pathname,port:i.port,protocol:i.protocol,search:i.search}},o="function"==typeof Event;t.default=i.isClient&&o?function(){var e=a.useState(r("load")),t=e[0],n=e[1];return a.useEffect((function(){var e=function(){return n(r("popstate"))},t=function(){return n(r("pushstate"))},a=function(){return n(r("replacestate"))};return i.on(window,"popstate",e),i.on(window,"pushstate",t),i.on(window,"replacestate",a),function(){i.off(window,"popstate",e),i.off(window,"pushstate",t),i.off(window,"replacestate",a)}}),[]),t}:function(){return{trigger:"load",length:1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestBody=void 0;var a=n(2);function i(e){if(!e)return null;if("BODY"===e.tagName)return e;if("IFRAME"===e.tagName){var t=e.contentDocument;return t?t.body:null}return e.offsetParent?i(e.offsetParent):null}function s(e){var t=e||window.event;return t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)}t.getClosestBody=i;var r="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),o=new Map,l="object"==typeof document?document:void 0,u=!1;t.default=l?function(e,t){void 0===e&&(e=!0);var n=a.useRef(l.body);t=t||n;var c=function(e){var t=o.get(e);t&&(1===t.counter?(o.delete(e),r?(e.ontouchmove=null,u&&(document.removeEventListener("touchmove",s),u=!1)):e.style.overflow=t.initialOverflow):o.set(e,{counter:t.counter-1,initialOverflow:t.initialOverflow}))};a.useEffect((function(){var n=i(t.current);n&&(e?function(e){var t=o.get(e);t?o.set(e,{counter:t.counter+1,initialOverflow:t.initialOverflow}):(o.set(e,{counter:1,initialOverflow:e.style.overflow}),r?u||(document.addEventListener("touchmove",s,{passive:!1}),u=!0):e.style.overflow="hidden")}(n):c(n))}),[e,t.current]),a.useEffect((function(){var e=i(t.current);if(e)return function(){c(e)}}),[])}:function(e,t){void 0===e&&(e=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(256)),s=a.__importDefault(n(254));t.default=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];i.default((function(){return console.log.apply(console,a.__spreadArrays([e+" mounted"],t)),function(){return console.log(e+" unmounted")}})),s.default((function(){console.log.apply(console,a.__spreadArrays([e+" updated"],t))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};t.default=function(e,t){var n=void 0===t?{}:t,s=n.isPreventDefault,r=void 0===s||s,o=n.delay,l=void 0===o?300:o,u=a.useRef(),c=a.useRef(),d=a.useCallback((function(t){r&&t.target&&(t.target.addEventListener("touchend",i,{passive:!1}),c.current=t.target),u.current=setTimeout((function(){return e(t)}),l)}),[e,l,r]),m=a.useCallback((function(){u.current&&clearTimeout(u.current),r&&c.current&&c.current.removeEventListener("touchend",i)}),[r]);return{onMouseDown:function(e){return d(e)},onTouchStart:function(e){return d(e)},onMouseUp:m,onMouseLeave:m,onTouchEnd:m}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131);t.default=function(e,t){void 0===t&&(t=!1);var n=a.useState(i.isClient?function(){return window.matchMedia(e).matches}:t),s=n[0],r=n[1];return a.useEffect((function(){var t=!0,n=window.matchMedia(e),a=function(){t&&r(!!n.matches)};return n.addListener(a),r(n.matches),function(){t=!1,n.removeListener(a)}}),[e]),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),s=function(){};t.default="object"==typeof navigator&&navigator.mediaDevices?function(){var e=a.useState({}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,t=function(){navigator.mediaDevices.enumerateDevices().then((function(t){e&&n({devices:t.map((function(e){return{deviceId:e.deviceId,groupId:e.groupId,kind:e.kind,label:e.label}}))})})).catch(s)};return i.on(navigator.mediaDevices,"devicechange",t),t(),function(){e=!1,i.off(navigator.mediaDevices,"devicechange",t)}}),[]),t}:function(){return{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMediatedState=void 0;var a=n(2);t.useMediatedState=function(e,t){var n=a.useRef(e),i=a.useState(t),s=i[0],r=i[1];return[s,a.useCallback((function(e){2===n.current.length?n.current(e,r):r(n.current(e))}),[s])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useMemo((function(){return function(t,n){var a;return(a=e(t))[n.type].apply(a,n.payload)}}),[e]),i=a.useReducer(n,t),s=i[0],r=i[1],o=a.useMemo((function(){return Object.keys(e(t)).reduce((function(e,t){return e[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return r({type:t,payload:e})},e}),{})}),[e,t]);return[s,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),s={acceleration:{x:null,y:null,z:null},accelerationIncludingGravity:{x:null,y:null,z:null},rotationRate:{alpha:null,beta:null,gamma:null},interval:16};t.default=function(e){void 0===e&&(e=s);var t=a.useState(e),n=t[0],r=t[1];return a.useEffect((function(){var e=function(e){var t=e.acceleration,n=e.accelerationIncludingGravity,a=e.rotationRate,i=e.interval;r({acceleration:{x:t.x,y:t.y,z:t.z},accelerationIncludingGravity:{x:n.x,y:n.y,z:n.z},rotationRate:{alpha:a.alpha,beta:a.beta,gamma:a.gamma},interval:i})};return i.on(window,"devicemotion",e),function(){i.off(window,"devicemotion",e)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(503)),s=a.__importDefault(n(510)),r={current:null};t.default=function(e,t){void 0===t&&(t={});var n=!!t.whenHovered,a=!!t.bound,o=i.default(e,n),l=s.default(n&&!o?r:e);return a&&(l.elX=Math.max(0,Math.min(l.elX,l.elW)),l.elY=Math.max(0,Math.min(l.elY,l.elH))),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(0),t=e[0],n=e[1];return a.useEffect((function(){var e=function(e){n(e.deltaY+t)};return window.addEventListener("wheel",e,!1),function(){return window.removeEventListener("wheel",e)}})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=n(131),r=function(){if("object"!=typeof navigator)return null;var e=navigator;return e.connection||e.mozConnection||e.webkitConnection},o=function(){var e=r();return e?{downlink:e.downlink,downlinkMax:e.downlinkMax,effectiveType:e.effectiveType,type:e.type,rtt:e.rtt}:{}};t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],l=t[1];return i.useEffect((function(){var e=n,t=function(t){e=a.__assign(a.__assign({},e),t),l(e)},i=r(),u=function(){t({online:!0,since:new Date})},c=function(){t({online:!1,since:new Date})},d=function(){t(o())};return s.on(window,"online",u),s.on(window,"offline",c),i&&(s.on(i,"change",d),t(a.__assign(a.__assign(a.__assign({},n),{online:navigator.onLine,since:void 0}),o()))),function(){s.off(window,"online",u),s.off(window,"offline",c),i&&s.off(i,"change",d)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(501));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),s={angle:0,type:"landscape-primary"};t.default=function(e){void 0===e&&(e=s);var t=window.screen,n=a.useState(e),r=n[0],o=n[1];return a.useEffect((function(){var n=!0,a=function(){if(n){var a=t.orientation;if(a){var i=a.angle,s=a.type;o({angle:i,type:s})}else window.orientation?o({angle:"number"==typeof window.orientation?window.orientation:0,type:""}):o(e)}};return i.on(window,"orientationchange",a),a(),function(){n=!1,i.off(window,"orientationchange",a)}}),[]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=[]),a.useEffect((function(){if(e){var t=function(t){var n=(t=t||window.event).relatedTarget||t.toElement;n&&"HTML"!==n.nodeName||e()};return document.addEventListener("mouseout",t),function(){document.removeEventListener("mouseout",t)}}}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),s=function(){};t.default=function(e){var t=!0,n=null,r=a.useState(""),o=r[0],l=r[1],u=function(){t&&n&&l(n.state)};return a.useEffect((function(){return navigator.permissions.query(e).then((function(e){n=e,u(),i.on(n,"change",u)})).catch(s),function(){t=!1,n&&i.off(n,"change",u)}}),[]),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(300),s=function(e,t){return e===t};t.default=function(e,t){void 0===t&&(t=s);var n=a.useRef(),r=a.useRef(e);return i.useFirstMountState()||t(r.current,e)||(n.current=r.current,r.current=e),n.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(207));t.default=function(){var e=s.default();return i.useCallback((function(t){return new Promise((function(n,a){t.then((function(t){e()&&n(t)}),(function(t){e()&&a(t)}))}))}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){void 0===e&&(e=[]);var t=i.useState(e),n=t[0],s=t[1];return{add:function(e){s((function(t){return a.__spreadArrays(t,[e])}))},remove:function(){var e;return s((function(t){var n=t[0],a=t.slice(1);return e=n,a})),e},get first(){return n[0]},get last(){return n[n.length-1]},get size(){return n.length}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useRef(null),i=a.useRef(!1),s=a.useRef(e);s.current=e;var r=a.useCallback((function(e){i.current&&(s.current(e),n.current=requestAnimationFrame(r))}),[]),o=a.useMemo((function(){return[function(){i.current&&(i.current=!1,n.current&&cancelAnimationFrame(n.current))},function(){i.current||(i.current=!0,n.current=requestAnimationFrame(r))},function(){return i.current}]}),[]);return a.useEffect((function(){return t&&o[1](),o[0]}),[]),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e,t){return new URLSearchParams(e).get(t)};t.default="object"==typeof window?function(e){var t=window.location,n=a.useState((function(){return i(t.search,e)})),s=n[0],r=n[1];return a.useEffect((function(){var n=function(){r(i(t.search,e))};return window.addEventListener("popstate",n),window.addEventListener("pushstate",n),window.addEventListener("replacestate",n),function(){window.removeEventListener("popstate",n),window.removeEventListener("pushstate",n),window.removeEventListener("replacestate",n)}}),[]),s}:function(){return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScratchSensor=void 0;var a=n(38),i=n(2),s=n(830),r=a.__importDefault(n(506)),o=function(){},l=function(e){void 0===e&&(e={});var t=e.disabled,n=r.default(e),s=i.useState({isScratching:!1}),l=s[0],u=s[1],c=i.useRef(l),d=i.useRef(!1),m=i.useRef(null),p=i.useState(null),f=p[0],b=p[1];return i.useEffect((function(){if(!t&&f){var e,i,s=function(e,t){cancelAnimationFrame(m.current),m.current=requestAnimationFrame((function(){var i=f.getBoundingClientRect(),s=i.left,r=i.top,l=s+window.scrollX,d=r+window.scrollY,m=e-l,p=t-d;u((function(e){var t=a.__assign(a.__assign({},e),{dx:m-(e.x||0),dy:p-(e.y||0),end:Date.now(),isScratching:!0});return c.current=t,(n.current.onScratch||o)(t),t}))}))},r=function(e){s(e.pageX,e.pageY)},l=function(e){s(e.changedTouches[0].pageX,e.changedTouches[0].pageY)},p=function(){d.current&&(d.current=!1,c.current=a.__assign(a.__assign({},c.current),{isScratching:!1}),(n.current.onScratchEnd||o)(c.current),u({isScratching:!1}),window.removeEventListener("mousemove",r),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i))};e=p,i=p;var b=function(t,a){if(d.current){var s=f.getBoundingClientRect(),m=s.left,p=s.top,b=m+window.scrollX,g=p+window.scrollY,v=t-b,y=a-g,h=Date.now(),j={isScratching:!0,start:h,end:h,docX:t,docY:a,x:v,y:y,dx:0,dy:0,elH:f.offsetHeight,elW:f.offsetWidth,elX:b,elY:g};c.current=j,(n.current.onScratchStart||o)(j),u(j),window.addEventListener("mousemove",r),window.addEventListener("touchmove",l),window.addEventListener("mouseup",e),window.addEventListener("touchend",i)}},g=function(e){d.current=!0,b(e.pageX,e.pageY)},v=function(e){d.current=!0,b(e.changedTouches[0].pageX,e.changedTouches[0].pageY)};return f.addEventListener("mousedown",g),f.addEventListener("touchstart",v),function(){f.removeEventListener("mousedown",g),f.removeEventListener("touchstart",v),window.removeEventListener("mousemove",r),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i),m.current&&cancelAnimationFrame(m.current),m.current=null,d.current=!1,c.current={isScratching:!1},u(c.current)}}}),[f,t,n]),[b,l]};t.ScratchSensor=function(e){e.children;var t=a.__rest(e,["children"]),n=l(t),r=n[0],o=n[1],u=s.render(e,o);return i.cloneElement(u,a.__assign(a.__assign({},u.props),{ref:function(e){u.props.ref&&("object"==typeof u.props.ref&&(u.props.ref.current=e),"function"==typeof u.props.ref&&u.props.ref(e)),r(e)}}))},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hookToRenderProp=t.createEnhancer=t.render=void 0;var a=n(38),i=a.__importDefault(n(512));t.render=i.default;var s=a.__importDefault(n(831));t.createEnhancer=s.default;var r=a.__importDefault(n(834));t.hookToRenderProp=r.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.divWrapper=void 0;var a=n(38),i=a.__importStar(n(2)),s=a.__importDefault(n(832)),r=i.createElement,o=function(e,t,n,i){var s;return r(e,t?a.__assign(((s={})[t]=i,s),n):a.__assign(a.__assign({},i),n))};t.divWrapper=function(e,t,n,a){return r("div",null,o(e,t,n,a))},t.default=function(e,t,n){void 0===n&&(n=o);var a=function(i,o,l){void 0===o&&(o=t),void 0===l&&(l=null);var u="string"==typeof i;if(u)return function(e){return a(e,i||t,o)};var c=function(t){return r(e,l,(function(e){return n(i,o,t,e)}))};return u?s.default(c):c};return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(833));t.default=function(e){return e.prototype?e:a.default(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importStar(n(2));t.default=function(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(n,t),n.prototype.render=function(){return e(this.props,this.context)},n}(i.Component);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(512)),i=function(e){return[e]};t.default=function(e,t){return void 0===t&&(t=i),function(n){return a.default(n,e.apply(void 0,t(n)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(257));t.default=function(e){var t=s.default({x:0,y:0}),n=t[0],a=t[1];return i.useEffect((function(){var t=function(){e.current&&a({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&e.current.addEventListener("scroll",t,{capture:!1,passive:!0}),function(){e.current&&e.current.removeEventListener("scroll",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useState(!1),n=t[0],i=t[1];return a.useEffect((function(){if(e.current){var t,n=function(){i(!0),clearTimeout(t),t=setTimeout((function(){i(!1)}),150)};return e.current.addEventListener("scroll",n,!1),function(){e.current&&e.current.removeEventListener("scroll",n,!1)}}return function(){}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131);t.default=function(e,t,n){if(!i.isClient)return[t,function(){}];var s=a.useState((function(){try{var a=sessionStorage.getItem(e);return"string"!=typeof a?(sessionStorage.setItem(e,n?String(t):JSON.stringify(t)),t):n?a:JSON.parse(a||"null")}catch(e){return t}})),r=s[0],o=s[1];return a.useEffect((function(){try{var t=n?String(r):JSON.stringify(r);sessionStorage.setItem(e,t)}catch(e){}})),[r,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(839),s=a.__importDefault(n(375)),r=function(e,t){return e.every((function(e,n){return i.equal(e,t[n])}))};t.default=function(e,t){s.default(e,t,r)}},function(e,t){var n=Object.keys;t.equal=function(e,t){if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;for(var a=n(e),i=a.length,s=0;s<i;s++)if(!(a[s]in t))return!1;for(s=0;s<i;s++)if(e[a[s]]!==t[a[s]])return!1;return i===n(t).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importStar(n(2)),s=n(131),r=i.useState,o=i.useEffect,l=i.useRef;t.default=function(e,t){var n=void 0===t?{}:t,u=n.width,c=void 0===u?1/0:u,d=n.height,m=void 0===d?1/0:d;if(!s.isClient)return["function"==typeof e?e({width:c,height:m}):e,{width:c,height:m}];var p=r({width:c,height:m}),f=p[0],b=p[1];"function"==typeof e&&(e=e(f));var g=e.props.style||{},v=l(null),y=null,h=function(){var e=v.current,t=e?{width:e.offsetWidth,height:e.offsetHeight}:{width:c,height:m};b(t)},j=function(e){e.addEventListener("resize",h),setTimeout(h,35)};return o((function(){var e=v.current;if(e){if(e.contentWindow)y=e.contentWindow,j(y);else{var t=function(){e.removeEventListener("load",t),y=e.contentWindow,j(y)};e.addEventListener("load",t)}return function(){y&&y.removeEventListener&&y.removeEventListener("resize",h)}}}),[]),g.position="relative",[i.cloneElement.apply(i,a.__spreadArrays([e,{style:g}],a.__spreadArrays([i.createElement("iframe",{ref:v,style:{background:"transparent",border:"none",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:-1}})],i.Children.toArray(e.props.children)))),f]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=n(131),r=a.__importDefault(n(207)),o=a.__importDefault(n(255)),l=function(){};t.default=function(e,t){void 0===t&&(t={});var n=r.default(),a=i.useRef(!1),u=i.useRef(0),c=i.useRef(0),d=o.default({isSliding:!1,value:0}),m=d[0],p=d[1];return u.current=m.value,i.useEffect((function(){if(s.isClient){var i=void 0===t.styles||t.styles,r=void 0!==t.reverse&&t.reverse;e.current&&i&&(e.current.style.userSelect="none");var o=function(){!a.current&&n()&&((t.onScrubStart||l)(),a.current=!0,p({isSliding:!0}),v())},d=function(){a.current&&n()&&((t.onScrubStop||l)(u.current),a.current=!1,p({isSliding:!1}),y())},m=function(e){o(),f(e)},f=t.vertical?function(e){return h(e.clientY)}:function(e){return h(e.clientX)},b=function(e){o(),g(e)},g=t.vertical?function(e){return h(e.changedTouches[0].clientY)}:function(e){return h(e.changedTouches[0].clientX)},v=function(){s.on(document,"mousemove",f),s.on(document,"mouseup",d),s.on(document,"touchmove",g),s.on(document,"touchend",d)},y=function(){s.off(document,"mousemove",f),s.off(document,"mouseup",d),s.off(document,"touchmove",g),s.off(document,"touchend",d)},h=function(a){cancelAnimationFrame(c.current),c.current=requestAnimationFrame((function(){if(n()&&e.current){var i=e.current.getBoundingClientRect(),s=t.vertical?i.top:i.left,o=t.vertical?i.height:i.width;if(!o)return;var u=(a-s)/o;u>1?u=1:u<0&&(u=0),r&&(u=1-u),p({value:u}),(t.onScrub||l)(u)}}))};return s.on(e.current,"mousedown",m),s.on(e.current,"touchstart",b),function(){s.off(e.current,"mousedown",m),s.off(e.current,"touchstart",b)}}}),[e,t.vertical]),m}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(509)),r=a.__importDefault(n(255)),o="object"==typeof window&&"object"==typeof window.speechSynthesis?window.speechSynthesis.getVoices():[];t.default=function(e,t){void 0===t&&(t={});var n=r.default({isPlaying:!1,lang:t.lang||"default",voice:t.voice||o[0],rate:t.rate||1,pitch:t.pitch||1,volume:t.volume||1}),a=n[0],l=n[1],u=i.useRef(null);return s.default((function(){var n=new SpeechSynthesisUtterance(e);t.lang&&(n.lang=t.lang),t.voice&&(n.voice=t.voice),n.rate=t.rate||1,n.pitch=t.pitch||1,n.volume=t.volume||1,n.onstart=function(){return l({isPlaying:!0})},n.onresume=function(){return l({isPlaying:!0})},n.onend=function(){return l({isPlaying:!1})},n.onpause=function(){return l({isPlaying:!1})},u.current=n,window.speechSynthesis.speak(u.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(40));t.default=function(e){a.default((function(){var t=function(t){var n,a,i,s,r;!function(){var e=document.activeElement,t=document.body;if(!e)return!1;if(e===t)return!1;switch(e.tagName){case"INPUT":case"TEXTAREA":return!0}return e.hasAttribute("contenteditable")}()&&(a=(n=t).keyCode,i=n.metaKey,s=n.ctrlKey,r=n.altKey,!(i||s||r)&&(a>=48&&a<=57||a>=65&&a<=90))&&e(t)};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStateWithHistory=void 0;var a=n(2),i=n(300),s=n(301);t.useStateWithHistory=function(e,t,n){if(void 0===t&&(t=10),t<1)throw new Error("Capacity has to be greater than 1, got '"+t+"'");var r=i.useFirstMountState(),o=a.useState(e),l=o[0],u=o[1],c=a.useRef(null!=n?n:[]),d=a.useRef(0);return r&&(c.current.length?(c.current[c.current.length-1]!==e&&c.current.push(e),c.current.length>t&&(c.current=c.current.slice(c.current.length-t))):c.current.push(e),d.current=c.current.length&&c.current.length-1),[l,a.useCallback((function(e){u((function(n){return(e=s.resolveHookState(e))!==n&&(d.current<c.current.length-1&&(c.current=c.current.slice(0,d.current+1)),d.current=c.current.push(e)-1,c.current.length>t&&(c.current=c.current.slice(c.current.length-t))),e}))}),[l,t]),a.useMemo((function(){return{history:c.current,position:d.current,capacity:t,back:function(e){void 0===e&&(e=1),d.current&&u((function(){return d.current-=Math.min(e,d.current),c.current[d.current]}))},forward:function(e){void 0===e&&(e=1),d.current!==c.current.length-1&&u((function(){return d.current=Math.min(d.current+e,c.current.length-1),c.current[d.current]}))},go:function(e){e!==d.current&&u((function(){return d.current=e<0?Math.max(c.current.length+e,0):Math.min(c.current.length-1,e),c.current[d.current]}))}}}),[l])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(207)),r=a.__importDefault(n(223)),o=a.__importDefault(n(254));t.default=function(e){void 0===e&&(e=[]);var t=s.default(),n=r.default(),l=i.useRef(0);o.default((function(){e.length<=l.current&&(l.current=e.length-1,n())}),[e.length]);var u=i.useMemo((function(){return{next:function(){return u.setStateAt(l.current+1)},prev:function(){return u.setStateAt(l.current-1)},setStateAt:function(a){t()&&e.length&&a!==l.current&&(l.current=a>=0?a%e.length:e.length+a%e.length,n())},setState:function(a){if(t()){var i=e.length?e.indexOf(a):-1;if(-1===i)throw new Error("State '"+a+"' is not a valid state (does not exist in state list)");l.current=i,n()}}}}),[e]);return a.__assign({state:e[l.current],currentIndex:l.current},u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(303));t.default=function(e,t){void 0===t&&(t=200);var n=i.useState(e),a=n[0],r=n[1],o=i.useRef(),l=i.useRef(null),u=i.useRef(0);return i.useEffect((function(){if(o.current)l.current=e,u.current=!0;else{r(e);var n=function(){u.current?(u.current=!1,r(l.current),o.current=setTimeout(n,t)):o.current=void 0};o.current=setTimeout(n,t)}}),[e]),s.default((function(){o.current&&clearTimeout(o.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(303));t.default=function(e,t,n){void 0===t&&(t=200);var a=i.useState(null),r=a[0],o=a[1],l=i.useRef(),u=i.useRef();return i.useEffect((function(){if(l.current)u.current=n;else{o(e.apply(void 0,n));var a=function(){u.current?(o(e.apply(void 0,u.current)),u.current=void 0,l.current=setTimeout(a,t)):l.current=void 0};l.current=setTimeout(a,t)}}),n),s.default((function(){l.current&&clearTimeout(l.current)})),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(376)),s=a.__importDefault(n(223));t.default=function(e){void 0===e&&(e=0);var t=s.default();return i.default(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i={restoreOnUnmount:!1};t.default="undefined"!=typeof document?function(e,t){void 0===t&&(t=i);var n=a.useRef(document.title);document.title=e,a.useEffect((function(){return t&&t.restoreOnUnmount?function(){document.title=n.current}:void 0}),[])}:function(e){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(1092),s=a.__importDefault(n(511));t.default=function(e,t,n){return void 0===e&&(e="inCirc"),void 0===t&&(t=200),void 0===n&&(n=0),(0,i.easing[e])(s.default(t,n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useRef(!1);return a.useEffect((function(){return function(){e.current=!0}})),a.useMemo((function(){return function(t,n){return new Promise((function(a,i){t.then((function(t){e.current||a(t)}),(function(t){e.current?n?n(t):console.error("useUnmountPromise",t):i(t)}))}))}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(508));t.default=function(e,t){void 0===t&&(t=[]);var n=i.default(t),s=n[0],r=n[1];return[s,a.__assign(a.__assign({},r),{upsert:function(t){r.upsert(e,t)}})]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i="object"==typeof navigator&&"vibrate"in navigator;t.default=i?function(e,t,n){void 0===e&&(e=!0),void 0===t&&(t=[1e3,1e3]),void 0===n&&(n=!0),a.useEffect((function(){var a;if(e&&(navigator.vibrate(t),n)){var i=t instanceof Array?t.reduce((function(e,t){return e+t})):t;a=setInterval((function(){navigator.vibrate(t)}),i)}return function(){e&&(navigator.vibrate(0),n&&clearInterval(a))}}),[e])}:function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(499)).default("video");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){void 0===n&&(n=[void 0]);var i=a.useRef(t),s=a.useRef(e);i.current=t,s.current=e;var r=a.useState(n),o=r[0],l=r[1],u=a.useCallback((function(){i.current.length>=2?i.current(s.current,l):l(i.current(s.current))}),[l]);return a.useEffect((function(){u()}),[e]),[o,u]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useScrollbarWidth=void 0;var a=n(857),i=n(2);t.useScrollbarWidth=function(){var e=i.useState(a.scrollbarWidth()),t=e[0],n=e[1];return i.useEffect((function(){if(void 0===t){var e=requestAnimationFrame((function(){n(a.scrollbarWidth())}));return function(){return cancelAnimationFrame(e)}}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if("undefined"==typeof document)return 0;if(document.body&&(!document.readyState||"loading"!==document.readyState)){if(!0!==e&&"number"==typeof a.__cache)return a.__cache;var t=document.createElement("div"),n=t.style;n.display="block",n.position="absolute",n.width="100px",n.height="100px",n.left="-999px",n.top="-999px",n.overflow="scroll",document.body.insertBefore(t,null);var i=t.clientWidth;if(0!==i)return a.__cache=100-i,document.body.removeChild(t),a.__cache;document.body.removeChild(t)}};t.scrollbarWidth=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMultiStateValidator=void 0;var a=n(2);t.useMultiStateValidator=function(e,t,n){if(void 0===n&&(n=[void 0]),"object"!=typeof e)throw new Error("states expected to be an object or array, got "+typeof e);var i=a.useRef(t),s=a.useRef(e);i.current=t,s.current=e;var r=a.useState(n),o=r[0],l=r[1],u=a.useCallback((function(){i.current.length>=2?i.current(s.current,l):l(i.current(s.current))}),[l]);return a.useEffect((function(){u()}),Object.values(e)),[o,u]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=n(131),r=a.__importDefault(n(257));t.default=function(){var e=r.default({x:s.isClient?window.pageXOffset:0,y:s.isClient?window.pageYOffset:0}),t=e[0],n=e[1];return i.useEffect((function(){var e=function(){n({x:window.pageXOffset,y:window.pageYOffset})};return window.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){window.removeEventListener("scroll",e)}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(257)),r=n(131);t.default=function(e,t){void 0===e&&(e=1/0),void 0===t&&(t=1/0);var n=s.default({width:r.isClient?window.innerWidth:e,height:r.isClient?window.innerHeight:t}),a=n[0],o=n[1];return i.useEffect((function(){if(r.isClient){var e=function(){o({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),s=a.__importDefault(n(40)),r=n(131),o={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};t.default=r.isClient&&window.ResizeObserver?function(){var e=i.useState(null),t=e[0],n=e[1],a=i.useState(o),r=a[0],l=a[1],u=i.useMemo((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,a=t.y,i=t.width,s=t.height,r=t.top,o=t.left,u=t.bottom,c=t.right;l({x:n,y:a,width:i,height:s,top:r,left:o,bottom:u,right:c})}}))}),[]);return s.default((function(){if(t)return u.observe(t),function(){u.disconnect()}}),[t]),[n,r]}:function(){return[function(){},o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRendersCount=void 0;var a=n(2);t.useRendersCount=function(){return++a.useRef(0).current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){void 0===e&&(e=new Set);var t=i.useState(e),n=t[0],s=t[1],r=i.useMemo((function(){return{add:function(e){return s((function(t){return new Set(a.__spreadArrays(Array.from(t),[e]))}))},remove:function(e){return s((function(t){return new Set(Array.from(t).filter((function(t){return t!==e})))}))},toggle:function(e){return s((function(t){return t.has(e)?new Set(Array.from(t).filter((function(t){return t!==e}))):new Set(a.__spreadArrays(Array.from(t),[e]))}))},reset:function(){return s(e)}}}),[s]),o=a.__assign({has:i.useCallback((function(e){return n.has(e)}),[n])},r);return[n,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGlobalState=void 0;var a=n(38),i=n(2),s=a.__importDefault(n(256)),r=a.__importDefault(n(40));function o(e){var t={state:e,setState:function(e){t.state=e,t.setters.forEach((function(e){return e(t.state)}))},setters:[]};return function(){var e=i.useState(t.state),n=e[0],a=e[1];return s.default((function(){return function(){t.setters=t.setters.filter((function(e){return e!==a}))}})),r.default((function(){t.setters.includes(a)||t.setters.push(a)})),[n,t.setState]}}t.createGlobalState=o,t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useHash=void 0;var a=n(38),i=n(2),s=a.__importDefault(n(507));t.useHash=function(){var e=i.useState((function(){return window.location.hash})),t=e[0],n=e[1],a=i.useCallback((function(){n(window.location.hash)}),[]);s.default((function(){window.addEventListener("hashchange",a)}),(function(){window.removeEventListener("hashchange",a)}));var r=i.useCallback((function(e){e!==t&&(window.location.hash=e)}),[t]);return[t,r]}},,,function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI1NnB4IiBoZWlnaHQ9IjI1NXB4IiB2aWV3Qm94PSIwIDAgMjU2IDI1NSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjU1LjIxNDYxNywwLjI1NzU4MDI0NyBMMjU1LjIxNDYxNyw2My45OTM2NzkgTDE5MS42MDk2NzksMTI3LjU5ODYxNyBMMTkxLjYwOTY3OSw2My43Mjk3Nzc4IEwyNTUuMjE0NjE3LDAuMjU3NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTEyOC4wMDYzMjEsMC4yNTc1ODAyNDcgTDEyOC4wMDYzMjEsNjMuOTkzNjc5IEwxOTEuNjExMjU5LDEyNy41OTg2MTcgTDE5MS42MTEyNTksNjMuNzI5Nzc3OCBMMTI4LjAwNjMyMSwwLjI1NzU4MDI0NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDI1NC44MDM3NTMgTDE5MS42MDk2NzksMjU0LjgwMzc1MyBMMTI4LjAwNDc0MSwxOTEuMTk4ODE1IEwxOTEuODcyLDE5MS4xOTg4MTUgTDI1NS4zNDU3NzgsMjU0LjgwMzc1MyIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDEyNy41OTU0NTcgTDE5MS42MDk2NzksMTI3LjU5NTQ1NyBMMTI4LjAwNDc0MSwxOTEuMjAwMzk1IEwxOTEuODcyLDE5MS4yMDAzOTUgTDI1NS4zNDU3NzgsMTI3LjU5NTQ1NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjgwMTE4NTE4NSwyNTQuOTM2NDk0IEwwLjgwMTE4NTE4NSwxOTEuMTk4ODE1IEw2NC40MDYxMjM1LDEyNy41OTM4NzcgTDY0LjQwNjEyMzUsMTkxLjQ2MjcxNiBMMC44MDExODUxODUsMjU0LjkzNjQ5NCIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0xMjguMDA5NDgxLDI1NC45MzY0OTQgTDEyOC4wMDk0ODEsMTkxLjE5ODgxNSBMNjQuNDA0NTQzMiwxMjcuNTkzODc3IEw2NC40MDQ1NDMyLDE5MS40NjI3MTYgTDEyOC4wMDk0ODEsMjU0LjkzNjQ5NCIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjY3MTYwNDkzOCwwLjM4NTU4MDI0NyBMNjQuNDA3NzAzNywwLjM4NTU4MDI0NyBMMTI4LjAxMjY0Miw2My45OTA1MTg1IEw2NC4xNDUzODI3LDYzLjk5MDUxODUgTDAuNjcxNjA0OTM4LDAuMzg1NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTAuNjcxNjA0OTM4LDEyNy41OTM4NzcgTDY0LjQwNzcwMzcsMTI3LjU5Mzg3NyBMMTI4LjAxMjY0Miw2My45ODg5MzgzIEw2NC4xNDUzODI3LDYzLjk4ODkzODMgTDAuNjcxNjA0OTM4LDEyNy41OTM4NzciIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KCTwvZz4KPC9zdmc+Cg=="},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(870);n(23),n(2),n(518),n(13),n(269),n(268),n(519);var i=a.default.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){i[e]=i(e)})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(23),i=n(2),s=n(518),r=n(13),o=n(269),l=n(268),u=n(519);function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var m=d(i),p=c(s).default,f=function(e){return"theme"!==e},b=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?p:f},g=function(e,t,n){var a;if(t){var i=t.shouldForwardProp;a=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!=typeof a&&n&&(a=e.__emotion_forwardProp),a},v="undefined"!=typeof document,y=function(e){var t=e.cache,n=e.serialized,a=e.isStringTag;o.registerStyles(t,n,a);var i=u.useInsertionEffectAlwaysWithSyncFallback((function(){return o.insertStyles(t,n,a)}));if(!v&&void 0!==i){for(var s,r=n.name,l=n.next;void 0!==l;)r+=" "+l.name,l=l.next;return m.createElement("style",((s={})["data-emotion"]=t.key+" "+r,s.dangerouslySetInnerHTML={__html:i},s.nonce=t.sheet.nonce,s))}return null};t.default=function e(t,n){var i,s,u=t.__emotion_real===t,c=u&&t.__emotion_base||t;void 0!==n&&(i=n.label,s=n.target);var d=g(t,n,u),p=d||b(c),f=!p("as");return function(){var v=arguments,h=u&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&h.push("label:"+i+";"),null==v[0]||void 0===v[0].raw)h.push.apply(h,v);else{h.push(v[0][0]);for(var j=v.length,E=1;E<j;E++)h.push(v[E],v[0][E])}var O=r.withEmotionCache((function(e,t,n){var a=f&&e.as||c,i="",u=[],g=e;if(null==e.theme){for(var v in g={},e)g[v]=e[v];g.theme=m.useContext(r.ThemeContext)}"string"==typeof e.className?i=o.getRegisteredStyles(t.registered,u,e.className):null!=e.className&&(i=e.className+" ");var j=l.serializeStyles(h.concat(u),t.registered,g);i+=t.key+"-"+j.name,void 0!==s&&(i+=" "+s);var E=f&&void 0===d?b(a):p,O={};for(var x in e)f&&"as"===x||E(x)&&(O[x]=e[x]);return O.className=i,O.ref=n,m.createElement(m.Fragment,null,m.createElement(y,{cache:t,serialized:j,isStringTag:"string"==typeof a}),m.createElement(a,O))}));return O.displayName=void 0!==i?i:"Styled("+("string"==typeof c?c:c.displayName||c.name||"Component")+")",O.defaultProps=t.defaultProps,O.__emotion_real=O,O.__emotion_base=c,O.__emotion_styles=h,O.__emotion_forwardProp=d,Object.defineProperty(O,"toString",{value:function(){return"."+s}}),O.withComponent=function(t,i){return e(t,a({},n,i,{shouldForwardProp:g(O,i,!0)})).apply(void 0,h)},O}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(418);function i(e){return e&&e.__esModule?e:{default:e}}var s=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,r=i(a).default((function(e){return s.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));t.default=r},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),s="undefined"!=typeof document,r=!!i.useInsertionEffect&&i.useInsertionEffect,o=s&&r||function(e){return e()},l=r||i.useLayoutEffect;t.useInsertionEffectAlwaysWithSyncFallback=o,t.useInsertionEffectWithLayoutFallback=l},function(e,t,n){"use strict";var a=n(513),i=n(2);function s(e,t,n){return e[t]?e[t][0]?e[t][0][n]:e[t][n]:"contentBoxSize"===t?e.contentRect["inlineSize"===n?"width":"height"]:void 0}e.exports=function(e){void 0===e&&(e={});var t=e.onResize,n=i.useRef(void 0);n.current=t;var r=e.round||Math.round,o=i.useRef(),l=i.useState({width:void 0,height:void 0}),u=l[0],c=l[1],d=i.useRef(!1);i.useEffect((function(){return d.current=!1,function(){d.current=!0}}),[]);var m=i.useRef({width:void 0,height:void 0}),p=function(e,t){var n=i.useRef(null),a=i.useRef(null);a.current=t;var s=i.useRef(null);i.useEffect((function(){r()}));var r=i.useCallback((function(){var t=s.current,i=a.current,r=t||(i?i instanceof Element?i:i.current:null);n.current&&n.current.element===r&&n.current.subscriber===e||(n.current&&n.current.cleanup&&n.current.cleanup(),n.current={element:r,subscriber:e,cleanup:r?e(r):void 0})}),[e]);return i.useEffect((function(){return function(){n.current&&n.current.cleanup&&(n.current.cleanup(),n.current=null)}}),[]),i.useCallback((function(e){s.current=e,r()}),[r])}(i.useCallback((function(t){return o.current&&o.current.box===e.box&&o.current.round===r||(o.current={box:e.box,round:r,instance:new a.ResizeObserver((function(t){var a=t[0],i="border-box"===e.box?"borderBoxSize":"device-pixel-content-box"===e.box?"devicePixelContentBoxSize":"contentBoxSize",o=s(a,i,"inlineSize"),l=s(a,i,"blockSize"),u=o?r(o):void 0,p=l?r(l):void 0;if(m.current.width!==u||m.current.height!==p){var f={width:u,height:p};m.current.width=u,m.current.height=p,n.current?n.current(f):d.current||c(f)}}))}),o.current.instance.observe(t,{box:e.box}),function(){o.current&&o.current.instance.unobserve(t)}}),[e.box,r]),e.ref);return i.useMemo((function(){return{ref:p,width:u.width,height:u.height}}),[p,u.width,u.height])}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(2),i=n(50),s=n(163),r=n(326),o=n(337);const l=["POST",r.e],u=e=>Object(i.useQuery)(l,(async({signal:e})=>await Object(s.w)({signal:e})),{...o.a,...e}),c=()=>{const e=Object(i.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(2),i=n(50),s=n(163),r=n(326),o=n(337);const l=["POST",r.f],u=e=>Object(i.useQuery)(l,(async({signal:e})=>await Object(s.x)({signal:e})),{...o.a,...e}),c=()=>{const e=Object(i.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(45),i=n(2),s=n(117),r=n(110),o=n(21),l=n(1129),u=n(5);const c=u.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),d=u.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),m=u.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),p=()=>{const{telemetry:e}=Object(r.i)().services,{addError:t}=Object(s.a)(),[n,a]=Object(i.useState)(!1);return{enableDatafeed:Object(i.useCallback)((async(n,i)=>{if(a(!0),Object(o.h)(o.a.COUNT,n.isElasticJob?o.c.SIEM_JOB_ENABLED:o.c.CUSTOM_JOB_ENABLED),!n.isInstalled)try{await Object(l.c)({configTemplate:n.moduleId,indexPatternName:n.defaultIndexPattern,jobIdErrorFilter:[n.id],groups:n.groups}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,moduleId:n.moduleId,status:o.b.moduleInstalled})}catch(i){return a(!1),t(i,{title:m}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,moduleId:n.moduleId,status:o.b.installationError,errorMessage:`${m} - ${i.message}`}),{enabled:!1}}const s=new Date,r=s.setDate(s.getDate()-14),u=`datafeed-${n.id}`,d=Math.max(i,r);try{var p;const t=await Object(l.d)({datafeedIds:[u],start:d});if(null!==(p=t[u])&&void 0!==p&&p.error)throw new Error(t[u].error);return e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.started}),{enabled:!!t[u]&&t[u].started}}catch(a){Object(o.h)(o.a.COUNT,o.c.JOB_ENABLE_FAILURE),t(a,{title:c}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.startError,errorMessage:`${c} - ${a.message}`})}finally{a(!1)}return{enabled:!1}}),[t,e]),disableDatafeed:Object(i.useCallback)((async n=>{Object(o.h)(o.a.COUNT,n.isElasticJob?o.c.SIEM_JOB_DISABLED:o.c.CUSTOM_JOB_DISABLED),a(!0);const i=`datafeed-${n.id}`;try{const[t]=await Object(l.e)({datafeedIds:[i]});if(f(t))throw new Error(t.error);return e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.stopped}),{enabled:!t[i]||!t[i].stopped}}catch(a){Object(o.h)(o.a.COUNT,o.c.JOB_DISABLE_FAILURE),t(a,{title:d}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.stopError,errorMessage:`${d} - ${a.message}`})}finally{a(!1)}return{enabled:!0}}),[t,e]),isLoading:n}},f=e=>!Object(a.isEmpty)(e.error)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(24)(191)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(44),i=n.n(a),s=n(2),r=n.n(s),o=n(17),l=n(232);const u=i()(o.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-g8lc0e-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);u.displayName="StaticSwitch";const c=({job:e,isSecurityJobsLoading:t,onJobStateChange:n})=>{const[a,i]=Object(s.useState)(!1),c=Object(s.useCallback)((async t=>{i(!0),await n(e,e.latestTimestampMs||0,t.target.checked),i(!1)}),[e,i,n]);return r.a.createElement(o.EuiFlexGroup,{justifyContent:"spaceAround"},r.a.createElement(o.EuiFlexItem,{grow:!1},t||a||Object(l.b)(e.jobState,e.datafeedState)?r.a.createElement(o.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):r.a.createElement(u,{"data-test-subj":"job-switch",disabled:Object(l.a)(e.jobState,e.datafeedState),checked:Object(l.c)(e.jobState,e.datafeedState),onChange:c,showLabel:!1,label:""})))};c.displayName="JobSwitchComponent";const d=r.a.memo(c);d.displayName="JobSwitch"},,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),s=n(44),r=n.n(s),o=n(17);const l=r.a.div.withConfig({displayName:"StatusTextWrapper",componentId:"sc-1nku0d-0"})(["width:100%;display:inline-grid;"]),u=({tooltipContent:e,children:t,healthColor:n,dataTestSubj:a})=>i.a.createElement(o.EuiToolTip,{content:e},i.a.createElement(o.EuiHealth,{color:n,"data-test-subj":a},i.a.createElement(l,null,i.a.createElement("span",{className:"eui-textTruncate"},t))));u.displayName="HealthTruncateText"},,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(2),i=n(5),s=n(48),r=n(128),o=n(112),l=n(121),u=n(116),c=n(334),d=n(117),m=n(110),p=n(477),f=n(149);const b=()=>{const{indicesExist:e,dataViewId:t}=Object(l.d)(u.SourcererScopeName.detections),{indexFieldsSearch:n}=Object(c.b)(),b=Object(s.useDispatch)(),{addError:g}=Object(d.a)(),v=Object(a.useRef)(new AbortController),{data:{dataViews:y}}=Object(m.i)().services,h=Object(a.useMemo)((()=>r.e.defaultDataViewSelector()),[]),j=Object(a.useMemo)((()=>r.e.signalIndexNameSelector()),[]),E=Object(o.a)(j),O=Object(o.a)(h),x=Object(a.useMemo)((()=>!O.title.includes(`${E}`)),[O.title,E]),S=Object(a.useMemo)((()=>!e&&!x),[e,x]),k=Object(a.useCallback)((()=>{null!==E&&(v.current.abort(),(async()=>{v.current=new AbortController;try{const e=await Object(p.a)({body:{patternList:O.title.split(",")},signal:v.current.signal,dataViewId:t,dataViewService:y});null!==E&&null!=e&&e.defaultDataView.patternList.includes(E)&&(n({dataViewId:e.defaultDataView.id}),b(f.a.setSourcererDataViews(e)))}catch(e){"AbortError"===e.name||g(e,{title:i.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:i.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[g,t,y,O.title,b,n,E]);return{...S?{pollForSignalIndex:k}:{},signalIndexNeedsInit:x}}},,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(50),i=(n(2),n(110));const s=["POST","/api/ml/jobs/jobs_summary"],r=(e,t)=>Object(a.useQuery)([s,e],(async({signal:t})=>(async({jobIds:e,signal:t})=>i.b.get().http.fetch("/internal/ml/jobs/jobs_summary",{method:"POST",version:"1",body:JSON.stringify({jobIds:null!=e?e:[]}),asSystemRequest:!0,signal:t}))({signal:t,...e})),{refetchIntervalInBackground:!1,staleTime:3e5,retry:!1,...t})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return g}));var a=n(50),i=n(2),s=n(27),r=n(135),o=n(110),l=n(70),u=n(163),c=n(885),d=n(604),m=n(886);const p=["POST",l.EPM_API_ROUTES.BULK_INSTALL_PATTERN],f=["POST",l.EPM_API_ROUTES.INSTALL_FROM_REGISTRY_PATTERN],b=()=>{const e=Object(o.i)(),t=Object(r.a)().endpointPrivileges.canAccessFleet,{mutate:n}=(e=>{const t=Object(d.b)(),n=Object(c.b)(),i=Object(m.b)();return Object(a.useMutation)((e=>Object(u.c)(e)),{...e,mutationKey:p,onSettled:(...e)=>{const a=e[0],r=null==a?void 0:a.items.find((e=>e.name===s.d));r&&"result"in r&&"installed"===r.result.status&&(t(),n(),i())}})})(),{mutate:l}=(e=>{const t=Object(d.b)(),n=Object(c.b)(),i=Object(m.b)();return Object(a.useMutation)((e=>Object(u.o)(e)),{...e,mutationKey:f,onSettled:(...e)=>{const{packageName:a}=e[2];a===s.d&&(t(),n(),i())}})})();Object(i.useEffect)((()=>{t&&(async t=>{await(null===(t=e.services.fleet)||void 0===t?void 0:t.isInitialized());const a="traditional"===o.b.getBuildFlavor()&&(o.b.getKibanaVersion().includes("-SNAPSHOT")||"main"===o.b.getKibanaBranch()),i=o.b.getPrebuiltRulesPackageVersion(),r=["endpoint",s.d];null!=i&&(l({packageName:s.d,packageVersion:i,prerelease:a,force:!0}),r.splice(r.indexOf(s.d),1)),n({packages:r,prerelease:a})})()}),[n,t,e.services.fleet,l])},g=()=>Object(a.useIsMutating)({predicate:({options:{mutationKey:e},state:{variables:t}})=>e===p?t.packages.includes(s.d):e===f&&t.packageName===s.d})>0},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Fe}));var a=n(17),i=n(2),s=n.n(i),r=n(48),o=n(5);const l=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutTitle",{defaultMessage:"Data view cannot be modified on this page"}),u=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTitle",{defaultMessage:"This timeline uses a legacy data view selector"}),c=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTemplateTitle",{defaultMessage:"This timeline template uses a legacy data view selector"}),d=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTitle",{defaultMessage:"This timeline is out of date with the Security Data View"}),m=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTemplateTitle",{defaultMessage:"This timeline template is out of date with the Security Data View"}),p=o.i18n.translate("xpack.securitySolution.indexPatterns.callOutTimelineTitle",{defaultMessage:"Data view cannot be modified when show only detection alerts is selected"}),f=o.i18n.translate("xpack.securitySolution.indexPatterns.toggleToNewSourcerer.link",{defaultMessage:"here"}),b=o.i18n.translate("xpack.securitySolution.indexPatterns.dataViewLabel",{defaultMessage:"Data view"}),g=o.i18n.translate("xpack.securitySolution.indexPatterns.updateDataView",{defaultMessage:"Would you like to add this index pattern to Security Data View? Otherwise, we can recreate the data view without the missing index patterns."}),v=o.i18n.translate("xpack.securitySolution.indexPatterns.updateSecurityDataView",{defaultMessage:"Update Security Data View"}),y=o.i18n.translate("xpack.securitySolution.indexPatterns.continue",{defaultMessage:"Continue without adding"}),h=o.i18n.translate("xpack.securitySolution.indexPatterns.add",{defaultMessage:"Add index pattern"}),j=o.i18n.translate("xpack.securitySolution.indexPatterns.modifiedBadgeTitle",{defaultMessage:"Modified"}),E=o.i18n.translate("xpack.securitySolution.indexPatterns.alertsBadgeTitle",{defaultMessage:"Alerts"}),O=o.i18n.translate("xpack.securitySolution.indexPatterns.updateAvailableBadgeTitle",{defaultMessage:"Update available"}),x=o.i18n.translate("xpack.securitySolution.indexPatterns.securityDefaultDataViewLabel",{defaultMessage:"Security Default Data View"}),S=o.i18n.translate("xpack.securitySolution.indexPatterns.securityDataViewLabel",{defaultMessage:"Security Data View"}),k=o.i18n.translate("xpack.securitySolution.indexPatterns.selectDataView",{defaultMessage:"Data view selection"}),w=o.i18n.translate("xpack.securitySolution.indexPatterns.save",{defaultMessage:"Save"}),T=o.i18n.translate("xpack.securitySolution.indexPatterns.chooseDataViewLabel",{defaultMessage:"Choose data view"}),C=o.i18n.translate("xpack.securitySolution.indexPatterns.advancedOptionsTitle",{defaultMessage:"Advanced options"}),M=o.i18n.translate("xpack.securitySolution.indexPatterns.indexPatternsLabel",{defaultMessage:"Index patterns"}),I=o.i18n.translate("xpack.securitySolution.indexPatterns.descriptionsLabel",{defaultMessage:"These are the index patterns currently selected. Filtering out index patterns from your data view can help improve overall performance."}),A=o.i18n.translate("xpack.securitySolution.sourcerer.disabled",{defaultMessage:"The updates to the Data view require a page reload to take effect."}),P=o.i18n.translate("xpack.securitySolution.indexPatterns.update",{defaultMessage:"Update and recreate data view"}),_=o.i18n.translate("xpack.securitySolution.indexPatterns.resetButton",{defaultMessage:"Reset"}),D=o.i18n.translate("xpack.securitySolution.indexPatterns.closeButton",{defaultMessage:"Close"}),R=o.i18n.translate("xpack.securitySolution.indexPatterns.inactive",{defaultMessage:"Inactive index patterns"}),F=o.i18n.translate("xpack.securitySolution.indexPatterns.noData",{defaultMessage:"The index pattern on this timeline doesn't match any data streams, indices, or index aliases."}),N=o.i18n.translate("xpack.securitySolution.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),L=o.i18n.translate("xpack.securitySolution.indexPatterns.onlyDetectionAlertsLabel",{defaultMessage:"Show only detection alerts"}),z=o.i18n.translate("xpack.securitySolution.indexPatterns.successToastTitle",{defaultMessage:"One or more settings require you to reload the page to take effect"}),B=o.i18n.translate("xpack.securitySolution.indexPatterns.reloadPageTitle",{defaultMessage:"Reload page"}),q=o.i18n.translate("xpack.securitySolution.indexPatterns.failureToastTitle",{defaultMessage:"Unable to update data view"});var V=n(149),$=n(112),U=n(116),Q=n(392),H=n(44),G=n.n(H),W=n(55);const K=G()(a.EuiFormRow).withConfig({displayName:"FormRow",componentId:"sc-1x3qwn3-0"})(["display:",";max-width:none;"],(({$expandAdvancedOptions:e})=>e?"flex":"none")),J=G()(a.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-1x3qwn3-1"})(["max-width:none;"]),Y=G()(a.EuiButtonEmpty).withConfig({displayName:"StyledButtonEmpty",componentId:"sc-1x3qwn3-2"})(["&:enabled:focus,&:focus{background-color:transparent;}"]),X=G()(a.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-1x3qwn3-3"})(["width:fit-content;&:enabled:focus,&:focus{background-color:transparent;}"]),Z=G.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-1x3qwn3-4"})(["width:600px;"]),ee=G()(a.EuiBadge).withConfig({displayName:"StyledBadge",componentId:"sc-1x3qwn3-5"})(["margin-left:",";&,.euiBadge__text{cursor:pointer;}"],W.euiThemeVars.euiSizeXS),te=G.a.span.withConfig({displayName:"Blockquote",componentId:"sc-1x3qwn3-6"})(["",""],(({theme:e})=>Object(H.css)(["display:block;border-color:",";border-left:",";margin:"," 0 "," ",";padding:",";"],e.eui.euiColorDarkShade,e.eui.euiBorderThick,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS))),ne=(e,t)=>e.filter((e=>e!==t));var ae=n(295),ie=n(110),se=n(554);const re=(e,t)=>Object(ae.b)(e).map((e=>({label:e,value:e,...null!=t?{disabled:!t.includes(e)}:{}})));var oe=n(47);const le=G()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-1e562tk-0"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]),ue=s.a.memo((({isShowing:e,onDismissModal:t,onContinue:n,onUpdate:i,missingPatterns:r})=>e?s.a.createElement(le,{onClose:t,"data-test-subj":"sourcerer-update-data-view-modal"},s.a.createElement(a.EuiModalHeader,null,s.a.createElement(a.EuiModalHeaderTitle,null,v)),s.a.createElement(a.EuiModalBody,null,s.a.createElement(a.EuiText,{size:"s"},s.a.createElement(a.EuiTextColor,{color:"subdued"},s.a.createElement("p",null,s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns",defaultMessage:"Security Data View is missing the following index patterns in order to recreate the previous timeline's data view: {callout}",values:{callout:s.a.createElement(te,null,r.join(", "))}}),g))),s.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(X,{"aria-label":y,"data-test-subj":"sourcerer-continue-close",flush:"left",onClick:n,title:y},y)),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiButton,{"data-test-subj":"sourcerer-update-data-view",fill:!0,fullWidth:!0,onClick:i,size:"s"},h))))):null));ue.displayName="UpdateDefaultDataViewModal";var ce=n(151),de=n(113),me=n(118),pe=n(134);const fe=({activePatterns:e,deadPatterns:t,selectedPatterns:n,timelineType:r})=>{const o=Object(i.useMemo)((()=>t.length>0?s.a.createElement(a.EuiToolTip,{content:s.a.createElement(be,{activePatterns:e,selectedPatterns:n,timelineType:r})},s.a.createElement(a.EuiIcon,{type:"questionInCircle",title:R})):null),[e,t.length,n,r]);return r===de.l.template?s.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatterns",defaultMessage:"The active index patterns in this timeline template are{tooltip}: {callout}",values:{tooltip:o,callout:s.a.createElement(te,null,e.join(", "))}})):s.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatterns",defaultMessage:"The active index patterns in this timeline are{tooltip}: {callout}",values:{tooltip:o,callout:s.a.createElement(te,null,e.join(", "))}}))},be=({activePatterns:e,selectedPatterns:t,timelineType:n})=>{const a=Object(i.useMemo)((()=>t.filter((t=>!e.includes(t))).join(", ")),[e,t]);return n===de.l.template?s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.noMatchData",defaultMessage:"The following index patterns are saved to this timeline template but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:a}}):s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.noMatchData",defaultMessage:"The following index patterns are saved to this timeline but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:a}})},ge=({timelineType:e,selectedPatterns:t})=>{const n=Object(i.useMemo)((()=>s.a.createElement(te,null,t.join(", "))),[t]);return e===de.l.template?s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatternsBad",defaultMessage:"The current index patterns in this timeline template are: {callout}",values:{callout:n}}):s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatternsBad",defaultMessage:"The current index patterns in this timeline are: {callout}",values:{callout:n}})},ve=({onReset:e,timelineType:t})=>t===de.l.template?s.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:s.a.createElement(a.EuiLink,{onClick:e},f)}})):s.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:s.a.createElement(a.EuiLink,{onClick:e},f)}})),ye=({onReset:e,timelineType:t})=>t===de.l.template?s.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timelineTemplate.description",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:s.a.createElement(a.EuiLink,{onClick:e},f)}})):s.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timeline.description",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:s.a.createElement(a.EuiLink,{onClick:e},f)}})),he={deprecated:{title:{[de.l.default]:u,[de.l.template]:c},update:P},missingPatterns:{title:{[de.l.default]:d,[de.l.template]:m},update:h}},je=s.a.memo((({activePatterns:e,indicesExist:t,isModified:n,onDismiss:r,onReset:o,onUpdate:l,selectedPatterns:u,missingPatterns:c})=>{const d=Object(i.useMemo)((()=>s.a.createElement(a.EuiButton,{"data-test-subj":"sourcerer-deprecated-update",fill:!0,fullWidth:!0,onClick:l,size:"s",disabled:!t},he[n].update)),[t,n,l]),m=Object(i.useMemo)((()=>t?d:s.a.createElement(a.EuiToolTip,{position:"top",content:F,"data-test-subj":"sourcerer-tooltip"},d)),[t,d]),p=e&&e.length>0?u.filter((t=>!e.includes(t))):[],f=Object(i.useMemo)((()=>me.b.getTimelineByIdSelector()),[]),b=Object($.a)((e=>{var t;return(null!==(t=f(e,ce.f.active))&&void 0!==t?t:pe.b).timelineType}));return s.a.createElement(s.a.Fragment,null,s.a.createElement(a.EuiCallOut,{color:"warning","data-test-subj":"sourcerer-deprecated-callout",iconType:"warning",size:"s",title:he[n].title[b]}),s.a.createElement(a.EuiSpacer,{size:"s"}),s.a.createElement(a.EuiText,{size:"s"},s.a.createElement(a.EuiTextColor,{color:"subdued"},s.a.createElement("p",null,e&&e.length>0?s.a.createElement(fe,{timelineType:b,activePatterns:e,deadPatterns:p,selectedPatterns:u}):s.a.createElement(ge,{timelineType:b,selectedPatterns:u}),"deprecated"===n&&s.a.createElement(ve,{timelineType:b,onReset:o}),"missingPatterns"===n&&s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-callout"},s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.callout",defaultMessage:"Security Data View is missing the following index patterns: {callout}",values:{callout:s.a.createElement(te,null,c.join(", "))}})),s.a.createElement(ye,{timelineType:b,onReset:o}))))),s.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(X,{"aria-label":D,"data-test-subj":"sourcerer-deprecated-close",flush:"left",onClick:r,title:D},D)),s.a.createElement(a.EuiFlexItem,{grow:!1},m)))}));je.displayName="TemporarySourcererComp";const Ee=s.a.memo((({activePatterns:e,indicesExist:t,isModified:n,missingPatterns:a,onContinueWithoutUpdate:i,onDismiss:r,onReset:o,onUpdateStepOne:l,onUpdateStepTwo:u,selectedPatterns:c,isShowingUpdateModal:d,onDismissModal:m})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(je,{activePatterns:e,indicesExist:t,isModified:n,missingPatterns:a,onDismiss:r,onReset:o,onUpdate:l,selectedPatterns:c}),s.a.createElement(ue,{isShowing:d,missingPatterns:a,onDismissModal:m,onContinue:i,onUpdate:u}))));Ee.displayName="TemporarySourcerer";var Oe=n(121),xe=n(63),Se=n(4);const ke=G()(a.EuiButton).withConfig({displayName:"StyledRefreshButton",componentId:"sc-nuholq-0"})(["float:right;"]),we=s.a.memo((()=>{const e=Object(i.useCallback)((()=>{document.location.reload()}),[]);return s.a.createElement(ke,{onClick:e,"data-test-subj":"page-refresh"},B)}));we.displayName="RefreshButton";var Te=n(117);const Ce=({activePatterns:e,disabled:t,isModified:n,isOnlyDetectionAlerts:r,isPopoverOpen:o,isTimelineSourcerer:l,loading:u,onClick:c,selectedPatterns:d,signalIndexName:m})=>{const p=Object(i.useMemo)((()=>{switch(n){case"modified":return s.a.createElement(ee,{"data-test-subj":"sourcerer-modified-badge"},j);case"alerts":return s.a.createElement(ee,{"data-test-subj":"sourcerer-alerts-badge"},E);case"deprecated":return s.a.createElement(ee,{color:"warning","data-test-subj":"sourcerer-deprecated-badge"},O);case"missingPatterns":return s.a.createElement(ee,{color:"warning","data-test-subj":"sourcerer-missingPatterns-badge"},O);default:return null}}),[n]),f=Object(i.useMemo)((()=>l?a.EuiButton:Y),[l]),g=Object(i.useMemo)((()=>s.a.createElement(f,{"aria-label":b,"data-test-subj":l?"timeline-sourcerer-trigger":"sourcerer-trigger",color:"primary",iconSide:"right",iconType:"arrowDown",disabled:t,isLoading:u,onClick:c,title:b},b,!t&&p)),[t,p,l,u,c,f]),v=Object(i.useMemo)((()=>t?A:(({isOnlyDetectionAlerts:e,isPopoverOpen:t,selectedPatterns:n,signalIndexName:a})=>t||e&&!a?null:(e?[a]:n).join(", "))({isOnlyDetectionAlerts:r,isPopoverOpen:o,selectedPatterns:null!=e?e:d,signalIndexName:m})),[e,t,r,o,d,m]);return v?s.a.createElement(a.EuiToolTip,{position:"top",content:v,"data-test-subj":"sourcerer-tooltip"},g):g},Me=Object(i.memo)(Ce),Ie=s.a.memo((({isOnlyDetectionAlerts:e,title:t})=>e?s.a.createElement(a.EuiCallOut,{"data-test-subj":"sourcerer-callout",iconType:"iInCircle",size:"s",title:t}):null));Ie.displayName="SourcererCallout";const Ae=s.a.memo((({onChange:e,checked:t,isShow:n})=>n?s.a.createElement(J,null,s.a.createElement(a.EuiCheckbox,{checked:t,"data-test-subj":"sourcerer-alert-only-checkbox",id:"sourcerer-alert-only-checkbox",label:L,onChange:e})):null));Ae.displayName="AlertsCheckbox";const Pe=s.a.memo((({disableSave:e,isShow:t,onReset:n,onSave:i})=>t?s.a.createElement(J,null,s.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(X,{"aria-label":_,"data-test-subj":"sourcerer-reset",flush:"left",onClick:n,title:_},_)),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiButton,{onClick:i,disabled:e,"data-test-subj":"sourcerer-save",fill:!0,fullWidth:!0,size:"s"},w)))):null));Pe.displayName="SaveButtons";var _e=n(1123),De=n(157),Re=n(218);const Fe=s.a.memo((({scope:e})=>{const t=Object(r.useDispatch)(),n=e===U.SourcererScopeName.detections,o=e===U.SourcererScopeName.timeline,u=e===U.SourcererScopeName.default,c=Object(De.d)(Re.a.sourcerer),d=Object(i.useMemo)((()=>V.d.getSourcererScopeSelector()),[]),{defaultDataView:m,kibanaDataViews:b,signalIndexName:g,sourcererScope:{selectedDataViewId:v,selectedPatterns:y,missingPatterns:h}}=Object($.a)((t=>d(t,e))),{pollForSignalIndex:O}=Object(_e.a)();Object(i.useEffect)((()=>{null!=O&&(o||n)&&O()}),[n,o,O]);const{activePatterns:w,indicesExist:A,loading:P}=Object(Oe.d)(e),[_,D]=Object(i.useState)(w&&w.length>0?h.filter((e=>w.includes(e))):[]);Object(i.useEffect)((()=>{w&&w.length>0&&D(h.filter((e=>w.includes(e))))}),[w,h]);const[R,F]=Object(i.useState)(o&&y.join()===g),L=Object(i.useCallback)((()=>{F(o&&y.join()===g)}),[o,y,g]);Object(i.useEffect)((()=>{L()}),[y]);const B=n||o&&R,[H,G]=Object(i.useState)(!1),[W,X]=Object(i.useState)(v),{allOptions:te,dataViewSelectOptions:le,loadingIndexPatterns:ue,isModified:ce,handleOutsideClick:de,onChangeCombo:me,renderOption:pe,selectedOptions:fe,setIndexPatternsByDataView:be}=(({dataViewId:e,defaultDataViewId:t,isOnlyDetectionAlerts:n,kibanaDataViews:o,missingPatterns:l,scopeId:u,selectedDataViewId:c,selectedPatterns:d,signalIndexName:m})=>{const p=Object(r.useDispatch)(),{data:{dataViews:f}}=Object(ie.i)().services,b=Object(i.useRef)(!0),[g,v]=Object(i.useState)(!1),y=Object(i.useMemo)((()=>m?re([m]):[]),[m]),[h,O]=Object(i.useState)(n?y:re(d)),[k,w]=Object(i.useState)(null==e?"deprecated":l.length>0?"missingPatterns":""),{allPatterns:T,selectablePatterns:C}=Object(i.useMemo)((()=>{if(n&&m)return{allPatterns:[m],selectablePatterns:[m]};const t=o.find((t=>t.id===e));if(null==t)return{allPatterns:[],selectablePatterns:[]};const a=[...new Set(t.title.split(","))];return u===V.b.SourcererScopeName.default?{allPatterns:ne(a,m),selectablePatterns:ne(t.patternList,m)}:{allPatterns:a,selectablePatterns:t.patternList}}),[e,n,o,u,m]),M=Object(i.useMemo)((()=>re(T,C)),[T,C]),I=Object(i.useCallback)(((e,n=!1)=>u===U.SourcererScopeName.detections||n?y:re(Object(Q.b)(o.find((t=>t.id===e)),u,m,e===t))),[y,o,u,m,t]),A=Object(i.useMemo)((()=>null!=e?I(e):[]),[e,I]),P=Object(i.useCallback)(((e,t)=>{if(null==t)return w("deprecated");if(l.length>0)return w("missingPatterns");if(n)return w("alerts");const a=A.length!==e.length||!A.every((t=>e.find((e=>t.value===e))));return w(a?"modified":"")}),[A,n,l.length]);Object(i.useEffect)((()=>{O(u===U.SourcererScopeName.detections?y:re(d))}),[d,u]),Object(i.useEffect)((()=>{P(d.map((e=>e)),c)}),[n,c,l,u,d]);const _=Object(i.useCallback)((e=>{O(e)}),[]),D=Object(i.useCallback)((({value:e})=>s.a.createElement("span",{"data-test-subj":"sourcerer-combo-option"},e)),[]),R=Object(i.useCallback)((async(e,t)=>{if(o.some((t=>t.id===e&&0===t.indexFields.length))){try{v(!0),O([]);const t=await Object(se.a)(e,f);b.current&&(p(V.a.setDataView(t)),O(n?y:re(t.patternList)))}catch(e){}v(!1)}else O(I(e,t))}),[y,p,I,n,o,f]),F=Object(i.useMemo)((()=>null!=e?(({dataViewId:e,defaultDataViewId:t,isModified:n,isOnlyDetectionAlerts:i,kibanaDataViews:r})=>i?[{inputDisplay:s.a.createElement("span",{"data-test-subj":"security-alerts-option-super"},s.a.createElement(a.EuiIcon,{type:"logoSecurity",size:"s"})," ",S,s.a.createElement(ee,{"data-test-subj":"security-alerts-option-badge"},E)),value:t}]:r.map((({title:i,id:r})=>({inputDisplay:r===t?s.a.createElement("span",{"data-test-subj":"security-option-super"},s.a.createElement(a.EuiIcon,{type:"logoSecurity",size:"s"})," ",x,n&&r===e&&s.a.createElement(ee,{"data-test-subj":"security-modified-option-badge"},j)):s.a.createElement("span",{"data-test-subj":"dataView-option-super"},s.a.createElement(a.EuiIcon,{type:"logoKibana",size:"s"})," ",i,n&&r===e&&s.a.createElement(ee,{"data-test-subj":"security-modified-option-badge"},j)),value:r}))))({dataViewId:e,defaultDataViewId:t,isModified:"modified"===k,isOnlyDetectionAlerts:n,kibanaDataViews:o}):[]),[e,t,k,n,o]);return Object(i.useEffect)((()=>(b.current=!0,()=>{b.current=!1})),[]),{allOptions:M,dataViewSelectOptions:F,loadingIndexPatterns:g,handleOutsideClick:Object(i.useCallback)((()=>{O(re(d))}),[d]),isModified:k,onChangeCombo:_,renderOption:D,selectedOptions:h,setIndexPatternsByDataView:R}})({dataViewId:W,defaultDataViewId:m.id,isOnlyDetectionAlerts:B,kibanaDataViews:b,missingPatterns:_,scopeId:e,selectedDataViewId:v,selectedPatterns:y,signalIndexName:g}),ge=Object(i.useCallback)((e=>{F(e.target.checked),X(m.id),be(m.id,e.target.checked)}),[m.id,be]),[ve,ye]=Object(i.useState)(!1),[he,je]=Object(i.useState)(!1),ke=Object(i.useCallback)((()=>{G((e=>!e)),ye(!1)}),[]),Ce=Object(i.useCallback)(((n,a,i)=>{t(V.a.setSelectedDataView({id:e,selectedDataViewId:n,selectedPatterns:a,shouldValidateSelectedPatterns:i})),u&&c({[U.SourcererScopeName.default]:{id:n,selectedPatterns:a}})}),[t,e,u,c]),Fe=Object(i.useCallback)((e=>{X(e),be(e)}),[be]),Ne=Object(i.useCallback)((()=>{X(m.id),be(m.id),F(!1),D([])}),[m.id,be]),Le=Object(i.useCallback)((()=>{const e=fe.map((e=>e.label));null!=W&&Ce(W,e),G(!1)}),[Ce,W,fe]),ze=Object(i.useCallback)((()=>{G(!1),ye(!1)}),[]),Be=Object(i.useCallback)((()=>{je(!1);const e=y.filter((e=>m.patternList.includes(e)));Ce(m.id,e),G(!1)}),[m.id,m.patternList,Ce,y]),qe=Object(i.useCallback)((()=>{0===_.length?Be():je(!0)}),[_,Be]),[Ve,$e]=Object(i.useState)(!1),Ue=(e=>{const{theme:t,uiSettings:n}=Object(ie.i)().services,{addSuccess:r,addError:o}=Object(Te.a)();return Object(i.useCallback)((async i=>{const[l,u]=await(async()=>{try{const e=[...n.get(Se.I),...i];return[await n.set(Se.I,Object(ae.a)(e)),null]}catch(e){return[!1,e]}})();return l?(r({color:"success",title:Object(xe.toMountPoint)(z,{theme$:t.theme$}),text:Object(xe.toMountPoint)(s.a.createElement(we,null),{theme$:t.theme$}),iconType:void 0,toastLifeTimeMs:6e5}),!0):(o(null!==u?u:new Error(q),{title:q,toastMessage:s.a.createElement(s.a.Fragment,null,s.a.createElement(oe.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.failureToastText",defaultMessage:"Unexpected error occurred on update. If you would like to modify your data, you can manually select a data view {link}.",values:{link:s.a.createElement(a.EuiLink,{onClick:e,"data-test-subj":"failureToastLink"},f)}}))}),!1)}),[o,r,e,t.theme$,n])})(Object(i.useCallback)((()=>{G(!0),Ne()}),[Ne])),Qe=Object(i.useCallback)((async()=>{const e=await Ue(_);je(!1),G(!1),e&&(Ce(m.id,null!=w?w:y,!1),$e(!0))}),[w,m.id,_,Ce,y,Ue]);Object(i.useEffect)((()=>{X(v)}),[v]);const He=Object(i.useCallback)((()=>{X(v),D(h),L(),de()}),[de,L,v,h]),Ge=Object(i.useCallback)((()=>{ye((e=>!e))}),[]);return A||e===U.SourcererScopeName.timeline?s.a.createElement(a.EuiPopover,{panelClassName:"sourcererPopoverPanel",button:s.a.createElement(Me,{activePatterns:w,disabled:Ve,isModified:ce,isOnlyDetectionAlerts:B,isPopoverOpen:H,isTimelineSourcerer:o,loading:P,onClick:ke,selectedPatterns:y,signalIndexName:g}),closePopover:ze,"data-test-subj":o?"timeline-sourcerer-popover":"sourcerer-popover",display:"block",isOpen:H,ownFocus:!0,repositionOnScroll:!0},s.a.createElement(a.EuiOutsideClickDetector,{onOutsideClick:He},s.a.createElement(Z,null,s.a.createElement(a.EuiPopoverTitle,{"data-test-subj":"sourcerer-title"},s.a.createElement(s.a.Fragment,null,k)),s.a.createElement(Ie,{isOnlyDetectionAlerts:B,title:o?p:l}),s.a.createElement(a.EuiSpacer,{size:"s"}),null===W&&"deprecated"===ce||"missingPatterns"===ce?s.a.createElement(Ee,{activePatterns:w,indicesExist:A,isModified:ce,isShowingUpdateModal:he,missingPatterns:_,onContinueWithoutUpdate:Be,onDismiss:ke,onDismissModal:()=>je(!1),onReset:Ne,onUpdateStepOne:"deprecated"===ce?qe:Qe,onUpdateStepTwo:Qe,selectedPatterns:y}):s.a.createElement(a.EuiForm,{component:"form"},s.a.createElement(s.a.Fragment,null,s.a.createElement(Ae,{isShow:o,checked:R,onChange:ge}),W&&s.a.createElement(J,{label:T},s.a.createElement(a.EuiSuperSelect,{"data-test-subj":"sourcerer-select",isLoading:ue,disabled:B,fullWidth:!0,onChange:Fe,options:le,placeholder:T,valueOfSelected:W})),s.a.createElement(a.EuiSpacer,{size:"m"}),s.a.createElement(Y,{color:"text","data-test-subj":"sourcerer-advanced-options-toggle",iconType:ve?"arrowDown":"arrowRight",onClick:Ge},C),ve&&s.a.createElement(a.EuiSpacer,{size:"m"}),s.a.createElement(K,{isDisabled:ue,$expandAdvancedOptions:ve,helpText:B?void 0:I,label:M},s.a.createElement(a.EuiComboBox,{"data-test-subj":"sourcerer-combo-box",fullWidth:!0,isDisabled:B||ue,onChange:me,options:te,placeholder:N,renderOption:pe,selectedOptions:fe})),s.a.createElement(Pe,{disableSave:0===fe.length,isShow:!n,onReset:Ne,onSave:Le})),s.a.createElement(a.EuiSpacer,{size:"s"}))))):null}));Fe.displayName="Sourcerer"},,,,,,,,,,,,,,function(e,t,n){(function(e){var a=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(a.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(a.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(1336),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(967))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var a,i,s,r,o,l=1,u={},c=!1,d=e.document,m=Object.getPrototypeOf&&Object.getPrototypeOf(e);m=m&&m.setTimeout?m:e,"[object process]"==={}.toString.call(e.process)?a=function(e){t.nextTick((function(){f(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(r="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(r)&&f(+t.data.slice(r.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),a=function(t){e.postMessage(r+t,"*")}):e.MessageChannel?((s=new MessageChannel).port1.onmessage=function(e){f(e.data)},a=function(e){s.port2.postMessage(e)}):d&&"onreadystatechange"in d.createElement("script")?(i=d.documentElement,a=function(e){var t=d.createElement("script");t.onreadystatechange=function(){f(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):a=function(e){setTimeout(f,0,e)},m.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var i={callback:e,args:t};return u[l]=i,a(l),l++},m.clearImmediate=p}function p(e){delete u[e]}function f(e){if(c)setTimeout(f,0,e);else{var t=u[e];if(t){c=!0;try{!function(e){var t=e.callback,a=e.args;switch(a.length){case 0:t();break;case 1:t(a[0]);break;case 2:t(a[0],a[1]);break;case 3:t(a[0],a[1],a[2]);break;default:t.apply(n,a)}}(t)}finally{p(e),c=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(967),n(391))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t,n)=>{const a=t.indexOf(e),i=[...t];a>=0?i.splice(a,1):i.push(e),n(i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(9);const i=(e,t)=>{var n,i;const s={...e,fields:null==e||null===(n=e.searchSource)||void 0===n?void 0:n.getFields()},r={...t,fields:null==t||null===(i=t.searchSource)||void 0===i?void 0:i.getFields()},o=["columns","grid","hideChart","sort","timeRange","fields.filter","fields.query","title","description"],l=Object(a.pick)(s,o),u=Object(a.pick)(r,o);return Object(a.isEqual)(l,u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwsCrc32=t.Crc32=t.crc32=void 0;var a=n(38),i=n(1509);t.crc32=function(e){return(new s).update(e).digest()};var s=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var t,n;try{for(var i=a.__values(e),s=i.next();!s.done;s=i.next()){var o=s.value;this.checksum=this.checksum>>>8^r[255&(this.checksum^o)]}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}();t.Crc32=s;var r=(0,i.uint32ArrayFrom)([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]),o=n(1641);Object.defineProperty(t,"AwsCrc32",{enumerable:!0,get:function(){return o.AwsCrc32}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=t.numToUint8=t.isEmptyData=t.convertToBuffer=void 0;var a=n(1634);Object.defineProperty(t,"convertToBuffer",{enumerable:!0,get:function(){return a.convertToBuffer}});var i=n(1638);Object.defineProperty(t,"isEmptyData",{enumerable:!0,get:function(){return i.isEmptyData}});var s=n(1639);Object.defineProperty(t,"numToUint8",{enumerable:!0,get:function(){return s.numToUint8}});var r=n(1640);Object.defineProperty(t,"uint32ArrayFrom",{enumerable:!0,get:function(){return r.uint32ArrayFrom}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HeaderMarshaller=void 0;const a=n(1511),i=n(1512);var s;t.HeaderMarshaller=class HeaderMarshaller{constructor(e,t){this.toUtf8=e,this.fromUtf8=t}format(e){const t=[];for(const n of Object.keys(e)){const a=this.fromUtf8(n);t.push(Uint8Array.from([a.byteLength]),a,this.formatHeaderValue(e[n]))}const n=new Uint8Array(t.reduce(((e,t)=>e+t.byteLength),0));let a=0;for(const e of t)n.set(e,a),a+=e.byteLength;return n}formatHeaderValue(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":const t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":const n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":const s=new Uint8Array(9);return s[0]=5,s.set(e.value.bytes,1),s;case"binary":const r=new DataView(new ArrayBuffer(3+e.value.byteLength));r.setUint8(0,6),r.setUint16(1,e.value.byteLength,!1);const o=new Uint8Array(r.buffer);return o.set(e.value,3),o;case"string":const l=this.fromUtf8(e.value),u=new DataView(new ArrayBuffer(3+l.byteLength));u.setUint8(0,7),u.setUint16(1,l.byteLength,!1);const c=new Uint8Array(u.buffer);return c.set(l,3),c;case"timestamp":const d=new Uint8Array(9);return d[0]=8,d.set(i.Int64.fromNumber(e.value.valueOf()).bytes,1),d;case"uuid":if(!b.test(e.value))throw new Error(`Invalid UUID received: ${e.value}`);const m=new Uint8Array(17);return m[0]=9,m.set((0,a.fromHex)(e.value.replace(/\-/g,"")),1),m}}parse(e){const t={};let n=0;for(;n<e.byteLength;){const s=e.getUint8(n++),b=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,s));switch(n+=s,e.getUint8(n++)){case 0:t[b]={type:r,value:!0};break;case 1:t[b]={type:r,value:!1};break;case 2:t[b]={type:o,value:e.getInt8(n++)};break;case 3:t[b]={type:l,value:e.getInt16(n,!1)},n+=2;break;case 4:t[b]={type:u,value:e.getInt32(n,!1)},n+=4;break;case 5:t[b]={type:c,value:new i.Int64(new Uint8Array(e.buffer,e.byteOffset+n,8))},n+=8;break;case 6:const s=e.getUint16(n,!1);n+=2,t[b]={type:d,value:new Uint8Array(e.buffer,e.byteOffset+n,s)},n+=s;break;case 7:const g=e.getUint16(n,!1);n+=2,t[b]={type:m,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,g))},n+=g;break;case 8:t[b]={type:p,value:new Date(new i.Int64(new Uint8Array(e.buffer,e.byteOffset+n,8)).valueOf())},n+=8;break;case 9:const v=new Uint8Array(e.buffer,e.byteOffset+n,16);n+=16,t[b]={type:f,value:`${(0,a.toHex)(v.subarray(0,4))}-${(0,a.toHex)(v.subarray(4,6))}-${(0,a.toHex)(v.subarray(6,8))}-${(0,a.toHex)(v.subarray(8,10))}-${(0,a.toHex)(v.subarray(10))}`};break;default:throw new Error("Unrecognized header type tag")}}return t}},function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(s||(s={}));const r="boolean",o="byte",l="short",u="integer",c="long",d="binary",m="string",p="timestamp",f="uuid",b=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toHex=t.fromHex=void 0;const a={},i={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),a[e]=t,i[t]=e}t.fromHex=function(e){if(e.length%2!=0)throw new Error("Hex encoded strings must have an even number length");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){const a=e.slice(n,n+2).toLowerCase();if(!(a in i))throw new Error(`Cannot decode unrecognized sequence ${a} as hexadecimal`);t[n/2]=i[a]}return t},t.toHex=function(e){let t="";for(let n=0;n<e.byteLength;n++)t+=a[e[n]];return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Int64=void 0;const a=n(1511);class Int64{constructor(e){if(this.bytes=e,8!==e.byteLength)throw new Error("Int64 buffers must be exactly 8 bytes")}static fromNumber(e){if(e>0x8000000000000000||e<-0x8000000000000000)throw new Error(`${e} is too large (or, if negative, too small) to represent as an Int64`);const t=new Uint8Array(8);for(let n=7,a=Math.abs(Math.round(e));n>-1&&a>0;n--,a/=256)t[n]=a;return e<0&&i(t),new Int64(t)}valueOf(){const e=this.bytes.slice(0),t=128&e[0];return t&&i(e),parseInt((0,a.toHex)(e),16)*(t?-1:1)}toString(){return String(this.valueOf())}}function i(e){for(let t=0;t<8;t++)e[t]^=255;for(let t=7;t>-1&&(e[t]++,0===e[t]);t--);}t.Int64=Int64},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromUtf8=void 0;const a=n(1514);t.fromUtf8=e=>{const t=(0,a.fromString)(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromString=t.fromArrayBuffer=void 0;const a=n(1649),i=n(242);t.fromArrayBuffer=(e,t=0,n=e.byteLength-t)=>{if(!(0,a.isArrayBuffer)(e))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);return i.Buffer.from(e,t,n)},t.fromString=(e,t)=>{if("string"!=typeof e)throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?i.Buffer.from(e,t):i.Buffer.from(e)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.assistant.getComments.assistant",{defaultMessage:"Assistant"}),s=e=>a.i18n.translate("xpack.securitySolution.assistant.getComments.at",{defaultMessage:"at: {timestamp}",values:{timestamp:e}}),r=a.i18n.translate("xpack.securitySolution.assistant.getComments.you",{defaultMessage:"You"}),o=a.i18n.translate("xpack.securitySolution.assistant.apiErrorTitle",{defaultMessage:"An error occurred sending your message."})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return r}));var a=n(2),i=n(49),s=n(110);const r=()=>{const{pathname:t}=Object(i.useLocation)(),{executionContext:n}=Object(s.i)().services;Object(a.useEffect)((()=>{e((()=>{n.set({page:t})}))}),[t,n])}}).call(this,n(1335).setImmediate)},function(e,t,n){"use strict";(function(e){n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return c}));var a=n(3),i=n(1632),s=n(1648),r=n(1515);const o=({connectorTypeTitle:t,isError:n,reader:o,setLoading:c})=>new a.Observable((a=>{a.next({chunks:[],loading:!0});const c=new TextDecoder,d=[];let m="",p=new Uint8Array(0);return"Amazon Bedrock"===t?function t(){o.read().then((({done:o,value:l})=>{try{if(o)return a.next({chunks:d,message:d.join(""),loading:!1}),void a.complete();let t;if(n)t=`${r.a}\n\n${JSON.parse(c.decode(l)).message}`,d.push(t),a.next({chunks:d,message:d.join(""),loading:!0});else if(null!=l){p=function(e,t){const n=new Uint8Array(e.length+t.length);return n.set(e),n.set(t,e.length),n}(p,l);let n=u(p);const r=[];for(;p.byteLength>0&&p.byteLength>=n;){const e=p.slice(0,n);r.push(e),p=p.slice(n),n=u(p)}const o=new i.EventStreamCodec(s.toUtf8,s.fromUtf8);r.forEach((n=>{const i=o.decode(n),s=JSON.parse(e.from(JSON.parse(c.decode(i.body)).bytes,"base64").toString());t=s.completion,d.push(t),a.next({chunks:d,message:d.join(""),loading:!0})}))}}catch(e){return void a.error(e)}t()})).catch((e=>{a.error(e)}))}():"OpenAI"===t?function e(){o.read().then((({done:t,value:i})=>{try{if(t)return m&&d.push(l([m])[0]),a.next({chunks:d,message:d.join(""),loading:!1}),void a.complete();const e=c.decode(i);let s;if(n)s=[`${r.a}\n\n${JSON.parse(e).message}`];else{const t=e.split("\n");t[0]=m+t[0],m=t.pop()||"",s=l(t)}s.forEach((e=>{d.push(e),a.next({chunks:d,message:d.join(""),loading:!0})}))}catch(e){return void a.error(e)}e()})).catch((e=>{a.error(e)}))}():(a.next({chunks:[`Invalid connector type - ${t} is not a supported GenAI connector.`],message:`Invalid connector type - ${t} is not a supported GenAI connector.`,loading:!1}),a.complete()),()=>{o.cancel()}})).pipe(Object(a.timestamp)(),Object(a.scan)(((e,t)=>{const n=e.timestamp||0;return{timestamp:Math.max(n+35,t.timestamp),value:t.value}})),Object(a.concatMap)((e=>{const t=Date.now(),n=e.timestamp-t;return n<=0?Object(a.of)(e.value):Object(a.of)(e.value).pipe(Object(a.delay)(n))})),Object(a.finalize)((()=>c(!1)))),l=e=>e.map((e=>e.substring(6))).filter((e=>!!e&&"[DONE]"!==e)).map((e=>{try{var t,n;return null!==(t=null===(n=JSON.parse(e).choices[0])||void 0===n?void 0:n.delta.content)&&void 0!==t?t:""}catch(e){return""}}));function u(e){return 0===e.byteLength?0:new DataView(e.buffer,e.byteOffset,e.byteLength).getUint32(0,!1)}const c=()=>new a.Observable}).call(this,n(242).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(38);a.__exportStar(n(1633),t),a.__exportStar(n(1510),t),a.__exportStar(n(1512),t),a.__exportStar(n(1643),t),a.__exportStar(n(1644),t),a.__exportStar(n(1645),t),a.__exportStar(n(1646),t),a.__exportStar(n(1647),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventStreamCodec=void 0;const a=n(1405),i=n(1510),s=n(1642);t.EventStreamCodec=class EventStreamCodec{constructor(e,t){this.headerMarshaller=new i.HeaderMarshaller(e,t),this.messageBuffer=[],this.isEndOfStream=!1}feed(e){this.messageBuffer.push(this.decode(e))}endOfStream(){this.isEndOfStream=!0}getMessage(){const e=this.messageBuffer.pop(),t=this.isEndOfStream;return{getMessage:()=>e,isEndOfStream:()=>t}}getAvailableMessages(){const e=this.messageBuffer;this.messageBuffer=[];const t=this.isEndOfStream;return{getMessages:()=>e,isEndOfStream:()=>t}}encode({headers:e,body:t}){const n=this.headerMarshaller.format(e),i=n.byteLength+t.byteLength+16,s=new Uint8Array(i),r=new DataView(s.buffer,s.byteOffset,s.byteLength),o=new a.Crc32;return r.setUint32(0,i,!1),r.setUint32(4,n.byteLength,!1),r.setUint32(8,o.update(s.subarray(0,8)).digest(),!1),s.set(n,12),s.set(t,n.byteLength+12),r.setUint32(i-4,o.update(s.subarray(8,i-4)).digest(),!1),s}decode(e){const{headers:t,body:n}=(0,s.splitMessage)(e);return{headers:this.headerMarshaller.parse(t),body:n}}formatHeaders(e){return this.headerMarshaller.format(e)}}},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.convertToBuffer=void 0;var a=n(1635),i=void 0!==e&&e.from?function(t){return e.from(t,"utf8")}:a.fromUtf8;t.convertToBuffer=function(e){return e instanceof Uint8Array?e:"string"==typeof e?i(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)}}).call(this,n(242).Buffer)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=t.fromUtf8=void 0;const a=n(1636),i=n(1637);t.fromUtf8=e=>"function"==typeof TextEncoder?(0,i.fromUtf8)(e):(0,a.fromUtf8)(e),t.toUtf8=e=>"function"==typeof TextDecoder?(0,i.toUtf8)(e):(0,a.toUtf8)(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=t.fromUtf8=void 0,t.fromUtf8=e=>{const t=[];for(let n=0,a=e.length;n<a;n++){const a=e.charCodeAt(n);if(a<128)t.push(a);else if(a<2048)t.push(a>>6|192,63&a|128);else if(n+1<e.length&&55296==(64512&a)&&56320==(64512&e.charCodeAt(n+1))){const i=65536+((1023&a)<<10)+(1023&e.charCodeAt(++n));t.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}else t.push(a>>12|224,a>>6&63|128,63&a|128)}return Uint8Array.from(t)},t.toUtf8=e=>{let t="";for(let n=0,a=e.length;n<a;n++){const a=e[n];if(a<128)t+=String.fromCharCode(a);else if(192<=a&&a<224){const i=e[++n];t+=String.fromCharCode((31&a)<<6|63&i)}else if(240<=a&&a<365){const i="%"+[a,e[++n],e[++n],e[++n]].map((e=>e.toString(16))).join("%");t+=decodeURIComponent(i)}else t+=String.fromCharCode((15&a)<<12|(63&e[++n])<<6|63&e[++n])}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=t.fromUtf8=void 0,t.fromUtf8=function(e){return(new TextEncoder).encode(e)},t.toUtf8=function(e){return new TextDecoder("utf-8").decode(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyData=void 0,t.isEmptyData=function(e){return"string"==typeof e?0===e.length:0===e.byteLength}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.numToUint8=void 0,t.numToUint8=function(e){return new Uint8Array([(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.uint32ArrayFrom=void 0,t.uint32ArrayFrom=function(e){if(!Uint32Array.from){for(var t=new Uint32Array(e.length),n=0;n<e.length;)t[n]=e[n],n+=1;return t}return Uint32Array.from(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AwsCrc32=void 0;var a=n(38),i=n(1509),s=n(1405),r=function(){function e(){this.crc32=new s.Crc32}return e.prototype.update=function(e){(0,i.isEmptyData)(e)||this.crc32.update((0,i.convertToBuffer)(e))},e.prototype.digest=function(){return a.__awaiter(this,void 0,void 0,(function(){return a.__generator(this,(function(e){return[2,(0,i.numToUint8)(this.crc32.digest())]}))}))},e.prototype.reset=function(){this.crc32=new s.Crc32},e}();t.AwsCrc32=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.splitMessage=void 0;const a=n(1405);t.splitMessage=function({byteLength:e,byteOffset:t,buffer:n}){if(e<16)throw new Error("Provided message too short to accommodate event stream message overhead");const i=new DataView(n,t,e),s=i.getUint32(0,!1);if(e!==s)throw new Error("Reported message length does not match received message length");const r=i.getUint32(4,!1),o=i.getUint32(8,!1),l=i.getUint32(e-4,!1),u=(new a.Crc32).update(new Uint8Array(n,t,8));if(o!==u.digest())throw new Error(`The prelude checksum specified in the message (${o}) does not match the calculated CRC32 checksum (${u.digest()})`);if(u.update(new Uint8Array(n,t+8,e-12)),l!==u.digest())throw new Error(`The message checksum (${u.digest()}) did not match the expected value of ${l}`);return{headers:new DataView(n,t+8+4,r),body:new Uint8Array(n,t+8+4+r,s-r-16)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageDecoderStream=void 0;class MessageDecoderStream{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream){const t=this.options.decoder.decode(e);yield t}}}t.MessageDecoderStream=MessageDecoderStream},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageEncoderStream=void 0;class MessageEncoderStream{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const t=this.options.encoder.encode(e);yield t}this.options.includeEndFrame&&(yield new Uint8Array(0))}}t.MessageEncoderStream=MessageEncoderStream},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SmithyMessageDecoderStream=void 0;class SmithyMessageDecoderStream{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.messageStream){const t=await this.options.deserializer(e);void 0!==t&&(yield t)}}}t.SmithyMessageDecoderStream=SmithyMessageDecoderStream},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SmithyMessageEncoderStream=void 0;class SmithyMessageEncoderStream{constructor(e){this.options=e}[Symbol.asyncIterator](){return this.asyncIterator()}async*asyncIterator(){for await(const e of this.options.inputStream){const t=this.options.serializer(e);yield t}}}t.SmithyMessageEncoderStream=SmithyMessageEncoderStream},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(38);a.__exportStar(n(1513),t),a.__exportStar(n(1650),t),a.__exportStar(n(1651),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isArrayBuffer=void 0,t.isArrayBuffer=e=>"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUint8Array=void 0;const a=n(1513);t.toUint8Array=e=>"string"==typeof e?(0,a.fromUtf8)(e):ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength/Uint8Array.BYTES_PER_ELEMENT):new Uint8Array(e)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toUtf8=void 0;const a=n(1514);t.toUtf8=e=>(0,a.fromArrayBuffer)(e.buffer,e.byteOffset,e.byteLength).toString("utf8")},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"renderApp",(function(){return Zn})),n.d(t,"createStoreFactory",(function(){return ea.a}));var a=n(2),i=n.n(a),s=n(67),r=n(48),o=n(63),l=n(69),u=n(320),c=n(84),d=n(28),m=n(438),p=n(213),f=n(4),b=n(112),g=n(128),v=n(167),y=n(480);const h=({toastLifeTimeMs:e=5e3})=>{const t=Object(r.useDispatch)(),n=Object(a.useMemo)((()=>g.a.errorsSelector()),[]),i=Object(b.a)(n),[{toasts:s},o]=Object(y.f)();return Object(a.useEffect)((()=>{i.forEach((({id:n,title:a,message:i})=>{s.some((e=>e.id===n))||o({type:"addToaster",toast:{color:"danger",id:n,iconType:"error",title:a,errors:i,toastLifeTimeMs:e}}),t(v.a.removeError({id:n}))}))}),[t,o,i,e,s]),null};h.displayName="ErrorToastDispatcherComponent";const j=i.a.memo(h);var E=n(749),O=n(110),x=n(246),S=n(49),k=n(151),w=n(118);const T=Object(a.memo)((({children:e})=>{const t=Object(S.useLocation)(),n=Object(r.useDispatch)();return Object(a.useEffect)((()=>{n(w.a.showTimeline({id:k.f.active,show:!1}))}),[n,t.pathname]),Object(a.useEffect)((()=>{n({type:"userChangedUrl",payload:t})})),i.a.createElement(i.a.Fragment,null,e)}));T.displayName="RouteCapture";var C=n(698);const M=({children:e})=>i.a.createElement(C.a.Provider,{value:Object(a.useReducer)(((e,t)=>{switch(t.type){case"updateRoute":return t.route;case"updateRouteWithOutSearch":return{...e,...t.route};case"updateSearch":return{...e,search:t.search};default:return e}}),C.b)},e),I=Object(a.memo)(M);var A=n(434),P=n(45),_=n(82),D=n(136),R=n.n(D),F=n(114),N=n(424),L=n(5);L.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.indexPatternFetchFailureTitle",{defaultMessage:"Index pattern fetch failure"}),L.i18n.translate("xpack.securitySolution.components.hooks.eql.partialResponse",{defaultMessage:"EQL Preview Error"}),L.i18n.translate("xpack.securitySolution.components.hooks.errors.timeIntervalsNotDefined",{defaultMessage:"Time intervals are not defined."});var z=n(122),B=n(113),q=n(174),V=n(134),$=n(196),U=n(204);const Q=[{columnHeaderType:$.a,id:"@timestamp",initialWidth:U.b},{columnHeaderType:$.a,id:"event.module",linkField:"rule.reference"},{columnHeaderType:$.a,id:"event.dataset"},{columnHeaderType:$.a,id:"event.category"},{columnHeaderType:$.a,id:"event.severity"},{columnHeaderType:$.a,id:"observer.name"},{columnHeaderType:$.a,id:"host.name"},{columnHeaderType:$.a,id:"message"},{columnHeaderType:$.a,id:"agent.id"},{columnHeaderType:$.a,id:"agent.type"}];window["__@hello-pangea/dnd-disable-dev-warnings"]=!0;const H=({browserFields:e,children:t})=>{const n=Object(r.useDispatch)(),s=Object(a.useMemo)((()=>w.b.getTimelineByIdSelector()),[]),o=Object(a.useMemo)((()=>g.b.getDataProvidersSelector()),[]),{timelines:l}=Object(O.i)().services,u=[l.getUseAddToTimelineSensor()],{dataProviders:c,timelineType:d}=Object(b.a)((e=>{var t;return Object(P.pick)(["dataProviders","timelineType"],null!==(t=s(e,z.c.active))&&void 0!==t?t:V.b)})),m=Object(b.a)(o),[,p]=Object(y.f)(),f=Object(a.useCallback)((e=>{const t=d===B.l.template?(e=>L.i18n.translate("xpack.securitySolution.hooks.useAddToTimeline.template.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline template"}))(e):(e=>L.i18n.translate("xpack.securitySolution.hooks.useAddToTimeline.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline"}))(e);Object(y.d)(t,p)}),[p,d]),v=Object(a.useCallback)((t=>{try{K(),null!=m&&(({activeTimelineDataProviders:e,browserFields:t,dataProviders:n,dispatch:a,onAddedToTimeline:i,result:s})=>{if(Object(q.r)(s))Object(N.e)({dataProviders:e,destination:s.destination,dispatch:a,source:s.source,timelineId:z.c.active});else if(Object(q.q)(s))Object(q.d)({activeTimelineDataProviders:e,dataProviders:n,dispatch:a,onAddedToTimeline:i,result:s,timelineId:z.c.active});else if(Object(q.j)(s)){var r,o;Object(q.c)({browserFields:t,defaultsHeader:Q,dispatch:a,result:s,scopeId:Object(q.n)(null!==(r=null===(o=s.destination)||void 0===o?void 0:o.droppableId)&&void 0!==r?r:"")})}})({activeTimelineDataProviders:c,browserFields:e,dataProviders:m,dispatch:n,onAddedToTimeline:f,result:t})}finally{document.body.classList.remove(F.d),Object(q.f)(t)&&document.body.classList.remove(q.b)}}),[c,e,m,n,f]);return i.a.createElement(_.DragDropContext,{onBeforeDragStart:W,onDragEnd:v,sensors:u},t)};H.displayName="DragDropContextWrapperComponent";const G=i.a.memo(H,((e,t)=>R()(e.children,t.children)));G.displayName="DragDropContextWrapper";const W=e=>{Object(q.f)(e)||document.body.classList.add(F.d),Object(q.f)(e)&&document.body.classList.add(q.b)},K=()=>window.onscroll=()=>P.noop;var J=n(214),Y=n(22);const X=i.a.memo((()=>{const{chrome:e,docLinks:t}=Object(O.i)().services;return Object(a.useEffect)((()=>{e.setHelpExtension({appName:Y.c,links:[{content:L.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation",{defaultMessage:"Security documentation"}),href:t.links.siem.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{content:L.i18n.translate("xpack.securitySolution.chrome.helpMenu.documentation.ecs",{defaultMessage:"ECS documentation"}),href:t.links.ecs.guide,iconType:"documents",linkType:"custom",target:"_blank",rel:"noopener"},{linkType:"discuss",href:"https://discuss.elastic.co/c/security",target:"_blank",rel:"noopener"}]})}),[]),null}));X.displayName="HelpMenu";var Z=n(121),ee=n(17),te=n(395),ne=n(743),ae=n(47),ie=n(44),se=n.n(ie),re=n(86);const oe=L.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.searchFilterPlaceholder",{defaultMessage:"e.g. Unusual Linux Process"}),le=L.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.groupsLabel",{defaultMessage:"Groups"}),ue=L.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.noGroupsAvailableDescription",{defaultMessage:"No Groups available"}),ce=L.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showAllJobsLabel",{defaultMessage:"Elastic jobs"}),de=L.i18n.translate("xpack.securitySolution.components.mlPopover.jobsTable.filters.showSiemJobsLabel",{defaultMessage:"Custom jobs"});var me=n(1403);const pe=({securityJobs:e,onSelectedGroupsChanged:t})=>{const[n,s]=Object(a.useState)(!1),[r,o]=Object(a.useState)([]),l=e.map((e=>e.groups)).flat().filter((e=>"siem"!==e&&"security"!==e)),u=Array.from(new Set(l));return Object(a.useEffect)((()=>{t(r)}),[r.sort().join()]),i.a.createElement(ee.EuiPopover,{ownFocus:!0,button:i.a.createElement(ee.EuiFilterButton,{"data-test-subj":"groups-filter-popover-button",iconType:"arrowDown",onClick:()=>s(!n),isSelected:n,numFilters:u.length,hasActiveFilters:r.length>0,numActiveFilters:r.length},le),isOpen:n,closePopover:()=>s(!n),panelPaddingSize:"none",repositionOnScroll:!0},u.map(((e,t)=>i.a.createElement(ee.EuiFilterSelectItem,{checked:r.includes(e)?"on":void 0,key:`${t}-${e}`,onClick:()=>Object(me.a)(e,r,o)},`${e} (${l.filter((t=>t===e)).length})`))),0===u.length&&i.a.createElement(ee.EuiFlexGroup,{gutterSize:"m",justifyContent:"spaceAround"},i.a.createElement(ee.EuiFlexItem,{grow:!0},i.a.createElement(ee.EuiIcon,{type:"minusInCircle"}),i.a.createElement(ee.EuiSpacer,{size:"xs"}),i.a.createElement("p",null,ue))))};pe.displayName="GroupsFilterPopoverComponent";const fe=i.a.memo(pe);fe.displayName="GroupsFilterPopover";const be=({securityJobs:e,onFilterChanged:t})=>{const[n,s]=Object(a.useState)(""),[r,o]=Object(a.useState)([]),[l,u]=Object(a.useState)(!1),[c,d]=Object(a.useState)(!1);Object(a.useEffect)((()=>{t({filterQuery:n,showCustomJobs:l,showElasticJobs:c,selectedGroups:r})}),[n,r,l,c,t]);const m=Object(a.useCallback)((e=>s(e.queryText.trim())),[s]),p=Object(a.useCallback)((()=>{d(!c),u(!1)}),[d,c,u]),f=Object(a.useCallback)((()=>{u(!l),d(!1)}),[d,l,u]);return i.a.createElement(ee.EuiFlexGroup,{gutterSize:"m",justifyContent:"flexEnd"},i.a.createElement(ee.EuiFlexItem,{grow:!0},i.a.createElement(ee.EuiSearchBar,{"data-test-subj":"jobs-filter-bar",box:{placeholder:oe,incremental:!0},onChange:m})),i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(ee.EuiFilterGroup,null,i.a.createElement(fe,{securityJobs:e,onSelectedGroupsChanged:o}))),i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(ee.EuiFilterGroup,null,i.a.createElement(ee.EuiFilterButton,{hasActiveFilters:c,onClick:p,"data-test-subj":"show-elastic-jobs-filter-button",withNext:!0},ce),i.a.createElement(ee.EuiFilterButton,{hasActiveFilters:l,onClick:f,"data-test-subj":"show-custom-jobs-filter-button"},de))))};be.displayName="JobsTableFiltersComponent";const ge=i.a.memo(be);ge.displayName="JobsTableFilters";var ve=n(1104);const ye=L.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.jobNameColumn",{defaultMessage:"Job name"}),he=L.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.tagsColumn",{defaultMessage:"Groups"}),je=L.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.runJobColumn",{defaultMessage:"Run job"}),Ee=L.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.noItemsDescription",{defaultMessage:"No Security Machine Learning jobs found"}),Oe=L.i18n.translate("xpack.securitySolution.components.mlPopup.jobsTable.createCustomJobButtonLabel",{defaultMessage:"Create custom job"});var xe=n(1074);const Se=se.a.div.withConfig({displayName:"JobNameWrapper",componentId:"sc-1gfh62-0"})(["margin:5px 0;"]);Se.displayName="JobNameWrapper";const ke=({id:e,name:t,description:n,basePath:a})=>{const{services:{ml:s}}=Object(O.i)(),r=Object(re.useMlHref)(s,a,{page:re.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:e}},[e]);return i.a.createElement(Se,null,i.a.createElement(ee.EuiText,{size:"s"},i.a.createElement(ee.EuiLink,{"data-test-subj":"jobs-table-link",href:r,target:"_blank"},null!=t?t:e)),i.a.createElement(ee.EuiText,{color:"subdued",size:"xs"},n.length>200?`${n.substring(0,200)}...`:n))},we=(e,t,n)=>[{name:ye,render:({id:e,description:t,customSettings:a})=>{var s;return i.a.createElement(ke,{id:e,name:null!==(s=null==a?void 0:a.security_app_display_name)&&void 0!==s?s:e,description:t,basePath:n})}},{name:he,render:({groups:e})=>i.a.createElement(ve.a,{items:e,numberOfItemsToDisplay:0,popoverButtonTitle:`${e.length} Groups`,renderItem:(e,t)=>i.a.createElement(ee.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"group"},e),dataTestPrefix:"groups"}),width:"80px"},{name:je,render:n=>n.isCompatible?i.a.createElement(xe.a,{job:n,isSecurityJobsLoading:e,onJobStateChange:t}):i.a.createElement(ee.EuiIcon,{"aria-label":"Warning",size:"s",type:"warning",color:"warning"}),align:ee.CENTER_ALIGNMENT,width:"80px"}],Te=(e,t,n)=>e.slice(t*n,t*n+n),Ce=({isLoading:e,jobs:t,onJobStateChange:n,mlNodesAvailable:s})=>{const[r,o]=Object(a.useState)(0),l=Object(O.d)(),u={showPerPageOptions:!1,pageIndex:r,pageSize:5,totalItemCount:t.length};return Object(a.useEffect)((()=>{o(0)}),[t.length]),i.a.createElement(ee.EuiBasicTable,{"data-test-subj":"jobs-table",columns:we(e,n,l),items:Te(t.map((e=>({...e,isCompatible:!!s&&e.isCompatible}))),r,5),loading:e,noItemsMessage:i.a.createElement(Ie,{basePath:l}),pagination:u,responsive:!1,onChange:({page:e})=>{o(e.index)}})};Ce.displayName="JobsTableComponent";const Me=i.a.memo(Ce);Me.displayName="JobsTable";const Ie=i.a.memo((({basePath:e})=>{const{services:{ml:t}}=Object(O.i)(),n=Object(re.useMlHref)(t,e,{page:re.ML_PAGES.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});return i.a.createElement(ee.EuiEmptyPrompt,{title:i.a.createElement("h3",null,Ee),titleSize:"xs",actions:i.a.createElement(ee.EuiButton,{href:n,iconType:"popout",iconSide:"right",size:"s",target:"_blank"},Oe)})}));Ie.displayName="NoItemsMessage";const Ae=se.a.div.withConfig({displayName:"ShowingContainer",componentId:"sc-1qc9cz9-0"})(["user-select:none;margin-top:5px;"]);Ae.displayName="ShowingContainer";const Pe=({filterResultsLength:e})=>i.a.createElement(Ae,{"data-test-subj":"showing"},i.a.createElement(ee.EuiText,{color:"subdued",size:"xs"},i.a.createElement(ae.FormattedMessage,{"data-test-subj":"query-message",id:"xpack.securitySolution.components.mlPopup.showingLabel",defaultMessage:"Showing: {filterResultsLength} {filterResultsLength, plural, one {job} other {jobs}}",values:{filterResultsLength:e}})));Pe.displayName="ShowingCountComponent";const _e=i.a.memo(Pe);_e.displayName="ShowingCount";const De=()=>i.a.createElement(ee.EuiText,{size:"s"},i.a.createElement(ae.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.anomalyDetectionDescription",defaultMessage:"Run any of the Machine Learning jobs below to prepare for creating detection rules that produce alerts for detected anomalies, and to view anomalous events throughout the Security application. We’ve provided a collection of common detection jobs to get you started. If you wish to add your own custom ML jobs, create and add them to the “Security” group from the {machineLearning} application.",values:{machineLearning:i.a.createElement(ee.EuiLink,{href:`${Object(O.d)()}/app/ml`,target:"_blank"},i.a.createElement(ae.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.machineLearningLink",defaultMessage:"Machine Learning"}))}}));De.displayName="PopoverDescriptionComponent";const Re=i.a.memo(De);Re.displayName="PopoverDescription";const Fe=L.i18n.translate("xpack.securitySolution.components.mlPopup.mlJobSettingsButtonLabel",{defaultMessage:"ML job settings"}),Ne=L.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeTitle",{defaultMessage:"Upgrade to Elastic Platinum"}),Le=L.i18n.translate("xpack.securitySolution.components.mlPopup.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),ze=L.i18n.translate("xpack.securitySolution.components.mlPopup.licenseButtonLabel",{defaultMessage:"Manage license"}),Be=e=>L.i18n.translate("xpack.securitySolution.components.mlPopup.moduleNotCompatibleTitle",{values:{incompatibleJobCount:e},defaultMessage:"{incompatibleJobCount} {incompatibleJobCount, plural, =1 {job is} other {jobs are}} currently unavailable"}),qe=L.i18n.translate("xpack.securitySolution.entityAnalytics.anomalies.AnomalyDetectionDocsTitle",{defaultMessage:"Anomaly Detection with Machine Learning"}),Ve=se.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-1kq19yh-0"})(["width:384px;"]);Ve.displayName="PopoverContentsDiv";const $e=()=>i.a.createElement(Ve,{"data-test-subj":"ml-popover-upgrade-contents"},i.a.createElement(ee.EuiPopoverTitle,null,Ne),i.a.createElement(ee.EuiText,{size:"s"},i.a.createElement(ae.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.upgradeDescription",defaultMessage:"To access SIEM’s anomaly detection features, you must update your license to Platinum, start a free 30-day trial, or spin up a {cloudLink} on AWS, GCP, or Azure. You can then run Machine Learning jobs and view anomalies.",values:{cloudLink:i.a.createElement(ee.EuiLink,{href:"https://www.elastic.co/cloud/",target:"_blank"},i.a.createElement(ae.FormattedMessage,{id:"xpack.securitySolution.components.mlPopup.cloudLink",defaultMessage:"cloud deployment"}))}})),i.a.createElement(ee.EuiSpacer,null),i.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",wrap:!0},i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(ee.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},Le)),i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(ee.EuiButton,{href:`${Object(O.d)()}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},ze)))),Ue=i.a.memo($e);Ue.displayName="UpgradeContents";var Qe=n(690),He=n(897);const Ge=se.a.div.withConfig({displayName:"PopoverContentsDiv",componentId:"sc-1wz4ps6-0"})(["max-width:684px;max-height:90vh;overflow-y:auto;overflow-x:hidden;padding-bottom:15px;"]);Ge.displayName="PopoverContentsDiv";const We={filterQuery:"",showCustomJobs:!1,showElasticJobs:!1,selectedGroups:[]},Ke=i.a.memo((()=>{const[e,t]=Object(a.useState)(!1),[n,s]=Object(a.useState)(We),[r,o]=Object(a.useState)(!1),{isMlAdmin:l,isLicensed:u,loading:c,jobs:d,refetch:m}=Object(Qe.a)(),p=Object(O.i)().services.docLinks,{enableDatafeed:f,disableDatafeed:b,isLoading:g}=Object(He.a)(),v=Object(a.useCallback)((async(e,t,n)=>{n?await f(e,t):await b(e),m()}),[m,f,b]),y=(({jobs:e,selectedGroups:t,showCustomJobs:n,showElasticJobs:a,filterQuery:i})=>((e,t)=>{const n=null==t?void 0:t.toLowerCase();return e.filter((e=>{var t,a,i;return null==n||e.id.includes(n)||(null===(t=e.customSettings)||void 0===t||null===(a=t.security_app_display_name)||void 0===a||null===(i=a.toLowerCase())||void 0===i?void 0:i.includes(n))||e.description.toLowerCase().includes(n)}))})(e.filter((e=>!n||n&&!e.isElasticJob)).filter((e=>!a||a&&e.isElasticJob)).filter((e=>0===t.length||t.some((t=>e.groups.includes(t))))),i))({jobs:d,...n}),h=d.filter((e=>!e.isCompatible)).length,j=Object(a.useMemo)((()=>d.filter((e=>e.isInstalled)).map((e=>e.id))),[d]);return u?l?i.a.createElement(ee.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:i.a.createElement(ee.EuiHeaderSectionItemButton,{"aria-expanded":e,"aria-haspopup":"true","aria-label":Fe,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>{t(!e),m()},textProps:{style:{fontSize:"1rem"}}},Fe),isOpen:e,closePopover:()=>t(!e),repositionOnScroll:!0},i.a.createElement(Ge,{"data-test-subj":"ml-popover-contents"},i.a.createElement(ee.EuiPopoverTitle,null,Fe),i.a.createElement(Re,null),i.a.createElement(ee.EuiSpacer,null),i.a.createElement(ge,{securityJobs:d,onFilterChanged:s}),i.a.createElement(_e,{filterResultsLength:y.length}),i.a.createElement(ee.EuiSpacer,{size:"m"}),h>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ee.EuiCallOut,{title:Be(h),color:"warning",iconType:"warning",size:"s"},i.a.createElement("p",null,i.a.createElement(ae.FormattedMessage,{defaultMessage:"We could not find any data, see {mlDocs} for more information on Machine Learning job requirements.",id:"xpack.securitySolution.components.mlPopup.moduleNotCompatibleDescription",values:{mlDocs:i.a.createElement("a",{href:`${p.links.siem.ml}`,rel:"noopener noreferrer",target:"_blank"},qe)}}))),i.a.createElement(ee.EuiSpacer,{size:"m"})),i.a.createElement(re.MLJobsAwaitingNodeWarning,{jobIds:j}),i.a.createElement(re.MlNodeAvailableWarningShared,{size:"s",nodeAvailableCallback:o}),i.a.createElement(Me,{isLoading:c||g,jobs:y,onJobStateChange:v,mlNodesAvailable:r}))):null:i.a.createElement(ee.EuiPopover,{anchorPosition:"downRight",id:"integrations-popover",button:i.a.createElement(ee.EuiHeaderSectionItemButton,{"aria-expanded":e,"aria-haspopup":"true","aria-label":Fe,color:"primary","data-test-subj":"integrations-button",iconType:"arrowDown",iconSide:"right",onClick:()=>t(!e),textProps:{style:{fontSize:"1rem"}}},Fe),isOpen:e,closePopover:()=>t(!e),repositionOnScroll:!0},i.a.createElement(Ue,null))}));Ke.displayName="MlPopover";var Je=n(127),Ye=n(1321),Xe=n(283),Ze=n(123),et=n(194);const tt=navigator.platform.toLowerCase().indexOf("mac")>=0,nt=L.i18n.translate("xpack.securitySolution.globalHeader.assistantHeaderLinkShortcutTooltip",{values:{keyboardShortcut:tt?"⌘ ;":"Ctrl ;"},defaultMessage:"Keyboard shortcut {keyboardShortcut}"}),at=L.i18n.translate("xpack.securitySolution.globalHeader.assistantHeaderLink",{defaultMessage:"AI Assistant"}),it=()=>{const{showAssistantOverlay:e,assistantAvailability:t}=Object(Ze.b)(),n=Object(a.useCallback)((()=>e({showOverlay:!0})),[e]);return t.hasAssistantPrivilege?i.a.createElement(ee.EuiToolTip,{content:nt},i.a.createElement(ee.EuiHeaderLink,{"data-test-subj":"assistantHeaderLink",color:"primary",onClick:n},i.a.createElement(ee.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(et.b,{size:"xs"})),i.a.createElement(ee.EuiFlexItem,{grow:!1},at)))):null},st=L.i18n.translate("xpack.securitySolution.globalHeader.buttonAddData",{defaultMessage:"Add integrations"}),rt=i.a.memo((()=>{const e=Object(a.useMemo)((()=>Object(te.c)()),[]),{theme:t,setHeaderActionMenu:n,i18n:s}=Object(O.i)().services,{pathname:r}=Object(S.useLocation)(),o=Object(a.useMemo)((()=>w.b.getTimelineByIdSelector()),[]),l=Object(b.b)((e=>{var t;return(null!==(t=o(e,z.c.active))&&void 0!==t?t:V.b).show})),u=Object(Z.a)(r),c=Object(Z.b)(r),d=Object(Je.isDashboardViewPath)(r),{href:m,onClick:p}=(()=>{const{http:{basePath:{prepend:e}},cloudExperiments:t}=Object(O.i)().services,{pathname:n}=Object(S.useLocation)(),{navigateTo:i}=Object(O.j)(),s=Object(Je.isThreatIntelligencePath)(n)?f.b:f.a,[r,o]=Object(a.useState)(s);Object(Xe.c)(t,"security-solutions.add-integrations-url",s,o);const l=Object(a.useMemo)((()=>e(r)),[e,r]),u=Object(a.useCallback)((e=>{e.preventDefault(),i({url:l})}),[l,i]);return{href:l,onClick:u}})();return Object(a.useEffect)((()=>(n((n=>Object(ne.a)(i.a.createElement(te.b,{node:e}),{theme:t,i18n:s})(n))),()=>{d||(e.unmount(),n(void 0))})),[e,n,t,s,d]),i.a.createElement(te.a,{node:e},i.a.createElement(ee.EuiHeaderSection,{side:"right"},Object(Je.isDetectionsPath)(r)&&i.a.createElement(ee.EuiHeaderSectionItem,null,i.a.createElement(Ke,null)),i.a.createElement(ee.EuiHeaderSectionItem,null,i.a.createElement(ee.EuiHeaderLinks,null,i.a.createElement(ee.EuiHeaderLink,{color:"primary","data-test-subj":"add-data",href:m,iconType:"indexOpen",onClick:p},st),c&&!l&&i.a.createElement(Ye.a,{scope:u,"data-test-subj":"sourcerer"}),i.a.createElement(it,null)))))}));rt.displayName="GlobalHeader";var ot=n(908),lt=n(526),ut=n(218),ct=n(31),dt=n(39);const mt=(e,t)=>{if(!t)return null;for(const a of t){var n;if(null!==(n=a.links)&&void 0!==n&&n.length){const t=mt(e,a.links);if(t)return t}if(e(a))return a}return null};var pt=n(1630),ft=n(1281),bt=n(1127),gt=n(704),vt=n(758);const yt=i.a.memo((()=>{const{pathname:e}=Object(S.useLocation)(),{browserFields:t,indexPattern:n}=Object(Z.d)(Object(Z.a)(e)),{services:{topValuesPopover:s}}=Object(O.i)(),r=Object(gt.useObservable)(s.getObservable()),o=Object(a.useCallback)((()=>{s.closePopover()}),[s]);return r&&r.nodeRef?i.a.createElement(ee.EuiWrappingPopover,{isOpen:!0,button:r.nodeRef,closePopover:o,anchorPosition:"downCenter",hasArrow:!1,repositionOnScroll:!0,ownFocus:!0,attachToAnchor:!1},i.a.createElement(vt.a,{field:r.fieldName,showLegend:!0,scopeId:r.scopeId,toggleTopN:o,indexPattern:n,browserFields:t})):null}));yt.displayName="TopValuesPopover";const ht=()=>{const{assistantAvailability:e}=Object(et.j)();return e.hasAssistantPrivilege?i.a.createElement(et.c,null):null},jt=({children:e})=>{const{pathname:t}=Object(S.useLocation)();Object(Z.c)(Object(Z.a)(t)),Object(ut.b)(),(()=>{const e=(e=>{const{getAppUrl:t}=Object(O.c)(),n=Object(O.d)(),{pathname:i}=Object(S.useLocation)(),s=Object(a.useCallback)((e=>{const a=t({deepLinkId:e.id});return!!Object(S.matchPath)(`${n}${dt.APP_PATH}${i}`,{path:a,strict:!1})}),[n,t,i]);return Object(a.useMemo)((()=>mt(s,e)),[e,s])})(Object(ct.b)());Object(a.useEffect)((()=>{var t;document.title=`${null!==(t=null==e?void 0:e.title)&&void 0!==t?t:""} - Kibana`}),[e])})(),Object(pt.a)();const{browserFields:n}=Object(Z.d)(Object(Z.a)(t));return Object(ft.b)(),Object(bt.f)(),i.a.createElement(J.h,{id:"security-solution-app",className:"kbnAppWrapper"},i.a.createElement(ot.a,null,i.a.createElement(lt.a,null,i.a.createElement(i.a.Fragment,null,i.a.createElement(rt,null),i.a.createElement(G,{browserFields:n},e),i.a.createElement(X,null),i.a.createElement(yt,null),i.a.createElement(ht,null)))))};jt.displayName="HomePage";const Et=i.a.memo(jt),Ot=({children:e,history:t,onAppLeave:n})=>{const{cases:s}=Object(O.i)().services,o=s.ui.getCasesContext(),l=s.helpers.canUseCases([f.i]),u=Object(r.useDispatch)();return Object(a.useEffect)((()=>()=>{u({type:"userChangedUrl",payload:{pathname:"",search:"",hash:""}})}),[u]),i.a.createElement(I,null,i.a.createElement(x.b,{history:t},i.a.createElement(T,null,i.a.createElement(x.c,null,i.a.createElement(x.a,{path:"/"},i.a.createElement(o,{owner:[f.i],permissions:l},i.a.createElement(Et,null,e))),i.a.createElement(x.a,null,i.a.createElement(A.a,null))))))},xt=Object(a.memo)(Ot);var St=n(891),kt=n(682),wt=n(706),Tt=n(9),Ct=n(50),Mt=n(117),It=n(1404);const At=L.i18n.translate("xpack.securitySolution.timelines.discoverInTimeline.save_saved_search_error",{defaultMessage:"Error while saving the Discover search"}),Pt=L.i18n.translate("xpack.securitySolution.timelines.discoverInTimeline.save_saved_search_unknown_error",{defaultMessage:"Unknown error occurred while saving Discover search"}),_t={from:"now-15m",to:"now",mode:"relative"},Dt=e=>{const t=Object(a.useRef)(),n=(e=>{const{addError:t}=Object(Mt.a)(),{services:{customDataService:n,savedSearch:i}}=Object(O.i)(),s=Object(r.useDispatch)(),o=Object(a.useMemo)((()=>w.b.getTimelineByIdSelector()),[]),l=Object(b.b)((e=>{var t;return null!==(t=o(e,k.f.active))&&void 0!==t?t:V.b})),{savedSearchId:u,version:c}=l,d=Object(a.useRef)(l);d.current=l;const m=Object(Ct.useQueryClient)(),{mutateAsync:p,status:f}=Object(Ct.useMutation)({mutationFn:({savedSearch:e,savedSearchOptions:t})=>i.save(e,t),onSuccess:e=>{e&&s(w.a.endTimelineSaving({id:k.f.active})),m.invalidateQueries({queryKey:["savedSearchById",u]})},mutationKey:[c]}),g=Object(a.useCallback)((async()=>({query:{esql:""},sort:[["@timestamp","desc"]],columns:[],interval:"auto",filters:[],hideChart:!0,grid:{}})),[]),v=Object(a.useCallback)((t=>{var n;return{savedSearch:t,appState:null===(n=e.current)||void 0===n?void 0:n.appState.getAppStateFromSavedSearch(t)}}),[e]),y=Object(a.useCallback)((t=>{var n,a,i;const{appState:s}=v(t);if(!s)return;null===(n=e.current)||void 0===n||n.appState.set(s);const r=t.timeRange;null===(a=e.current)||void 0===a||a.globalState.set({...null===(i=e.current)||void 0===i?void 0:i.globalState.get(),time:null!=r?r:_t})}),[v,e]),h=Object(a.useCallback)((async()=>{var t,n,a;const i=await g();null===(t=e.current)||void 0===t||t.appState.replaceUrlState(i),null===(n=e.current)||void 0===n||n.globalState.set({...null===(a=e.current)||void 0===a?void 0:a.globalState.get(),time:_t})}),[g,e]),j=Object(a.useCallback)((async(n,a)=>{if(e){if(n)try{const e=await p({savedSearch:n,savedSearchOptions:a});if(e)return{id:e};t(Pt,{title:At})}catch(e){t(e,{title:At})}}else console.log("Saved search is not open since state container is null")}),[t,e,p]),E=Object(a.useCallback)((async(e,t)=>{var a;if(e.timeRestore=!0,e.timeRange=null!==(a=e.timeRange)&&void 0!==a?a:n.query.timefilter.timefilter.getTime(),e.tags=["security-solution-default"],u)e.id=u,d.current.savedSearch?Object(Tt.isEqualWith)(d.current.savedSearch,e,It.a)||s(w.a.updateSavedSearch({id:k.f.active,savedSearch:e})):s(w.a.initializeSavedSearch({id:k.f.active,savedSearch:e}));else try{if("idle"!==f)return;s(w.a.startTimelineSaving({id:k.f.active}));const t=await j(e,{onTitleDuplicate:()=>{},copyOnSave:!u}),n=!t||!(null!=t&&t.id);if(n)throw new Error("Response is empty");u||n||(s(w.a.updateSavedSearchId({id:k.f.active,savedSearchId:t.id})),s(w.a.saveTimeline({id:k.f.active,saveAsNew:!1})))}catch(e){s(w.a.endTimelineSaving({id:k.f.active}))}}),[j,u,s,n,f]),x=Object(a.useCallback)((async(e,t)=>{s(w.a.initializeSavedSearch({id:k.f.active,savedSearch:e}))}),[s]);return Object(a.useMemo)((()=>({resetDiscoverAppState:h,restoreDiscoverAppStateFromSavedSearch:y,updateSavedSearch:E,initializeLocalSavedSearch:x,getAppStateFromSavedSearch:v,getDefaultDiscoverAppState:g})),[h,y,E,x,v,g])})(t),s=Object(a.useCallback)((e=>{t.current=e}),[]);return i.a.createElement(wt.a.Provider,{value:{discoverStateContainer:t,setDiscoverStateContainer:s,...n}},e.children)};var Rt=n(719),Ft=n(405),Nt=n(1631),Lt=n(23),zt=n.n(Lt);function Bt(e){return i.a.createElement(ee.EuiButtonEmpty,zt()({"data-test-subj":"stopGeneratingButton",color:"text",iconType:"stop",size:"s"},e),L.i18n.translate("xpack.securitySolution.aiAssistant.stopGeneratingButtonLabel",{defaultMessage:"Stop generating"}))}function qt(e){return i.a.createElement(ee.EuiButtonEmpty,zt()({size:"s","data-test-subj":"regenerateResponseButton",iconType:"sparkles"},e),L.i18n.translate("xpack.securitySolution.aiAssistant.regenerateResponseButtonLabel",{defaultMessage:"Regenerate"}))}function Vt(){return i.a.createElement(ee.EuiFlexGroup,{direction:"row",gutterSize:"s",alignItems:"center"},i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(ee.EuiIcon,{type:"alert",color:"danger",size:"s"})),i.a.createElement(ee.EuiFlexItem,null,i.a.createElement(ee.EuiText,{size:"s",color:"danger"},L.i18n.translate("xpack.securitySolution.aiAssistant.failedLoadingResponseText",{defaultMessage:"Failed to load response"}))))}function $t(e){return i.a.createElement(i.a.Fragment,null,e.body,e.error?i.a.createElement("span",{"data-test-subj":"messsage-error"},e.body?i.a.createElement(ee.EuiSpacer,{size:"xs"}):null,i.a.createElement(Vt,null)):null,e.controls?i.a.createElement(i.a.Fragment,null,i.a.createElement(ee.EuiSpacer,{size:"m"}),i.a.createElement(ee.EuiHorizontalRule,{margin:"none"}),i.a.createElement(ee.EuiSpacer,{size:"s"}),e.controls):null)}var Ut=n(179),Qt=n(59),Ht=n.n(Qt),Gt=n(55);const Wt=()=>{const e=(t,n)=>{if("children"in t){const n=t;n.children.forEach((t=>{e(t,n)}))}"code"!==t.type||"eql"!==t.lang&&"esql"!==t.lang&&"kql"!==t.lang&&"dsl"!==t.lang&&"json"!==t.lang||(t.type="customCodeBlock")};return t=>{e(t)}},Kt=({value:e})=>{const t=Object(ee.useEuiTheme)();return i.a.createElement(ee.EuiPanel,{hasShadow:!1,hasBorder:!1,paddingSize:"s",className:Ut.css`
        background-color: ${t.euiTheme.colors.lightestShade};
        .euiCodeBlock__pre {
          margin-bottom: 0;
          padding: ${t.euiTheme.size.m};
          min-block-size: 48px;
        }
        .euiCodeBlock__controls {
          inset-block-start: ${t.euiTheme.size.m};
          inset-inline-end: ${t.euiTheme.size.m};
        }
      `},i.a.createElement(ee.EuiFlexGroup,{direction:"column",gutterSize:"xs"},i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(ee.EuiCodeBlock,{isCopyable:!0,fontSize:"m"},e))))},Jt=Ut.css`
  @keyframes blink {
    0% {
      opacity: 0;
    }
    50% {
      opacity: 1;
    }
    100% {
      opacity: 0;
    }
  }

  animation: blink ${1}s infinite;
  width: 10px;
  height: 16px;
  vertical-align: middle;
  display: inline-block;
  background: ${Object(ee.transparentize)(Gt.euiThemeVars.euiColorDarkShade,.25)};
`,Yt=()=>i.a.createElement("span",{"data-test-subj":"cursor",key:"cursor",className:Ht()(Jt,"cursor")}),Xt=" ᠎  ",Zt=()=>{const e=(t,n)=>{var a;if("children"in t){const n=t;n.children.forEach((t=>{e(t,n)}))}if("text"!==t.type&&"inlineCode"!==t.type&&"code"!==t.type)return;const i=t;if(-1===i.value.indexOf(Xt))return;i.value=i.value.replace(Xt,"");const s=null!==(a=null==n?void 0:n.children.indexOf(i))&&void 0!==a?a:0;null==n||n.children.splice(s+1,0,{type:"cursor",value:Xt})};return t=>{e(t)}},en=()=>{const e=Object(ee.getDefaultEuiMarkdownParsingPlugins)(),t=Object(ee.getDefaultEuiMarkdownProcessingPlugins)(),{components:n}=t[1][1];return t[1][1].components={...n,cursor:Yt,customCodeBlock:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Kt,{value:e.value}),i.a.createElement(ee.EuiSpacer,{size:"m"})),table:e=>i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{className:"euiBasicTable"}," ",i.a.createElement("table",zt()({className:"euiTable"},e))),i.a.createElement(ee.EuiSpacer,{size:"m"})),th:e=>{const{children:t,...n}=e;return i.a.createElement("th",zt()({className:"euiTableHeaderCell"},n),i.a.createElement("span",{className:"euiTableCellContent"},i.a.createElement("span",{className:"euiTableCellContent__text",title:t},t)))},tr:e=>i.a.createElement("tr",zt()({className:"euiTableRow"},e)),td:e=>{const{children:t,...n}=e;return i.a.createElement("td",zt()({className:"euiTableRowCell"},n),i.a.createElement("div",{className:"euiTableCellContent euiTableCellContent--truncateText"},i.a.createElement("span",{className:"euiTableCellContent__text",title:t},t)))}},{parsingPluginList:[Zt,Wt,...e],processingPluginList:t}};function tn({loading:e,content:t,index:n}){const a=Ut.css`
    overflow-wrap: break-word;
  `,{parsingPluginList:s,processingPluginList:r}=en();return i.a.createElement(ee.EuiText,{className:a},i.a.createElement(ee.EuiMarkdownFormat,{className:`message-${n}`,"data-test-subj":"messageText",parsingPluginList:s,processingPluginList:r},`${t}${e?Xt:""}`))}const nn=({amendMessage:e,content:t,connectorTypeTitle:n,index:s,isError:r=!1,isFetching:o=!1,isLastComment:l,reader:u,regenerateMessage:c,transformMessage:d})=>{const{error:m,isLoading:p,isStreaming:f,pendingMessage:b,setComplete:g}=(({amendMessage:e,content:t,connectorTypeTitle:n,reader:i,isError:s})=>{const[r,o]=Object(a.useState)(),[l,u]=Object(a.useState)(!1),[c,d]=Object(a.useState)(),[m,p]=Object(a.useState)(),f=Object(a.useMemo)((()=>null==t&&null!=i?Object(Nt.b)({connectorTypeTitle:n,reader:i,setLoading:u,isError:s}):Object(Nt.a)()),[t,s,i,n]),b=Object(a.useCallback)((()=>{null==m||m.unsubscribe(),u(!1),e(null!=r?r:"")}),[e,r,m]),[g,v]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{g&&(v(!1),b())}),[g,b]),Object(a.useEffect)((()=>{const e=f.subscribe({next:({message:e,loading:t})=>{u(t),o(e)},complete:()=>{v(!0)},error:e=>{d(e.message)}});p(e)}),[f]),{error:c,isLoading:l,isStreaming:l&&null!=r,pendingMessage:null!=r?r:"",setComplete:v}})({amendMessage:e,content:t,connectorTypeTitle:n,reader:u,isError:r}),v=Object(a.useRef)({isStreaming:f,pendingMessage:b,amendMessage:e});Object(a.useEffect)((()=>{v.current={isStreaming:f,pendingMessage:b,amendMessage:e}}),[e,f,b]),Object(a.useEffect)((()=>()=>{var e;v.current.isStreaming&&v.current.pendingMessage.length>0&&v.current.amendMessage(null!==(e=v.current.pendingMessage)&&void 0!==e?e:"")}),[]);const y=Object(a.useMemo)((()=>null!=t?t:d(b).content),[t,d,b]),h=Object(a.useMemo)((()=>o||p||f),[o,p,f]),j=Object(a.useMemo)((()=>{if(null!=u&&l)return h?i.a.createElement(Bt,{onClick:()=>{g(!0)}}):i.a.createElement(ee.EuiFlexGroup,{direction:"row",justifyContent:"flexEnd"},i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(qt,{onClick:c})))}),[h,l,u,c,g]);return i.a.createElement($t,{body:i.a.createElement(tn,{content:y,index:s,loading:h}),error:m?new Error(m):void 0,controls:j})};var an=n(68),sn=n(181),rn=n(590),on=n(720),ln=n(130);const un=({message:e})=>{var t;const n=Object(O.m)(),s=Object(O.d)(),{cases:o}=Object(O.i)().services,l=Object(r.useDispatch)(),u=Object(ln.a)("assistantModelEvaluation"),{showAssistantOverlay:c}=Object(Ze.b)(),d=Object(a.useCallback)((e=>l(w.a.addNote({id:k.f.active,noteId:e}))),[l]),m=Object(a.useCallback)((e=>l(sn.a.updateNote({note:e}))),[l]),p=null!==(t=e.content)&&void 0!==t?t:"",f=Object(a.useCallback)((()=>{Object(rn.b)({associateNote:d,newNote:p,updateNewNote:()=>{},updateNote:m,user:""}),n.addSuccess(on.a)}),[d,p,n,m]),b=o.hooks.useCasesAddToExistingCaseModal({onClose:()=>{},onSuccess:()=>{}}),g=Object(a.useCallback)((()=>{c({showOverlay:!1}),b.open({getAttachments:()=>[{comment:p,type:an.AttachmentType.user,owner:on.f}]})}),[p,b,c]),v=null!=e.traceData?`${s}/app/apm/traces/explorer/waterfall?comparisonEnabled=false&detailTab=timeline&environment=ENVIRONMENT_ALL&kuery=&query=transaction.id:%20${e.traceData.transactionId}&rangeFrom=now-1y/d&rangeTo=now&showCriticalPath=false&traceId=${e.traceData.traceId}&transactionId=${e.traceData.transactionId}&type=kql&waterfallItemId=`:void 0;return i.a.createElement(ee.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},u&&null!=v&&i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(ee.EuiToolTip,{position:"top",content:on.g},i.a.createElement(ee.EuiButtonIcon,{"aria-label":on.g,color:"primary",iconType:"apmTrace",href:v,target:"_blank"}))),i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(ee.EuiToolTip,{position:"top",content:on.c},i.a.createElement(ee.EuiButtonIcon,{"aria-label":on.b,color:"primary",iconType:"editorComment",onClick:f}))),i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(ee.EuiToolTip,{position:"top",content:on.d},i.a.createElement(ee.EuiButtonIcon,{"aria-label":on.d,color:"primary",iconType:"addDataApp",onClick:g}))),i.a.createElement(ee.EuiFlexItem,{grow:!1},i.a.createElement(ee.EuiToolTip,{position:"top",content:on.e},i.a.createElement(ee.EuiCopy,{textToCopy:p},(e=>i.a.createElement(ee.EuiButtonIcon,{"aria-label":on.e,color:"primary",iconType:"copyClipboard",onClick:e}))))))},cn=i.a.memo(un);var dn=n(1515);const mn=({amendMessage:e,currentConversation:t,isFetchingResponse:n,regenerateMessage:a,showAnonymizedValues:s})=>{var r;const o=n=>{e({conversationId:t.id,content:n})},l=()=>{a(t.id)},u=null!==(r=t.apiConfig.connectorTypeTitle)&&void 0!==r?r:"",c=n?[{username:dn.b,timelineAvatar:i.a.createElement(ee.EuiLoadingSpinner,{size:"xl"}),timestamp:"...",children:i.a.createElement(nn,{amendMessage:o,connectorTypeTitle:u,content:"",regenerateMessage:l,isLastComment:!0,transformMessage:()=>({content:""}),isFetching:!0,index:999})}]:[];return[...t.messages.map(((e,n)=>{var a;const r=n===t.messages.length-1,c="user"===e.role,d=t.replacements,m={timelineAvatar:c?i.a.createElement(ee.EuiAvatar,{name:"user",size:"l",color:"subdued",iconType:"userAvatar"}):i.a.createElement(ee.EuiAvatar,{name:"machine",size:"l",color:"subdued",iconType:et.b}),timestamp:dn.c(0===e.timestamp.length?(new Date).toLocaleString():e.timestamp),username:c?dn.d:dn.b,eventColor:e.isError?"danger":void 0},p=t=>(({message:e,content:t,showAnonymizedValues:n,replacements:a})=>({...e,content:n||!a?t:Object(Ft.c)({messageContent:t,replacements:a})}))({message:e,content:t,showAnonymizedValues:s,replacements:d});if(!e.content||!e.content.length)return{...m,children:i.a.createElement(nn,{amendMessage:o,connectorTypeTitle:u,index:n,isLastComment:r,isError:e.isError,reader:e.reader,regenerateMessage:l,transformMessage:p})};const f=p(null!==(a=e.content)&&void 0!==a?a:"");return{...m,actions:i.a.createElement(cn,{message:f}),children:i.a.createElement(nn,{amendMessage:o,connectorTypeTitle:u,content:f.content,index:n,isLastComment:r,reader:f.reader,regenerateMessage:l,transformMessage:p})}})),...c]};var pn=n(485);const fn=["_id","@timestamp","cloud.availability_zone","cloud.provider","cloud.region","destination.ip","dns.question.name","dns.question.type","event.action","event.category","event.dataset","event.module","event.outcome","event.type","file.Ext.original.path","file.hash.sha256","file.name","file.path","host.name","host.risk.calculated_level","host.risk.calculated_score_norm","kibana.alert.last_detected","kibana.alert.risk_score","kibana.alert.rule.description","kibana.alert.rule.name","kibana.alert.rule.references","kibana.alert.rule.threat.framework","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.threat.technique.subtechnique.id","kibana.alert.rule.threat.technique.subtechnique.name","kibana.alert.rule.threat.technique.subtechnique.reference","kibana.alert.severity","kibana.alert.workflow_status","process.args","process.command_line","process.executable","process.Ext.token.integrity_level_name","process.entity_id","process.exit_code","process.hash.md5","process.hash.sha1","process.name","process.hash.sha256","process.parent.args","process.parent.args_count","process.parent.code_signature.exists","process.parent.code_signature.status","process.parent.code_signature.subject_name","process.parent.code_signature.trusted","process.parent.command_line","process.parent.entity_id","process.parent.executable","process.pid","process.working_directory","network.protocol","source.ip","user.domain","user.name","user.risk.calculated_level","user.risk.calculated_score_norm"],bn=["_id","cloud.availability_zone","cloud.provider","cloud.region","destination.ip","file.Ext.original.path","file.name","file.path","host.ip","host.name","source.ip","user.domain","user.name"];var gn=n(1085);const vn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.alertSummarizationTitle",{defaultMessage:"Alert summarization"}),yn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.alertSummarizationPrompt",{defaultMessage:"As an expert in security operations and incident response, provide a breakdown of the attached alert and summarize what it might mean for my organization."}),hn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.esqlQueryGenerationTitle",{defaultMessage:"ES|QL Query Generation"}),jn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.esqlQueryGenerationPrompt",{defaultMessage:"As an expert user of Elastic Security, please generate an accurate and valid ESQL query to detect the use case below. Your response should be formatted to be able to use immediately in an Elastic Security timeline or detection rule. Take your time with the answer, check your knowledge really well on all the functions I am asking for. For ES|QL answers specifically, you should only ever answer with what's available in your private knowledge. I cannot afford for queries to be inaccurate. Assume I am using the Elastic Common Schema and Elastic Agent.\n\nEnsure the answers are formatted in a way which is easily copyable as a separate code block in markdown."}),En=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.ruleCreationTitle",{defaultMessage:"Query generation"}),On=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.ruleCreationPrompt",{defaultMessage:"As an expert user of Elastic Security, please generate an accurate and valid EQL query to detect the use case below. Your response should be formatted to be able to use immediately in an Elastic Security timeline or detection rule. If Elastic Security already has a prebuilt rule for the use case, or a similar one, please provide a link to it and describe it."}),xn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.workflowAnalysisTitle",{defaultMessage:"Workflow suggestions"}),Sn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.workflowAnalysisPrompt",{defaultMessage:"As an expert user of Elastic Security, please suggest a workflow, with step by step instructions on how to:"}),kn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.threatInvestigationGuidesTitle",{defaultMessage:"Custom data ingestion helper"}),wn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.threatInvestigationGuidesPrompt",{defaultMessage:"As an expert user of Elastic Security, Elastic Agent, and Ingest pipelines, please list accurate and formatted, step by step instructions on how to ingest the following data using Elastic Agent and Fleet in Kibana and convert it to the Elastic Common Schema:"}),Tn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.splQueryConversionTitle",{defaultMessage:"Query conversion"}),Cn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.splQueryConversionPrompt",{defaultMessage:"I have the following query from a previous SIEM platform. As an expert user of Elastic Security, please suggest an Elastic EQL equivalent. I should be able to copy it immediately into an Elastic security timeline."}),Mn=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.AutomationTitle",{defaultMessage:"Agent integration advice"}),In=L.i18n.translate("xpack.securitySolution.assistant.quickPrompts.AutomationPrompt",{defaultMessage:"Which Fleet enabled Elastic Agent integration should I use to collect logs and events from:"}),An=[{title:vn,prompt:yn,color:"#F68FBE",categories:[gn.c],isDefault:!0},{title:hn,prompt:jn,color:"#9170B8",categories:[gn.a],isDefault:!0},{title:En,prompt:On,categories:[gn.d],color:"#7DDED8",isDefault:!0},{title:xn,prompt:Sn,color:"#36A2EF",isDefault:!0},{title:kn,prompt:wn,categories:[gn.e],color:"#F3D371",isDefault:!0},{title:Tn,prompt:Cn,color:"#BADA55",isDefault:!0},{title:Mn,prompt:In,color:"#FFA500",isDefault:!0}],Pn=L.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.youAreAHelpfulExpertAssistant",{defaultMessage:"You are a helpful, expert assistant who answers questions about Elastic Security."}),_n=L.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.useTheFollowingContextToAnswer",{defaultMessage:"Use the following context to answer questions:"}),Dn=L.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.ifYouDontKnowTheAnswer",{defaultMessage:"Do not answer questions unrelated to Elastic Security."}),Rn=L.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.superheroPersonality",{defaultMessage:"Provide the most detailed and relevant answer possible, as if you were relaying this information back to a cyber security expert."}),Fn=L.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.outputFormatting",{defaultMessage:'If you answer a question related to KQL, EQL, or ES|QL, it should be immediately usable within an Elastic Security timeline; please always format the output correctly with back ticks. Any answer provided for Query DSL should also be usable in a security timeline. This means you should only ever include the "filter" portion of the query.'}),Nn=[{id:"default-system-prompt",content:`${Pn} ${Dn}\n${Fn}\n${_n}`,name:L.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.defaultSystemPromptName",{defaultMessage:"Default system prompt"}),promptType:"system",isDefault:!0,isNewConversationDefault:!0},{id:"CB9FA555-B59F-4F71-AFF9-8A891AC5BC28",content:`${Pn} ${Dn}\n${Rn}\n${Fn}\n${_n}`,name:L.i18n.translate("xpack.securitySolution.assistant.content.prompts.system.superheroSystemPromptName",{defaultMessage:"Enhanced system prompt"}),promptType:"system",isDefault:!0}];var Ln=n(561);const zn=`${Ft.a}.defaultAllow`,Bn=`${Ft.a}.defaultAllowReplacement`;var qn=n(377),Vn=n(322);const $n=L.i18n.translate("xpack.securitySolution.assistant.title",{defaultMessage:"Elastic AI Assistant"}),Un=({children:e})=>{const{http:t,triggersActionsUi:{actionTypeRegistry:n},docLinks:{ELASTIC_WEBSITE_URL:s,DOC_LINK_VERSION:r}}=Object(O.i)().services,o=Object(O.d)(),l=Object(ln.a)("assistantModelEvaluation"),u=Object(ln.a)("assistantStreamingEnabled"),{conversations:c,setConversations:d}=Object(pn.a)(),m=Object(a.useCallback)((()=>c),[c]),p=Object(qn.a)(),b=Object(Rt.a)(),{defaultAllow:g,defaultAllowReplacement:v,setDefaultAllow:y,setDefaultAllowReplacement:h}=(()=>{const[e,t]=Object(Ln.a)({defaultValue:fn,key:zn,isInvalidDefault:e=>!Array.isArray(e)}),[n,a]=Object(Ln.a)({defaultValue:bn,key:Bn,isInvalidDefault:e=>!Array.isArray(e)});return{defaultAllow:e,defaultAllowReplacement:n,setDefaultAllow:t,setDefaultAllowReplacement:a}})(),j=`${f.i}.${Ft.a}`,{signalIndexName:E}=Object(Vn.a)(),x=null!=E?E:void 0,S=Object(Mt.a)();return i.a.createElement(et.d,{actionTypeRegistry:n,alertsIndexPattern:x,augmentMessageCodeBlocks:Ft.b,assistantAvailability:p,assistantTelemetry:b,defaultAllow:g,defaultAllowReplacement:v,docLinks:{ELASTIC_WEBSITE_URL:s,DOC_LINK_VERSION:r},baseAllow:fn,baseAllowReplacement:bn,basePath:o,basePromptContexts:Object.values(gn.b),baseQuickPrompts:An,baseSystemPrompts:Nn,getInitialConversations:m,getComments:mn,http:t,assistantStreamingEnabled:u,modelEvaluatorEnabled:l,nameSpace:j,setConversations:d,setDefaultAllow:y,setDefaultAllowReplacement:h,title:$n,toasts:S},e)},Qn=({children:e,history:t,onAppLeave:n,store:a,theme$:s})=>{const b=Object(O.i)().services,{i18n:g,analytics:v,application:{capabilities:h},uiActions:x,upselling:S}=b,[k]=Object(O.o)(f.C);return i.a.createElement(c.KibanaErrorBoundaryProvider,{analytics:v},i.a.createElement(c.KibanaErrorBoundary,null,i.a.createElement(g.Context,null,i.a.createElement(y.b,null,i.a.createElement(r.Provider,{store:a},i.a.createElement(o.KibanaThemeProvider,{theme$:s},i.a.createElement(l.EuiThemeProvider,{darkMode:k},i.a.createElement(E.b,null,i.a.createElement(St.b,{kibanaCapabilities:h},i.a.createElement(p.a,null,i.a.createElement(d.b,{core:b},i.a.createElement(kt.a,null,i.a.createElement(u.c,{getTriggerCompatibleActions:x.getTriggerCompatibleActions},i.a.createElement(m.a,{upsellingService:S},i.a.createElement(Dt,null,i.a.createElement(Un,null,i.a.createElement(xt,{history:t,onAppLeave:n},e)))))))))))),i.a.createElement(j,null),i.a.createElement(y.a,null))))))},Hn=Object(a.memo)(Qn),Gn=({children:e,history:t,onAppLeave:n,services:a,store:s,theme$:r})=>{var o,l;const u=null!==(o=null===(l=a.cloud)||void 0===l?void 0:l.CloudContextProvider)&&void 0!==o?o:i.a.Fragment;return i.a.createElement(O.a,{services:{appName:f.j,...a}},i.a.createElement(u,null,i.a.createElement(Hn,{history:t,onAppLeave:n,store:s,theme$:r},e)))},Wn=Object(a.memo)(Gn);var Kn=n(11),Jn=n.n(Kn);const Yn=({services:e,subPluginRoutes:t})=>{var n;const a=Jn()(e.extraRoutes$,null);return i.a.createElement(x.c,null,t.map(((e,t)=>i.a.createElement(x.a,zt()({key:`route-${t}`},e)))),null!==(n=null==a?void 0:a.map(((e,t)=>i.a.createElement(x.a,zt()({key:`extra-route-${t}`},e)))))&&void 0!==n?n:i.a.createElement(x.a,null,i.a.createElement(ee.EuiLoadingElastic,{size:"xl",style:{display:"flex",margin:"auto"}})),i.a.createElement(x.a,null,i.a.createElement(Xn,{capabilities:e.application.capabilities})))},Xn=i.a.memo((function({capabilities:e}){return!0===e[f.vc].show?i.a.createElement(S.Redirect,{to:f.Ib}):!0===e[f.r].read_cases?i.a.createElement(S.Redirect,{to:f.s}):i.a.createElement(A.a,null)})),Zn=({element:e,history:t,onAppLeave:n,services:a,store:r,usageCollection:o,subPluginRoutes:l,theme$:u})=>{var c;const d=null!==(c=null==o?void 0:o.components.ApplicationUsageTrackingProvider)&&void 0!==c?c:i.a.Fragment;return Object(s.render)(i.a.createElement(Wn,{history:t,onAppLeave:n,services:a,store:r,theme$:u},i.a.createElement(d,null,i.a.createElement(Yn,{subPluginRoutes:l,services:a}))),e),()=>{a.data.search.session.clear(),Object(s.unmountComponentAtNode)(e)}};var ea=n(342)}])]);