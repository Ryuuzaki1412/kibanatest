/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[38],{1134:function(e,t,i){"use strict";i.d(t,"b",(function(){return M})),i.d(t,"a",(function(){return P}));var n=i(2),l=i.n(n),a=i(17),c=i(44),o=i.n(c),r=i(48),s=i(124),u=i(127),d=i(110),m=i(5);const b=m.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeAnalyzerButton",{defaultMessage:"Close analyzer"}),p=m.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeSessionButton",{defaultMessage:"Close session viewer"});var v=i(122),j=i(118),g=i(121),S=i(282),O=i(134),y=i(112),T=i(745),E=i(116),h=i(1078),I=i(4),f=i(1109),w=i(562),C=i(189),F=i(446),D=i(135);const A=o()(a.EuiButtonIcon).withConfig({displayName:"FullScreenButtonIcon",componentId:"sc-tyt961-0"})(["margin:4px 0 4px 0;"]),x=({fullScreen:e,globalFullScreen:t,onCloseOverlay:i,isActiveTimelines:n,timelineFullScreen:c,toggleFullScreen:o,graphEventId:r,activeTab:s})=>l.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(a.EuiButtonEmpty,{iconType:"cross",onClick:i,size:"xs","data-test-subj":"close-overlay"},n?s===v.d.graph?b:p:r?b:p)),!1===n&&l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(a.EuiToolTip,{content:e?w.a:f.d},l.a.createElement(A,{"aria-label":Object(h.b)({globalFullScreen:t,isActiveTimelines:n,timelineFullScreen:c})?w.a:f.d,display:e?"fill":"empty",color:"primary","data-test-subj":"full-screen",iconType:"fullScreen",onClick:o}))));x.displayName="NavigationComponent";const V=l.a.memo(x),M=({scopeId:e})=>{const t=Object(r.useDispatch)(),i=Object(n.useMemo)((()=>Object(u.isTimelineScope)(e)?j.b.getTimelineByIdSelector():Object(u.isInTableScope)(e)?s.j.getTableByIdSelector():void 0),[e]),{globalFullScreen:a,setGlobalFullScreen:c}=Object(C.a)(),{timelineFullScreen:o,setTimelineFullScreen:d}=Object(C.c)(),m=Object(u.isTimelineScope)(e)?O.b:s.q,{graphEventId:b,sessionViewConfig:p,activeTab:g,prevActiveTab:S}=Object(y.a)((t=>{var n;return{activeTab:O.b.activeTab,prevActiveTab:O.b.prevActiveTab,...null!==(n=i&&i(t,e))&&void 0!==n?n:m}})),T=Object(u.getScopedActions)(e),E=Object(n.useCallback)((()=>{null!==document.querySelector(".euiDataGrid--fullScreen")?Object(u.isActiveTimeline)(e)?document.body.classList.add("euiDataGrid__restrictBody"):document.body.classList.add(I.rc,"euiDataGrid__restrictBody"):Object(u.isActiveTimeline)(e)?d(!1):c(!1),!1===Object(u.isActiveTimeline)(e)?T&&(t(T.updateGraphEventId({id:e,graphEventId:""})),t(T.updateSessionViewConfig({id:e,sessionViewConfig:null}))):g===v.d.graph?(T&&t(T.updateGraphEventId({id:e,graphEventId:""})),S!==v.d.session||p||t(j.a.setActiveTabTimeline({id:e,activeTab:v.d.query}))):g===v.d.session&&(Object(u.isTimelineScope)(e)&&(S!==v.d.graph||b?t(j.a.setActiveTabTimeline({id:e,activeTab:S})):t(j.a.setActiveTabTimeline({id:e,activeTab:v.d.query}))),T&&t(T.updateSessionViewConfig({id:e,sessionViewConfig:null})))}),[d,c,T,t,e,g,S,p,b]),f=Object(n.useMemo)((()=>Object(h.b)({globalFullScreen:a,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:o})),[a,e,o]),w=Object(n.useCallback)((()=>{Object(u.isActiveTimeline)(e)?d(!o):c(!a)}),[e,d,o,c,a]),F=Object(n.useMemo)((()=>l.a.createElement(V,{fullScreen:f,globalFullScreen:a,activeTab:g,onCloseOverlay:E,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:o,toggleFullScreen:w,graphEventId:b})),[f,a,g,E,e,o,w,b]);return{onCloseOverlay:E,Navigation:F}},P=({scopeId:e,entityType:t,height:i})=>{const{sessionView:a}=Object(d.i)().services,c=Object(n.useMemo)((()=>Object(u.isTimelineScope)(e)?j.b.getTimelineByIdSelector():Object(u.isInTableScope)(e)?s.j.getTableByIdSelector():void 0),[e]),{globalFullScreen:o}=Object(C.a)(),{timelineFullScreen:m}=Object(C.c)(),{canReadPolicyManagement:b}=Object(D.a)().endpointPrivileges,p=Object(u.isTimelineScope)(e)?O.b:s.q,{sessionViewConfig:I,activeTab:f}=Object(y.a)((t=>{var i;return{activeTab:O.b.activeTab,prevActiveTab:O.b.prevActiveTab,...null!==(i=c&&c(t,e))&&void 0!==i?i:p}})),w=Object(n.useMemo)((()=>Object(h.b)({globalFullScreen:o,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:m})),[o,e,m]),A=Object(n.useMemo)((()=>Object(u.isActiveTimeline)(e)?E.SourcererScopeName.timeline:F.a.includes(e)?E.SourcererScopeName.detections:E.SourcererScopeName.default),[e]),{openEventDetailsPanel:x,shouldShowDetailsPanel:V,DetailsPanel:M}=(({entityType:e,isFlyoutView:t,sourcererScope:i,scopeId:a,tabType:c=v.d.query})=>{const{browserFields:o,selectedPatterns:d,runtimeMappings:m}=Object(g.d)(i),b=Object(r.useDispatch)(),p=Object(n.useMemo)((()=>Object(u.isTimelineScope)(a)?j.b.getTimelineByIdSelector():Object(u.isInTableScope)(a)?s.j.getTableByIdSelector():void 0),[a]),E=Object(n.useMemo)((()=>d.join(",")),[d]),h=Object(y.a)((e=>{var t,i;return null===(t=null!==(i=p&&p(e,a))&&void 0!==i?i:O.b)||void 0===t?void 0:t.expandedDetail})),I=Object(n.useRef)((()=>{})),f=()=>{},w=Object(n.useMemo)((()=>{var e;return!!(c&&h&&h[c]&&null!==(e=h[c])&&void 0!==e&&e.panelView)}),[h,c]),C=Object(u.getScopedActions)(a),F=Object(n.useCallback)((e=>{e&&C&&b(C.toggleDetailPanel({...e,tabType:c,id:a}))}),[C,a,b,c]),D=Object(n.useCallback)(((e,t)=>{e&&F({panelView:"eventDetail",params:{eventId:e,indexName:E}}),I.current=null!=t?t:f}),[F,E]),A=Object(n.useCallback)(((e,t)=>{F({panelView:"hostDetail",params:{hostName:e}}),I.current=null!=t?t:f}),[F]),x=Object(n.useCallback)(((e,t,i)=>{F({panelView:"networkDetail",params:{ip:e,flowTarget:t}}),I.current=null!=i?i:f}),[F]),V=Object(n.useCallback)(((e,t)=>{F({panelView:"userDetail",params:{userName:e}}),I.current=null!=t?t:f}),[F]),M=Object(n.useCallback)((()=>{var e;I.current&&I.current(),C&&b(C.toggleDetailPanel({tabType:c,id:a})),c&&null!==(e=h[c])&&void 0!==e&&e.panelView&&a===v.c.active&&w&&S.a.toggleExpandedDetail({})}),[C,c,h,a,w,b]),P=Object(n.useMemo)((()=>w?l.a.createElement(T.a,{browserFields:o,entityType:e,handleOnPanelClosed:M,isFlyoutView:t,runtimeMappings:m,tabType:c,scopeId:a}):null),[o,e,M,t,m,w,c,a]);return{openEventDetailsPanel:D,openHostDetailsPanel:A,openNetworkDetailsPanel:x,openUserDetailsPanel:V,handleOnDetailsPanelClosed:M,shouldShowDetailsPanel:w,DetailsPanel:P}})({isFlyoutView:!Object(u.isActiveTimeline)(e),entityType:t,sourcererScope:A,scopeId:e,tabType:Object(u.isActiveTimeline)(e)?f:v.d.query}),P=Object(n.useMemo)((()=>{const e=i?i-118:void 0;return null!==I?a.getSessionView({...I,loadAlertDetails:x,isFullScreen:w,height:e,canReadPolicyManagement:b}):null}),[i,I,a,x,w,b]);return{openEventDetailsPanel:x,shouldShowDetailsPanel:V,SessionView:P,DetailsPanel:M}}},1315:function(e,t,i){"use strict";i.d(t,"a",(function(){return D}));var n=i(2),l=i.n(n),a=i(17),c=i(55),o=i(48),r=i(44),s=i.n(r),u=i(124),d=i(127),m=i(112),b=i(119),p=i(189),v=i(1078),j=i(181),g=i(906),S=i(866),O=i(118),y=i(134);const T="sessionViewFullScreen",E=Object(r.css)(["display:flex;flex-direction:column;flex:1;width:100%;"]),h=s.a.div.withConfig({displayName:"OverlayContainer",componentId:"sc-jhq5kd-0"})(["",""],E),I=Object(r.css)(["background-color:"," position:fixed;top:0;bottom:2em;left:0;right:0;z-index:",";"],(({theme:e})=>`${e.eui.euiColorEmptyShade};`),c.euiThemeVars.euiZLevel3),f=s.a.div.withConfig({displayName:"FullScreenOverlayContainer",componentId:"sc-jhq5kd-1"})(["",""],I),w=s()(g.a).withConfig({displayName:"StyledResolver",componentId:"sc-jhq5kd-2"})(["height:100%;"]),C=s()(a.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-jhq5kd-3"})([""," overflow:hidden;width:100%;&.","{","}"],(({theme:e})=>`background-color: ${e.eui.euiColorEmptyShade};`),T,(({theme:e})=>`padding: 0 ${e.eui.euiSizeM}`)),F=({SessionView:e,Navigation:t,scopeId:i})=>{const c=Object(o.useDispatch)(),{globalFullScreen:r}=Object(p.a)(),{timelineFullScreen:s}=Object(p.c)(),g=Object(n.useMemo)((()=>Object(d.isInTableScope)(i)?u.j.getTableByIdSelector():Object(d.isTimelineScope)(i)?O.b.getTimelineByIdSelector():void 0),[i]),F=Object(d.isInTableScope)(i)?u.q:y.b,{graphEventId:D,sessionViewConfig:A}=Object(m.a)((e=>{var t;return null!==(t=g&&g(e,i))&&void 0!==t?t:F})),x=Object(n.useMemo)((()=>Object(v.b)({globalFullScreen:r,isActiveTimelines:Object(d.isActiveTimeline)(i),timelineFullScreen:s})),[r,i,s]);Object(n.useEffect)((()=>()=>{const e=Object(d.getScopedActions)(i);e&&c(e.updateGraphEventId({id:i,graphEventId:""})),Object(d.isActiveTimeline)(i)?c(j.c.setFullScreen({id:b.a.timeline,fullScreen:!1})):c(j.c.setFullScreen({id:b.a.global,fullScreen:!1}))}),[c,i]);const{from:V,to:M,shouldUpdate:P,selectedPatterns:N}=Object(S.a)(Object(d.isActiveTimeline)(i)),k=Object(n.useMemo)((()=>({from:V,to:M})),[V,M]),z=Object(n.useRef)(null);Object(n.useLayoutEffect)((()=>{x&&z.current?z.current.setAttribute("style",I.join("")):z.current&&z.current.setAttribute("style",E.join(""))}),[x]);const B=Object(n.useMemo)((()=>void 0!==D?l.a.createElement(w,{databaseDocumentID:D,resolverComponentInstanceID:i,indices:N,shouldUpdate:P,filters:k}):l.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",style:{height:"100%"}},l.a.createElement(a.EuiLoadingSpinner,{size:"xl"}))),[D,i,N,P,k]);return Object(d.isActiveTimeline)(i)||null===A?x&&!Object(d.isActiveTimeline)(i)?l.a.createElement(f,{"data-test-subj":"overlayContainer"},l.a.createElement(a.EuiHorizontalRule,{margin:"none"}),l.a.createElement(a.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},l.a.createElement(a.EuiFlexItem,{grow:!1},t)),l.a.createElement(a.EuiHorizontalRule,{margin:"none"}),B):l.a.createElement(h,{"data-test-subj":"overlayContainer"},l.a.createElement(a.EuiHorizontalRule,{margin:"none"}),l.a.createElement(a.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween"},l.a.createElement(a.EuiFlexItem,{grow:!1},t)),l.a.createElement(a.EuiHorizontalRule,{margin:"none"}),B):l.a.createElement(h,{"data-test-subj":"overlayContainer",ref:z},l.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",direction:"column"},l.a.createElement(a.EuiHorizontalRule,{margin:"none"}),l.a.createElement(a.EuiFlexItem,{grow:!1},t),l.a.createElement(a.EuiHorizontalRule,{margin:"none"}),l.a.createElement(a.EuiSpacer,{size:"m"}),l.a.createElement(C,{grow:2,className:x?T:""},e)))},D=l.a.memo(F)},1710:function(e,t,i){"use strict";i.r(t),i.d(t,"default",(function(){return v}));var n=i(2),l=i.n(n),a=i(17),c=i(44),o=i.n(c),r=i(118),s=i(112),u=i(1315),d=i(1134);const m=o()(a.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-wo2hnu-0"})([""," overflow:hidden;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`)),b=o.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-wo2hnu-1"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade)),p=({timelineId:e})=>{const t=Object(n.useMemo)((()=>r.b.getTimelineByIdSelector()),[]),i=Object(s.b)((i=>{var n;return null===(n=t(i,e))||void 0===n?void 0:n.graphEventId})),{Navigation:a}=Object(d.b)({scopeId:e}),{shouldShowDetailsPanel:c,DetailsPanel:o,SessionView:p}=Object(d.a)({scopeId:e});return i?l.a.createElement(l.a.Fragment,null,l.a.createElement(u.a,{scopeId:e,Navigation:a,SessionView:p}),c&&l.a.createElement(l.a.Fragment,null,l.a.createElement(b,null),l.a.createElement(m,{grow:1},o))):null};p.displayName="GraphTabContentComponent";const v=l.a.memo(p)},906:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(2),l=i.n(n),a=i(48),c=i(957),o=i(271);const r=l.a.memo((e=>{const t=Object(a.useSelector)((t=>t.analyzer[e.resolverComponentInstanceID])),i=Object(a.useDispatch)();return t||i(Object(o.createResolver)({id:e.resolverComponentInstanceID})),Object(n.useEffect)((()=>{e.shouldUpdate&&i(Object(o.createResolver)({id:e.resolverComponentInstanceID}))}),[i,e.shouldUpdate,e.resolverComponentInstanceID]),l.a.createElement(c.a,e)}))}}]);