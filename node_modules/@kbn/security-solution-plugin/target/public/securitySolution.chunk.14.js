/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[14],{1275:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return g})),n.d(t,"a",(function(){return u}));var r=n(736),a=n(760),i=n(924),o=n(966);const s=e=>{const t={coreStart:e};return e=>n=>async s=>{n(s),(async({coreStart:e},{dispatch:t,getState:n},s)=>{const c=e.http,l=n();if("userChangedUrl"===s.type&&Object(a.f)(l)&&Object(a.d)(l)){const e=Object(a.i)(l);let n;try{n=(await Object(i.e)(c,e)).item,""===n.inputs[0].config.policy.value.windows.popup.malware.message&&(n.inputs[0].config.policy.value.windows.popup.malware.message=r.a,n.inputs[0].config.policy.value.mac.popup.malware.message=r.a,n.inputs[0].config.policy.value.linux.popup.malware.message=r.a),""===n.inputs[0].config.policy.value.windows.popup.ransomware.message&&(n.inputs[0].config.policy.value.windows.popup.ransomware.message=r.a),""===n.inputs[0].config.policy.value.windows.popup.memory_protection.message&&(n.inputs[0].config.policy.value.windows.popup.memory_protection.message=r.b),""===n.inputs[0].config.policy.value.mac.popup.memory_protection.message&&(n.inputs[0].config.policy.value.mac.popup.memory_protection.message=r.b),""===n.inputs[0].config.policy.value.linux.popup.memory_protection.message&&(n.inputs[0].config.policy.value.linux.popup.memory_protection.message=r.b),""===n.inputs[0].config.policy.value.windows.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.windows.popup.behavior_protection.message=r.b),""===n.inputs[0].config.policy.value.mac.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.mac.popup.behavior_protection.message=r.b),""===n.inputs[0].config.policy.value.linux.popup.behavior_protection.message&&(n.inputs[0].config.policy.value.linux.popup.behavior_protection.message=r.b)}catch(e){return void t({type:"serverFailedToReturnPolicyDetailsData",payload:e.body||e})}if(t({type:"serverReturnedPolicyDetailsData",payload:{policyItem:n}}),n.policy_id){const{results:e}=await Object(i.d)(c,n.policy_id);t({type:"serverReturnedPolicyDetailsAgentSummaryData",payload:{agentStatusSummary:e}})}}else if("userClickedPolicyDetailsSaveButton"===s.type){const{id:e}=Object(a.g)(l),n=Object(a.h)(l);let r;try{r=await Object(i.f)(c,e,n).catch((t=>t.response&&409===t.response.status?Object(i.e)(c,e).then((t=>{const r=t.item;return r.inputs[0].config.policy=n.inputs[0].config.policy,Object(i.f)(c,e,Object(o.a)(r))})):Promise.reject(t)))}catch(e){return void t({type:"serverReturnedPolicyDetailsUpdateFailure",payload:{success:!1,error:e.body||e}})}t({type:"serverReturnedUpdatedPolicyDetailsData",payload:{policyItem:r.item,updateStatus:{success:!0}}})}})(t,e,s)}};var c=n(734),l=n(238),d=n(178);const u=()=>({policyItem:void 0,isLoading:!1,agentStatusSummary:{error:0,events:0,offline:0,online:0,total:0,other:0,all:0,active:0},artifacts:{location:{page:d.b,pageSize:d.c,show:void 0,filter:""}}}),p=(e,t)=>({...e,inputs:e.inputs.map((e=>({...e,config:e.config&&{...e.config,policy:{...e.config.policy,value:t}}})))}),f=(e=u(),t)=>{if("serverReturnedPolicyDetailsData"===t.type||"serverReturnedUpdatedPolicyDetailsData"===t.type)return{...e,...t.payload,isLoading:!1};if("serverFailedToReturnPolicyDetailsData"===t.type)return{...e,isLoading:!1,apiError:t.payload};if("serverReturnedPolicyDetailsAgentSummaryData"===t.type)return{...e,...t.payload};if("serverReturnedPolicyDetailsUpdateFailure"===t.type)return{...e,isLoading:!1,updateStatus:t.payload};if("userClickedPolicyDetailsSaveButton"===t.type)return{...e,isLoading:!0,updateApiError:void 0};if("licenseChanged"===t.type)return{...e,license:t.payload};if("userChangedUrl"===t.type){const n={...e,location:t.payload,artifacts:{...e.artifacts,location:Object(l.b)(Object(c.parse)(t.payload.search.slice(1)))}},r=Object(a.d)(n),i=Object(a.d)(e),o=Object(a.e)(n);return r?i?n:{...n,isLoading:!0}:{...u(),location:t.payload,license:o}}if("userChangedPolicyConfig"===t.type){if(!e.policyItem)return e;const n={...e,policyItem:{...e.policyItem}},r={...Object(a.c)(e)};return n.policyItem.inputs[0].config.policy.value=r,Object.entries(t.payload.policyConfig).forEach((([e,t])=>{r[e]={...r[e],...t}})),n}if("userChangedAntivirusRegistration"===t.type){if(e.policyItem){const n=Object(a.c)(e);return{...e,policyItem:p(e.policyItem,{...n,windows:{...n.windows,antivirus_registration:{enabled:t.payload.enabled}}})}}return e}if("userChangedCredentialHardening"===t.type){if(e.policyItem){const n=Object(a.c)(e);return{...e,policyItem:p(e.policyItem,{...n,windows:{...n.windows,attack_surface_reduction:{credential_hardening:{enabled:t.payload.enabled}}}})}}return e}return e},g=(e=u(),t)=>[f].reduce(((e,n)=>n(e,t)),e)},1293:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(70),a=n(924);const i=(e,t={})=>{var n;return e.get(a.a,{...t,query:{...t.query,kuery:`${null!=t&&null!==(n=t.query)&&void 0!==n&&n.kuery?`${t.query.kuery} and `:""}${r.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`},version:r.API_VERSIONS.public.v1})}},1309:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(603),a=n.n(r);const i={macos:!0,windows:!0};function o(e){return e.includes("-")?e.substring(0,e.indexOf("-")):e}const s=({osName:e,version:t,capabilities:n})=>!(!t||!(({currentVersion:e,minVersionRequired:t="7.14.0"})=>{try{const n=o(e);return a()(t,n)}catch(n){return window&&window.console&&window.console.warn(`SecuritySolution: isVersionSupported(): Unable to determine if current version [${e}] meets minimum version [${t}]. Error: ${n.message}`),!1}})({currentVersion:t}))&&(function(e){const t=o(e);return a()("7.15.0",t)}(t)?function(e=[]){return e.includes("isolation")}(n):function(e){return(({currentOs:e,supportedOss:t=i})=>!!t[e])({currentOs:e.toLowerCase()})}(e))},1317:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u}));var r=n(2),a=n.n(r),i=n(17),o=n(1334),s=n(887),c=n(110);let l;!function(e){e.overview="details",e.activityLog="activity_log"}(l||(l={}));const d=Object(r.memo)((({tab:e,isSelected:t})=>{const{getAppUrl:n}=Object(c.c)(),r=Object(s.a)(e.route);return a.a.createElement(i.EuiTab,{href:n({path:e.route}),onClick:r,isSelected:t,key:e.id,"data-test-subj":`endpoint-details-flyout-tab-${e.id}`},e.name)}));d.displayName="EndpointDetailsTab";const u=Object(r.memo)((({hostname:e,isHostInfoLoading:t,show:n,tabs:s})=>{const c=Object(r.useMemo)((()=>s.find((e=>e.id===n))),[s,n]),l=s.map((e=>a.a.createElement(d,{key:e.id,tab:e,isSelected:e.id===(null==c?void 0:c.id)})));return a.a.createElement(a.a.Fragment,null,a.a.createElement(o.a,{hostname:e,isHostInfoLoading:t,hasBorder:!0},a.a.createElement(i.EuiTabs,{bottomBorder:!1,style:{marginBottom:"-25px"}},l)),a.a.createElement(i.EuiFlyoutBody,{"data-test-subj":`endpoint${"details"===(null==c?void 0:c.id)?"Details":"ActivityLog"}FlyoutBody`},null==c?void 0:c.content))}));u.displayName="EndpointDetailsFlyoutTabs"},1334:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(2),a=n.n(r),i=n(17),o=n(5),s=n(238),c=n(887),l=n(691),d=n(436),u=n(352);const p=Object(r.memo)((({endpointId:e})=>{var t;const{getAppUrl:n}=Object(u.a)(),{show:p,...f}=Object(l.b)(d.uiQueryParams),g=Object(r.useMemo)((()=>Object(s.d)({name:"endpointDetails",...f,selected_endpoint:e})),[f,e]),m=Object(c.a)(g),y=Object(r.useMemo)((()=>({title:o.i18n.translate("xpack.securitySolution.endpoint.policyResponse.backLinkTitle",{defaultMessage:"Endpoint details"}),href:n({path:g}),onClick:m})),[m,n,g]);return a.a.createElement("div",null,a.a.createElement(i.EuiButtonEmpty,{flush:"both","data-test-subj":"flyoutSubHeaderBackButton",iconType:"arrowLeft",size:"xs",href:null!==(t=null==y?void 0:y.href)&&void 0!==t?t:"",onClick:null==y?void 0:y.onClick},null==y?void 0:y.title))}));p.displayName="BackToEndpointDetailsFlyoutSubHeader";const f=Object(r.memo)((({children:e,endpointId:t,hasBorder:n=!1,hostname:r,isHostInfoLoading:o})=>a.a.createElement(i.EuiFlyoutHeader,{hasBorder:n},t&&a.a.createElement(p,{endpointId:t}),o?a.a.createElement(i.EuiSkeletonText,{lines:1}):a.a.createElement(i.EuiToolTip,{content:r,anchorClassName:"eui-textTruncate"},a.a.createElement(i.EuiTitle,{size:"s"},a.a.createElement("h2",{style:{overflow:"hidden",textOverflow:"ellipsis"},"data-test-subj":"endpointDetailsFlyoutTitle"},r))),e)));f.displayName="EndpointDetailsFlyoutHeader"},1383:function(e,t,n){"use strict";function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,i){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var s=/\+/g;e=e.split(t);var c=1e3;i&&"number"==typeof i.maxKeys&&(c=i.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var d=0;d<l;++d){var u,p,f,g,m=e[d].replace(s,"%20"),y=m.indexOf(n);y>=0?(u=m.substr(0,y),p=m.substr(y+1)):(u=m,p=""),f=decodeURIComponent(u),g=decodeURIComponent(p),r(o,f)?a(o[f])?o[f].push(g):o[f]=[o[f],g]:o[f]=g}return o};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},1384:function(e,t,n){"use strict";var r=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,s){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?i(o(e),(function(o){var s=encodeURIComponent(r(o))+n;return a(e[o])?i(e[o],(function(e){return s+encodeURIComponent(r(e))})).join(t):s+encodeURIComponent(r(e[o]))})).join(t):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(e)):""};var a=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function i(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r],r));return n}var o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},1410:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),a=n.n(r),i=n(48),o=n(18);const s=Object(r.memo)((({children:e})=>{const t=Object(i.useDispatch)();return Object(r.useEffect)((()=>{var e;const n=null===(e=o.a.getLicenseInformation$())||void 0===e?void 0:e.subscribe((e=>{t({type:"licenseChanged",payload:e})}));return()=>null==n?void 0:n.unsubscribe()}),[t]),a.a.createElement(a.a.Fragment,null,e)}));s.displayName="CurrentLicense"},1429:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(80),a=n(1275),i=n(178),o=n(436),s=n(200),c=n(894);const l=()=>({hosts:[],pageSize:10,pageIndex:0,total:0,sortDirection:s.h,sortField:s.i,loading:!1,error:void 0,location:void 0,policyItems:[],selectedPolicyId:void 0,policyItemsLoading:!1,endpointPackageInfo:Object(c.e)(),nonExistingPolicies:{},agentPolicies:{},endpointsExist:!0,patterns:[],patternsError:void 0,isAutoRefreshEnabled:!0,autoRefreshInterval:i.a,agentsWithEndpointsTotal:0,agentsWithEndpointsTotalError:void 0,endpointsTotal:0,endpointsTotalError:void 0,isolationRequestState:Object(c.e)(),endpointPendingActions:Object(c.c)(new Map),metadataTransformStats:Object(c.e)()}),d=r.combineReducers,u=(i.w,Object(a.a)(),i.u,l(),d({[i.w]:a.c,[i.u]:(e=l(),t)=>{if("serverReturnedEndpointList"===t.type){const{data:n,total:r,page:a,pageSize:i,sortDirection:o,sortField:s}=t.payload;return{...e,hosts:n,total:r,pageIndex:a,pageSize:i,sortField:s,sortDirection:o,loading:!1,error:void 0}}if("serverFailedToReturnEndpointList"===t.type)return{...e,error:t.payload,loading:!1};if("serverReturnedEndpointNonExistingPolicies"===t.type)return{...e,nonExistingPolicies:{...e.nonExistingPolicies,...t.payload}};if("serverReturnedEndpointAgentPolicies"===t.type)return{...e,agentPolicies:{...e.agentPolicies,...t.payload}};if("serverReturnedMetadataPatterns"===t.type)return{...e,patterns:t.payload,patternsError:void 0};if("serverFailedToReturnMetadataPatterns"===t.type)return{...e,patternsError:t.payload};if("endpointPendingActionsStateChanged"===t.type)return((e,t)=>Object(o.isOnEndpointPage)(e)?{...e,endpointPendingActions:t.payload}:e)(e,t);if("serverReturnedPoliciesForOnboarding"===t.type)return{...e,policyItems:t.payload.policyItems,policyItemsLoading:!1};if("serverFailedToReturnPoliciesForOnboarding"===t.type)return{...e,error:t.payload,policyItemsLoading:!1};if("userSelectedEndpointPolicy"===t.type)return{...e,selectedPolicyId:t.payload.selectedPolicyId};if("serverCancelledEndpointListLoading"===t.type)return{...e,loading:!1};if("serverCancelledPolicyItemsLoading"===t.type)return{...e,policyItemsLoading:!1};if("endpointPackageInfoStateChanged"===t.type)return((e,t)=>({...e,endpointPackageInfo:t.payload}))(e,t);if("serverReturnedEndpointExistValue"===t.type)return{...e,endpointsExist:t.payload};if("serverReturnedAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotal:t.payload,agentsWithEndpointsTotalError:void 0};if("serverFailedToReturnAgenstWithEndpointsTotal"===t.type)return{...e,agentsWithEndpointsTotalError:t.payload};if("serverReturnedEndpointsTotal"===t.type)return{...e,endpointsTotal:t.payload,endpointsTotalError:void 0};if("serverFailedToReturnEndpointsTotal"===t.type)return{...e,endpointsTotalError:t.payload};var n,r;if("userUpdatedEndpointListRefreshOptions"===t.type)return{...e,isAutoRefreshEnabled:null!==(n=t.payload.isAutoRefreshEnabled)&&void 0!==n?n:e.isAutoRefreshEnabled,autoRefreshInterval:null!==(r=t.payload.autoRefreshInterval)&&void 0!==r?r:e.autoRefreshInterval};if("endpointIsolationRequestStateChange"===t.type)return((e,t)=>({...e,isolationRequestState:t.payload}))(e,t);if("userChangedUrl"===t.type){const n={...e,location:t.payload},r=Object(o.isOnEndpointPage)(n)&&!Object(o.hasSelectedEndpoint)(n),a=Object(o.isOnEndpointPage)(e)&&!Object(o.hasSelectedEndpoint)(e),i=Object(o.isOnEndpointPage)(n)&&Object(o.hasSelectedEndpoint)(n),s=Object(o.isOnEndpointPage)(e)&&Object(o.hasSelectedEndpoint)(e),l={location:t.payload,error:void 0};if("isolate"===Object(o.uiQueryParams)(n).show||Object(c.i)(Object(o.getCurrentIsolationRequestState)(n))||(l.isolationRequestState=Object(c.e)()),r){if(!a)return{...e,...l,loading:!0,policyItemsLoading:!0}}else if(i)return s||a?{...e,...l,detailsLoading:!0}:{...e,...l,loading:!0,policyItemsLoading:!0};return{...e,...l,endpointsExist:!0}}return"metadataTransformStatsChanged"===t.type?((e,t)=>({...e,metadataTransformStats:t.payload}))(e,t):e}}))},1433:function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var r=n(128),a=n(178),i=n(1275),o=n(3),s=n(539),c=n.n(s),l=n(200),d=n(621),u=n(1330),p=n(1293),f=n(894),g=n(924),m=n(436);const y=console.error,h=(e,t)=>{async function n(e){var n;const r=null!==(n=Object(m.endpointPackageVersion)(e))&&void 0!==n?n:"",a=r.includes("-")?r.substring(0,r.indexOf("-")):r,i=c()(a,"1.2.0")?l.v:l.C,s=t.data.search.search({indices:[i],onlyCheckIfIndicesExist:!1},{strategy:l.k});return[{title:i,fields:(await Object(o.firstValueFrom)(s)).indexFields}]}return t=>r=>async a=>{r(a);const{getState:i,dispatch:o}=t;return await async function(e,t,n){if(Object(m.getIsEndpointPackageInfoUninitialized)(e)){t({type:"endpointPackageInfoStateChanged",payload:Object(f.d)(Object(f.a)(Object(m.endpointPackageInfo)(e)))});try{const e=await Object(g.c)(n.http);t({type:"endpointPackageInfoStateChanged",payload:Object(f.c)(e)})}catch(e){y(e),t({type:"endpointPackageInfoStateChanged",payload:Object(f.b)(e)})}}}(i(),o,e),"userChangedUrl"!==a.type&&"appRequestedEndpointList"!==a.type||!Object(m.isOnEndpointPage)(i())||await async function({store:e,coreStart:t,fetchIndexPatterns:n}){const{getState:r,dispatch:a}=e,{page_index:i,page_size:o,sort_field:s,sort_direction:c}=Object(m.uiQueryParams)(r());let d;try{const n=Object(m.searchBarQuery)(r());d=await t.http.get(l.r,{version:"2023-10-31",query:{page:i,pageSize:o,kuery:n.query,sortField:s,sortDirection:c}}),a({type:"serverReturnedEndpointList",payload:d}),O(e),async function({store:e,hosts:t,http:n}){const{getState:r,dispatch:a}=e;try{const e=await E(n,t,Object(m.nonExistingPolicies)(r()));void 0!==(null==e?void 0:e.packagePolicy)&&a({type:"serverReturnedEndpointNonExistingPolicies",payload:e.packagePolicy}),void 0!==(null==e?void 0:e.agentPolicy)&&a({type:"serverReturnedEndpointAgentPolicies",payload:e.agentPolicy})}catch(e){y(e)}}({http:t.http,hosts:d.data,store:e})}catch(e){a({type:"serverFailedToReturnEndpointList",payload:e})}if(0===Object(m.patterns)(r()).length)try{const e=await n(r());void 0!==e&&a({type:"serverReturnedMetadataPatterns",payload:e})}catch(e){a({type:"serverFailedToReturnMetadataPatterns",payload:e})}if(d&&0===d.data.length){const e=t.http;if(await b(e))return;a({type:"serverReturnedEndpointExistValue",payload:!1});try{a({type:"serverReturnedPoliciesForOnboarding",payload:{policyItems:(await Object(p.a)(e,{query:{perPage:50,page:1}})).items}})}catch(e){var u;a({type:"serverFailedToReturnPoliciesForOnboarding",payload:null!==(u=e.body)&&void 0!==u?u:e})}}else a({type:"serverCancelledPolicyItemsLoading"}),a({type:"serverReturnedEndpointExistValue",payload:!0})}({coreStart:e,store:t,fetchIndexPatterns:n}),"endpointIsolationRequest"===a.type?v(t,a):"loadMetadataTransformStats"===a.type?async function(e,t){const{getState:n,dispatch:r}=t;if(!e||!n||!r)return;const a=n();if(!Object(m.isMetadataTransformStatsLoading)(a)){r({type:"metadataTransformStatsChanged",payload:Object(f.d)(Object(f.a)(Object(m.getMetadataTransformStats)(a)))});try{const t=await e.get(l.u,{version:"2023-10-31"});r({type:"metadataTransformStatsChanged",payload:Object(f.c)(t.transforms)})}catch(e){r({type:"metadataTransformStatsChanged",payload:Object(f.b)(e)})}}}(e.http,t):void 0}},E=async(e,t,n)=>{if(0===t.length)return;const r=[...new Set(t.reduce(((e,t)=>{const r=t.metadata.Endpoint.policy.applied.id;return n[r]||e.push(r),e}),[]))];if(0===r.length)return;const a=(await Object(g.b)(e,r)).items.reduce(((e,t)=>(e.packagePolicy[t.id]=!0,e.agentPolicy[t.id]=t.policy_id,e)),{packagePolicy:{},agentPolicy:{}}),i=r.reduce(((e,t)=>a.packagePolicy[t]?(e.agentPolicy[t]=a.agentPolicy[t],e):(e.packagePolicy[t]=!0,e)),{packagePolicy:{},agentPolicy:{}});return 0!==Object.keys(i.packagePolicy).length||0!==Object.keys(i.agentPolicy).length?i:void 0},b=async e=>{try{return await(async e=>{try{return(await e.get(l.r,{version:"2023-10-31",query:{page:0,pageSize:1}})).total}catch(e){y("error while trying to check for total endpoints"),y(e)}return 0})(e)>0}catch(e){y("error while trying to check if endpoints exist"),y(e)}return!1},v=async({getState:e,dispatch:t},n)=>{const r=e();if(!Object(m.getIsIsolationRequestPending)(r)){t({type:"endpointIsolationRequestStateChange",payload:Object(f.d)(Object(f.a)(Object(m.getCurrentIsolationRequestState)(r)))});try{let e;e="unisolate"===n.payload.type?await Object(d.b)(n.payload.data):await Object(d.a)(n.payload.data),t({type:"endpointIsolationRequestStateChange",payload:Object(f.c)(e)})}catch(e){var a;t({type:"endpointIsolationRequestStateChange",payload:Object(f.b)(null!==(a=e.body)&&void 0!==a?a:e)})}}},O=async({getState:e,dispatch:t})=>{const n=e(),r=Object(m.listData)(n),a=new Set;for(const e of r)a.add(e.metadata.elastic.agent.id);if(0!==a.size)try{const{data:e}=await Object(u.a)(Array.from(a)),n=new Map;for(const t of e)n.set(t.agent_id,t.pending_actions);t({type:"endpointPendingActionsStateChanged",payload:Object(f.c)(n)})}catch(e){y(e)}},I=e=>t=>t[a.v][e],S=(e,t)=>[Object(r.f)(I(a.w),Object(i.b)(e,t)),Object(r.f)(I(a.u),h(e,t))]},173:function(e,t,n){const r=n(314),{MAX_LENGTH:a,MAX_SAFE_INTEGER:i}=n(315),{safeRe:o,t:s}=n(316),c=n(412),{compareIdentifiers:l}=n(514);class SemVer{constructor(e,t){if(t=c(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>a)throw new TypeError(`version is longer than ${a} characters`);r("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?o[s.LOOSE]:o[s.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>i||this.major<0)throw new TypeError("Invalid major version");if(this.minor>i||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>i||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<i)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(r("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),l(this.major,e.major)||l(this.minor,e.minor)||l(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],a=e.prerelease[t];if(r("prerelease compare",t,n,a),void 0===n&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===n)return-1;if(n!==a)return l(n,a)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],a=e.build[t];if(r("prerelease compare",t,n,a),void 0===n&&void 0===a)return 0;if(void 0===a)return 1;if(void 0===n)return-1;if(n!==a)return l(n,a)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let r=[t,e];!1===n&&(r=[t]),0===l(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=SemVer},1733:function(e,t,n){"use strict";n.r(t),n.d(t,"withSecurityContext",(function(){return v}));var r=n(2),a=n.n(r),i=n(80),o=n(1429),s=n(167),c=n(34),l=n(1433);const d=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||i.compose;var u=n(48),p=n(28),f=n(438),g=n(891),m=n(682),y=n(902),h=n(1410),E=n(110);const b=Object(r.memo)((({store:e,depsStart:t,queryClient:n,upsellingService:r,children:i})=>{const o=Object(E.i)().services,{application:{capabilities:s}}=o;return a.a.createElement(u.Provider,{store:e},a.a.createElement(m.a,{queryClient:n},a.a.createElement(y.a.Provider,{value:t},a.a.createElement(g.b,{kibanaCapabilities:s},a.a.createElement(p.b,{core:o},a.a.createElement(h.a,null,a.a.createElement(f.a,{upsellingService:r},i)))))))}));b.displayName="RenderContextProviders";const v=({coreStart:e,depsStart:t,services:{upsellingService:n},WrappedComponent:u})=>{let p;return Object(r.memo)((r=>(p||(p=(({coreStart:e,depsStart:t,reducersObject:n={management:o.a,app:s.b},preloadedState:r={management:void 0,app:{enableExperimental:c.a.get()}},additionalMiddleware:a=[]})=>Object(i.createStore)(Object(i.combineReducers)(n),r,d(Object(i.applyMiddleware)(...Object(l.a)(e,t),...a))))({coreStart:e,depsStart:t})),a.a.createElement(b,{store:p,depsStart:t,upsellingService:n},a.a.createElement(u,r)))))}},225:function(e,t,n){const r=n(173);e.exports=(e,t,n)=>new r(e,n).compare(new r(t,n))},238:function(e,t,n){"use strict";n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return m})),n.d(t,"h",(function(){return y})),n.d(t,"j",(function(){return h})),n.d(t,"o",(function(){return E})),n.d(t,"l",(function(){return b})),n.d(t,"a",(function(){return j})),n.d(t,"p",(function(){return w})),n.d(t,"b",(function(){return _})),n.d(t,"k",(function(){return P})),n.d(t,"f",(function(){return L})),n.d(t,"g",(function(){return N})),n.d(t,"m",(function(){return A})),n.d(t,"c",(function(){return $})),n.d(t,"i",(function(){return T})),n.d(t,"n",(function(){return D}));var r=n(45),a=n(734),i=n.n(a),o=n(49),s=n(185),c=n(876),l=n(875),d=n(178);const u=(e,t)=>void 0===e||e===t||0===e,p=(e,t={})=>`${e}${Object(s.a)(i.a.stringify(((e={})=>({...u(e.page,1)?{}:{page:e.page},...u(e.pageSize,d.c)?{}:{pageSize:e.pageSize},...u(e.show,void 0)?{}:{show:e.show},...u(e.itemId,void 0)?{}:{itemId:e.itemId},...u(e.filter,"")?"":{filter:e.filter},...u(e.includedPolicies,"")?"":{includedPolicies:e.includedPolicies}}))(t)))}`,f=e=>i.a.stringify(e),g=(e,t)=>{const{name:n,...a}=e,i=f(a),c=`${i&&!Object(r.isEmpty)(t)?"&":""}${null!=t?t:""}`;return"endpointList"===n?`${Object(o.generatePath)(d.h,{tabName:l.a.endpoints})}${Object(s.a)(`${i?`${i}${c}`:c}`)}`:`${Object(s.a)(`${i?`${i}${c}`:c}`)}`},m=(e,t)=>{const{name:n,show:a,...i}=e,c={...i};switch(e.name){case"endpointDetails":c.show="details";break;case"endpointIsolate":c.show="isolate";break;case"endpointUnIsolate":c.show="unisolate";break;case"endpointPolicyResponse":c.show="policy_response";break;case"endpointActivityLog":c.show="activity_log"}const u=f(c),p=`${u&&!Object(r.isEmpty)(t)?"&":""}${null!=t?t:""}`;return`${Object(o.generatePath)(d.h,{tabName:l.a.endpoints})}${Object(s.a)(`${u?`${u}${p}`:p}`)}`},y=e=>`${Object(o.generatePath)(d.k,{tabName:l.a.policies})}${Object(s.a)(e)}`,h=(e,t)=>`${Object(o.generatePath)(d.n,{tabName:l.a.policies,policyId:e})}${Object(s.a)(t)}`,E=(e,t)=>`${Object(o.generatePath)(d.r,{tabName:l.a.policies,policyId:e})}${Object(s.a)(t)}`,b=(e,t)=>`${Object(o.generatePath)(d.m,{tabName:l.a.policies,policyId:e})}${Object(s.a)(i.a.stringify(v(t)))}`,v=e=>e?{...u(e.page,d.b+1)?{}:{page:e.page},...u(e.pageSize,d.c)?{}:{pageSize:e.pageSize},...u(e.show,void 0)?{}:{show:e.show},...u(e.filter,"")?"":{filter:e.filter}}:{},O=(e,t)=>{const n=e[t];return Array.isArray(n)?n[n.length-1]:n},I=e=>{const t=Number(O(e,"page_index"));return!Number.isFinite(t)||t<0?d.b:t},S=e=>{const t=Number(O(e,"page_size"));return d.f.includes(t)?t:d.c},R=e=>O(e,"filter")||"",j=e=>({page_index:I(e),page_size:S(e),filter:R(e)}),w=e=>{const t=Object(o.generatePath)(d.t,{tabName:l.a.trustedApps});return p(t,e)},_=e=>{const t=O(e,"show"),n=Object(c.a)(e);return{page:n.page,pageSize:n.pageSize,filter:e.filter,show:t&&"list"===t?t:void 0}},P=(e,t)=>`${Object(o.generatePath)(d.r,{tabName:l.a.policies,policyId:e})}${Object(s.a)(i.a.stringify(v(t)))}`,L=e=>{const t=Object(o.generatePath)(d.i,{tabName:l.a.eventFilters});return p(t,e)},N=e=>{const t=Object(o.generatePath)(d.j,{tabName:l.a.hostIsolationExceptions});return p(t,e)},A=(e,t)=>`${Object(o.generatePath)(d.o,{tabName:l.a.policies,policyId:e})}${Object(s.a)(i.a.stringify(v(t)))}`,$=e=>{const t=Object(o.generatePath)(d.g,{tabName:l.a.blocklist});return p(t,e)},T=(e,t)=>`${Object(o.generatePath)(d.l,{tabName:l.a.policies,policyId:e})}${Object(s.a)(i.a.stringify(v(t)))}`,D=(e,t)=>`${Object(o.generatePath)(d.q,{tabName:l.a.policies,policyId:e})}${Object(s.a)(i.a.stringify(v(t)))}`},314:function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(391))},315:function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},316:function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:a,MAX_LENGTH:i}=n(315),o=n(314),s=(t=e.exports={}).re=[],c=t.safeRe=[],l=t.src=[],d=t.t={};let u=0;const p="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",i],[p,a]],g=(e,t,n)=>{const r=(e=>{for(const[t,n]of f)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),a=u++;o(e,a,t),d[e]=a,l[a]=t,s[a]=new RegExp(t,n?"g":void 0),c[a]=new RegExp(r,n?"g":void 0)};g("NUMERICIDENTIFIER","0|[1-9]\\d*"),g("NUMERICIDENTIFIERLOOSE","\\d+"),g("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),g("MAINVERSION",`(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})\\.(${l[d.NUMERICIDENTIFIER]})`),g("MAINVERSIONLOOSE",`(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})\\.(${l[d.NUMERICIDENTIFIERLOOSE]})`),g("PRERELEASEIDENTIFIER",`(?:${l[d.NUMERICIDENTIFIER]}|${l[d.NONNUMERICIDENTIFIER]})`),g("PRERELEASEIDENTIFIERLOOSE",`(?:${l[d.NUMERICIDENTIFIERLOOSE]}|${l[d.NONNUMERICIDENTIFIER]})`),g("PRERELEASE",`(?:-(${l[d.PRERELEASEIDENTIFIER]}(?:\\.${l[d.PRERELEASEIDENTIFIER]})*))`),g("PRERELEASELOOSE",`(?:-?(${l[d.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[d.PRERELEASEIDENTIFIERLOOSE]})*))`),g("BUILDIDENTIFIER",`${p}+`),g("BUILD",`(?:\\+(${l[d.BUILDIDENTIFIER]}(?:\\.${l[d.BUILDIDENTIFIER]})*))`),g("FULLPLAIN",`v?${l[d.MAINVERSION]}${l[d.PRERELEASE]}?${l[d.BUILD]}?`),g("FULL",`^${l[d.FULLPLAIN]}$`),g("LOOSEPLAIN",`[v=\\s]*${l[d.MAINVERSIONLOOSE]}${l[d.PRERELEASELOOSE]}?${l[d.BUILD]}?`),g("LOOSE",`^${l[d.LOOSEPLAIN]}$`),g("GTLT","((?:<|>)?=?)"),g("XRANGEIDENTIFIERLOOSE",`${l[d.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),g("XRANGEIDENTIFIER",`${l[d.NUMERICIDENTIFIER]}|x|X|\\*`),g("XRANGEPLAIN",`[v=\\s]*(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:\\.(${l[d.XRANGEIDENTIFIER]})(?:${l[d.PRERELEASE]})?${l[d.BUILD]}?)?)?`),g("XRANGEPLAINLOOSE",`[v=\\s]*(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[d.XRANGEIDENTIFIERLOOSE]})(?:${l[d.PRERELEASELOOSE]})?${l[d.BUILD]}?)?)?`),g("XRANGE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAIN]}$`),g("XRANGELOOSE",`^${l[d.GTLT]}\\s*${l[d.XRANGEPLAINLOOSE]}$`),g("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),g("COERCERTL",l[d.COERCE],!0),g("LONETILDE","(?:~>?)"),g("TILDETRIM",`(\\s*)${l[d.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",g("TILDE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAIN]}$`),g("TILDELOOSE",`^${l[d.LONETILDE]}${l[d.XRANGEPLAINLOOSE]}$`),g("LONECARET","(?:\\^)"),g("CARETTRIM",`(\\s*)${l[d.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",g("CARET",`^${l[d.LONECARET]}${l[d.XRANGEPLAIN]}$`),g("CARETLOOSE",`^${l[d.LONECARET]}${l[d.XRANGEPLAINLOOSE]}$`),g("COMPARATORLOOSE",`^${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]})$|^$`),g("COMPARATOR",`^${l[d.GTLT]}\\s*(${l[d.FULLPLAIN]})$|^$`),g("COMPARATORTRIM",`(\\s*)${l[d.GTLT]}\\s*(${l[d.LOOSEPLAIN]}|${l[d.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",g("HYPHENRANGE",`^\\s*(${l[d.XRANGEPLAIN]})\\s+-\\s+(${l[d.XRANGEPLAIN]})\\s*$`),g("HYPHENRANGELOOSE",`^\\s*(${l[d.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[d.XRANGEPLAINLOOSE]})\\s*$`),g("STAR","(<|>)?=?\\s*\\*"),g("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),g("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},412:function(e,t){const n=Object.freeze({loose:!0}),r=Object.freeze({});e.exports=e=>e?"object"!=typeof e?n:e:r},436:function(e,t,n){"use strict";n.r(t),n.d(t,"listData",(function(){return p})),n.d(t,"pageIndex",(function(){return f})),n.d(t,"pageSize",(function(){return g})),n.d(t,"sortField",(function(){return m})),n.d(t,"sortDirection",(function(){return y})),n.d(t,"totalHits",(function(){return h})),n.d(t,"listLoading",(function(){return E})),n.d(t,"listError",(function(){return b})),n.d(t,"policyItems",(function(){return v})),n.d(t,"policyItemsLoading",(function(){return O})),n.d(t,"selectedPolicyId",(function(){return I})),n.d(t,"endpointPackageInfo",(function(){return S})),n.d(t,"getIsEndpointPackageInfoUninitialized",(function(){return R})),n.d(t,"isAutoRefreshEnabled",(function(){return j})),n.d(t,"autoRefreshInterval",(function(){return w})),n.d(t,"endpointPackageVersion",(function(){return _})),n.d(t,"patterns",(function(){return P})),n.d(t,"patternsError",(function(){return L})),n.d(t,"isOnEndpointPage",(function(){return N})),n.d(t,"uiQueryParams",(function(){return A})),n.d(t,"hasSelectedEndpoint",(function(){return $})),n.d(t,"showView",(function(){return T})),n.d(t,"nonExistingPolicies",(function(){return D})),n.d(t,"agentPolicies",(function(){return k})),n.d(t,"endpointsExist",(function(){return C})),n.d(t,"searchBarQuery",(function(){return F})),n.d(t,"getCurrentIsolationRequestState",(function(){return x})),n.d(t,"getIsIsolationRequestPending",(function(){return M})),n.d(t,"getWasIsolationRequestSuccessful",(function(){return U})),n.d(t,"getIsolationRequestError",(function(){return G})),n.d(t,"getIsOnEndpointDetailsActivityLog",(function(){return V})),n.d(t,"getEndpointPendingActionsState",(function(){return B})),n.d(t,"getMetadataTransformStats",(function(){return q})),n.d(t,"metadataTransformStats",(function(){return X})),n.d(t,"isMetadataTransformStatsLoading",(function(){return H})),n.d(t,"getEndpointPendingActionsCallback",(function(){return z}));var r=n(734),a=n.n(r),i=n(57),o=n(49),s=n(60),c=n(238),l=n(178),d=n(894),u=n(1317);const p=e=>e.hosts,f=e=>e.pageIndex,g=e=>e.pageSize,m=e=>e.sortField,y=e=>e.sortDirection,h=e=>e.total,E=e=>e.loading,b=e=>e.error,v=e=>e.policyItems,O=e=>e.policyItemsLoading,I=e=>e.selectedPolicyId,S=e=>e.endpointPackageInfo,R=Object(i.createSelector)(S,(e=>Object(d.i)(e))),j=e=>e.isAutoRefreshEnabled,w=e=>e.autoRefreshInterval,_=Object(i.createSelector)(S,(e=>Object(d.g)(e)?e.data.version:void 0)),P=e=>e.patterns,L=e=>e.patternsError,N=e=>{var t,n;return null!==Object(o.matchPath)(null!==(t=null===(n=e.location)||void 0===n?void 0:n.pathname)&&void 0!==t?t:"",{path:l.h,exact:!0})},A=Object(i.createSelector)((e=>e.location),(e=>{const t={page_index:String(l.b),page_size:String(l.c)};if(e){const n=a.a.parse(e.search.slice(1)),r=Object(c.a)(n),i=["selected_endpoint","show","admin_query","sort_field","sort_direction"],o=["policy_response","details","isolate","unisolate","activity_log"];for(const e of i){const r="string"==typeof n[e]?n[e]:Array.isArray(n[e])?n[e][n[e].length-1]:void 0;void 0!==r&&("show"===e?o.includes(r)&&(t[e]=r):"sort_direction"===e?["asc","desc"].includes(r)&&(t[e]=r):t[e]=r)}t.page_size=String(r.page_size),t.page_index=String(r.page_index)}return t})),$=Object(i.createSelector)(A,(({selected_endpoint:e})=>void 0!==e)),T=Object(i.createSelector)(A,(e=>{var t;return null!==(t=e.show)&&void 0!==t?t:"details"})),D=e=>e.nonExistingPolicies,k=e=>e.agentPolicies,C=e=>e.endpointsExist,F=Object(i.createSelector)(A,(({admin_query:e})=>{const t={query:"",language:"kuery"};if(e){const n=Object(s.decode)(e);n&&"string"==typeof n.query&&(t.query=n.query),!n||"string"!=typeof n.language||"kuery"!==n.language&&"lucene"!==n.language||(t.language=n.language)}return t})),x=e=>e.isolationRequestState,M=Object(i.createSelector)(x,(e=>Object(d.h)(e))),U=Object(i.createSelector)(x,(e=>Object(d.g)(e))),G=Object(i.createSelector)(x,(e=>{if(Object(d.f)(e))return e.error})),V=Object(i.createSelector)(A,(e=>e.show===u.b.activityLog)),B=e=>e.endpointPendingActions,q=e=>e.metadataTransformStats,X=e=>Object(d.g)(e.metadataTransformStats)?e.metadataTransformStats.data:[],H=e=>Object(d.h)(e.metadataTransformStats),z=Object(i.createSelector)(B,(e=>t=>{let n={};var r;return Object(d.g)(e)&&(n=null!==(r=e.data.get(t))&&void 0!==r?r:{}),n}))},438:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(2),a=n.n(r);const i=a.a.createContext(null),o=Object(r.memo)((({upsellingService:e,children:t})=>a.a.createElement(i.Provider,{value:e},t)));o.displayName="UpsellingProvider";const s=()=>{const e=Object(r.useContext)(i);if(!e)throw new Error("UpsellingProviderContext not found");return e}},514:function(e,t){const n=/^[0-9]+$/,r=(e,t)=>{const r=n.test(e),a=n.test(t);return r&&a&&(e=+e,t=+t),e===t?0:r&&!a?-1:a&&!r?1:e<t?-1:1};e.exports={compareIdentifiers:r,rcompareIdentifiers:(e,t)=>r(t,e)}},539:function(e,t,n){const r=n(225);e.exports=(e,t,n)=>r(e,t,n)>=0},603:function(e,t,n){const r=n(225);e.exports=(e,t,n)=>r(e,t,n)<=0},682:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(2),a=n.n(r),i=n(50);class SecuritySolutionQueryClient extends i.QueryClient{constructor(e={}){var t,n,r;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(n=null==e||null===(r=e.defaultOptions)||void 0===r?void 0:r.queries)&&void 0!==n?n:{}}}})}}const o=new SecuritySolutionQueryClient,s=Object(r.memo)((({queryClient:e,children:t})=>{const n=Object(r.useMemo)((()=>e||o),[e]);return a.a.createElement(i.QueryClientProvider,{client:n},t)}));s.displayName="ReactQueryClientProvider"},691:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return E}));var r=n(48),a=n(178);function i(e){return Object(r.useSelector)((function(t){return e(t[a.v][a.u])}))}var o=n(2),s=n.n(o),c=n(47),l=n(88),d=n(135),u=n(744),p=n(4),f=n(238),g=n(436),m=n(352),y=n(226),h=n(1309);const E=(e,t)=>{const{getAppUrl:n}=Object(m.a)(),r=i(g.agentPolicies),a=i(g.uiQueryParams),E=Object(u.d)(),{canAccessResponseConsole:b,canIsolateHost:v,canUnIsolateHost:O,canAccessEndpointActionsLogManagement:I,canAccessFleet:S}=Object(d.a)().endpointPrivileges;return Object(o.useMemo)((()=>{if(!e)return[];const i=Object(y.b)(e),o=e.agent.id,d=e.Endpoint.policy.applied.id,u=e.host.hostname,g=e.elastic.agent.id,m=Object(h.a)({osName:e.host.os.name,version:e.agent.version,capabilities:e.Endpoint.capabilities}),{show:R,selected_endpoint:j,...w}=a,_=Object(f.d)({name:"endpointActivityLog",...w,selected_endpoint:o}),P=Object(f.d)({name:"endpointIsolate",...w,selected_endpoint:o}),L=Object(f.d)({name:"endpointUnIsolate",...w,selected_endpoint:o}),N=[];return i&&O?N.push({"data-test-subj":"unIsolateLink",icon:"lockOpen",key:"unIsolateHost",navigateAppId:p.l,navigateOptions:{path:L},href:n({path:L}),children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.unIsolateHost",defaultMessage:"Release host"})}):m&&v&&N.push({"data-test-subj":"isolateLink",icon:"lock",key:"isolateHost",navigateAppId:p.l,navigateOptions:{path:P},href:n({path:P}),children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.isolateHost",defaultMessage:"Isolate host"})}),[...N,...b?[{"data-test-subj":"console",icon:"console",key:"consoleLink",onClick:t=>{t.preventDefault(),E(e)},children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.console",defaultMessage:"Respond"})}]:[],...null!=t&&t.isEndpointList&&I?[{"data-test-subj":"actionsLink",icon:"logoSecurity",key:"actionsLogLink",navigateAppId:p.l,navigateOptions:{path:_},href:n({path:_}),children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.responseActionsHistory",defaultMessage:"View response actions history"})}]:[],{"data-test-subj":"hostLink",icon:"logoSecurity",key:"hostDetailsLink",navigateAppId:p.l,navigateOptions:{path:`/hosts/${u}`},href:n({path:`/hosts/${u}`}),children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.hostDetails",defaultMessage:"View host details"})},...S?[{icon:"gear",key:"agentConfigLink","data-test-subj":"agentPolicyLink",navigateAppId:"fleet",navigateOptions:{path:`${l.pagePathGetters.policy_details({policyId:r[d]})[1]}`},href:`${n({appId:"fleet"})}${l.pagePathGetters.policy_details({policyId:r[d]})[1]}`,disabled:void 0===r[d],children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicy",defaultMessage:"View agent policy"})},{icon:"gear",key:"agentDetailsLink","data-test-subj":"agentDetailsLink",navigateAppId:"fleet",navigateOptions:{path:`${l.pagePathGetters.agent_details({agentId:g})[1]}`},href:`${n({appId:"fleet"})}${l.pagePathGetters.agent_details({agentId:g})[1]}`,children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentDetails",defaultMessage:"View agent details"})},{icon:"gear",key:"agentPolicyReassignLink","data-test-subj":"agentPolicyReassignLink",navigateAppId:"fleet",navigateOptions:{path:`${l.pagePathGetters.agent_details({agentId:g})[1]}?openReassignFlyout=true`,state:{onDoneNavigateTo:[p.l,{path:Object(f.e)({name:"endpointList"})}]}},href:`${n({appId:"fleet"})}${l.pagePathGetters.agent_details({agentId:g})[1]}?openReassignFlyout=true`,children:s.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.endpoint.actions.agentPolicyReassign",defaultMessage:"Reassign agent policy"})}]:[]]}),[a,b,I,e,r,n,E,null==t?void 0:t.isEndpointList,v,O,S])}},734:function(e,t,n){"use strict";t.decode=t.parse=n(1383),t.encode=t.stringify=n(1384)},736:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return l}));var r=n(186);const a=(e="",t=!1,n="",a="",i="",o=!1)=>({meta:{license:e,license_uuid:n,cluster_uuid:a,cluster_name:i,cloud:t,serverless:o},global_manifest_version:"latest",windows:{events:{credential_access:!0,dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:r.f.prevent,blocklist:!0},ransomware:{mode:r.f.prevent,supported:!0},memory_protection:{mode:r.f.prevent,supported:!0},behavior_protection:{mode:r.f.prevent,reputation_service:t,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{enabled:!1},attack_surface_reduction:{credential_hardening:{enabled:!0}}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:r.f.prevent,blocklist:!0},behavior_protection:{mode:r.f.prevent,reputation_service:t,supported:!0},memory_protection:{mode:r.f.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"},advanced:{capture_env_vars:"DYLD_INSERT_LIBRARIES,DYLD_FRAMEWORK_PATH,DYLD_LIBRARY_PATH,LD_PRELOAD"}},linux:{events:{process:!0,file:!0,network:!0,session_data:!1,tty_io:!1},malware:{mode:r.f.prevent,blocklist:!0},behavior_protection:{mode:r.f.prevent,reputation_service:t,supported:!0},memory_protection:{mode:r.f.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"},advanced:{capture_env_vars:"LD_PRELOAD,LD_LIBRARY_PATH"}}}),i=(e=a())=>({...e,global_manifest_version:"latest"}),o=(e=a())=>{const t={rollback:{self_healing:{enabled:!1}}};return{...e,global_manifest_version:"latest",windows:{...e.windows,advanced:void 0===e.windows.advanced?void 0:{...e.windows.advanced,alerts:void 0===e.windows.advanced.alerts?{...t}:{...e.windows.advanced.alerts,...t}},ransomware:{mode:r.f.off,supported:!1},memory_protection:{mode:r.f.off,supported:!1},behavior_protection:{mode:r.f.off,reputation_service:!1,supported:!1},attack_surface_reduction:{credential_hardening:{enabled:!1}},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:r.f.off,reputation_service:!1,supported:!1},memory_protection:{mode:r.f.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:r.f.off,reputation_service:!1,supported:!1},memory_protection:{mode:r.f.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}},s=(e=a())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),c="Elastic Security {action} {filename}",l="Elastic Security {action} {rule}"},760:function(e,t,n){"use strict";n.d(t,"g",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return y})),n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return S}));var r=n(49),a=n(57),i=n(33),o=n(736),s=n(178),c=n(966),l=n(884);const d=e=>e.policyItem,u=Object(a.createSelector)(d,(e=>e.license),((e,t)=>{if(e){const n=((e,t)=>{if(Object(i.b)(t,"enterprise"))return Object(o.d)(e);if(Object(i.b)(t,"platinum")){const t=Object(o.d)(e);return Object(o.e)(t)}return Object(o.f)(e)})(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:n}}}]}}return e})),p=Object(a.createSelector)(u,(e=>{if(e)return Object(c.a)(e)})),f=e=>!e.policyItem&&!e.apiError,g=e=>Object(l.e)(e)||Object(l.f)(e)||Object(l.d)(e)||Object(l.c)(e)||Object(l.b)(e)||Object(l.g)(e),m=e=>e.license,y=Object(a.createSelector)((e=>e.location),(e=>{var t,n,a,i;return null!==(t=null===(n=Object(r.matchPath)(null!==(i=null==e?void 0:e.pathname)&&void 0!==i?i:"",{path:[s.n,s.r,s.m,s.o,s.l,s.q],exact:!0}))||void 0===n||null===(a=n.params)||void 0===a?void 0:a.policyId)&&void 0!==t?t:""})),h=Object(o.c)(),E=Object(a.createSelector)(u,(e=>{var t,n,r,a;return null!==(t=null==e||null===(n=e.inputs[0])||void 0===n||null===(r=n.config)||void 0===r||null===(a=r.policy)||void 0===a?void 0:a.value)&&void 0!==t?t:h})),b=Object(a.createSelector)(E,(e=>null==e?void 0:e.windows)),v=Object(a.createSelector)(E,(e=>null==e?void 0:e.mac)),O=Object(a.createSelector)(E,(e=>null==e?void 0:e.linux)),I=(Object(a.createSelector)(b,v,O,((e,t,n)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration,attack_surface_reduction:e.attack_surface_reduction},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:n.advanced,events:n.events,malware:n.malware,behavior_protection:n.behavior_protection,memory_protection:n.memory_protection,popup:n.popup}}))),e=>e.apiError),S=e=>e.agentStatusSummary},884:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return f}));var r=n(49),a=n(57),i=n(178);const o=e=>e.artifacts.location,s=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},c=Object(a.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:i.n,exact:!0}))),l=Object(a.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:i.r,exact:!0}))),d=Object(a.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:i.m,exact:!0}))),u=Object(a.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:i.o,exact:!0}))),p=Object(a.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:i.l,exact:!0}))),f=Object(a.createSelector)(s,(e=>null!==Object(r.matchPath)(null!=e?e:"",{path:i.q,exact:!0})))},887:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2),a=n(49);const i=(e,t)=>{const n=Object(a.useHistory)();return Object(r.useCallback)((r=>{try{t&&t(r)}catch(e){throw r.preventDefault(),e}r.defaultPrevented||0===r.button&&(r.currentTarget instanceof HTMLAnchorElement&&""!==r.currentTarget.target&&"_self"!==r.currentTarget.target||r.metaKey||r.altKey||r.ctrlKey||r.shiftKey||(r.preventDefault(),Array.isArray(e)?n.push(...e):n.push(e)))}),[n,t,e])}},894:function(e,t,n){"use strict";n.d(t,"i",(function(){return r})),n.d(t,"h",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return u}));const r=e=>"UninitialisedResourceState"===e.type,a=e=>"LoadingResourceState"===e.type,i=e=>"LoadedResourceState"===e.type,o=e=>"FailedResourceState"===e.type,s=()=>({type:"UninitialisedResourceState"}),c=e=>({type:"LoadingResourceState",previousState:e}),l=e=>({type:"LoadedResourceState",data:e}),d=(e,t)=>({type:"FailedResourceState",error:e,lastLoadedState:t}),u=e=>{switch(e.type){case"LoadedResourceState":case"FailedResourceState":return e;case"UninitialisedResourceState":case"LoadingResourceState":return s()}}},924:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"f",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return u}));var r=n(70);const a="/api/fleet",i=`${a}/package_policies`,o=`${a}/agent_status`,s=(e,t,n)=>e.get(`${i}/${t}`,{...n,version:r.API_VERSIONS.public.v1}),c=(e,t,n)=>e.post(`${i}/_bulk_get`,{...n,version:r.API_VERSIONS.public.v1,body:JSON.stringify({ids:t,ignoreMissing:!0})}),l=(e,t,n,a={})=>e.put(`${i}/${t}`,{...a,version:r.API_VERSIONS.public.v1,body:JSON.stringify(n)}),d=(e,t,n={})=>e.get(o,{...n,version:r.API_VERSIONS.public.v1,query:{policyId:t}}),u=async e=>{const t=r.epmRouteService.getInfoPath("endpoint"),n=(await e.get(t,{version:r.API_VERSIONS.public.v1})).item;if(!n)throw new Error("Endpoint package was not found.");return n}},966:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(9);const a=e=>{const{id:t,revision:n,created_by:a,created_at:i,updated_by:o,updated_at:s,...c}=e,l=Object(r.cloneDeep)(c),d=l.inputs[0].config.policy.value;return[d.windows.popup.malware,d.mac.popup.malware].forEach((e=>e.message.trim())),l}}}]);