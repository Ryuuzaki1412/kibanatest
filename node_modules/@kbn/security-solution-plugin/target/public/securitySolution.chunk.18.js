/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[18,12],Array(121).concat([function(e,t,n){"use strict";n.d(t,"c",(function(){return x})),n.d(t,"d",(function(){return S})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return T}));var a=n(2),i=n(48),r=n(5),s=n(49),o=n(149),l=n(116),u=n(213),c=n(118),d=n(4),m=n(151),p=n(112),f=n(392),b=n(117),g=n(477),v=n(334),y=n(241),h=n(157),j=n(218),E=n(295),O=n(110);const x=(e=l.SourcererScopeName.default)=>{const t=Object(i.useDispatch)(),{data:{dataViews:n}}=Object(O.i)().services,s=Object(a.useRef)(new AbortController),d=Object(a.useRef)(!0),y=Object(a.useRef)(!0),{loading:E,isSignalIndexExists:x,signalIndexName:k}=Object(u.c)(),w=Object(h.d)(j.a.sourcerer),C=Object(a.useMemo)((()=>o.d.getSourcererDataViewsSelector()),[]),{defaultDataView:T,signalIndexName:M}=Object(p.a)((e=>C(e))),{addError:I,addWarning:A}=Object(b.a)();Object(a.useEffect)((()=>{null!=T.error&&A({title:r.i18n.translate("xpack.securitySolution.sourcerer.permissions.title",{defaultMessage:"Write role required to generate data"}),text:r.i18n.translate("xpack.securitySolution.sourcerer.permissions.toastMessage",{defaultMessage:"Users with write permission need to access the Elastic Security app to initialize the app source data."})})}),[A,T.error]);const P=Object(a.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),_=Object(p.a)((e=>P(e,m.f.active))),D=Object(a.useMemo)((()=>o.d.getSourcererScopeSelector()),[]),{sourcererScope:{selectedDataViewId:F,selectedPatterns:N,missingPatterns:R}}=Object(p.a)((t=>D(t,e))),{selectedDataView:z,sourcererScope:{selectedDataViewId:L,selectedPatterns:B,missingPatterns:q}}=Object(p.a)((e=>D(e,l.SourcererScopeName.timeline))),{indexFieldsSearch:$}=Object(v.b)(),V=Object(a.useCallback)((n=>{null!=n?Object.keys(n).forEach((a=>{var i,r,s,u;a===l.SourcererScopeName.default&&e===l.SourcererScopeName.detections||t(o.a.setSelectedDataView({id:a,selectedDataViewId:null!==(i=null===(r=n[a])||void 0===r?void 0:r.id)&&void 0!==i?i:null,selectedPatterns:null!==(s=null===(u=n[a])||void 0===u?void 0:u.selectedPatterns)&&void 0!==s?s:[]}))})):F&&w({[l.SourcererScopeName.default]:{id:F,selectedPatterns:N}})}),[t,F,e,N,w]);Object(h.b)(j.a.sourcerer,V);const U=Object(a.useRef)([]);Object(a.useEffect)((()=>{[...new Set([F,L])].forEach(((e,t)=>{if(null!=e&&e.length>0&&!U.current.includes(e)){U.current=[...U.current,e];const n=0===t?l.SourcererScopeName.default:l.SourcererScopeName.timeline,a=e===F?0===N.length&&0===R.length:L===e&&0===q.length&&0===(null==z?void 0:z.patternList.length);$({dataViewId:e,scopeId:n,needToBeInit:a,...a&&n===l.SourcererScopeName.timeline?{skipScopeUpdate:B.length>0}:{}})}}))}),[$,R.length,F,N.length,L,q.length,z,B.length]),Object(a.useEffect)((()=>{!E&&null!=k&&null==M&&(null==_||null==_.savedObjectId)&&d.current&&T.id.length>0?(d.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:T.id,selectedPatterns:Object(f.b)(T,l.SourcererScopeName.timeline,k,!0)}))):null!=M&&(null==_||null==_.savedObjectId)&&d.current&&T.id.length>0&&(d.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:T.id,selectedPatterns:Object(f.b)(T,l.SourcererScopeName.timeline,M,!0)})))}),[_,T,t,E,k,M]);const{dataViewId:H}=S(e),G=Object(a.useCallback)((e=>{-1===T.title.indexOf(e)&&(s.current.abort(),(async a=>{s.current=new AbortController,t(o.a.setSourcererScopeLoading({loading:!0}));try{const i=await Object(g.a)({body:{patternList:a},signal:s.current.signal,dataViewService:n,dataViewId:H});null!=i&&i.defaultDataView.patternList.includes(e)&&($({dataViewId:i.defaultDataView.id}),t(o.a.setSourcererDataViews(i))),t(o.a.setSourcererScopeLoading({loading:!1}))}catch(e){"AbortError"===e.name||I(e,{title:r.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:r.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})}),t(o.a.setSourcererScopeLoading({loading:!1}))}})([...T.title.split(","),e]))}),[T.title,t,n,H,$,I]),Q=Object(a.useCallback)((()=>{!E&&null!=k&&null==M&&T.id.length>0&&(G(k),t(o.a.setSignalIndexName({signalIndexName:k})))}),[T.id.length,t,E,k,M,G]);Object(a.useEffect)((()=>{Q()}),[k]),Object(a.useEffect)((()=>{e===l.SourcererScopeName.detections&&x&&null!=k&&y.current&&T.id.length>0?(y.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:T.id,selectedPatterns:Object(f.b)(T,l.SourcererScopeName.detections,k,!0)}))):e===l.SourcererScopeName.detections&&null!=M&&d.current&&T.id.length>0&&(y.current=!1,o.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:T.id,selectedPatterns:Object(f.b)(T,l.SourcererScopeName.detections,M,!0)}))}),[T,t,x,e,k,M])},S=(e=l.SourcererScopeName.default)=>{const{getDataViewsSelector:t,getSourcererDataViewSelector:n,getScopeSelector:i}=Object(a.useMemo)((()=>({getDataViewsSelector:o.d.getSourcererDataViewsSelector(),getSourcererDataViewSelector:o.d.sourcererDataViewSelector(),getScopeSelector:o.d.scopeIdSelector()})),[]),{defaultDataView:r,signalIndexName:s,selectedDataView:u,sourcererScope:{missingPatterns:c,selectedPatterns:d,loading:m}}=Object(p.a)((a=>{const r=i(a,e);return{...t(a),selectedDataView:n(a,r.selectedDataViewId),sourcererScope:r}})),b=Object(a.useMemo)((()=>Object(E.b)(d)),[d]),[g,h]=Object(a.useState)([]),[j,O]=Object(y.b)(g),x=Object(a.useMemo)((()=>{var e,t,n,a,i,r,s;return{...O,dataView:O.dataView,runtimeMappings:null!==(e=null===(t=O.dataView)||void 0===t?void 0:t.runtimeFieldMap)&&void 0!==e?e:{},title:null!==(n=null===(a=O.dataView)||void 0===a?void 0:a.title)&&void 0!==n?n:"",id:null!==(i=null===(r=O.dataView)||void 0===r?void 0:r.id)&&void 0!==i?i:null,loading:j,patternList:O.indexes,indexFields:O.indexPatterns.fields,fields:null===(s=O.dataView)||void 0===s?void 0:s.fields}}),[O,j]);Object(a.useEffect)((()=>{null==u||c.length>0?h(b):h([])}),[c,u,b]);const S=Object(a.useMemo)((()=>null==u||c.length>0?x:u),[x,c.length,u]),k=Object(a.useMemo)((()=>!(!m&&!S.loading)||Object(f.a)({scopeId:e,signalIndexName:s,patternList:S.patternList,isDefaultDataViewSelected:S.id===r.id})),[r.id,m,e,s,S.id,S.loading,S.patternList]),w=Object(a.useCallback)((()=>{const{browserFields:e}=Object(v.a)(S.patternList.join(","),S.fields);return e}),[S.fields,S.patternList]);return Object(a.useMemo)((()=>({browserFields:w(),dataViewId:S.id,indexPattern:{fields:S.indexFields,title:b.join(","),getName:()=>b.join(",")},indicesExist:k,loading:m||S.loading,runtimeMappings:S.runtimeMappings,patternList:S.title.split(","),selectedPatterns:b,...g.length>0?{activePatterns:S.patternList}:{},sourcererDataView:S.dataView})),[w,S,b,k,m,g.length])},k=[d.d,`${d.oc}/id/:id`,`${d.s}/:detailName`],w=e=>null==Object(s.matchPath)(e,{path:k,strict:!1})?l.SourcererScopeName.default:l.SourcererScopeName.detections,C=[d.d,d.v,`${d.oc}/id/:id`,d.Ab,d.Lc,d.Ob,d.Wb],T=e=>null!=Object(s.matchPath)(e,{path:C,strict:!1})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return v}));var a=n(45),i=n(2),r=n.n(i),s=n(704),o=n(168),l=n(492),u=n(249),c=n(250);const d=[{id:"default-system-prompt",content:c.b,name:c.a,promptType:"system"},{id:"CB9FA555-B59F-4F71-AFF9-8A891AC5BC28",content:c.d,name:c.c,promptType:"system"}],m={alerts:!1,assistantLangChain:!1,latestAlerts:20};var p=n(259),f=n(13);const b=r.a.createContext(void 0),g=({actionTypeRegistry:e,alertsIndexPattern:t,assistantAvailability:n,assistantStreamingEnabled:r=!1,assistantTelemetry:c,augmentMessageCodeBlocks:g,baseAllow:v,baseAllowReplacement:y,defaultAllow:h,defaultAllowReplacement:j,docLinks:E,basePath:O,basePromptContexts:x=[],baseQuickPrompts:S=[],baseSystemPrompts:k=d,children:w,getComments:C,http:T,getInitialConversations:M,modelEvaluatorEnabled:I=!1,nameSpace:A="elasticAssistantDefault",setConversations:P,setDefaultAllow:_,setDefaultAllowReplacement:D,title:F=u.c,toasts:N})=>{const[R,z]=Object(s.useLocalStorage)(`${A}.quickPrompts`,S),[L,B]=Object(s.useLocalStorage)(`${A}.systemPrompts`,k),[q,$]=Object(s.useLocalStorage)(`${A}.lastConversationId`),[V,U]=Object(s.useLocalStorage)(`${A}.knowledgeBase`,m),[H,G]=Object(i.useState)({}),Q=Object(i.useCallback)((e=>{G((t=>null!=e&&null==t[e.id]?Object(l.b)({prevPromptContexts:t,promptContext:e}):t))}),[]),W=Object(i.useCallback)((e=>G((t=>null==t[e]?t:Object(a.omit)(e,t)))),[]),[K,Y]=Object(i.useState)((e=>{})),[X,J]=Object(i.useState)(p.b),[Z,ee]=Object(i.useState)(M()),te=Object(i.useMemo)((()=>Object.keys(Z).sort()),[Z]);Object(i.useEffect)((()=>{ee(M())}),[M]);const ne=Object(i.useCallback)((e=>{if("function"==typeof e){const t=e;ee((e=>{const n=t(e);return P(n),n}))}else P(e),ee(e)}),[P]),ae=Object(i.useCallback)((e=>{var t;return null!==(t=null!=e?e:q)&&void 0!==t?t:o.d}),[q]),ie=Object(i.useMemo)((()=>({actionTypeRegistry:e,alertsIndexPattern:t,assistantAvailability:n,assistantStreamingEnabled:r,assistantTelemetry:c,augmentMessageCodeBlocks:g,allQuickPrompts:null!=R?R:[],allSystemPrompts:null!=L?L:[],baseAllow:Object(a.uniq)(v),baseAllowReplacement:Object(a.uniq)(y),basePath:O,basePromptContexts:x,baseQuickPrompts:S,baseSystemPrompts:k,conversationIds:te,conversations:Z,defaultAllow:Object(a.uniq)(h),defaultAllowReplacement:Object(a.uniq)(j),docLinks:E,getComments:C,http:T,knowledgeBase:null!=V?V:m,modelEvaluatorEnabled:I,promptContexts:H,nameSpace:A,registerPromptContext:Q,selectedSettingsTab:X,setAllQuickPrompts:z,setAllSystemPrompts:B,setConversations:ne,setDefaultAllow:_,setDefaultAllowReplacement:D,setKnowledgeBase:U,setSelectedSettingsTab:J,setShowAssistantOverlay:Y,showAssistantOverlay:K,title:F,toasts:N,unRegisterPromptContext:W,getConversationId:ae,setLastConversationId:$})),[e,t,n,r,c,g,v,y,O,x,S,k,te,Z,h,j,E,C,T,V,ae,R,L,I,A,ne,H,Q,X,_,D,U,$,z,B,K,F,N,W]);return Object(f.jsx)(b.Provider,{value:ie},w)},v=()=>{const e=r.a.useContext(b);if(null==e)throw new Error("useAssistantContext must be used within a AssistantProvider");return e}},,,function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"f",(function(){return b}));var a=n(45),i=n(2),r=n.n(i),s=n(44),o=n.n(s);const l=n(5).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),u=o.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1h9raim-0"})(["color:",";"],(e=>e.theme.eui.euiColorMediumShade));u.displayName="EmptyWrapper";const c=()=>"—",d=()=>`(${l})`,m=()=>r.a.createElement(u,null,c()),p=()=>r.a.createElement(u,null,d()),f=e=>null==e?m():Object(a.isString)(e)&&""===e?p():r.a.createElement(r.a.Fragment,null,e),b=e=>null==e?m():""===e?p():r.a.createElement(r.a.Fragment,null,e)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(48),i=n(16);const r=Object(i.b)(),s=e=>{const t=o();if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${r.join(", ")}`);return t[e]},o=()=>Object(a.useSelector)((({app:{enableExperimental:e}})=>e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var a=n(38).__importDefault(n(774));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.removeEventListener.apply(e,t)},t.isDeepEqual=a.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"m",(function(){return m})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return f})),n.d(t,"q",(function(){return b})),n.d(t,"p",(function(){return g})),n.d(t,"y",(function(){return v})),n.d(t,"A",(function(){return y})),n.d(t,"B",(function(){return h})),n.d(t,"C",(function(){return j})),n.d(t,"D",(function(){return E})),n.d(t,"d",(function(){return O})),n.d(t,"e",(function(){return x})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return k})),n.d(t,"E",(function(){return w})),n.d(t,"F",(function(){return C})),n.d(t,"G",(function(){return T})),n.d(t,"H",(function(){return M})),n.d(t,"J",(function(){return I})),n.d(t,"K",(function(){return A})),n.d(t,"L",(function(){return P})),n.d(t,"M",(function(){return _})),n.d(t,"Y",(function(){return D})),n.d(t,"Z",(function(){return F})),n.d(t,"ab",(function(){return N})),n.d(t,"bb",(function(){return R})),n.d(t,"z",(function(){return z})),n.d(t,"cb",(function(){return L})),n.d(t,"db",(function(){return B})),n.d(t,"N",(function(){return q})),n.d(t,"O",(function(){return $})),n.d(t,"Q",(function(){return V})),n.d(t,"T",(function(){return U})),n.d(t,"U",(function(){return H})),n.d(t,"R",(function(){return G})),n.d(t,"S",(function(){return Q})),n.d(t,"X",(function(){return W})),n.d(t,"W",(function(){return K})),n.d(t,"s",(function(){return Y})),n.d(t,"r",(function(){return X})),n.d(t,"w",(function(){return J})),n.d(t,"P",(function(){return Z})),n.d(t,"x",(function(){return ee})),n.d(t,"I",(function(){return te})),n.d(t,"V",(function(){return ne})),n.d(t,"t",(function(){return ae})),n.d(t,"v",(function(){return ie})),n.d(t,"u",(function(){return re}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.open.timeline.batchActionsTitle",{defaultMessage:"Bulk actions"}),r=a.i18n.translate("xpack.securitySolution.open.timeline.cancelButton",{defaultMessage:"Cancel"}),s=a.i18n.translate("xpack.securitySolution.open.timeline.collapseButton",{defaultMessage:"Collapse"}),o=a.i18n.translate("xpack.securitySolution.open.timeline.deleteButton",{defaultMessage:"Delete"}),l=a.i18n.translate("xpack.securitySolution.open.timeline.deleteSelectedButton",{defaultMessage:"Delete selected"}),u=a.i18n.translate("xpack.securitySolution.open.timeline.deleteWarningLabel",{defaultMessage:"You will not be able to recover this timeline or its notes once deleted."}),c=a.i18n.translate("xpack.securitySolution.open.timeline.deleteTemplateWarningLabel",{defaultMessage:"You will not be able to recover this timeline template or its notes once deleted."}),d=a.i18n.translate("xpack.securitySolution.open.timeline.descriptionTableHeader",{defaultMessage:"Description"}),m=a.i18n.translate("xpack.securitySolution.open.timeline.expandButton",{defaultMessage:"Expand"}),p=a.i18n.translate("xpack.securitySolution.open.timeline.exportFileNameTitle",{defaultMessage:"timelines_export"}),f=a.i18n.translate("xpack.securitySolution.open.timeline.exportSelectedButton",{defaultMessage:"Export selected"}),b=a.i18n.translate("xpack.securitySolution.open.timeline.favoriteSelectedButton",{defaultMessage:"Favorite selected"}),g=a.i18n.translate("xpack.securitySolution.open.timeline.favoritesTooltip",{defaultMessage:"Favorites"}),v=a.i18n.translate("xpack.securitySolution.open.timeline.lastModifiedTableHeader",{defaultMessage:"Last modified"}),y=a.i18n.translate("xpack.securitySolution.open.timeline.missingSavedObjectIdTooltip",{defaultMessage:"Missing savedObjectId"}),h=a.i18n.translate("xpack.securitySolution.open.timeline.modifiedByTableHeader",{defaultMessage:"Modified by"}),j=a.i18n.translate("xpack.securitySolution.open.timeline.notesTooltip",{defaultMessage:"Notes"}),E=a.i18n.translate("xpack.securitySolution.open.timeline.onlyFavoritesButtonLabel",{defaultMessage:"Only favorites"}),O=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineTooltip",{defaultMessage:"Create query rule from timeline"}),x=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineEqlTooltip",{defaultMessage:"Create EQL rule from timeline"}),S=a.i18n.translate("xpack.securitySolution.open.timeline.createTemplateFromTimelineTooltip",{defaultMessage:"Create template from timeline"}),k=a.i18n.translate("xpack.securitySolution.open.timeline.createTimelineFromTemplateTooltip",{defaultMessage:"Create timeline from template"}),w=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTooltip",{defaultMessage:"Duplicate timeline"}),C=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTemplateTooltip",{defaultMessage:"Duplicate template"}),T=a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineButton",{defaultMessage:"Open Timeline…"}),M=a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineTitle",{defaultMessage:"Open"}),I=a.i18n.translate("xpack.securitySolution.open.timeline.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),A=a.i18n.translate("xpack.securitySolution.open.timeline.refreshTitle",{defaultMessage:"Refresh"}),P=a.i18n.translate("xpack.securitySolution.open.timeline.searchPlaceholder",{defaultMessage:"e.g. timeline name, or description"}),_=a.i18n.translate("xpack.securitySolution.open.timeline.searchTemplatePlaceholder",{defaultMessage:"e.g. template name, or description"}),D=a.i18n.translate("xpack.securitySolution.open.timeline.timelineNameTableHeader",{defaultMessage:"Timeline name"}),F=a.i18n.translate("xpack.securitySolution.open.timeline.timelineTemplateNameTableHeader",{defaultMessage:"Template name"}),N=a.i18n.translate("xpack.securitySolution.open.timeline.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),R=a.i18n.translate("xpack.securitySolution.open.timeline.withLabel",{defaultMessage:"with"}),z=a.i18n.translate("xpack.securitySolution.open.timeline.loadingLabel",{defaultMessage:"Loading..."}),L=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelinesMatchLabel",{defaultMessage:"0 timelines match the search criteria"}),B=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelineTemplatesMatchLabel",{defaultMessage:"0 timeline templates match the search criteria"}),q=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTemplatesTitle",{values:{selectedTemplates:e},defaultMessage:"Selected {selectedTemplates} {selectedTemplates, plural, =1 {template} other {templates}}"}),$=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTimelinesTitle",{values:{selectedTimelines:e},defaultMessage:"Selected {selectedTimelines} {selectedTimelines, plural, =1 {timeline} other {timelines}}"}),V=a.i18n.translate("xpack.securitySolution.open.timeline.showingLabel",{defaultMessage:"Showing:"}),U=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully exported {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),H=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully exported {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),G=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully deleted {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),Q=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully deleted {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),W=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.timelinesTitle",{defaultMessage:"Timelines"}),K=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.templatesTitle",{defaultMessage:"Templates"}),Y=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.elasticTitle",{defaultMessage:"Elastic templates"}),X=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.customizedTitle",{defaultMessage:"Custom templates"}),J=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTimelineTitle",{defaultMessage:"Import"}),Z=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.selectTimelineDescription",{defaultMessage:"Select a timeline or timeline template file to import"}),ee=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid timelines_export.ndjson file"}),te=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.overwriteDescription",{defaultMessage:"Automatically overwrite saved objects with the same timeline ID"}),ne=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.successfullyImportedTimelinesTitle",{values:{totalCount:e},defaultMessage:"Successfully imported {totalCount} {totalCount, plural, =1 {item} other {items}}"}),ae=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedTitle",{values:{totalTimelines:e},defaultMessage:"Failed to import {totalTimelines} {totalTimelines, plural, =1 {timeline} other {timelines}}"}),ie=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTitle",{defaultMessage:"Import…"}),re=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"})},,,,,function(e,t,n){"use strict";n.d(t,"g",(function(){return E.d})),n.d(t,"f",(function(){return E.c})),n.d(t,"o",(function(){return w})),n.d(t,"m",(function(){return M})),n.d(t,"d",(function(){return A})),n.d(t,"h",(function(){return F})),n.d(t,"a",(function(){return R})),n.d(t,"c",(function(){return z})),n.d(t,"i",(function(){return L})),n.d(t,"e",(function(){return B})),n.d(t,"b",(function(){return q})),n.d(t,"j",(function(){return G})),n.d(t,"n",(function(){return Q})),n.d(t,"l",(function(){return W})),n.d(t,"k",(function(){return K}));var a=n(17),i=n(2),r=n.n(i),s=n(45),o=n(470),l=n(266),u=n(526),c=n(4),d=n(563),m=n(164),p=n(245),f=n(110),b=n(226),g=n(5),v=n(397);const y=e=>g.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var h=n(129),j=n(527),E=n(284),O=n(23),x=n.n(O),S=n(462),k=n(486);const w=()=>{const e=Object(S.b)(),t=Object(k.a)();return Object(i.useCallback)((({deepLinkId:n,path:a,onClick:i})=>{const r=t(n);return e({id:n,path:a,urlState:r,onClick:i})}),[e,t])},C=e=>(e=>r.a.memo((function({deepLinkId:t,...n}){const a=Object(k.a)()(t);return r.a.createElement(e,x()({id:t,urlState:a},n))})))(Object(S.d)(e)),T=({children:e,Component:t,userName:n,isButton:a,onClick:s,title:o,userTab:l})=>{const u=encodeURIComponent(n),{formatUrl:d,search:p}=Object(m.l)(h.a.users),{application:{navigateToApp:b},telemetry:g}=Object(f.i)().services,v=Object(i.useCallback)((e=>{e.preventDefault(),b(c.l,{deepLinkId:h.a.users,path:l?Object(j.a)(u,l,p):Object(j.c)(u,p)})}),[u,b,p,l]),y=Object(i.useMemo)((()=>d(l?Object(j.a)(u,l):Object(j.c)(u))),[d,u,l]),O=Object(i.useCallback)((e=>{g.reportEntityDetailsClicked({entity:"user"}),(null!=s?s:v)(e)}),[v,s,g]);return a?r.a.createElement(E.b,{Component:t,dataTestSubj:"data-grid-user-details",href:y,onClick:O,title:null!=o?o:n},e||n):r.a.createElement(E.c,{"data-test-subj":"users-link-anchor",onClick:O,href:y},e||n)},M=r.a.memo(T),I=({children:e,Component:t,hostName:n,isButton:a,onClick:s,title:o,hostTab:l})=>{const{formatUrl:u,search:d}=Object(m.l)(h.a.hosts),{application:{navigateToApp:p},telemetry:b}=Object(f.i)().services,g=encodeURIComponent(n),v=Object(i.useCallback)((e=>{e.preventDefault(),p(c.l,{deepLinkId:h.a.hosts,path:l?Object(m.i)(g,l,d):Object(m.d)(g,d)})}),[g,p,d,l]),y=Object(i.useMemo)((()=>u(l?Object(m.i)(g,l):Object(m.d)(g))),[u,g,l]),j=Object(i.useCallback)((e=>{b.reportEntityDetailsClicked({entity:"host"}),(null!=s?s:v)(e)}),[v,s,b]);return a?r.a.createElement(E.b,{Component:t,dataTestSubj:"data-grid-host-details",href:y,iconType:"expand",onClick:j,title:null!=o?o:n},e):r.a.createElement(E.c,{onClick:j,href:y,"data-test-subj":"host-details-button"},e||n)},A=r.a.memo(I),P=["http://","https://"],_=r.a.memo((({url:e,children:t,idx:n,overflowIndexStart:i=5,allItemsLimit:o=5})=>{const l=i-1,u=o-1,c=Math.max(0,Math.min(l,u)),d=P.some((t=>0===e.indexOf(t)));return e&&d&&!Object(b.c)(e)&&t?r.a.createElement(a.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(s.isNil)(n)&&n<c&&r.a.createElement(E.a,{"data-test-subj":"externalLinkComma"}))):null}));_.displayName="ExternalLink";const D=({Component:e,children:t,ip:n,flowTarget:a=p.a.source,isButton:o,onClick:l,title:u})=>{const c=w(),f=Object(i.useCallback)(((n,i)=>{const{onClick:s,href:p}=c({deepLinkId:h.a.network,path:Object(m.f)(encodeURIComponent(Object(d.c)(n)),a)}),f=null!=l?l:e=>s(e);return o?r.a.createElement(E.b,{Component:e,key:`${n}-${i}`,dataTestSubj:"data-grid-network-details",onClick:f,href:p,title:null!=u?u:n},t):r.a.createElement(E.c,{key:`${n}-${i}`,onClick:f,href:p,"data-test-subj":"network-details"},t||n)}),[t,e,a,c,l,o,u]);return Object(s.isArray)(n)?r.a.createElement(r.a.Fragment,null,n.map(f)):f(n,0)},F=r.a.memo(D),N=({index:e,children:t,detailName:n,title:a})=>{const{formatUrl:s,search:d}=Object(m.l)(h.a.case),{navigateToApp:p}=Object(f.i)().services.application,{activeStep:b,isTourShown:g}=Object(u.b)(),v=Object(i.useMemo)((()=>b===l.a.viewCase&&g(l.b.alertsCases)&&0===e),[b,e,g]),j=Object(i.useCallback)((async e=>(e&&e.preventDefault(),p(c.l,{deepLinkId:h.a.case,path:Object(m.a)({id:n,search:d})}))),[n,p,d]);return Object(i.useEffect)((()=>{var e;v&&(null===(e=document.querySelector('[tour-step="RelatedCases-accordion"]'))||void 0===e||e.scrollIntoView())}),[v]),r.a.createElement(o.a,{onClick:j,isTourAnchor:v,step:l.a.viewCase,tourId:l.b.alertsCases},r.a.createElement(E.c,{onClick:j,href:s(Object(m.a)({id:n})),"data-test-subj":"case-details-link","aria-label":y(null!=a?a:n)},t||n))},R=r.a.memo(N);R.displayName="CaseDetailsLink",r.a.memo((({children:e})=>{const{formatUrl:t,search:n}=Object(m.l)(h.a.case),{navigateToApp:a}=Object(f.i)().services.application,s=Object(i.useCallback)((async e=>(e.preventDefault(),a(c.l,{deepLinkId:h.a.case,path:Object(m.b)(n)}))),[a,n]);return r.a.createElement(E.c,{onClick:s,href:t(Object(m.b)())},e)})).displayName="CreateCaseLink";const z=r.a.memo((({children:e,link:t})=>{const n=Object(i.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(_,{url:n},e||t)}));z.displayName="GoogleLink";const L=r.a.memo((({Component:e,title:t,children:n,portOrServiceName:s})=>{var o;const l=Object(i.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(s))}`),[s]);return e?r.a.createElement(e,{href:l,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(o=null!=t?t:n)&&void 0!==o?o:s):r.a.createElement(E.e,null,r.a.createElement(a.EuiLink,{"data-test-subj":"port-or-service-name-link",href:l,target:"_blank"},n||s))}));L.displayName="PortOrServiceNameLink";const B=r.a.memo((({children:e,ja3Fingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return r.a.createElement(a.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:n,target:"_blank"},e||t)}));B.displayName="Ja3FingerprintLink";const q=r.a.memo((({children:e,certificateFingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return r.a.createElement(a.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:n,target:"_blank"},e||t)}));var $;function V(e){return e===$["virustotal.com"]||e===$["talosIntelligence.com"]}q.displayName="CertificateFingerprintLink",function(e){e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com"}($||($={}));const U={[$["virustotal.com"]]:v.m,[$["talosIntelligence.com"]]:v.l},H=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:n=!1,domain:o,direction:l="row"})=>{const[u]=Object(f.o)(c.Gb),d=Object(i.useMemo)((()=>null==u?void 0:u.slice(0,t).filter((({url_template:e,name:t})=>!Object(s.isNil)(e)&&!Object(s.isNil)(t)&&!Object(b.c)(e))).map((({name:e,url_template:t})=>({name:V(e)?U[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(o))})))),[u,o,U,t]),m=Object(i.useCallback)((n=>{var a;return(e=>void 0!==e.url_template&&void 0!==e.name)(n)&&r.a.createElement(_,{url:n.url_template,overflowIndexStart:e,allItemsLimit:t},r.a.createElement(r.a.Fragment,null,null!==(a=n.name)&&void 0!==a?a:o))}),[t,o,e]);return(null==d?void 0:d.length)>0?r.a.createElement("section",null,r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:l,alignItems:"center","data-test-subj":"reputationLinkGroup"},r.a.createElement(a.EuiFlexItem,{grow:!0},null==d?void 0:d.slice(0,e).map((({name:t,url_template:a},i)=>r.a.createElement(_,{allItemsLimit:d.length,idx:i,overflowIndexStart:e,url:a,"data-test-subj":"externalLinkComponent",key:`reputationLink-${i}`},r.a.createElement(r.a.Fragment,null,n?o:null!=t?t:o))))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(E.f,{rowItems:d,render:m,moreMaxHeight:"200px",overflowIndexStart:e})))):null};H.displayName="ReputationLinkComponent";const G=r.a.memo(H),Q=r.a.memo((({children:e,domain:t})=>{const n=Object(i.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(_,{url:n},e||t)}));Q.displayName="WhoIsLink";const W=C(E.d),K=C(E.c)},,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return _})),n.d(t,"a",(function(){return C}));var a=n(23),i=n.n(a),r=n(2),s=n(17);const o=Object(r.createContext)(void 0),l=()=>{const e=Object(r.useContext)(o);if(!e)throw new Error("ExpandableFlyoutContext can only be used within ExpandableFlyoutContext provider");return e};var u=n(13),c=n(9);const d="previewSection";var m=n(5);const p=m.i18n.translate("expandableFlyout.previewSection.backButton",{defaultMessage:"Back"}),f=m.i18n.translate("expandableFlyout.previewSection.closeButton",{defaultMessage:"Close"}),b=e=>Object(c.has)(e,"title")||Object(c.has)(e,"backgroundColor")||Object(c.has)(e,"textColor"),g=({component:e,showBackButton:t,leftPosition:n,banner:a})=>{const{euiTheme:i}=Object(s.useEuiTheme)(),{closePreviewPanel:r,previousPreviewPanel:o}=l(),c=n+4,m=Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiButtonIcon,{iconType:"cross",onClick:()=>r(),"data-test-subj":"previewSectionCloseButton","aria-label":f})),g=t?Object(u.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween",responsive:!1},Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiButtonEmpty,{size:"xs",iconType:"arrowLeft",iconSide:"left",onClick:()=>o(),"data-test-subj":"previewSectionBackButton","aria-label":p},p)),m):Object(u.jsx)(s.EuiFlexGroup,{justifyContent:"flexEnd",responsive:!1},m);return Object(u.jsx)("div",{css:Object(u.css)("position:absolute;top:4px;bottom:12px;right:4px;left:",c,"px;z-index:1000;","")},Object(u.jsx)(s.EuiSplitPanel.Outer,{css:Object(u.css)("margin:",i.size.xs,";box-shadow:0 0 4px 4px ",i.colors.darkShade,";",""),className:"eui-yScroll","data-test-subj":d},b(a)&&Object(u.jsx)(s.EuiSplitPanel.Inner,{grow:!1,color:a.backgroundColor,paddingSize:"none","data-test-subj":`${d}BannerPanel`},Object(u.jsx)(s.EuiText,{textAlign:"center",color:a.textColor,size:"s","data-test-subj":`${d}BannerText`},a.title)),Object(u.jsx)(s.EuiSplitPanel.Inner,{grow:!1,paddingSize:"s","data-test-subj":"previewSectionHeader"},g),Object(u.jsx)(s.EuiSplitPanel.Inner,{paddingSize:"none"},e)))};g.displayName="PreviewSection";const v=({component:e,width:t})=>{const n=Object(r.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(u.jsx)(s.EuiFlexItem,{grow:!1,style:n,"data-test-subj":"rightSection"},e)};v.displayName="RightSection";const y=({component:e,width:t})=>{const n=Object(r.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(u.jsx)(s.EuiFlexItem,{grow:!0,"data-test-subj":"leftSection",style:n},e)};y.displayName="LeftSection";const h={height:"100%"},j=({registeredPanels:e,...t})=>{var n,a;const o=(()=>{const[e,t]=Object(r.useState)(0);return Object(r.useLayoutEffect)((()=>{function e(){t(window.innerWidth)}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]),e})(),{closeFlyout:c,panels:d}=l(),{left:m,right:p,preview:f}=d,j=Object(r.useMemo)((()=>e.find((e=>e.key===(null==m?void 0:m.id)))),[m,e]),E=Object(r.useMemo)((()=>e.find((e=>e.key===(null==p?void 0:p.id)))),[p,e]),O=f?f[f.length-1]:void 0,x=b(null==O||null===(n=O.params)||void 0===n?void 0:n.banner)?null==O||null===(a=O.params)||void 0===a?void 0:a.banner:void 0,S=!!f&&f.length>1,k=Object(r.useMemo)((()=>e.find((e=>e.key===(null==O?void 0:O.id)))),[O,e]),w=null!=E&&null!=p,C=null!=j&&null!=m,T=null!=k&&null!=f,{rightSectionWidth:M,leftSectionWidth:I,flyoutWidth:A,previewSectionLeft:P}=(({windowWidth:e,showRight:t,showLeft:n,showPreview:a})=>{let i=0;if(t)if(e<992)i=Math.min(380,e);else{const t=(e-992)/928*370;i=Math.min(380+t,750)}let r=0;n&&(r=e<=1600?e-i-48:Math.min(80*(e-i)/100,1500));let s=0;return a&&(s=r),{rightSectionWidth:i,leftSectionWidth:r,flyoutWidth:t&&n?`${i+r}px`:`${i}px`,previewSectionLeft:s}})({windowWidth:o,showRight:w,showLeft:C,showPreview:T});return m||p||null!=f&&f.length?Object(u.jsx)(s.EuiFlyout,i()({},t,{size:A,ownFocus:!1,onClose:c}),Object(u.jsx)(s.EuiFlexGroup,{direction:j?"row":"column",wrap:!1,gutterSize:"none",style:h,responsive:!1},C?Object(u.jsx)(y,{component:j.component({...m}),width:I}):null,w?Object(u.jsx)(v,{component:E.component({...p}),width:M}):null),T?Object(u.jsx)(g,{component:k.component({...O}),showBackButton:S,leftPosition:P,banner:x}):null):null};j.displayName="ExpandableFlyout";var E=n(60),O=n(310);const x={namespaces:{},timeoutHandle:0},S="url:update",k=["popstate",S],w=(e,t)=>{x.namespaces[e]||(x.namespaces[e]={});const[n,a]=Object(r.useState)(void 0);return Object(r.useEffect)((()=>{const n=()=>{const n=new URLSearchParams(window.location.search).get(e),i=n?Object(E.decode)(n):{},r=null==i?void 0:i[t];x.namespaces[e][t]=r,a(r)};return n(),k.forEach((e=>window.addEventListener(e,n))),()=>k.forEach((e=>window.removeEventListener(e,n)))}),[t,e]),[n,Object(r.useCallback)((n=>{const a=x.namespaces[e][t],i="object"==typeof n&&"object"==typeof a&&!Array.isArray(n)&&!Array.isArray(a);x.namespaces[e][t]=i?{...a,...n}:n,x.timeoutHandle&&window.clearTimeout(x.timeoutHandle),x.timeoutHandle=window.setTimeout((()=>{const e=Object(O.parse)(location.search);for(const t in x.namespaces)Object.prototype.hasOwnProperty.call(x.namespaces,t)&&(e[t]=encodeURIComponent(Object(E.encode)(x.namespaces[t])));const t=Object(O.stringify)(e,{encode:!1});if(window.location.search===t)return;const n=`${window.location.hash}?${t}`;window.history.pushState({},"",n),window.dispatchEvent(new Event(S))}),0)}),[t,e])]},C="eventFlyout",T=({children:e})=>{const{setRightPanelState:t,rightPanelState:n}=(()=>{const[e,t]=w(C,"rightPanel");return{rightPanelState:e,setRightPanelState:t}})(),{setLeftPanelState:a,leftPanelState:i}=(()=>{const[e,t]=w(C,"leftPanel");return{leftPanelState:e,setLeftPanelState:t}})(),{previewState:s,setPreviewState:l}=(()=>{const[e,t]=w(C,"preview");return{previewState:e,setPreviewState:t}})(),c=Object(r.useMemo)((()=>({left:i,right:n,preview:s||[]})),[i,s,n]),d=Object(r.useCallback)((({right:e,left:n,preview:i})=>{t(e),a(n),l(i?[i]:[])}),[t,a,l]),m=Object(r.useCallback)((e=>{t(e)}),[t]),p=Object(r.useCallback)((e=>a(e)),[a]),f=Object(r.useCallback)((e=>l([...null!=s?s:[],e])),[s,l]),b=Object(r.useCallback)((()=>t(void 0)),[t]),g=Object(r.useCallback)((()=>a(void 0)),[a]),v=Object(r.useCallback)((()=>l([])),[l]),y=Object(r.useCallback)((()=>l(null==s?void 0:s.slice(0,s.length-1))),[s,l]),h=Object(r.useCallback)((()=>{t(void 0),a(void 0),l([])}),[t,a,l]),j=Object(r.useMemo)((()=>({panels:c,openFlyout:d,openRightPanel:m,openLeftPanel:p,openPreviewPanel:f,closeRightPanel:b,closeLeftPanel:g,closePreviewPanel:v,closeFlyout:h,previousPreviewPanel:y})),[c,d,m,p,f,b,g,v,h,y]);return Object(u.jsx)(o.Provider,{value:j},e)};let M;!function(e){e.openFlyout="open_flyout",e.openRightPanel="open_right_panel",e.openLeftPanel="open_left_panel",e.openPreviewPanel="open_preview_panel",e.closeRightPanel="close_right_panel",e.closeLeftPanel="close_left_panel",e.closePreviewPanel="close_preview_panel",e.previousPreviewPanel="previous_preview_panel",e.closeFlyout="close_flyout"}(M||(M={}));const I={left:void 0,right:void 0,preview:[]};function A(e,t){switch(t.type){case M.openFlyout:{const{left:e,right:n,preview:a}=t.payload;return{left:e,right:n,preview:a?[a]:[]}}case M.openRightPanel:return{...e,right:t.payload};case M.openLeftPanel:return{...e,left:t.payload};case M.openPreviewPanel:return{...e,preview:[...e.preview,t.payload]};case M.closeRightPanel:return{...e,right:void 0};case M.closeLeftPanel:return{...e,left:void 0};case M.closePreviewPanel:return{...e,preview:[]};case M.previousPreviewPanel:{const t=[...e.preview];return t.pop(),{...e,preview:t}}case M.closeFlyout:return{left:void 0,right:void 0,preview:[]};default:return e}}const P=({children:e})=>{const[t,n]=Object(r.useReducer)(A,I),a=Object(r.useCallback)((({right:e,left:t,preview:a})=>n({type:M.openFlyout,payload:{left:t,right:e,preview:a}})),[n]),i=Object(r.useCallback)((e=>n({type:M.openRightPanel,payload:e})),[]),s=Object(r.useCallback)((e=>n({type:M.openLeftPanel,payload:e})),[]),l=Object(r.useCallback)((e=>n({type:M.openPreviewPanel,payload:e})),[]),c=Object(r.useCallback)((()=>n({type:M.closeRightPanel})),[]),d=Object(r.useCallback)((()=>n({type:M.closeLeftPanel})),[]),m=Object(r.useCallback)((()=>n({type:M.closePreviewPanel})),[]),p=Object(r.useCallback)((()=>n({type:M.previousPreviewPanel})),[]),f=Object(r.useCallback)((()=>{n({type:M.closeFlyout})}),[]),b=Object(r.useMemo)((()=>({panels:t,openFlyout:a,openRightPanel:i,openLeftPanel:s,openPreviewPanel:l,closeRightPanel:c,closeLeftPanel:d,closePreviewPanel:m,closeFlyout:f,previousPreviewPanel:p})),[t,a,i,s,l,c,d,m,f,p]);return Object(u.jsx)(o.Provider,{value:b},e)},_=({children:e,storage:t="url"})=>"memory"===t?Object(u.jsx)(P,null,e):Object(u.jsx)(T,null,e)},,function(e,t,n){"use strict";var a=n(52);n.d(t,"j",(function(){return a.getUseField})),n.d(t,"i",(function(){return a.getFieldValidityAndErrorMessage})),n.d(t,"a",(function(){return a.FIELD_TYPES})),n.d(t,"c",(function(){return a.Form})),n.d(t,"e",(function(){return a.UseField})),n.d(t,"f",(function(){return a.UseMultiFields})),n.d(t,"k",(function(){return a.useForm})),n.d(t,"l",(function(){return a.useFormContext})),n.d(t,"m",(function(){return a.useFormData})),n.d(t,"g",(function(){return a.VALIDATION_TYPES}));var i=n(71);n.d(t,"b",(function(){return i.Field})),n.d(t,"d",(function(){return i.SelectField}));var r=n(81);n.d(t,"h",(function(){return r.fieldValidators}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(45),i=n(2),r=n(48),s=n(119),o=n(112),l=n(128),u=n(181);const c=()=>{const e=Object(r.useDispatch)(),{from:t,to:n}=Object(o.a)((e=>Object(a.pick)(["from","to"],l.d.globalTimeRangeSelector(e)))),[c,d]=Object(i.useState)(!0),m=Object(i.useRef)([]),p=Object(i.useCallback)((({id:t,inspect:n,loading:a,refetch:i,searchSessionId:r})=>{m.current=[...m.current,t],e(u.c.setQuery({inputId:s.a.global,id:t,inspect:n,loading:a,refetch:i,searchSessionId:r}))}),[e]),f=Object(i.useCallback)((({id:t})=>e(u.c.deleteOneQuery({inputId:s.a.global,id:t}))),[e]);return Object(i.useEffect)((()=>{d(!1)}),[]),Object(i.useEffect)((()=>()=>{m.current.length>0&&m.current.forEach((e=>f({id:e})))}),[f]),Object(i.useMemo)((()=>({isInitializing:c,from:t,to:n,setQuery:p,deleteQuery:f})),[f,t,c,p,n])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return h})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return Qe})),n.d(t,"c",(function(){return We})),n.d(t,"f",(function(){return Ke})),n.d(t,"d",(function(){return Ye})),n.d(t,"e",(function(){return Xe}));var a=n(111),i=n(141),r=n(363),s=n(365),o=n(362),l=n(323),u=n(366),c=n(367),d=n(368),m=n(369);const p=a.z.object({name:i.I,description:i.z,risk_score:i.p,severity:i.V}),f=a.z.object({rule_name_override:i.J.optional(),timestamp_override:i.ab.optional(),timestamp_override_fallback_disabled:i.bb.optional(),timeline_id:i.Y.optional(),timeline_title:i.Z.optional(),outcome:i.S.optional(),alias_target_id:i.R.optional(),alias_purpose:i.Q.optional(),license:i.G.optional(),note:i.h.optional(),building_block_type:i.d.optional(),output_index:i.b.optional(),namespace:i.c.optional(),meta:i.H.optional(),investigation_fields:i.g.optional(),throttle:i.x.optional()}),b=a.z.object({version:i.P.optional(),tags:i.O.optional(),enabled:i.i.optional(),risk_score_mapping:i.q.optional(),severity_mapping:i.W.optional(),interval:i.D.optional(),from:i.E.optional(),to:i.F.optional(),actions:a.z.array(i.r).optional(),exceptions_list:a.z.array(i.A).optional(),author:i.y.optional(),false_positives:i.B.optional(),references:i.M.optional(),max_signals:i.l.optional(),threat:i.X.optional()}),g=p.merge(f).merge(b),v=p.partial().merge(f).merge(b),y=p.merge(f).merge(b.required()),h=a.z.object({id:i.K,rule_id:i.N,immutable:i.j,updated_at:a.z.string().datetime(),updated_by:a.z.string(),created_at:a.z.string().datetime(),created_by:a.z.string(),revision:a.z.number().int().min(0),related_integrations:i.n,required_fields:i.o,setup:i.U,execution_summary:r.a.optional()}),j=g.merge(a.z.object({rule_id:i.N.optional()})),E=g.merge(a.z.object({id:i.K.optional(),rule_id:i.N.optional()})),O=v.merge(a.z.object({id:i.K.optional(),rule_id:i.N.optional()})),x=y.merge(h),S=a.z.literal("eql"),k=a.z.object({type:a.z.literal("eql"),query:i.L,language:S}),w=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),event_category_override:s.a.optional(),tiebreaker_field:s.b.optional(),timestamp_field:s.c.optional()}),C=k.merge(w),T=k.merge(w),M=k.partial().merge(w),I=x.merge(T),A=j.merge(C),P=E.merge(C),_=O.merge(M),D=a.z.object({type:a.z.literal("query")}),F=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),response_actions:a.z.array(o.a).optional(),alert_suppression:l.a.optional()}),N=a.z.object({query:i.L.optional(),language:i.k.optional()}),R=D.merge(F).merge(N),z=D.partial().merge(F).merge(N),L=D.merge(F).merge(N.required()),B=x.merge(L),q=j.merge(R),$=E.merge(R),V=O.merge(z),U=a.z.object({type:a.z.literal("saved_query"),saved_id:i.T}),H=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),response_actions:a.z.array(o.a).optional(),alert_suppression:l.a.optional(),query:i.L.optional()}),G=a.z.object({language:i.k.optional()}),Q=U.merge(H).merge(G),W=U.partial().merge(H).merge(G),K=U.merge(H).merge(G.required()),Y=x.merge(K),X=j.merge(Q),J=E.merge(Q),Z=O.merge(W),ee=a.z.object({type:a.z.literal("threshold"),query:i.L,threshold:u.a}),te=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),alert_suppression:u.b.optional()}),ne=a.z.object({language:i.k.optional()}),ae=ee.merge(te).merge(ne),ie=ee.partial().merge(te).merge(ne),re=ee.merge(te).merge(ne.required()),se=x.merge(re),oe=j.merge(ae),le=E.merge(ae),ue=O.merge(ie),ce=a.z.object({type:a.z.literal("threat_match"),query:i.L,threat_query:c.g,threat_mapping:c.f,threat_index:c.d}),de=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),threat_filters:c.c.optional(),threat_indicator_path:c.e.optional(),threat_language:i.k.optional(),concurrent_searches:c.a.optional(),items_per_search:c.b.optional()}),me=a.z.object({language:i.k.optional()}),pe=ce.merge(de).merge(me),fe=ce.partial().merge(de).merge(me),be=ce.merge(de).merge(me.required()),ge=x.merge(be),ve=j.merge(pe),ye=E.merge(pe),he=O.merge(fe),je=a.z.object({type:a.z.literal("machine_learning"),anomaly_threshold:d.a,machine_learning_job_id:d.b}),Ee=je.partial(),Oe=je,xe=je,Se=x.merge(Oe),ke=j.merge(xe),we=E.merge(xe),Ce=O.merge(Ee),Te=a.z.object({type:a.z.literal("new_terms"),query:i.L,new_terms_fields:m.b,history_window_start:m.a}),Me=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional()}),Ie=a.z.object({language:i.k.optional()}),Ae=Te.partial().merge(Me).merge(Ie),Pe=Te.merge(Me).merge(Ie.required()),_e=Te.merge(Me).merge(Ie),De=x.merge(Pe),Fe=j.merge(_e),Ne=E.merge(_e),Re=O.merge(Ae),ze=a.z.literal("esql"),Le=a.z.object({type:a.z.literal("esql"),language:ze,query:i.L}),Be=Le.partial(),qe=Le,$e=Le,Ve=x.merge(qe),Ue=j.merge($e),He=E.merge($e),Ge=O.merge(Be.partial()),Qe=a.z.discriminatedUnion("type",[C,R,Q,ae,pe,xe,_e,$e]),We=(a.z.union([M,z,W,ie,fe,Ee,Ae,Be]),a.z.discriminatedUnion("type",[T,L,K,re,be,Oe,Pe,qe]),a.z.discriminatedUnion("type",[A,q,X,oe,ve,ke,Fe,Ue])),Ke=a.z.discriminatedUnion("type",[P,$,J,le,ye,we,Ne,He]),Ye=a.z.union([_,V,Z,ue,he,Ce,Re,Ge]),Xe=a.z.discriminatedUnion("type",[I,B,Y,se,ge,Se,De,Ve])},,,,,,function(e,t,n){"use strict";n.d(t,"cc",(function(){return i})),n.d(t,"Lb",(function(){return r})),n.d(t,"Nb",(function(){return s})),n.d(t,"ad",(function(){return o})),n.d(t,"Zc",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"bc",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"Bb",(function(){return m})),n.d(t,"dc",(function(){return p})),n.d(t,"f",(function(){return f})),n.d(t,"r",(function(){return b})),n.d(t,"p",(function(){return g})),n.d(t,"s",(function(){return v})),n.d(t,"q",(function(){return y})),n.d(t,"m",(function(){return h})),n.d(t,"t",(function(){return j})),n.d(t,"w",(function(){return E})),n.d(t,"g",(function(){return O})),n.d(t,"n",(function(){return x})),n.d(t,"i",(function(){return S})),n.d(t,"o",(function(){return k})),n.d(t,"j",(function(){return w})),n.d(t,"h",(function(){return C})),n.d(t,"v",(function(){return T})),n.d(t,"u",(function(){return M})),n.d(t,"W",(function(){return I})),n.d(t,"U",(function(){return A})),n.d(t,"V",(function(){return P})),n.d(t,"Y",(function(){return _})),n.d(t,"A",(function(){return D})),n.d(t,"l",(function(){return F})),n.d(t,"y",(function(){return N})),n.d(t,"k",(function(){return R})),n.d(t,"z",(function(){return z})),n.d(t,"X",(function(){return L})),n.d(t,"S",(function(){return B})),n.d(t,"K",(function(){return q})),n.d(t,"B",(function(){return $})),n.d(t,"M",(function(){return V})),n.d(t,"C",(function(){return U})),n.d(t,"E",(function(){return H})),n.d(t,"F",(function(){return G})),n.d(t,"D",(function(){return Q})),n.d(t,"L",(function(){return W})),n.d(t,"N",(function(){return K})),n.d(t,"O",(function(){return Y})),n.d(t,"G",(function(){return X})),n.d(t,"P",(function(){return J})),n.d(t,"H",(function(){return Z})),n.d(t,"T",(function(){return ee})),n.d(t,"J",(function(){return te})),n.d(t,"I",(function(){return ne})),n.d(t,"Q",(function(){return ae})),n.d(t,"R",(function(){return ie})),n.d(t,"Gb",(function(){return re})),n.d(t,"Pc",(function(){return se})),n.d(t,"Oc",(function(){return oe})),n.d(t,"Uc",(function(){return le})),n.d(t,"Sc",(function(){return ue})),n.d(t,"ab",(function(){return ce})),n.d(t,"Rc",(function(){return de})),n.d(t,"Cb",(function(){return me})),n.d(t,"Qb",(function(){return pe})),n.d(t,"Rb",(function(){return fe})),n.d(t,"Ab",(function(){return be})),n.d(t,"Hb",(function(){return ge})),n.d(t,"xb",(function(){return ve})),n.d(t,"mb",(function(){return ye})),n.d(t,"lb",(function(){return he})),n.d(t,"nb",(function(){return je})),n.d(t,"gb",(function(){return Ee})),n.d(t,"ib",(function(){return Oe})),n.d(t,"hb",(function(){return xe})),n.d(t,"pb",(function(){return Se})),n.d(t,"bb",(function(){return ke})),n.d(t,"ob",(function(){return we})),n.d(t,"eb",(function(){return Ce})),n.d(t,"fb",(function(){return Te})),n.d(t,"jb",(function(){return Me})),n.d(t,"kb",(function(){return Ie})),n.d(t,"cb",(function(){return Ae})),n.d(t,"db",(function(){return Pe})),n.d(t,"Eb",(function(){return _e})),n.d(t,"zb",(function(){return De})),n.d(t,"rb",(function(){return Fe})),n.d(t,"Db",(function(){return Ne})),n.d(t,"Xc",(function(){return Re})),n.d(t,"Qc",(function(){return ze})),n.d(t,"Fc",(function(){return Le})),n.d(t,"Yb",(function(){return Be})),n.d(t,"Hc",(function(){return qe})),n.d(t,"Sb",(function(){return $e})),n.d(t,"Xb",(function(){return Ve})),n.d(t,"Tb",(function(){return Ue})),n.d(t,"Ub",(function(){return He})),n.d(t,"Vb",(function(){return Ge})),n.d(t,"Wb",(function(){return Qe})),n.d(t,"sb",(function(){return We})),n.d(t,"b",(function(){return Ke})),n.d(t,"Nc",(function(){return Ye})),n.d(t,"Gc",(function(){return Xe})),n.d(t,"tb",(function(){return Je})),n.d(t,"a",(function(){return Ze})),n.d(t,"Mc",(function(){return et})),n.d(t,"c",(function(){return tt})),n.d(t,"Zb",(function(){return nt})),n.d(t,"qb",(function(){return at})),n.d(t,"ub",(function(){return it})),n.d(t,"Mb",(function(){return rt})),n.d(t,"Tc",(function(){return st})),n.d(t,"Ob",(function(){return ot})),n.d(t,"ac",(function(){return lt})),n.d(t,"Wc",(function(){return ut})),n.d(t,"Jb",(function(){return ct})),n.d(t,"Kb",(function(){return dt})),n.d(t,"x",(function(){return mt})),n.d(t,"Vc",(function(){return pt})),n.d(t,"wb",(function(){return ft})),n.d(t,"vb",(function(){return bt})),n.d(t,"ec",(function(){return gt})),n.d(t,"Z",(function(){return vt})),n.d(t,"Dc",(function(){return yt})),n.d(t,"Ec",(function(){return ht})),n.d(t,"Cc",(function(){return jt})),n.d(t,"Ac",(function(){return Et})),n.d(t,"Bc",(function(){return Ot})),n.d(t,"pc",(function(){return xt})),n.d(t,"qc",(function(){return St})),n.d(t,"nc",(function(){return kt})),n.d(t,"oc",(function(){return wt})),n.d(t,"hc",(function(){return Ct})),n.d(t,"ic",(function(){return Tt})),n.d(t,"fc",(function(){return Mt})),n.d(t,"gc",(function(){return It})),n.d(t,"yc",(function(){return At})),n.d(t,"zc",(function(){return Pt})),n.d(t,"wc",(function(){return _t})),n.d(t,"xc",(function(){return Dt})),n.d(t,"lc",(function(){return Ft})),n.d(t,"mc",(function(){return Nt})),n.d(t,"jc",(function(){return Rt})),n.d(t,"kc",(function(){return zt})),n.d(t,"tc",(function(){return Lt})),n.d(t,"vc",(function(){return Bt})),n.d(t,"uc",(function(){return qt})),n.d(t,"rc",(function(){return $t})),n.d(t,"sc",(function(){return Vt})),n.d(t,"Lc",(function(){return Ut})),n.d(t,"Ic",(function(){return Ht})),n.d(t,"Fb",(function(){return Gt})),n.d(t,"yb",(function(){return Qt})),n.d(t,"Jc",(function(){return Wt})),n.d(t,"Pb",(function(){return Kt})),n.d(t,"Yc",(function(){return Yt})),n.d(t,"Ib",(function(){return Xt})),n.d(t,"Kc",(function(){return Jt}));var a=n(5);const i=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.popoverTooltip.ariaLabel",{defaultMessage:"Tooltip for column: {columnName}",values:{columnName:e}}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.importRuleTitle",{defaultMessage:"Import rules"}),s=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.importValueListsButton",{defaultMessage:"Import value lists"}),o=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonTooltip",{defaultMessage:"Use value lists to create an exception when a field value matches a value found in a list"}),l=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonPrivilegesTooltip",{defaultMessage:"A user with manage cluster privileges must visit the Rules page before you can import value lists."}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addNewRuleTitle",{defaultMessage:"Create new rule"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.pageTitle",{defaultMessage:"Rules"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addPageTitle",{defaultMessage:"Create"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.editPageTitle",{defaultMessage:"Edit"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.refreshTitle",{defaultMessage:"Refresh"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActionsTitle",{defaultMessage:"Bulk actions"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enableTitle",{defaultMessage:"Enable"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disableTitle",{defaultMessage:"Disable"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.exportTitle",{defaultMessage:"Export"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicateTitle",{defaultMessage:"Duplicate"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTitle",{defaultMessage:"Delete"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.indexPatternsTitle",{defaultMessage:"Index patterns"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.tagsTitle",{defaultMessage:"Tags"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addTagsTitle",{defaultMessage:"Add tags"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTagsTitle",{defaultMessage:"Delete tags"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.applyTimelineTemplateTitle",{defaultMessage:"Apply Timeline template"}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addRuleActionsTitle",{defaultMessage:"Add rule actions"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.setScheduleTitle",{defaultMessage:"Update rule schedules"}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.contextMenuTitle",{defaultMessage:"Options"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastTitle",{defaultMessage:"Rules updates are in progress"}),A=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} updating."}),P=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastNotifyButtonLabel",{defaultMessage:"Notify me when done"}),_=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkExportConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be exported"}),D=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be edited"}),F=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkActionConfirmationPartlyTitle",{values:{customRulesCount:e},defaultMessage:"This action can only be applied to {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),N=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmationCancelButtonLabel",{defaultMessage:"Cancel"}),R=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkActionConfirmationCloseButtonLabel",{defaultMessage:"Close"}),z=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Edit {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),L=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkExportConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Export {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),B=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.saveButtonLabel",{defaultMessage:"Save"}),q=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.cancelButtonLabel",{defaultMessage:"Cancel"}),$=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to add. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),V=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to delete. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),U=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxLabel",{defaultMessage:"Add index patterns for selected rules"}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.indexPatternsRequiredErrorMessage",{defaultMessage:"A minimum of one index pattern is required."}),G=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),Q=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' index patterns"}),W=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.dataViewsOverwriteCheckboxLabel",{defaultMessage:"Apply changes to rules configured with data views"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxLabel",{defaultMessage:"Delete index patterns for selected rules"}),Y=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),X=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxHelpText",{defaultMessage:"Add one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),J=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxHelpText",{defaultMessage:"Delete one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxLabel",{defaultMessage:"Add tags for selected rules"}),ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.tagsComoboxRequiredErrorMessage",{defaultMessage:"A minimum of one tag is required."}),te=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsTitle",{defaultMessage:"Add tags"}),ne=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' tags"}),ae=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxLabel",{defaultMessage:"Delete tags for selected rules"}),ie=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsTitle",{defaultMessage:"Delete tags"}),re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.exportFilenameTitle",{defaultMessage:"rules_export"}),se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchAriaLabel",{defaultMessage:"Search rules"}),oe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchPlaceholder",{defaultMessage:'Rule name, index pattern (e.g., "filebeat-*"), or MITRE ATT&CK™ tactic or technique (e.g., "Defense Evasion" or "TA0005")'}),le=(e,t,n)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.showingRulesTitle",{values:{firstInPage:e,lastOfPage:t,totalRules:n},defaultMessage:"Showing {firstInPage}-{lastOfPage} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ue=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectAllRulesTitle",{values:{totalRules:e},defaultMessage:"Select all {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.clearSelectionTitle",{defaultMessage:"Clear selection"}),de=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectedRulesTitle",{values:{selectedRules:e},defaultMessage:"Selected {selectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.editRuleSettingsDescription",{defaultMessage:"Edit rule settings"}),pe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaActionsFeaturePrivileges",{defaultMessage:"You do not have Kibana Actions privileges"}),fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaSecurityPrivileges",{defaultMessage:"You do not have Kibana Security privileges"}),be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.duplicateRuleDescription",{defaultMessage:"Duplicate rule"}),ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.exportRuleDescription",{defaultMessage:"Export rule"}),ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.deleteRuleDescription",{defaultMessage:"Delete rule"}),ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.ruleTitle",{defaultMessage:"Rule"}),he=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.riskScoreTitle",{defaultMessage:"Risk score"}),je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.severityTitle",{defaultMessage:"Severity"}),Ee=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastRunTitle",{defaultMessage:"Last run"}),Oe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastUpdateTitle",{defaultMessage:"Last updated"}),xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastResponseTitle",{defaultMessage:"Last response"}),Se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.tagsTitle",{defaultMessage:"Tags"}),ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.enabledTitle",{defaultMessage:"Enabled"}),we=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.snoozeTitle",{defaultMessage:"Notify"}),Ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimes",{defaultMessage:"Indexing Time (ms)"}),Te=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimesTooltip",{defaultMessage:"Total time spent indexing alerts during last Rule execution"}),Me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimes",{defaultMessage:"Query Time (ms)"}),Ie=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimesTooltip",{defaultMessage:"Total time spent querying source indices during last Rule execution"}),Ae=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gap",{defaultMessage:"Last Gap (if any)"}),Pe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),_e=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.rules",{defaultMessage:"Rules"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.enabledRulesTitle",{defaultMessage:"Enabled rules"})),De=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.disabledRulesTitle",{defaultMessage:"Disabled rules"}),Fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.customRulesTitle",{defaultMessage:"Custom rules"}),Ne=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.elasticRulesTitle",{defaultMessage:"Elastic rules"}),Re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.tagsLabel",{defaultMessage:"Tags"}),ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.searchTagsPlaceholder",{defaultMessage:"Search tags"}),Le=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.rulesTagSearchText",{defaultMessage:"Rules tag search"}),Be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noTagsAvailableDescription",{defaultMessage:"No tags available"}),qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.ruleExecutionStatusFilter",{defaultMessage:"Select rule execution status to filter by"}),$e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesTitle",{defaultMessage:"No rules found"}),Ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesBodyTitle",{defaultMessage:"We weren't able to find any rules with the above filters."}),Ue=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesTitle",{defaultMessage:"All Elastic rules have been installed"}),He=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesBodyTitle",{defaultMessage:"There are no prebuilt detection rules available for installation"}),Ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesTitle",{defaultMessage:"All Elastic rules are up to date"}),Qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesBodyTitle",{defaultMessage:"There are currently no available updates to your installed Elastic rules."}),We=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.defineRuleTitle",{defaultMessage:"Define rule"}),Ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.aboutRuleTitle",{defaultMessage:"About rule"}),Ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.scheduleRuleTitle",{defaultMessage:"Schedule rule"}),Xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleActionsTitle",{defaultMessage:"Rule actions"}),Je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepDefinitionTitle",{defaultMessage:"Definition"}),Ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepAboutTitle",{defaultMessage:"About"}),et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepScheduleTitle",{defaultMessage:"Schedule"}),tt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepActionsTitle",{defaultMessage:"Actions"}),nt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.optionalFieldDescription",{defaultMessage:"Optional"}),at=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.continueButtonTitle",{defaultMessage:"Continue"}),it=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.updateButtonTitle",{defaultMessage:"Update"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.deleteDescription",{defaultMessage:"Delete"})),rt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importRuleTitle",{defaultMessage:"Import"}),st=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.selectRuleDescription",{defaultMessage:"Select rules to import. Associated rule actions and exceptions can be included."}),ot=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid rules_export.ndjson file"}),lt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteDescription",{defaultMessage:'Overwrite existing detection rules with conflicting "rule_id"'}),ut=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.successfullyImportedRulesTitle",{values:{totalRules:e},defaultMessage:"Successfully imported {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ct=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedTitle",{values:{totalRules:e},defaultMessage:"Failed to import {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),dt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"}),mt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkDeleteConfirmationTitle",{defaultMessage:"Confirm bulk deletion"}),pt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.singleDeleteConfirmationTitle",{defaultMessage:"Confirm deletion"}),ft=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationConfirm",{defaultMessage:"Delete"}),bt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationCancel",{defaultMessage:"Cancel"}),gt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverDescription",{defaultMessage:"Automatically refresh table"}),vt=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverLabel",{defaultMessage:"Refresh settings"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.clearRulesTableFilters",{defaultMessage:"Clear filters"})),yt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastTitle",{defaultMessage:"Rules exported"}),ht=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastDescription",{values:{totalRules:t,exportedRules:e},defaultMessage:"Successfully exported {exportedRules} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}."}),jt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.prebuiltRulesExcludedToastDescription",{defaultMessage:"Prebuilt rules were excluded from the resulting file."}),Et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastTitle",{defaultMessage:"Error exporting rules"}),Ot=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to export."}),xt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastTitle",{defaultMessage:"Rules duplicated"}),St=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully duplicated {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),kt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastTitle",{defaultMessage:"Error duplicating rule"}),wt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to duplicate."}),Ct=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastTitle",{defaultMessage:"Rules deleted"}),Tt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully deleted {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Mt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastTitle",{defaultMessage:"Error deleting rules"}),It=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to delete."}),At=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.successToastTitle",{defaultMessage:"Rules enabled"}),Pt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkAction.enable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully enabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),_t=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastTitle",{defaultMessage:"Error enabling rules"}),Dt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to enable."}),Ft=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastTitle",{defaultMessage:"Rules disabled"}),Nt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully disabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Rt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastTitle",{defaultMessage:"Error disabling rules"}),zt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to disable."}),Lt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastTitle",{defaultMessage:"Rules updated"}),Bt=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastDescription",{values:{succeededRulesCount:e,skippedRulesCount:t},defaultMessage:"{succeededRulesCount, plural, =0 {} =1 {You've successfully updated # rule. } other {You've successfully updated # rules. }}\n        {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}\n        "}),qt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successIndexEditToastDescription",{defaultMessage:"If you did not select to apply changes to rules using Kibana data views, those rules were not updated and will continue using data views."}),$t=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastTitle",{defaultMessage:"Error updating rules"}),Vt=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastDescription",{values:{failedRulesCount:e,skippedRulesCount:t},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to update. {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}"}),Ut=(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.hooks.useGetSavedQuery.errorToastMessage",{defaultMessage:"Failed to load the saved query"})),Ht=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextDescription",{defaultMessage:"Selected Detection Rules"}),Gt=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.explainThenSummarizeRuleDetails",{defaultMessage:"Please explain the selected rules above. For each rule, highlight why they are relevant, the query as published on Elastic's detection rules repository and an in-depth explanation of it, and what they typically mean for an organization if detected."}),Qt=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.detectionRulesConversationId",{defaultMessage:"Detection Rules"}),Wt=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextTooltip",{defaultMessage:"Add this alert as context"}),Kt=a.i18n.translate("xpack.securitySolution.addRules.installRuleButton",{defaultMessage:"Install rule"}),Yt=a.i18n.translate("xpack.securitySolution.addRules.upgradeRuleButton",{defaultMessage:"Update rule"}),Xt=a.i18n.translate("xpack.securitySolution.addRules.goBackToRulesTableButton",{defaultMessage:"Go back to installed Elastic rules"}),Jt=a.i18n.translate("xpack.securitySolution.ruleUpdates.documentationLink",{defaultMessage:"See what's new in Prebuilt Security Detection Rules"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return v}));var a=n(78),i=n.n(a),r=n(2),s=n.n(r),o=n(47),l=n(110),u=n(126),c=n(715),d=n(586);const m=s.a.memo((({value:e,dateFormat:t=Object(l.g)()})=>s.a.createElement(s.a.Fragment,null,i.a.tz(e,Object(l.l)()).format(t))));m.displayName="PreferenceFormattedDate";const p=({value:e})=>{if(null==e)return Object(u.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(u.f)(e);const n=t.toDate();return s.a.createElement(m,{value:n})};p.displayName="PreferenceFormattedDateFromPrimitive";const f=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,b=s.a.memo((({value:e})=>{const[t]=Object(l.o)("dateFormat:scaled"),n=Array.isArray(t)?t.find(f):null,a=Array.isArray(n)&&2===n.length?n[1]:"YYYY-MM-DD";return s.a.createElement(m,{dateFormat:a,value:e})}));b.displayName="PreferenceFormattedP1DTDate";const g=s.a.memo((({value:e,fieldName:t,className:n="",dateFormat:a})=>{if(null==e)return Object(u.f)(e);const i=Object(d.a)(e);return i.isValid()?s.a.createElement(c.a,{date:i.toDate(),fieldName:t,className:n},s.a.createElement(m,{value:i.toDate(),dateFormat:a})):Object(u.f)(e)}));g.displayName="FormattedDate";const v=s.a.memo((({value:e,dateFormat:t,tooltipFieldName:n,tooltipAnchorClassName:a,relativeThresholdInHrs:r=1})=>{if(null==e)return Object(u.f)(e);const l=Object(d.a)(e);if(!l.isValid())return Object(u.f)(e);const p=l.toDate(),f=i()(p).add(r,"hours").isBefore(new Date);return s.a.createElement(c.a,{date:p,fieldName:n,className:a},f?s.a.createElement(m,{"data-test-subj":"preference-time",value:p,dateFormat:t}):s.a.createElement(o.FormattedRelative,{"data-test-subj":"relative-time",value:p}))}));v.displayName="FormattedRelativePreferenceDate"},,function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return g})),n.d(t,"c",(function(){return v}));var a=n(2),i=n(45),r=n(48),s=n(235),o=n.n(s),l=n(60),u=n(203),c=n(112),d=n(610),m=n(202),p=n(20);const f=(e,t)=>{const n=Object(r.useDispatch)(),i=Object(u.f)(e);Object(a.useEffect)((()=>{const a=i();return n(d.a.registerUrlParam({key:e,initialValue:a})),t(a),()=>{n(d.a.deregisterUrlParam({key:e}))}}),[])},b=e=>{const t=Object(r.useDispatch)();return Object(a.useCallback)((n=>{t(d.a.updateUrlParam({key:e,value:n}))}),[t,e])},g=()=>{const e=Object(c.b)(d.c.selectGlobalUrlParam);return Object(a.useMemo)((()=>{const t={};return e?(Object.keys(e).forEach((n=>{const a=e[n];if(a&&("object"!=typeof a||!Object(i.isEmpty)(a)))try{t[n]=Object(l.encode)(a)}catch{}})),Object(u.b)(Object(i.pickBy)((e=>!Object(i.isEmpty)(e)),t))):""}),[e])},v=()=>{const[{pageName:e}]=Object(m.a)(),t=Object(c.b)(d.c.selectGlobalUrlParam),n=o()(t),r=Object(u.g)();Object(a.useEffect)((()=>{var a;const s=null!==(a=Object(p.b)(e))&&void 0!==a?a:{skipUrlState:!0},o={...t};s.skipUrlState&&Object.keys(o).forEach((e=>{o[e]=null})),Object(i.difference)(Object.keys(null!=n?n:{}),Object.keys(t)).forEach((e=>{o[e]=null})),Object.keys(o).length>0&&r(o)}),[n,t,e,r])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(17),i=n(2),r=n.n(i),s=n(119),o=n(276),l=n(381),u=n(465),c=n(382);const d="inspectButtonComponent",m=({children:e,show:t=!0})=>r.a.createElement(o.a,{show:t,targetClassNames:[d]},e),p=({compact:e=!1,inputId:t=s.a.global,inspectIndex:n=0,isDisabled:i,multiple:o=!1,onCloseInspect:m,queryId:p="",showInspectButton:f=!0,title:b=""})=>{const{additionalRequests:g,additionalResponses:v,handleClick:y,handleCloseModal:h,isButtonDisabled:j,isShowingModal:E,loading:O,request:x,response:S}=Object(u.a)({inputId:t,inspectIndex:n,isDisabled:i,multiple:o,onCloseInspect:m,queryId:p});return r.a.createElement(r.a.Fragment,null,t===s.a.timeline&&!e&&f&&r.a.createElement(a.EuiButtonEmpty,{className:d,"aria-label":c.d,"data-test-subj":"inspect-empty-button",isDisabled:j,isLoading:O,onClick:y},c.d),(t===s.a.global||e)&&f&&r.a.createElement(a.EuiButtonIcon,{className:d,"aria-label":c.d,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:j,title:c.d,onClick:y}),E&&null!==x&&null!==S&&r.a.createElement(l.a,{additionalRequests:g,additionalResponses:v,closeModal:h,"data-test-subj":"inspect-modal",inputId:t,request:x,response:S,title:b}))};p.displayName="InspectButtonComponent";const f=r.a.memo(p)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(110),r=n(202);const s=e=>{var t;const[{pageName:n}]=Object(r.a)(),{services:{storage:s}}=Object(i.i)(),o=((e,t)=>t&&e.length>0?`kibana.siem:${t}.query.toggle:${e}`:null)(n,e),[l,u]=Object(a.useState)(null==o||null===(t=s.get(o))||void 0===t||t);Object(a.useEffect)((()=>{var e;null!=o&&u(null===(e=s.get(o))||void 0===e||e)}),[s,o]);const c=Object(a.useCallback)((e=>{null!=o&&(s.set(o,e),u(e))}),[s,o]);return e?{toggleStatus:l,setToggleStatus:c}:{toggleStatus:!0,setToggleStatus:()=>{}}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return k})),n.d(t,"d",(function(){return w})),n.d(t,"f",(function(){return C})),n.d(t,"g",(function(){return M})),n.d(t,"c",(function(){return $})),n.d(t,"h",(function(){return V})),n.d(t,"b",(function(){return U}));var a=n(448),i=n(45),r=n(51),s=n(324),o=n.n(s),l=n(119),u=n(122),c=n(113),d=n(208),m=n(158),p=n(14),f=n(134),b=n(196),g=n(204),v=n(590),y=n(153),h=n(335),j=n(149),E=n(116),O=n(281),x=n(193);const S="open-timeline",k=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,w=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,n)=>t+e[n].length),0):0)+(null!=t?t.length:0),C=({title:e})=>null==e||0===e.trim().length,T=(e,t)=>"__typename"===e?void 0:t,M=e=>JSON.parse(JSON.stringify(e),T),I=e=>{try{return JSON.parse(e)}catch{return e}},A=e=>Object.entries(e).reduce(((e,[t,n])=>"id"!==t&&null!=n?{...e,[t]:n}:e),{columnHeaderType:b.a,id:null!=e.id?e.id:"unknown",initialWidth:"@timestamp"===e.id?g.b:g.a}),P=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:I(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:I(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:I(e.meta.value)}:{}},...null!=e.exists?{exists:I(e.exists)}:{},...null!=e.match_all?{exists:I(e.match_all)}:{},...null!=e.missing?{exists:I(e.missing)}:{},...null!=e.query?{query:I(e.query)}:{},...null!=e.range?{range:I(e.range)}:{},...null!=e.script?{exists:I(e.script)}:{}}),_=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(i.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):{},D=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},F=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},N=(e,t,n)=>n===c.l.default&&e.timelineType===c.l.template?e.templateTimelineId:t&&e.timelineType===c.l.template?Object(r.v4)():e.templateTimelineId,R=({and:e,...t})=>t.type===c.a.template?o()(t,{type:c.a.default,enabled:t.queryMatch.operator!==y.d,queryMatch:{value:t.queryMatch.operator===y.d?"":t.queryMatch.value}}):t,z=(e,t,n)=>e&&t&&n===c.l.default?t.map((e=>{var t,n;return{...R(e),and:null!==(t=null===(n=e.and)||void 0===n?void 0:n.map(R))&&void 0!==t?t:[]}})):t,L=(e,t,n)=>n&&e.timelineType!==n?"":t?`${e.title} - Duplicate`:e.title||"",B=(e,t,n)=>n&&e.timelineType!==n?c.k.draft:t?c.k.active:e.status,q=(e,t,n)=>{const i=e.timelineType===c.l.template,r={...e,columns:null!=e.columns?e.columns.map(A):b.b,defaultColumns:b.b,dateRange:e.status===c.k.immutable&&e.timelineType===c.l.template?{start:O.a.toISOString(),end:O.b.toISOString()}:e.dateRange,dataProviders:z(t,e.dataProviders,n),eventIdToNoteIds:_(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(P):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:F(t,e.pinnedEventIds),pinnedEventsSaveObject:D(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:B(e,t,n),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=n?n:e.timelineType,title:L(e,t,n),templateTimelineId:N(e,t,n),templateTimelineVersion:t&&i?1:e.templateTimelineVersion};return Object.entries(r).reduce(((e,[t,n])=>null!=n?Object(a.set)(t,n,e):e),{...f.b,id:""})},$=(e,t=!1,n)=>{const{notes:a,...i}=e;return{notes:a,timeline:q(i,t,n)}},V=({activeTimelineTab:e=u.d.query,duplicate:t=!1,graphEventId:n="",timelineId:a,timelineType:r,onError:s,onOpenTimeline:o,openTimeline:l=!0,updateIsLoading:c,updateTimeline:d,savedSearchId:m})=>{c({id:u.c.active,isLoading:!0}),null==a?(d({id:u.c.active,duplicate:!1,notes:[],from:O.a.toISOString(),to:O.b.toISOString(),timeline:{...f.b,id:u.c.active,activeTab:e,show:l,initialized:!0,savedSearchId:null!=m?m:null}})(),c({id:u.c.active,isLoading:!1})):Promise.resolve(Object(x.j)(a)).then((a=>{const s=Object(i.getOr)(null,"data",a);if(!s)return;const c=M(s.timeline),{timeline:m,notes:p}=$(c,t,r);if(null!=o)o(m);else if(d){const{from:a,to:r}=Object(h.a)({from:Object(i.getOr)(null,"dateRange.start",m),to:Object(i.getOr)(null,"dateRange.end",m)});d({duplicate:t,from:a,id:u.c.active,notes:p,resolveTimelineConfig:{outcome:s.outcome,alias_target_id:s.alias_target_id,alias_purpose:s.alias_purpose},timeline:{...m,activeTab:e,graphEventId:n,show:l,dateRange:{start:a,end:r},savedSearchId:m.savedSearchId},to:r,preventSettingQuery:!0})()}})).catch((e=>{null!=s&&s(e,a)})).finally((()=>{c({id:u.c.active,isLoading:!1})}))},U=e=>({duplicate:t,id:n,forceNotes:a=!1,from:r,notes:s,resolveTimelineConfig:o,timeline:u,to:f,ruleNote:b,ruleAuthor:g,preventSettingQuery:y})=>()=>{let h=u;var x;if(t&&(h={...u,updated:void 0,changed:void 0,version:null}),Object(i.isEmpty)(h.indexNames)||e(j.a.setSelectedDataView({id:E.SourcererScopeName.timeline,selectedDataViewId:h.dataViewId,selectedPatterns:h.indexNames})),h.status===c.k.immutable&&h.timelineType===c.l.template?e(Object(m.setRelativeRangeDatePicker)({id:l.a.timeline,fromStr:"now-24h",toStr:"now",from:O.a.toISOString(),to:O.b.toISOString()})):e(Object(m.setTimelineRangeDatePicker)({from:r,to:f})),e(Object(p.addTimeline)({id:n,timeline:h,resolveTimelineConfig:o,savedTimeline:t})),y||null==h.kqlQuery||null==h.kqlQuery.filterQuery||null==h.kqlQuery.filterQuery.kuery||""===h.kqlQuery.filterQuery.kuery.expression||e(Object(p.applyKqlFilterQuery)({id:n,filterQuery:{kuery:{kind:null!==(x=h.kqlQuery.filterQuery.kuery.kind)&&void 0!==x?x:"kuery",expression:h.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:h.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=b&&!Object(i.isEmpty)(b)){const t=Object(v.a)({newNote:b,user:g||"elastic"});e(Object(d.updateNote)({note:t})),e(Object(p.addNote)({noteId:t.id,id:n}))}t&&!a||e(Object(d.addNotes)({notes:null!=s?s.map((e=>{var t,n;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(n=e.timelineId)&&void 0!==n?n:null}})):[]}))}},function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"y",(function(){return p})),n.d(t,"p",(function(){return f})),n.d(t,"v",(function(){return b})),n.d(t,"j",(function(){return g})),n.d(t,"h",(function(){return v})),n.d(t,"k",(function(){return y})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return j})),n.d(t,"e",(function(){return E})),n.d(t,"q",(function(){return O})),n.d(t,"b",(function(){return x})),n.d(t,"n",(function(){return S})),n.d(t,"i",(function(){return k})),n.d(t,"l",(function(){return w})),n.d(t,"a",(function(){return C})),n.d(t,"o",(function(){return T})),n.d(t,"c",(function(){return M})),n.d(t,"m",(function(){return I})),n.d(t,"x",(function(){return A})),n.d(t,"w",(function(){return P})),n.d(t,"r",(function(){return _})),n.d(t,"s",(function(){return D})),n.d(t,"t",(function(){return F})),n.d(t,"u",(function(){return N}));var a=n(29),i=n(72),r=n(70),s=n(663),o=n(191),l=n(4),u=n(341),c=n(389),d=n(110);n(154);const m=async({rule:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),p=async({rule:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"PUT",version:"2023-10-31",body:JSON.stringify(e),signal:t}),f=async({ruleProperties:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"PATCH",version:"2023-10-31",body:JSON.stringify(e),signal:t}),b=async({rule:e,signal:t})=>d.b.get().http.fetch(l.ib,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),g=async({filterOptions:e={filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:t={field:"enabled",order:"desc"},pagination:n={page:1,perPage:20},signal:a})=>{const i=Object(s.a)(e),r={page:n.page,per_page:n.perPage,sort_field:t.field,sort_order:t.order,...""!==i?{filter:i}:{}};return d.b.get().http.fetch(l.kb,{method:"GET",version:"2023-10-31",query:r,signal:a})},v=async({id:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"GET",version:"2023-10-31",query:{id:e},signal:t}),y=async({ids:e,signal:t})=>{var n;return null===(n=(await d.b.get().http.fetch(a.INTERNAL_ALERTING_API_FIND_RULES_PATH,{method:"GET",query:{filter:e.map((e=>`alert.id:"alert:${e}"`)).join(" or "),fields:JSON.stringify(["muteAll","activeSnoozes","isSnoozedUntil","snoozeSchedule"]),per_page:e.length},signal:t})).data)||void 0===n?void 0:n.reduce(((e,{id:t,...n})=>{var a,i;return e[t]={muteAll:null!==(a=n.mute_all)&&void 0!==a&&a,activeSnoozes:null!==(i=n.active_snoozes)&&void 0!==i?i:[],isSnoozedUntil:n.is_snoozed_until?new Date(n.is_snoozed_until):void 0,snoozeSchedule:n.snooze_schedule},e}),{})},h=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connectors`,{method:"GET",signal:e}),j=async({filter:e,signal:t})=>d.b.get().http.fetch(o.f,{method:"POST",version:"1",body:JSON.stringify({filter:e}),signal:t}),E=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connector_types`,{method:"GET",signal:e,query:{feature_id:"siem"}});async function O({bulkAction:e,dryRun:t=!1}){const n={action:e.type,query:e.query,ids:e.ids,edit:e.type===o.b.edit?e.editPayload:void 0,duplicate:e.type===o.b.duplicate?e.duplicatePayload:void 0};return d.b.get().http.fetch(l.hb,{method:"POST",version:"2023-10-31",body:JSON.stringify(n),query:{dry_run:t}})}async function x(e){const t={action:o.b.export,query:e.query,ids:e.ids};return d.b.get().http.fetch(l.hb,{method:"POST",version:"2023-10-31",body:JSON.stringify(t)})}const S=async({fileToImport:e,overwrite:t=!1,overwriteExceptions:n=!1,overwriteActionConnectors:a=!1,signal:i})=>{const r=new FormData;return r.append("file",e),d.b.get().http.fetch(`${l.jb}/_import`,{method:"POST",version:"2023-10-31",headers:{"Content-Type":void 0},query:{overwrite:t,overwrite_exceptions:n,overwrite_action_connectors:a},body:r,signal:i})},k=async({signal:e})=>d.b.get().http.fetch(o.g,{method:"GET",version:"1",signal:e}),w=async({lists:e,signal:t})=>{const n=e.some((({id:e})=>void 0===e))?{namespace_types:e.map((({namespaceType:e})=>e)).join(",")}:{ids:e.map((({id:e})=>e)).join(","),list_ids:e.map((({listId:e})=>e)).join(","),namespace_types:e.map((({namespaceType:e})=>e)).join(",")};return d.b.get().http.fetch(c.a,{method:"GET",version:"1",query:n,signal:t})},C=async({ruleId:e,items:t,signal:n})=>d.b.get().http.fetch(`${l.jb}/${e}/exceptions`,{method:"POST",version:"2023-10-31",body:JSON.stringify({items:t}),signal:n}),T=({packageName:e,packageVersion:t,prerelease:n=!1,force:a=!0})=>d.b.get().http.post(r.epmRouteService.getInstallPath(e,t),{query:{prerelease:n},version:"2023-10-31",body:JSON.stringify({force:a})}),M=({packages:e,prerelease:t=!1})=>d.b.get().http.post(r.epmRouteService.getBulkInstallPath(),{query:{prerelease:t},version:"2023-10-31",body:JSON.stringify({packages:e})}),I=async({signal:e})=>d.b.get().http.fetch(u.a,{method:"GET",version:"1",signal:e}),A=async({signal:e})=>d.b.get().http.fetch(u.f,{method:"POST",version:"1",signal:e}),P=async({signal:e})=>d.b.get().http.fetch(u.e,{method:"POST",version:"1",signal:e}),_=async()=>d.b.get().http.fetch(u.b,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES"})}),D=async e=>d.b.get().http.fetch(u.b,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e})}),F=async()=>d.b.get().http.fetch(u.c,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES",pick_version:"TARGET"})}),N=async e=>d.b.get().http.fetch(u.c,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e,pick_version:"TARGET"})})},function(e,t,n){"use strict";n.d(t,"c",(function(){return l.a})),n.d(t,"h",(function(){return l.d})),n.d(t,"d",(function(){return u.a})),n.d(t,"i",(function(){return u.b})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return m.b})),n.d(t,"f",(function(){return m.a})),n.d(t,"j",(function(){return p})),n.d(t,"k",(function(){return f})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"l",(function(){return v})),n.d(t,"m",(function(){return y}));var a=n(45),i=n(2),r=n(462),s=n(486),o=n(352),l=n(237),u=n(229),c=(n(4),n(185));const d=(e,t)=>`/${e}${Object(c.a)(t)}`;var m=n(346);const p=(e,t)=>`/${e}${Object(c.a)(t)}`,f=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(a.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,b=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(c.a)(null!=t?t:void 0)}`,g=e=>`/create${Object(c.a)(null!=e?e:void 0)}`,v=e=>{const{getAppUrl:t}=Object(o.a)(),n=Object(s.b)(e);return{formatUrl:Object(i.useCallback)(((i,{absolute:r=!1,skipSearch:s=!1}={})=>{const o=function(e,t,n){const[i,r]=e.split("?");return`${i}${n?Object(a.isEmpty)(r)?"":`?${r}`:Object(a.isEmpty)(r)?t:`?${r}${Object(a.isEmpty)(t)?"":`&${t}`}`}`}(i,n,s);return t({deepLinkId:e,path:o,absolute:r})}),[t,e,n]),search:n}},y=()=>{const e=Object(r.c)(),t=Object(s.a)();return Object(i.useCallback)((({deepLinkId:n,path:a="",absolute:i=!1,skipSearch:r=!1})=>{const s=r?"":t(n);return e({id:n,path:a,urlState:s,absolute:i})}),[e,t])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(544),u=n(174),c=n(126),d=n(153),m=n(564);const p=({field:e,tooltipContent:t})=>null!=t?t:e,f=r.a.memo((({children:e,field:t,tooltipContent:n,tooltipPosition:i,value:s})=>(e=>null===e)(n)?r.a.createElement(r.a.Fragment,null,e||s):r.a.createElement(a.EuiToolTip,{"data-test-subj":`${t}-tooltip`,position:i,content:p({tooltipContent:n,field:t})},r.a.createElement(r.a.Fragment,null,e||s))));f.displayName="Content";const b=r.a.memo((({hideTopN:e=!1,id:t,isDraggable:n=!0,field:a,fieldType:s="",isAggregatable:o=!1,value:c,name:p,children:b,scopeId:g,tooltipContent:v,tooltipPosition:y,queryValue:h,truncate:j})=>{const E=Object(i.useMemo)((()=>{var e;return{and:[],enabled:!0,id:Object(u.i)(t),name:p||(null!==(e=null==c?void 0:c.toString())&&void 0!==e?e:""),excluded:!1,kqlQuery:"",queryMatch:{field:a,value:h||(null!=c?c:""),operator:d.d}}}),[a,t,p,h,c]),O=Object(i.useCallback)(((e,t,n)=>n.isDragging?r.a.createElement(l.a,null,r.a.createElement(m.a,{dataProvider:e})):r.a.createElement(f,{field:a,tooltipContent:v,tooltipPosition:y,value:c},b)),[b,a,v,y,c]);return null==c?null:r.a.createElement(l.b,{dataProvider:E,fieldType:s,isAggregatable:o,hideTopN:e,isDraggable:n,render:O,scopeId:g,truncate:j})}));b.displayName="DefaultDraggable";const g=o()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1g0jgxk-0"})(["vertical-align:top;"]);g.displayName="Badge";const v=({contextId:e,eventId:t,field:n,value:a,iconType:i,isDraggable:s,isAggregatable:o,fieldType:l,name:u,color:d="hollow",children:m,scopeId:p,tooltipContent:f,queryValue:v})=>null!=a?r.a.createElement(b,{id:`draggable-badge-default-draggable-${e}-${t}-${n}-${a}`,isDraggable:s,isAggregatable:o,fieldType:l,field:n,name:u,value:a,scopeId:p,tooltipContent:f,queryValue:v},r.a.createElement(g,{iconType:i,color:d,title:""},m||(""!==a?a:Object(c.c)()))):null;v.displayName="DraggableBadgeComponent";const y=r.a.memo(v);y.displayName="DraggableBadge"},,function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.welcomeConversationTitle",{defaultMessage:"Welcome"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.defaultConversationTitle",{defaultMessage:"Default"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.elasticAiAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.elasticAiAssistantName",{defaultMessage:"Assistant"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(59),u=n.n(l),c=n(159),d=n(716),m=n(717);const p=o.a.header.withConfig({displayName:"Header",componentId:"sc-1q9aiyj-0"})(["&.toggle-expand{margin-bottom:",";}.no-margin{margin-top:0 !important;margin-bottom:0 !important;}"," margin-bottom:0;user-select:text;",""],(({theme:e})=>e.eui.euiSizeL),(({height:e})=>e&&Object(s.css)(["height:","px;"],e)),(({border:e})=>e&&Object(s.css)(["border-bottom:",";padding-bottom:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeL))));p.displayName="Header";const f=({alignHeader:e,stackHeader:t})=>null!=e?e:t?void 0:"center",b=({alignHeader:e,border:t,children:n,outerDirection:s="column",growLeftSplit:o=!0,headerFilters:l,height:b,hideSubtitle:g=!1,id:v,inspectMultiple:y=!1,inspectTitle:h,isInspectDisabled:j,showInspectButton:E=!0,split:O,stackHeader:x,subtitle:S,title:k,titleSize:w="l",toggleQuery:C,toggleStatus:T=!0,tooltip:M,tooltipTitle:I})=>{const A=Object(i.useCallback)((()=>{C&&C(!T)}),[C,T]),P=u()({"toggle-expand":T,siemHeaderSection:!0});return r.a.createElement(p,{"data-test-subj":"header-section",border:t,height:b,className:P,$hideSubtitle:g},r.a.createElement(a.EuiFlexGroup,{"data-test-subj":"headerSectionOuterFlexGroup",direction:s,gutterSize:"xs",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:o},r.a.createElement(a.EuiFlexGroup,{alignItems:f({alignHeader:e,stackHeader:x}),"data-test-subj":"headerSectionInnerFlexGroup",direction:x?"column":"row",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,{grow:o,className:T?"":"no-margin"},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{responsive:!1,gutterSize:"none",className:"header-section-titles"},C&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonIcon,{"data-test-subj":"query-toggle-header","aria-label":m.a(T),color:"text",display:"empty",iconType:T?"arrowDown":"arrowRight",onClick:A,size:"s",title:m.a(T)})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiTitle,{size:w},r.a.createElement("h4",{"data-test-subj":"header-section-title"},r.a.createElement("span",{className:"eui-textBreakNormal"},k),M&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiIconTip,{color:"subdued",title:I,content:M,size:"l",type:"iInCircle"}))))))),v&&T&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(c.b,{isDisabled:j,queryId:v,multiple:y,showInspectButton:E,title:null!=h?h:k})),l&&T&&r.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-filters",grow:!1},l))),n&&T&&r.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-supplements",grow:!!O},n))),!g&&T&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(d.a,{"data-test-subj":"header-section-subtitle",items:S}))))},g=r.a.memo(b)},,,function(e,t,n){const a=n(314),{MAX_LENGTH:i,MAX_SAFE_INTEGER:r}=n(315),{safeRe:s,t:o}=n(316),l=n(412),{compareIdentifiers:u}=n(514);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[o.LOOSE]:s[o.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let a=this.prerelease.length;for(;--a>=0;)"number"==typeof this.prerelease[a]&&(this.prerelease[a]++,a=-2);if(-1===a){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let a=[t,e];!1===n&&(a=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=SemVer},function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"n",(function(){return f}));var a=n(45),i=n(114),r=n(124),s=n(204),o=n(127),l=n(181),u=n(424);n.d(t,"f",(function(){return i.g})),n.d(t,"h",(function(){return i.i})),n.d(t,"g",(function(){return i.h})),n.d(t,"l",(function(){return i.m})),n.d(t,"k",(function(){return i.l})),n.d(t,"p",(function(){return i.r})),n.d(t,"o",(function(){return i.q})),n.d(t,"m",(function(){return i.n})),n.d(t,"i",(function(){return i.j})),n.d(t,"q",(function(){return i.w})),n.d(t,"r",(function(){return i.x})),n.d(t,"j",(function(){return i.k})),n.d(t,"a",(function(){return i.b})),n.d(t,"b",(function(){return i.e}));const c=({activeTimelineDataProviders:e,dataProviders:t,dispatch:n,result:a,timelineId:r,noProviderFound:s=l.b.noProviderFound,onAddedToTimeline:o})=>{const c=Object(i.p)(a),d=t[c];d?Object(u.b)({dataProviders:e,destination:a.destination,dispatch:n,onAddedToTimeline:o,providerToAdd:d,timelineId:r}):n(s({id:c}))},d=({isAggregatable:e,fieldType:t,fieldName:n,hideTopN:a})=>{const i=["boolean","geo-point","geo-shape","ip","keyword","number","numeric","string"].includes(t),r=["kibana.alert.ancestors.depth","kibana.alert.ancestors.id","kibana.alert.ancestors.rule","kibana.alert.ancestors.type","kibana.alert.original_event.action","kibana.alert.original_event.category","kibana.alert.original_event.code","kibana.alert.original_event.created","kibana.alert.original_event.dataset","kibana.alert.original_event.duration","kibana.alert.original_event.end","kibana.alert.original_event.hash","kibana.alert.original_event.id","kibana.alert.original_event.kind","kibana.alert.original_event.module","kibana.alert.original_event.original","kibana.alert.original_event.outcome","kibana.alert.original_event.provider","kibana.alert.original_event.risk_score","kibana.alert.original_event.risk_score_norm","kibana.alert.original_event.sequence","kibana.alert.original_event.severity","kibana.alert.original_event.start","kibana.alert.original_event.timezone","kibana.alert.original_event.type","kibana.alert.original_time","kibana.alert.rule.created_by","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.false_positives","kibana.alert.rule.from","kibana.alert.rule.uuid","kibana.alert.rule.immutable","kibana.alert.rule.interval","kibana.alert.rule.max_signals","kibana.alert.rule.name","kibana.alert.rule.note","kibana.alert.rule.references","kibana.alert.risk_score","kibana.alert.rule.rule_id","kibana.alert.severity","kibana.alert.rule.size","kibana.alert.rule.tags","kibana.alert.rule.threat","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.timeline_id","kibana.alert.rule.timeline_title","kibana.alert.rule.to","kibana.alert.rule.type","kibana.alert.rule.updated_by","kibana.alert.rule.version","kibana.alert.workflow_status"].includes(n);return!a&&(r||e&&i)},m={"kibana.alert.rule.name":"kibana.alert.rule.uuid","event.module":"rule.reference"},p=({browserFields:e,dispatch:t,result:n,scopeId:l,defaultsHeader:u})=>{var c;const d=Object(i.o)(n),p=(e=>Object(a.keyBy)("name",(e=>Object.values(e).reduce(((e,t)=>[...e,...Object.values(null!=t.fields?t.fields:{})]),[]))(e)))(e)[d],f=l!==r.e.alertsOnAlertsPage&&l!==r.e.alertsOnRuleDetailsPage||null===(c=u.find((e=>e.id===d)))||void 0===c?{}:c,b=Object(o.getScopedActions)(l);var g;null!=p&&b?t(b.upsertColumn({column:{category:p.category,columnHeaderType:"not-filtered",description:Object(a.isString)(p.description)?p.description:void 0,example:Object(a.isString)(p.example)?p.example:void 0,id:d,linkField:null!==(g=m[d])&&void 0!==g?g:void 0,type:p.type,aggregatable:p.aggregatable,initialWidth:s.a,...f},id:l,index:null!=n.destination?n.destination.index:0})):b&&t(b.upsertColumn({column:{columnHeaderType:"not-filtered",id:d,initialWidth:s.a},id:l,index:null!=n.destination?n.destination.index:0}))},f=e=>e.slice(e.lastIndexOf(".")+1)},,,function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"o",(function(){return r})),n.d(t,"r",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"k",(function(){return b})),n.d(t,"j",(function(){return g})),n.d(t,"i",(function(){return v})),n.d(t,"h",(function(){return y})),n.d(t,"g",(function(){return h})),n.d(t,"p",(function(){return j})),n.d(t,"q",(function(){return E}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.connectors.useLoadActionTypes.errorMessage",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into your Elastic Life. "}),r=a.i18n.translate("xpack.elasticAssistant.connectors.useLoadConnectors.errorMessage",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into your Elastic Life. "}),s=(a.i18n.translate("xpack.elasticAssistant.content.prompts.welcome.welcomeSecurityPrompt",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into Elastic Security. "}),a.i18n.translate("xpack.elasticAssistant.assistant.connectors.preconfiguredTitle",{defaultMessage:"Preconfigured"})),o=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.ariaLabel",{defaultMessage:"Conversation Selector"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.newConnectorOptions",{defaultMessage:"Add new Connector..."}),u=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelectorInline.connectorLabel",{defaultMessage:"Connector:"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelectorInline.connectorPlaceholder",{defaultMessage:"Select a Connector"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.title",{defaultMessage:"Add Generative AI Connector"}),m=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.description",{defaultMessage:"Configure a connector to continue the conversation"}),p=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.missingPrivilegesTitle",{defaultMessage:"Generative AI Connector Required"}),f=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.missingPrivilegesDescription",{defaultMessage:"Please contact your administrator to enable a Generative AI Connector."}),b=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.userYouTitle",{defaultMessage:"You"}),g=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.userAssistantTitle",{defaultMessage:"Assistant"}),v=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.timestampAtTitle",{defaultMessage:"at"}),y=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.skipTitle",{defaultMessage:"Click to skip..."}),h=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.complete",{defaultMessage:"Connector setup complete!"}),j=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.calloutTitle",{defaultMessage:"The current conversation is missing a connector configuration"}),E=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.conversationSettingsLink",{defaultMessage:"Conversation Settings"})},,function(e,t,n){"use strict";e.exports=n(611)},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(2),i=n(110);const r={managed:!0},s=()=>{const{services:{apm:e}}=Object(i.i)();return{startTransaction:Object(a.useCallback)((({name:t,type:n="user-interaction",options:a})=>e.startTransaction(t,n,null!=a?a:r)),[e])}},o=e=>`Timeline search ${e}`},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return m}));var a=n(4);const i="histogram-actions-trigger",r={[a.yc.hosts]:"host",[a.yc.users]:"user"},s=(e,t)=>{const n=r[e];return n&&t?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:`${n}.name`,params:{query:t}},query:{match_phrase:{[`${n}.name`]:t}}}]:[]},o=e=>{const t=r[e];return t&&e?[{query:{bool:{should:[{exists:{field:`${t}.name`}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:`{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "${t}.name"}}],"minimum_should_match": 1}}]}}}`}}]:[]},l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"source.ip",params:{query:e}},query:{bool:{should:[{match_phrase:{"source.ip":e}},{match_phrase:{"destination.ip":e}}],minimum_should_match:1}}}]:[],u=[{query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],c=e=>e.length>=1?[{meta:{type:"phrases",key:"_index",params:e,alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({match_phrase:{_index:e}}))),minimum_should_match:1}}}]:[],d=e=>(null!=e?e:[]).reduce(((e,t)=>{var n,a,i,r,s,o;return{requests:[...e.requests,JSON.stringify({body:null==t?void 0:t.json,index:(null!==(n=null==t||null===(a=t.stats)||void 0===a||null===(i=a.indexFilter)||void 0===i?void 0:i.value)&&void 0!==n?n:"").split(",")},null,2)],responses:[...e.responses,JSON.stringify(null!==(r=null==t||null===(s=t.response)||void 0===s||null===(o=s.json)||void 0===o?void 0:o.rawResponse)&&void 0!==r?r:{},null,2)]}}),{requests:[],responses:[]}),m=e=>e.reduce(((e,t)=>{try{return[...e,JSON.parse(t)]}catch(t){return e}}),[])},function(e,t,n){"use strict";n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return N})),n.d(t,"d",(function(){return z})),n.d(t,"e",(function(){return Q})),n.d(t,"g",(function(){return Y.b})),n.d(t,"f",(function(){return Y.a}));var a=n(111),i=n(182),r=n(148),s=n(141);const o=a.z.literal("RULE_NOT_MODIFIED"),l=a.z.object({id:a.z.string(),name:a.z.string().optional(),skip_reason:o}),u=a.z.object({id:a.z.string(),name:a.z.string().optional()}),c=a.z.enum(["IMMUTABLE","MACHINE_LEARNING_AUTH","MACHINE_LEARNING_INDEX_PATTERN","ESQL_INDEX_PATTERN"]),d=(c.enum,a.z.object({message:a.z.string(),status_code:a.z.number().int(),err_code:c.optional(),rules:a.z.array(u)})),m=a.z.object({updated:a.z.array(r.e),created:a.z.array(r.e),deleted:a.z.array(r.e),skipped:a.z.array(l)}),p=a.z.object({failed:a.z.number().int(),skipped:a.z.number().int(),succeeded:a.z.number().int(),total:a.z.number().int()}),f=a.z.object({success:a.z.boolean().optional(),status_code:a.z.number().int().optional(),message:a.z.string().optional(),rules_count:a.z.number().int().optional(),attributes:a.z.object({results:m,summary:p,errors:a.z.array(d).optional()})}),b=a.z.string(),g=a.z.object({query:a.z.string().optional(),ids:a.z.array(a.z.string()).min(1).optional()}),v=g.merge(a.z.object({action:a.z.literal("delete")})),y=g.merge(a.z.object({action:a.z.literal("disable")})),h=g.merge(a.z.object({action:a.z.literal("enable")})),j=g.merge(a.z.object({action:a.z.literal("export")})),E=g.merge(a.z.object({action:a.z.literal("duplicate"),duplicate:a.z.object({include_exceptions:a.z.boolean(),include_expired_exceptions:a.z.boolean()}).optional()})),O=a.z.enum(["rule","1h","1d","7d"]),x=(O.enum,a.z.enum(["enable","disable","export","delete","duplicate","edit"]).enum),S=a.z.enum(["add_tags","delete_tags","set_tags","add_index_patterns","delete_index_patterns","set_index_patterns","set_timeline","add_rule_actions","set_rule_actions","set_schedule"]).enum,k=a.z.object({group:s.u,id:s.v,params:s.w,frequency:s.t.optional(),alerts_filter:s.s.optional()}).strict(),w=a.z.object({type:a.z.enum(["add_rule_actions","set_rule_actions"]),value:a.z.object({throttle:O.optional(),actions:a.z.array(k)})}),C=a.z.object({type:a.z.literal("set_schedule"),value:a.z.object({interval:a.z.string().regex(/^[1-9]\d*[smh]$/),lookback:a.z.string().regex(/^[1-9]\d*[smh]$/)})}),T=a.z.object({type:a.z.enum(["add_index_patterns","delete_index_patterns","set_index_patterns"]),value:s.f,overwrite_data_views:a.z.boolean().optional()}),M=a.z.object({type:a.z.enum(["add_tags","delete_tags","set_tags"]),value:s.O}),I=a.z.object({type:a.z.literal("set_timeline"),value:a.z.object({timeline_id:s.Y,timeline_title:s.Z})}),A=a.z.union([M,T,I,w,C]),P=g.merge(a.z.object({action:a.z.literal("edit"),edit:a.z.array(A).min(1)}));a.z.object({dry_run:i.b.optional()}),a.z.union([v,y,h,j,E,P]),a.z.union([f,b]);var _=n(299);a.z.array(a.z.union([r.e,_.a])),a.z.array(r.c),a.z.array(a.z.object({id:s.K.optional(),rule_id:s.N.optional()})),a.z.array(r.d),a.z.array(r.f);var D=n(46),F=n(120);let N;!function(e){e.Enabled="enabled",e.Disabled="disabled"}(N||(N={}));const R=Object(F.r)("CoverageOverviewRuleActivity",N);let z;!function(e){e.Prebuilt="prebuilt",e.Custom="custom"}(z||(z={}));const L=Object(F.r)("CoverageOverviewRuleSource",z),B=D.partial({search_term:F.j,activity:Object(F.i)(R),source:Object(F.i)(L)}),q=(D.exact(D.partial({filter:B})),D.type({name:D.string,activity:R}));D.exact(D.type({coverage:D.record(D.string,Object(F.i)(D.string)),unmapped_rule_ids:D.array(D.string),rules_data:D.record(D.string,q)})),r.c,r.e,a.z.object({id:s.K.optional(),rule_id:s.N.optional()}),r.e,r.d,r.e,a.z.object({id:s.K.optional(),rule_id:s.N.optional()}),r.e,r.f,r.e;var $=n(139);const V={exported_count:D.number,exported_rules_count:D.number,missing_rules:D.array(D.exact(D.type({rule_id:F.j}))),missing_rules_count:D.number},U=D.intersection([D.exact(D.type({id:F.j,type:F.j})),D.exact(D.partial({reason:D.string}))]),H={exported_action_connector_count:D.number,missing_action_connection_count:D.number,missing_action_connections:D.array(D.exact(D.type({id:F.j,type:F.j}))),excluded_action_connection_count:D.number,excluded_action_connections:D.array(U)};D.intersection([D.exact(D.type(V)),D.exact(D.partial($.p)),D.exact(D.partial(H))]),a.z.object({exclude_export_details:i.b.optional().default(!1),file_name:a.z.string().optional().default("export.ndjson")}),a.z.object({objects:a.z.array(a.z.object({rule_id:s.N}))}).nullable();var G=n(248);const Q=a.z.enum(["created_at","createdAt","enabled","execution_summary.last_execution.date","execution_summary.last_execution.metrics.execution_gap_duration_s","execution_summary.last_execution.metrics.total_indexing_duration_ms","execution_summary.last_execution.metrics.total_search_duration_ms","execution_summary.last_execution.status","name","risk_score","riskScore","severity","updated_at","updatedAt"]);Q.enum,a.z.object({fields:Object(i.a)(a.z.string()).optional(),filter:a.z.string().optional(),sort_field:Q.optional(),sort_order:G.a.optional(),page:a.z.coerce.number().int().min(1).optional().default(1),per_page:a.z.coerce.number().int().min(0).optional().default(20)}),a.z.object({page:a.z.number().int(),perPage:a.z.number().int(),total:a.z.number().int(),data:a.z.array(r.e)}),D.exact(D.type({rules_summary:D.type({custom_count:F.m,prebuilt_installed_count:F.m}),aggregated_fields:D.type({tags:D.array(D.string)})}));var W=n(371);a.z.object({overwrite:i.b.optional().default(!1),overwrite_exceptions:i.b.optional().default(!1),overwrite_action_connectors:i.b.optional().default(!1),as_new_list:i.b.optional().default(!1)}),a.z.object({exceptions_success:a.z.boolean(),exceptions_success_count:a.z.number().int().min(0),exceptions_errors:a.z.array(_.a),rules_count:a.z.number().int().min(0),success:a.z.boolean(),success_count:a.z.number().int().min(0),errors:a.z.array(_.a),action_connectors_errors:a.z.array(_.a),action_connectors_warnings:a.z.array(W.a),action_connectors_success:a.z.boolean(),action_connectors_success_count:a.z.number().int().min(0)}).strict();var K=n(247);K.b.and(K.f).and(K.c.partial().extend({rule_id:K.d,immutable:a.literal(!1).default(!1)})),s.O;var Y=n(410)},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return a.a})),n.d(t,"j",(function(){return a.b})),n.d(t,"c",(function(){return St})),n.d(t,"a",(function(){return Et})),n.d(t,"f",(function(){return Mt})),n.d(t,"g",(function(){return Pt})),n.d(t,"k",(function(){return wt})),n.d(t,"i",(function(){return E.a})),n.d(t,"b",(function(){return Y})),n.d(t,"e",(function(){return se.c})),n.d(t,"h",(function(){return se.d}));var a=n(123),i=n(2),r=n.n(i),s=n(17),o=n(302),l=n.n(o),u=n(44),c=n.n(u),d=n(67),m=n(13),p=n(253),f=n(221),b=n(388),g=n(250),v=n(45),y=n(51);const h=({currentReplacements:e,rawValue:t})=>{if(null!=e){const n=Object(v.invert)(e)[t];return null!=n?n:Object(y.v4)()}return Object(y.v4)()};var j=n(374),E=n(222);var O=n(249),x={name:"a4hmbt",styles:"position:absolute"};const S=({isDisabled:e,isLoading:t,onChatCleared:n,onSendMessage:a})=>Object(m.jsx)(s.EuiFlexGroup,{css:x,direction:"column",gutterSize:"xs"},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiToolTip,{position:"right",content:O.b},Object(m.jsx)(s.EuiButtonIcon,{"aria-label":O.b,color:"danger","data-test-subj":"clear-chat",display:"base",iconType:"cross",isDisabled:e,onClick:n}))),Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiToolTip,{position:"right",content:O.g},Object(m.jsx)(s.EuiButtonIcon,{"aria-label":O.g,"data-test-subj":"submit-chat",color:"primary",display:"base",iconType:"returnKey",isDisabled:e,isLoading:t,onClick:a}))));var k=n(5);const w=k.i18n.translate("xpack.elasticAssistant.assistant.promptPlaceholder",{defaultMessage:"Ask me anything from 'summarize this alert' to 'help me build a query...'"}),C=c()(s.EuiTextArea)`
  min-height: 125px;
  padding-right: 42px;
`,T=Object(i.forwardRef)((({isDisabled:e=!1,value:t,onPromptSubmit:n,handlePromptChange:a,...r},s)=>{const o=Object(i.useCallback)((e=>{a(e.target.value)}),[a]),l=Object(i.useCallback)((e=>{var i;"Enter"===e.key&&!e.shiftKey&&t.trim().length>0?(e.preventDefault(),n(null===(i=e.target.value)||void 0===i?void 0:i.trim()),a("")):"Enter"!==e.key||e.shiftKey||0!==t.trim().length||(e.preventDefault(),e.stopPropagation())}),[t,n,a]);return Object(i.useEffect)((()=>{a(t)}),[a,t]),Object(m.jsx)(C,{className:"eui-scrollBar",inputRef:s,id:"prompt-textarea","data-test-subj":"prompt-textarea",fullWidth:!0,autoFocus:!0,disabled:e,placeholder:w,value:t,onChange:o,onKeyDown:l})}));T.displayName="PromptTextArea";var M={name:"zyunh5",styles:"left:-34px;position:relative;top:11px"},I={name:"1d3w5wq",styles:"width:100%"};const A=({handleButtonSendMessage:e,handleOnChatCleared:t,handlePromptChange:n,handleSendMessage:a,isDisabled:r,isLoading:o,shouldRefocusPrompt:l,userPrompt:u})=>{const c=Object(i.useRef)(null);Object(i.useEffect)((()=>{l&&c.current&&(null==c||c.current.focus())}),[l]);const d=Object(i.useMemo)((()=>r?"":null!=u?u:""),[r,u]),p=Object(i.useCallback)((()=>{var t,n,a;e(null!==(t=null===(n=c.current)||void 0===n||null===(a=n.value)||void 0===a?void 0:a.trim())&&void 0!==t?t:"")}),[e,c]);return Object(m.jsx)(s.EuiFlexGroup,{gutterSize:"none",css:I},Object(m.jsx)(s.EuiFlexItem,null,Object(m.jsx)(T,{onPromptSubmit:a,ref:c,handlePromptChange:n,value:d,isDisabled:r})),Object(m.jsx)(s.EuiFlexItem,{css:M,grow:!1},Object(m.jsx)(S,{onChatCleared:t,isDisabled:r,isLoading:o,onSendMessage:p})))},P=k.i18n.translate("xpack.elasticAssistant.components.upgrade.upgradeTitle",{defaultMessage:"Manage license"}),_=k.i18n.translate("xpack.elasticAssistant.components.upgrade.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),D=({basePath:e})=>Object(m.jsx)(s.EuiFlexGroup,{gutterSize:"s",wrap:!0,"data-test-subj":"upgrade-buttons"},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},_)),Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiButton,{href:`${e}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},P))),F=r.a.memo(D);F.displayName="UpgradeButtons";var N={name:"1d3w5wq",styles:"width:100%"},R={name:"1d3w5wq",styles:"width:100%"};const z=({connectorPrompt:e,http:t,isAssistantEnabled:n,isWelcomeSetup:a})=>{const i=t.basePath.get();return n?a?Object(m.jsx)(s.EuiFlexGroup,{css:N},Object(m.jsx)(s.EuiFlexItem,{"data-test-subj":"connector-prompt"},e)):null:Object(m.jsx)(s.EuiFlexGroup,{justifyContent:"spaceAround",css:R},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(F,{basePath:i})))};var L=n(47),B=n(179),q=n(496),$=n(220),V=n(177),U=n(252);const H=Object(B.css)({name:"1azv1pg",styles:"height:32px;.euiSuperSelect{width:400px;}.euiSuperSelectControl{border:none;box-shadow:none;background:none;padding-left:0;}.euiFormControlLayoutIcons{right:14px;top:2px;}"}),G=Object(B.css)({name:"94g3yr",styles:"overflow:hidden;text-overflow:ellipsis;max-width:400px"}),Q=Object(B.css)({name:"gexgj1",styles:"overflow:hidden;text-overflow:ellipsis;max-width:400px;font-weight:normal;padding-bottom:5px;padding-left:0;padding-top:2px"}),W=r.a.memo((({isDisabled:e=!1,selectedConnectorId:t,selectedConversation:n})=>{var r,o;const[l,u]=Object(i.useState)(!1),{actionTypeRegistry:c,assistantAvailability:d,http:p}=Object(a.b)(),{setApiConfig:b}=Object(f.a)(),{data:g}=Object($.a)({http:p}),v=null!==(r=null===(o=Object(i.useMemo)((()=>g?g.map((e=>({...e,connectorTypeTitle:Object(U.a)(c.get(e.actionTypeId))}))):[]),[c,g]).find((e=>e.id===t)))||void 0===o?void 0:o.name)&&void 0!==r?r:V.m,y=e||!d.hasConnectorsReadPrivilege,h=Object(i.useCallback)((()=>{u(!l)}),[l]),j=Object(i.useCallback)((e=>{const t=e.id;if("ADD_NEW_CONNECTOR"===t)return;const a=Object(U.b)(e),i=null==a?void 0:a.apiProvider,r=null==a?void 0:a.defaultModel;u(!1),null!=n&&b({conversationId:n.id,apiConfig:{...n.apiConfig,connectorId:t,connectorTypeTitle:e.connectorTypeTitle,provider:null!=i?i:null==a?void 0:a.apiProvider,model:null!=r?r:null==a?void 0:a.defaultModel}})}),[n,b]);return Object(m.jsx)(s.EuiFlexGroup,{alignItems:"center",className:H,direction:"row",gutterSize:"xs",justifyContent:"flexStart",responsive:!1},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiText,{size:"xs",color:"subdued"},V.l)),Object(m.jsx)(s.EuiFlexItem,null,l?Object(m.jsx)(q.a,{displayFancy:e=>Object(m.jsx)(s.EuiText,{className:G,size:"xs"},e),isOpen:!0,isDisabled:y,selectedConnectorId:t,setIsOpen:u,onConnectorSelectionChange:j}):Object(m.jsx)("span",null,Object(m.jsx)(s.EuiButtonEmpty,{className:Q,color:"text","data-test-subj":"connectorSelectorPlaceholderButton",iconSide:"right",iconType:"arrowDown",isDisabled:y,onClick:h,size:"xs"},v))))}));W.displayName="ConnectorSelectorInline";const K={xl:64,l:48,m:32,s:24,xs:16},Y=({size:e="s"})=>Object(m.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:K[e],height:K[e],viewBox:"0 0 64 64",fill:"none"},Object(m.jsx)("path",{fill:"#F04E98",d:"M36 28h24v36H36V28Z"}),Object(m.jsx)("path",{fill:"#00BFB3",d:"M4 46c0-9.941 8.059-18 18-18h6v36h-6c-9.941 0-18-8.059-18-18Z"}),Object(m.jsx)("path",{fill:"#343741",d:"M60 12c0 6.627-5.373 12-12 12s-12-5.373-12-12S41.373 0 48 0s12 5.373 12 12Z"}),Object(m.jsx)("path",{fill:"#FA744E",d:"M6 23C6 10.85 15.85 1 28 1v22H6Z"}));var X={name:"1y0ex1",styles:"max-width:400px"};const J=({isDisabled:e=!1,title:t,docLinks:n,selectedConversation:a})=>{var r;const o=null==a||null===(r=a.apiConfig)||void 0===r?void 0:r.connectorId,{ELASTIC_WEBSITE_URL:l,DOC_LINK_VERSION:u}=n,c=`${l}guide/en/security/${u}/security-assistant.html`,d=Object(i.useMemo)((()=>Object(m.jsx)(s.EuiLink,{"aria-label":O.h,"data-test-subj":"externalDocumentationLink",external:!0,href:c,target:"_blank"},O.d)),[c]),p=Object(i.useMemo)((()=>Object(m.jsx)(L.FormattedMessage,{defaultMessage:"Responses from AI systems may not always be entirely accurate. For more information on the assistant feature and its usage, please reference the {documentationLink}.",id:"xpack.elasticAssistant.assistant.technicalPreview.tooltipContent",values:{documentationLink:d}})),[d]),[f,b]=Object(i.useState)(!1),g=Object(i.useCallback)((()=>b((e=>!e))),[]),v=Object(i.useCallback)((()=>b(!1)),[]);return Object(m.jsx)(s.EuiModalHeaderTitle,null,Object(m.jsx)(s.EuiFlexGroup,{gutterSize:"m"},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(Y,{"data-test-subj":"titleIcon",size:"m"})),Object(m.jsx)(s.EuiFlexGroup,{direction:"column",gutterSize:"none",justifyContent:"center"},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiTitle,{size:"s"},Object(m.jsx)("h3",null,t))),Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiPopover,{button:Object(m.jsx)(s.EuiButtonIcon,{"aria-label":O.h,"data-test-subj":"tooltipIcon",iconType:"iInCircle",onClick:g}),isOpen:f,closePopover:v,anchorPosition:"rightUp"},Object(m.jsx)(s.EuiText,{"data-test-subj":"tooltipContent",grow:!1,css:X},Object(m.jsx)(s.EuiText,{size:"s"},Object(m.jsx)("p",null,p))))))),Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(W,{isDisabled:e||void 0===a,selectedConnectorId:o,selectedConversation:a})))))},Z=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.defaultConversationTitle",{defaultMessage:"Conversations"}),ee=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.ariaLabel",{defaultMessage:"Conversation selector"}),te=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.placeholderTitle",{defaultMessage:"Select or type to create new..."}),ne=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.CustomOptionTextTitle",{defaultMessage:"Create new conversation:"}),ae=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.previousConversationTitle",{defaultMessage:"Previous conversation"}),ie=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.nextConversationTitle",{defaultMessage:"Next conversation"}),re=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.deleteConversationTitle",{defaultMessage:"Delete conversation"});var se=n(168);const oe=navigator.platform.toLowerCase().indexOf("mac")>=0,le=(e,t)=>0===e.indexOf(t)?e[e.length-1]:e[e.indexOf(t)-1];var ue={name:"1v0pok0",styles:"min-width:300px"},ce={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},de={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},me={name:"1e5733u",styles:"width:calc(100% - 60px)"};const pe=r.a.memo((({selectedConversationId:e=se.a,defaultConnectorId:t,defaultProvider:n,onConversationSelected:r,shouldDisableKeyboardShortcut:o=(()=>!1),isDisabled:u=!1})=>{const{allSystemPrompts:c,conversations:d}=Object(a.b)(),{deleteConversation:p,setConversation:b}=Object(f.a)(),g=Object(i.useMemo)((()=>Object.keys(d)),[d]),v=Object(i.useMemo)((()=>Object.values(d).map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.id}}))),[d]),[y,h]=Object(i.useState)((()=>{var t;return null!==(t=v.filter((t=>t.label===e)))&&void 0!==t?t:[]})),j=Object(i.useCallback)(((e,a=[])=>{if(!e||!e.trim().toLowerCase())return;const i=e.trim().toLowerCase(),s=c.find((e=>e.isNewConversationDefault));if(-1===a.findIndex((e=>e.label.trim().toLowerCase()===i))){const a={id:e,messages:[],apiConfig:{connectorId:t,provider:n,defaultSystemPromptId:null==s?void 0:s.id}};b({conversation:a})}r(e)}),[c,t,n,b,r]),E=Object(i.useCallback)((t=>{e===t&&r(le(g,t)),setTimeout((()=>{p(t)}),0)}),[g,p,e,r]),O=Object(i.useCallback)((e=>{0===e.length?h([]):-1!==v.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&r(null==e?void 0:e[0].label)}),[v,r]),x=Object(i.useCallback)((()=>{const t=le(g,e);r(t)}),[g,e,r]),S=Object(i.useCallback)((()=>{const t=((e,t)=>e.indexOf(t)+1>=e.length?e[0]:e[e.indexOf(t)+1])(g,e);r(t)}),[g,e,r]),k=Object(i.useCallback)((e=>{u||g.length<=1||("ArrowLeft"===e.key&&(oe?e.metaKey:e.ctrlKey)&&!o()&&(e.preventDefault(),x()),"ArrowRight"===e.key&&(oe?e.metaKey:e.ctrlKey)&&!o()&&(e.preventDefault(),S()))}),[g.length,u,x,S,o]);return l()("keydown",k),Object(i.useEffect)((()=>{h(v.filter((t=>t.label===e)))}),[v,e]),Object(m.jsx)(s.EuiFormRow,{label:Z,display:"rowCompressed",css:ue},Object(m.jsx)(s.EuiComboBox,{"data-test-subj":"conversation-selector","aria-label":ee,customOptionText:`${ne} {searchValue}`,placeholder:te,singleSelection:{asPlainText:!0},options:v,selectedOptions:y,onChange:O,onCreateOption:j,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(m.jsx)(s.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween","data-test-subj":`convo-option-${a}`},Object(m.jsx)(s.EuiFlexItem,{component:"span",grow:!1,css:me},Object(m.jsx)(s.EuiHighlight,{search:t,css:de},a)),!(null!=i&&i.isDefault)&&Object(m.jsx)(s.EuiFlexItem,{grow:!1,component:"span"},Object(m.jsx)(s.EuiToolTip,{position:"right",content:re},Object(m.jsx)(s.EuiButtonIcon,{iconType:"cross","aria-label":re,color:"danger",onClick:e=>{e.stopPropagation(),E(a)},"data-test-subj":"delete-option",css:ce}))))},compressed:!0,isDisabled:u,prepend:Object(m.jsx)(s.EuiToolTip,{content:`${ae} (⌘ + ←)`,display:"block"},Object(m.jsx)(s.EuiButtonIcon,{iconType:"arrowLeft","aria-label":ae,onClick:x,disabled:u||g.length<=1})),append:Object(m.jsx)(s.EuiToolTip,{content:`${ie} (⌘ + →)`,display:"block"},Object(m.jsx)(s.EuiButtonIcon,{iconType:"arrowRight","aria-label":ie,onClick:S,disabled:u||g.length<=1}))}))}));pe.displayName="ConversationSelector";var fe=n(259),be=n(493);const ge=r.a.memo((({defaultConnectorId:e,defaultProvider:t,isDisabled:n=!1,isSettingsModalVisible:o,setIsSettingsModalVisible:l,selectedConversation:u,setSelectedConversationId:c})=>{const{toasts:d,setSelectedSettingsTab:p}=Object(a.b)(),f=Object(i.useCallback)((()=>{l(!1)}),[l]),b=Object(i.useCallback)((()=>{f()}),[f]),g=Object(i.useCallback)((()=>{f(),null==d||d.addSuccess({iconType:"check",title:be.j})}),[f,d]),v=Object(i.useCallback)((()=>{p(fe.b),l(!0)}),[l,p]);return Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(s.EuiToolTip,{position:"right",content:be.i},Object(m.jsx)(s.EuiButtonIcon,{"aria-label":be.h,"data-test-subj":"settings",onClick:v,isDisabled:n,iconType:"gear",size:"xs"})),o&&Object(m.jsx)(fe.a,{defaultConnectorId:e,defaultProvider:t,selectedConversation:u,setSelectedConversationId:c,onClose:b,onSave:g}))}));ge.displayName="AssistantSettingsButton";var ve={name:"1h6p4mk",styles:"width:335px"},ye={name:"1d3w5wq",styles:"width:100%"};const he=({currentConversation:e,defaultConnectorId:t,defaultProvider:n,docLinks:a,isDisabled:o,isSettingsModalVisible:l,onConversationSelected:u,onToggleShowAnonymizedValues:c,selectedConversationId:d,setIsSettingsModalVisible:p,setSelectedConversationId:f,shouldDisableKeyboardShortcut:b,showAnonymizedValues:g,title:v})=>{const y=Object(i.useMemo)((()=>null!=e.replacements&&Object.keys(e.replacements).length>0&&g),[e.replacements,g]);return Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(s.EuiFlexGroup,{css:ye,alignItems:"center",justifyContent:"spaceBetween"},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(J,{isDisabled:o,docLinks:a,selectedConversation:e,title:v})),Object(m.jsx)(s.EuiFlexItem,{grow:!1,css:ve},Object(m.jsx)(pe,{defaultConnectorId:t,defaultProvider:n,selectedConversationId:d,onConversationSelected:u,shouldDisableKeyboardShortcut:b,isDisabled:o}),Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(s.EuiSpacer,{size:"s"}),Object(m.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiToolTip,{content:O.f,position:"left",repositionOnScroll:!0},Object(m.jsx)(s.EuiSwitch,{"data-test-subj":"showAnonymizedValues",checked:y,compressed:!0,disabled:null==e.replacements,label:O.e,onChange:c}))),Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(ge,{defaultConnectorId:t,defaultProvider:n,isDisabled:o,isSettingsModalVisible:l,selectedConversation:e,setIsSettingsModalVisible:p,setSelectedConversationId:f})))))),Object(m.jsx)(s.EuiHorizontalRule,{margin:"m"}))};async function je({defaultAllow:e,defaultAllowReplacement:t,promptContext:n}){const a=await n.getPromptContext();return"string"==typeof a?{allow:[],allowReplacement:[],promptContextId:n.id,rawData:a}:{allow:[...e],allowReplacement:[...t],promptContextId:n.id,rawData:a}}const Ee=c()(s.EuiButton)`
  margin-right: ${({theme:e})=>e.eui.euiSizeXS};
`,Oe=({defaultAllow:e,defaultAllowReplacement:t,promptContexts:n,selectedPromptContexts:a,setSelectedPromptContexts:r})=>{const o=Object(i.useMemo)((()=>Object(v.sortBy)("description",Object.values(n))),[n]),l=Object(i.useCallback)((async i=>{if(null==a[i]&&null!=n[i]){const a=await je({defaultAllow:e,defaultAllowReplacement:t,promptContext:n[i]});r((e=>({...e,[i]:a})))}}),[e,t,n,a,r]);return Object(m.jsx)(s.EuiFlexGroup,{gutterSize:"none",wrap:!0},o.map((({description:e,id:t,getPromptContext:n,tooltip:i})=>{const r=Object(m.jsx)(Ee,{"data-test-subj":`pillButton-${t}`,disabled:null!=a[t],iconSide:"left",iconType:"plus",onClick:()=>l(t)},e);return Object(m.jsx)(s.EuiFlexItem,{grow:!1,key:t},null!=a[t]?r:Object(m.jsx)(s.EuiToolTip,{content:i},r))})))},xe=r.a.memo(Oe);var Se=n(373),ke=n(551),we={name:"1m5oqbf",styles:"white-space:pre-line;&:hover{cursor:pointer;text-decoration:underline;}"};const Ce=({conversation:e,editingSystemPromptId:t,isSettingsModalVisible:n,onSystemPromptSelectionChange:o,setIsSettingsModalVisible:l})=>{const{allSystemPrompts:u}=Object(a.b)(),c=Object(i.useMemo)((()=>{var n;return void 0!==t?null!==(n=null==u?void 0:u.find((e=>e.id===t)))&&void 0!==n?n:null==u?void 0:u.find((t=>t.id===(null==e?void 0:e.apiConfig.defaultSystemPromptId))):void 0}),[u,null==e?void 0:e.apiConfig.defaultSystemPromptId,t]),[d,p]=r.a.useState(!1),f=Object(i.useCallback)((()=>{e&&o(void 0)}),[e,o]),b=Object(i.useCallback)((()=>p(!0)),[]);return Object(m.jsx)("div",null,null==c||d?Object(m.jsx)(ke.a,{allSystemPrompts:u,clearSelectedSystemPrompt:f,conversation:e,"data-test-subj":"systemPrompt",isClearable:!0,isEditing:d,isOpen:d,isSettingsModalVisible:n,onSystemPromptSelectionChange:o,selectedPrompt:c,setIsEditing:p,setIsSettingsModalVisible:l}):Object(m.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none"},Object(m.jsx)(s.EuiFlexItem,{grow:!0},Object(m.jsx)(s.EuiText,{color:"subdued","data-test-subj":"systemPromptText",onClick:b,css:we},Object(v.isEmpty)(null==c?void 0:c.content)?Se.d:null==c?void 0:c.content)),Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiFlexGroup,{gutterSize:"none"},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiToolTip,{content:Se.e},Object(m.jsx)(s.EuiButtonIcon,{"aria-label":Se.e,"data-test-subj":"edit",iconType:"documentEdit",onClick:b}))),Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiToolTip,{content:Se.c},Object(m.jsx)(s.EuiButtonIcon,{"aria-label":Se.c,"data-test-subj":"clear",iconType:"cross",onClick:f})))))))};Ce.displayName="SystemPromptComponent";const Te=r.a.memo(Ce),Me=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.commentsListAriaLabel",{defaultMessage:"List of comments"}),Ie=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.editingPromptLabel",{defaultMessage:"editing prompt"}),Ae=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.youLabel",{defaultMessage:"You"});var Pe=n(543),_e=n(494);const De=({rawData:e})=>Object(m.jsx)(s.EuiCodeBlock,{"data-test-subj":"readOnlyContextViewer",isCopyable:!0},Object(g.e)(e));De.displayName="ReadOnlyContextViewerComponent";const Fe=r.a.memo(De);var Ne=n(552),Re=n(547),ze=n(372);const Le=k.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableDescription",{defaultMessage:"Available"}),Be=({total:e})=>{const t=Object(i.useMemo)((()=>(e=>k.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableTooltip",{values:{total:e},defaultMessage:"{total} fields in this context are available to be included in the conversation"}))(e)),[e]);return Object(m.jsx)(s.EuiToolTip,{content:t},Object(m.jsx)(s.EuiStat,{"data-test-subj":"availableStat",description:Le,reverse:!0,title:e,titleSize:ze.a}))};Be.displayName="AvailableStatComponent";const qe=r.a.memo(Be),$e=c()(s.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeL};
`,Ve=({isDataAnonymizable:e,selectedPromptContext:t})=>{const{allowed:n,anonymized:a,total:r}=Object(i.useMemo)((()=>(({allow:e,allowReplacement:t,rawData:n})=>{const a={allowed:0,anonymized:0,denied:0,total:0};if("string"==typeof n)return a;{const i=Object.keys(n),r=new Set(t),s=new Set(e);return i.reduce(((e,t)=>({allowed:e.allowed+(Object(b.a)({allowSet:s,field:t})?1:0),anonymized:e.anonymized+(Object(b.a)({allowSet:s,field:t})&&Object(b.b)({allowReplacementSet:r,field:t})?1:0),denied:e.denied+(Object(b.c)({allowSet:s,field:t})?1:0),total:e.total+1})),a)}})(t)),[t]);return Object(m.jsx)(s.EuiFlexGroup,{alignItems:"center","data-test-subj":"stats",gutterSize:"none"},e&&Object(m.jsx)($e,{grow:!1},Object(m.jsx)(Ne.a,{allowed:n,total:r})),Object(m.jsx)($e,{grow:!1},Object(m.jsx)(Re.a,{anonymized:a,isDataAnonymizable:e})),e&&Object(m.jsx)($e,{grow:!1},Object(m.jsx)(qe,{total:r})))};Ve.displayName="StatsComponent";const Ue=r.a.memo(Ve),He=c.a.div`
  overflow-x: auto;
`,Ge=({selectedPromptContext:e,setSelectedPromptContexts:t})=>{const{defaultAllow:n,defaultAllowReplacement:r,setDefaultAllow:o,setDefaultAllowReplacement:l}=Object(a.b)(),u=Object(i.useMemo)((()=>Object(_e.a)(e.rawData)),[e]),c=Object(i.useCallback)((a=>{const i=a.reduce(((e,{field:t,operation:n,update:a})=>Object(_e.c)({field:t,operation:n,selectedPromptContext:e,update:a})),e);t((t=>({...t,[e.promptContextId]:i}))),Object(_e.b)({defaultAllow:n,defaultAllowReplacement:r,setDefaultAllow:o,setDefaultAllowReplacement:l,updates:a})}),[n,r,e,o,l,t]);return Object(m.jsx)(He,{"data-test-subj":"dataAnonymizationEditor"},Object(m.jsx)(Ue,{isDataAnonymizable:u,selectedPromptContext:e}),Object(m.jsx)(s.EuiSpacer,{size:"s"}),"string"==typeof e.rawData?Object(m.jsx)(Fe,{rawData:e.rawData}):Object(m.jsx)(Pe.a,{allow:e.allow,allowReplacement:e.allowReplacement,onListUpdated:c,rawData:e.rawData}))},Qe=r.a.memo(Ge),We=k.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.selectedPromotContexts.removeContextTooltip",{defaultMessage:"Remove context"}),Ke=c.a.div`
  ${({$accordionState:e})=>"closed"===e?"height: 0px;":""}
  ${({$accordionState:e})=>"closed"===e?"overflow: hidden;":""}
  ${({$accordionState:e})=>"closed"===e?"position: absolute;":""}
`,Ye=({isNewConversation:e,promptContexts:t,selectedPromptContexts:n,setSelectedPromptContexts:a})=>{const[o,l]=r.a.useState("closed"),u=Object(i.useCallback)((()=>l((e=>"open"===e?"closed":"open"))),[]),c=Object(i.useCallback)((e=>{a((t=>Object(v.omit)(e,t)))}),[a]);return Object(v.isEmpty)(t)?null:Object(m.jsx)(s.EuiFlexGroup,{"data-test-subj":"selectedPromptContexts",direction:"column",gutterSize:"none"},Object.keys(n).sort().map((i=>{var r;return Object(m.jsx)(s.EuiFlexItem,{"data-test-subj":`selectedPromptContext-${i}`,grow:!1,key:i},e||Object.keys(n).length>1?Object(m.jsx)(s.EuiSpacer,{"data-test-subj":"spacer"}):null,Object(m.jsx)(s.EuiAccordion,{buttonContent:null===(r=t[i])||void 0===r?void 0:r.description,forceState:o,extraAction:Object(m.jsx)(s.EuiToolTip,{content:We},Object(m.jsx)(s.EuiButtonIcon,{"aria-label":We,"data-test-subj":`removePromptContext-${i}`,iconType:"cross",onClick:()=>c(i)})),id:i,onToggle:u,paddingSize:"s"},Object(m.jsx)(Ke,{$accordionState:o},Object(m.jsx)(Qe,{selectedPromptContext:n[i],setSelectedPromptContexts:a}))))})))},Xe=r.a.memo(Ye),Je=c()(s.EuiText)`
  white-space: pre-line;
`,Ze=({conversation:e,editingSystemPromptId:t,isNewConversation:n,isSettingsModalVisible:a,promptContexts:o,promptTextPreview:l,onSystemPromptSelectionChange:u,selectedPromptContexts:c,setIsSettingsModalVisible:d,setSelectedPromptContexts:p})=>{const f=Object(i.useMemo)((()=>Object(m.jsx)(r.a.Fragment,null,n&&Object(m.jsx)(Te,{conversation:e,editingSystemPromptId:t,onSystemPromptSelectionChange:u,isSettingsModalVisible:a,setIsSettingsModalVisible:d}),Object(m.jsx)(Xe,{isNewConversation:n,promptContexts:o,selectedPromptContexts:c,setSelectedPromptContexts:p}),Object(m.jsx)(Je,{color:"subdued","data-test-subj":"previewText"},l))),[e,t,n,a,u,o,l,c,d,p]),b=Object(i.useMemo)((()=>[{children:f,event:Object(m.jsx)(s.EuiText,{"data-test-subj":"eventText",size:"xs"},Object(m.jsx)("i",null,Ie)),timelineAvatar:Object(m.jsx)(s.EuiAvatar,{"data-test-subj":"userAvatar",name:"user",size:"l",color:"subdued",iconType:"userAvatar"}),timelineAvatarAriaLabel:Ae,username:Ae}]),[f]);return Object(m.jsx)(s.EuiCommentList,{"aria-label":Me,comments:b})};Ze.displayName="PromptEditorComponent";const et=r.a.memo(Ze),tt=k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.addQuickPromptTitle",{defaultMessage:"Add quick prompt..."}),nt=k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.overflowAriaTitle",{defaultMessage:"Show overflow Quick Prompts"}),at=(k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"}),c()(s.EuiFlexGroup)`
  margin: 16px;
`),it=r.a.memo((({setInput:e,setIsSettingsModalVisible:t,trackPrompt:n})=>{const{allQuickPrompts:r,knowledgeBase:o,promptContexts:l,setSelectedSettingsTab:u}=Object(a.b)(),c=Object(i.useMemo)((()=>{const e=Object.values(l).map((e=>e.category));return o.assistantLangChain&&e.push("knowledge-base"),r.filter((t=>null==t.categories||0===t.categories.length||t.categories.some((t=>e.includes(t)))))}),[r,o.assistantLangChain,l]),[d,p]=Object(i.useState)(!1),f=Object(i.useCallback)((()=>p(!d)),[d]),b=Object(i.useCallback)((()=>p(!1)),[]),g=Object(i.useCallback)((t=>{e(t.prompt),t.isDefault?n(t.title):n("Custom")}),[e,n]),v=Object(i.useCallback)((e=>{g(e),b()}),[b,g]),y=Object(i.useCallback)((()=>{t(!0),u(fe.c)}),[t,u]);return Object(m.jsx)(at,{gutterSize:"s",alignItems:"center"},c.slice(0,5).map(((e,t)=>Object(m.jsx)(s.EuiFlexItem,{key:t,grow:!1},Object(m.jsx)(s.EuiBadge,{color:e.color,onClick:()=>g(e),onClickAriaLabel:e.title},e.title)))),c.length>5&&Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiPopover,{button:Object(m.jsx)(s.EuiBadge,{color:"hollow",iconType:"boxesHorizontal",onClick:f,onClickAriaLabel:nt}),isOpen:d,closePopover:b,anchorPosition:"rightUp"},Object(m.jsx)(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},c.slice(5).map(((e,t)=>Object(m.jsx)(s.EuiFlexItem,{key:t,grow:!1},Object(m.jsx)(s.EuiBadge,{color:e.color,onClick:()=>v(e),onClickAriaLabel:e.title},e.title))))))),Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiButtonEmpty,{"data-test-subj":"addQuickPrompt",onClick:y,iconType:"plus",size:"xs"},tt)))}));it.displayName="QuickPrompts";var rt=n(548),st=n(549),ot=n(497);const lt=r.a.memo((({text:e,children:t,chunkSize:n=5,delay:a=100,onStreamingComplete:r})=>{const[s,o]=Object(i.useState)(a>0?"":e),[l,u]=Object(i.useState)(null==a||0===a);return Object(i.useEffect)((()=>{0===a&&(null==r||r())}),[]),Object(i.useEffect)((()=>{if(l||0===a)return void o(e);let t=0;u(!1);const i=setInterval((()=>{if(t>=e.length)return null==r||r(),u(!0),void clearInterval(i);const a=e.substring(t,t+n);o((e=>e+a)),t+=n}),a);return()=>{clearInterval(i)}}),[e,n,a,r,l]),t?Object(m.jsx)("div",null,t(s,l)):Object(m.jsx)("div",null,s)}));lt.displayName="StreamingText";var ut=n(73);const ct=r.a.memo((({setIsConnectorModalVisible:e})=>{const{assistantAvailability:t}=Object(a.b)(),n=t.hasConnectorsAllPrivilege?V.d:V.c,r=t.hasConnectorsAllPrivilege?V.a:V.b,o=Object(i.useCallback)((()=>{null==e||e(!0)}),[e]);return Object(m.jsx)(s.EuiFlexGroup,{gutterSize:"l",justifyContent:"spaceAround"},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(s.EuiCard,{"data-test-subj":"connectorButton",layout:"horizontal",icon:Object(m.jsx)(s.EuiIcon,{size:"xl",type:ut.OpenAILogo}),title:n,description:r,onClick:t.hasConnectorsAllPrivilege?o:void 0})))}));ct.displayName="ConnectorButton";const dt=e=>{const{messages:t,...n}=e;return{...n,messages:t.map((e=>{const{presentation:t,...n}=e;return{...n,presentation:void 0}}))}},mt=e=>!e.messages.some((e=>void 0!==e.presentation)),pt=c.a.div`
  margin-bottom: 10px;
`,ft=c()(s.EuiText)`
  margin-top: 20px;
`,bt=r.a.memo((({isConnectorConfigured:e,isSettingsModalVisible:t,setIsSettingsModalVisible:n})=>{const{assistantAvailability:o,setSelectedSettingsTab:l}=Object(a.b)(),u=Object(i.useCallback)((()=>{t||(n(!0),l(fe.b))}),[t,n,l]),c=o.hasConnectorsAllPrivilege||o.hasConnectorsReadPrivilege&&e;return Object(m.jsx)(r.a.Fragment,null,c?Object(m.jsx)(s.EuiCallOut,{"data-test-subj":"connectorMissingCallout",color:"danger",iconType:"controlsVertical",size:"m",title:V.p},Object(m.jsx)("p",null," ",Object(m.jsx)(L.FormattedMessage,{defaultMessage:"Select a connector above or from the {link} to continue",id:"xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.calloutDescription",values:{link:Object(m.jsx)(s.EuiLink,{onClick:u},V.q)}}))):Object(m.jsx)(ct,null))}));bt.displayName="ConnectorMissingCallout";var gt={name:"hbng6e",styles:"align-items:flex-start;flex-direction:column"},vt={name:"hbng6e",styles:"align-items:flex-start;flex-direction:column"},yt={name:"r5hahk",styles:"margin-right:20px"},ht={name:"r5hahk",styles:"margin-right:20px"};const jt=({conversationId:e,embeddedLayout:t=!1,promptContextId:n="",shouldRefocusPrompt:o=!1,showTitle:l=!0,setConversationId:u})=>{var c,v;const{assistantTelemetry:y,augmentMessageCodeBlocks:O,assistantAvailability:{isAssistantEnabled:x},conversations:S,defaultAllow:k,defaultAllowReplacement:w,docLinks:C,getComments:T,http:M,promptContexts:I,setLastConversationId:P,getConversationId:_,title:D,allSystemPrompts:F}=Object(a.b)(),[N,R]=Object(i.useState)({}),L=Object(i.useMemo)((()=>Object.keys(N).length),[N]),{amendMessage:B,createConversation:q}=Object(f.a)(),{data:H,isSuccess:G}=Object($.a)({http:M}),Q=Object(i.useMemo)((()=>{var e;return null===(e=Object(j.b)(H))||void 0===e?void 0:e.id}),[H]),W=Object(i.useMemo)((()=>{var e,t;return null===(e=Object(j.b)(H))||void 0===e||null===(t=e.config)||void 0===t?void 0:t.apiProvider}),[H]),[K,X]=Object(i.useState)(x?_(e):se.d);Object(i.useEffect)((()=>{u&&u(K)}),[K,u]);const J=Object(i.useMemo)((()=>{var e;return null!==(e=S[K])&&void 0!==e?e:q({conversationId:K})}),[S,q,K]),Z=Object(i.useMemo)((()=>{var e;return!Object.keys(S).some((e=>null!=S[e].apiConfig.connectorId))&&0===(null!==(e=null==H?void 0:H.length)&&void 0!==e?e:0)}),[null==H?void 0:H.length,S]),ee=Z||!x,te=Object(i.useMemo)((()=>Object(j.a)(J,x)),[J,x]),[ne,ae]=Object(i.useState)(!1);Object(i.useEffect)((()=>{if(G&&(null==H||!H.length))return P(se.d);J.excludeFromLastConversationStorage||P(J.id)}),[G,null==H?void 0:H.length,J,P]);const{comments:ie,prompt:re}=(({conversation:e=st.a,onSetupComplete:t})=>{var n,r,o,l;const{appendMessage:u,setApiConfig:c,setConversation:d}=Object(f.a)(),p=Object(i.useRef)(null),{actionTypeRegistry:b,conversations:g,http:v}=Object(a.b)(),{data:y,isSuccess:h,refetch:j}=Object($.a)({http:v}),E=h&&!(null==y||!y.length),[O,x]=Object(i.useState)(!1),[S,k]=Object(i.useState)((()=>mt(e))),{data:w}=Object(ot.a)({http:v}),[C,T]=Object(i.useState)(null),M=Object(i.useMemo)((()=>{var t,n,a;return null!==(t=null===(n=e.theme)||void 0===n||null===(a=n.user)||void 0===a?void 0:a.name)&&void 0!==t?t:V.k}),[null===(n=e.theme)||void 0===n||null===(r=n.user)||void 0===r?void 0:r.name]),I=Object(i.useMemo)((()=>{var t,n,a;return null!==(t=null===(n=e.theme)||void 0===n||null===(a=n.assistant)||void 0===a?void 0:a.name)&&void 0!==t?t:V.j}),[null===(o=e.theme)||void 0===o||null===(l=o.assistant)||void 0===l?void 0:l.name]),A=Object(i.useMemo)((()=>e.messages.length-1),[e.messages.length]),[P,_]=Object(i.useState)(E||mt(e)?A:0),D=Object(i.useRef)(void 0),F=Object(i.useCallback)((()=>{var t,n,a;if(P!==A)return D.current=window.setTimeout((()=>{var e;return null===(e=p.current)||void 0===e||e.scrollIntoView({block:"end"}),_(P+1)}),null!==(t=null===(n=e.messages[P])||void 0===n||null===(a=n.presentation)||void 0===a?void 0:a.delay)&&void 0!==t?t:0),()=>clearTimeout(D.current);clearTimeout(D.current)}),[e.messages,P,A]),N=Object(i.useCallback)((()=>{var n;k(!0),null===(n=p.current)||void 0===n||n.scrollIntoView({block:"end"}),null==t||t(),d({conversation:dt(e)})}),[e,t,d]),R=Object(i.useCallback)((()=>{_(A)}),[A]),z=Object(i.useCallback)(((t,n,a)=>{var i,r,o;null!=e.messages[n].timestamp&&0!==e.messages[n].timestamp.length||(e.messages[n].timestamp=(new Date).toLocaleString());const l=n===a-1,u=null!==(i=null==t||null===(r=t.presentation)||void 0===r?void 0:r.stream)&&void 0!==i&&i&&P!==a-1;return Object(m.jsx)(lt,{text:null!==(o=t.content)&&void 0!==o?o:"",delay:u?50:0,onStreamingComplete:l?N:F},((e,t)=>Object(m.jsx)(s.EuiText,null,Object(m.jsx)(s.EuiMarkdownFormat,{className:`message-${n}`},e),Object(m.jsx)("span",{ref:p}))))}),[e.messages,P,N,F]),L=Object(i.useMemo)((()=>e.messages.slice(0,P+1).map(((t,n)=>({username:"user"===t.role?M:I,children:z(t,n,e.messages.length),timelineAvatar:Object(m.jsx)(s.EuiAvatar,{name:V.j,size:"l",color:"subdued",iconType:Y}),timestamp:`${V.i}: ${t.timestamp}`})))),[I,z,e.messages,P,M]),B=Object(i.useCallback)((t=>{const n=Object(U.b)(t),a=Object(U.a)(b.get(t.actionTypeId));Object.values(g).forEach((e=>{c({conversationId:e.id,apiConfig:{...e.apiConfig,connectorId:t.id,connectorTypeTitle:a,provider:null==n?void 0:n.apiProvider,model:null==n?void 0:n.defaultModel}})})),null==j||j(),x(!1),u({conversationId:e.id,message:{role:"assistant",content:V.g,timestamp:(new Date).toLocaleString()}})}),[b,u,e.id,g,j,c]);return{comments:L,prompt:Object(m.jsx)("div",{"data-test-subj":"prompt"},S&&Object(m.jsx)(pt,null,Object(m.jsx)(ct,{setIsConnectorModalVisible:x})),!S&&Object(m.jsx)(ft,{color:"subdued",size:"xs"},Object(m.jsx)(s.EuiTextAlign,{textAlign:"center"},Object(m.jsx)(s.EuiBadge,{color:"hollow","data-test-subj":"skip-setup-button",onClick:R,onClickAriaLabel:V.h},V.h))),O&&Object(m.jsx)(rt.a,{actionTypeRegistry:b,actionTypes:w,onClose:()=>x(!1),onSaveConnector:B,onSelectActionType:e=>T(e),selectedActionType:C}))}})({conversation:te}),oe=Z&&null!==(c=te.theme)&&void 0!==c&&c.title?null===(v=te.theme)||void 0===v?void 0:v.title:D,[le,ue]=Object(i.useState)(""),[ce,de]=Object(i.useState)(!1),[me,pe]=Object(i.useState)(null),[fe,be]=Object(i.useState)(!1),[ge,ve]=Object(i.useState)(!1),[ye,Ee]=Object(i.useState)(),[Oe,Se]=Object(i.useState)(!1);Object(i.useLayoutEffect)((()=>{setTimeout((()=>{Ee(O(J))}),0)}),[O,J]);const ke=Object(i.useMemo)((()=>ee||fe),[fe,ee]);Object(i.useEffect)((()=>{const e=()=>{const e=document.querySelectorAll(".euiCodeBlock__controls");Se(e.length>0)};e();const t=new MutationObserver(e);return t.observe(document.body,{subtree:!0,childList:!0}),()=>{t.disconnect()}}),[]);const we=Object(i.useRef)(null);Object(i.useEffect)((()=>{var e;const t=null===(e=we.current)||void 0===e?void 0:e.parentElement;t&&(t.scrollTop=t.scrollHeight)}));const Ce=(e,t)=>t?Object(m.jsx)("span",{ref:we},e):Object(m.jsx)(r.a.Fragment,null,e),Te=Object(i.useMemo)((()=>Object(E.b)({allSystemPrompts:F,conversation:J})),[F,J]),[Me,Ie]=Object(i.useState)(null==Te?void 0:Te.id),Ae=Object(i.useCallback)((e=>{var t;X(e),Ie(null===(t=Object(E.b)({allSystemPrompts:F,conversation:S[e]}))||void 0===t?void 0:t.id)}),[F,S]),Pe=Object(i.useCallback)((e=>{Ie(e)}),[]);[...document.getElementsByClassName("euiCodeBlock")].forEach((e=>e.style.minHeight="75px"));const _e=Object(i.useCallback)((e=>{null!=ve&&ve(e.target.checked)}),[ve]);Object(i.useEffect)((()=>{if(J.messages.length||e!==K)return;if(ce)return;const t=I[n];null!=t&&(de(!0),Object.keys(N).includes(t.id)||(async()=>{const e=await je({defaultAllow:k,defaultAllowReplacement:w,promptContext:t});R((n=>({...n,[t.id]:e})))})(),null!=t.suggestedUserPrompt&&pe(t.suggestedUserPrompt))}),[J.messages,I,n,e,K,N,ce,k,w]),Object(i.useEffect)((()=>{var e;const t=null!==(e=null==H?void 0:H.some((e=>{var t;return e.id===(null===(t=J.apiConfig)||void 0===t?void 0:t.connectorId)})))&&void 0!==e&&e;be(!t)}),[H,J]);const De=Object(i.useCallback)((()=>null==ye?void 0:ye.map(((e,t)=>Object(m.jsx)("span",{key:`${t}`},e.map(((e,n)=>{const a=e.getControlContainer,i=null==a?void 0:a();return Object(m.jsx)("span",{key:`${t}+${n}`},i?Object(d.createPortal)(e.button,i):Object(m.jsx)(r.a.Fragment,null))})))))),[ye]),{handleButtonSendMessage:Fe,handleOnChatCleared:Ne,handlePromptChange:Re,handleSendMessage:ze,handleRegenerateResponse:Le,isLoading:Be}=(({allSystemPrompts:e,currentConversation:t,editingSystemPromptId:n,http:r,selectedPromptContexts:s,setEditingSystemPromptId:o,setPromptTextPreview:l,setSelectedPromptContexts:u,setUserPrompt:c})=>{const{isLoading:d,sendMessages:m}=(()=>{const{alertsIndexPattern:e,assistantStreamingEnabled:t,defaultAllow:n,defaultAllowReplacement:r,knowledgeBase:s}=Object(a.b)(),[o,l]=Object(i.useState)(!1);return{isLoading:o,sendMessages:Object(i.useCallback)((async({apiConfig:a,http:i,messages:o,onNewReplacements:u,replacements:c})=>{l(!0);try{return await Object(p.b)({alerts:s.alerts,alertsIndexPattern:e,allow:n,allowReplacement:r,apiConfig:a,assistantLangChain:s.assistantLangChain,assistantStreamingEnabled:t,http:i,replacements:c,messages:o,size:s.latestAlerts,onNewReplacements:u})}finally{l(!1)}}),[e,t,n,r,s.alerts,s.assistantLangChain,s.latestAlerts])}})(),{appendMessage:v,appendReplacements:y,clearConversation:O,removeLastMessage:x}=Object(f.a)(),S=Object(i.useCallback)((async a=>{var i;const o=e=>y({conversationId:t.id,replacements:e}),c=e.find((e=>e.id===n)),d=await async function({currentReplacements:e,getAnonymizedValue:t=h,isNewChat:n,onNewReplacements:a,promptText:i,selectedPromptContexts:r,selectedSystemPrompt:s}){var o;const l=Object.keys(r).sort().map((n=>{const i=Object(b.d)({allow:r[n].allow,allowReplacement:r[n].allowReplacement,currentReplacements:e,getAnonymizedValue:t,onNewReplacements:a,rawData:r[n].rawData});return`${Object(g.e)(i)}`}));return{content:`${n?`${null!==(o=null==s?void 0:s.content)&&void 0!==o?o:""}\n\n`:""}${l}\n\n${i}`,role:"user",timestamp:(new Date).toLocaleString()}}({isNewChat:0===t.messages.length,currentReplacements:t.replacements,onNewReplacements:o,promptText:a,selectedPromptContexts:s,selectedSystemPrompt:c}),p=v({conversationId:t.id,message:d});u({}),l("");const f=await m({apiConfig:t.apiConfig,http:r,messages:p,onNewReplacements:o,replacements:null!==(i=t.replacements)&&void 0!==i?i:{}}),E=Object(j.d)(f);v({conversationId:t.id,message:E})}),[e,v,y,t.apiConfig,t.id,t.messages.length,t.replacements,n,r,s,m,l,u]),k=Object(i.useCallback)((async()=>{var e;const n=x(t.id),a=await m({apiConfig:t.apiConfig,http:r,messages:n,onNewReplacements:e=>y({conversationId:t.id,replacements:e}),replacements:null!==(e=t.replacements)&&void 0!==e?e:{}}),i=Object(j.d)(a);v({conversationId:t.id,message:i})}),[v,y,t.apiConfig,t.id,t.replacements,r,x,m]);return{handleButtonSendMessage:Object(i.useCallback)((e=>{S(e),c("")}),[S,c]),handleOnChatCleared:Object(i.useCallback)((()=>{var n;const a=null===(n=Object(E.b)({allSystemPrompts:e,conversation:t}))||void 0===n?void 0:n.id;l(""),c(""),u({}),O(t.id),o(a)}),[e,O,t,o,l,u,c]),handlePromptChange:e=>{l(e),c(e)},handleSendMessage:S,handleRegenerateResponse:k,isLoading:d}})({allSystemPrompts:F,currentConversation:J,setPromptTextPreview:ue,setUserPrompt:pe,editingSystemPromptId:Me,http:M,setEditingSystemPromptId:Ie,selectedPromptContexts:N,setSelectedPromptContexts:R}),qe=Object(i.useMemo)((()=>Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(s.EuiCommentList,{comments:T({currentConversation:J,showAnonymizedValues:ge,amendMessage:B,regenerateMessage:Le,isFetchingResponse:Be}),css:ht}),0!==J.messages.length&&L>0&&Object(m.jsx)(s.EuiSpacer,{size:"m"}),(0===J.messages.length||L>0)&&Object(m.jsx)(et,{conversation:J,editingSystemPromptId:Me,isNewConversation:0===J.messages.length,isSettingsModalVisible:ne,promptContexts:I,promptTextPreview:le,onSystemPromptSelectionChange:Pe,selectedPromptContexts:N,setIsSettingsModalVisible:ae,setSelectedPromptContexts:R}))),[B,J,Me,T,Pe,Le,Be,ne,I,le,N,L,ge]),$e=Object(i.useMemo)((()=>ee?Object(m.jsx)(s.EuiCommentList,{comments:ie,css:yt}):qe),[ie,ee,qe]),Ve=Object(i.useCallback)((e=>{null==y||y.reportAssistantQuickPrompt({conversationId:K,promptTitle:e})}),[y,K]);return Ce(Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(s.EuiModalHeader,{css:vt},l&&Object(m.jsx)(he,{currentConversation:J,defaultConnectorId:Q,defaultProvider:W,docLinks:C,isDisabled:ee,isSettingsModalVisible:ne,onConversationSelected:Ae,onToggleShowAnonymizedValues:_e,selectedConversationId:K,setIsSettingsModalVisible:ae,setSelectedConversationId:X,showAnonymizedValues:ge,title:oe}),De(),!ee&&Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(xe,{defaultAllow:k,defaultAllowReplacement:w,promptContexts:I,selectedPromptContexts:N,setSelectedPromptContexts:R}),Object.keys(I).length>0&&Object(m.jsx)(s.EuiSpacer,{size:"s"}))),Object(m.jsx)(s.EuiModalBody,null,Ce(Object(m.jsx)(r.a.Fragment,null,$e,!ee&&fe&&G&&Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(s.EuiSpacer,null),Object(m.jsx)(s.EuiFlexGroup,{justifyContent:"spaceAround"},Object(m.jsx)(s.EuiFlexItem,{grow:!1},Object(m.jsx)(bt,{isConnectorConfigured:(null==H?void 0:H.length)>0,isSettingsModalVisible:ne,setIsSettingsModalVisible:ae}))))),!t)),Object(m.jsx)(s.EuiModalFooter,{css:gt},Object(m.jsx)(z,{connectorPrompt:re,http:M,isAssistantEnabled:x,isWelcomeSetup:Z}),Object(m.jsx)(A,{isDisabled:ke,shouldRefocusPrompt:o,userPrompt:me,handleButtonSendMessage:Fe,handleOnChatCleared:Ne,handlePromptChange:Re,handleSendMessage:ze,handleRegenerateResponse:Le,isLoading:Be}),!ee&&Object(m.jsx)(it,{setInput:pe,setIsSettingsModalVisible:ae,trackPrompt:Ve}))),t)};jt.displayName="AssistantComponent";const Et=r.a.memo(jt),Ot=navigator.platform.toLowerCase().indexOf("mac")>=0,xt=c()(s.EuiModal)`
  ${({theme:e})=>`margin-top: ${e.eui.euiSizeXXL};`}
  min-width: 95vw;
  min-height: 25vh;
`,St=r.a.memo((()=>{const[e,t]=Object(i.useState)(!1),[n,s]=Object(i.useState)(se.d),[o,u]=Object(i.useState)(),{assistantTelemetry:c,setShowAssistantOverlay:d,getConversationId:p}=Object(a.b)(),f=Object(i.useCallback)((()=>({showOverlay:e,promptContextId:n,conversationId:a})=>{const i=p(a);e&&(null==c||c.reportAssistantInvoked({conversationId:i,invokedBy:"click"})),t(e),u(n),s(i)}),[c,p]);Object(i.useEffect)((()=>{d(f)}),[d,f]);const b=Object(i.useCallback)((()=>{e||(s(p()),null==c||c.reportAssistantInvoked({invokedBy:"shortcut",conversationId:p()})),t(!e)}),[c,e,p]),g=Object(i.useCallback)((e=>{";"===e.key&&(Ot?e.metaKey:e.ctrlKey)&&(e.preventDefault(),b())}),[b]);l()("keydown",g);const v=Object(i.useCallback)((()=>{t(!1),u(void 0),s(n)}),[n]),y=Object(i.useCallback)((()=>{v()}),[v]);return Object(m.jsx)(r.a.Fragment,null,e&&Object(m.jsx)(xt,{onClose:y,"data-test-subj":"ai-assistant-modal"},Object(m.jsx)(Et,{conversationId:n,promptContextId:o})))}));St.displayName="AssistantOverlay";var kt=n(492);const wt=(e,t,n,r,s,o,l)=>{const u=Object(i.useMemo)((()=>e),[e]),c=Object(i.useMemo)((()=>n),[n]),d=Object(i.useMemo)((()=>r),[r]),m=Object(i.useMemo)((()=>null!=s?s:Object(kt.a)()),[s]),p=Object(i.useMemo)((()=>null!=o?o:void 0),[o]),f=Object(i.useMemo)((()=>l),[l]),{registerPromptContext:b,showAssistantOverlay:g,unRegisterPromptContext:v}=Object(a.b)(),y=Object(i.useCallback)((e=>{null!=m&&g({showOverlay:e,promptContextId:m,conversationId:null!=t?t:void 0})}),[g,t,m]);return Object(i.useEffect)((()=>(v(m),b({category:u,description:c,getPromptContext:d,id:m,suggestedUserPrompt:p,tooltip:f}),()=>v(m))),[u,c,d,p,f,m,b,v]),{promptContextId:m,showAssistantOverlay:y}},Ct=k.i18n.translate("xpack.elasticAssistant.assistant.newChat.newChatButton",{defaultMessage:"Chat"}),Tt=({category:e,color:t="primary",children:n=Ct,conversationId:a,description:r,getPromptContext:o,iconType:l,promptContextId:u,suggestedUserPrompt:c,tooltip:d})=>{const{showAssistantOverlay:p}=wt(e,null!=a?a:null,r,o,null!=u?u:null,c,d),f=Object(i.useCallback)((()=>{p(!0)}),[p]),b=Object(i.useMemo)((()=>{if(null!==l)return null!=l?l:"discuss"}),[l]);return Object(i.useMemo)((()=>Object(m.jsx)(s.EuiButtonEmpty,{color:t,"data-test-subj":"newChat",onClick:f,iconType:b},n)),[n,b,f,t])};Tt.displayName="NewChatComponent";const Mt=r.a.memo(Tt),It=k.i18n.translate("xpack.elasticAssistant.assistant.newChatById.newChatByIdButton",{defaultMessage:"Chat"}),At=({children:e=It,conversationId:t,iconType:n,promptContextId:r,iconOnly:o=!1})=>{const{showAssistantOverlay:l}=Object(a.b)(),u=Object(i.useCallback)((()=>l({conversationId:t,promptContextId:r,showOverlay:!0})),[t,r,l]),c=Object(i.useMemo)((()=>{if(null!==n)return null!=n?n:"discuss"}),[n]);return Object(i.useMemo)((()=>o?Object(m.jsx)(s.EuiToolTip,{content:It},Object(m.jsx)(s.EuiButtonIcon,{"data-test-subj":"newChatById",iconType:null!=c?c:"discuss",onClick:u,color:"text","aria-label":It})):Object(m.jsx)(s.EuiButtonEmpty,{"data-test-subj":"newChatById",iconType:c,onClick:u,"aria-label":It},e)),[e,c,u,o])};At.displayName="NewChatByIdComponent";const Pt=r.a.memo(At);k.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.user.thenSummarizeSuggestedKqlAndEqlQueries",{defaultMessage:"Evaluate the event from the context above and format your output neatly in markdown syntax for my Elastic Security case."}),k.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.user.finallySuggestInvestigationGuideAndFormatAsMarkdown",{defaultMessage:"Add your description, recommended actions and bulleted triage steps. Use the MITRE ATT&CK data provided to add more context and recommendations from MITRE, and hyperlink to the relevant pages on MITRE's website. Be sure to include the user and host risk score data from the context. Your response should include steps that point to Elastic Security specific features, including endpoint response actions, the Elastic Agent OSQuery manager integration (with example osquery queries), timelines and entity analytics and link to all the relevant Elastic Security documentation."})},,,,function(e,t,n){"use strict";n.d(t,"l",(function(){return i})),n.d(t,"k",(function(){return r})),n.d(t,"m",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"n",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"o",(function(){return m})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"q",(function(){return g})),n.d(t,"p",(function(){return v})),n.d(t,"g",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"a",(function(){return j}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.visualizationActions.moreActions",{defaultMessage:"More actions"}),r=a.i18n.translate("xpack.securitySolution.visualizationActions.inspect",{defaultMessage:"Inspect"}),s=a.i18n.translate("xpack.securitySolution.visualizationActions.openInLens",{defaultMessage:"Open in Lens"}),o=a.i18n.translate("xpack.securitySolution.visualizationActions.addToNewCase",{defaultMessage:"Add to new case"}),l=a.i18n.translate("xpack.securitySolution.visualizationActions.addToExistingCase",{defaultMessage:"Add to existing case"}),u=a.i18n.translate("xpack.securitySolution.visualizationActions.addToCaseSuccessContent",{defaultMessage:"Successfully added visualization to the case"}),c=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),d=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),m=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),p=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.successChartLabel",{defaultMessage:"Success"}),f=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),b=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.failureChartLabel",{defaultMessage:"Failure"}),g=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueCountLabel",{values:{field:e},defaultMessage:"Unique count of {field}"}),v=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.topValueLabel",{values:{field:e},defaultMessage:"Top values of {field}"}),y=a.i18n.translate("xpack.securitySolution.visualizationActions.countLabel",{defaultMessage:"Count of records"}),h=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.countOfFieldLabel",{values:{field:e},defaultMessage:"Count of {field}"}),j=a.i18n.translate("xpack.securitySolution.visualizationActions.addedToLibrary",{defaultMessage:"Added to library"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(17),s=n(44);const o=n.n(s)()(r.EuiText).withConfig({displayName:"CodeBlock",componentId:"sc-s548fn-0"})(["font-family:",";"],(e=>e.theme.eui.euiCodeFontFamily)),l=Object(a.memo)((({children:e,inline:t=!1,textColor:n="default",bold:a=!1})=>i.a.createElement(o,{size:"relative",color:n,className:t?"eui-displayInline":""},a?i.a.createElement("strong",null,e):e)));l.displayName="ConsoleCodeBlock"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(698);const r=()=>Object(a.useContext)(i.a)},function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"a",(function(){return b}));var a=n(60),i=n(310),r=n(15),s=n(49),o=n(2),l=n(129);const u=e=>e===l.a.alerts||e===l.a.rules||e===l.a.rulesAdd||e===l.a.rulesCreate||e===l.a.exceptions,c=e=>e.substring(1),d=(e,t)=>{const n=Object(i.parse)(e,{sort:!1})[t];return Array.isArray(n)?n[0]:n},m=e=>Object(o.useCallback)((()=>{const t=d(c(window.location.search),e);return Object(a.safeDecode)(null!=t?t:"")}),[e]),p=e=>Object(i.stringify)(r.url.encodeQuery(e),{sort:!1,encode:!1}),f=()=>{const e=Object(s.useHistory)();return Object(o.useCallback)((t=>{const n=window.location.search,r=Object(i.parse)(n,{sort:!1});Object.keys(t).forEach((e=>{const n=t[e];if(null!=n&&""!==n)try{r[e]=Object(a.encode)(n)}catch{console.error("Unable to encode url param value")}else delete r[e]}));const s=p(r);c(n)!==s&&e.replace({search:s})}),[e])},b=()=>{window.history.pushState({},"",window.location.href)}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(45);const i=e=>Object(a.isString)(e)?e:JSON.stringify(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(749);const r=()=>Object(a.useContext)(i.a)},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return p}));var a=n(45),i=n(2),r=n.n(i),s=n(262),o=n(322);const l={canUserCRUD:null,canUserREAD:null,hasIndexManage:null,hasIndexMaintenance:null,hasIndexWrite:null,hasIndexRead:null,hasIndexUpdateDelete:null,isSignalIndexExists:null,isAuthenticated:null,hasEncryptionKey:null,loading:!0,signalIndexName:null,signalIndexMappingOutdated:null},u=(e,t)=>{switch(t.type){case"updateLoading":return{...e,loading:t.loading};case"updateHasIndexManage":return{...e,hasIndexManage:t.hasIndexManage};case"updateHasIndexMaintenance":return{...e,hasIndexMaintenance:t.hasIndexMaintenance};case"updateHasIndexWrite":return{...e,hasIndexWrite:t.hasIndexWrite};case"updateHasIndexRead":return{...e,hasIndexRead:t.hasIndexRead};case"updateHasIndexUpdateDelete":return{...e,hasIndexUpdateDelete:t.hasIndexUpdateDelete};case"updateIsSignalIndexExists":return{...e,isSignalIndexExists:t.isSignalIndexExists};case"updateIsAuthenticated":return{...e,isAuthenticated:t.isAuthenticated};case"updateHasEncryptionKey":return{...e,hasEncryptionKey:t.hasEncryptionKey};case"updateSignalIndexName":return{...e,signalIndexName:t.signalIndexName};case"updateSignalIndexMappingOutdated":return{...e,signalIndexMappingOutdated:t.signalIndexMappingOutdated};case"updateCanUserCRUD":return{...e,canUserCRUD:t.canUserCRUD};case"updateCanUserREAD":return{...e,canUserREAD:t.canUserREAD};default:return e}},c=Object(i.createContext)([l,()=>a.noop]),d=()=>Object(i.useContext)(c),m=({children:e})=>r.a.createElement(c.Provider,{value:Object(i.useReducer)(u,l)},e),p=()=>{const[{canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:a,hasIndexWrite:r,hasIndexRead:l,hasIndexUpdateDelete:u,isSignalIndexExists:c,isAuthenticated:m,hasEncryptionKey:p,loading:f,signalIndexName:b,signalIndexMappingOutdated:g},v]=d(),{loading:y,isAuthenticated:h,hasEncryptionKey:j,hasIndexManage:E,hasIndexMaintenance:O,hasIndexUpdateDelete:x,hasIndexWrite:S,hasIndexRead:k,hasKibanaCRUD:w,hasKibanaREAD:C}=Object(s.a)(),{loading:T,signalIndexExists:M,signalIndexName:I,signalIndexMappingOutdated:A,createDeSignalIndex:P}=Object(o.a)();return Object(i.useEffect)((()=>{f||e===w||v({type:"updateCanUserCRUD",canUserCRUD:w})}),[v,f,e,w]),Object(i.useEffect)((()=>{f||t===C||v({type:"updateCanUserREAD",canUserREAD:C})}),[v,f,t,C]),Object(i.useEffect)((()=>{f!==(y||T)&&v({type:"updateLoading",loading:y||T})}),[v,f,y,T]),Object(i.useEffect)((()=>{f||n===E||null==E||v({type:"updateHasIndexManage",hasIndexManage:E})}),[v,f,n,E]),Object(i.useEffect)((()=>{f||r===S||null==S||v({type:"updateHasIndexWrite",hasIndexWrite:S})}),[v,f,r,S]),Object(i.useEffect)((()=>{f||l===k||null==k||v({type:"updateHasIndexRead",hasIndexRead:k})}),[v,f,l,k]),Object(i.useEffect)((()=>{f||u===x||null==x||v({type:"updateHasIndexUpdateDelete",hasIndexUpdateDelete:x})}),[v,f,u,x]),Object(i.useEffect)((()=>{f||a===O||null==O||v({type:"updateHasIndexMaintenance",hasIndexMaintenance:O})}),[v,f,a,O]),Object(i.useEffect)((()=>{f||c===M||null==M||v({type:"updateIsSignalIndexExists",isSignalIndexExists:M})}),[v,f,c,M]),Object(i.useEffect)((()=>{f||m===h||null==h||v({type:"updateIsAuthenticated",isAuthenticated:h})}),[v,f,m,h]),Object(i.useEffect)((()=>{f||p===j||null==j||v({type:"updateHasEncryptionKey",hasEncryptionKey:j})}),[v,f,p,j]),Object(i.useEffect)((()=>{f||b===I||null==I||v({type:"updateSignalIndexName",signalIndexName:I})}),[v,f,b,I]),Object(i.useEffect)((()=>{f||g===A||null==A||v({type:"updateSignalIndexMappingOutdated",signalIndexMappingOutdated:A})}),[v,f,g,A]),Object(i.useEffect)((()=>{m&&p&&n&&(null!=c&&!c||null!=g&&g)&&null!=P&&P()}),[P,m,p,c,n,g]),{loading:f,isSignalIndexExists:c,isAuthenticated:m,hasEncryptionKey:p,canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:a,hasIndexWrite:r,hasIndexRead:l,hasIndexUpdateDelete:u,signalIndexName:b,signalIndexMappingOutdated:g}}},,function(e,t,n){"use strict";n.d(t,"C",(function(){return i})),n.d(t,"q",(function(){return r})),n.d(t,"v",(function(){return s})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return l})),n.d(t,"p",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"n",(function(){return d})),n.d(t,"B",(function(){return m})),n.d(t,"r",(function(){return p})),n.d(t,"u",(function(){return f})),n.d(t,"y",(function(){return b})),n.d(t,"k",(function(){return g})),n.d(t,"E",(function(){return v})),n.d(t,"w",(function(){return y})),n.d(t,"b",(function(){return h})),n.d(t,"x",(function(){return j})),n.d(t,"z",(function(){return E})),n.d(t,"t",(function(){return O})),n.d(t,"s",(function(){return x})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return k})),n.d(t,"F",(function(){return w})),n.d(t,"g",(function(){return C})),n.d(t,"A",(function(){return T})),n.d(t,"D",(function(){return M})),n.d(t,"e",(function(){return I})),n.d(t,"d",(function(){return A})),n.d(t,"f",(function(){return P})),n.d(t,"i",(function(){return _})),n.d(t,"h",(function(){return D})),n.d(t,"j",(function(){return F}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.alertDetails.threatIntel",{defaultMessage:"Threat Intel"}),r=a.i18n.translate("xpack.securitySolution.alertDetails.overview.investigationGuide",{defaultMessage:"Investigation guide"}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview",{defaultMessage:"Overview"}),o=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields",{defaultMessage:"Highlighted fields"}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.field",{defaultMessage:"Field"}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.value",{defaultMessage:"Value"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalence",{defaultMessage:"Alert prevalence"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalenceTooltip",{defaultMessage:"The total count of alerts with the same value within the currently selected timerange. This value is not affected by additional filters."}),m=a.i18n.translate("xpack.securitySolution.eventDetails.table",{defaultMessage:"Table"}),p=a.i18n.translate("xpack.securitySolution.eventDetails.jsonView",{defaultMessage:"JSON"}),f=a.i18n.translate("xpack.securitySolution.eventDetails.osqueryView",{defaultMessage:"Osquery Results"}),b=a.i18n.translate("xpack.securitySolution.eventDetails.responseActionsView",{defaultMessage:"Response Results"}),g=a.i18n.translate("xpack.securitySolution.eventDetails.field",{defaultMessage:"Field"}),v=a.i18n.translate("xpack.securitySolution.eventDetails.value",{defaultMessage:"Value"}),y=(a.i18n.translate("xpack.securitySolution.eventDetails.description",{defaultMessage:"Description"}),a.i18n.translate("xpack.securitySolution.eventDetails.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."})),h=a.i18n.translate("xpack.securitySolution.detections.alerts.agentStatus",{defaultMessage:"Agent status"}),j=a.i18n.translate("xpack.securitySolution.detections.alerts.quarantinedFilePath",{defaultMessage:"Quarantined file path"}),E=a.i18n.translate("xpack.securitySolution.detections.alerts.ruleType",{defaultMessage:"Rule type"}),O=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldTooltipContent",{defaultMessage:"Multi-fields can have multiple values per field"}),x=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldBadge",{defaultMessage:"multi-field"}),S=a.i18n.translate("xpack.securitySolution.eventDetails.table.actions",{defaultMessage:"Actions"}),k=a.i18n.translate("xpack.securitySolution.eventDetails.alertReason",{defaultMessage:"Alert reason"}),w=a.i18n.translate("xpack.securitySolution.eventDetails.viewAllFields",{defaultMessage:"View all fields in table"}),C=Object.freeze({tried:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.tried",{values:{command:e},defaultMessage:"tried to execute {command} command"}),executed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.executed",{values:{command:e},defaultMessage:"executed {command} command"}),pending:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.pending",{values:{command:e},defaultMessage:"is executing {command} command"}),failed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.failed",{values:{command:e},defaultMessage:"failed to execute {command} command"})}),T=a.i18n.translate("xpack.securitySolution.eventDetails.summaryView",{defaultMessage:"summary"}),M=a.i18n.translate("xpack.securitySolution.eventDetails.timelineView",{defaultMessage:"Timeline"}),I=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewConversationId",{defaultMessage:"Alert summary"}),A=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextDescription",{defaultMessage:"Alert (from {view})",values:{view:e}}),P=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextTooltip",{defaultMessage:"Add this alert as context"}),_=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewConversationId",{defaultMessage:"Event summary"}),D=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextDescription",{defaultMessage:"Event (from {view})",values:{view:e}}),F=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextTooltip",{defaultMessage:"Add this event as context"})},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return M}));var a=n(144),i=n(157),r=n(48),s=n(2),o=n(119),l=n(110),u=n(128),c=n(138),d=n(45),m=n(130),p=n(335),f=n(360);var b=n(235),g=n.n(b),v=n(203),y=n(202);var h=n(60),j=n(151),E=n(162),O=n(118),x=n(112),S=n(49);const k=({search:e,urlKey:t})=>Object(v.c)(Object(v.d)(e),t);var w=n(124),C=n(4);const T=()=>{Object(i.c)(),(()=>{const e=Object(r.useDispatch)(),{filterManager:t,savedQueries:n}=Object(l.i)().services.data.query,a=Object(s.useMemo)((()=>u.d.globalFiltersQuerySelector()),[]),d=Object(r.useSelector)(a),m=Object(s.useCallback)((t=>{null!=t&&e(c.b.setFilterQuery({id:o.a.global,query:t.query,language:t.language}))}),[e]),p=Object(s.useCallback)((n=>{null!=n?(t.setFilters(n),e(c.b.setSearchBarFilter({id:o.a.global,filters:n}))):(t.setAppFilters(d),e(c.b.setSearchBarFilter({id:o.a.global,filters:t.getFilters()})))}),[t,e,d]),f=Object(s.useCallback)((a=>{null!=a&&""!==a&&n.getSavedQuery(a).then((n=>{const a=n.attributes.filters||[],i=n.attributes.query;t.setFilters(a),e(c.b.setSearchBarFilter({id:o.a.global,filters:a})),e(c.b.setFilterQuery({id:o.a.global,...i})),e(c.b.setSavedQuery({id:o.a.global,savedQuery:n}))}))}),[e,t,n]);Object(i.b)(M.appQuery,m),Object(i.b)(M.filters,p),Object(i.b)(M.savedQuery,f)})(),(()=>{const e=Object(r.useDispatch)(),t=Object(m.a)("socTrendsEnabled"),n=Object(s.useCallback)((n=>((e,t,n)=>{if(null!=e){const a={linkTo:Object(d.get)("global.linkTo",e)},i=Object(d.get)("global.timerange.kind",e),r={linkTo:Object(d.get)("timeline.linkTo",e)},s=Object(d.get)("timeline.timerange.kind",e),l={linkTo:Object(d.get)("socTrends.linkTo",e)},u=Object(d.get)("socTrends.timerange.kind",e);if(n&&(Object(d.isEmpty)(l.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.socTrends])):t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(d.isEmpty)(a.linkTo)?(t(c.b.removeLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.removeLinkTo([o.a.global,o.a.socTrends]))):(t(c.b.addLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(d.isEmpty)(r.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.timeline])):t(c.b.addLinkTo([o.a.global,o.a.timeline])),s){if("absolute"===s){const n=Object(p.a)(Object(d.get)("timeline.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.timeline}))}if("relative"===s){const n=Object(p.a)(Object(d.get)("timeline.timerange",e));n.from=Object(f.c)(n.fromStr),n.to=Object(f.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.timeline}))}}if(i){if("absolute"===i){const n=Object(p.a)(Object(d.get)("global.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.global}))}if("relative"===i){const n=Object(p.a)(Object(d.get)("global.timerange",e));n.from=Object(f.c)(n.fromStr),n.to=Object(f.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.global}))}}if(n&&u){if("absolute"===u){const n=Object(p.a)(Object(d.get)("socTrends.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.socTrends}))}if("relative"===u){const n=Object(p.a)(Object(d.get)("socTrends.timerange",e));n.from=Object(f.c)(n.fromStr),n.to=Object(f.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.socTrends}))}}}})(n,e,t)),[e,t]);Object(i.b)(M.timerange,n)})(),(()=>{const[{pageName:e}]=Object(y.a)(),t=Object(r.useDispatch)(),n=g()(e),a=Object(s.useMemo)((()=>u.d.inputsSelector()),[]),i=Object(r.useSelector)(a),{timerange:l}=i.global,{timerange:d}=i.timeline;Object(s.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(v.e)(e))(e,n)&&("relative"===d.kind&&t(c.b.setRelativeRangeDatePicker({...d,from:Object(f.c)(d.fromStr),to:Object(f.c)(d.toStr,{roundUp:!0}),id:o.a.timeline})),"relative"===l.kind&&t(c.b.setRelativeRangeDatePicker({...l,from:Object(f.c)(l.fromStr),to:Object(f.c)(l.toStr,{roundUp:!0}),id:o.a.global})))}),[e,n,t,d,l])})(),(()=>{const e=Object(r.useDispatch)(),t=Object(m.a)("timelineEsqlTabDisabled"),n=Object(s.useCallback)((n=>{null!=n&&Object(E.h)({activeTimelineTab:n.activeTab===j.g.esql&&t?j.g.query:n.activeTab,duplicate:!1,graphEventId:n.graphEventId,timelineId:n.id,openTimeline:n.isOpen,updateIsLoading:t=>e(O.a.updateIsLoading(t)),updateTimeline:Object(E.b)(e),savedSearchId:n.savedSearchId})}),[e,t]);Object(s.useEffect)((()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get(M.timeline);if(!e)return;const t=Object(h.safeDecode)(e);n(t)};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[n]),Object(i.b)(M.timeline,n)})(),(()=>{const e=Object(i.d)(M.timeline),t=Object(s.useMemo)((()=>O.b.getTimelineByIdSelector()),[]),{activeTab:n,graphEventId:a,show:r,savedObjectId:o,savedSearchId:l}=Object(x.b)((e=>{var n;return null!==(n=t(e,j.f.active))&&void 0!==n?n:{}}));Object(s.useEffect)((()=>{const t={...o?{id:o}:{},isOpen:r,activeTab:n,graphEventId:null!=a?a:"",savedSearchId:l||void 0};e(t)}),[n,a,o,r,e,l])})(),(()=>{var e;const t=Object(s.useMemo)((()=>O.b.getTimelineByIdSelector()),[]),n=Object(x.b)((e=>t(e,j.f.active))),{search:a}=Object(S.useLocation)(),i=g()(a),o=null!==(e=null==n?void 0:n.savedObjectId)&&void 0!==e?e:"",l=Object(r.useDispatch)(),[u,c]=Object(s.useMemo)((()=>{const e=k({urlKey:M.timeline,search:null!=i?i:""}),t=k({urlKey:M.timeline,search:a});return null!=e&&null!=t?[Object(h.safeDecode)(e),Object(h.safeDecode)(t)]:[null,null]}),[i,a]),d=null==u?void 0:u.id,{id:m,activeTab:p,graphEventId:f}=c||{};Object(s.useEffect)((()=>{m&&m!==d&&m!==o&&Object(E.h)({activeTimelineTab:null!=p?p:j.g.query,duplicate:!1,graphEventId:f,timelineId:m,openTimeline:!0,updateIsLoading:e=>l(O.a.updateIsLoading(e)),updateTimeline:Object(E.b)(l)})}),[o,l,d,m,p,f])})(),(()=>{const[e]=Object(l.o)(C.nb),[t,n]=Object(s.useState)(null),[a,o]=Object(s.useState)(!1),u=Object(r.useDispatch)(),c=w.j.getTableByIdSelector(),d=Object(x.b)((e=>{var t;return null!==(t=c(e,w.e.alertsOnAlertsPage))&&void 0!==t?t:w.q})),m=Object(s.useCallback)((t=>{!e&&null!=t&&t.panelView&&n(t)}),[e]),p=Object(s.useCallback)((()=>{const{initialized:n,isLoading:a,totalCount:i,additionalFilters:r}=d,s=n&&!a&&i>0;!e&&t&&(r&&r.showBuildingBlockAlerts||u(w.h.updateShowBuildingBlockAlertsFilter({id:w.e.alertsOnAlertsPage,showBuildingBlockAlerts:!0})),s&&(o(!0),u(w.h.toggleDetailPanel({id:w.e.alertsOnAlertsPage,...t}))))}),[d,u,e,t]);Object(s.useEffect)((()=>{a||p()}),[a,p]);const f=e?"":M.eventFlyout;Object(i.b)(f,m)})(),(()=>{const e=Object(i.d)(M.eventFlyout),{pathname:t}=Object(S.useLocation)(),n=Object(r.useDispatch)(),a=w.j.getTableByIdSelector(),{expandedDetail:o}=Object(x.b)((e=>{var t;return null!==(t=a(e,w.e.alertsOnAlertsPage))&&void 0!==t?t:w.q}));Object(s.useEffect)((()=>{var a;const i=t===C.d;i&&null!=o&&null!=o&&o.query?e(o.query.panelView?o.query:null):!i&&null!=o&&null!==(a=o.query)&&void 0!==a&&a.panelView&&(n(w.h.toggleDetailPanel({id:w.e.alertsOnAlertsPage})),e(null))}),[n,o,t,e])})()},M={appQuery:"query",eventFlyout:a.a,filters:"filters",savedQuery:"savedQuery",sourcerer:"sourcerer",timeline:"timeline",timerange:"timerange",pageFilter:"pageFilters",rulesTable:"rulesTable"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var a=n(111);const i=a.z.enum(["going to run","running","partial failure","failed","succeeded"]),r=i.enum,s=a.z.number().int()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(50),i=n(76),r=n(177);const s=["elastic-assistant, load-connectors"],o=({http:e,toasts:t})=>Object(a.useQuery)(s,(async()=>(await Object(i.loadAllActions)({http:e})).filter((e=>!e.isMissingSecrets&&[".bedrock",".gen-ai"].includes(e.actionTypeId)))),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:r.o}))}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(123),r=n(168),s=n(222);const o={id:r.a,messages:[],apiConfig:{},theme:{title:r.c,titleIcon:"logoSecurity",assistant:{name:r.b,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}}},l=()=>{const{allSystemPrompts:e,assistantTelemetry:t,setConversations:n}=Object(i.b)(),r=Object(a.useCallback)((e=>{let t=[];return n((n=>{const a=n[e];if(null!=a){t=a.messages.slice(0,a.messages.length-1);const i={...a,messages:t};return{...n,[e]:i}}return n})),t}),[n]);return{amendMessage:Object(a.useCallback)((({conversationId:e,content:t})=>{n((n=>{const a=n[e];if(null!=a){const{messages:i,...r}=a,s=i[i.length-1],o={...r,messages:s?[...i.slice(0,-1),{...s,content:t}]:[...i]};return{...n,[e]:o}}return n}))}),[n]),appendMessage:Object(a.useCallback)((({conversationId:e,message:a})=>{null==t||t.reportAssistantMessageSent({conversationId:e,role:a.role});let i=[];return n((t=>{const n=t[e];if(null!=n){i=[...n.messages,a];const r={...n,messages:i};return{...t,[e]:r}}return t})),i}),[t,n]),appendReplacements:Object(a.useCallback)((({conversationId:e,replacements:t})=>{let a=t;return n((n=>{const i=n[e];if(null!=i){a={...i.replacements,...t};const r={...i,replacements:a};return{...n,[e]:r}}return n})),a}),[n]),clearConversation:Object(a.useCallback)((t=>{n((n=>{var a;const i=n[t],r=null===(a=Object(s.b)({allSystemPrompts:e,conversation:i}))||void 0===a?void 0:a.id;if(null!=i){const e={...i,apiConfig:{...i.apiConfig,defaultSystemPromptId:r},messages:[],replacements:void 0};return{...n,[t]:e}}return n}))}),[e,n]),createConversation:Object(a.useCallback)((({conversationId:t,messages:a})=>{var i;const r=null===(i=Object(s.b)({allSystemPrompts:e,conversation:void 0}))||void 0===i?void 0:i.id,l={...o,apiConfig:{...o.apiConfig,defaultSystemPromptId:r},id:t,messages:null!=a?a:[]};return n((e=>{if(null!=e[t])throw new Error("Conversation already exists!");return{...e,[t]:{...l}}})),l}),[e,n]),deleteConversation:Object(a.useCallback)((e=>{let t;return n((n=>{const{[e]:a,...i}=n;return t=a,null!=a?i:n})),t}),[n]),removeLastMessage:r,setApiConfig:Object(a.useCallback)((({conversationId:e,apiConfig:t})=>{n((n=>{const a=n[e];if(null!=a){const i={...a,apiConfig:t};return{...n,[e]:i}}return n}))}),[n]),setConversation:Object(a.useCallback)((({conversation:e})=>{n((t=>({...t,[e.id]:e})))}),[n])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));const a=e=>{const t=[...e.matchAll(/```(\w+)?\s([\s\S]*?)```/g)],n={eql:["Event Query Language","EQL sequence query","EQL"],esql:["Elasticsearch Query Language","ESQL","ES|QL","SQL"],kql:["Kibana Query Language","KQL Query","KQL"],dsl:["Elasticsearch QueryDSL","Elasticsearch Query DSL","Elasticsearch DSL","Query DSL","DSL"]};return t.map((t=>{let a=t[1]||"no-type";if("no-type"===a||"json"===a){const i=t.index||0,r=e.slice(0,i);for(const[e,t]of Object.entries(n))if(t.some((e=>r.toLowerCase().includes(e.toLowerCase())))){a=e;break}}const i=t[2].trim(),r=t.index||0;return{type:a,content:i,start:r,end:r+t[0].length}}))},i=({allSystemPrompts:e,conversation:t})=>{var n;const a=e.find((e=>{var n;return e.id===(null==t||null===(n=t.apiConfig)||void 0===n?void 0:n.defaultSystemPromptId)})),i=e.find((e=>e.isNewConversationDefault));return null!==(n=null!=a?a:i)&&void 0!==n?n:null==e?void 0:e[0]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e){return(e+1)%1e6};t.default=function(){return a.useReducer(i,0)[1]}},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u}));var a=n(4);const i={ENABLE:`${a.l} singleRuleActions enable`,DISABLE:`${a.l} singleRuleActions disable`,DUPLICATE:`${a.l} singleRuleActions duplicate`,EXPORT:`${a.l} singleRuleActions export`,DELETE:`${a.l} singleRuleActions delete`,PREVIEW:`${a.l} singleRuleActions preview`,SAVE:`${a.l} singleRuleActions save`},r={ENABLE:`${a.l} bulkRuleActions enable`,DISABLE:`${a.l} bulkRuleActions disable`,DUPLICATE:`${a.l} bulkRuleActions duplicate`,EXPORT:`${a.l} bulkRuleActions export`,DELETE:`${a.l} bulkRuleActions delete`,EDIT:`${a.l} bulkRuleActions edit`},s={REFRESH:`${a.l} rulesTable refresh`,FILTER:`${a.l} rulesTable filter`,LOAD_PREBUILT:`${a.l} rulesTable loadPrebuilt`},o={SAVE:`${a.l} timeline save`,DUPLICATE:`${a.l} timeline duplicate`,DELETE:`${a.l} timeline delete`,BULK_DELETE:`${a.l} timeline bulkDelete`},l={OPEN_ANALYZER:`${a.l} alerts openAnalyzer`,OPEN_SESSION_VIEW:`${a.l} alerts openSessionView`,INVESTIGATE_IN_TIMELINE:`${a.l} alerts investigateInTimeline`},u={FIELD_SAVED:`${a.l} fieldBrowser fieldSaved`,FIELD_DELETED:`${a.l} fieldBrowser fieldDeleted`}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(45);const i=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},r=["http:","https:"],s=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(r.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function o(e){return Object(a.isNumber)(e)||!Object(a.isEmpty)(e)}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return O}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(48),l=n(17),u=n(119),c=n(196),d=n(118),m=n(189),p=n(122),f=n(113),b=n(112),g=n(138),v=n(149),y=n(116),h=n(167),j=n(460);const E=({timelineId:e,timelineType:t,onClick:n})=>{const a=Object(o.useDispatch)(),i=Object(r.useMemo)((()=>v.d.defaultDataViewSelector()),[]),{id:s,patternList:l}=Object(b.a)(i),{timelineFullScreen:f,setTimelineFullScreen:E}=Object(m.c)(),O=Object(b.a)(g.d.globalTimeRangeSelector),{resetDiscoverAppState:x}=Object(j.a)(),S=Object(r.useCallback)((({id:e,show:n,timeRange:i})=>{const r=null!=i?i:O;e===p.c.active&&f&&E(!1),a(v.a.setSelectedDataView({id:y.SourcererScopeName.timeline,selectedDataViewId:s,selectedPatterns:l})),a(d.a.createTimeline({columns:c.b,dataViewId:s,id:e,indexNames:l,show:n,timelineType:t,updated:void 0})),a(g.b.addLinkTo([u.a.global,u.a.timeline])),a(h.a.addNotes({notes:[]})),i&&a(g.b.removeLinkTo([u.a.timeline,u.a.global])),"absolute"===r.kind?a(g.b.setAbsoluteRangeDatePicker({...r,id:u.a.timeline})):"relative"===r.kind&&a(g.b.setRelativeRangeDatePicker({...r,id:u.a.timeline}))}),[a,O,s,l,E,f,t]);return Object(r.useCallback)((a=>{S({id:e,show:!0,timelineType:t,timeRange:null==a?void 0:a.timeRange}),"function"==typeof n&&n(),x()}),[S,e,t,n,x])},O=({timelineId:e,timelineType:t,onClick:n})=>{const a=E({timelineId:e,timelineType:t,onClick:n});return{getButton:Object(r.useCallback)((({outline:e,title:n,iconType:r="plusInCircle",fill:o=!0})=>{const u={iconType:r,onClick:()=>a(),fill:o},c=t===f.l.template?"template-timeline-new":"timeline-new",{fill:d,...m}=u;return e?s.a.createElement(l.EuiButton,i()({"data-test-subj":`${c}-with-border`},u),n):s.a.createElement(l.EuiButtonEmpty,i()({"data-test-subj":c,color:"text"},m),n)}),[a,t])}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n(4);var a=n(185);const i=(e,t)=>`/${e}${Object(a.a)(t)}`,r=(e,t)=>`/name/${e}${Object(a.a)(t)}`,s=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`},function(e,t,n){"use strict";let a,i;n.r(t),n.d(t,"HostsType",(function(){return a})),n.d(t,"HostsTableType",(function(){return i})),function(e){e.page="page",e.details="details"}(a||(a={})),function(e){e.authentications="authentications",e.hosts="allHosts",e.events="events",e.uncommonProcesses="uncommonProcesses",e.anomalies="anomalies",e.risk="hostRisk",e.sessions="sessions"}(i||(i={}))},,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef();return a.useEffect((function(){t.current=e})),t.current}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(17),i=n(5),r=n(47),s=n(2),o=n.n(s);const l=({count:e})=>{const[t,n,l]=Object(s.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const n=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),a={compactThousands:i.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},r=new Map([[1,""],[1e3,a.compactThousands],[1e6,a.compactMillions],[1e9,a.compactBillions],[1e12,a.compactTrillions]]),s=i.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),o=null!==(t=r.get(n))&&void 0!==t?t:"";return[Math.floor(e/n),o,e/n%1>Number.EPSILON?s:""]}(e||0)),[e]);return null==e?null:0===e?o.a.createElement(o.a.Fragment,null,0):o.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:o.a.createElement(a.EuiI18nNumber,{value:t}),scale:n,hasRemainder:l}})},u=o.a.memo(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n(185);const i=e=>`${Object(a.a)(e)}`,r=e=>`${Object(a.a)(e)}`,s=(e,t)=>`/id/${e}${Object(a.a)(t)}`,o=(e,t,n)=>`/id/${e}/${t}${Object(a.a)(n)}`,l=(e,t)=>`/id/${e}/edit${Object(a.a)(t)}`},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return b}));var a=n(45),i=n(234),r=n.n(i),s=n(2),o=n(110),l=n(555),u=n(334),c=n(117);const d=e=>Object(a.keyBy)("name",function(e){const t=[];for(const n of Object.values(e))n.fields&&t.push(...Object.values(n.fields));return t}(e)),m=r()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(a.pick)(["name","searchable","type","aggregatable","esTypes","subType","conflictDescriptions"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),p={},f={fields:[],title:""},b=(e,t=!1,n="indexFields")=>{const{data:i}=Object(o.i)().services,r=Object(s.useRef)(new AbortController),d=Object(s.useRef)([]),[b,g]=Object(s.useState)({browserFields:p,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),{addError:v}=Object(c.a)(),y=Object(s.useCallback)((t=>{(async()=>{try{g({...b,loading:!0}),r.current=new AbortController;const e=await i.dataViews.create({title:t.join(","),allowNoIndex:!0}),n=e.toSpec(),{browserFields:a}=Object(u.a)(t,n.fields);d.current=e.getIndexPattern().split(","),g({loading:!1,dataView:n,browserFields:a,indexes:e.getIndexPattern().split(","),indexExists:e.getIndexPattern().split(",").length>0,indexPatterns:m(e.getIndexPattern(),e.fields)})}catch(t){g({browserFields:p,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),v(null==t?void 0:t.message,{title:l.a})}})()}),[v,i.dataViews,e,b]);return Object(s.useEffect)((()=>(Object(a.isEmpty)(e)||Object(a.isEqual)(d.current,e)||y(e),()=>{r.current.abort()})),[e,d]),[b.loading,b]}},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return s})),n.d(t,"k",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return b}));var a=n(5);a.i18n.translate("xpack.securitySolution.timeline.properties.timelineDescription",{defaultMessage:"Timeline Description"});const i=a.i18n.translate("xpack.securitySolution.timeline.properties.addToFavoriteButtonLabel",{defaultMessage:"Add to favorites"}),r=a.i18n.translate("xpack.securitySolution.timeline.properties.removeFromFavoritesButtonLabel",{defaultMessage:"Remove from favorites"}),s=a.i18n.translate("xpack.securitySolution.timeline.properties.untitledTimelinePlaceholder",{defaultMessage:"Untitled timeline"}),o=a.i18n.translate("xpack.securitySolution.timeline.properties.untitledTemplatePlaceholder",{defaultMessage:"Untitled template"}),l=a.i18n.translate("xpack.securitySolution.timeline.properties.descriptionPlaceholder",{defaultMessage:"Add a description"}),u=a.i18n.translate("xpack.securitySolution.timeline.properties.notesButtonLabel",{defaultMessage:"Notes"}),c=a.i18n.translate("xpack.securitySolution.timeline.properties.newTimelineButtonLabel",{defaultMessage:"Create new Timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.properties.newTemplateTimelineButtonLabel",{defaultMessage:"Create new Timeline template"}),m=a.i18n.translate("xpack.securitySolution.timeline.properties.addTimelineButtonLabel",{defaultMessage:"Add new timeline or template"}),p=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToCaseButtonLabel",{defaultMessage:"Attach to case"}),f=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToNewCaseButtonLabel",{defaultMessage:"Attach to new case"}),b=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToExistingCaseButtonLabel",{defaultMessage:"Attach to existing case"})},,,function(e,t,n){"use strict";var a=n(141);n.d(t,"d",(function(){return a.N}));var i=n(148);n.d(t,"b",(function(){return i.a})),n.d(t,"c",(function(){return i.b})),n.d(t,"e",(function(){return i.g})),n.d(t,"f",(function(){return i.h})),n(365),n(368),n(369);var r=n(323);n.d(t,"a",(function(){return r.b})),n(367),n(366)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(111).z.enum(["asc","desc"]);a.enum},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return d}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.clearChat",{defaultMessage:"Clear chat"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.defaultAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedToggleLabel",{defaultMessage:"Show anonymized"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedTooltip",{defaultMessage:"Show the anonymized values sent to and from the assistant"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.submitMessage",{defaultMessage:"Submit message"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.apiErrorTitle",{defaultMessage:"An error occurred sending your message."}),c=a.i18n.translate("xpack.elasticAssistant.documentationLinks.ariaLabel",{defaultMessage:"Click to open Elastic Assistant documentation in a new tab"}),d=a.i18n.translate("xpack.elasticAssistant.documentationLinks.documentation",{defaultMessage:"documentation"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return m}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.youAreAHelpfulExpertAssistant",{defaultMessage:"You are a helpful, expert assistant who answers questions about Elastic Security."}),r=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.useTheFollowingContextToAnswer",{defaultMessage:"Use the following context to answer questions:"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.ifYouDontKnowTheAnswer",{defaultMessage:"Do not answer questions unrelated to Elastic Security."}),o=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroPersonality",{defaultMessage:"Provide the most detailed and relevant answer possible, as if you were relaying this information back to a cyber security expert."}),l=`${i} ${s}\n${r}`,u=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.defaultSystemPromptName",{defaultMessage:"Default system prompt"}),c=`${i} ${s}\n${o}\n${r}`,d=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroSystemPromptName",{defaultMessage:"Enhanced system prompt"}),m=e=>`CONTEXT:\n"""\n${e}\n"""`},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={SYSTEM_PROMPT_SELECTOR:"systemPromptSelector",CONVERSATIONS_MULTISELECTOR:"conversationMultiSelector",ADD_SYSTEM_PROMPT:"addSystemPrompt",PROMPT_SUPERSELECT:"promptSuperSelect",CONVERSATIONS_MULTISELECTOR_OPTION:e=>`conversationMultiSelectorOption-${e}`,SETTINGS_MODAL:"settingsModal",SYSTEM_PROMPT_MODAL:{ID:"systemPromptModal",PROMPT_TEXT:"systemPromptModalPromptText",TOGGLE_ALL_DEFAULT_CONVERSATIONS:"systemPromptModalToggleDefaultConversations",SAVE:"systemPromptModalSave",CANCEL:"systemPromptModalCancel"}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a=e=>{if(null==e||!e.isPreconfigured)return null==e?void 0:e.config},i=e=>{var t;return null!==(t=e.actionTypeTitle)&&void 0!==t?t:e.id}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return d}));var a=n(73),i=n(249),r=n(498),s=n(374);const o=async({alerts:e,alertsIndexPattern:t,allow:n,allowReplacement:o,assistantLangChain:l,assistantStreamingEnabled:u,http:c,messages:d,onNewReplacements:m,replacements:p,apiConfig:f,signal:b,size:g})=>{var v;const y=d.map((e=>({role:e.role,content:e.content}))),h=(null==f?void 0:f.provider)===a.OpenAiProviderType.OpenAi?{model:null!==(v=f.model)&&void 0!==v?v:r.a,messages:y,n:1,stop:null,temperature:.2}:{messages:y},j=u&&!l,E=Object(s.e)({alerts:e,alertsIndexPattern:t,allow:n,allowReplacement:o,replacements:p,size:g}),O=j?{params:{subActionParams:h,subAction:"invokeStream"},assistantLangChain:l,...E}:{params:{subActionParams:h,subAction:"invokeAI"},assistantLangChain:l,...E};try{var x,S,k,w,C;if(j){var T,M;const e=await c.fetch(`/internal/elastic_assistant/actions/connector/${null==f?void 0:f.connectorId}/_execute`,{method:"POST",body:JSON.stringify(O),signal:b,asResponse:j,rawResponse:j}),t=null==e||null===(T=e.response)||void 0===T||null===(M=T.body)||void 0===M?void 0:M.getReader();return t?{response:t,isStream:!0,isError:!1}:{response:`${i.a}\n\nCould not get reader from response`,isError:!0,isStream:!1}}const t=await c.fetch(`/internal/elastic_assistant/actions/connector/${null==f?void 0:f.connectorId}/_execute`,{method:"POST",body:JSON.stringify(O),headers:{"Content-Type":"application/json"},signal:b});if("ok"!==t.status||!t.data)return t.service_message?{response:`${i.a}\n\n${t.service_message}`,isError:!0,isStream:!1}:{response:i.a,isError:!0,isStream:!1};const n=null!=(null===(x=t.trace_data)||void 0===x?void 0:x.trace_id)&&null!=(null===(S=t.trace_data)||void 0===S?void 0:S.transaction_id)?{traceId:null===(k=t.trace_data)||void 0===k?void 0:k.trace_id,transactionId:null===(w=t.trace_data)||void 0===w?void 0:w.transaction_id}:void 0;return m(null!==(C=t.replacements)&&void 0!==C?C:{}),{response:Object(s.f)({alerts:e,assistantLangChain:l})?Object(s.c)(t.data):t.data,isError:!1,isStream:!1,traceData:n}}catch(e){var I,A;const t=null==e||null===(I=e.response)||void 0===I||null===(A=I.body)||void 0===A?void 0:A.getReader,n=j&&"function"==typeof t?t.call(e.response.body):null;var P,_;return n?{response:n,isStream:!0,isError:!0}:{response:`${i.a}\n\n${null!==(P=null==e||null===(_=e.body)||void 0===_?void 0:_.message)&&void 0!==P?P:null==e?void 0:e.message}`,isError:!0,isStream:!1}}},l=async({http:e,resource:t,signal:n})=>{try{const a=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(a,{method:"GET",signal:n})}catch(e){return e}},u=async({http:e,resource:t,signal:n})=>{try{const a=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(a,{method:"POST",signal:n})}catch(e){return e}},c=async({http:e,resource:t,signal:n})=>{try{const a=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(a,{method:"DELETE",signal:n})}catch(e){return e}},d=async({http:e,evalParams:t,signal:n})=>{try{var a,i,r,s,o,l;const u="/internal/elastic_assistant/evaluate",c={agents:null==t||null===(a=t.agents.sort())||void 0===a?void 0:a.join(","),datasetName:null==t?void 0:t.datasetName,evaluationType:null==t||null===(i=t.evaluationType.sort())||void 0===i?void 0:i.join(","),evalModel:null==t||null===(r=t.evalModel.sort())||void 0===r?void 0:r.join(","),outputIndex:null==t?void 0:t.outputIndex,models:null==t||null===(s=t.models.sort())||void 0===s?void 0:s.join(","),projectName:null==t?void 0:t.projectName,runName:null==t?void 0:t.runName};return await e.fetch(u,{method:"POST",body:JSON.stringify({dataset:JSON.parse(null!==(o=null==t?void 0:t.dataset)&&void 0!==o?o:"[]"),evalPrompt:null!==(l=null==t?void 0:t.evalPrompt)&&void 0!==l?l:""}),headers:{"Content-Type":"application/json"},query:c,signal:n})}catch(e){return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(300);t.default=function(e,t){var n=i.useFirstMountState();a.useEffect((function(){if(!n)return e()}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){void 0===e&&(e={});var t=a.useState(e),n=t[0],i=t[1];return[n,a.useCallback((function(e){i((function(t){return Object.assign({},t,e instanceof Function?e(t):e)}))}),[i])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect(e,[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(303));t.default=function(e){var t=i.useRef(0),n=i.useState(e),a=n[0],s=n[1],o=i.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){s(e)}))}),[]);return r.default((function(){cancelAnimationFrame(t.current)})),[a,o]}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return on})),n.d(t,"c",(function(){return ln})),n.d(t,"d",(function(){return un})),n.d(t,"a",(function(){return En}));var a=n(2),i=n.n(a),r=n(17),s=n(44),o=n.n(s),l=n(13),u=n(493),c=n(123),d=n(251),m=n(543),p=n(494),f=n(552),b=n(547),g=n(5);g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph1",{defaultMessage:"The fields below are allowed by default"}),g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph2",{defaultMessage:"Optionally enable anonymization for these fields"}),g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutTitle",{defaultMessage:"Anonymization defaults"});const v=g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsTitle",{defaultMessage:"Anonymization"}),y=g.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsDescription",{defaultMessage:"When adding Prompt Context throughout the Security App that may contain sensitive information, you can choose which fields are sent, and whether to enable anonymization for these fields. This will replace the field's value with a random string before sending the conversation. Helpful defaults are provided below."}),h=o()(r.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeL};
`,j=({defaultAllow:e,defaultAllowReplacement:t,pageSize:n,setUpdatedDefaultAllow:s,setUpdatedDefaultAllowReplacement:o})=>{const{baseAllow:u,baseAllowReplacement:d}=Object(c.b)(),g=Object(a.useCallback)((n=>{Object(p.b)({defaultAllow:e,defaultAllowReplacement:t,setDefaultAllow:s,setDefaultAllowReplacement:o,updates:n})}),[e,t,s,o]),j=Object(a.useCallback)((()=>{s(u),o(d)}),[u,d,s,o]),E=Object(a.useMemo)((()=>{const n=new Set(e);return t.reduce(((e,t)=>n.has(t)?e+1:e),0)}),[e,t]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,v)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"xs"},y),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center","data-test-subj":"summary",gutterSize:"none"},Object(l.jsx)(h,{grow:!1},Object(l.jsx)(f.a,{allowed:e.length,total:e.length})),Object(l.jsx)(h,{grow:!1},Object(l.jsx)(b.a,{anonymized:E,isDataAnonymizable:!0}))),Object(l.jsx)(r.EuiSpacer,{size:"s"}),Object(l.jsx)(m.a,{allow:e,allowReplacement:t,onListUpdated:g,onReset:j,rawData:null,pageSize:n}))};j.displayName="AnonymizationSettingsComponent";const E=i.a.memo(j);var O=n(47),x=n(73),S=n(45);const k=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsTitle",{defaultMessage:"Conversations"}),w=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsDescription",{defaultMessage:"Create and manage conversations with the Elastic AI Assistant."}),C=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.connectorTitle",{defaultMessage:"Connector"}),T=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptTitle",{defaultMessage:"System Prompt"}),M=g.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptHelpTextTitle",{defaultMessage:"Context provided as part of every conversation"});var I=n(495),A=n(496),P=n(551),_=n(498);const D=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.defaultConversationTitle",{defaultMessage:"Conversations"}),F=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.ariaLabel",{defaultMessage:"Conversation selector"}),N=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.placeholderTitle",{defaultMessage:"Select or type to create new..."}),R=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.CustomOptionTextTitle",{defaultMessage:"Create new conversation:"}),z=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.previousConversationTitle",{defaultMessage:"Previous conversation"}),L=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.nextConversationTitle",{defaultMessage:"Next conversation"}),B=g.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.deleteConversationTitle",{defaultMessage:"Delete conversation"});var q={name:"1v0pok0",styles:"min-width:300px"},$={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},V={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},U={name:"1e5733u",styles:"width:calc(100% - 60px)"};const H=i.a.memo((({conversations:e,onConversationDeleted:t,onConversationSelectionChange:n,selectedConversationId:i})=>{const s=Object(a.useMemo)((()=>Object.keys(e)),[e]),[o,u]=Object(a.useState)((()=>Object.values(e).map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.id,"data-test-subj":e.id}})))),c=Object(a.useMemo)((()=>{var e;return i&&null!==(e=o.filter((e=>e.label===i)))&&void 0!==e?e:[]}),[o,i]),d=Object(a.useCallback)((t=>{var a,i;const r=0===t.length?void 0:null!==(a=Object.values(e).find((e=>{var n;return e.id===(null===(n=t[0])||void 0===n?void 0:n.label)})))&&void 0!==a?a:null===(i=t[0])||void 0===i?void 0:i.label;n(r)}),[n,e]),m=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||u([...o,a]),d([a])}),[o,d]),p=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[o,d]),f=Object(a.useCallback)((e=>{var n;u(o.filter((t=>t.label!==e))),(null==c||null===(n=c[0])||void 0===n?void 0:n.label)===e&&d([]),t(e)}),[o,d,t,c]),b=Object(a.useCallback)((()=>{const e=((e,t="")=>0===e.indexOf(t)?e[e.length-1]:e[e.indexOf(t)-1])(s,i),t=o.filter((t=>t.label===e));d(t)}),[s,o,d,i]),g=Object(a.useCallback)((()=>{const e=((e,t="")=>e.indexOf(t)+1>=e.length?e[0]:e[e.indexOf(t)+1])(s,i),t=o.filter((t=>t.label===e));d(t)}),[s,o,d,i]);return Object(l.jsx)(r.EuiFormRow,{label:D,display:"rowCompressed",css:q},Object(l.jsx)(r.EuiComboBox,{"aria-label":F,customOptionText:`${R} {searchValue}`,placeholder:N,singleSelection:{asPlainText:!0},options:o,selectedOptions:c,onChange:p,onCreateOption:m,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(l.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:U},Object(l.jsx)(r.EuiHighlight,{search:t,css:V},a)),!(null!=i&&i.isDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(r.EuiToolTip,{position:"right",content:B},Object(l.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":B,color:"danger","data-test-subj":"delete-conversation",onClick:e=>{e.stopPropagation(),f(a)},css:$}))))},compressed:!0,prepend:Object(l.jsx)(r.EuiButtonIcon,{iconType:"arrowLeft","data-test-subj":"arrowLeft","aria-label":z,onClick:b,disabled:s.length<=1}),append:Object(l.jsx)(r.EuiButtonIcon,{iconType:"arrowRight","data-test-subj":"arrowRight","aria-label":L,onClick:g,disabled:s.length<=1})}))}));H.displayName="ConversationSelectorSettings";var G=n(222),Q=n(220),W=n(252);const K=i.a.memo((({allSystemPrompts:e,defaultConnectorId:t,defaultProvider:n,selectedConversation:s,onSelectedConversationChange:o,conversationSettings:u,http:c,setUpdatedConversationSettings:d,isDisabled:m=!1})=>{const p=Object(a.useMemo)((()=>Object(G.b)({allSystemPrompts:e,conversation:void 0})),[e]),f=Object(a.useMemo)((()=>Object(G.b)({allSystemPrompts:e,conversation:s})),[e,s]),{data:b,isSuccess:g}=Object(Q.a)({http:c}),v=Object(a.useCallback)((e=>{const a="string"==typeof e?{id:null!=e?e:"",messages:[],apiConfig:{connectorId:t,provider:n,defaultSystemPromptId:null==p?void 0:p.id}}:e;null!=a&&d((e=>({...e,[a.id]:a}))),o(a)}),[t,n,null==p?void 0:p.id,o,d]),y=Object(a.useCallback)((e=>{d((t=>{const{[e]:n,...a}=t;return null!=n?a:t}))}),[d]),h=Object(a.useCallback)((e=>{null!=s&&d((t=>({...t,[s.id]:{...s,apiConfig:{...s.apiConfig,defaultSystemPromptId:e}}})))}),[s,d]),j=Object(a.useMemo)((()=>{const e=null==s?void 0:s.apiConfig.connectorId;if(g)return null==b?void 0:b.find((t=>t.id===e))}),[g,b,null==s?void 0:s.apiConfig.connectorId]),E=Object(a.useMemo)((()=>null==s?void 0:s.apiConfig.provider),[null==s?void 0:s.apiConfig.provider]),D=Object(a.useCallback)((e=>{if(null!=s){const t=Object(W.b)(e);d((n=>({...n,[s.id]:{...s,apiConfig:{...s.apiConfig,connectorId:null==e?void 0:e.id,provider:null==t?void 0:t.apiProvider,model:null==t?void 0:t.defaultModel}}})))}}),[s,d]),F=Object(a.useMemo)((()=>{var e,t;const n=null===(e=Object(W.b)(j))||void 0===e?void 0:e.defaultModel;return null!==(t=null==s?void 0:s.apiConfig.model)&&void 0!==t?t:n}),[j,null==s?void 0:s.apiConfig.model]),N=Object(a.useCallback)((e=>{null!=s&&d((t=>({...t,[s.id]:{...s,apiConfig:{...s.apiConfig,model:e}}})))}),[s,d]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,k)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},w),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(H,{selectedConversationId:null==s?void 0:s.id,conversations:u,onConversationDeleted:y,onConversationSelectionChange:v}),Object(l.jsx)(r.EuiFormRow,{"data-test-subj":"prompt-field",display:"rowCompressed",fullWidth:!0,label:T,helpText:M},Object(l.jsx)(P.a,{allSystemPrompts:e,compressed:!0,conversation:s,isEditing:!0,isDisabled:m,onSystemPromptSelectionChange:h,selectedPrompt:f,showTitles:!0,isSettingsModalVisible:!0,setIsSettingsModalVisible:S.noop})),Object(l.jsx)(r.EuiFormRow,{"data-test-subj":"connector-field",display:"rowCompressed",label:C,helpText:Object(l.jsx)(r.EuiLink,{href:`${c.basePath.get()}/app/management/insightsAndAlerting/triggersActionsConnectors/connectors`,target:"_blank",external:!0},Object(l.jsx)(O.FormattedMessage,{id:"xpack.elasticAssistant.assistant.settings.connectorHelpTextTitle",defaultMessage:"Kibana Connector to make requests with"}))},Object(l.jsx)(A.a,{isDisabled:m,onConnectorSelectionChange:D,selectedConnectorId:null==j?void 0:j.id})),!1===(null==j?void 0:j.isPreconfigured)&&E===x.OpenAiProviderType.OpenAi&&Object(l.jsx)(r.EuiFormRow,{"data-test-subj":"model-field",display:"rowCompressed",label:I.c,helpText:I.b},Object(l.jsx)(_.b,{onModelSelectionChange:N,selectedModel:F})))}));K.displayName="ConversationSettings";const Y=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsTitle",{defaultMessage:"Evaluation"}),X=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsDescription",{defaultMessage:"Run predictions and evaluations against test data sets using different models (connectors), agents, and evaluation schemes."}),J=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsTitle",{defaultMessage:"🏃 Run Details"}),Z=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsDescription",{defaultMessage:"Configure test run details like project, run name, dataset, and output index"}),ee=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsTitle",{defaultMessage:"🔮 Predictions"}),te=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsDescription",{defaultMessage:"Choose models (connectors) and corresponding agents the dataset should run against"}),ne=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsTitle",{defaultMessage:"🧮 Evaluation (Optional)"}),ae=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsDescription",{defaultMessage:"Evaluate prediction results using a specific model (connector) and evaluation criterion"}),ie=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectLabel",{defaultMessage:"Project"}),re=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectDescription",{defaultMessage:"LangSmith project to write results to"}),se=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectPlaceholder",{defaultMessage:"8.12 Testing"}),oe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameLabel",{defaultMessage:"Run name"}),le=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameDescription",{defaultMessage:"Name for this specific test run"}),ue=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNamePlaceholder",{defaultMessage:"8.12 ESQL Query Generation"}),ce=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsLabel",{defaultMessage:"Connectors / Models"}),de=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsDescription",{defaultMessage:"Select whichever models you want to evaluate the dataset against"}),me=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsLabel",{defaultMessage:"Agents"}),pe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsDescription",{defaultMessage:"Select the agents (i.e. RAG algos) to evaluate the dataset against"}),fe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelLabel",{defaultMessage:"Evaluator Model"}),be=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelDescription",{defaultMessage:"Model to perform the final evaluation with"}),ge=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeLabel",{defaultMessage:"Evaluation type"}),ve=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeDescription",{defaultMessage:'Type of evaluation to perform, e.g. "correctness" "esql-validator", or "custom" and provide your own evaluation prompt'}),ye=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptLabel",{defaultMessage:"Evaluation prompt"}),he=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptDescription",{defaultMessage:"Prompt template given `input`, `reference` and `prediction` template variables"}),je=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexLabel",{defaultMessage:"Output index"}),Ee=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexDescription",{defaultMessage:'Index to write results to. Must be prefixed with ".kibana-elastic-ai-assistant-"'}),Oe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorDatasetLabel",{defaultMessage:"Dataset"}),xe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetLabel",{defaultMessage:"LangSmith"}),Se=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetDescription",{defaultMessage:"Name of dataset hosted on LangSmith to evaluate"}),ke=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetPlaceholder",{defaultMessage:"ESQL Query Generation"}),we=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetLabel",{defaultMessage:"Custom"}),Ce=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetDescription",{defaultMessage:'Custom dataset to evaluate. Array of objects with "input" and "references" properties'}),Te=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.performEvaluationTitle",{defaultMessage:"Perform evaluation..."}),Me=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactDiscoverLinkText",{defaultMessage:"Discover"}),Ie=g.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactApmLinkText",{defaultMessage:"APM"});var Ae=n(177),Pe=n(50),_e=n(253);const De=["elastic-assistant","perform-evaluation"],Fe=["DefaultAgentExecutor","OpenAIFunctionsExecutor"],Ne=[{label:"correctness"},{label:"esql-validator",disabled:!0},{label:"custom",disabled:!0}];var Re={name:"1sl5m7u",styles:"min-height:330px"},ze={name:"vc763q",styles:"min-height:300px"},Le={name:"1bs7qd7",styles:"&:hover{text-decoration:none;}"},Be={name:"yz1nei",styles:"margin-top:16px"};const qe=i.a.memo((({onEvaluationSettingsChange:e})=>{var t,n;const{actionTypeRegistry:s,basePath:o,http:u}=Object(c.b)(),{data:d}=Object(Q.a)({http:u}),{data:m,mutate:p,isLoading:f}=(({http:e,toasts:t})=>Object(Pe.useMutation)(De,(t=>Object(_e.d)({http:e,evalParams:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.evaluation.evaluationError",{defaultMessage:"Error performing evaluation..."})}))}}))({http:u}),[b,v]=Object(a.useState)(),y=Object(a.useCallback)((e=>{v(e.target.value)}),[v]),[h,j]=Object(a.useState)(),E=Object(a.useCallback)((e=>{j(e.target.value)}),[j]),[x,S]=Object(a.useState)(".kibana-elastic-ai-assistant-evaluation-results"),k=Object(a.useCallback)((e=>{S(e.target.value)}),[S]),[w,C]=Object(a.useState)(!0),T=Object(a.useMemo)((()=>Object(l.jsx)(r.EuiText,{size:"xs",css:Be},Oe," (",Object(l.jsx)(r.EuiLink,{color:w?"primary":"text",onClick:()=>C(!0)},xe)," / ",Object(l.jsx)(r.EuiLink,{color:w?"text":"primary",onClick:()=>C(!1)},we),")")),[w]),[M,I]=Object(a.useState)(),A=Object(a.useCallback)((e=>{I(e.target.value)}),[I]),[P,_]=Object(a.useState)(JSON.stringify([{input:"As an expert user of Elastic Security, please generate an accurate and valid ESQL query to detect the use case below. Your response should be formatted to be able to use immediately in an Elastic Security timeline or detection rule. Take your time with the answer, and really make sure you check your knowledge really well on all the functions I am asking for. check it multiple times if you need to. I cannot afford for queries to be inaccurate. Assume I am using the Elastic Common Schema. Ensure the answers are formatted in a way which is easily copyable.\n\nWrite an ESQL query for detecting cryptomining activity on an AWS EC2 instance.",reference:'FROM metrics-apm*\n| WHERE metricset.name == ""transaction"" AND metricset.interval == ""1m""\n| EVAL bucket = AUTO_BUCKET(transaction.duration.histogram, 50, <start-date>, <end-date>)\n| STATS avg_duration = AVG(transaction.duration.histogram) BY bucket'}],null,2)),D=Object(a.useCallback)((e=>{_(e.target.value)}),[_]),[F,N]=Object(a.useState)([]),R=Object(a.useCallback)((e=>{N(e)}),[N]),z=Object(r.euiPaletteComplementary)(null!==(t=null==d?void 0:d.length)&&void 0!==t?t:0),L=Object(a.useMemo)((()=>{var e;return null!==(e=null==d?void 0:d.map(((e,t)=>{var n;const a=null===(n=Object(W.b)(e))||void 0===n?void 0:n.apiProvider,i=null!=a?a:Object(W.a)(s.get(e.actionTypeId)),r=e.isPreconfigured?Ae.r:i;return{key:e.id,label:`${e.name} (${r})`,color:z[t]}})))&&void 0!==e?e:[]}),[s,d,z]),[B,q]=Object(a.useState)([]),$=Object(a.useCallback)((e=>{q(e)}),[q]),V=Object(a.useCallback)((e=>{const t=e.trim();t&&q([...B,{label:t}])}),[B]),U=Object(a.useMemo)((()=>Fe.map((e=>({label:e})))),[]),[H,G]=Object(a.useState)([]),K=Object(a.useCallback)((e=>{G(e)}),[G]),qe=Object(a.useCallback)((e=>{const t=e.trim();t&&G([{label:t}])}),[G]),$e=Object(a.useMemo)((()=>Ne),[]),[Ve,Ue]=Object(a.useState)([]),He=Object(a.useCallback)((e=>{Ue(e)}),[Ue]),[Ge,Qe]=Object(a.useState)("For the below input: \n\n{{input}} \n\na prediction: \n\n{{prediction}} \n\nwas made. How's it stack up against this reference: \n\n{{reference}} \n\nReturn output in a succinct sentence ranking on a simple grading rubric focused on correctness."),We=Object(a.useCallback)((e=>{Qe(e.target.value)}),[Qe]),Ke=0===F.length||0===B.length||0===x.length,Ye=Object(a.useCallback)((async()=>{const e={models:F.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),agents:B.map((e=>e.label)),dataset:w?void 0:P,datasetName:w?M:void 0,evalModel:Ve.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),evalPrompt:Ge,evaluationType:H.map((e=>e.label)),outputIndex:x,projectName:b,runName:h};p(e)}),[M,P,Ge,x,p,b,h,B,H,Ve,F,w]),Xe=Object(a.useMemo)((()=>{var e;return((e,t)=>`${e}/app/discover#/?_g=(filters:!(),refreshInterval:(pause:!t,value:60000),time:(from:now-1y%2Fd,to:now))&_a=(columns:!(evaluationId,runName,totalAgents,totalInput,totalRequests,input,reference,prediction,evaluation.value,evaluation.reasoning,connectorName,connectorName.keyword,evaluation.__run.runId,evaluation.__run.runId.keyword,evaluation.score,evaluationEnd,evaluationId.keyword,evaluationStart,input.keyword,inputExampleId,inputExampleId.keyword,evaluationDuration,prediction.keyword,predictionResponse.reason.sendToLLM,predictionResponse.status,ConnectorId,predictionResponse.value.data,predictionResponse.value.data.keyword,predictionResponse.value.status,predictionResponse.value.trace_data.trace_id,predictionResponse.value.trace_data.trace_id.keyword,predictionResponse.value.trace_data.transaction_id,predictionResponse.value.trace_data.transaction_id.keyword,reference.keyword,runName.keyword),filters:!(),grid:(columns:('@timestamp':(width:212),ConnectorId:(width:133),connectorName:(width:181),connectorName.keyword:(width:229),evaluation.__run.runId:(width:282),evaluation.__run.runId.keyword:(width:245),evaluation.reasoning:(width:336),evaluation.reasoning.keyword:(width:232),evaluation.score:(width:209),evaluation.value:(width:156),evaluationDuration:(width:174),evaluationEnd:(width:151),evaluationId:(width:130),evaluationId.keyword:(width:186),evaluationStart:(width:202),input:(width:347),input.keyword:(width:458),prediction:(width:264),prediction.keyword:(width:313),predictionResponse.value.connector_id:(width:294),predictionResponse.value.trace_data.trace_id:(width:278),predictionResponse.value.trace_data.transaction_id.keyword:(width:177),reference:(width:305),reference.keyword:(width:219),runName:(width:405),totalAgents:(width:125),totalInput:(width:111),totalRequests:(width:138))),hideChart:!t,index:ce1b41cb-6298-4612-a33c-ba85b3c18ec7,interval:auto,query:(esql:'from%20.kibana-elastic-ai-assistant-evaluation-results%20%0A%7C%20keep%20@timestamp,%20evaluationId,%20runName,%20totalAgents,%20totalInput,%20totalRequests,%20input,%20reference,%20prediction,%20evaluation.value,%20evaluation.reasoning,%20connectorName,%20*%0A%7C%20drop%20evaluation.reasoning.keyword%0A%7C%20rename%20predictionResponse.value.connector_id%20as%20ConnectorId%0A%7C%20where%20evaluationId%20%3D%3D%20%22${t}%22%0A%7C%20sort%20@timestamp%20desc%0A%7C%20limit%20100%0A%0A%0A'),rowHeight:15,sort:!(!('@timestamp',desc)))`)(o,null!==(e=null==m?void 0:m.evaluationId)&&void 0!==e?e:"")}),[o,m]),Je=Object(a.useMemo)((()=>{var e;return((e,t)=>`${e}/app/apm/traces/explorer/waterfall?comparisonEnabled=false&detailTab=timeline&environment=ENVIRONMENT_ALL&kuery=&query=%22labels.evaluationId%22:%20%22${t}%22&rangeFrom=now-1y&rangeTo=now&showCriticalPath=false&traceId=451662121b1f5e6c44084ad7415b9409&transactionId=5f1392fa04766025&type=kql&waterfallItemId=`)(o,null!==(e=null==m?void 0:m.evaluationId)&&void 0!==e?e:"")}),[o,m]),Ze=(e,t)=>Object(l.jsx)("div",null,Object(l.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiTitle,{size:"xs"},Object(l.jsx)("h3",null,e)))),Object(l.jsx)(r.EuiText,{size:"s"},Object(l.jsx)("p",null,Object(l.jsx)(r.EuiTextColor,{color:"subdued"},t)))),et=Object(a.useMemo)((()=>Ze(J,Z)),[]),tt=Object(a.useMemo)((()=>Ze(ee,te)),[]),nt=Object(a.useMemo)((()=>Ze(ne,ae)),[]),at=Le;return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,Y)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},X),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiAccordion,{id:J,arrowDisplay:"right",buttonContent:et,buttonProps:{paddingSize:"s",css:at},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(l.jsx)(r.EuiFlexGroup,null,Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:ie,helpText:re},Object(l.jsx)(r.EuiFieldText,{"aria-label":"project-textfield",compressed:!0,onChange:y,placeholder:se,value:b}))),Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:oe,helpText:le},Object(l.jsx)(r.EuiFieldText,{"aria-label":"run-name-textfield",compressed:!0,onChange:E,placeholder:ue,value:h})))),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:T,fullWidth:!0,helpText:w?Se:Ce},w?Object(l.jsx)(r.EuiFieldText,{"aria-label":"dataset-name-textfield",compressed:!0,onChange:A,placeholder:ke,value:M}):Object(l.jsx)(r.EuiTextArea,{"aria-label":"evaluation-dataset-textarea",compressed:!0,css:ze,fullWidth:!0,onChange:D,value:P})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:je,fullWidth:!0,helpText:Ee},Object(l.jsx)(r.EuiFieldText,{value:x,onChange:k,"aria-label":"evaluation-output-index-textfield"}))),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiAccordion,{id:ee,arrowDisplay:"right",buttonContent:tt,buttonProps:{paddingSize:"s",css:at},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:ce,helpText:de},Object(l.jsx)(r.EuiComboBox,{"aria-label":"model-selector",compressed:!0,options:L,selectedOptions:F,onChange:R})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:me,helpText:pe},Object(l.jsx)(r.EuiComboBox,{"aria-label":"agent-selector",compressed:!0,onCreateOption:V,options:U,selectedOptions:B,onChange:$}))),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiAccordion,{id:ne,arrowDisplay:"right",element:"fieldset",buttonProps:{paddingSize:"s",css:at},buttonContent:nt,paddingSize:"s"},Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:fe,helpText:be},Object(l.jsx)(r.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,options:L,selectedOptions:Ve,singleSelection:{asPlainText:!0},onChange:He})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:ge,helpText:ve},Object(l.jsx)(r.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,onChange:K,onCreateOption:qe,options:$e,selectedOptions:H,singleSelection:{asPlainText:!0}})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:ye,fullWidth:!0,helpText:he},Object(l.jsx)(r.EuiTextArea,{"aria-label":"evaluation-prompt-textarea",compressed:!0,css:Re,disabled:"custom"!==(null===(n=H[0])||void 0===n?void 0:n.label),fullWidth:!0,onChange:We,value:Ge}))),Object(l.jsx)(r.EuiHorizontalRule,null),Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiButton,{size:"s",type:"submit",isDisabled:Ke,isLoading:f,onClick:Ye,fill:!0},Te)),Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)(O.FormattedMessage,{defaultMessage:"Fun Facts: Watch the Kibana server logs for progress, and view results in {discover} / {apm} once complete. Will take (many) minutes depending on dataset, and closing this dialog will cancel the evaluation!",id:"xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactText",values:{discover:Object(l.jsx)(r.EuiLink,{external:!0,href:Xe,target:"_blank"},Me),apm:Object(l.jsx)(r.EuiLink,{external:!0,href:Je,target:"_blank"},Ie)}})))),Object(l.jsx)(r.EuiSpacer,{size:"s"}))}));qe.displayName="EvaluationSettings";const $e=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsLabel",{defaultMessage:"Alerts"}),Ve=(g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.askQuestionsAboutLabel",{defaultMessage:"Ask questions about the"}),g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.yourAnonymizationSettingsLabel",{defaultMessage:"Your anonymization settings will apply to these alerts."})),Ue=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.selectFewerAlertsLabel",{defaultMessage:"Send fewer alerts if the model's context window is too small."}),He=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsRangeSliderLabel",{defaultMessage:"Alerts range"}),Ge=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsTitle",{defaultMessage:"Knowledge Base"}),Qe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsBadgeTitle",{defaultMessage:"Experimental"}),We=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsDescription",{defaultMessage:"Powered by ELSER, the Knowledge Base enables the ability to recall documents and other relevant context within your conversation."}),Ke=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseLabel",{defaultMessage:"Knowledge Base"}),Ye=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseTooltip",{defaultMessage:"ELSER must be configured to enable the Knowledge Base"}),Xe=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseDescription",{defaultMessage:"Index where Knowledge Base docs are stored"}),Je=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.initializeKnowledgeBaseButton",{defaultMessage:"Initialize"}),Ze=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.deleteKnowledgeBaseButton",{defaultMessage:"Delete"}),et=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserLabel",{defaultMessage:"ELSER Configured"}),tt=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserMachineLearningDescription",{defaultMessage:"Machine Learning"}),nt=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserSeeDocsDescription",{defaultMessage:"See docs"}),at=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlLabel",{defaultMessage:"ES|QL Knowledge Base Documents"}),it=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlDescription",{defaultMessage:"Knowledge Base docs for generating ES|QL queries"}),rt=g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlInstalledDescription",{defaultMessage:"ES|QL Knowledge Base docs loaded"}),st=({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{const n=Object(r.useGeneratedHtmlId)({prefix:"inputRangeSlider"}),s=Object(a.useCallback)((n=>{t({...e,alerts:n.target.checked})}),[e,t]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiFormRow,{display:"columnCompressedSwitch",label:$e,css:Object(l.css)(".euiFormRow__labelWrapper{min-width:",95,"px!important;}","")},Object(l.jsx)(r.EuiSwitch,{checked:e.alerts,compressed:!0,"data-test-subj":"alertsSwitch",label:$e,onChange:s,showLabel:!1})),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(l.jsx)(r.EuiFlexItem,{css:Object(l.css)("width:",300,"px;",""),grow:!1},Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiRange,{"aria-label":He,compressed:!0,"data-test-subj":"alertsRange",disabled:!e.alerts,id:n,max:100,min:10,onChange:n=>t({...e,latestAlerts:Number(n.currentTarget.value)}),showTicks:!0,step:10,value:e.latestAlerts}),Object(l.jsx)(r.EuiSpacer,{size:"s"})),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,(o=e.latestAlerts,g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.latestAndRiskiestOpenAlertsLabel",{defaultMessage:"Send AI Assistant information about your {alertsCount} newest and riskiest open or acknowledged alerts.",values:{alertsCount:o}}))))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,Ve))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,Ue)))));var o},ot=i.a.memo(st),lt=["elastic-assistant","knowledge-base-status"],ut=()=>{const e=Object(Pe.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(lt,{refetchType:"active"})}),[e])},ct=["elastic-assistant","delete-knowledge-base"],dt=["elastic-assistant","post-knowledge-base"],mt="esql";var pt={name:"1tyyxc3",styles:"padding-left:20px"},ft={name:"1tyyxc3",styles:"padding-left:20px"},bt={name:"1tyyxc3",styles:"padding-left:20px"},gt={name:"nvudtm",styles:"padding-left:5px"},vt={name:"1xr0ypo",styles:".euiFormRow__labelWrapper{min-width:95px!important;}"};const yt=i.a.memo((({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{var n,s,o;const{http:u}=Object(c.b)(),{data:d,isLoading:m,isFetching:p}=(({http:e,resource:t,toasts:n})=>Object(Pe.useQuery)(lt,(async({signal:n})=>Object(_e.c)({http:e,resource:t,signal:n})),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==n||n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.knowledgeBase.statusError",{defaultMessage:"Error fetching Knowledge Base Status"})}))}}))({http:u,resource:mt}),{mutate:f,isLoading:b}=(({http:e,toasts:t})=>{const n=ut();return Object(Pe.useMutation)(dt,(t=>Object(_e.e)({http:e,resource:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.knowledgeBase.setupError",{defaultMessage:"Error setting up Knowledge Base"})}))},onSettled:()=>{n()}})})({http:u}),{mutate:v,isLoading:y}=(({http:e,toasts:t})=>{const n=ut();return Object(Pe.useMutation)(ct,(t=>Object(_e.a)({http:e,resource:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:g.i18n.translate("xpack.elasticAssistant.knowledgeBase.deleteError",{defaultMessage:"Error deleting Knowledge Base"})}))},onSettled:()=>{n()}})})({http:u}),h=null!==(n=null==d?void 0:d.elser_exists)&&void 0!==n&&n,j=null!==(s=(null==d?void 0:d.index_exists)&&(null==d?void 0:d.pipeline_exists))&&void 0!==s&&s,E=null!==(o=null==d?void 0:d.esql_exists)&&void 0!==o&&o,x=m||p||b||y,S=e.assistantLangChain&&(null==d?void 0:d.elser_exists),k=e.assistantLangChain&&S&&j,w=!(null!=d&&d.elser_exists||e.assistantLangChain),C=h?"success":"subdued",T=j?"success":"subdued",M=E?"success":"subdued",I=Object(a.useCallback)((n=>{t({...e,assistantLangChain:n.target.checked}),n.target.checked&&null!=d&&d.elser_exists&&f(mt)}),[null==d?void 0:d.elser_exists,e,t,f]),A=Object(a.useMemo)((()=>x?Object(l.jsx)(r.EuiLoadingSpinner,{size:"s"}):Object(l.jsx)(r.EuiToolTip,{content:w&&Ye,position:"right"},Object(l.jsx)(r.EuiSwitch,{showLabel:!1,"data-test-subj":"assistantLangChainSwitch",disabled:w,checked:e.assistantLangChain,onChange:I,label:Ke,compressed:!0}))),[x,w,e.assistantLangChain,I]),P=Object(a.useCallback)((e=>{e?f():v()}),[v,f]),_=Object(a.useMemo)((()=>x||!S?Object(l.jsx)(i.a.Fragment,null):Object(l.jsx)(r.EuiButtonEmpty,{color:j?"danger":"primary",flush:"left","data-test-subj":"knowledgeBaseActionButton",onClick:()=>P(!j),size:"xs"},j?Ze:Je)),[S,j,x,P]),D=Object(a.useMemo)((()=>j?Object(l.jsx)("span",{"data-test-subj":"kb-installed"},(".kibana-elastic-ai-assistant-kb",g.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseInstalledDescription",{defaultMessage:"Initialized to `{kbIndexPattern}`",values:{kbIndexPattern:".kibana-elastic-ai-assistant-kb"}}))," ",_):Object(l.jsx)("span",{"data-test-subj":"install-kb"},Xe," ",_)),[j,_]),F=Object(a.useCallback)((e=>{e?f(mt):v(mt)}),[v,f]),N=Object(a.useMemo)((()=>x||!k?Object(l.jsx)(i.a.Fragment,null):Object(l.jsx)(r.EuiButtonEmpty,{color:E?"danger":"primary",flush:"left","data-test-subj":"esqlEnableButton",onClick:()=>F(!E),size:"xs"},E?Ze:Je)),[x,k,E,F]),R=Object(a.useMemo)((()=>E?Object(l.jsx)("span",{"data-test-subj":"esql-installed"},rt," ",N):Object(l.jsx)("span",{"data-test-subj":"install-esql"},it," ",N)),[N,E]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,Ge," ",Object(l.jsx)(r.EuiBetaBadge,{iconType:"beaker",label:Qe,size:"s",color:"hollow"}))),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},We),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFormRow,{display:"columnCompressedSwitch",label:Ke,css:vt},A),Object(l.jsx)(r.EuiSpacer,{size:"s"}),Object(l.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"s",css:gt},Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)("div",null,Object(l.jsx)(r.EuiHealth,{color:C},et),Object(l.jsx)(r.EuiText,{size:"xs",color:"subdued",css:bt},Object(l.jsx)(O.FormattedMessage,{defaultMessage:"Configure ELSER within {machineLearning} to get started. {seeDocs}",id:"xpack.elasticAssistant.assistant.settings.knowledgeBasedSettings.knowledgeBaseDescription",values:{machineLearning:Object(l.jsx)(r.EuiLink,{external:!0,href:u.basePath.prepend("/app/ml/trained_models"),target:"_blank"},tt),seeDocs:Object(l.jsx)(r.EuiLink,{external:!0,href:"https://www.elastic.co/guide/en/machine-learning/current/ml-nlp-elser.html#download-deploy-elser",target:"_blank"},nt)}})))),Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)("div",null,Object(l.jsx)(r.EuiHealth,{color:T},Ke),Object(l.jsx)(r.EuiText,{size:"xs",color:"subdued",css:ft},D))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)("span",null,Object(l.jsx)(r.EuiHealth,{color:M},at),Object(l.jsx)(r.EuiText,{size:"xs",color:"subdued",css:pt},R)))),Object(l.jsx)(r.EuiSpacer,{size:"s"}),Object(l.jsx)(ot,{knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t}))}));yt.displayName="KnowledgeBaseSettings";const ht=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsTitle",{defaultMessage:"Quick Prompts"}),jt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsDescription",{defaultMessage:"Create and manage Quick Prompts. Quick Prompts are shortcuts to common actions."}),Et=(g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.modalTitle",{defaultMessage:"Quick Prompts"}),g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.nameLabel",{defaultMessage:"Name"})),Ot=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptLabel",{defaultMessage:"Prompt"}),xt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptPlaceholder",{defaultMessage:"Enter a Quick Prompt"}),St=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.badgeColorLabel",{defaultMessage:"Badge color"}),kt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsLabel",{defaultMessage:"Contexts"}),wt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsHelpText",{defaultMessage:"Select the Prompt Contexts that this Quick Prompt will be available for. Selecting none will make this Quick Prompt available at all times."}),Ct=(g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"}),g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."})),Tt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.deletePromptTitle",{defaultMessage:"Delete Quick Prompt"}),Mt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.customOptionText",{defaultMessage:"Create new Quick Prompt named"});var It={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},At={name:"d3v9zr",styles:"overflow:hidden"},Pt={name:"1e5733u",styles:"width:calc(100% - 60px)"};const _t=i.a.memo((({isDisabled:e=!1,quickPrompts:t,onQuickPromptDeleted:n,onQuickPromptSelectionChange:i,selectedQuickPrompt:s})=>{const[o,u]=Object(a.useState)(t.map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.title,"data-test-subj":e.title,color:e.color}}))),c=Object(a.useMemo)((()=>s?[{value:{isDefault:!0},label:s.title,color:s.color}]:[]),[s]),d=Object(a.useCallback)((e=>{var n,a;const r=0===e.length?void 0:null!==(n=t.find((t=>{var n;return t.title===(null===(n=e[0])||void 0===n?void 0:n.label)})))&&void 0!==n?n:null===(a=e[0])||void 0===a?void 0:a.label;i(r)}),[i,t]),m=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||u([...o,a]),d([a])}),[d,o]),p=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[d,o]),f=Object(a.useCallback)((e=>{var t;u(o.filter((t=>t.label!==e))),(null==c||null===(t=c[0])||void 0===t?void 0:t.label)===e&&d([]),n(e)}),[d,n,o,c]);return Object(l.jsx)(r.EuiComboBox,{"data-test-subj":"quickPromptSelector","aria-label":Ct,compressed:!0,isDisabled:e,placeholder:Ct,customOptionText:`${Mt} {searchValue}`,singleSelection:!0,options:o,selectedOptions:c,onChange:p,onCreateOption:m,renderOption:(e,t,n)=>{const{color:a,label:i,value:s}=e;return Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(l.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:Pt},Object(l.jsx)(r.EuiHealth,{color:a,css:At},Object(l.jsx)(r.EuiHighlight,{search:t},i))),!(null!=s&&s.isDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiToolTip,{position:"right",content:Tt},Object(l.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":Tt,"data-test-subj":"delete-quick-prompt",color:"danger",onClick:e=>{e.stopPropagation(),f(i)},css:It}))))},fullWidth:!0})}));_t.displayName="QuickPromptSelector";const Dt=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.ariaLabel",{defaultMessage:"Select Prompt Context categories this Quick Prompt will be available for."}),Ft=g.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.placeholderLabel",{defaultMessage:"(Quick Prompt will always be visible)."}),Nt=i.a.memo((({isDisabled:e,onPromptContextSelectionChange:t,promptContexts:n,selectedPromptContexts:i=[]})=>{const s=Object(a.useMemo)((()=>n.map((e=>({value:{category:e.category},label:e.description,"data-test-subj":e.description})))),[n]),o=Object(a.useMemo)((()=>null!=i?i.map((e=>({value:{category:e.category},label:e.description}))):[]),[i]),u=Object(a.useCallback)((e=>{const a=n.filter((t=>e.some((e=>t.description===e.label))));t(a)}),[t,n]),c=Object(a.useCallback)((e=>{0===e.length?u([]):-1!==s.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&u(e)}),[u,s]);return Object(l.jsx)(r.EuiComboBox,{"aria-label":Dt,compressed:!0,fullWidth:!0,isDisabled:e,placeholder:Ft,options:s,selectedOptions:o,onChange:c,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(l.jsx)("span",{className:n},Object(l.jsx)(r.EuiHighlight,{search:t},a),Object(l.jsx)("span",null,` / (${null==i?void 0:i.category})`))}})}));Nt.displayName="PromptContextSelector";const Rt="#D36086";var zt={name:"xpz1vu",styles:"min-height:150px"};const Lt=i.a.memo((({onSelectedQuickPromptChange:e,quickPromptSettings:t,selectedQuickPrompt:n,setUpdatedQuickPromptSettings:s})=>{const{basePromptContexts:o}=Object(c.b)(),u=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.prompt)&&void 0!==e?e:""}),[null==n?void 0:n.prompt]),d=Object(a.useCallback)((e=>{null!=n&&s((t=>t.some((e=>e.title===n.title))?t.map((t=>t.title===n.title?{...t,prompt:e.target.value}:t)):t))}),[n,s]),m=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.color)&&void 0!==e?e:Rt}),[null==n?void 0:n.color]),p=Object(a.useCallback)(((e,{hex:t,isValid:a})=>{null!=n&&s((t=>t.some((e=>e.title===n.title))?t.map((t=>t.title===n.title?{...t,color:e}:t)):t))}),[n,s]),f=Object(a.useMemo)((()=>{var e;return null!==(e=o.filter((e=>{var t;return null==n||null===(t=n.categories)||void 0===t?void 0:t.some((t=>(null==e?void 0:e.category)===t))})))&&void 0!==e?e:[]}),[o,null==n?void 0:n.categories]),b=Object(a.useCallback)((e=>{null!=n&&s((t=>t.some((e=>e.title===n.title))?t.map((t=>t.title===n.title?{...t,categories:e.map((e=>e.category))}:t)):t))}),[n,s]),g=Object(a.useCallback)((t=>{const n="string"==typeof t?{title:null!=t?t:"",prompt:"",color:Rt,categories:[]}:t;null!=n&&s((e=>e.some((e=>e.title===n.title))?e:[...e,n])),e(n)}),[e,s]),v=Object(a.useCallback)((e=>{s((t=>t.filter((t=>t.title!==e))))}),[s]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,ht)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},jt),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFormRow,{label:Et,display:"rowCompressed",fullWidth:!0},Object(l.jsx)(_t,{onQuickPromptDeleted:v,onQuickPromptSelectionChange:g,quickPrompts:t,selectedQuickPrompt:n})),Object(l.jsx)(r.EuiFormRow,{label:Ot,display:"rowCompressed",fullWidth:!0},Object(l.jsx)(r.EuiTextArea,{compressed:!0,disabled:null==n,fullWidth:!0,"data-test-subj":"quick-prompt-prompt",onChange:d,placeholder:xt,value:u,css:zt})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",fullWidth:!0,label:kt,helpText:wt},Object(l.jsx)(Nt,{isDisabled:null==n,onPromptContextSelectionChange:b,promptContexts:o,selectedPromptContexts:f})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:St},Object(l.jsx)(r.EuiColorPicker,{color:m,compressed:!0,disabled:null==n,onChange:p})))}));Lt.displayName="AddQuickPromptModal";const Bt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsTitle",{defaultMessage:"System Prompts"}),qt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsDescription",{defaultMessage:"Create and manage System Prompts. System Prompts are configurable chunks of context that are always sent for a given conversation."}),$t=(g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.modalTitle",{defaultMessage:"System Prompts"}),g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.nameLabel",{defaultMessage:"Name"})),Vt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptLabel",{defaultMessage:"Prompt"}),Ut=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptPlaceholder",{defaultMessage:"Enter a System Prompt"}),Ht=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsLabel",{defaultMessage:"Default conversations"}),Gt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultNewConversationTitle",{defaultMessage:"Use as default for all new conversations"}),Qt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsHelpText",{defaultMessage:"Conversations that should use this System Prompt by default"}),Wt=(g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"}),g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"}),i.a.memo((({conversations:e,isDisabled:t=!1,onConversationSelectionChange:n,selectedConversations:i=[]})=>{const s=Object(a.useMemo)((()=>e.map((e=>({label:e.id,"data-test-subj":d.a.CONVERSATIONS_MULTISELECTOR_OPTION(e.id)})))),[e]),o=Object(a.useMemo)((()=>null!=i?i.map((e=>({label:e.id}))):[]),[i]),u=Object(a.useCallback)((t=>{const a=e.filter((e=>t.some((t=>e.id===t.label))));n(a)}),[n,e]),c=Object(a.useCallback)((e=>{0===e.length?u([]):-1!==s.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&u(e)}),[u,s]);return Object(l.jsx)(r.EuiComboBox,{"aria-label":Ht,compressed:!0,"data-test-subj":d.a.CONVERSATIONS_MULTISELECTOR,isDisabled:t,fullWidth:!0,options:s,selectedOptions:o,onChange:c})})));Wt.displayName="ConversationMultiSelector";const Kt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."}),Yt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.deletePromptTitle",{defaultMessage:"Delete System Prompt"}),Xt=g.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.customOptionText",{defaultMessage:"Create new System Prompt named"});var Jt={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},Zt={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},en={name:"qhxz92",styles:"max-width:100%"},tn={name:"1e5733u",styles:"width:calc(100% - 60px)"};const nn=i.a.memo((({autoFocus:e=!1,systemPrompts:t,onSystemPromptDeleted:n,onSystemPromptSelectionChange:i,selectedSystemPrompt:s})=>{const[o,u]=Object(a.useState)(t.map((e=>{var t,n;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t,isNewConversationDefault:null!==(n=e.isNewConversationDefault)&&void 0!==n&&n},label:e.name,"data-test-subj":`${d.a.SYSTEM_PROMPT_SELECTOR}-${e.id}`}}))),c=Object(a.useMemo)((()=>{var e,t;return s?[{value:{isDefault:null!==(e=s.isDefault)&&void 0!==e&&e,isNewConversationDefault:null!==(t=s.isNewConversationDefault)&&void 0!==t&&t},label:s.name}]:[]}),[s]),m=Object(a.useCallback)((e=>{var n,a;const r=0===e.length?void 0:null!==(n=t.find((t=>{var n;return t.name===(null===(n=e[0])||void 0===n?void 0:n.label)})))&&void 0!==n?n:null===(a=e[0])||void 0===a?void 0:a.label;i(r)}),[i,t]),p=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||u([...o,a]),m([a])}),[m,o]),f=Object(a.useCallback)((e=>{0===e.length?m([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&m(e)}),[m,o]),b=Object(a.useCallback)((e=>{var t;u(o.filter((t=>t.label!==e))),(null==c||null===(t=c[0])||void 0===t?void 0:t.label)===e&&m([]),n(e)}),[m,n,o,c]);return Object(l.jsx)(r.EuiComboBox,{"aria-label":Kt,className:"systemPromptSelector",compressed:!0,"data-test-subj":d.a.SYSTEM_PROMPT_SELECTOR,fullWidth:!0,placeholder:Kt,customOptionText:`${Xt} {searchValue}`,singleSelection:{asPlainText:!0},options:o,selectedOptions:c,onChange:f,onCreateOption:p,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween","data-test-subj":"systemPromptOptionSelector"},Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span",css:tn},Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",component:"span",gutterSize:"s"},Object(l.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:en},Object(l.jsx)(r.EuiHighlight,{search:t,css:Zt},a)),(null==i?void 0:i.isNewConversationDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(r.EuiToolTip,{position:"right",content:Gt},Object(l.jsx)(r.EuiIcon,{type:"starFilled"}))))),!(null!=i&&i.isDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(r.EuiToolTip,{position:"right",content:Yt},Object(l.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":Yt,color:"danger","data-test-subj":"delete-prompt",onClick:e=>{e.stopPropagation(),b(a)},css:Jt}))))},autoFocus:e})}));nn.displayName="SystemPromptSelector";var an={name:"xpz1vu",styles:"min-height:150px"};const rn=i.a.memo((({conversationSettings:e,onSelectedSystemPromptChange:t,selectedSystemPrompt:n,setUpdatedSystemPromptSettings:s,setUpdatedConversationSettings:o,systemPromptSettings:u})=>{const c=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.content)&&void 0!==e?e:""}),[null==n?void 0:n.content]),m=Object(a.useCallback)((e=>{null!=n&&s((t=>t.some((e=>e.id===n.id))?t.map((t=>t.id===n.id?{...t,content:e.target.value}:t)):t))}),[n,s]),p=Object(a.useMemo)((()=>Object.values(e)),[e]),f=Object(a.useMemo)((()=>null!=n?Object.values(e).filter((e=>e.apiConfig.defaultSystemPromptId===n.id)):[]),[e,n]),b=Object(a.useCallback)((e=>{const t=e.map((e=>e.id));null!=n&&o((e=>Object(S.keyBy)("id",Object.values(e).map((e=>({...e,apiConfig:{...e.apiConfig,defaultSystemPromptId:t.includes(e.id)?null==n?void 0:n.id:e.apiConfig.defaultSystemPromptId===(null==n?void 0:n.id)?void 0:e.apiConfig.defaultSystemPromptId}}))))))}),[n,o]),g=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.isNewConversationDefault)&&void 0!==e&&e}),[null==n?void 0:n.isNewConversationDefault]),v=Object(a.useCallback)((e=>{const t=e.target.checked;null!=n&&s((e=>e.map((e=>({...e,isNewConversationDefault:n.id===e.id&&t})))))}),[n,s]),y=Object(a.useCallback)((e=>{const n="string"==typeof e?{id:null!=e?e:"",content:"",name:null!=e?e:"",promptType:"system"}:e;null!=n&&s((e=>e.some((e=>e.id===n.id))?e:[...e,n])),t(n)}),[t,s]),h=Object(a.useCallback)((e=>{s((t=>t.filter((t=>t.id!==e))))}),[s]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,Bt)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},qt),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:$t,fullWidth:!0},Object(l.jsx)(nn,{onSystemPromptDeleted:h,onSystemPromptSelectionChange:y,systemPrompts:u,selectedSystemPrompt:n})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:Vt,fullWidth:!0},Object(l.jsx)(r.EuiTextArea,{"data-test-subj":d.a.SYSTEM_PROMPT_MODAL.PROMPT_TEXT,disabled:null==n,onChange:m,placeholder:Ut,value:c,compressed:!0,fullWidth:!0,css:an})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",fullWidth:!0,helpText:Qt,label:Ht},Object(l.jsx)(Wt,{conversations:p,isDisabled:null==n,onConversationSelectionChange:b,selectedConversations:f})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed"},Object(l.jsx)(r.EuiCheckbox,{"data-test-subj":d.a.SYSTEM_PROMPT_MODAL.TOGGLE_ALL_DEFAULT_CONVERSATIONS,disabled:null==n,id:"defaultNewConversation",label:Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(l.jsx)(r.EuiFlexItem,null,Gt),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiIcon,{type:g?"starFilled":"starEmpty"}))),checked:g,onChange:v,compressed:!0})))}));rn.displayName="SystemPromptSettings";const sn=o()(r.EuiModal)`
  width: 800px;
  height: 575px;
`,on="CONVERSATION_TAB",ln="QUICK_PROMPTS_TAB",un="SYSTEM_PROMPTS_TAB",cn="ANONYMIZATION_TAB",dn="KNOWLEDGE_BASE_TAB",mn="EVALUATION_TAB";var pn={name:"1r962iv",styles:"padding:4px"},fn={name:"1tk8yx0",styles:"padding:8px"},bn={name:"zd35ug",styles:"max-height:550px;overflow-y:scroll"},gn={name:"16zl6ct",styles:"position:absolute;top:11px;left:14px"},vn={name:"16zl6ct",styles:"position:absolute;top:11px;left:14px"},yn={name:"57t0bw",styles:"position:relative;transform:rotateY(180deg);top:-7px"},hn={name:"15ag9ng",styles:"position:relative;top:-10px"},jn={name:"18wygtw",styles:"min-inline-size:unset!important;max-width:104px"};const En=i.a.memo((({defaultConnectorId:e,defaultProvider:t,onClose:n,onSave:s,selectedConversation:o,setSelectedConversationId:m})=>{const{modelEvaluatorEnabled:p,http:f,selectedSettingsTab:b,setSelectedSettingsTab:g}=Object(c.b)(),{conversationSettings:v,defaultAllow:y,defaultAllowReplacement:h,knowledgeBase:j,quickPromptSettings:O,systemPromptSettings:x,setUpdatedConversationSettings:S,setUpdatedDefaultAllow:k,setUpdatedDefaultAllowReplacement:w,setUpdatedKnowledgeBaseSettings:C,setUpdatedQuickPromptSettings:T,setUpdatedSystemPromptSettings:M,saveSettings:I}=(()=>{const{allQuickPrompts:e,allSystemPrompts:t,conversations:n,defaultAllow:i,defaultAllowReplacement:r,knowledgeBase:s,setAllQuickPrompts:o,setAllSystemPrompts:l,setConversations:u,setDefaultAllow:d,setDefaultAllowReplacement:m,setKnowledgeBase:p}=Object(c.b)(),[f,b]=Object(a.useState)(n),[g,v]=Object(a.useState)(e),[y,h]=Object(a.useState)(t),[j,E]=Object(a.useState)(i),[O,x]=Object(a.useState)(r),[S,k]=Object(a.useState)(s),w=Object(a.useCallback)((()=>{b(n),v(e),k(s),h(t),E(i),x(r)}),[e,t,n,i,r,s]),C=Object(a.useCallback)((()=>{o(g),l(y),u(f),p(S),d(j),m(O)}),[o,l,u,d,m,p,f,j,O,S,g,y]);return{conversationSettings:f,defaultAllow:j,defaultAllowReplacement:O,knowledgeBase:S,quickPromptSettings:g,resetSettings:w,systemPromptSettings:y,saveSettings:C,setUpdatedDefaultAllow:E,setUpdatedDefaultAllowReplacement:x,setUpdatedConversationSettings:b,setUpdatedKnowledgeBaseSettings:k,setUpdatedQuickPromptSettings:v,setUpdatedSystemPromptSettings:h}})(),[A,P]=Object(a.useState)((()=>v[o.id])),_=Object(a.useCallback)((e=>{P(e)}),[]);Object(a.useEffect)((()=>{null!=A&&P(v[A.id])}),[v,A]);const[D,F]=Object(a.useState)(),N=Object(a.useCallback)((e=>{F(e)}),[]);Object(a.useEffect)((()=>{null!=D&&F(O.find((e=>e.title===D.title)))}),[O,D]);const[R,z]=Object(a.useState)(),L=Object(a.useCallback)((e=>{z(e)}),[]);Object(a.useEffect)((()=>{null!=R&&z(x.find((e=>e.id===R.id)))}),[R,x]);const B=Object(a.useCallback)((()=>{const e=null==v[o.id],t=Object.keys(v)[0];e&&null!=t&&m(v[t].id),I(),s()}),[v,o.id,s,I,m]);return Object(l.jsx)(sn,{"data-test-subj":d.a.SETTINGS_MODAL,onClose:n},Object(l.jsx)(r.EuiPage,{paddingSize:"none"},Object(l.jsx)(r.EuiPageSidebar,{paddingSize:"xs",css:jn},Object(l.jsx)(r.EuiKeyPadMenu,null,Object(l.jsx)(r.EuiKeyPadMenuItem,{id:on,label:u.c,isSelected:b===on,onClick:()=>g(on),"data-test-subj":`${on}-button`},Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"xl",css:hn}),Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"l",css:yn}))),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:ln,label:u.f,isSelected:b===ln,onClick:()=>g(ln),"data-test-subj":`${ln}-button`},Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"xxl"}),Object(l.jsx)(r.EuiIcon,{type:"bolt",size:"s",color:"warning",css:vn}))),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:un,label:u.k,isSelected:b===un,onClick:()=>g(un),"data-test-subj":`${un}-button`},Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"xxl"}),Object(l.jsx)(r.EuiIcon,{type:"storage",size:"s",color:"success",css:gn})),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:cn,label:u.a,isSelected:b===cn,onClick:()=>g(cn),"data-test-subj":`${cn}-button`},Object(l.jsx)(r.EuiIcon,{type:"eyeClosed",size:"l"})),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:dn,label:u.e,isSelected:b===dn,onClick:()=>g(dn),"data-test-subj":`${dn}-button`},Object(l.jsx)(r.EuiIcon,{type:"notebookApp",size:"l"})),p&&Object(l.jsx)(r.EuiKeyPadMenuItem,{id:mn,label:u.d,isSelected:b===mn,onClick:()=>g(mn),"data-test-subj":`${mn}-button`},Object(l.jsx)(r.EuiIcon,{type:"crossClusterReplicationApp",size:"l"})))),Object(l.jsx)(r.EuiPageBody,{paddingSize:"none",panelled:!0},Object(l.jsx)(r.EuiSplitPanel.Outer,{grow:!0},Object(l.jsx)(r.EuiSplitPanel.Inner,{className:"eui-scrollBar",grow:!0,css:bn},b===on&&Object(l.jsx)(K,{defaultConnectorId:e,defaultProvider:t,conversationSettings:v,setUpdatedConversationSettings:S,allSystemPrompts:x,selectedConversation:A,isDisabled:null==A,onSelectedConversationChange:_,http:f}),b===ln&&Object(l.jsx)(Lt,{quickPromptSettings:O,onSelectedQuickPromptChange:N,selectedQuickPrompt:D,setUpdatedQuickPromptSettings:T}),b===un&&Object(l.jsx)(rn,{conversationSettings:v,systemPromptSettings:x,onSelectedSystemPromptChange:L,selectedSystemPrompt:R,setUpdatedConversationSettings:S,setUpdatedSystemPromptSettings:M}),b===cn&&Object(l.jsx)(E,{defaultAllow:y,defaultAllowReplacement:h,pageSize:5,setUpdatedDefaultAllow:k,setUpdatedDefaultAllowReplacement:w}),b===dn&&Object(l.jsx)(yt,{knowledgeBase:j,setUpdatedKnowledgeBaseSettings:C}),b===mn&&Object(l.jsx)(qe,null)),Object(l.jsx)(r.EuiSplitPanel.Inner,{grow:!1,color:"subdued",css:fn},Object(l.jsx)(r.EuiModalFooter,{css:pn},Object(l.jsx)(r.EuiButtonEmpty,{size:"s","data-test-subj":"cancel-button",onClick:n},u.b),Object(l.jsx)(r.EuiButton,{size:"s",type:"submit","data-test-subj":"save-button",onClick:B,fill:!0},u.g)))))))}));En.displayName="AssistantSettings"},function(e,t,n){"use strict";n.d(t,"a",(function(){return R})),n.d(t,"b",(function(){return z})),n.d(t,"c",(function(){return L})),n.d(t,"d",(function(){return B}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(5),l=n(17),u=n(47),c=n(44),d=n.n(c),m=n(59),p=n.n(m),f=n(115);const b=d()(l.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-n74boe-0"})(["&.full-height,.full-height{height:100%;}.is-not-scrollable{overflow:hidden;}.is-scrollable{overflow:auto;}"]),g=Object(r.memo)((({pageTitle:e,pageDescription:t,pageBody:n,actions:a,headerHasBottomBorder:i,restrictWidth:o,paddingSize:u="l",scrollableBody:c=!1,headerBackComponent:d,children:m,"data-test-subj":g})=>{const v=!(e||t||a||d),y=Object(f.a)(g),h=Object(r.useMemo)((()=>Array.isArray(a)?a:a?[a]:void 0),[a]),j=Object(r.useMemo)((()=>({gutterSize:"s"})),[]),E=Object(r.useMemo)((()=>p()({"is-scrollable":c,"is-not-scrollable":!c,"full-height":!0})),[c]),O=Object(r.useMemo)((()=>v?null:s.a.createElement(l.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart",wrap:!1,responsive:!1},d&&s.a.createElement(l.EuiFlexItem,{grow:!1},d),s.a.createElement(l.EuiSpacer,{size:"m"}),s.a.createElement(l.EuiFlexItem,{grow:!1},s.a.createElement(l.EuiTitle,{size:"l"},s.a.createElement("span",{"data-test-subj":y("titleHolder")},e))))),[y,d,v,e]);return s.a.createElement(b,{hasShadow:!1,paddingSize:u,"data-test-subj":g,className:"full-height",color:"transparent"},s.a.createElement(l.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"none",className:"full-height","data-test-subj":y("root")},!v&&s.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":y("headerContainer")},s.a.createElement(l.EuiPageHeader,{pageTitle:O,description:t,bottomBorder:i,rightSideItems:h,rightSideGroupProps:j,restrictWidth:o,alignItems:"bottom","data-test-subj":y("header")}),s.a.createElement(l.EuiSpacer,{size:"l"})),s.a.createElement(l.EuiFlexItem,{grow:!1},n),s.a.createElement(l.EuiFlexItem,{grow:!0,className:E,"data-test-subj":y("consoleBody")},s.a.createElement("div",{role:"main",className:"full-height"},m))))}));g.displayName="PageLayout";var v=n(49),y=n(152),h=n(189),j=n(214);const E=d.a.div.withConfig({displayName:"OverlayRootContainer",componentId:"sc-vostrz-0"})(["border:none;display:block;position:fixed;overflow:hidden;top:var(--euiFixedHeadersOffset,0);bottom:0;right:0;height:calc(100% - var(--euiFixedHeadersOffset,0));width:100%;z-index:",";background-color:",";&.scrolling{overflow:auto;}&.hidden{display:none;}&.padding-xs{padding:",";}&.padding-s{padding:",";}&.padding-m{padding:",";}&.padding-l{padding:",";}&.padding-xl{padding:",";}&.fullScreen{top:0;height:100%;}.fullHeight{height:100%;}"],(({theme:{eui:e}})=>e.euiZFlyout),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeM),(({theme:{eui:e}})=>e.euiSizeL),(({theme:{eui:e}})=>e.euiSizeXL)),O="securitySolution-pageOverlay",x=`${O}-isVisible`,S=`${O}-lock`,k=`${O}-fullScreen`,w=`${O}-overSecuritySolutionPageWrapper`,C=Object(c.createGlobalStyle)(["body.","{overflow:hidden;}body.","{","}"],S,k,j.e),T=()=>{document.body.classList.remove(x)},M=()=>{document.body.classList.remove(S)},I=()=>{document.body.classList.remove(k)},A=()=>{document.body.classList.remove(w)},P=Object(r.memo)((({children:e,onHide:t,isHidden:n=!1,enableScrolling:a=!0,hideOnUrlPathnameChange:i=!0,lockDocumentBody:o=!0,appendAsBodyLastNode:u=!0,paddingSize:c,zIndex:d,"data-test-subj":m})=>{const{pathname:f}=Object(v.useLocation)(),b=Object(y.b)(),g=Object(h.b)(),[j,P]=Object(r.useState)(null),_=Object(r.useRef)(),D=Object(r.useCallback)((e=>{_.current=e}),[]),F=Object(r.useMemo)((()=>{const e={};return d&&(e.zIndex=d),e}),[d]),N=Object(r.useMemo)((()=>p()({[O]:!0,scrolling:a,hidden:n,fullScreen:g,"eui-scrollBar":a,"padding-xs":"xs"===c,"padding-s":"s"===c,"padding-m":"m"===c,"padding-l":"l"===c,"padding-xl":"xl"===c})),[a,n,c,g]);return Object(r.useEffect)((()=>{b()&&P((e=>n?null:e||(u&&_.current&&document.body.appendChild(_.current),f)))}),[u,n,b,f]),Object(r.useEffect)((()=>{b()&&i&&!n&&j&&j!==f&&t()}),[i,n,b,t,j,f]),Object(r.useEffect)((()=>{if(b()){const e=Boolean(document.querySelector(".securitySolutionWrapper"));n?(T(),M(),I(),A()):(document.body.classList.add(x),o&&document.body.classList.add(S),g&&document.body.classList.add(k),e&&document.body.classList.add(w))}return()=>{M(),T(),I(),A()}}),[n,b,o,g]),s.a.createElement(l.EuiPortal,{portalRef:D},s.a.createElement(E,{"data-test-subj":m,className:N,style:F},s.a.createElement(l.EuiFocusTrap,{"data-test-subj":"trap-focus",className:"fullHeight"},e)),s.a.createElement(C,null))}));P.displayName="PageOverlay";const _=o.i18n.translate("xpack.securitySolution.consolePageOverlay.backButtonLabel",{defaultMessage:"Back"}),D=Object(r.memo)((({console:e,onHide:t,isHidden:n,body:a,actions:i,pageTitle:o="",showCloseButton:c=!1})=>{const d=Object(f.a)("consolePageOverlay"),m=Object(r.useCallback)((e=>{e.preventDefault(),t()}),[t]),p=Object(r.useMemo)((()=>n?{}:{pageTitle:o,pageBody:a,headerHasBottomBorder:!1,"data-test-subj":d("layout"),headerBackComponent:s.a.createElement(l.EuiButtonEmpty,{flush:"left",size:"s",iconType:"arrowLeft",onClick:m,"data-test-subj":d("header-back-link")},_),actions:c?[s.a.createElement(l.EuiButton,{fill:!0,onClick:m,minWidth:"auto","data-test-subj":d("doneButton")},s.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.consolePageOverlay.doneButtonLabel",defaultMessage:"Done"})),...null!=i?i:[]]:[...null!=i?i:[]]}),[i,a,d,m,n,o,c]);return s.a.createElement(P,{isHidden:n,"data-test-subj":"consolePageOverlay",onHide:t,paddingSize:"l",enableScrolling:!1},s.a.createElement(g,p,e))}));D.displayName="ConsolePageOverlay";var F=n(685);const N=s.a.createContext(void 0),R=Object(r.memo)((({storage:e={},children:t})=>{const[n,a]=Object(r.useState)(e),[o]=Object(r.useState)(new Map),l=Object(r.useRef)();l.current=n;const u=Object(r.useCallback)((e=>{var t;if(null===(t=l.current)||void 0===t||!t[e])throw new Error(`Console with id ${e} not found`)}),[]),c=Object(r.useCallback)((e=>{u(e),a((t=>{const n={...t};return Object.entries(n).forEach((([e,t])=>{t.isOpen&&(n[e]={...t,isOpen:!1})})),n[e]={...n[e],isOpen:!0},n}))}),[u]),d=Object(r.useCallback)((e=>{u(e),a((t=>({...t,[e]:{...t[e],isOpen:!1}})))}),[u]),m=Object(r.useCallback)((e=>{u(e),a((t=>{const n={...t};return delete n[e],n}))}),[u]),p=Object(r.useCallback)((e=>{var t;if(null!==(t=l.current)&&void 0!==t&&t[e])return l.current[e].client}),[]),f=Object(r.useCallback)((()=>Object.values(n).map((e=>e.client))),[n]),b=Object(r.useCallback)((e=>{var t;return!(null===(t=l.current)||void 0===t||!t[e])&&l.current[e].isOpen}),[]),g=Object(r.useCallback)((({id:e,meta:t,consoleProps:r,...o})=>{if(n[e])throw new Error(`Console with id ${e} already registered`);const l=Symbol(e),u=c.bind(null,e),p=d.bind(null,e),f=m.bind(null,e),g=b.bind(null,e),v={PageBodyComponent:void 0,PageTitleComponent:void 0,ActionComponents:void 0,...o,client:{id:e,meta:t,show:()=>{setTimeout(u,0)},hide:()=>{setTimeout(p,0)},terminate:()=>{setTimeout(f,0)},isVisible:()=>g()},consoleProps:r,console:s.a.createElement(F.a,i()({},r,{managedKey:l,key:e})),isOpen:!1,key:l};return a((t=>({...t,[e]:v}))),v.client}),[n,d,b,c,m]),v=Object(r.useMemo)((()=>({register:g,show:c,hide:d,terminate:m,getOne:p,getList:f})),[f,p,d,g,c,m]),y=Object(r.useMemo)((()=>({client:v,internal:{getManagedConsole:e=>Object.values(n).find((t=>t.key===e)),getManagedConsoleState:e=>o.get(e),storeManagedConsoleState(e,t){o.set(e,t)}}})),[v,o,n]),h=Object(r.useMemo)((()=>Object.values(n).find((e=>e.isOpen))),[n]),j=Object(r.useMemo)((()=>{var e;return null!==(e=null==h?void 0:h.client.meta)&&void 0!==e?e:{}}),[null==h?void 0:h.client.meta]),E=Object(r.useCallback)((()=>{h&&v.hide(h.client.id)}),[v,h]);return s.a.createElement(N.Provider,{value:y},t,h&&s.a.createElement(D,{onHide:E,console:s.a.createElement(F.a,i()({},h.consoleProps,{managedKey:h.key,key:h.client.id})),isHidden:!h,pageTitle:h.PageTitleComponent&&s.a.createElement(h.PageTitleComponent,{meta:j}),body:h.PageBodyComponent&&s.a.createElement(h.PageBodyComponent,{meta:j}),actions:h.ActionComponents&&h.ActionComponents.map((e=>s.a.createElement(e,{meta:j}))),showCloseButton:h.showCloseButton}))}));R.displayName="ConsoleManager";const z=()=>{const e=Object(r.useContext)(N);if(!e)throw new Error("ConsoleManagerContext not found");return e.client},L=e=>{const t=Object(r.useContext)(N);if(e&&t)return t.internal.getManagedConsole(e)},B=e=>{const t=Object(r.useContext)(N);return Object(r.useMemo)((()=>e&&t?[()=>t.internal.getManagedConsoleState(e),n=>{t.internal.getManagedConsole(e)&&t.internal.storeManagedConsoleState(e,n)}]:[void 0,void 0]),[t,e])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(135);const r=()=>{const[e,t]=Object(a.useState)({isAuthenticated:null,hasEncryptionKey:null,hasIndexManage:null,hasIndexRead:null,hasIndexWrite:null,hasIndexUpdateDelete:null,hasIndexMaintenance:null,hasKibanaCRUD:!1,hasKibanaREAD:!1}),{detectionEnginePrivileges:n,kibanaSecuritySolutionsPrivileges:{crud:r,read:s}}=Object(i.a)();return Object(a.useEffect)((()=>{null!=n.error&&t({isAuthenticated:!1,hasEncryptionKey:!1,hasIndexManage:!1,hasIndexRead:!1,hasIndexWrite:!1,hasIndexUpdateDelete:!1,hasIndexMaintenance:!1,hasKibanaCRUD:r,hasKibanaREAD:s})}),[n.error,r,s]),Object(a.useEffect)((()=>{if(null!=n.result){const e=n.result;if(null!=e.index&&Object.keys(e.index).length>0){const n=Object.keys(e.index)[0];t({isAuthenticated:e.is_authenticated,hasEncryptionKey:e.has_encryption_key,hasIndexManage:e.index[n].manage&&e.cluster.manage,hasIndexMaintenance:e.index[n].maintenance,hasIndexRead:e.index[n].read,hasIndexWrite:e.index[n].create||e.index[n].create_doc||e.index[n].index||e.index[n].write,hasIndexUpdateDelete:e.index[n].write,hasKibanaCRUD:r,hasKibanaREAD:s})}}}),[n.result,r,s]),{loading:n.loading,...e}}},,function(e,t,n){"use strict";var a=n(362);n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return a.c}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"i",(function(){return g})),n.d(t,"e",(function(){return v})),n.d(t,"g",(function(){return y})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return j})),n.d(t,"d",(function(){return E})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return x}));var a=n(62),i=n(17),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(4),c=n(110);const d="100%",m=l.a.div.withConfig({displayName:"WrappedByAutoSizerComponent",componentId:"sc-1gxuxf9-0"})([""," position:relative;&:hover{z-index:100;}"],(e=>`\n    height: ${null!=e.height?e.height:d};\n  `));m.displayName="WrappedByAutoSizer";const p=s.a.memo(m);let f;!function(e){e.BAR="bar",e.AREA="area",e.LINE="line"}(f||(f={}));const b={chartMargins:{left:0,right:0,top:4,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.05}},g=()=>({baseTheme:Object(c.n)(u.C)?a.DARK_THEME:a.LIGHT_THEME,theme:b}),v={rotation:0,rendering:"canvas",showLegend:!1,showLegendExtra:!1,debug:!1,legendPosition:a.Position.Bottom},y=(e,t)=>{const n=e||t;return n?`${n}px`:d},h=(e,t)=>{const n=e||t;return n?`${n}px`:"100%"},j=e=>Array.isArray(e)&&e.every((e=>Array.isArray(e.value)&&e.value.every((({y:e})=>0===e)))),E=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1gxuxf9-1"})(["position:relative;"]),O=l()(i.EuiFlexGroup).withConfig({displayName:"ChartWrapper",componentId:"sc-1gxuxf9-2"})(["z-index:0;"]),x=l()(i.EuiFlexGroup).withConfig({displayName:"BarChartWrapper",componentId:"sc-1gxuxf9-3"})(["z-index:0;padding-right:20px;"])},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return c}));var a=n(5);let i,r;!function(e){e.rules="rules",e.alertsCases="alertsCases"}(i||(i={})),function(e){e[e.none=0]="none",e[e.pointToAlertName=1]="pointToAlertName",e[e.expandEvent=2]="expandEvent",e[e.reviewAlertDetailsFlyout=3]="reviewAlertDetailsFlyout",e[e.addAlertToCase=4]="addAlertToCase",e[e.createCase=5]="createCase",e[e.submitCase=6]="submitCase",e[e.viewCase=7]="viewCase"}(r||(r={}));const s={minWidth:360,maxWidth:360,offset:10,repositionOnScroll:!0,ownFocus:!0,initialFocus:'[tour-step="nextButton"]'},o=(e,t)=>`tourStepAnchor-${t}-${e}`,l=[{...s,step:r.pointToAlertName,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourTitle",{defaultMessage:"Examine the Alerts Table"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourContent",{defaultMessage:"To help you practice triaging alerts, here is the alert from the rule that we enabled in the previous step."}),anchorPosition:"downCenter",dataTestSubj:o(r.pointToAlertName,i.alertsCases),initialFocus:'button[tour-step="nextButton"]'},{...s,step:r.expandEvent,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourTitle",{defaultMessage:"Review the alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourContent",{defaultMessage:"Some information is provided at-a-glance in the table, but for full details, you'll want to open the alert."}),anchorPosition:"rightUp",dataTestSubj:o(r.expandEvent,i.alertsCases)},{...s,step:r.reviewAlertDetailsFlyout,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourTitle",{defaultMessage:"Explore alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourContent",{defaultMessage:"Learn more about alerts by checking out all the information available."}),anchor:`[tour-step="${o(r.reviewAlertDetailsFlyout,i.alertsCases)}"] span.euiTab__content`,offset:20,anchorPosition:"leftUp",dataTestSubj:o(r.reviewAlertDetailsFlyout,i.alertsCases)},{...s,step:r.addAlertToCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourContent",{defaultMessage:'From the Take action menu, select "Add to new case".'}),anchorPosition:"upRight",dataTestSubj:o(r.addAlertToCase,i.alertsCases)},{...s,step:r.createCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourTitle",{defaultMessage:"Add Case details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourContent",{defaultMessage:"Provide the relevant information to create the case. We have included sample text for you."}),anchor:'[tour-step="create-case-flyout"] label',anchorPosition:"leftUp",dataTestSubj:o(r.createCase,i.alertsCases),offset:20,repositionOnScroll:!1},{...s,step:r.submitCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourContent",{defaultMessage:'Press "Create case" to continue.'}),anchor:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]',anchorPosition:"leftUp",hideNextButton:!0,dataTestSubj:o(r.submitCase,i.alertsCases),offset:20,ownFocus:!1,initialFocus:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]'},{...s,step:r.viewCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourTitle",{defaultMessage:"View the case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourContent",{defaultMessage:"Cases are shown under Insights, in the alert details."}),anchorPosition:"rightUp",dataTestSubj:o(r.viewCase,i.alertsCases)}],u={title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.title",{defaultMessage:"This is a test case"}),description:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.description",{defaultMessage:"Add a description and other relevant information. The alert will be added to the case."})},c={[i.rules]:[],[i.alertsCases]:l}},,function(e,t,n){"use strict";e.exports=n(613)},function(e,t,n){"use strict";e.exports=n(619)},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(45);const l=s.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-we8ln-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}",""],(({targetClassNames:e})=>Object(r.css)(["","{pointer-events:none;opacity:0;transition:opacity "," ease;}","{pointer-events:auto;opacity:1;}"],e.map((e=>`.${e}`)).join(", "),(e=>Object(o.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),e.map((e=>`&:hover .${e}`)).join(", ")))),u=i.a.memo((({show:e=!0,targetClassNames:t,children:n})=>e?i.a.createElement(l,{"data-test-subj":"hoverVisibilityContainer",targetClassNames:t},n):i.a.createElement(i.a.Fragment,null,n)));u.displayName="HoverVisibilityContainer"},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m}));var a=n(45),i=n(2),r=n(873),s=n.n(r),o=n(62),l=n(78),u=n.n(l);const c=(e,t)=>{const n=null!=t?t:((e,t)=>{const n=t.diff(e,"days");return n<=1&&!e.isSame(t)?2:n})(u()(e[0]),u()(e[1])),a=Object(o.niceTimeFormatByDay)(n);return Object(o.timeFormatter)(a)},d=(e=100)=>{const[t,n]=Object(i.useState)({width:0,height:0}),r=Object(i.useMemo)((()=>Object(a.throttle)(e,n)),[e]),{ref:o}=s()({onResize:r});return{ref:o,...t}},m=(e,t,n,a)=>{Object(i.useEffect)((()=>{!async function(){const i=await(null==e?void 0:e.getVariation(t,n));i&&a(i)}()}),[e,t,n,a])}},function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return g}));var a=n(2),i=n.n(a),r=n(17),s=n(44),o=n.n(s),l=n(47),u=n(126);const c=({children:e,...t})=>i.a.createElement(r.EuiButton,t,e),d=({children:e,...t})=>i.a.createElement(r.EuiLink,t,e),m=o()("span").withConfig({displayName:"Comma",componentId:"sc-11tqw5g-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);m.displayName="Comma";const p=({children:e,Component:t,dataTestSubj:n,href:a,onClick:r,title:s,iconType:o="expand"})=>t?i.a.createElement(t,{"data-test-subj":n,href:a,iconType:o,onClick:r,title:s},null!=s?s:e):i.a.createElement(c,{"data-test-subj":n,href:a,onClick:r},null!=s?s:e),f=i.a.memo(p),b=o.a.div.withConfig({displayName:"PortContainer",componentId:"sc-11tqw5g-1"})(["& svg{position:relative;top:-1px;}"]),g=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:n,rowItems:s})=>{const[o,u]=Object(a.useState)(!1),c=Object(a.useCallback)((()=>u((e=>!e))),[]),d=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null," ,",i.a.createElement(r.EuiButtonEmpty,{size:"xs",onClick:c},`+${s.length-t} `,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[c,t,s.length]);return i.a.createElement(r.EuiFlexItem,{grow:!1},s.length>t&&i.a.createElement(r.EuiPopover,{id:"popover",button:d,isOpen:o,closePopover:c,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},i.a.createElement(v,{render:n,rowItems:s,moreMaxHeight:e,overflowIndexStart:t})))}));g.displayName="ReputationLinksOverflow";const v=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:n,rowItems:s})=>{const o=Object(a.useMemo)((()=>s.slice(t).map(((e,t)=>{var a;return i.a.createElement(r.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(a=n&&n(e))&&void 0!==a?a:Object(u.a)(e))}))),[t,n,s]);return i.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},i.a.createElement(r.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},o))}));v.displayName="MoreReputationLinksContainer"},,,,,function(e,t,n){"use strict";n.d(t,"g",(function(){return c.a})),n.d(t,"a",(function(){return d.b})),n.d(t,"b",(function(){return d.c})),n.d(t,"c",(function(){return d.d})),n.d(t,"d",(function(){return d.f})),n.d(t,"e",(function(){return m.f})),n.d(t,"f",(function(){return m.g}));var a=n(111),i=n(141);const r=a.z.object({add:a.z.array(i.m),remove:a.z.array(i.m)}),s=a.z.array(i.m).min(1);a.z.object({assignees:r,ids:s});var o=n(46),l=(n(264),n(247)),u=(n(299),n(370),n(273)),c=n(248);n(371),o.exact(o.type({tags:u.b,ids:u.a})),n(481),n(341),n(389);var d=n(191),m=n(290);l.e.and(l.f).and(a.object({invocationCount:a.number(),timeframeEnd:a.string()}));var p=n(120);o.exact(o.partial({query:o.object,aggs:o.object,size:p.m,track_total_hits:o.boolean,_source:o.union([o.boolean,o.string,o.array(o.string)]),fields:o.array(o.string),runtime_mappings:o.unknown,sort:o.object})),o.intersection([o.type({status:u.h}),o.partial({conflicts:u.d,signal_ids:u.f,query:u.g})]);const f=o.partial({requests_per_second:o.number,size:p.n,slices:p.m});o.intersection([o.exact(o.type({index:o.array(o.string)})),o.exact(f)]),o.exact(o.type({migration_ids:o.array(o.string)})),o.exact(o.type({migration_ids:o.array(o.string)}));var b=n(277);o.exact(o.type({from:b.f}))},function(e,t,n){"use strict";n.d(t,"h",(function(){return E})),n.d(t,"i",(function(){return O})),n.d(t,"j",(function(){return x})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"c",(function(){return S})),n.d(t,"f",(function(){return v.a})),n.d(t,"g",(function(){return v.b})),n.d(t,"a",(function(){return k}));var a=n(46),i=n(120);let r,s;!function(e){e.last_hour="last_hour",e.last_day="last_day",e.last_week="last_week",e.last_month="last_month",e.last_year="last_year",e.custom_range="custom_range"}(r||(r={})),function(e){e.minute="minute",e.hour="hour",e.day="day",e.week="week",e.month="month"}(s||(s={}));const o=a.union([a.exact(a.type({type:a.literal(r.last_hour),granularity:a.literal(s.minute)})),a.exact(a.type({type:a.literal(r.last_day),granularity:a.union([a.literal(s.minute),a.literal(s.hour)])})),a.exact(a.type({type:a.literal(r.last_week),granularity:a.union([a.literal(s.hour),a.literal(s.day)])})),a.exact(a.type({type:a.literal(r.last_month),granularity:a.union([a.literal(s.day),a.literal(s.week)])})),a.exact(a.type({type:a.literal(r.last_year),granularity:a.union([a.literal(s.week),a.literal(s.month)])})),a.exact(a.type({type:a.literal(r.custom_range),granularity:a.union([a.literal(s.minute),a.literal(s.hour),a.literal(s.day),a.literal(s.week),a.literal(s.month)]),from:i.g,to:i.g}))]);a.exact(a.partial({interval:o,debug:a.boolean})),a.exact(a.intersection([a.type({rule_id:i.j}),a.partial({interval:o,debug:a.boolean})])),a.exact(a.partial({interval:o,debug:a.boolean})),a.exact(a.type({}));var l=n(111),u=n(182);const c=l.z.enum(["trace","debug","info","warn","error"]),d=c.enum,m=l.z.enum(["message","status-change","execution-metrics"]),p=m.enum,f=l.z.object({timestamp:l.z.string().datetime(),sequence:l.z.number().int(),level:c,type:m,execution_id:l.z.string().min(1),message:l.z.string()});var b=n(248),g=n(370);l.z.object({search_term:l.z.string().optional(),event_types:Object(u.a)(m).optional().default([]),log_levels:Object(u.a)(c).optional().default([]),date_start:l.z.string().datetime().optional(),date_end:l.z.string().datetime().optional(),sort_order:b.a.optional().default("desc"),page:l.z.coerce.number().int().optional().default(1),per_page:l.z.coerce.number().int().optional().default(20)}),l.z.object({ruleId:l.z.string().min(1)}),l.z.object({events:l.z.array(f),pagination:g.a});var v=n(219);const y=l.z.object({execution_uuid:l.z.string(),timestamp:l.z.string().datetime(),duration_ms:l.z.number().int(),status:l.z.string(),message:l.z.string(),num_active_alerts:l.z.number().int(),num_new_alerts:l.z.number().int(),num_recovered_alerts:l.z.number().int(),num_triggered_actions:l.z.number().int(),num_succeeded_actions:l.z.number().int(),num_errored_actions:l.z.number().int(),total_search_duration_ms:l.z.number().int(),es_search_duration_ms:l.z.number().int(),schedule_delay_ms:l.z.number().int(),timed_out:l.z.boolean(),indexing_duration_ms:l.z.number().int(),search_duration_ms:l.z.number().int(),gap_duration_s:l.z.number().int(),security_status:l.z.string(),security_message:l.z.string()}),h=l.z.enum(["timestamp","duration_ms","gap_duration_s","indexing_duration_ms","search_duration_ms","schedule_delay_ms"]);h.enum,l.z.object({start:l.z.string().datetime(),end:l.z.string().datetime(),query_text:l.z.string().optional().default(""),status_filters:Object(u.a)(v.a).optional().default([]),sort_field:h.optional().default("timestamp"),sort_order:b.a.optional().default("desc"),page:l.z.coerce.number().int().optional().default(1),per_page:l.z.coerce.number().int().optional().default(20)}),l.z.object({ruleId:l.z.string().min(1)}),l.z.object({events:l.z.array(y).optional(),total:l.z.number().int().optional()});var j=n(4);j.Db,j.Db,j.Db;const E=`${j.Db}/health/_setup`,O=(j.Db,e=>`${j.Db}/rules/${e}/execution/events`),x=(j.Db,e=>`${j.Db}/rules/${e}/execution/results`);let S;n(364),function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.off="off"}(S||(S={})),n(143),n(363);const k=c.options},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="row-renderer-example"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m}));var a=n(17),i=n(2),r=n.n(i),s=n(47),o=n(113),l=n(151),u=n(516);const c={ACTION_MENU:"timeline-action-menu",DATA_VIEW:"timeline-data-view",DATA_PROVIDER:"toggle-data-provider",SAVE_TIMELINE:"save-timeline-action",ADD_TO_FAVORITES:"add-to-favorites"},d=[{title:u.o,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.newTimeline.description",defaultMessage:"Click {newButton} to create a new Timeline. Click {openButton} to open an existing one.",values:{newButton:r.a.createElement(a.EuiCode,null,u.i),openButton:r.a.createElement(a.EuiCode,null,u.k)}})),anchor:c.ACTION_MENU},{title:u.a,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.addToFavorites.description",defaultMessage:"Click to favorite your Timeline so you can quickly find it later."})),anchor:c.ADD_TO_FAVORITES},{timelineTab:l.g.query,title:u.b,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.changeDataView.description",defaultMessage:"Click the {dataViewButton} menu to choose the event or alert data that you want to display.",values:{dataViewButton:r.a.createElement(a.EuiCode,null," ",u.e)}})),anchor:c.DATA_VIEW},{timelineType:o.l.default,timelineTab:l.g.query,title:u.d,content:r.a.createElement(a.EuiText,null,u.c),anchor:c.DATA_PROVIDER},{title:u.m,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.saveTimeline.description",defaultMessage:"Click {saveButton} to manually save new changes. While saving your Timeline, you can {editButton} its name and description or save it as a new Timeline.",values:{saveButton:r.a.createElement(a.EuiCode,null,u.l),editButton:r.a.createElement(a.EuiCode,null,u.f)}})),anchor:c.SAVE_TIMELINE}],m={currentTourStep:1,isTourActive:!0,tourPopoverWidth:300,tourSubtitle:u.n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.chart.dataAllValuesZerosTitle",{defaultMessage:"All values returned zero"}),r=a.i18n.translate("xpack.securitySolution.chart.dataNotAvailableTitle",{defaultMessage:"Chart Data Not Available"}),s=a.i18n.translate("xpack.securitySolution.chart.emptyValueLabel",{defaultMessage:"empty value"})},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i={ADD_EXCEPTION_FLYOUT:`${a.l} fetchAlerts addExceptionFlyout`,ALERTS_COUNT_BY_STATUS:`${a.l} fetchAlerts byRulebyCount`,ALERTS_GROUPING:`${a.l} fetchAlerts grouping`,BY_ID:`${a.l} fetchAlerts byId`,BY_RULE_BY_STATUS:`${a.l} fetchAlerts byRulebyStatus`,BY_RULE_ID:`${a.l} fetchAlerts byRuleId`,BY_SEVERITY:`${a.l} fetchAlerts bySeverity`,BY_STATUS:`${a.l} fetchAlerts byStatus`,CASES:`${a.l} fetchAlerts cases`,COUNT:`${a.l} fetchAlerts count`,HISTOGRAM:`${a.l} fetchAlerts histogram`,PREVALENCE:`${a.l} fetchAlerts prevalence`,SOC_TRENDS:`${a.l} fetchAlerts socTrends`,TREE_MAP:`${a.l} fetchAlerts treeMap`,VULNERABLE_HOSTS:`${a.l} fetchAlerts vulnerableHosts`,VULNERABLE_USERS:`${a.l} fetchAlerts vulnerableUsers`}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(9),i=n(2),r=n(311),s=n(336);const o=({fetchMethod:e=r.e,query:t,indexName:n,skip:o,queryName:l})=>{const[u,c]=Object(i.useState)(t),[d,m]=Object(i.useState)({data:null,response:"",request:"",setQuery:c,refetch:null}),[p,f]=Object(i.useState)(!1),b=((e,t)=>{const{startTracking:n}=Object(s.a)();return Object(i.useMemo)((()=>async a=>{const{endTracking:i}=n({name:t});let r;try{r=await e(a),i("success")}catch(e){throw i(a.signal.aborted?"aborted":"error"),e}return r}),[e,t,n])})(e,l);return Object(i.useEffect)((()=>{let e=!0;const t=new AbortController,i=async()=>{try{f(!0);const r=await b({query:u,signal:t.signal});var a;e&&m({data:r,response:JSON.stringify(r,null,2),request:JSON.stringify({index:null!==(a=[n])&&void 0!==a?a:[""],body:u},null,2),setQuery:c,refetch:i})}catch(t){e&&m({data:null,response:"",request:"",setQuery:c,refetch:i})}e&&f(!1)};return Object(a.isEmpty)(u)||o||i(),o&&(f(!1),e=!1,t.abort()),()=>{e=!1,t.abort()}}),[u,n,o,b]),{loading:p,...d}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(111),i=n(141);const r=a.z.object({id:a.z.string().optional(),rule_id:i.N.optional(),list_id:a.z.string().min(1).optional(),item_id:a.z.string().min(1).optional(),error:a.z.object({status_code:a.z.number().int().min(400),message:a.z.string()})}).strict()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var a=n(2);t.useFirstMountState=function(){var e=a.useRef(!0);return e.current?(e.current=!1,!0):e.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveHookState=void 0,t.resolveHookState=function(e,t){return"function"==typeof e?e(t):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131).isClient?window:null,r=function(e){return!!e.addEventListener},s=function(e){return!!e.on};t.default=function(e,t,n,o){void 0===n&&(n=i),a.useEffect((function(){if(t&&n)return r(n)?n.addEventListener(e,t,o):s(n)&&n.on(e,t,o),function(){r(n)?n.removeEventListener(e,t,o):s(n)&&n.off(e,t,o)}}),[e,t,n,JSON.stringify(o)])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(256));t.default=function(e){var t=i.useRef(e);t.current=e,r.default((function(){return function(){return t.current()}}))}},function(e,t,n){const a=n(173);e.exports=(e,t,n=!1)=>{if(e instanceof a)return e;try{return new a(e,t)}catch(e){if(!n)return null;throw e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return v}));var a=n(2),i=n.n(a),r=n(11),s=n.n(r),o=n(3),l=n(49),u=n(692),c=n(127),d=n(110),m=n(266);const p={activeStep:0,endTourStep:()=>{},incrementStep:()=>{},isTourShown:()=>!1,setStep:()=>{}},f=Object(a.createContext)(p),b=({children:e})=>{var t,n,r,l;const{guidedOnboarding:c}=Object(d.i)().services,p=s()(null!==(t=null==c||null===(n=c.guidedOnboardingApi)||void 0===n?void 0:n.isGuideStepActive$(u.a,m.b.rules).pipe(Object(o.timeout)(3e4),Object(o.catchError)((e=>Object(o.of)(!1)))))&&void 0!==t?t:Object(o.of)(!1),!1),b=s()(null!==(r=null==c||null===(l=c.guidedOnboardingApi)||void 0===l?void 0:l.isGuideStepActive$(u.a,m.b.alertsCases).pipe(Object(o.timeout)(3e4),Object(o.catchError)((e=>Object(o.of)(!1)))))&&void 0!==r?r:Object(o.of)(!1),!1),g=Object(a.useMemo)((()=>({[m.b.rules]:p,[m.b.alertsCases]:b})),[p,b]),v=Object(a.useCallback)((e=>g[e]),[g]),[y,h]=Object(a.useState)(1),j=Object(a.useCallback)((e=>{h((t=>(t>=m.e[e].length?0:t)+1))}),[]),E=Object(a.useCallback)(((e,t)=>{t<=m.e[e].length&&h(t)}),[]),[O,x]=Object(a.useState)(null);Object(a.useEffect)((()=>{if(!O||null==c||!c.guidedOnboardingApi)return;let e=!1;return(async()=>{var t;await(null==c||null===(t=c.guidedOnboardingApi)||void 0===t?void 0:t.completeGuideStep(u.a,O)),e||(x(null),h(1))})(),()=>{e=!0}}),[O,c]);const S=Object(a.useCallback)((e=>{x(e)}),[]),k=Object(a.useMemo)((()=>({activeStep:y,endTourStep:S,incrementStep:j,isTourShown:v,setStep:E})),[y,S,j,v,E]);return i.a.createElement(f.Provider,{value:k},e)},g=({children:e})=>{const{pathname:t}=Object(l.useLocation)(),n=Object(a.useMemo)((()=>Object(c.isTourPath)(t)?b:f.Provider),[t]);return i.a.createElement(n,{value:p},e)},v=()=>{const e=Object(a.useContext)(f);if(!e)throw new Error("useTourContext can only be called inside of TourContext!");return e}},,,,,,,,,function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(391))},function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=n(315),s=n(314),o=(t=e.exports={}).re=[],l=t.safeRe=[],u=t.src=[],c=t.t={};let d=0;const m="[a-zA-Z0-9-]",p=[["\\s",1],["\\d",r],[m,i]],f=(e,t,n)=>{const a=(e=>{for(const[t,n]of p)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=d++;s(e,i,t),c[e]=i,u[i]=t,o[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(a,n?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${m}*`),f("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${m}+`),f("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),f("FULL",`^${u[c.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),f("LOOSE",`^${u[c.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),f("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),f("COERCE",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?(?:$|[^\\d])`),f("COERCERTL",u[c.COERCE],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u}));var a=n(2),i=n(11),r=n.n(i),s=n(438);const o=e=>{const t=Object(s.b)(),n=r()(t.sections$,t.getSectionsValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},l=e=>{const t=Object(s.b)(),n=r()(t.messages$,t.getMessagesValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},u=e=>{const t=Object(s.b)(),n=Object(a.useMemo)((()=>t.getPageUpselling(e)),[e,t]);return null!=n?n:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return v})),n.d(t,"b",(function(){return y}));var a=n(142),i=n(124),r=n(122),s=n(116),o=n(521);const l=[i.e.alertsOnAlertsPage,i.e.alertsOnRuleDetailsPage,i.e.alertsOnCasePage,r.c.casePage],u=[{value:"all",inputDisplay:o.b,"data-test-subj":"option-all"}],c=[{value:"raw",inputDisplay:o.d,"data-test-subj":"option-raw"}],d=[{value:"alert",inputDisplay:o.a,"data-test-subj":"option-alert"}],m=[...c,...d],p=e=>{switch(e){case"all":return u;case"raw":return c;case"alert":return d;default:return m}},f=e=>!!e&&l.includes(e),b=[a.a,a.b,a.e,a.f,a.g,a.h,a.o,a.r,a.H,a.w,a.K,a.s,a.t,a.Z,a.nb,a.ob,a.rb,a.u,a.x,a.y,a.z,a.A,a.D,a.E,a.F,a.G,a.I,a.J,a.L,a.N,a.O,a.P,a.Q,a.R,a.S,a.T,a.U,a.V,a.v,a.W,a.X,a.Y,a.ib,a.lb,"signal.rule.building_block_type","signal.rule.id","signal.rule.name","signal.rule.threat_mapping","signal.status"],g=({tableId:e,view:t})=>"raw"===t&&f(e),v=({filters:e,tableId:t,view:n})=>g({tableId:t,view:n})?e.filter((e=>!b.includes(`${e.meta.key}`))):e,y=({scopeId:e,view:t})=>g({tableId:e,view:t})?s.SourcererScopeName.default:f(e)?s.SourcererScopeName.detections:e===r.c.active?s.SourcererScopeName.timeline:s.SourcererScopeName.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(48),r=n(128),s=n(167),o=n(117),l=n(112);const u=({id:e,filterQuery:t,kqlError:n,query:u,startDate:c,endDate:d})=>{const{addError:m}=Object(o.a)(),p=Object(i.useDispatch)(),f=Object(a.useMemo)((()=>r.a.errorsSelector()),[]),b=Object(l.a)(f),g=null==n?void 0:n.name,v=null==n?void 0:n.message;Object(a.useEffect)((()=>{if(!t&&v&&g){const t=v.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0).toString();p(s.a.addErrorHash({id:e,hash:t,title:g,message:[v]}))}}),[e,t,m,u,c,d,p,v,g]),Object(a.useEffect)((()=>{const t=b.find((t=>t.id===e));null!=t&&t.displayError&&null!=n&&(delete n.stack,m(n,{title:n.name}))}),[m,b,e,n])}},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(114),r=n(117),s=n(311),o=n(553),l=n(262);const u=()=>{const[e,t]=Object(a.useState)(!0),[n,u]=Object(a.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:null}),{addError:c}=Object(r.a)(),{hasIndexRead:d}=Object(l.a)();return Object(a.useEffect)((()=>{let e=!0;const n=new AbortController,a=async()=>{try{t(!0);const a=await Object(s.h)({signal:n.signal});e&&null!=a&&u({signalIndexExists:!0,signalIndexName:a.name,signalIndexMappingOutdated:a.index_mapping_outdated,createDeSignalIndex:r})}catch(t){e&&(u({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:r}),Object(i.v)(t)&&404!==t.body.status_code&&c(t,{title:o.c}))}e&&t(!1)},r=async()=>{let l=!1;try{t(!0),await Object(s.d)({signal:n.signal}),e&&(l=!0,a())}catch(t){e&&(Object(i.v)(t)&&409===t.body.status_code?a():(u({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:r}),c(t,{title:o.d})))}e&&!l&&t(!1)};return d?a():t(!1),()=>{e=!1,n.abort()}}),[c,d]),{loading:e,...n}}},,function(e,t,n){"use strict";var a=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?u((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function s(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function l(e,t){try{return t in e}catch(e){return!1}}function u(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||s,n.isMergeableObject=n.isMergeableObject||a,n.cloneUnlessOtherwiseSpecified=r;var i=Array.isArray(t);return i===Array.isArray(e)?i?n.arrayMerge(e,t,n):function(e,t,n){var a={};return n.isMergeableObject(e)&&o(e).forEach((function(t){a[t]=r(e[t],n)})),o(t).forEach((function(i){(function(e,t){return l(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(l(e,i)&&n.isMergeableObject(t[i])?a[i]=function(e,t){if(!t.customMerge)return u;var n=t.customMerge(e);return"function"==typeof n?n:u}(i,n)(e[i],t[i],n):a[i]=r(t[i],n))})),a}(e,t,n):r(t,n)}u.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return u(e,n,t)}),{})};var c=u;e.exports=c},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(9);const i=(e,t=!1)=>{if(Array.isArray(e))return e;const n={};return Object.entries(e).forEach((([e,i])=>{const r=t&&Array.isArray(i)&&1===i.length;Object(a.merge)(n,Object(a.setWith)({},e,r?i[0]:i,Object))})),n}},function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(4);const i=`${a.jb}/prepackaged`,r=`${a.Db}/prebuilt_rules`,s=`${i}/_status`,o=`${r}/status`,l=`${r}/upgrade/_review`,u=`${r}/upgrade/_perform`,c=`${r}/installation/_review`,d=`${r}/installation/_perform`},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return y})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return E}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(48),u=n(113),c=n(118),d=n(112),m=n(244),p=n(228),f=n(134),b=n(292);o()(a.EuiBadge).withConfig({displayName:"NotesCountBadge",componentId:"sc-v4xtfs-0"})(["margin-left:5px;"]).displayName="NotesCountBadge";const g=({timelineId:e,compact:t})=>{const n=Object(l.useDispatch)(),s=Object(i.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),o=Object(d.b)((t=>{var n;return(null!==(n=s(t,e))&&void 0!==n?n:f.b).isFavorite})),p=Object(d.b)((t=>{var n;return(null!==(n=s(t,e))&&void 0!==n?n:f.b).status}))===u.k.immutable,g=Object(i.useCallback)((()=>n(c.a.updateIsFavorite({id:e,isFavorite:!o}))),[n,e,o]),v=o?m.j:m.b;return t?r.a.createElement(a.EuiButtonIcon,{id:b.a.ADD_TO_FAVORITES,iconType:o?"starFilled":"starEmpty",iconSize:"m",isSelected:o,onClick:g,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,disabled:p,"aria-label":v,title:v}):r.a.createElement(a.EuiButton,{id:b.a.ADD_TO_FAVORITES,isSelected:o,fill:o,iconType:o?"starFilled":"starEmpty",onClick:g,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,disabled:p,"aria-label":v,title:v},v)};g.displayName="AddToFavoritesButtonComponent";const v=r.a.memo(g),y=r.a.memo((({onClick:e,outline:t=!1,timelineId:n,title:a=m.h})=>{const{getButton:i}=Object(p.b)({timelineId:n,timelineType:u.l.default,onClick:e});return i({outline:t,title:a})}));y.displayName="NewTimeline";const h="notes-button",j=r.a.memo((({ariaLabel:e=m.i,isDisabled:t,toggleShowNotes:n,timelineType:i})=>{const s=i===u.l.template;return r.a.createElement(a.EuiButtonIcon,{"aria-label":e,className:h,"data-test-subj":"timeline-notes-button-small",disabled:t,iconType:"editorComment",onClick:n,size:"s",isDisabled:s})}));j.displayName="SmallNotesButton";const E=r.a.memo((({ariaLabel:e,isDisabled:t,showNotes:n,timelineType:i,toggleShowNotes:s,toolTip:o})=>n?r.a.createElement(j,{ariaLabel:e,isDisabled:t,toggleShowNotes:s,timelineType:i}):r.a.createElement(a.EuiToolTip,{content:o||"","data-test-subj":"timeline-notes-tool-tip"},r.a.createElement(j,{ariaLabel:e,isDisabled:t,toggleShowNotes:s,timelineType:i}))));E.displayName="NotesButton"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Q}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(48),l=n(44),u=n.n(l),c=n(595),d=n(112),m=n(138),p=n(596),f=n(119),b=n(396),g=n(47),v=n(75),y=n(17),h=n(158),j=n(110),E=n(522),O=n(212),x=n(523),S=n(524),k=n(550),w=n(198),C=n(382);const T=({callback:e})=>({id:"openInLens",getDisplayName:e=>w.m,getIconType:e=>"visArea",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},order:0}),M=({callback:e,disabled:t})=>({id:"saveToLibrary",getDisplayName:e=>w.a,getIconType:e=>"save",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:1}),I=({callback:e,disabled:t})=>({id:"addToExistingCase",getDisplayName:e=>w.c,getIconType:e=>"casesApp",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:2}),A=({callback:e,disabled:t})=>({id:"addToNewCase",getDisplayName:e=>w.d,getIconType:e=>"casesApp",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:3}),P=({callback:e,disabled:t})=>({id:"inspect",getDisplayName:e=>C.d,getIconType:e=>"inspect",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:4});var _=n(128),D=n(381),F=n(190),N=n(116),R=n(339);const z=[v.ACTION_CUSTOMIZE_PANEL],L=u.a.div.withConfig({displayName:"LensComponentWrapper",componentId:"sc-1ajgxgj-0"})(["height:",";width:",";"," .embPanel__header{z-index:2;position:absolute;right:0;}.expExpressionRenderer__expression{padding:2px 0 0 0 !important;}.legacyMtrVis__container{padding:0;}"],(({$height:e})=>e?`${e}px`:"auto"),(({width:e})=>null!=e?e:"auto"),(({$addHoverActionsPadding:e})=>e?".embPanel__header { top: -24px; }":"")),B={requests:void 0,responses:void 0,isLoading:!0},q=({applyGlobalQueriesAndFilters:e=!0,extraActions:t,extraOptions:n,getLensAttributes:a,height:i,id:l,inputsModelId:u=f.a.global,inspectTitle:c,lensAttributes:m,onLoad:p,scopeId:b=N.SourcererScopeName.default,stackByField:w,timerange:C,width:q,withActions:V=!0,disableOnClickFilter:U=!1})=>{var H,G,Q,W;const K=Object(r.useMemo)((()=>({height:null!=i?i:"100%",minWidth:"100px",width:null!=q?q:"100%"})),[i,q]),{lens:Y,data:{actions:{createFiltersFromValueClickAction:X}}}=Object(j.i)().services,J=Object(o.useDispatch)(),[Z,ee]=Object(r.useState)(!1),[te,ne]=Object(r.useState)(B),ae=_.d.globalQueryByIdSelector(),{searchSessionId:ie}=Object(d.a)((e=>ae(e,l))),re=Object(E.a)({applyGlobalQueriesAndFilters:e,extraOptions:n,getLensAttributes:a,lensAttributes:m,scopeId:b,stackByField:w,title:""}),se=null==re||null===(H=re.state)||void 0===H||null===(G=H.visualization)||void 0===G?void 0:G.preferredSeriesType,oe="lnsLegacyMetric"!==(null==re?void 0:re.visualizationType)&&"lnsPie"!==(null==re?void 0:re.visualizationType),le=Y.EmbeddableComponent,ue=Object(r.useMemo)((()=>({onInspectActionClicked:()=>{ee(!0)},isDisabled:te.isLoading})),[te.isLoading]),ce=(({attributes:e,extraActions:t,inspectActionProps:n,timeRange:a,withActions:i})=>{const{lens:s}=Object(O.b)().services,{navigateToPrefilledEditor:o}=s,[l,u]=Object(r.useState)(["inspect","addToNewCase","addToExistingCase","saveToLibrary","openInLens"]);Object(r.useEffect)((()=>{!1===i&&u([])}),[i]);const c=Object(r.useCallback)((()=>{a&&e&&o({id:"",timeRange:a,attributes:e},{openInNewTab:!0})}),[e,o,a]),{disabled:d,onAddToExistingCaseClicked:m}=Object(x.a)({lensAttributes:e,timeRange:a}),{onAddToNewCaseClicked:p,disabled:f}=Object(S.a)({timeRange:a,lensAttributes:e}),{openSaveVisualizationFlyout:b,disableVisualizations:g}=Object(k.a)({attributes:e});return Object(r.useMemo)((()=>null==l?void 0:l.reduce(((e,t)=>"inspect"===t&&null!=n?[...e,P({callback:null==n?void 0:n.onInspectActionClicked,disabled:null==n?void 0:n.isDisabled})]:"addToExistingCase"===t?[...e,I({callback:m,disabled:d})]:"addToNewCase"===t?[...e,A({callback:p,disabled:f})]:"openInLens"===t?[...e,T({callback:c})]:"saveToLibrary"===t?[...e,M({callback:b,disabled:g})]:e),[])),[l,n,m,d,p,f,c,b,g]).concat(null!=t?t:[]).map(((e,t,n)=>({...e,order:Math.max(n.length-(1+t),0)})))})({attributes:re,extraActions:t,inspectActionProps:ue,timeRange:C,withActions:V}),de=Object(r.useCallback)((()=>{ee(!1)}),[]),me=Object(r.useCallback)((({range:e})=>{const[t,n]=e;J(Object(h.setAbsoluteRangeDatePicker)({id:u,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[J,u]),pe=Object(r.useMemo)((()=>{var e;const[t,...n]=null!==(e=te.requests)&&void 0!==e?e:[];return{request:t,additionalRequests:n}}),[te.requests]),fe=Object(r.useMemo)((()=>{var e;const[t,...n]=null!==(e=te.responses)&&void 0!==e?e:[];return{response:t,additionalResponses:n}}),[te.responses]),be=Object(r.useCallback)(((e,t)=>{var n;if(!t)return;const a=Object(F.f)(null==t||null===(n=t.requests)||void 0===n?void 0:n.getRequests());ne({requests:a.requests,responses:a.responses,isLoading:e}),null!=p&&p({requests:a.requests,responses:a.responses,isLoading:e})}),[p]),ge=Object(r.useCallback)((()=>async e=>{if(!$(e)||"area"!==se||U)return void e.preventDefault();const[{query:t}]=await X({data:e.data,negate:e.negate}),n=null==t?void 0:t.range["@timestamp"];null!=n&&n.gte&&null!=n&&n.lt&&me({range:[n.gte,n.lt]})}),[X,me,se,U]),ve=Object(r.useMemo)((()=>{var e,t;return null!=(null==re||null===(e=re.state)||void 0===e?void 0:e.adHocDataViews)?Object.values(null==re||null===(t=re.state)||void 0===t?void 0:t.adHocDataViews).reduce(((e,t)=>(null!=(null==t?void 0:t.name)&&e.push(null==t?void 0:t.name),e)),[]):null}),[null==re||null===(Q=re.state)||void 0===Q?void 0:Q.adHocDataViews]);return ie?!re||null!=(null==te?void 0:te.responses)&&0===(null==te||null===(W=te.responses)||void 0===W?void 0:W.length)?s.a.createElement(y.EuiFlexGroup,null,s.a.createElement(y.EuiFlexItem,{grow:1},s.a.createElement(y.EuiEmptyPrompt,{body:s.a.createElement(y.EuiText,{size:"xs"},s.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.lensEmbeddable.NoDataToDisplay.title",defaultMessage:"No data to display"}))})),s.a.createElement(y.EuiFlexItem,{grow:!1},s.a.createElement(R.a,{extraActions:t,getLensAttributes:a,inputId:u,isInspectButtonDisabled:!0,lensAttributes:re,queryId:l,stackByField:w,timerange:C,title:c,withDefaultActions:!1}))):s.a.createElement(s.a.Fragment,null,re&&ie&&s.a.createElement(L,{$height:i,width:q,$addHoverActionsPadding:oe},s.a.createElement(le,{id:l,style:K,timeRange:C,attributes:re,disabledActions:z,onLoad:be,onBrushEnd:me,onFilter:ge,viewMode:v.ViewMode.VIEW,withDefaultActions:!1,extraActions:ce,searchSessionId:ie,showInspector:!1,syncTooltips:!1,syncCursor:!1})),Z&&null!=pe.request&&null!=fe.response&&s.a.createElement(D.a,{adHocDataViews:ve,additionalRequests:pe.additionalRequests,additionalResponses:fe.additionalResponses,closeModal:de,"data-test-subj":"inspect-modal",inputId:u,request:pe.request,response:fe.response,title:c})):null},$=e=>Array.isArray(e.data)&&"column"in e.data[0],V=s.a.memo(q);var U=n(121),H=n(347);const G=e=>{var t,n;const a=Object(o.useDispatch)(),{inputId:u=f.a.global,id:g,isDonut:v,label:y,donutTextWrapperClassName:h,onLoad:j,...E}=e,{session:O,refetchByRestartingSession:x,refetchByDeletingSession:S}=Object(b.a)({inputId:u,queryId:g}),{indicesExist:k}=Object(U.d)(E.scopeId),w=Object(r.useRef)(E.timerange),C=m.d.globalQueryByIdSelector(),{searchSessionId:T}=Object(d.a)((e=>C(e,g))),M=Object(H.a)({visualizationId:g}),I=null!=M&&0!==(null===(t=M[0])||void 0===t||null===(n=t.hits)||void 0===n?void 0:n.total),A=I?Object(l.css)(["top:40%;right:12%;"]):Object(l.css)(["top:66%;right:12%;"]),P=Object(r.useCallback)((({requests:e,responses:t,isLoading:n})=>{a(m.b.setQuery({inputId:u,id:g,searchSessionId:O.current.start(),refetch:x,loading:n,inspect:{dsl:e,response:t}})),"function"==typeof j&&j({requests:e,responses:t,isLoading:n})}),[a,u,g,O,x,j]);return Object(r.useEffect)((()=>{var e,t;(!k&&(null===(e=w.current)||void 0===e?void 0:e.from)!==E.timerange.from||(null===(t=w.current)||void 0===t?void 0:t.to)!==E.timerange.to)&&(w.current=E.timerange,a(m.b.deleteOneQuery({inputId:u,id:g})))}),[a,g,k,u,E.timerange]),Object(r.useEffect)((()=>{T||setTimeout((()=>{a(m.b.setQuery({inputId:u,id:g,searchSessionId:O.current.start(),refetch:I?x:S,loading:!1,inspect:null}))}),200)}),[a,u,g,O,I,x,T,S]),Object(r.useEffect)((()=>()=>{a(m.b.deleteOneQuery({inputId:u,id:g}))}),[a,g,u]),(E.getLensAttributes||E.lensAttributes)&&E.timerange?v?s.a.createElement(p.b,{isChartEmbeddablesEnabled:!0,dataExists:I,label:y,title:I?s.a.createElement(c.a,{count:null===(_=M[0])||void 0===_||null===(D=_.hits)||void 0===D?void 0:D.total}):null,donutTextWrapperClassName:h,donutTextWrapperStyles:A},s.a.createElement(V,i()({},E,{id:g,onLoad:P}))):s.a.createElement(V,i()({},E,{id:g,onLoad:P})):null;var _,D},Q=s.a.memo(G)},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(184);const r=()=>{const{startTransaction:e}=Object(i.b)();return{startTracking:Object(a.useCallback)((({name:t,spanName:n="fetch"})=>{const a=e({name:t,type:"http-request",options:{managed:!1}}),i=null==a?void 0:a.startSpan(n,"http-request",{blocking:!0});return{endTracking:e=>{null==a||a.addLabels({result:e}),null==i||i.end()}}}),[e])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={refetchIntervalInBackground:!1,staleTime:3e5}},function(e,t,n){"use strict";let a,i,r;n.r(t),n.d(t,"NetworkType",(function(){return a})),n.d(t,"NetworkTableType",(function(){return i})),n.d(t,"NetworkDetailsTableType",(function(){return r})),function(e){e.page="page",e.details="details"}(a||(a={})),function(e){e.alerts="alerts",e.dns="dns",e.http="http",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.tls="tls",e.anomalies="anomalies"}(i||(i={})),function(e){e.http="http",e.tls="tls",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.users="users",e.anomalies="anomalies"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(119),u=n(212),c=n(381),d=n(465),m=n(522),p=n(523),f=n(524),b=n(550),g=n(198),v=n(190),y=n(116),h=n(117);const j=o.a.div.withConfig({displayName:"Wrapper",componentId:"sc-9cci34-0"})(["&.viz-actions{position:absolute;top:0;right:0;z-index:1;}&.histogram-viz-actions{padding:",";}"],(({theme:e})=>e.eui.euiSizeS)),E=({applyGlobalQueriesAndFilters:e=!0,className:t,extraActions:n,extraOptions:s,getLensAttributes:o,inputId:E=l.a.global,inspectIndex:O=0,isInspectButtonDisabled:x,isMultipleQuery:S,lensAttributes:k,onCloseInspect:w,queryId:C,timerange:T,title:M,scopeId:I=y.SourcererScopeName.default,stackByField:A,withDefaultActions:P=!0})=>{const{lens:_}=Object(u.b)().services,{canUseEditor:D,navigateToPrefilledEditor:F,SaveModalComponent:N}=_,[R,z]=Object(i.useState)(!1),[L,B]=Object(i.useState)(!1),[q,$]=Object(i.useState)(!1),{addSuccess:V}=Object(h.a)(),U=Object(i.useCallback)((()=>{$(!1),V(g.a)}),[V]),H=Object(i.useCallback)((()=>{$(!1)}),[]),G=D(),Q=Object(i.useCallback)((()=>{z(!R)}),[R]),W=()=>{z(!1)},K=Object(m.a)({applyGlobalQueriesAndFilters:e,extraOptions:s,getLensAttributes:o,lensAttributes:k,scopeId:I,stackByField:A,title:""}),Y=`stat-${C}`,{disabled:X,onAddToExistingCaseClicked:J}=Object(p.a)({onAddToCaseClicked:W,lensAttributes:K,timeRange:T}),{onAddToNewCaseClicked:Z,disabled:ee}=Object(f.a)({onClick:W,timeRange:T,lensAttributes:K}),te=Object(i.useCallback)((()=>{W(),T&&K&&F({id:"",timeRange:T,attributes:K},{openInNewTab:!0})}),[K,F,T]),{openSaveVisualizationFlyout:ne,disableVisualizations:ae}=Object(b.a)({attributes:K}),ie=Object(i.useCallback)((()=>{W(),B(!0)}),[]),re=Object(i.useCallback)((()=>{B(!1),w&&w()}),[w]),{additionalRequests:se,additionalResponses:oe,handleClick:le,handleCloseModal:ue,isButtonDisabled:ce,request:de,response:me}=Object(d.a)({inputId:E,inspectIndex:O,isDisabled:x,multiple:S,onCloseInspect:re,onClick:ie,queryId:C}),pe=Object(i.useMemo)((()=>{var e;const t={};return[...(null!==(e=null==n?void 0:n.map((e=>r.a.createElement(a.EuiContextMenuItem,{icon:null==e?void 0:e.getIconType(t),key:e.id,onClick:()=>e.execute(t),"data-test-subj":`viz-actions-${e.id}`},e.getDisplayName(t)))))&&void 0!==e?e:[])||[],...P?[r.a.createElement(a.EuiContextMenuItem,{icon:"inspect",key:"visualizationActionsInspect",onClick:le,disabled:ce,"data-test-subj":"viz-actions-inspect"},g.k),r.a.createElement(a.EuiContextMenuItem,{disabled:ee,icon:"plusInCircle",key:"visualizationActionsAddToNewCase",onClick:Z,"data-test-subj":"viz-actions-add-to-new-case"},g.d),r.a.createElement(a.EuiContextMenuItem,{disabled:X,"data-test-subj":"viz-actions-add-to-existing-case",icon:"plusInCircle",key:"visualizationActionsAddToExistingCase",onClick:J},g.c),...G?[r.a.createElement(a.EuiContextMenuItem,{icon:"visArea",key:"visualizationActionsSaveVisualization","data-test-subj":"viz-actions-save-visualization",disabled:ae,onClick:ne},g.a)]:[],r.a.createElement(a.EuiContextMenuItem,{icon:"visArea",key:"visualizationActionsOpenInLens","data-test-subj":"viz-actions-open-in-lens",disabled:ae,onClick:te},g.m)]:[]]}),[G,ce,ae,n,le,X,ee,J,Z,te,ne,P]),fe=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonIcon,{"aria-label":g.l,className:v.a,"data-test-subj":Y,iconType:"boxesHorizontal",onClick:Q})),[Y,Q]);return r.a.createElement(j,{className:t},pe.length>0&&r.a.createElement(a.EuiPopover,{button:fe,isOpen:R,closePopover:W,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover","data-test-subj":"viz-actions-popover"},r.a.createElement(a.EuiContextMenuPanel,{"data-test-subj":"viz-actions-panel",size:"s",items:pe})),L&&null!==de&&null!==me&&r.a.createElement(c.a,{additionalRequests:se,additionalResponses:oe,closeModal:ue,inputId:E,request:de,response:me,title:M}),q&&G&&r.a.createElement(N,{initialInput:K,onSave:U,onClose:H}))};E.displayName="VisualizationActionsComponent";const O=r.a.memo(E)},,function(e,t,n){"use strict";n.d(t,"d",(function(){return g.d})),n.d(t,"a",(function(){return g.a})),n.d(t,"f",(function(){return g.f})),n.d(t,"c",(function(){return g.c})),n.d(t,"e",(function(){return g.e})),n.d(t,"b",(function(){return g.b}));var a=n(111);a.z.object({rules_custom_installed:a.z.number().int().min(0),rules_installed:a.z.number().int().min(0),rules_not_installed:a.z.number().int().min(0),rules_not_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_not_installed:a.z.number().int().min(0),timelines_not_updated:a.z.number().int().min(0)}).strict(),a.z.object({rules_installed:a.z.number().int().min(0),rules_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_updated:a.z.number().int().min(0)}).strict();var i=n(46);const r=i.exact(i.type({rule_id:i.string,version:i.number})),s=i.exact(i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(r)})),o=i.exact(i.type({mode:i.literal("ALL_RULES")}));let l;i.union([o,s]),function(e){e.ALREADY_INSTALLED="ALREADY_INSTALLED"}(l||(l={}));var u=n(120);let c;!function(e){e.BASE="BASE",e.CURRENT="CURRENT",e.TARGET="TARGET"}(c||(c={}));const d=Object(u.r)("PickVersionValues",c),m=i.exact(i.intersection([i.type({rule_id:i.string,revision:i.number,version:i.number}),i.partial({pick_version:d})])),p=i.exact(i.intersection([i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(m)}),i.partial({pick_version:d})])),f=i.exact(i.intersection([i.type({mode:i.literal("ALL_RULES")}),i.partial({pick_version:d})]));let b;i.union([f,p]),function(e){e.RULE_UP_TO_DATE="RULE_UP_TO_DATE"}(b||(b={}));var g=n(326),v=n(278);const y=e=>i.intersection([i.exact(i.type(e.required)),i.exact(i.type(Object(v.N)(e.optional)))]);var h=n(273);let j;!function(e){e.index_patterns="index_patterns",e.data_view="data_view"}(j||(j={}));const E=i.exact(i.type({type:i.literal(j.index_patterns),index_patterns:v.g})),O=i.exact(i.type({type:i.literal(j.data_view),data_view_id:v.c})),x=i.union([E,O]);let S;!function(e){e.inline_query="inline_query",e.saved_query="saved_query"}(S||(S={}));const k=i.exact(i.type({type:i.literal(S.inline_query),query:v.w,language:v.i,filters:v.q})),w=i.exact(i.type({type:i.literal(S.saved_query),saved_query_id:h.e})),C=i.union([k,w]),T=i.exact(i.type({query:v.w,language:i.literal("eql"),filters:v.q})),M=i.exact(i.type({query:v.w,language:i.literal("esql")})),I=i.exact(i.type({interval:Object(u.p)({allowedUnits:["s","m","h"]}),lookback:Object(u.p)({allowedUnits:["s","m","h"]})})),A=i.exact(i.type({field_name:v.u})),P=i.exact(i.type({field_name:v.L,fallback_disabled:v.M})),_=i.exact(i.type({timeline_id:v.I,timeline_title:v.J})),D=i.exact(i.type({type:v.b}));var F=n(277);const N=y({required:{rule_id:v.y,version:v.A,meta:v.s,name:v.t,tags:v.z,description:v.o,severity:F.h,severity_mapping:F.i,risk_score:F.a,risk_score_mapping:F.b,references:v.x,false_positives:v.p,threat:v.F,note:v.h,setup:v.E,related_integrations:v.l,required_fields:v.m,author:v.n,license:v.r,rule_schedule:I,actions:F.c,throttle:F.d,exceptions_list:v.e,max_signals:v.j},optional:{rule_name_override:A,timestamp_override:P,timeline_template:_,building_block:D}}),R=y({required:{type:i.literal("query"),kql_query:C},optional:{data_source:x,alert_suppression:v.a}}),z=y({required:{type:i.literal("saved_query"),kql_query:C},optional:{data_source:x,alert_suppression:v.a}}),L=y({required:{type:i.literal("eql"),eql_query:T},optional:{data_source:x,event_category_override:v.d,timestamp_field:v.K,tiebreaker_field:v.H}}),B=y({required:{type:i.literal("esql"),esql_query:M},optional:{}}),q=y({required:{type:i.literal("threat_match"),kql_query:C,threat_query:k,threat_index:F.q,threat_mapping:F.s},optional:{data_source:x,threat_indicator_path:F.r,concurrent_searches:F.j,items_per_search:F.k}}),$=y({required:{type:i.literal("threshold"),kql_query:C,threshold:v.G},optional:{data_source:x}}),V=y({required:{type:i.literal("machine_learning"),machine_learning_job_id:F.l,anomaly_threshold:h.c},optional:{}}),U=y({required:{type:i.literal("new_terms"),kql_query:k,new_terms_fields:v.k,history_window_start:v.f},optional:{data_source:x}});let H,G;i.intersection([N,i.union([R,z,L,B,q,$,V,U])]),n(9),Symbol("MissingVersion"),function(e){e.StockValueNoUpdate="BASE=A, CURRENT=A, TARGET=A",e.StockValueCanUpdate="BASE=A, CURRENT=A, TARGET=B",e.CustomizedValueNoUpdate="BASE=A, CURRENT=B, TARGET=A",e.CustomizedValueSameUpdate="BASE=A, CURRENT=B, TARGET=B",e.CustomizedValueCanUpdate="BASE=A, CURRENT=B, TARGET=C"}(H||(H={})),function(e){e.Current="CURRENT",e.Target="TARGET",e.Merged="MERGED",e.Conflict="CONFLICT"}(G||(G={}))},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(245),i=n(558),r=n(185);const s=e=>`${Object(r.a)(e)}`,o=(e,t,n,s=i.a.flows)=>`/ip/${e}/${t||a.a.source}/${s}${Object(r.a)(n)}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(190),r=n(112),s=n(128);const o=({visualizationId:e})=>{const t=s.d.globalQueryByIdSelector(),{inspect:n}=Object(r.a)((n=>t(n,e)));return Object(a.useMemo)((()=>n?Object(i.g)(null==n?void 0:n.response):null),[n])}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(17),i=n(345),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(61),c=n.n(u),d=n(4),m=n(166),p=n(110),f=n(293),b=n(226);const g=l()(a.EuiFlexItem).withConfig({displayName:"CountFlexItem",componentId:"sc-1yje3m6-0"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeS};`)),v=s.a.memo((({value:e})=>Object(b.a)(e)?s.a.createElement(s.a.Fragment,null,e):s.a.createElement("em",{"data-test-subj":"value-wrapper-empty"},f.c)));v.displayName="ValueWrapper";const y=({legendItem:e})=>{const[t]=Object(p.o)(d.P),{color:n,count:i,dataProviderId:r,field:o,scopeId:l,value:u}=e;return s.a.createElement(a.EuiText,{size:"xs"},s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=n&&s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiHealth,{"data-test-subj":"legend-color",color:n})),s.a.createElement(a.EuiFlexItem,{grow:!0},s.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(m.b,{"data-test-subj":`legend-item-${r}`,field:o,hideTopN:!0,id:r,isDraggable:!1,scopeId:l,value:u},null==e.render?s.a.createElement(v,{value:u}):e.render({field:o,value:u}))),null!=i&&s.a.createElement(g,{"data-test-subj":"legendItemCount",grow:!1},c()(i).format(t))))))};y.displayName="DraggableLegendItemComponent";const h=s.a.memo(y),j=l.a.div.withConfig({displayName:"DraggableLegendContainer",componentId:"sc-94chus-0"})(["height:",";overflow:auto;scrollbar-width:thin;width:100%;@media only screen and (min-width:","){width:165px;}min-width:",";&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({height:e})=>`${e}px`),(({theme:e})=>e.eui.euiBreakpoints.m),(({$minWidth:e})=>`${e}px`),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),E=({className:e,height:t=0,legendItems:n,minWidth:i=165})=>0===n.length?null:s.a.createElement(j,{className:e,"data-test-subj":"draggable-legend",height:0===t?175:t,$minWidth:i},s.a.createElement(a.EuiText,{size:"xs"},s.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},n.map((e=>s.a.createElement(a.EuiFlexItem,{key:e.dataProviderId,grow:!1},s.a.createElement(h,{legendItem:e}),s.a.createElement(a.EuiSpacer,{"data-test-subj":"draggable-legend-spacer",size:"s"})))))));E.displayName="DraggableLegendComponent";const O=s.a.memo(E)},,,,,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return E})),n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return x}));var a=n(65),i=n.n(a),r=n(17),s=n(45),o=n(2),l=n.n(o),u=n(48),c=n(136),d=n.n(c),m=n(581),p=n(4),f=n(118),b=n(110),g=n(181),v=n(119),y=n(361);const h={fill:!1},j=l.a.memo((({duration:e,end:t,fromStr:n,id:a,isLoading:i,kqlQuery:u,policy:c,queries:d,setDuration:m,showUpdateButton:f=!0,start:g,startAutoReload:v,stopAutoReload:y,timelineId:j,toStr:O,updateReduxTime:x,disabled:S,width:k="restricted",compressed:w=!1})=>{const[C,T]=Object(o.useState)([]),M=Object(o.useCallback)((({start:e,end:n})=>{const i=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:r}=x({end:n,id:a,isInvalid:!1,isQuickSelection:i,kql:u,start:e,timelineId:j,hasRangeChanged:!1}),s=E(e),o=i?E(n,{roundUp:!0}):E(n);!d||r||i&&(g!==s||t!==o)||A(d)}),[t,a,u,d,g,j,x]),I=Object(o.useCallback)((({isPaused:t,refreshInterval:i})=>{const r=null!=n&&n.includes("now")||null!=O&&O.includes("now");e!==i&&m({id:a,duration:i}),t&&"interval"===c?y({id:a}):t||"manual"!==c||v({id:a}),d&&!t&&(!r||r&&"now"!==O)&&A(d)}),[n,O,e,c,m,a,y,v,d]),A=e=>{e.forEach((e=>e.refetch&&e.refetch()))},P=Object(o.useCallback)((({start:e,end:t,isInvalid:n})=>{const i=e.includes("now")||t.includes("now");if(!n){x({end:t,id:a,isInvalid:n,isQuickSelection:i,kql:u,start:e,timelineId:j,hasRangeChanged:!0});const r=[{start:e,end:t},...Object(s.take)(9,C.filter((n=>!(n.start===e&&n.end===t))))];T(r)}}),[x,a,u,j,C]),_=null!=O?O:new Date(t).toISOString(),D=null!=n?n:new Date(g).toISOString(),[F]=Object(b.o)(p.W),N=Object(s.isEmpty)(F)?[]:F.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return l.a.createElement(r.EuiSuperDatePicker,{commonlyUsedRanges:N,end:_,isLoading:i,isPaused:"manual"===c,onRefresh:M,onRefreshChange:I,onTimeChange:P,recentlyUsedRanges:C,refreshInterval:e,showUpdateButton:f,start:D,isDisabled:S,width:k,compressed:w,updateButtonProps:h})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),E=(e,t)=>{const n=i.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},O=e=>({end:t,id:n,isQuickSelection:a,kql:i,start:r,timelineId:s,hasRangeChanged:o})=>{const l=E(r);let u=E(t,{roundUp:!0});var c;return a?e(t===r?g.c.setAbsoluteRangeDatePicker({id:n,fromStr:r,toStr:t,from:l,to:u}):g.c.setRelativeRangeDatePicker({id:n,fromStr:r,toStr:t,from:l,to:u})):(u=E(t),e(g.c.setAbsoluteRangeDatePicker({id:n,from:E(r),to:E(t)}))),null!=s&&o&&e(f.a.updateRange({id:s,start:l,end:u})),i&&i.refetch?{kqlHaveBeenUpdated:null!==(c=i.refetch(e))&&void 0!==c&&c}:{kqlHaveBeenUpdated:!1}};j.displayName="SuperDatePickerComponent";const x=Object(u.connect)((()=>{const e=Object(y.a)(),t=Object(y.b)(),n=Object(y.c)(),a=Object(y.d)(),i=Object(y.e)(),r=Object(y.f)(),o=Object(y.g)(),l=Object(y.h)(),u=Object(y.i)(),c=Object(y.j)();return(d,{id:p})=>{const f=Object(s.getOr)({},`inputs.${p}`,d);return{duration:e(f),end:t(f),fromStr:n(f),kind:i(f),policy:o(f),start:u(f),toStr:c(f),isLoading:!1,...Object(m.c)(f)&&(p===v.a.timeline||p===v.a.global)&&{isLoading:a(f),kqlQuery:r(f),queries:l(d,p)}}}}),(e=>({startAutoReload:({id:t})=>e(g.c.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(g.c.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(g.c.setDuration({id:t,duration:n})),updateReduxTime:O(e)})))(j)},function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return b})),n.d(t,"j",(function(){return g})),n.d(t,"d",(function(){return v})),n.d(t,"h",(function(){return y})),n.d(t,"f",(function(){return h}));var a=n(9),i=n(57),r=n(119);const s=e=>e.policy,o=e=>e.timerange,l=e=>e.queries,u=(e,t)=>{const n=e.inputs[t];return Object(a.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>{if(n===r.a.socTrends)return t;const a=e.inputs[n];return[...t,...a.queries]}),n.queries)},c=()=>Object(i.createSelector)(s,(e=>e.kind)),d=()=>Object(i.createSelector)(s,(e=>e.duration)),m=()=>Object(i.createSelector)(o,(e=>e.kind)),p=()=>Object(i.createSelector)(o,(e=>e.from)),f=()=>Object(i.createSelector)(o,(e=>e.to)),b=()=>Object(i.createSelector)(o,(e=>e.fromStr)),g=()=>Object(i.createSelector)(o,(e=>e.toStr)),v=()=>Object(i.createSelector)(l,(e=>e.some((e=>!0===e.loading)))),y=()=>Object(i.createSelector)(u,(e=>e.filter((e=>"kql"!==e.id)))),h=()=>Object(i.createSelector)(l,(e=>e.find((e=>"kql"===e.id))))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return b}));var a=n(111);const i=a.z.enum([".osquery",".endpoint"]),r=i.enum,s=a.z.object({}).catchall(a.z.object({field:a.z.string().optional(),value:a.z.union([a.z.string(),a.z.array(a.z.string())]).optional()})),o=a.z.object({id:a.z.string(),query:a.z.string(),ecs_mapping:s.optional(),version:a.z.string().optional(),platform:a.z.string().optional(),removed:a.z.boolean().optional(),snapshot:a.z.boolean().optional()}),l=a.z.object({query:a.z.string().optional(),ecs_mapping:s.optional(),queries:a.z.array(o).optional(),pack_id:a.z.string().optional(),saved_query_id:a.z.string().optional(),timeout:a.z.number().optional()}),u=a.z.object({query:a.z.string().optional(),ecsMapping:s.optional(),queries:a.z.array(o).optional(),packId:a.z.string().optional(),savedQueryId:a.z.string().optional(),timeout:a.z.number().optional()}),c=a.z.object({action_type_id:a.z.literal(".osquery"),params:l}),d=a.z.object({actionTypeId:a.z.literal(".osquery"),params:u}),m=a.z.object({command:a.z.literal("isolate"),comment:a.z.string().optional()}),p=a.z.object({action_type_id:a.z.literal(".endpoint"),params:m}),f=a.z.object({actionTypeId:a.z.literal(".endpoint"),params:m}),b=a.z.union([c,p]);a.z.union([d,f])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(111),i=n(219),r=n(364);const s=a.z.object({last_execution:a.z.object({date:a.z.string().datetime(),status:i.a,status_order:i.c,message:a.z.string(),metrics:r.a})})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(111);const i=a.z.object({total_search_duration_ms:a.z.number().int().min(0).optional(),total_indexing_duration_ms:a.z.number().int().min(0).optional(),total_enrichment_duration_ms:a.z.number().int().min(0).optional(),execution_gap_duration_s:a.z.number().int().min(0).optional()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(111);const i=a.z.string(),r=a.z.string(),s=a.z.string()},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(111),i=n(141);const r=a.z.array(a.z.object({field:a.z.string(),value:a.z.number().int().min(0)})),s=a.z.number().int().min(1),o=a.z.union([a.z.string(),a.z.array(a.z.string())]),l=a.z.array(a.z.string()),u=a.z.object({field:o,value:s,cardinality:r.optional()}),c=(a.z.object({field:l,value:s,cardinality:r.optional()}),a.z.object({field:l,value:s,cardinality:r}),a.z.object({duration:i.a}))},function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(111),i=n(141);const r=a.z.string(),s=a.z.array(a.z.object({entries:a.z.array(a.z.object({field:i.m,type:a.z.literal("mapping"),value:i.m}))})).min(1),o=a.z.array(a.z.string()),l=a.z.array(a.z.unknown()),u=a.z.string(),c=a.z.number().int().min(1),d=a.z.number().int().min(1)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(111);const i=a.z.number().int().min(0),r=a.z.union([a.z.string(),a.z.array(a.z.string()).min(1)])},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(111),i=n(141);const r=a.z.array(a.z.string()).min(1).max(3),s=i.m},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(111);const i=a.z.number().int().min(1),r=a.z.number().int().min(0),s=a.z.object({page:i,per_page:r,total:a.z.number().int().min(0)})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(111);const i=a.z.object({type:a.z.string(),message:a.z.string(),actionPath:a.z.string(),buttonLabel:a.z.string().optional()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="xs"},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return l}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addSystemPromptTooltip",{defaultMessage:"Add system prompt"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.clearSystemPrompt",{defaultMessage:"Clear system prompt"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.selectASystemPromptPlaceholder",{defaultMessage:"Select a system prompt"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addNewSystemPrompt",{defaultMessage:"Add new system prompt..."}),l=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.emptyPrompt",{defaultMessage:"(empty prompt)"})},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return u}));var a=n(549);const i=e=>{const{response:t,isStream:n,isError:a}=e,i=(new Date).toLocaleString();return e?{role:"assistant",...n?{reader:t}:{content:t},timestamp:i,isError:a,traceData:e.traceData}:{role:"assistant",content:"Error: Response from LLM API is empty or undefined.",timestamp:i,isError:!0}},r=(e,t)=>t?{...e,messages:[...e.messages,...a.a.messages]}:0===e.messages.length||e.messages[e.messages.length-1].content!==a.b[0].content?{...e,messages:[...e.messages,...a.b]}:e,s=e=>1===(null==e?void 0:e.length)?e[0]:void 0,o=e=>{const t=e.match(/```json\n([\s\S]+)\n```/);if(t)try{var n;return null!==(n=JSON.parse(t[1]).action_input)&&void 0!==n?n:e}catch{}return e},l=({alerts:e,alertsIndexPattern:t,allow:n,allowReplacement:a,replacements:i,size:r})=>e?{...t?{alertsIndexPattern:t}:void 0,...n?{allow:n}:void 0,...a?{allowReplacement:a}:void 0,...i?{replacements:i}:void 0,...r?{size:r}:void 0}:{},u=({alerts:e,assistantLangChain:t})=>t||e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){var i=a.useRef(void 0);i.current&&n(t,i.current)||(i.current=t),a.useEffect(e,i.current)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef(!1),i=a.useRef(),r=a.useRef(e),s=a.useCallback((function(){return n.current}),[]),o=a.useCallback((function(){n.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){n.current=!0,r.current()}),t)}),[t]),l=a.useCallback((function(){n.current=null,i.current&&clearTimeout(i.current)}),[]);return a.useEffect((function(){r.current=e}),[e]),a.useEffect((function(){return o(),l}),[t]),[s,l,o]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(18),i=n(110),r=n(4);const s=()=>{var e,t,n,s,o;const l=Object(a.b)().isEnterprise(),u=Object(i.i)().services.application.capabilities,c=!0===(null===(e=u[r.n])||void 0===e?void 0:e["ai-assistant"]),d=!0===(null===(t=u.actions)||void 0===t?void 0:t.show)&&!0===(null===(n=u.actions)||void 0===n?void 0:n.execute);return{hasAssistantPrivilege:c,hasConnectorsAllPrivilege:d&&!0===(null===(s=u.actions)||void 0===s?void 0:s.delete)&&!0===(null===(o=u.actions)||void 0===o?void 0:o.save),hasConnectorsReadPrivilege:d,isAssistantEnabled:l}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=(a=n(2))&&"object"==typeof a&&"default"in a?a:{default:a},r=e=>"checkbox"===e.type,s=e=>e instanceof Date,o=e=>null==e;const l=e=>"object"==typeof e;var u=e=>!o(e)&&!Array.isArray(e)&&l(e)&&!s(e),c=e=>u(e)&&e.target?r(e.target)?e.target.checked:e.target.value:e,d=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),m="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function p(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(m&&(e instanceof Blob||e instanceof FileList)||!n&&!u(e))return e;if(t=n?[]:{},n||(e=>{const t=e.constructor&&e.constructor.prototype;return u(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)e.hasOwnProperty(n)&&(t[n]=p(e[n]));else t=e}return t}var f=e=>Array.isArray(e)?e.filter(Boolean):[],b=e=>void 0===e,g=(e,t,n)=>{if(!t||!u(e))return n;const a=f(t.split(/[,[\].]+?/)).reduce(((e,t)=>o(e)?e:e[t]),e);return b(a)||a===e?b(e[t])?n:e[t]:a};const v="blur",y="focusout",h="change",j="onChange",E="onSubmit",O="all",x="pattern",S="required",k=i.default.createContext(null),w=()=>i.default.useContext(k);var C=(e,t,n,a=!0)=>{const i={defaultValues:t._defaultValues};for(const r in e)Object.defineProperty(i,r,{get:()=>{const i=r;return t._proxyFormState[i]!==O&&(t._proxyFormState[i]=!a||O),n&&(n[i]=!0),e[i]}});return i},T=e=>u(e)&&!Object.keys(e).length,M=(e,t,n,a)=>{n(e);const{name:i,...r}=e;return T(r)||Object.keys(r).length>=Object.keys(t).length||Object.keys(r).find((e=>t[e]===(!a||O)))},I=e=>Array.isArray(e)?e:[e],A=(e,t,n)=>n&&t?e===t:!e||!t||e===t||I(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function P(e){const t=i.default.useRef(e);t.current=e,i.default.useEffect((()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}}),[e.disabled])}function _(e){const t=w(),{control:n=t.control,disabled:a,name:r,exact:s}=e||{},[o,l]=i.default.useState(n._formState),u=i.default.useRef(!0),c=i.default.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=i.default.useRef(r);return d.current=r,P({disabled:a,next:e=>u.current&&A(d.current,e.name,s)&&M(e,c.current,n._updateFormState)&&l({...n._formState,...e}),subject:n._subjects.state}),i.default.useEffect((()=>(u.current=!0,c.current.isValid&&n._updateValid(!0),()=>{u.current=!1})),[n]),C(o,n,c.current,!1)}var D=e=>"string"==typeof e,F=(e,t,n,a,i)=>D(e)?(a&&t.watch.add(e),g(n,e,i)):Array.isArray(e)?e.map((e=>(a&&t.watch.add(e),g(n,e)))):(a&&(t.watchAll=!0),n);function N(e){const t=w(),{control:n=t.control,name:a,defaultValue:r,disabled:s,exact:o}=e||{},l=i.default.useRef(a);l.current=a,P({disabled:s,subject:n._subjects.values,next:e=>{A(l.current,e.name,o)&&c(p(F(l.current,n._names,e.values||n._formValues,!1,r)))}});const[u,c]=i.default.useState(n._getWatch(a,r));return i.default.useEffect((()=>n._removeUnmounted())),u}var R=e=>/^\w*$/.test(e),z=e=>f(e.replace(/["|']|\]/g,"").split(/\.|\[/));function L(e,t,n){let a=-1;const i=R(t)?[t]:z(t),r=i.length,s=r-1;for(;++a<r;){const t=i[a];let r=n;if(a!==s){const n=e[t];r=u(n)||Array.isArray(n)?n:isNaN(+i[a+1])?{}:[]}e[t]=r,e=e[t]}return e}function B(e){const t=w(),{name:n,control:a=t.control,shouldUnregister:r}=e,s=d(a._names.array,n),o=N({control:a,name:n,defaultValue:g(a._formValues,n,g(a._defaultValues,n,e.defaultValue)),exact:!0}),l=_({control:a,name:n}),u=i.default.useRef(a.register(n,{...e.rules,value:o}));return u.current=a.register(n,e.rules),i.default.useEffect((()=>{const e=a._options.shouldUnregister||r,t=(e,t)=>{const n=g(a._fields,e);n&&(n._f.mount=t)};if(t(n,!0),e){const e=p(g(a._options.defaultValues,n));L(a._defaultValues,n,e),b(g(a._formValues,n))&&L(a._formValues,n,e)}return()=>{(s?e&&!a._state.action:e)?a.unregister(n):t(n,!1)}}),[n,a,s,r]),{field:{name:n,value:o,onChange:i.default.useCallback((e=>u.current.onChange({target:{value:c(e),name:n},type:h})),[n]),onBlur:i.default.useCallback((()=>u.current.onBlur({target:{value:g(a._formValues,n),name:n},type:v})),[n,a]),ref:e=>{const t=g(a._fields,n);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!g(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!g(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!g(l.touchedFields,n)},error:{enumerable:!0,get:()=>g(l.errors,n)}})}}const q="post";var $=(e,t,n,a,i)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[a]:i||!0}}:{};const V=(e,t,n)=>{for(const a of n||Object.keys(e)){const n=g(e,a);if(n){const{_f:e,...a}=n;if(e&&t(e.name)){if(e.ref.focus){e.ref.focus();break}if(e.refs&&e.refs[0].focus){e.refs[0].focus();break}}else u(a)&&V(a,t)}}};var U=()=>{const e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=(16*Math.random()+e)%16|0;return("x"==t?n:3&n|8).toString(16)}))},H=(e,t,n={})=>n.shouldFocus||b(n.shouldFocus)?n.focusName||`${e}.${b(n.focusIndex)?t:n.focusIndex}.`:"",G=e=>({isOnSubmit:!e||e===E,isOnBlur:"onBlur"===e,isOnChange:e===j,isOnAll:e===O,isOnTouch:"onTouched"===e}),Q=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),W=(e,t,n)=>{const a=f(g(e,n));return L(a,"root",t[n]),L(e,n,a),e},K=e=>"boolean"==typeof e,Y=e=>"file"===e.type,X=e=>"function"==typeof e,J=e=>{if(!m)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Z=e=>D(e),ee=e=>"radio"===e.type,te=e=>e instanceof RegExp;const ne={value:!1,isValid:!1},ae={value:!0,isValid:!0};var ie=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!b(e[0].attributes.value)?b(e[0].value)||""===e[0].value?ae:{value:e[0].value,isValid:!0}:ae:ne}return ne};const re={isValid:!1,value:null};var se=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),re):re;function oe(e,t,n="validate"){if(Z(e)||Array.isArray(e)&&e.every(Z)||K(e)&&!e)return{type:n,message:Z(e)?e:"",ref:t}}var le=e=>u(e)&&!te(e)?e:{value:e,message:""},ue=async(e,t,n,a,i)=>{const{ref:s,refs:l,required:c,maxLength:d,minLength:m,min:p,max:f,pattern:v,validate:y,name:h,valueAsNumber:j,mount:E,disabled:O}=e._f,k=g(t,h);if(!E||O)return{};const w=l?l[0]:s,C=e=>{a&&w.reportValidity&&(w.setCustomValidity(K(e)?"":e||""),w.reportValidity())},M={},I=ee(s),A=r(s),P=I||A,_=(j||Y(s))&&b(s.value)&&b(k)||J(s)&&""===s.value||""===k||Array.isArray(k)&&!k.length,F=$.bind(null,h,n,M),N=(e,t,n,a="maxLength",i="minLength")=>{const r=e?t:n;M[h]={type:e?a:i,message:r,ref:s,...F(e?a:i,r)}};if(i?!Array.isArray(k)||!k.length:c&&(!P&&(_||o(k))||K(k)&&!k||A&&!ie(l).isValid||I&&!se(l).isValid)){const{value:e,message:t}=Z(c)?{value:!!c,message:c}:le(c);if(e&&(M[h]={type:S,message:t,ref:w,...F(S,t)},!n))return C(t),M}if(!(_||o(p)&&o(f))){let e,t;const a=le(f),i=le(p);if(o(k)||isNaN(k)){const n=s.valueAsDate||new Date(k),r=e=>new Date((new Date).toDateString()+" "+e),o="time"==s.type,l="week"==s.type;D(a.value)&&k&&(e=o?r(k)>r(a.value):l?k>a.value:n>new Date(a.value)),D(i.value)&&k&&(t=o?r(k)<r(i.value):l?k<i.value:n<new Date(i.value))}else{const n=s.valueAsNumber||(k?+k:k);o(a.value)||(e=n>a.value),o(i.value)||(t=n<i.value)}if((e||t)&&(N(!!e,a.message,i.message,"max","min"),!n))return C(M[h].message),M}if((d||m)&&!_&&(D(k)||i&&Array.isArray(k))){const e=le(d),t=le(m),a=!o(e.value)&&k.length>+e.value,i=!o(t.value)&&k.length<+t.value;if((a||i)&&(N(a,e.message,t.message),!n))return C(M[h].message),M}if(v&&!_&&D(k)){const{value:e,message:t}=le(v);if(te(e)&&!k.match(e)&&(M[h]={type:x,message:t,ref:s,...F(x,t)},!n))return C(t),M}if(y)if(X(y)){const e=oe(await y(k,t),w);if(e&&(M[h]={...e,...F("validate",e.message)},!n))return C(e.message),M}else if(u(y)){let e={};for(const a in y){if(!T(e)&&!n)break;const i=oe(await y[a](k,t),w,a);i&&(e={...i,...F(a,i.message)},C(i.message),n&&(M[h]=e))}if(!T(e)&&(M[h]={ref:w,...e},!n))return M}return C(!0),M};function ce(e,t){return[...e,...I(t)]}var de=e=>Array.isArray(e)?e.map((()=>{})):void 0;function me(e,t,n){return[...e.slice(0,t),...I(n),...e.slice(t)]}var pe=(e,t,n)=>Array.isArray(e)?(b(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[];function fe(e,t){return[...I(t),...I(e)]}var be=(e,t)=>b(t)?[]:function(e,t){let n=0;const a=[...e];for(const e of t)a.splice(e-n,1),n++;return f(a).length?a:[]}(e,I(t).sort(((e,t)=>e-t))),ge=(e,t,n)=>{e[t]=[e[n],e[n]=e[t]][0]};function ve(e,t){const n=Array.isArray(t)?t:R(t)?[t]:z(t),a=1===n.length?e:function(e,t){const n=t.slice(0,-1).length;let a=0;for(;a<n;)e=b(e)?a++:e[t[a++]];return e}(e,n),i=n.length-1,r=n[i];return a&&delete a[r],0!==i&&(u(a)&&T(a)||Array.isArray(a)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!b(e[t]))return!1;return!0}(a))&&ve(e,n.slice(0,-1)),e}var ye=(e,t,n)=>(e[t]=n,e);function he(){let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next&&n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var je=e=>o(e)||!l(e);function Ee(e,t){if(je(e)||je(t))return e===t;if(s(e)&&s(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const i of n){const n=e[i];if(!a.includes(i))return!1;if("ref"!==i){const e=t[i];if(s(n)&&s(e)||u(n)&&u(e)||Array.isArray(n)&&Array.isArray(e)?!Ee(n,e):n!==e)return!1}}return!0}var Oe=e=>"select-multiple"===e.type,xe=e=>J(e)&&e.isConnected,Se=e=>{for(const t in e)if(X(e[t]))return!0;return!1};function ke(e,t={}){const n=Array.isArray(e);if(u(e)||n)for(const n in e)Array.isArray(e[n])||u(e[n])&&!Se(e[n])?(t[n]=Array.isArray(e[n])?[]:{},ke(e[n],t[n])):o(e[n])||(t[n]=!0);return t}function we(e,t,n){const a=Array.isArray(e);if(u(e)||a)for(const a in e)Array.isArray(e[a])||u(e[a])&&!Se(e[a])?b(t)||je(n[a])?n[a]=Array.isArray(e[a])?ke(e[a],[]):{...ke(e[a])}:we(e[a],o(t)?{}:t[a],n[a]):n[a]=!Ee(e[a],t[a]);return n}var Ce=(e,t)=>we(e,t,ke(t)),Te=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:a})=>b(e)?e:t?""===e?NaN:e?+e:e:n&&D(e)?new Date(e):a?a(e):e;function Me(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return Y(t)?t.files:ee(t)?se(e.refs).value:Oe(t)?[...t.selectedOptions].map((({value:e})=>e)):r(t)?ie(e.refs).value:Te(b(t.value)?e.ref.value:t.value,e)}var Ie=e=>b(e)?e:te(e)?e.source:u(e)?te(e.value)?e.value.source:e.value:e;function Ae(e,t,n){const a=g(e,n);if(a||R(n))return{error:a,name:n};const i=n.split(".");for(;i.length;){const a=i.join("."),r=g(t,a),s=g(e,a);if(r&&!Array.isArray(r)&&n!==a)return{name:n};if(s&&s.type)return{name:a,error:s};i.pop()}return{name:n}}const Pe={mode:E,reValidateMode:j,shouldFocusError:!0};function _e(e={},t){let n,a={...Pe,...e},i={submitCount:0,isDirty:!1,isLoading:X(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},l={},h=(u(a.defaultValues)||u(a.values))&&p(a.defaultValues||a.values)||{},j=a.shouldUnregister?{}:p(h),E={action:!1,mount:!1,watch:!1},x={mount:new Set,unMount:new Set,array:new Set,watch:new Set},S=0;const k={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},w={values:he(),array:he(),state:he()},C=e.resetOptions&&e.resetOptions.keepDirtyValues,M=G(a.mode),A=G(a.reValidateMode),P=a.criteriaMode===O,_=async e=>{if(k.isValid||e){const e=a.resolver?T((await q()).errors):await $(l,!0);e!==i.isValid&&w.state.next({isValid:e})}},N=e=>k.isValidating&&w.state.next({isValidating:e}),R=(e,t,n,a)=>{const i=g(l,e);if(i){const r=g(j,e,b(n)?g(h,e):n);b(r)||a&&a.defaultChecked||t?L(j,e,t?r:Me(i._f)):Z(e,r),E.mount&&_()}},z=(e,t,n,a,r)=>{let s=!1,o=!1;const l={name:e};if(!n||a){k.isDirty&&(o=i.isDirty,i.isDirty=l.isDirty=U(),s=o!==l.isDirty);const n=Ee(g(h,e),t);o=g(i.dirtyFields,e),n?ve(i.dirtyFields,e):L(i.dirtyFields,e,!0),l.dirtyFields=i.dirtyFields,s=s||k.dirtyFields&&o!==!n}if(n){const t=g(i.touchedFields,e);t||(L(i.touchedFields,e,n),l.touchedFields=i.touchedFields,s=s||k.touchedFields&&t!==n)}return s&&r&&w.state.next(l),s?l:{}},B=(t,a,r,s)=>{const o=g(i.errors,t),l=k.isValid&&K(a)&&i.isValid!==a;var u;if(e.delayError&&r?(u=()=>((e,t)=>{L(i.errors,e,t),w.state.next({errors:i.errors})})(t,r),n=e=>{clearTimeout(S),S=setTimeout(u,e)},n(e.delayError)):(clearTimeout(S),n=null,r?L(i.errors,t,r):ve(i.errors,t)),(r?!Ee(o,r):o)||!T(s)||l){const e={...s,...l&&K(a)?{isValid:a}:{},errors:i.errors,name:t};i={...i,...e},w.state.next(e)}N(!1)},q=async e=>a.resolver(j,a.context,((e,t,n,a)=>{const i={};for(const n of e){const e=g(t,n);e&&L(i,n,e._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:a}})(e||x.mount,l,a.criteriaMode,a.shouldUseNativeValidation)),$=async(e,t,n={valid:!0})=>{for(const r in e){const s=e[r];if(s){const{_f:e,...r}=s;if(e){const r=x.array.has(e.name),o=await ue(s,j,P,a.shouldUseNativeValidation&&!t,r);if(o[e.name]&&(n.valid=!1,t))break;!t&&(g(o,e.name)?r?W(i.errors,o,e.name):L(i.errors,e.name,o[e.name]):ve(i.errors,e.name))}r&&await $(r,t,n)}}return n.valid},U=(e,t)=>(e&&t&&L(j,e,t),!Ee(re(),h)),H=(e,t,n)=>F(e,x,{...E.mount?j:b(t)?h:D(e)?{[e]:t}:t},n,t),Z=(e,t,n={})=>{const a=g(l,e);let i=t;if(a){const n=a._f;n&&(!n.disabled&&L(j,e,Te(t,n)),i=J(n.ref)&&o(t)?"":t,Oe(n.ref)?[...n.ref.options].forEach((e=>e.selected=i.includes(e.value))):n.refs?r(n.ref)?n.refs.length>1?n.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(i)?!!i.find((t=>t===e.value)):i===e.value))):n.refs[0]&&(n.refs[0].checked=!!i):n.refs.forEach((e=>e.checked=e.value===i)):Y(n.ref)?n.ref.value="":(n.ref.value=i,n.ref.type||w.values.next({name:e,values:{...j}})))}(n.shouldDirty||n.shouldTouch)&&z(e,i,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&ie(e)},te=(e,t,n)=>{for(const a in t){const i=t[a],r=`${e}.${a}`,o=g(l,r);!x.array.has(e)&&je(i)&&(!o||o._f)||s(i)?Z(r,i,n):te(r,i,n)}},ne=(e,n,a={})=>{const r=g(l,e),s=x.array.has(e),u=p(n);L(j,e,u),s?(w.array.next({name:e,values:{...j}}),(k.isDirty||k.dirtyFields)&&a.shouldDirty&&w.state.next({name:e,dirtyFields:Ce(h,j),isDirty:U(e,u)})):!r||r._f||o(u)?Z(e,u,a):te(e,u,a),Q(e,x)&&w.state.next({...i}),w.values.next({name:e,values:{...j}}),!E.mount&&t()},ae=async e=>{const t=e.target;let r=t.name,s=!0;const o=g(l,r);if(o){let d,m;const p=t.type?Me(o._f):c(e),f=e.type===v||e.type===y,b=!((u=o._f).mount&&(u.required||u.min||u.max||u.maxLength||u.minLength||u.pattern||u.validate)||a.resolver||g(i.errors,r)||o._f.deps)||((e,t,n,a,i)=>!i.isOnAll&&(!n&&i.isOnTouch?!(t||e):(n?a.isOnBlur:i.isOnBlur)?!e:!(n?a.isOnChange:i.isOnChange)||e))(f,g(i.touchedFields,r),i.isSubmitted,A,M),h=Q(r,x,f);L(j,r,p),f?(o._f.onBlur&&o._f.onBlur(e),n&&n(0)):o._f.onChange&&o._f.onChange(e);const E=z(r,p,f,!1),O=!T(E)||h;if(!f&&w.values.next({name:r,type:e.type,values:{...j}}),b)return k.isValid&&_(),O&&w.state.next({name:r,...h?{}:E});if(!f&&h&&w.state.next({...i}),N(!0),a.resolver){const{errors:e}=await q([r]),t=Ae(i.errors,l,r),n=Ae(e,l,t.name||r);d=n.error,r=n.name,m=T(e)}else d=(await ue(o,j,P,a.shouldUseNativeValidation))[r],s=isNaN(p)||p===g(j,r,p),s&&(d?m=!1:k.isValid&&(m=await $(l,!0)));s&&(o._f.deps&&ie(o._f.deps),B(r,m,d,E))}var u},ie=async(e,t={})=>{let n,r;const s=I(e);if(N(!0),a.resolver){const t=await(async e=>{const{errors:t}=await q();if(e)for(const n of e){const e=g(t,n);e?L(i.errors,n,e):ve(i.errors,n)}else i.errors=t;return t})(b(e)?e:s);n=T(t),r=e?!s.some((e=>g(t,e))):n}else e?(r=(await Promise.all(s.map((async e=>{const t=g(l,e);return await $(t&&t._f?{[e]:t}:t)})))).every(Boolean),(r||i.isValid)&&_()):r=n=await $(l);return w.state.next({...!D(e)||k.isValid&&n!==i.isValid?{}:{name:e},...a.resolver||!e?{isValid:n}:{},errors:i.errors,isValidating:!1}),t.shouldFocus&&!r&&V(l,(e=>e&&g(i.errors,e)),e?s:x.mount),r},re=e=>{const t={...h,...E.mount?j:{}};return b(e)?t:D(e)?g(t,e):e.map((e=>g(t,e)))},se=(e,t)=>({invalid:!!g((t||i).errors,e),isDirty:!!g((t||i).dirtyFields,e),isTouched:!!g((t||i).touchedFields,e),error:g((t||i).errors,e)}),oe=(e,t,n)=>{const a=(g(l,e,{_f:{}})._f||{}).ref;L(i.errors,e,{...t,ref:a}),w.state.next({name:e,errors:i.errors,isValid:!1}),n&&n.shouldFocus&&a&&a.focus&&a.focus()},le=(e,t={})=>{for(const n of e?I(e):x.mount)x.mount.delete(n),x.array.delete(n),t.keepValue||(ve(l,n),ve(j,n)),!t.keepError&&ve(i.errors,n),!t.keepDirty&&ve(i.dirtyFields,n),!t.keepTouched&&ve(i.touchedFields,n),!a.shouldUnregister&&!t.keepDefaultValue&&ve(h,n);w.values.next({values:{...j}}),w.state.next({...i,...t.keepDirty?{isDirty:U()}:{}}),!t.keepIsValid&&_()},ce=(e,t={})=>{let n=g(l,e);const i=K(t.disabled);return L(l,e,{...n||{},_f:{...n&&n._f?n._f:{ref:{name:e}},name:e,mount:!0,...t}}),x.mount.add(e),n?i&&L(j,e,t.disabled?void 0:g(j,e,Me(n._f))):R(e,!0,t.value),{...i?{disabled:t.disabled}:{},...a.progressive?{required:!!t.required,min:Ie(t.min),max:Ie(t.max),minLength:Ie(t.minLength),maxLength:Ie(t.maxLength),pattern:Ie(t.pattern)}:{},name:e,onChange:ae,onBlur:ae,ref:i=>{if(i){ce(e,t),n=g(l,e);const a=b(i.value)&&i.querySelectorAll&&i.querySelectorAll("input,select,textarea")[0]||i,s=(e=>ee(e)||r(e))(a),o=n._f.refs||[];if(s?o.find((e=>e===a)):a===n._f.ref)return;L(l,e,{_f:{...n._f,...s?{refs:[...o.filter(xe),a,...Array.isArray(g(h,e))?[{}]:[]],ref:{type:a.type,name:e}}:{ref:a}}}),R(e,!1,void 0,a)}else n=g(l,e,{}),n._f&&(n._f.mount=!1),(a.shouldUnregister||t.shouldUnregister)&&(!d(x.array,e)||!E.action)&&x.unMount.add(e)}}},de=()=>a.shouldFocusError&&V(l,(e=>e&&g(i.errors,e)),x.mount),me=(e,t)=>async n=>{n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let r=p(j);if(w.state.next({isSubmitting:!0}),a.resolver){const{errors:e,values:t}=await q();i.errors=e,r=t}else await $(l);ve(i.errors,"root"),T(i.errors)?(w.state.next({errors:{}}),await e(r,n)):(t&&await t({...i.errors},n),de(),setTimeout(de)),w.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:T(i.errors),submitCount:i.submitCount+1,errors:i.errors})},pe=(n,a={})=>{const r=n||h,s=p(r),o=n&&!T(n)?s:h;if(a.keepDefaultValues||(h=r),!a.keepValues){if(a.keepDirtyValues||C)for(const e of x.mount)g(i.dirtyFields,e)?L(o,e,g(j,e)):ne(e,g(o,e));else{if(m&&b(n))for(const e of x.mount){const t=g(l,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(J(e)){const t=e.closest("form");if(t){t.reset();break}}}}l={}}j=e.shouldUnregister?a.keepDefaultValues?p(h):{}:p(o),w.array.next({values:{...o}}),w.values.next({values:{...o}})}x={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!E.mount&&t(),E.mount=!k.isValid||!!a.keepIsValid,E.watch=!!e.shouldUnregister,w.state.next({submitCount:a.keepSubmitCount?i.submitCount:0,isDirty:a.keepDirty?i.isDirty:!(!a.keepDefaultValues||Ee(n,h)),isSubmitted:!!a.keepIsSubmitted&&i.isSubmitted,dirtyFields:a.keepDirtyValues?i.dirtyFields:a.keepDefaultValues&&n?Ce(h,n):{},touchedFields:a.keepTouched?i.touchedFields:{},errors:a.keepErrors?i.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},fe=(e,t)=>pe(X(e)?e(j):e,t);return{control:{register:ce,unregister:le,getFieldState:se,handleSubmit:me,setError:oe,_executeSchema:q,_getWatch:H,_getDirty:U,_updateValid:_,_removeUnmounted:()=>{for(const e of x.unMount){const t=g(l,e);t&&(t._f.refs?t._f.refs.every((e=>!xe(e))):!xe(t._f.ref))&&le(e)}x.unMount=new Set},_updateFieldArray:(e,t=[],n,a,r=!0,s=!0)=>{if(a&&n){if(E.action=!0,s&&Array.isArray(g(l,e))){const t=n(g(l,e),a.argA,a.argB);r&&L(l,e,t)}if(s&&Array.isArray(g(i.errors,e))){const t=n(g(i.errors,e),a.argA,a.argB);r&&L(i.errors,e,t),((e,t)=>{!f(g(e,t)).length&&ve(e,t)})(i.errors,e)}if(k.touchedFields&&s&&Array.isArray(g(i.touchedFields,e))){const t=n(g(i.touchedFields,e),a.argA,a.argB);r&&L(i.touchedFields,e,t)}k.dirtyFields&&(i.dirtyFields=Ce(h,j)),w.state.next({name:e,isDirty:U(e,t),dirtyFields:i.dirtyFields,errors:i.errors,isValid:i.isValid})}else L(j,e,t)},_getFieldArray:t=>f(g(E.mount?j:h,t,e.shouldUnregister?g(h,t,[]):[])),_reset:pe,_resetDefaultValues:()=>X(a.defaultValues)&&a.defaultValues().then((e=>{fe(e,a.resetOptions),w.state.next({isLoading:!1})})),_updateFormState:e=>{i={...i,...e}},_subjects:w,_proxyFormState:k,get _fields(){return l},get _formValues(){return j},get _state(){return E},set _state(e){E=e},get _defaultValues(){return h},get _names(){return x},set _names(e){x=e},get _formState(){return i},set _formState(e){i=e},get _options(){return a},set _options(e){a={...a,...e}}},trigger:ie,register:ce,handleSubmit:me,watch:(e,t)=>X(e)?w.values.subscribe({next:n=>e(H(void 0,t),n)}):H(e,t,!0),setValue:ne,getValues:re,reset:fe,resetField:(e,t={})=>{g(l,e)&&(b(t.defaultValue)?ne(e,g(h,e)):(ne(e,t.defaultValue),L(h,e,t.defaultValue)),t.keepTouched||ve(i.touchedFields,e),t.keepDirty||(ve(i.dirtyFields,e),i.isDirty=t.defaultValue?U(e,g(h,e)):U()),t.keepError||(ve(i.errors,e),k.isValid&&_()),w.state.next({...i}))},clearErrors:e=>{e&&I(e).forEach((e=>ve(i.errors,e))),w.state.next({errors:e?i.errors:{}})},unregister:le,setError:oe,setFocus:(e,t={})=>{const n=g(l,e),a=n&&n._f;if(a){const e=a.refs?a.refs[0]:a.ref;e.focus&&(e.focus(),t.shouldSelect&&e.select())}},getFieldState:se}}t.Controller=e=>e.render(B(e)),t.Form=function(e){const t=w(),[n,a]=i.default.useState(!1),{control:r=t.control,onSubmit:s,children:o,action:l,method:u=q,headers:c,encType:d,onError:m,render:p,onSuccess:f,validateStatus:b,...v}=e,y=async t=>{let n=!1,a="";await r.handleSubmit((async e=>{const i=new FormData;let o="";try{o=JSON.stringify(e)}catch(e){}for(const t of r._names.mount)i.append(t,g(e,t));if(s&&s({data:e,event:t,method:u,formData:i,formDataJson:o}),l)try{const e=[c&&c["Content-Type"],d].some((e=>e&&e.includes("json"))),t=await fetch(l,{method:u,headers:{...c,...d?{"Content-Type":d}:{}},body:e?o:i});t&&(b?!b(t.status):t.status<200||t.status>=300)?(n=!0,m&&m({response:t}),a=String(t.status)):f&&f({response:t})}catch(e){n=!0,m&&m({error:e})}}))(t),n&&e.control&&(e.control._subjects.state.next({isSubmitSuccessful:!1}),e.control.setError("root.server",{type:a}))};return i.default.useEffect((()=>{a(!0)}),[]),p?i.default.createElement(i.default.Fragment,null,p({submit:y})):i.default.createElement("form",{noValidate:n,action:l,method:u,encType:d,onSubmit:y,...v},o)},t.FormProvider=e=>{const{children:t,...n}=e;return i.default.createElement(k.Provider,{value:n},t)},t.appendErrors=$,t.get=g,t.set=L,t.useController=B,t.useFieldArray=function(e){const t=w(),{control:n=t.control,name:a,keyName:r="id",shouldUnregister:s}=e,[o,l]=i.default.useState(n._getFieldArray(a)),u=i.default.useRef(n._getFieldArray(a).map(U)),c=i.default.useRef(o),d=i.default.useRef(a),m=i.default.useRef(!1);d.current=a,c.current=o,n._names.array.add(a),e.rules&&n.register(a,e.rules),P({next:({values:e,name:t})=>{if(t===d.current||!t){const t=g(e,d.current);Array.isArray(t)&&(l(t),u.current=t.map(U))}},subject:n._subjects.array});const f=i.default.useCallback((e=>{m.current=!0,n._updateFieldArray(a,e)}),[n,a]);return i.default.useEffect((()=>{if(n._state.action=!1,Q(a,n._names)&&n._subjects.state.next({...n._formState}),m.current&&(!G(n._options.mode).isOnSubmit||n._formState.isSubmitted))if(n._options.resolver)n._executeSchema([a]).then((e=>{const t=g(e.errors,a),i=g(n._formState.errors,a);(i?!t&&i.type||t&&(i.type!==t.type||i.message!==t.message):t&&t.type)&&(t?L(n._formState.errors,a,t):ve(n._formState.errors,a),n._subjects.state.next({errors:n._formState.errors}))}));else{const e=g(n._fields,a);e&&e._f&&ue(e,n._formValues,n._options.criteriaMode===O,n._options.shouldUseNativeValidation,!0).then((e=>!T(e)&&n._subjects.state.next({errors:W(n._formState.errors,e,a)})))}n._subjects.values.next({name:a,values:{...n._formValues}}),n._names.focus&&V(n._fields,(e=>!!e&&e.startsWith(n._names.focus||""))),n._names.focus="",n._updateValid()}),[o,a,n]),i.default.useEffect((()=>(!g(n._formValues,a)&&n._updateFieldArray(a),()=>{(n._options.shouldUnregister||s)&&n.unregister(a)})),[a,n,r,s]),{swap:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);ge(i,e,t),ge(u.current,e,t),f(i),l(i),n._updateFieldArray(a,i,ge,{argA:e,argB:t},!1)}),[f,a,n]),move:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);pe(i,e,t),pe(u.current,e,t),f(i),l(i),n._updateFieldArray(a,i,pe,{argA:e,argB:t},!1)}),[f,a,n]),prepend:i.default.useCallback(((e,t)=>{const i=I(p(e)),r=fe(n._getFieldArray(a),i);n._names.focus=H(a,0,t),u.current=fe(u.current,i.map(U)),f(r),l(r),n._updateFieldArray(a,r,fe,{argA:de(e)})}),[f,a,n]),append:i.default.useCallback(((e,t)=>{const i=I(p(e)),r=ce(n._getFieldArray(a),i);n._names.focus=H(a,r.length-1,t),u.current=ce(u.current,i.map(U)),f(r),l(r),n._updateFieldArray(a,r,ce,{argA:de(e)})}),[f,a,n]),remove:i.default.useCallback((e=>{const t=be(n._getFieldArray(a),e);u.current=be(u.current,e),f(t),l(t),n._updateFieldArray(a,t,be,{argA:e})}),[f,a,n]),insert:i.default.useCallback(((e,t,i)=>{const r=I(p(t)),s=me(n._getFieldArray(a),e,r);n._names.focus=H(a,e,i),u.current=me(u.current,e,r.map(U)),f(s),l(s),n._updateFieldArray(a,s,me,{argA:e,argB:de(t)})}),[f,a,n]),update:i.default.useCallback(((e,t)=>{const i=p(t),r=ye(n._getFieldArray(a),e,i);u.current=[...r].map(((t,n)=>t&&n!==e?u.current[n]:U())),f(r),l([...r]),n._updateFieldArray(a,r,ye,{argA:e,argB:i},!0,!1)}),[f,a,n]),replace:i.default.useCallback((e=>{const t=I(p(e));u.current=t.map(U),f([...t]),l([...t]),n._updateFieldArray(a,[...t],(e=>e),{},!0,!1)}),[f,a,n]),fields:i.default.useMemo((()=>o.map(((e,t)=>({...e,[r]:u.current[t]||U()})))),[o,r])}},t.useForm=function(e={}){const t=i.default.useRef(),[n,a]=i.default.useState({isDirty:!1,isValidating:!1,isLoading:X(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:X(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={..._e(e,(()=>a((e=>({...e}))))),formState:n});const r=t.current.control;return r._options=e,P({subject:r._subjects.state,next:e=>{M(e,r._proxyFormState,r._updateFormState,!0)&&a({...r._formState})}}),i.default.useEffect((()=>{e.values&&!Ee(e.values,r._defaultValues)?r._reset(e.values,r._options.resetOptions):r._resetDefaultValues()}),[e.values,r]),i.default.useEffect((()=>{r._state.mount||(r._updateValid(),r._state.mount=!0),r._state.watch&&(r._state.watch=!1,r._subjects.state.next({...r._formState})),r._removeUnmounted()})),t.current.formState=C(n,r),t.current},t.useFormContext=w,t.useFormState=_,t.useWatch=N},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(17),l=n(48),u=n(128),c=n(119),d=n(138),m=n(14),p=n(181),f=n(116),b=n(122),g=n(113),v=n(228),y=n(197),h=n(112);const j=({asEmptyButton:e,children:t,dataProviders:n,filters:a,timeRange:j,keepDataView:E,iconType:O,...x})=>{const S=Object(l.useDispatch)(),k=Object(r.useMemo)((()=>u.e.getSourcererDataViewsSelector()),[]),{defaultDataView:w,signalIndexName:C}=Object(h.a)((e=>k(e))),T=n&&n.find((e=>"template"===e.type)),M=Object(v.a)({timelineId:b.c.active,timelineType:T?g.l.template:g.l.default}),I=Object(r.useCallback)((()=>{(n||a)&&(j?M({timeRange:j}):M(),n&&S(Object(m.updateProviders)({id:b.c.active,providers:n})),a&&S(Object(m.setFilters)({id:b.c.active,filters:a})),E||S(p.d.setSelectedDataView({id:f.SourcererScopeName.timeline,selectedDataViewId:w.id,selectedPatterns:[C||""]})),S(d.b.removeLinkTo([c.a.timeline,c.a.global])))}),[n,M,S,w.id,C,a,j,E]);return e?s.a.createElement(o.EuiButtonEmpty,{"aria-label":y.i,onClick:I,flush:"right",size:"xs",iconType:O},t):s.a.createElement(o.EuiButton,i()({"aria-label":y.i,onClick:I},x),t)};j.displayName="InvestigateInTimelineButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(17),s=n(542),o=n(317);const l=Object(a.forwardRef)((({onChange:e,value:t,ariaLabel:n,editorId:l,dataTestSubj:u,height:c,autoFocusDisabled:d,setIsMarkdownInvalid:m},p)=>{const[f,b]=Object(a.useState)([]),g=Object(a.useCallback)(((e,{messages:t})=>{b(e?[e]:t),m(!!e)}),[m]),v=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e,t;d||null===(e=v.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus()}),[d]);const y=Object(o.b)("investigation_guide"),h=Object(a.useMemo)((()=>Object(s.d)({insightsUpsellingMessage:y})),[y]);return Object(a.useImperativeHandle)(p,(()=>{var e,t;if(!v.current)return null;const n=null===(e=v.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...v.current,toolbar:null==n?void 0:n.querySelector(".euiMarkdownEditorToolbar")}})),i.a.createElement(r.EuiMarkdownEditor,{ref:v,"aria-label":n,editorId:l,onChange:e,value:t,uiPlugins:h,parsingPluginList:s.a,processingPluginList:s.c,onParse:g,errors:f,"data-test-subj":u,height:c})}));l.displayName="MarkdownEditorComponent";const u=Object(a.memo)(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return y}));var a=n(17),i=n(61),r=n.n(i),s=n(2),o=n.n(s),l=n(44),u=n.n(l),c=n(49),d=n(4),m=n(382),p=n(121),f=n(116);const b=u()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-67qpo8-0"})(["width:min(768px,calc(100vw - 16px));min-height:41vh;.euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]);b.displayName="MyEuiModal";const g=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},v=(e=[])=>1===e.length&&e[0]===d.Vb?o.a.createElement("i",null,m.f):e.length>0?e.filter((e=>e!==d.Vb)).join(", "):m.k,y=({adHocDataViews:e,additionalRequests:t,additionalResponses:n,closeModal:i,inputId:l,request:u,response:d,title:y})=>{var h,j,E,O;const{pathname:x}=Object(c.useLocation)(),{selectedPatterns:S}=Object(p.d)("timeline"===l?f.SourcererScopeName.timeline:Object(p.a)(x)),k=[u,...null!=t?t:[]],w=[d,...null!=n?n:[]],C=g(k),T=g(w),M=Object(s.useMemo)((()=>{var e,t;return(null!==(e=null===(t=C[0])||void 0===t?void 0:t.index)&&void 0!==e?e:[]).every((e=>S.includes(e.trim())))}),[C,S]),I=[{title:o.a.createElement("span",{"data-test-subj":"index-pattern-title"},m.b," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.c,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"index-pattern-description"},o.a.createElement("p",null,v(null!=e&&e.length>0?e:null!==(h=null===(j=C[0])||void 0===j?void 0:j.index)&&void 0!==h?h:[])),!M&&o.a.createElement("p",null,o.a.createElement("small",null,o.a.createElement("i",{"data-test-subj":"not-sourcerer-msg"},m.e))))},{title:o.a.createElement("span",{"data-test-subj":"query-time-title"},m.g," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.h,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"query-time-description"},0===(null===(E=T[0])||void 0===E?void 0:E.took)?"0ms":null!==(O=T[0])&&void 0!==O&&O.took?`${r()(T[0].took).format("0,0")}ms`:m.k)},{title:o.a.createElement("span",{"data-test-subj":"request-timestamp-title"},m.i," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:m.j,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}],A=[{id:"statistics",name:"Statistics",content:o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiDescriptionList,{listItems:I,type:"responsiveColumn",columnWidths:[3,7]}))},{id:"request",name:"Request",content:C.length>0?C.map(((e,t)=>o.a.createElement(s.Fragment,{key:t},o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return m.k}})(e.body))))):o.a.createElement(a.EuiCodeBlock,null,m.k)},{id:"response",name:"Response",content:T.length>0?w.map(((e,t)=>o.a.createElement(s.Fragment,{key:t},o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},e)))):o.a.createElement(a.EuiCodeBlock,null,m.k)}];return o.a.createElement(b,{onClose:i,"data-test-subj":"modal-inspect-euiModal"},o.a.createElement(a.EuiModalHeader,null,o.a.createElement(a.EuiModalHeaderTitle,null,m.d," ",y)),o.a.createElement(a.EuiModalBody,null,o.a.createElement(a.EuiTabbedContent,{tabs:A,initialSelectedTab:A[0],autoFocus:"selected"})),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButton,{onClick:i,fill:!0,"data-test-subj":"modal-inspect-close"},m.a)))}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"k",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return p})),n.d(t,"f",(function(){return f}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.inspectDescription",{defaultMessage:"Inspect"}),r=a.i18n.translate("xpack.securitySolution.inspect.modal.closeTitle",{defaultMessage:"Close"}),s=a.i18n.translate("xpack.securitySolution.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),o=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),l=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),u=a.i18n.translate("xpack.securitySolution.inspectPatternDifferent",{defaultMessage:"This element has a unique index pattern separate from the data view setting."}),c=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),d=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),m=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),p=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),f=a.i18n.translate("xpack.securitySolution.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(62),i=n(45),r=n(283);const s=e=>e.toLocaleString(),o=({chartHeight:e,from:t,legendPosition:n,to:i,onBrushEnd:o,yTickFormatter:l,showLegend:u})=>({series:{xScaleType:a.ScaleType.Time,yScaleType:a.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(r.a)([t,i]),yTickFormatter:null!=l?l:s,tickSize:8},settings:{legendPosition:null!=n?n:a.Position.Right,onBrushEnd:o,showLegend:null==u||u,showLegendExtra:!0,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:null!=e?e:174}),l=["#1EA593","#2B70F7","#CE0060","#38007E","#FCA5D3","#F37020","#E49E29","#B0916F","#7B000B","#34130C","#GGGGGG"],u=([e,t])=>({key:e,value:t}),c=(e,t)=>{if(!e)return[];const n=Object(i.groupBy)("g",e),a=Object(i.toPairs)(n);return Object(i.map)(u,a).map(((e,n)=>{var a;const r=Object(i.get)(e.key,t);return{...e,color:null!==(a=null==r?void 0:r.color)&&void 0!==a?a:l[n]}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"m",(function(){return b})),n.d(t,"n",(function(){return g})),n.d(t,"o",(function(){return v})),n.d(t,"p",(function(){return y})),n.d(t,"f",(function(){return h}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.addToCaseSuccessToast",{defaultMessage:"Successfully added data quality results to the case"}),r=(a.i18n.translate("xpack.securitySolution.dataQualityDashboard.betaBadge",{defaultMessage:"Beta"}),a.i18n.translate("xpack.securitySolution.overview.ilmPhaseCold",{defaultMessage:"cold"})),s=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.pageTitle",{defaultMessage:"Data Quality"}),o=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.datePicker.tooltip",{defaultMessage:"Data quality checks are ran on data that was ingested during the Search Boost window. The default window range is 7 days."}),l=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.elasticCommonSchemaReferenceLink",{defaultMessage:"Elastic Common Schema (ECS)"}),u=(a.i18n.translate("xpack.securitySolution.overview.eventsTitle",{defaultMessage:"Event count"}),a.i18n.translate("xpack.securitySolution.overview.ilmPhaseFrozen",{defaultMessage:"frozen"})),c=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseHot",{defaultMessage:"hot"}),d=a.i18n.translate("xpack.securitySolution.overview.newsFeedSidebarTitle",{defaultMessage:"Security news"}),m=a.i18n.translate("xpack.securitySolution.overview.recentTimelinesSidebarTitle",{defaultMessage:"Recent timelines"}),p=a.i18n.translate("xpack.securitySolution.overview.signalCountTitle",{defaultMessage:"Alert trend"}),f=e=>a.i18n.translate("xpack.securitySolution.overview.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}),b=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseUnmanaged",{defaultMessage:"unmanaged"}),g=a.i18n.translate("xpack.securitySolution.overview.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),v=a.i18n.translate("xpack.securitySolution.overview.viewEventsButtonLabel",{defaultMessage:"View events"}),y=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseWarm",{defaultMessage:"warm"}),h=a.i18n.translate("xpack.securitySolution.detectionResponse.pageTitle",{defaultMessage:"Detection & Response"});a.i18n.translate("xpack.securitySolution.entityAnalytics.technicalPreviewLabel",{defaultMessage:"Technical Preview"})},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n(45),n(51);const a=({allowSet:e,field:t})=>e.has(t),i=({allowSet:e,field:t})=>!e.has(t),r=({allowReplacementSet:e,field:t})=>e.has(t),s=({allowSet:e,allowReplacementSet:t,currentReplacements:n,field:i,getAnonymizedValue:s,rawData:o})=>{var l;return(null!==(l=o[i])&&void 0!==l?l:[]).reduce(((o,l)=>{const u=`${l}`;if(a({allowSet:e,field:i})&&r({allowReplacementSet:t,field:i})){const e=`${s({currentReplacements:n,rawValue:u})}`;return{anonymizedValues:[...o.anonymizedValues,e],replacements:{...o.replacements,[e]:u}}}return a({allowSet:e,field:i})?{anonymizedValues:[...o.anonymizedValues,u],replacements:{...o.replacements}}:o}),{anonymizedValues:[],replacements:{}})},o=({allow:e,allowReplacement:t,currentReplacements:n,getAnonymizedValue:i,onNewReplacements:r,rawData:o})=>{if("string"==typeof o)return o;const l=(({allow:e,allowReplacement:t,currentReplacements:n,getAnonymizedValue:i,getAnonymizedValues:r,rawData:s})=>Object.keys(s).reduce(((o,l)=>{const u=new Set(t),c=new Set(e);if(a({allowSet:c,field:l})){const{anonymizedValues:e,replacements:t}=r({allowReplacementSet:u,allowSet:c,currentReplacements:n,field:l,getAnonymizedValue:i,rawData:s});return{anonymizedData:{...o.anonymizedData,[l]:e},replacements:{...o.replacements,...t}}}return o}),{anonymizedData:{},replacements:{}}))({allow:e,allowReplacement:t,currentReplacements:n,rawData:o,getAnonymizedValue:i,getAnonymizedValues:s});return null!=r&&r(l.replacements),u=l.anonymizedData,Object.keys(u).sort().map((e=>`${e},${u[e].join(",")}`)).join("\n");var u}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(46),i=n(139),r=n(120);a.exact(a.type({id:r.q})),a.exact(a.type({items:a.array(i.i)})),a.exact(a.type({name:a.string,description:a.string}));var s=n(278);a.intersection([a.exact(a.type({namespace_types:i.a})),a.exact(a.partial({ids:r.k,list_ids:r.k}))]);const o=a.exact(a.type({name:s.t,id:s.v,rule_id:s.y,exception_lists:i.y})),l=a.intersection([i.o,a.exact(a.type({referenced_rules:a.array(o)}))]),u=a.record(i.B,l);a.exact(a.type({references:a.array(u)}));var c=n(4);const d=`${c.Db}/rules`,m=(c.jb,`${d}/exceptions/_find_references`)},function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return O.a}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(45),l=n(17),u=n(461),c=n.n(u),d=n(47),m=n(542);const p=({disableLinks:e,href:t,target:n,children:a,...i})=>s.a.createElement(l.EuiToolTip,{content:t},s.a.createElement(l.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},a)),f=Object(r.memo)(p);var b=n(110),g=n(18),v=n(5);const y=v.i18n.translate("xpack.securitySolution.markdown.platinumWarning",{defaultMessage:"The following markdown may make use of subscription features"}),h=v.i18n.translate("xpack.securitySolution.markdown.invalid",{defaultMessage:"Invalid markdown detected"}),j=({children:e,disableLinks:t,textSize:n="m"})=>{const a=Object(r.useMemo)((()=>e=>s.a.createElement(f,i()({},e,{disableLinks:t}))),[t]),u=Object(o.cloneDeep)(m.c);u[1][1].components.a=a;const p=Object(g.b)().isAtLeast("platinum"),{application:v}=Object(b.i)().services,j=Object(r.useMemo)((()=>{if(!1===p){const t=String(e);return m.b.some((e=>new RegExp(e).test(t)))}return!1}),[e,p]),E=Object(r.useMemo)((()=>c()().use(m.a).use(u)),[u]),O=Object(r.useMemo)((()=>{try{return E.processSync(e),null}catch(e){return String(e.message)}}),[e,E]);return s.a.createElement(s.a.Fragment,null,j&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.EuiCallOut,{title:y,color:"primary",iconType:"lock"},s.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkPrefix",defaultMessage:"To use these interactive markdown features, you must {link}.",values:{link:s.a.createElement(l.EuiLink,{href:v.getUrlForApp("management",{path:"stack/license_management/home"})},s.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkSuffix",defaultMessage:"start a trial or upgrade your subscription"}))}})),s.a.createElement(l.EuiSpacer,{size:"s"})),null!==O&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.EuiCallOut,{title:h,color:"danger",iconType:"error"},O),s.a.createElement(l.EuiSpacer,{size:"s"})),s.a.createElement(l.EuiMarkdownFormat,{parsingPluginList:m.a,processingPluginList:u,textSize:n},e))};j.displayName="MarkdownRendererComponent";const E=Object(r.memo)(j);var O=n(380);n(463)},,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a,i=n(2),r=n(67),s=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o="html",l="svg",u=function(e,t){var n,a,i,r={};if(e===o)i=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');i=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var s=0,u=Object.entries(t.attributes);s<u.length;s++){var c=u[s],d=c[0],m=c[1];i.setAttribute(d,m)}var p={element:i,elementType:e,setPortalProps:function(e){r=e},getInitialPortalProps:function(){return r},mount:function(t,i){if(i!==a){if(p.unmount(),t!==n&&!function(e,t){if(t===o)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(p.element,i),n=t,a=i}},unmount:function(e){e&&e!==a||n&&a&&(n.replaceChild(a,p.element),n=void 0,a=void 0)}};return p},c=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return s(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,a=t.node;return r.createPortal(i.Children.map(n,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),a.element)},t}(i.PureComponent),d=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=i.createRef(),n.passPropsThroughPortal(),n}return s(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent),m=u.bind(null,o);u.bind(null,l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n(48),r=n(112),s=n(110),o=n(128),l=n(181),u=n(119);const c=({inputId:e,queryId:t,skip:n})=>{const c=Object(i.useDispatch)(),{data:d}=Object(s.i)().services,m=Object(a.useRef)(d.search.session),p=o.d.globalQueryByIdSelector(),f=o.d.timelineQueryByIdSelector(),{selectedInspectIndex:b}=Object(r.a)((n=>e===u.a.global?p(n,t):f(n,t))),g=Object(a.useCallback)((()=>{const e=m.current.start();c(l.c.setInspectionParameter({id:t,selectedInspectIndex:b,isInspected:!1,inputId:u.a.global,searchSessionId:n?void 0:e}))}),[c,t,b,n]),v=Object(a.useCallback)((()=>{c(l.c.deleteOneQuery({inputId:u.a.global,id:t}))}),[c,t]);return{session:m,refetchByRestartingSession:g,refetchByDeletingSession:v}}},function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"o",(function(){return d})),n.d(t,"n",(function(){return m})),n.d(t,"k",(function(){return p})),n.d(t,"m",(function(){return f})),n.d(t,"l",(function(){return b})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return v})),n.d(t,"g",(function(){return y}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),r=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),s=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),o=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),l=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),u=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),m=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),p=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),f=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),b=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),g=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),v=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),y=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return m}));var a=n(2),i=n(49),r=n(5),s=n(117),o=n(121),l=n(241),u=n(728);const c=({setQuery:e,response:t,request:n,refetch:i,uniqueQueryId:r,deleteQuery:s,loading:o,searchSessionId:l})=>{Object(a.useEffect)((()=>(null!=i&&null!=e&&e({id:r,inspect:{dsl:[n],response:[t]},loading:o,refetch:i,searchSessionId:l}),()=>{s&&s({id:r})})),[e,o,t,n,i,r,s,l])};function d(e){var t;const n=null==e?void 0:e.subType;return!(null==n||null===(t=n.nested)||void 0===t||!t.path)}const m=e=>{const{pathname:t}=Object(i.useLocation)(),{addError:n}=Object(s.a)(),{browserFields:c}=Object(o.d)(Object(o.a)(t));return Object(a.useCallback)((()=>{try{return function(e,t){const n=[];for(const[a,i]of Object.entries(e))t?i.aggregatable&&Object(u.a)(i.type)&&!d(i)&&n.push({label:a,value:a}):!0===i.aggregatable&&n.push({label:a,value:a});return n}(Object(l.a)(c),e)}catch(e){return n(e,{title:r.i18n.translate("xpack.securitySolution.useStackByFields.error.title",{defaultMessage:"Error fetching fields"}),toastMessage:r.i18n.translate("xpack.securitySolution.useStackByFields.error.toastMessage",{defaultMessage:"This error indicates an exceedingly large number of fields in an index"})}),[]}}),[n,c,e])}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByLabel",{defaultMessage:"Group by"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByPlaceholder",{defaultMessage:"Select a field to stack by"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByAriaLabel",{defaultMessage:"Stack the alerts histogram by a field value"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByTopLabel",{defaultMessage:"Group by top"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return p})),n.d(t,"i",(function(){return f}));var a=n(142),i=n(124),r=n(357);const s=e=>{const t="acknowledged"===e?{bool:{should:[{term:{[a.ob]:e}},{term:{[a.ob]:"in-progress"}}]}}:{term:{[a.ob]:e}};return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:a.ob,params:{query:e}},query:t}]},o=e=>[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({term:{[a.ob]:e}})))}}}],l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:a.N,params:{query:e}},query:{match_phrase:{[a.N]:e}}}]:[],u=e=>e?[]:[{meta:{alias:null,negate:!0,disabled:!1,type:"exists",key:a.b,value:"exists"},query:{exists:{field:a.b}}}],c=e=>e?[{meta:{alias:null,disabled:!1,negate:!1,key:"kibana.alert.rule.type",type:"term"},query:{term:{"kibana.alert.rule.type":"threat_match"}}}]:[],d=e=>e.length?[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>e?{term:{[a.mb]:e}}:{bool:{must_not:{exists:{field:a.mb}}}}))}}}]:[],m=e=>({...i.q,columns:Object(r.c)(e),showCheckboxes:!0}),p=e=>({...m(e),columns:Object(r.d)(e),defaultColumns:Object(r.d)(e),sort:[{columnId:"kibana.alert.original_time",columnType:"date",esTypes:["date"],sortDirection:"desc"}],showCheckboxes:!1}),f=["@timestamp","kibana.alert.workflow_status","kibana.alert.workflow_tags","kibana.alert.workflow_assignee_ids","kibana.alert.group.id","kibana.alert.original_time","kibana.alert.building_block_type","kibana.alert.rule.from","kibana.alert.rule.name","kibana.alert.rule.to","kibana.alert.rule.uuid","kibana.alert.rule.rule_id","kibana.alert.rule.type","kibana.alert.suppression.docs_count","kibana.alert.original_event.kind","kibana.alert.original_event.module","file.path","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.hash.sha256","host.os.family","event.code","process.entry_leader.entity_id"]},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"o",(function(){return p})),n.d(t,"n",(function(){return f})),n.d(t,"p",(function(){return b})),n.d(t,"q",(function(){return g})),n.d(t,"r",(function(){return v})),n.d(t,"u",(function(){return y})),n.d(t,"t",(function(){return h})),n.d(t,"v",(function(){return j})),n.d(t,"x",(function(){return E})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return x})),n.d(t,"w",(function(){return S})),n.d(t,"s",(function(){return k})),n.d(t,"m",(function(){return w})),n.d(t,"l",(function(){return C}));var a=n(5);a.i18n.translate("xpack.securitySolution.dataProviders.and",{defaultMessage:"AND"});const i=a.i18n.translate("xpack.securitySolution.dataProviders.deleteDataProvider",{defaultMessage:"Delete"}),r=a.i18n.translate("xpack.securitySolution.dataProviders.dropAnything",{defaultMessage:"Drop anything"}),s=(a.i18n.translate("xpack.securitySolution.dataProviders.edit",{defaultMessage:"Edit"}),a.i18n.translate("xpack.securitySolution.dataProviders.editMenuItem",{defaultMessage:"Edit filter"})),o=a.i18n.translate("xpack.securitySolution.dataProviders.editTitle",{defaultMessage:"EDIT FILTER"}),l=a.i18n.translate("xpack.securitySolution.dataProviders.excludeDataProvider",{defaultMessage:"Exclude results"}),u=a.i18n.translate("xpack.securitySolution.dataProviders.existsLabel",{defaultMessage:"exists"}),c=(a.i18n.translate("xpack.securitySolution.dataProviders.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dataProviders.filterForFieldPresentLabel",{defaultMessage:"Filter for field present"})),d=a.i18n.translate("xpack.securitySolution.dataProviders.convertToFieldLabel",{defaultMessage:"Convert to field"}),m=a.i18n.translate("xpack.securitySolution.dataProviders.convertToTemplateFieldLabel",{defaultMessage:"Convert to template field"}),p=a.i18n.translate("xpack.securitySolution.dataProviders.highlighted",{defaultMessage:"highlighted"}),f=a.i18n.translate("xpack.securitySolution.dataProviders.hereToBuildAn",{defaultMessage:"here to build an"}),b=a.i18n.translate("xpack.securitySolution.dataProviders.includeDataProvider",{defaultMessage:"Include results"}),g=a.i18n.translate("xpack.securitySolution.dataProviders.not",{defaultMessage:"NOT"}),v=(a.i18n.translate("xpack.securitySolution.dataProviders.or",{defaultMessage:"or"}),a.i18n.translate("xpack.securitySolution.dataProviders.query",{defaultMessage:"query"})),y=(a.i18n.translate("xpack.securitySolution.dataProviders.toggle",{defaultMessage:"toggle"}),a.i18n.translate("xpack.securitySolution.dataProviders.reEnableDataProvider",{defaultMessage:"Re-enable"})),h=a.i18n.translate("xpack.securitySolution.dataProviders.removeDataProvider",{defaultMessage:"Remove Data Provider"}),j=({field:e,value:t})=>a.i18n.translate("xpack.securitySolution.dataProviders.showOptionsDataProviderAriaLabel",{values:{field:e,value:t},defaultMessage:"{field} {value} Press enter for options, or press space to begin dragging"}),E=a.i18n.translate("xpack.securitySolution.dataProviders.temporaryDisableDataProvider",{defaultMessage:"Temporarily disable"}),O=(a.i18n.translate("xpack.securitySolution.dataProviders.valuePlaceholder",{defaultMessage:"value"}),a.i18n.translate("xpack.securitySolution.dataProviders.addFieldPopoverButtonLabel",{defaultMessage:"Add field"})),x=a.i18n.translate("xpack.securitySolution.dataProviders.addTemplateFieldPopoverButtonLabel",{defaultMessage:"Add template field"}),S=a.i18n.translate("xpack.securitySolution.dataProviders.templateFieldLabel",{defaultMessage:"Template field"}),k=a.i18n.translate("xpack.securitySolution.dataProviders.queryAreaAriaLabel",{defaultMessage:"You are in the timeline query area, which contains groups of data providers that query for events"}),w=e=>a.i18n.translate("xpack.securitySolution.dataProviders.groupAreaAriaLabel",{values:{group:e},defaultMessage:"You are in group {group}"}),C=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"})},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return E}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(215),u=n(390),c=n(5);const d=c.i18n.translate("xpack.securitySolution.alertDetails.summary.readMore",{defaultMessage:"Read More"}),m=c.i18n.translate("xpack.securitySolution.alertDetails.summary.readLess",{defaultMessage:"Read Less"}),p=o()(a.EuiButtonEmpty).withConfig({displayName:"ReadMore",componentId:"sc-1cdn95f-0"})(["span.euiButtonContent{padding:0;}"]),f=o.a.div.withConfig({displayName:"ExpandedContent",componentId:"sc-1cdn95f-1"})(["max-height:33vh;overflow-wrap:break-word;overflow-x:hidden;overflow-y:auto;"]),b=o.a.div.withConfig({displayName:"StyledLineClamp",componentId:"sc-1cdn95f-2"})(["display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;max-height:","em;height:","em;"],3,(({lineClampHeight:e})=>e),(({lineClampHeight:e})=>e)),g=({children:e,lineClampHeight:t=5.5})=>{const[n,a]=Object(i.useState)(null),[s,o]=(e=>{const[t,n]=Object(i.useState)(null),a=Object(i.useRef)(null);return Object(i.useEffect)((()=>{var e,t,i,r,s,o,l,u,c;null!=(null===(e=a.current)||void 0===e?void 0:e.clientHeight)&&((null!==(t=null==a||null===(i=a.current)||void 0===i?void 0:i.scrollHeight)&&void 0!==t?t:0)>(null!==(r=null==a||null===(s=a.current)||void 0===s?void 0:s.clientHeight)&&void 0!==r?r:0)&&n(!0),(null!==(o=null===(l=a.current)||void 0===l?void 0:l.scrollHeight)&&void 0!==o?o:0)<=(null!==(u=null==a||null===(c=a.current)||void 0===c?void 0:c.clientHeight)&&void 0!==u?u:0)&&n(!1))}),[a,e]),[t,a]})(e),l=Object(i.useCallback)((()=>{a((e=>!e))}),[]);return n?r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{"data-test-subj":"expanded-line-clamp"},r.a.createElement("p",null,e)),s&&r.a.createElement(p,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},m)):r.a.createElement(r.a.Fragment,null,null==s||!0===s?r.a.createElement(b,{"data-test-subj":"styled-line-clamp",ref:o,lineClampHeight:t},e):e,s&&r.a.createElement(p,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},d))},v=r.a.memo(g),y=o.a.div.withConfig({displayName:"Indent",componentId:"sc-1pv3muo-0"})(["padding:0 8px;word-break:break-word;"]),h=Object(i.createContext)({}),j=({basicData:e,ruleNote:t,showFullView:n=!1,showTitle:i=!0})=>r.a.createElement(h.Provider,{value:e},i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(a.EuiTitle,{size:"xxxs","data-test-subj":"summary-view-guide"},r.a.createElement("h5",null,l.q)),r.a.createElement(a.EuiSpacer,{size:"s"})),r.a.createElement(y,null,n?r.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-full-view"},r.a.createElement(u.b,null,t)):r.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-clamped"},r.a.createElement(v,{lineClampHeight:4.5},r.a.createElement(u.b,null,t))))),E=r.a.memo(j)},function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return C})),n.d(t,"c",(function(){return M})),n.d(t,"b",(function(){return I}));var a=n(17),i=n(194),r=n(2),s=n.n(r),o=n(23),l=n.n(o),u=n(48),c=n(112),d=n(128),m=n(181),p=n(138),f=n(119),b=n(116),g=n(122),v=n(113),y=n(197),h=n(228),j=n(14),E=n(460),O=n(665),x=n(130);const S=({asEmptyButton:e,children:t,dataProviders:n,filters:o,timeRange:S,keepDataView:k,...w})=>{var C,T;const M=Object(u.useDispatch)(),{showAssistantOverlay:I}=Object(i.j)(),[A]=Object(O.a)(),{discoverStateContainer:P}=Object(E.a)(),_=Object(x.a)("timelineEsqlTabDisabled"),D=Object(r.useMemo)((()=>d.e.getSourcererDataViewsSelector()),[]),{defaultDataView:F,signalIndexName:N}=Object(c.a)((e=>D(e))),R=n&&n.find((e=>"template"===e.type)),z=Object(h.a)({timelineId:g.c.active,timelineType:R?v.l.template:v.l.default}),L=Object(r.useCallback)((()=>{if(I({showOverlay:!1}),n||o){var e,t,a;if("esql"===(null==n||null===(e=n[0])||void 0===e?void 0:e.queryType)||"sql"===(null==n||null===(t=n[0])||void 0===t?void 0:t.queryType))return null===(a=P.current)||void 0===a||a.appState.update({query:{esql:n[0].kqlQuery}}),M(Object(j.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.esql})),void M(Object(j.showTimeline)({id:g.c.active,show:!0}));if(S?z({timeRange:S}):z(),n)switch(M(Object(j.updateDataView)({id:g.c.active,dataViewId:"security-solution-default",indexNames:["logs-*"]})),n[0].queryType){case"eql":M(Object(j.updateEqlOptions)({id:g.c.active,field:"query",value:n[0].kqlQuery})),M(Object(j.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.eql}));break;case"kql":M(Object(j.applyKqlFilterQuery)({id:g.c.active,filterQuery:{kuery:{kind:"kuery",expression:n[0].kqlQuery},serializedQuery:n[0].kqlQuery}})),M(Object(j.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.query}));break;case"dsl":const e={meta:{type:"custom",disabled:!1,negate:!1,alias:n[0].name,key:"query",value:n[0].kqlQuery},query:JSON.parse(n[0].kqlQuery)};M(Object(j.setFilters)({id:g.c.active,filters:[e]})),M(Object(j.setActiveTabTimeline)({id:g.c.active,activeTab:g.d.query}))}o&&M(Object(j.setFilters)({id:g.c.active,filters:o})),k||M(m.d.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:F.id,selectedPatterns:[N||""]})),M(p.b.removeLinkTo([f.a.timeline,f.a.global]))}}),[I,n,o,S,k,M,z,P,F.id,N]),B=A?y.i:y.h,q=!A;return"esql"!==(null==n||null===(C=n[0])||void 0===C?void 0:C.queryType)&&"sql"!==(null==n||null===(T=n[0])||void 0===T?void 0:T.queryType)||!_?e?s.a.createElement(a.EuiButtonEmpty,{"aria-label":B,onClick:L,isDisabled:q,color:"text",flush:"both",size:"xs"},s.a.createElement(a.EuiToolTip,{position:"right",content:B},s.a.createElement(s.a.Fragment,null,t))):s.a.createElement(a.EuiButton,l()({"aria-label":B,isDisabled:q,onClick:L},w),s.a.createElement(a.EuiToolTip,{position:"right",content:B},s.a.createElement(s.a.Fragment,null,t))):null};S.displayName="SendToTimelineButton";const k="securityAssistant",w=e=>e.map((e=>`Rule Name:${e.name}\nRule Description:${e.description}`)).join("\n\n"),C=e=>e.filter((({field:e})=>!e.startsWith("signal."))).reduce(((e,{field:t,values:n})=>({...e,[t]:null!=n?n:[]})),{}),T=["kql","dsl","eql","esql","sql"],M=({messageContent:e,replacements:t})=>null!=t?Object.keys(t).reduce(((e,n)=>e.replaceAll(n,t[n])),e):e,I=e=>e.messages.map((({content:t})=>Object(i.i)(M({messageContent:null!=t?t:"",replacements:e.replacements})))).map(((t,n)=>t.map(((t,i)=>{var r;return{...t,getControlContainer:()=>document.querySelectorAll(`.message-${n} .euiCodeBlock__controls`)[i],button:T.includes(t.type)?s.a.createElement(S,{asEmptyButton:!0,dataProviders:[{id:"assistant-data-provider",name:`Assistant Query from conversation ${e.id}`,enabled:!0,excluded:!1,queryType:t.type,kqlQuery:null!==(r=t.content)&&void 0!==r?r:"",queryMatch:{field:"host.name",operator:":",value:"test"},and:[]}],keepDataView:!0},s.a.createElement(a.EuiIcon,{type:"timeline"})):null}}))))},,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(4);const i=`${a.Db}/rules/_rule_management_filters`,r=`${a.Db}/rules/_coverage_overview`},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.osquery=function(e,t,n){if(!1===t.startsWith("!{osquery"))return!1;const a=t[9];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i="!{osquery",r={};if("{"===a){let n="",a=0;for(let e=9;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}i+=n;try{r=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse osquery JSON configuration: ${t}`,{line:n.line,column:n.column+9})}}return i+="}",e(i)({type:"osquery",configuration:r})},n.splice(n.indexOf("text"),0,"osquery")}},function(e,t){const n=Object.freeze({loose:!0}),a=Object.freeze({});e.exports=e=>e?"object"!=typeof e?n:e:a},,,,,,function(e,t,n){"use strict";e.exports=n(618)},,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.incompatibleTab.dataQualityDashboardConversationId",{defaultMessage:"Data Quality dashboard"})},function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(395);const s=Object(r.c)(),o=Object(r.c)(),l=()=>{const[e]=Object(a.useState)(s);return{portalNode:e}},u=i.a.memo((()=>{const{portalNode:e}=l();return i.a.createElement(r.b,{node:e})}));u.displayName="TimelineEventsCountBadge";const c=()=>{const[e]=Object(a.useState)(o);return{portalNode:e}},d=i.a.memo((()=>{const{portalNode:e}=c();return i.a.createElement(r.b,{node:e})}));d.displayName="EqlEventsCountBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(23),i=n.n(a),r=n(44),s=n.n(r),o=n(2),l=n.n(o),u=n(17);const c=s()((({loading:e,...t})=>l.a.createElement(u.EuiPanel,i()({},t,{hasBorder:!0})))).withConfig({displayName:"Panel",componentId:"sc-h09jgf-0"})(["position:relative;",""],(({loading:e})=>e&&"\n    overflow: hidden;\n  "));c.displayName="Panel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s}));const a="kibana.alert.rule.name",i="host.name",r=300,s=500},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(2),i=n.n(a);const r=i.a.createContext(null),s=Object(a.memo)((({upsellingService:e,children:t})=>i.a.createElement(r.Provider,{value:e},t)));s.displayName="UpsellingProvider";const o=()=>{const e=Object(a.useContext)(r);if(!e)throw new Error("UpsellingProviderContext not found");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(17);const c=l.a.span.withConfig({displayName:"EllipsisText",componentId:"sc-saif2w-0"})(["&,& *{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;}"]);function d({tooltipContent:e,children:t,dataTestSubj:n,...a}){return e?s.a.createElement(u.EuiToolTip,{display:"block",content:e},s.a.createElement(c,i()({"data-test-subj":n},a),t)):s.a.createElement(c,i()({"data-test-subj":n},a),t)}c.displayName="EllipsisText"},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"c",(function(){return d}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),r=a.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),s=a.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),o=a.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),l=a.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),u=a.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),c=e=>a.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=a.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(706);const r=()=>{const e=Object(a.useContext)(i.a);if(!e)throw new Error("useDiscoverInTimelineContext should only used within a tree with parent as DiscoverInTimelineContextProvider");return e}},function(e,t,n){e.exports=n(24)(1069)},function(e,t,n){"use strict";var a=n(25);n.d(t,"c",(function(){return a.e})),n.d(t,"b",(function(){return a.d})),n.d(t,"d",(function(){return a.f})),n.d(t,"a",(function(){return a.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17),l=n(146),u=n(380);const c=s()(o.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-1819ayg-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),d=i.a.memo(Object(a.forwardRef)((({id:e,field:t,dataTestSubj:n,idAria:r,bottomRightContent:s},d)=>{const{isInvalid:m,errorMessage:p}=Object(l.i)(t),[f,b]=Object(a.useState)(!1);return i.a.createElement(o.EuiFormRow,{"data-test-subj":n,describedByIds:r?[r]:void 0,error:p,fullWidth:!0,helpText:t.helpText,isInvalid:m||f,label:t.label,labelAppend:t.labelAppend},i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{ref:d,ariaLabel:r,editorId:e,onChange:t.setValue,value:t.value,"data-test-subj":`${n}-markdown-editor`,setIsMarkdownInvalid:b}),s&&i.a.createElement(c,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},s))))})));d.displayName="MarkdownEditorForm"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(48),r=n(119),s=n(112),o=n(128),l=n(181);const u=({inputId:e=r.a.global,inspectIndex:t=0,isDisabled:n,multiple:u=!1,onClick:c,onCloseInspect:d,queryId:m})=>{const p=Object(i.useDispatch)(),f=o.d.globalQueryByIdSelector(),b=o.d.timelineQueryByIdSelector(),{loading:g,inspect:v,selectedInspectIndex:y,isInspected:h}=Object(s.a)((t=>e===r.a.global?f(t,m):b(t,m))),j=Object(a.useCallback)((()=>{c&&c(),p(l.c.setInspectionParameter({id:m,inputId:e,isInspected:!0,selectedInspectIndex:t}))}),[c,p,m,e,t]),E=Object(a.useCallback)((()=>{null!=d&&d(),p(l.c.setInspectionParameter({id:m,inputId:e,isInspected:!1,selectedInspectIndex:t}))}),[d,p,m,e,t]);let O=null,x=null;null!=v&&v.dsl.length>0&&(u?[O,...x]=v.dsl:O=v.dsl[t]);let S=null,k=null;null!=v&&v.response.length>0&&(u?[S,...k]=v.response:S=v.response[t]);const w=Object(a.useMemo)((()=>!g&&y===t&&h),[t,h,g,y]);return{additionalRequests:x,additionalResponses:k,handleClick:j,handleCloseModal:E,isButtonDisabled:Object(a.useMemo)((()=>g||n||null==O||null==S||null==m),[n,g,m,O,S]),isShowingModal:w,loading:g,request:O,response:S}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(122),s=n(113),o=n(228);const l=({onClick:e,outline:t,title:n,timelineId:a=r.c.active})=>{const{getButton:i}=Object(o.b)({timelineId:a,timelineType:s.l.template,onClick:e});return i({outline:t,title:n})},u=i.a.memo(l);u.displayName="NewTemplateTimeline"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(17),i=n(2),r=n.n(i),s=n(132),o=n(739);const l=r.a.memo((({hideActions:e=[],modalTitle:t,onClose:n,onOpen:i})=>r.a.createElement(a.EuiModal,{"data-test-subj":"open-timeline-modal",maxWidth:1100,onClose:n},r.a.createElement(o.a,{closeModalTimeline:n,hideActions:e,isModal:!0,defaultPageSize:10,onOpenTimeline:i,title:null!=t?t:s.H}))));l.displayName="OpenTimelineModal"},function(e,t,n){"use strict";n.d(t,"i",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return f}));var a=n(45),i=n(113),r=n(592);const s=(e,t)=>"__typename"!==e&&null!=t?t:void 0,o=e=>!Object(a.isEmpty)(e),l=({isAlert:e,isPinned:t,eventHasNotes:n,timelineType:a})=>a===i.l.template?r.b(e):t&&n?r.d(e):t?r.c(e):r.g(e),u=({eventId:e,pinnedEventIds:t})=>!0===t[e],c=({allowUnpinning:e,eventId:t,onPinEvent:n,onUnPinEvent:a,isEventPinned:i})=>{e&&(i?a(t):n(t))},d=(e,t,n)=>e.reduce(((e,a)=>({...e,...t.includes(a._id)?{[a._id]:a.data.filter((e=>n.includes(e.field)))}:{}})),{}),m=e=>{var t;if(!Object(a.isEmpty)(null===(t=e.eql)||void 0===t?void 0:t.sequenceNumber))try{var n,i;const t=(null!==(n=null===(i=e.eql)||void 0===i?void 0:i.sequenceNumber)&&void 0!==n?n:"").split("-")[0];return parseInt(t,10)%2==0}catch{return!1}return!1},p=e=>{var t,n,i,r;return Object(a.isEmpty)(null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n||null===(i=n.rule)||void 0===i?void 0:i.uuid)?Object(a.isEmpty)(null===(r=e.eql)||void 0===r?void 0:r.parentId)?"raw":"eql":"signal"},f="note-content"},function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.flows="flows",e.dns="dns",e.anomalies="anomalies",e.tls="tls",e.http="http",e.events="events"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(17),l=n(47),u=n(44),c=n.n(u),d=n(112),m=n(151),p=n(134),f=n(118),b=n(305),g=n(266);const v=(e,t)=>(t===g.a.createCase||t===g.a.submitCase)&&e===g.b.alertsCases,y=c()(o.EuiTourStep).withConfig({displayName:"StyledTourStep",componentId:"sc-1l8wop5-0"})(["&.euiPopover__panel[data-popover-open]{z-index:",";}"],(({step:e,tourId:t})=>v(t,e)?"9000 !important":"1000 !important")),h=({children:e,onClick:t,step:n,tourId:a})=>{const{activeStep:u,incrementStep:c,isTourShown:h}=Object(b.b)(),j=Object(r.useMemo)((()=>g.e[a].find((e=>e.step===n))),[n,a]),E=Object(r.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),O=Object(d.b)((e=>{var t;return(null!==(t=E(e,m.f.active))&&void 0!==t?t:p.b).show})),x=Object(r.useCallback)((()=>t?t():c(a)),[c,t,a]),S=Object(r.useCallback)((e=>{"Enter"===e.key&&e.stopPropagation()}),[]),k=v(a,n);if(null==j||(n!==u||!h(a))&&!k||O)return e||null;const{anchor:w,content:C,imageConfig:T,dataTestSubj:M,hideNextButton:I=!1,...A}=j,P=I?s.a.createElement(s.a.Fragment,null):s.a.createElement(o.EuiButtonEmpty,{onClick:x,onKeyDown:S,size:"xs",color:"text",flush:"right","data-test-subj":"onboarding--securityTourNextStepButton","tour-step":"nextButton"},s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.nextStep.buttonLabel",defaultMessage:"Next"})),_={...A,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,C)),T&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiImage,{alt:T.altText,src:T.src,size:"fullWidth"}))),footerAction:P,isStepOpen:!0,onFinish:()=>null,stepsTotal:g.e[a].length,panelProps:{"data-test-subj":M}};return null!=w?s.a.createElement(s.a.Fragment,null,s.a.createElement(y,i()({tourId:a},_,{anchor:w})),s.a.createElement(s.a.Fragment,null,e)):null!=e?s.a.createElement(y,i()({tourId:a},_),e):null},j=({children:e,isTourAnchor:t=!0,...n})=>t?s.a.createElement(h,n,e):s.a.createElement(s.a.Fragment,null,e)},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return E}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r);const o=s.a.aside.attrs({className:"siemUtilityBar"}).withConfig({displayName:"Bar",componentId:"sc-yj1vvr-0"})(["",""],(({border:e,theme:t})=>Object(r.css)([""," @media only screen and (min-width:","){display:flex;justify-content:space-between;}"],e&&Object(r.css)(["border-bottom:",";padding-bottom:",";align-items:center;"],t.eui.euiBorderThin,t.eui.euiSizeXS),t.eui.euiBreakpoints.l)));o.displayName="Bar";const l=s.a.div.attrs({className:"siemUtilityBar__section"}).withConfig({displayName:"BarSection",componentId:"sc-yj1vvr-1"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["& + &{margin-top:",";align-items:center;}@media only screen and (min-width:","){display:flex;flex-wrap:wrap;}@media only screen and (min-width:","){& + &{margin-top:0;margin-left:",";}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBreakpoints.l,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));l.displayName="BarSection";const u=s.a.div.attrs({className:"siemUtilityBar__group"}).withConfig({displayName:"BarGroup",componentId:"sc-yj1vvr-2"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["align-items:flex-start;display:flex;flex-wrap:wrap;& + &{margin-top:",";}@media only screen and (min-width:","){border-right:",";flex-wrap:nowrap;margin-right:",";padding-right:",";& + &{margin-top:0;}&:last-child{border-right:none;margin-right:0;padding-right:0;}}& > *{margin-right:",";&:last-child{margin-right:0;}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBorderThin,t.eui.euiSizeM,t.eui.euiSizeM,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));u.displayName="BarGroup";const c=s.a.p.attrs((({className:e})=>({className:e||"siemUtilityBar__text"}))).withConfig({displayName:"BarText",componentId:"sc-yj1vvr-3"})(["",""],(({shouldWrap:e,theme:t})=>Object(r.css)(["color:",";font-size:",";line-height:",";white-space:",";"],t.eui.euiTextSubduedColor,t.eui.euiFontSizeXS,t.eui.euiLineHeight,e?"normal":"nowrap")));c.displayName="BarText";const d=s.a.div.attrs({className:"siemUtilityBar__action"}).withConfig({displayName:"BarAction",componentId:"sc-yj1vvr-4"})(["",""],(({theme:e})=>Object(r.css)(["font-size:",";"],e.eui.euiFontSizeXS)));d.displayName="BarAction";const m=s.a.div.attrs({className:"siemUtilityBar__spacer"}).withConfig({displayName:"BarSpacer",componentId:"sc-yj1vvr-5"})(["",""],(()=>Object(r.css)(["flex:1;"])));m.displayName="BarSpacer";const p=i.a.memo((({border:e,children:t})=>i.a.createElement(o,{border:e},t)));p.displayName="UtilityBar";var f=n(17),b=n(713);const g=s()(f.EuiButtonEmpty).withConfig({displayName:"LoadingButtonEmpty",componentId:"sc-ou55gk-0"})(["",""],(({theme:e})=>Object(r.css)(["&.euiButtonEmpty{height:",";}"],e.eui.euiSize))),v=i.a.memo((({children:e,color:t,iconSide:n,iconSize:r,iconType:s,popoverContent:o,disabled:l,ownFocus:u,dataTestSubj:c,popoverPanelPaddingSize:d,onClick:m})=>{const[p,g]=Object(a.useState)(!1),v=Object(a.useCallback)((()=>g(!1)),[g]),y=Object(a.useCallback)((()=>{null==m||m(),g(!p)}),[p,m]);return i.a.createElement(f.EuiPopover,{ownFocus:u,panelPaddingSize:d,button:i.a.createElement(b.a,{dataTestSubj:c,color:t,iconSide:n,iconSize:r,iconType:s,disabled:l,onClick:y},e),closePopover:v,isOpen:p,repositionOnScroll:!0},null==o?void 0:o(v))}));v.displayName="Popover";const y=i.a.memo((({children:e,color:t,dataTestSubj:n,disabled:a,href:r,iconSide:s,iconSize:o,iconType:l,ownFocus:u,onClick:c,popoverContent:m,popoverPanelPaddingSize:p,inProgress:f})=>f?i.a.createElement(d,null,i.a.createElement(g,{"data-test-subj":`${n}-progress`,size:"xs",className:"eui-alignTop",isLoading:!0,iconSide:"right",flush:"both"},e)):i.a.createElement(d,{"data-test-subj":n},m?i.a.createElement(v,{dataTestSubj:`${n}-popover`,disabled:a,color:t,iconSide:s,iconSize:o,iconType:l,ownFocus:u,popoverPanelPaddingSize:p,popoverContent:m,onClick:c},e):i.a.createElement(b.a,{color:t,dataTestSubj:`${n}-linkIcon`,disabled:a,href:r,iconSide:s,iconSize:o,iconType:l,onClick:c},e))));y.displayName="UtilityBarAction";const h=i.a.memo((({grow:e,children:t})=>i.a.createElement(u,{grow:e},t)));h.displayName="UtilityBarGroup";const j=i.a.memo((({grow:e,children:t,dataTestSubj:n})=>i.a.createElement(l,{grow:e,"data-test-subj":n},t)));j.displayName="UtilityBarSection",i.a.memo((({dataTestSubj:e})=>i.a.createElement(m,{"data-test-subj":e}))).displayName="UtilityBarSpacer";const E=i.a.memo((({children:e,dataTestSubj:t,shouldWrap:n=!1,className:a})=>i.a.createElement(c,{"data-test-subj":t,shouldWrap:n,className:a},e)));E.displayName="UtilityBarText"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=`${n(4).Db}/fleet/integrations/installed`},,,function(e,t,n){"use strict";n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return g}));var a=n(61),i=n.n(a),r=n(294),s=n(198),o=n(51);const l=Object(o.v4)();var u,c,d=n(725);const m=(e,t)=>n=>`${d.g}: ${i()(n).format(e)} ${t?d.f(n):d.e(n)}`,p=[{text:"event.action",value:"event.action"},{text:"event.dataset",value:"event.dataset"},{text:"event.module",value:"event.module"}],f={defaultStackByOption:null!==(u=p.find((e=>"event.action"===e.text)))&&void 0!==u?u:p[0],errorMessage:d.c,histogramType:r.i.events,stackByOptions:p,subtitle:void 0,title:d.d,getLensAttributes:(e="event.action",t={})=>{var n;return{title:"Events",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:l,accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:null!==(n=t.filters)&&void 0!==n?n:[],datasourceStates:{formBased:{layers:{[l]:{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${l}`}]}}},b=[{text:"event.category",value:"event.category"},{text:"event.module",value:"event.module"}],g={defaultStackByOption:null!==(c=b.find((e=>"event.module"===e.text)))&&void 0!==c?c:b[0],errorMessage:d.b,histogramType:r.i.alerts,stackByOptions:b,subtitle:void 0,title:d.a,getLensAttributes:(e="event.module")=>({title:"External alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"a3c54471-615f-4ff9-9fda-69b5b2ea3eef",accessors:["0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"37bdf546-3c11-4b08-8c5d-e37debc44f1d",splitAccessor:"42334c6e-98d9-47a2-b4cb-a445abb44c93"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:[{meta:{index:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{match_phrase:{"event.kind":"alert"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"a3c54471-615f-4ff9-9fda-69b5b2ea3eef":{columns:{"37bdf546-3c11-4b08-8c5d-e37debc44f1d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"0a923af2-c880-4aa3-aa93-a0b9c2801f6d":{label:s.g,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"42334c6e-98d9-47a2-b4cb-a445abb44c93":{label:Object(s.p)(`${e}`),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"0a923af2-c880-4aa3-aa93-a0b9c2801f6d"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["42334c6e-98d9-47a2-b4cb-a445abb44c93","37bdf546-3c11-4b08-8c5d-e37debc44f1d","0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-a3c54471-615f-4ff9-9fda-69b5b2ea3eef"},{type:"index-pattern",name:"723c4653-681b-4105-956e-abef287bf025",id:"{dataViewId}"},{type:"index-pattern",name:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",id:"{dataViewId}"}]})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(45),i=n(429),r=n(2),s=n(561),o=n(405),l=n(194),u=n(154),c=n(215),d=n(720),m=n(520);const p={[c.e]:{id:c.e,isDefault:!0,messages:[],apiConfig:{}},[i.a]:{id:i.a,isDefault:!0,messages:[],apiConfig:{}},[u.yb]:{id:u.yb,isDefault:!0,messages:[],apiConfig:{}},[c.i]:{id:c.i,isDefault:!0,messages:[],apiConfig:{}},[m.a]:{excludeFromLastConversationStorage:!0,id:m.a,isDefault:!0,messages:[],apiConfig:{}},[l.h]:{id:l.h,isDefault:!0,theme:{title:l.e,titleIcon:"logoSecurity",assistant:{name:d.f,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}},messages:[],apiConfig:{}}};var f=n(20),b=n(39);const g=()=>{const e=Object(f.f)(b.SecurityPageName.dataQuality),t=Object(r.useMemo)((()=>e?p:Object(a.unset)(i.a,p)),[e]),[n,l]=Object(s.a)({defaultValue:t,key:o.a,isInvalidDefault:e=>!e});return{conversations:n,setConversations:l}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(2),i=n(157),r=n(20);const s=e=>{const t=o();return Object(a.useMemo)((()=>t(e)),[t,e])},o=()=>{const e=Object(i.a)();return Object(a.useCallback)((t=>((e,t)=>Object(r.d)(e)&&t.length>0?`?${t}`:"")(t,e)),[e])}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(51);const i=()=>Object(a.v4)(),r=({prevPromptContexts:e,promptContext:t})=>({...e,[t.id]:{...t}})},function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return f}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAriaLabel",{defaultMessage:"Settings"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsTooltip",{defaultMessage:"Settings"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsUpdatedToastTitle",{defaultMessage:"Settings updated"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsConversationsMenuItemTitle",{defaultMessage:"Conversations"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsQuickPromptsMenuItemTitle",{defaultMessage:"Quick Prompts"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsSystemPromptsMenuItemTitle",{defaultMessage:"System Prompts"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAnonymizationMenuItemTitle",{defaultMessage:"Anonymization"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsKnowledgeBaseMenuItemTitle",{defaultMessage:"Knowledge Base"}),m=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsEvaluationMenuItemTitle",{defaultMessage:"Evaluation"}),p=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.modalTitle",{defaultMessage:"System Prompts"}),a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"})),f=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));const a=e=>"string"!=typeof e,i=({field:e,list:t,operation:n})=>"add"===n?t.includes(e)?t:[...t,e]:t.filter((t=>t!==e)),r=({field:e,operation:t,selectedPromptContext:n,update:a})=>{const{allow:r,allowReplacement:s}=n;switch(a){case"allow":return{...n,allow:i({field:e,list:r,operation:t})};case"allowReplacement":return{...n,allowReplacement:i({field:e,list:s,operation:t})};default:return n}},s=({currentList:e,setDefaultList:t,update:n,updates:a})=>{const r=a.filter((e=>e.update===n));r.length>0&&t(r.reduce(((e,{field:t,operation:n})=>i({field:t,list:e,operation:n})),e))},o=({defaultAllow:e,defaultAllowReplacement:t,setDefaultAllow:n,setDefaultAllowReplacement:a,updates:i})=>{s({currentList:e,setDefaultList:n,update:"defaultAllow",updates:i}),s({currentList:t,setDefaultList:a,update:"defaultAllowReplacement",updates:i})}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.placeholderText",{defaultMessage:"Select or type to create new..."}),r=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.modelTitle",{defaultMessage:"Model"}),s=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.helpLabel",{defaultMessage:"Model to use for this connector"}),o=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.customOptionText",{defaultMessage:"Create new Model named"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(17),i=n(2),r=n.n(i),s=n(220),o=n(177),l=n(497),u=n(123),c=n(252),d=n(548),m=n(13);const p="ADD_NEW_CONNECTOR",f=r.a.memo((({isDisabled:e=!1,isOpen:t=!1,displayFancy:n,selectedConnectorId:f,onConnectorSelectionChange:b,setIsOpen:g})=>{const{actionTypeRegistry:v,http:y,assistantAvailability:h}=Object(u.b)(),[j,E]=Object(i.useState)(!1),{data:O}=Object(l.a)({http:y}),[x,S]=Object(i.useState)(null),{data:k,isLoading:w,isFetching:C,refetch:T}=Object(s.a)({http:y}),M=Object(i.useMemo)((()=>k?k.map((e=>({...e,connectorTypeTitle:Object(c.a)(v.get(e.actionTypeId))}))):[]),[v,k]),I=w||C,A=e||!h.hasConnectorsReadPrivilege,P=Object(i.useMemo)((()=>({value:p,inputDisplay:o.e,dropdownDisplay:Object(m.jsx)(a.EuiFlexGroup,{gutterSize:"none",key:p},Object(m.jsx)(a.EuiFlexItem,{grow:!0},Object(m.jsx)(a.EuiButtonEmpty,{"data-test-subj":"addNewConnectorButton",href:"#",iconType:"plus",size:"xs"},o.e)),Object(m.jsx)(a.EuiFlexItem,{grow:!1},Object(m.jsx)("div",{style:{width:"24px"}})))})),[]),_=Object(i.useMemo)((()=>M.map((e=>{var t,i;const s=null!==(t=null===(i=Object(c.b)(e))||void 0===i?void 0:i.apiProvider)&&void 0!==t?t:e.connectorTypeTitle,l=e.isPreconfigured?o.r:s;return{value:e.id,"data-test-subj":e.id,inputDisplay:n?n(e.name):e.name,dropdownDisplay:Object(m.jsx)(r.a.Fragment,{key:e.id},Object(m.jsx)("strong",null,e.name),l&&Object(m.jsx)(a.EuiText,{size:"xs",color:"subdued"},Object(m.jsx)("p",null,l)))}}))),[M,n]),D=Object(i.useMemo)((()=>h.hasConnectorsAllPrivilege?[..._,P]:[..._]),[P,h.hasConnectorsAllPrivilege,_]),F=Object(i.useCallback)((()=>{null==g||g(!1),E(!1),S(null)}),[g]),[N,R]=Object(i.useState)(t),z=Object(i.useCallback)((e=>{if(e===p)return R(!1),void E(!0);const t=M.find((t=>t.id===e));t&&b(t)}),[M,b]),L=Object(i.useCallback)((e=>{b({...e,connectorTypeTitle:Object(c.a)(v.get(e.actionTypeId))}),null==T||T(),F()}),[v,F,b,T]);return Object(m.jsx)(r.a.Fragment,null,Object(m.jsx)(a.EuiSuperSelect,{"aria-label":o.f,compressed:!0,"data-test-subj":"connector-selector",disabled:A,hasDividers:!0,isLoading:I,isOpen:N,onChange:z,options:D,valueOfSelected:null!=f?f:""}),j&&Object(m.jsx)(d.a,{actionTypeRegistry:v,actionTypes:O,onClose:()=>E(!1),onSaveConnector:L,onSelectActionType:e=>S(e),selectedActionType:x}))}));f.displayName="ConnectorSelector"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(50),i=n(76),r=n(72),s=n(177);const o=["elastic-assistant, load-action-types"],l=({http:e,toasts:t})=>Object(a.useQuery)(o,(async()=>(await Object(i.loadActionTypes)({http:e,featureId:r.GenerativeAIConnectorFeatureId})).sort(((e,t)=>e.name.localeCompare(t.name)))),{retry:!1,keepPreviousData:!0,staleTime:6e4,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.n}))}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(2),i=n.n(a),r=n(17),s=n(495),o=n(13);const l="gpt-3.5-turbo",u=[l,"gpt-4"],c=i.a.memo((({models:e=u,onModelSelectionChange:t,selectedModel:n=u[0]})=>{const[i,l]=Object(a.useState)(e.map((e=>({"data-test-subj":e,label:e})))),c=Object(a.useMemo)((()=>n?[{label:n}]:[]),[n]),d=Object(a.useCallback)((n=>{var a,i;const r=0===n.length?void 0:null!==(a=e.find((e=>{var t;return e===(null===(t=n[0])||void 0===t?void 0:t.label)})))&&void 0!==a?a:null===(i=n[0])||void 0===i?void 0:i.label;null==t||t(r)}),[t,e]),m=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||l([...i,a]),d([a])}),[d,i]),p=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==i.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[d,i]);return Object(o.jsx)(r.EuiComboBox,{"aria-label":s.b,compressed:!0,"data-test-subj":"model-selector",isClearable:!1,placeholder:s.d,customOptionText:`${s.a} {searchValue}`,singleSelection:{asPlainText:!0},options:i,selectedOptions:c,onChange:p,onCreateOption:m,fullWidth:!0})}));c.displayName="ModelSelector"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importStar(n(2)),r=n(2),s=a.__importDefault(n(255)),o=a.__importDefault(n(772));t.default=function(e){return function(t){var n,l;l=i.isValidElement(t)?(n=t).props:t;var u=s.default({buffered:[],time:0,duration:0,paused:!0,muted:!1,volume:1}),c=u[0],d=u[1],m=r.useRef(null),p=function(e,t){return function(n){try{t&&t(n)}finally{e&&e(n)}}},f=function(){return d({paused:!1})},b=function(){return d({paused:!0})},g=function(){var e=m.current;e&&d({muted:e.muted,volume:e.volume})},v=function(){var e=m.current;if(e){var t=e.duration,n=e.buffered;d({duration:t,buffered:o.default(n)})}},y=function(){var e=m.current;e&&d({time:e.currentTime})},h=function(){var e=m.current;e&&d({buffered:o.default(e.buffered)})};n=n?i.cloneElement(n,a.__assign(a.__assign({controls:!1},l),{ref:m,onPlay:p(l.onPlay,f),onPause:p(l.onPause,b),onVolumeChange:p(l.onVolumeChange,g),onDurationChange:p(l.onDurationChange,v),onTimeUpdate:p(l.onTimeUpdate,y),onProgress:p(l.onProgress,h)})):i.createElement(e,a.__assign(a.__assign({controls:!1},l),{ref:m,onPlay:p(l.onPlay,f),onPause:p(l.onPause,b),onVolumeChange:p(l.onVolumeChange,g),onDurationChange:p(l.onDurationChange,v),onTimeUpdate:p(l.onTimeUpdate,y),onProgress:p(l.onProgress,h)}));var j=!1,E={play:function(){var e=m.current;if(e&&!j){var t=e.play();if("object"==typeof t){j=!0;var n=function(){j=!1};t.then(n,n)}return t}},pause:function(){var e=m.current;if(e&&!j)return e.pause()},seek:function(e){var t=m.current;t&&void 0!==c.duration&&(e=Math.min(c.duration,Math.max(0,e)),t.currentTime=e)},volume:function(e){var t=m.current;t&&(e=Math.min(1,Math.max(0,e)),t.volume=e,d({volume:e}))},mute:function(){var e=m.current;e&&(e.muted=!0)},unmute:function(){var e=m.current;e&&(e.muted=!1)}};return r.useEffect((function(){var e=m.current;e&&(d({volume:e.volume,muted:e.muted,paused:e.paused}),l.autoPlay&&e.paused&&E.play())}),[l.src]),[n,c,E,m]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e,t){return"boolean"==typeof t?t:!e};t.default=function(e){return a.useReducer(i,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(502)),s=n(301);t.default=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=null),void 0===n&&(n=null);var a=s.resolveHookState(e);"number"!=typeof a&&console.error("initialValue has to be a number, got "+typeof e),"number"==typeof n?a=Math.max(a,n):null!==n&&console.error("min has to be a number, got "+typeof n),"number"==typeof t?a=Math.min(a,t):null!==t&&console.error("max has to be a number, got "+typeof t);var o=r.default(a),l=o[0],u=o[1];return[l(),i.useMemo((function(){var e=function(e){var a=l(),i=s.resolveHookState(e,a);a!==i&&("number"==typeof n&&(i=Math.max(i,n)),"number"==typeof t&&(i=Math.min(i,t)),a!==i&&u(i))};return{get:l,set:e,inc:function(t){void 0===t&&(t=1);var n=s.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e+n}))},dec:function(t){void 0===t&&(t=1);var n=s.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e-n}))},reset:function(t){void 0===t&&(t=a);var n=s.resolveHookState(t,l());"number"!=typeof n&&console.error("value has to be a number or function returning a number, got "+typeof n),a=n,e(n)}}}),[a,n,t])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(223)),s=n(301);t.default=function(e){var t=i.useRef(s.resolveHookState(e)),n=r.default();return i.useMemo((function(){return[function(){return t.current},function(e){t.current=s.resolveHookState(e,t.current),n()}]}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useState(!1),i=n[0],r=n[1];return a.useEffect((function(){var n=function(){return r(!0)},a=function(){return r(!1)};t&&e&&e.current&&(e.current.addEventListener("mouseover",n),e.current.addEventListener("mouseout",a));var i=e.current;return function(){t&&i&&(i.removeEventListener("mouseover",n),i.removeEventListener("mouseout",a))}}),[t,e]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(302)),s=function(){};t.default=function(e,t,n,a){void 0===t&&(t=s),void 0===n&&(n={}),void 0===a&&(a=[e]);var o=n.event,l=void 0===o?"keydown":o,u=n.target,c=n.options,d=i.useMemo((function(){var n,a="function"==typeof(n=e)?n:"string"==typeof n?function(e){return e.key===n}:n?function(){return!0}:function(){return!1};return function(e){if(a(e))return t(e)}}),a);r.default(l,d,u,c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(504));t.default=function(e){var t=i.useState([!1,null]),n=t[0],a=t[1];return r.default(e,(function(e){return a([!0,e])}),{event:"keydown"},[n]),r.default(e,(function(e){return a([!1,e])}),{event:"keyup"},[n]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef(e);return t.current=e,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){a.useEffect((function(){return e&&e(),function(){t&&t()}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(223)),s=n(301);t.default=function(e){void 0===e&&(e=[]);var t=i.useRef(s.resolveHookState(e)),n=r.default(),a=i.useMemo((function(){var i={set:function(e){t.current=s.resolveHookState(e,t.current),n()},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length&&a.set((function(t){return t.concat(e)}))},updateAt:function(e,t){a.set((function(n){var a=n.slice();return a[e]=t,a}))},insertAt:function(e,t){a.set((function(n){var a=n.slice();return e>a.length?a[e]=t:a.splice(e,0,t),a}))},update:function(e,t){a.set((function(n){return n.map((function(n){return e(n,t)?t:n}))}))},updateFirst:function(e,n){var i=t.current.findIndex((function(t){return e(t,n)}));i>=0&&a.updateAt(i,n)},upsert:function(e,n){var i=t.current.findIndex((function(t){return e(t,n)}));i>=0?a.updateAt(i,n):a.push(n)},sort:function(e){a.set((function(t){return t.slice().sort(e)}))},filter:function(e,t){a.set((function(n){return n.slice().filter(e,t)}))},removeAt:function(e){a.set((function(t){var n=t.slice();return n.splice(e,1),n}))},clear:function(){a.set([])},reset:function(){a.set(s.resolveHookState(e).slice())}};return i.remove=i.removeAt,i}),[]);return[t.current,a]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(256));t.default=function(e){a.default((function(){e()}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(257));t.default=function(e){var t=r.default({docX:0,docY:0,posX:0,posY:0,elX:0,elY:0,elH:0,elW:0}),n=t[0],a=t[1];return i.useEffect((function(){var t=function(t){if(e&&e.current){var n=e.current.getBoundingClientRect(),i=n.left,r=n.top,s=n.width,o=n.height,l=i+window.pageXOffset,u=r+window.pageYOffset,c=t.pageX-l,d=t.pageY-u;a({docX:t.pageX,docY:t.pageY,posX:l,posY:u,elX:c,elY:d,elH:o,elW:s})}};return document.addEventListener("mousemove",t),function(){document.removeEventListener("mousemove",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(40));t.default=function(e,t){void 0===e&&(e=1e12),void 0===t&&(t=0);var n=i.useState(0),a=n[0],s=n[1];return r.default((function(){var n,a,i,r=function(){var t=Math.min(1,(Date.now()-i)/e);s(t),o()},o=function(){n=requestAnimationFrame(r)},l=setTimeout((function(){a=setTimeout((function(){cancelAnimationFrame(n),s(1)}),e),i=Date.now(),o()}),t);return function(){clearTimeout(a),clearTimeout(l),cancelAnimationFrame(n)}}),[e,t]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=parseInt(i.version.substr(0,i.version.indexOf(".")))>15,s=function(e){return"function"==typeof e};t.default=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var l=e.render,u=e.children,c=void 0===u?l:u,d=e.component,m=e.comp,p=void 0===m?d:m;return s(c)?c.apply(void 0,a.__spreadArrays([t],n)):p?i.createElement(p,t):c instanceof Array?r?c:i.createElement.apply(void 0,a.__spreadArrays(["div",null],c)):c&&c instanceof Object?"string"==typeof c.type?c:i.cloneElement(c,Object.assign({},c.props,t)):c||null}},function(e,t,n){!function(e){"use strict";var t,n=[],a="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(t||(t={}));var i,r=function(e){return Object.freeze(e)},s=function(e,t){this.inlineSize=e,this.blockSize=t,r(this)},o=function(){function e(e,t,n,a){return this.x=e,this.y=t,this.width=n,this.height=a,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,r(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),l=function(e){return e instanceof SVGElement&&"getBBox"in e},u=function(e){if(l(e)){var t=e.getBBox(),n=t.width,a=t.height;return!n&&!a}var i=e,r=i.offsetWidth,s=i.offsetHeight;return!(r||s||e.getClientRects().length)},c=function(e){var t;if(e instanceof Element)return!0;var n=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(n&&e instanceof n.Element)},d="undefined"!=typeof window?window:{},m=new WeakMap,p=/auto|scroll/,f=/^tb|vertical/,b=/msie|trident/i.test(d.navigator&&d.navigator.userAgent),g=function(e){return parseFloat(e||"0")},v=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new s((n?t:e)||0,(n?e:t)||0)},y=r({devicePixelContentBoxSize:v(),borderBoxSize:v(),contentBoxSize:v(),contentRect:new o(0,0,0,0)}),h=function(e,t){if(void 0===t&&(t=!1),m.has(e)&&!t)return m.get(e);if(u(e))return m.set(e,y),y;var n=getComputedStyle(e),a=l(e)&&e.ownerSVGElement&&e.getBBox(),i=!b&&"border-box"===n.boxSizing,s=f.test(n.writingMode||""),c=!a&&p.test(n.overflowY||""),d=!a&&p.test(n.overflowX||""),h=a?0:g(n.paddingTop),j=a?0:g(n.paddingRight),E=a?0:g(n.paddingBottom),O=a?0:g(n.paddingLeft),x=a?0:g(n.borderTopWidth),S=a?0:g(n.borderRightWidth),k=a?0:g(n.borderBottomWidth),w=O+j,C=h+E,T=(a?0:g(n.borderLeftWidth))+S,M=x+k,I=d?e.offsetHeight-M-e.clientHeight:0,A=c?e.offsetWidth-T-e.clientWidth:0,P=i?w+T:0,_=i?C+M:0,D=a?a.width:g(n.width)-P-A,F=a?a.height:g(n.height)-_-I,N=D+w+A+T,R=F+C+I+M,z=r({devicePixelContentBoxSize:v(Math.round(D*devicePixelRatio),Math.round(F*devicePixelRatio),s),borderBoxSize:v(N,R,s),contentBoxSize:v(D,F,s),contentRect:new o(O,h,D,F)});return m.set(e,z),z},j=function(e,n,a){var i=h(e,a),r=i.borderBoxSize,s=i.contentBoxSize,o=i.devicePixelContentBoxSize;switch(n){case t.DEVICE_PIXEL_CONTENT_BOX:return o;case t.BORDER_BOX:return r;default:return s}},E=function(e){var t=h(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=r([t.borderBoxSize]),this.contentBoxSize=r([t.contentBoxSize]),this.devicePixelContentBoxSize=r([t.devicePixelContentBoxSize])},O=function(e){if(u(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},x=function(){var e=1/0,t=[];n.forEach((function(n){if(0!==n.activeTargets.length){var a=[];n.activeTargets.forEach((function(t){var n=new E(t.target),i=O(t.target);a.push(n),t.lastReportedSize=j(t.target,t.observedBox),i<e&&(e=i)})),t.push((function(){n.callback.call(n.observer,a,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var a=0,i=t;a<i.length;a++)(0,i[a])();return e},S=function(e){n.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(O(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},k=function(){var e,t=0;for(S(t);n.some((function(e){return e.activeTargets.length>0}));)t=x(),S(t);return n.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:a}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=a),window.dispatchEvent(e)),t>0},w=[],C=function(e){if(!i){var t=0,n=document.createTextNode("");new MutationObserver((function(){return w.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),i=function(){n.textContent="".concat(t?t--:t++)}}w.push(e),i()},T=0,M={attributes:!0,characterData:!0,childList:!0,subtree:!0},I=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],A=function(e){return void 0===e&&(e=0),Date.now()+e},P=!1,_=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t,n=this;if(void 0===e&&(e=250),!P){P=!0;var a=A(e);t=function(){var t=!1;try{t=k()}finally{if(P=!1,e=a-A(),!T)return;t?n.run(1e3):e>0?n.run(e):n.start()}},C((function(){requestAnimationFrame(t)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,M)};document.body?t():d.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),I.forEach((function(t){return d.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),I.forEach((function(t){return d.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),D=function(e){!T&&e>0&&_.start(),!(T+=e)&&_.stop()},F=function(){function e(e,n){this.target=e,this.observedBox=n||t.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=j(this.target,this.observedBox,!0);return e=this.target,!l(e)&&!function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)&&"inline"===getComputedStyle(e).display&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),N=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},R=new WeakMap,z=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},L=function(){function e(){}return e.connect=function(e,t){var n=new N(e,t);R.set(e,n)},e.observe=function(e,t,a){var i=R.get(e),r=0===i.observationTargets.length;z(i.observationTargets,t)<0&&(r&&n.push(i),i.observationTargets.push(new F(t,a&&a.box)),D(1),_.schedule())},e.unobserve=function(e,t){var a=R.get(e),i=z(a.observationTargets,t),r=1===a.observationTargets.length;i>=0&&(r&&n.splice(n.indexOf(a),1),a.observationTargets.splice(i,1),D(-1))},e.disconnect=function(e){var t=this,n=R.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),B=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");L.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!c(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");L.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!c(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");L.unobserve(this,e)},e.prototype.disconnect=function(){L.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();e.ResizeObserver=B,e.ResizeObserverEntry=E,e.ResizeObserverSize=s,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t){const n=/^[0-9]+$/,a=(e,t)=>{const a=n.test(e),i=n.test(t);return a&&i&&(e=+e,t=+t),e===t?0:a&&!i?-1:i&&!a?1:e<t?-1:1};e.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(145);const l=s.a.div.withConfig({displayName:"ProviderContainerComponent",componentId:"sc-11ewwh0-0"})([""," ",""],(({isDragging:e})=>!e&&Object(r.css)(["&{border-radius:2px;padding:0 4px 0 8px;position:relative;z-index:"," !important;&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );background-position:0 0,1px 0,1px -1px,0px 1px;background-size:2px 2px;bottom:2px;content:'';display:block;left:2px;position:absolute;top:2px;width:4px;}}&:hover{&,& .euiBadge,& .euiBadge__text{cursor:move;cursor:grab;}}.",":hover &,tr:hover &{&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}&:hover,&:focus,.",":hover &:hover,.",":focus &:focus,tr:hover &:hover,tr:hover &:focus{background-color:",";&,& a,& a:hover{color:",";}&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}"],(({theme:e})=>e.eui.euiZLevel0),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),o.f,(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),o.f,o.f,(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade))),(({isDragging:e})=>e&&Object(r.css)(["&{z-index:9999 !important;}"])));l.displayName="ProviderContainerComponent";const u=i.a.memo(l);u.displayName="ProviderContainer"},function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"o",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"m",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return m})),n.d(t,"g",(function(){return p})),n.d(t,"l",(function(){return f})),n.d(t,"i",(function(){return b})),n.d(t,"k",(function(){return g})),n.d(t,"f",(function(){return v})),n.d(t,"e",(function(){return y}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.timeline.tour.subTitle",{defaultMessage:"Recent Timeline improvements"}),r=a.i18n.translate("xpack.securitySolution.timeline.tour.newTimeline.title",{defaultMessage:"Actions are now easier to find"}),s=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.title",{defaultMessage:"The query builder is collapsed by default"}),o=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.description",{defaultMessage:"Click to expand or collapse the query builder."}),l=a.i18n.translate("xpack.securitySolution.timeline.tour.saveTimeline.title",{defaultMessage:"An easier way to save new changes"}),u=a.i18n.translate("xpack.securitySolution.timeline.tour.changeDataView.title",{defaultMessage:"The Data view menu has moved"}),c=a.i18n.translate("xpack.securitySolution.timeline.tour.addToFavorites.title",{defaultMessage:"A new and intuitive way to favorite your Timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.tour.next",{defaultMessage:"Next"}),m=a.i18n.translate("xpack.securitySolution.timeline.tour.finish",{defaultMessage:"Finish tour"}),p=a.i18n.translate("xpack.securitySolution.timeline.tour.exit",{defaultMessage:"Exit tour"}),f=a.i18n.translate("xpack.securitySolution.timeline.tour.save",{defaultMessage:"Save"}),b=a.i18n.translate("xpack.securitySolution.timeline.tour.new",{defaultMessage:"New"}),g=a.i18n.translate("xpack.securitySolution.timeline.tour.open",{defaultMessage:"Open"}),v=a.i18n.translate("xpack.securitySolution.timeline.tour.edit",{defaultMessage:"Edit"}),y=a.i18n.translate("xpack.securitySolution.timeline.tour.dataView",{defaultMessage:"Data view"})},function(e,t,n){"use strict";e.exports=n(869)},function(e,t,n){"use strict";e.exports=n(871)},function(e,t,n){"use strict";e.exports=n(872)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.assistant.conversations.timelineConversationTitle",{defaultMessage:"Timeline"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.topN.closeButtonLabel",{defaultMessage:"Close"}),r=a.i18n.translate("xpack.securitySolution.topN.allEventsSelectLabel",{defaultMessage:"Alerts and events"}),s=a.i18n.translate("xpack.securitySolution.topN.rawEventsSelectLabel",{defaultMessage:"Raw events"}),o=a.i18n.translate("xpack.securitySolution.topN.alertEventsSelectLabel",{defaultMessage:"Detection alerts"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n(4),r=n(469),s=n(121),o=n(112),l=n(128),u=n(116),c=n(202),d=n(190);const m=({applyGlobalQueriesAndFilters:e=!0,extraOptions:t,getLensAttributes:n,lensAttributes:m,scopeId:p=u.SourcererScopeName.default,stackByField:f,title:b})=>{var g,v;const{selectedPatterns:y,dataViewId:h,indicesExist:j}=Object(s.d)(p),E=Object(a.useMemo)((()=>l.d.globalQuerySelector()),[]),O=Object(a.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),x=Object(o.a)(E),S=Object(o.a)(O),[{detailName:k,pageName:w,tabName:C}]=Object(c.a)(),T=Object(a.useMemo)((()=>C===r.a.events?w===i.yc.network?d.h:Object(d.b)(w):[]),[w,C]),M=Object(a.useMemo)((()=>[i.yc.hosts,i.yc.users].indexOf(w)>=0&&null!=k?Object(d.c)(w,k):i.yc.network===w?Object(d.e)(k):[]),[k,w]),I=Object(a.useMemo)((()=>null!=m?m:n&&f&&n(f,t)),[t,n,m,f]),A=Object.values(null!==(g=null==I||null===(v=I.state)||void 0===v?void 0:v.adHocDataViews)&&void 0!==g?g:{}).length>0,P=Object(a.useMemo)((()=>{var t;if(null==m&&(null==n||null==f||0===(null==f?void 0:f.length)))return null;const a=A?[]:Object(d.d)(y);return{...I,...null!=b?{title:b}:{},state:{...I.state,...e?{query:x}:{},filters:[...I.state.filters,...M,...T,...a,...e?S:[]]},references:null==I||null===(t=I.references)||void 0===t?void 0:t.map((e=>({...e,id:h})))}}),[e,I,h,S,n,A,m,M,x,y,f,T,b]);return A||!A&&j?P:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(68),r=n(39),s=n(110),o=n(198);const l=({onAddToCaseClicked:e,lensAttributes:t,timeRange:n})=>{const{cases:l}=Object(s.i)().services,u=l.helpers.canUseCases([r.APP_ID]),c=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:t,timeRange:n},persistableStateAttachmentTypeId:i.LENS_ATTACHMENT_TYPE,type:i.AttachmentType.persistableState}]),[t,n]),d=l.hooks.useCasesAddToExistingCaseModal({onClose:e,successToaster:{title:o.b}});return{onAddToExistingCaseClicked:Object(a.useCallback)((()=>{e&&e(),d.open({getAttachments:()=>c})}),[c,e,d]),disabled:null==t||null==n||!u.create||!u.read}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(68),r=n(39),s=n(110),o=n(198);const l=({onClick:e,timeRange:t,lensAttributes:n})=>{const{cases:l}=Object(s.i)().services,u=l.helpers.canUseCases([r.APP_ID]),c=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:n,timeRange:t},persistableStateAttachmentTypeId:i.LENS_ATTACHMENT_TYPE,type:i.AttachmentType.persistableState}]),[n,t]),d=l.hooks.useCasesAddToNewCaseFlyout({toastContent:o.b});return{onAddToNewCaseClicked:Object(a.useCallback)((()=>{e&&e(),d.open({attachments:c})}),[c,d,e]),disabled:null==n||null==t||!u.create||!u.read}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(17),s=n(44);const o=n.n(s)()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1tb0fg5-0"})(["flex:1;"]),l=()=>i.a.createElement(o,{alignItems:"center",justifyContent:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}))),u=i.a.memo(l)},function(e,t,n){"use strict";var a=n(305);n.d(t,"b",(function(){return a.b})),n.d(t,"a",(function(){return a.a}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(185);const i=(e,t)=>`/name/${e}${Object(a.a)(t)}`,r=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`,s=(e,t)=>`/${e}${Object(a.a)(t)}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(17),i=n(44),r=n.n(i),s=n(2),o=n.n(s),l=n(432),u=n(398),c=n(399);const d=r()(a.EuiPanel).withConfig({displayName:"KpiPanel",componentId:"sc-12zc7xr-0"})(["display:flex;flex-direction:column;position:relative;overflow-x:hidden;overflow-y:",";@media only screen and (min-width:","){","}",""],(({$overflowY:e})=>null!=e?e:"hidden"),(e=>e.theme.eui.euiBreakpoints.m),(({height:e,$toggleStatus:t})=>t&&`\n      height: ${null!=e?e:l.d}px;\n  `),(({$toggleStatus:e})=>e&&`\n    height: ${l.c}px;\n  `)),m=r.a.div.withConfig({displayName:"StackByComboBoxWrapper",componentId:"sc-12zc7xr-1"})(["max-width:400px;width:","px;"],(({width:e})=>e)),p=o.a.forwardRef((({"aria-label":e=c.c,"data-test-subj":t,isDisabled:n=!1,onSelect:i,prepend:r=c.d,selected:l,inputRef:d,width:p=400,dropDownoptions:f,useLensCompatibleFields:b},g)=>{const v=Object(s.useCallback)((e=>{e&&e.length>0?i(e[0].value):i("")}),[i]),y=Object(s.useMemo)((()=>[{label:l,value:l}]),[l]),h=Object(u.b)(b),j=Object(s.useMemo)((()=>null!=f?f:h()),[f,h]),E=Object(s.useMemo)((()=>({asPlainText:!0})),[]);return o.a.createElement(m,{width:p},o.a.createElement(a.EuiComboBox,{"data-test-subj":t,"aria-label":e,inputRef:d,isDisabled:n,placeholder:c.e,prepend:r,ref:g,singleSelection:E,isClearable:!1,sortMatchesBy:"startsWith",options:j,selectedOptions:y,compressed:!0,onChange:v}))}));p.displayName="StackByComboBox"},,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Te})),n.d(t,"c",(function(){return Me})),n.d(t,"b",(function(){return Ie})),n.d(t,"d",(function(){return Ae}));var a=n(17),i=n(747),r=n(378),s=n(2),o=n.n(s),l=n(9),u=n(47),c=n(5),d=n(23),m=n.n(d);const p=({euiFieldProps:e})=>{const{field:{onChange:t,value:n,name:i},fieldState:{error:l}}=Object(r.useController)({name:"label",defaultValue:""}),u=Object(s.useMemo)((()=>!(null==l||!l.message)),[null==l?void 0:l.message]);return o.a.createElement(a.EuiFormRow,{label:c.i18n.translate("xpack.securitySolution.markdown.osquery.labelFieldText",{defaultMessage:"Label"}),error:null==l?void 0:l.message,isInvalid:u,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({isInvalid:u,onChange:t,value:n,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},f=o.a.memo(p),b=c.i18n.translate("xpack.securitySolution.markdown.osquery.permissionDenied",{defaultMessage:"Permission denied"}),g=()=>o.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:o.a.createElement("h2",null,b),titleSize:"xs",body:o.a.createElement("p",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:o.a.createElement(a.EuiCode,null,"osquery")}}))});var v=n(110);const y=({node:e,onSave:t,onCancel:n})=>{var i,d,m;const p=null!=e,{osquery:b,application:{capabilities:{osquery:y}}}=Object(v.i)().services,h=Object(r.useForm)({defaultValues:{label:null==e||null===(i=e.configuration)||void 0===i?void 0:i.label,query:null==e||null===(d=e.configuration)||void 0===d?void 0:d.query,ecs_mapping:null==e||null===(m=e.configuration)||void 0===m?void 0:m.ecs_mapping}}),j=Object(s.useCallback)((e=>{t(`!{osquery${JSON.stringify(Object(l.pickBy)({query:e.query,label:e.label,ecs_mapping:e.ecs_mapping},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t]),E=Object(s.useMemo)((()=>!(y.runSavedQueries&&y.readSavedQueries||y.writeLiveQueries)),[y.readSavedQueries,y.runSavedQueries,y.writeLiveQueries]),O=Object(s.useMemo)((()=>{if(null!=b&&b.LiveQueryField){const{LiveQueryField:e}=b;return o.a.createElement(r.FormProvider,h,o.a.createElement(f,null),o.a.createElement(a.EuiSpacer,{size:"m"}),o.a.createElement(e,{formMethods:h}))}return null}),[h,b]);return E?o.a.createElement(g,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiModalHeader,null,o.a.createElement(a.EuiModalHeaderTitle,null,o.a.createElement("h1",null,p?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalTitle",defaultMessage:"Edit query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalTitle",defaultMessage:"Add query"})))),o.a.createElement(a.EuiModalBody,null,o.a.createElement(o.a.Fragment,null,O)),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButtonEmpty,{onClick:n},c.i18n.translate("xpack.securitySolution.markdown.osquery.modalCancelButtonLabel",{defaultMessage:"Cancel"})),o.a.createElement(a.EuiButton,{onClick:h.handleSubmit(j),fill:!0},p?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},h=o.a.memo(y),j={name:"osquery",button:{label:"Osquery",iconType:"logoOsquery"},helpText:o.a.createElement("div",null,o.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},"!{osquery{options}}"),o.a.createElement(a.EuiSpacer,{size:"s"})),editor:h};var E=n(411),O=n(44),x=n.n(O),S=n(404),k=n(325),w=n(868),C=n.n(w),T=n(695);const M=x()(a.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-14wavsd-0"})(["> span > img{margin-block-end:0;}"]);var I=n(56),A=n.n(I),P=n(61),_=n.n(P),D=(n(13),n(87)),F=n(53),N=n(117),R=n(54),z=n(122),L=n(172),B=n(559),q=n(121),$=n(116),V=n(113),U=n(153);const H=e=>e===F.FILTERS.EXISTS?U.b:e===F.FILTERS.PHRASES?U.c:U.d,G={$state:{store:F.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:void 0}},Q={and:[],enabled:!0,id:"",name:"",excluded:!1,kqlQuery:"",type:V.a.default,queryMatch:{field:"",value:"",operator:U.b}},W=e=>{const t={...G,meta:{...G.meta,negate:e.excluded,type:e.queryType}};if(e.queryType===F.FILTERS.EXISTS)return{...t,meta:{...t.meta,params:void 0,value:"exists"},query:{exists:{field:e.field}}};if(e.queryType===F.FILTERS.PHRASES){var n;let a=JSON.parse(String(e.value));return"number"===e.valueType?a=a.map(Number):"boolean"===e.valueType&&(a=a.map(Boolean)),{...t,meta:{...t.meta},query:{bool:{minimum_should_match:1,should:null===(n=a)||void 0===n?void 0:n.map((t=>({match_phrase:{[e.field]:t}})))}}}}var a;if(e.queryType===F.FILTERS.PHRASE)return{...t,meta:{...t.meta,params:{query:e.value},value:void 0},query:{match_phrase:{[e.field]:null!==(a=e.value)&&void 0!==a?a:""}}};if(e.queryType===F.FILTERS.RANGE){let n,a;try{const t=JSON.parse(String(e.value));n=t.gte,a=t.lt}catch{n="",a=""}const i={gte:n,lt:a};return{...t,meta:{...t.meta,params:i},query:{range:{[e.field]:i}}}}return t},K=({providers:e,alertData:t})=>{const n=Object(s.useMemo)((()=>e.some((e=>e.some((e=>"range"===e.queryType))))),[e]);return{dataProviders:Object(s.useMemo)((()=>n?[]:((e,t)=>e.map((e=>e.reduce(((e,n,a)=>{const{field:i,value:r,excluded:s,queryType:o}=n,{result:u,matchedBrackets:c}=((e,t)=>{if("number"==typeof e||"boolean"==typeof e)return{result:e,skipped:!0,matchedBrackets:null};const n=/\{{([^}]+)\}}/g,a=e.match(new RegExp(n));let i=e;a&&t&&Object(l.each)(a,(e=>{const n=e.replace(/{{|}}/g,"").trim();if(i.includes(e)){const a=t.find((({field:e})=>e===n));if(a&&a.values){const{values:[t]}=a;i=i.replace(e,t)}}}));const r=new RegExp(n).test(i);return{result:i,skipped:r,matchedBrackets:a}})(r,t),d=!t&&c;if(0===a)return{and:[],enabled:!0,id:JSON.stringify(i+r),name:i,excluded:s,kqlQuery:"",type:d?V.a.template:V.a.default,queryMatch:{field:i,value:u,operator:H(o)}};{const t={enabled:!0,id:JSON.stringify(i+r),name:i,excluded:s,kqlQuery:"",type:d?V.a.template:V.a.default,queryMatch:{field:i,value:u,operator:H(o)}};e.and.push(t)}return e}),Q))))(e,t)),[t,e,n]),filters:Object(s.useMemo)((()=>n?((e,t)=>{const n=[];for(let t=0;t<e.length;t++){const a=e[t];if(a.length>1){const e=a.map((e=>W(e))),t={$state:{store:F.FilterStateStore.APP_STATE},meta:{type:F.FILTERS.COMBINED,relation:F.BooleanRelation.AND,params:e,index:void 0,disabled:!1,negate:!1}};n.push(t)}else{const e=a[0],t=W(e);n.push(t)}}return n})(e):[]),[n,e,t])}};var Y=n(379),X=n(281),J=n(4);const Z=e=>{var t,n,a,i,r,s;const o=null!==(t=null===(n=e.meta)||void 0===n?void 0:n.key)&&void 0!==t?t:"",l={field:o,excluded:null!==(a=null===(i=e.meta)||void 0===i?void 0:i.negate)&&void 0!==a&&a,queryType:null!==(r=null===(s=e.meta)||void 0===s?void 0:s.type)&&void 0!==r?r:F.FILTERS.PHRASE};if(Object(F.isRangeFilter)(e)){var u;const{gte:t,lt:n}=e.query.range[o],a=JSON.stringify({gte:t,lt:n});return{...l,value:a,queryType:null!==(u=e.meta.type)&&void 0!==u?u:F.FILTERS.RANGE}}if(Object(F.isPhrasesFilter)(e)){var c,d,m,p;const t=typeof(null===(c=e.meta)||void 0===c?void 0:c.params[0]);return{...l,value:JSON.stringify(null!==(d=null===(m=e.meta)||void 0===m?void 0:m.params)&&void 0!==d?d:[]),valueType:t,queryType:null!==(p=e.meta.type)&&void 0!==p?p:F.FILTERS.PHRASES}}var f;if(Object(F.isExistsFilter)(e))return{...l,value:"",queryType:null!==(f=e.meta.type)&&void 0!==f?f:F.FILTERS.EXISTS};if(Object(F.isPhraseFilter)(e)){var b,g,v,y,h,j;const t=typeof(null===(b=e.meta)||void 0===b||null===(g=b.params)||void 0===g?void 0:g.query);return{...l,value:null!==(v=null===(y=e.meta)||void 0===y||null===(h=y.params)||void 0===h?void 0:h.query)&&void 0!==v?v:"",valueType:t,queryType:null!==(j=e.meta.type)&&void 0!==j?j:F.FILTERS.PHRASE}}return{...l,value:"",queryType:F.FILTERS.PHRASE}},ee=e=>e.map((e=>Z(e))),te=e=>!1===e.some(F.isCombinedFilter)?[ee(e)]:e.reduce(((e,t)=>{if(Object(F.isCombinedFilter)(t)){const n=t.meta.params;if(t.meta.relation===F.BooleanRelation.OR){const t=n.map((e=>{const t=te([e]);return Object(l.flatten)(t)}));return[...e,...t]}{const t=te(n);return[...e,...t]}}return[...e,[Z(t)]]}),[]);var ne=n(18),ae=n(65),ie=n.n(ae),re=n(591),se=n.n(re),oe=n(328);function le(e,t,n){var a;if(void 0===t||"undefined"===n)return!1;switch(e.type){case"date":const n="string"==typeof t?ie.a.parse(t):null;return Boolean("string"==typeof t&&n&&n.isValid());case"ip":if("string"==typeof t||"number"==typeof t)try{return Boolean(new R.IpAddress(t))}catch(e){return!1}return!1;case"string":return"string"==typeof t&&null!==(a=e.esTypes)&&void 0!==a&&a.includes(oe.a.VERSION)?Boolean(se()(t)):"string"==typeof t&&t.trim().length>0;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t||"string"==typeof t&&!isNaN(parseFloat(t));default:return!0}}const ue=c.i18n.translate("xpack.securitySolution.markdown.insight.label",{defaultMessage:"Label"}),ce=c.i18n.translate("xpack.securitySolution.markdown.insight.title",{defaultMessage:"Investigate"}),de=c.i18n.translate("xpack.securitySolution.markdown.insight.labelText",{defaultMessage:"Label on the query button."}),me=c.i18n.translate("xpack.securitySolution.markdown.insight.description",{defaultMessage:"Description"}),pe=c.i18n.translate("xpack.securitySolution.markdown.insight.descriptionText",{defaultMessage:"Additional description of the query."}),fe=c.i18n.translate("xpack.securitySolution.markdown.insight.formDescription",{defaultMessage:"Create a query to investigate an alert in Timeline, using a clickable query button in the investigation guide. The button also displays a count of matching documents."}),be=c.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilder",{defaultMessage:"Filters"}),ge=c.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilderText",{defaultMessage:"Create filters to populate the Timeline query builder. To use a value from the alert document, enter the field name in double braces {example} as a custom option in the value field.",values:{example:"{{kibana.alert.example}}"}}),ve=c.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerange",{defaultMessage:"Relative time range"}),ye=c.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerangeText",{defaultMessage:"Select a time range to limit the query, relative to the alert's creation time (optional)."}),he=c.i18n.translate("xpack.securitySolution.markdown.insight.modalCancelButtonLabel",{defaultMessage:"Cancel"}),je=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightProviderError",{defaultMessage:"Unable to parse insight provider configuration"}),Ee="!{investigate",Oe=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:r})=>{const{addError:l}=Object(N.a)();let u=[];try{void 0!==n&&(u=JSON.parse(n))}catch(e){l(e,{title:je})}const{data:c,timestamp:d}=Object(s.useContext)(S.a),{dataProviders:m,filters:p}=K({providers:u,alertData:c}),f=Object(s.useMemo)((()=>{if(i&&r){const e=d?A()(d):A()();return{kind:"absolute",from:Object(X.e)(i,X.a,!1,A.a,e.toDate()).toISOString(),to:Object(X.e)(r,X.b,!0,A.a,e.toDate()).toISOString()}}return null}),[i,r,d]),{totalCount:b,isQueryLoading:g,oldestTimestamp:y,hasError:h}=(({dataProviders:e,filters:t,relativeTimerange:n})=>{const{uiSettings:a}=Object(v.i)().services,i=Object(s.useMemo)((()=>Object(R.getEsQueryConfig)(a)),[a]),{browserFields:r,selectedPatterns:o,indexPattern:l,dataViewId:u}=Object(q.d)($.SourcererScopeName.timeline),[c,d]=Object(s.useState)(!1),m=Object(s.useMemo)((()=>{try{if(!1===c)return Object(L.d)({config:i,dataProviders:e,indexPattern:l,browserFields:r,filters:t,kqlQuery:{query:"",language:"kuery"},kqlMode:"filter"})}catch(e){return d(!0),null}}),[r,e,i,c,l,t]),[p,{events:f,totalCount:b}]=Object(B.a)({dataViewId:u,fields:["*"],filterQuery:null==m?void 0:m.filterQuery,id:z.c.active,indexNames:o,language:"kuery",limit:1,runtimeMappings:{},...n?{startDate:null==n?void 0:n.from,endDate:null==n?void 0:n.to}:{}}),[g]=f,y=g&&g.data&&g.data.find((e=>"@timestamp"===e.field));return{isQueryLoading:p,totalCount:b,oldestTimestamp:y&&y.value&&y.value[0],hasError:c}})({dataProviders:m,filters:p,relativeTimerange:f}),j=Object(s.useMemo)((()=>{if(f)return f;if(null!=y)return{kind:"absolute",from:y,to:(new Date).toISOString()};{const{to:e,from:t,fromStr:n,toStr:a}=Object(X.d)();return{kind:"relative",to:e,from:t,fromStr:n,toStr:a}}}),[y,f]);return g?o.a.createElement(a.EuiLoadingSpinner,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(Y.a,{asEmptyButton:!1,isDisabled:h,dataProviders:m,filters:p,timeRange:j,keepDataView:!0,"data-test-subj":"insight-investigate-in-timeline-button"},o.a.createElement(a.EuiIcon,{type:"timeline"}),` ${e} (${_()(b).format("0,0.[000]a")})`),o.a.createElement("div",null,t))},xe=({node:e,onSave:t,onCancel:n})=>{const i=null!=e,{sourcererDataView:c,indexPattern:d}=Object(q.d)($.SourcererScopeName.default),{unifiedSearch:{ui:{FiltersBuilderLazy:p}},uiSettings:f,fieldFormats:b}=Object(v.i)().services,g=Object(s.useMemo)((()=>null!=c?new D.DataView({spec:c,fieldFormats:b}):null),[c,b]),[y,h]=Object(s.useState)([[]]),j=Object(s.useMemo)((()=>[{value:"0",text:""},...f.get(J.W).map((({display:e},t)=>({value:String(t),text:e})))]),[f]),E=Object(r.useForm)({defaultValues:{label:null==e?void 0:e.label,description:null==e?void 0:e.description,relativeTimerange:(null==e?void 0:e.relativeTimerange)||"0"},shouldUnregister:!0}),O=Object(r.useController)({name:"label",control:E.control}),x=Object(r.useController)({name:"description",control:E.control}),S=Object(r.useController)({name:"relativeTimerange",control:E.control}),k=Object(s.useCallback)((e=>{const t=j.find((t=>t.value===e));if(t&&"0"!==t.value){const e=Number(t.value),n=f.get(J.W);return{relativeFrom:n[e].from,relativeTo:n[e].to}}return{}}),[j,f]),w=Object(s.useCallback)((()=>{t(`${Ee}${JSON.stringify(Object(l.pickBy)({label:O.field.value,description:x.field.value,providers:y,...k(S.field.value)},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t,y,O.field.value,x.field.value,S.field.value,k]),C=Object(s.useCallback)((e=>{h(te(e))}),[]),T=Object(s.useCallback)((e=>{S.field.onChange(e.target.value)}),[S.field]),M=Object(s.useMemo)((()=>{var e;const t=null!==(e=O.field.value)&&void 0!==e?e:"",n=y.flat();return""===t.trim()||0===n.length||n.some((e=>!function(e,t){if(!t||!e.field)return!1;switch(e.queryType){case"phrase":return le(t,e.value,e.valueType);case"phrases":const n="string"==typeof e.value?JSON.parse(`${e.value}`):null;return!(!Array.isArray(n)||!n.length)&&n.every((n=>le(t,n,e.valueType)));case"range":const a=JSON.parse("string"==typeof e.value?e.value:"");return"object"==typeof a&&(!a.gte||le(t,a.gte,e.valueType))&&(!a.lt||le(t,a.lt,e.valueType));case"exists":return!0;default:throw new Error(`Unknown operator type: ${e.queryType}`)}}(e,null==g?void 0:g.getFieldByName(e.field))))}),[O.field.value,y,g]),I=Object(s.useMemo)((()=>{const e=d&&d.getName?d.getName():"*";return[{$state:{store:F.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:e}}]}),[d]),A=Object(ne.b)().isAtLeast("platinum");return o.a.createElement(o.a.Fragment,null,o.a.createElement(we,null,o.a.createElement(a.EuiModalHeaderTitle,null,o.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(a.EuiFlexItem,null,i?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalTitle",defaultMessage:"Edit investigation query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalTitle",defaultMessage:"Add investigation query"}))))),!1===A&&o.a.createElement(a.EuiCallOut,{title:"To add suggested queries to an investigation guide, please upgrade to platinum",iconType:"timeline"}),o.a.createElement(a.EuiModalBody,null,o.a.createElement(r.FormProvider,E,o.a.createElement(a.EuiForm,{fullWidth:!0},o.a.createElement(a.EuiFormRow,{label:fe,fullWidth:!0},o.a.createElement(o.a.Fragment,null)),o.a.createElement(a.EuiFormRow,{label:ue,helpText:de,isInvalid:void 0!==O.field.value&&0===O.field.value.trim().length,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({},E.register("label"),{ref:null,name:"label",onChange:O.field.onChange}))),o.a.createElement(a.EuiFormRow,{label:me,helpText:pe,fullWidth:!0},o.a.createElement(a.EuiFieldText,m()({},E.register("description"),{ref:null,name:"description",onChange:x.field.onChange}))),o.a.createElement(a.EuiFormRow,{label:be,helpText:ge,fullWidth:!0},g?o.a.createElement(p,{filters:I,onChange:C,dataView:g,maxDepth:1}):o.a.createElement(o.a.Fragment,null)),o.a.createElement(a.EuiFormRow,{label:ve,helpText:ye,fullWidth:!0},o.a.createElement(a.EuiSelect,m()({},E.register("relativeTimerange"),{ref:null,onChange:T,options:j})))))),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButtonEmpty,{onClick:n},he),o.a.createElement(a.EuiButton,{onClick:E.handleSubmit(w),fill:!0,disabled:M},i?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},Se=o.a.memo(xe),ke=`${Ee}{\n  "label": "Test action",\n  "description": "Click to investigate",\n  "providers": [\n    [\n      {"field": "event.id", "value": "{{kibana.alert.original_event.id}}", "queryType": "phrase", "excluded": "false"}\n    ],\n    [\n      {"field": "event.action", "value": "", "queryType": "exists", "excluded": "false"},\n      {"field": "process.pid", "value": "{{process.pid}}", "queryType": "phrase", "excluded":"false"}\n    ]\n  ]\n}}`;var we=x()(a.EuiModalHeader).withConfig({displayName:"_StyledEuiModalHeader",componentId:"sc-1kbgjgu-0"})(["min-width:700px;"]);const Ce=Object(a.getDefaultEuiMarkdownUiPlugins)(),Te=Object(a.getDefaultEuiMarkdownParsingPlugins)(),Me=Object(a.getDefaultEuiMarkdownProcessingPlugins)(),Ie=[Ee],Ae=({insightsUpsellingMessage:e})=>{const t=Ce.map((e=>e.name)),n=(({insightsUpsellingMessage:e})=>({name:"insights",button:{label:null!=e?e:ce,iconType:"timelineWithArrow",isDisabled:!!e},helpText:o.a.createElement("div",null,o.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},ke),o.a.createElement(a.EuiSpacer,{size:"s"})),editor:Se}))({insightsUpsellingMessage:e});if(!1===t.includes(n.name))Ce.push(i.b),Ce.push(j),Ce.push(n);else{const e=Ce.findIndex((e=>e.name===n.name));Ce[e]=n}return Ce};Te.push((function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){if(!1===t.startsWith(Ee))return!1;const a=t[Ee.length];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i={};if("{"===a){let n="",a=0;for(let e=Ee.length;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}try{return i=JSON.parse(n),e(t)({type:"insight",...i,providers:JSON.stringify(i.providers)})}catch(t){const n=e.now();this.file.fail((e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightConfigError",{values:{err:e},defaultMessage:"Unable to parse insight JSON configuration: {err}"}))(t),{line:n.line,column:n.column+Ee.length})}}return!1};a.locator=(e,t)=>e.indexOf(Ee,t),t.insight=a,n.splice(n.indexOf("text"),0,"insight")})),Te.push(i.a),Te.push(E.a),Me[1][1].components.insight=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:r})=>!1===Object(ne.b)().isPlatinumPlus()?o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiButton,{isDisabled:!0,iconSide:"left",iconType:"timeline","data-test-subj":"insight-investigate-in-timeline-button"},`${e}`),o.a.createElement("div",null,t)):o.a.createElement(Oe,{label:e,description:t,providers:n,relativeFrom:i,relativeTo:r}),Me[1][1].components.timeline=i.c,Me[1][1].components.osquery=({configuration:e})=>{var t;const[n,a]=Object(s.useState)(!1),{agentId:i,alertId:r,data:u}=Object(s.useContext)(S.a),d=Object(s.useCallback)((()=>a(!0)),[a]),m=Object(s.useCallback)((()=>a(!1)),[a]),p=Object(s.useMemo)((()=>{const e=Object(l.reduce)(u,((e,t)=>{var n;return{...e,[t.field]:null==t||null===(n=t.values)||void 0===n?void 0:n[0]}}),{});return Object(k.a)(e)}),[u]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(M,{iconType:C.a,onClick:d},null!==(t=e.label)&&void 0!==t?t:c.i18n.translate("xpack.securitySolution.markdown.osquery.runOsqueryButtonLabel",{defaultMessage:"Run Osquery"})),n&&o.a.createElement(T.a,{defaultValues:{...r?{alertIds:[r]}:{},query:e.query,ecs_mapping:e.ecs_mapping,queryField:!1},agentId:i,onClose:m,ecsData:p}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(5);const u=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allActionsTooltip",{defaultMessage:"All actions"}),c=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowAction",{defaultMessage:"Allow"}),d=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowByDefaultAction",{defaultMessage:"Allow by default"}),m=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowedColumnTitle",{defaultMessage:"Allowed"}),p=(l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.alwaysSubmenu",{defaultMessage:"Always"}),l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeAction",{defaultMessage:"Anonymize"})),f=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeByDefaultAction",{defaultMessage:"Anonymize by default"}),b=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizedColumnTitle",{defaultMessage:"Anonymized"}),g=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.bulkActions",{defaultMessage:"Bulk actions"}),v=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.defaultsSubmenu",{defaultMessage:"Defaults"}),y=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyAction",{defaultMessage:"Deny"}),h=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyByDefaultAction",{defaultMessage:"Deny by default"}),j=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.fieldColumnTitle",{defaultMessage:"Field"}),E=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.noButtonLabel",{defaultMessage:"No"}),O=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.resetButton",{defaultMessage:"Reset"}),x=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeAction",{defaultMessage:"Unanonymize"}),S=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeByDefaultAction",{defaultMessage:"Unanonymize by default"}),k=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.valuesColumnTitle",{defaultMessage:"Values"}),w=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.yesButtonLabel",{defaultMessage:"Yes"}),C="primary-panel-id",T="secondary-panel-id";var M=n(13);const I=({appliesTo:e,disabled:t,disableAllow:n=!1,disableAnonymize:r=!1,disableDeny:s=!1,disableUnanonymize:o=!1,onListUpdated:l,onlyDefaults:m,selected:b})=>{const[j,E]=Object(i.useState)(!1),O=Object(a.useGeneratedHtmlId)({prefix:"contextEditorBulkActions"}),k=Object(i.useCallback)((()=>E(!1)),[]),w=Object(i.useCallback)((()=>E((e=>!e))),[]),I=Object(i.useMemo)((()=>Object(M.jsx)(a.EuiToolTip,{content:"multipleRows"===e?void 0:u},Object(M.jsx)(a.EuiButtonEmpty,{"data-test-subj":"bulkActionsButton",disabled:t,iconType:"multipleRows"===e?"arrowDown":"boxesVertical",iconSide:"multipleRows"===e?"right":void 0,onClick:w,size:"xs"},"multipleRows"===e?g:null))),[e,t,w]),A=Object(i.useMemo)((()=>(({disableAllow:e,disableAnonymize:t,disableDeny:n,disableUnanonymize:a,closePopover:i,onListUpdated:r,onlyDefaults:s,selected:o})=>{const l=s?C:T,u=s?T:C,m=[s?[]:{icon:"check",name:d,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allow"}))),t=o.map((({field:e})=>({field:e,operation:"add",update:"defaultAllow"})));r([...e,...t])}}].flat(),b=[{id:l,title:v,items:[...m,{icon:"cross",name:h,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allow"}))),t=o.map((({field:e})=>({field:e,operation:"remove",update:"defaultAllow"})));r([...e,...t])}},{icon:"eyeClosed",name:f,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allowReplacement"}))),t=o.map((({field:e})=>({field:e,operation:"add",update:"defaultAllowReplacement"})));r([...e,...t])}},{icon:"eye",name:S,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allowReplacement"}))),t=o.map((({field:e})=>({field:e,operation:"remove",update:"defaultAllowReplacement"})));r([...e,...t])}}]}],g=[{id:u,items:[{disabled:e,icon:"check",name:c,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allow"})));r(e)}},{disabled:n,icon:"cross",name:y,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allow"})));r(e)}},{disabled:t,icon:"eyeClosed",name:p,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allowReplacement"})));r(e)}},{disabled:a,icon:"eye",name:x,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allowReplacement"})));r(e)}},{isSeparator:!0,key:"sep"},{name:v,panel:l}]},...b];return s?b:g})({disableAllow:n,disableAnonymize:r,disableDeny:s,disableUnanonymize:o,closePopover:k,onListUpdated:l,onlyDefaults:m,selected:b})),[k,n,r,s,o,l,m,b]);return Object(M.jsx)(a.EuiPopover,{anchorPosition:"downLeft",button:I,closePopover:k,"data-test-subj":"bulkActions",id:O,isOpen:j,panelPaddingSize:"none"},Object(M.jsx)(a.EuiContextMenu,{initialPanelId:C,panels:A,size:"s"}))},A=r.a.memo(I),P="allowed",_="anonymized",D="field",F=o()(a.EuiButtonEmpty)`
  max-height: 24px;
`;var N=n(388);const R=({onListUpdated:e,onlyDefaults:t,onReset:n,onSelectAll:i,selected:r,totalFields:s})=>Object(M.jsx)(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"toolbar",gutterSize:"none"},Object(M.jsx)(a.EuiFlexItem,{grow:!1},Object(M.jsx)(a.EuiText,{color:"subdued","data-test-subj":"selectedFields",size:"xs"},(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectedFields",{values:{selected:e},defaultMessage:"Selected {selected} fields"}))(r.length))),Object(M.jsx)(a.EuiFlexItem,{grow:!1},Object(M.jsx)(a.EuiButtonEmpty,{"data-test-subj":"selectAllFields",iconType:"pagesSelect",onClick:i,size:"xs"},(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectAllFields",{values:{totalFields:e},defaultMessage:"Select all {totalFields} fields"}))(s))),Object(M.jsx)(a.EuiFlexItem,{grow:!1},Object(M.jsx)(A,{appliesTo:"multipleRows",disabled:0===r.length,onListUpdated:e,onlyDefaults:t,selected:r})),null!=n&&Object(M.jsx)(a.EuiFlexItem,{grow:!0},Object(M.jsx)(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"toolbarTrailingActions",gutterSize:"none",justifyContent:"flexEnd"},Object(M.jsx)(a.EuiFlexItem,{grow:!1},Object(M.jsx)(a.EuiButtonEmpty,{"data-test-subj":"resetFields",iconType:"eraser",onClick:n,size:"xs"},O)))));R.displayName="ToolbarComponent";const z=r.a.memo(R),L={sort:{direction:"desc",field:P}},B={box:{incremental:!0},filters:[{field:P,type:"is",name:m},{field:_,type:"is",name:b}]},q=({allow:e,allowReplacement:t,onListUpdated:n,onReset:r,rawData:s,pageSize:o=10})=>{const[l,u]=Object(i.useState)([]),c=Object(i.useMemo)((()=>({selectable:()=>!0,onSelectionChange:e=>u(e),initialSelected:[]})),[]),d=Object(i.useRef)(null),p=Object(i.useMemo)((()=>(({onListUpdated:e,rawData:t})=>{const n={field:"actions",name:"",render:(n,a)=>Object(M.jsx)(A,{appliesTo:"singleRow",disabled:!1,disableAllow:a.allowed,disableDeny:!a.allowed,disableAnonymize:!a.allowed||a.allowed&&a.anonymized,disableUnanonymize:!a.allowed||a.allowed&&!a.anonymized,onListUpdated:e,onlyDefaults:null==t,selected:[a]}),sortable:!1,width:"36px"},i={field:"rawValues",name:k,render:e=>Object(M.jsx)(a.EuiCode,{"data-test-subj":"rawValues"},e.join(",")),sortable:!1},r=[{field:P,name:m,render:(n,{allowed:i,field:r})=>Object(M.jsx)(a.EuiSwitch,{"data-test-subj":"allowed",checked:i,label:"",showLabel:!1,onChange:()=>{e([{field:r,operation:i?"remove":"add",update:null==t?"defaultAllow":"allow"}]),null==t&&i&&e([{field:r,operation:"remove",update:"defaultAllowReplacement"}])}}),sortable:!0,width:"75px"},{field:_,name:b,render:(n,{allowed:i,anonymized:r,field:s})=>Object(M.jsx)(F,{"data-test-subj":"anonymized",disabled:!i,color:r?"primary":"text",flush:"both",iconType:r?"eyeClosed":"eye",isSelected:!!r,onClick:()=>e([{field:s,operation:r?"remove":"add",update:null==t?"defaultAllowReplacement":"allowReplacement"}])},Object(M.jsx)(a.EuiText,{size:"xs"},r?w:E)),sortable:!0,width:"102px"},{field:D,name:j,sortable:!0,width:"260px"}];return null==t?[...r,n]:[...r,i,n]})({onListUpdated:n,rawData:s})),[n,s]),f=Object(i.useMemo)((()=>(({allow:e,allowReplacement:t,rawData:n})=>{const a=new Set(t),i=new Set(e);return null!==n&&"object"==typeof n?Object.keys(n).sort().reduce(((e,t)=>[...e,{field:t,allowed:Object(N.a)({allowSet:i,field:t}),anonymized:Object(N.b)({allowReplacementSet:a,field:t}),denied:Object(N.c)({allowSet:i,field:t}),rawValues:n[t]}]),[]):e.sort().reduce(((e,t)=>[...e,{field:t,allowed:!0,anonymized:a.has(t),denied:!1,rawValues:[]}]),[])})({allow:e,allowReplacement:t,rawData:s})),[e,t,s]),g=Object(i.useCallback)((()=>{var e;null===(e=d.current)||void 0===e||e.setSelection(f),setTimeout((()=>u(f)),0)}),[f]),v=Object(i.useMemo)((()=>({initialPageSize:o,pageSizeOptions:[5,10,25,50]})),[o]),y=Object(i.useMemo)((()=>Object(M.jsx)(z,{onListUpdated:n,onlyDefaults:null==s,onReset:r,onSelectAll:g,selected:l,totalFields:f.length})),[n,r,g,s,f.length,l]);return Object(M.jsx)(a.EuiInMemoryTable,{allowNeutralSort:!1,childrenBetween:y,columns:p,compressed:!0,"data-test-subj":"contextEditor",isSelectable:!0,itemId:D,items:f,pagination:v,ref:d,search:B,selection:c,sorting:L})};q.displayName="ContextEditorComponent";const $=r.a.memo(q)},function(e,t,n){"use strict";n.d(t,"a",(function(){return W})),n.d(t,"c",(function(){return Y})),n.d(t,"b",(function(){return ee}));var a=n(23),i=n.n(a),r=n(17),s=n(114),o=n(2),l=n.n(o),u=n(82),c=n(48),d=n(44),m=n.n(d),p=n(124),f=n(195),b=n(291),g=n(439),v=n(666),y=n(174),h=n(515),j=n(710),E=n(689),O=n(5),x=n(66),S=n(122),k=n(9),w=n(19),C=n(127),T=n(118),M=n(110),I=n(758),A=n(116),P=n(121),_=n(754);const D=({field:e,value:t})=>null==t?e:Array.isArray(t)?`${e} ${t.join(" ")}`:`${e} ${t}`;var F=n(318);const N=l.a.memo((({className:e,Component:t,enablePopOver:n,field:a,flush:i,iconSide:s,iconType:u,isExpandable:c,onClick:d,onFilterAdded:m,ownFocus:p,paddingSize:f,showLegend:b,showTooltip:g=!0,showTopN:v,scopeId:y,title:h,value:j,globalFilters:E})=>{const x=Object(C.isActiveTimeline)(null!=y?y:"")?A.SourcererScopeName.timeline:null!=y&&Object(F.c)(y)?A.SourcererScopeName.detections:A.SourcererScopeName.default,{browserFields:S,indexPattern:k}=Object(P.d)(x),w=null!=u?u:"visBarVertical",T=null!=s?s:"left",M=null!=h?h:(N=a,O.i18n.translate("xpack.securitySolution.hoverActions.showTopTooltip",{values:{fieldName:N},defaultMessage:"Show top {fieldName}"}));var N;const R=Object(o.useMemo)((()=>t?l.a.createElement(t,{"aria-label":M,className:e,"data-test-subj":"show-top-field",icon:w,iconType:w,iconSide:T,flush:i,onClick:d,title:M},M):l.a.createElement(r.EuiButtonIcon,{"aria-label":M,className:"securitySolution__hoverActionButton","data-test-subj":"show-top-field",iconSize:"s",iconType:w,onClick:d})),[t,M,e,i,w,d,T]),z=Object(o.useMemo)((()=>g&&!v?l.a.createElement(r.EuiToolTip,{content:l.a.createElement(_.a,{additionalScreenReaderOnlyContext:D({field:a,value:j}),content:M,shortcut:"t",showShortcut:p})},R):R),[R,M,a,p,g,v,j]),L=Object(o.useMemo)((()=>l.a.createElement(I.a,{browserFields:S,field:a,indexPattern:k,onFilterAdded:m,paddingSize:f,showLegend:b,scopeId:null!=y?y:void 0,toggleTopN:d,globalFilters:E})),[S,a,k,m,f,b,y,d,E]);return c?l.a.createElement(l.a.Fragment,null,R,v&&L):v?n?l.a.createElement(r.EuiPopover,{button:R,isOpen:v,closePopover:d,panelClassName:"withHoverActions__popover","data-test-subj":"showTopNContainer"},L):L:z}));N.displayName="ShowTopNButton";var R=n(14),z=n(112),L=n(129);const B=m.a.div.withConfig({displayName:"AdditionalContent",componentId:"sc-hbiy4s-0"})(["padding:2px;"]);B.displayName="AdditionalContent";const q=m.a.div.withConfig({displayName:"StyledHoverActionsContainer",componentId:"sc-hbiy4s-1"})(["display:flex;"," ",""],(e=>e.$isActive?"\n    .hoverActions-active {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n  ":""),(e=>e.$showOwnFocus?`\n    &:focus-within {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n    &:hover {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n  .timelines__hoverActionButton,\n  .securitySolution__hoverActionButton {\n    opacity: ${e.$showTopN?1:0};\n\n      &:focus {\n        opacity: 1;\n      }\n    }\n  `:"")),$=m()(q).withConfig({displayName:"StyledHoverActionsContainerWithPaddingsAndMinWidth",componentId:"sc-hbiy4s-2"})(["min-width:",";padding:",";position:relative;"],(({$hiddenActionsCount:e})=>138-26*e+"px"),(e=>`0 ${e.theme.eui.euiSizeS}`)),V=({ownFocus:e,showTopN:t})=>!t&&!e,U=l.a.memo((({additionalContent:e=null,closePopOver:t,closeTopN:n,dataProvider:a,dataType:i,draggableId:s,enableOverflowButton:u=!1,applyWidthAndPadding:d=!0,field:m,fieldType:p,isAggregatable:f,goGetTimelineId:b,isObjectArray:g,hideAddToTimeline:v=!1,hideTopN:h=!1,onFilterAdded:j,ownFocus:E,showOwnFocus:I=!0,showTopN:A,scopeId:P,toggleColumn:_,toggleTopN:D,values:F})=>{const[U,H]=Object(o.useState)(),[G,Q]=Object(o.useState)(!1),[W,K]=Object(o.useState)(!1),Y=Object(o.useCallback)((()=>{Q((e=>!e)),K(!W)}),[W,K]),X=Object(o.useCallback)((()=>{n&&n(),Q(!1),K(!1),t&&t()}),[t,n]),J=Object(o.useRef)(!0),Z=Object(o.useRef)(null);Object(o.useEffect)((()=>{J.current&&null!=b&&null==P&&(J.current=!1,b(!0))}),[b,P]),Object(o.useEffect)((()=>{E&&setTimeout((()=>{var e;null===(e=Z.current)||void 0===e||e.focus()}),0)}),[E]);const ee=Object(o.useCallback)((e=>{if(E)switch(e.key){case"t":Object(x.stopPropagationAndPreventDefault)(e),D();break;case"Enter":break;case"Escape":Object(x.stopPropagationAndPreventDefault)(e);break;default:H(e)}}),[E,D]),te=P===S.c.casePage,ne=P===S.c.active,ae=P===L.a.entityAnalytics,ie=Object(o.useMemo)((()=>ae&&!ne),[ne,ae]),re=Object(o.useMemo)((()=>(h?1:0)+(ie?2:0)),[ie,h]),{overflowActionItems:se,allActionItems:oe}=(({dataProvider:e,dataType:t,defaultFocusedButtonRef:n,draggableId:a,enableOverflowButton:i,field:s,fieldType:u,isAggregatable:d,handleHoverActionClicked:m,hideFilters:p,hideTopN:f,hideAddToTimeline:b,isCaseView:g,isObjectArray:v,isOverflowPopoverOpen:h,itemsToShow:j=2,onFilterAdded:E,onOverflowButtonClick:O,ownFocus:x,showTopN:I,stKeyboardEvent:A,scopeId:P,toggleColumn:_,toggleTopN:D,values:F})=>{const L=Object(M.i)(),B=Object(c.useDispatch)(),{timelines:q,uiSettings:$}=L.services,{getAddToTimelineButton:V,getColumnToggleButton:U,getCopyButton:H,getFilterForValueButton:G,getFilterOutValueButton:Q,getOverflowButton:W}=q.getHoverActions(),K=Object(o.useMemo)((()=>L.services.data.query.filterManager),[L.services.data.query.filterManager]),Y=Object(o.useMemo)((()=>T.b.getTimelineByIdSelector()),[]),X=Object(z.a)((e=>{var t;return Object(C.isActiveTimeline)(null!=P?P:"")?null===(t=Y(e,null!=P?P:""))||void 0===t?void 0:t.filterManager:void 0})),J=Object(o.useMemo)((()=>Object(C.isActiveTimeline)(null!=P?P:"")?null!=X?X:new w.FilterManager($):K),[P,X,$,K]),Z=Object(o.useCallback)((()=>{e&&!Object(k.isEmpty)(e)&&B(Object(R.addProvider)({id:S.c.active,providers:e instanceof Array?e:[e]}))}),[e,B]),ee=Object(o.useCallback)((()=>{m&&m(),Z()}),[m,Z]),te=Object(o.useMemo)((()=>!p&&null!=F&&(i||!I&&!i)&&!g),[i,p,g,I,F]),ne=v&&"geo_point"!==s||g,ae=Object(o.useMemo)((()=>l.a.createElement(N,{Component:i?r.EuiContextMenuItem:void 0,"data-test-subj":"hover-actions-show-top-n",enablePopOver:!i&&g,field:s,key:"hover-actions-show-top-n",onClick:D,onFilterAdded:E,ownFocus:x,showTopN:I,showTooltip:!i,scopeId:P,value:F})),[i,g,s,D,E,x,I,P,F]),ie=Object(o.useMemo)((()=>[te?l.a.createElement("div",{"data-test-subj":"hover-actions-filter-for",key:"hover-actions-filter-for"},G({defaultFocusedButtonRef:n,field:s,filterManager:J,keyboardEvent:A,onClick:m,onFilterAdded:E,ownFocus:x,showTooltip:!i,value:F})):null,te?l.a.createElement("div",{"data-test-subj":"hover-actions-filter-out",key:"hover-actions-filter-out"},Q({field:s,filterManager:J,keyboardEvent:A,onFilterAdded:E,ownFocus:x,onClick:m,showTooltip:!i,value:F})):null,_&&!ne?l.a.createElement("div",{"data-test-subj":"hover-actions-toggle-column",key:"hover-actions-toggle-column"},U({Component:i?r.EuiContextMenuItem:void 0,field:s,isDisabled:v&&"geo_point"!==t,isObjectArray:v,keyboardEvent:A,ownFocus:x,onClick:m,showTooltip:!i,toggleColumn:_,value:F})):null,null==F||null==a&&Object(k.isEmpty)(e)||b?null:l.a.createElement("div",{"data-test-subj":"hover-actions-add-timeline",key:"hover-actions-add-timeline"},V({Component:i?r.EuiContextMenuItem:void 0,dataProvider:e,draggableId:a,field:s,keyboardEvent:A,ownFocus:x,onClick:ee,showTooltip:!i,value:F})),Object(y.e)({fieldType:u,isAggregatable:d,fieldName:s,hideTopN:f})?ae:null,null!=s?l.a.createElement("div",{"data-test-subj":"hover-actions-copy-button",key:"hover-actions-copy-button"},H({Component:i?r.EuiContextMenuItem:void 0,field:s,isHoverAction:!0,keyboardEvent:A,ownFocus:x,onClick:m,showTooltip:!i,value:F})):null].filter((e=>null!=e))),[e,t,n,a,i,s,u,d,J,V,U,H,G,Q,m,ee,b,f,v,E,x,ne,te,ae,A,_,F]);return{overflowActionItems:Object(o.useMemo)((()=>[...ie.slice(0,j),...i&&j>0&&j<ie.length?[W({closePopOver:m,field:s,keyboardEvent:A,ownFocus:x,onClick:O,showTooltip:!i,value:F,items:I?[ae]:ie.slice(j),isOverflowPopoverOpen:!!h})]:[]].filter((e=>null!=e))),[ie,i,s,W,m,h,j,O,ae,x,I,A,F]),allActionItems:Object(o.useMemo)((()=>!I||i||g?ie:[ae]),[I,i,g,ae,ie])}})({dataProvider:a,dataType:i,defaultFocusedButtonRef:Z,draggableId:s,enableOverflowButton:u&&!te,field:m,fieldType:p,hideFilters:ie,isAggregatable:f,handleHoverActionClicked:X,hideAddToTimeline:v,hideTopN:h,isCaseView:te,isObjectArray:g,isOverflowPopoverOpen:W,onFilterAdded:j,onOverflowButtonClick:Y,ownFocus:E,showTopN:A,stKeyboardEvent:U,toggleColumn:_,toggleTopN:D,values:F,scopeId:P}),le=d?$:q;return l.a.createElement(r.EuiFocusTrap,{disabled:V({ownFocus:E,showTopN:A})},l.a.createElement(le,{"data-test-subj":"hover-actions-container",onKeyDown:ee,$showTopN:A,$showOwnFocus:I,$hiddenActionsCount:re,$isActive:G,className:G?"hoverActions-active":""},l.a.createElement(r.EuiScreenReaderOnly,null,l.a.createElement("p",null,(ue=m,O.i18n.translate("xpack.securitySolution.dragAndDrop.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:ue},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."})))),null!=e&&l.a.createElement(B,null,e),u&&!te?se:oe));var ue}));U.displayName="HoverActions";var H=n(729);const G=({dataProvider:e,isAggregatable:t,fieldType:n,hideTopN:a,isDraggable:i,onFilterAdded:r,render:s,scopeId:u})=>{const{timelineId:c}=Object(o.useContext)(E.b),{tableId:d}=Object(o.useContext)(H.b),m=Object(o.useRef)(null),p=Object(o.useRef)(null),[f,b]=Object(o.useState)(!1),[g,v]=Object(o.useState)(!1),h=Object(o.useMemo)((()=>u||(null!=c?c:d)),[u,d,c]),j=Object(o.useCallback)((()=>{b((e=>!e)),v((e=>(e&&setTimeout((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}),0),!1))),setTimeout((()=>{v(!1)}),0)}),[p]),{closeTopN:O,toggleTopN:x,isShowingTopN:S}=(e=>{const[t,n]=Object(o.useState)(!1),a=Object(o.useCallback)((()=>{n((t=>{const n=!t;return e&&e(n),n}))}),[e]);return{closeTopN:Object(o.useCallback)((()=>{n(!1)}),[]),toggleTopN:a,isShowingTopN:t}})(j),k=Object(o.useMemo)((()=>{const t=e.queryMatch.value;return"number"==typeof t||"boolean"==typeof t?t.toString():Array.isArray(t)?t.map((e=>String(e))):t}),[e.queryMatch.value]),w=Object(o.useMemo)((()=>{const o=g&&!S&&(null!==(c=null==(u=m.current)?void 0:u.querySelectorAll(".euiLink"))&&void 0!==c?c:[]).length>0?l.a.createElement(Y,{"data-test-subj":`draggable-link-content-${e.queryMatch.field}`},s(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):null;var u,c;return l.a.createElement(U,{additionalContent:o,closeTopN:O,closePopOver:j,dataProvider:e,draggableId:i?Object(y.l)(e.id):void 0,field:e.queryMatch.field,isAggregatable:t,fieldType:n,hideTopN:a,isObjectArray:!1,onFilterAdded:r,ownFocus:g,showOwnFocus:!1,showTopN:S,scopeId:h,toggleTopN:x,values:k})}),[g,S,e,s,O,j,i,t,n,a,r,h,x,k]),C=Object(o.useCallback)((e=>{m.current=e}),[]),T=Object(o.useCallback)((()=>{var e;g||null===(e=p.current)||void 0===e||e.focus()}),[g,p]),M=Object(o.useCallback)((()=>{O(),g&&(v(!1),setTimeout((()=>{T()}),0))}),[T,g,O]),I=Object(o.useCallback)((()=>{v(!0)}),[]);return Object(o.useMemo)((()=>({closePopOverTrigger:f,handleClosePopOverTrigger:j,hoverActionsOwnFocus:g,hoverContent:w,keyboardHandlerRef:p,onCloseRequested:M,onFocus:T,openPopover:I,setContainerRef:C,isShowingTopN:S})),[f,j,g,w,M,T,I,C,S])};var Q=n(694);const W=m.a.div.withConfig({displayName:"DragEffects",componentId:"sc-1n4vnmw-0"})([""]);W.displayName="DragEffects";class draggable_wrapper_DragDropErrorBoundary extends l.a.PureComponent{componentDidCatch(){this.forceUpdate()}render(){return this.props.children}}const K=m.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1n4vnmw-1"})(["display:inline-block;max-width:100%;[data-rbd-placeholder-context-id]{display:none !important;}",""],(({disabled:e})=>e&&"\n    [data-rbd-draggable-id]:hover,\n    .euiBadge:hover,\n    .euiBadge__text:hover {\n      cursor: default;\n    }\n  "));K.displayName="Wrapper";const Y=m.a.span.withConfig({displayName:"ProviderContentWrapper",componentId:"sc-1n4vnmw-2"})(["> span.euiToolTipAnchor{display:block;}> span.euiToolTipAnchor.eui-textTruncate{display:inline-block;}"]),X=(e,t)=>t.isDropAnimating?{...e,transitionDuration:"0.00000001s"}:e,J=({dataProvider:e,hideTopN:t=!1,onFilterAdded:n,render:a,fieldType:d="",isAggregatable:m=!1,scopeId:p,truncate:E})=>{const[O,x]=Object(o.useState)(!1),S=e.id.includes(`-${b.a}-`),k=Object(c.useDispatch)(),{closePopOverTrigger:w,handleClosePopOverTrigger:C,hoverActionsOwnFocus:T,hoverContent:M,keyboardHandlerRef:I,onCloseRequested:A,openPopover:P,onFocus:_,setContainerRef:D,isShowingTopN:F}=G({dataProvider:e,hideTopN:t,onFilterAdded:n,render:a,fieldType:d,isAggregatable:m,scopeId:p,truncate:E}),N=Object(o.useCallback)((()=>{S||(k(f.a.registerProvider({provider:e})),x(!0))}),[S,k,e]),R=Object(o.useCallback)((()=>O&&k(f.a.unRegisterProvider({id:e.id}))),[O,k,e.id]);Object(o.useEffect)((()=>()=>{R()}),[R]);const z=Object(o.useCallback)(((t,n)=>l.a.createElement(te,{registerProvider:N},l.a.createElement("div",i()({},t.draggableProps,t.dragHandleProps,{style:X(t.draggableProps.style,n),ref:t.innerRef,"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(Y,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},a(e,t,n))))),[e,N,a]),L=Object(o.useCallback)(((t,n)=>l.a.createElement(h.a,i()({},t.draggableProps,t.dragHandleProps,{ref:e=>{t.innerRef(e),D(e)},"data-test-subj":"providerContainer",isDragging:n.isDragging,registerProvider:N,tabIndex:-1}),l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyField"},l.a.createElement("p",null,e.queryMatch.field)),E&&!n.isDragging?l.a.createElement(g.b,{"data-test-subj":"draggable-truncatable-content"},a(e,t,n)):l.a.createElement(Y,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},a(e,t,n)),!n.isDragging&&l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"draggableKeyboardInstructionsNotDragging"},l.a.createElement("p",null,j.b)))),[e,N,a,D,E]),{onBlur:B,onKeyDown:q}=Object(Q.a)({closePopover:C,draggableId:Object(y.l)(e.id),fieldName:e.queryMatch.field,keyboardHandlerRef:I,openPopover:P}),$=Object(o.useCallback)((t=>l.a.createElement("div",i()({ref:t.innerRef},t.droppableProps),l.a.createElement("div",{className:s.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:_,onBlur:B,onKeyDown:q,ref:I,role:"button",tabIndex:0},l.a.createElement(u.Draggable,{draggableId:Object(y.l)(e.id),index:0,key:Object(y.l)(e.id),isDragDisabled:S},L)),t.placeholder)),[L,e.id,S,I,B,_,q]),V=Object(o.useMemo)((()=>l.a.createElement(K,{"data-test-subj":"draggableWrapperDiv",disabled:S},l.a.createElement(draggable_wrapper_DragDropErrorBoundary,null,l.a.createElement(u.Droppable,{isDropDisabled:!0,droppableId:Object(y.m)(e.id),renderClone:z},$)))),[$,z,e.id,S]),U=Object(o.useCallback)((()=>V),[V]);return S?l.a.createElement(l.a.Fragment,null,V):l.a.createElement(v.a,{alwaysShow:F||T,closePopOverTrigger:w,hoverContent:M,onCloseRequested:A,render:U})},Z=({dataProvider:e,hideTopN:t=!1,isDraggable:n=!1,onFilterAdded:a,render:i,isAggregatable:r=!1,fieldType:s="",scopeId:u,truncate:c})=>{const{closePopOverTrigger:d,hoverActionsOwnFocus:m,hoverContent:f,onCloseRequested:h,setContainerRef:j,isShowingTopN:E}=G({dataProvider:e,hideTopN:t,isDraggable:n,isAggregatable:r,fieldType:s,onFilterAdded:a,render:i,scopeId:u,truncate:c}),O=Object(o.useCallback)((()=>l.a.createElement("div",{ref:e=>{j(e)},tabIndex:-1,"data-provider-id":Object(y.l)(e.id)},c?l.a.createElement(g.b,{"data-test-subj":"render-truncatable-content"},i(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):l.a.createElement(Y,{"data-test-subj":`render-content-${e.queryMatch.field}`},i(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})))),[e,i,j,c]);return n?l.a.createElement(J,{dataProvider:e,hideTopN:t,onFilterAdded:a,fieldType:s,isAggregatable:r,render:i,scopeId:u,truncate:c}):l.a.createElement(v.a,{alwaysShow:E||m,closePopOverTrigger:d,hoverContent:(x=u,[p.e.rulePreview,b.a].includes(null!=x?x:"")?void 0:f),onCloseRequested:h,render:O});var x},ee=l.a.memo(Z);ee.displayName="DraggableWrapper";const te=l.a.memo((({children:e,registerProvider:t})=>(Object(o.useEffect)((()=>{t()}),[t]),l.a.createElement(l.a.Fragment,null,e))));te.displayName="ConditionalPortal"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return I}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17),l=n(48),u=n(45);const c=n(5).i18n.translate("xpack.securitySolution.components.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"});var d=n(170),m=n(431),p=n(383),f=n(759),b=n(158),g=n(119),v=n(276),y=n(339),h=n(160),j=n(130),E=n(190),O=n(330),x=n(598),S=n(525);const k=({isInitialLoading:e,barChart:t,configs:n,stackByField:a,scopeId:r})=>e?i.a.createElement(S.a,null):i.a.createElement(x.a,{barChart:t,configs:n,stackByField:a,scopeId:r}),w=i.a.memo(k);k.displayName="MatrixHistogramChartContentComponent";var C=n(347);const T=s()(m.a).withConfig({displayName:"HistogramPanel",componentId:"sc-cnfih-0"})(["display:flex;flex-direction:column;",""],(({height:e})=>null!=e?`min-height: ${e}px;`:"")),M=({chartHeight:e,defaultStackByOption:t,endDate:n,errorMessage:r,filterQuery:s,getLensAttributes:m,headerChildren:x,histogramType:S,hideHistogramIfEmpty:k=!1,id:M,indexNames:I,runtimeMappings:A,isPtrIncluded:P,legendPosition:_,lensAttributes:D,mapping:F,onError:N,paddingSize:R="m",panelHeight:z=300,setAbsoluteRangeDatePickerTarget:L=g.a.global,setQuery:B,showInspectButton:q=!1,showLegend:$,showSpacer:V=!0,stackByOptions:U,startDate:H,subtitle:G,scopeId:Q,sourcererScopeId:W,title:K,titleSize:Y,yTickFormatter:X,skip:J,hideQueryToggle:Z=!1,applyGlobalQueriesAndFilters:ee=!0})=>{const te=`${M}-embeddable`,ne=Object(l.useDispatch)(),ae=Object(a.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;ne(Object(b.setAbsoluteRangeDatePicker)({id:L,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[ne,L]),ie=Object(a.useMemo)((()=>Object(p.b)({chartHeight:e,from:H,legendPosition:_,to:n,onBrushEnd:ae,yTickFormatter:X,showLegend:$})),[e,H,_,n,ae,X,$]),[re,se]=Object(a.useState)(!0),[oe,le]=Object(a.useState)(t);Object(a.useEffect)((()=>{le(t)}),[t]);const ue=Object(a.useCallback)((e=>{var n;le(null!==(n=U.find((t=>t.value===e.target.value)))&&void 0!==n?n:t)}),[t,U]),{toggleStatus:ce,setToggleStatus:de}=Object(h.a)(M),[me,pe]=Object(a.useState)(J||!ce);Object(a.useEffect)((()=>{pe(J||!ce)}),[J,ce]);const fe=Object(a.useCallback)((e=>{de(e),pe(!e)}),[pe,de]),be=Object(j.a)("chartEmbeddablesEnabled"),ge={endDate:n,errorMessage:r,filterQuery:s,histogramType:S,indexNames:I,onError:N,startDate:H,stackByField:oe.value,runtimeMappings:A,isPtrIncluded:P,skip:me||be},[ve,{data:ye,inspect:he,totalCount:je,refetch:Ee}]=Object(f.a)(ge),Oe=Object(a.useMemo)((()=>null!=K&&"function"==typeof K?K(oe):K),[K,oe]),xe=Object(C.a)({visualizationId:te}),Se=Object(a.useMemo)((()=>{if(re)return null;if("function"==typeof G){if(be){if(!xe||(e=xe[0],!Object.values(null!==(t=e.aggregations)&&void 0!==t?t:{}).some((({buckets:e})=>e.length>0))))return G(0);const n=xe[0].hits.total;return n>=0?G(n):null}return je>=0?G(je):null}var e,t;return G}),[be,re,G,je,xe]),ke=Object(a.useMemo)((()=>!!(je<=0&&k)),[je,k]),we=Object(a.useMemo)((()=>Object(p.c)(ye,F)),[ye,F]);Object(a.useEffect)((()=>{ve||re||B({id:M,inspect:he,loading:ve,refetch:Ee}),re&&we&&ye&&se(!1)}),[we,ye,M,he,be,re,ve,Ee,se,B]);const Ce=Object(a.useMemo)((()=>({from:H,to:n})),[H,n]),Te=Object(a.useMemo)((()=>({dnsIsPtrIncluded:null!=P&&P,filters:s?[{query:Object(u.isString)(s)?JSON.parse(s):s,meta:{}}]:void 0})),[P,s]);return ke?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(v.a,{show:!re,targetClassNames:[E.a]},i.a.createElement(T,{"data-test-subj":`${M}Panel`,height:ce?z:void 0,paddingSize:R},ve&&!re&&i.a.createElement(o.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),i.a.createElement(d.a,{id:M,height:ce?void 0:0,title:Oe,titleSize:Y,toggleStatus:ce,toggleQuery:Z?void 0:fe,subtitle:Se,inspectMultiple:!0,showInspectButton:q&&!be,isInspectDisabled:void 0===s},i.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},(m||D)&&Ce&&!be&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(y.a,{className:"histogram-viz-actions",extraOptions:Te,getLensAttributes:m,isInspectButtonDisabled:void 0===s,lensAttributes:D,queryId:M,stackByField:oe.value,timerange:Ce,title:K})),i.a.createElement(o.EuiFlexItem,{grow:!1},U.length>1&&i.a.createElement(o.EuiSelect,{onChange:ue,options:U,prepend:c,value:null==oe?void 0:oe.value})),i.a.createElement(o.EuiFlexItem,{grow:!1},x))),ce?be?i.a.createElement(O.a,{scopeId:W,applyGlobalQueriesAndFilters:ee,"data-test-subj":"embeddable-matrix-histogram",extraOptions:Te,getLensAttributes:m,height:null!=e?e:150,id:te,inspectTitle:K,lensAttributes:D,stackByField:oe.value,timerange:Ce}):i.a.createElement(w,{isInitialLoading:re,barChart:we,configs:ie,stackByField:oe.value,scopeId:Q}):null)),V&&i.a.createElement(o.EuiSpacer,{"data-test-subj":"spacer",size:"l"}))},I=i.a.memo(M)},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(5);const u=l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.anonymizeFieldsdDescription",{defaultMessage:"Anonymized"});var c=n(372),d=n(13);const m=o()(a.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeS};
`,p=({anonymized:e,isDataAnonymizable:t,showIcon:n=!1})=>{const r=Object(i.useMemo)((()=>(e=>e?"default":"subdued")(t)),[t]),s=Object(i.useMemo)((()=>(({anonymized:e,isDataAnonymizable:t})=>t&&0!==e?(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.fieldsWillBeAnonymizedTooltip",{values:{anonymized:e},defaultMessage:"{anonymized} {anonymized, plural, =1 {field} other {fields}} in this context will be replaced with random values. Responses are automatically translated back to the original values."}))(e):(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.noneOfTheDataWillBeAnonymizedTooltip",{values:{isDataAnonymizable:e},defaultMessage:"{isDataAnonymizable, select, true {Select fields to be replaced with random values. Responses are automatically translated back to the original values.} other {This context cannot be anonymized}}"}))(t))({anonymized:e,isDataAnonymizable:t})),[e,t]),o=Object(i.useMemo)((()=>Object(d.jsx)(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n&&Object(d.jsx)(m,{grow:!1},Object(d.jsx)(a.EuiIcon,{color:r,"data-test-subj":"anonymizationIcon",size:"m",type:"eyeClosed"})),Object(d.jsx)(a.EuiFlexItem,{grow:!1},Object(d.jsx)(a.EuiText,{color:r,"data-test-subj":"description",size:"s"},u)))),[r,n]);return Object(d.jsx)(a.EuiToolTip,{content:s},Object(d.jsx)(a.EuiStat,{"data-test-subj":"anonymizedFieldsStat",description:o,reverse:!0,titleColor:r,title:e,titleSize:c.a}))};p.displayName="AnonymizedStatComponent";const f=r.a.memo(p)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),r=n(76),s=n(17),o=n(179),l=n(177),u=n(13);const c=Object(o.css)({name:"1les383",styles:".euiKeyPadMenuItem__label{white-space:nowrap;overflow:hidden;}"}),d=({actionTypes:e,actionTypeRegistry:t,onClose:n,onSelect:a})=>e&&e.length>0?Object(u.jsx)(s.EuiModal,{onClose:n,"data-test-subj":"action-type-selector-modal"},Object(u.jsx)(s.EuiModalHeader,null,Object(u.jsx)(s.EuiModalHeaderTitle,null,l.m)),Object(u.jsx)(s.EuiModalBody,null,Object(u.jsx)(s.EuiFlexGroup,null,e.map((e=>{const n=t.get(e.id);return Object(u.jsx)(s.EuiFlexItem,{"data-test-subj":"action-option",key:e.id,grow:!1},Object(u.jsx)(s.EuiKeyPadMenuItem,{className:c,key:e.id,isDisabled:!e.enabled,label:e.name,"data-test-subj":`action-option-${e.name}`,onClick:()=>a(e)},Object(u.jsx)(s.EuiIcon,{size:"xl",type:n.iconClass})))}))))):null,m=i.a.memo((({actionTypeRegistry:e,actionTypes:t,onClose:n,onSaveConnector:a,onSelectActionType:i,selectedActionType:s})=>s?Object(u.jsx)(r.ConnectorAddModal,{actionType:s,actionTypeRegistry:e,onClose:n,postSaveEventHandler:a}):Object(u.jsx)(d,{actionTypes:t,actionTypeRegistry:e,onClose:n,onSelect:i})));m.displayName="AddConnectorModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneralPrompt",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-code portal into your Elastic life. In time, I will be able to answer questions and provide assistance across all your information in Elastic, and oh-so much more. Till then, I hope this early preview will open your mind to the possibilities of what we can create when we work together, in the open. Cheers!"}),r=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneral2Prompt",{defaultMessage:"First things first, we'll need to set up a Generative AI Connector to get this chat experience going! With the Generative AI Connector, you'll be able to configure access to either an OpenAI service or an Amazon Bedrock service, but you better believe you'll be able to deploy your own models within your Elastic Cloud instance and use those here in the future... 😉"}),s=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneral3Prompt",{defaultMessage:"Go ahead and click the add connector button below to continue the conversation!"}),o=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.enterprisePrompt",{defaultMessage:"Elastic AI Assistant is available to Enterprise users only. Please upgrade your license to use this feature."});var l=n(168);const u={id:l.d,theme:{title:l.c,titleIcon:"logoSecurity",assistant:{name:l.b,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}},messages:[{role:"assistant",content:i,timestamp:"",presentation:{delay:2e3,stream:!0}},{role:"assistant",content:r,timestamp:"",presentation:{delay:1e3,stream:!0}},{role:"assistant",content:s,timestamp:"",presentation:{delay:1e3,stream:!0}}],apiConfig:{}},c=[{role:"assistant",content:o,timestamp:"",presentation:{delay:2e3,stream:!0}}]},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(743),s=n(67),o=n(110),l=n(39),u=n(164);const c=({attributes:e})=>{const{lens:t,theme:n,i18n:c}=Object(o.i)().services,{SaveModalComponent:d,canUseEditor:m}=t,p=Object(u.m)(),{redirectTo:f,getEditOrCreateDashboardPath:b}=(({getSecuritySolutionUrl:e})=>{const{navigateTo:t}=Object(o.j)(),n=Object(a.useMemo)((()=>`${e({deepLinkId:l.SecurityPageName.dashboards})}`),[e]),i=Object(a.useCallback)((e=>null!=e&&"new"!==e?`${e}/edit`:"/create"),[]),r=Object(a.useCallback)((t=>`${e({deepLinkId:l.SecurityPageName.dashboards,path:i(t)})}`),[i,e]);return{redirectTo:Object(a.useCallback)((e=>{"listing"===e.destination&&t({url:n}),"dashboard"===e.destination&&t({url:r(e.id)})}),[n,r,t]),getEditOrCreateDashboardPath:i,getEditOrCreateDashboardUrl:r,dashboardListingUrl:n}})({getSecuritySolutionUrl:p});return{openSaveVisualizationFlyout:Object(a.useCallback)((()=>{const t=document.createElement("div");Object(r.a)(i.a.createElement(d,{initialInput:e,onSave:e=>{Object(s.unmountComponentAtNode)(t)},onClose:()=>{Object(s.unmountComponentAtNode)(t)},originatingApp:l.APP_UI_ID,getOriginatingPath:e=>`${l.SecurityPageName.dashboards}/${b(e)}`,redirectTo:f}),{theme:n,i18n:c})(t)}),[d,e,b,c,f,n]),disableVisualizations:Object(a.useMemo)((()=>!m()||null==e),[e,m])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(13),i=n(17),r=n(2),s=n.n(r),o=n(55),l=n(44),u=n.n(l),c=n(45),d=n(373);const m=u.a.strong`
  margin-right: ${({theme:e})=>e.eui.euiSizeS};
`;var p={name:"16fopk3",styles:"overflow:hidden;&:hover{cursor:pointer;text-decoration:underline;}"};var f=n(123),b=n(221),g=n(259),v=n(251);const y="ADD_NEW_SYSTEM_PROMPT";var h={name:"1bxycju",styles:"min-width:100%"},j={name:"qhxz92",styles:"max-width:100%"};const E=({allSystemPrompts:e,compressed:t=!1,conversation:n,selectedPrompt:l,clearSelectedSystemPrompt:u,isClearable:E=!1,isEditing:O=!1,isDisabled:x=!1,isOpen:S=!1,isSettingsModalVisible:k,onSystemPromptSelectionChange:w,setIsEditing:C,setIsSettingsModalVisible:T,showTitles:M=!1})=>{var I;const{setSelectedSettingsTab:A}=Object(f.b)(),{setApiConfig:P}=Object(b.a)(),[_,D]=Object(r.useState)(S),F=Object(r.useCallback)((()=>D(!1)),[]),N=Object(r.useCallback)((e=>{n&&P({conversationId:n.id,apiConfig:{...n.apiConfig,defaultSystemPromptId:null==e?void 0:e.id}})}),[n,P]),R=Object(r.useMemo)((()=>({value:y,inputDisplay:d.a,dropdownDisplay:Object(a.jsx)(i.EuiFlexGroup,{gutterSize:"none",key:y},Object(a.jsx)(i.EuiFlexItem,{grow:!0},Object(a.jsx)(i.EuiButtonEmpty,{href:"#",iconType:"plus",size:"xs","data-test-subj":"addSystemPrompt"},d.a)),Object(a.jsx)(i.EuiFlexItem,{grow:!1},Object(a.jsx)("div",{style:{width:"24px"}})))})),[]),z=Object(r.useMemo)((()=>(({prompts:e,showTitles:t=!1})=>{var n;return null!==(n=null==e?void 0:e.map((e=>(({content:e,id:t,name:n,showTitles:r=!1})=>({value:t,inputDisplay:Object(a.jsx)(i.EuiText,{color:"subdued","data-test-subj":"systemPromptText",css:p},r?n:e),dropdownDisplay:Object(a.jsx)(s.a.Fragment,null,Object(a.jsx)(m,{"data-test-subj":"name"},n),Object(a.jsx)(i.EuiToolTip,{content:void 0},Object(a.jsx)(i.EuiText,{color:"subdued","data-test-subj":"content",size:"s"},Object(c.isEmpty)(e)?Object(a.jsx)("p",null,d.d):Object(a.jsx)("p",null,e))))}))({...e,showTitles:t}))))&&void 0!==n?n:[]})({prompts:e,showTitles:M})),[e,M]),L=Object(r.useCallback)((t=>{if(t===y)return T(!0),void A(g.d);null!=w?w(t):N(e.find((e=>e.id===t))),null==C||C(!1)}),[e,w,C,T,A,N]),B=Object(r.useCallback)((()=>{N(void 0),null==C||C(!1),null==u||u()}),[u,C,N]),q=Object(r.useCallback)((()=>{null==C||C(!0),D(!0)}),[C]);return Object(a.jsx)(i.EuiFlexGroup,{"data-test-subj":"selectSystemPrompt",gutterSize:"none"},Object(a.jsx)(i.EuiFlexItem,{css:j},O&&Object(a.jsx)(i.EuiFormRow,{css:h},Object(a.jsx)(i.EuiSuperSelect,{popoverProps:{zIndex:o.euiThemeVars.euiZLevel8},compressed:t,"data-test-subj":v.a.PROMPT_SUPERSELECT,fullWidth:!0,hasDividers:!0,itemLayoutAlign:"top",disabled:x,isOpen:_&&!k,onChange:L,onBlur:F,options:[...z,R],placeholder:d.e,valueOfSelected:null!==(I=null==l?void 0:l.id)&&void 0!==I?I:e[0].id}))),Object(a.jsx)(i.EuiFlexItem,{grow:!1},O&&E&&Object(a.jsx)(i.EuiToolTip,{content:d.c},Object(a.jsx)(i.EuiButtonIcon,{"aria-label":d.c,"data-test-subj":"clearSystemPrompt",iconType:"cross",onClick:B})),!O&&Object(a.jsx)(i.EuiToolTip,{content:d.b},Object(a.jsx)(i.EuiButtonIcon,{"aria-label":d.b,"data-test-subj":"addSystemPrompt",iconType:"plus",onClick:q}))))};E.displayName="SelectSystemPromptComponent";const O=s.a.memo(E)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(17),i=n(2),r=n.n(i),s=n(372),o=n(5);const l=o.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedDescription",{defaultMessage:"Allowed"});var u=n(13);const c=({allowed:e,total:t})=>{const n=Object(i.useMemo)((()=>(({allowed:e,total:t})=>o.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedTooltip",{values:{allowed:e,total:t},defaultMessage:"{allowed} of {total} fields in this context are allowed to be included in the conversation"}))({allowed:e,total:t})),[e,t]);return Object(u.jsx)(a.EuiToolTip,{content:n},Object(u.jsx)(a.EuiStat,{"data-test-subj":"allowedStat",description:l,reverse:!0,title:e,titleSize:s.a}))};c.displayName="AllowedStatComponent";const d=r.a.memo(c)},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorGetAlertDescription",{defaultMessage:"Failed to get signal index name"}),r=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorPostAlertDescription",{defaultMessage:"Failed to create signal index"}),s=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.failedToIsolate.title",{defaultMessage:"Failed to isolate host"}),o=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.casesFromAlerts.title",{defaultMessage:"Failed to find associated cases"});a.i18n.translate("xpack.securitySolution.containers.detectionEngine.users.userProfiles.title",{defaultMessage:"Failed to find users"})},,,,,function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),n(338).NetworkType.details,function(e){e.anomalies="anomalies",e.flows="flows",e.tls="tls",e.http="http",e.events="events",e.users="users"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return k}));var a=n(136),i=n.n(a),r=n(45),s=n(2),o=n(48),l=n(3),u=n(54),c=n(110),d=n(209),m=n(118),p=n(446),f=n(127),b=n(125),g=n(122),v=n(202),y=n(282),h=n(336),j=n(4);const E="timelineEventsQuery",O=[{field:"@timestamp",direction:b.b.asc,type:"date",esTypes:["date"]}],x=e=>({...Object(r.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(r.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(r.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(r.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),S=({dataViewId:e,endDate:t,eqlOptions:n,id:a=E,indexNames:S,fields:k,filterQuery:w,runtimeMappings:C,startDate:T,language:M="kuery",limit:I,sort:A=O,skip:P=!1,timerangeKind:_})=>{const[{pageName:D}]=Object(v.a)(),F=Object(o.useDispatch)(),{data:N}=Object(c.i)().services,R=Object(s.useRef)(r.noop),z=Object(s.useRef)(new AbortController),L=Object(s.useRef)(new l.Subscription),[B,q]=Object(s.useState)(!1),[$,V]=Object(s.useState)(a===g.c.active?y.a.getActivePage():0),[U,H]=Object(s.useState)(null),G=Object(s.useRef)(null),{startTracking:Q}=Object(h.a)(),W=Object(s.useCallback)((()=>{null!=a&&p.a.some((e=>e===a))&&(F(m.a.clearEventsLoading({id:a})),F(m.a.clearEventsDeleted({id:a})))}),[F,a]),K=Object(s.useCallback)((e=>{W(),a===g.c.active&&(y.a.setExpandedDetail({}),y.a.setActivePage(e)),V(e)}),[W,a]),Y=Object(s.useCallback)((()=>{null!=R.current&&R.current(),K(0)}),[K]),[X,J]=Object(s.useState)({id:a,inspect:{dsl:[],response:[]},refetch:Y,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:K,refreshedAt:0}),Z=Object(s.useCallback)((async(t,n)=>{if(null==t||""===D||P)return;const i=async()=>{G.current=t,z.current=new AbortController,q(!0);const{endTracking:i}=Q({name:`${j.l} timeline events search`});L.current=N.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:z.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(u.isRunningResponse)(e)||(i("success"),q(!1),J((i=>{const r={...i,events:(s=e.edges,s.map((e=>e.node))),inspect:Object(f.getInspectResponse)(e,i.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,refreshedAt:Date.now()};var s;return a===g.c.active&&(y.a.setExpandedDetail({}),y.a.setPageName(D),"eql"===t.language?(y.a.setEqlRequest(t),y.a.setEqlResponse(r)):(y.a.setRequest(t),y.a.setResponse(r))),n&&n(r),r})),L.current.unsubscribe())},error:e=>{i(z.current.signal.aborted?"aborted":"error"),q(!1),N.search.showError(e),L.current.unsubscribe()}})};if(a===g.c.active&&""!==y.a.getPageName()&&D!==y.a.getPageName()){if(y.a.setPageName(D),z.current.abort(),q(!1),"eql"===t.language?(G.current=y.a.getEqlRequest(),R.current=i.bind(null,y.a.getEqlRequest())):(G.current=y.a.getRequest(),R.current=i.bind(null,y.a.getRequest())),J((e=>{const n="eql"===t.language?y.a.getEqlResponse():y.a.getResponse();return null!=n?{...n,refetch:Y,loadPage:K}:e})),"eql"!==t.language&&null!=y.a.getResponse())return;if("eql"===t.language&&null!=y.a.getEqlResponse())return}L.current.unsubscribe(),z.current.abort(),await i(),R.current=i}),[D,P,a,Q,N.search,e,Y,K]);Object(s.useEffect)((()=>{0!==S.length&&H((e=>{var r,s,o,l,u,c,m;const p=e,f={defaultIndex:null!==(r=null==e?void 0:e.defaultIndex)&&void 0!==r?r:[],filterQuery:null!==(s=null==e?void 0:e.filterQuery)&&void 0!==s?s:"",querySize:null!==(o=null==e||null===(l=e.pagination)||void 0===l?void 0:l.querySize)&&void 0!==o?o:0,sort:null!==(u=null==e?void 0:e.sort)&&void 0!==u?u:O,timerange:null!==(c=null==e?void 0:e.timerange)&&void 0!==c?c:{},runtimeMappings:null!==(m=null==e?void 0:e.runtimeMappings)&&void 0!==m?m:{},...x(p)},v=T&&t?{timerange:{interval:"12h",from:T,to:t}}:{},h={defaultIndex:S,filterQuery:Object(d.a)(w),querySize:I,sort:A,runtimeMappings:C,...v,...x(n)},j=i()(f,h)?$:0,E={defaultIndex:S,factoryQueryType:b.y.all,fieldRequested:k,fields:k,filterQuery:Object(d.a)(w),pagination:{activePage:j,querySize:I},language:M,runtimeMappings:C,sort:A,...v,...n||{}};return $!==j&&(V(j),a===g.c.active&&y.a.setActivePage(j)),i()(e,E)?e:E}))}),[F,S,$,t,n,w,a,M,I,T,A,k,C]);const ee=Object(s.useCallback)((async e=>{a===g.c.active&&"absolute"!==_&&i()(G.current,U)||await Z(U,e)}),[a,U,Z,_]);return Object(s.useEffect)((()=>{Object(r.isEmpty)(w)&&J({id:a,inspect:{dsl:[],response:[]},refetch:Y,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:K,refreshedAt:0})}),[w,a,Y,K]),[B,X,ee]},k=({dataViewId:e,endDate:t,eqlOptions:n,id:a=E,indexNames:i,fields:r,filterQuery:o,runtimeMappings:l,startDate:u,language:c="kuery",limit:d,sort:m=O,skip:p=!1,timerangeKind:f})=>{const[b,g,v]=S({dataViewId:e,endDate:t,eqlOptions:n,id:a,indexNames:i,fields:r,filterQuery:o,runtimeMappings:l,startDate:u,language:c,limit:d,sort:m,skip:p,timerangeKind:f});return Object(s.useEffect)((()=>{v&&v()}),[v]),[b,g]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(19),r=n(110);const s=()=>{const e=Object(r.i)(),{http:t}=e.services,[n,s]=Object(a.useState)(Object(i.createSavedQueryService)(t));return Object(a.useEffect)((()=>{s(Object(i.createSavedQueryService)(t))}),[t]),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(4),r=n(110);const s=({defaultValue:e,key:t,plugin:n=i.i,isInvalidDefault:s})=>{const{storage:o}=Object(r.i)().services,[l,u]=Object(a.useState)(!1),[c,d]=Object(a.useState)(e),m=Object(a.useCallback)((()=>{const a=o.get(`${n}.${t}`),i=typeof a!=typeof e,r=null!=s&&s(a);d(i||r?e:a)}),[e,s,t,n,o]),p=Object(a.useCallback)((e=>{if("function"==typeof e){const a=e;d((e=>{const i=a(e);return o.set(`${n}.${t}`,i),i}))}else o.set(`${n}.${t}`,e),d(e)}),[t,n,o]);return Object(a.useEffect)((()=>{l||(m(),u(!0))}),[l,m]),[c,p,u]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(45);const i=e=>e.replace(/:/g,"-"),r=e=>e.replace(/-/g,":"),s=e=>Object(a.isUndefined)(e)?void 0:Object(a.castArray)(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(45),i=n(2),r=n.n(i),s=n(153),o=n(753);const l=r.a.memo((({dataProvider:e})=>{var t;const[n,l]=Object(i.useState)(!1);return r.a.createElement(o.a,{deleteProvider:a.noop,field:e.queryMatch.displayField||e.queryMatch.field,kqlQuery:e.kqlQuery,isEnabled:e.enabled,isExcluded:e.excluded,providerId:e.id,isPopoverOpen:n,setIsPopoverOpen:l,toggleExcludedProvider:a.noop,toggleEnabledProvider:a.noop,toggleTypeProvider:a.noop,displayValue:String(null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value),val:e.queryMatch.value,operator:e.queryMatch.operator||s.d,type:e.type||s.a.default})}));l.displayName="Provider"},,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return b}));var a=n(17),i=n(56),r=n.n(i),s=n(2),o=n.n(s),l=n(44),u=n.n(l),c=n(51),d=n(459),m=n(214);d.f;const p=u.a.h3.withConfig({displayName:"TitleText",componentId:"sc-7x1zh4-0"})(["margin:0 5px;cursor:default;user-select:none;"]);p.displayName="TitleText",o.a.memo((({noteIds:e})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{color:"text",size:"l",type:"editorComment"})),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiTitle,{size:"s"},o.a.createElement(p,null,d.e))),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(m.c,{color:"hollow"},e.length))))).displayName="NotesCount";const f=({newNote:e,user:t})=>({created:r.a.utc().toDate(),id:Object(c.v4)(),lastEdit:null,note:e,saveObjectId:null,user:t,version:null}),b=({associateNote:e,newNote:t,updateNewNote:n,updateNote:a,user:i})=>{const r=f({newNote:t,user:i});a(r),e(r.id),n("")}},function(e,t,n){const a=n(304);e.exports=(e,t)=>{const n=a(e,t);return n?n.version:null}},function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var a=n(5);const i=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinTooltip",{values:{isAlert:e},defaultMessage:"Pin {isAlert, select, true{alert} other{event}}"}),r=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.unpinTooltip",{values:{isAlert:e},defaultMessage:"Unpin {isAlert, select, true{alert} other{event}}"}),s=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinnnedWithNotesTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} cannot be unpinned because it has notes"}),o=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),l=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),u=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.disablePinnnedTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} may not be pinned while editing a template timeline"}),c=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.attachAlertToCaseForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Attach the alert or event in row {ariaRowindex} to a case, with columns {columnValues}"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var a=n(17),i=n(2),r=n.n(i),s=n(562);const o="exit-full-screen",l=({fullScreen:e,setFullScreen:t})=>{const n=Object(i.useCallback)((()=>{t(!1)}),[t]),l=Object(i.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),n())}),[n]);return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiWindowEvent,{event:"keydown",handler:l}),r.a.createElement(a.EuiButton,{className:o,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",fill:!0,isDisabled:!e,onClick:n},s.a)):null};l.displayName="ExitFullScreenComponent";const u=r.a.memo(l)},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.eventsViewer.showingLabel",{defaultMessage:"Showing"}),r=(a.i18n.translate("xpack.securitySolution.eventsViewer.eventsLabel",{defaultMessage:"Events"}),e=>a.i18n.translate("xpack.securitySolution.eventsViewer.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"})),s=a.i18n.translate("xpack.securitySolution.eventsViewer.actionsColumnLabel",{defaultMessage:"Actions"});a.i18n.translate("xpack.securitySolution.eventsViewer.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(236);const u=o.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-pcodem-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),c=({count:e,onClick:t})=>{const n=Object(i.useCallback)((()=>t&&t()),[t]);return e?t?r.a.createElement(a.EuiLink,{onClick:n},r.a.createElement("b",null,r.a.createElement(l.a,{count:e}))):r.a.createElement("b",null,r.a.createElement(l.a,{count:e})):r.a.createElement(u,null)};c.displayName="ChartLabelComponent";const d=r.a.memo(c)},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return h}));var a=n(17),i=n(2),r=n.n(i),s=n(62),o=n(9),l=n(44),u=n.n(l),c=n(5),d=n(265),m=n(351),p=n(597);const f={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},b=u()(a.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-g5h38u-0"})(["top:",";width:100%;max-width:77px;position:absolute;z-index:1;",""],(({$isChartEmbeddablesEnabled:e,$dataExists:t})=>e&&!t?"66%":"34%;"),(({className:e,$donutTextWrapperStyles:t})=>e&&t?`&.${e} {${t}}`:"")),g=u()(a.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-g5h38u-1"})(["position:relative;align-items:center;"]),v=({children:e,dataExists:t,donutTextWrapperClassName:n,donutTextWrapperStyles:s,isChartEmbeddablesEnabled:o,label:l,title:u})=>{const{euiTheme:c}=Object(a.useEuiTheme)(),d=Object(i.useMemo)((()=>({color:c.colors.disabled})),[c.colors.disabled]),m=o?void 0:"eui-textTruncate";return r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},r.a.createElement(g,{grow:o},r.a.createElement(b,{$dataExists:t,$donutTextWrapperStyles:s,$isChartEmbeddablesEnabled:o,alignItems:"center",className:n,direction:"column",gutterSize:"none",justifyContent:"center"},r.a.createElement(a.EuiFlexItem,null,u),l&&r.a.createElement(a.EuiFlexItem,{className:m},r.a.createElement(a.EuiToolTip,{content:l},r.a.createElement(a.EuiText,{className:m,size:"s",style:t?void 0:d},l)))),e))},y=r.a.memo(v),h=({data:e,fillColor:t,height:n=90,label:l,legendItems:u,onPartitionClick:b,title:g,totalCount:v})=>{const{baseTheme:h,theme:j}=Object(d.i)(),E=Object(i.useCallback)((e=>{if(b){var t;const n=e.flat(2),a=n.length>0&&"groupByRollup"in n[0]&&null!=(null===(t=n[0])||void 0===t?void 0:t.groupByRollup)?`${n[0].groupByRollup}`:"";Object(o.isEmpty)(a.trim())||b(a.toLowerCase())}}),[b]);return r.a.createElement(y,{dataExists:null!=e&&e.length>0,label:l,title:g,isChartEmbeddablesEnabled:!1},r.a.createElement(r.a.Fragment,null,null==e||null==v||0===v?r.a.createElement(p.a,{size:n}):r.a.createElement(s.Chart,{size:n},r.a.createElement(s.Settings,{theme:[f,j],baseTheme:h,onElementClick:E,locale:c.i18n.getLocale()}),r.a.createElement(s.Partition,{id:"donut-chart",data:e,layout:s.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(s.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]})),u&&(null==u?void 0:u.length)>0&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(m.a,{legendItems:u,height:n}))))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17);const l="#FAFBFD",u=s.a.div.withConfig({displayName:"BigRing",componentId:"sc-1m6sj8k-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${l};\n    text-align: center;\n    line-height: ${e}px;`)),c=s.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1m6sj8k-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: ${Object(o.useEuiBackgroundColor)("plain")};\n    display: inline-block;\n    vertical-align: middle;`)),d=({size:e=90,donutWidth:t=20})=>e-t>0?i.a.createElement(u,{size:e,"data-test-subj":"empty-donut"},i.a.createElement(c,{size:e-t,"data-test-subj":"empty-donut-small"})):null,m=i.a.memo(d)},function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var a=n(23),i=n.n(a),r=n(17),s=n(2),o=n.n(s),l=n(5),u=n(62),c=n(45),d=n(324),m=n.n(d),p=n(51),f=n(44),b=n.n(f),g=n(136),v=n.n(g),y=n(174),h=n(110),j=n(383),E=n(283),O=n(226),x=n(293),S=n(724),k=n(265),w=n(351),C=n(339),T=n(276),M=n(190);const I=b()(r.EuiFlexItem).withConfig({displayName:"LegendFlexItem",componentId:"sc-1257qcd-0"})(["overview:hidden;"]),A=e=>null!=e&&!!Object(c.get)("value.length",e)&&(e.value||[]).every((({x:e,y:t})=>Object(c.isNumber)(t)&&t>=0)),P=["y"],_=[e=>Object(O.a)(e.g)?e.g:x.c],D=({data:e,forceHiddenLegend:t=!1,yAxisTitle:n,...a})=>{const r=Object(k.i)(),d=Object(h.l)(),p=Object(c.get)("configs.axis.xTickFormatter",a),f=Object(c.get)("configs.axis.yTickFormatter",a),b=Object(c.getOr)(0,"configs.axis.tickSize",a),g=`stat-items-barchart-${e[0].key}-x`,v=`stat-items-barchart-${e[0].key}-y`,y={...k.e,...m()(Object(c.get)("configs.settings",a),r)},j=Object(s.useMemo)((()=>m()({tickLine:{size:b}},Object(c.getOr)({},"configs.axis.bottom.style",a))),[a,b]),E=Object(s.useMemo)((()=>m()({tickLine:{size:b}},Object(c.getOr)({},"configs.axis.left.style",a))),[a,b]),O=Object(c.get)("configs.axis.bottom.labelFormat",a);return a.width&&a.height?o.a.createElement(u.Chart,null,o.a.createElement(u.Settings,i()({},y,{showLegend:y.showLegend&&!t,locale:l.i18n.getLocale()})),e.map((e=>{var t;const n=e.key;return A(e)?o.a.createElement(u.BarSeries,{id:n,key:n,name:e.key,xScaleType:Object(c.getOr)(u.ScaleType.Linear,"configs.series.xScaleType",a),yScaleType:Object(c.getOr)(u.ScaleType.Linear,"configs.series.yScaleType",a),xAccessor:"x",yAccessors:P,timeZone:d,splitSeriesAccessors:_,data:null!==(t=e.value)&&void 0!==t?t:[],stackAccessors:Object(c.get)("configs.series.stackAccessors",a),color:e.color?e.color:void 0,barSeriesStyle:Object(c.get)("configs.series.barSeriesStyle",a)}):null})),o.a.createElement(u.Axis,{id:g,position:u.Position.Bottom,showOverlappingTicks:!1,style:j,tickFormat:p,labelFormat:O}),o.a.createElement(u.Axis,{id:v,position:u.Position.Left,style:E,tickFormat:f,title:n})):null};D.displayName="BarChartBaseComponent";const F=o.a.memo(D);F.displayName="BarChartBase";const N=[],R=({barChart:e,configs:t,stackByField:n,scopeId:a,visualizationActionsOptions:l})=>{const{ref:u,width:d,height:m}=Object(E.b)(),f=Object(s.useMemo)((()=>null!=e&&null!=n?e.map(((e,t)=>{var i;return{color:null!==(i=e.color)&&void 0!==i?i:t<j.a.length?j.a[t]:void 0,dataProviderId:Object(y.i)(`draggable-legend-item-${Object(p.v4)()}-${n}-${e.key}`),scopeId:a,field:n,value:e.key}})):N),[e,n,a]),b=Object(c.get)("yAxisTitle",t),g=Object(c.get)("customHeight",t),v=Object(c.get)("customWidth",t),h=Object(k.g)(g,m),O=Object(k.h)(v,d),x=Object(s.useMemo)((()=>{return t=e,Array.isArray(t)&&!Object(k.f)(t)&&t.some(A);var t}),[e]);return o.a.createElement(k.d,null,o.a.createElement(T.a,{targetClassNames:[M.a]},x&&e&&o.a.createElement(k.a,{gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(k.c,{ref:u,height:h},o.a.createElement(F,{configs:t,data:e,yAxisTitle:b,forceHiddenLegend:null!=n,height:h,width:h}))),o.a.createElement(I,{grow:!1},o.a.createElement(w.a,{legendItems:f,height:m}))),!x&&o.a.createElement(S.a,{height:h,width:O,data:e}),null!=l&&o.a.createElement(C.a,i()({},l,{className:"viz-actions"}))))},z=o.a.memo(R,((e,t)=>e.stackByField===t.stackByField&&e.scopeId===t.scopeId&&v()(e.configs,t.configs)&&v()(e.barChart,t.barChart)))},,,,,,,,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(612);n(74),n(268),n(269);var i=a.default({key:"css"}),r=i.flush,s=i.hydrate,o=i.cx,l=i.merge,u=i.getRegisteredStyles,c=i.injectGlobal,d=i.keyframes,m=i.css,p=i.sheet,f=i.cache;t.cache=f,t.css=m,t.cx=o,t.flush=r,t.getRegisteredStyles=u,t.hydrate=s,t.injectGlobal=c,t.keyframes=d,t.merge=l,t.sheet=p},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(74),i=n(268),r=n(269);function s(e){return e&&e.__esModule?e:{default:e}}var o=s(a);function l(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function u(e,t,n){var a=[],i=r.getRegisteredStyles(e,a,n);return a.length<2?n:i+t(a)}var c=function e(t){for(var n="",a=0;a<t.length;a++){var i=t[a];if(null!=i){var r=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))r=e(i);else for(var s in r="",i)i[s]&&s&&(r&&(r+=" "),r+=s);break;default:r=i}r&&(n&&(n+=" "),n+=r)}}return n};t.default=function(e){var t=o.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var s=i.serializeStyles(n,t.registered,void 0);return r.insertStyles(t,s,!1),t.key+"-"+s.name};return{css:n,cx:function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return u(t.registered,n,c(a))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered);l(t,r)},keyframes:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered),s="animation-"+r.name;return l(t,{name:r.name,styles:"@keyframes "+s+"{"+r.styles+"}"}),s},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:r.getRegisteredStyles.bind(null,t.registered),merge:u.bind(null,t.registered,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(614),i=n(616),r=n(418);function s(e){return e&&e.__esModule?e:{default:e}}var o=s(a),l=s(i),u=/[A-Z]|^ms/g,c=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},m=function(e){return null!=e&&"boolean"!=typeof e},p=s(r).default((function(e){return d(e)?e:e.replace(u,"-$&").toLowerCase()})),f=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(c,(function(e,t,n){return g={name:t,styles:n,next:g},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function b(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return g={name:n.name,styles:n.styles,next:g},n.name;if(void 0!==n.styles){var a=n.next;if(void 0!==a)for(;void 0!==a;)g={name:a.name,styles:a.styles,next:g},a=a.next;return n.styles+";"}return function(e,t,n){var a="";if(Array.isArray(n))for(var i=0;i<n.length;i++)a+=b(e,t,n[i])+";";else for(var r in n){var s=n[r];if("object"!=typeof s)null!=t&&void 0!==t[s]?a+=r+"{"+t[s]+"}":m(s)&&(a+=p(r)+":"+f(r,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var o=b(e,t,s);switch(r){case"animation":case"animationName":a+=p(r)+":"+o+";";break;default:a+=r+"{"+o+"}"}}else for(var l=0;l<s.length;l++)m(s[l])&&(a+=p(r)+":"+f(r,s[l])+";")}return a}(e,t,n);case"function":if(void 0!==e){var i=g,r=n(e);return g=i,b(e,t,r)}}if(null==t)return n;var s=t[n];return void 0!==s?s:n}var g,v=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var a=!0,i="";g=void 0;var r=e[0];null==r||void 0===r.raw?(a=!1,i+=b(n,t,r)):i+=r[0];for(var s=1;s<e.length;s++)i+=b(n,t,e[s]),a&&(i+=r[s]);v.lastIndex=0;for(var l,u="";null!==(l=v.exec(i));)u+="-"+l[1];return{name:o.default(i)+u,styles:i,next:g}}},function(e,t,n){"use strict";e.exports=n(615)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=0,a=0,i=e.length;i>=4;++a,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(a+2))<<16;case 2:n^=(255&e.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(a)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},function(e,t,n){"use strict";e.exports=n(617)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="undefined"!=typeof document,i=function(e,t,n){var i=e.key+"-"+t.name;(!1===n||!1===a&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,n){var a="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):a+=n+" "})),a},t.insertStyles=function(e,t,n){i(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var s="",o=t;do{var l=e.insert(t===o?"."+r:"",o,e.sheet,!0);a||void 0===l||(s+=l),o=o.next}while(void 0!==o);if(!a&&0!==s.length)return s}},t.registerStyles=i},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(289),i=n(425),r=n(32);const s=`${r.c}: true`,o=`${r.c}: false`,l=`${r.a}: true`,u=`${r.a}: false`;function c({filter:e,showCustomRules:t,showElasticRules:n,enabled:c,tags:m,excludeRuleTypes:p=[],ruleExecutionStatus:f}){const b=[];var g;return null!=e&&e.length&&b.push(`(${function(e,t=d){return t.map((t=>`${t}: ${Object(i.b)(e)}`)).join(" OR ")}(e)})`),t&&n||(n?b.push(s):t&&b.push(o)),void 0!==c&&b.push(c?l:u),null!=m&&m.length&&b.push(function(e){return`${r.g}:(${e.map(i.b).join(" AND ")})`}(m)),p.length&&b.push("NOT "+(g=p,`${r.d}: (${g.map(i.b).join(" OR ")})`)),f===a.f.succeeded?b.push(`${r.b}: "succeeded"`):f===a.f["partial failure"]?b.push(`${r.b}: "warning"`):f===a.f.failed&&b.push(`${r.b}: "failed"`),b.join(" AND ")}const d=[r.e,r.f.INDEX,r.f.TACTIC_ID,r.f.TACTIC_NAME,r.f.TECHNIQUE_ID,r.f.TECHNIQUE_NAME,r.f.SUBTECHNIQUE_ID,r.f.SUBTECHNIQUE_NAME]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(131),r=a.__importDefault(n(375));t.default=function(e,t){r.default(e,t,i.isDeepEqual)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(49),r=n(707);const s=()=>{const{pathname:e}=Object(i.useLocation)(),t=Object(r.a)();return[Object(a.useMemo)((()=>t(e)),[e,t])]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(17),i=n(114),r=n(2),s=n.n(r),o=n(44);const l=n.n(o)()(a.EuiPopover).withConfig({displayName:"WithHoverActionsPopover",componentId:"sc-1w6un7x-0"})([".euiPopover__anchor{width:100%;}"]),u=s.a.memo((({alwaysShow:e=!1,closePopOverTrigger:t,hoverContent:n,onCloseRequested:a,render:o})=>{const[u,c]=Object(r.useState)(null!=n&&e),[d,m]=Object(r.useState)(!1),[,p]=Object(r.useState)(void 0),f=Object(r.useRef)(null),b=Object(r.useCallback)((()=>{p((e=>{clearTimeout(e)})),m(!1),null!=a&&setTimeout((()=>{a()}))}),[a]),g=Object(r.useCallback)((()=>{p(Number(setTimeout((()=>{document.body.classList.contains(i.d)||m(!0)}),100)))}),[p,m]),v=Object(r.useCallback)((()=>{e||b()}),[e,b]),y=Object(r.useCallback)((e=>{u&&"Escape"===e.key&&v()}),[u,v]),h=Object(r.useMemo)((()=>s.a.createElement("div",{"data-test-subj":"withHoverActionsButton",onMouseEnter:g},o(d))),[g,o,d]);return Object(r.useEffect)((()=>{c(null!=n&&(d||e))}),[n,d,e]),Object(r.useEffect)((()=>{m(!1)}),[t]),Object(r.useEffect)((()=>{var e;u&&(null==f||null===(e=f.current)||void 0===e||e.positionPopoverFluid())}),[n,u]),s.a.createElement("div",{className:e?i.c:"",onMouseLeave:v},s.a.createElement(l,{ref:f,anchorPosition:"downCenter",button:h,closePopover:b,hasArrow:!1,isOpen:u,ownFocus:!1,panelPaddingSize:"none",panelClassName:"withHoverActions__popover",repositionOnScroll:!0},u?s.a.createElement("div",{onKeyDown:y},n):null))}));u.displayName="WithHoverActions"},,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return ft}));var a=n(2),i=n.n(a),r=n(17),s=n(44),o=n.n(s),l=n(110);const u="commandInputHistory";var c=n(260),d=n(0),m=n.n(d);class parsed_command_input_ParsedCommand{constructor(e){m()(this,"name",void 0),m()(this,"args",void 0),m()(this,"hasArgs",void 0),this.input=e;const t=(e=>{const t=e.trim(),n={name:f(t),args:{}};if(!t)return n;const a=t.indexOf(" "),i=-1===a?[]:t.substring(a).trim().split(/--/);for(const e of i){const t=e.trim();if(t){const e=/[ =]/.exec(t),a=(e?t.substring(0,e.index).trim():t).trim();if(a)if(n.args[a]||(n.args[a]=[]),a!==t&&e){let i=t.substring(e.index+1).trim().replace(/\\-\\-/g,"--");'"'===i.charAt(0)&&(i=i.substring(1)),'"'===i.charAt(i.length-1)&&(i=i.substring(0,i.length-1)),n.args[a].push(i)}else n.args[a].push(!0)}}return n})(e);this.name=t.name,this.args=t.args,this.hasArgs=Object.keys(this.args).length>0}hasArg(e){return e in this.args}}const p=e=>new parsed_command_input_ParsedCommand(e),f=e=>{const t=e.trimStart();if(!t)return"";const n=e.indexOf(" ");return-1===n?t:t.substring(0,n)},b=e=>{let t="",n="";const a=[];if(e.args)for(const[i,r]of Object.entries(e.args))r.required?(t.length&&(t+=" "),t+=`--${i}`):r.exclusiveOr?a.push(`--${i}`):(n.length&&(n+=" "),n+=`--${i}`);const i=({required:e,exclusive:t,optional:n})=>`${e||""}${t?` ${t}`:""} ${n&&n.length>0?`[${n}]`:""}`.trim();return a.length>0?a.map((e=>i({required:t,exclusive:e,optional:n}))):t||n?[i({required:t,optional:n})]:[]};var g=n(5),v=n(51);const y=g.i18n.translate("xpack.securitySolution.handleInputAreaState.inputPlaceholderText",{defaultMessage:"Submit response action"}),h=(e,t)=>{if(t&&t.argsWithValueSelectors)for(const a of Object.keys(t.argsWithValueSelectors))if(e.hasArg(a)){var n;const i=null!==(n=t.argState[a])&&void 0!==n?n:[];e.args[a]=i.map((e=>e.value))}},j=(e,{type:t,payload:n})=>{var a;switch(t){case"updateInputPopoverState":if(e.input.showPopover!==n.show)return{...e,input:{...e.input,showPopover:n.show}};break;case"updateInputHistoryState":return{...e,input:{...e.input,history:[{id:Object(v.v4)(),input:n.command,display:null!==(a=n.display)&&void 0!==a?a:n.command},...e.input.history.slice(0,99)]}};case"clearInputHistoryState":return{...e,input:{...e.input,history:[]}};case"updateInputTextEnteredState":const{leftOfCursorText:t,rightOfCursorText:o="",argState:l}="function"==typeof n?n(e.input):n;if(e.input.leftOfCursorText!==t||e.input.rightOfCursorText!==o){var i;const n=p(t+o);let a=e.input.enteredCommand;if(a&&l&&(null===(i=a)||void 0===i?void 0:i.argState)!==l&&(a={...a,argState:l}),n.name&&(!a||n.name!==a.commandDefinition.name)||!n.name&&a){a=void 0;const t=e.commands.find((e=>e.name===n.name));if(t){let e;for(const[n,a]of Object.entries(null!==(r=t.args)&&void 0!==r?r:{})){var r;a.SelectorComponent&&(e||(e={}),e[n]=a)}a={argState:{},commandDefinition:t,argsWithValueSelectors:e}}}return h(n,a),{...e,input:{...e.input,leftOfCursorText:t,rightOfCursorText:o,parsedInput:n,enteredCommand:a}}}break;case"updateInputPlaceholderState":if(e.input.placeholder!==n.placeholder)return{...e,input:{...e.input,placeholder:n.placeholder||y}};break;case"setInputState":if(e.input.visibleState!==n.value)return{...e,input:{...e.input,visibleState:n.value}};break;case"updateInputCommandArgState":if(e.input.enteredCommand){var s;const{name:t,instance:a,state:i}=n,r=[...null!==(s=e.input.enteredCommand.argState[t])&&void 0!==s?s:[]];r[a]=i;const o={...e.input.enteredCommand,argState:{...e.input.enteredCommand.argState,[t]:r}},l=p(e.input.leftOfCursorText+e.input.rightOfCursorText);return h(l,o),{...e,input:{...e.input,parsedInput:l,enteredCommand:o}}}}return e};var E=n(47),O=n(199);const x=Object.freeze({mustHaveValue:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveValue",{defaultMessage:"Argument --{argName} must have a value",values:{argName:e}}),mustBeNumber:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.mustBeNumber",{defaultMessage:"Argument --${argName} value must be a number",values:{argName:e}}),mustBeGreaterThanZero:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.mustBeGreaterThanZero",{defaultMessage:"Argument --{argName} value must be greater than zero",values:{argName:e}}),NO_ARGUMENTS_SUPPORTED:g.i18n.translate("xpack.securitySolution.console.commandValidation.noArgumentsSupported",{defaultMessage:"Command does not support any arguments"}),missingRequiredArg:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.missingRequiredArg",{defaultMessage:"Missing required argument: --{argName}",values:{argName:e}}),unsupportedArg:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.unsupportedArg",{defaultMessage:"Unsupported argument: --{argName}",values:{argName:e}}),noMultiplesAllowed:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.argSupportedOnlyOnce",{defaultMessage:"Argument can only be used once: --{argName}",values:{argName:e}}),argValueValidatorError:(e,t)=>g.i18n.translate("xpack.securitySolution.console.commandValidation.invalidArgValue",{defaultMessage:"Invalid argument value: --{argName}. {error}",values:{argName:e,error:t}}),missingArguments:e=>g.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveArgs",{defaultMessage:"Missing required arguments: {missingArgs}",values:{missingArgs:e}}),MUST_HAVE_AT_LEAST_ONE_ARG:g.i18n.translate("xpack.securitySolution.console.commandValidation.oneArgIsRequired",{defaultMessage:"At least one argument must be used"}),onlyOneFromExclusiveOr:e=>i.a.createElement(O.a,null,i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.exclusiveOr",defaultMessage:"This command supports only one of the following arguments: {argNames}",values:{argNames:i.a.createElement(O.a,{bold:!0,inline:!0},e)}})),unknownArgument:(e,t,n)=>i.a.createElement(O.a,null,i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.unknownArgument",defaultMessage:"The following {command} {countOfInvalidArgs, plural, =1 {argument is} other {arguments are}} not supported by this command: {unknownArgs}",values:{countOfInvalidArgs:e,command:i.a.createElement(O.a,{bold:!0,inline:!0},t),unknownArgs:i.a.createElement(O.a,{bold:!0,inline:!0},n)}}))});var S=n(115);const k=(e="")=>{const t=oe().state.dataTestSubj;return t?t+(e?`-${e}`:""):""},w=g.i18n.translate("xpack.securitySolution.console.unsupportedMessageCallout.title",{defaultMessage:"Unsupported"}),C=Object(a.memo)((({children:e,header:t=w,"data-test-subj":n})=>i.a.createElement("div",{"data-test-subj":n},i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(r.EuiTextColor,{color:"danger"},t)),i.a.createElement(r.EuiSpacer,{size:"s"}),e)));C.displayName="UnsupportedMessageCallout";const T={className:"euiTruncateText"},M=Object(a.memo)((({commandDef:e})=>{const t=Object(a.useMemo)((()=>b(e).map(((t,n)=>i.a.createElement(i.a.Fragment,{key:`helpUsage-${n}`},n>0&&i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(O.a,null,`${e.name} ${t}`))))),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(O.a,null,g.i18n.translate("xpack.securitySolution.console.commandUsage.inputUsage",{defaultMessage:"Usage"})),description:t&&t.length>0?t:e.name}],descriptionProps:T,titleProps:T}),i.a.createElement(r.EuiSpacer,{size:"s"}),e.exampleUsage&&i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(O.a,null,g.i18n.translate("xpack.securitySolution.console.commandUsage.exampleUsage",{defaultMessage:"Example"})),description:i.a.createElement(O.a,null,e.exampleUsage)}],descriptionProps:T,titleProps:T}))}));M.displayName="CommandInputUsage";const I=Object(a.memo)((({commandDef:e,errorMessage:t})=>{const n=Object(S.a)(k()),s=Object(a.useMemo)((()=>{var t;return Object.keys(null!==(t=e.args)&&void 0!==t?t:[]).length>0}),[e.args]),o=Object(a.useMemo)((()=>s&&e.args?Object.entries(e.args).reduce(((e,t)=>{const n={title:`--${t[0]}`,description:t[1].about};return t[1].required?e.required.push(n):t[1].exclusiveOr?e.exclusiveOr.push(n):e.optional.push(n),e}),{required:[],exclusiveOr:[],optional:[]}):{required:[],exclusiveOr:[],optional:[]}),[e.args,s]),l=(t,a)=>{const s=a.map((e=>i.a.createElement("div",null,i.a.createElement(O.a,{bold:!0,inline:!0},e.title),i.a.createElement(O.a,{inline:!0}," - ",e.description))));return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"s"}),e.args&&i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(O.a,null,t),description:s}],descriptionProps:T,titleProps:T,"data-test-subj":n("commandUsage-options")}))},u=Object(a.useCallback)((()=>t?i.a.createElement(C,{header:i.a.createElement(O.a,{textColor:"danger"},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":n("validationError")},i.a.createElement("div",{"data-test-subj":n("badArgument-message")},t),i.a.createElement(r.EuiSpacer,{size:"s"})):null),[t,n]);return i.a.createElement(r.EuiPanel,{paddingSize:"none",color:"transparent","data-test-subj":n("commandUsage")},u(),i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(O.a,null,g.i18n.translate("xpack.securitySolution.console.commandUsage.about",{defaultMessage:"About"})),description:i.a.createElement(O.a,null,e.about)}],descriptionProps:T,titleProps:T,"data-test-subj":n("commandUsage-options")}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(M,{commandDef:e}),o.required&&o.required.length>0&&l(g.i18n.translate("xpack.securitySolution.console.commandUsage.requiredLabel",{defaultMessage:"Required parameters"}),o.required),o.exclusiveOr&&o.exclusiveOr.length>0&&l(g.i18n.translate("xpack.securitySolution.console.commandUsage.exclusiveOr",{defaultMessage:"Include only one parameter"}),o.exclusiveOr),o.optional&&o.optional.length>0&&l(g.i18n.translate("xpack.securitySolution.console.commandUsage.optional",{defaultMessage:"Optional parameters"}),o.optional))}));I.displayName="CommandUsage";const A=Object(a.memo)((({title:e,children:t})=>{const n=Object(S.a)(k());return i.a.createElement(r.EuiPanel,{hasShadow:!1,color:"transparent",paddingSize:"none","data-test-subj":n("helpOutput")},t)}));A.displayName="HelpOutput";const P=Object(a.memo)((e=>{const t=e.command.commandDefinition.HelpComponent;return Object(a.useEffect)((()=>{t||e.setStatus("success")}),[t,e]),t?i.a.createElement(t,e):i.a.createElement(A,{command:e.command,title:g.i18n.translate("xpack.securitySolution.console.buildInCommand.helpArgument.helpTitle",{defaultMessage:"{cmdName} command",values:{cmdName:e.command.args.name}})},i.a.createElement(I,{commandDef:e.command.commandDefinition,errorMessage:e.store.errorMessage}))}));P.displayName="HelpCommandArgument";const _=Object(a.memo)((({command:e,setStatus:t})=>{const n=Object(S.a)(k()),s=Object(a.useMemo)((()=>i.a.createElement(O.a,null,i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage",defaultMessage:"The text you entered {userInput} is unsupported! Click {helpIcon} {boldHelp} or type {helpCmd} for assistance.",values:{userInput:i.a.createElement(O.a,{bold:!0,inline:!0},e.input),helpIcon:i.a.createElement(r.EuiIcon,{type:"help"}),helpCmd:i.a.createElement(O.a,{bold:!0,inline:!0},"help"),boldHelp:i.a.createElement("strong",null,i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage.help",defaultMessage:"Help"}))}}))),[e.input]);return Object(a.useEffect)((()=>{t("success")}),[t]),i.a.createElement(C,{header:i.a.createElement(O.a,{textColor:"danger"},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.title",defaultMessage:"Unsupported text/command"})),"data-test-subj":n("unknownCommandError")},s)}));_.displayName="UnknownCommand";const D=Object(a.memo)((({command:e,setStatus:t,store:n})=>{const s=Object(S.a)(k());return Object(a.useEffect)((()=>{t("success")}),[t]),i.a.createElement(C,{header:i.a.createElement(O.a,{textColor:"danger"},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.title",defaultMessage:"Unsupported argument"})),"data-test-subj":s("badArgument")},i.a.createElement("div",{"data-test-subj":s("badArgument-message")},n.errorMessage),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(M,{commandDef:e.commandDefinition}),i.a.createElement(O.a,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:i.a.createElement(O.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}})))}));D.displayName="BadArgument";const F=Object(a.memo)((({command:e,setStatus:t,store:n})=>{const s=Object(S.a)(k());return Object(a.useEffect)((()=>{t("success")}),[t]),i.a.createElement(C,{header:i.a.createElement(O.a,{textColor:"error"},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":s("validationError")},i.a.createElement("div",{"data-test-subj":s("validationError-message")},n.errorMessage),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(M,{commandDef:e.commandDefinition}),i.a.createElement(O.a,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.validationError.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:i.a.createElement(O.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}})))}));F.displayName="ValidationError";const N=e=>`--${e}`,R=(e,t)=>{const n=j(e,{type:"updateInputHistoryState",payload:{command:t.command.input,display:t.command.inputDisplay}});return n.commandHistory=[...e.commandHistory,t],n},z={name:"unknown-command",about:"unknown command",RenderComponent:()=>null},L=(e={})=>({status:"pending",store:e}),B=(e,t)=>({...e,commandDefinition:{...e.commandDefinition,RenderComponent:t}}),q=(e,t=L(),n=!0)=>({id:Object(v.v4)(),isValid:n,enteredAt:(new Date).toISOString(),command:e,state:t}),$=()=>oe().dispatch,V=Object(a.memo)((({status:e,setStatus:t})=>{const n=$();return Object(a.useEffect)((()=>{"pending"===e&&n({type:"clear"}),t("success")}),[e,t,n]),null}));V.displayName="ClearCommand";var U=n(9);const H=e=>{if(!e.mustHaveArgs||!e.args)return e.name;let t=!1;const n=Object.entries(e.args).reduce(((e,[n,a])=>a.required?(e[n]=a,e):a.exclusiveOr&&!t?(t=!0,e[n]=a,e):e),{});return`${e.name} --${Object.keys(n).join(" --")}`},G=g.i18n.translate("xpack.securitySolution.console.commandList.otherCommandsGroup.label",{defaultMessage:"Other commands"}),Q=e=>e.replace(/[^A-Za-z0-9]/g,""),W=o()(r.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-10x4uz4-0"})(["margin-top:",";.euiTableHeaderCell{.euiTableCellContent__text{color:",";font-size:",";padding-bottom:",";padding-left:",";}}"],(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiTextColor),(({theme:{eui:e}})=>e.euiFontSize),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeS)),K=o()(r.EuiCallOut).withConfig({displayName:"StyledEuiCallOut",componentId:"sc-10x4uz4-1"})(["margin:",";padding:",";border-radius:",";"],(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS)),Y=o()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-10x4uz4-2"})(["padding-left:",";"],(({theme:{eui:e}})=>e.euiSizeS)),X=o()(r.EuiFlexGrid).withConfig({displayName:"StyledEuiFlexGrid",componentId:"sc-10x4uz4-3"})(["@media only screen and (min-width:","){max-width:75%;}@media only screen and (min-width:","){max-width:50%;}"],(e=>e.theme.eui.euiBreakpoints.l),(e=>e.theme.eui.euiBreakpoints.xl)),J=o()(r.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-10x4uz4-4"})(["font-size:10px !important;span{color:"," !important;}"],(({theme:{eui:e}})=>e.euiShadowColor)),Z=Object(a.memo)((({commands:e,display:t="default"})=>{const n=Object(S.a)(k("commandList")),s=$(),{docLinks:o}=Object(l.i)().services,u=Object(a.useMemo)((()=>{var e;return i.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:i.a.createElement(J,null,i.a.createElement(O.a,{inline:!0,bold:!0},null===(e=ae.find((e=>"--help"===e.name)))||void 0===e?void 0:e.name)),description:i.a.createElement(r.EuiText,{color:"subdued",size:"xs"},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.commandList.footerText",defaultMessage:"For more help with the individual commands use the --help argument. Ex: processes --help"}))}]})}),[]),c=Object(a.useCallback)((e=>()=>{s({type:"updateInputTextEnteredState",payload:()=>({leftOfCursorText:e,rightOfCursorText:""})}),s({type:"addFocusToKeyCapture"})}),[s]),d=Object(a.useMemo)((()=>{const t=new Map,n=e.filter((e=>!0!==e.helpHidden));for(const e of n){const{helpGroupLabel:n=G,helpGroupPosition:a=1/0}=e,i=t.get(n);i?(i.list.push(e),i.position===1/0&&void 0!==a&&a!==i.position&&(i.position=a)):t.set(e.helpGroupLabel,{label:n,position:a,list:[e]})}return Object(U.sortBy)(Array.from(t.values()),"position").map((e=>{const t=e.list.map((e=>void 0===e.helpCommandPosition?{...e,helpCommandPosition:1/0}:e));return Object(U.sortBy)(t,"helpCommandPosition")}))}),[e]),m=Object(a.useCallback)((e=>e[0].helpGroupLabel===ne.supporting.label?[...ae,...e].map((t=>{var n,a;return{[null!==(n=null===(a=e[0])||void 0===a?void 0:a.helpGroupLabel)&&void 0!==n?n:G]:t}})):e.map((t=>{var n,a;return{[null!==(n=null===(a=e[0])||void 0===a?void 0:a.helpGroupLabel)&&void 0!==n?n:G]:t}}))),[]),p=Object(a.useCallback)((e=>{var t,a;const s=null!==(t=null===(a=e[0])||void 0===a?void 0:a.helpGroupLabel)&&void 0!==t?t:G,o=Q(s);return[{field:s,name:i.a.createElement("div",{"data-test-subj":n("group")},s),render:e=>{const t=H(e);return i.a.createElement(Y,{alignItems:"center","data-test-subj":n(`${o}-${e.name}`)},i.a.createElement(r.EuiFlexItem,{grow:1},i.a.createElement(r.EuiDescriptionList,{"data-test-subj":n("command"),listItems:[{title:i.a.createElement(r.EuiBadge,{"data-test-subj":n("commandName")},t),description:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about))}]})),e.helpGroupLabel!==ne.supporting.label&&!0!==e.helpHidden&&e.RenderComponent&&i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:!0===e.helpDisabled?g.i18n.translate("xpack.securitySolution.console.commandList.disabledButtonTooltip",{defaultMessage:"Unsupported command"}):g.i18n.translate("xpack.securitySolution.console.commandList.addButtonTooltip",{defaultMessage:"Add to text bar"})},i.a.createElement(r.EuiButtonIcon,{iconType:"plusInCircle","aria-label":`updateTextInputCommand-${e.name}`,onClick:c(`${t} `),isDisabled:!0===e.helpDisabled,"data-test-subj":n(`${o}-${e.name}-addToInput`)}))))}}]}),[n,c]),f=Object(a.useCallback)((e=>e.filter((e=>"help"!==e.name&&"clear"!==e.name))),[]);if("table"===t){const e=[i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.multipleResponses",defaultMessage:"You can enter consecutive response actions — no need to wait for previous actions to complete."}),i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.leavingResponder",defaultMessage:"Leaving the response console does not terminate any actions that have been submitted."}),i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.visitSupportSections",defaultMessage:"{learnMore} about response actions and using the console.",values:{learnMore:i.a.createElement(r.EuiLink,{href:o.links.securitySolution.responseActions,target:"_blank","data-test-subj":n("helpfulHintDocLink")},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.readMoreLink",defaultMessage:"Learn more"}))}})],t=i.a.createElement(K,{title:i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.title",defaultMessage:"Helpful tips:"}),"data-test-subj":n("helpfulTips")},i.a.createElement("ul",null,e.map(((e,t)=>i.a.createElement("li",{key:t},i.a.createElement(r.EuiText,{size:"s"},e))))));return i.a.createElement("div",{"data-test-subj":n()},d.map(((e,t)=>{var a;return i.a.createElement(W,{"data-test-subj":n(Q(null!==(a=e[0].helpGroupLabel)&&void 0!==a?a:G)),key:`styledEuiBasicTable-${t}`,items:m(e),columns:p(e)})})),t)}return i.a.createElement("div",{"data-test-subj":n()},i.a.createElement(r.EuiSpacer,{size:"s"}),d.map((e=>{const t=e[0].helpGroupLabel,a=f(e);return 0===a.length?null:i.a.createElement(X,{columns:3,responsive:!1,gutterSize:"l",key:t,direction:"column"},a.map((e=>{const t=H(e);return i.a.createElement(r.EuiFlexItem,{key:e.name},i.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:i.a.createElement(r.EuiToolTip,{content:t},i.a.createElement(J,null,i.a.createElement(O.a,{inline:!0,bold:!0},t))),description:i.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about)}],"data-test-subj":n("command")}))})))})),i.a.createElement(r.EuiSpacer,{size:"xl"}),u)}));Z.displayName="CommandList";const ee=()=>oe().state.commands,te=Object(a.memo)((e=>{const t=ee(),n=oe().state.HelpComponent;return Object(a.useEffect)((()=>{n||e.setStatus("success")}),[n,e]),n?i.a.createElement(n,e):i.a.createElement(A,{command:e.command,title:g.i18n.translate("xpack.securitySolution.console.builtInCommands.help.helpTitle",{defaultMessage:"Available commands"})},i.a.createElement(Z,{commands:t}))}));te.displayName="HelpCommand";const ne=Object.freeze({supporting:{label:g.i18n.translate("xpack.securitySolution.console.builtInCommands.groups.supporting",{defaultMessage:"Supporting commands & parameters"})}}),ae=Object.freeze([{name:"--comment",about:g.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.comment",{defaultMessage:"Add comment to any action Ex: isolate --comment your comment"})},{name:"--help",about:g.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.help",{defaultMessage:"Command assistance Ex: isolate --help"})}]),ie=(e,t)=>{var n,a,r,s;let o=e;switch(t.type){case"scrollDown":e.scrollToBottom();break;case"addFocusToKeyCapture":null===(n=e.keyCapture)||void 0===n||null===(a=n.current)||void 0===a||a.focus();break;case"removeFocusFromKeyCapture":null===(r=e.keyCapture)||void 0===r||null===(s=r.current)||void 0===s||s.blur();break;case"updateFooterContent":e.footerContent!==t.payload.value&&(o={...e,footerContent:t.payload.value});break;case"executeCommand":o=((e,t)=>{const{parsedInput:n,enteredCommand:a,input:r}=t.payload;if(""===n.name)return e;const s=null==a?void 0:a.commandDefinition;if(!s)return R(e,q({input:n.input,inputDisplay:r,args:n,commandDefinition:{...z,RenderComponent:_}},void 0,!1));const o={input:n.input,inputDisplay:r,args:n,commandDefinition:s},l=(u=s.args)?Object.entries(u).filter((([e,t])=>t.required)).map((([e])=>e)):[];var u;const c=(e=>e?Object.entries(e).reduce(((e,[t,n])=>(n.exclusiveOr&&e.push(t),e)),[]):[])(s.args),d=x.onlyOneFromExclusiveOr(c.map(N).join(", "));if(n.hasArgs){if(n.hasArg("help")){if(Object.keys(n.args).length>1||n.args.help.length>1||!0!==n.args.help[0])return R(e,q(B(o,D),void 0,!1));if(null!=s&&s.validate){const t=s.validate(o);if(!0!==t)return R(e,q(B(o,P),L({errorMessage:t}),!1))}return R(e,q(B(o,P),void 0,!1))}if(!s.args||0===Object.keys(s.args).length)return R(e,q(B(o,D),L({errorMessage:x.NO_ARGUMENTS_SUPPORTED}),!1));const t=((e,t)=>{const n=[];return Object.keys(e).forEach((e=>{"help"===e||t&&t[e]||n.push(e)})),n})(n.args,s.args);if(t.length)return R(e,q(B(o,D),L({errorMessage:x.unknownArgument(t.length,n.name,t.map(N).join(", "))}),!1));for(const t of l)if(!n.args[t])return R(e,q(B(o,D),L({errorMessage:i.a.createElement(O.a,null,x.missingRequiredArg(t))}),!1));if(c.filter((e=>n.args[e])).length>1)return R(e,q(B(o,D),L({errorMessage:d}),!1));for(const t of Object.keys(n.args)){var m;const a=null===(m=s.args)||void 0===m?void 0:m[t],r=n.args[t];if(!a)return R(e,q(B(o,D),L({errorMessage:i.a.createElement(O.a,null,x.unsupportedArg(t))}),!1));if(!a.allowMultiples&&Array.isArray(r)&&r.length>1)return R(e,q(B(o,D),L({errorMessage:i.a.createElement(O.a,null,x.noMultiplesAllowed(t))}),!1));if(void 0!==a.mustHaveValue&&!1!==a.mustHaveValue){let n="";if(0===r.length?n=x.mustHaveValue(t):r.some(((e,i)=>{switch(a.mustHaveValue){case!0:case"non-empty-string":("boolean"==typeof e||"non-empty-string"===a.mustHaveValue&&0===e.trim().length)&&(n=x.mustHaveValue(t));break;case"truthy":e||(n=x.mustHaveValue(t));break;case"number":case"number-greater-than-zero":{const s=Number(e);Number.isSafeInteger(s)?"number-greater-than-zero"===a.mustHaveValue&&s<=0&&(n=x.mustBeGreaterThanZero(t)):n=x.mustBeNumber(t),n||(r[i]=s)}}return!!n})),n)return R(e,q(B(o,D),L({errorMessage:i.a.createElement(O.a,null,n)}),!1))}if(a.validate){const n=a.validate(r);if(!0!==n)return R(e,q(B(o,D),L({errorMessage:i.a.createElement(O.a,null,x.argValueValidatorError(t,n))}),!1))}}}else{if(l.length>0)return R(e,q(B(o,D),L({errorMessage:i.a.createElement(O.a,null,x.missingArguments(l.map((e=>N(e))).join(", ")))}),!1));if(c.length>0)return R(e,q(B(o,D),L({errorMessage:d}),!1));if(s.mustHaveArgs)return R(e,q(B(o,D),L({errorMessage:i.a.createElement(O.a,null,x.MUST_HAVE_AT_LEAST_ONE_ARG)}),!1))}if(s.validate){const t=s.validate(o);if(!0!==t)return R(e,q(B(o,F),L({errorMessage:t}),!1))}return R(e,q(o))})(e,t);break;case"updateCommandStatusState":case"updateCommandStoreState":o=((e,{type:t,payload:{id:n,value:a}})=>{let i=!1;const r=e.commandHistory.map((e=>{if(i||e.id!==n)return e;i=!0;const r={...e,state:{...e.state}};switch(t){case"updateCommandStoreState":r.state.store=a(r.state.store);break;case"updateCommandStatusState":if(r.state.status===a)return i=!1,e;r.state.status=a}return r}));return i?{...e,commandHistory:r}:e})(e,t);break;case"showSidePanel":o=((e,t)=>"showSidePanel"===t.type&&e.sidePanel.show!==t.payload.show?{...e,sidePanel:{...e.sidePanel,show:t.payload.show}}:e)(e,t);break;case"updateInputPopoverState":case"updateInputHistoryState":case"clearInputHistoryState":case"updateInputTextEnteredState":case"updateInputPlaceholderState":case"setInputState":case"updateInputCommandArgState":o=j(e,t);break;case"clear":o={...e,commandHistory:[]}}return o},re=Object(a.createContext)(null),se=Object(a.memo)((({commands:e,scrollToBottom:t,keyCapture:n,HelpComponent:r,dataTestSubj:s,storagePrefix:o,managedKey:d,children:m})=>{const[f,b]=Object(c.d)(d),v=(e=>{const{storage:t}=Object(l.i)().services;return Object(a.useMemo)((()=>{if(e){var n;const a=null!==(n=t.get(`${e}.${u}`))&&void 0!==n?n:{version:2,data:[]};return 2!==a.version&&(e=>{const{data:t,version:n}=e;for(const e of t)n<2&&(e.display=e.input);e.version=2})(a),a.data}return[]}),[t,e])})(o),h=(e=>{const{storage:t}=Object(l.i)().services;return Object(a.useCallback)((n=>{if(e){const a={version:2,data:n};t.set(`${e}.${u}`,a)}}),[t,e])})(o),j=Object(a.useCallback)((e=>{const t=(({commands:e,...t},n)=>{const a=[{name:"help",about:g.i18n.translate("xpack.securitySolution.console.builtInCommands.helpAbout",{defaultMessage:"List all available commands"}),RenderComponent:te,helpGroupLabel:ne.supporting.label,helpCommandPosition:1},{name:"clear",about:g.i18n.translate("xpack.securitySolution.console.builtInCommands.clearAbout",{defaultMessage:"Clear console screen"}),RenderComponent:V,helpGroupLabel:ne.supporting.label,helpCommandPosition:0}].concat(e),i=null!=n?n:{commands:a,...t,commandHistory:[],sidePanel:{show:null},footerContent:"",input:{leftOfCursorText:"",rightOfCursorText:"",parsedInput:p(""),enteredCommand:void 0,placeholder:y,showPopover:void 0,history:[],visibleState:void 0}};return n&&Object.assign(i,{commands:a,...t}),i})(e,f?f():void 0);return t.input.history=v,t}),[f,v]),[E,O]=Object(a.useReducer)(ie,{commands:e,scrollToBottom:t,keyCapture:n,HelpComponent:r,dataTestSubj:s,storagePrefix:o},j);return Object(a.useEffect)((()=>{b&&b(E)}),[E,b]),Object(a.useEffect)((()=>{o&&E.input.history&&h(E.input.history)}),[h,E.input.history,o]),i.a.createElement(re.Provider,{value:{state:E,dispatch:O}},m)}));se.displayName="ConsoleStateProvider";const oe=()=>{const e=Object(a.useContext)(re);if(!e)throw new Error("ConsoleStateContext not defined");return e},le=()=>oe().state.input.visibleState,ue=Object(a.memo)((()=>{const e=oe().state.footerContent,t=Object(S.a)(k()),n=le(),s=Object(a.useMemo)((()=>"error"===n?"danger":"subdued"),[n]);return i.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",color:"transparent","data-test-subj":t("footer")},i.a.createElement(r.EuiText,{size:"xs",color:s,className:"font-style-italic"},e||i.a.createElement(i.a.Fragment,null," ")))}));ue.displayName="ConsoleFooter";const ce=()=>oe().state.sidePanel,de=(g.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonTitle",{defaultMessage:"Help"}),g.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonLabel",{defaultMessage:"Show help"})),me=o()(r.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-lvlnbi-0"})(["margin-left:auto;height:inherit;"]),pe=Object(a.memo)((({TitleComponent:e})=>{const t=$(),n=ce().show,s=Object(S.a)(k("header")),o="help"===n,l=Object(a.useCallback)((()=>{t({type:"showSidePanel",payload:{show:o?null:"help"}})}),[t,o]);return i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"spaceBetween",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:1,className:"eui-textTruncate noThemeOverrides","data-test-subj":s("titleComponentContainer")},e?i.a.createElement(e,null):""),!o&&i.a.createElement(r.EuiFlexItem,{grow:1},i.a.createElement(me,{style:{marginLeft:"auto"},onClick:l,iconType:"help",title:de,"aria-label":de,isSelected:o,"data-test-subj":s("helpButton")},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.layoutHeader.helpButtonTitle",defaultMessage:"Help"}))))}));pe.displayName="ConsoleHeader";var fe=n(23),be=n.n(fe),ge=n(59),ve=n.n(ge);const ye=()=>{const{leftOfCursorText:e,rightOfCursorText:t,parsedInput:n,enteredCommand:i}=oe().state.input;return Object(a.useMemo)((()=>({leftOfCursorText:e,rightOfCursorText:t,parsedInput:n,enteredCommand:i,fullTextEntered:e+t})),[i,e,n,t])},he=o.a.div.withConfig({displayName:"InputDisplayContainer",componentId:"sc-cduvts-0"})(["overflow:hidden !important;.inputDisplay{& > *{flex-direction:row;align-items:center;}}.cursor{display:inline-block;width:1px;height:","em;background-color:",";}"],(({theme:{eui:e}})=>e.euiLineHeight),(({theme:e})=>e.eui.euiTextSubduedColor)),je=Object(a.memo)((({leftOfCursor:e,rightOfCursor:t})=>{const n=Object(S.a)(k()),s=$(),{leftOfCursorText:o,fullTextEntered:l}=ye(),u=Object(a.useRef)(null),c=Object(a.useRef)(null),d=Object(a.useRef)(null),m=o.length,p=Object(a.useCallback)((e=>{const t=e.target;if(l.length&&t.classList&&t.classList.contains("chr")){const n=Array.from(e.currentTarget.querySelectorAll("span.chr")).indexOf(t),a=l.substring(0,n+1),i=l.substring(n+1);s({type:"updateInputTextEnteredState",payload:{leftOfCursorText:a,rightOfCursorText:i}})}}),[s,l]);return Object(a.useEffect)((()=>{if(c.current){const e=e=>{if(c.current){const t=e[0];if(t&&t.rootBounds){const e=c.current.scrollLeft,n=t.rootBounds.right,a=t.rootBounds.left,i=t.boundingClientRect.right;if(i>n-20){const n=e+(i-t.rootBounds.width)+20;c.current.scrollLeft=n}else if(i<a+20){const t=i-20<0?0:e-20;c.current.scrollLeft=t}}}};return u.current=new IntersectionObserver(e,{root:c.current,rootMargin:"0px -10px",threshold:0}),()=>{var e;null===(e=u.current)||void 0===e||e.disconnect(),u.current=null}}}),[]),Object(a.useEffect)((()=>{if(u.current&&d.current){const e=u.current,t=d.current;return e.observe(t),()=>{e.unobserve(t)}}}),[m]),i.a.createElement(he,{ref:c},i.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none",className:"inputDisplay",onClick:p},i.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":n("cmdInput-leftOfCursor"),className:"noMinWidth"},e),i.a.createElement(r.EuiFlexItem,{grow:!1,className:"noMinWidth"},i.a.createElement("span",{className:"cursor essentialAnimation",ref:d})),i.a.createElement(r.EuiFlexItem,{className:"noMinWidth","data-test-subj":n("cmdInput-rightOfCursor")},t)))}));je.displayName="InputDisplay";const Ee=()=>oe().state.input.showPopover,Oe=o.a.span.withConfig({displayName:"ArgumentSelectorWrapperContainer",componentId:"sc-jnz75k-0"})(["border:",";border-radius:",";overflow:hidden;user-select:none;.flexGroup{align-items:stretch;}.selectorContainer{padding:0 ",";max-width:25vw;display:flex;align-items:center;height:100%;}.argNameContainer{background-color:",";}.argName{padding-left:",";height:100%;display:flex;align-items:center;white-space:nowrap;}"],(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormInputGroupLabelBackground),(({theme:{eui:e}})=>e.euiSizeXS)),xe=Object(a.memo)((({argName:e,argIndex:t,argDefinition:{SelectorComponent:n}})=>{const s=$(),{valueText:o,value:l,store:u}=((e,t)=>{const n=oe().state.input.enteredCommand;return Object(a.useMemo)((()=>{var a;const i=null==n||null===(a=n.argState[e])||void 0===a?void 0:a.at(t);return null!=i?i:{value:void 0,valueText:""}}),[e,n,t])})(e,t),c=Object(a.useCallback)((n=>{s({type:"updateInputCommandArgState",payload:{name:e,instance:t,state:n}})}),[t,e,s]);return i.a.createElement(Oe,{className:"eui-displayInlineBlock"},i.a.createElement(r.EuiFlexGroup,{className:"flexGroup",responsive:!1,alignItems:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1,className:"argNameContainer"},i.a.createElement("div",{className:"argName"},i.a.createElement("span",null,`--${e}=`))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement("div",{className:"selectorContainer noThemeOverrides eui-textTruncate"},i.a.createElement(n,{value:l,valueText:null!=o?o:"",argName:e,argIndex:t,store:u,onChange:c})))))}));xe.displayName="ArgumentSelectorWrapper";const Se=[""," ","="],ke=(e={})=>({value:"",renderValue:null,isArgSelector:!1,argName:"",argIndex:0,argState:void 0,...e}),we=e=>e.split("").map((e=>ke({value:e,renderValue:e}))),Ce=(e,t,n)=>{var a;return i.a.createElement("span",{className:"chr",key:`${e}.${n}.${null!==(a=t.value)&&void 0!==a?a:"$"}`},t.renderValue)},Te=(e,t)=>{let n=t.value;var a,i;return e&&t.isArgSelector&&(n+=`="${null!==(a=null===(i=t.argState)||void 0===i?void 0:i.valueText)&&void 0!==a?a:""}"`),n};class entered_input_EnteredInput{constructor(e,t,n,a){if(m()(this,"leftOfCursorContent",void 0),m()(this,"rightOfCursorContent",void 0),m()(this,"canHaveArgValueSelectors",void 0),m()(this,"argState",void 0),this.leftOfCursorContent=we(e),this.rightOfCursorContent=we(t),this.canHaveArgValueSelectors=Boolean(null==a?void 0:a.argsWithValueSelectors),n.hasArgs&&a&&a.argsWithValueSelectors){this.argState=a.argState;const s=[{input:e,items:this.leftOfCursorContent,side:"left"},{input:t,items:this.rightOfCursorContent,side:"right"}];for(const[e,o]of Object.entries(a.argsWithValueSelectors))if(n.hasArg(e)){let n=0;for(const{input:l,items:u,side:c}of s){const s=`--${e}`;let d=l.indexOf(s);for(;d>-1;){const m=s.length,p=d+m,f=l.charAt(p),b="left"===c&&""===f&&Se.includes(t.charAt(0));if(Se.includes(f)&&(b||"left"===c&&""!==f||"right"===c)){var r;const t=Array.from({length:m},ke),l=null===(r=a.argState[e])||void 0===r?void 0:r.at(n);t[0]=ke({value:s,renderValue:i.a.createElement(xe,{argName:e,argIndex:n,argDefinition:o}),isArgSelector:!0,argName:e,argIndex:n++,argState:l}),u.splice(d,m,...t)}d=l.indexOf(s,p)}}}this.leftOfCursorContent=this.leftOfCursorContent.filter((({value:e})=>e.length>0)),this.rightOfCursorContent=this.rightOfCursorContent.filter((({value:e})=>e.length>0))}}replaceSelection(e,t){const n=this.getFullText(),a=t?ke({value:t}):void 0;let i=n.indexOf(e);const r=[...this.leftOfCursorContent,...this.rightOfCursorContent];this.canHaveArgValueSelectors&&r.forEach(((e,t)=>{e.isArgSelector&&t<i&&(i-=e.value.length-1)}));const s=r.splice(i,e.length);a&&(r.splice(i,0,a),i++),this.leftOfCursorContent=r.splice(0,i),this.rightOfCursorContent=r,this.removeArgState(s)}removeArgState(e){if(this.argState){let n=!1;const a={...this.argState};for(const{argName:i,argIndex:r,isArgSelector:s}of e){var t;s&&null!==(t=a[i])&&void 0!==t&&t.at(r)&&(a[i]=a[i].filter(((e,t)=>t!==r)),n=!0)}n&&(this.argState=a)}}getLeftOfCursorText(e=!1){return this.leftOfCursorContent.map(Te.bind(null,e)).join("")}getRightOfCursorText(e=!1){return this.rightOfCursorContent.map(Te.bind(null,e)).join("")}getFullText(e=!1){return this.getLeftOfCursorText(e)+this.getRightOfCursorText(e)}getLeftOfCursorRenderingContent(){return i.a.createElement(i.a.Fragment,null,this.leftOfCursorContent.map(Ce.bind(null,"left")))}getRightOfCursorRenderingContent(){return i.a.createElement(i.a.Fragment,null,this.rightOfCursorContent.map(Ce.bind(null,"right")))}getArgState(){return this.argState}moveCursorTo(e){switch(e){case"end":this.leftOfCursorContent.push(...this.rightOfCursorContent.splice(0));break;case"home":this.rightOfCursorContent.unshift(...this.leftOfCursorContent.splice(0));break;case"left":if(this.leftOfCursorContent.length){const e=this.leftOfCursorContent.pop();e&&this.rightOfCursorContent.unshift(e)}break;case"right":if(this.rightOfCursorContent.length){const e=this.rightOfCursorContent.shift();e&&this.leftOfCursorContent.push(e)}}}addValue(e,t=""){t.length&&e.length?this.replaceSelection(t,e):e&&this.leftOfCursorContent.push(ke({value:e}))}deleteChar(e=""){if(e)this.replaceSelection(e,"");else{const e=this.rightOfCursorContent.shift();null!=e&&e.isArgSelector&&this.removeArgState([e])}}backspaceChar(e=""){if(e)this.replaceSelection(e,"");else{const e=this.leftOfCursorContent.pop();null!=e&&e.isArgSelector&&this.removeArgState([e])}}clear(){this.leftOfCursorContent=[],this.rightOfCursorContent=[],this.argState=void 0}}const Me=g.i18n.translate("xpack.securitySolution.inputCapture.ariaPlaceHolder",{defaultMessage:"Enter a command"}),Ie=()=>{const e=getSelection();e&&e.removeAllRanges()},Ae=o.a.div.withConfig({displayName:"InputCaptureContainer",componentId:"sc-19dx6ae-0"})([".focus-container{outline:none !important;}.textSelectionBoundaryHelper{opacity:0;position:absolute;top:-100vh;left:-100vw;}.invisible-input{&,&:focus{border:none;outline:none;background-image:none;background-color:transparent;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;animation:none !important;width:1ch !important;position:absolute;opacity:0;top:-100vh;left:-100vw;}"]),Pe=Object(a.memo)((({onCapture:e,focusRef:t,onChangeFocus:n,children:r})=>{const s=Object(S.a)(k()),o=Object(a.useRef)(null),l=Object(a.useRef)(null),u=Object(a.useRef)(null),c=Object(a.useCallback)((()=>{if(o.current){var e,t,n;const a=document.getSelection(),i=(null!==(e=null==a?void 0:a.toString())&&void 0!==e?e:"").replace(/[\r\n]/g,""),r=!(!o.current||!a)&&(null===(t=o.current)||void 0===t?void 0:t.contains(a.focusNode))&&(null===(n=o.current)||void 0===n?void 0:n.contains(a.anchorNode));return a&&0!==i.length&&r?i:""}return""}),[]),d=Object(a.useCallback)((t=>{if(t.metaKey||t.ctrlKey){if("a"===t.key){t.preventDefault();const e=window.getSelection();if(e&&l.current){const t=document.createRange();t.selectNodeContents(l.current),t.toString().length>0&&(e.removeAllRanges(),e.addRange(t))}}return}const n=/^[\w\d]{2}/.test(t.key)?"":t.key,a=c(),i=Object(U.pick)(t,["key","altKey","ctrlKey","keyCode","metaKey","repeat","shiftKey"]);e({value:n,selection:a,eventDetails:i}),a&&Ie()}),[c,e]),m=Object(a.useCallback)((t=>{t.preventDefault(),t.stopPropagation();const n=t.clipboardData.getData("text").replace(/[\r\n]/g,""),a=c();e({value:n,selection:a,eventDetails:{altKey:!1,ctrlKey:!1,key:"Meta",keyCode:91,metaKey:!0,repeat:!1,shiftKey:!1}}),a&&Ie()}),[c,e]),p=Object(a.useCallback)((()=>{n&&n(!0)}),[n]),f=Object(a.useCallback)((()=>{n&&n(!1)}),[n]),b=Object(a.useMemo)((()=>({focus:(e=!1)=>{var t,n,a;!e&&(null!==(t=null===(n=window.getSelection())||void 0===n?void 0:n.toString())&&void 0!==t?t:"").length>0||document.activeElement===u.current||null===(a=u.current)||void 0===a||a.focus()},blur:()=>{var e;u.current&&document.activeElement===u.current&&(null===(e=u.current)||void 0===e||e.blur())}})),[]);return t&&(t.current=b),i.a.createElement(Ae,{"data-test-subj":s("inputCapture"),onKeyDown:d,onPaste:m},i.a.createElement("div",{role:"textbox","aria-placeholder":Me,tabIndex:0,ref:o,className:"focus-container","data-test-subj":s("keyCapture-input"),onBlur:f,onFocus:p},i.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),i.a.createElement("div",{ref:l,className:"text-container"},r),i.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),i.a.createElement("input",{ref:u,type:"text",value:"",tabIndex:-1,onPaste:m,onChange:()=>{},spellCheck:"false",className:"invisible-input"})))}));Pe.displayName="InputCapture";const _e=g.i18n.translate("xpack.securitySolution.useInputHints.noArguments",{defaultMessage:"Hit enter to execute"}),De=g.i18n.translate("xpack.securitySolution.useInputHints.viewInputHistory",{defaultMessage:"Press the up arrow key to access previously entered commands"}),Fe=o()(r.EuiText).withConfig({displayName:"InputPlaceholderContainer",componentId:"sc-6afwlc-0"})(["position:absolute;pointer-events:none;padding-left:0.5em;width:96%;color:",";user-select:none;"],(({theme:{eui:e}})=>e.euiFormControlPlaceholderText)),Ne=Object(a.memo)((()=>{const{fullTextEntered:e}=ye(),t=oe().state.input.placeholder,n=Object(S.a)(k());return e.length>0?null:i.a.createElement(Fe,{size:"s",className:"eui-textTruncate","data-test-subj":n("inputPlaceholder")},i.a.createElement("div",{className:"eui-textTruncate"},t))}));Ne.displayName="InputPlaceholder";const Re=o()(r.EuiCode).withConfig({displayName:"StyledEuiCode",componentId:"sc-qp7srp-0"})(["padding-left:0;"]),ze=Object(a.memo)((({input:e,isValid:t=!0})=>{const n=Object(S.a)(k()),s=Object(a.useMemo)((()=>t?e:i.a.createElement(r.EuiTextColor,null,e)),[e,t]);return i.a.createElement(Re,{transparentBackground:!0,"data-test-subj":n("userCommandText")},s)}));ze.displayName="UserCommandInput";const Le=Object(a.memo)((()=>{const[e,t]=Object(a.useState)(!1),n=$(),s=Object(S.a)(k()),o=Object(a.useCallback)((()=>{t(!0)}),[]),l=Object(a.useCallback)((()=>{t(!1)}),[]),u=Object(a.useCallback)((()=>{n({type:"clearInputHistoryState"}),t(!1)}),[n]);return i.a.createElement(i.a.Fragment,null,e&&i.a.createElement(r.EuiConfirmModal,{title:g.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmTitle",{defaultMessage:"Clear input history"}),cancelButtonText:g.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:g.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmSubmitButton",{defaultMessage:"Clear"}),buttonColor:"danger",onCancel:l,onConfirm:u},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.commandInputClearHistory.confirmMessage",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})),i.a.createElement(r.EuiFlexGroup,{responsive:!1,justifyContent:"flexEnd",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{size:"xs",tabIndex:-1,onClick:o,disabled:e,"data-test-subj":s("clearInputHistoryButton")},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.commandInputClearHistory.clearHistoryButtonLabel",defaultMessage:"Clear input history"})))))}));Le.displayName="CommandInputClearHistory";const Be=g.i18n.translate("xpack.securitySolution.commandInputHistory.noHistoryEmptyMessage",{defaultMessage:"No commands have been entered"}),qe=g.i18n.translate("xpack.securitySolution.commandInputHistory.filterPlaceholder",{defaultMessage:"Filter previously entered actions"}),$e=g.i18n.translate("xpack.securitySolution.commandInputHistory.noFilteredMatchesFoundMessage",{defaultMessage:"No entries found matching the filter entered"}),Ve=Object(a.memo)((()=>{const e=$(),t=oe().state.input.history,[n]=Object(a.useState)(ye()),s=Object(a.useRef)(!1),o=Object(S.a)(k()),l=Object(a.useMemo)((()=>t.map(((e,t)=>({label:e.display,key:e.id,data:e})))),[t]),u=Object(a.useMemo)((()=>({showIcons:!1,bordered:!0})),[]),c=Object(a.useMemo)((()=>({placeholder:qe,compressed:!0,fullWidth:!0})),[]),d=Object(a.useCallback)(((e,n)=>i.a.createElement(i.a.Fragment,null,e,i.a.createElement(r.EuiSpacer,{size:"s"}),t.length>0?n:i.a.createElement("div",{tabIndex:-1}))),[t.length]),m=Object(a.useCallback)((t=>{s.current=!0;const n=t.find((e=>"on"===e.checked));e({type:"updateInputPopoverState",payload:{show:void 0}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}),n&&e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:n.data.input,rightOfCursorText:""}}),e({type:"addFocusToKeyCapture"})}),[e]),p=Object(a.useCallback)((t=>{t&&e({type:"updateInputPlaceholderState",payload:{placeholder:t.data.input}})}),[e]),f=Object(a.useCallback)((e=>i.a.createElement(ze,{input:e.label})),[]);return Object(a.useEffect)((()=>(e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:"",rightOfCursorText:""}}),()=>{s.current||(e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:n.leftOfCursorText,rightOfCursorText:n.rightOfCursorText}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}))})),[e,s,n]),i.a.createElement("div",null,t.length>0&&i.a.createElement(Le,null),i.a.createElement(r.EuiSelectable,{options:l,onChange:m,onActiveOptionChange:p,renderOption:f,listProps:u,singleSelection:!0,searchable:!0,searchProps:c,emptyMessage:Be,noMatchesMessage:$e,"data-test-subj":o("inputHistorySelector"),"data-console-input-history":!0},d))}));Ve.displayName="CommandInputHistory";const Ue=Object(a.memo)((({children:e,width:t="92vw"})=>{const n=Object(S.a)(k()),s=Ee(),o=void 0!==s,l=$(),u=Object(a.useMemo)((()=>({width:t,borderBottomLeftRadius:0,borderBottomRightRadius:0})),[t]),c=Object(a.useMemo)((()=>({clickOutsideDisables:!0})),[]),d=Object(a.useCallback)((()=>{l({type:"updateInputPopoverState",payload:{show:void 0}}),l({type:"addFocusToKeyCapture"})}),[l]);return Object(a.useEffect)((()=>{s||l({type:"addFocusToKeyCapture"})}),[l,s]),i.a.createElement(r.EuiPopover,{button:e,closePopover:d,isOpen:o,panelStyle:u,anchorPosition:"upLeft",hasArrow:!1,display:"block",attachToAnchor:!0,focusTrapProps:c,ownFocus:!1,"data-test-subj":n("inputPopover")},s&&i.a.createElement(r.EuiFocusTrap,{clickOutsideDisables:!0},"input-history"===s&&i.a.createElement(Ve,null)))}));Ue.displayName="InputAreaPopover";const He=o.a.div.withConfig({displayName:"CommandInputContainer",componentId:"sc-ujnhrt-0"})(["background-color:",";border-radius:",";padding:",";outline:",";&:focus-within{border-bottom:",";border-bottom-color:",";}&.error{border-bottom-color:",";}.textEntered{white-space:break-spaces;}.prompt{padding-right:1ch;}&.withPopover{border-top-left-radius:0;border-top-right-radius:0;}&.hasFocus{.cursor{background-color:",";animation:cursor-blink-animation 1s steps(5,start) infinite;-webkit-animation:cursor-blink-animation 1s steps(5,start) infinite;@keyframes cursor-blink-animation{to{visibility:hidden;}}@-webkit-keyframes cursor-blink-animation{to{visibility:hidden;}}}}"],(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderRadius),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderThick),(({theme:{eui:e}})=>e.euiColorPrimary),(({theme:{eui:e}})=>e.euiColorDanger),(({theme:{eui:e}})=>e.euiTextColor)),Ge=Object(a.memo)((({prompt:e="",focusRef:t,...n})=>{(()=>{const e=$(),t=Boolean(Ee()),n=(()=>{const e=oe().state.input.parsedInput;return-1!==e.input.trimStart().indexOf(" ")?e.name:""})(),i=ee(),{leftOfCursorText:r}=ye(),s=Object(a.useMemo)((()=>{if(n)return i.find((e=>e.name===n))}),[n,i]);Object(a.useEffect)((()=>{if(n&&!t)if(s&&!0!==s.helpHidden){var a,i;const t=null!==(a=null==s?void 0:s.exampleInstruction)&&void 0!==a?a:"",n=null!==(i=null==s?void 0:s.exampleUsage)&&void 0!==i?i:"";let r=null!=t?t:"";if(n&&(r+=t?` ${g.i18n.translate("xpack.securitySolution.useInputHints.exampleInstructions",{defaultMessage:"Ex: [ {exampleUsage} ]",values:{exampleUsage:n}})}`:n),!r||!n){const e=b(s);e.length>0?r+=`${s.name} ${e}`:r+=_e}e({type:"updateFooterContent",payload:{value:r}}),e({type:"setInputState",payload:{value:void 0}})}else e({type:"updateFooterContent",payload:{value:(o=n,g.i18n.translate("xpack.securitySolution.useInputHints.unknownCommand",{defaultMessage:"Unknown command {commandName}",values:{commandName:o}}))}}),e({type:"setInputState",payload:{value:"error"}});else e({type:"updateFooterContent",payload:{value:r||t?"":De}}),e({type:"setInputState",payload:{value:void 0}});var o}),[n,s,e,t,r])})();const s=Object(S.a)(k()),o=$(),{rightOfCursorText:l,leftOfCursorText:u,fullTextEntered:c,enteredCommand:d,parsedInput:m}=ye(),p=le(),f=!!Ee(),[v,y]=Object(a.useState)(!1),[h,j]=Object(a.useState)(void 0),[E,O]=Object(a.useState)("94vw"),x=Object(a.useRef)(null),w=t||x,C=Object(a.useMemo)((()=>ve()({cmdInput:!0,hasFocus:v,error:"error"===p,withPopover:f})),[v,f,p]),T=Object(a.useMemo)((()=>0===c.trim().length),[c]),M=Object(a.useMemo)((()=>new entered_input_EnteredInput(u,l,m,d)),[d,u,m,l]),I=Object(a.useCallback)((({width:e})=>{e>0&&O(`${e}px`)}),[]),A=Object(a.useCallback)((()=>{j({input:M.getFullText(!0),enteredCommand:d,parsedInput:m})}),[d,m,M]),P=Object(a.useCallback)((e=>{y(e)}),[]),_=Object(a.useCallback)((e=>{w.current&&w.current.focus(),f&&o({type:"updateInputPopoverState",payload:{show:void 0}})}),[o,f,w]),D=Object(a.useCallback)((({value:e,selection:t,eventDetails:n})=>{const a=n.keyCode;if(38===a)return o({type:"removeFocusFromKeyCapture"}),void o({type:"updateInputPopoverState",payload:{show:"input-history"}});o({type:"updateInputTextEnteredState",payload:({leftOfCursorText:n,rightOfCursorText:i,enteredCommand:r,parsedInput:s})=>{const o=new entered_input_EnteredInput(n,i,s,r);switch(o.addValue(null!=e?e:"",t),a){case 8:o.backspaceChar(t);break;case 46:o.deleteChar(t);break;case 13:j({input:o.getFullText(!0),enteredCommand:r,parsedInput:s}),o.clear();break;case 37:o.moveCursorTo("left");break;case 39:o.moveCursorTo("right");break;case 36:o.moveCursorTo("home");break;case 35:o.moveCursorTo("end")}return{leftOfCursorText:o.getLeftOfCursorText(),rightOfCursorText:o.getRightOfCursorText(),argState:o.getArgState()}}})}),[o]);return Object(a.useEffect)((()=>{h&&(o({type:"executeCommand",payload:h}),j(void 0),o({type:"updateInputTextEnteredState",payload:{leftOfCursorText:"",rightOfCursorText:""}}))}),[h,o]),i.a.createElement(Ue,{width:E},i.a.createElement(r.EuiResizeObserver,{onResize:I},(a=>i.a.createElement(He,be()({},n,{className:C,onClick:_,ref:a,"data-test-subj":s("cmdInput-container")}),i.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none"},e&&i.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":s("cmdInput-prompt")},i.a.createElement("span",{className:"eui-displayInlineBlock prompt"},e)),i.a.createElement(r.EuiFlexItem,{className:"textEntered"},i.a.createElement(Pe,{onCapture:D,onChangeFocus:P,focusRef:t},i.a.createElement(je,{leftOfCursor:M.getLeftOfCursorRenderingContent(),rightOfCursor:M.getRightOfCursorRenderingContent()})),i.a.createElement(Ne,null)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{"data-test-subj":s("inputTextSubmitButton"),"aria-label":"submit-command",iconType:"playFilled",color:"primary",isDisabled:T,onClick:A})))))))}));Ge.displayName="CommandInput";var Qe=n(56),We=n.n(Qe);const Ke=Object(a.memo)((({size:e="s",color:t,children:n,"data-test-subj":a,className:s})=>{const{euiTheme:o}=Object(r.useEuiTheme)();return i.a.createElement(r.EuiText,{size:e,"data-test-subj":a,className:`font-family-code ${null!=s?s:""}`},i.a.createElement(r.EuiTextColor,{color:null!=t?t:o.colors.text},n))}));Ke.displayName="ConsoleText";const Ye=Object(a.memo)((()=>{const e=Object(S.a)(k());return i.a.createElement(Ke,{"data-test-subj":e("longRunningCommandHint")},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.longRunningCommandHintMessage",defaultMessage:"Hint: We are still working on this task. You may leave the console or place another command while this command is processing."}))}));Ye.displayName="LongRunningCommandHint";const Xe=g.i18n.translate("xpack.securitySolution.commandExecutionResult.successTitle",{defaultMessage:"Action completed."}),Je=g.i18n.translate("xpack.securitySolution.commandExecutionResult.failureTitle",{defaultMessage:"Action failed."}),Ze=g.i18n.translate("xpack.securitySolution.commandExecutionResult.pending",{defaultMessage:"Action pending."}),et=Object(a.memo)((({showAs:e="success",title:t,showTitle:n=!0,"data-test-subj":s,className:o,children:l})=>{const u=k(),c=Object(S.a)(null!=s?s:u),d=Object(a.useMemo)((()=>ve()({"eui-displayInlineBlock":"pending"===e,"font-family-code":!0,[o||"_"]:Boolean(o)})),[o,e]);return i.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",borderRadius:"none",color:"transparent",className:d,"data-test-subj":s||c("commandExecutionResult")},"pending"===e?i.a.createElement(Ke,null,null!=l?l:Ze):i.a.createElement(i.a.Fragment,null,n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ke,{color:"success"===e?"success":"danger"},t||("success"===e?Xe:Je)),i.a.createElement(r.EuiSpacer,{size:"s"})),l))}));et.displayName="CommandExecutionResult";const tt=o.a.div.withConfig({displayName:"CommandOutputContainer",componentId:"sc-1wmcd6l-0"})(["position:relative;.busy-indicator{margin-left:0.5em;}"]),nt=Object(a.memo)((({item:{command:e,state:t,id:n,enteredAt:s,isValid:o}})=>{const l=$(),u=e.commandDefinition.RenderComponent,[c,d]=Object(a.useState)(!1),m=Object(a.useMemo)((()=>"pending"===t.status),[t.status]),p=Object(a.useCallback)((e=>{l({type:"updateCommandStatusState",payload:{id:n,value:e}})}),[l,n]),f=Object(a.useCallback)((e=>{l({type:"updateCommandStoreState",payload:{id:n,value:e}})}),[l,n]);return Object(a.useEffect)((()=>{let e;if(m&&!c){const t=We()().diff(We()(s),"seconds");if(t>=15)return void d(!0);e=setTimeout((()=>{d(!0)}),1e3*(15-t))}return()=>{e&&clearTimeout(e)}}),[s,c,m]),i.a.createElement(tt,null,i.a.createElement("div",null,i.a.createElement(ze,{input:e.inputDisplay,isValid:o})),i.a.createElement("div",{className:"noThemeOverrides"},i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(u,{command:e,store:t.store,status:t.status,setStore:f,setStatus:p,ResultComponent:et}),m&&i.a.createElement(r.EuiLoadingChart,{className:"busy-indicator",mono:!0}),m&&c&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(Ye,null))))}));nt.displayName="CommandExecutionOutput";const at=n(69).css`
  ${({theme:{eui:e}})=>e.euiSizeL}
`,it=o()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemHistoryItem",componentId:"sc-1249lql-0"})(["border-bottom:"," dashed ",";margin-bottom:",";padding-bottom:",";"],(({theme:{eui:e}})=>e.euiBorderWidthThin),(({theme:{eui:e}})=>e.euiBorderColor),at,at),rt=Object(a.memo)((({children:e})=>{const t=Object(S.a)(k());return i.a.createElement(it,{grow:!0,"data-test-subj":t("historyItem")},e)}));rt.displayName="HistoryItem";const st=Object(a.memo)((e=>{const t=oe().state.commandHistory,n=$(),s=Object(S.a)(k()),o=Object(a.useMemo)((()=>t.map((e=>i.a.createElement(rt,{key:e.id},i.a.createElement(nt,{item:e}))))),[t]);return Object(a.useEffect)((()=>{n({type:"scrollDown"})}),[n,t.length]),i.a.createElement(r.EuiFlexGroup,be()({"data-test-subj":s("historyOutput")},e,{wrap:!0,direction:"column",alignItems:"stretch",responsive:!1,gutterSize:"none"}),o)}));st.displayName="HistoryOutput";const ot=o()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemNoPadding",componentId:"sc-ojfnk7-0"})(["padding:0 !important;"]),lt=Object(a.memo)((({headerContent:e,children:t})=>{const n=Object(S.a)(k("sidePanel"));return i.a.createElement(r.EuiFlexGroup,{direction:"column",responsive:!1,className:"eui-fullHeight",gutterSize:"none","data-test-subj":n()},e&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container","data-test-subj":n("header")},e),i.a.createElement(r.EuiHorizontalRule,{margin:"none"})),i.a.createElement(ot,{className:"eui-scrollBar eui-yScroll layout-container"},i.a.createElement("div",{"data-test-subj":n("body")},t)))}));lt.displayName="SidePanelContentLayout";const ut=o()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-u9ickv-0"})(["padding-top:",";padding-right:",";"],(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall)),ct=Object(a.memo)((()=>{const e=$(),t=ee(),n=Object(S.a)(k("sidePanel")),s=ce().show,o=Object(a.useCallback)((()=>{e({type:"showSidePanel",payload:{show:null}})}),[e]),l=Object(a.useMemo)((()=>"help"===s?i.a.createElement(i.a.Fragment,null,i.a.createElement(ut,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiTitle,{size:"s","data-test-subj":n("headerTitle")},i.a.createElement("h3",null,i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpTitle",defaultMessage:"Help"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{"aria-label":"closeSidePanelIcon",iconType:"cross",color:"text",onClick:o,"data-test-subj":n("headerCloseButton")}))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(E.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpDescription",defaultMessage:"Use the add ({icon}) button to populate a response action to the text bar. Add additional parameters or comments as necessary.",values:{icon:i.a.createElement(r.EuiIcon,{type:"plusInCircle"})}}))):null),[s,n,o]),u=Object(a.useMemo)((()=>"help"===s?i.a.createElement("div",{"data-test-subj":n("helpContent")},i.a.createElement(Z,{commands:t,display:"table"})):null),[t,n,s]);return s?i.a.createElement(lt,{headerContent:l},u):null}));ct.displayName="RightPanelContentManager";const dt=o()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemWhite",componentId:"sc-hd3kv7-0"})(["background-color:"," !important;border-radius:",";box-shadow:0 "," "," ",";"],(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>`0 ${e.euiSizeXS} ${e.euiSizeXS} 0`),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>Object(r.transparentize)(e.euiShadowColor,.04))),mt=Object(a.memo)((e=>Boolean(ce().show)?i.a.createElement(dt,{grow:!1,className:"layout-rightPanel"},i.a.createElement(ct,null)):null));mt.displayName="SidePanelFlexItem";const pt=o.a.div.withConfig({displayName:"ConsoleWindow",componentId:"sc-d15gh7-0"})(["height:100%;background-color:",";border:",";border-radius:",";.layout{height:100%;width:100%;min-height:300px;min-width:300px;overflow:hidden;&-hideOverflow{overflow:hidden;}&-bottomBorder{border-bottom:"," solid ",";}&-container{padding:",";}&-header{background-color:",";border-bottom:1px solid ",";border-top-left-radius:",";border-top-right-radius:",";padding:"," "," "," ",";}&-commandInput{padding-top:",";padding-bottom:",";}&-footer{padding-top:0;padding-bottom:",";}&-rightPanel{width:35%;background-color:",";border-left:",";}&-historyOutput{overflow:auto;}&-historyViewport{height:100%;overflow-x:hidden;white-space:pre-wrap;}.euiFlexItem:not(.noMinWidth):not(.noThemeOverrides .euiFlexItem){min-width:0;}}.font-family-code{font-family:",";}.font-style-italic{font-style:italic;}"],(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingMedium),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiColorLightShade),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiCodeFontFamily)),ft=Object(a.memo)((({prompt:e,commands:t,HelpComponent:n,TitleComponent:s,storagePrefix:o,managedKey:l,...u})=>{const d=Object(a.useRef)(null),m=Object(a.useRef)(null),p=Object(S.a)(u["data-test-subj"]),f=Object(c.c)(l),b=Object(a.useCallback)((()=>{setTimeout((()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)}),1)}),[]),g=Object(a.useCallback)((()=>{m.current&&m.current.focus()}),[]);return Object(a.useEffect)((()=>{f&&!f.isOpen||setTimeout(g,2)}),[g,f]),i.a.createElement(se,{commands:t,scrollToBottom:b,keyCapture:m,managedKey:l,HelpComponent:n,dataTestSubj:u["data-test-subj"],storagePrefix:o},i.a.createElement(pt,u,i.a.createElement(r.EuiFlexGroup,{className:"layout",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{direction:"column",className:"layout",gutterSize:"none",responsive:!1,"data-test-subj":p("mainPanel")},i.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-header"},i.a.createElement(pe,{TitleComponent:s})),i.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-hideOverflow"},i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},i.a.createElement(r.EuiFlexItem,{className:"eui-fullHeight layout-hideOverflow"},i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},i.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-historyOutput"},i.a.createElement("div",{className:"layout-container layout-historyViewport eui-scrollBar eui-yScroll",ref:d},i.a.createElement(st,null))),i.a.createElement(r.EuiFlexItem,{onClick:g,grow:!1,className:"layout-container layout-commandInput","data-test-subj":p("mainPanel-inputArea")},i.a.createElement(Ge,{prompt:e,focusRef:m})),i.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container layout-footer"},i.a.createElement(ue,null)))))))),i.a.createElement(mt,null))))}));ft.displayName="Console"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return ne}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(45),u=n(51),c=n(53),d=n(54),m=n(147),p=n(4),f=n(174),b=n(170),g=n(298),v=n(297),y=n(164),h=n(383),j=n(159),E=n(525),O=n(110),x=n(726),S=n(5),k=n(62),w=n(265),C=n(283),T=n(226),M=n(351),I=n(293);const A=r.a.memo((({chartHeight:e=174,data:t,from:n,legendItems:s,legendPosition:o=k.Position.Right,legendMinWidth:l,loading:u,showLegend:c,to:d,updateDateRange:m})=>{const{baseTheme:p,theme:f}=Object(w.i)(),b=Object(i.useMemo)((()=>["100%",e]),[e]),g=Object(i.useMemo)((()=>["y"]),[]),v=Object(i.useMemo)((()=>[e=>Object(T.a)(e.g)?e.g:I.c]),[]),y=Object(i.useMemo)((()=>Object(C.a)([n,d])),[n,d]);return r.a.createElement(r.a.Fragment,null,u&&r.a.createElement(a.EuiProgress,{"data-test-subj":"loadingPanelAlertsHistogram",size:"xs",position:"absolute",color:"accent"}),r.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(k.Chart,{size:b},r.a.createElement(k.Settings,{legendPosition:o,onBrushEnd:m,showLegend:c&&0===s.length,showLegendExtra:c,theme:f,baseTheme:p,locale:S.i18n.getLocale()}),r.a.createElement(k.Axis,{id:"alertsHistogramAxisX",position:k.Position.Bottom,tickFormat:y}),r.a.createElement(k.Axis,{id:"alertsHistogramAxisY",position:k.Position.Left}),r.a.createElement(k.HistogramBarSeries,{id:"alertsHistogram",xScaleType:k.ScaleType.Time,yScaleType:k.ScaleType.Linear,xAccessor:"x",yAccessors:g,splitSeriesAccessors:v,data:t}))),r.a.createElement(a.EuiFlexItem,{grow:!1},s.length>0&&r.a.createElement(M.a,{legendItems:s,height:e,minWidth:l}))))}));A.displayName="AlertsHistogram";const P=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.headerTitle",{defaultMessage:"Trend"}),_=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.notAvailableTooltip",{defaultMessage:"Not available for trend view"}),D=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),F=(e,t,n)=>S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.showingAlertsTitle",{values:{totalAlertsFormatted:e,totalAlerts:t,modifier:n},defaultMessage:"Showing: {modifier}{totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"});var N=n(137),R=n(129),z=n(432),L=n(528),B=n(398),q=n(160),$=n(399),V=n(130);const U=Object(u.v4)(),H=(e="kibana.alert.rule.name",t)=>({title:"Alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:U,accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:null!=t&&t.filters?t.filters:[],datasourceStates:{formBased:{layers:{[U]:{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:e,isBucketed:!0,params:{size:1e3,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"},secondaryFields:[]}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}},internalReferences:[],adHocDataViews:{}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${U}`}]});var G=n(116),Q=n(330),W=n(61),K=n.n(W),Y=n(347);const X={value:0,relation:"eq"},J="detections-histogram",Z=o()(a.EuiFlexItem).withConfig({displayName:"ViewAlertsFlexItem",componentId:"sc-tvqkga-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeL)),ee=o()(a.EuiFlexItem).withConfig({displayName:"OptionsFlexItem",componentId:"sc-tvqkga-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),te=[],ne=Object(i.memo)((({alignHeader:e,chartHeight:t=155,chartOptionsContextMenu:n,combinedQueries:s,comboboxRef:o,defaultStackByOption:k=z.a,extraActions:w,filters:C,headerChildren:T,inspectTitle:M,legendPosition:I="right",onFieldSelected:U,onlyField:W,paddingSize:ne="m",panelHeight:ae=z.d,query:ie,runtimeMappings:re,setComboboxInputRef:se,showCountsInLegend:oe=!1,showGroupByPlaceholder:le=!1,showLegend:ue=!0,showLinkToAlerts:ce=!1,showStackBy:de=!0,showTotalAlertsCount:me=!1,signalIndexName:pe,stackByLabel:fe,stackByWidth:be,timelineId:ge,title:ve=P,titleSize:ye="m",updateDateRange:he,hideQueryToggle:je=!1,isExpanded:Ee,setIsExpanded:Oe})=>{var xe;const{to:Se,from:ke,deleteQuery:we,setQuery:Ce}=Object(m.a)(),Te=Object(i.useMemo)((()=>`${J}-${Object(u.v4)()}`),[]),Me=`alerts-trend-embeddable-${Te}`,[Ie,Ae]=Object(i.useState)(!0),[Pe,_e]=Object(i.useState)(!1),[De,Fe]=Object(i.useState)(X),[Ne,Re]=Object(i.useState)(null==W?k:W),ze=Object(V.a)("chartEmbeddablesEnabled"),Le=Object(V.a)("alertsPageChartsEnabled"),Be=Object(i.useCallback)((e=>{Re(e),null!=U&&U(e)}),[U]);Object(i.useEffect)((()=>{Re(null==W?k:W)}),[k,W]);const{toggleStatus:qe,setToggleStatus:$e}=Object(q.a)(J),Ve=Object(i.useCallback)((e=>{Le&&void 0!==Oe?Oe(e):$e(e)}),[$e,Oe,Le]),Ue=Object(i.useMemo)((()=>Le&&void 0!==Oe?!Ee:!qe),[Le,Oe,Ee,qe]),He=Object(i.useMemo)((()=>({from:ke,to:Se})),[ke,Se]),{loading:Ge,data:Qe,setQuery:We,response:Ke,request:Ye,refetch:Xe}=Object(g.a)({query:Object(x.d)(Ne,ke,Se,Object(x.a)(s),re),indexName:pe,skip:Ue||ze,queryName:v.a.HISTOGRAM}),Je=Object(O.i)(),{navigateToApp:Ze}=Je.services.application,{formatUrl:et,search:tt}=Object(y.l)(R.a.alerts),nt=(({totalAlertsObj:e,visualizationId:t,isChartEmbeddablesEnabled:n})=>{const[a]=Object(O.o)(p.P),r=Object(Y.a)({visualizationId:t}),s=Object(i.useMemo)((()=>F(K()(e.value).format(a),e.value,"gte"===e.relation?">":"lte"===e.relation?"<":"")),[e.value,e.relation,a]),o=Object(i.useMemo)((()=>{const e=null!=r?r[0].hits.total:0;return F(K()(e).format(a),e,"")}),[a,r]);return n?o:s})({totalAlertsObj:De,visualizationId:Me,isChartEmbeddablesEnabled:ze}),at=Object(i.useCallback)((e=>{e.preventDefault(),Ze(p.l,{deepLinkId:R.a.alerts,path:Object(y.c)(tt)})}),[Ze,tt]),it=Object(i.useMemo)((()=>Object(x.c)(Qe)),[Qe]),rt=Object(i.useMemo)((()=>{var e,t;return ue&&null!=(null==Qe||null===(e=Qe.aggregations)||void 0===e||null===(t=e.alertsByGrouping)||void 0===t?void 0:t.buckets)?Qe.aggregations.alertsByGrouping.buckets.map(((e,t)=>{var n;return{color:t<h.a.length?h.a[t]:void 0,count:oe?e.doc_count:void 0,dataProviderId:Object(f.i)(`draggable-legend-item-${Object(u.v4)()}-${Ne}-${e.key}`),field:Ne,timelineId:ge,value:null!==(n=null==e?void 0:e.key_as_string)&&void 0!==n?n:e.key}})):te}),[null==Qe||null===(xe=Qe.aggregations)||void 0===xe?void 0:xe.alertsByGrouping.buckets,Ne,oe,ue,ge]);Object(i.useEffect)((()=>{let e=!1;return e||Object(x.f)({isInitialLoading:Ie,isLoadingAlerts:Ge})||Ae(!1),()=>{e=!0}}),[Ie,Ge,Ae]),Object(B.a)({deleteQuery:we,loading:Ge,refetch:Xe,request:Ye,response:Ke,setQuery:Ce,uniqueQueryId:Te}),Object(i.useEffect)((()=>{var e;Fe(null!==(e=null==Qe?void 0:Qe.hits.total)&&void 0!==e?e:{value:0,relation:"eq"})}),[Qe]),Object(i.useEffect)((()=>{try{let t=null;var e;t=null!=s?Object(x.e)(s):Object(c.buildEsQuery)(void 0,null!=ie?[ie]:[],null!==(e=null==C?void 0:C.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[],{...Object(d.getEsQueryConfig)(Je.services.uiSettings),dateFormatTZ:void 0}),_e(!1),We(Object(x.d)(Ne,ke,Se,Object(l.isEmpty)(t)?[]:[t],re))}catch(e){_e(!0),We(Object(x.d)(Ne,ke,Se,[],re))}}),[Ne,ke,Se,ie,C,s,re]);const st=Object(i.useMemo)((()=>{if(ce)return r.a.createElement(Z,{grow:!1},r.a.createElement(N.g,{"data-test-subj":"alerts-histogram-panel-go-to-alerts-page",onClick:at,href:et(Object(y.c)())},D))}),[ce,at,et]),ot=Object(i.useMemo)((()=>{return null==W?ve:(e=W,S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}));var e}),[W,ve]),lt=Object(i.useMemo)((()=>Le&&void 0!==Ee?Ee:qe),[Le,Ee,qe]);return r.a.createElement(j.c,{show:!Ie&&lt},r.a.createElement(L.a,{height:ae,hasBorder:!0,paddingSize:ne,"data-test-subj":"alerts-histogram-panel",$toggleStatus:lt},r.a.createElement(b.a,{alignHeader:e,id:Te,inspectTitle:M,outerDirection:"column",title:ot,titleSize:ye,toggleStatus:lt,toggleQuery:je?void 0:Ve,showInspectButton:!ze&&null==n,subtitle:!Ie&&me&&nt,isInspectDisabled:Pe},r.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"panelFlexGroup",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},de&&r.a.createElement(r.a.Fragment,null,r.a.createElement(L.b,{"data-test-subj":"stackByComboBox",inputRef:se,onSelect:Be,prepend:fe,ref:o,selected:Ne,useLensCompatibleFields:ze,width:be}),le&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{"data-test-subj":"placeholderSpacer",size:"s"}),r.a.createElement(a.EuiToolTip,{"data-test-subj":"placeholderTooltip",content:_},r.a.createElement(L.b,{"data-test-subj":"stackByPlaceholder",isDisabled:!0,onSelect:l.noop,prepend:$.b,selected:"",useLensCompatibleFields:ze,width:be})))),null!=T&&T),null!=n&&!ze&&r.a.createElement(ee,{grow:!1},n(Te)),st)),lt?ze?r.a.createElement(Q.a,{"data-test-subj":"embeddable-matrix-histogram",extraActions:w,extraOptions:{filters:C},getLensAttributes:H,height:null!=t?t:155,id:Me,inspectTitle:null!=M?M:ve,scopeId:G.SourcererScopeName.detections,stackByField:Ne,timerange:He}):Ie?r.a.createElement(E.a,null):r.a.createElement(A,{chartHeight:t,data:it,from:ke,legendItems:rt,legendPosition:I,legendMinWidth:oe?300:void 0,loading:Ge,to:Se,showLegend:ue,updateDateRange:he}):null))}));ne.displayName="AlertsHistogramPanel"},function(e,t,n){"use strict";n.d(t,"b",(function(){return we})),n.d(t,"a",(function(){return Ie}));var a=n(45),i=n(17),r=n(2),s=n.n(r),o=n(48),l=n(44),u=n.n(l),c=n(66),d=n(135),m=n(118),p=n(134),f=n(196),b=n(116),g=n(742),v=n(113),y=n(112),h=n(282),j=n(145),E=n(296),O=n(23),x=n.n(O),S=(n(13),n(194)),k=n(47),w=n(130),C=n(110),T=n(719),M=n(485),I=n(377),A=n(122),P=n(430),_=n(721),D=n(5);const F=D.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),N=D.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),R=D.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),z=D.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),L=D.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),B=D.i18n.translate("xpack.securitySolution.timeline.tabs.securityAssistantTimelineTitle",{defaultMessage:"Elastic AI Assistant"}),q=D.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline",{defaultMessage:"ES|QL"}),$=D.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline.technicalPreviewLabel",{defaultMessage:"Technical Preview"}),V=D.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"});var U=n(18),H=n(520),G=n(14);const Q=u.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-1ib7jds-0"})(["flex:1;"]);var W=u()(Q).withConfig({displayName:"_StyledHideShowContainer",componentId:"sc-1ib7jds-1"})(["overflow:hidden !important;"]);const K=(e,t=s.a.createElement(i.EuiSkeletonText,{lines:10}))=>{var n;const a=s.a.forwardRef(((n,a)=>s.a.createElement(r.Suspense,{fallback:t},s.a.createElement(e,x()({},n,{ref:a})))));return a.displayName=`${null!==(n=e.displayName)&&void 0!==n?n:"Tab"}WithSuspense`,a},Y=u.a.div.withConfig({displayName:"AssistantTabContainer",componentId:"sc-1ib7jds-2"})(["overflow-y:auto;width:100%;"]),X=K(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(15),n.e(16),n.e(44)]).then(n.bind(null,1724))))),J=K(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(15),n.e(16),n.e(37)]).then(n.bind(null,1732))))),Z=K(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(17),n.e(38)]).then(n.bind(null,1710))))),ee=K(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(46)]).then(n.bind(null,1735))))),te=K(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(15),n.e(50)]).then(n.bind(null,1711))))),ne=K(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(47)]).then(n.bind(null,1712))))),ae=K(Object(r.lazy)((()=>n.e(43).then(n.bind(null,1726))))),ie=Object(r.memo)((({shouldRefocusPrompt:e,setConversationId:t})=>s.a.createElement(r.Suspense,{fallback:s.a.createElement(i.EuiSkeletonText,{lines:10})},s.a.createElement(Y,null,s.a.createElement(S.a,{conversationId:H.a,embeddedLayout:!0,setConversationId:t,shouldRefocusPrompt:e})))));ie.displayName="AssistantTab";const re=Object(r.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:n,timelineId:a,timelineType:i,setConversationId:o,showTimeline:l})=>{const{hasAssistantPrivilege:u}=Object(I.a)(),c=Object(C.i)().services.configSettings.ESQLEnabled,d=Object(r.useCallback)((e=>{switch(e){case A.d.graph:return s.a.createElement(Z,{timelineId:a});case A.d.notes:return s.a.createElement(ee,{timelineId:a});case A.d.session:return s.a.createElement(ne,{timelineId:a});default:return null}}),[a]),m=Object(r.useMemo)((()=>[A.d.graph,A.d.notes,A.d.session].includes(e)),[e]),{conversations:p}=Object(M.a)(),f=Object(r.useMemo)((()=>p[H.a].messages.length>0),[p]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(Q,{$isVisible:A.d.query===e,"data-test-subj":`timeline-tab-content-${A.d.query}`},s.a.createElement(X,{renderCellValue:t,rowRenderers:n,timelineId:a})),l&&c&&e===A.d.esql&&s.a.createElement(Q,{$isVisible:!0,"data-test-subj":`timeline-tab-content-${A.d.esql}`},s.a.createElement(ae,{timelineId:a})),s.a.createElement(Q,{$isVisible:A.d.pinned===e,"data-test-subj":`timeline-tab-content-${A.d.pinned}`},s.a.createElement(te,{renderCellValue:t,rowRenderers:n,timelineId:a})),i===v.l.default&&s.a.createElement(Q,{$isVisible:A.d.eql===e,"data-test-subj":`timeline-tab-content-${A.d.eql}`},s.a.createElement(J,{renderCellValue:t,rowRenderers:n,timelineId:a})),s.a.createElement(Q,{$isVisible:m,isOverflowYScroll:e===A.d.session,"data-test-subj":`timeline-tab-content-${A.d.graph}-${A.d.notes}`},m&&d(e)),u&&s.a.createElement(W,{$isVisible:e===A.d.securityAssistant,isOverflowYScroll:e===A.d.securityAssistant,"data-test-subj":"timeline-tab-content-security-assistant"},(e===A.d.securityAssistant||f)&&s.a.createElement(ie,{setConversationId:o,shouldRefocusPrompt:l&&e===A.d.securityAssistant})))}));re.displayName="ActiveTimelineTab";const se=u()(i.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-1ib7jds-3"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),oe=u()(i.EuiBetaBadge).withConfig({displayName:"StyledEuiBetaBadge",componentId:"sc-1ib7jds-4"})(["vertical-align:middle;margin-left:",";&:hover{cursor:pointer;}"],(({theme:e})=>e.eui.euiSizeS)),le=u()(i.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-1ib7jds-5"})([".euiTab__content{align-items:center;display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),ue=u()(i.EuiTabs).withConfig({displayName:"StyledEuiTabs",componentId:"sc-1ib7jds-6"})(["padding-inline:",";"],(e=>e.theme.eui.euiSizeM)),ce=({renderCellValue:e,rowRenderers:t,timelineId:n,timelineFullScreen:l,timelineType:u,graphEventId:c,sessionViewConfig:d,timelineDescription:p})=>{const f=Object(w.a)("timelineEsqlTabDisabled"),b=Object(C.i)().services.configSettings.ESQLEnabled,{hasAssistantPrivilege:g}=Object(I.a)(),h=Object(o.useDispatch)(),j=Object(r.useMemo)((()=>Object(_.a)()),[]),E=Object(r.useMemo)((()=>Object(_.g)()),[]),O=Object(r.useMemo)((()=>Object(_.e)()),[]),x=Object(r.useMemo)((()=>Object(_.d)()),[]),S=Object(r.useMemo)((()=>Object(_.c)()),[]),M=Object(r.useMemo)((()=>Object(_.b)()),[]),D=Object(y.b)((e=>j(e,n))),Q=Object(y.b)((e=>E(e,n))),W=Object(y.b)((e=>O(e,n))),K=Object(y.a)((e=>S(e,n))),Y=Object(y.a)((e=>M(e,n))),X=Object(y.a)((e=>x(e))),J=Object(U.b)().isEnterprise(),[Z,ee]=Object(r.useState)(H.a),{reportAssistantInvoked:te}=Object(T.a)(),ne=Object(r.useMemo)((()=>{const e=Object.values(Y).reduce(((e,t)=>[...e,...t]),[]);return[...K,...e]}),[K,Y]),ae=Object(r.useMemo)((()=>X.filter((e=>ne.includes(e.id))).length+(Object(a.isEmpty)(p)?0:1)),[X,ne,p]),ie=Object(r.useCallback)((e=>{h(m.a.setActiveTabTimeline({id:n,activeTab:e}))}),[h,n]),ce=Object(r.useCallback)((()=>{ie(A.d.query)}),[ie]),de=Object(r.useCallback)((()=>{ie(A.d.eql)}),[ie]),me=Object(r.useCallback)((()=>{ie(A.d.graph)}),[ie]),pe=Object(r.useCallback)((()=>{ie(A.d.notes)}),[ie]),fe=Object(r.useCallback)((()=>{ie(A.d.pinned)}),[ie]),be=Object(r.useCallback)((()=>{ie(A.d.session)}),[ie]),ge=Object(r.useCallback)((()=>{ie(A.d.securityAssistant),D!==A.d.securityAssistant&&te({conversationId:Z,invokedBy:H.a})}),[D,Z,te,ie]),ve=Object(r.useCallback)((()=>{h(Object(G.initializeTimelineSettings)({id:n})),ie(A.d.esql)}),[ie,h,n]);return Object(r.useEffect)((()=>{c||D!==A.d.graph||ce()}),[D,c,ce]),s.a.createElement(s.a.Fragment,null,!l&&s.a.createElement(ue,{className:"eui-scrollBar"},s.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.query}`,onClick:ce,isSelected:D===A.d.query,disabled:!1,key:A.d.query},s.a.createElement("span",null,F),Q&&s.a.createElement(P.b,null)),!f&&b&&s.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.esql}`,onClick:ve,isSelected:D===A.d.esql,disabled:!1,key:A.d.esql},s.a.createElement("span",null,q),s.a.createElement(oe,{label:$,size:"s",iconType:"beaker",tooltipContent:s.a.createElement(k.FormattedMessage,{id:"xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline.technicalPreviewTooltip",defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."})})),u===v.l.default&&s.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.eql}`,onClick:de,isSelected:D===A.d.eql,disabled:!1,key:A.d.eql},s.a.createElement("span",null,N),Q&&s.a.createElement(P.a,null)),s.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${A.d.graph}`,onClick:me,isSelected:D===A.d.graph,disabled:!c,key:A.d.graph},R),J&&s.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${A.d.session}`,onClick:be,isSelected:D===A.d.session,disabled:null===d,key:A.d.session},V),s.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.notes}`,onClick:pe,isSelected:D===A.d.notes,disabled:u===v.l.template,key:A.d.notes},s.a.createElement("span",null,z),Q&&ae>0&&u===v.l.default&&s.a.createElement("div",null,s.a.createElement(se,null,ae))),s.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.pinned}`,onClick:fe,disabled:u===v.l.template,isSelected:D===A.d.pinned,key:A.d.pinned},s.a.createElement("span",null,L),Q&&W>0&&u===v.l.default&&s.a.createElement("div",null,s.a.createElement(se,null,W))),g&&s.a.createElement(le,{"data-test-subj":`timelineTabs-${A.d.securityAssistant}`,onClick:ge,disabled:u===v.l.template,isSelected:D===A.d.securityAssistant,key:A.d.securityAssistant},s.a.createElement("span",null,B))),s.a.createElement(re,{activeTimelineTab:D,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:u,timelineDescription:p,setConversationId:ee,showTimeline:Q}))},de=Object(r.memo)(ce);var me=n(243),pe=n(189),fe=n(593),be=n(49),ge=n(60),ve=n(218),ye=n(128),he=n(722),je=n(4),Ee=n(292),Oe=n(516);const xe=e=>{var t;const{activeTab:n,switchToTab:a,timelineType:o}=e,{services:{storage:l}}=Object(C.i)(),u=Object(r.useMemo)((()=>Ee.b.filter((e=>!e.timelineType||e.timelineType===o))),[o]),[c,d]=Object(r.useState)((()=>{const e=l.get(je.Qb.TIMELINE);return null!=e?e:Ee.c})),m=Object(r.useCallback)((()=>{d((e=>({...e,isTourActive:!1})))}),[]),p=Object(r.useCallback)((()=>{d((e=>({...e,currentTourStep:e.currentTourStep+1})))}),[]);Object(r.useEffect)((()=>{l.set(je.Qb.TIMELINE,c)}),[c,l]);const f=Object(r.useCallback)((e=>e===u.length?s.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:m},Oe.h):[s.a.createElement(i.EuiButtonEmpty,{size:"s",color:"text",onClick:m},Oe.g),s.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:p},Oe.j)]),[m,p,u.length]),b=null===(t=u[c.currentTourStep-1])||void 0===t?void 0:t.anchor,g=Object(he.a)(b),v=u[c.currentTourStep-1];return null!=v&&v.timelineTab&&v.timelineTab!==n&&a(v.timelineTab),c.isTourActive&&g?s.a.createElement(s.a.Fragment,null,u.map(((e,t)=>{const n=t+1;if(c.currentTourStep!==n)return null;const a={"data-test-subj":`timeline-tour-step-${t+1}`};return s.a.createElement(i.EuiTourStep,{panelProps:a,key:t,step:n,isStepOpen:c.isTourActive&&c.currentTourStep===t+1,minWidth:c.tourPopoverWidth,stepsTotal:u.length,onFinish:m,title:e.title,content:e.content,anchor:`#${e.anchor}`,subtitle:Ee.c.tourSubtitle,footerAction:f(n)})}))):null},Se=s.a.memo(xe),ke=u.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-4r2lej-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),we=Object(r.createContext)({timelineId:null}),Ce=({timelineId:e})=>{const t=Object(r.useMemo)((()=>m.b.getTimelineByIdSelector()),[]);return Object(y.b)((n=>{var a;return(null!==(a=t(n,e))&&void 0!==a?a:p.b).isSaving}))?s.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},Te=s.a.memo(Ce),Me=({renderCellValue:e,rowRenderers:t,timelineId:n})=>{const l=Object(o.useDispatch)(),u=Object(r.useRef)(null),O=Object(r.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),x=Object(r.useMemo)((()=>ye.e.scopeIdSelector()),[]),{selectedPatterns:S,selectedDataViewId:k}=Object(y.a)((e=>x(e,b.SourcererScopeName.timeline))),{dataViewId:w,indexNames:T,graphEventId:M,savedObjectId:I,timelineType:P,description:_,sessionViewConfig:D,initialized:F,show:N,isLoading:R,activeTab:z}=Object(y.a)((e=>{var t;return Object(a.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig","initialized","show","isLoading","activeTab"],null!==(t=O(e,n))&&void 0!==t?t:p.b)})),{kibanaSecuritySolutionsPrivileges:{crud:L}}=Object(d.a)(),{timelineFullScreen:B}=Object(pe.c)();Object(r.useEffect)((()=>{I||F||l(m.a.createTimeline({id:n,columns:f.b,dataViewId:k,indexNames:S,expandedDetail:h.a.getExpandedDetail(),show:!1}))}),[]);const q=Object(r.useCallback)((()=>{!I||null==k||null===w&&0===T.length||w===k&&T.sort().join()===S.sort().join()||l(m.a.updateDataView({dataViewId:k,id:n,indexNames:S}))}),[l,I,k,w,S,T,n]);Object(r.useEffect)((()=>{q()}),[k,S]);const $=Object(r.useCallback)((()=>{var e;const t=null===(e=u.current)||void 0===e?void 0:e.querySelector(fe.a);var n,a;null!=t?t.focus():null===(n=u.current)||void 0===n||null===(a=n.querySelector(".globalFilterBar__addButton"))||void 0===a||a.focus()}),[u]),V=Object(r.useCallback)((()=>{var e,t;null===(e=u.current)||void 0===e||null===(t=e.querySelector(`.${j.d}`))||void 0===t||t.focus()}),[u]),U=Object(r.useCallback)((e=>{Object(c.isTab)(e)&&Object(j.l)({containerElement:u.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:$,onSkipFocusAfterEventsTable:V})}),[u,$,V]),H=Object(r.useMemo)((()=>({timelineId:n})),[n]),G=(()=>{const{search:e,pathname:t}=Object(be.useLocation)(),{spaces:n}=Object(C.i)().services,a=Object(r.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:o,savedObjectId:l,show:u,graphEventId:c,activeTab:d}=Object(y.a)((e=>{var t;return null!==(t=a(e,A.c.active))&&void 0!==t?t:p.b})),f=Object(r.useCallback)((()=>{var a,r,m;const p=new URLSearchParams(e),f=null!==(a=p.get(ve.a.timeline))&&void 0!==a?a:void 0,b={id:null!=l?l:"",isOpen:!!u,activeTab:d,graphEventId:c},g=null!==(r=Object(ge.safeDecode)(null!=f?f:""))&&void 0!==r?r:b,v=null==g?void 0:g.id;if(!n||"conflict"!==(null==o?void 0:o.outcome)||null==(null==o?void 0:o.alias_target_id)||null==v)return null;const y=null!==(m=null==o?void 0:o.alias_target_id)&&void 0!==m?m:"",h={...g,id:y},j=Object(ge.encode)(h);p.set(ve.a.timeline,j);const E=`${t}?${p.toString()}${window.location.hash}`;return s.a.createElement(s.a.Fragment,null,n.ui.components.getLegacyUrlConflict({objectNoun:ve.a.timeline,currentObjectId:v,otherObjectId:y,otherObjectPath:E}),s.a.createElement(i.EuiSpacer,null))}),[d,c,t,null==o?void 0:o.alias_target_id,null==o?void 0:o.outcome,l,e,u,n]);return Object(r.useMemo)((()=>f()),[f])})(),Q=N&&!R&&L,W=Object(r.useCallback)((e=>{l(m.a.setActiveTabTimeline({id:n,activeTab:e}))}),[n,l]);return s.a.createElement(we.Provider,{value:H},s.a.createElement(me.B,{"data-test-subj":"timeline","data-timeline-id":n,onKeyDown:U,ref:u},s.a.createElement(Te,{timelineId:n}),s.a.createElement("div",{className:"timeline-body","data-test-subj":"timeline-body"},P===v.l.template&&s.a.createElement(ke,{className:"timeline-template-badge"},E.f),G,s.a.createElement(me.y,{$isVisible:!B,"data-test-subj":"timeline-hide-show-container"},s.a.createElement(g.a,{timelineId:n})),s.a.createElement(de,{graphEventId:M,sessionViewConfig:D,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:P,timelineDescription:_,timelineFullScreen:B}))),Q?s.a.createElement(Se,{activeTab:z,switchToTab:W,timelineType:P}):null)};Me.displayName="StatefulTimelineComponent";const Ie=s.a.memo(Me)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5);a.i18n.translate("xpack.securitySolution.guideConfig.title",{defaultMessage:"Detect threats in my data with SIEM"}),a.i18n.translate("xpack.securitySolution.guideConfig.description",{defaultMessage:"There are many ways to get your SIEM data into Elastic. In this guide, we'll help you get set up quickly using the Elastic Defend integration."}),a.i18n.translate("xpack.securitySolution.guideConfig.documentationLink",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description.linkText",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.title",{defaultMessage:"Add data with Elastic Defend"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description",{defaultMessage:"Install Elastic Agent and its Elastic Defend integration on one of your computers to get SIEM data flowing."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.title",{defaultMessage:"Turn on rules"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.description",{defaultMessage:"Load the Elastic prebuilt rules, select the rules you want, and enable them to generate alerts."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.title",{defaultMessage:"Continue with the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.description",{defaultMessage:"After you've enabled the rules you need, continue."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.title",{defaultMessage:"Manage alerts and cases"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.description",{defaultMessage:"Learn how to view and triage alerts with cases."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.title",{defaultMessage:"Continue the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.description",{defaultMessage:"After you've explored the case, continue."});const i="siem"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(110),r=n(114),s=n(66);const o=({closePopover:e,draggableId:t,fieldName:n,keyboardHandlerRef:o,openPopover:l})=>{const{timelines:u}=Object(i.i)().services,c=u.getUseAddToTimeline(),{beginDrag:d,cancelDrag:m,dragToLocation:p,endDrag:f,hasDraggableLock:b}=c({draggableId:t,fieldName:n}),[g,v]=Object(a.useState)(null),y=Object(a.useCallback)((()=>{v((e=>e?(m(e),null):null))}),[m]),h=Object(a.useCallback)((n=>{const a=document.querySelector(`[data-rbd-drag-handle-draggable-id="${t}"]`);var i;a&&((b()||!b()&&" "===n.key)&&(n.preventDefault(),n.stopPropagation()),(({beginDrag:e,cancelDragActions:t,closePopover:n,draggableElement:a,dragActions:i,dragToLocation:o,endDrag:l,keyboardEvent:u,openPopover:c,setDragActions:d})=>{let m=null;switch(u.key){case" ":i?(l(i),d(null)):(null!=n&&n(),d(e()));break;case"Escape":t();break;case"Tab":(e=>{const t=e.querySelectorAll("a, button");t.forEach((e=>{e.setAttribute("tabindex","-1")})),setTimeout((()=>{t.forEach((e=>{e.setAttribute("tabindex","0")}))}),0)})(a);break;case"ArrowUp":m=a.getBoundingClientRect(),o({dragActions:i,position:{x:m.x,y:m.y-r.f}});break;case"ArrowDown":m=a.getBoundingClientRect(),o({dragActions:i,position:{x:m.x,y:m.y+r.f}});break;case"ArrowLeft":m=a.getBoundingClientRect(),o({dragActions:i,position:{x:m.x-r.f,y:m.y}});break;case"ArrowRight":m=a.getBoundingClientRect(),o({dragActions:i,position:{x:m.x+r.f,y:m.y}});break;case"Enter":Object(s.stopPropagationAndPreventDefault)(u),i||null==c||c()}})({beginDrag:d,cancelDragActions:y,closePopover:e,dragActions:g,draggableElement:a,dragToLocation:p,endDrag:f,keyboardEvent:n,openPopover:l,setDragActions:v}),null===(i=o.current)||void 0===i||i.focus())}),[d,y,e,g,t,p,f,b,o,l,v]);return Object(a.useMemo)((()=>({onBlur:y,onKeyDown:h})),[y,h])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17),l=n(50),u=n(110),c=n(47);const d=({handleClick:e})=>i.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonEmpty,{onClick:e,"data-test-subj":"osquery-empty-button"},i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.footer.cancel",defaultMessage:"Cancel"})))),m=i.a.memo(d);var p=n(709);const f=s.a.div.withConfig({displayName:"OsqueryActionWrapper",componentId:"sc-flf6q3-0"})(["padding:8px;"]),b=({agentId:e,defaultValues:t,onClose:n,ecsData:r})=>{const{services:{osquery:s}}=Object(u.i)(),c=Object(l.useQueryClient)(),d=Object(a.useCallback)((()=>{var e;c.invalidateQueries({queryKey:["actions",{alertId:null==t||null===(e=t.alertIds)||void 0===e?void 0:e[0]}]})}),[null==t?void 0:t.alertIds,c]);return null!=s&&s.OsqueryAction?i.a.createElement(o.EuiFlyout,{size:"m",onClose:n},i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"flyout-header-osquery"},i.a.createElement(o.EuiTitle,null,i.a.createElement("h2",null,p.a))),i.a.createElement(o.EuiFlyoutBody,null,i.a.createElement(f,{"data-test-subj":"flyout-body-osquery"},i.a.createElement(s.OsqueryAction,{agentId:e,formType:"steps",defaultValues:t,ecsData:r,onSuccess:d}))),i.a.createElement(o.EuiFlyoutFooter,null,i.a.createElement(m,{handleClick:n,"data-test-subj":"flyout-footer-osquery"}))):null},g=i.a.memo(b)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return A})),n.d(t,"a",(function(){return R}));var a=n(45),i=n(17),r=n(47),s=n(2),o=n.n(s),l=n(44),u=n.n(l),c=n(48),d=n(50),m=n(126),p=n(390),f=n(118),b=n(167),g=n(468),v=n(5);const y=v.i18n.translate("xpack.securitySolution.timeline.toggleEventDetailsTitle",{defaultMessage:"Expand event details"}),h=v.i18n.translate("xpack.securitySolution.timeline.addedANoteLabel",{defaultMessage:"added a note"}),j=v.i18n.translate("xpack.securitySolution.timeline.addedADescriptionLabel",{defaultMessage:"added description"}),E=v.i18n.translate("xpack.securitySolution.timeline.anUnknownUserLabel",{defaultMessage:"an unknown user"}),O=v.i18n.translate("xpack.securitySolution.timeline.deleteNoteLabel",{defaultMessage:"Delete Note"}),x=v.i18n.translate("xpack.securitySolution.timeline.cancelDeleteNoteLabel",{defaultMessage:"Keep Note"}),S=v.i18n.translate("xpack.securitySolution.timeline.promptDeleteNoteLabel",{defaultMessage:"Delete timeline note?"});var k=n(122),w=n(112),C=n(116),T=n(121),M=n(110),I=n(117);const A=u.a.section.withConfig({displayName:"NotePreviewsContainer",componentId:"sc-16ieedj-0"})(["padding-top:",";"],(({theme:e})=>`${e.eui.euiSizeS}`));A.displayName="NotePreviewsContainer";const P=({eventId:e,timelineId:t})=>{const n=Object(c.useDispatch)(),{selectedPatterns:a}=Object(T.d)(C.SourcererScopeName.timeline),r=Object(s.useCallback)((()=>{n(f.a.toggleDetailPanel({panelView:"eventDetail",tabType:k.d.notes,id:t,params:{eventId:e,indexName:a.join(",")}}))}),[n,e,a,t]);return o.a.createElement(i.EuiButtonIcon,{title:y,"aria-label":y,color:"text",iconType:"arrowRight",onClick:r})},_=o.a.memo(P),D=o.a.memo((({closeModal:e,confirmModal:t})=>o.a.createElement(i.EuiConfirmModal,{title:S,onCancel:e,onConfirm:t,cancelButtonText:x,confirmButtonText:O,buttonColor:"danger",defaultFocusedButton:"confirm"})));D.displayName="DeleteNoteConfirm";const F=o.a.memo((({noteId:e})=>{const[t,n]=Object(s.useState)(null),{mutate:a,isLoading:r}=function(e){const{services:{http:t}}=Object(M.i)(),n=Object(c.useDispatch)(),{addError:a}=Object(I.a)();return Object(d.useMutation)({mutationFn:e=>t.fetch("/api/note",{method:"DELETE",body:JSON.stringify({noteId:e}),version:"2023-10-31"}),onSuccess:()=>{e&&n(b.a.deleteNote({id:e}))},onError:e=>{var t;a(e,{title:(t=e,v.i18n.translate("xpack.securitySolution.timeline.deleteNoteError",{defaultMessage:"An error occurred deleting note {error}",values:{error:t}}))})}})}(e),l=Object(s.useCallback)((async()=>{n(e)}),[e]),u=Object(s.useCallback)((()=>{n(null)}),[]),m=Object(s.useCallback)((()=>{a(e),n(null)}),[a,e]),p=Object(s.useMemo)((()=>r||null==e),[r,e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiButtonIcon,{title:O,"aria-label":O,"data-test-subj":"delete-note",color:"text",iconType:"trash",onClick:l,disabled:p}),null!=t&&o.a.createElement(D,{closeModal:u,confirmModal:m}))}));F.displayName="DeleteNoteButton";const N=o.a.memo((({eventId:e,timelineId:t,noteId:n})=>e&&t?o.a.createElement(o.a.Fragment,null,o.a.createElement(_,{eventId:e,timelineId:t}),o.a.createElement(F,{noteId:n})):o.a.createElement(F,{noteId:n})));N.displayName="NoteActions";const R=o.a.memo((({eventIdToNoteIds:e,notes:t,timelineId:n,showTimelineDescription:l})=>{const u=Object(s.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),c=Object(w.a)((e=>n?u(e,n):null)),d=Object(s.useMemo)((()=>l&&n&&null!=c&&c.description?[{username:Object(m.a)(c.updatedBy),event:j,"data-test-subj":"note-preview-description",id:"note-preview-description",timestamp:c.updated?o.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(c.updated)}):Object(m.e)(),children:o.a.createElement(i.EuiText,{size:"s"},c.description),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=c.updatedBy?c.updatedBy:"?",size:"l"}),actions:null}]:[]),[c,n,l]),b=Object(s.useMemo)((()=>Object(a.uniqBy)("savedObjectId",t).map((t=>{var a,s,l;const u=null!=e?Object.entries(e).reduce(((e,[n,a])=>{var i;return a.includes(null!==(i=t.noteId)&&void 0!==i?i:"")?n:e}),null):null!==(a=t.eventId)&&void 0!==a?a:null;return{"data-test-subj":`note-preview-${t.savedObjectId}`,username:Object(m.a)(t.updatedBy),event:h,timestamp:t.updated?o.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(t.updated)}):Object(m.e)(),children:o.a.createElement("div",{className:g.a,tabIndex:0},o.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyUserAddedANote"},o.a.createElement("p",null,`${null!==(s=t.updatedBy)&&void 0!==s?s:E} ${h}`)),o.a.createElement(p.b,null,null!==(l=t.note)&&void 0!==l?l:"")),actions:o.a.createElement(N,{eventId:u,timelineId:n,noteId:t.savedObjectId}),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=t.updatedBy?t.updatedBy:"?",size:"l"})}}))),[e,t,n]);return o.a.createElement(i.EuiCommentList,{"data-test-subj":"note-comment-list",comments:[...d,...b]})}));R.displayName="NotePreviews"},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(45),i=n(2);const r={pageName:n(129).a.noPage,detailName:void 0,tabName:void 0,search:"",pathName:"/",state:void 0},s=Object(i.createContext)([r,()=>a.noop])},,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(766);Object.defineProperty(t,"createMemo",{enumerable:!0,get:function(){return a.default}});var i=n(767);Object.defineProperty(t,"createReducerContext",{enumerable:!0,get:function(){return i.default}});var r=n(768);Object.defineProperty(t,"createReducer",{enumerable:!0,get:function(){return r.default}});var s=n(769);Object.defineProperty(t,"createStateContext",{enumerable:!0,get:function(){return s.default}});var o=n(407);Object.defineProperty(t,"useAsync",{enumerable:!0,get:function(){return o.default}});var l=n(419);Object.defineProperty(t,"useAsyncFn",{enumerable:!0,get:function(){return l.default}});var u=n(770);Object.defineProperty(t,"useAsyncRetry",{enumerable:!0,get:function(){return u.default}});var c=n(771);Object.defineProperty(t,"useAudio",{enumerable:!0,get:function(){return c.default}});var d=n(773);Object.defineProperty(t,"useBattery",{enumerable:!0,get:function(){return d.default}});var m=n(775);Object.defineProperty(t,"useBeforeUnload",{enumerable:!0,get:function(){return m.default}});var p=n(776);Object.defineProperty(t,"useBoolean",{enumerable:!0,get:function(){return p.default}});var f=n(777);Object.defineProperty(t,"useClickAway",{enumerable:!0,get:function(){return f.default}});var b=n(778);Object.defineProperty(t,"useCookie",{enumerable:!0,get:function(){return b.default}});var g=n(780);Object.defineProperty(t,"useCopyToClipboard",{enumerable:!0,get:function(){return g.default}});var v=n(501);Object.defineProperty(t,"useCounter",{enumerable:!0,get:function(){return v.default}});var y=n(781);Object.defineProperty(t,"useCss",{enumerable:!0,get:function(){return y.default}});var h=n(375);Object.defineProperty(t,"useCustomCompareEffect",{enumerable:!0,get:function(){return h.default}});var j=n(787);Object.defineProperty(t,"useDebounce",{enumerable:!0,get:function(){return j.default}});var E=n(664);Object.defineProperty(t,"useDeepCompareEffect",{enumerable:!0,get:function(){return E.default}});var O=n(788);Object.defineProperty(t,"useDefault",{enumerable:!0,get:function(){return O.default}});var x=n(789);Object.defineProperty(t,"useDrop",{enumerable:!0,get:function(){return x.default}});var S=n(790);Object.defineProperty(t,"useDropArea",{enumerable:!0,get:function(){return S.default}});var k=n(256);Object.defineProperty(t,"useEffectOnce",{enumerable:!0,get:function(){return k.default}});var w=n(791);Object.defineProperty(t,"useEnsuredForwardedRef",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"ensuredForwardRef",{enumerable:!0,get:function(){return w.ensuredForwardRef}});var C=n(302);Object.defineProperty(t,"useEvent",{enumerable:!0,get:function(){return C.default}});var T=n(792);Object.defineProperty(t,"useError",{enumerable:!0,get:function(){return T.default}});var M=n(793);Object.defineProperty(t,"useFavicon",{enumerable:!0,get:function(){return M.default}});var I=n(794);Object.defineProperty(t,"useFullscreen",{enumerable:!0,get:function(){return I.default}});var A=n(796);Object.defineProperty(t,"useGeolocation",{enumerable:!0,get:function(){return A.default}});var P=n(502);Object.defineProperty(t,"useGetSet",{enumerable:!0,get:function(){return P.default}});var _=n(797);Object.defineProperty(t,"useGetSetState",{enumerable:!0,get:function(){return _.default}});var D=n(798);Object.defineProperty(t,"useHarmonicIntervalFn",{enumerable:!0,get:function(){return D.default}});var F=n(800);Object.defineProperty(t,"useHover",{enumerable:!0,get:function(){return F.default}});var N=n(503);Object.defineProperty(t,"useHoverDirty",{enumerable:!0,get:function(){return N.default}});var R=n(801);Object.defineProperty(t,"useIdle",{enumerable:!0,get:function(){return R.default}});var z=n(803);Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return z.default}});var L=n(804);Object.defineProperty(t,"useInterval",{enumerable:!0,get:function(){return L.default}});var B=n(40);Object.defineProperty(t,"useIsomorphicLayoutEffect",{enumerable:!0,get:function(){return B.default}});var q=n(504);Object.defineProperty(t,"useKey",{enumerable:!0,get:function(){return q.default}});var $=n(805);Object.defineProperty(t,"createBreakpoint",{enumerable:!0,get:function(){return $.default}});var V=n(505);Object.defineProperty(t,"useKeyPress",{enumerable:!0,get:function(){return V.default}});var U=n(806);Object.defineProperty(t,"useKeyPressEvent",{enumerable:!0,get:function(){return U.default}});var H=n(506);Object.defineProperty(t,"useLatest",{enumerable:!0,get:function(){return H.default}});var G=n(507);Object.defineProperty(t,"useLifecycles",{enumerable:!0,get:function(){return G.default}});var Q=n(508);Object.defineProperty(t,"useList",{enumerable:!0,get:function(){return Q.default}});var W=n(807);Object.defineProperty(t,"useLocalStorage",{enumerable:!0,get:function(){return W.default}});var K=n(808);Object.defineProperty(t,"useLocation",{enumerable:!0,get:function(){return K.default}});var Y=n(809);Object.defineProperty(t,"useLockBodyScroll",{enumerable:!0,get:function(){return Y.default}});var X=n(810);Object.defineProperty(t,"useLogger",{enumerable:!0,get:function(){return X.default}});var J=n(811);Object.defineProperty(t,"useLongPress",{enumerable:!0,get:function(){return J.default}});var Z=n(705);Object.defineProperty(t,"useMap",{enumerable:!0,get:function(){return Z.default}});var ee=n(812);Object.defineProperty(t,"useMedia",{enumerable:!0,get:function(){return ee.default}});var te=n(813);Object.defineProperty(t,"useMediaDevices",{enumerable:!0,get:function(){return te.default}});var ne=n(814);Object.defineProperty(t,"useMediatedState",{enumerable:!0,get:function(){return ne.useMediatedState}});var ae=n(815);Object.defineProperty(t,"useMethods",{enumerable:!0,get:function(){return ae.default}});var ie=n(816);Object.defineProperty(t,"useMotion",{enumerable:!0,get:function(){return ie.default}});var re=n(509);Object.defineProperty(t,"useMount",{enumerable:!0,get:function(){return re.default}});var se=n(207);Object.defineProperty(t,"useMountedState",{enumerable:!0,get:function(){return se.default}});var oe=n(510);Object.defineProperty(t,"useMouse",{enumerable:!0,get:function(){return oe.default}});var le=n(817);Object.defineProperty(t,"useMouseHovered",{enumerable:!0,get:function(){return le.default}});var ue=n(818);Object.defineProperty(t,"useMouseWheel",{enumerable:!0,get:function(){return ue.default}});var ce=n(819);Object.defineProperty(t,"useNetwork",{enumerable:!0,get:function(){return ce.default}});var de=n(820);Object.defineProperty(t,"useNumber",{enumerable:!0,get:function(){return de.default}});var me=n(11);Object.defineProperty(t,"useObservable",{enumerable:!0,get:function(){return me.default}});var pe=n(821);Object.defineProperty(t,"useOrientation",{enumerable:!0,get:function(){return pe.default}});var fe=n(822);Object.defineProperty(t,"usePageLeave",{enumerable:!0,get:function(){return fe.default}});var be=n(823);Object.defineProperty(t,"usePermission",{enumerable:!0,get:function(){return be.default}});var ge=n(235);Object.defineProperty(t,"usePrevious",{enumerable:!0,get:function(){return ge.default}});var ve=n(824);Object.defineProperty(t,"usePreviousDistinct",{enumerable:!0,get:function(){return ve.default}});var ye=n(825);Object.defineProperty(t,"usePromise",{enumerable:!0,get:function(){return ye.default}});var he=n(826);Object.defineProperty(t,"useQueue",{enumerable:!0,get:function(){return he.default}});var je=n(511);Object.defineProperty(t,"useRaf",{enumerable:!0,get:function(){return je.default}});var Ee=n(827);Object.defineProperty(t,"useRafLoop",{enumerable:!0,get:function(){return Ee.default}});var Oe=n(257);Object.defineProperty(t,"useRafState",{enumerable:!0,get:function(){return Oe.default}});var xe=n(828);Object.defineProperty(t,"useSearchParam",{enumerable:!0,get:function(){return xe.default}});var Se=n(829);Object.defineProperty(t,"useScratch",{enumerable:!0,get:function(){return Se.default}});var ke=n(835);Object.defineProperty(t,"useScroll",{enumerable:!0,get:function(){return ke.default}});var we=n(836);Object.defineProperty(t,"useScrolling",{enumerable:!0,get:function(){return we.default}});var Ce=n(837);Object.defineProperty(t,"useSessionStorage",{enumerable:!0,get:function(){return Ce.default}});var Te=n(255);Object.defineProperty(t,"useSetState",{enumerable:!0,get:function(){return Te.default}});var Me=n(838);Object.defineProperty(t,"useShallowCompareEffect",{enumerable:!0,get:function(){return Me.default}});var Ie=n(840);Object.defineProperty(t,"useSize",{enumerable:!0,get:function(){return Ie.default}});var Ae=n(841);Object.defineProperty(t,"useSlider",{enumerable:!0,get:function(){return Ae.default}});var Pe=n(842);Object.defineProperty(t,"useSpeech",{enumerable:!0,get:function(){return Pe.default}});var _e=n(843);Object.defineProperty(t,"useStartTyping",{enumerable:!0,get:function(){return _e.default}});var De=n(844);Object.defineProperty(t,"useStateWithHistory",{enumerable:!0,get:function(){return De.useStateWithHistory}});var Fe=n(845);Object.defineProperty(t,"useStateList",{enumerable:!0,get:function(){return Fe.default}});var Ne=n(846);Object.defineProperty(t,"useThrottle",{enumerable:!0,get:function(){return Ne.default}});var Re=n(847);Object.defineProperty(t,"useThrottleFn",{enumerable:!0,get:function(){return Re.default}});var ze=n(848);Object.defineProperty(t,"useTimeout",{enumerable:!0,get:function(){return ze.default}});var Le=n(376);Object.defineProperty(t,"useTimeoutFn",{enumerable:!0,get:function(){return Le.default}});var Be=n(849);Object.defineProperty(t,"useTitle",{enumerable:!0,get:function(){return Be.default}});var qe=n(500);Object.defineProperty(t,"useToggle",{enumerable:!0,get:function(){return qe.default}});var $e=n(850);Object.defineProperty(t,"useTween",{enumerable:!0,get:function(){return $e.default}});var Ve=n(303);Object.defineProperty(t,"useUnmount",{enumerable:!0,get:function(){return Ve.default}});var Ue=n(851);Object.defineProperty(t,"useUnmountPromise",{enumerable:!0,get:function(){return Ue.default}});var He=n(223);Object.defineProperty(t,"useUpdate",{enumerable:!0,get:function(){return He.default}});var Ge=n(254);Object.defineProperty(t,"useUpdateEffect",{enumerable:!0,get:function(){return Ge.default}});var Qe=n(852);Object.defineProperty(t,"useUpsert",{enumerable:!0,get:function(){return Qe.default}});var We=n(853);Object.defineProperty(t,"useVibrate",{enumerable:!0,get:function(){return We.default}});var Ke=n(854);Object.defineProperty(t,"useVideo",{enumerable:!0,get:function(){return Ke.default}});var Ye=n(855);Object.defineProperty(t,"useStateValidator",{enumerable:!0,get:function(){return Ye.default}});var Xe=n(856);Object.defineProperty(t,"useScrollbarWidth",{enumerable:!0,get:function(){return Xe.useScrollbarWidth}});var Je=n(858);Object.defineProperty(t,"useMultiStateValidator",{enumerable:!0,get:function(){return Je.useMultiStateValidator}});var Ze=n(859);Object.defineProperty(t,"useWindowScroll",{enumerable:!0,get:function(){return Ze.default}});var et=n(860);Object.defineProperty(t,"useWindowSize",{enumerable:!0,get:function(){return et.default}});var tt=n(861);Object.defineProperty(t,"useMeasure",{enumerable:!0,get:function(){return tt.default}});var nt=n(862);Object.defineProperty(t,"useRendersCount",{enumerable:!0,get:function(){return nt.useRendersCount}});var at=n(300);Object.defineProperty(t,"useFirstMountState",{enumerable:!0,get:function(){return at.useFirstMountState}});var it=n(863);Object.defineProperty(t,"useSet",{enumerable:!0,get:function(){return it.default}});var rt=n(864);Object.defineProperty(t,"createGlobalState",{enumerable:!0,get:function(){return rt.createGlobalState}});var st=n(865);Object.defineProperty(t,"useHash",{enumerable:!0,get:function(){return st.useHash}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],r=t[1],s=i.useMemo((function(){return{set:function(e,t){r((function(n){var i;return a.__assign(a.__assign({},n),((i={})[e]=t,i))}))},setAll:function(e){r(e)},remove:function(e){r((function(t){var n=t,i=e;return n[i],a.__rest(n,["symbol"==typeof i?i:i+""])}))},reset:function(){return r(e)}}}),[r]),o=a.__assign({get:i.useCallback((function(e){return n[e]}),[n])},s);return[n,o]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=Object(a.createContext)(null)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(49),r=n(20),s=n(116),o=n(121),l=n(110);const u=()=>{const{indicesExist:e,dataViewId:t}=Object(o.d)(s.SourcererScopeName.timeline),n=Object(l.i)().services.application.capabilities.siem.show,u=Object(a.useMemo)((()=>n&&(e||null===t)),[e,t,n]);return Object(a.useCallback)((e=>{return!!u&&(t=e,!Object(r.c)().map((e=>e.path)).find((e=>Object(i.matchPath)(t,e))));var t}),[u])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(17),i=n(45),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(113),c=n(393),d=n(162),m=n(132),p=n(126),f=n(296),b=n(125);const g=l()(a.EuiFlexItem).withConfig({displayName:"TimelineContentItem",componentId:"sc-t3gz96-0"})(["max-width:calc(100% - 56px);"]),v=l()(a.EuiFilterButton).withConfig({displayName:"StyledEuiFilterButton",componentId:"sc-t3gz96-1"})(["border-top:0;border-bottom:0;"]),y=({hideUntitled:e=!1,getSelectableOptions:t,onClosePopover:n,onTimelineChange:o,timelineType:l,placeholder:y})=>{const[h,j]=Object(r.useState)(50),[E,O]=Object(r.useState)(0),[x,S]=Object(r.useState)(""),[k,w]=Object(r.useState)(!1),{fetchAllTimeline:C,timelines:T,loading:M,totalCount:I}=Object(c.b)(),A=Object(r.useRef)(null),P=Object(r.useRef)(null),_=Object(r.useMemo)((()=>Object(i.debounce)(500,S)),[]),D=Object(r.useCallback)((e=>{_(e)}),[_]),F=Object(r.useCallback)((()=>{w(!k)}),[k]),N=Object(r.useCallback)(((e,t,n)=>{if(e<t&&A.current&&P.current){const e=A.current.clientHeight,t=P.current.clientHeight;n>10&&t-n<1.2*e&&t>E&&(O(t),j(h+50))}}),[E,h]),R=Object(r.useCallback)(((e,t)=>{const n=Object(d.f)({...e,title:e.timelineTitle})?m.ab:e.timelineTitle,r=null!=e.description&&e.description.trim().length>0?e.description:null;return s.a.createElement(a.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiIcon,{type:"on"===e.checked?"check":"empty",color:"primary"})),s.a.createElement(g,{grow:!0},s.a.createElement(a.EuiFlexGroup,{gutterSize:"none",direction:"column",responsive:!1},s.a.createElement(a.EuiFlexItem,{"data-test-subj":"timeline"},s.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate eui-alignMiddle"},s.a.createElement(a.EuiHighlight,{search:t},n))),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(a.EuiToolTip,{content:r,anchorClassName:"eui-textTruncate eui-alignMiddle"},s.a.createElement(a.EuiTextColor,{color:"subdued",component:"span"},s.a.createElement("small",null,null!=r?r:Object(p.d)())))))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiIcon,{type:null!=e.favorite&&Object(i.isEmpty)(e.favorite)?"starEmpty":"starFilled"})))}),[]),z=Object(r.useCallback)((e=>{const t=e.filter((e=>"on"===e.checked));var a;null!=t&&t.length>0&&o(Object(i.isEmpty)(t[0].timelineTitle)?m.ab:t[0].timelineTitle,"-1"===t[0].id?null:t[0].id,null!==(a=t[0].graphEventId)&&void 0!==a?a:""),n()}),[n,o]),L=Object(r.useCallback)(((e,t)=>s.a.createElement(s.a.Fragment,null,t,e)),[]),B=Object(r.useMemo)((()=>({"data-test-subj":"timeline-super-select-search-box",placeholder:null!=y?y:f.e(l),onSearch:D,incremental:!1,append:s.a.createElement(v,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:k,onClick:F},m.D)})),[F,D,k,l,y]),q=Object(r.useMemo)((()=>({rowHeight:50,showIcons:!1,windowProps:{onScroll:({scrollOffset:t})=>N((null!=T?T:[]).filter((t=>!e||""!==t.title)).length,I,t),outerRef:A,innerRef:P}})),[N,e,I,T]);return Object(r.useEffect)((()=>{C({pageInfo:{pageIndex:1,pageSize:h},search:x,sort:{sortField:u.f.updated,sortOrder:b.b.desc},onlyUserFavorite:k,status:null,timelineType:l})}),[C,k,h,x,l]),s.a.createElement(a.EuiSelectable,{"data-test-subj":"selectable-input",height:260,isLoading:M&&null==T,listProps:q,renderOption:R,onChange:z,searchable:!0,searchProps:B,singleSelection:!0,options:($=t({timelines:null!=T?T:[],onlyFavorites:k,searchTimelineValue:x,timelineType:l}),$.map((({title:e,...t})=>({...t,title:void 0,timelineTitle:e}))))},L);var $},h=Object(r.memo)(y)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.alertsView.osqueryAlertTitle",{defaultMessage:"Run Osquery"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.dragAndDrop.copyToClipboardTooltip",{defaultMessage:"Copy to Clipboard"}),r=a.i18n.translate("xpack.securitySolution.dragAndDrop.draggableKeyboardInstructionsNotDraggingScreenReaderOnly",{defaultMessage:"Press enter for options, or press space to begin dragging."});a.i18n.translate("xpack.securitySolution.dragAndDrop.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dragAndDrop.closeButtonLabel",{defaultMessage:"Close"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return h}));var a=n(45),i=n(2),r=n(48),s=n(5),o=n(172),l=n(14),u=n(117),c=n(121),d=n(149),m=n(162),p=n(203),f=n(145),b=n(712),g=n(116);const v="createRuleFromTimeline",y="createRuleFromEql",h=e=>{const t=Object(r.useDispatch)(),{addError:n}=Object(u.a)(),{browserFields:h,dataViewId:j,selectedPatterns:E}=Object(c.d)(g.SourcererScopeName.timeline),O=Object(i.useRef)(!1),[x,S]=Object(i.useState)(null),[k,w]=Object(i.useState)(!1),C=Object(i.useCallback)((e=>{w(!0),S(e),e.dataViewId===j||Object(a.isEmpty)(e.indexNames)||t(d.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:e.dataViewId,selectedPatterns:e.indexNames}))}),[j,t]),[T]=Object(i.useState)({dataViewId:j,selectedPatterns:E}),M=Object(i.useMemo)((()=>null==x||Object(a.isEmpty)(h)||null!==x.dataViewId&&null!==j&&j!==x.dataViewId?null:h),[h,j,x]),I=Object(p.f)(v),A=Object(i.useMemo)(I,[I]),P=Object(p.f)(y),_=Object(i.useMemo)(P,[P]),D=Object(i.useCallback)((()=>{if(null!=x&&null!=M){try{const t=()=>{var e,t,n,a,i,r,s;return{dataProviders:null!=x.dataProviders&&x.dataProviders.length>0?Object(o.f)(Object(f.g)(x.dataProviders,M),{fields:[],title:E.join(",")}):"",query:{query:null!==(e=null===(t=x.kqlQuery.filterQuery)||void 0===t||null===(n=t.kuery)||void 0===n?void 0:n.expression)&&void 0!==e?e:"",language:null!==(a=null===(i=x.kqlQuery.filterQuery)||void 0===i||null===(r=i.kuery)||void 0===r?void 0:r.kind)&&void 0!==a?a:"kuery"},filters:null!==(s=x.filters)&&void 0!==s?s:[],eqlOptions:{}}},n=()=>{var e;return{dataProviders:"",query:{query:null!==(e=x.eqlOptions.query)&&void 0!==e?e:"",language:"eql"},filters:[],eqlOptions:{eqlOptions:x.eqlOptions}}},a=O.current?n():t();w(!1),e({index:E,queryBar:{filters:""!==a.dataProviders?[...a.filters,Object(b.b)(a.dataProviders)]:a.filters,query:a.query,saved_id:null},...a.eqlOptions})}catch(e){w(!1),n(e,{toastMessage:s.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.toastMessage",{defaultMessage:"Failed to create rule from timeline with id: {id}",values:{id:x.id}}),title:s.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.title",{defaultMessage:"Failed to import rule from timeline"})})}O.current=!1,T.dataViewId!==j&&t(d.a.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:T.dataViewId,selectedPatterns:T.selectedPatterns}))}}),[n,j,t,T.dataViewId,T.selectedPatterns,M,E,x,e]);Object(i.useEffect)((()=>{null!=M&&D()}),[D,M]);const F=Object(i.useCallback)((e=>{null!=x&&e===x.id||Object(m.h)({timelineId:e,onOpenTimeline:C,updateIsLoading:({id:e,isLoading:n})=>t(Object(l.updateIsLoading)({id:e,isLoading:n})),updateTimeline:Object(m.b)(t)})}),[t,C,x]),[N,R]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{if(!N){let e=null;null!=A?e=A:null!=_&&(e=_,O.current=!0),null!=e&&(R(!0),F(e),w(!0))}}),[F,A,_,N]),{loading:k,onOpenTimeline:C}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return k}));var a=n(45),i=n(2),r=n.n(i),s=n(48),o=n(3),l=n(136),u=n.n(l),c=n(53),d=n(517),m=n.n(d),p=n(119),f=n(121),b=n(116),g=n(172),v=n(560),y=n(757),h=n(145),j=n(118);const E=m.a.div`
  /*
  *
  * hide search bar default filters as they are disturbing the layout  as shown below
  *
  * Filters are displayed with QueryBar so below is how is the layout with default filters.
  *
  *
  *                    --------------------------------
  *   -----------------|                              |------------
  *   | DataViewPicker |        QueryBar              | Date      |
  *   -------------------------------------------------------------
  *                    |      Filters                 |
  *                    --------------------------------
  *
  * The tree under this component makes sure that default filters are not rendered and we can separately display
  * them outside query component so that layout is as below:
  *
  *   -----------------------------------------------------------
  *   | DataViewPicker |      QueryBar              |   Date    |
  *   -----------------------------------------------------------
  *   |                       Filters                           |
  *   -----------------------------------------------------------
  *
  * */
  .uniSearchBar .filter-items-group {
    display: none;
  }

  .euiDataGrid__restrictBody & {
    .kbnQueryBar {
      display: flex;
    }
  }
`,O="timeline-filter-drop-area",x=(e=[])=>e.filter((e=>e.meta.controlledBy!==O)),S=Object(i.memo)((({dataProviders:e,filters:t,filterManager:n,filterQuery:a,from:l,fromStr:c,kqlMode:d,isRefreshPaused:m,savedQueryId:S,setFilters:w,setSavedQueryId:C,refreshInterval:T,timelineId:M,to:I,toStr:A,updateReduxTime:P})=>{const _=Object(s.useDispatch)(),[D,F]=Object(i.useState)(null!=c?c:new Date(l).toISOString()),[N,R]=Object(i.useState)(null!=A?A:new Date(I).toISOString()),{browserFields:z,indexPattern:L}=Object(f.d)(b.SourcererScopeName.timeline),[B,q]=Object(i.useState)(void 0),[$,V]=Object(i.useState)({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"}),[U,H]=Object(i.useState)(x(t)),[G,Q]=Object(i.useState)(Object(g.f)(Object(h.g)(e,z),L)),W=Object(v.a)(),K=Object(i.useCallback)(((e,t)=>_(j.a.applyKqlFilterQuery({id:M,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(g.f)(e,L)}}))),[_,L,M]);Object(i.useEffect)((()=>{let e=!0;const a=new o.Subscription;return n.setFilters(t),a.add(n.getUpdates$().subscribe({next:()=>{if(e){const e=x(n.getFilters());w(e),H(e)}}})),()=>{e=!1,a.unsubscribe()}}),[]),Object(i.useEffect)((()=>{const e=x(n.getFilters());u()(t,e)||n.setFilters(t)}),[t]),Object(i.useEffect)((()=>{V({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"})}),[a]),Object(i.useEffect)((()=>{Q(Object(g.f)(Object(h.g)(e,z),L))}),[e,z,L]),Object(i.useEffect)((()=>{null!=c&&null!=A?(F(c),R(A)):null!=l&&null!=I&&(F(new Date(l).toISOString()),R(new Date(I).toISOString()))}),[l,c,I,A]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=S&&null!=W)try{const n=await W.getSavedQuery(S);e&&null!=n&&q({...n,attributes:{...n.attributes,filters:x(t)}})}catch(e){q(void 0)}else e&&q(void 0)}(),()=>{e=!1}}),[S]);const Y=Object(i.useCallback)(((e,t)=>{if((null==a||null!=a&&a.expression!==e.query||a.kind!==e.language)&&K(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");P({id:p.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:M,hasRangeChanged:!0})}}),[a,M]),X=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==S&&C(e.id),null!=W&&""!==G){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===O)):-1;W.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),k(G),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,k(G)]:[]})}}else C(null)}),[G,S,W]);return r.a.createElement(E,{className:"search_bar_container"},r.a.createElement(y.a,{dateRangeFrom:D,dateRangeTo:N,hideSavedQuery:"search"===d,indexPattern:L,isRefreshPaused:m,filterQuery:$,filterManager:n,filters:U,onSubmitQuery:Y,refreshInterval:T,savedQuery:B,onSavedQuery:X,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"}))})),k=e=>{const t=JSON.parse(e),n=Object.keys(t);return{...t,meta:{alias:O,controlledBy:O,negate:!1,disabled:!1,type:"custom",key:Object(a.isEmpty)(n)?"bool":n[0],value:e},$state:{store:c.FilterStateStore.APP_STATE}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(17),i=n(2),r=n.n(i),s=n(44);const o=n.n(s)()((({iconSide:e,children:t,...n})=>r.a.createElement(a.EuiLink,n,t))).withConfig({displayName:"Link",componentId:"sc-z5mbxm-0"})(["",""],(({iconSide:e,theme:t})=>Object(s.css)(["align-items:center;display:inline-flex;vertical-align:top;white-space:nowrap;"," ",""],"left"===e&&Object(s.css)([".euiIcon{margin-right:",";}"],t.eui.euiSizeXS),"right"===e&&Object(s.css)(["flex-direction:row-reverse;.euiIcon{margin-left:",";}"],t.eui.euiSizeXS))));o.displayName="Link";const l=r.a.memo((({ariaLabel:e,children:t,color:n,dataTestSubj:s,disabled:l,href:u,iconSide:c="left",iconSize:d="s",iconType:m,onClick:p})=>{const f=Object(i.useCallback)((e=>"object"==typeof e&&null!=e&&"props"in e&&e.props&&e.props.children?f(e.props.children):null!=e&&Object.keys(e).length>0?e:""),[]),b=Object(i.useMemo)((()=>e||f(t)),[e,t,f]);return r.a.createElement(o,{className:"siemLinkIcon",color:n,"data-test-subj":s,disabled:l,href:u,iconSide:c,onClick:p,"aria-label":b},r.a.createElement(a.EuiIcon,{size:d,type:m}),r.a.createElement("span",{className:"siemLinkIcon__label"},t))}));l.displayName="LinkIcon"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>{const n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.click(),window.URL.revokeObjectURL(n),a.remove()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(17),i=n(47),r=n(56),s=n.n(r),o=n(2),l=n.n(o);const u=l.a.memo((({children:e,date:t,fieldName:n,className:r=""})=>l.a.createElement(a.EuiToolTip,{"data-test-subj":"localized-date-tool-tip",anchorClassName:r,content:l.a.createElement(a.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=n?l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement("span",{"data-test-subj":"field-name"},n)):null,l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(i.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:s.a.utc(t).toDate()})),l.a.createElement(a.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},s.a.utc(t).local().format("llll")),l.a.createElement(a.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},s()(t).format()))},l.a.createElement(l.a.Fragment,null,e))));u.displayName="LocalizedDateTooltip"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(44);const s=n.n(r).a.div.withConfig({displayName:"Wrapper",componentId:"sc-4ssvqk-0"})(["",""],(({theme:e})=>Object(r.css)([".siemSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));s.displayName="Wrapper";const o=i.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?i.a.createElement("p",{className:"siemSubtitle__item siemSubtitle__item--text","data-test-subj":t},e):i.a.createElement("div",{className:"siemSubtitle__item siemSubtitle__item--node","data-test-subj":t},e)));o.displayName="SubtitleItem";const l=i.a.memo((({items:e})=>i.a.createElement(s,{className:"siemSubtitle"},Array.isArray(e)?e.map(((e,t)=>i.a.createElement(o,{key:t},e))):i.a.createElement(o,null,e))));l.displayName="Subtitle"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5);const i=e=>e?a.i18n.translate("xpack.securitySolution.toggleQuery.on",{defaultMessage:"Open"}):a.i18n.translate("xpack.securitySolution.toggleQuery.off",{defaultMessage:"Closed"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(17),s=n(113),o=n(132),l=n(193);const u=({timelineType:e,elasticTemplateTimelineCount:t,customTemplateTimelineCount:n})=>{const[u,c]=Object(a.useState)(null),d=Object(a.useMemo)((()=>e===s.l.template),[e]),m=Object(a.useMemo)((()=>d?u:null),[u,d]),p=Object(a.useMemo)((()=>null==m?null:m===s.g.elastic?s.k.immutable:s.k.active),[m]),f=Object(a.useMemo)((()=>[{id:s.g.elastic,name:o.s,disabled:!d,withNext:!0,count:null!=t?t:void 0},{id:s.g.custom,name:o.r,disabled:!d,withNext:!1,count:null!=n?n:void 0}]),[n,t,d]),b=Object(a.useCallback)((e=>{c(u===e?null:e)}),[c,u]),g=Object(a.useMemo)((()=>d?f.map((e=>i.a.createElement(r.EuiFilterButton,{hasActiveFilters:e.id===m,key:`template-timeline-filter-${e.id}`,numFilters:e.count,onClick:b.bind(null,e.id),withNext:e.withNext,isDisabled:e.disabled,"data-test-subj":e.name},e.name))):null),[m,f,d,b]),v=Object(a.useCallback)((async()=>{m!==s.g.custom&&await Object(l.g)()}),[m]);return{timelineStatus:p,templateTimelineType:m,templateTimelineFilter:g,installPrepackagedTimelines:v}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(485),r=n(110);const s=()=>{const{conversations:e}=Object(i.a)(),{services:{telemetry:t}}=Object(r.i)(),n=Object(a.useCallback)((t=>{var n;return(null!==(n=e[t])&&void 0!==n?n:{isDefault:!1}).isDefault?t:"Custom"}),[e]),s=Object(a.useCallback)((({fn:e,params:{conversationId:t,...a}})=>e({...a,conversationId:n(t)})),[n]);return{reportAssistantInvoked:e=>s({fn:t.reportAssistantInvoked,params:e}),reportAssistantMessageSent:e=>s({fn:t.reportAssistantMessageSent,params:e}),reportAssistantQuickPrompt:e=>s({fn:t.reportAssistantQuickPrompt,params:e})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return c}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addedNoteToTimelineToast",{defaultMessage:"Added note to timeline"}),r=a.i18n.translate("xpack.securitySolution.assistant.commentActions.viewAPMTraceLabel",{defaultMessage:"View APM Trace for this message"}),s=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addMessageContentAsTimelineNoteAriaLabel",{defaultMessage:"Add message content as a timeline note"}),o=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addNoteToTimelineTooltip",{defaultMessage:"Add note to timeline"}),l=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addToCaseExistingCase",{defaultMessage:"Add to existing case"}),u=a.i18n.translate("xpack.securitySolution.assistant.commentActions.elasticAiAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),c=a.i18n.translate("xpack.securitySolution.assistant.commentActions.copyToClipboard",{defaultMessage:"Copy to clipboard"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return m})),n.d(t,"f",(function(){return p}));var a=n(57),i=n(122),r=n(422),s=n(353);const o=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:i.d.query})),l=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),u=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),c=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),m=()=>Object(a.createSelector)(r.selectNotesById,(e=>Object.values(e))),p=()=>Object(a.createSelector)(s.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=e=>{const[t,n]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const a=new MutationObserver((()=>{const a=!!document.getElementById(e);a&&!t&&n(!0),!a&&t&&n(!1)}));return a.observe(document.body,{childList:!0,subtree:!0}),()=>a.disconnect()}),[t,e]),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var a=n(23),i=n.n(a),r=n(62),s=n(61),o=n.n(s),l=n(2),u=n.n(l),c=n(44),d=n.n(c),m=n(17),p=n(54),f=n(4),b=n(594),g=n(229),v=n(546),y=n(172),h=n(110),j=n(484),E=n(230),O=n(384),x=n(129),S=n(164),k=n(319);const w=e=>({text:e,value:e}),C=d()(m.EuiButton).withConfig({displayName:"StyledLinkButton",componentId:"sc-11itwu1-0"})(["margin-left:0;@media only screen and (min-width:","){margin-left:",";}"],(e=>e.theme.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiSizeL)),T=({combinedQueries:e,deleteQuery:t,filters:n,from:a,headerChildren:s,indexPattern:c,indexNames:d,runtimeMappings:m,onlyField:T,paddingSize:M,query:I,queryType:A,setAbsoluteRangeDatePickerTarget:P,setQuery:_,showLegend:D,showSpacer:F=!0,scopeId:N,sourcererScopeId:R,to:z,toggleTopN:L,hideQueryToggle:B=!1})=>{const q=Object(l.useMemo)((()=>`eventsByDatasetOverview-${A}`),[A]);Object(l.useEffect)((()=>()=>{t&&t({id:q})}),[t,q]);const $=Object(h.i)(),{formatUrl:V,search:U}=Object(S.l)(x.a.hosts),{navigateToApp:H}=$.services.application,[G]=Object(h.o)(f.P),Q=Object(l.useCallback)((e=>{e.preventDefault(),H(f.l,{deepLinkId:x.a.hosts,path:Object(g.c)(E.HostsTableType.events,U)})}),[H,U]),W=Object(l.useMemo)((()=>u.a.createElement(C,{onClick:Q,href:V(Object(g.c)(E.HostsTableType.events))},O.o)),[Q,V]),[K,Y]=Object(l.useMemo)((()=>null==e?Object(y.i)({config:Object(p.getEsQueryConfig)($.services.uiSettings),indexPattern:c,queries:[I],filters:n}):[e]),[e,$,c,I,n]);Object(k.a)({id:q,filterQuery:K,kqlError:Y,query:I,startDate:a,endDate:z});const X=Object(l.useMemo)((()=>{var e;return{...j.b,stackByOptions:null!=T?[w(T)]:j.b.stackByOptions,defaultStackByOption:null!=T?w(T):null!==(e=j.c.find((e=>"event.dataset"===e.text)))&&void 0!==e?e:j.c[0],legendPosition:r.Position.Right,subtitle:e=>`${b.b}: ${o()(e).format(G)} ${Object(b.c)(e)}`,titleSize:null==T?"m":"s"}}),[T,G]),J=Object(l.useMemo)((()=>null==T||null!=s?u.a.createElement(u.a.Fragment,null,s,null==T&&W):null),[T,s,W]);return u.a.createElement(v.a,i()({endDate:z,filterQuery:K,headerChildren:J,id:q,indexNames:d,runtimeMappings:m,onError:L,paddingSize:M,setAbsoluteRangeDatePickerTarget:P,setQuery:_,showSpacer:F,showLegend:D,skip:void 0===K,startDate:a,scopeId:N,sourcererScopeId:R},X,{title:null!=T?O.l(T):X.title,chartHeight:160,hideQueryToggle:B}))};T.displayName="EventsByDatasetComponent";const M=u.a.memo(T)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(17),s=n(44),o=n.n(s),l=n(265),u=n(293);const c=o()(r.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1719m3x-0"})(["height:",";width:",";position:relative;margin:0;"],(({height:e})=>e||"100%"),(({width:e})=>e||"100%"));c.displayName="FlexGroup";const d=({height:e="100%",width:t="100%",data:n})=>i.a.createElement(c,{justifyContent:"center",alignItems:"center",height:e,width:t},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{size:"s",textAlign:"center",color:"subdued","data-test-subj":"chartHolderText"},Object(l.f)(n)?u.a:u.b)))},function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return d}));var a=n(5);const i=e=>a.i18n.translate("xpack.securitySolution.eventsTab.externalAlertsUnit",{values:{totalCount:e},defaultMessage:"external {totalCount, plural, =1 {alert} other {alerts}}"}),r=e=>a.i18n.translate("xpack.securitySolution.hosts.navigaton.eventsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"}),s=a.i18n.translate("xpack.securitySolution.eventsTab.showing",{defaultMessage:"Showing"}),o=a.i18n.translate("xpack.securitySolution.eventsTab.alertsGraphTitle",{defaultMessage:"External alert trend"}),l=a.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingAlertsData",{defaultMessage:"Failed to query alerts data"}),u=a.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingEventsData",{defaultMessage:"Failed to query events data"}),c=a.i18n.translate("xpack.securitySolution.eventsTab.showExternalAlerts",{defaultMessage:"Show only external alerts"}),d=a.i18n.translate("xpack.securitySolution.eventsGraphTitle",{defaultMessage:"Events"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return p}));var a=n(45),i=n(56),r=n.n(i),s=n(727);const o=[],l=e=>{var t,n,a;return(null!==(t=null==e||null===(n=e.aggregations)||void 0===n||null===(a=n.alertsByGrouping)||void 0===a?void 0:a.buckets)&&void 0!==t?t:[]).reduce(((e,{key_as_string:t,key:n,alerts:a})=>{var i;return[...e,...(null!==(i=a.buckets)&&void 0!==i?i:[]).map((({key:e,doc_count:a})=>({x:e,y:a,g:null!=t?t:n.toString()})))]}),o)},u=(e,t,n,a,i)=>({aggs:{alertsByGrouping:{terms:{field:e,order:{_count:"desc"},size:10},aggs:{alerts:{date_histogram:{field:"@timestamp",fixed_interval:`${Math.floor(r()(n).diff(r()(t))/32)}ms`,min_doc_count:0,extended_bounds:{min:t,max:n}}}}}},query:{bool:{filter:[...a,{range:{"@timestamp":{gte:t,lte:n}}}]}},runtime_mappings:i,_source:!1,size:0}),c=({isInitialLoading:e,isLoadingAlerts:t})=>e&&t,d=e=>{try{return null==e||Object(a.isEmpty)(e)?{}:JSON.parse(e)}catch{return{}}},m=e=>{try{return Object(a.isEmpty)(e)?[]:[d(e)]}catch{return[]}},p=({callback:e,order:t}={})=>({id:"resetGroupByField",getDisplayName:()=>s.b,getIconType:()=>"editorRedo",type:"actionButton",isCompatible:async()=>!0,async execute({embeddable:t}){null==e||e();const n=t.getInput(),{attributes:{state:{visualization:{columns:a}}}}=n;t.updateInput({...n,attributes:{...n.attributes,state:{...n.attributes.state,visualization:{...n.attributes.state.visualization,columns:a.map((e=>({...e,hidden:!1})))}}}})},order:t})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.inspectTitle",{defaultMessage:"Inspect"}),r=a.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.resetGroupByFieldsMenuItem",{defaultMessage:"Reset group by fields"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(328);const i=new Set([a.b.STRING,a.b.BOOLEAN,a.b.NUMBER,a.b.IP]),r=e=>!!e&&i.has(e)},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),r=n(17),s=n(47),o=n(63);const l={tall:490,short:250},u=Object(a.createContext)({tableId:null}),c=({height:e="tall"})=>i.a.createElement(r.EuiPanel,{color:"subdued"},i.a.createElement(r.EuiFlexGroup,{style:{height:l[e]},alignItems:"center",justifyContent:"center","data-test-subj":"loading-alerts-panel"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"})))),d={maxWidth:500},m=()=>{const{http:e}=Object(o.useKibana)().services;return i.a.createElement(r.EuiPanel,{color:"subdued","data-test-subj":"tGridEmptyState"},i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiPanel,{hasBorder:!0,style:d},i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(r.EuiTitle,null,i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.title",defaultMessage:"No results match your search criteria"}))),i.a.createElement("p",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiImage,{size:"200",alt:"",url:e.basePath.prepend("/plugins/timelines/assets/illustration_product_no_results_magnifying_glass.svg")})))))))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.isPlatinumOrTrialLicense},,,,,,,,function(e,t,n){"use strict";n.d(t,"c",(function(){return ge})),n.d(t,"b",(function(){return ve})),n.d(t,"a",(function(){return he}));var a=n(2),i=n.n(a),r=n(48),s=n(60),o=n(711),l=n(110),u=n(4),c=n(112),d=n(122),m=n(118),p=n(14),f=n(393),b=n(196),g=n(47),v=n(44),y=n.n(v),h=n(113),j=n(750),E=n(478),O=n(193),x=n(135),S=n(17),k=n(132),w=n(49),C=n(117),T=n(714);const M=({onComplete:e,isEnableDownloader:t,exportedIds:n})=>{const{tabName:i}=Object(w.useParams)(),{addSuccess:r}=Object(C.a)(),s=Object(a.useCallback)((t=>{null!=e&&e(),r({title:i===h.l.template?k.U(t):k.T(t),"data-test-subj":"addObjectToContainerSuccess"})}),[r,e,i]),o=Object(a.useCallback)((()=>{null!=e&&e()}),[e]);return Object(a.useEffect)((()=>{(async()=>{if(null!=n&&n.length&&t){const e=await Object(O.c)({ids:n});e instanceof Blob?(Object(T.a)(e,`${k.n}.ndjson`),s(n.length)):o()}})()}),[n,t]),null};M.displayName="ExportTimeline";const I=i.a.memo(M);var A=n(45);const P=i.a.memo((({title:e,closeModal:t,onDelete:n})=>{const{tabName:r}=Object(w.useParams)(),s=r===h.l.template?k.j:k.k,o=Object(a.useCallback)((()=>{const t=null!=e?e.trim():"",n=Object(A.isEmpty)(t)?k.ab:t;return i.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.open.timeline.deleteTimelineModalTitle",defaultMessage:'Delete "{title}"?',"data-test-subj":"title",values:{title:n}})}),[e]);return i.a.createElement(S.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:k.b,confirmButtonText:k.h,defaultFocusedButton:S.EUI_MODAL_CONFIRM_BUTTON,onCancel:t,onConfirm:n,title:o()},i.a.createElement("div",{"data-test-subj":"warning"},s))}));P.displayName="DeleteTimelineModal";const _=Object(v.createGlobalStyle)(["div[data-popover-open]{display:none;}"]),D=i.a.memo((({deleteTimelines:e,isModalOpen:t,savedObjectIds:n,title:r,onComplete:s,savedSearchIds:o})=>{const{addSuccess:l}=Object(C.a)(),{tabName:u}=Object(w.useParams)(),c=Object(a.useCallback)((()=>{null!=s&&s()}),[s]),d=Object(a.useCallback)((()=>{n.length>0&&null!=o&&o.length>0?(e(n,o),l({title:u===h.l.template?k.S(n.length):k.R(n.length)})):n.length>0&&(e(n),l({title:u===h.l.template?k.S(n.length):k.R(n.length)})),null!=s&&s()}),[e,n,s,l,u,o]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(_,{"data-test-subj":"remove-popover"}),t?i.a.createElement(S.EuiModal,{maxWidth:600,onClose:c},i.a.createElement(P,{"data-test-subj":"delete-timeline-modal",onDelete:d,title:r,closeModal:c})):null)}));D.displayName="DeleteTimelineModalOverlay";const F=({deleteTimelines:e,ids:t,savedSearchIds:n,isEnableDownloader:a,isDeleteTimelineModalOpen:r,onComplete:s,title:o})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(I,{"data-test-subj":"TimelineDownloader",exportedIds:t,isEnableDownloader:a,onComplete:s}),null!=e&&i.a.createElement(D,{"data-test-subj":"DeleteTimelineModalOverlay",deleteTimelines:e,isModalOpen:r,onComplete:s,savedObjectIds:t,savedSearchIds:n,title:o})),N=i.a.memo(F),R=()=>{const[e,t]=Object(a.useState)(null),[n,i]=Object(a.useState)(!1),[r,s]=Object(a.useState)(!1),o=Object(a.useCallback)((()=>{i(!1),t(null)}),[e]),l=Object(a.useCallback)((e=>{i(!0),null!=e&&t(e)}),[]),u=Object(a.useCallback)((e=>{s(!0),null!=e&&t(e)}),[]),c=Object(a.useCallback)((()=>{s(!1),t(null)}),[]);return{actionItem:e,onCompleteEditTimelineAction:Object(a.useCallback)((()=>{i(!1),s(!1),t(null)}),[]),isDeleteTimelineModalOpen:n,onCloseDeleteTimelineModal:o,onOpenDeleteTimelineModal:l,isEnableDownloader:r,enableExportTimelineDownloader:u,disableExportTimelineDownloader:c}},z=y.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-1dq1et8-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));z.displayName="SearchRowContainer";const L=y()(S.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-1dq1et8-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));L.displayName="SearchRowFlexGroup";const B=i.a.memo((({favoriteCount:e,onlyFavorites:t,onQueryChange:n,onToggleOnlyFavorites:r,children:s,timelineType:o})=>{const l=Object(a.useMemo)((()=>({placeholder:o===h.l.default?k.L:k.M,incremental:!1,"data-test-subj":"search-bar"})),[o]);return i.a.createElement(z,null,i.a.createElement(L,{gutterSize:"s"},i.a.createElement(S.EuiFlexItem,null,i.a.createElement(S.EuiSearchBar,{box:l,onChange:n})),i.a.createElement(S.EuiFlexItem,{grow:!1},i.a.createElement(S.EuiFilterGroup,{fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiFilterButton,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:t,onClick:r,numFilters:null!=e?e:void 0},k.D),!!s&&s)))))}));B.displayName="SearchRow";var q=n(23),$=n.n(q);const V=({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:a,onOpenTimeline:i,onCreateRule:r,onCreateRuleFromEql:s,hasCrudAccess:o})=>[{width:o?"80px":"150px",actions:[{name:k.g,icon:"timeline",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:h.l.default,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.g,"data-test-subj":"create-from-template",available:t=>t.timelineType===h.l.template&&e.includes("createFrom")},{name:k.f,icon:"visText",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:h.l.template,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.f,"data-test-subj":"create-template-from-timeline",available:t=>t.timelineType!==h.l.template&&e.includes("createFrom")},{name:k.E,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.E,"data-test-subj":"open-duplicate",available:t=>t.timelineType!==h.l.template&&e.includes("duplicate")},{name:k.F,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.F,"data-test-subj":"open-duplicate-template",available:t=>t.timelineType===h.l.template&&e.includes("duplicate")},{name:k.o,icon:"exportAction",onClick:e=>{null!=n&&n(e)},enabled:e=>null!=e.savedObjectId&&e.status!==h.k.immutable,description:k.o,"data-test-subj":"export-timeline",available:()=>e.includes("export")},{name:k.i,icon:"trash",onClick:e=>{null!=a&&a(e)},enabled:({savedObjectId:e,status:t})=>null!=e&&t!==h.k.immutable,description:k.i,"data-test-subj":"delete-timeline",available:()=>e.includes("delete")&&null!=t},{name:k.d,icon:"indexEdit",onClick:e=>{null!=r&&e.savedObjectId&&r(e.savedObjectId)},enabled:e=>null!=r&&null!=e.savedObjectId&&e.status!==h.k.immutable,description:k.d,"data-test-subj":"create-rule-from-timeline",available:({queryType:t})=>e.includes("createRule")&&null!=r&&null!=t&&t.hasQuery},{name:k.e,icon:"indexEdit",onClick:e=>{null!=s&&e.savedObjectId&&s(e.savedObjectId)},enabled:e=>null!=s&&null!=e.savedObjectId&&e.status!==h.k.immutable,description:k.d,"data-test-subj":"create-rule-from-eql",available:({queryType:t})=>e.includes("createRuleFromEql")&&null!=s&&null!=t&&t.hasEql}]}],U="45px";var H=n(162),G=n(697),Q=n(126),W=n(155);const K=y.a.span.withConfig({displayName:"LineClampTextContainer",componentId:"sc-4zme7l-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;"]),Y=({itemIdToExpandedNotesRowMap:e,onOpenTimeline:t,onToggleShowNotes:n,timelineType:a})=>[{isExpander:!0,render:({notes:t,savedObjectId:a})=>null!=t&&t.length>0&&null!=a?i.a.createElement(S.EuiButtonIcon,{"data-test-subj":"expand-notes",onClick:()=>null!=e[a]?n(Object(A.omit)(a,e)):n({...e,[a]:i.a.createElement(G.a,{notes:t})}),"aria-label":e[a]?k.c:k.m,iconType:e[a]?"arrowDown":"arrowRight"}):null,width:U},{dataType:"string",field:"title",name:a===h.l.default?k.Y:k.Z,render:(e,n)=>null!=n.savedObjectId?i.a.createElement(S.EuiLink,{"data-test-subj":`timeline-title-${n.savedObjectId}`,onClick:()=>t({duplicate:!1,timelineId:`${n.savedObjectId}`})},Object(H.f)(n)?k.ab:i.a.createElement(K,null,e)):i.a.createElement("div",{"data-test-subj":`title-no-saved-object-id-${e||"no-title"}`},Object(H.f)(n)?k.ab:e),sortable:!1},{dataType:"string",field:"description",name:k.l,render:e=>i.a.createElement(K,{"data-test-subj":"description"},null!=e&&e.trim().length>0?e:Object(Q.d)()),sortable:!1},{dataType:"date",field:"updated",name:k.y,render:(e,t)=>i.a.createElement("div",{"data-test-subj":"updated"},null!=t.updated?i.a.createElement(W.b,{value:e}):Object(Q.d)()),sortable:!0}],X=e=>e?[{dataType:"string",field:"updatedBy",name:k.B,render:e=>i.a.createElement("div",{"data-test-subj":"username"},Object(Q.a)(e)),sortable:!1}]:[],J=({timelineType:e})=>{const t={note:{align:"center",field:"eventIdToNoteIds",name:i.a.createElement(S.EuiToolTip,{content:k.C},i.a.createElement(S.EuiIcon,{"data-test-subj":"notes-count-header-icon",size:"m",type:"editorComment"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"notes-count"},Object(H.d)(t)),sortable:!1,width:U},pinnedEvent:{align:"center",field:"pinnedEventIds",name:i.a.createElement(S.EuiToolTip,{content:k.J},i.a.createElement(S.EuiIcon,{"data-test-subj":"pinned-event-header-icon",size:"m",type:"pin"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"pinned-event-count"},`${Object(H.e)(t)}`),sortable:!1,width:U},favorite:{align:"center",field:"favorite",name:i.a.createElement(S.EuiToolTip,{content:k.p},i.a.createElement(S.EuiIcon,{"data-test-subj":"favorites-header-icon",size:"m",type:"starEmpty"})),render:e=>{const t=null!=e&&e.length>0?"starFilled":"starEmpty";return i.a.createElement(S.EuiIcon,{"data-test-subj":`favorite-${t}-star`,type:t,size:"m"})},sortable:!1,width:U}},n=[t.note,t.favorite],a=[t.pinnedEvent,t.note,t.favorite];return e===h.l.template?n:a},Z=S.EuiBasicTable,ee=y()(Z).withConfig({displayName:"BasicTable",componentId:"sc-1yfhyq7-0"})([".euiTableCellContent{animation:none;}.euiTableRow-isExpandedRow .euiTableCellContent__text{width:100%;}"]);ee.displayName="BasicTable";const te=i.a.memo((({actionTimelineToShow:e,deleteTimelines:t,defaultPageSize:n,loading:r,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:o,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:c,onOpenTimeline:d,onSelectionChange:m,onTableChange:p,onToggleShowNotes:f,pageIndex:b,pageSize:g,searchResults:v,showExtendedColumns:y,sortField:j,sortDirection:E,tableRef:O,timelineType:S,totalSearchResultsCount:w})=>{const C={showPerPageOptions:y,pageIndex:b,pageSize:g,pageSizeOptions:[Math.floor(Math.max(n,1)/2),n,2*n],totalItemCount:w},T={sort:{field:j,direction:E}},M={selectable:e=>null!=e.savedObjectId&&e.status!==h.k.immutable,selectableMessage:e=>e?void 0:k.A,onSelectionChange:m},I=null!=O?{ref:O}:{},{kibanaSecuritySolutionsPrivileges:A}=Object(x.a)(),P=Object(a.useMemo)((()=>(({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,itemIdToExpandedNotesRowMap:a,onCreateRule:i,onCreateRuleFromEql:r,onOpenDeleteTimelineModal:s,onOpenTimeline:o,onToggleShowNotes:l,showExtendedColumns:u,timelineType:c,hasCrudAccess:d})=>[...Y({itemIdToExpandedNotesRowMap:a,onOpenTimeline:o,onToggleShowNotes:l,timelineType:c}),...X(u),...J({timelineType:c}),...e.length?V({onCreateRule:i,onCreateRuleFromEql:r,actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:s,onOpenTimeline:o,hasCrudAccess:d}):[]])({actionTimelineToShow:e,deleteTimelines:t,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:o,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:c,onOpenTimeline:d,onSelectionChange:m,onToggleShowNotes:f,showExtendedColumns:y,timelineType:S,hasCrudAccess:A.crud})),[e,t,s,o,l,u,c,d,m,f,y,S,A]),_=r||null==v?k.z:S===h.l.template?k.db:k.cb;return i.a.createElement(ee,$()({columns:P,"data-test-subj":"timelines-table",isExpandable:!0,isSelectable:e.includes("selectable"),itemId:"savedObjectId",itemIdToExpandedRowMap:s,items:null!=v?v:[],loading:r,noItemsMessage:_,onChange:p,pagination:C,selection:e.includes("selectable")?M:void 0,sorting:T},I))}));te.displayName="TimelinesTable";const ne=y.a.span.withConfig({displayName:"QueryText",componentId:"sc-1qxahey-0"})(["white-space:normal;word-break:break-word;"]),ae=i.a.memo((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,isLoading:r,itemIdToExpandedNotesRowMap:s,importDataModalToggle:o,onCreateRule:l,onCreateRuleFromEql:u,onDeleteSelected:c,onlyFavorites:d,onOpenTimeline:m,onQueryChange:p,onSelectionChange:f,onTableChange:b,onToggleOnlyFavorites:v,onToggleShowNotes:y,pageIndex:w,pageSize:C,query:T,refetch:M,searchResults:I,selectedItems:A,sortDirection:P,setImportDataModalToggle:_,sortField:D,timelineType:F=h.l.default,timelineStatus:z,timelineFilter:L,templateTimelineFilter:q,totalSearchResultsCount:$})=>{var V;const U=Object(a.useRef)(),{actionItem:G,enableExportTimelineDownloader:Q,isEnableDownloader:W,isDeleteTimelineModalOpen:K,onOpenDeleteTimelineModal:Y,onCompleteEditTimelineAction:X}=R(),{kibanaSecuritySolutionsPrivileges:J}=Object(x.a)(),{getBatchItemsPopoverContent:Z}=(({deleteTimelines:e,selectedItems:t,tableRef:n,timelineType:r=h.l.default})=>{const{enableExportTimelineDownloader:s,disableExportTimelineDownloader:o,isEnableDownloader:l,isDeleteTimelineModalOpen:u,onOpenDeleteTimelineModal:c,onCloseDeleteTimelineModal:d}=R(),m=Object(a.useCallback)((e=>{null!=e&&e(),null!=n&&null!=n.current&&n.current.changeSelection([]),o(),d()}),[o,d,n]),{timelineIds:p,searchIds:f}=Object(a.useMemo)((()=>null!=t?ve(ge(t)):{timelineIds:[],searchIds:void 0}),[t]),b=Object(a.useCallback)((()=>s()),[s]),g=Object(a.useCallback)((()=>c()),[c]),v=Object(a.useCallback)((n=>{var a,s,o,c;const d=null==t||0===t.length,v=[];return t&&v.push(i.a.createElement(S.EuiContextMenuItem,{"data-test-subj":"export-timeline-action",disabled:d,icon:"exportAction",key:"ExportItemKey",onClick:b},k.o)),e&&v.push(i.a.createElement(S.EuiContextMenuItem,{"data-test-subj":"delete-timeline-action",disabled:d,icon:"trash",key:"DeleteItemKey",onClick:g},k.i)),i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{deleteTimelines:e,ids:p,savedSearchIds:f,isEnableDownloader:l,isDeleteTimelineModalOpen:u,onComplete:m.bind(null,n),title:1!==(null==t?void 0:t.length)?r===h.l.template?k.N(null!==(a=null==t?void 0:t.length)&&void 0!==a?a:0):k.O(null!==(s=null==t?void 0:t.length)&&void 0!==s?s:0):null!==(o=null===(c=t[0])||void 0===c?void 0:c.title)&&void 0!==o?o:""}),i.a.createElement(S.EuiContextMenuPanel,{items:v}))}),[t,e,p,f,l,u,m,r,b,g]);return{onCompleteBatchActions:m,getBatchItemsPopoverContent:v}})({deleteTimelines:J.crud?e:void 0,selectedItems:A,tableRef:U,timelineType:F}),ee=Object(a.useMemo)((()=>i.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTemplatesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {template} other {templates}} {with}",values:{totalSearchResultsCount:$,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},T.trim().length?`${k.bb} "${T.trim()}"`:"")}})),[$,T]),ae=Object(a.useMemo)((()=>i.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTimelinesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {timeline} other {timelines}} {with}",values:{totalSearchResultsCount:$,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},T.trim().length?`${k.bb} "${T.trim()}"`:"")}})),[$,T]),ie=Object(a.useMemo)((()=>null!=G&&null!=G.savedObjectId?[G.savedObjectId]:[]),[G]),re=Object(a.useMemo)((()=>null!=G&&null!=G.savedSearchId?[G.savedSearchId]:void 0),[G]),se=Object(a.useCallback)((()=>{null!=M&&M()}),[M]),oe=Object(a.useCallback)((()=>{null!=_&&_(!1)}),[_]),le=Object(a.useCallback)((()=>{null!=_&&_(!1),null!=M&&M()}),[_,M]),ue=Object(a.useMemo)((()=>{if(J.crud){const t=["createFrom","duplicate",...null!=l?["createRule"]:[],...null!=u?["createRuleFromEql"]:[]];return z!==h.k.immutable&&(t.push("export"),t.push("selectable")),null!=c&&null!=e&&z!==h.k.immutable&&t.push("delete"),t}return z!==h.k.immutable?["export","selectable"]:[]}),[l,u,z,c,e,J]),ce=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,q)),[q]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{deleteTimelines:e,ids:ie,savedSearchIds:re,isDeleteTimelineModalOpen:K,isEnableDownloader:W,onComplete:X,title:null!==(V=null==G?void 0:G.title)&&void 0!==V?V:k.ab}),i.a.createElement(j.a,{checkBoxLabel:k.I,closeModal:oe,description:k.P,errorMessage:k.t,failedDetailed:k.u,importComplete:le,importData:O.f,successMessage:k.V,showCheckBox:!1,showModal:null!=o&&o,submitBtnText:k.w,subtitle:k.x,title:k.v}),i.a.createElement("div",{className:H.a},!!L&&L,i.a.createElement(B,{"data-test-subj":"search-row",favoriteCount:n,onlyFavorites:d,onQueryChange:p,onToggleOnlyFavorites:v,query:T,timelineType:F},ce),i.a.createElement(E.a,{border:!0},i.a.createElement(E.d,null,i.a.createElement(E.c,null,i.a.createElement(E.e,{"data-test-subj":"query-message"},i.a.createElement(i.a.Fragment,null,k.Q," ",F===h.l.template?ee:ae))),i.a.createElement(E.c,null,z!==h.k.immutable&&i.a.createElement(i.a.Fragment,null,i.a.createElement(E.e,{"data-test-subj":"selected-count"},F===h.l.template?k.N(A.length):k.O(A.length)),i.a.createElement(E.b,{dataTestSubj:"batchActions",iconSide:"right",iconType:"arrowDown",popoverContent:Z,"data-test-subj":"utility-bar-action"},i.a.createElement("span",{"data-test-subj":"utility-bar-action-button"},k.a))),i.a.createElement(E.b,{dataTestSubj:"refreshButton",iconSide:"right",iconType:"refresh",onClick:se},k.K)))),i.a.createElement(te,{actionTimelineToShow:ue,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:r,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:Q,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:Y,onOpenTimeline:m,onSelectionChange:f,onTableChange:b,onToggleShowNotes:y,pageIndex:w,pageSize:C,searchResults:I,showExtendedColumns:!0,sortDirection:P,sortField:D,timelineType:F,tableRef:U,totalSearchResultsCount:$})))}));ae.displayName="OpenTimeline";var ie=n(170);const re=i.a.memo((({children:e,onAddTimelinesToFavorites:t,selectedTimelinesCount:n,title:a})=>i.a.createElement(ie.a,{title:a,split:!0,height:40},i.a.createElement(S.EuiFlexGroup,{gutterSize:"s",responsive:!1},t&&i.a.createElement(S.EuiFlexItem,{grow:!1},i.a.createElement(S.EuiButton,{"data-test-subj":"favorite-selected",iconSide:"left",iconType:"starEmptySpace",isDisabled:0===n,onClick:t},k.q)),e&&i.a.createElement(S.EuiFlexItem,null,e)))));re.displayName="TitleRow";const se=y.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-98e87t-0"})(["width:100%;"]);se.displayName="HeaderContainer";const oe=Object(a.memo)((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,hideActions:r=[],isLoading:s,itemIdToExpandedNotesRowMap:o,onAddTimelinesToFavorites:l,onDeleteSelected:u,onlyFavorites:c,onOpenTimeline:d,onQueryChange:m,onSelectionChange:p,onTableChange:f,onToggleOnlyFavorites:b,onToggleShowNotes:g,pageIndex:v,pageSize:y,searchResults:h,selectedItems:j,sortDirection:E,sortField:O,timelineFilter:x,timelineType:k,templateTimelineFilter:w,title:C,totalSearchResultsCount:T})=>{const M=Object(a.useMemo)((()=>{const t=["createFrom","duplicate"];return null!=u&&null!=e&&t.push("delete"),t.filter((e=>!r.includes(e)))}),[u,e,r]),I=Object(a.useMemo)((()=>i.a.createElement(a.Fragment,{key:"search-row-content"},!!w&&w)),[w]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiModalHeader,null,i.a.createElement(se,null,i.a.createElement(re,{"data-test-subj":"title-row",onAddTimelinesToFavorites:l,selectedTimelinesCount:j.length,title:C}))),i.a.createElement(S.EuiModalBody,null,i.a.createElement(i.a.Fragment,null,!!x&&i.a.createElement(i.a.Fragment,null,x,i.a.createElement(S.EuiSpacer,{size:"m"})),i.a.createElement(B,{"data-test-subj":"search-row",onlyFavorites:c,onQueryChange:m,onToggleOnlyFavorites:b,query:"",timelineType:k},I),i.a.createElement(te,{actionTimelineToShow:M,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:s,itemIdToExpandedNotesRowMap:o,onOpenTimeline:d,onSelectionChange:p,onTableChange:f,onToggleShowNotes:g,pageIndex:v,pageSize:y,searchResults:h,showExtendedColumns:!1,sortDirection:E,sortField:O,timelineType:k,totalSearchResultsCount:T}))))}));oe.displayName="OpenTimelineModalBody";var le=n(129),ue=n(164);let ce;!function(e){e.tab="tab",e.filter="filter"}(ce||(ce={}));var de=n(718),me=n(116),pe=n(121),fe=n(184),be=n(224);const ge=e=>e.reduce(((e,t)=>null!=t.savedObjectId&&null!=t.savedSearchId?[...e,{timelineId:t.savedObjectId,searchId:t.savedSearchId}]:null!=t.savedObjectId?[...e,{timelineId:t.savedObjectId}]:e),[]),ve=e=>e.reduce(((e,{timelineId:t,searchId:n})=>{let a=e;return null!=n&&(a={...a,searchIds:[...a.searchIds,n]}),null!=t&&(a={...a,timelineIds:[...a.timelineIds,t]}),a}),{timelineIds:[],searchIds:[]}),ye=i.a.memo((({closeModalTimeline:e,defaultPageSize:t,hideActions:n=[],isModal:g=!1,importDataModalToggle:v,onOpenTimeline:y,setImportDataModalToggle:j,title:E})=>{const x=Object(r.useDispatch)(),{startTransaction:C}=Object(fe.b)(),[T,M]=Object(a.useState)({}),[I,P]=Object(a.useState)(!1),[_,D]=Object(a.useState)(0),[F,N]=Object(a.useState)(t),[R,z]=Object(a.useState)(""),[L,B]=Object(a.useState)([]),[q,$]=Object(a.useState)("desc"),[V,U]=Object(a.useState)("updated"),G=Object(a.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),Q=Object(c.b)((e=>{var t,n;return null!==(t=null===(n=G(e,d.c.active))||void 0===n?void 0:n.savedObjectId)&&void 0!==t?t:""})),{dataViewId:W,selectedPatterns:K}=Object(pe.d)(me.SourcererScopeName.timeline),Y=Object(a.useMemo)((()=>Object(H.b)(x)),[x]),X=Object(a.useCallback)((e=>x(Object(p.updateIsLoading)(e))),[x]),{customTemplateTimelineCount:J,defaultTimelineCount:Z,elasticTemplateTimelineCount:ee,favoriteCount:te,fetchAllTimeline:ne,timelines:ie,loading:re,totalCount:se,templateTimelineCount:ye}=Object(f.b)(),{timelineType:he,timelineTabs:je,timelineFilters:Ee}=(({defaultTimelineCount:e,templateTimelineCount:t})=>{const{formatUrl:n,search:r}=Object(ue.l)(le.a.timelines),{navigateToUrl:s}=Object(l.i)().services.application,{tabName:o}=Object(w.useParams)(),[u,c]=Object(a.useState)(o===h.l.default||o===h.l.template?o:h.l.default),d=n(Object(ue.j)(h.l.default,r)),m=n(Object(ue.j)(h.l.template,r)),p=Object(a.useCallback)((e=>{e.preventDefault(),s(d)}),[s,d]),f=Object(a.useCallback)((e=>{e.preventDefault(),s(m)}),[s,m]),b=Object(a.useCallback)((e=>[{id:h.l.default,name:k.X,href:d,disabled:!1,onClick:e===ce.tab?p:A.noop},{id:h.l.template,name:k.W,href:m,disabled:!1,onClick:e===ce.tab?f:A.noop}]),[d,m,p,f]),g=Object(a.useCallback)(((e,t)=>{c((t=>(t!==e&&c(e),t)))}),[c]),v=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiTabs,{"data-test-subj":"open-timeline-subtabs"},b(ce.tab).map((e=>i.a.createElement(S.EuiTab,{"data-test-subj":`timeline-${ce.tab}-${e.id}`,isSelected:e.id===o,disabled:e.disabled,key:`timeline-${ce.tab}-${e.id}`,href:e.href,onClick:t=>{e.onClick(t),g(e.id,ce.tab)}},e.name)))),i.a.createElement(S.EuiSpacer,{size:"m"}))),[o]),y=Object(a.useMemo)((()=>i.a.createElement(S.EuiTabs,null,b(ce.filter).map((e=>i.a.createElement(S.EuiTab,{"data-test-subj":`open-timeline-modal-body-${ce.filter}-${e.id}`,isSelected:e.id===u,key:`timeline-${ce.filter}-${e.id}`,onClick:t=>{e.onClick(t),g(e.id,ce.filter)}},e.name))))),[u,b,g]);return{timelineType:u,timelineTabs:v,timelineFilters:y}})({defaultTimelineCount:Z,templateTimelineCount:ye}),{timelineStatus:Oe,templateTimelineFilter:xe,installPrepackagedTimelines:Se}=Object(de.a)({timelineType:he,customTemplateTimelineCount:J,elasticTemplateTimelineCount:ee}),ke=Object(a.useCallback)((()=>{ne({pageInfo:{pageIndex:_+1,pageSize:F},search:R,sort:{sortField:V,sortOrder:q},onlyUserFavorite:I,timelineType:he,status:Oe})}),[ne,_,F,R,V,q,he,Oe,I]),we=Object(a.useCallback)((e=>{z(e.queryText.trim())}),[]),Ce=Object(a.useCallback)((async(e,t)=>{C({name:e.length>1?be.f.BULK_DELETE:be.f.DELETE}),e.includes(Q)&&x(Object(p.createTimeline)({id:d.c.active,columns:b.b,dataViewId:W,indexNames:K,show:!1})),await Object(O.b)(e,t),ke()}),[C,Q,ke,x,W,K]),Te=Object(a.useCallback)((async(e,t)=>{await Ce(e,t)}),[Ce]),Me=Object(a.useCallback)((async()=>{const e=ge(L),{timelineIds:t,searchIds:n}=ve(e);await Ce(t,n),Re()}),[L,Ce]),Ie=Object(a.useCallback)((e=>{B(e)}),[]),Ae=Object(a.useCallback)((({page:e,sort:t})=>{const{index:n,size:a}=e,{field:i,direction:r}=t;D(n),N(a),$(r),U(i)}),[]),Pe=Object(a.useCallback)((()=>{P(!I)}),[I]),_e=Object(a.useCallback)((e=>{M(e)}),[]),{navigateTo:De}=Object(l.k)(),Fe=Object(a.useCallback)((e=>De({deepLinkId:u.yc.rulesCreate,path:`?${o.b}=${Object(s.encode)(e)}`})),[De]),Ne=Object(a.useCallback)((e=>De({deepLinkId:u.yc.rulesCreate,path:`?${o.a}=${Object(s.encode)(e)}`})),[De]),Re=Object(a.useCallback)((()=>{B([])}),[]),ze=Object(a.useCallback)((({duplicate:t,timelineId:n,timelineType:a})=>{t&&C({name:be.f.DUPLICATE}),g&&null!=e&&e(),Object(H.h)({duplicate:t,onOpenTimeline:y,timelineId:n,timelineType:a,updateIsLoading:X,updateTimeline:Y})}),[X,Y]);return Object(a.useEffect)((()=>{(()=>{const e=document.querySelector(`.${H.a} input`);null!=e&&e.focus()})()}),[]),Object(a.useEffect)((()=>{(async()=>{await Se(),ke()})()}),[ke,Se]),g?i.a.createElement(oe,{"data-test-subj":"open-timeline-modal",deleteTimelines:Te,defaultPageSize:t,favoriteCount:te,hideActions:n,isLoading:re,itemIdToExpandedNotesRowMap:T,onAddTimelinesToFavorites:void 0,onlyFavorites:I,onOpenTimeline:ze,onQueryChange:we,onSelectionChange:Ie,onTableChange:Ae,onToggleOnlyFavorites:Pe,onToggleShowNotes:_e,pageIndex:_,pageSize:F,query:R,searchResults:ie,selectedItems:L,sortDirection:q,sortField:V,templateTimelineFilter:xe,timelineType:he,timelineStatus:Oe,timelineFilter:Ee,title:E,totalSearchResultsCount:se}):i.a.createElement(ae,{"data-test-subj":"open-timeline",deleteTimelines:Te,defaultPageSize:t,favoriteCount:te,isLoading:re,itemIdToExpandedNotesRowMap:T,importDataModalToggle:v,onAddTimelinesToFavorites:void 0,onCreateRule:Fe,onCreateRuleFromEql:Ne,onDeleteSelected:Me,onlyFavorites:I,onOpenTimeline:ze,onQueryChange:we,onSelectionChange:Ie,onTableChange:Ae,onToggleOnlyFavorites:Pe,onToggleShowNotes:_e,pageIndex:_,pageSize:F,query:R,refetch:ke,searchResults:ie,setImportDataModalToggle:j,selectedItems:L,sortDirection:q,sortField:V,templateTimelineFilter:xe,timelineType:he,timelineStatus:Oe,timelineFilter:je,title:E,totalSearchResultsCount:se})})),he=i.a.memo(ye)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return ze}));var a=n(17),i=n(2),r=n.n(i),s=n(45),o=n(48),l=n(44),u=n.n(l),c=n(54),d=n(69),m=n(203),p=n(112),f=n(118),b=n(110),g=n(121),v=n(145),y=n(172),h=n(116),j=n(113),E=n(430),O=n(244),x=n(5);const S=e=>x.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} false {template}}",values:{isTimeline:e}}),k=x.i18n.translate("xpack.securitySolution.timeline.properties.unsavedLabel",{defaultMessage:"Unsaved"}),w=(x.i18n.translate("xpack.securitySolution.timeline.properties.savedLabel",{defaultMessage:"Saved"}),x.i18n.translate("xpack.securitySolution.timeline.properties.hasChangesLabel",{defaultMessage:"Unsaved changes"})),C=(x.i18n.translate("xpack.securitySolution.timeline.properties.inspectTimelineTitle",{defaultMessage:"Timeline"}),x.i18n.translate("xpack.securitySolution.timeline.properties.readMore",{defaultMessage:"Read More"}),({isOpen:e,title:t})=>x.i18n.translate("xpack.securitySolution.timeline.properties.timelineToggleButtonAriaLabel",{values:{isOpen:e,title:t},defaultMessage:"{isOpen, select, false {Open} true {Close} other {Toggle}} timeline {title}"})),T=u()(a.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-m1giyi-0"})(["&:active,&:focus{background:transparent;}> span{padding:0;}"]),M=u()(a.EuiFlexItem).withConfig({displayName:"TitleConatiner",componentId:"sc-m1giyi-1"})(["overflow:hidden;display:inline-block;text-overflow:ellipsis;white-space:nowrap;"]),I=({timelineId:e,timelineType:t,timelineTitle:n,isOpen:l})=>{const u=Object(o.useDispatch)(),c=Object(i.useCallback)((()=>{u(f.a.showTimeline({id:e,show:!l})),Object(v.i)()}),[u,l,e]),d=Object(s.isEmpty)(n)?t===j.l.template?O.k:O.l:n,m=Object(i.useMemo)((()=>r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"flexStart",responsive:!1},r.a.createElement(M,{"data-test-subj":"timeline-title",grow:!1},l?r.a.createElement(a.EuiText,{grow:!1},r.a.createElement("h3",null,d)):r.a.createElement(r.a.Fragment,null,d)),!l&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(E.b,null)))),[l,d]);return l?r.a.createElement(r.a.Fragment,null,m):r.a.createElement(T,{"aria-label":C({isOpen:l,title:d}),className:v.b,flush:"both","data-test-subj":"flyoutOverlay",size:"s",isSelected:l,onClick:c},m)},A=r.a.memo(I);var P=n(212),_=n(39),D=n(159),F=n(119),N=n(4),R=n(14),z=n(122),L=n(164),B=n(129),q=n(134);const $=({timelineId:e})=>{const t=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{cases:n,application:{navigateToApp:l}}=Object(b.i)().services,u=Object(o.useDispatch)(),{graphEventId:c,savedObjectId:d,status:m,title:g,timelineType:v}=Object(p.a)((n=>{var a;return Object(s.pick)(["graphEventId","savedObjectId","status","title","timelineType"],null!==(a=t(n,e))&&void 0!==a?a:q.b)})),[y,h]=Object(i.useState)(!1),[E,x]=Object(i.useState)(!1),S=Object(i.useCallback)((async t=>{x(!1),await l(N.l,{deepLinkId:B.a.case,path:null!=t?Object(L.a)({id:t.id}):Object(L.b)()}),u(Object(R.setInsertTimeline)({graphEventId:c,timelineId:e,timelineSavedObjectId:d,timelineTitle:g}))}),[u,c,l,d,e,g]),k=n.helpers.canUseCases([N.i]),w=Object(i.useCallback)((()=>{h((e=>!e))}),[]),C=Object(i.useCallback)((()=>h(!1)),[]),T=Object(i.useCallback)((()=>{C(),l(N.l,{deepLinkId:B.a.case,path:Object(L.b)()}).then((()=>{u(Object(R.setInsertTimeline)({graphEventId:c,timelineId:e,timelineSavedObjectId:d,timelineTitle:g.length>0?g:O.l})),u(Object(R.showTimeline)({id:z.c.active,show:!1}))}))}),[u,c,l,C,d,e,g]),M=Object(i.useCallback)((()=>{C(),x(!0)}),[x,C]),I=Object(i.useCallback)((()=>{x(!1)}),[x]),A=Object(i.useCallback)((()=>{h(!1)}),[]),P=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonEmpty,{size:"m","data-test-subj":"attach-timeline-case-button",iconType:"arrowDown",iconSide:"right",onClick:w,disabled:m===j.k.draft||v!==j.l.default},O.c)),[w,m,v]),_=Object(i.useMemo)((()=>[r.a.createElement(a.EuiContextMenuItem,{key:"new-case","data-test-subj":"attach-timeline-new-case",onClick:T},O.e),r.a.createElement(a.EuiContextMenuItem,{key:"existing-case","data-test-subj":"attach-timeline-existing-case",onClick:M},O.d)]),[M,T]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiPopover,{id:"singlePanel",button:P,isOpen:y,closePopover:A,panelPaddingSize:"none",anchorPosition:"downLeft"},r.a.createElement(a.EuiContextMenuPanel,{items:_})),E&&n.ui.getAllCasesSelectorModal({onRowClick:S,onClose:I,owner:[N.i],permissions:k}))};$.displayName="AddToCaseButtonComponent";const V=r.a.memo($);var U=n(327),H=n(466);const G=x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimelineBtn",{defaultMessage:"New"}),Q=x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimeline",{defaultMessage:"New Timeline"}),W=x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.openTimelineBtn",{defaultMessage:"Open"}),K=x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.openTimelineBtnLabel",{defaultMessage:"Open Existing Timeline"}),Y=(x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.saveTimelineBtn",{defaultMessage:"Save"}),x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.saveTimelineBtnLabel",{defaultMessage:"Save currently opened Timeline"}),x.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimelineTemplate",{defaultMessage:"New Timeline template"})),X=x.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),J=(x.i18n.translate("xpack.securitySolution.timeline.callOut.immutable.message.description",{defaultMessage:"This prebuilt timeline template cannot be modified. To make changes, please duplicate this template and make modifications to the duplicate template."}),x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"})),Z=x.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),ee=x.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),te=x.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),ne=x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),ae=x.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),ie=x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),re=x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),se=x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),oe=x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"}),le=(x.i18n.translate("xpack.securitySolution.timeline.flyout.saveTour.closeButton",{defaultMessage:"Close"}),x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.title",{defaultMessage:"Title"})),ue=(x.i18n.translate("xpack.securitySolution.timeline.flyout.saveTour.title",{defaultMessage:"Timeline changes now require manual saves"}),x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.saveAsNew",{defaultMessage:"Save as new timeline"})),ce={padding:0},de=r.a.memo((({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),s=Object(i.useCallback)((()=>{n(!1)}),[]),o=Object(i.useCallback)((()=>n((e=>!e))),[]),l=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonEmpty,{iconType:"arrowDown",size:"s",iconSide:"right",onClick:o},G)),[o]);return r.a.createElement(a.EuiPopover,{button:l,isOpen:t,closePopover:s,panelStyle:ce},r.a.createElement(a.EuiFlexGroup,{gutterSize:"xs",direction:"column",alignItems:"flexStart"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(U.c,{timelineId:e,title:Q,onClick:s})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(H.a,{timelineId:e,title:Y,onClick:s}))))}));de.displayName="NewTimelineAction";var me=n(135),pe=n(235),fe=n.n(pe),be=n(146),ge=n(184),ve=n(224),ye=n(228);const he={title:{type:be.a.TEXT,validations:[{validator:be.h.emptyField("")}]},description:{type:be.a.TEXTAREA,validations:[]}},je=Object(be.j)({component:be.b}),Ee=r.a.memo((({closeSaveTimeline:e,initialFocusOn:t,timelineId:n,showWarning:l})=>{const{startTransaction:u}=Object(ge.b)(),c=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{isSaving:d,description:m="",status:b,title:g="",timelineType:v}=Object(p.a)((e=>Object(s.pick)(["isSaving","description","status","title","timelineType"],c(e,n)))),y=b===j.k.draft,h=fe()(d),E=Object(o.useDispatch)(),S=Object(ye.a)({timelineId:z.c.active,timelineType:j.l.default}),[k,w]=Object(i.useState)(!1),C=Object(i.useCallback)((e=>w(e.target.checked)),[]),T=Object(i.useCallback)(((e,t)=>(t&&(E(f.a.updateTitleAndDescription({id:n,...e})),E(f.a.saveTimeline({id:n,saveAsNew:k}))),Promise.resolve())),[E,n,k]),M=Object(i.useMemo)((()=>({title:g,description:m})),[g,m]),{form:I}=Object(be.k)({id:"timelineTitleAndDescriptionForm",schema:he,onSubmit:T,options:{stripEmptyFields:!1},defaultValue:M}),{isSubmitted:A,isSubmitting:P,submit:_}=I,D=Object(i.useCallback)((()=>{u({name:ve.f.SAVE}),_()}),[_,u]),F=Object(i.useCallback)((()=>{l&&S(),e()}),[e,S,l]),N=Object(i.useMemo)((()=>b===j.k.draft&&l?v===j.l.template?ae:ne:ie),[l,b,v]),R=Object(i.useMemo)((()=>b===j.k.draft?v===j.l.template?Z:J:v===j.l.template?te:J),[b,v]),L=Object(i.useMemo)((()=>b===j.k.draft&&l?v===j.l.template?Z:J:ee),[l,b,v]),B=Object(i.useMemo)((()=>(e=>x.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:e===j.l.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}))(v)),[v]),q=Object(i.useMemo)((()=>`${se} (${oe})`),[]),$=Object(i.useMemo)((()=>({"aria-label":re,autoFocus:"title"===t,"data-test-subj":"save-timeline-title",disabled:d,spellCheck:!0,placeholder:v===j.l.template?O.k:O.l})),[t,d,v]),V=Object(i.useMemo)((()=>({"aria-label":se,"data-test-subj":"save-timeline-description",disabled:d,placeholder:O.f})),[d]);return Object(i.useEffect)((()=>{A&&!d&&h&&e()}),[A,d,h,e]),r.a.createElement(a.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:e},d&&r.a.createElement(a.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),r.a.createElement(a.EuiModalHeader,{"data-test-subj":"modal-header"},R),r.a.createElement(a.EuiModalBody,null,l&&r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(a.EuiCallOut,{title:B,color:"danger",iconType:"warning","data-test-subj":"edit-timeline-callout"}),r.a.createElement(a.EuiSpacer,{size:"m"})),r.a.createElement(be.c,{form:I},r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(je,{path:"title",fullWidth:!0,label:le,euiFieldProps:$}),r.a.createElement(a.EuiSpacer,null)),r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(je,{label:q,path:"description",fullWidth:!0,euiFieldProps:V}),r.a.createElement(a.EuiSpacer,null)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFlexGroup,{direction:"row",alignItems:"center"},y?null:r.a.createElement(a.EuiSwitch,{label:ue,checked:k,onChange:C,"data-test-subj":"save-as-new-switch"}),r.a.createElement(a.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(a.EuiButton,{size:"s",fill:!1,onClick:F,isDisabled:d,"data-test-subj":"close-button"},N)),r.a.createElement(a.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(a.EuiButton,{autoFocus:"save"===t,size:"s",isDisabled:d||P,fill:!0,onClick:D,"data-test-subj":"save-button"},L))))))))}));Ee.displayName="SaveTimelineModal";var Oe=n(57),xe=n(292);const Se=r.a.memo((({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),s=Object(i.useCallback)((()=>{n(!1)}),[]),o=Object(i.useCallback)((()=>{n(!0)}),[]),{kibanaSecuritySolutionsPrivileges:{crud:l}}=Object(me.a)(),u=Object(i.useMemo)((()=>Object(Oe.createSelector)(f.b.selectTimeline,(e=>{var t,n,a,i,r,s;return{status:null!==(t=null==e?void 0:e.status)&&void 0!==t?t:j.k.draft,updated:null!==(n=null==e?void 0:e.updated)&&void 0!==n?n:void 0,isSaving:null!==(a=null==e?void 0:e.isSaving)&&void 0!==a?a:void 0,isLoading:null!==(i=null==e?void 0:e.isLoading)&&void 0!==i?i:void 0,changed:null!==(r=null==e?void 0:e.changed)&&void 0!==r?r:void 0,show:null!==(s=null==e?void 0:e.show)&&void 0!==s?s:void 0}}))),[]),{status:c,isSaving:d}=Object(p.a)((t=>u(t,e))),m=l&&c!==j.k.immutable,b=c===j.k.draft,g=m?null:X;return r.a.createElement(a.EuiToolTip,{content:g,position:"bottom","data-test-subj":"save-timeline-btn-tooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiButton,{id:xe.a.SAVE_TIMELINE,fill:!0,color:"primary",onClick:o,size:"s",iconType:"save",isLoading:d,disabled:!m,"data-test-subj":"save-timeline-action-btn"},ee),t&&m?r.a.createElement(Ee,{closeSaveTimeline:s,initialFocusOn:b?"title":"save",timelineId:e,showWarning:!1}):null))}));Se.displayName="SaveTimelineButton";var ke=n(467);const we=["createFrom"],Ce=r.a.memo((()=>{const[e,t]=Object(i.useState)(!1),n=Object(i.useCallback)((()=>t(!1)),[]),s=Object(i.useCallback)((()=>{t(!0)}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiButtonEmpty,{"data-test-subj":"open-timeline-button",onClick:s,"aria-label":K},W),e?r.a.createElement(ke.a,{onClose:n,hideActions:we}):null)}));Ce.displayName="OpenTimelineAction";const Te=u.a.span.withConfig({displayName:"VerticalDivider",componentId:"sc-1qnxttj-0"})(["width:0px;height:20px;border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),Me=({mode:e="normal",timelineId:t,activeTab:n,isInspectButtonDisabled:i})=>{const{cases:s}=Object(P.b)().services,o=s.helpers.canUseCases([_.APP_ID]);return r.a.createElement(a.EuiFlexGroup,{id:xe.a.ACTION_MENU,gutterSize:"xs",justifyContent:"flexEnd",alignItems:"center",responsive:!1,"data-test-subj":"timeline-action-menu"},r.a.createElement(a.EuiFlexItem,{"data-test-subj":"new-timeline-action"},r.a.createElement(de,{timelineId:t})),r.a.createElement(a.EuiFlexItem,{"data-test-subj":"open-timeline-action"},r.a.createElement(Ce,null)),r.a.createElement(a.EuiFlexItem,{"data-test-subj":"inspect-timeline-action"},r.a.createElement(D.b,{compact:"compact"===e,queryId:`${t}-${n}`,inputId:F.a.timeline,isDisabled:i,title:""})),o.create&&o.read?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexItem,null,r.a.createElement(Te,null)),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(V,{timelineId:t}))):null,r.a.createElement(a.EuiFlexItem,{"data-test-subj":"save-timeline-action"},r.a.createElement(Se,{timelineId:t})))},Ie=r.a.memo(Me),Ae=u()(a.EuiText).withConfig({displayName:"NoWrapText",componentId:"sc-33d5ea-0"})(["white-space:nowrap;"]),Pe=r.a.memo((({status:e,updated:t,changed:n})=>{let i=null;return e!==j.k.draft&&t?n&&(i=r.a.createElement(a.EuiBadge,{color:"warning"},w)):i=r.a.createElement(a.EuiBadge,{color:"warning"},k),i?r.a.createElement(Ae,{size:"xs","data-test-subj":"timeline-status"},i):null}));Pe.displayName="TimelineStatusInfo";var _e=n(756);const De=u()(a.EuiFlexGroup).withConfig({displayName:"FlyoutHeaderPanelContentFlexGroupContainer",componentId:"sc-a6ccyo-0"})(["overflow-x:auto;"]),Fe=u()(a.EuiFlexItem).withConfig({displayName:"ActiveTimelinesContainer",componentId:"sc-a6ccyo-1"})(["overflow:hidden;"]),Ne=Object(d.euiStyled)(a.EuiPanel)`
  backgroundColor: ${e=>e.theme.eui.euiColorEmptyShade};
  color: ${e=>e.theme.eui.euiTextColor};
  padding-inline: ${e=>e.theme.eui.euiSizeM};
  border-radius: ${({$isOpen:e,theme:t})=>e?t.eui.euiBorderRadius:"0px"};
`,Re=({timelineId:e})=>{const t=Object(o.useDispatch)(),{browserFields:n,indexPattern:l}=Object(g.d)(h.SourcererScopeName.timeline),{uiSettings:u}=Object(b.i)().services,d=Object(i.useMemo)((()=>Object(c.getEsQueryConfig)(u)),[u]),j=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{activeTab:E,dataProviders:O,kqlQuery:x,title:k,timelineType:w,status:C,updated:T,show:M,filters:I,kqlMode:P,changed:_=!1}=Object(p.a)((t=>{var n;return Object(s.pick)(["activeTab","dataProviders","kqlQuery","status","title","timelineType","updated","show","filters","kqlMode","changed"],null!==(n=j(t,e))&&void 0!==n?n:q.b)})),D=Object(i.useMemo)((()=>!Object(s.isEmpty)(O)||!Object(s.isEmpty)(Object(s.get)("filterQuery.kuery.expression",x))),[O,x]),F=Object(i.useMemo)((()=>f.b.getKqlFilterQuerySelector()),[]),N=Object(o.useSelector)((t=>F(t,e))),R=Object(s.isEmpty)(O)&&Object(s.isEmpty)(N)&&"template"===w?" ":null!=N?N:"",z=Object(i.useMemo)((()=>({query:R,language:"kuery"})),[R]),L=Object(i.useMemo)((()=>Object(y.d)({config:d,dataProviders:O,indexPattern:l,browserFields:n,filters:I||[],kqlQuery:z,kqlMode:P})),[n,O,d,I,l,P,z]),B=Object(i.useCallback)((()=>{Object(m.a)(),t(f.a.showTimeline({id:e,show:!1})),Object(v.i)()}),[t,e]);return r.a.createElement(Ne,{$isOpen:M,grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-flyout-header-panel","data-show":M},r.a.createElement(De,{className:"eui-scrollBar",alignItems:"center",gutterSize:"s",responsive:!1,justifyContent:"spaceBetween"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},M?null:r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(_e.b,{timelineId:e})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(U.a,{timelineId:e,compact:!0})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(Fe,{grow:!1},r.a.createElement(A,{timelineId:e,timelineType:w,timelineTitle:k,isOpen:M}))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(Pe,{status:C,updated:T,changed:_})))),M&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(Ie,{timelineId:e,activeTab:E,isInspectButtonDisabled:!D||void 0===(null==L?void 0:L.filterQuery)}),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{content:S("default"===w)},r.a.createElement(a.EuiButtonIcon,{"aria-label":S("default"===w),"data-test-subj":"close-timeline",iconType:"cross",onClick:B})))))))},ze=r.a.memo(Re)},function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var a=n(2),i=n(67),r=n.n(i),s=n(23),o=n.n(s),l=n(11),u=n.n(l),c=n(74),d=n.n(c),m=n(17);let p;!function(e){e.preboot="preboot",e.standard="standard"}(p||(p={}));const f="eui-global",b="eui-utilities",g={darkMode:!1};var v=n(13);const y=[m.euiStylisPrefixer],h=d()({key:"css",stylisPlugins:y,container:document.querySelector('meta[name="emotion"]')}),j=d()({key:f,stylisPlugins:y,container:document.querySelector(`meta[name="${f}"]`)}),E=d()({key:b,stylisPlugins:y,container:document.querySelector(`meta[name="${b}"]`)});h.compat=!0,j.compat=!0,E.compat=!0;const O={default:h,global:j,utility:E},x=({theme:{theme$:e},globalStyles:t,colorMode:n,children:i})=>{const r=u()(e,g),s=Object(a.useMemo)((()=>(e=>e.darkMode?m.COLOR_MODES_STANDARD.dark:m.COLOR_MODES_STANDARD.light)(r)),[r]),o=n||s,l=!1!==t&&void 0;return Object(v.jsx)(m.EuiProvider,{cache:O,colorMode:o,globalStyles:l,utilityClasses:l},i)},S=({children:e,i18n:t,...n})=>Object(v.jsx)(x,n,Object(v.jsx)(t.Context,null,e));var k=n(84);const w=({children:e,...t})=>Object(v.jsx)(S,o()({globalStyles:!1},t),Object(v.jsx)(k.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(v.jsx)(k.KibanaErrorBoundary,null,e))),C=(e,t)=>n=>(r.a.render(Object(v.jsx)(w,t,e),n),()=>r.a.unmountComponentAtNode(n));n(0),n(5);class mount_point_portal_MountPointPortalErrorBoundary extends a.Component{constructor(...e){super(...e),definePropertyfrom_dll_reference_kbnSharedDeps_npm_default()(this,"state",{error:void 0})}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(){}render(){return this.state.error?Object(v.jsx)("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("reactPackages.mountPointPortal.errorMessage",{defaultMessage:"Error rendering portal content"})):this.props.children}}},,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return x})),n.d(t,"c",(function(){return M}));var a=n(2),i=n.n(a),r=n(17),s=n(113),o=n(708),l=n(164);const u="timeline";var c=n(5);const d=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.insertTimelineButtonLabel",{defaultMessage:"Insert timeline link"}),m=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineNameFoundErrorMsg",{defaultMessage:"No timeline name found"}),p=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineIdFoundErrorMsg",{defaultMessage:"No timeline id found"}),f=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),b=e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.failedRetrieveTimelineErrorMsg",{defaultMessage:"Failed to retrieve timeline id: { timelineId }",values:{timelineId:e}}),g=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.timelineErrorTitle",{defaultMessage:"Timeline Error"});var v=n(129);const y=({onClosePopover:e,onInsert:t})=>{const{formatUrl:n}=Object(l.l)(v.a.timelines),u=Object(a.useCallback)((({timelines:e})=>[...e.map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:void 0})))]),[]),c=Object(a.useCallback)(((e,a,i)=>{const r=n(Object(l.k)(null!=a?a:"",i),{absolute:!0,skipSearch:!0});t(`[${e}](${r})`,{block:!1})}),[n,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiModalHeader,null),i.a.createElement(r.EuiModalBody,null,i.a.createElement(o.a,{hideUntitled:!0,getSelectableOptions:u,onTimelineChange:c,onClosePopover:e,timelineType:s.l.default})))},h=Object(a.memo)(y),j={name:u,button:{label:d,iconType:"timeline"},helpText:i.a.createElement(r.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"[title](url)"),editor:function({node:e,onSave:t,onCancel:n}){return i.a.createElement(h,{onClosePopover:n,onInsert:t})}};var E=n(60),O=n(310);const x=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){let a=0;if("["!==t[a])return!1;if(n)return!0;function i(e,n){if(t[a]!==e)throw new Error(f);a++;let i="",r=0;for(;a<t.length;a++){const s=t[a];if(s===n&&0===r)return a++,i;s===n?r--:s===e&&r++,i+=s}return""}const r=i("[","]"),s=i("(",")"),o=e.now();if(!r)return this.file.info(m,{line:o.line,column:o.column}),!1;try{var l;const t=s.split("?"),n=Object(O.parse)(t[1]),a=Object(E.safeDecode)(null!==(l=n.timeline)&&void 0!==l?l:""),{id:i="",graphEventId:c=""}=null!=a?a:{id:null,graphEventId:""};return i?e(`[${r}](${s})`)({type:u,id:i,title:r,graphEventId:c}):(this.file.info(p,{line:o.line,column:o.column+s.indexOf("id")}),!1)}catch{this.file.info((e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineUrlIsNotValidErrorMsg",{defaultMessage:"Timeline URL is not valid => {timelineUrl}",values:{timelineUrl:e}}))(s),{line:o.line,column:o.column})}return!1},i=function(e,t,n){return!(!1===t.startsWith("[")||!0===t.startsWith("[")&&!t.includes("timelines?timeline=(id"))&&a.call(this,e,t,n)};i.locator=(e,t)=>e.indexOf("[",t),t.timeline=i,n.splice(n.indexOf("url"),0,u)};var S=n(48),k=n(162),w=n(14),C=n(117);const T=({id:e,title:t,graphEventId:n})=>{const{addError:s}=Object(C.a)(),o=(()=>{const e=Object(S.useDispatch)();return Object(a.useCallback)(((t,n,a)=>{Object(k.h)({graphEventId:a,timelineId:t,onError:n,updateIsLoading:({id:t,isLoading:n})=>e(Object(w.updateIsLoading)({id:t,isLoading:n})),updateTimeline:Object(k.b)(e)})}),[e])})(),l=Object(a.useCallback)(((e,t)=>{s(e,{title:g,toastMessage:b(t)})}),[s]),u=Object(a.useCallback)((()=>o(null!=e?e:"",l,n)),[e,n,o,l]);return i.a.createElement(r.EuiToolTip,{content:(d=null!=e?e:"",c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineId",{defaultMessage:"Timeline id: { timelineId }",values:{timelineId:d}}))},i.a.createElement(r.EuiLink,{onClick:u,"data-test-subj":`markdown-timeline-link-${e}`},t));var d},M=Object(a.memo)(T)},function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(45),i=n(17),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(153),c=n(113),d=n(241),m=n(5);const p=m.i18n.translate("xpack.securitySolution.editDataProvider.doesNotExistLabel",{defaultMessage:"does not exist"}),f=m.i18n.translate("xpack.securitySolution.editDataProvider.existsLabel",{defaultMessage:"exists"}),b=m.i18n.translate("xpack.securitySolution.editDataProvider.fieldLabel",{defaultMessage:"Field"}),g=m.i18n.translate("xpack.securitySolution.editDataProvider.placeholder",{defaultMessage:"Select a field"}),v=m.i18n.translate("xpack.securitySolution.editDataProvider.isLabel",{defaultMessage:"is"}),y=m.i18n.translate("xpack.securitySolution.editDataProvider.isOneOfLabel",{defaultMessage:"is one of"}),h=m.i18n.translate("xpack.securitySolution.editDataProvider.isNotLabel",{defaultMessage:"is not"}),j=m.i18n.translate("xpack.securitySolution.editDataProvider.isNotOneOfLabel",{defaultMessage:"is not one of"}),E=m.i18n.translate("xpack.securitySolution.editDataProvider.includesPlaceholder",{defaultMessage:"enter one or more values"}),O=m.i18n.translate("xpack.securitySolution.editDataProvider.operatorLabel",{defaultMessage:"Operator"}),x=m.i18n.translate("xpack.securitySolution.editDataProvider.saveButton",{defaultMessage:"Save"}),S=m.i18n.translate("xpack.securitySolution.editDataProvider.valuePlaceholder",{defaultMessage:"value"}),k=m.i18n.translate("xpack.securitySolution.editDataProvider.valueLabel",{defaultMessage:"Value"}),w=m.i18n.translate("xpack.securitySolution.editDataProvider.selectAnOperatorPlaceholder",{defaultMessage:"Select an operator"}),C=e=>m.i18n.translate("xpack.securitySolution.editDataProvider.unavailableOperator",{values:{operator:e},defaultMessage:"{operator} operator is unavailable with templates"}),T=[{label:v},{label:h},{label:y},{label:j},{label:f},{label:p}],M=[],I=e=>e?Object.keys(e).sort().map((t=>{return{label:t,options:(n=e[t],null!=n.fields&&Object.keys(n.fields).length>0?Object.keys(n.fields):M).map((e=>({label:e})))};var n})):M,A=({browserFields:e,selectedField:t,selectedOperator:n,type:i})=>{const r=t.length>0?t[0].label:"",s=n.length>0?n[0].label:"",o=e&&null!=Object(d.a)(e)[r],l=-1!==Object(a.findIndex)((e=>e.label===s),T),u=i===c.a.template&&(s===y||s===j);return o&&l&&!u},P=e=>{switch(e.length>0?e[0].label:""){case v:case h:return u.d;case y:case j:return u.c;case f:case p:return u.b;default:return u.d}},_=e=>{switch(e.length>0?e[0].label:""){case h:case j:case p:return!0;default:return!1}},D=e=>Array.isArray(e)?e.length?`${e[0]}`:"":`${e}`;var F=n(145);const N=({value:e,onChangeCallback:t})=>{const[n,a]=Object(r.useState)(R(e));Object(r.useEffect)((()=>{t(z(n))}),[n,t]);const o=Object(r.useCallback)(((e,t=n)=>{const i=e.trim().toLowerCase();i&&-1===t.findIndex((e=>e.label.trim().toLowerCase()===i))&&a([...n,{label:e}])}),[n]),l=Object(r.useCallback)((e=>{a(e)}),[]);return s.a.createElement(i.EuiComboBox,{noSuggestions:!0,isClearable:!0,"data-test-subj":"is-one-of-combobox-input",selectedOptions:n,placeholder:E,onCreateOption:o,onChange:l})},R=e=>Object(F.k)(e)?e.map((e=>({label:String(e)}))):[],z=e=>e.map((e=>e.label)),L=({value:e,onChangeCallback:t})=>{const[n,a]=Object(r.useState)(B(e));Object(r.useEffect)((()=>{t(D(n))}),[n,t]);const o=Object(r.useCallback)((e=>{a(e.target.value)}),[]);return s.a.createElement(i.EuiFieldText,{className:"edit-data-provider-value",onChange:o,placeholder:S,value:D(n)})},B=e=>{var t;return Object(F.k)(e)?null!==(t=e[0])&&void 0!==t?t:"":e},q="edit-data-provider-save";l.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-1dznxok-0"})(["width:",";"],400).displayName="HeaderContainer";const $=s.a.memo((({andProviderId:e,browserFields:t,field:n,isExcluded:o,onDataProviderEdited:l,operator:c,providerId:d,timelineId:m,value:E,type:S=u.a.default})=>{const[M,D]=Object(r.useState)([{label:n}]),[F,R]=Object(r.useState)(((e,t)=>":"===t?e?[{label:h}]:[{label:v}]:"includes"===t?e?[{label:j}]:[{label:y}]:e?[{label:p}]:[{label:f}])(o,c)),[z,B]=Object(r.useState)(E),$=Object(r.useMemo)((()=>F.length>0&&(F[0].label===y||F[0].label===j)),[F]),V=Object(r.useMemo)((()=>S!==u.a.template&&F.length>0&&F[0].label!==f&&F[0].label!==p&&!$),[$,S,F]),U=Object(r.useMemo)((()=>$&&Array.isArray(z)&&!z.length),[$,z]),H=()=>{const e=document.getElementsByClassName("edit-data-provider-value");if(e.length>0)e[0].focus();else{const e=document.getElementsByClassName(q);e.length>0&&e[0].focus()}},G=Object(r.useCallback)((e=>{D(e),S===u.a.template&&B(`{${e[0].label}}`),H()}),[S]),Q=Object(r.useCallback)((e=>{R(e),H()}),[]),W=Object(r.useCallback)((e=>{B(e)}),[]),K=Object(r.useCallback)((()=>{l({andProviderId:e,excluded:_(F),field:M.length>0?M[0].label:"",id:m,operator:P(F),providerId:d,value:z,type:S})}),[l,e,F,M,m,d,z,S]);return Object(r.useEffect)((()=>((()=>{const e=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;window.onscroll=()=>window.scrollTo(e,t)})(),()=>{window.onscroll=()=>a.noop})),[]),s.a.createElement(i.EuiPanel,{paddingSize:"s"},s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFormRow,{label:b},s.a.createElement(i.EuiComboBox,{autoFocus:!0,"data-test-subj":"field",isClearable:!1,onChange:G,options:I(t),placeholder:g,selectedOptions:M,singleSelection:{asPlainText:!0},fullWidth:!0}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"row",justifyContent:"spaceBetween"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFormRow,{label:O},s.a.createElement(i.EuiComboBox,{"data-test-subj":"operator",isClearable:!1,onChange:Q,options:T,placeholder:w,selectedOptions:F,singleSelection:{asPlainText:!0},style:{minWidth:152}}))))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!1},V&&s.a.createElement(i.EuiFormRow,{label:k},s.a.createElement(L,{onChangeCallback:W,value:E})),$&&S!==u.a.template&&s.a.createElement(i.EuiFormRow,{label:k},s.a.createElement(N,{onChangeCallback:W,value:E}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!1},S===u.a.template&&$&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiCallOut,{color:"warning",iconType:"warning",size:"s",title:C(F[0].label)}),s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{className:q,color:"primary","data-test-subj":"save",fill:!0,isDisabled:!A({type:S,browserFields:t,selectedField:M,selectedOperator:F})||U,onClick:K,size:"m"},x))))))}));$.displayName="StatefulEditDataProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f}));var a=n(2),i=n.n(a),r=n(90);const s={capabilities:Object(r.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var o=n(117),l=n(110),u=n(152);const c=Object(u.d)((async({http:e,signal:t})=>e.fetch("/internal/ml/ml_capabilities",{method:"GET",version:"1",asSystemRequest:!0,signal:t}))),d=n(5).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),m={...s,capabilitiesFetched:!1},p=i.a.createContext(m);p.displayName="MlCapabilitiesContext";const f=i.a.memo((({children:e})=>{const[t,n]=Object(a.useState)(m),r=Object(l.h)(),{addError:s}=Object(o.a)(),{start:f,result:b,error:g}=Object(u.a)(c);return Object(a.useEffect)((()=>{f({http:r})}),[r,f]),Object(a.useEffect)((()=>{b&&n({...b,capabilitiesFetched:!0})}),[b]),Object(a.useEffect)((()=>{g&&s(g,{title:d})}),[s,g]),i.a.createElement(p.Provider,{value:t},e)}));f.displayName="MlCapabilitiesProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(2),i=n.n(a),r=n(17),s=n(117),o=n(5);const l=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.cancelTitle",{defaultMessage:"Cancel"}),u=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteExceptionLabel",{defaultMessage:'Overwrite existing exception lists with conflicting "list_id"'}),c=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteActionConnectorsLabel",{defaultMessage:'Overwrite existing connectors with conflicting action "id"'}),d=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importExceptionsFailedLabel",{values:{totalExceptions:e},defaultMessage:"Failed to import {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}"}),m=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importConnectorsFailedLabel",{values:{totalConnectors:e},defaultMessage:"Failed to import {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}"}),p=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningButton",{defaultMessage:"Go to connectors"}),f=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsAdditionalPrivilegesError",{defaultMessage:"You need additional privileges to import rules with actions."}),b=(e,t,n)=>{const a=n.map((t=>e(t.error.message))),i=new Error(a.join(". "));return i.stack=void 0,i.name="Network errors",i.raw_network_error=t,i};var g=n(212);const v=({actionConnectorsWarnings:e,importedActionConnectorsCount:t})=>{const{http:n}=Object(g.b)().services;if(!t||!e.length)return null;const{actionPath:a,message:s,buttonLabel:l}=e[0];return i.a.createElement(r.EuiCallOut,{"data-test-subj":"actionConnectorsWarningsCallOut",size:"m",heading:"h2",iconType:"warning",title:i.a.createElement("span",{"data-test-subj":"actionConnectorsWarningsCallOutTitle"},(u=t,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningTitle",{values:{totalConnectors:u},defaultMessage:"{totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}} imported"}))),color:"warning"},i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{"data-test-subj":"actionConnectorsWarningsCallOutMessage"},i.a.createElement(r.EuiText,{size:"xs"},s)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",direction:"columnReverse",alignItems:"flexEnd"},i.a.createElement(r.EuiButton,{"data-test-subj":"actionConnectorsWarningsCallOutButton",color:"warning",href:n.basePath.prepend(a)},l||p)))));var u};v.displayName="ActionConnectorWarningsComponent";const y=i.a.memo(v);y.displayName="ActionConnectorWarnings";const h=({checkBoxLabel:e,closeModal:t,description:n,errorMessage:p,failedDetailed:g,importComplete:v,importData:h,showCheckBox:j=!0,showExceptionsCheckBox:E=!1,showActionConnectorsCheckBox:O=!1,showModal:x,submitBtnText:S,subtitle:k,successMessage:w,title:C})=>{const[T,M]=Object(a.useState)(null),[I,A]=Object(a.useState)(!1),[P,_]=Object(a.useState)(!1),[D,F]=Object(a.useState)(!1),[N,R]=Object(a.useState)(!1),{addError:z,addSuccess:L}=Object(s.a)(),[B,q]=Object(a.useState)([]),[$,V]=Object(a.useState)(0),U=Object(a.useCallback)((()=>{t(),_(!1),F(!1),R(!1),q([])}),[t,_,F]),H=Object(a.useCallback)((e=>{A(!1),M(null),v(),e&&(v(),U())}),[U,v]),G=Object(a.useCallback)((async()=>{if(null!=T){A(!0);const e=new AbortController;try{const{action_connectors_warnings:t,...n}=await h({fileToImport:T[0],overwrite:P,overwriteExceptions:D,overwriteActionConnectors:N,signal:e.signal}),a=n.action_connectors_success_count;q(t),V(a),(({importResponse:e,exceptionsIncluded:t,actionConnectorsIncluded:n,successMessage:a,errorMessage:i,errorMessageDetailed:r,addError:s,addSuccess:l})=>{if(e.success)return e.success_count>0&&l(a(e.success_count)),t&&e.exceptions_success&&null!=e.exceptions_success_count&&e.exceptions_success_count>0&&l((c=e.exceptions_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.exceptionsSuccessLabel",{values:{totalExceptions:c},defaultMessage:"Successfully imported {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}."}))),void(n&&e.action_connectors_success&&null!=e.action_connectors_success_count&&e.action_connectors_success_count>0&&l((u=e.action_connectors_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.connectorsSuccessLabel",{values:{totalConnectors:u},defaultMessage:"Successfully imported {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}."}))));var u,c;if(e.errors.length>0){if(n&&null!=e.action_connectors_errors&&e.action_connectors_errors.length>0){const{mappedErrors:t,numberOfActions:n}=(e=>{let t="";return{mappedErrors:e.map((e=>{const{id:n,error:a}=e;t=t&&t!==n?`${t},${n}`:n;const{status_code:i,message:r}=a||{};let s;return s=403===i?f:r,{...e,error:{...a,message:s}}})),numberOfActions:new Set(t&&[...t.split(",")]).size}})(e.action_connectors_errors);return s(b(r,e,t),{title:m(n||t.length)})}s(b(r,e,e.errors),{title:i(e.errors.length)}),t&&null!=e.exceptions_errors&&e.exceptions_errors.length>0&&s(b(r,e,e.exceptions_errors),{title:d(e.exceptions_errors.length)})}})({importResponse:n,exceptionsIncluded:E,actionConnectorsIncluded:O,successMessage:w,errorMessage:p,errorMessageDetailed:g,addError:z,addSuccess:L}),H(!(null!=t&&t.length))}catch(e){U(),z(e,{title:p(1)})}}}),[T,h,P,D,N,E,w,p,g,z,L,O,H,U]),Q=Object(a.useCallback)((()=>{U()}),[U]),W=Object(a.useCallback)((()=>{_((e=>!e))}),[]),K=Object(a.useCallback)((()=>{F((e=>!e))}),[]),Y=Object(a.useCallback)((()=>{R((e=>!e))}),[]);return i.a.createElement(i.a.Fragment,null,x&&i.a.createElement(r.EuiModal,{onClose:Q,maxWidth:"750px"},i.a.createElement(r.EuiModalHeader,null,i.a.createElement(r.EuiModalHeaderTitle,null,C)),i.a.createElement(r.EuiModalBody,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("h4",null,n)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiFilePicker,{"data-test-subj":"rule-file-picker",accept:".ndjson",id:"rule-file-picker",initialPromptText:k,onChange:e=>{M(e&&e.length>0?e:null)},display:"large",fullWidth:!0,isLoading:I}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(y,{actionConnectorsWarnings:B,importedActionConnectorsCount:$}),i.a.createElement(r.EuiSpacer,{size:"s"}),j&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalCheckboxLabel",id:"importDataModalCheckboxLabel",label:e,checked:P,onChange:W}),E&&i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalExceptionsCheckboxLabel",id:"importDataModalExceptionsCheckboxLabel",label:u,checked:D,onChange:K}),O&&i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalActionConnectorsCheckbox",id:"importDataModalActionConnectorsCheckbox",label:c,checked:N,onChange:Y}))),i.a.createElement(r.EuiModalFooter,null,i.a.createElement(r.EuiButtonEmpty,{onClick:Q},l),i.a.createElement(r.EuiButton,{"data-test-subj":"import-data-modal-button",onClick:G,disabled:null==T||I,fill:!0},S))))};h.displayName="ImportDataModalComponent";const j=i.a.memo(h);j.displayName="ImportDataModal"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(48),s=n(688),o=n(322),l=n(158),u=n(119),c=n(384),d=n(400);const m=({combinedQueries:e,filters:t,headerChildren:n,onlyField:m,paddingSize:p,query:f,showLegend:b,setAbsoluteRangeDatePickerTarget:g=u.a.global,runtimeMappings:v,hideQueryToggle:y=!1})=>{const h=Object(r.useDispatch)(),{signalIndexName:j}=Object(o.a)(),E=(O=t,Object(a.useMemo)((()=>[...O,...Object(d.e)(!1)]),[O]));var O;const x=Object(a.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;h(Object(l.setAbsoluteRangeDatePicker)({id:g,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[h,g]);return i.a.createElement(s.a,{combinedQueries:e,filters:E,headerChildren:n,legendPosition:"right",onlyField:m,paddingSize:p,query:f,showLegend:b,showLinkToAlerts:null==m,showStackBy:null==m,showTotalAlertsCount:!0,signalIndexName:j,runtimeMappings:v,title:c.b,titleSize:null==m?"m":"s",updateDateRange:x,hideQueryToggle:y})};m.displayName="SignalsByCategoryComponent";const p=i.a.memo(m)},function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var a=n(45),i=n(2),r=n.n(i),s=n(48),o=n(113),l=n(112),u=n(118),c=n(17),d=n(59),m=n.n(d),p=n(44),f=n.n(p),b=n(126),g=n(515),v=n(153),y=n(401);const h=f()(c.EuiBadge).withConfig({displayName:"ProviderBadgeStyled",componentId:"sc-l32wgy-0"})([".euiToolTipAnchor{&::after{font-style:normal;content:'|';padding:0px 3px;}}&.globalFilterItem{white-space:nowrap;min-width:",";display:flex;&.globalFilterItem-isDisabled{text-decoration:line-through;font-weight:400;font-style:italic;}&.globalFilterItem-isError{box-shadow:0 1px 1px -1px rgba(152,162,179,0.2),0 3px 2px -2px rgba(152,162,179,0.2),inset 0 0 0 1px #bd271e;}}"],(({$timelineType:e})=>e===o.l.template?"140px":"none"));h.displayName="ProviderBadgeStyled";const j=f.a.div.withConfig({displayName:"ProviderFieldBadge",componentId:"sc-l32wgy-1"})(["display:block;color:#fff;padding:6px 8px;font-size:0.6em;"]),E=f()(j).withConfig({displayName:"StyledTemplateFieldBadge",componentId:"sc-l32wgy-2"})(["background:",";text-transform:uppercase;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),O=f()(j).withConfig({displayName:"ConvertFieldBadge",componentId:"sc-l32wgy-3"})(["background:",";cursor:pointer;&:hover{text-decoration:underline;}"],(({theme:e})=>e.eui.euiColorDarkShade)),x=({type:e,toggleType:t})=>e!==v.a.template?r.a.createElement(O,{onClick:t},y.d):r.a.createElement(E,null,y.w),S=r.a.memo(x),k={tabIndex:-1},w=r.a.memo((({deleteProvider:e,field:t,isEnabled:n,isExcluded:s,operator:l,providerId:u,togglePopover:c,toggleType:d,displayValue:p,val:f,type:j,timelineType:E})=>{const O=Object(i.useCallback)((t=>{t.stopPropagation&&t.stopPropagation(),e()}),[e]),x=Object(i.useMemo)((()=>m()("globalFilterItem",{"globalFilterItem-isDisabled":!n,"globalFilterItem-isExcluded":s})),[n,s]),w=Object(i.useMemo)((()=>Object(a.isString)(f)&&""===f?Object(b.b)():f),[f]),C=Object(i.useMemo)((()=>s?r.a.createElement("span",null,y.q," "):null),[s]),T=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,C,l!==v.b?r.a.createElement("span",{className:"field-value"},`${t}: "${"includes"===l?p:w}"`):r.a.createElement("span",{className:"field-value"},t," ",y.j))),[p,t,w,l,C]),M=Object(i.useMemo)((()=>y.v({field:t,value:`${w}`})),[t,w]);return r.a.createElement(g.a,{id:`${u}-${t}-${f}`},r.a.createElement(r.a.Fragment,null,r.a.createElement(h,{className:x,color:"hollow",title:"",iconOnClick:O,iconOnClickAriaLabel:y.t,iconType:"cross",iconSide:"right",onClick:c,onClickAriaLabel:M,closeButtonProps:k,"data-test-subj":"providerBadge",$timelineType:E},T),E===o.l.template&&l!==v.c&&r.a.createElement(S,{toggleType:d,type:j})))}));w.displayName="ProviderBadge";var C=n(0),T=n.n(C),M=n(748);const I="edit-data-provider",A="exclude-data-provider",P="enable-data-provider",_="filter-for-field-present-data-provider",D="delete-data-provider",F=f()(c.EuiPopover).withConfig({displayName:"MyEuiPopover",componentId:"sc-2zwix7-0"})(["height:100%;user-select:none;"]);F.displayName="MyEuiPopover";class provider_item_actions_ProviderItemActions extends r.a.PureComponent{constructor(...e){super(...e),T()(this,"onDataProviderEdited",(({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,value:s,type:o})=>{null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,value:s,type:o}),this.props.closePopover()})),T()(this,"onFilterForFieldPresent",(()=>{const{andProviderId:e,field:t,timelineId:n,providerId:a,value:i,type:r}=this.props;null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:!1,field:t,id:`${n}`,operator:v.b,providerId:a,value:i,type:r}),this.props.closePopover()}))}render(){const{andProviderId:e,browserFields:t,button:n,closePopover:a,deleteProvider:i,field:s,isEnabled:l,isExcluded:u,isLoading:d,isOpen:m,operator:p,providerId:f,timelineId:b,timelineType:g,toggleEnabledProvider:h,toggleExcludedProvider:j,toggleTypeProvider:E,value:O,type:x}=this.props,S=(({andProviderId:e,browserFields:t,deleteItem:n,field:a,isEnabled:i,isExcluded:s,isLoading:l,operator:u,onDataProviderEdited:c,onFilterForFieldPresent:d,providerId:m,timelineId:p,timelineType:f,toggleEnabled:b,toggleExcluded:g,toggleType:h,type:j,value:E})=>[{id:0,items:[{className:I,disabled:l,icon:"pencil",name:y.g,panel:1},{className:A,disabled:l,icon:s?"plusInCircle":"minusInCircle",name:s?y.p:y.i,onClick:g},{className:P,disabled:l,icon:i?"eyeClosed":"eye",name:i?y.x:y.u,onClick:b},{className:_,disabled:l,icon:"logstashFilter",name:y.k,onClick:d},f===o.l.template?{className:"convert-to-field-data-provider",disabled:l||u===v.c,icon:"visText",name:j===v.a.template?y.c:y.d,onClick:h}:{name:null},{className:D,disabled:l,icon:"trash",name:y.e,onClick:n}].filter((e=>null!=e.name))},{content:null!=t&&null!=p&&null!=c?r.a.createElement(M.a,{andProviderId:e,browserFields:t,field:a,isExcluded:s,onDataProviderEdited:c,operator:u,providerId:m,timelineId:p,value:E,type:j}):null,id:1,title:y.h,width:400}])({andProviderId:e,browserFields:t,deleteItem:i,field:s,isEnabled:l,isExcluded:u,isLoading:d,onDataProviderEdited:this.onDataProviderEdited,onFilterForFieldPresent:this.onFilterForFieldPresent,operator:p,providerId:f,timelineId:b,timelineType:g,toggleEnabled:h,toggleExcluded:j,toggleType:E,value:O,type:x});return r.a.createElement(F,{id:`popoverFor_${f}-${s}-${O}`,isOpen:m,closePopover:a,button:n,anchorPosition:"downCenter",panelPaddingSize:"none",ownFocus:!0},r.a.createElement("div",{style:{userSelect:"none"}},r.a.createElement(c.EuiContextMenu,{initialPanelId:0,panels:S,"data-test-subj":"providerActions"})))}}var N=n(195),R=n(134);const z=r.a.memo((({andProviderId:e,browserFields:t,deleteProvider:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,isPopoverOpen:f,onDataProviderEdited:b,operator:g,providerId:y,register:h,setIsPopoverOpen:j,timelineId:E,toggleEnabledProvider:O,toggleExcludedProvider:x,toggleTypeProvider:S,displayValue:k,val:C,type:T=v.a.default,wrapperRef:M})=>{const I=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),A=Object(l.b)((e=>{var t,n;return E&&null!==(t=null===(n=I(e,E))||void 0===n?void 0:n.timelineType)&&void 0!==t?t:o.l.default})),{isLoading:P}=Object(l.a)((e=>{var t;return null!==(t=I(e,null!=E?E:""))&&void 0!==t?t:R.b})),_=Object(i.useCallback)((()=>{j(!f)}),[f,j]),D=Object(i.useCallback)((()=>{var e;j(!1),null==M||null===(e=M.current)||void 0===e||e.focus()}),[M,j]),F=Object(i.useCallback)((()=>{O(),D()}),[D,O]),z=Object(i.useCallback)((()=>{x(),D()}),[x,D]),L=Object(i.useCallback)((()=>{S(),D()}),[S,D]),[B,q]=Object(i.useState)(!1),$=Object(s.useDispatch)();Object(i.useEffect)((()=>{null!=h&&($(N.a.registerProvider({provider:{...h,and:[]}})),q(!0))}),[B,$,h,q]);const V=Object(i.useCallback)((()=>{B&&null!=h&&$(N.a.unRegisterProvider({id:h.id}))}),[B,$,h]);Object(i.useEffect)((()=>()=>{V()}),[V]);const U=Object(i.useMemo)((()=>r.a.createElement(w,{deleteProvider:P?a.noop:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,providerId:y,togglePopover:_,toggleType:L,displayValue:null!=k?k:String(C),val:C,operator:g,type:T,timelineType:A})),[n,k,c,m,p,P,d,L,g,y,A,_,T,C]);return r.a.createElement(provider_item_actions_ProviderItemActions,{andProviderId:e,browserFields:t,button:U,closePopover:D,deleteProvider:n,field:c,kqlQuery:d,isEnabled:m,isExcluded:p,isLoading:P,isOpen:f,onDataProviderEdited:b,operator:g,providerId:y,timelineId:E,timelineType:A,toggleEnabledProvider:F,toggleExcludedProvider:z,toggleTypeProvider:L,value:C,type:T})}));z.displayName="ProviderItemBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(17),i=n(2),r=n.n(i);const s=n(5).i18n.translate("xpack.securitySolution.accessibility.tooltipWithKeyboardShortcut.pressTooltipLabel",{defaultMessage:"Press"}),o=({additionalScreenReaderOnlyContext:e="",content:t,shortcut:n,showShortcut:i})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{"data-test-subj":"content"},t),""!==e&&r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"additionalScreenReaderOnlyContext"},r.a.createElement("p",null,e)),i&&r.a.createElement(a.EuiText,{color:"subdued","data-test-subj":"shortcut",size:"s",textAlign:"center"},r.a.createElement("span",null,s)," ",r.a.createElement(a.EuiBadge,{color:"hollow"},n))),l=r.a.memo(o);l.displayName="TooltipWithKeyboardShortcut"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b}));var a=n(17),i=n(2),r=n.n(i),s=n(132);const o=r.a.memo((({onClick:e})=>r.a.createElement(a.EuiButtonEmpty,{color:"text","data-test-subj":"open-timeline-button",iconSide:"left",iconType:"folderOpen",onClick:e},s.G)));o.displayName="OpenTimelineModalButton";var l=n(467),u=n(244),c=n(327),d=n(466);const m="add-timeline-button",p=["createFrom"],f=({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),[s,f]=Object(i.useState)(!1),b=Object(i.useCallback)((()=>n(!t)),[t]),g=Object(i.useCallback)((()=>n(!1)),[]),v=Object(i.useCallback)((()=>f(!1)),[]),y=Object(i.useCallback)((()=>{g(),f(!0)}),[g]),h=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonIcon,{className:m,"data-test-subj":"timeline-create-open-control",iconType:"plusInCircle",iconSize:"m",color:"primary",onClick:b,"aria-label":u.a})),[b]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiPopover,{anchorPosition:"downRight",button:h,id:"timelineSettingsPopover",panelProps:{"data-test-subj":"timeline-addPopupPanel"},isOpen:t,closePopover:g,ownFocus:!0,repositionOnScroll:!0},r.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(c.c,{timelineId:e,title:u.h,onClick:g})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(d.a,{onClick:g,timelineId:e,title:u.g})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o,{onClick:y}))))),s?r.a.createElement(l.a,{onClose:v,hideActions:p}):null)},b=r.a.memo(f)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),r=n(136),s=n.n(r),o=n(19),l=n(79),u=n(15),c=n(110);const d=e=>"esql"in e?{query:e.esql,language:"esql"}:"sql"in e?{query:e.sql,language:"sql"}:e,m=Object(a.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:n=!1,indexPattern:r,isLoading:m=!1,isRefreshPaused:p,filterQuery:f,filterManager:b,filters:g,onChangedQuery:v,onSubmitQuery:y,refreshInterval:h,savedQuery:j,onSavedQuery:E,dataTestSubj:O,displayStyle:x,isDisabled:S})=>{const{data:k}=Object(c.i)().services,[w,C]=Object(a.useState)(),[T,M]=Object(a.useState)(g),I=Object(a.useCallback)((e=>{if(null!=e.query&&!s()(e.query,f)){const t=d(e.query);y(t)}}),[f,y]),A=Object(a.useCallback)((e=>{if(v&&null!=e.query&&!s()(e.query,f)){const t=d(e.query);v(t)}}),[f,v]),P=Object(a.useCallback)((e=>{const{query:t,filters:n,timefilter:a}=e.attributes;y(t,a),b.setFilters(n||[]),E(e)}),[b,y,E]),_=Object(a.useCallback)((()=>{null!=j&&(y({query:"",language:j.attributes.query.language}),b.setFilters([]),E(void 0))}),[b,y,E,j]),D=Object(a.useCallback)((e=>{b.setFilters(e)}),[b]),F="esql"===(null==f?void 0:f.language),N=Object(a.useMemo)((()=>F&&"string"==typeof f.query?{esql:f.query}:f),[f,F]);Object(a.useEffect)((()=>{let e;var t;return null!=(t=r)&&"object"==typeof t&&Object.hasOwn(t,"getName")?C(r):F||(async()=>{e=await k.dataViews.create({id:r.title,title:r.title}),C(e);const t=[...g];t.forEach((e=>e.meta.index=r.title)),M(t)})(),()=>{var t,n;null!==(t=e)&&void 0!==t&&t.id&&k.dataViews.clearInstanceCache(null===(n=e)||void 0===n?void 0:n.id)}}),[k.dataViews,g,r,F]);const R=Object(a.useMemo)((()=>new o.TimeHistory(new u.Storage(localStorage))),[]),z=Object(a.useMemo)((()=>null!=w?[w]:[]),[w]);return i.a.createElement(l.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:T,indexPatterns:z,isLoading:m,isRefreshPaused:p,query:N,onClearSavedQuery:_,onFiltersUpdated:D,onQueryChange:A,onQuerySubmit:I,onSaved:E,onSavedQueryUpdated:P,refreshInterval:h,showAutoRefreshOnly:!1,showFilterBar:!n,showDatePicker:!1,showQueryInput:!0,showSaveQuery:!0,timeHistory:R,dataTestSubj:O,savedQuery:j,displayStyle:x,isDisabled:S})}));m.displayName="QueryBar"},function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var a=n(2),i=n.n(a),r=n(48),s=n(54),o=n(127),l=n(119),u=n(147),c=n(110),d=n(172),m=n(128),p=n(134),f=n(118),b=n(318),g=n(17),v=n(44),y=n.n(v),h=n(723),j=n(752),E=n(121),O=n(521);const x=y.a.div.withConfig({displayName:"TopNContainer",componentId:"sc-149y4ld-0"})(["min-width:600px;"]),S=y()(g.EuiButtonIcon).withConfig({displayName:"CloseButton",componentId:"sc-149y4ld-1"})(["position:absolute;right:4px;top:4px;"]),k=y()(g.EuiSuperSelect).withConfig({displayName:"ViewSelect",componentId:"sc-149y4ld-2"})(["width:170px;"]),w=y.a.div.withConfig({displayName:"TopNContent",componentId:"sc-149y4ld-3"})(["margin-top:4px;margin-right:",";.euiPanel{border:none;}"],(({theme:e})=>e.eui.euiSizeXS)),C=({combinedQueries:e,defaultView:t,deleteQuery:n,filters:r,field:s,from:o,indexPattern:l,options:u,paddingSize:c,query:d,showLegend:m,setAbsoluteRangeDatePickerTarget:p,setQuery:f,scopeId:g,to:v,toggleTopN:y})=>{const[C,T]=Object(a.useState)(t),M=Object(a.useCallback)((e=>T(e)),[T]),I=Object(b.b)({scopeId:g,view:C}),{selectedPatterns:A,runtimeMappings:P}=Object(E.d)(I);Object(a.useEffect)((()=>{T(t)}),[t]);const _=Object(a.useMemo)((()=>i.a.createElement(k,{"data-test-subj":"view-select",disabled:1===u.length,onChange:M,options:u,valueOfSelected:C})),[M,u,C]),D=Object(a.useMemo)((()=>Object(b.d)({filters:r,tableId:g,view:C})),[r,g,C]);return i.a.createElement(x,{"data-test-subj":"topN-container"},i.a.createElement(w,null,"raw"===C||"all"===C?i.a.createElement(h.a,{combinedQueries:e,deleteQuery:n,filters:D,from:o,headerChildren:_,indexPattern:l,indexNames:A,runtimeMappings:P,onlyField:s,paddingSize:c,query:d,queryType:"topN",showLegend:m,setAbsoluteRangeDatePickerTarget:p,setQuery:f,showSpacer:!1,toggleTopN:y,scopeId:g,sourcererScopeId:I,to:v,hideQueryToggle:!0}):i.a.createElement(j.a,{combinedQueries:e,filters:D,headerChildren:_,onlyField:s,paddingSize:c,query:d,showLegend:m,setAbsoluteRangeDatePickerTarget:p,runtimeMappings:P,hideQueryToggle:!0})),i.a.createElement(S,{"aria-label":O.c,"data-test-subj":"close",iconType:"cross",onClick:y}))};C.displayName="TopNComponent";const T=i.a.memo(C);var M=n(122);const I=[],A={query:"",language:"kuery"},P=Object(r.connect)((()=>{const e=m.d.globalQuerySelector(),t=m.d.globalFiltersQuerySelector(),n=f.b.getTimelineByIdSelector(),a=m.d.getTimelineSelector(),i=f.b.getKqlFilterQuerySelector();return(r,s)=>{var o,l;const u=null!==(o=n(r,M.c.active))&&void 0!==o?o:p.b,c=null!==(l=u.filters)&&void 0!==l?l:I,d=a(r),{globalFilters:m}=s;return{activeTimelineEventType:u.eventType,activeTimelineFilters:u.activeTab===M.d.query?c:I,activeTimelineFrom:d.timerange.from,activeTimelineKqlQueryExpression:u.activeTab===M.d.query?i(r,M.c.active):null,activeTimelineTo:d.timerange.to,dataProviders:u.activeTab===M.d.query?u.dataProviders:[],globalQuery:e(r),globalFilters:null!=m?m:t(r),kqlMode:u.kqlMode}}})),_=({activeTimelineEventType:e,activeTimelineFilters:t,activeTimelineFrom:n,activeTimelineKqlQueryExpression:r,activeTimelineTo:m,browserFields:p,dataProviders:f,field:g,indexPattern:v,globalFilters:y=I,globalQuery:h=A,kqlMode:j,onFilterAdded:E,paddingSize:O,showLegend:x,scopeId:S,toggleTopN:k})=>{const{uiSettings:w}=Object(c.i)().services,{from:C,deleteQuery:M,setQuery:P,to:_}=Object(u.a)(),D=Object(b.a)(Object(o.isActiveTimeline)(null!=S?S:"")?e:void 0),F=Object(a.useMemo)((()=>{var e;return Object(o.isActiveTimeline)(null!=S?S:"")?null===(e=Object(d.d)({browserFields:p,config:Object(s.getEsQueryConfig)(w),dataProviders:f,filters:t,indexPattern:v,kqlMode:j,kqlQuery:{language:"kuery",query:null!=r?r:""}}))||void 0===e?void 0:e.filterQuery:void 0}),[S,p,w,f,t,v,j,r]),N=Object(a.useMemo)((()=>Object(b.c)(S)?"alert":D[0].value),[D,S]);return i.a.createElement(T,{combinedQueries:F,"data-test-subj":"top-n",defaultView:N,deleteQuery:Object(o.isActiveTimeline)(null!=S?S:"")?void 0:M,field:g,filters:Object(o.isActiveTimeline)(null!=S?S:"")?I:y,from:Object(o.isActiveTimeline)(null!=S?S:"")?n:C,indexPattern:v,options:D,paddingSize:O,query:Object(o.isActiveTimeline)(null!=S?S:"")?A:h,showLegend:x,setAbsoluteRangeDatePickerTarget:Object(o.isActiveTimeline)(null!=S?S:"")?l.a.timeline:l.a.global,setQuery:P,scopeId:S,to:Object(o.isActiveTimeline)(null!=S?S:"")?m:_,toggleTopN:k,onFilterAdded:E})};_.displayName="StatefulTopNComponent";const D=P(i.a.memo(_))},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(136),i=n.n(a),r=n(45),s=n(2),o=n(3),l=n(54),u=n(209),c=n(110),d=n(294),m=n(127),p=n(5);p.i18n.translate("xpack.securitySolution.matrixHistogram.errorSearchDescription",{defaultMessage:"An error has occurred on matrix histogram search"});const f=p.i18n.translate("xpack.securitySolution.matrixHistogram.failSearchDescription",{defaultMessage:"Failed to run search on matrix histogram"});var b=n(117),g=n(336),v=n(4);const y=[],h=({endDate:e,errorMessage:t,filterQuery:n,histogramType:a,indexNames:p,isPtrIncluded:h,onError:j,stackByField:E,runtimeMappings:O,startDate:x,threshold:S,skip:k=!1,includeMissingData:w=!0})=>{const{data:C}=Object(c.i)().services,T=Object(s.useRef)(r.noop),M=Object(s.useRef)(new AbortController),I=Object(s.useRef)(new o.Subscription),[A,P]=Object(s.useState)(!1),{startTracking:_}=Object(g.a)(),[D,F]=Object(s.useState)({defaultIndex:p,factoryQueryType:d.h,filterQuery:Object(u.a)(n),histogramType:a,timerange:{interval:"12h",from:x,to:e},stackByField:E,runtimeMappings:O,threshold:S,...null!=h?{isPtrIncluded:h}:{},...null!=w?{includeMissingData:w}:{}}),{addError:N}=Object(b.a)(),[R,z]=Object(s.useState)({data:[],inspect:{dsl:[],response:[]},refetch:T.current,totalCount:-1,buckets:[]}),L=Object(s.useCallback)((e=>{const n=async()=>{M.current=new AbortController,P(!0);const{endTracking:n}=_({name:`${v.l} matrixHistogram ${a}`});I.current=C.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:M.current.signal}).subscribe({next:e=>{if(!Object(l.isRunningResponse)(e)){const t=Object(r.getOr)(y,d.j[a],e.rawResponse);P(!1),z((n=>({...n,data:e.matrixHistogramData,inspect:Object(m.getInspectResponse)(e,n.inspect),refetch:T.current,totalCount:t.reduce(((e,t)=>t.doc_count+e),0),buckets:t}))),n("success"),I.current.unsubscribe()}},error:e=>{P(!1),N(e,{title:null!=t?t:f}),n("error"),I.current.unsubscribe()}})};I.current.unsubscribe(),M.current.abort(),n(),T.current=n}),[C.search,a,N,t,_]);return Object(s.useEffect)((()=>{F((t=>{const r={...t,defaultIndex:p,filterQuery:Object(u.a)(n),histogramType:a,timerange:{interval:"12h",from:x,to:e},stackByField:E,threshold:S,...null!=h?{isPtrIncluded:h}:{}};return i()(t,r)?t:r}))}),[p,e,n,x,E,a,S,h]),Object(s.useEffect)((()=>(k||L(D),()=>{I.current.unsubscribe(),M.current.abort()})),[D,L,k]),Object(s.useEffect)((()=>{k&&(P(!1),I.current.unsubscribe(),M.current.abort())}),[k]),[A,R,Object(s.useCallback)(((e,t)=>{L({...D,timerange:{interval:"12h",from:t,to:e}})}),[D,L])]},j=e=>{const[t,n]=h({...e,includeMissingData:!0}),a=Object(s.useMemo)((()=>!e.stackByField.endsWith(".ip")),[e.stackByField]),[i,r]=h({...e,includeMissingData:!1,skip:a||void 0===e.filterQuery||e.skip}),o=Object(s.useMemo)((()=>t||i),[t,i]),l=Object(s.useMemo)((()=>{if(a)return n;const{data:e,inspect:t,totalCount:i,refetch:s,buckets:l}=n,{data:u,inspect:c,totalCount:d,refetch:m}=r,p=()=>{s(),m()};return o?{data:[],inspect:{dsl:[],response:[]},refetch:p,totalCount:-1,buckets:[]}:{data:[...e,...u],inspect:{dsl:[...t.dsl,...c.dsl],response:[...t.response,...c.response]},totalCount:i+d,refetch:p,buckets:l}}),[o,n,r,a]);return[o,l]}},,,,,,,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return a.useMemo((function(){return e.apply(void 0,t)}),t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.createContext(void 0);return[function(){var e=a.useContext(n);if(null==e)throw new Error("useReducerContext must be used inside a ReducerProvider.");return e},function(i){var r=i.children,s=i.initialState;return function(e,t){return a.createElement(n.Provider,e,t)}({value:a.useReducer(e,void 0!==s?s:t)},r)},n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(254));t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,a=(n=e,function(e,t){return n.reduceRight((function(t,n){return n(e)(t)}),t)});return function(e,t,n){void 0===n&&(n=function(e){return e});var s=i.useRef(n(t)),o=i.useState(s.current)[1],l=i.useCallback((function(t){return s.current=e(s.current,t),o(s.current),t}),[e]),u=i.useRef(a({getState:function(){return s.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u.current.apply(u,e)}},l));return r.default((function(){u.current=a({getState:function(){return s.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u.current.apply(u,e)}},l)}),[l]),[s.current,u.current]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.createContext(void 0);return[function(){var e=a.useContext(t);if(null==e)throw new Error("useStateContext must be used inside a StateProvider.");return e},function(n){var i=n.children,r=n.initialValue;return function(e,n){return a.createElement(t.Provider,e,n)}({value:a.useState(void 0!==r?r:e)},i)},t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(407));t.default=function(e,t){void 0===t&&(t=[]);var n=i.useState(0),s=n[0],o=n[1],l=r.default(e,a.__spreadArrays(t,[s])),u=l.loading,c=i.useCallback((function(){u||o((function(e){return e+1}))}),a.__spreadArrays(t,[u]));return a.__assign(a.__assign({},l),{retry:c})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(499)).default("audio");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r="object"==typeof navigator?navigator:void 0,s=r&&"function"==typeof r.getBattery;t.default=s?function(){var e=a.useState({isSupported:!0,fetched:!1}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,a=null,s=function(){if(e&&a){var r={isSupported:!0,fetched:!0,level:a.level,charging:a.charging,dischargingTime:a.dischargingTime,chargingTime:a.chargingTime};!i.isDeepEqual(t,r)&&n(r)}};return r.getBattery().then((function(t){e&&(a=t,i.on(a,"chargingchange",s),i.on(a,"chargingtimechange",s),i.on(a,"dischargingtimechange",s),i.on(a,"levelchange",s),s())})),function(){e=!1,a&&(i.off(a,"chargingchange",s),i.off(a,"chargingtimechange",s),i.off(a,"dischargingtimechange",s),i.off(a,"levelchange",s))}}),[]),t}:function(){return{isSupported:!1}}},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var a,i,r;if(Array.isArray(t)){if((a=t.length)!=n.length)return!1;for(i=a;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((a=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=a;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,r[i]))return!1;for(i=a;0!=i--;){var s=r[i];if(!("_owner"===s&&t.$$typeof||e(t[s],n[s])))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===e&&(e=!0);var n=a.useCallback((function(n){if("function"!=typeof e||e())return n.preventDefault(),t&&(n.returnValue=t),t}),[e,t]);a.useEffect((function(){if(e)return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}),[e,n])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(500));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r=["mousedown","touchstart"];t.default=function(e,t,n){void 0===n&&(n=r);var s=a.useRef(t);a.useEffect((function(){s.current=t}),[t]),a.useEffect((function(){for(var t=function(t){var n=e.current;n&&!n.contains(t.target)&&s.current(t)},a=0,r=n;a<r.length;a++){var o=r[a];i.on(document,o,t)}return function(){for(var e=0,a=n;e<a.length;e++){var r=a[e];i.off(document,r,t)}}}),[n,e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(779));t.default=function(e){var t=i.useState((function(){return r.default.get(e)||null})),n=t[0],a=t[1];return[n,i.useCallback((function(t,n){r.default.set(e,t,n),a(t)}),[e]),i.useCallback((function(){r.default.remove(e),a(null)}),[e])]}},function(e,t,n){var a,i,r;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */r=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(a){function i(){}function r(t,n,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},i.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(e){}n=a.write?a.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var o="";for(var l in r)r[l]&&(o+="; "+l,!0!==r[l]&&(o+="="+r[l].split(";")[0]));return document.cookie=t+"="+n+o}}function s(e,n){if("undefined"!=typeof document){for(var i={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var o=r[s].split("="),l=o.slice(1).join("=");n||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var u=t(o[0]);if(l=(a.read||a)(l,u)||t(l),n)try{l=JSON.parse(l)}catch(e){}if(i[u]=l,e===u)break}catch(e){}}return e?i[e]:i}}return i.set=r,i.get=function(e){return s(e,!1)},i.getJSON=function(e){return s(e,!0)},i.remove=function(t,n){r(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))},void 0===(i="function"==typeof(a=r)?a.call(t,n,t,e):a)||(e.exports=i),e.exports=r()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(487)),r=n(2),s=a.__importDefault(n(207)),o=a.__importDefault(n(255));t.default=function(){var e=s.default(),t=o.default({value:void 0,error:void 0,noUserInteraction:!0}),n=t[0],a=t[1];return[n,r.useCallback((function(t){var n,r;if(e())try{if("string"!=typeof t&&"number"!=typeof t){var s=new Error("Cannot copy typeof "+typeof t+" to clipboard, must be a string");return void a({value:t,error:s,noUserInteraction:!0})}if(""===t)return s=new Error("Cannot copy empty string to clipboard."),void a({value:t,error:s,noUserInteraction:!0});r=t.toString(),n=i.default(r),a({value:r,error:void 0,noUserInteraction:n})}catch(s){a({value:r,error:s,noUserInteraction:n})}}),[])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(782),r=n(783),s=n(784),o=n(786),l=n(2),u=a.__importDefault(n(40)),c=i.create();r.addon(c),s.addon(c);var d=0;t.default=function(e){var t=l.useMemo((function(){return"react-use-css-"+(d++).toString(36)}),[]),n=l.useMemo((function(){return new c.VSheet}),[]);return u.default((function(){var a={};return o.cssToTree(a,e,"."+t,""),n.diff(a),function(){n.diff({})}})),t}},function(e,t,n){"use strict";var a=/[A-Z]/g;t.create=function(e){var t=(e=e||{}).assign||Object.assign,n=t({raw:"",pfx:"_",client:"object"==typeof window,assign:t,stringify:JSON.stringify,kebab:function(e){return e.replace(a,"-$&").toLowerCase()},decl:function(e,t){return(e=n.kebab(e))+":"+t+";"},hash:function(e){return function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return"_"+(t>>>0).toString(36)}(n.stringify(e))},selector:function(e,t){return e+(":"===t[0]?"":" ")+t},putRaw:function(e){n.raw+=e}},e);return n.client&&(n.sh||document.head.appendChild(n.sh=document.createElement("style")),n.putRaw=function(e){var t=n.sh.sheet;try{t.insertRule(e,t.cssRules.length)}catch(e){}}),n.put=function(e,t,a){var i,r,s="",o=[];for(i in t)(r=t[i])instanceof Object&&!(r instanceof Array)?o.push(i):s+=n.decl(i,r,e,a);s&&(s=e+"{"+s+"}",n.putRaw(a?a+"{"+s+"}":s));for(var l=0;l<o.length;l++)"@"===(i=o[l])[0]&&"@font-face"!==i?n.putAt(e,t[i],i):n.put(n.selector(e,i),t[i],a)},n.putAt=n.put,n}},function(e,t,n){"use strict";t.addon=function(e){e.client&&(document.head.appendChild(e.msh=document.createElement("style")),e.createRule=function(t,n){var a=t+"{}";n&&(a=n+"{"+a+"}");var i=n?e.msh.sheet:e.sh.sheet,r=i.insertRule(a,i.cssRules.length),s=(i.cssRules||i.rules)[r];if(s.index=r,n){var o=(s.cssRules||s.rules)[0];s.style=o.style,s.styleMap=o.styleMap}return s})}},function(e,t,n){"use strict";var a=n(785).removeRule;t.addon=function(e){if(e.client){var t=e.kebab;n.prototype.diff=function(e){var n,a=this.decl,i=this.rule.style;for(n in a)void 0===e[n]&&i.removeProperty(n);for(n in e)e[n]!==a[n]&&i.setProperty(t(n),e[n]);this.decl=e},n.prototype.del=function(){a(this.rule)},i.prototype.diff=function(e){var t=this.tree;for(var a in t)if(void 0===e[a]){var i=t[a];for(var r in i)i[r].del()}for(var a in e)if(void 0===t[a])for(var r in e[a])(l=new n(r,a)).diff(e[a][r]),e[a][r]=l;else{var s=t[a],o=e[a];for(var r in s)o[r]||s[r].del();for(var r in o){var l;(l=s[r])?(l.diff(o[r]),o[r]=l):((l=new n(r,a)).diff(o[r]),o[r]=l)}}this.tree=e},e.VRule=n,e.VSheet=i}function n(t,n){this.rule=e.createRule(t,n),this.decl={}}function i(){this.tree={}}}},function(e,t){t.removeRule=function(e){var t=e.index,n=e.parentStyleSheet,a=n.cssRules||n.rules;for(t=Math.max(t,a.length-1);t>=0;){if(a[t]===e){n.deleteRule(t);break}t--}}},function(e,t){t.cssToTree=function e(t,n,a,i){var r,s,o={},l=!1;for(r in n)"object"!=typeof(s=n[r])&&(l=!0,o[r]=s);for(r in l&&(t[i]||(t[i]={}),t[i][a]=o),n)if("object"==typeof(s=n[r]))if("@"===r[0])e(t,s,a,r);else{var u=r.indexOf("&")>-1,c=a.split(",");if(u)for(var d=0;d<c.length;d++)c[d]=r.replace(/&/g,c[d]);else for(d=0;d<c.length;d++)c[d]=c[d]+" "+r;e(t,s,c.join(","),i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(376));t.default=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var a=r.default(e,t),s=a[0],o=a[1],l=a[2];return i.useEffect(l,n),[s,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(t),i=n[0],r=n[1];return null==i?[e,r]:[i,r]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=function(){};t.default=function(e,t){void 0===e&&(e={}),void 0===t&&(t=[]);var n=e.onFiles,s=e.onText,o=e.onUri,l=i.useState(!1),u=l[0],c=l[1],d=i.useCallback(c,[]),m=i.useMemo((function(){return function(e){return function(t,n){var a=t.getData("text/uri-list");if(a)(e.onUri||r)(a,n);else if(t.files&&t.files.length)(e.onFiles||r)(Array.from(t.files),n);else if(n.clipboardData){var i=n.clipboardData.getData("text");(e.onText||r)(i,n)}}}(e)}),[n,s,o]);return i.useEffect((function(){var e=function(e){e.preventDefault(),d(!0)},t=function(e){e.preventDefault(),d(!0)},n=function(){d(!1)},a=function(){d(!1)},i=function(e){e.preventDefault(),d(!1),m(e.dataTransfer,e)},r=function(e){m(e.clipboardData,e)};return document.addEventListener("dragover",e),document.addEventListener("dragenter",t),document.addEventListener("dragleave",n),document.addEventListener("dragexit",a),document.addEventListener("drop",i),s&&document.addEventListener("paste",r),function(){document.removeEventListener("dragover",e),document.removeEventListener("dragenter",t),document.removeEventListener("dragleave",n),document.removeEventListener("dragexit",a),document.removeEventListener("drop",i),document.removeEventListener("paste",r)}}),a.__spreadArrays([m],t)),{over:u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(207)),s=function(){};t.default=function(e){void 0===e&&(e={});var t=e.onFiles,n=e.onText,a=e.onUri,o=r.default(),l=i.useState(!1),u=l[0],c=l[1],d=i.useMemo((function(){return function(e,t){return function(n,a){var i=n.getData("text/uri-list");i?(e.onUri||s)(i,a):n.files&&n.files.length?(e.onFiles||s)(Array.from(n.files),a):n.items&&n.items.length&&n.items[0].getAsString((function(n){t&&(e.onText||s)(n,a)}))}}(e,o())}),[t,n,a]),m=i.useMemo((function(){return function(e,t){return{onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault(),t(!0)},onDragLeave:function(){t(!1)},onDrop:function(n){n.preventDefault(),n.persist(),t(!1),e(n.dataTransfer,n)},onPaste:function(t){t.persist(),e(t.clipboardData,t)}}}(d,c)}),[d,c]);return[m,{over:u}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensuredForwardRef=void 0;var a=n(2);function i(e){var t=a.useRef(e&&e.current);return a.useEffect((function(){e&&(e.current=t.current)}),[e]),t}t.default=i,t.ensuredForwardRef=function(e){return a.forwardRef((function(t,n){var a=i(n);return e(t,a)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(null),t=e[0],n=e[1];return a.useEffect((function(){if(t)throw t}),[t]),a.useCallback((function(e){n(e)}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect((function(){var t=document.querySelector("link[rel*='icon']")||document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(795)),s=a.__importDefault(n(40)),o=function(){};t.default=function(e,t,n){void 0===n&&(n={});var a=n.video,l=n.onClose,u=void 0===l?o:l,c=i.useState(t),d=c[0],m=c[1];return s.default((function(){if(t&&e.current){var n=function(){a.current.removeEventListener("webkitendfullscreen",n),u()},i=function(){if(r.default.isEnabled){var e=r.default.isFullscreen;m(e),e||u()}};if(r.default.isEnabled){try{r.default.request(e.current),m(!0)}catch(e){u(e),m(!1)}r.default.on("change",i)}else a&&a.current&&a.current.webkitEnterFullscreen?(a.current.webkitEnterFullscreen(),a.current.addEventListener("webkitendfullscreen",n),m(!0)):(u(),m(!1));return function(){if(m(!1),r.default.isEnabled)try{r.default.off("change",i),r.default.exit()}catch(e){}else a&&a.current&&a.current.webkitExitFullscreen&&(a.current.removeEventListener("webkitendfullscreen",n),a.current.webkitExitFullscreen())}}}),[t,a,e]),d}},function(e,t,n){
/*!
* screenfull
* v5.0.0 - 2019-09-09
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,a=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=0,i=n.length,r={};a<i;a++)if((e=n[a])&&e[1]in t){for(a=0;a<e.length;a++)r[n[0][a]]=e[a];return r}return!1}(),i={change:a.fullscreenchange,error:a.fullscreenerror},r={request:function(e){return new Promise(function(n,i){var r=function(){this.off("change",r),n()}.bind(this);this.on("change",r),e=e||t.documentElement,Promise.resolve(e[a.requestFullscreen]()).catch(i)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var i=function(){this.off("change",i),e()}.bind(this);this.on("change",i),Promise.resolve(t[a.exitFullscreen]()).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var a=i[e];a&&t.addEventListener(a,n,!1)},off:function(e,n){var a=i[e];a&&t.removeEventListener(a,n,!1)},raw:a};a?(Object.defineProperties(r,{isFullscreen:{get:function(){return Boolean(t[a.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[a.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[a.fullscreenEnabled])}}}),n?e.exports=r:window.screenfull=r):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){var t,n=i.useState({loading:!0,accuracy:null,altitude:null,altitudeAccuracy:null,heading:null,latitude:null,longitude:null,speed:null,timestamp:Date.now()}),r=n[0],s=n[1],o=!0,l=function(e){o&&s({loading:!1,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,latitude:e.coords.latitude,longitude:e.coords.longitude,speed:e.coords.speed,timestamp:e.timestamp})},u=function(e){return o&&s((function(t){return a.__assign(a.__assign({},t),{loading:!1,error:e})}))};return i.useEffect((function(){return navigator.geolocation.getCurrentPosition(l,u,e),t=navigator.geolocation.watchPosition(l,u,e),function(){o=!1,navigator.geolocation.clearWatch(t)}}),[]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(223));t.default=function(e){void 0===e&&(e={});var t=r.default(),n=i.useRef(a.__assign({},e));return[i.useCallback((function(){return n.current}),[]),i.useCallback((function(e){e&&(Object.assign(n.current,e),t())}),[])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(799);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=i.setHarmonicInterval((function(){return n.current()}),t);return function(){return i.clearHarmonicInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0,i={};t.clearHarmonicInterval=function(e){var t=e.bucket,n=e.id;delete t.listeners[n];var a=!1;for(var r in t.listeners){a=!0;break}a||(clearInterval(t.timer),delete i[t.ms])},t.setHarmonicInterval=function(e,t){var n,r=a++;if(i[t])i[t].listeners[r]=e;else{var s=setInterval((function(){for(var e,n=i[t].listeners,a=!1,r=0,s=Object.values(n);r<s.length;r++){var o=s[r];try{o()}catch(t){a=!0,e=t}}if(a)throw e}),t);i[t]={ms:t,timer:s,listeners:(n={},n[r]=e,n)}}return{bucket:i[t],id:r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importStar(n(2)),i=a.useState,r=function(){};t.default=function(e){var t,n,s=i(!1),o=s[0],l=s[1];return"function"==typeof e&&(e=e(o)),[a.cloneElement(e,{onMouseEnter:(n=e.props.onMouseEnter,function(e){(n||r)(e),l(!0)}),onMouseLeave:(t=e.props.onMouseLeave,function(e){(t||r)(e),l(!1)})}),o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(802),r=n(131),s=["mousemove","mousedown","resize","keydown","touchstart","wheel"];t.default=function(e,t,n){void 0===e&&(e=6e4),void 0===t&&(t=!1),void 0===n&&(n=s);var o=a.useState(t),l=o[0],u=o[1];return a.useEffect((function(){for(var t,a=!0,s=l,o=function(e){a&&(s=e,u(e))},c=i.throttle(50,(function(){s&&o(!1),clearTimeout(t),t=setTimeout((function(){return o(!0)}),e)})),d=function(){document.hidden||c()},m=0;m<n.length;m++)r.on(window,n[m],c);return r.on(document,"visibilitychange",d),t=setTimeout((function(){return o(!0)}),e),function(){a=!1;for(var e=0;e<n.length;e++)r.off(window,n[e],c);r.off(document,"visibilitychange",d)}}),[e,n]),l}},function(e,t,n){"use strict";function a(e,t,n,a){var i,r=!1,s=0;function o(){i&&clearTimeout(i)}function l(){var l=this,u=Date.now()-s,c=arguments;function d(){s=Date.now(),n.apply(l,c)}r||(a&&!i&&d(),o(),void 0===a&&u>e?d():!0!==t&&(i=setTimeout(a?function(){i=void 0}:d,void 0===a?e-u:e)))}return"boolean"!=typeof t&&(a=n,n=t,t=void 0),l.cancel=function(){o(),r=!0},l}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=a,t.debounce=function(e,t,n){return void 0===n?a(e,t,!1):a(e,n,!1!==t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(null),i=n[0],r=n[1];return a.useEffect((function(){if(e.current&&"function"==typeof IntersectionObserver){var n=new IntersectionObserver((function(e){r(e[0])}),t);return n.observe(e.current),function(){r(null),n.disconnect()}}return function(){}}),[e.current,t.threshold,t.root,t.rootMargin]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=setInterval((function(){return n.current()}),t||0);return function(){return clearInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return void 0===e&&(e={laptopL:1440,laptop:1024,tablet:768}),function(){var t=a.useState(0),n=t[0],i=t[1];a.useEffect((function(){var e=function(){i(window.innerWidth)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}));var r=a.useMemo((function(){return Object.entries(e).sort((function(e,t){return e[1]>=t[1]?1:-1}))}),[e]),s=r.reduce((function(e,t){var a=t[0],i=t[1];return n>=i?a:e}),r[0][0]);return s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(505)),r=a.__importDefault(n(254));t.default=function(e,t,n,a){void 0===a&&(a=i.default);var s=a(e),o=s[0],l=s[1];r.default((function(){!o&&n?n(l):o&&t&&t(l)}),[o])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r=function(){};t.default=function(e,t,n){if(!i.isClient)return[t,r,r];if(!e)throw new Error("useLocalStorage key may not be falsy");var s=n?n.raw?function(e){return e}:n.deserializer:JSON.parse,o=a.useState((function(){try{var a=n?n.raw?String:n.serializer:JSON.stringify,i=localStorage.getItem(e);return null!==i?s(i):(t&&localStorage.setItem(e,a(t)),t)}catch(e){return t}})),l=o[0],u=o[1],c=a.useCallback((function(t){try{var a="function"==typeof t?t(l):t;if(void 0===a)return;var i;i=n?n.raw?"string"==typeof a?a:JSON.stringify(a):n.serializer?n.serializer(a):JSON.stringify(a):JSON.stringify(a),localStorage.setItem(e,i),u(s(i))}catch(e){}}),[e,u]),d=a.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[l,c,d]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r=function(e){var t=window.history,n=t[e];t[e]=function(t){var a=n.apply(this,arguments),i=new Event(e.toLowerCase());return i.state=t,window.dispatchEvent(i),a}};i.isClient&&(r("pushState"),r("replaceState"));var s=function(e){var t=window.history,n=t.state,a=t.length,i=window.location;return{trigger:e,state:n,length:a,hash:i.hash,host:i.host,hostname:i.hostname,href:i.href,origin:i.origin,pathname:i.pathname,port:i.port,protocol:i.protocol,search:i.search}},o="function"==typeof Event;t.default=i.isClient&&o?function(){var e=a.useState(s("load")),t=e[0],n=e[1];return a.useEffect((function(){var e=function(){return n(s("popstate"))},t=function(){return n(s("pushstate"))},a=function(){return n(s("replacestate"))};return i.on(window,"popstate",e),i.on(window,"pushstate",t),i.on(window,"replacestate",a),function(){i.off(window,"popstate",e),i.off(window,"pushstate",t),i.off(window,"replacestate",a)}}),[]),t}:function(){return{trigger:"load",length:1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestBody=void 0;var a=n(2);function i(e){if(!e)return null;if("BODY"===e.tagName)return e;if("IFRAME"===e.tagName){var t=e.contentDocument;return t?t.body:null}return e.offsetParent?i(e.offsetParent):null}function r(e){var t=e||window.event;return t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)}t.getClosestBody=i;var s="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),o=new Map,l="object"==typeof document?document:void 0,u=!1;t.default=l?function(e,t){void 0===e&&(e=!0);var n=a.useRef(l.body);t=t||n;var c=function(e){var t=o.get(e);t&&(1===t.counter?(o.delete(e),s?(e.ontouchmove=null,u&&(document.removeEventListener("touchmove",r),u=!1)):e.style.overflow=t.initialOverflow):o.set(e,{counter:t.counter-1,initialOverflow:t.initialOverflow}))};a.useEffect((function(){var n=i(t.current);n&&(e?function(e){var t=o.get(e);t?o.set(e,{counter:t.counter+1,initialOverflow:t.initialOverflow}):(o.set(e,{counter:1,initialOverflow:e.style.overflow}),s?u||(document.addEventListener("touchmove",r,{passive:!1}),u=!0):e.style.overflow="hidden")}(n):c(n))}),[e,t.current]),a.useEffect((function(){var e=i(t.current);if(e)return function(){c(e)}}),[])}:function(e,t){void 0===e&&(e=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(256)),r=a.__importDefault(n(254));t.default=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];i.default((function(){return console.log.apply(console,a.__spreadArrays([e+" mounted"],t)),function(){return console.log(e+" unmounted")}})),r.default((function(){console.log.apply(console,a.__spreadArrays([e+" updated"],t))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};t.default=function(e,t){var n=void 0===t?{}:t,r=n.isPreventDefault,s=void 0===r||r,o=n.delay,l=void 0===o?300:o,u=a.useRef(),c=a.useRef(),d=a.useCallback((function(t){s&&t.target&&(t.target.addEventListener("touchend",i,{passive:!1}),c.current=t.target),u.current=setTimeout((function(){return e(t)}),l)}),[e,l,s]),m=a.useCallback((function(){u.current&&clearTimeout(u.current),s&&c.current&&c.current.removeEventListener("touchend",i)}),[s]);return{onMouseDown:function(e){return d(e)},onTouchStart:function(e){return d(e)},onMouseUp:m,onMouseLeave:m,onTouchEnd:m}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131);t.default=function(e,t){void 0===t&&(t=!1);var n=a.useState(i.isClient?function(){return window.matchMedia(e).matches}:t),r=n[0],s=n[1];return a.useEffect((function(){var t=!0,n=window.matchMedia(e),a=function(){t&&s(!!n.matches)};return n.addListener(a),s(n.matches),function(){t=!1,n.removeListener(a)}}),[e]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r=function(){};t.default="object"==typeof navigator&&navigator.mediaDevices?function(){var e=a.useState({}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,t=function(){navigator.mediaDevices.enumerateDevices().then((function(t){e&&n({devices:t.map((function(e){return{deviceId:e.deviceId,groupId:e.groupId,kind:e.kind,label:e.label}}))})})).catch(r)};return i.on(navigator.mediaDevices,"devicechange",t),t(),function(){e=!1,i.off(navigator.mediaDevices,"devicechange",t)}}),[]),t}:function(){return{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMediatedState=void 0;var a=n(2);t.useMediatedState=function(e,t){var n=a.useRef(e),i=a.useState(t),r=i[0],s=i[1];return[r,a.useCallback((function(e){2===n.current.length?n.current(e,s):s(n.current(e))}),[r])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useMemo((function(){return function(t,n){var a;return(a=e(t))[n.type].apply(a,n.payload)}}),[e]),i=a.useReducer(n,t),r=i[0],s=i[1],o=a.useMemo((function(){return Object.keys(e(t)).reduce((function(e,t){return e[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return s({type:t,payload:e})},e}),{})}),[e,t]);return[r,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r={acceleration:{x:null,y:null,z:null},accelerationIncludingGravity:{x:null,y:null,z:null},rotationRate:{alpha:null,beta:null,gamma:null},interval:16};t.default=function(e){void 0===e&&(e=r);var t=a.useState(e),n=t[0],s=t[1];return a.useEffect((function(){var e=function(e){var t=e.acceleration,n=e.accelerationIncludingGravity,a=e.rotationRate,i=e.interval;s({acceleration:{x:t.x,y:t.y,z:t.z},accelerationIncludingGravity:{x:n.x,y:n.y,z:n.z},rotationRate:{alpha:a.alpha,beta:a.beta,gamma:a.gamma},interval:i})};return i.on(window,"devicemotion",e),function(){i.off(window,"devicemotion",e)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(503)),r=a.__importDefault(n(510)),s={current:null};t.default=function(e,t){void 0===t&&(t={});var n=!!t.whenHovered,a=!!t.bound,o=i.default(e,n),l=r.default(n&&!o?s:e);return a&&(l.elX=Math.max(0,Math.min(l.elX,l.elW)),l.elY=Math.max(0,Math.min(l.elY,l.elH))),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(0),t=e[0],n=e[1];return a.useEffect((function(){var e=function(e){n(e.deltaY+t)};return window.addEventListener("wheel",e,!1),function(){return window.removeEventListener("wheel",e)}})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=n(131),s=function(){if("object"!=typeof navigator)return null;var e=navigator;return e.connection||e.mozConnection||e.webkitConnection},o=function(){var e=s();return e?{downlink:e.downlink,downlinkMax:e.downlinkMax,effectiveType:e.effectiveType,type:e.type,rtt:e.rtt}:{}};t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],l=t[1];return i.useEffect((function(){var e=n,t=function(t){e=a.__assign(a.__assign({},e),t),l(e)},i=s(),u=function(){t({online:!0,since:new Date})},c=function(){t({online:!1,since:new Date})},d=function(){t(o())};return r.on(window,"online",u),r.on(window,"offline",c),i&&(r.on(i,"change",d),t(a.__assign(a.__assign(a.__assign({},n),{online:navigator.onLine,since:void 0}),o()))),function(){r.off(window,"online",u),r.off(window,"offline",c),i&&r.off(i,"change",d)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(501));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r={angle:0,type:"landscape-primary"};t.default=function(e){void 0===e&&(e=r);var t=window.screen,n=a.useState(e),s=n[0],o=n[1];return a.useEffect((function(){var n=!0,a=function(){if(n){var a=t.orientation;if(a){var i=a.angle,r=a.type;o({angle:i,type:r})}else window.orientation?o({angle:"number"==typeof window.orientation?window.orientation:0,type:""}):o(e)}};return i.on(window,"orientationchange",a),a(),function(){n=!1,i.off(window,"orientationchange",a)}}),[]),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=[]),a.useEffect((function(){if(e){var t=function(t){var n=(t=t||window.event).relatedTarget||t.toElement;n&&"HTML"!==n.nodeName||e()};return document.addEventListener("mouseout",t),function(){document.removeEventListener("mouseout",t)}}}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r=function(){};t.default=function(e){var t=!0,n=null,s=a.useState(""),o=s[0],l=s[1],u=function(){t&&n&&l(n.state)};return a.useEffect((function(){return navigator.permissions.query(e).then((function(e){n=e,u(),i.on(n,"change",u)})).catch(r),function(){t=!1,n&&i.off(n,"change",u)}}),[]),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(300),r=function(e,t){return e===t};t.default=function(e,t){void 0===t&&(t=r);var n=a.useRef(),s=a.useRef(e);return i.useFirstMountState()||t(s.current,e)||(n.current=s.current,s.current=e),n.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(207));t.default=function(){var e=r.default();return i.useCallback((function(t){return new Promise((function(n,a){t.then((function(t){e()&&n(t)}),(function(t){e()&&a(t)}))}))}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){void 0===e&&(e=[]);var t=i.useState(e),n=t[0],r=t[1];return{add:function(e){r((function(t){return a.__spreadArrays(t,[e])}))},remove:function(){var e;return r((function(t){var n=t[0],a=t.slice(1);return e=n,a})),e},get first(){return n[0]},get last(){return n[n.length-1]},get size(){return n.length}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useRef(null),i=a.useRef(!1),r=a.useRef(e);r.current=e;var s=a.useCallback((function(e){i.current&&(r.current(e),n.current=requestAnimationFrame(s))}),[]),o=a.useMemo((function(){return[function(){i.current&&(i.current=!1,n.current&&cancelAnimationFrame(n.current))},function(){i.current||(i.current=!0,n.current=requestAnimationFrame(s))},function(){return i.current}]}),[]);return a.useEffect((function(){return t&&o[1](),o[0]}),[]),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e,t){return new URLSearchParams(e).get(t)};t.default="object"==typeof window?function(e){var t=window.location,n=a.useState((function(){return i(t.search,e)})),r=n[0],s=n[1];return a.useEffect((function(){var n=function(){s(i(t.search,e))};return window.addEventListener("popstate",n),window.addEventListener("pushstate",n),window.addEventListener("replacestate",n),function(){window.removeEventListener("popstate",n),window.removeEventListener("pushstate",n),window.removeEventListener("replacestate",n)}}),[]),r}:function(){return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScratchSensor=void 0;var a=n(38),i=n(2),r=n(830),s=a.__importDefault(n(506)),o=function(){},l=function(e){void 0===e&&(e={});var t=e.disabled,n=s.default(e),r=i.useState({isScratching:!1}),l=r[0],u=r[1],c=i.useRef(l),d=i.useRef(!1),m=i.useRef(null),p=i.useState(null),f=p[0],b=p[1];return i.useEffect((function(){if(!t&&f){var e,i,r=function(e,t){cancelAnimationFrame(m.current),m.current=requestAnimationFrame((function(){var i=f.getBoundingClientRect(),r=i.left,s=i.top,l=r+window.scrollX,d=s+window.scrollY,m=e-l,p=t-d;u((function(e){var t=a.__assign(a.__assign({},e),{dx:m-(e.x||0),dy:p-(e.y||0),end:Date.now(),isScratching:!0});return c.current=t,(n.current.onScratch||o)(t),t}))}))},s=function(e){r(e.pageX,e.pageY)},l=function(e){r(e.changedTouches[0].pageX,e.changedTouches[0].pageY)},p=function(){d.current&&(d.current=!1,c.current=a.__assign(a.__assign({},c.current),{isScratching:!1}),(n.current.onScratchEnd||o)(c.current),u({isScratching:!1}),window.removeEventListener("mousemove",s),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i))};e=p,i=p;var b=function(t,a){if(d.current){var r=f.getBoundingClientRect(),m=r.left,p=r.top,b=m+window.scrollX,g=p+window.scrollY,v=t-b,y=a-g,h=Date.now(),j={isScratching:!0,start:h,end:h,docX:t,docY:a,x:v,y:y,dx:0,dy:0,elH:f.offsetHeight,elW:f.offsetWidth,elX:b,elY:g};c.current=j,(n.current.onScratchStart||o)(j),u(j),window.addEventListener("mousemove",s),window.addEventListener("touchmove",l),window.addEventListener("mouseup",e),window.addEventListener("touchend",i)}},g=function(e){d.current=!0,b(e.pageX,e.pageY)},v=function(e){d.current=!0,b(e.changedTouches[0].pageX,e.changedTouches[0].pageY)};return f.addEventListener("mousedown",g),f.addEventListener("touchstart",v),function(){f.removeEventListener("mousedown",g),f.removeEventListener("touchstart",v),window.removeEventListener("mousemove",s),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i),m.current&&cancelAnimationFrame(m.current),m.current=null,d.current=!1,c.current={isScratching:!1},u(c.current)}}}),[f,t,n]),[b,l]};t.ScratchSensor=function(e){e.children;var t=a.__rest(e,["children"]),n=l(t),s=n[0],o=n[1],u=r.render(e,o);return i.cloneElement(u,a.__assign(a.__assign({},u.props),{ref:function(e){u.props.ref&&("object"==typeof u.props.ref&&(u.props.ref.current=e),"function"==typeof u.props.ref&&u.props.ref(e)),s(e)}}))},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hookToRenderProp=t.createEnhancer=t.render=void 0;var a=n(38),i=a.__importDefault(n(512));t.render=i.default;var r=a.__importDefault(n(831));t.createEnhancer=r.default;var s=a.__importDefault(n(834));t.hookToRenderProp=s.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.divWrapper=void 0;var a=n(38),i=a.__importStar(n(2)),r=a.__importDefault(n(832)),s=i.createElement,o=function(e,t,n,i){var r;return s(e,t?a.__assign(((r={})[t]=i,r),n):a.__assign(a.__assign({},i),n))};t.divWrapper=function(e,t,n,a){return s("div",null,o(e,t,n,a))},t.default=function(e,t,n){void 0===n&&(n=o);var a=function(i,o,l){void 0===o&&(o=t),void 0===l&&(l=null);var u="string"==typeof i;if(u)return function(e){return a(e,i||t,o)};var c=function(t){return s(e,l,(function(e){return n(i,o,t,e)}))};return u?r.default(c):c};return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(833));t.default=function(e){return e.prototype?e:a.default(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importStar(n(2));t.default=function(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(n,t),n.prototype.render=function(){return e(this.props,this.context)},n}(i.Component);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(512)),i=function(e){return[e]};t.default=function(e,t){return void 0===t&&(t=i),function(n){return a.default(n,e.apply(void 0,t(n)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(257));t.default=function(e){var t=r.default({x:0,y:0}),n=t[0],a=t[1];return i.useEffect((function(){var t=function(){e.current&&a({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&e.current.addEventListener("scroll",t,{capture:!1,passive:!0}),function(){e.current&&e.current.removeEventListener("scroll",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useState(!1),n=t[0],i=t[1];return a.useEffect((function(){if(e.current){var t,n=function(){i(!0),clearTimeout(t),t=setTimeout((function(){i(!1)}),150)};return e.current.addEventListener("scroll",n,!1),function(){e.current&&e.current.removeEventListener("scroll",n,!1)}}return function(){}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131);t.default=function(e,t,n){if(!i.isClient)return[t,function(){}];var r=a.useState((function(){try{var a=sessionStorage.getItem(e);return"string"!=typeof a?(sessionStorage.setItem(e,n?String(t):JSON.stringify(t)),t):n?a:JSON.parse(a||"null")}catch(e){return t}})),s=r[0],o=r[1];return a.useEffect((function(){try{var t=n?String(s):JSON.stringify(s);sessionStorage.setItem(e,t)}catch(e){}})),[s,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(839),r=a.__importDefault(n(375)),s=function(e,t){return e.every((function(e,n){return i.equal(e,t[n])}))};t.default=function(e,t){r.default(e,t,s)}},function(e,t){var n=Object.keys;t.equal=function(e,t){if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;for(var a=n(e),i=a.length,r=0;r<i;r++)if(!(a[r]in t))return!1;for(r=0;r<i;r++)if(e[a[r]]!==t[a[r]])return!1;return i===n(t).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importStar(n(2)),r=n(131),s=i.useState,o=i.useEffect,l=i.useRef;t.default=function(e,t){var n=void 0===t?{}:t,u=n.width,c=void 0===u?1/0:u,d=n.height,m=void 0===d?1/0:d;if(!r.isClient)return["function"==typeof e?e({width:c,height:m}):e,{width:c,height:m}];var p=s({width:c,height:m}),f=p[0],b=p[1];"function"==typeof e&&(e=e(f));var g=e.props.style||{},v=l(null),y=null,h=function(){var e=v.current,t=e?{width:e.offsetWidth,height:e.offsetHeight}:{width:c,height:m};b(t)},j=function(e){e.addEventListener("resize",h),setTimeout(h,35)};return o((function(){var e=v.current;if(e){if(e.contentWindow)y=e.contentWindow,j(y);else{var t=function(){e.removeEventListener("load",t),y=e.contentWindow,j(y)};e.addEventListener("load",t)}return function(){y&&y.removeEventListener&&y.removeEventListener("resize",h)}}}),[]),g.position="relative",[i.cloneElement.apply(i,a.__spreadArrays([e,{style:g}],a.__spreadArrays([i.createElement("iframe",{ref:v,style:{background:"transparent",border:"none",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:-1}})],i.Children.toArray(e.props.children)))),f]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=n(131),s=a.__importDefault(n(207)),o=a.__importDefault(n(255)),l=function(){};t.default=function(e,t){void 0===t&&(t={});var n=s.default(),a=i.useRef(!1),u=i.useRef(0),c=i.useRef(0),d=o.default({isSliding:!1,value:0}),m=d[0],p=d[1];return u.current=m.value,i.useEffect((function(){if(r.isClient){var i=void 0===t.styles||t.styles,s=void 0!==t.reverse&&t.reverse;e.current&&i&&(e.current.style.userSelect="none");var o=function(){!a.current&&n()&&((t.onScrubStart||l)(),a.current=!0,p({isSliding:!0}),v())},d=function(){a.current&&n()&&((t.onScrubStop||l)(u.current),a.current=!1,p({isSliding:!1}),y())},m=function(e){o(),f(e)},f=t.vertical?function(e){return h(e.clientY)}:function(e){return h(e.clientX)},b=function(e){o(),g(e)},g=t.vertical?function(e){return h(e.changedTouches[0].clientY)}:function(e){return h(e.changedTouches[0].clientX)},v=function(){r.on(document,"mousemove",f),r.on(document,"mouseup",d),r.on(document,"touchmove",g),r.on(document,"touchend",d)},y=function(){r.off(document,"mousemove",f),r.off(document,"mouseup",d),r.off(document,"touchmove",g),r.off(document,"touchend",d)},h=function(a){cancelAnimationFrame(c.current),c.current=requestAnimationFrame((function(){if(n()&&e.current){var i=e.current.getBoundingClientRect(),r=t.vertical?i.top:i.left,o=t.vertical?i.height:i.width;if(!o)return;var u=(a-r)/o;u>1?u=1:u<0&&(u=0),s&&(u=1-u),p({value:u}),(t.onScrub||l)(u)}}))};return r.on(e.current,"mousedown",m),r.on(e.current,"touchstart",b),function(){r.off(e.current,"mousedown",m),r.off(e.current,"touchstart",b)}}}),[e,t.vertical]),m}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(509)),s=a.__importDefault(n(255)),o="object"==typeof window&&"object"==typeof window.speechSynthesis?window.speechSynthesis.getVoices():[];t.default=function(e,t){void 0===t&&(t={});var n=s.default({isPlaying:!1,lang:t.lang||"default",voice:t.voice||o[0],rate:t.rate||1,pitch:t.pitch||1,volume:t.volume||1}),a=n[0],l=n[1],u=i.useRef(null);return r.default((function(){var n=new SpeechSynthesisUtterance(e);t.lang&&(n.lang=t.lang),t.voice&&(n.voice=t.voice),n.rate=t.rate||1,n.pitch=t.pitch||1,n.volume=t.volume||1,n.onstart=function(){return l({isPlaying:!0})},n.onresume=function(){return l({isPlaying:!0})},n.onend=function(){return l({isPlaying:!1})},n.onpause=function(){return l({isPlaying:!1})},u.current=n,window.speechSynthesis.speak(u.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(40));t.default=function(e){a.default((function(){var t=function(t){var n,a,i,r,s;!function(){var e=document.activeElement,t=document.body;if(!e)return!1;if(e===t)return!1;switch(e.tagName){case"INPUT":case"TEXTAREA":return!0}return e.hasAttribute("contenteditable")}()&&(a=(n=t).keyCode,i=n.metaKey,r=n.ctrlKey,s=n.altKey,!(i||r||s)&&(a>=48&&a<=57||a>=65&&a<=90))&&e(t)};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStateWithHistory=void 0;var a=n(2),i=n(300),r=n(301);t.useStateWithHistory=function(e,t,n){if(void 0===t&&(t=10),t<1)throw new Error("Capacity has to be greater than 1, got '"+t+"'");var s=i.useFirstMountState(),o=a.useState(e),l=o[0],u=o[1],c=a.useRef(null!=n?n:[]),d=a.useRef(0);return s&&(c.current.length?(c.current[c.current.length-1]!==e&&c.current.push(e),c.current.length>t&&(c.current=c.current.slice(c.current.length-t))):c.current.push(e),d.current=c.current.length&&c.current.length-1),[l,a.useCallback((function(e){u((function(n){return(e=r.resolveHookState(e))!==n&&(d.current<c.current.length-1&&(c.current=c.current.slice(0,d.current+1)),d.current=c.current.push(e)-1,c.current.length>t&&(c.current=c.current.slice(c.current.length-t))),e}))}),[l,t]),a.useMemo((function(){return{history:c.current,position:d.current,capacity:t,back:function(e){void 0===e&&(e=1),d.current&&u((function(){return d.current-=Math.min(e,d.current),c.current[d.current]}))},forward:function(e){void 0===e&&(e=1),d.current!==c.current.length-1&&u((function(){return d.current=Math.min(d.current+e,c.current.length-1),c.current[d.current]}))},go:function(e){e!==d.current&&u((function(){return d.current=e<0?Math.max(c.current.length+e,0):Math.min(c.current.length-1,e),c.current[d.current]}))}}}),[l])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(207)),s=a.__importDefault(n(223)),o=a.__importDefault(n(254));t.default=function(e){void 0===e&&(e=[]);var t=r.default(),n=s.default(),l=i.useRef(0);o.default((function(){e.length<=l.current&&(l.current=e.length-1,n())}),[e.length]);var u=i.useMemo((function(){return{next:function(){return u.setStateAt(l.current+1)},prev:function(){return u.setStateAt(l.current-1)},setStateAt:function(a){t()&&e.length&&a!==l.current&&(l.current=a>=0?a%e.length:e.length+a%e.length,n())},setState:function(a){if(t()){var i=e.length?e.indexOf(a):-1;if(-1===i)throw new Error("State '"+a+"' is not a valid state (does not exist in state list)");l.current=i,n()}}}}),[e]);return a.__assign({state:e[l.current],currentIndex:l.current},u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(303));t.default=function(e,t){void 0===t&&(t=200);var n=i.useState(e),a=n[0],s=n[1],o=i.useRef(),l=i.useRef(null),u=i.useRef(0);return i.useEffect((function(){if(o.current)l.current=e,u.current=!0;else{s(e);var n=function(){u.current?(u.current=!1,s(l.current),o.current=setTimeout(n,t)):o.current=void 0};o.current=setTimeout(n,t)}}),[e]),r.default((function(){o.current&&clearTimeout(o.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(303));t.default=function(e,t,n){void 0===t&&(t=200);var a=i.useState(null),s=a[0],o=a[1],l=i.useRef(),u=i.useRef();return i.useEffect((function(){if(l.current)u.current=n;else{o(e.apply(void 0,n));var a=function(){u.current?(o(e.apply(void 0,u.current)),u.current=void 0,l.current=setTimeout(a,t)):l.current=void 0};l.current=setTimeout(a,t)}}),n),r.default((function(){l.current&&clearTimeout(l.current)})),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(376)),r=a.__importDefault(n(223));t.default=function(e){void 0===e&&(e=0);var t=r.default();return i.default(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i={restoreOnUnmount:!1};t.default="undefined"!=typeof document?function(e,t){void 0===t&&(t=i);var n=a.useRef(document.title);document.title=e,a.useEffect((function(){return t&&t.restoreOnUnmount?function(){document.title=n.current}:void 0}),[])}:function(e){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(1092),r=a.__importDefault(n(511));t.default=function(e,t,n){return void 0===e&&(e="inCirc"),void 0===t&&(t=200),void 0===n&&(n=0),(0,i.easing[e])(r.default(t,n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useRef(!1);return a.useEffect((function(){return function(){e.current=!0}})),a.useMemo((function(){return function(t,n){return new Promise((function(a,i){t.then((function(t){e.current||a(t)}),(function(t){e.current?n?n(t):console.error("useUnmountPromise",t):i(t)}))}))}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(508));t.default=function(e,t){void 0===t&&(t=[]);var n=i.default(t),r=n[0],s=n[1];return[r,a.__assign(a.__assign({},s),{upsert:function(t){s.upsert(e,t)}})]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i="object"==typeof navigator&&"vibrate"in navigator;t.default=i?function(e,t,n){void 0===e&&(e=!0),void 0===t&&(t=[1e3,1e3]),void 0===n&&(n=!0),a.useEffect((function(){var a;if(e&&(navigator.vibrate(t),n)){var i=t instanceof Array?t.reduce((function(e,t){return e+t})):t;a=setInterval((function(){navigator.vibrate(t)}),i)}return function(){e&&(navigator.vibrate(0),n&&clearInterval(a))}}),[e])}:function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(499)).default("video");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){void 0===n&&(n=[void 0]);var i=a.useRef(t),r=a.useRef(e);i.current=t,r.current=e;var s=a.useState(n),o=s[0],l=s[1],u=a.useCallback((function(){i.current.length>=2?i.current(r.current,l):l(i.current(r.current))}),[l]);return a.useEffect((function(){u()}),[e]),[o,u]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useScrollbarWidth=void 0;var a=n(857),i=n(2);t.useScrollbarWidth=function(){var e=i.useState(a.scrollbarWidth()),t=e[0],n=e[1];return i.useEffect((function(){if(void 0===t){var e=requestAnimationFrame((function(){n(a.scrollbarWidth())}));return function(){return cancelAnimationFrame(e)}}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if("undefined"==typeof document)return 0;if(document.body&&(!document.readyState||"loading"!==document.readyState)){if(!0!==e&&"number"==typeof a.__cache)return a.__cache;var t=document.createElement("div"),n=t.style;n.display="block",n.position="absolute",n.width="100px",n.height="100px",n.left="-999px",n.top="-999px",n.overflow="scroll",document.body.insertBefore(t,null);var i=t.clientWidth;if(0!==i)return a.__cache=100-i,document.body.removeChild(t),a.__cache;document.body.removeChild(t)}};t.scrollbarWidth=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMultiStateValidator=void 0;var a=n(2);t.useMultiStateValidator=function(e,t,n){if(void 0===n&&(n=[void 0]),"object"!=typeof e)throw new Error("states expected to be an object or array, got "+typeof e);var i=a.useRef(t),r=a.useRef(e);i.current=t,r.current=e;var s=a.useState(n),o=s[0],l=s[1],u=a.useCallback((function(){i.current.length>=2?i.current(r.current,l):l(i.current(r.current))}),[l]);return a.useEffect((function(){u()}),Object.values(e)),[o,u]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=n(131),s=a.__importDefault(n(257));t.default=function(){var e=s.default({x:r.isClient?window.pageXOffset:0,y:r.isClient?window.pageYOffset:0}),t=e[0],n=e[1];return i.useEffect((function(){var e=function(){n({x:window.pageXOffset,y:window.pageYOffset})};return window.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){window.removeEventListener("scroll",e)}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(257)),s=n(131);t.default=function(e,t){void 0===e&&(e=1/0),void 0===t&&(t=1/0);var n=r.default({width:s.isClient?window.innerWidth:e,height:s.isClient?window.innerHeight:t}),a=n[0],o=n[1];return i.useEffect((function(){if(s.isClient){var e=function(){o({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(40)),s=n(131),o={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};t.default=s.isClient&&window.ResizeObserver?function(){var e=i.useState(null),t=e[0],n=e[1],a=i.useState(o),s=a[0],l=a[1],u=i.useMemo((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,a=t.y,i=t.width,r=t.height,s=t.top,o=t.left,u=t.bottom,c=t.right;l({x:n,y:a,width:i,height:r,top:s,left:o,bottom:u,right:c})}}))}),[]);return r.default((function(){if(t)return u.observe(t),function(){u.disconnect()}}),[t]),[n,s]}:function(){return[function(){},o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRendersCount=void 0;var a=n(2);t.useRendersCount=function(){return++a.useRef(0).current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){void 0===e&&(e=new Set);var t=i.useState(e),n=t[0],r=t[1],s=i.useMemo((function(){return{add:function(e){return r((function(t){return new Set(a.__spreadArrays(Array.from(t),[e]))}))},remove:function(e){return r((function(t){return new Set(Array.from(t).filter((function(t){return t!==e})))}))},toggle:function(e){return r((function(t){return t.has(e)?new Set(Array.from(t).filter((function(t){return t!==e}))):new Set(a.__spreadArrays(Array.from(t),[e]))}))},reset:function(){return r(e)}}}),[r]),o=a.__assign({has:i.useCallback((function(e){return n.has(e)}),[n])},s);return[n,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGlobalState=void 0;var a=n(38),i=n(2),r=a.__importDefault(n(256)),s=a.__importDefault(n(40));function o(e){var t={state:e,setState:function(e){t.state=e,t.setters.forEach((function(e){return e(t.state)}))},setters:[]};return function(){var e=i.useState(t.state),n=e[0],a=e[1];return r.default((function(){return function(){t.setters=t.setters.filter((function(e){return e!==a}))}})),s.default((function(){t.setters.includes(a)||t.setters.push(a)})),[n,t.setState]}}t.createGlobalState=o,t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useHash=void 0;var a=n(38),i=n(2),r=a.__importDefault(n(507));t.useHash=function(){var e=i.useState((function(){return window.location.hash})),t=e[0],n=e[1],a=i.useCallback((function(){n(window.location.hash)}),[]);r.default((function(){window.addEventListener("hashchange",a)}),(function(){window.removeEventListener("hashchange",a)}));var s=i.useCallback((function(e){e!==t&&(window.location.hash=e)}),[t]);return[t,s]}},,,function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI1NnB4IiBoZWlnaHQ9IjI1NXB4IiB2aWV3Qm94PSIwIDAgMjU2IDI1NSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjU1LjIxNDYxNywwLjI1NzU4MDI0NyBMMjU1LjIxNDYxNyw2My45OTM2NzkgTDE5MS42MDk2NzksMTI3LjU5ODYxNyBMMTkxLjYwOTY3OSw2My43Mjk3Nzc4IEwyNTUuMjE0NjE3LDAuMjU3NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTEyOC4wMDYzMjEsMC4yNTc1ODAyNDcgTDEyOC4wMDYzMjEsNjMuOTkzNjc5IEwxOTEuNjExMjU5LDEyNy41OTg2MTcgTDE5MS42MTEyNTksNjMuNzI5Nzc3OCBMMTI4LjAwNjMyMSwwLjI1NzU4MDI0NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDI1NC44MDM3NTMgTDE5MS42MDk2NzksMjU0LjgwMzc1MyBMMTI4LjAwNDc0MSwxOTEuMTk4ODE1IEwxOTEuODcyLDE5MS4xOTg4MTUgTDI1NS4zNDU3NzgsMjU0LjgwMzc1MyIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDEyNy41OTU0NTcgTDE5MS42MDk2NzksMTI3LjU5NTQ1NyBMMTI4LjAwNDc0MSwxOTEuMjAwMzk1IEwxOTEuODcyLDE5MS4yMDAzOTUgTDI1NS4zNDU3NzgsMTI3LjU5NTQ1NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjgwMTE4NTE4NSwyNTQuOTM2NDk0IEwwLjgwMTE4NTE4NSwxOTEuMTk4ODE1IEw2NC40MDYxMjM1LDEyNy41OTM4NzcgTDY0LjQwNjEyMzUsMTkxLjQ2MjcxNiBMMC44MDExODUxODUsMjU0LjkzNjQ5NCIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0xMjguMDA5NDgxLDI1NC45MzY0OTQgTDEyOC4wMDk0ODEsMTkxLjE5ODgxNSBMNjQuNDA0NTQzMiwxMjcuNTkzODc3IEw2NC40MDQ1NDMyLDE5MS40NjI3MTYgTDEyOC4wMDk0ODEsMjU0LjkzNjQ5NCIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjY3MTYwNDkzOCwwLjM4NTU4MDI0NyBMNjQuNDA3NzAzNywwLjM4NTU4MDI0NyBMMTI4LjAxMjY0Miw2My45OTA1MTg1IEw2NC4xNDUzODI3LDYzLjk5MDUxODUgTDAuNjcxNjA0OTM4LDAuMzg1NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTAuNjcxNjA0OTM4LDEyNy41OTM4NzcgTDY0LjQwNzcwMzcsMTI3LjU5Mzg3NyBMMTI4LjAxMjY0Miw2My45ODg5MzgzIEw2NC4xNDUzODI3LDYzLjk4ODkzODMgTDAuNjcxNjA0OTM4LDEyNy41OTM4NzciIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KCTwvZz4KPC9zdmc+Cg=="},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(870);n(23),n(2),n(518),n(13),n(269),n(268),n(519);var i=a.default.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){i[e]=i(e)})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(23),i=n(2),r=n(518),s=n(13),o=n(269),l=n(268),u=n(519);function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var m=d(i),p=c(r).default,f=function(e){return"theme"!==e},b=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?p:f},g=function(e,t,n){var a;if(t){var i=t.shouldForwardProp;a=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!=typeof a&&n&&(a=e.__emotion_forwardProp),a},v="undefined"!=typeof document,y=function(e){var t=e.cache,n=e.serialized,a=e.isStringTag;o.registerStyles(t,n,a);var i=u.useInsertionEffectAlwaysWithSyncFallback((function(){return o.insertStyles(t,n,a)}));if(!v&&void 0!==i){for(var r,s=n.name,l=n.next;void 0!==l;)s+=" "+l.name,l=l.next;return m.createElement("style",((r={})["data-emotion"]=t.key+" "+s,r.dangerouslySetInnerHTML={__html:i},r.nonce=t.sheet.nonce,r))}return null};t.default=function e(t,n){var i,r,u=t.__emotion_real===t,c=u&&t.__emotion_base||t;void 0!==n&&(i=n.label,r=n.target);var d=g(t,n,u),p=d||b(c),f=!p("as");return function(){var v=arguments,h=u&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&h.push("label:"+i+";"),null==v[0]||void 0===v[0].raw)h.push.apply(h,v);else{h.push(v[0][0]);for(var j=v.length,E=1;E<j;E++)h.push(v[E],v[0][E])}var O=s.withEmotionCache((function(e,t,n){var a=f&&e.as||c,i="",u=[],g=e;if(null==e.theme){for(var v in g={},e)g[v]=e[v];g.theme=m.useContext(s.ThemeContext)}"string"==typeof e.className?i=o.getRegisteredStyles(t.registered,u,e.className):null!=e.className&&(i=e.className+" ");var j=l.serializeStyles(h.concat(u),t.registered,g);i+=t.key+"-"+j.name,void 0!==r&&(i+=" "+r);var E=f&&void 0===d?b(a):p,O={};for(var x in e)f&&"as"===x||E(x)&&(O[x]=e[x]);return O.className=i,O.ref=n,m.createElement(m.Fragment,null,m.createElement(y,{cache:t,serialized:j,isStringTag:"string"==typeof a}),m.createElement(a,O))}));return O.displayName=void 0!==i?i:"Styled("+("string"==typeof c?c:c.displayName||c.name||"Component")+")",O.defaultProps=t.defaultProps,O.__emotion_real=O,O.__emotion_base=c,O.__emotion_styles=h,O.__emotion_forwardProp=d,Object.defineProperty(O,"toString",{value:function(){return"."+r}}),O.withComponent=function(t,i){return e(t,a({},n,i,{shouldForwardProp:g(O,i,!0)})).apply(void 0,h)},O}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(418);function i(e){return e&&e.__esModule?e:{default:e}}var r=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,s=i(a).default((function(e){return r.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));t.default=s},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r="undefined"!=typeof document,s=!!i.useInsertionEffect&&i.useInsertionEffect,o=r&&s||function(e){return e()},l=s||i.useLayoutEffect;t.useInsertionEffectAlwaysWithSyncFallback=o,t.useInsertionEffectWithLayoutFallback=l},function(e,t,n){"use strict";var a=n(513),i=n(2);function r(e,t,n){return e[t]?e[t][0]?e[t][0][n]:e[t][n]:"contentBoxSize"===t?e.contentRect["inlineSize"===n?"width":"height"]:void 0}e.exports=function(e){void 0===e&&(e={});var t=e.onResize,n=i.useRef(void 0);n.current=t;var s=e.round||Math.round,o=i.useRef(),l=i.useState({width:void 0,height:void 0}),u=l[0],c=l[1],d=i.useRef(!1);i.useEffect((function(){return d.current=!1,function(){d.current=!0}}),[]);var m=i.useRef({width:void 0,height:void 0}),p=function(e,t){var n=i.useRef(null),a=i.useRef(null);a.current=t;var r=i.useRef(null);i.useEffect((function(){s()}));var s=i.useCallback((function(){var t=r.current,i=a.current,s=t||(i?i instanceof Element?i:i.current:null);n.current&&n.current.element===s&&n.current.subscriber===e||(n.current&&n.current.cleanup&&n.current.cleanup(),n.current={element:s,subscriber:e,cleanup:s?e(s):void 0})}),[e]);return i.useEffect((function(){return function(){n.current&&n.current.cleanup&&(n.current.cleanup(),n.current=null)}}),[]),i.useCallback((function(e){r.current=e,s()}),[s])}(i.useCallback((function(t){return o.current&&o.current.box===e.box&&o.current.round===s||(o.current={box:e.box,round:s,instance:new a.ResizeObserver((function(t){var a=t[0],i="border-box"===e.box?"borderBoxSize":"device-pixel-content-box"===e.box?"devicePixelContentBoxSize":"contentBoxSize",o=r(a,i,"inlineSize"),l=r(a,i,"blockSize"),u=o?s(o):void 0,p=l?s(l):void 0;if(m.current.width!==u||m.current.height!==p){var f={width:u,height:p};m.current.width=u,m.current.height=p,n.current?n.current(f):d.current||c(f)}}))}),o.current.instance.observe(t,{box:e.box}),function(){o.current&&o.current.instance.unobserve(t)}}),[e.box,s]),e.ref);return i.useMemo((function(){return{ref:p,width:u.width,height:u.height}}),[p,u.width,u.height])}},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var a=n(260);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17);const l=s.a.div.withConfig({displayName:"StatusTextWrapper",componentId:"sc-1nku0d-0"})(["width:100%;display:inline-grid;"]),u=({tooltipContent:e,children:t,healthColor:n,dataTestSubj:a})=>i.a.createElement(o.EuiToolTip,{content:e},i.a.createElement(o.EuiHealth,{color:n,"data-test-subj":a},i.a.createElement(l,null,i.a.createElement("span",{className:"eui-textTruncate"},t))));u.displayName="HealthTruncateText"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(50),i=(n(2),n(110));const r=["POST","/api/ml/jobs/jobs_summary"],s=(e,t)=>Object(a.useQuery)([r,e],(async({signal:t})=>(async({jobIds:e,signal:t})=>i.b.get().http.fetch("/internal/ml/jobs/jobs_summary",{method:"POST",version:"1",body:JSON.stringify({jobIds:null!=e?e:[]}),asSystemRequest:!0,signal:t}))({signal:t,...e})),{refetchIntervalInBackground:!1,staleTime:3e5,retry:!1,...t})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"registerActions",(function(){return he}));var a=n(75),i=n(108),r=n(320),s=n(343),o=n(344),l=n(118),u=n(109),c=n(4);const d=["signal.rule.risk_score","kibana.alert.risk_score","signal.reason","kibana.alert.reason"],m=e=>!!e&&e===c.l,p=e=>e.type===u.LENS_EMBEDDABLE_TYPE,f=e=>!!e&&!d.includes(e),b=(e,t)=>"number"===e&&"value_count"===t;var g=n(151),v=n(127),y=n(321);const h=({store:e,services:t})=>{const n=l.b.getTimelineByIdSelector(),{filterManager:a}=t.data.query,{notifications:i}=t;return Object(r.h)({filterManager:a,notifications:i}).combine({type:y.d.FILTER,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&f(n.name)&&Object(s.b)(n.type)},execute:async({data:t,metadata:l})=>{var u,c;const d=null===(u=t[0])||void 0===u?void 0:u.field,m=null===(c=t[0])||void 0===c?void 0:c.value,p=Object(s.a)(Object(s.d)(m));if(!Object(s.c)(p))return void i.toasts.addWarning({title:o.a});if(!d)return;const f=!0===(null==l?void 0:l.negateFilters)?r.e:r.d;var b;null!=l&&l.scopeId&&Object(v.isTimelineScope)(l.scopeId)?f({filterManager:null===(b=n(e.getState(),g.f.active))||void 0===b?void 0:b.filterManager,fieldName:d.name,value:p}):f({filterManager:a,fieldName:d.name,value:p})}})},j=({store:e,services:t})=>{const n=l.b.getTimelineByIdSelector(),{filterManager:a}=t.data.query,{notifications:i}=t;return Object(r.i)({filterManager:a,notifications:i}).combine({type:y.d.FILTER,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&f(n.name)&&Object(s.b)(n.type)},execute:async({data:t,metadata:l})=>{var u,c;const d=null===(u=t[0])||void 0===u?void 0:u.field,m=null===(c=t[0])||void 0===c?void 0:c.value,p=Object(s.a)(Object(s.d)(m));if(!Object(s.c)(p))return void i.toasts.addWarning({title:o.a});if(!d)return;const f=!0===(null==l?void 0:l.negateFilters)?r.d:r.e;var b;null!=l&&l.scopeId&&Object(v.isTimelineScope)(l.scopeId)?f({filterManager:null===(b=n(e.getState(),g.f.active))||void 0===b?void 0:b.filterManager,fieldName:d.name,value:p}):f({filterManager:a,fieldName:d.name,value:p})}})},E=({store:e,services:t})=>{const{application:n}=t;let a;return n.currentAppId$.subscribe((e=>{a=e})),h({store:e,services:t}).combine({isCompatible:async()=>m(a)})},O=({store:e,services:t})=>{const{application:n}=t;let a;return n.currentAppId$.subscribe((e=>{a=e})),j({store:e,services:t}).combine({isCompatible:async()=>m(a)})};var x=n(93),S=n(5);const k=({id:e,order:t,store:n,services:i,negate:u})=>{const{application:c,notifications:d,data:b,topValuesPopover:v}=i;let h;c.currentAppId$.subscribe((e=>{h=e}));const j=l.b.getTimelineByIdSelector();return Object(x.createAction)({id:e,order:t,getIconType:()=>u?"minusInCircle":"plusInCircle",getDisplayName:()=>u?S.i18n.translate("xpack.securitySolution.actions.filterOutTimeline",{defaultMessage:"Filter out"}):S.i18n.translate("xpack.securitySolution.actions.filterForTimeline",{defaultMessage:"Filter for"}),type:y.a.FILTER,isCompatible:async({embeddable:e,data:t})=>!Object(a.isErrorEmbeddable)(e)&&p(e)&&function(e){return!!e&&e.length>0&&e.every((({columnMeta:e})=>e&&f(e.field)))}(t)&&m(h),execute:async({data:e})=>{var t,a,i;const l=null===(t=e[0])||void 0===t||null===(a=t.columnMeta)||void 0===a?void 0:a.field,c=null===(i=e[0])||void 0===i?void 0:i.value,m=Object(s.a)(Object(s.d)(c));if(!Object(s.c)(m))return void d.toasts.addWarning({title:o.a});if(!l)return;v.closePopover();const p=!0===u?r.e:r.d,f=j(n.getState(),g.f.active);p({filterManager:null!=f&&f.show?f.filterManager:b.query.filterManager,fieldName:l,value:m})}})};var w=n(14);const C="timeline",T=S.i18n.translate("xpack.securitySolution.actions.cellValue.addToTimeline.displayName",{defaultMessage:"Add to timeline"}),M=S.i18n.translate("xpack.securitySolution.actions.cellValue.addToNewTimeline.displayName",{defaultMessage:"Investigate in timeline"}),I=e=>S.i18n.translate("xpack.securitySolution.actions.addToTimeline.addedFieldMessage",{values:{fieldOrValue:e},defaultMessage:"Added {fieldOrValue} to timeline"}),A=S.i18n.translate("xpack.securitySolution.actions.cellValue.addToTimeline.warningTitle",{defaultMessage:"Unable to add to timeline"}),P=S.i18n.translate("xpack.securitySolution.actions.cellValue.addToTimeline.warningMessage",{defaultMessage:"Filter received is empty or cannot be added to timeline"});var _=n(114),D=n(45),F=n(272),N=n(927),R=n(878),z=n(1101),L=n(1367),B=n(285);const q=({field:e,id:t,value:n,operator:a=g.e,excluded:i=!1})=>({and:[],enabled:!0,id:Object(_.j)(t),name:e,excluded:i,kqlQuery:"",queryMatch:{field:e,value:n,operator:a}}),$=({contextId:e,eventId:t,field:n,fieldFormat:a,fieldType:i,values:r,sourceParamType:s,negate:o})=>null==n?null:(Array.isArray(r)?r.length>0?r:[null]:[r]).reduce(((r,l,u)=>{let c="";const d=null!=l?l.toString():l,m=`${e}${t?`-${t}`:""}-${n}-${u}${d?`-${d}`:""}`;if(!V(n,i))return r;if(b(i,s))return c=`value-count-data-provider-${e}-${n}`,r.push(q({field:n,id:c,value:"",excluded:!1,operator:g.a})),r;if(null==d)return c=`empty-value-${m}`,r.push(q({field:n,id:c,value:"",excluded:!0,operator:g.a})),r;if(i===N.b&&(c=`formatted-ip-data-provider-${e}-${n}-${d}${t?`-${t}`:""}`,Object(D.isString)(d)&&!Object(D.isEmpty)(d))){let e=d;try{e=JSON.parse(d)}catch(e){}return Object(D.isArray)(e)?e.forEach((e=>r.push(q({field:n,id:c,value:e})))):r.push(q({field:n,id:c,value:e})),r}return c=U({field:n,fieldFormat:a,appendedUniqueId:m,value:d}),r.push(q({field:n,id:c,value:d,excluded:o})),r}),[]),V=(e,t)=>t!==B.f&&e!==B.i,U=({field:e,fieldFormat:t,appendedUniqueId:n,value:a})=>{let i;return i=R.b.some((t=>e===t))?`port-default-${n}`:e===z.b?`duration-default-${n}`:t===L.a?`bytes-default-${n}`:e===B.o?`alert-field-default-${n}`:[B.m,B.l,B.e,F.j,B.n,B.c].includes(e)?`event-field-default-${n}-${a}`:`event-field-default-${n}`,i},H=Object(r.f)((({store:e,services:t})=>{const{notifications:n}=t;return{type:y.d.ADD_TO_TIMELINE,getIconType:()=>C,getDisplayName:()=>T,getDisplayNameTooltip:()=>T,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&f(n.name)&&V(n.name,n.type)&&Object(s.b)(n.type)},execute:async({data:t,metadata:a})=>{var i,r,l;const{name:u,type:c}=null===(i=t[0])||void 0===i?void 0:i.field,d=null===(r=t[0])||void 0===r?void 0:r.value,m=Object(s.a)(Object(s.d)(d));if(!Object(s.c)(m))return void n.toasts.addWarning({title:o.a});const[p,...f]=m,[b]=null!==(l=$({contextId:g.f.active,fieldType:c,values:p,field:u,negate:!0===(null==a?void 0:a.negateFilters)}))&&void 0!==l?l:[];if(b&&f.forEach((e=>{var t;const[n]=null!==(t=$({contextId:g.f.active,fieldType:c,values:e,field:u,negate:!0===(null==a?void 0:a.negateFilters)}))&&void 0!==t?t:[];n&&b.and.push(n)})),b){e.dispatch(Object(w.addProvider)({id:g.f.active,providers:[b]}));const t=m.join(", ");n.toasts.addSuccess({title:I(t)})}else n.toasts.addWarning({title:A,text:P})}}}));var G=n(134);const Q=Object(r.f)((({store:e,services:t})=>{const{notifications:n}=t;return{type:y.d.INVESTIGATE_IN_NEW_TIMELINE,getIconType:()=>C,getDisplayName:()=>M,getDisplayNameTooltip:()=>M,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&f(n.name)&&V(n.name,n.type)&&Object(s.b)(n.type)},execute:async({data:t,metadata:a})=>{var i,r,u;const c=null===(i=t[0])||void 0===i?void 0:i.field,d=null===(r=t[0])||void 0===r?void 0:r.value,m=Object(s.a)(Object(s.d)(d));if(!Object(s.c)(m))return void n.toasts.addWarning({title:o.a});const p=null!==(u=$({contextId:g.f.active,fieldType:c.type,values:m,field:c.name,negate:!0===(null==a?void 0:a.negateFilters)}))&&void 0!==u?u:[];for(const e of null!==(f=null==a?void 0:a.andFilters)&&void 0!==f?f:[]){var f,b;const t=null!==(b=$({contextId:g.f.active,field:e.field,values:e.value}))&&void 0!==b?b:[];if(t)for(const e of p)e.and.push(...t)}p.length>0?(e.dispatch(l.a.createTimeline({...G.b,id:g.f.active})),e.dispatch(Object(w.showTimeline)({id:g.f.active,show:!0})),e.dispatch(Object(w.addProvider)({id:g.f.active,providers:p}))):n.toasts.addWarning({title:A,text:P})}}}));var W=n(110);const K="embeddable_addToTimeline",Y=({store:e,services:t})=>{const{application:n}=t;let a;return n.currentAppId$.subscribe((e=>{a=e})),H({store:e,services:t}).combine({isCompatible:async()=>m(a)})};var X=n(53),J=n(728);const Z=e=>S.i18n.translate("xpack.securitySolution.actions.showTopTooltip",{values:{fieldName:e},defaultMessage:"Show top {fieldName}"}),ee=Object(r.f)((({services:e})=>({type:y.d.SHOW_TOP_N,getIconType:()=>"visBarVertical",getDisplayName:({data:e})=>{var t;return Z(null===(t=e[0])||void 0===t?void 0:t.field.name)},getDisplayNameTooltip:({data:e})=>{var t;return Z(null===(t=e[0])||void 0===t?void 0:t.field.name)},isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&f(n.name)&&Object(J.a)(n.type)&&!Object(X.isDataViewFieldSubtypeNested)(n)&&!!n.aggregatable},execute:async t=>{var n;const a=Object(D.first)(t.data);t.nodeRef.current&&a&&e.topValuesPopover.showPopover({fieldName:a.field.name,scopeId:null===(n=t.metadata)||void 0===n?void 0:n.scopeId,nodeRef:t.nodeRef.current})}})));var te=n(487),ne=n.n(te);const ae=S.i18n.translate("xpack.securitySolution.actions.cellValue.copyToClipboard.displayName",{defaultMessage:"Copy to Clipboard"}),ie=S.i18n.translate("xpack.securitySolution.actions.cellValue.copyToClipboard.successMessage",{defaultMessage:"Copied to the clipboard"}),re="embeddable_copyToClipboard",se=({services:e})=>{const{notifications:t}=e;return Object(r.g)({notifications:t}).combine({type:y.d.COPY,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return f(n.name)}})},oe=({services:e})=>{const{application:t}=e;let n;return t.currentAppId$.subscribe((e=>{n=e})),se({services:e}).combine({isCompatible:async()=>m(n)})};var le=n(124),ue=n(204);const ce={[le.e.alertsOnAlertsPage]:c.e.ALERTS_PAGE,[le.e.alertsOnRuleDetailsPage]:c.e.RULE_DETAILS,[le.e.alertsOnCasePage]:c.e.CASE,[le.e.alertsRiskInputs]:c.e.RISK_INPUTS},de=S.i18n.translate("xpack.securitySolution.actions.toggleColumnToggle.label",{defaultMessage:"Toggle column in table"}),me=Object(r.f)((({store:e,services:t})=>({type:y.d.TOGGLE_COLUMN,getIconType:()=>"listAdd",getDisplayName:()=>de,getDisplayNameTooltip:({data:e,metadata:t})=>{var n,a;return null!=t&&t.isObjectArray?(a=null===(n=e[0])||void 0===n?void 0:n.field.name,S.i18n.translate("xpack.securitySolution.actions.toggleColumnToggle.nestedLabel",{values:{field:a},defaultMessage:"The {field} field is an object, and is broken down into nested fields which can be added as columns"})):de},isCompatible:async({data:e,metadata:t})=>{var n;const a=null===(n=e[0])||void 0===n?void 0:n.field;return 1===e.length&&f(a.name)&&!(null==t||!t.scopeId)&&(Object(v.isTimelineScope)(t.scopeId)||Object(v.isInTableScope)(t.scopeId))},execute:async({metadata:n,data:a})=>{var i,r;const s=null===(i=a[0])||void 0===i?void 0:i.field,o=null==n?void 0:n.scopeId;if(!o)return;const u=Object(v.getScopedActions)(o);if(!u)return;const c=(e=>{if(ce[e])return ce[e]})(o);if(c)return void t.triggersActionsUi.alertsTableConfigurationRegistry.getActions(c).toggleColumn(s.name);const d=Object(v.isTimelineScope)(o)?l.b.getTimelineByIdSelector():le.j.getTableByIdSelector(),m=Object(v.isTimelineScope)(o)?G.b:le.q,{columns:p}=null!==(r=d(e.getState(),o))&&void 0!==r?r:m;p.some((e=>e.id===s.name))?e.dispatch(u.removeColumn({columnId:s.name,id:o})):e.dispatch(u.upsertColumn({column:{columnHeaderType:le.k,id:s.name,initialWidth:ue.a},id:o,index:1}))}})));var pe=n(176),fe=n(329);const be=S.i18n.translate("xpack.securitySolution.actions.toggleFieldToAssetTable.label",{defaultMessage:"Toggle field in asset table"}),ge=Object(r.f)((({store:e})=>({type:y.d.TOGGLE_COLUMN,getIconType:()=>"listAdd",getDisplayName:()=>be,getDisplayNameTooltip:({data:e})=>be,isCompatible:async({data:e,metadata:t})=>{var n;const a=null===(n=e[0])||void 0===n?void 0:n.field;return 1===e.length&&f(a.name)&&!(null!=t&&t.isObjectArray)&&!(null==t||!t.scopeId)&&Object.values(pe.UserAssetTableType).includes(null==t?void 0:t.scopeId)},execute:async({metadata:t,data:n})=>{var a;const i=null===(a=n[0])||void 0===a?void 0:a.field,r=null==t?void 0:t.scopeId;if(!r)return;const{fields:s}=fe.e.selectUserAssetTableById(e.getState(),r);s.some((e=>e===i.name))?e.dispatch(fe.c.removeUserAssetTableField({fieldName:i.name,tableId:r})):e.dispatch(fe.c.addUserAssetTableField({fieldName:i.name,tableId:r}))}}))),ve=(e,t)=>{const{telemetry:n}=t,{execute:a,...i}=e;return{...i,execute:e=>(n.reportCellActionClicked({actionId:i.id,displayName:i.getDisplayName(e),fieldName:e.data.map((({field:e})=>e.name)).join(", "),metadata:e.metadata}),a(e))}};var ye=n(79);const he=(e,t,n)=>{je(e,n),Ee(e,n),Oe(e,t,n),((e,t,n)=>{((e,t,n)=>{n.uiActions.registerTrigger({id:y.c.HISTOGRAM_TRIGGER})})(0,0,n);const a=((e,t,n)=>{const a=Object(ye.createFilterAction)(n.customDataService.query.filterManager,n.customDataService.query.timefilter.timefilter,n.theme,y.b.VIS_FILTER_ACTION,y.b.VIS_FILTER_ACTION);return n.uiActions.registerAction(a),a})(0,0,n);n.uiActions.attachAction(y.c.HISTOGRAM_TRIGGER,a.id)})(0,0,n)},je=(e,t)=>{const{uiActions:n}=t,i=(({store:e,order:t,services:n})=>k({id:"embeddable_filterIn",order:t,store:e,services:n}))({store:e,order:2,services:t});n.addTriggerAction(a.CELL_VALUE_TRIGGER,i);const r=(({store:e,order:t,services:n})=>k({id:"embeddable_filterOut",order:t,store:e,services:n,negate:!0}))({store:e,order:3,services:t});n.addTriggerAction(a.CELL_VALUE_TRIGGER,r);const s=(({store:e,order:t})=>{const{application:n,notifications:{toasts:i}}=W.b.get();let r;return n.currentAppId$.subscribe((e=>{r=e})),Object(x.createAction)({id:K,type:K,order:t,getIconType:()=>C,getDisplayName:()=>T,isCompatible:async({embeddable:e,data:t})=>!Object(a.isErrorEmbeddable)(e)&&p(e)&&Object(a.isFilterableEmbeddable)(e)&&function(e){return!!e&&e.length>0&&e.every((({columnMeta:e})=>{var t;return e&&f(e.field)&&"esaggs"===e.source&&(null===(t=e.sourceParams)||void 0===t?void 0:t.indexPatternId)}))}(t)&&m(r),execute:async({data:t})=>{const n=t.reduce(((e,{columnMeta:t,value:n,eventId:a})=>{var i;const r=$({contextId:g.f.active,fieldType:null==t?void 0:t.type,values:n,field:null==t?void 0:t.field,eventId:a,sourceParamType:null==t||null===(i=t.sourceParams)||void 0===i?void 0:i.type});return r&&e.push(...r),e}),[]);if(n.length>0){e.dispatch(Object(w.addProvider)({id:g.f.active,providers:n}));const t=(e=>e.reduce(((e,{queryMatch:{value:t,operator:n,field:a}})=>{if(null!=t)if(n===g.a)e.push(a);else{const n=Array.isArray(t)?t.join(", "):t.toString();e.push(n)}return e}),[]).join(", "))(n);t.length>0&&i.addSuccess({title:I(t)})}else i.addWarning({title:A,text:P})}})})({store:e,order:4});n.addTriggerAction(a.CELL_VALUE_TRIGGER,s);const o=(({order:e})=>{const{application:t}=W.b.get();let n;return t.currentAppId$.subscribe((e=>{n=e})),Object(x.createAction)({id:re,type:re,order:e,getIconType:()=>"copyClipboard",getDisplayName:()=>ae,isCompatible:async({embeddable:e,data:t})=>!Object(a.isErrorEmbeddable)(e)&&p(e)&&function(e){return!!e&&e.length>0&&e.every((({columnMeta:e})=>e&&f(e.field)))}(t)&&m(n),execute:async({data:e})=>{const{notifications:{toasts:t}}=W.b.get(),n=e.map((({columnMeta:e,value:t})=>{var n;return b(null==e?void 0:e.type,null==e||null===(n=e.sourceParams)||void 0===n?void 0:n.type)?`${null==e?void 0:e.field}: *`:`${null==e?void 0:e.field}${null!=t?`: "${t}"`:""}`})).join(" | ");ne()(n,{debug:!0})&&t.addSuccess({title:ie,toastLifeTimeMs:800})}})})({order:5});n.addTriggerAction(a.CELL_VALUE_TRIGGER,o)},Ee=(e,t)=>{const{uiActions:n}=t,a={filterIn:E({store:e,services:t}),filterOut:O({store:e,services:t}),addToTimeline:Y({store:e,services:t}),copyToClipboard:oe({services:t})};var r;r=i.SEARCH_EMBEDDABLE_CELL_ACTIONS_TRIGGER_ID,["filterIn","filterOut","addToTimeline","copyToClipboard"].forEach(((e,i)=>{const s=a[e];if(s){const a=s({id:`${r}-${e}`,order:i}),o=ve(a,t);n.addTriggerAction(r,o)}}))},Oe=(e,t,n)=>{const{uiActions:a}=n,i={filterIn:h({store:e,services:n}),filterOut:j({store:e,services:n}),addToTimeline:H({store:e,services:n}),investigateInNewTimeline:Q({store:e,services:n}),showTopN:ee({services:n}),copyToClipboard:se({services:n}),toggleColumn:me({store:e,services:n}),toggleUserAssetField:ge({store:e})},r=(e,t)=>{a.registerTrigger({id:e}),t.forEach(((t,r)=>{const s=i[t];if(s){const i=s({id:`${e}-${t}`,order:r}),o=ve(i,n);a.addTriggerAction(e,o)}}))};r(y.e.DEFAULT,["filterIn","filterOut","addToTimeline","showTopN","copyToClipboard"]),r(y.e.DETAILS_FLYOUT,["filterIn","filterOut","addToTimeline","toggleColumn","toggleUserAssetField","showTopN","copyToClipboard"]),r(y.e.ALERTS_COUNT,["investigateInNewTimeline"])}}])]);