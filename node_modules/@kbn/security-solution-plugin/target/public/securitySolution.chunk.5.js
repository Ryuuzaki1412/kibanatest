/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[5],{1107:function(t,e,n){"use strict";n.d(e,"a",(function(){return EventFiltersApiClient}));var i=n(175),r=n(387),s=n(200),o=n(488),a=n(599),c=n(1108);function u(t){return Object(r.a)(t)}class EventFiltersApiClient extends a.a{constructor(t){super(t,i.f,c.b,void 0,u)}static getInstance(t){return super.getInstance(t,i.f,c.b,void 0,u)}async getSuggestions(t){return await this.getHttp().post(Object(o.a)(s.x,{suggestion_type:"eventFilters"}),{version:this.version,body:JSON.stringify(t)})}}},1108:function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return a}));var i=n(139),r=n(175);n.d(e,"a",(function(){return r.f}));const s=i.b.ENDPOINT_EVENTS,o={name:r.g,namespace_type:"agnostic",description:r.e,list_id:r.f,type:s},a=["name","description","entries.value","entries.entries.value","comments.comment","item_id"]},1295:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i=n(23),r=n.n(i),s=n(2),o=n.n(s),a=n(17),c=n(733),u=n(4);const p=Object(s.memo)((({appId:t=u.l,deepLinkId:e,appPath:n,appState:i,onClick:s,asButton:p,children:l,...d})=>{const f=Object(c.a)(t,{deepLinkId:e,path:n,state:i,onClick:s});return o.a.createElement(o.a.Fragment,null,p&&!0===p?o.a.createElement(a.EuiButton,r()({},d,{onClick:f}),l):o.a.createElement(a.EuiLink,r()({},d,{onClick:f}),l))}))},1381:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}));var i=n(45);const r=(t,e)=>t?`(${e.map((e=>`exception-list-agnostic.attributes.${e}:(*${t.trim().replace(/([\)\(\<\>\}\{\"\:\\])/gm,"\\$&").replace(/\s/gm,"*")}*)`)).join(" OR ")})`:"",s=t=>"global"===t?'exception-list-agnostic.attributes.tags:"policy:all"':"unassigned"===t?"(not exception-list-agnostic.attributes.tags:*)":`exception-list-agnostic.attributes.tags:"policy:${t}"`,o=({policies:t=[],excludedPolicies:e=[],kuery:n})=>{if(0===(null==t?void 0:t.length)&&0===(null==e?void 0:e.length))return n||void 0;const r=((t,e=[])=>{if(Object(i.isEmpty)(t)&&Object(i.isEmpty)(e))return"";const n=t.map(s).join(" OR "),r=e.map((t=>`not ${s(t)}`)).join(" AND "),o=[];return n&&o.push(n),r&&o.push(r),`(${o.join(" AND ")})`})(t,e);return`(${r})${n?` AND (${n})`:""}`}},1383:function(t,e,n){"use strict";function i(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,s){e=e||"&",n=n||"=";var o={};if("string"!=typeof t||0===t.length)return o;var a=/\+/g;t=t.split(e);var c=1e3;s&&"number"==typeof s.maxKeys&&(c=s.maxKeys);var u=t.length;c>0&&u>c&&(u=c);for(var p=0;p<u;++p){var l,d,f,g,h=t[p].replace(a,"%20"),b=h.indexOf(n);b>=0?(l=h.substr(0,b),d=h.substr(b+1)):(l=h,d=""),f=decodeURIComponent(l),g=decodeURIComponent(d),i(o,f)?r(o[f])?o[f].push(g):o[f]=[o[f],g]:o[f]=g}return o};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},1384:function(t,e,n){"use strict";var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?s(o(t),(function(o){var a=encodeURIComponent(i(o))+n;return r(t[o])?s(t[o],(function(t){return a+encodeURIComponent(i(t))})).join(e):a+encodeURIComponent(i(t[o]))})).join(e):a?encodeURIComponent(i(a))+n+encodeURIComponent(i(t)):""};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function s(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i++)n.push(e(t[i],i));return n}var o=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},1479:function(t,e,n){"use strict";const i=n(1609);t.exports=async(t,e,{concurrency:n=1/0,stopOnError:r=!0}={})=>new Promise(((s,o)=>{if("function"!=typeof e)throw new TypeError("Mapper function is required");if(!Number.isSafeInteger(n)&&n!==1/0||!(n>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${n}\` (${typeof n})`);const a=[],c=[],u=t[Symbol.iterator]();let p=!1,l=!1,d=0,f=0;const g=()=>{if(p)return;const t=u.next(),n=f;if(f++,t.done)return l=!0,void(0===d&&(r||0===c.length?s(a):o(new i(c))));d++,(async()=>{try{const i=await t.value;a[n]=await e(i,n),d--,g()}catch(t){r?(p=!0,o(t)):(c.push(t),d--,g())}})()};for(let t=0;t<n&&(g(),!l);t++);}))},1609:function(t,e,n){"use strict";const i=n(1610),r=n(1611);class AggregateError extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError("Expected input to be an Array, got "+typeof t);let e=(t=[...t].map((t=>t instanceof Error?t:null!==t&&"object"==typeof t?Object.assign(new Error(t.message),t):new Error(t)))).map((t=>"string"==typeof t.stack?r(t.stack).replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""):String(t))).join("\n");e="\n"+i(e,4),super(e),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:t})}*[Symbol.iterator](){for(const t of this._errors)yield t}}t.exports=AggregateError},1610:function(t,e,n){"use strict";t.exports=(t,e=1,n)=>{if(n={indent:" ",includeEmptyLines:!1,...n},"string"!=typeof t)throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof t}\``);if("number"!=typeof e)throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof e}\``);if("string"!=typeof n.indent)throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof n.indent}\``);if(0===e)return t;const i=n.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return t.replace(i,n.indent.repeat(e))}},1611:function(t,e,n){"use strict";const i=n(1612),r=/\s+at.*(?:\(|\s)(.*)\)?/,s=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,o=void 0===i.homedir?"":i.homedir();t.exports=(t,e)=>(e=Object.assign({pretty:!1},e),t.replace(/\\/g,"/").split("\n").filter((t=>{const e=t.match(r);if(null===e||!e[1])return!0;const n=e[1];return!n.includes(".app/Contents/Resources/electron.asar")&&!n.includes(".app/Contents/Resources/default_app.asar")&&!s.test(n)})).filter((t=>""!==t.trim())).map((t=>e.pretty?t.replace(r,((t,e)=>t.replace(e,e.replace(o,"~")))):t)).join("\n"))},1612:function(t,e){},238:function(t,e,n){"use strict";n.d(e,"e",(function(){return g})),n.d(e,"d",(function(){return h})),n.d(e,"h",(function(){return b})),n.d(e,"j",(function(){return y})),n.d(e,"o",(function(){return m})),n.d(e,"l",(function(){return j})),n.d(e,"a",(function(){return $})),n.d(e,"p",(function(){return I})),n.d(e,"b",(function(){return _})),n.d(e,"k",(function(){return L})),n.d(e,"f",(function(){return A})),n.d(e,"g",(function(){return C})),n.d(e,"m",(function(){return P})),n.d(e,"c",(function(){return N})),n.d(e,"i",(function(){return T})),n.d(e,"n",(function(){return k}));var i=n(45),r=n(734),s=n.n(r),o=n(49),a=n(185),c=n(876),u=n(875),p=n(178);const l=(t,e)=>void 0===t||t===e||0===t,d=(t,e={})=>`${t}${Object(a.a)(s.a.stringify(((t={})=>({...l(t.page,1)?{}:{page:t.page},...l(t.pageSize,p.c)?{}:{pageSize:t.pageSize},...l(t.show,void 0)?{}:{show:t.show},...l(t.itemId,void 0)?{}:{itemId:t.itemId},...l(t.filter,"")?"":{filter:t.filter},...l(t.includedPolicies,"")?"":{includedPolicies:t.includedPolicies}}))(e)))}`,f=t=>s.a.stringify(t),g=(t,e)=>{const{name:n,...r}=t,s=f(r),c=`${s&&!Object(i.isEmpty)(e)?"&":""}${null!=e?e:""}`;return"endpointList"===n?`${Object(o.generatePath)(p.h,{tabName:u.a.endpoints})}${Object(a.a)(`${s?`${s}${c}`:c}`)}`:`${Object(a.a)(`${s?`${s}${c}`:c}`)}`},h=(t,e)=>{const{name:n,show:r,...s}=t,c={...s};switch(t.name){case"endpointDetails":c.show="details";break;case"endpointIsolate":c.show="isolate";break;case"endpointUnIsolate":c.show="unisolate";break;case"endpointPolicyResponse":c.show="policy_response";break;case"endpointActivityLog":c.show="activity_log"}const l=f(c),d=`${l&&!Object(i.isEmpty)(e)?"&":""}${null!=e?e:""}`;return`${Object(o.generatePath)(p.h,{tabName:u.a.endpoints})}${Object(a.a)(`${l?`${l}${d}`:d}`)}`},b=t=>`${Object(o.generatePath)(p.k,{tabName:u.a.policies})}${Object(a.a)(t)}`,y=(t,e)=>`${Object(o.generatePath)(p.n,{tabName:u.a.policies,policyId:t})}${Object(a.a)(e)}`,m=(t,e)=>`${Object(o.generatePath)(p.r,{tabName:u.a.policies,policyId:t})}${Object(a.a)(e)}`,j=(t,e)=>`${Object(o.generatePath)(p.m,{tabName:u.a.policies,policyId:t})}${Object(a.a)(s.a.stringify(v(e)))}`,v=t=>t?{...l(t.page,p.b+1)?{}:{page:t.page},...l(t.pageSize,p.c)?{}:{pageSize:t.pageSize},...l(t.show,void 0)?{}:{show:t.show},...l(t.filter,"")?"":{filter:t.filter}}:{},O=(t,e)=>{const n=t[e];return Array.isArray(n)?n[n.length-1]:n},w=t=>{const e=Number(O(t,"page_index"));return!Number.isFinite(e)||e<0?p.b:e},E=t=>{const e=Number(O(t,"page_size"));return p.f.includes(e)?e:p.c},x=t=>O(t,"filter")||"",$=t=>({page_index:w(t),page_size:E(t),filter:x(t)}),I=t=>{const e=Object(o.generatePath)(p.t,{tabName:u.a.trustedApps});return d(e,t)},_=t=>{const e=O(t,"show"),n=Object(c.a)(t);return{page:n.page,pageSize:n.pageSize,filter:t.filter,show:e&&"list"===e?e:void 0}},L=(t,e)=>`${Object(o.generatePath)(p.r,{tabName:u.a.policies,policyId:t})}${Object(a.a)(s.a.stringify(v(e)))}`,A=t=>{const e=Object(o.generatePath)(p.i,{tabName:u.a.eventFilters});return d(e,t)},C=t=>{const e=Object(o.generatePath)(p.j,{tabName:u.a.hostIsolationExceptions});return d(e,t)},P=(t,e)=>`${Object(o.generatePath)(p.o,{tabName:u.a.policies,policyId:t})}${Object(a.a)(s.a.stringify(v(e)))}`,N=t=>{const e=Object(o.generatePath)(p.g,{tabName:u.a.blocklist});return d(e,t)},T=(t,e)=>`${Object(o.generatePath)(p.l,{tabName:u.a.policies,policyId:t})}${Object(a.a)(s.a.stringify(v(e)))}`,k=(t,e)=>`${Object(o.generatePath)(p.q,{tabName:u.a.policies,policyId:t})}${Object(a.a)(s.a.stringify(v(e)))}`},531:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return a}));var i=n(175);const r="policy:",s=`${r}all`,o=i.a,a=["name","description","entries.value","entries.entries.value","item_id"]},599:function(t,e,n){"use strict";n.d(e,"a",(function(){return ExceptionsListApiClient}));var i=n(0),r=n.n(i),s=n(175),o=n(178);class ExceptionsListApiClient{constructor(t,e,n,i,s,o){r()(this,"ensureListExists",void 0),this.http=t,this.listId=e,this.listDefinition=n,this.readTransform=i,this.writeTransform=s,this.version=o,this.ensureListExists=this.createExceptionList(),this.version=null!=o?o:"2023-10-31"}async createExceptionList(){return ExceptionsListApiClient.wasListCreated.has(this.listId)||ExceptionsListApiClient.wasListCreated.set(this.listId,new Promise(((t,e)=>{(async()=>{try{await this.http.post(s.t,{version:"1",body:JSON.stringify({...this.listDefinition,list_id:this.listId})}),t()}catch(t){ExceptionsListApiClient.wasListCreated.delete(this.listId),e(t)}})()}))),ExceptionsListApiClient.wasListCreated.get(this.listId)}checkIfIsUsingTheRightInstance(t){if(t!==this.listId)throw new Error(`The list id you are using is not valid, expected [${this.listId}] list id but received [${t}] list id`)}isHttp(t){return this.http===t}getHttp(){return this.http}static getInstance(t,e,n,i,r){var s;ExceptionsListApiClient.instance.has(e)&&null!==(s=ExceptionsListApiClient.instance.get(e))&&void 0!==s&&s.isHttp(t)||ExceptionsListApiClient.instance.set(e,new ExceptionsListApiClient(t,e,n,i,r));return ExceptionsListApiClient.instance.get(e)||new ExceptionsListApiClient(t,e,n,i,r)}static cleanExceptionsBeforeUpdate(t){var e;const n={...t};return["created_at","created_by","list_id","tie_breaker_id","updated_at","updated_by","meta"].forEach((t=>{delete n[t]})),n.comments=null===(e=n.comments)||void 0===e?void 0:e.map((t=>({comment:t.comment,id:t.id}))),n}async find({perPage:t=o.c,page:e=o.b+1,sortField:n,sortOrder:i,filter:r}={}){await this.ensureListExists;const a=await this.http.get(`${s.p}/_find`,{version:this.version,query:{page:e,per_page:t,sort_field:n,sort_order:i,list_id:[this.listId],namespace_type:["agnostic"],filter:r}});return this.readTransform&&(a.data=a.data.map(this.readTransform)),a}async get(t,e){if(!t&&!e)throw TypeError("either `itemId` or `id` argument must be set");await this.ensureListExists;let n=await this.http.get(s.p,{version:this.version,query:{id:e,item_id:t,namespace_type:"agnostic"}});return this.readTransform&&(n=this.readTransform(n)),n}async create(t){await this.ensureListExists,this.checkIfIsUsingTheRightInstance(t.list_id),delete t.meta;let e=t;return this.writeTransform&&(e=this.writeTransform(t)),this.http.post(s.p,{version:this.version,body:JSON.stringify(e)})}async update(t){await this.ensureListExists;let e=t;return this.writeTransform&&(e=this.writeTransform(t)),this.http.put(s.p,{version:this.version,body:JSON.stringify(ExceptionsListApiClient.cleanExceptionsBeforeUpdate(e))})}async delete(t,e){if(!t&&!e)throw TypeError("either `itemId` or `id` argument must be set");return await this.ensureListExists,this.http.delete(s.p,{version:this.version,query:{id:e,item_id:t,namespace_type:"agnostic"}})}async summary(t){return await this.ensureListExists,this.http.get(`${s.s}/summary`,{version:this.version,query:{filter:t,list_id:this.listId,namespace_type:"agnostic"}})}async hasData(){return(await this.find({perPage:1,page:1})).total>0}}r()(ExceptionsListApiClient,"instance",new Map),r()(ExceptionsListApiClient,"wasListCreated",new Map)},733:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(2),r=n(110);const s=(t,e)=>{const{services:n}=Object(r.i)(),{path:s,state:o,onClick:a,deepLinkId:c,openInNewTab:u}=e||{};return Object(i.useCallback)((e=>{try{a&&a(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0===e.button&&(e.currentTarget instanceof HTMLAnchorElement&&""!==e.currentTarget.target&&"_self"!==e.currentTarget.target||e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||(e.preventDefault(),n.application.navigateToApp(t,{deepLinkId:c,path:s,state:o,openInNewTab:u})))}),[t,c,a,s,n.application,o,u])}},734:function(t,e,n){"use strict";e.decode=e.parse=n(1383),e.encode=e.stringify=n(1384)},746:function(t,e,n){"use strict";n.d(e,"e",(function(){return u})),n.d(e,"d",(function(){return p})),n.d(e,"b",(function(){return d})),n.d(e,"g",(function(){return g})),n.d(e,"c",(function(){return b})),n.d(e,"f",(function(){return m})),n.d(e,"a",(function(){return w}));var i=n(50),r=n(2),s=n(178),o=n(1381),a=n(531);const c=Object.freeze({});function u(t,e=c,n=a.c,u,p=[]){const{filter:l="",page:d=s.b+1,perPage:f=s.c,policies:g=[],excludedPolicies:h=[]}=e,b=Object(r.useMemo)((()=>Object(o.a)({kuery:Object(o.b)(l,n),policies:g,excludedPolicies:h})),[l,n,g,h]);return Object(i.useQuery)([...p,"list",t,b,d,f],(async()=>await t.find({filter:b,perPage:f,page:d,sortField:s.d,sortOrder:s.e})),u)}function p(t,e,n,r){return Object(i.useQuery)(["get",t,e,n],(()=>t.get(e,n)),r)}const l=Object.freeze({});function d(t,e=l){return Object(i.useMutation)((e=>t.create(e)),e)}const f=Object.freeze({});function g(t,e=f){return Object(i.useMutation)((e=>t.update(e)),e)}const h=Object.freeze({});function b(t,e=h){return Object(i.useMutation)((({itemId:e,id:n})=>t.delete(e,n)),e)}const y=Object.freeze({});function m(t,e=y,n=a.c,r){const{filter:s="",policies:c=[]}=e;return Object(i.useQuery)(["summary",t,s,c],(()=>t.summary(Object(o.a)({policies:c,kuery:Object(o.b)(s,n)}))),r)}var j=n(1479),v=n.n(j);const O=Object.freeze({});function w(t,e=O,n={concurrency:5}){return Object(i.useMutation)((e=>v()(e,(e=>t.update(e)),n)),e)}Object.freeze({})}}]);