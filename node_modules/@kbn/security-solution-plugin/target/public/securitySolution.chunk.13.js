/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[13],{1310:function(e,t,a){"use strict";a.d(t,"a",(function(){return D}));var i=a(55),l=a(2),o=a.n(l),n=a(4),r=a(110),s=a(126),c=a(464),d=a(730),u=a(397),p=a(214),m=a(529),b=a(1276),g=a(210),w=a(385),y=a(159),E=a(667);const D=o.a.memo((({contextID:e,id:t,ip:a,data:l,isDraggable:D=!1,isInDetailsSidePanel:N=!1,loading:T,flowTarget:f,startDate:k,endDate:I,isLoadingAnomaliesData:v,anomaliesData:O,narrowDateRange:j,indexPatterns:S,jobNameById:h})=>{const x=Object(g.a)(),F=Object(w.a)(x),[P]=Object(r.o)(n.C),C=l[f],A=[{title:u.i,description:Object(c.g)([`${f}.geo.city_name`,`${f}.geo.region_name`],l,e,D)},{title:u.c,description:C?Object(c.d)(C.autonomousSystem,f,e,D):Object(s.d)()}],_=[F?[...A,{title:u.j,description:o.a.createElement(b.a,{anomalies:O,startDate:k,endDate:I,isLoading:v,narrowDateRange:j,jobNameById:h})}]:A,[{title:u.d,description:o.a.createElement(d.a,{indexPatterns:S,field:`${f}.ip`,value:a,type:d.b.FIRST_SEEN})},{title:u.h,description:o.a.createElement(d.a,{indexPatterns:S,field:`${f}.ip`,value:a,type:d.b.LAST_SEEN})}],[{title:u.e,description:C&&l.host?Object(c.e)({host:l.host,isDraggable:D,ipFilter:a,contextID:e}):Object(s.d)()},{title:u.f,description:C&&l.host?Object(c.f)(l.host,a,e,D):Object(s.d)()}],[{title:u.o,description:Object(c.i)(a)},{title:u.k,description:Object(c.h)(a)}]];return o.a.createElement(y.c,null,o.a.createElement(p.g,{direction:N?"column":"row"},!N&&o.a.createElement(y.b,{queryId:t,title:u.g,inspectIndex:0}),_.map(((e,t)=>o.a.createElement(E.a,{descriptionList:e,key:t}))),T&&o.a.createElement(m.a,{overlay:!0,overlayBackground:P?i.euiDarkVars.euiPageBackgroundColor:i.euiLightVars.euiPageBackgroundColor,size:"xl"})))}));D.displayName="IpOverview"},1311:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var i=a(125);const l=(e,t)=>t===i.g.source?[{fieldName:"source.ip",fieldValue:e}]:t===i.g.destination?[{fieldName:"destination.ip",fieldValue:e}]:[]},1312:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(2),l=a(11),o=a.n(l),n=a(110);const r=()=>{const{getComponents$:e}=Object(n.i)().services,t=Object(i.useMemo)((()=>e()),[e]);return o()(t,{})}},1333:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return d}));var i=a(2),l=a(209),o=a(125),n=a(5);const r=n.i18n.translate("xpack.securitySolution.networkDetails.errorSearchDescription",{defaultMessage:"An error has occurred on network details search"});n.i18n.translate("xpack.securitySolution.networkDetails.failSearchDescription",{defaultMessage:"Failed to run search on network details"});var s=a(279);const c="networkDetailsQuery",d=({filterQuery:e,id:t=c,indexNames:a,ip:n,skip:d})=>{const{loading:u,result:p,search:m,refetch:b,inspect:g}=Object(s.a)({factoryQueryType:o.q.details,initialResult:{networkDetails:{}},errorMessage:r,abort:d}),w=Object(i.useMemo)((()=>({networkDetails:p.networkDetails,id:t,inspect:g,isInspected:!1,refetch:b})),[t,g,b,p.networkDetails]),y=Object(i.useMemo)((()=>({defaultIndex:a,factoryQueryType:o.q.details,filterQuery:Object(l.a)(e),ip:n})),[e,a,n]);return Object(i.useEffect)((()=>{!d&&y&&m(y)}),[y,m,d]),[u,w]}},308:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return i})),a.d(t,"a",(function(){return g})),a.d(t,"d",(function(){return w}));var i={};a.r(i),a.d(i,"dnsSelector",(function(){return N})),a.d(i,"topNFlowSelector",(function(){return f})),a.d(i,"tlsSelector",(function(){return I})),a.d(i,"topCountriesSelector",(function(){return O})),a.d(i,"httpSelector",(function(){return S})),a.d(i,"usersSelector",(function(){return h})),a.d(i,"networkAnomaliesJobIdFilterSelector",(function(){return x})),a.d(i,"networkAnomaliesIntervalSelector",(function(){return F}));var l=a(950),o=a(338),n=a(57),r=a(45),s=a(245),c=a(187),d=a(448),u=a(125),p=a(409);const m=e=>({...e.page.queries,[o.NetworkTableType.topCountriesSource]:{...e.page.queries[o.NetworkTableType.topCountriesSource],activePage:p.a},[o.NetworkTableType.topCountriesDestination]:{...e.page.queries[o.NetworkTableType.topCountriesDestination],activePage:p.a},[o.NetworkTableType.topNFlowSource]:{...e.page.queries[o.NetworkTableType.topNFlowSource],activePage:p.a},[o.NetworkTableType.topNFlowDestination]:{...e.page.queries[o.NetworkTableType.topNFlowDestination],activePage:p.a},[o.NetworkTableType.dns]:{...e.page.queries[o.NetworkTableType.dns],activePage:p.a},[o.NetworkTableType.tls]:{...e.page.queries[o.NetworkTableType.tls],activePage:p.a},[o.NetworkTableType.http]:{...e.page.queries[o.NetworkTableType.http],activePage:p.a}}),b=e=>({...e.details.queries,[o.NetworkDetailsTableType.topCountriesSource]:{...e.details.queries[o.NetworkDetailsTableType.topCountriesSource],activePage:p.a},[o.NetworkDetailsTableType.topCountriesDestination]:{...e.details.queries[o.NetworkDetailsTableType.topCountriesDestination],activePage:p.a},[o.NetworkDetailsTableType.topNFlowSource]:{...e.details.queries[o.NetworkDetailsTableType.topNFlowSource],activePage:p.a},[o.NetworkDetailsTableType.topNFlowDestination]:{...e.details.queries[o.NetworkDetailsTableType.topNFlowDestination],activePage:p.a},[o.NetworkDetailsTableType.tls]:{...e.details.queries[o.NetworkDetailsTableType.tls],activePage:p.a},[o.NetworkDetailsTableType.users]:{...e.details.queries[o.NetworkDetailsTableType.users],activePage:p.a},[o.NetworkDetailsTableType.http]:{...e.details.queries[o.NetworkDetailsTableType.http],activePage:p.a}}),g={page:{queries:{[o.NetworkTableType.topNFlowSource]:{activePage:p.a,limit:p.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[o.NetworkTableType.topNFlowDestination]:{activePage:p.a,limit:p.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[o.NetworkTableType.dns]:{activePage:p.a,limit:p.b,sort:{field:u.n.uniqueDomains,direction:u.b.desc},isPtrIncluded:!1},[o.NetworkTableType.http]:{activePage:p.a,limit:p.b,sort:{direction:u.b.desc}},[o.NetworkTableType.tls]:{activePage:p.a,limit:p.b,sort:{field:u.r._id,direction:u.b.desc}},[o.NetworkTableType.topCountriesSource]:{activePage:p.a,limit:p.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[o.NetworkTableType.topCountriesDestination]:{activePage:p.a,limit:p.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[o.NetworkTableType.alerts]:{activePage:p.a,limit:p.b},[o.NetworkTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}}},details:{queries:{[o.NetworkDetailsTableType.http]:{activePage:p.a,limit:p.b,sort:{direction:u.b.desc}},[o.NetworkDetailsTableType.topCountriesSource]:{activePage:p.a,limit:p.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[o.NetworkDetailsTableType.topCountriesDestination]:{activePage:p.a,limit:p.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[o.NetworkDetailsTableType.topNFlowSource]:{activePage:p.a,limit:p.b,sort:{field:u.s.bytes_out,direction:u.b.desc}},[o.NetworkDetailsTableType.topNFlowDestination]:{activePage:p.a,limit:p.b,sort:{field:u.s.bytes_in,direction:u.b.desc}},[o.NetworkDetailsTableType.tls]:{activePage:p.a,limit:p.b,sort:{field:u.r._id,direction:u.b.desc}},[o.NetworkDetailsTableType.users]:{activePage:p.a,limit:p.b,sort:{field:u.t.name,direction:u.b.asc}},[o.NetworkDetailsTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"}},flowTarget:u.f.source}},w=Object(c.reducerWithInitialState)(g).case(l.updateNetworkTable,((e,{networkType:t,tableType:a,updates:i})=>({...e,[t]:{...e[t],queries:{...e[t].queries,[a]:{...Object(r.get)([t,"queries",a],e),...i}}}}))).case(l.setNetworkTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:m(e)},details:{...e.details,queries:b(e)}}))).case(l.setNetworkDetailsTablesActivePageToZero,(e=>({...e,details:{...e.details,queries:b(e)}}))).case(l.updateNetworkAnomaliesJobIdFilter,((e,{jobIds:t,networkType:a})=>a===o.NetworkType.page?Object(d.set)("page.queries.anomalies.jobIdSelection",t,e):Object(d.set)("details.queries.anomalies.jobIdSelection",t,e))).case(l.updateNetworkAnomaliesInterval,((e,{interval:t,networkType:a})=>a===o.NetworkType.page?Object(d.set)("page.queries.anomalies.intervalSelection",t,e):Object(d.set)("details.queries.anomalies.intervalSelection",t,e))).build(),y=(e,t)=>Object(r.get)(t,e.network),E=e=>e.network.page,D=e=>e.network.details,N=()=>Object(n.createSelector)(E,(e=>e.queries.dns)),T=(e,t,a)=>{const i=a===s.b.source?"topNFlowSource":"topNFlowDestination",l=t===o.NetworkType.page?o.NetworkTableType[i]:o.NetworkDetailsTableType[i];return Object(r.get)([t,"queries",l],e.network)||Object(r.get)([t,"queries",l],g)},f=()=>Object(n.createSelector)(T,(e=>e)),k=(e,t)=>{const a=t===o.NetworkType.page?o.NetworkTableType.tls:o.NetworkDetailsTableType.tls;return Object(r.get)([t,"queries",a],e.network)||Object(r.get)([t,"queries",a],g)},I=()=>Object(n.createSelector)(k,(e=>e)),v=(e,t,a)=>{const i=a===s.b.source?"topCountriesSource":"topCountriesDestination",l=t===o.NetworkType.page?o.NetworkTableType[i]:o.NetworkDetailsTableType[i];return Object(r.get)([t,"queries",l],e.network)||Object(r.get)([t,"queries",l],g)},O=()=>Object(n.createSelector)(v,(e=>e)),j=(e,t)=>{const a=t===o.NetworkType.page?o.NetworkTableType.http:o.NetworkDetailsTableType.http;return Object(r.get)([t,"queries",a],e.network)||Object(r.get)([t,"queries",a],g)},S=()=>Object(n.createSelector)(j,(e=>e)),h=()=>Object(n.createSelector)(D,(e=>e.queries.users)),x=()=>Object(n.createSelector)(y,(e=>e.queries[o.NetworkTableType.anomalies].jobIdSelection)),F=()=>Object(n.createSelector)(y,(e=>e.queries[o.NetworkTableType.anomalies].intervalSelection))},435:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var i=a(2),l=a.n(i),o=a(121),n=a(1312);const r=Object(i.memo)((()=>{const{GetStarted:e}=Object(n.a)(),{indicesExist:t}=Object(o.d)();return e?l.a.createElement(e,{indicesExist:t}):null}));r.displayName="LandingPageComponent"},745:function(e,t,a){"use strict";a.d(t,"a",(function(){return Me}));var i=a(2),l=a.n(i),o=a(48),n=a(17),r=a(124),s=a(127),c=a(118),d=a(134),u=a(122),p=a(112),m=a(194),b=a(44),g=a.n(b),w=a(136),y=a.n(w),E=a(1359),D=a(377),N=a(405),T=a(1308),f=a(1135),k=a(1121),I=a(1273),v=a(211),O=a(620),j=a(892),S=a(1322),h=a(215),x=a(1085);const F=g()(n.EuiPanel).withConfig({displayName:"FlyoutFooterContainerPanel",componentId:"sc-1y4op3v-0"})([".side-panel-flyout-footer{background-color:transparent;}"]),P=()=>({promptContextId:void 0}),C=({browserFields:e,entityType:t="events",expandedEvent:a,handleOnEventClosed:o,isDraggable:r,isFlyoutView:s,runtimeMappings:c,tabType:d,scopeId:u,isReadOnly:p})=>{var b,g;const{hasAssistantPrivilege:w}=Object(D.a)(),y=w?m.k:P,C=Object(O.a)(),{indexName:A}=a,_=null!==(b=Object(v.a)(A,C))&&void 0!==b?b:A,[q,B,M,z,V]=Object(f.a)({entityType:t,indexName:null!=_?_:"",eventId:null!==(g=a.eventId)&&void 0!==g?g:"",runtimeMappings:c,skip:!a.eventId}),R=Object(E.a)(null==M?void 0:M.fields),{isolateAction:L,isHostIsolationPanelOpen:$,isIsolateActionSuccessBannerVisible:H,handleIsolationActionSuccess:Q,showAlertDetails:G,showHostIsolationPanel:W}=Object(k.a)(),{alertId:U,isAlert:Z,hostName:J,ruleName:K,timestamp:X}=Object(v.b)(B),Y=Object(i.useMemo)((()=>s?h.A:h.D),[s]),ee=Object(i.useCallback)((async()=>Object(N.e)(null!=B?B:[])),[B]),{promptContextId:te}=y(Z?"alert":"event",Z?h.e:h.i,Z?Object(h.d)(Y):Object(h.h)(Y),ee,null,Z?x.b[x.c].suggestedUserPrompt:x.b[x.e].suggestedUserPrompt,Z?h.f:h.j),ae=Object(i.useMemo)((()=>s||$?l.a.createElement(I.c,{eventId:a.eventId,eventIndex:_,isHostIsolationPanelOpen:$,isAlert:Z,isolateAction:L,loading:q,ruleName:K,showAlertDetails:G,timestamp:X,promptContextId:te,scopeId:u,refetchFlyoutData:V,getFieldsData:R}):l.a.createElement(T.b,{eventId:a.eventId,eventIndex:_,isAlert:Z,loading:q,ruleName:K,timestamp:X,handleOnEventClosed:o,promptContextId:te,scopeId:u,refetchFlyoutData:V,getFieldsData:R})),[s,$,a.eventId,_,Z,L,q,K,G,X,te,o,u,V,R]),ie=Object(i.useMemo)((()=>s?l.a.createElement(I.a,{alertId:U,browserFields:e,detailsData:B,detailsEcsData:z,event:a,hostName:J,handleIsolationActionSuccess:Q,handleOnEventClosed:o,isAlert:Z,isDraggable:r,isolateAction:L,isIsolateActionSuccessBannerVisible:H,isHostIsolationPanelOpen:$,loading:q,rawEventData:M,showAlertDetails:G,scopeId:u,isReadOnly:p}):$?l.a.createElement(l.a.Fragment,null,H&&l.a.createElement(j.c,{hostName:J,alertId:U,isolateAction:L}),l.a.createElement(n.EuiFlyoutBody,null,l.a.createElement(S.a,{details:B,cancelCallback:G,successCallback:Q,isolateAction:L}))):l.a.createElement(l.a.Fragment,null,l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(T.a,{browserFields:e,detailsData:B,detailsEcsData:z,event:a,isAlert:Z,isDraggable:r,loading:q,rawEventData:M,scopeId:u,timelineTabType:d,handleOnEventClosed:o}))),[U,e,B,z,a,Q,o,J,Z,r,s,$,H,p,L,q,M,G,d,u]);return null!=a&&a.eventId?l.a.createElement(l.a.Fragment,null,ae,ie,l.a.createElement(F,{hasShadow:!1,borderRadius:"none"},l.a.createElement(I.b,{detailsData:B,detailsEcsData:z,refetchFlyoutData:V,handleOnEventClosed:o,isHostIsolationPanelOpen:$,isReadOnly:p,loadingEventDetails:q,onAddIsolationStatusClick:W,scopeId:u}))):null},A=l.a.memo(C,((e,t)=>y()(e.browserFields,t.browserFields)&&y()(e.expandedEvent,t.expandedEvent)&&e.scopeId===t.scopeId&&e.isDraggable===t.isDraggable));var _=a(5),q=a(119),B=a(137),M=a(147),z=a(121),V=a(1133),R=a(158),L=a(565),$=a(874),H=a(433),Q=a(896);const G=g.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-1xbsnt9-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),W=({hostName:e})=>l.a.createElement(n.EuiTitle,{size:"s"},l.a.createElement(G,null,_.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.title",{defaultMessage:"Host details"}),`: ${e}`)),U=({hostName:e})=>l.a.createElement(B.d,{hostName:e,isButton:!0},_.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.hostDetailsPageLink",{defaultMessage:"View details page"})),Z=({contextID:e,scopeId:t,hostName:a,isDraggable:n=!1})=>{const{to:r,from:c,isInitializing:d}=Object(M.a)(),{selectedPatterns:u}=Object(z.d)(),p=Object(o.useDispatch)(),[m,{hostDetails:b}]=Object(Q.b)({endDate:r,hostName:a,indexNames:u,startDate:c}),g=Object(i.useCallback)(((e,t)=>{const a=Object(H.a)(e,t);p(Object(R.setAbsoluteRangeDatePicker)({id:q.a.global,from:a.from,to:a.to}))}),[p]);return l.a.createElement(L.a,{criteriaFields:Object($.a)(b),startDate:c,endDate:r,skip:d},(({isLoadingAnomaliesData:i,anomaliesData:o,jobNameById:d})=>l.a.createElement(V.a,{contextID:e,sourcererScopeId:Object(s.getSourcererScopeId)(t),id:Q.a,isInDetailsSidePanel:!0,data:b,anomaliesData:o,isDraggable:n,isLoadingAnomaliesData:i,indexNames:u,loading:m,startDate:c,endDate:r,narrowDateRange:g,hostName:a,jobNameById:d})))},J=g()(n.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1i9mt5q-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;margin-bottom:64px;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 0px`)),K=g()(n.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1i9mt5q-1"})(["flex:1 0 auto;"]),X=g()(n.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-1i9mt5q-2"})(["align-self:flex-start;flex:1 0 auto;"]),Y=g.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-1i9mt5q-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),ee=l.a.memo((({contextID:e,scopeId:t,expandedHost:a,handleOnHostClosed:i,isDraggable:o,isFlyoutView:r})=>{const{hostName:s}=a;return s?r?l.a.createElement(l.a.Fragment,null,l.a.createElement(n.EuiFlyoutHeader,{hasBorder:!0},l.a.createElement(W,{hostName:s})),l.a.createElement(J,null,l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(U,{hostName:s}),l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(Z,{contextID:e,scopeId:t,hostName:s}))):l.a.createElement(l.a.Fragment,null,l.a.createElement(K,{justifyContent:"spaceBetween",wrap:!1},l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(W,{hostName:s})),l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(n.EuiButtonIcon,{iconType:"cross","aria-label":_.i18n.translate("xpack.securitySolution.timeline.sidePanel.hostDetails.close",{defaultMessage:"close"}),onClick:i}))),l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(X,{grow:!1},l.a.createElement(U,{hostName:s})),l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(Y,null,l.a.createElement(Z,{contextID:e,scopeId:t,hostName:s,isDraggable:o}))):null}));var te=a(54),ae=a(319),ie=a(1310),le=a(1311),oe=a(110),ne=a(172),re=a(128),se=a(1333),ce=a(308),de=a(1087),ue=a(577),pe=a(435);const me=g.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-1jm2ava-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),be=({ip:e})=>l.a.createElement(n.EuiTitle,{size:"s"},l.a.createElement(me,null,_.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.title",{defaultMessage:"Network details"}),`: ${e}`)),ge=({expandedNetwork:{ip:e,flowTarget:t}})=>l.a.createElement(B.h,{ip:e,flowTarget:t,isButton:!0},_.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.networkDetailsPageLink",{defaultMessage:"View details page"})),we=({contextID:e,expandedNetwork:t,isDraggable:a})=>{const{ip:n,flowTarget:r}=t,s=Object(o.useDispatch)(),{to:c,from:d,isInitializing:u}=Object(M.a)(),m=Object(i.useMemo)((()=>re.d.globalQuerySelector()),[]),b=Object(i.useMemo)((()=>re.d.globalFiltersQuerySelector()),[]),g=Object(p.a)(m),w=Object(p.a)(b),y=ce.c.NetworkType.details,E=Object(i.useCallback)(((e,t)=>{const a=Object(H.a)(e,t);s(Object(R.setAbsoluteRangeDatePicker)({id:q.a.global,from:a.from,to:a.to}))}),[s]),{services:{uiSettings:D}}=Object(oe.i)(),{indicesExist:N,indexPattern:T,selectedPatterns:f}=Object(z.d)(),[k,I]=Object(ne.i)({config:Object(te.getEsQueryConfig)(D),indexPattern:T,queries:[g],filters:w}),[v,{id:O,networkDetails:j}]=Object(se.b)({skip:u||void 0===k,filterQuery:k,indexNames:f,ip:n});Object(ae.a)({id:O,filterQuery:k,kqlError:I,query:g,startDate:d,endDate:c});const{jobNameById:S}=Object(ue.a)(),h=Object(i.useMemo)((()=>Object.keys(S)),[S]),[x,F]=Object(de.a)({criteriaFields:Object(le.a)(n,r),startDate:d,endDate:c,skip:u,jobIds:h,aggregationInterval:"auto"});return N?l.a.createElement(ie.a,{contextID:e,id:O,ip:n,data:j,anomaliesData:F,loading:v,isInDetailsSidePanel:!0,isLoadingAnomaliesData:x,isDraggable:a,type:y,flowTarget:r,startDate:d,endDate:c,narrowDateRange:E,indexPatterns:f,jobNameById:S}):l.a.createElement(pe.a,null)},ye=g()(n.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1tify25-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),Ee=g()(n.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1tify25-1"})(["flex:1 0 auto;"]),De=g()(n.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-1tify25-2"})(["align-self:flex-start;flex:1 0 auto;"]),Ne=g.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-1tify25-3"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),Te=l.a.memo((({contextID:e,expandedNetwork:t,handleOnNetworkClosed:a,isFlyoutView:i,isDraggable:o})=>{const{ip:r}=t;return i?l.a.createElement(l.a.Fragment,null,l.a.createElement(n.EuiFlyoutHeader,{hasBorder:!0},l.a.createElement(be,{ip:r})),l.a.createElement(ye,null,l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(ge,{expandedNetwork:t}),l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(we,{contextID:e,expandedNetwork:t}))):l.a.createElement(l.a.Fragment,null,l.a.createElement(Ee,{justifyContent:"spaceBetween",wrap:!1},l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(be,{ip:r})),l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(n.EuiButtonIcon,{iconType:"cross","aria-label":_.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:a}))),l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(De,{grow:!1},l.a.createElement(ge,{expandedNetwork:t})),l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(Ne,null,l.a.createElement(we,{contextID:e,expandedNetwork:t,isDraggable:o})))}));var fe=a(1095),ke=a(693),Ie=a(1168),ve=a(176);const Oe=g.a.h4.withConfig({displayName:"StyledTitle",componentId:"sc-19b6yfb-0"})(["word-break:break-all;word-wrap:break-word;white-space:pre-wrap;"]),je=({userName:e})=>l.a.createElement(n.EuiTitle,{size:"s"},l.a.createElement(Oe,null,_.i18n.translate("xpack.securitySolution.timeline.sidePanel.userDetails.title",{defaultMessage:"User details"}),`: ${e}`)),Se=({userName:e})=>l.a.createElement(B.m,{userName:e,isButton:!0},_.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.userDetails",{defaultMessage:"View details page"})),he=({contextID:e,scopeId:t,userName:a,isDraggable:n})=>{const{to:r,from:c,isInitializing:d}=Object(M.a)(),{selectedPatterns:u}=Object(z.d)(),p=Object(o.useDispatch)(),[m,{userDetails:b}]=Object(ke.b)({endDate:r,startDate:c,userName:a,indexNames:u,skip:d}),g=Object(i.useCallback)(((e,t)=>{const a=Object(H.a)(e,t);p(Object(R.setAbsoluteRangeDatePicker)({id:q.a.global,from:a.from,to:a.to}))}),[p]);return l.a.createElement(L.a,{criteriaFields:Object(Ie.a)(ve.UsersType.details,a),startDate:c,endDate:r,skip:d},(({isLoadingAnomaliesData:i,anomaliesData:o,jobNameById:d})=>l.a.createElement(fe.a,{userName:a,isInDetailsSidePanel:!0,data:b,loading:m,contextID:e,sourcererScopeId:Object(s.getSourcererScopeId)(t),isDraggable:n,id:"usersDetailsQuery",anomaliesData:o,isLoadingAnomaliesData:i,startDate:c,endDate:r,narrowDateRange:g,indexPatterns:u,jobNameById:d})))},xe=g()(n.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-iwngk-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow-x:hidden;overflow-y:scroll;.euiFlyoutBody__overflowContent{flex:1;overflow-x:hidden;overflow-y:scroll;padding:",";}}"],(({theme:e})=>`${e.eui.euiSizeXS} ${e.eui.euiSizeM} 64px`)),Fe=({contextID:e,scopeId:t,userName:a})=>l.a.createElement(l.a.Fragment,null,l.a.createElement(n.EuiFlyoutHeader,{hasBorder:!0},l.a.createElement(je,{userName:a})),l.a.createElement(xe,null,l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(Se,{userName:a}),l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(he,{contextID:e,scopeId:t,userName:a}))),Pe=g()(n.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-190swzt-0"})(["flex:1 0 auto;"]),Ce=g()(n.EuiFlexItem).withConfig({displayName:"StyledEuiFlexButtonWrapper",componentId:"sc-190swzt-1"})(["align-self:flex-start;flex:1 0 auto;"]),Ae=g.a.div.withConfig({displayName:"StyledPanelContent",componentId:"sc-190swzt-2"})(["display:block;height:100%;overflow-y:scroll;overflow-x:hidden;"]),_e=({contextID:e,scopeId:t,userName:a,isDraggable:i,handleOnClose:o})=>l.a.createElement(l.a.Fragment,null,l.a.createElement(Pe,{justifyContent:"spaceBetween",wrap:!1},l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(je,{userName:a})),l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(n.EuiButtonIcon,{iconType:"cross","aria-label":_.i18n.translate("xpack.securitySolution.timeline.sidePanel.networkDetails.close",{defaultMessage:"close"}),onClick:o}))),l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(Ce,{grow:!1},l.a.createElement(Se,{userName:a})),l.a.createElement(n.EuiSpacer,{size:"m"}),l.a.createElement(Ae,null,l.a.createElement(he,{contextID:e,scopeId:t,userName:a,isDraggable:i}))),qe=({contextID:e,scopeId:t,userName:a,handleOnClose:i,isFlyoutView:o,isDraggable:n})=>o?l.a.createElement(Fe,{userName:a,contextID:e,scopeId:t}):l.a.createElement(_e,{userName:a,contextID:e,isDraggable:n,handleOnClose:i,scopeId:t}),Be=l.a.memo(qe),Me=l.a.memo((({browserFields:e,entityType:t,handleOnPanelClosed:a,isFlyoutView:m,runtimeMappings:b,tabType:g,scopeId:w,isReadOnly:y})=>{var E,D,N,T;const f=Object(o.useDispatch)(),k=Object(i.useMemo)((()=>Object(s.isTimelineScope)(w)?c.b.getTimelineByIdSelector():Object(s.isInTableScope)(w)?r.j.getTableByIdSelector():void 0),[w]),I=Object(p.a)((e=>{var t,a;return null===(t=null!==(a=k&&k(e,w))&&void 0!==a?a:d.b)||void 0===t?void 0:t.expandedDetail}));Object(i.useEffect)((()=>()=>{f(r.h.toggleDetailPanel({id:w}))}),[f,w]);const v=Object(i.useCallback)((()=>{const e=Object(s.getScopedActions)(w);e&&f(e.toggleDetailPanel({id:w}))}),[f,w]),O=null!=g?g:u.d.query,j=Object(i.useCallback)((()=>{a?a():v()}),[v,a]);if(!I)return null;const S=I[O];if(null==S||!S.panelView)return null;let h=null,x="s",F=w;const P=`${w}-${O}`,C=w===u.c.active&&O===u.d.query;return"eventDetail"===(null==S?void 0:S.panelView)&&null!=S&&null!==(E=S.params)&&void 0!==E&&E.eventId&&(x="m",F=S.params.eventId,h=l.a.createElement(A,{browserFields:e,entityType:t,expandedEvent:null==S?void 0:S.params,handleOnEventClosed:j,isDraggable:C,isFlyoutView:m,runtimeMappings:b,tabType:O,scopeId:w,isReadOnly:y})),"hostDetail"===(null==S?void 0:S.panelView)&&null!=S&&null!==(D=S.params)&&void 0!==D&&D.hostName&&(F=S.params.hostName,h=l.a.createElement(ee,{contextID:P,expandedHost:null==S?void 0:S.params,handleOnHostClosed:j,isDraggable:C,isFlyoutView:m,scopeId:w})),"userDetail"===(null==S?void 0:S.panelView)&&null!=S&&null!==(N=S.params)&&void 0!==N&&N.userName&&(F=S.params.userName,h=l.a.createElement(Be,{contextID:P,userName:S.params.userName,handleOnClose:j,isDraggable:C,isFlyoutView:m,scopeId:w})),"networkDetail"===(null==S?void 0:S.panelView)&&null!=S&&null!==(T=S.params)&&void 0!==T&&T.ip&&(F=S.params.ip,h=l.a.createElement(Te,{contextID:P,expandedNetwork:null==S?void 0:S.params,handleOnNetworkClosed:j,isDraggable:C,isFlyoutView:m})),m?l.a.createElement(n.EuiFlyout,{"data-test-subj":"timeline:details-panel:flyout",size:x,onClose:j,ownFocus:!1,key:F},h):h}));Me.displayName="DetailsPanel"},950:function(e,t,a){"use strict";a.r(t),a.d(t,"updateNetworkTable",(function(){return o})),a.d(t,"setNetworkDetailsTablesActivePageToZero",(function(){return n})),a.d(t,"setNetworkTablesActivePageToZero",(function(){return r})),a.d(t,"updateNetworkAnomaliesJobIdFilter",(function(){return s})),a.d(t,"updateNetworkAnomaliesInterval",(function(){return c}));var i=a(26);const l=a.n(i)()("x-pack/security_solution/local/network"),o=l("UPDATE_NETWORK_TABLE"),n=l("SET_IP_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),r=l("SET_NETWORK_TABLES_ACTIVE_PAGE_TO_ZERO"),s=l("UPDATE_NETWORK_ANOMALIES_JOB_ID_FILTER"),c=l("UPDATE_NETWORK_ANOMALIES_INTERVAL")}}]);