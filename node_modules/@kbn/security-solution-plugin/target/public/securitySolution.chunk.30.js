/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[30],{1077:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(139),i=n(175);const r=a.b.ENDPOINT_BLOCKLISTS,s={name:i.d,namespace_type:"agnostic",description:i.b,list_id:i.c,type:r},o=["name","description","item_id","entries.value","entries.entries.value","comments.comment"]},1126:function(e,t,n){"use strict";var a=n(888);n.d(t,"a",(function(){return a.a}))},1411:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(135);const r=()=>{const{canReadBlocklist:e,canReadEventFilters:t,canReadTrustedApplications:n,canReadHostIsolationExceptions:r}=Object(i.a)().endpointPrivileges;return Object(a.useMemo)((()=>e||t||n||r),[e,t,n,r])}},1412:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),r=n(17),s=n(44),o=n.n(s),c=n(5);const u=["windows","macos","linux","total"],l={windows:c.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.windows",{defaultMessage:"Windows"}),linux:c.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.linux",{defaultMessage:"Linux"}),macos:c.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.macos",{defaultMessage:"Mac"}),total:c.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.exceptionItemsSummary.total",{defaultMessage:"Total"})},d=o()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-y73df1-0"})(["font-size:",";font-weight:",";"],(({isSmall:e,theme:t})=>e?t.eui.euiFontSizeXS:"inherit"),(({isSmall:e})=>e?"1px":"inherit")),p={fontWeight:"bold"},m=Object(a.memo)((({stats:e,isSmall:t=!1})=>{const n=Object(a.useCallback)((n=>{var a;return"total"!==n&&t?null:i.a.createElement(r.EuiFlexItem,{key:n},i.a.createElement(f,{value:null!==(a=null==e?void 0:e[n])&&void 0!==a?a:0,color:"total"!==n||t?"default":"primary",key:n,isSmall:t},l[n]))}),[e,t]);return i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:t?"flexStart":"spaceAround",gutterSize:t?"s":"l"},u.map((e=>n(e))))}));m.displayName="ExceptionItemsSummary";const f=Object(a.memo)((({children:e,value:t,color:n,isSmall:a=!1,...s})=>i.a.createElement(r.EuiText,{className:"eui-displayInlineBlock",size:a?"xs":"s"},i.a.createElement(d,{justifyContent:a?"flexStart":"center",direction:a?"rowReverse":"row",alignItems:"center",gutterSize:a?"xs":"l",isSmall:a},a?null:i.a.createElement(r.EuiFlexItem,{grow:!1,style:"primary"===n?p:void 0},e),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiBadge,{color:n},t))))));f.displayName="SummaryState"},1413:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(44),i=n.n(a),r=n(2),s=n.n(r),o=n(17),c=n(1295);const u=i.a.span.withConfig({displayName:"LinkLabel",componentId:"sc-p54il1-0"})(["display:inline-block;padding-right:",";font-size:",";"],(e=>e.theme.eui.euiSizeS),(({size:e,theme:t})=>"m"===e?t.eui.euiFontSizeXS:"innherit")),l=Object(r.memo)((({children:e,size:t="l",...n})=>s.a.createElement(c.a,n,s.a.createElement(u,{size:t},e),s.a.createElement(o.EuiIcon,{type:"m"===t?"arrowRight":"popout"}))));l.displayName="LinkWithIcon"},1414:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return c}));var a=n(44),i=n.n(a),r=n(17);const s=i()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGridGroup",componentId:"sc-1i8l9we-0"})(["display:grid;grid-template-columns:33% 45% 22%;grid-template-areas:'title summary link';"]),o=i()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexGridItem",componentId:"sc-1i8l9we-1"})(["grid-area:",";align-items:",";margin:0px;padding:12px;"],(({gridarea:e})=>e),(({alignitems:e})=>null!=e?e:"center")),c=i()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1i8l9we-2"})(["flex-direction:row-reverse;"])},1731:function(e,t,n){"use strict";n.r(t),n.d(t,"EndpointPackageCustomExtension",(function(){return P})),n.d(t,"TRUSTED_APPS_LABELS",(function(){return N})),n.d(t,"EVENT_FILTERS_LABELS",(function(){return _})),n.d(t,"HOST_ISOLATION_EXCEPTIONS_LABELS",(function(){return T})),n.d(t,"BLOCKLISTS_LABELS",(function(){return w}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(17),c=n(135),u=n(574),l=n(1411),d=n(110),p=n(952),m=n(1107),f=n(954),E=n(1126),b=n(5),g=n(47),y=n(88),S=n(70),h=n(352),x=n(1413),I=n(1412),v=n(1414),A=n(746),j=n(115);const O={artifactsSummaryApiError:e=>b.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.artifactsSummaryError",{defaultMessage:'There was an error trying to fetch artifacts stats: "{error}"',values:{error:e}}),cardTitle:s.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.title",defaultMessage:"Artifacts"})},k=Object(r.memo)((({pkgkey:e,artifactApiClientInstance:t,getArtifactsPath:n,labels:a=O,"data-test-subj":i})=>{const{getAppUrl:c}=Object(h.a)(),u=Object(d.m)(),l=n(),p=Object(j.a)(i),{data:m}=Object(A.f)(t,{},[],{onError:e=>u.addDanger(a.artifactsSummaryApiError(e.message))}),f=Object(r.useMemo)((()=>{const t=`#${y.pagePathGetters.integration_details_custom({pkgkey:e})[1]}`;return{backButtonLabel:b.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.backButtonLabel",{defaultMessage:"Return to Elastic Defend integration"}),onBackButtonNavigateTo:[S.INTEGRATIONS_PLUGIN_ID,{path:t}],backButtonUrl:c({appId:S.INTEGRATIONS_PLUGIN_ID,path:t})}}),[c,e]);return s.a.createElement(o.EuiPanel,{hasShadow:!1,paddingSize:"l",hasBorder:!0,"data-test-subj":p("fleetCard")},s.a.createElement(v.a,{alignItems:"baseline",justifyContent:"center"},s.a.createElement(v.b,{gridarea:"title",alignitems:"flex-start"},s.a.createElement(o.EuiText,null,s.a.createElement("h4",null,a.cardTitle))),s.a.createElement(v.b,{gridarea:"summary"},s.a.createElement(I.a,{stats:m})),s.a.createElement(v.b,{gridarea:"link",alignitems:"flex-end"},s.a.createElement(s.a.Fragment,null,s.a.createElement(x.a,{href:c({path:l}),appPath:l,appState:f,"data-test-subj":p("artifactsLink")},s.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.endpoint.fleetCustomExtension.manageArtifactsLinkLabel",defaultMessage:"Manage"}))))))}));k.displayName="FleetArtifactsCard";var C=n(238);const N={artifactsSummaryApiError:e=>b.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.trustedAppsSummary.error",{defaultMessage:'There was an error trying to fetch trusted applications stats: "{error}"',values:{error:e}}),cardTitle:s.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.endpoint.trustedApps.fleetIntegration.title",defaultMessage:"Trusted applications"})},_={artifactsSummaryApiError:e=>b.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.eventFiltersSummary.error",{defaultMessage:'There was an error trying to fetch event filters stats: "{error}"',values:{error:e}}),cardTitle:s.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.endpoint.eventFilters.fleetIntegration.title",defaultMessage:"Event filters"})},T={artifactsSummaryApiError:e=>b.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.hostIsolationExceptionsSummary.error",{defaultMessage:'There was an error trying to fetch host isolation exceptions stats: "{error}"',values:{error:e}}),cardTitle:s.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolationExceptions.fleetIntegration.title",defaultMessage:"Host isolation exceptions"})},w={artifactsSummaryApiError:e=>b.i18n.translate("xpack.securitySolution.endpoint.fleetCustomExtension.blocklistsSummary.error",{defaultMessage:'There was an error trying to fetch blocklist stats: "{error}"',values:{error:e}}),cardTitle:s.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.endpoint.blocklists.fleetIntegration.title",defaultMessage:"Blocklist"})},F=Object(r.memo)((e=>{const t=Object(d.h)(),n=Object(r.useMemo)((()=>p.a.getInstance(t)),[t]);return s.a.createElement(k,i()({},e,{artifactApiClientInstance:n,getArtifactsPath:C.p,labels:N,"data-test-subj":"trustedApps"}))}));F.displayName="TrustedAppsArtifactCard";const $=Object(r.memo)((e=>{const t=Object(d.h)(),n=Object(r.useMemo)((()=>m.a.getInstance(t)),[t]);return s.a.createElement(k,i()({},e,{artifactApiClientInstance:n,getArtifactsPath:C.f,labels:_,"data-test-subj":"eventFilters"}))}));$.displayName="EventFiltersArtifactCard";const L=Object(r.memo)((e=>{const t=Object(d.h)(),n=Object(r.useMemo)((()=>f.a.getInstance(t)),[t]);return s.a.createElement(k,i()({},e,{artifactApiClientInstance:n,getArtifactsPath:C.g,labels:T,"data-test-subj":"hostIsolationExceptions"}))}));L.displayName="HostIsolationExceptionsArtifactCard";const M=Object(r.memo)((e=>{const t=Object(d.h)(),n=Object(r.useMemo)((()=>E.a.getInstance(t)),[t]);return s.a.createElement(k,i()({},e,{artifactApiClientInstance:n,getArtifactsPath:C.c,labels:w,"data-test-subj":"blocklists"}))}));M.displayName="BlockListArtifactCard";const P=Object(r.memo)((e=>{const{loading:t,canReadBlocklist:n,canReadEventFilters:a,canReadTrustedApplications:i,canReadHostIsolationExceptions:d}=Object(c.a)().endpointPrivileges,p=Object(l.a)(),m=Object(r.useMemo)((()=>t?s.a.createElement(s.a.Fragment,null):p?s.a.createElement("div",{"data-test-subj":"fleetEndpointPackageCustomContent"},i&&s.a.createElement(s.a.Fragment,null,s.a.createElement(F,e),s.a.createElement(o.EuiSpacer,null)),a&&s.a.createElement(s.a.Fragment,null,s.a.createElement($,e),s.a.createElement(o.EuiSpacer,null)),d&&s.a.createElement(s.a.Fragment,null,s.a.createElement(L,e),s.a.createElement(o.EuiSpacer,null)),n&&s.a.createElement(M,e)):s.a.createElement(u.a,{docLinkSelector:e=>e.securitySolution.privileges})),[n,a,i,d,t,e,p]);return t?s.a.createElement(o.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceAround"},s.a.createElement(o.EuiFlexItem,{grow:!1},s.a.createElement(o.EuiSpacer,{size:"xl"}),s.a.createElement(o.EuiLoadingSpinner,{size:"l","data-test-subj":"endpointExtensionLoadingSpinner"}),s.a.createElement(o.EuiSpacer,{size:"xl"}))):m}));P.displayName="EndpointPackageCustomExtension"},178:function(e,t,n){"use strict";n.d(t,"h",(function(){return r})),n.d(t,"k",(function(){return s})),n.d(t,"n",(function(){return o})),n.d(t,"r",(function(){return c})),n.d(t,"m",(function(){return u})),n.d(t,"o",(function(){return l})),n.d(t,"l",(function(){return d})),n.d(t,"q",(function(){return p})),n.d(t,"p",(function(){return m})),n.d(t,"t",(function(){return f})),n.d(t,"i",(function(){return E})),n.d(t,"j",(function(){return b})),n.d(t,"g",(function(){return g})),n.d(t,"s",(function(){return y})),n.d(t,"v",(function(){return S})),n.d(t,"w",(function(){return h})),n.d(t,"u",(function(){return x})),n.d(t,"f",(function(){return I})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return A})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return O})),n.d(t,"a",(function(){return k}));var a=n(4),i=n(875);const r=`${a.Jb}/:tabName(${i.a.endpoints})`,s=`${a.Jb}/:tabName(${i.a.policies})`,o=`${a.Jb}/:tabName(${i.a.policies})/:policyId/settings`,c=`${a.Jb}/:tabName(${i.a.policies})/:policyId/trustedApps`,u=`${a.Jb}/:tabName(${i.a.policies})/:policyId/eventFilters`,l=`${a.Jb}/:tabName(${i.a.policies})/:policyId/hostIsolationExceptions`,d=`${a.Jb}/:tabName(${i.a.policies})/:policyId/blocklists`,p=`${a.Jb}/:tabName(${i.a.policies})/:policyId/protectionUpdates`,m=`${a.Jb}/:tabName(${i.a.policies})/:policyId`,f=`${a.Jb}/:tabName(${i.a.trustedApps})`,E=`${a.Jb}/:tabName(${i.a.eventFilters})`,b=`${a.Jb}/:tabName(${i.a.hostIsolationExceptions})`,g=`${a.Jb}/:tabName(${i.a.blocklist})`,y=`${a.Jb}/:tabName(${i.a.responseActionsHistory})`,S="management",h="policyDetails",x="endpoints",I=[10,20,50],v=0,A=10,j="desc",O="created_at",k=1e4},530:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(310),r=n(49);function s(){const{search:e}=Object(r.useLocation)();return Object(a.useMemo)((()=>{const t=Object(i.parse)(e);return{urlParams:t,toUrlParams:(e=t)=>Object(i.stringify)(e)}}),[e])}},737:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(139),i=n(175);const r=["item_id","name","description","entries.value"],s={name:i.j,namespace_type:"agnostic",description:i.h,list_id:i.i,type:a.b.ENDPOINT_HOST_ISOLATION_EXCEPTIONS}},875:function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.endpoints="endpoints",e.policies="policy",e.trustedApps="trusted_apps",e.eventFilters="event_filters",e.hostIsolationExceptions="host_isolation_exceptions",e.blocklist="blocklist",e.responseActionsHistory="response_actions_history",e.protectionUpdates="protection_updates"}(a||(a={}))},876:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return c}));var a=n(2),i=n(49),r=n(178),s=n(530);const o=e=>{var t,n,a;const i={pageSize:r.c,page:1};return i.page=Number(null!==(t=Array.isArray(e.page)?e.page[e.page.length-1]:e.page)&&void 0!==t?t:i.page),i.pageSize=null!==(n=Number(null!==(a=Array.isArray(e.pageSize)?e.pageSize[e.pageSize.length-1]:e.pageSize)&&void 0!==a?a:i.pageSize))&&void 0!==n?n:i.pageSize,(!Number.isFinite(i.page)||i.page<1)&&(i.page=1),r.f.includes(i.pageSize)||(i.pageSize=r.c),i},c=()=>{const e=Object(i.useLocation)(),t=Object(i.useHistory)(),{urlParams:n,toUrlParams:c}=Object(s.a)(),u=Object(a.useMemo)((()=>o(n)),[n]),[l,d]=Object(a.useState)(u),p=Object(a.useCallback)((({pageSize:a,page:i})=>{t.push({...e,search:c({...n,page:i,pageSize:a})})}),[t,e,c,n]);return Object(a.useEffect)((()=>{d((e=>({...e,...o(n)})))}),[d,n]),{pagination:l,setPagination:p,pageSizeOptions:[...r.f]}}},888:function(e,t,n){"use strict";n.d(t,"a",(function(){return BlocklistsApiClient}));var a=n(175),i=n(964),r=n(599),s=n(1077);function o(e){return{...e,entries:Object(i.b)(e.entries)}}function c(e){return{...e,entries:Object(i.a)(e.entries)}}class BlocklistsApiClient extends r.a{constructor(e){super(e,a.c,s.a,o,c)}static getInstance(e){return super.getInstance(e,a.c,s.a,o,c)}}},952:function(e,t,n){"use strict";n.d(t,"a",(function(){return TrustedAppsApiClient}));var a=n(175),i=n(964),r=n(599),s=n(953);function o(e){return{...e,entries:Object(i.b)(e.entries)}}function c(e){return{...e,entries:Object(i.a)(e.entries,!0)}}class TrustedAppsApiClient extends r.a{constructor(e){super(e,a.n,s.b,o,c)}static getInstance(e){return super.getInstance(e,a.n,s.b,o,c)}}},953:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(139),i=n(175);const r=["name","description","item_id","entries.value","entries.entries.value"],s={name:i.o,namespace_type:"agnostic",description:i.m,list_id:i.n,type:a.b.ENDPOINT_TRUSTED_APPS}},954:function(e,t,n){"use strict";n.d(t,"a",(function(){return HostIsolationExceptionsApiClient}));var a=n(175),i=n(599),r=n(737);class HostIsolationExceptionsApiClient extends i.a{constructor(e){super(e,a.i,r.a)}static getInstance(e){return super.getInstance(e,a.i,r.a)}}},964:function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(169);const i="included",r=e=>{switch(e.length){case 32:return"md5";case 40:return"sha1";case 64:return"sha256"}},s=(e,t)=>({field:e,value:t,type:"match",operator:i}),o=(e,t)=>({field:e,value:t,type:"match_any",operator:i}),c=(e,t=!1)=>{const n=[];return e.forEach((e=>{if(e.field.includes(a.b.HASH))(function(e,t){const n=[];if(!Array.isArray(t.value)){const i=s(`${e}${a.b.HASH}${r(t.value)}`,t.value.toLowerCase());return n.push(i),n}const i=t.value.reduce(((e,t)=>{const n=r(t);return n?{...e,[n]:[...e[n],t]}:e}),{md5:[],sha1:[],sha256:[]});return Object.entries(i).forEach((([t,i])=>{if(!i.length)return;const r=o(`${e}${a.b.HASH}${t}`,i.map((e=>e.toLowerCase())));n.push(r)})),n})(e.field.split(".")[0],e).forEach((e=>n.push(e)));else if(e.field.includes(a.b.SIGNER)){const a=function(e,t,n=!1){const a=Array.isArray(t)?o("subject_name",t):s("subject_name",t),i=[];return n&&i.push(s("trusted","true")),i.push(a),((e,t)=>({field:e,entries:t,type:"nested"}))(e,i)}(e.field,e.value,t);n.push(a)}else if((e.field.includes(a.b.EXECUTABLE)||e.field.includes(a.b.PATH))&&"wildcard"===e.type){const t=(c=e.field,u=e.value,Array.isArray(u)?o(c,u):((e,t)=>({field:e,value:t,type:"wildcard",operator:i}))(c,u));n.push(t)}else{const t=function(e,t){return Array.isArray(t)?o(e,t):s(e,t)}(e.field,e.value);n.push(t)}var c,u})),n},u=(e,t,n)=>({field:e,value:n,type:t,operator:i});function l(e){return`${e.split(".")[0]}${a.b.HASH}*`}const d=e=>{const t=(e=>e.reduce(((e,t)=>{const n=t.field;if(n.includes(a.b.HASH)&&"match"===t.type){const a=l(n);return{...e,[a]:u(a,t.type,t.value)}}if(n.includes(a.b.HASH)&&"match_any"===t.type){var i,r;const a=l(n),s=null!==(i=null===(r=e[a])||void 0===r?void 0:r.value)&&void 0!==i?i:[];return{...e,[a]:u(a,t.type,[...s,...t.value])}}if((n.includes(a.b.EXECUTABLE)||n.includes(a.b.PATH))&&("match"===t.type||"match_any"===t.type||"wildcard"===t.type))return{...e,[n]:u(n,t.type,t.value)};if(n.includes(a.b.SIGNER)&&"nested"===t.type){const a=t.entries.find((e=>"subject_name"===e.field&&("match"===e.type||"match_any"===e.type)));if(a)return{...e,[n]:u(n,a.type,a.value)}}return e}),{}))(e);return Object.values(t).reduce(((e,t)=>t?[...e,t]:e),[])}}}]);