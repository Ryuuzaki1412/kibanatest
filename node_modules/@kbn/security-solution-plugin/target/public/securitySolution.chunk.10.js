/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[10],{1063:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a(45),i=a(130);const o=e=>{const t=Object(i.a)("sentinelOneDataInAnalyzerEnabled");return Object(n.useMemo)((()=>{const a=[...t?["sentinel_one_cloud_funnel","sentinel_one"]:[]],n=Object(r.get)(["agent","type",0],e),i=Object(r.get)(["process","entity_id"],e),o=Object(r.get)(["process","entity_id",0],e),s=Object(r.get)(["event","module",0],e),l=Object(r.get)(["event","dataset"],e),c=Array.isArray(l)&&l.some((e=>e.includes("windows.sysmon"))),u="endpoint"===n,d="winlogbeat"===n&&"sysmon"===s,p="filebeat"===n&&a.includes(s),m=u||d||c||p,y=null!=i&&1===i.length&&""!==o;return m&&y}),[e,t])}},1064:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(50),r=a(110),i=a(866);function o({documentId:e,isActiveTimeline:t,indices:a}){const o=Object(r.h)(),{selectedPatterns:s}=Object(i.a)(t),l=[...new Set(s.concat(a))],{loading:c,id:u,schema:d}=function({documentId:e,indices:t}){const a=Object(r.h)(),i=Object(n.useQuery)(["getAlertPrevalenceSchema",e],(()=>a.get("/api/endpoint/resolver/entity",{query:{_id:e,indices:t}})));if(i.isLoading)return{loading:!0,error:!1,id:null,schema:null};if(i.data&&i.data.length>0){const{data:[{schema:e,id:t}]}=i;return{loading:!1,error:!1,id:t,schema:e}}return{loading:!1,error:!0,id:null,schema:null}}({documentId:e,indices:l}),p=Object(n.useQuery)(["getAlertPrevalenceFromProcessTree",u],(()=>o.post("/api/endpoint/resolver/tree",{body:JSON.stringify({schema:d,ancestors:200,descendants:500,indexPatterns:l,nodes:[u],includeHits:!0})})),{enabled:null!==d&&null!==u});return p.isLoading||c?{loading:!0,error:!1,alertIds:void 0,statsNodes:void 0}:p.data?{loading:!1,error:!1,alertIds:p.data.alertIds,statsNodes:p.data.statsNodes}:{loading:!1,error:!0,alertIds:void 0,statsNodes:void 0}}},1068:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(17),r=a(2),i=a.n(r),o=a(166),s=a(267),l=a(1110);const c=i.a.memo((({contextId:e,endgamePid:t,endgameProcessName:a,eventId:r,processExecutable:l,processName:c,processPid:u,isDraggable:d})=>Object(s.e)(c)&&Object(s.e)(l)&&Object(s.e)(a)&&Object(s.e)(u)&&Object(s.e)(t)?null:i.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(s.e)(c)?Object(s.e)(l)?Object(s.e)(a)?null:i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"endgame.process_name",value:a,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"process.executable",value:l,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})):i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"process.name",value:c,iconType:"console",isDraggable:d,fieldType:"keyword",isAggregatable:!0})),Object(s.e)(u)?Object(s.e)(t)?null:i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"endgame.pid",queryValue:String(t),value:`(${String(t)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})):i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(o.c,{contextId:e,eventId:r,field:"process.pid",queryValue:String(u),value:`(${String(u)})`,isDraggable:d,fieldType:"keyword",isAggregatable:!0})))));c.displayName="ProcessDraggable";const u=i.a.memo((({contextId:e,endgamePid:t,endgameProcessName:a,eventId:n,processExecutable:r,processName:o,processPid:s,isDraggable:u})=>null==t&&null==a&&null==r&&null==o&&null==s?i.a.createElement(i.a.Fragment,null,l.g):i.a.createElement(c,{contextId:e,endgamePid:t,endgameProcessName:a,eventId:n,processExecutable:r,processName:o,processPid:s,isDraggable:u})));u.displayName="ProcessDraggableWithNonExistentProcess"},1069:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a.n(n),i=a(243);const o=r.a.memo((({children:e})=>r.a.createElement(i.w,{className:"siemEventsTable__trSupplement--summary"},e)));o.displayName="RowRendererContainer"},1070:function(e,t,a){"use strict";a.d(t,"Vb",(function(){return r})),a.d(t,"oc",(function(){return i})),a.d(t,"e",(function(){return o})),a.d(t,"eb",(function(){return s})),a.d(t,"Yb",(function(){return l})),a.d(t,"db",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"pc",(function(){return d})),a.d(t,"gb",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"T",(function(){return y})),a.d(t,"kc",(function(){return g})),a.d(t,"Db",(function(){return f})),a.d(t,"y",(function(){return b})),a.d(t,"A",(function(){return h})),a.d(t,"z",(function(){return v})),a.d(t,"ob",(function(){return E})),a.d(t,"gc",(function(){return x})),a.d(t,"V",(function(){return k})),a.d(t,"Bb",(function(){return w})),a.d(t,"Ob",(function(){return j})),a.d(t,"S",(function(){return S})),a.d(t,"Q",(function(){return O})),a.d(t,"dc",(function(){return I})),a.d(t,"ic",(function(){return C})),a.d(t,"Z",(function(){return M})),a.d(t,"N",(function(){return T})),a.d(t,"mb",(function(){return _})),a.d(t,"t",(function(){return N})),a.d(t,"Hb",(function(){return D})),a.d(t,"Ub",(function(){return A})),a.d(t,"lb",(function(){return q})),a.d(t,"D",(function(){return F})),a.d(t,"M",(function(){return L})),a.d(t,"ub",(function(){return R})),a.d(t,"L",(function(){return P})),a.d(t,"h",(function(){return z})),a.d(t,"Rb",(function(){return B})),a.d(t,"g",(function(){return G})),a.d(t,"u",(function(){return $})),a.d(t,"nb",(function(){return H})),a.d(t,"H",(function(){return V})),a.d(t,"rb",(function(){return U})),a.d(t,"hc",(function(){return W})),a.d(t,"f",(function(){return Y})),a.d(t,"U",(function(){return Z})),a.d(t,"hb",(function(){return K})),a.d(t,"jc",(function(){return Q})),a.d(t,"ib",(function(){return X})),a.d(t,"o",(function(){return J})),a.d(t,"Eb",(function(){return ee})),a.d(t,"n",(function(){return te})),a.d(t,"ec",(function(){return ae})),a.d(t,"nc",(function(){return ne})),a.d(t,"lc",(function(){return re})),a.d(t,"B",(function(){return ie})),a.d(t,"P",(function(){return oe})),a.d(t,"v",(function(){return se})),a.d(t,"Jb",(function(){return le})),a.d(t,"Cb",(function(){return ce})),a.d(t,"X",(function(){return ue})),a.d(t,"Y",(function(){return de})),a.d(t,"ac",(function(){return pe})),a.d(t,"d",(function(){return me})),a.d(t,"a",(function(){return ye})),a.d(t,"Lb",(function(){return ge})),a.d(t,"Mb",(function(){return fe})),a.d(t,"Wb",(function(){return be})),a.d(t,"p",(function(){return he})),a.d(t,"Ib",(function(){return ve})),a.d(t,"Pb",(function(){return Ee})),a.d(t,"Qb",(function(){return xe})),a.d(t,"Zb",(function(){return ke})),a.d(t,"ab",(function(){return we})),a.d(t,"bb",(function(){return je})),a.d(t,"w",(function(){return Se})),a.d(t,"Kb",(function(){return Oe})),a.d(t,"q",(function(){return Ie})),a.d(t,"C",(function(){return Ce})),a.d(t,"xb",(function(){return Me})),a.d(t,"jb",(function(){return Te})),a.d(t,"yb",(function(){return _e})),a.d(t,"Fb",(function(){return Ne})),a.d(t,"E",(function(){return De})),a.d(t,"tb",(function(){return Ae})),a.d(t,"J",(function(){return qe})),a.d(t,"qb",(function(){return Fe})),a.d(t,"K",(function(){return Le})),a.d(t,"j",(function(){return Re})),a.d(t,"zb",(function(){return Pe})),a.d(t,"Nb",(function(){return ze})),a.d(t,"mc",(function(){return Be})),a.d(t,"bc",(function(){return Ge})),a.d(t,"cc",(function(){return $e})),a.d(t,"s",(function(){return He})),a.d(t,"O",(function(){return Ve})),a.d(t,"Xb",(function(){return Ue})),a.d(t,"Tb",(function(){return We})),a.d(t,"fc",(function(){return Ye})),a.d(t,"Sb",(function(){return Ze})),a.d(t,"c",(function(){return Ke})),a.d(t,"r",(function(){return Qe})),a.d(t,"G",(function(){return Xe})),a.d(t,"Gb",(function(){return Je})),a.d(t,"fb",(function(){return et})),a.d(t,"sb",(function(){return tt})),a.d(t,"F",(function(){return at})),a.d(t,"pb",(function(){return nt})),a.d(t,"Ab",(function(){return rt})),a.d(t,"I",(function(){return it})),a.d(t,"b",(function(){return ot})),a.d(t,"x",(function(){return st})),a.d(t,"kb",(function(){return lt})),a.d(t,"W",(function(){return ct})),a.d(t,"cb",(function(){return ut})),a.d(t,"R",(function(){return dt})),a.d(t,"k",(function(){return pt})),a.d(t,"vb",(function(){return mt})),a.d(t,"wb",(function(){return yt})),a.d(t,"l",(function(){return gt}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.auditd.sessionDescription",{defaultMessage:"Session"}),i=n.i18n.translate("xpack.securitySolution.auditd.wasAuthorizedToUseDescription",{defaultMessage:"was authorized to use"}),o=n.i18n.translate("xpack.securitySolution.auditd.acquiredCredentialsDescription",{defaultMessage:"acquired credentials to"}),s=n.i18n.translate("xpack.securitySolution.auditd.endedFromDescription",{defaultMessage:"ended from"}),l=n.i18n.translate("xpack.securitySolution.auditd.startedAtDescription",{defaultMessage:"started"}),c=n.i18n.translate("xpack.securitySolution.auditd.disposedCredentialsDescription",{defaultMessage:"disposed credentials to"}),u=n.i18n.translate("xpack.securitySolution.auditd.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),d=n.i18n.translate("xpack.securitySolution.auditd.withResultDescription",{defaultMessage:"with result"}),p=n.i18n.translate("xpack.securitySolution.auditd.executedDescription",{defaultMessage:"executed"}),m=n.i18n.translate("xpack.securitySolution.auditd.asDescription",{defaultMessage:"as"}),y=n.i18n.translate("xpack.securitySolution.auditd.connectedUsingDescription",{defaultMessage:"connected using"}),g=n.i18n.translate("xpack.securitySolution.auditd.usingDescription",{defaultMessage:"using"}),f=n.i18n.translate("xpack.securitySolution.auditd.OpenedFileDescription",{defaultMessage:"opened file"}),b=n.i18n.translate("xpack.securitySolution.auditd.ChangedFileAttributesOfDescription",{defaultMessage:"changed file attributes of"}),h=n.i18n.translate("xpack.securitySolution.auditd.changedFilePermissionOfDescription",{defaultMessage:"changed file permissions of"}),v=n.i18n.translate("xpack.securitySolution.auditd.changeidleOwernshipOfDescription",{defaultMessage:"changed file ownership of"}),E=n.i18n.translate("xpack.securitySolution.auditd.loaedKernelModuleOfDescription",{defaultMessage:"loaded kernel module of"}),x=n.i18n.translate("xpack.securitySolution.auditd.unloadedKernelModuleOfDescription",{defaultMessage:"unloaded kernel module of"}),k=n.i18n.translate("xpack.securitySolution.auditd.createdDirectoryDescription",{defaultMessage:"created directory"}),w=n.i18n.translate("xpack.securitySolution.auditd.mountedDescription",{defaultMessage:"mounted"}),j=n.i18n.translate("xpack.securitySolution.auditd.renamedDescription",{defaultMessage:"renamed"}),S=n.i18n.translate("xpack.securitySolution.auditd.chedckedMetaDataOfDescription",{defaultMessage:"checked metadata of"}),O=n.i18n.translate("xpack.securitySolution.auditd.checkedFileSystemMetadataOfDescription",{defaultMessage:"checked filesystem metadata of"}),I=n.i18n.translate("xpack.securitySolution.auditd.symLinkedDescription",{defaultMessage:"symbolically linked"}),C=n.i18n.translate("xpack.securitySolution.auditd.unmountedDescription",{defaultMessage:"unmounted"}),M=n.i18n.translate("xpack.securitySolution.auditd.deletedDescription",{defaultMessage:"deleted"}),T=n.i18n.translate("xpack.securitySolution.auditd.changedTimeStampOfDescription",{defaultMessage:"changed time stamp of"}),_=n.i18n.translate("xpack.securitySolution.auditd.ListeningForConnectionsUsingDescription",{defaultMessage:"listening for connections using"}),N=n.i18n.translate("xpack.securitySolution.auditd.boundSocketFromDescription",{defaultMessage:"bound socket from"}),D=n.i18n.translate("xpack.securitySolution.auditd.receivedFromDescription",{defaultMessage:"received from"}),A=n.i18n.translate("xpack.securitySolution.auditd.sentToDescription",{defaultMessage:"sent to"}),q=n.i18n.translate("xpack.securitySolution.auditd.killedProcessIdDescription",{defaultMessage:"killed process id of"}),F=n.i18n.translate("xpack.securitySolution.auditd.changedIdentityUsingDescription",{defaultMessage:"changed identity using"}),L=n.i18n.translate("xpack.securitySolution.auditd.changedSystemTimeWithDescription",{defaultMessage:"changed system time with"}),R=n.i18n.translate("xpack.securitySolution.auditd.madeDeviceWithDescription",{defaultMessage:"made device with"}),P=n.i18n.translate("xpack.securitySolution.auditd.changedSystemNameDescription",{defaultMessage:"changed system name"}),z=n.i18n.translate("xpack.securitySolution.auditd.allocatedMemoryForDescription",{defaultMessage:"allocated memory for"}),B=n.i18n.translate("xpack.securitySolution.auditd.scheduledPolicyOFDescription",{defaultMessage:"scheduled policy of"}),G=n.i18n.translate("xpack.securitySolution.auditd.addedUserAccountDescription",{defaultMessage:"added user account"}),$=n.i18n.translate("xpack.securitySolution.auditd.causedMacPolicyErrorDescription",{defaultMessage:"caused mac policy error"}),H=n.i18n.translate("xpack.securitySolution.auditd.loadedFirewallRuleDescription",{defaultMessage:"loaded firewall rule"}),V=n.i18n.translate("xpack.securitySolution.auditd.promiscuousModeDescription",{defaultMessage:"changed promiscuous mode on the device using"}),U=n.i18n.translate("xpack.securitySolution.auditd.lockedAccountDescription",{defaultMessage:"locked account"}),W=n.i18n.translate("xpack.securitySolution.auditd.unlockedAccountDescription",{defaultMessage:"unlocked account"}),Y=n.i18n.translate("xpack.securitySolution.auditd.adddedGroupAccountUsingDescription",{defaultMessage:"added group account using"}),Z=n.i18n.translate("xpack.securitySolution.auditd.crashedProgramDescription",{defaultMessage:"crashed program"}),K=n.i18n.translate("xpack.securitySolution.auditd.executionOfForbiddenProgramDescription",{defaultMessage:"execution of forbidden program"}),Q=n.i18n.translate("xpack.securitySolution.auditd.suspiciousProgramDescription",{defaultMessage:"used suspicious program"}),X=n.i18n.translate("xpack.securitySolution.auditd.failedLoginTooManyTimesDescription",{defaultMessage:"failed login due to logging in too many times"}),J=n.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusalPlaceDescription",{defaultMessage:"attempted login from unusual place"}),ee=n.i18n.translate("xpack.securitySolution.auditd.openedTooManySessionsDescription",{defaultMessage:"opened too many sessions"}),te=n.i18n.translate("xpack.securitySolution.auditd.attemptedLoginFromUnusualHourDescription",{defaultMessage:"attempted login from unusual hour"}),ae=n.i18n.translate("xpack.securitySolution.auditd.testedFileSystemIntegrityDescription",{defaultMessage:"tested file system integrity"}),ne=n.i18n.translate("xpack.securitySolution.auditd.violatedSeLinuxPolicyDescription",{defaultMessage:"violated selinux policy"}),re=n.i18n.translate("xpack.securitySolution.auditd.violatedAppArmorPolicyFromDescription",{defaultMessage:"violated app armor policy from"}),ie=n.i18n.translate("xpack.securitySolution.auditd.changedGroupDescription",{defaultMessage:"changed group"}),oe=n.i18n.translate("xpack.securitySolution.auditd.changedUserIdDescription",{defaultMessage:"changed user id"}),se=n.i18n.translate("xpack.securitySolution.auditd.changedAuditConfigurationDescription",{defaultMessage:"changed audit configuration"}),le=n.i18n.translate("xpack.securitySolution.auditd.refreshedCredentialsForDescription",{defaultMessage:"refreshed credentials for"}),ce=n.i18n.translate("xpack.securitySolution.auditd.negotiatedCryptoKeyDescription",{defaultMessage:"negotiated crypto key"}),ue=n.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedInDescription",{defaultMessage:"crypto officer logged in"}),de=n.i18n.translate("xpack.securitySolution.auditd.cryptoOfficerLoggedOutDescription",{defaultMessage:"crypto officer logged out"}),pe=n.i18n.translate("xpack.securitySolution.auditd.startedCryptoSessionDescription",{defaultMessage:"started crypto session"}),me=n.i18n.translate("xpack.securitySolution.auditd.accessResultDescription",{defaultMessage:"access result"}),ye=n.i18n.translate("xpack.securitySolution.auditd.abortedAuditStartupDescription",{defaultMessage:"aborted audit startup"}),ge=n.i18n.translate("xpack.securitySolution.auditd.remoteAuditConnectedDescription",{defaultMessage:"remote audit connected"}),fe=n.i18n.translate("xpack.securitySolution.auditd.remoteAuditDisconnectedDescription",{defaultMessage:"remote audit disconnected"}),be=n.i18n.translate("xpack.securitySolution.auditd.shutDownAuditDescription",{defaultMessage:"shutdown audit"}),he=n.i18n.translate("xpack.securitySolution.auditd.auditErrorDescription",{defaultMessage:"audit error"}),ve=n.i18n.translate("xpack.securitySolution.auditd.reconfiguredAuditDescription",{defaultMessage:"reconfigured audit"}),Ee=n.i18n.translate("xpack.securitySolution.auditd.resumedAuditLoggingDescription",{defaultMessage:"resumed audit logging"}),xe=n.i18n.translate("xpack.securitySolution.auditd.rotatedAuditLogsDescription",{defaultMessage:"rotated-audit-logs"}),ke=n.i18n.translate("xpack.securitySolution.auditd.startedAuditDescription",{defaultMessage:"started audit"}),we=n.i18n.translate("xpack.securitySolution.auditd.deletedGroupAccountUsingDescription",{defaultMessage:"deleted group account using"}),je=n.i18n.translate("xpack.securitySolution.auditd.deletedUserAccountUsingDescription",{defaultMessage:"deleted user account using"}),Se=n.i18n.translate("xpack.securitySolution.auditd.changedAuditFeatureDescription",{defaultMessage:"changed audit feature"}),Oe=n.i18n.translate("xpack.securitySolution.auditd.relabeledFileSystemDescription",{defaultMessage:"relabeled filesystem"}),Ie=n.i18n.translate("xpack.securitySolution.auditd.authenticatedToGroupDescription",{defaultMessage:"authenticated to group"}),Ce=n.i18n.translate("xpack.securitySolution.auditd.changedGroupPasswordDescription",{defaultMessage:"changed group password"}),Me=n.i18n.translate("xpack.securitySolution.auditd.modifiedGroupAccountDescription",{defaultMessage:"modified group account"}),Te=n.i18n.translate("xpack.securitySolution.auditd.initializedAuditSubsystemDescription",{defaultMessage:"initialized audit subsystem"}),_e=n.i18n.translate("xpack.securitySolution.auditd.modifiedLevelOfDescription",{defaultMessage:"modified level of"}),Ne=n.i18n.translate("xpack.securitySolution.auditd.overrodeLabelOfDescription",{defaultMessage:"overrode label of"}),De=n.i18n.translate("xpack.securitySolution.auditd.changedLoginIdToDescription",{defaultMessage:"changed login id to"}),Ae=n.i18n.translate("xpack.securitySolution.auditd.macPermissionDescription",{defaultMessage:"mac permission"}),qe=n.i18n.translate("xpack.securitySolution.auditd.changedSeLinuxBooleanDescription",{defaultMessage:"changed selinux boolean"}),Fe=n.i18n.translate("xpack.securitySolution.auditd.loadedSeLinuxPolicyDescription",{defaultMessage:"loaded selinux policy"}),Le=n.i18n.translate("xpack.securitySolution.auditd.changedSelinuxEnforcementDescription",{defaultMessage:"changed selinux enforcement"}),Re=n.i18n.translate("xpack.securitySolution.auditd.assignedUserRoleToDescription",{defaultMessage:"assigned user role to"}),Pe=n.i18n.translate("xpack.securitySolution.auditd.modifiedRoleDescription",{defaultMessage:"modified role"}),ze=n.i18n.translate("xpack.securitySolution.auditd.removedUserRoleFromDescription",{defaultMessage:"removed user role from"}),Be=n.i18n.translate("xpack.securitySolution.auditd.violatedSeccompPolicyWithDescription",{defaultMessage:"violated seccomp policy with"}),Ge=n.i18n.translate("xpack.securitySolution.auditd.startedServiceDescription",{defaultMessage:"started service"}),$e=n.i18n.translate("xpack.securitySolution.auditd.stoppedServiceDescription",{defaultMessage:"stopped service"}),He=n.i18n.translate("xpack.securitySolution.auditd.bootedSystemDescription",{defaultMessage:"booted system"}),Ve=n.i18n.translate("xpack.securitySolution.auditd.changedToRunLevelWithDescription",{defaultMessage:"changed to run level with"}),Ue=n.i18n.translate("xpack.securitySolution.auditd.shutdownSystemDescription",{defaultMessage:"shutdown system"}),We=n.i18n.translate("xpack.securitySolution.auditd.sentTestDescription",{defaultMessage:"sent test"}),Ye=n.i18n.translate("xpack.securitySolution.auditd.unknownDescription",{defaultMessage:"unknown"}),Ze=n.i18n.translate("xpack.securitySolution.auditd.sentMessageDescription",{defaultMessage:"sent message"}),Ke=n.i18n.translate("xpack.securitySolution.auditd.accessPermissionDescription",{defaultMessage:"access permission"}),Qe=n.i18n.translate("xpack.securitySolution.auditd.authenticatedUsingDescription",{defaultMessage:"authenticated using"}),Xe=n.i18n.translate("xpack.securitySolution.auditd.changedPasswordWithDescription",{defaultMessage:"changed password with"}),Je=n.i18n.translate("xpack.securitySolution.auditd.ranCommandDescription",{defaultMessage:"ran command"}),et=n.i18n.translate("xpack.securitySolution.auditd.errorFromDescription",{defaultMessage:"error from"}),tt=n.i18n.translate("xpack.securitySolution.auditd.loggedOutDescription",{defaultMessage:"logged out"}),at=n.i18n.translate("xpack.securitySolution.auditd.changedMacConfigurationDescription",{defaultMessage:"changed mac configuration"}),nt=n.i18n.translate("xpack.securitySolution.auditd.loadedMacPolicyDescription",{defaultMessage:"loaded mac policy"}),rt=n.i18n.translate("xpack.securitySolution.auditd.modifiedUserAccountDescription",{defaultMessage:"modified user account"}),it=n.i18n.translate("xpack.securitySolution.auditd.changedRoleUsingDescription",{defaultMessage:"changed role using"}),ot=n.i18n.translate("xpack.securitySolution.auditd.accessErrorDescription",{defaultMessage:"access error"}),st=n.i18n.translate("xpack.securitySolution.auditd.changedConfigurationWIthDescription",{defaultMessage:"changed configuration with"}),lt=n.i18n.translate("xpack.securitySolution.auditd.issuedVmControlDescription",{defaultMessage:"issued vm control"}),ct=n.i18n.translate("xpack.securitySolution.auditd.createdVmImageDescription",{defaultMessage:"created vm image"}),ut=n.i18n.translate("xpack.securitySolution.auditd.deletedVmImageDescription",{defaultMessage:"deleted vm image"}),dt=n.i18n.translate("xpack.securitySolution.auditd.checkedIntegrityOfDescription",{defaultMessage:"checked integrity of"}),pt=n.i18n.translate("xpack.securitySolution.auditd.assignedVmIdDescription",{defaultMessage:"assigned vm id"}),mt=n.i18n.translate("xpack.securitySolution.auditd.migratedVmFromDescription",{defaultMessage:"migrated vm from"}),yt=n.i18n.translate("xpack.securitySolution.auditd.migratedVmToDescription",{defaultMessage:"migrated vm to"}),gt=n.i18n.translate("xpack.securitySolution.auditd.assignedVMResourceDescription",{defaultMessage:"assigned vm resource"})},1078:function(e,t,a){"use strict";a.d(t,"b",(function(){return ce})),a.d(t,"a",(function(){return de}));var n=a(23),r=a.n(n),i=a(2),o=a.n(i),s=a(82),l=a(48),c=a(14),u=a(544),d=a(345),p=a(44),m=a.n(p);const y=m.a.div.attrs((({width:e})=>{if(e)return{style:{width:`${e}px`}}})).withConfig({displayName:"Field",componentId:"sc-1xzawmf-0"})(["background-color:",";border:",";box-shadow:0 2px 2px -1px ",",0 1px 5px -2px ",";font-size:",";font-weight:",";line-height:",";padding:",";"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>Object(d.rgba)(e.eui.euiColorMediumShade,.3)),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS));y.displayName="Field";const g=o.a.memo((({fieldId:e,fieldWidth:t})=>o.a.createElement(y,{"data-test-subj":"field",width:t},e)));g.displayName="DraggableFieldBadge";var f=a(174),b=a(243),h=a(17),v=a(1613),E=a(114),x=a(694),k=a(204),w=a(122),j=a(125),S=a(145),O=a(45),I=a(53),C=a(112),M=a(118),T=a(1109);const _=o.a.memo((({columnId:e,onColumnRemoved:t})=>{const a=Object(i.useCallback)((a=>{a.preventDefault(),a.stopPropagation(),t(e)}),[e,t]);return o.a.createElement(h.EuiButtonIcon,{"aria-label":T.f,color:"text","data-test-subj":"remove-column",iconType:"cross",onClick:a})}));_.displayName="CloseButton";const N=o.a.memo((({header:e,onColumnRemoved:t,sort:a,isLoading:n})=>o.a.createElement(o.a.Fragment,null,a.some((t=>t.columnId===e.id))&&n?o.a.createElement(b.d,{className:"siemEventsHeading__extra--loading"},o.a.createElement(b.h,{"data-test-subj":"timeline-loading-spinner"})):o.a.createElement(b.d,{className:"siemEventsHeading__extra--close"},o.a.createElement(_,{columnId:e.id,onColumnRemoved:t})))));N.displayName="Actions";const D=m()(h.EuiFieldText).withConfig({displayName:"FieldText",componentId:"sc-14rl5n4-0"})(["min-width:",";"],(e=>e.minwidth));D.displayName="FieldText";const A=o.a.memo((({columnId:e,minWidth:t,filter:a="",onFilterChange:n=O.noop,placeholder:r="Filter"})=>o.a.createElement(D,{"data-test-subj":"textFilter",minwidth:`${t}px`,placeholder:r,value:a,onChange:t=>{n({columnId:e,filter:t.target.value})}})));A.displayName="TextFilter";const q=o.a.memo((({header:e,onFilterChange:t=O.noop})=>{var a;return"text-filter"===e.columnHeaderType?o.a.createElement(A,{columnId:e.id,minWidth:null!==(a=e.initialWidth)&&void 0!==a?a:k.a,onFilterChange:t,placeholder:e.placeholder}):null}));q.displayName="Filter";const F=({header:e,sort:t})=>t.reduce(((t,a)=>e.id===a.columnId?a.sortDirection:t),"none"),L=({header:e,sort:t})=>t.findIndex((t=>t.columnId===e.id));var R=a(439),P=a(592);const z=o.a.memo((({sortNumber:e})=>e>=0?o.a.createElement(h.EuiNotificationBadge,{color:"subdued","data-test-subj":"sortNumber"},e+1):o.a.createElement(h.EuiIcon,{"data-test-subj":"sortEmptyNumber",type:"empty"})));var B;z.displayName="SortNumber",function(e){e.SORT_UP="sortUp",e.SORT_DOWN="sortDown"}(B||(B={}));const G=o.a.memo((({sortDirection:e,sortNumber:t})=>{const a=(e=>{switch(e){case j.b.asc:return B.SORT_UP;case j.b.desc:return B.SORT_DOWN;case"none":return;default:throw new Error("Unhandled sort direction")}})(e);return null!=a?o.a.createElement(h.EuiToolTip,{content:a===B.SORT_UP?P.e:P.f,"data-test-subj":"sort-indicator-tooltip"},o.a.createElement(o.a.Fragment,null,o.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:a}),o.a.createElement(z,{sortNumber:t}))):o.a.createElement(h.EuiIcon,{"data-test-subj":"sortIndicator",type:"empty"})}));G.displayName="SortIndicator";var $=a(732);const H=m()(h.EuiIcon).withConfig({displayName:"IconType",componentId:"sc-1mjgpab-0"})(["margin-right:3px;position:relative;top:-2px;"]);H.displayName="IconType";const V=m.a.span.withConfig({displayName:"P",componentId:"sc-1mjgpab-1"})(["margin-bottom:5px;"]);V.displayName="P";const U=m.a.span.withConfig({displayName:"ToolTipTableMetadata",componentId:"sc-1mjgpab-2"})(["margin-right:5px;display:block;font-weight:bold;"]);U.displayName="ToolTipTableMetadata";const W=m.a.span.withConfig({displayName:"ToolTipTableValue",componentId:"sc-1mjgpab-3"})(["word-wrap:break-word;"]);W.displayName="ToolTipTableValue";const Y=o.a.memo((({header:e})=>{var t;return o.a.createElement(o.a.Fragment,null,!Object(O.isEmpty)(e.category)&&o.a.createElement(V,null,o.a.createElement(U,{"data-test-subj":"category"},T.a,":"),o.a.createElement(W,{"data-test-subj":"category-value"},e.category)),o.a.createElement(V,null,o.a.createElement(U,{"data-test-subj":"field"},T.c,":"),o.a.createElement(W,{"data-test-subj":"field-value"},e.id)),o.a.createElement(V,null,o.a.createElement(U,{"data-test-subj":"type"},T.i,":"),o.a.createElement(W,null,o.a.createElement(H,{"data-test-subj":"type-icon",type:Object($.d)(e.type)}),null===(t=e.esTypes)||void 0===t?void 0:t.map((e=>o.a.createElement(h.EuiBadge,{"data-test-subj":`type-value-${e}`,key:e},e))))),!Object(O.isEmpty)(e.description)&&o.a.createElement(V,null,o.a.createElement(U,{"data-test-subj":"description"},T.b,":"),o.a.createElement(W,{"data-test-subj":"description-value"},e.description)))}));Y.displayName="HeaderToolTipContent";const Z=({children:e,header:t,isLoading:a,isResizing:n,onClick:r,showSortingCapability:i,sort:s})=>{var l,c;return o.a.createElement(b.c,{"data-test-subj":`header-${t.id}`,isLoading:a},t.aggregatable&&i?o.a.createElement(b.f,{"data-test-subj":"header-sort-button",onClick:n||a?O.noop:r},o.a.createElement(R.b,{"data-test-subj":`header-text-${t.id}`},o.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:o.a.createElement(Y,{header:t})},o.a.createElement(o.a.Fragment,null,o.a.isValidElement(t.display)?t.display:null!==(l=t.displayAsText)&&void 0!==l?l:t.id))),o.a.createElement(G,{"data-test-subj":"header-sort-indicator",sortDirection:F({header:t,sort:s}),sortNumber:L({header:t,sort:s})})):o.a.createElement(b.g,null,o.a.createElement(R.b,{"data-test-subj":`header-text-${t.id}`},o.a.createElement(h.EuiToolTip,{"data-test-subj":"header-tooltip",content:o.a.createElement(Y,{header:t})},o.a.createElement(o.a.Fragment,null,o.a.isValidElement(t.display)?t.display:null!==(c=t.displayAsText)&&void 0!==c?c:t.id)))),e)},K=o.a.memo(Z);var Q=a(57),X=a(353);const J=({header:e,onFilterChange:t=O.noop,sort:a,timelineId:n})=>{const r=Object(l.useDispatch)(),s=Object(i.useMemo)((()=>Object(Q.createSelector)(X.selectTimeline,(e=>(null==e?void 0:e.activeTab)===w.d.eql))),[]),c=Object(C.b)((e=>s(e,n))),u=Object(i.useCallback)((()=>{var t,i;const o=e.id,s=null!==(t=e.type)&&void 0!==t?t:"",l=null!==(i=e.esTypes)&&void 0!==i?i:[],c=(({clickedHeader:e,currentSort:t})=>t.reduce(((t,a)=>e.id===a.columnId?(e=>{switch(e.sortDirection){case j.b.desc:return j.b.asc;case j.b.asc:default:return j.b.desc}})(a):t),j.b.desc))({clickedHeader:e,currentSort:a}),u=a.findIndex((e=>e.columnId===o));let d=[];d=-1===u?[...a,{columnId:o,columnType:s,esTypes:l,sortDirection:c}]:[...a.slice(0,u),{columnId:o,columnType:s,esTypes:l,sortDirection:c},...a.slice(u+1)],r(M.a.updateSort({id:n,sort:d}))}),[r,e,a,n]),d=Object(i.useCallback)((e=>r(M.a.removeColumn({id:n,columnId:e}))),[r,n]),p=Object(i.useMemo)((()=>M.b.getTimelineByIdSelector()),[]),{isLoading:m}=Object(C.a)((e=>p(e,n)||{isLoading:!1})),y=!c&&!Object(I.isDataViewFieldSubtypeNested)(e);return o.a.createElement(o.a.Fragment,null,o.a.createElement(K,{header:e,isLoading:m,isResizing:!1,onClick:u,showSortingCapability:y,sort:a},o.a.createElement(N,{header:e,isLoading:m,onColumnRemoved:d,sort:a})),o.a.createElement(q,{header:e,onFilterChange:t}))},ee=o.a.memo(J),te=m()(h.EuiContextMenu).withConfig({displayName:"ContextMenu",componentId:"sc-wn02ez-0"})(["width:115px;& .euiContextMenuItem{font-size:12px;padding:4px 8px;width:115px;}"]),ae=m.a.div.withConfig({displayName:"PopoverContainer",componentId:"sc-wn02ez-1"})(["& .euiPopover__anchor{padding-right:8px;width:","px;}"],(({$width:e})=>e)),ne={right:!0},re=({draggableIndex:e,header:t,timelineId:a,isDragging:n,onFilterChange:c,sort:u,tabType:d})=>{const p=Object(i.useRef)(null),[m,y]=Object(i.useState)(!1),g=Object(i.useCallback)((()=>{var e;return null===(e=p.current)||void 0===e?void 0:e.focus()}),[]),O=Object(l.useDispatch)(),I=Object(i.useMemo)((()=>{var e;return{width:null!==(e=t.initialWidth)&&void 0!==e?e:k.a,height:"auto"}}),[t.initialWidth]),C=Object(i.useMemo)((()=>({position:n?"absolute":"relative"})),[n]),_=Object(i.useMemo)((()=>({right:o.a.createElement(b.e,null)})),[]),N=Object(i.useCallback)(((e,n,r,i)=>{O(M.a.applyDeltaToColumnWidth({columnId:t.id,delta:i.width,id:a}))}),[O,t.id,a]),D=Object(i.useMemo)((()=>Object(f.k)({contextId:`timeline-column-headers-${d}-${a}`,fieldId:t.id})),[d,a,t.id]),A=Object(i.useCallback)((e=>{var n,r;const i=t.id,o=null!==(n=t.type)&&void 0!==n?n:"",s=null!==(r=t.esTypes)&&void 0!==r?r:[],l=u.findIndex((e=>e.columnId===i)),c=-1===l?[...u,{columnId:i,columnType:o,esTypes:s,sortDirection:e}]:[...u.slice(0,l),{columnId:i,columnType:o,esTypes:s,sortDirection:e},...u.slice(l+1)];O(M.a.updateSort({id:a,sort:c}))}),[O,t,u,a]),q=Object(i.useCallback)((()=>{y(!1),g()}),[g]),F=Object(i.useMemo)((()=>[{id:0,items:[{icon:o.a.createElement(h.EuiIcon,{type:"eyeClosed",size:"s"}),name:T.e,onClick:()=>{O(M.a.removeColumn({id:a,columnId:t.id})),q()}},...d!==w.d.eql?[{disabled:!t.aggregatable,icon:o.a.createElement(h.EuiIcon,{type:"sortUp",size:"s"}),name:T.g,onClick:()=>{A(j.b.asc),q()}},{disabled:!t.aggregatable,icon:o.a.createElement(h.EuiIcon,{type:"sortDown",size:"s"}),name:T.h,onClick:()=>{A(j.b.desc),q()}}]:[]]}]),[O,q,t.aggregatable,t.id,A,d,a]),L=Object(i.useMemo)((()=>o.a.createElement(ee,{timelineId:a,header:t,onFilterChange:c,sort:u})),[t,c,u,a]),R=Object(i.useCallback)((e=>{var a;return o.a.createElement(b.o,r()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),o.a.createElement(b.p,null,o.a.createElement(ae,{$width:null!==(a=t.initialWidth)&&void 0!==a?a:k.a},o.a.createElement(h.EuiPopover,{anchorPosition:"downLeft",button:L,closePopover:q,isOpen:m,ownFocus:!0,panelPaddingSize:"none"},o.a.createElement(te,{initialPanelId:0,panels:F})))))}),[q,L,t.initialWidth,m,F]),P=Object(i.useCallback)((()=>{var e;null===(e=p.current)||void 0===e||e.focus()}),[]),z=Object(i.useCallback)((()=>{y(!0)}),[]),{onBlur:B,onKeyDown:G}=Object(x.a)({closePopover:q,draggableId:D,fieldName:t.id,keyboardHandlerRef:p,openPopover:z}),$=Object(i.useCallback)((e=>{m||G(e)}),[m,G]);return o.a.createElement(v.Resizable,{enable:ne,size:I,style:C,handleComponent:_,onResizeStop:N},o.a.createElement("div",{"aria-colindex":null!=e?e+S.c:void 0,className:E.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:P,onBlur:B,onKeyDown:$,ref:p,role:"columnheader",tabIndex:0},o.a.createElement(s.Draggable,{"data-test-subj":"draggable",disableInteractiveElementBlocking:!0,draggableId:D,index:e,key:t.id},R)))},ie=o.a.memo(re);var oe=a(116),se=a(1424);const le=o.a.memo((({children:e,onMount:t,onUnmount:a})=>(Object(i.useEffect)((()=>(t(),()=>a())),[t,a]),o.a.createElement(o.a.Fragment,null,e))));le.displayName="DraggableContainer";const ce=({globalFullScreen:e,isActiveTimelines:t,timelineFullScreen:a})=>t&&a||!1===t&&e,ue=({actionsColumnWidth:e,browserFields:t,columnHeaders:a,isEventViewer:n=!1,isSelectAllChecked:d,onSelectAll:p,show:m,showEventsSelect:y,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,leadingControlColumns:k,trailingControlColumns:w})=>{const j=Object(l.useDispatch)(),[S,O]=Object(i.useState)(null),I=Object(i.useRef)(null);Object(i.useEffect)((()=>()=>{I.current&&I.current.closeEditor()}),[]),Object(i.useEffect)((()=>{!m&&I.current&&I.current.closeEditor()}),[m]);const C=Object(i.useCallback)(((e,t,n)=>{const i=n.source.index,s=a[i];return o.a.createElement(b.o,r()({"data-test-subj":"draggable-header"},e.draggableProps,e.dragHandleProps,{ref:e.innerRef}),o.a.createElement(le,{onMount:()=>O(i),onUnmount:()=>O(null)},o.a.createElement(u.a,null,o.a.createElement(g,{fieldId:s.id,fieldWidth:s.initialWidth}))))}),[a,O]),M=Object(i.useMemo)((()=>a.map(((e,t)=>o.a.createElement(ie,{key:e.id,draggableIndex:t,timelineId:x,header:e,isDragging:S===t,sort:v,tabType:E})))),[a,x,S,v,E]),T=Object(i.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,o.a.createElement(b.r,r()({"data-test-subj":"headers-group",ref:e.innerRef,isDragging:t.isDraggingOver},e.droppableProps),M))),[M]),_=Object(i.useMemo)((()=>k?k.map((e=>e.headerCellRender)):[]),[k]),N=Object(i.useMemo)((()=>w?w.map((e=>e.headerCellRender)):[]),[w]),D=Object(se.a)({sourcererScope:oe.SourcererScopeName.timeline,editorActionsRef:I,upsertColumn:(e,t)=>j(Object(c.upsertColumn)({column:e,id:x,index:t})),removeColumn:e=>j(Object(c.removeColumn)({columnId:e,id:x}))}),A=Object(i.useMemo)((()=>_.map(((r,i)=>{const s=k[i]&&k[i].width||e;return o.a.createElement(b.q,{actionsColumnWidth:s,"data-test-subj":"actions-container",isEventViewer:n,key:i},r&&o.a.createElement(r,{width:s,browserFields:t,columnHeaders:a,isEventViewer:n,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:y,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,fieldBrowserOptions:D}))}))),[_,k,e,t,a,D,n,d,p,y,h,v,E,x]),q=Object(i.useMemo)((()=>N.map(((r,i)=>{const s=w[i]&&w[i].width||e;return o.a.createElement(b.q,{actionsColumnWidth:s,"data-test-subj":"actions-container",isEventViewer:n,key:i},r&&o.a.createElement(r,{width:s,browserFields:t,columnHeaders:a,isEventViewer:n,isSelectAllChecked:d,onSelectAll:p,showEventsSelect:y,showSelectAllCheckbox:h,sort:v,tabType:E,timelineId:x,fieldBrowserOptions:D}))}))),[N,w,e,t,a,D,n,d,p,y,h,v,E,x]);return o.a.createElement(b.s,{"data-test-subj":"column-headers"},o.a.createElement(b.v,null,A,o.a.createElement(s.Droppable,{direction:"horizontal",droppableId:`${f.g}-${E}.${x}`,isDropDisabled:!1,type:f.a,renderClone:C},T),q))},de=o.a.memo(ue)},1089:function(e,t,a){"use strict";a.d(t,"j",(function(){return b})),a.d(t,"i",(function(){return h})),a.d(t,"m",(function(){return v})),a.d(t,"d",(function(){return E})),a.d(t,"e",(function(){return x})),a.d(t,"a",(function(){return k})),a.d(t,"c",(function(){return w})),a.d(t,"n",(function(){return j})),a.d(t,"l",(function(){return S})),a.d(t,"b",(function(){return _})),a.d(t,"f",(function(){return N})),a.d(t,"g",(function(){return D})),a.d(t,"h",(function(){return A})),a.d(t,"k",(function(){return q}));var n=a(2),r=a.n(n),i=a(17),o=a(9),s=a(56),l=a.n(s),c=a(139),u=a(350),d=a(387),p=a(1277),m=a(1291),y=a(1534),g=a(1366);const f=["kibana.alert.rule","signal.rule","rule"],b=e=>e.map((e=>({username:e.created_by,timestamp:l()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:m.b,timelineAvatar:r.a.createElement(i.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:r.a.createElement(i.EuiText,{size:"s"},e.comment),actions:r.a.createElement(y.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:m.a})}))),h=e=>{const{created_at:t,created_by:a,list_id:n,tie_breaker_id:r,updated_at:i,updated_by:o,...s}=e;return{...s}},v=e=>e.map((e=>{if(void 0!==e.entries){const t=e.entries.map((e=>{const t=Object(o.omit)(e,"id");return{...t,field:t.field.startsWith("event.")?t.field.replace(/^event./,`${g.d}.`):t.field}}));return{...e,entries:t,comments:[]}}return{...e,comments:[]}})),E=(e,t)=>e.map((e=>({...e,comments:t}))),x=(e,t)=>{const a=void 0!==t?t.toISOString():void 0;return e.map((e=>({...e,expire_time:a})))},k=e=>({query:{match:{_id:{query:e||""}}}}),w=(e,t)=>e.map((e=>({...e,os_types:t}))),j=e=>{const t=["windows","macos"];if(null!=e){var a,n,r,i,o,s;const l="endpoint"===(null==e||null===(a=e.agent)||void 0===a?void 0:a.type)?null===(n=e.host)||void 0===n||null===(r=n.os)||void 0===r||null===(i=r.name)||void 0===i?void 0:i.toLowerCase():null===(o=e.host)||void 0===o||null===(s=o.os)||void 0===s?void 0:s.family;if(null!=l)return c.D.is(l)?[l]:t}return t},S=e=>e.map((e=>{const t=e.entries.map((e=>{if(e.field.includes(".hash")){if("match"===e.type)return{...e,value:e.value.toLowerCase()};if("match_any"===e.type)return{...e,value:e.value.map((e=>e.toLowerCase()))}}return e}));return{...e,entries:t}})),O=e=>{if(Array.isArray(e)&&e.length>0)return e.map((e=>{var t,a,n;return{subjectName:null!==(t=null==e?void 0:e.subject_name)&&void 0!==t?t:"",trusted:null!==(a=null==e||null===(n=e.trusted)||void 0===n?void 0:n.toString())&&void 0!==a?a:""}}));{var t,a;const n=Array.isArray(e)?void 0:e;return[{subjectName:null!==(t=null==n?void 0:n.subject_name)&&void 0!==t?t:"",trusted:null!==(a=null==n?void 0:n.trusted)&&void 0!==a?a:""}]}};function I(e){const t=[];for(const a of e)void 0!==a.entries?(a.entries=a.entries.filter((e=>void 0!==e.value&&e.value.length>0)),t.push(a)):void 0!==a.value&&a.value.length>0&&t.push(a);return t}const C=({listId:e,name:t,eventCode:a,listNamespace:n="agnostic",alertEcsData:r})=>{var i,o,s,l,c,d;const{process:p}=r,m=I([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(i=null===(o=r.Memory_protection)||void 0===o?void 0:o.feature)&&void 0!==i?i:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(s=null==p?void 0:p.executable)&&void 0!==s?s:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(l=null==p?void 0:p.name)&&void 0!==l?l:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!==(c=null==p||null===(d=p.hash)||void 0===d?void 0:d.sha256)&&void 0!==c?c:""}]);return{...Object(u.k)({listId:e,namespaceType:n,name:t}),entries:Object(u.c)(m)}},M=({listId:e,name:t,eventCode:a,listNamespace:n="agnostic",alertEcsData:r})=>{var i,o,s,l,c,d,p,m,y;const{process:g}=r,f=I([{field:"Memory_protection.feature",operator:"included",type:"match",value:null!==(i=null===(o=r.Memory_protection)||void 0===o?void 0:o.feature)&&void 0!==i?i:""},{field:"Memory_protection.self_injection",operator:"included",type:"match",value:null!==(s=String(null===(l=r.Memory_protection)||void 0===l?void 0:l.self_injection))&&void 0!==s?s:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(c=null==g?void 0:g.executable)&&void 0!==c?c:""},{field:"process.name.caseless",operator:"included",type:"match",value:null!==(d=null==g?void 0:g.name)&&void 0!==d?d:""},{field:"process.Ext.token.integrity_level_name",operator:"included",type:"match",value:null!==(p=null==g||null===(m=g.Ext)||void 0===m||null===(y=m.token)||void 0===y?void 0:y.integrity_level_name)&&void 0!==p?p:""}]);return{...Object(u.k)({listId:e,namespaceType:n,name:t}),entries:Object(u.c)(f)}},T=({listId:e,name:t,eventCode:a,listNamespace:n="agnostic",alertEcsData:r})=>{var i,o,s,l,c,d,p,m,y,g,f,b,h,v,E,x,k,w,j,S,O,C,M,T,_,N,D,A,q,F,L,R,P,z,B,G,$,H,V;const{process:U}=r,W=I([{field:"rule.id",operator:"included",type:"match",value:null!==(i=null===(o=r.rule)||void 0===o?void 0:o.id)&&void 0!==i?i:""},{field:"process.executable.caseless",operator:"included",type:"match",value:null!==(s=null==U?void 0:U.executable)&&void 0!==s?s:""},{field:"process.command_line",operator:"included",type:"match",value:null!==(l=null==U?void 0:U.command_line)&&void 0!==l?l:""},{field:"process.parent.executable",operator:"included",type:"match",value:null!==(c=null==U||null===(d=U.parent)||void 0===d?void 0:d.executable)&&void 0!==c?c:""},{field:"process.code_signature.subject_name",operator:"included",type:"match",value:null!==(p=null==U||null===(m=U.code_signature)||void 0===m?void 0:m.subject_name)&&void 0!==p?p:""},{field:"file.path",operator:"included",type:"match",value:null!==(y=null===(g=r.file)||void 0===g?void 0:g.path)&&void 0!==y?y:""},{field:"file.name",operator:"included",type:"match",value:null!==(f=null===(b=r.file)||void 0===b?void 0:b.name)&&void 0!==f?f:""},{field:"source.ip",operator:"included",type:"match",value:null!==(h=null===(v=r.source)||void 0===v?void 0:v.ip)&&void 0!==h?h:""},{field:"destination.ip",operator:"included",type:"match",value:null!==(E=null===(x=r.destination)||void 0===x?void 0:x.ip)&&void 0!==E?E:""},{field:"registry.path",operator:"included",type:"match",value:null!==(k=null===(w=r.registry)||void 0===w?void 0:w.path)&&void 0!==k?k:""},{field:"registry.value",operator:"included",type:"match",value:null!==(j=null===(S=r.registry)||void 0===S?void 0:S.value)&&void 0!==j?j:""},{field:"registry.data.strings",operator:"included",type:"match",value:null!==(O=null===(C=r.registry)||void 0===C||null===(M=C.data)||void 0===M?void 0:M.strings)&&void 0!==O?O:""},{field:"dll.path",operator:"included",type:"match",value:null!==(T=null===(_=r.dll)||void 0===_?void 0:_.path)&&void 0!==T?T:""},{field:"dll.code_signature.subject_name",operator:"included",type:"match",value:null!==(N=null===(D=r.dll)||void 0===D||null===(A=D.code_signature)||void 0===A?void 0:A.subject_name)&&void 0!==N?N:""},{field:"dll.pe.original_file_name",operator:"included",type:"match",value:null!==(q=null===(F=r.dll)||void 0===F||null===(L=F.pe)||void 0===L?void 0:L.original_file_name)&&void 0!==q?q:""},{field:"dns.question.name",operator:"included",type:"match",value:null!==(R=null===(P=r.dns)||void 0===P||null===(z=P.question)||void 0===z?void 0:z.name)&&void 0!==R?R:""},{field:"dns.question.type",operator:"included",type:"match",value:null!==(B=null===(G=r.dns)||void 0===G||null===($=G.question)||void 0===$?void 0:$.type)&&void 0!==B?B:""},{field:"user.id",operator:"included",type:"match",value:null!==(H=null===(V=r.user)||void 0===V?void 0:V.id)&&void 0!==H?H:""}]);return{...Object(u.k)({listId:e,namespaceType:n,name:t}),entries:Object(u.c)(W)}},_=(e,t,a)=>{var n,r;const i=null!==(n=a["event.code"])&&void 0!==n?n:null===(r=a.event)||void 0===r?void 0:r.code;switch(i){case"behavior":return[T({listId:e,name:t,eventCode:i,alertEcsData:a})];case"memory_signature":return[C({listId:e,name:t,eventCode:i,alertEcsData:a})];case"shellcode_thread":return[M({listId:e,name:t,eventCode:i,alertEcsData:a})];case"ransomware":return(e=>{const{process:t}=e,a=t&&t.Ext&&t.Ext.code_signature;return O(a)})(a).map((n=>(({listId:e,name:t,codeSignature:a,eventCode:n,listNamespace:r="agnostic",alertEcsData:i})=>{var o,s,l,c;const{process:d,Ransomware:p}=i,m=null!==(o=null==d||null===(s=d.hash)||void 0===s?void 0:s.sha256)&&void 0!==o?o:"",y=null!==(l=null==d?void 0:d.executable)&&void 0!==l?l:"",g=null!==(c=null==p?void 0:p.feature)&&void 0!==c?c:"";return{...Object(u.k)({listId:e,namespaceType:r,name:t}),entries:Object(u.c)([{field:"process.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=a?a.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=a?a.trusted:""}]},{field:"process.executable",operator:"included",type:"match",value:null!=y?y:""},{field:"process.hash.sha256",operator:"included",type:"match",value:null!=m?m:""},{field:"Ransomware.feature",operator:"included",type:"match",value:null!=g?g:""},{field:"event.code",operator:"included",type:"match",value:null!=n?n:""}])}})({listId:e,name:t,eventCode:i,codeSignature:n,alertEcsData:a})));default:return(e=>{const{file:t}=e,a=t&&t.Ext&&t.Ext.code_signature;return O(a)})(a).map((n=>(({listId:e,name:t,codeSignature:a,eventCode:n,listNamespace:r="agnostic",alertEcsData:i})=>{var o,s,l,c;const{file:d,host:p}=i,m=null!==(o=null==d?void 0:d.path)&&void 0!==o?o:"",y=null!==(s=null==d||null===(l=d.hash)||void 0===l?void 0:l.sha256)&&void 0!==s?s:"",g="Linux"===(null==p||null===(c=p.os)||void 0===c?void 0:c.name),f=[{field:g?"file.path":"file.path.caseless",operator:"included",type:"match",value:null!=m?m:""},{field:"file.hash.sha256",operator:"included",type:"match",value:null!=y?y:""},{field:"event.code",operator:"included",type:"match",value:null!=n?n:""}];return{...Object(u.k)({listId:e,namespaceType:r,name:t}),entries:g?Object(u.c)(f):Object(u.c)([{field:"file.Ext.code_signature",type:"nested",entries:[{field:"subject_name",operator:"included",type:"match",value:null!=a?a.subjectName:""},{field:"trusted",operator:"included",type:"match",value:null!=a?a.trusted:""}]},...f])}})({listId:e,name:t,eventCode:null!=i?i:"",codeSignature:n,alertEcsData:a})))}},N=(e,t)=>e.map((e=>({...e,name:t}))),D=e=>e.map((e=>({...Object(d.a)(e),list_id:void 0,namespace_type:"single"}))),A=(e,t)=>t.flatMap((t=>e.map((e=>({...Object(d.a)(e),list_id:t.list_id,namespace_type:t.namespace_type}))))),q=({alertData:e,exceptionItemName:t,ruleCustomHighlightedFields:a})=>{const n=F(e,a);if(!n.length)return null;const r=(({highlightedFields:e,alertData:t})=>Object.values(e).reduce(((e,a)=>{var n;const r=a.id,i=null!==(n=Object(o.get)(t,r))&&void 0!==n?n:Object(o.get)(t,`kibana.alert.${r}`);if(null!=i){const t=Array.isArray(i)?c.d.MATCH_ANY:c.d.MATCH,a=Array.isArray(i)?i.map(String):i.toString();e.push({field:r,operator:c.c.INCLUDED,type:t,value:a})}return e}),[]))({highlightedFields:n,alertData:e});return r.length?(({name:e,exceptionEntries:t})=>({...Object(u.k)({listId:void 0,namespaceType:"single",name:e}),entries:Object(u.c)(t)}))({name:t,exceptionEntries:r}):null},F=(e,t)=>{const a=Object(o.get)(e,"event.category"),n=Object(o.get)(e,"event.code"),r=Object(o.get)(e,"kibana.alert.rule.type"),i={primaryEventCategory:Array.isArray(a)?a[0]:a,allEventCategories:[a]};return((e,t,a)=>e.filter((({id:e})=>"agent.id"===e?L(a):!t.some((t=>e.startsWith(t))))))(Object(p.b)({eventCategories:i,eventCode:n,eventRuleType:r,highlightedFieldsOverride:t}),f,e)},L=e=>{if(!Object(o.get)(e,"kibana.alert.rule.uuid"))return!1;const t=Object(o.get)(e,"agent.type");return"endpoint"===(Array.isArray(t)?t[0]:t)}},1095:function(e,t,a){"use strict";a.d(t,"a",(function(){return T}));var n=a(17),r=a(55),i=a(45),o=a(2),s=a.n(o),l=a(44),c=a.n(l),u=a(125),d=a(4),p=a(110),m=a(126),y=a(464),g=a(730),f=a(159),b=a(529),h=a(137),v=a(385),E=a(210),x=a(1276),k=a(214),w=a(1286),j=a(667),S=a(479),O=a(306),I=a(1097),C=a(898);const M=c()(n.EuiFlexGroup).withConfig({displayName:"UserRiskOverviewWrapper",componentId:"sc-1f042fn-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),T=s.a.memo((({anomaliesData:e,contextID:t,sourcererScopeId:a,data:l,id:c,isDraggable:T=!1,isInDetailsSidePanel:_=!1,isLoadingAnomaliesData:N,loading:D,narrowDateRange:A,startDate:q,endDate:F,userName:L,indexPatterns:R,jobNameById:P})=>{const z=Object(E.a)(),B=Object(v.a)(z),[G]=Object(p.o)(d.C),$=Object(o.useMemo)((()=>L?Object(u.C)([L]):void 0),[L]),{data:H,isAuthorized:V}=Object(S.c)({filterQuery:$,skip:null==L,riskEntity:u.v.user}),U=Object(o.useCallback)(((e,n)=>s.a.createElement(y.a,{rowItems:Object(i.getOr)([],e,n),attrName:e,idPrefix:t?`user-overview-${t}`:"user-overview",isDraggable:T,sourcererScopeId:a})),[t,T,a]),[W,Y]=Object(o.useMemo)((()=>{const e=H&&H.length>0?H[0]:void 0;return[{title:s.a.createElement(I.a,{title:w.k,riskScoreEntity:u.v.user}),description:s.a.createElement(s.a.Fragment,null,e?Math.round(e.user.risk.calculated_score_norm):Object(m.d)())},{title:s.a.createElement(n.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(I.a,{title:w.j,riskScoreEntity:u.v.user})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(C.a,{riskScoreEntity:u.v.user}))),description:s.a.createElement(s.a.Fragment,null,e?s.a.createElement(O.a,{severity:e.user.risk.calculated_level,hideBackgroundColor:!0}):Object(m.d)())}]}),[H]),Z=Object(o.useMemo)((()=>[{title:w.i,description:l&&l.user?U("user.id",l):Object(m.d)()},{title:w.h,description:l&&l.user?U("user.domain",l):Object(m.d)()}]),[l,U]),K=Object(o.useMemo)((()=>B?[...Z,{title:w.g,description:s.a.createElement(x.a,{anomalies:e,startDate:q,endDate:F,isLoading:N,narrowDateRange:A,jobNameById:P})}]:Z),[e,Z,F,N,A,q,B,P]),Q=Object(o.useMemo)((()=>[K,[{title:w.a,description:s.a.createElement(g.a,{indexPatterns:R,field:"user.name",value:L,type:g.b.FIRST_SEEN})},{title:w.f,description:s.a.createElement(g.a,{indexPatterns:R,field:"user.name",value:L,type:g.b.LAST_SEEN})}],[{title:w.d,description:U("host.os.name",l)},{title:w.b,description:U("host.os.family",l)},{title:w.c,description:s.a.createElement(y.a,{rowItems:Object(i.getOr)([],"host.ip",l),attrName:"host.ip",idPrefix:t?`user-overview-${t}`:"user-overview",sourcererScopeId:a,isDraggable:T,render:e=>null!=e?s.a.createElement(h.h,{ip:e}):Object(m.d)()})}]]),[l,R,U,t,a,T,L,K]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(f.c,null,s.a.createElement(k.g,{direction:_?"column":"row","data-test-subj":"user-overview"},!_&&s.a.createElement(f.b,{queryId:c,title:w.e,inspectIndex:0}),Q.map(((e,t)=>s.a.createElement(j.a,{descriptionList:e,key:t}))),D&&s.a.createElement(b.a,{overlay:!0,overlayBackground:G?r.euiDarkVars.euiPageBackgroundColor:r.euiLightVars.euiPageBackgroundColor,size:"xl"}))),V&&s.a.createElement(M,{gutterSize:_?"m":"none",direction:_?"column":"row","data-test-subj":"user-risk-overview",$width:_?"100%":"66.6%"},s.a.createElement(n.EuiFlexItem,null,s.a.createElement(k.d,{listItems:[W]})),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(k.d,{listItems:[Y]}))))}));T.displayName="UserOverview"},1097:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(125),o=a(1362);const s=({riskScoreEntity:e,title:t})=>r.a.createElement(r.a.Fragment,null,null!=t?t:e===i.v.user?o.c:o.a),l=r.a.memo(s);l.displayName="RiskScoreHeaderTitle"},1103:function(e,t,a){"use strict";a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return h})),a.d(t,"d",(function(){return v})),a.d(t,"c",(function(){return E}));var n=a(2),r=a.n(n),i=a(45),o=a(139),s=a(17),l=a(738),c=a(1104),u=a(1089),d=a(1319),p=a(1370);const m=e=>t=>""!==e.trim()?Object(u.d)(t,[{comment:e}]):t,y=e=>t=>""!==e.trim()?Object(u.f)(t,e):t,g=e=>t=>Object(u.e)(t,e),f=(e,t)=>a=>e===o.b.ENDPOINT?Object(u.l)(Object(u.c)(a,t)):a,b=({itemName:e,commentToAdd:t,addToRules:a,addToSharedLists:n,sharedLists:r,selectedOs:s,listType:l,expireTime:c,items:d})=>{const p=Object(i.pipe)(m(t),g(c),y(e),f(l,s),((e,t)=>a=>t&&e!==o.b.ENDPOINT?Object(u.g)(a):a)(l,a),((e,t,a)=>n=>t&&e!==o.b.ENDPOINT?Object(u.h)(n,a):n)(l,n,r))(d);return p},h=({itemName:e,commentToAdd:t,selectedOs:a,listType:n,expireTime:r,items:o})=>Object(i.pipe)(m(t),g(r),y(e),f(n,a))(o),v=()=>[{field:"name",name:p.c,sortable:!0,"data-test-subj":"exceptionListNameCell"},{field:"referenced_rules",name:"Number of rules linked to",sortable:!1,"data-test-subj":"exceptionListRulesLinkedToIdCell",render:e=>r.a.createElement(l.e,{emptyButton:!0,useCustomActions:!0,actions:Object(l.j)({dataTestSubj:"addToSharedListsLinkedRulesMenu",linkedRules:e,securityLinkAnchorComponent:d.f}),panelPaddingSize:"none",disableActions:!1,text:e.length.toString(),dataTestSubj:"addToSharedListsLinkedRulesMenuAction"})},{name:p.a,"data-test-subj":"exceptionListRulesActionCell",render:e=>r.a.createElement(d.e,{dataTestSubj:"exceptionListActionCell-link",linkTitle:p.e,listId:e.list_id,external:!0})}],E=()=>[{field:"name",align:"left",name:p.c,sortable:!0,"data-test-subj":"ruleNameCell",truncateText:!1},{field:"tags",align:"left",name:p.d,"data-test-subj":"ruleNameCell",render:e=>0===e.length?null:r.a.createElement(c.a,{items:e,popoverTitle:p.d,popoverButtonTitle:e.length.toString(),popoverButtonIcon:"tag",dataTestPrefix:"tags",renderItem:(e,t)=>r.a.createElement(s.EuiBadge,{color:"hollow",key:`${e}-${t}`,"data-test-subj":"tag"},e)})},{name:p.a,"data-test-subj":"ruleAction-view",render:e=>r.a.createElement(d.f,{external:!0,referenceId:e.id,referenceName:p.f})}]},1105:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"e",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u}));var n=a(5);n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.pageTitle",{defaultMessage:"Rule details"}),n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.backToRulesButton",{defaultMessage:"Rules"});const r=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.enableRuleLabel",{defaultMessage:"Enable"}),i=(n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.unknownDescription",{defaultMessage:"Unknown"}),n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExceptionsTab",{defaultMessage:"Rule exceptions"})),o=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.endpointExceptionsTab",{defaultMessage:"Endpoint exceptions"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionResultsTab",{defaultMessage:"Execution results"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleExecutionEventsTab",{defaultMessage:"Execution events"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deletedRule",{defaultMessage:"Deleted rule"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.deleteRuleConfirmationBody",{defaultMessage:'This action will delete the rule. Click "Delete" to continue.'})},1106:function(e,t,a){"use strict";var n=a(1161);a.d(t,"e",(function(){return n.d})),a.d(t,"d",(function(){return n.c})),a.d(t,"c",(function(){return n.b}));var r=a(531);a.d(t,"a",(function(){return r.b})),a.d(t,"b",(function(){return r.d}))},1109:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"h",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"f",(function(){return p}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.timeline.categoryTooltip",{defaultMessage:"Category"}),i=n.i18n.translate("xpack.securitySolution.timeline.descriptionTooltip",{defaultMessage:"Description"}),o=n.i18n.translate("xpack.securitySolution.timeline.fieldTooltip",{defaultMessage:"Field"}),s=n.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),l=n.i18n.translate("xpack.securitySolution.timeline.hideColumnLabel",{defaultMessage:"Hide column"}),c=n.i18n.translate("xpack.securitySolution.timeline.sortAZLabel",{defaultMessage:"Sort A-Z"}),u=n.i18n.translate("xpack.securitySolution.timeline.sortZALabel",{defaultMessage:"Sort Z-A"}),d=n.i18n.translate("xpack.securitySolution.timeline.typeTooltip",{defaultMessage:"Type"}),p=n.i18n.translate("xpack.securitySolution.timeline.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"})},1112:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"f",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"e",(function(){return c}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.threatMatch.fieldDescription",{defaultMessage:"Field"}),i=n.i18n.translate("xpack.securitySolution.threatMatch.threatFieldDescription",{defaultMessage:"Indicator index field"}),o=n.i18n.translate("xpack.securitySolution.threatMatch.fieldPlaceholderDescription",{defaultMessage:"Search"}),s=n.i18n.translate("xpack.securitySolution.threatMatch.matchesLabel",{defaultMessage:"MATCHES"}),l=n.i18n.translate("xpack.securitySolution.threatMatch.andDescription",{defaultMessage:"AND"}),c=n.i18n.translate("xpack.securitySolution.threatMatch.orDescription",{defaultMessage:"OR"})},1113:function(e,t,a){"use strict";a.d(t,"m",(function(){return r})),a.d(t,"p",(function(){return i})),a.d(t,"g",(function(){return o})),a.d(t,"k",(function(){return s})),a.d(t,"v",(function(){return l})),a.d(t,"t",(function(){return c})),a.d(t,"r",(function(){return u})),a.d(t,"s",(function(){return d})),a.d(t,"n",(function(){return p})),a.d(t,"j",(function(){return m})),a.d(t,"q",(function(){return y})),a.d(t,"y",(function(){return g})),a.d(t,"u",(function(){return f})),a.d(t,"o",(function(){return b})),a.d(t,"l",(function(){return h})),a.d(t,"x",(function(){return v})),a.d(t,"w",(function(){return E})),a.d(t,"f",(function(){return x})),a.d(t,"h",(function(){return k})),a.d(t,"i",(function(){return w})),a.d(t,"b",(function(){return j})),a.d(t,"c",(function(){return S})),a.d(t,"a",(function(){return O})),a.d(t,"e",(function(){return I})),a.d(t,"d",(function(){return C}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.filtersLabel",{defaultMessage:"Filters"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryLabel",{defaultMessage:"Custom query"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlQueryLabel",{defaultMessage:"EQL query"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.esqlQueryLabel",{defaultMessage:"ES|QL query"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatQueryLabel",{defaultMessage:"Indicator index query"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedIdLabel",{defaultMessage:"Saved query name"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryFiltersLabel",{defaultMessage:"Saved query filters"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.savedQueryLabel",{defaultMessage:"Saved query"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.mlRuleTypeDescription",{defaultMessage:"Machine Learning"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.eqlRuleTypeDescription",{defaultMessage:"Event Correlation"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.queryRuleTypeDescription",{defaultMessage:"Query"}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.thresholdRuleTypeDescription",{defaultMessage:"Threshold"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.threatMatchRuleTypeDescription",{defaultMessage:"Indicator Match"}),b=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.newTermsRuleTypeDescription",{defaultMessage:"New Terms"}),h=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.esqlRuleTypeDescription",{defaultMessage:"ES|QL"}),v=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAllDescription",{defaultMessage:"All results"}),E=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.thresholdResultsAggregatedByDescription",{defaultMessage:"Results aggregated by"}),x=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlEventCategoryFieldLabel",{defaultMessage:"Event category field"}),k=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTiebreakerFieldLabel",{defaultMessage:"Tiebreaker field"}),w=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.eqlTimestampFieldLabel",{defaultMessage:"Timestamp field"}),j=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionPerRuleExecution",{defaultMessage:"One rule execution"}),S=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionSuppressOnMissingFieldsDescription",{defaultMessage:"Suppress and group alerts for events with missing fields"}),O=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.alertSuppressionDoNotSuppressOnMissingFieldsDescription",{defaultMessage:"Do not suppress alerts for events with missing fields"}),I=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.buildingBlockLabel",{defaultMessage:"Building block"}),C=n.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.buildingBlockDescription",{defaultMessage:'All generated alerts will be marked as "building block" alerts'})},1120:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return s}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolateHost",{defaultMessage:"Isolate host"}),i=n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolateHost",{defaultMessage:"Release host"}),o=e=>n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolateHost.casesAssociatedWithAlert",{defaultMessage:"{caseCount} {caseCount, plural, one {case} other {cases}} associated with this host",values:{caseCount:e}}),s=n.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.returnToAlertDetails",{defaultMessage:"Return to alert details"})},1121:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(1508);const i={isolateAction:"isolateHost",isHostIsolationPanelOpen:!1,isIsolateActionSuccessBannerVisible:!1};function o(e,t){switch(t.type){case"setIsolateAction":return{...e,isolateAction:t.isolateAction};case"setIsHostIsolationPanel":return{...e,isHostIsolationPanelOpen:t.isHostIsolationPanelOpen};case"setIsIsolateActionSuccessBannerVisible":return{...e,isIsolateActionSuccessBannerVisible:t.isIsolateActionSuccessBannerVisible};default:throw new Error}}const s=()=>{const[{isolateAction:e,isHostIsolationPanelOpen:t,isIsolateActionSuccessBannerVisible:a},s]=Object(n.useReducer)(o,i),l=Object(n.useCallback)((()=>{s({type:"setIsHostIsolationPanel",isHostIsolationPanelOpen:!1}),s({type:"setIsIsolateActionSuccessBannerVisible",isIsolateActionSuccessBannerVisible:!1})}),[]),c=Object(n.useCallback)((e=>{"isolateHost"!==e&&"unisolateHost"!==e||(s({type:"setIsHostIsolationPanel",isHostIsolationPanelOpen:!0}),s({type:"setIsolateAction",isolateAction:e}))}),[]),u=Object(r.b)(),d=Object(n.useCallback)((()=>{s({type:"setIsIsolateActionSuccessBannerVisible",isIsolateActionSuccessBannerVisible:!0}),u&&u.refreshCase()}),[u]);return Object(n.useMemo)((()=>({isolateAction:e,isHostIsolationPanelOpen:t,isIsolateActionSuccessBannerVisible:a,handleIsolationActionSuccess:d,showAlertDetails:l,showHostIsolationPanel:c})),[t,a,e,d,l,c])}},1128:function(e,t,a){"use strict";a.d(t,"b",(function(){return w})),a.d(t,"a",(function(){return A})),a.d(t,"d",(function(){return _})),a.d(t,"c",(function(){return y}));var n=a(5);const r=n.i18n.translate("autocomplete.loadingDescription",{defaultMessage:"Loading..."}),i=n.i18n.translate("autocomplete.selectField",{defaultMessage:"Please select a field first..."}),o=n.i18n.translate("autocomplete.fieldRequiredError",{defaultMessage:"Value cannot be empty"}),s=n.i18n.translate("autocomplete.invalidNumberError",{defaultMessage:"Not a valid number"}),l=n.i18n.translate("autocomplete.invalidDateError",{defaultMessage:"Not a valid date"}),c=n.i18n.translate("autocomplete.invalidBinaryType",{defaultMessage:"Binary fields are currently unsupported"}),u=n.i18n.translate("autocomplete.fieldSpaceWarning",{defaultMessage:"Warning: Spaces at the start or end of this value aren't being displayed."}),d=(n.i18n.translate("autocomplete.listsTooltipWarning",{defaultMessage:"Lists that aren't able to be processed by this rule type will be disabled."}),n.i18n.translate("autocomplete.seeDocumentation",{defaultMessage:"See Documentation"}),n.i18n.translate("autocomplete.conflictIndicesWarning.title",{defaultMessage:"Mapping Conflict"})),p=n.i18n.translate("autocomplete.conflictIndicesWarning.description",{defaultMessage:"This field is defined as different types across the following indices or is unmapped. This can cause unexpected query results."}),m=(e,t)=>n.i18n.translate("autocomplete.conflictIndicesWarning.index.description",{defaultMessage:"{name} ({count} indices)",values:{count:t,name:e}});var y={LOADING:r,SELECT_FIELD_FIRST:i,FIELD_REQUIRED_ERR:o,NUMBER_ERR:s,DATE_ERR:l,FIELD_SPACE_WARNING:u,BINARY_TYPE_NOT_SUPPORTED:c},g=a(2),f=a.n(g),b=a(17),h=a(13),v=a(350);const E=({getLabel:e,options:t,selectedOptions:a,disabledOptions:n})=>{const r=t.map(e),i=null==n?void 0:n.map(e),o=r.map((e=>({label:e,disabled:i&&0!==i.length&&i.includes(e)}))),s=a.map(e).filter((e=>-1!==r.indexOf(e))).map((e=>o[r.indexOf(e)]));return{comboOptions:o,labels:r,selectedComboOptions:s}},x={binary:c},k={asPlainText:!0},w=({fieldInputWidth:e,fieldTypeFilter:t=[],indexPattern:a,isClearable:r=!1,isDisabled:i=!1,isLoading:o=!1,isRequired:s=!1,onChange:l,placeholder:c,selectedField:u,acceptsCustomOptions:y=!1,showMappingConflicts:w=!1})=>{const{isInvalid:j,comboOptions:S,selectedComboOptions:O,fieldWidth:I,renderFields:C,handleTouch:M,handleValuesChange:T,handleCreateCustomOption:_}=(({indexPattern:e,fieldTypeFilter:t,isRequired:a,selectedField:n,fieldInputWidth:r,showMappingConflicts:i,onChange:o})=>{const[s,l]=Object(g.useState)(!1),[c,u]=Object(g.useState)(null),y=Object(b.useEuiPaddingSize)("s"),{availableFields:k,selectedFields:w}=Object(g.useMemo)((()=>((e,t,a)=>{const n=(e=>null!=e?e.fields:[])(e),r=(e=>e&&""!==e.name.trim()?[e]:[])(t),i=((e,t,a)=>{const n=new Map;e.forEach((e=>n.set(e.name,e))),t.forEach((e=>n.set(e.name,e)));const r=Array.from(n.values());return a&&(null==a?void 0:a.length)>0?r.filter((({type:e})=>a.includes(e))):r})(n,r,a);return{availableFields:i,selectedFields:r}})(null!=c&&null!=e?{...e,fields:[c,...null==e?void 0:e.fields]}:e,n,t)),[e,t,n,c]),{comboOptions:j,labels:S,selectedComboOptions:O,disabledLabelTooltipTexts:I,mappingConflictsTooltipInfo:C}=Object(g.useMemo)((()=>(e=>{const{availableFields:t,selectedFields:a}=e,n=E({getLabel:e=>e.name,options:t,selectedOptions:a}),r=(e=>e.availableFields.reduce(((e,t)=>{var a;const n=null===(a=t.esTypes)||void 0===a?void 0:a.find((e=>x[e])),r=n&&x[n]||x[t.type];return r&&(e[t.name]=r),e}),{}))(e),i=(e=>e.availableFields.reduce(((e,t)=>{const a=Object(v.j)(t);return a?(e[t.name]=a,e):e}),{}))(e);return{...n,disabledLabelTooltipTexts:r,mappingConflictsTooltipInfo:i}})({availableFields:k,selectedFields:w})),[k,w]),M=Object(g.useCallback)((e=>{const t=e.map((({label:e})=>k[S.indexOf(e)]));o(t)}),[k,S,o]),T=Object(g.useCallback)((e=>{e.trim().toLowerCase()&&(u({name:e,type:"text"}),o([{name:e,type:"text"}]))}),[o]),_=Object(g.useCallback)((()=>{l(!0)}),[l]),N=Object(g.useMemo)((()=>r?{width:`${r}px`}:{}),[r]);return{isInvalid:Object(g.useMemo)((()=>!!a&&s&&null==n),[a,n,s]),comboOptions:j,selectedComboOptions:O,fieldWidth:N,renderFields:e=>{const{label:t}=e,a=I[t];if(a)return e.disabled=!0,Object(h.jsx)(b.EuiToolTip,{"data-test-subj":"disabledLabelWithTooltip",content:a,position:"bottom"},Object(h.jsx)(f.a.Fragment,null,t));const n=C[t];if(i&&n){const e=Object(h.jsx)(f.a.Fragment,null,p,n.map((e=>{const t=e.groupedIndices.map((({name:e,count:t})=>`${t>1?m(e,t):e}`));return Object(h.jsx)(f.a.Fragment,null,Object(h.jsx)(b.EuiSpacer,{size:"s"}),`${e.totalIndexCount>1?m(e.type,e.totalIndexCount):e.type}: ${t.join(", ")}`)})));return Object(h.jsx)(b.EuiToolTip,{"data-test-subj":"mappingConflictsTooltip",position:"bottom",content:e},Object(h.jsx)(f.a.Fragment,null,t,Object(h.jsx)(b.EuiIcon,{"data-test-subj":"mappingConflictsWarningIcon",tabIndex:0,type:"warning",title:d,size:"s",css:Object(h.css)({marginLeft:`${y}`},"","")})))}return t},handleTouch:_,handleValuesChange:M,handleCreateCustomOption:T}})({indexPattern:a,fieldTypeFilter:t,isRequired:s,selectedField:u,fieldInputWidth:e,showMappingConflicts:w,onChange:l});return y?Object(h.jsx)(b.EuiComboBox,{placeholder:c,options:S,selectedOptions:O,onChange:T,isLoading:o,isDisabled:i,isClearable:r,isInvalid:j,onFocus:M,singleSelection:k,"data-test-subj":"fieldAutocompleteComboBox",style:I,onCreateOption:_,customOptionText:n.i18n.translate("autocomplete.customOptionText",{defaultMessage:"Add {searchValuePlaceholder} as a custom field",values:{searchValuePlaceholder:"{searchValue}"}}),fullWidth:!0,renderOption:C}):Object(h.jsx)(b.EuiComboBox,{placeholder:c,options:S,selectedOptions:O,onChange:T,isLoading:o,isDisabled:i,isClearable:r,isInvalid:j,onFocus:M,singleSelection:k,"data-test-subj":"fieldAutocompleteComboBox",style:I,fullWidth:!0,renderOption:C})};w.displayName="Field";a(387),a(85);var j=a(9),S=a(139),O=a(53);const I=({selectedField:e,operatorType:t,fieldValue:a,query:n,indexPattern:r,autocompleteService:i})=>{const[o,s]=Object(g.useState)(!1),[l,c]=Object(g.useState)(!0),[u,d]=Object(g.useState)([]),p=Object(g.useRef)(null);return Object(g.useEffect)((()=>{let o=!0;const l=new AbortController,u=Object(j.debounce)((async({fieldSelected:e,patterns:t,searchQuery:a})=>{try{if(o){if(null==e||null==t)return;if("boolean"===e.type)return void c(!1);s(!0);const n=Object(O.getDataViewFieldSubtypeNested)(e),r=n?{...e,name:`${n.nested.path}.${e.name}`}:e,o=await i.getValueSuggestions({field:r,indexPattern:t,query:a,signal:l.signal,useTimeRange:!1});0===o.length&&c(!1),s(!1),d([...o])}}catch(e){o&&(d([]),s(!1))}}),500);return t!==S.d.EXISTS&&u({fieldSelected:e,patterns:r,searchQuery:n,value:a}),p.current=u,()=>{o=!1,l.abort()}}),[e,t,a,r,n,i]),[o,l,u,p.current]};var C=a(65),M=a.n(C);const T=(e,t,a,n)=>{if(null==t)return;const r=((e,t,a,n)=>a&&n&&(null==e||""===e.trim())?o:null==t||a&&!n||!(a||null!=e&&""!==e)?void 0:null)(e,t,a,n);if(null!==r)return r;switch(t.type){case"date":const t=M.a.parse(null!=e?e:"");return Boolean(t&&t.isValid())?void 0:l;case"number":return null==e||""===e.trim()||isNaN(+e)?s:void 0;default:return}},_=e=>e&&e.trim().length!==e.length,N=[{inputDisplay:"true",value:"true"},{inputDisplay:"false",value:"false"}],D={asPlainText:!0},A=({placeholder:e,rowLabel:t,selectedField:a,selectedValue:n,indexPattern:o,isLoading:s,isDisabled:l=!1,isClearable:c=!1,isRequired:d=!1,fieldInputWidth:p,autocompleteService:m,onChange:y,onError:f})=>{const[v,x]=Object(g.useState)(""),[k,w]=Object(g.useState)(!1),[O,C]=Object(g.useState)(void 0),[M,A]=Object(g.useState)(!1),[q,F,L]=I({autocompleteService:m,fieldValue:n,indexPattern:o,operatorType:S.d.MATCH,query:v,selectedField:a}),R=Object(g.useCallback)((e=>e),[]),P=Object(g.useMemo)((()=>{const e=String(n);return null!=n&&""!==n.trim()?Object(j.uniq)([e,...L]):L}),[L,n]),z=Object(g.useMemo)((()=>{const e=String(n);return n?[e]:[]}),[n]),B=Object(g.useCallback)((e=>{if(!e)return A(!1);A(!!_(e))}),[A]),G=Object(g.useCallback)((e=>{C((t=>{const a=null!=e;return null!=t!==a&&null!=f&&f(a),e}))}),[C,f]),{comboOptions:$,labels:H,selectedComboOptions:V}=Object(g.useMemo)((()=>E({getLabel:R,options:P,selectedOptions:z})),[P,z,R]),U=Object(g.useCallback)((e=>{const[t]=e.map((({label:e})=>P[H.indexOf(e)]));B(t),G(void 0),y(null!=t?t:"")}),[G,B,H,y,P]),W=Object(g.useCallback)((e=>{if(""!==e&&null!=a){const t=T(e,a,d,k);G(t),t||B(e),x(e)}}),[G,B,d,a,k]),Y=Object(g.useCallback)((e=>{const t=T(e,a,d,k);if(G(t),null!=t)return A(!1),!1;B(e),y(e)}),[d,y,a,k,G,B]),Z=Object(g.useCallback)((e=>{const t=e.target.value;y(t)}),[y]),K=Object(g.useCallback)((e=>{y(e)}),[y]),Q=Object(g.useCallback)((()=>{w(!0);const e=T(n,a,d,!0);G(e)}),[w,G,n,a,d]),X=Object(g.useMemo)((()=>s||q?r:null==a?i:e),[s,a,q,e]),J=Object(g.useMemo)((()=>s||q),[s,q]);Object(g.useEffect)((()=>{C(void 0),null!=f&&f(!1),B(n)}),[null==a?void 0:a.name,null==a?void 0:a.type,n,B,f]);const ee=Object(g.useMemo)((()=>Object(h.jsx)(b.EuiFormRow,{label:t,error:O,isInvalid:null!=a&&null!=O,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0,helpText:M&&u},Object(h.jsx)(b.EuiComboBox,{placeholder:X,isDisabled:l||!a,isLoading:J,isClearable:c,options:$,selectedOptions:V,onChange:U,singleSelection:D,onSearchChange:W,onCreateOption:Y,isInvalid:null!=a&&null!=O,onBlur:Q,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteMatch",style:p?{width:`${p}px`}:{},fullWidth:!0,async:!0}))),[$,O,p,X,c,l,J,t,V,a,M,Y,W,U,Q]);if(F||null==a)return ee;switch(a.type){case"number":return Object(h.jsx)(b.EuiFormRow,{label:t,error:O,isInvalid:null!=a&&null!=O,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(h.jsx)(b.EuiFieldNumber,{placeholder:X,onBlur:Q,value:"string"==typeof n&&n.trim().length>0?parseFloat(n):null!=n?n:"",onChange:Z,"data-test-subj":"valueAutocompleteFieldMatchNumber",style:p?{width:`${p}px`}:{},fullWidth:!0}));case"boolean":return Object(h.jsx)(b.EuiFormRow,{label:t,error:O,isInvalid:null!=a&&null!=O,"data-test-subj":"valuesAutocompleteMatchLabel",fullWidth:!0},Object(h.jsx)(b.EuiSuperSelect,{isLoading:J,options:N,valueOfSelected:null!=n?n:"true",onChange:K,"data-test-subj":"valuesAutocompleteMatchBoolean",style:p?{width:`${p}px`}:{},fullWidth:!0}));default:return ee}};A.displayName="AutocompleteFieldMatch";const q={asPlainText:!0};Object(g.memo)((({autocompleteService:e,placeholder:t,rowLabel:a,selectedField:n,selectedValue:o,indexPattern:s,isLoading:l,isDisabled:c=!1,isClearable:d=!1,isRequired:p=!1,fieldInputWidth:m,onChange:y,onError:f,onWarning:v,warning:x})=>{const[k,w]=Object(g.useState)(""),[O,C]=Object(g.useState)(!1),[M,N]=Object(g.useState)(void 0),[D,A]=Object(g.useState)(!1),[F,,L]=I({autocompleteService:e,fieldValue:o,indexPattern:s,operatorType:S.d.WILDCARD,query:k,selectedField:n}),R=Object(g.useCallback)((e=>e),[]),P=Object(g.useMemo)((()=>{const e=String(o);return null!=o&&""!==o.trim()?Object(j.uniq)([e,...L]):L}),[L,o]),z=Object(g.useMemo)((()=>{const e=String(o);return o?[e]:[]}),[o]),B=Object(g.useCallback)((e=>{if(!e)return A(!1);A(!!_(e))}),[A]),G=Object(g.useCallback)((e=>{N((t=>{const a=null!=e;return null!=t!==a&&null!=f&&f(a),e}))}),[N,f]),$=Object(g.useCallback)((e=>{v(void 0!==e)}),[v]),{comboOptions:H,labels:V,selectedComboOptions:U}=Object(g.useMemo)((()=>E({getLabel:R,options:P,selectedOptions:z})),[P,z,R]),W=Object(g.useCallback)((e=>{const[t]=e.map((({label:e})=>P[V.indexOf(e)]));G(void 0),B(t),A(!1),y(null!=t?t:"")}),[G,B,V,y,P]),Y=Object(g.useCallback)((e=>{if(""!==e.trim()&&null!=n){const t=T(e,n,p,O);G(t),$(x),t||B(e),w(e)}}),[G,B,p,n,O,x,$]),Z=Object(g.useCallback)((e=>{const t=T(e,n,p,O);if(G(t),$(x),null!=t)return A(!1),!1;B(e),y(e)}),[p,B,y,n,O,G,$,x]),K=Object(g.useCallback)((()=>{C(!0);const e=T(o,n,p,!0);G(e),$(x)}),[C,G,o,n,p,$,x]),Q=Object(g.useMemo)((()=>l||F?r:null==n?i:t),[l,n,F,t]),X=Object(g.useMemo)((()=>l||F),[l,F]);return Object(g.useEffect)((()=>{N(void 0),null!=f&&f(!1),B(o),v(!1)}),[n,o,f,v,B]),Object(g.useMemo)((()=>Object(h.jsx)(b.EuiFormRow,{label:a,error:M,helpText:x||D&&u,isInvalid:null!=n&&null!=M,"data-test-subj":"valuesAutocompleteWildcardLabel",fullWidth:!0},Object(h.jsx)(b.EuiComboBox,{placeholder:Q,isDisabled:c||!n,isLoading:X,isClearable:d,options:H,selectedOptions:U,onChange:W,singleSelection:q,onSearchChange:Y,onCreateOption:Z,isInvalid:null!=n&&null!=M,onBlur:K,sortMatchesBy:"startsWith","data-test-subj":"valuesAutocompleteWildcard",style:m?{width:`${m}px`}:{},fullWidth:!0,async:!0}))),[H,M,m,Z,Y,W,Q,d,c,X,a,U,n,K,x,D])})).displayName="AutocompleteFieldWildcard"},1133:function(e,t,a){"use strict";a.d(t,"a",(function(){return R}));var n=a(17),r=a(55),i=a(45),o=a(2),s=a.n(o),l=a(44),c=a.n(l),u=a(125),d=a(4),p=a(110),m=a(126),y=a(464),g=a(730),f=a(159),b=a(529),h=a(137),v=a(385),E=a(210),x=a(1276),k=a(214),w=a(1288),j=a(895),S=a(667),O=a(5);const I=O.i18n.translate("xpack.securitySolution.host.details.endpoint.endpointPolicy",{defaultMessage:"Endpoint integration policy"}),C=O.i18n.translate("xpack.securitySolution.host.details.endpoint.policyStatus",{defaultMessage:"Policy Status"}),M=O.i18n.translate("xpack.securitySolution.host.details.endpoint.sensorversion",{defaultMessage:"Endpoint version"}),T=O.i18n.translate("xpack.securitySolution.host.details.endpoint.fleetAgentStatus",{defaultMessage:"Agent status"});var _=a(571);const N=s.a.memo((({contextID:e,data:t,sourcererScopeId:a})=>{const r=Object(o.useCallback)(((t,n,r)=>s.a.createElement(y.a,{rowItems:[Object(i.getOr)("",t,n)],attrName:r,idPrefix:e?`endpoint-overview-${e}`:"endpoint-overview",sourcererScopeId:a})),[e,a]),l=Object(o.useMemo)((()=>{var e,a,i;const o=null==t||null===(e=t.hostInfo)||void 0===e?void 0:e.metadata.Endpoint.policy.applied;return[[{title:I,description:null!==(a=null==o?void 0:o.name)&&void 0!==a?a:Object(m.d)()}],[{title:C,description:null!=o&&o.status?s.a.createElement(n.EuiHealth,{"aria-label":null==o?void 0:o.status,color:(null==o?void 0:o.status)===_.a.failure?"danger":null==o?void 0:o.status},null==o?void 0:o.status):Object(m.d)()}],[{title:M,description:null!=t&&null!==(i=t.hostInfo)&&void 0!==i&&i.metadata.agent.version?r("hostInfo.metadata.agent.version",t,"agent.version"):Object(m.d)()}],[{title:T,description:null!=t&&t.hostInfo?s.a.createElement(j.a,{endpointHostInfo:t.hostInfo,"data-test-subj":"endpointHostAgentStatus"}):Object(m.d)()}]]}),[t,r]);return s.a.createElement(s.a.Fragment,null,l.map(((e,t)=>s.a.createElement(S.a,{dataTestSubj:"endpoint-overview",descriptionList:e,key:t}))))}));N.displayName="EndpointOverview";var D=a(479),A=a(306),q=a(1097),F=a(898);const L=c()(n.EuiFlexGroup).withConfig({displayName:"HostRiskOverviewWrapper",componentId:"sc-p9r0sg-0"})(["padding-top:",";width:",";"],(({theme:e})=>e.eui.euiSizeM),(({$width:e})=>e)),R=s.a.memo((({anomaliesData:e,contextID:t,sourcererScopeId:a,data:l,endDate:c,id:j,isDraggable:O=!1,isInDetailsSidePanel:I=!1,isLoadingAnomaliesData:C,indexNames:M,loading:T,narrowDateRange:_,startDate:R,hostName:P,jobNameById:z})=>{const B=Object(E.a)(),G=Object(v.a)(B),[$]=Object(p.o)(d.C),H=Object(o.useMemo)((()=>P?Object(u.B)([P]):void 0),[P]),{data:V,isAuthorized:U}=Object(D.c)({filterQuery:H,riskEntity:u.v.host,skip:null==P}),W=Object(o.useCallback)(((e,n)=>s.a.createElement(y.a,{rowItems:Object(i.getOr)([],e,n),attrName:e,idPrefix:t?`host-overview-${t}`:"host-overview",isDraggable:O,sourcererScopeId:a})),[t,O,a]),[Y,Z]=Object(o.useMemo)((()=>{const e=V&&V.length>0?V[0]:void 0;return[{title:s.a.createElement(q.a,{title:w.g,riskScoreEntity:u.v.host}),description:s.a.createElement(s.a.Fragment,null,e?Math.round(e.host.risk.calculated_score_norm):Object(m.d)())},{title:s.a.createElement(n.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(q.a,{title:w.f,riskScoreEntity:u.v.host})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(F.a,{riskScoreEntity:u.v.host}))),description:s.a.createElement(s.a.Fragment,null,e?s.a.createElement(A.a,{severity:e.host.risk.calculated_level,hideBackgroundColor:!0}):Object(m.d)())}]}),[V]),K=Object(o.useMemo)((()=>[{title:w.e,description:l&&l.host?Object(y.e)({host:l.host,isDraggable:O,noLink:!0}):Object(m.d)()},{title:w.d,description:s.a.createElement(g.a,{indexPatterns:M,field:"host.name",value:P,type:g.b.FIRST_SEEN})},{title:w.k,description:s.a.createElement(g.a,{indexPatterns:M,field:"host.name",value:P,type:g.b.LAST_SEEN})}]),[l,M,P,O]),Q=Object(o.useMemo)((()=>G?[...K,{title:w.n,description:s.a.createElement(x.a,{anomalies:e,startDate:R,endDate:c,isLoading:C,narrowDateRange:_,jobNameById:z})}]:K),[e,K,c,C,_,R,G,z]),X=Object(o.useMemo)((()=>[Q,[{title:w.j,description:s.a.createElement(y.a,{rowItems:Object(i.getOr)([],"host.ip",l),attrName:"host.ip",idPrefix:t?`host-overview-${t}`:"host-overview",sourcererScopeId:a,isDraggable:O,render:e=>null!=e?s.a.createElement(h.h,{ip:e}):Object(m.d)()})},{title:w.m,description:W("host.mac",l)},{title:w.p,description:W("host.os.platform",l)}],[{title:w.o,description:W("host.os.name",l)},{title:w.c,description:W("host.os.family",l)},{title:w.r,description:W("host.os.version",l)},{title:w.a,description:W("host.architecture",l)}],[{title:w.b,description:W("cloud.provider",l)},{title:w.q,description:W("cloud.region",l)},{title:w.i,description:W("cloud.instance.id",l)},{title:w.l,description:W("cloud.machine.type",l)}]]),[t,a,l,Q,W,O]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(f.c,null,s.a.createElement(k.g,{direction:I?"column":"row","data-test-subj":"host-overview"},!I&&s.a.createElement(f.b,{queryId:j,title:w.h,inspectIndex:0}),X.map(((e,t)=>s.a.createElement(S.a,{descriptionList:e,key:t}))),T&&s.a.createElement(b.a,{overlay:!0,overlayBackground:$?r.euiDarkVars.euiPageBackgroundColor:r.euiLightVars.euiPageBackgroundColor,size:"xl"}))),U&&s.a.createElement(L,{gutterSize:I?"m":"none",direction:I?"column":"row","data-test-subj":"host-risk-overview",$width:I?"100%":"50%"},s.a.createElement(n.EuiFlexItem,null,s.a.createElement(k.d,{listItems:[Y]})),s.a.createElement(n.EuiFlexItem,null,s.a.createElement(k.d,{listItems:[Z]}))),l&&null!=l.endpoint?s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiHorizontalRule,null),s.a.createElement(k.g,{direction:I?"column":"row"},s.a.createElement(N,{contextID:t,data:l.endpoint,sourcererScopeId:a}),T&&s.a.createElement(b.a,{overlay:!0,overlayBackground:$?r.euiDarkVars.euiPageBackgroundColor:r.euiLightVars.euiPageBackgroundColor,size:"xl"}))):null)}));R.displayName="HostOverview"},1138:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a.n(n),i=a(17);const o=a(5).i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.TechnicalPreviewLabel",{defaultMessage:"Technical Preview"}),s=({label:e})=>r.a.createElement(r.a.Fragment,null,e,r.a.createElement(i.EuiBetaBadge,{label:o,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}))},1148:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(17),r=a(2),i=a.n(r),o=a(125),s=a(1287),l=a(110);const c=({riskScoreEntity:e,title:t})=>{const a=(e=>{const{docLinks:t}=Object(l.i)().services,a=t.links.securitySolution.entityAnalytics;return Object(r.useMemo)((()=>e?e===o.v.user?a.userRiskScore:a.hostRiskScore:a.entityRiskScoring),[e,a])})(e);return i.a.createElement(n.EuiLink,{target:"_blank",rel:"noopener nofollow noreferrer",href:a},t||Object(s.e)(e))},u=i.a.memo(c);u.displayName="RiskScoreDocLink"},1156:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"c",(function(){return l}));var n=a(264);const r=({group:e,id:t,action_type_id:a,params:n,uuid:r,frequency:i,alerts_filter:o})=>({group:e,id:t,params:n,actionTypeId:a,...o&&{alertsFilter:o},...r&&{uuid:r},...i&&{frequency:i}}),i=({group:e,id:t,actionTypeId:a,params:n,uuid:r,frequency:i,alertsFilter:o})=>({group:e,id:t,params:n,action_type_id:a,...o&&{alerts_filter:o},...r&&{uuid:r},...i&&{frequency:i}}),o=({group:e,id:t,params:a,frequency:n,alertsFilter:r})=>({group:e,id:t,params:a,...r&&{alerts_filter:r},...n&&{frequency:n}}),s=({action_type_id:e,params:t})=>{if(e===n.b[".osquery"]){const{saved_query_id:a,ecs_mapping:n,pack_id:r,...i}=t;return{params:{...i,savedQueryId:a,ecsMapping:n,packId:r},actionTypeId:e}}return{params:t,actionTypeId:e}},l=({actionTypeId:e,params:t})=>{if(e===n.b[".osquery"]){const{savedQueryId:a,ecsMapping:n,packId:r,...i}=t;return{params:{...i,saved_query_id:a,ecs_mapping:n,pack_id:r},action_type_id:e}}return{params:t,action_type_id:e}}},1157:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"j",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"k",(function(){return m})),a.d(t,"c",(function(){return y}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.advancedSettingsButton",{defaultMessage:"Advanced settings"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addReferenceDescription",{defaultMessage:"Add reference URL"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addFalsePositiveDescription",{defaultMessage:"Add false positive example"}),s=(n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.addCustomHighlightedFieldDescription",{defaultMessage:"Add a custom highlighted field"}),n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.endpointExceptionListLabel",{defaultMessage:"Elastic Endpoint exceptions"})),l=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.buildingBlockLabel",{defaultMessage:"Building block"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionLowDescription",{defaultMessage:"Low"}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionMediumDescription",{defaultMessage:"Medium"}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionHighDescription",{defaultMessage:"High"}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRuleForm.severityOptionCriticalDescription",{defaultMessage:"Critical"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.referencesUrlInvalidError",{defaultMessage:"URL is invalid format"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutrule.noteHelpText",{defaultMessage:"Add rule investigation guide..."})},1159:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(413);const r=e=>Object(n.a)(e)},1161:function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(51),r=a(531);const i=r.b.length,o=e=>{var t;return void 0!==(null!==(t=e.tags)&&void 0!==t?t:[]).find((e=>e===r.d))},s=e=>!o(e),l=e=>{var t;const a=[],n=null!==(t=e.tags)&&void 0!==t?t:[];for(const e of n)e!==r.d&&e.startsWith(r.b)&&a.push(e.substring(i));return a},c=e=>({comments:[],description:"",entries:[],item_id:void 0,list_id:e,meta:{temporaryUuid:Object(n.v4)()},name:"",namespace_type:"agnostic",tags:[r.d],type:"simple",os_types:["windows"]})},1162:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a.n(n),i=a(17),o=a(115);const s=Object(n.memo)((({title:e,subtitle:t,actions:a,children:s,restrictWidth:l=!1,hasBottomBorder:c=!0,hideHeader:u=!1,headerBackComponent:d,...p})=>{const m=Object(n.useMemo)((()=>r.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart"},r.a.createElement(i.EuiFlexItem,{grow:!1},d&&r.a.createElement(r.a.Fragment,null,d)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiTitle,{size:"l"},r.a.createElement("span",{"data-test-subj":"header-page-title"},e))))),[d,e]),y=Object(n.useMemo)((()=>t?r.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},t):void 0),[t]),g=Object(o.a)(p["data-test-subj"]);return r.a.createElement("div",p,!u&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiPageHeader,{pageTitle:m,description:y,bottomBorder:c,rightSideItems:a?[a]:void 0,restrictWidth:l,"data-test-subj":g("header")}),r.a.createElement(i.EuiSpacer,{size:"l"})),r.a.createElement(i.EuiPageSection,{paddingSize:"none",color:"transparent",restrictWidth:l},s))}));s.displayName="AdministrationListPage"},1163:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(23),r=a.n(n),i=a(2),o=a.n(i),s=a(17),l=a(44),c=a.n(l),u=a(733),d=a(115);const p=c()(s.EuiContextMenuItem).withConfig({displayName:"StyledEuiContextMenuItem",componentId:"sc-t3r55d-0"})([".additional-info{display:none;max-width:50%;}&:hover{.additional-info{display:block !important;}}"]),m=c()("div").withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-t3r55d-1"})(["max-width:50%;padding-right:",";"],(e=>e.theme.eui.euiSizeS)),y=c()(s.EuiText).withConfig({displayName:"StyledEuiText",componentId:"sc-t3r55d-2"})(["padding:",";line-height:",";"],(e=>e.theme.eui.euiSizeM),(e=>e.theme.eui.euiFontSizeM)),g=Object(i.memo)((({navigateAppId:e,navigateOptions:t,onClick:a,textTruncate:n,hoverInfo:l,children:c,isNavigationDisabled:g=!1,...f})=>{const b=Object(u.a)(null!=e?e:"",{...t,onClick:a}),h=Object(d.a)(f["data-test-subj"]),v=Object(i.useMemo)((()=>{const e="additional-info "+("object"!=typeof l?"eui-textTruncate":"");return l?o.a.createElement(m,{className:e},l):null}),[l]),E=n?o.a.createElement(o.a.Fragment,null,o.a.createElement("div",r()({className:"eui-textTruncate","data-test-subj":h("truncateWrapper")},"string"==typeof c?{title:c}:{}),c),v):o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiFlexItem,null,c),v);return g?o.a.createElement(y,{size:"s",className:"eui-textTruncate","data-test-subj":f["data-test-subj"]},E):o.a.createElement(p,r()({},f,{onClick:e?b:a}),o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},E))}));g.displayName="EuiContextMenuItemNavByRouter"},1164:function(e,t,a){"use strict";a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return p}));var n=a(50),r=a(3),i=a(200),o=a(110),s=a(178),l=a(924),c=a(1293);function u({onError:e,page:t,perPage:a}={page:1,perPage:s.c}){const r=Object(o.h)();return Object(n.useQuery)(["endpointSpecificPolicies",t,a],(()=>Object(c.a)(r,{query:{page:t,perPage:a,withAgentCount:!0}})),e?{onError:e}:void 0)}function d(e){const{data:t}=Object(o.i)().services;return Object(n.useQuery)(["endpointPackagePoliciesStatsStrategy"],(async()=>Object(r.firstValueFrom)(t.search.search({},{strategy:i.l}))),{select:e=>e.rawResponse,enabled:e})}function p({customQueryOptions:e}){const t=Object(o.h)();return Object(n.useQuery)(["endpointPackageVersion",e],(()=>Object(l.c)(t)),e)}},1165:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return s}));var n=a(531);function r(e){return(null==e?void 0:e.filter((e=>!e.startsWith("policy:"))))||[]}function i(e,t=[]){return e.isGlobal?[n.d,...t]:e.selected.map((e=>`policy:${e.id}`)).concat(t)}function o(e,t){return e.find((e=>e===n.d))?{isGlobal:!0,selected:[]}:{isGlobal:!1,selected:e.reduce(((e,a)=>{const n=a.split(":")[1],r=t.find((e=>e.id===n));return void 0!==r&&e.push(r),e}),[])}}function s(e){return void 0!==e&&void 0!==e.find((e=>e===n.d))}},1270:function(e,t,a){"use strict";a.d(t,"a",(function(){return Xt}));var n=a(2),r=a.n(n),i=a(17),o=a(48),s=a(44),l=a.n(s),c=a(151),u=a(1078),d=a(127),p=a(1390),m=a(118),y=a(112),g=a(189),f=a(110),b=a(961),h=a(243),v=a(113),E=a(14),x=a(134),k=a(45);const w={process:{hash:{md5:["177afc1eb0be88eb9983fb74111260c4"],sha256:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb"],sha1:["f573b85e9beb32121f1949217947b2adc6749e3d"]},entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTY5MjAtMTMyNDg5OTk2OTAuNDgzMzA3NzAw"],executable:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],name:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],pid:[6920],args:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"]},host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1518)"],name:["Windows"],version:["1809 (10.0.17763.1518)"],platform:["windows"],family:["windows"],kernel:["1809 (10.0.17763.1518)"]},mac:["aa:bb:cc:dd:ee:ff"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"],name:["win2019-endpoint-1"]},file:{mtime:["2020-11-04T21:40:51.494Z"],path:["C:\\Users\\sean\\Downloads\\3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],owner:["sean"],hash:{md5:["177afc1eb0be88eb9983fb74111260c4"],sha256:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb"],sha1:["f573b85e9beb32121f1949217947b2adc6749e3d"]},name:["3be13acde2f4dcded4fd8d518a513bfc9882407a6e384ffb17d12710db7d76fb.exe"],extension:["exe"],size:[1604112]},event:{category:["malware","intrusion_detection","process"],outcome:["success"],severity:[73],code:["malicious_file"],action:["execution"],id:["LsuMZVr+sdhvehVM++++Gp2Y"],kind:["alert"],created:["2020-11-04T21:41:30.533Z"],module:["endpoint"],type:["info","start","denied"],dataset:["endpoint.alerts"]},agent:{type:["endpoint"]},timestamp:"2020-11-04T21:41:30.533Z",message:["Malware Prevention Alert"],_id:"0dA2lXUBn9bLIbfPkY7d"};var j=a(687),S=a(672),O=a(291);const I=()=>{const e=Object(j.c)({eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:S.S});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:w,isDraggable:!1,scopeId:O.a}))},C=r.a.memo(I),M=[{_id:"1",data:[{field:"@timestamp",value:["2018-11-05T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"event.action",value:["Action"]},{field:"host.name",value:["apache"]},{field:"source.ip",value:["192.168.0.1"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["john.dee"]}],ecs:{_id:"1",timestamp:"2018-11-05T19:03:25.937Z",host:{name:["apache"],ip:["192.168.0.1"]},event:{id:["1"],action:["Action"],category:["Access"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.1"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["john.dee"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"3",data:[{field:"@timestamp",value:["2018-11-07T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["nginx"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["evan.davis"]}],ecs:{_id:"3",timestamp:"2018-11-07T19:03:25.937Z",host:{name:["nginx"],ip:["192.168.0.1"]},event:{id:["3"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[1]},source:{ip:["192.168.0.3"],port:[443]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["3"],name:["evan.davis"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"4",data:[{field:"@timestamp",value:["2018-11-08T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Attempted Administrator Privilege Gain"]},{field:"host.name",value:["suricata"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jenny.jones"]}],ecs:{_id:"4",timestamp:"2018-11-08T19:03:25.937Z",host:{name:["suricata"],ip:["192.168.0.1"]},event:{id:["4"],category:["Attempted Administrator Privilege Gain"],type:["Alert"],module:["suricata"],severity:[1]},source:{ip:["192.168.0.3"],port:[53]},destination:{ip:["192.168.0.3"],port:[6343]},suricata:{eve:{flow_id:[4],proto:[""],alert:{signature:["ET EXPLOIT NETGEAR WNR2000v5 hidden_lang_avi Stack Overflow (CVE-2016-10174)"],signature_id:[4]}}},user:{id:["4"],name:["jenny.jones"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"5",data:[{field:"@timestamp",value:["2018-11-09T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.3"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["becky.davis"]}],ecs:{_id:"5",timestamp:"2018-11-09T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["5"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.3"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["5"],name:["becky.davis"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"6",data:[{field:"@timestamp",value:["2018-11-10T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["braden.davis"]},{field:"source.ip",value:["192.168.0.6"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]}],ecs:{_id:"6",timestamp:"2018-11-10T19:03:25.937Z",host:{name:["braden.davis"],ip:["192.168.0.1"]},event:{id:["6"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.6"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"8",data:[{field:"@timestamp",value:["2018-11-12T19:03:25.937Z"]},{field:"event.severity",value:["2"]},{field:"event.category",value:["Web Application Attack"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.8"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"8",timestamp:"2018-11-12T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["8"],category:["Web Application Attack"],type:["Alert"],module:["suricata"],severity:[2]},suricata:{eve:{flow_id:[8],proto:[""],alert:{signature:["ET WEB_SERVER Possible CVE-2014-6271 Attempt in HTTP Cookie"],signature_id:[8]}}},source:{ip:["192.168.0.8"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["8"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"7",data:[{field:"@timestamp",value:["2018-11-11T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.7"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"7",timestamp:"2018-11-11T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["7"],category:["Access"],type:["HTTP Request"],module:["apache"],severity:[3]},source:{ip:["192.168.0.7"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["7"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"9",data:[{field:"@timestamp",value:["2018-11-13T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.9"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"9",timestamp:"2018-11-13T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["9"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.9"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["9"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"10",data:[{field:"@timestamp",value:["2018-11-14T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.10"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"10",timestamp:"2018-11-14T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["10"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.10"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["10"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"11",data:[{field:"@timestamp",value:["2018-11-15T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.11"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"11",timestamp:"2018-11-15T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["11"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.11"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["11"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"12",data:[{field:"@timestamp",value:["2018-11-16T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.12"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["jone.doe"]}],ecs:{_id:"12",timestamp:"2018-11-16T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["12"],category:["Access"],type:["HTTP Request"],module:["nginx"],severity:[3]},source:{ip:["192.168.0.12"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["12"],name:["jone.doe"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"2",data:[{field:"@timestamp",value:["2018-11-06T19:03:25.937Z"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Authentication"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.2"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["joe.bob"]}],ecs:{_id:"2",timestamp:"2018-11-06T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["2"],category:["Authentication"],type:["Authentication Success"],module:["authlog"],severity:[3]},source:{ip:["192.168.0.2"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["joe.bob"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"13",data:[{field:"@timestamp",value:["2018-13-12T19:03:25.937Z"]},{field:"event.severity",value:["1"]},{field:"event.category",value:["Web Application Attack"]},{field:"host.name",value:["joe.computer"]},{field:"source.ip",value:["192.168.0.8"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]}],ecs:{_id:"13",timestamp:"2018-12-12T19:03:25.937Z",host:{name:["joe.computer"],ip:["192.168.0.1"]},event:{id:["13"],category:["Web Application Attack"],type:["Alert"],module:["suricata"],severity:[1]},suricata:{eve:{flow_id:[13],proto:[""],alert:{signature:["ET WEB_SERVER Possible Attempt in HTTP Cookie"],signature_id:[13]}}},source:{ip:["192.168.0.8"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"14",data:[{field:"@timestamp",value:["2019-03-07T05:06:51.000Z"]},{field:"host.name",value:["zeek-franfurt"]},{field:"source.ip",value:["192.168.26.101"]},{field:"destination.ip",value:["192.168.238.205"]}],ecs:{_id:"14",timestamp:"2019-03-07T05:06:51.000Z",event:{module:["zeek"],dataset:["zeek.connection"]},host:{id:["37c81253e0fc4c46839c19b981be5177"],name:["zeek-franfurt"],ip:["207.154.238.205","10.19.0.5","fe80::d82b:9aff:fe0d:1e12"]},source:{ip:["185.176.26.101"],port:[44059]},destination:{ip:["207.154.238.205"],port:[11568]},geo:{region_name:["New York"],country_iso_code:["US"]},network:{transport:["tcp"]},zeek:{session_id:["C8DRTq362Fios6hw16"],connection:{local_resp:[!1],local_orig:[!1],missed_bytes:[0],state:["REJ"],history:["Sr"]}}}},{_id:"15",data:[{field:"@timestamp",value:["2019-03-07T00:51:28.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]},{field:"source.ip",value:["192.168.35.240"]},{field:"destination.ip",value:["192.168.67.3"]}],ecs:{_id:"15",timestamp:"2019-03-07T00:51:28.000Z",event:{module:["zeek"],dataset:["zeek.dns"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},source:{ip:["206.189.35.240"],port:[57475]},destination:{ip:["67.207.67.3"],port:[53]},geo:{region_name:["New York"],country_iso_code:["US"]},network:{transport:["udp"]},zeek:{session_id:["CyIrMA1L1JtLqdIuol"],dns:{AA:[!1],RD:[!1],trans_id:[65252],RA:[!1],TC:[!1]}}}},{_id:"16",data:[{field:"@timestamp",value:["2019-03-05T07:00:20.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]},{field:"source.ip",value:["192.168.35.240"]},{field:"destination.ip",value:["192.168.164.26"]}],ecs:{_id:"16",timestamp:"2019-03-05T07:00:20.000Z",event:{module:["zeek"],dataset:["zeek.http"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},source:{ip:["206.189.35.240"],port:[36220]},destination:{ip:["192.241.164.26"],port:[80]},geo:{region_name:["New York"],country_iso_code:["US"]},http:{version:["1.1"],request:{body:{bytes:[0]}},response:{status_code:[302],body:{bytes:[154]}}},zeek:{session_id:["CZLkpC22NquQJOpkwe"],http:{resp_mime_types:["text/html"],trans_depth:["3"],status_msg:["Moved Temporarily"],resp_fuids:["FzeujEPP7GTHmYPsc"],tags:[]}}}},{_id:"17",data:[{field:"@timestamp",value:["2019-02-28T22:36:28.000Z"]},{field:"host.name",value:["zeek-franfurt"]},{field:"source.ip",value:["192.168.77.171"]}],ecs:{_id:"17",timestamp:"2019-02-28T22:36:28.000Z",event:{module:["zeek"],dataset:["zeek.notice"]},host:{id:["37c81253e0fc4c46839c19b981be5177"],name:["zeek-franfurt"],ip:["207.154.238.205","10.19.0.5","fe80::d82b:9aff:fe0d:1e12"]},source:{ip:["8.42.77.171"]},zeek:{notice:{suppress_for:[3600],msg:["8.42.77.171 scanned at least 15 unique ports of host 207.154.238.205 in 0m0s"],note:["Scan::Port_Scan"],sub:["remote"],dst:["207.154.238.205"],dropped:[!1],peer_descr:["bro"]}}}},{_id:"18",data:[{field:"@timestamp",value:["2019-02-22T21:12:13.000Z"]},{field:"host.name",value:["zeek-sensor-amsterdam"]},{field:"source.ip",value:["192.168.66.184"]},{field:"destination.ip",value:["192.168.95.15"]}],ecs:{_id:"18",timestamp:"2019-02-22T21:12:13.000Z",event:{module:["zeek"],dataset:["zeek.ssl"]},host:{id:["2ce8b1e7d69e4a1d9c6bcddc473da9d9"],name:["zeek-sensor-amsterdam"]},source:{ip:["188.166.66.184"],port:[34514]},destination:{ip:["91.189.95.15"],port:[443]},geo:{region_name:["England"],country_iso_code:["GB"]},zeek:{session_id:["CmTxzt2OVXZLkGDaRe"],ssl:{cipher:["TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256"],established:[!1],resumed:[!1],version:["TLSv12"]}}}},{_id:"19",data:[{field:"@timestamp",value:["2019-03-03T04:26:38.000Z"]},{field:"host.name",value:["suricata-zeek-singapore"]}],ecs:{_id:"19",timestamp:"2019-03-03T04:26:38.000Z",event:{module:["zeek"],dataset:["zeek.files"]},host:{id:["af3fddf15f1d47979ce817ba0df10c6e"],name:["suricata-zeek-singapore"],ip:["206.189.35.240","10.15.0.5","fe80::98c7:eff:fe29:4455"]},zeek:{session_id:["Cu0n232QMyvNtzb75j"],files:{session_ids:["Cu0n232QMyvNtzb75j"],timedout:[!1],local_orig:[!1],tx_host:["5.101.111.50"],source:["HTTP"],is_orig:[!1],overflow_bytes:[0],sha1:["fa5195a5dfacc9d1c68d43600f0e0262cad14dde"],duration:[0],depth:[0],analyzers:["MD5","SHA1"],mime_type:["text/plain"],rx_host:["206.189.35.240"],total_bytes:[88722],fuid:["FePz1uVEVCZ3I0FQi"],seen_bytes:[1198],missing_bytes:[0],md5:["f7653f1951693021daa9e6be61226e32"]}}}},{_id:"20",data:[{field:"@timestamp",value:["2019-03-13T05:42:11.815Z"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-sanfran"]},{field:"process.args",value:["gpgconf","--list-dirs","agent-socket"]}],ecs:{_id:"20",timestamp:"2019-03-13T05:42:11.815Z",event:{action:["executed"],module:["auditd"],category:["audit-rule"]},host:{id:["f896741c3b3b44bdb8e351a4ab6d2d7c"],name:["zeek-sanfran"],ip:["134.209.63.134","10.46.0.5","fe80::a0d9:16ff:fecf:e70b"]},user:{name:["alice"]},process:{pid:[5402],name:["gpgconf"],ppid:[5401],args:["gpgconf","--list-dirs","agent-socket"],executable:["/usr/bin/gpgconf"],title:["gpgconf --list-dirs agent-socket"],working_directory:["/"]}}},{_id:"21",data:[{field:"@timestamp",value:["2019-03-14T22:30:25.527Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["zeek-london"]},{field:"source.ip",value:["192.168.77.171"]},{field:"user.name",value:["root"]}],ecs:{_id:"21",timestamp:"2019-03-14T22:30:25.527Z",event:{action:["logged-in"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["14"],data:{terminal:["/dev/pts/0"],op:["login"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["/dev/pts/0"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["8.42.77.171"]},user:{name:["root"]},process:{pid:[17471],executable:["/usr/sbin/sshd"]}}},{_id:"22",data:[{field:"@timestamp",value:["2019-03-13T03:35:21.614Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["root"]}],ecs:{_id:"22",timestamp:"2019-03-13T03:35:21.614Z",event:{action:["disposed-credentials"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["340"],data:{acct:["alice"],terminal:["ssh"],op:["PAM:setcred"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["ssh"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["root"]},process:{pid:[21202],executable:["/usr/sbin/sshd"]}}},{_id:"23",data:[{field:"@timestamp",value:["2019-03-13T03:35:21.614Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["root"]}],ecs:{_id:"23",timestamp:"2019-03-13T03:35:21.614Z",event:{action:["ended-session"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["340"],data:{acct:["alice"],terminal:["ssh"],op:["PAM:session_close"]},summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["ssh"],secondary:["8.42.77.171"],type:["user-session"]},how:["/usr/sbin/sshd"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["root"]},process:{pid:[21202],executable:["/usr/sbin/sshd"]}}},{_id:"24",data:[{field:"@timestamp",value:["2019-03-18T23:17:01.645Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["root"]}],ecs:{_id:"24",timestamp:"2019-03-18T23:17:01.645Z",event:{action:["acquired-credentials"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["unset"],data:{acct:["root"],terminal:["cron"],op:["PAM:setcred"]},summary:{actor:{primary:["unset"],secondary:["root"]},object:{primary:["cron"],type:["user-session"]},how:["/usr/sbin/cron"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},user:{name:["root"]},process:{pid:[9592],executable:["/usr/sbin/cron"]}}},{_id:"25",data:[{field:"@timestamp",value:["2019-03-19T01:17:01.336Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["siem-kibana"]},{field:"user.name",value:["root"]}],ecs:{_id:"25",timestamp:"2019-03-19T01:17:01.336Z",event:{action:["started-session"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["2908"],data:{acct:["root"],terminal:["cron"],op:["PAM:session_open"]},summary:{actor:{primary:["root"],secondary:["root"]},object:{primary:["cron"],type:["user-session"]},how:["/usr/sbin/cron"]}},host:{id:["aa7ca589f1b8220002f2fc61c64cfbf1"],name:["siem-kibana"]},user:{name:["root"]},process:{pid:[725],executable:["/usr/sbin/cron"]}}},{_id:"26",data:[{field:"@timestamp",value:["2019-03-13T03:34:08.890Z"]},{field:"event.category",value:["user-login"]},{field:"host.name",value:["suricata-bangalore"]},{field:"user.name",value:["alice"]}],ecs:{_id:"26",timestamp:"2019-03-13T03:34:08.890Z",event:{action:["was-authorized"],module:["auditd"],category:["user-login"]},auditd:{result:["success"],session:["338"],data:{terminal:["/dev/pts/0"]},summary:{actor:{primary:["root"],secondary:["alice"]},object:{primary:["/dev/pts/0"],type:["user-session"]},how:["/sbin/pam_tally2"]}},host:{id:["0a63559c1acf4c419d979c4b4d8b83ff"],name:["suricata-bangalore"],ip:["139.59.11.147","10.47.0.5","fe80::ec0b:1bff:fe29:80bd"]},user:{name:["alice"]},process:{pid:[21170],executable:["/sbin/pam_tally2"]}}},{_id:"27",data:[{field:"@timestamp",value:["2019-03-22T19:13:11.026Z"]},{field:"event.action",value:["connected-to"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-london"]},{field:"destination.ip",value:["192.168.216.34"]},{field:"user.name",value:["alice"]}],ecs:{_id:"27",timestamp:"2019-03-22T19:13:11.026Z",event:{action:["connected-to"],module:["auditd"],category:["audit-rule"]},auditd:{result:["success"],session:["246"],summary:{actor:{primary:["alice"],secondary:["alice"]},object:{primary:["192.168.216.34"],secondary:["80"],type:["socket"]},how:["/usr/bin/wget"]}},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},destination:{ip:["192.168.216.34"],port:[80]},user:{name:["alice"]},process:{pid:[1490],name:["wget"],ppid:[1476],executable:["/usr/bin/wget"],title:["wget www.example.com"]}}},{_id:"28",data:[{field:"@timestamp",value:["2019-03-26T22:12:18.609Z"]},{field:"event.action",value:["opened-file"]},{field:"event.category",value:["audit-rule"]},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["root"]}],ecs:{_id:"28",timestamp:"2019-03-26T22:12:18.609Z",event:{action:["opened-file"],module:["auditd"],category:["audit-rule"]},auditd:{result:["success"],session:["242"],summary:{actor:{primary:["unset"],secondary:["root"]},object:{primary:["/proc/15990/attr/current"],type:["file"]},how:["/lib/systemd/systemd-journald"]}},file:{path:["/proc/15990/attr/current"],device:["00:00"],inode:["27672309"],uid:["0"],owner:["root"],gid:["0"],group:["root"],mode:["0666"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},user:{name:["root"]},process:{pid:[27244],name:["systemd-journal"],ppid:[1],executable:["/lib/systemd/systemd-journald"],title:["/lib/systemd/systemd-journald"],working_directory:["/"]}}},{_id:"29",data:[{field:"@timestamp",value:["2019-04-08T21:18:57.000Z"]},{field:"event.action",value:["user_login"]},{field:"event.category",value:null},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["Braden"]}],ecs:{_id:"29",event:{action:["user_login"],dataset:["login"],kind:["event"],module:["system"],outcome:["failure"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["128.199.212.120"]},user:{name:["Braden"]},process:{pid:[6278]}}},{_id:"30",data:[{field:"@timestamp",value:["2019-04-08T22:27:14.814Z"]},{field:"event.action",value:["process_started"]},{field:"event.category",value:null},{field:"host.name",value:["zeek-london"]},{field:"user.name",value:["Evan"]}],ecs:{_id:"30",event:{action:["process_started"],dataset:["login"],kind:["event"],module:["system"],outcome:["failure"]},host:{id:["7c21f5ed03b04d0299569d221fe18bbc"],name:["zeek-london"],ip:["46.101.3.136","10.16.0.5","fe80::4066:42ff:fe19:b3b9"]},source:{ip:["128.199.212.120"]},user:{name:["Evan"]},process:{pid:[6278]}}},{_id:"31",data:[{field:"@timestamp",value:["2018-11-05T19:03:25.937Z"]},{field:"message",value:["I am a log file message"]},{field:"event.severity",value:["3"]},{field:"event.category",value:["Access"]},{field:"event.action",value:["Action"]},{field:"host.name",value:["apache"]},{field:"source.ip",value:["192.168.0.1"]},{field:"destination.ip",value:["192.168.0.3"]},{field:"destination.bytes",value:["123456"]},{field:"user.name",value:["john.dee"]}],ecs:{_id:"1",timestamp:"2018-11-05T19:03:25.937Z",host:{name:["apache"],ip:["192.168.0.1"]},event:{id:["1"],action:["Action"],category:["Access"],module:["nginx"],severity:[3]},message:["I am a log file message"],source:{ip:["192.168.0.1"],port:[80]},destination:{ip:["192.168.0.3"],port:[6343]},user:{id:["1"],name:["john.dee"]},geo:{region_name:["xx"],country_iso_code:["xx"]}}},{_id:"32",data:[],ecs:{_id:"BuBP4W0BOpWiDweSoYSg",timestamp:"2019-10-18T23:59:15.091Z",threat:{enrichments:[{indicator:{provider:["indicator_provider"],reference:["https://example.com"]},matched:{atomic:["192.168.1.1"],field:["source.ip"],type:["ip"]},feed:{name:["feed_name"]}}]}}}];var T=a(1425),_=a(1070);const N=()=>{const e=Object(T.b)({actionName:"connected-to",text:_.T});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:M[26].ecs,isDraggable:!1,scopeId:O.a}))},D=r.a.memo(N),A=()=>{const e=Object(T.c)({actionName:"opened-file",text:`${_.Db} ${_.kc}`});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:M[27].ecs,isDraggable:!1,scopeId:O.a}))},q=r.a.memo(A),F={file:{path:["C:\\Windows\\System32\\bcrypt.dll"],hash:{md5:["00439016776de367bad087d739a03797"],sha1:["2c4ba5c1482987d50a182bad915f52cd6611ee63"],sha256:["e70f5d8f87aab14e3160227d38387889befbe37fa4f8f5adc59eff52804b35fd"]},name:["bcrypt.dll"]},host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1697)"],name:["Windows"],version:["1809 (10.0.17763.1697)"],family:["windows"],kernel:["1809 (10.0.17763.1697)"],platform:["windows"]},mac:["aa:bb:cc:dd:ee:ff"],name:["win2019-endpoint-1"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"]},event:{category:["library"],kind:["event"],created:["2021-02-05T21:27:23.921Z"],module:["endpoint"],action:["load"],type:["start"],id:["LzzWB9jjGmCwGMvk++++Da5H"],dataset:["endpoint.events.library"]},process:{name:["sshd.exe"],pid:[9644],entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTk2NDQtMTMyNTcwMzQwNDEuNzgyMTczODAw"],executable:["C:\\Program Files\\OpenSSH-Win64\\sshd.exe"]},agent:{type:["endpoint"]},user:{name:["SYSTEM"],domain:["NT AUTHORITY"]},message:["Endpoint DLL load event"],timestamp:"2021-02-05T21:27:23.921Z",_id:"IAUYdHcBGrBB52F2zo8Q"},L=()=>{const e=Object(j.d)({actionName:"load",text:S.q});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:F,isDraggable:!1,scopeId:O.a}))},R=r.a.memo(L);var P=a(1439),z=a(1501);const B=()=>r.a.createElement(r.a.Fragment,null,z.a.renderRow({data:{destination:{bytes:[40],geo:{city_name:["New York"],continent_name:["North America"],country_iso_code:["US"],country_name:["United States"],region_name:["New York"]},ip:["10.1.2.3"],packets:[1],port:[80]},event:{action:["network_flow"],category:["network_traffic"],duration:[P.a],end:["2018-11-12T19:03:25.936Z"],start:["2018-11-12T19:03:25.836Z"]},_id:"abcd",network:{bytes:[100],community_id:["we.live.in.a"],direction:["outgoing"],packets:[3],protocol:["http"],transport:["tcp"]},process:{name:["rat"]},source:{bytes:[60],geo:{city_name:["Atlanta"],continent_name:["North America"],country_iso_code:["US"],country_name:["United States"],region_name:["Georgia"]},ip:["192.168.1.2"],packets:[2],port:[9987]},timestamp:"2018-11-12T19:03:25.936Z",tls:{client_certificate:{fingerprint:{sha1:["tls.client_certificate.fingerprint.sha1-value"]}},fingerprints:{ja3:{hash:["tls.fingerprints.ja3.hash-value"]}},server_certificate:{fingerprint:{sha1:["tls.server_certificate.fingerprint.sha1-value"]}}},user:{name:["first.last"]}},isDraggable:!1,scopeId:O.a})),G=r.a.memo(B),$={host:{os:{full:["Windows Server 2019 Datacenter 1809 (10.0.17763.1697)"],name:["Windows"],version:["1809 (10.0.17763.1697)"],family:["windows"],kernel:["1809 (10.0.17763.1697)"],platform:["windows"]},mac:["aa:bb:cc:dd:ee:ff"],name:["win2019-endpoint-1"],architecture:["x86_64"],ip:["10.1.2.3"],id:["d8ad572e-d224-4044-a57d-f5a84c0dfe5d"]},event:{category:["registry"],kind:["event"],created:["2021-02-04T13:44:31.559Z"],module:["endpoint"],action:["modification"],type:["change"],id:["LzzWB9jjGmCwGMvk++++CbOn"],dataset:["endpoint.events.registry"]},process:{name:["GoogleUpdate.exe"],pid:[7408],entity_id:["MWQxNWNmOWUtM2RjNy01Yjk3LWY1ODYtNzQzZjdjMjUxOGIyLTc0MDgtMTMyNTY5MTk4NDguODY4NTI0ODAw"],executable:["C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe"]},registry:{hive:["HKLM"],key:["SOFTWARE\\WOW6432Node\\Google\\Update\\ClientState\\{430FD4D0-B729-4F61-AA34-91526481799D}\\CurrentState"],path:["HKLM\\SOFTWARE\\WOW6432Node\\Google\\Update\\ClientState\\{430FD4D0-B729-4F61-AA34-91526481799D}\\CurrentState\\StateValue"],value:["StateValue"]},agent:{type:["endpoint"]},user:{name:["SYSTEM"],domain:["NT AUTHORITY"]},message:["Endpoint registry event"],timestamp:"2021-02-04T13:44:31.559Z",_id:"4cxLbXcBGrBB52F2uOfF"},H=()=>{const e=Object(j.e)({actionName:"modification",text:S.u});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:$,isDraggable:!1,scopeId:O.a}))},V=r.a.memo(H);var U=a(1525);const W=()=>r.a.createElement(r.a.Fragment,null,U.a.renderRow({data:M[2].ecs,isDraggable:!1,scopeId:O.a})),Y=r.a.memo(W),Z={_id:"2MjPcG0BOpWiDweSoutC",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["termination_event"],category:["process"],kind:["event"]},timestamp:"1569555712000",process:{hash:{md5:["bd4401441a21bf1abce6404f4231db4d"],sha1:["797255e72d5ed5c058d4785950eba7abaa057653"],sha256:["87976f3430cc99bc939e0694247c0759961a49832b87218f4313d6fc0bc3a776"]},pid:[442384],ppid:[8],name:["RuntimeBroker.exe"],executable:["C:\\Windows\\System32\\RuntimeBroker.exe"]},endgame:{pid:[442384],process_name:["RuntimeBroker.exe"],exit_code:[0]}},K=()=>{const e=Object(j.h)({actionName:"termination_event",text:S.H});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:Z,isDraggable:!1,scopeId:O.a}))},Q=r.a.memo(K),X={_id:"S8jPcG0BOpWiDweSou3g",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["request_event"],category:["network"],kind:["event"]},message:["DNS query is completed for the name %1, type %2, query options %3 with status %4 Results %5 "],timestamp:"1569555712000",dns:{question:{name:["update.googleapis.com"],type:["A"]},resolved_ip:["10.100.197.67"]},network:{protocol:["dns"]},process:{pid:[443192],name:["GoogleUpdate.exe"],executable:["C:\\Program Files (x86)\\Google\\Update\\GoogleUpdate.exe"]},winlog:{event_id:[3008]},endgame:{process_name:["GoogleUpdate.exe"],pid:[443192]}},J=()=>{const e=Object(j.a)();return r.a.createElement(r.a.Fragment,null,e.renderRow({data:X,isDraggable:!1,scopeId:O.a}))},ee=r.a.memo(J),te={_id:"BcjPcG0BOpWiDweSou3g",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["creation_event"],category:["process"],type:["process_start"],kind:["event"]},timestamp:"1569555712000",process:{hash:{md5:["62d06d7235b37895b68de56687895743"],sha1:["12563599116157778a22600d2a163d8112aed845"],sha256:["d4c97ed46046893141652e2ec0056a698f6445109949d7fcabbce331146889ee"]},pid:[441684],ppid:[8],name:["Microsoft.Photos.exe"],executable:["C:\\Program Files\\WindowsApps\\Microsoft.Windows.Photos_2018.18091.17210.0_x64__8wekyb3d8bbwe\\Microsoft.Photos.exe"],args:["C:\\Program Files\\WindowsApps\\Microsoft.Windows.Photos_2018.18091.17210.0_x64__8wekyb3d8bbwe\\Microsoft.Photos.exe","-ServerName:App.AppXzst44mncqdg84v7sv6p7yznqwssy6f7f.mca"]},endgame:{process_name:["Microsoft.Photos.exe"],pid:[441684],parent_process_name:["svchost.exe"]}},ae=()=>{const e=Object(j.b)({actionName:"creation_event",text:S.A});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:te,isDraggable:!1,scopeId:O.a}))},ne=r.a.memo(ae),re={_id:"98jPcG0BOpWiDweSouzg",user:{id:["S-1-5-21-3573271228-3407584681-1597858646-1002"],domain:["Anvi-Acer"],name:["Arun"]},host:{os:{platform:["windows"],name:["Windows"],version:["6.1"]},ip:["10.178.85.222"],name:["HD-obe-8bf77f54"]},event:{module:["endgame"],dataset:["esensor"],action:["file_create_event"],category:["file"],kind:["event"]},timestamp:"1569555712000",endgame:{process_name:["chrome.exe"],pid:[11620],file_path:["C:\\Users\\Arun\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\63d78c21-e593-4484-b7a9-db33cd522ddc.tmp"]}},ie={_id:"OMjPcG0BOpWiDweSeuW9",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.134.159.150"],name:["HD-v1s-d2118419"]},event:{module:["endgame"],dataset:["esensor"],action:["file_delete_event"],category:["file"],kind:["event"]},timestamp:"1569555704000",endgame:{pid:[1084],file_name:["tmp000002f6"],file_path:["C:\\Windows\\TEMP\\tmp00000404\\tmp000002f6"],process_name:["AmSvc.exe"]}},oe=()=>{const e=Object(j.g)({actionName:"file_delete_event",text:S.f});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:ie,isDraggable:!1,scopeId:O.a}))},se=r.a.memo(oe),le=()=>{const e=Object(j.f)({actionName:"file_create_event",text:S.e});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:re,isDraggable:!1,scopeId:O.a}))},ce=r.a.memo(le),ue={_id:"QsjPcG0BOpWiDweSeuRE",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.134.159.150"],name:["HD-v1s-d2118419"]},event:{module:["endgame"],dataset:["esensor"],action:["user_logon"],category:["authentication"],type:["authentication_success"],kind:["event"]},message:["An account was successfully logged on.\r\n\r\nSubject:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tWIN-Q3DOP1UKA81$\r\n\tAccount Domain:\t\tWORKGROUP\r\n\tLogon ID:\t\t0x3e7\r\n\r\nLogon Type:\t\t\t5\r\n\r\nNew Logon:\r\n\tSecurity ID:\t\tS-1-5-18\r\n\tAccount Name:\t\tSYSTEM\r\n\tAccount Domain:\t\tNT AUTHORITY\r\n\tLogon ID:\t\t0x3e7\r\n\tLogon GUID:\t\t{00000000-0000-0000-0000-000000000000}\r\n\r\nProcess Information:\r\n\tProcess ID:\t\t0x1b0\r\n\tProcess Name:\t\tC:\\Windows\\System32\\services.exe\r\n\r\nNetwork Information:\r\n\tWorkstation Name:\t\r\n\tSource Network Address:\t-\r\n\tSource Port:\t\t-\r\n\r\nDetailed Authentication Information:\r\n\tLogon Process:\t\tAdvapi  \r\n\tAuthentication Package:\tNegotiate\r\n\tTransited Services:\t-\r\n\tPackage Name (NTLM only):\t-\r\n\tKey Length:\t\t0\r\n\r\nThis event is generated when a logon session is created. It is generated on the computer that was accessed.\r\n\r\nThe subject fields indicate the account on the local system which requested the logon. This is most commonly a service such as the Server service, or a local process such as Winlogon.exe or Services.exe.\r\n\r\nThe logon type field indicates the kind of logon that occurred. The most common types are 2 (interactive) and 3 (network).\r\n\r\nThe New Logon fields indicate the account for whom the new logon was created, i.e. the account that was logged on.\r\n\r\nThe network fields indicate where a remote logon request originated. Workstation name is not always available and may be left blank in some cases.\r\n\r\nThe authentication information fields provide detailed information about this specific logon request.\r\n\t- Logon GUID is a unique identifier that can be used to correlate this event with a KDC event.\r\n\t- Transited services indicate which intermediate services have participated in this logon request.\r\n\t- Package name indicates which sub-protocol was used among the NTLM protocols.\r\n\t- Key length indicates the length of the generated session key. This will be 0 if no session key was requested."],timestamp:"1569555704000",process:{pid:[432],name:["C:\\Windows\\System32\\services.exe"],executable:["C:\\Windows\\System32\\services.exe"]},winlog:{event_id:[4624]},endgame:{target_logon_id:["0x3e7"],pid:[432],process_name:["C:\\Windows\\System32\\services.exe"],logon_type:[5],subject_user_name:["WIN-Q3DOP1UKA81$"],subject_logon_id:["0x3e7"],target_user_name:["SYSTEM"],target_domain_name:["NT AUTHORITY"]}},de=()=>{const e=Object(j.i)({actionName:"user_logon"});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:ue,isDraggable:!1,scopeId:O.a}))},pe=r.a.memo(de),me={_id:"LsjPcG0BOpWiDweSCNfu",user:{id:["S-1-5-18"],domain:["NT AUTHORITY"],name:["SYSTEM"]},host:{os:{platform:["windows"],name:["Windows"],version:["10.0"]},ip:["10.43.255.177"],name:["HD-gqf-0af7b4fe"]},event:{module:["endgame"],dataset:["esensor"],action:["ipv4_connection_accept_event"],category:["network"],kind:["event"]},timestamp:"1569555676000",network:{community_id:["1:network-community_id"],transport:["tcp"]},process:{pid:[1084],name:["AmSvc.exe"],executable:["C:\\Program Files\\Cybereason ActiveProbe\\AmSvc.exe"]},source:{ip:["127.0.0.1"],port:[49306]},destination:{port:[49305],ip:["127.0.0.1"]},endgame:{pid:[1084]}},ye=()=>{const e=Object(j.j)({actionName:"ipv4_connection_accept_event",text:S.b});return r.a.createElement(r.a.Fragment,null,e.renderRow({data:me,isDraggable:!1,scopeId:O.a}))},ge=r.a.memo(ye);var fe=a(1523);const be=()=>r.a.createElement(r.a.Fragment,null,fe.a.renderRow({data:M[31].ecs,isDraggable:!1,scopeId:O.a})),he=r.a.memo(be);var ve=a(1526);const Ee=()=>r.a.createElement(r.a.Fragment,null,ve.a.renderRow({data:M[13].ecs,isDraggable:!1,scopeId:O.a})),xe=r.a.memo(Ee);var ke=a(5);const we=ke.i18n.translate("xpack.securitySolution.eventRenderers.alertName",{defaultMessage:"Alert"}),je=ke.i18n.translate("xpack.securitySolution.eventRenderers.alertsName",{defaultMessage:"Alerts"}),Se=ke.i18n.translate("xpack.securitySolution.eventRenderers.alertsDescription",{defaultMessage:"Alerts are displayed when malware or ransomware is prevented and detected"}),Oe=ke.i18n.translate("xpack.securitySolution.eventRenderers.auditdName",{defaultMessage:"Auditd"}),Ie=ke.i18n.translate("xpack.securitySolution.eventRenderers.auditdDescriptionPart1",{defaultMessage:"audit events convey security-relevant logs from the Linux Audit Framework."}),Ce=ke.i18n.translate("xpack.securitySolution.eventRenderers.auditdFileName",{defaultMessage:"Auditd File"}),Me=ke.i18n.translate("xpack.securitySolution.eventRenderers.auditdFileDescriptionPart1",{defaultMessage:"File events show users (and system accounts) performing CRUD operations on files via specific processes."}),Te=ke.i18n.translate("xpack.securitySolution.eventRenderers.authenticationName",{defaultMessage:"Authentication"}),_e=ke.i18n.translate("xpack.securitySolution.eventRenderers.authenticationDescriptionPart1",{defaultMessage:"Authentication events show users (and system accounts) successfully or unsuccessfully logging into hosts."}),Ne=ke.i18n.translate("xpack.securitySolution.eventRenderers.authenticationDescriptionPart2",{defaultMessage:"Some authentication events may include additional details when users authenticate on behalf of other users."}),De=ke.i18n.translate("xpack.securitySolution.eventRenderers.dnsName",{defaultMessage:"Domain Name System (DNS)"}),Ae=ke.i18n.translate("xpack.securitySolution.eventRenderers.dnsDescriptionPart1",{defaultMessage:"Domain Name System (DNS) events show users (and system accounts) making requests via specific processes to translate from host names to IP addresses."}),qe=ke.i18n.translate("xpack.securitySolution.eventRenderers.fileName",{defaultMessage:"File"}),Fe=ke.i18n.translate("xpack.securitySolution.eventRenderers.fileDescriptionPart1",{defaultMessage:"File events show users (and system accounts) performing CRUD operations on files via specific processes."}),Le=ke.i18n.translate("xpack.securitySolution.eventRenderers.fimName",{defaultMessage:"File Integrity Module (FIM)"}),Re=ke.i18n.translate("xpack.securitySolution.eventRenderers.fimDescriptionPart1",{defaultMessage:"File Integrity Module (FIM) events show users (and system accounts) performing CRUD operations on files via specific processes."}),Pe=ke.i18n.translate("xpack.securitySolution.eventRenderers.flowName",{defaultMessage:"Flow"}),ze=ke.i18n.translate("xpack.securitySolution.eventRenderers.flowDescriptionPart1",{defaultMessage:"The Flow renderer visualizes the flow of data between a source and destination. It's applicable to many types of events."}),Be=ke.i18n.translate("xpack.securitySolution.eventRenderers.flowDescriptionPart2",{defaultMessage:"The hosts, ports, protocol, direction, duration, amount transferred, process, geographic location, and other details are visualized when available."}),Ge=ke.i18n.translate("xpack.securitySolution.eventRenderers.libraryName",{defaultMessage:"Library"}),$e=ke.i18n.translate("xpack.securitySolution.eventRenderers.libraryDescription",{defaultMessage:"Library events display a Dynamically Linked Library (DLL) being loaded by a process"}),He=ke.i18n.translate("xpack.securitySolution.eventRenderers.processName",{defaultMessage:"Process"}),Ve=ke.i18n.translate("xpack.securitySolution.eventRenderers.processDescriptionPart1",{defaultMessage:"Process events show users (and system accounts) starting and stopping processes."}),Ue=ke.i18n.translate("xpack.securitySolution.eventRenderers.processDescriptionPart2",{defaultMessage:"Details including the command line arguments, parent process, and if applicable, file hashes are displayed when available."}),We=ke.i18n.translate("xpack.securitySolution.eventRenderers.registryName",{defaultMessage:"Registry"}),Ye=ke.i18n.translate("xpack.securitySolution.eventRenderers.registryDescription",{defaultMessage:"Registry events show updates to the Windows Registry"}),Ze=ke.i18n.translate("xpack.securitySolution.eventRenderers.socketName",{defaultMessage:"Socket (Network)"}),Ke=ke.i18n.translate("xpack.securitySolution.eventRenderers.socketDescriptionPart1",{defaultMessage:"Socket (Network) events show processes listening, accepting, and closing connections."}),Qe=ke.i18n.translate("xpack.securitySolution.eventRenderers.socketDescriptionPart2",{defaultMessage:"Details including the protocol, ports, and a community ID for correlating all network events related to a single flow are displayed when available."}),Xe=ke.i18n.translate("xpack.securitySolution.eventRenderers.suricataName",{defaultMessage:"Suricata"}),Je=ke.i18n.translate("xpack.securitySolution.eventRenderers.suricataDescriptionPart1",{defaultMessage:"Summarizes"}),et=ke.i18n.translate("xpack.securitySolution.eventRenderers.suricataDescriptionPart2",{defaultMessage:"intrusion detection (IDS), inline intrusion prevention (IPS), and network security monitoring (NSM) events"}),tt=ke.i18n.translate("xpack.securitySolution.eventRenderers.systemName",{defaultMessage:"System"}),at=ke.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart1",{defaultMessage:"The Auditbeat"}),nt=ke.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart2",{defaultMessage:"module collects various security related information about a system."}),rt=ke.i18n.translate("xpack.securitySolution.eventRenderers.systemDescriptionPart3",{defaultMessage:"All datasets send both periodic state information (e.g. all currently running processes) and real-time changes (e.g. when a new process starts or stops)."}),it=ke.i18n.translate("xpack.securitySolution.eventRenderers.threatMatchName",{defaultMessage:"Threat Indicator Match"}),ot=ke.i18n.translate("xpack.securitySolution.eventRenderers.threatMatchDescription",{defaultMessage:"Summarizes events that matched threat indicators"}),st=ke.i18n.translate("xpack.securitySolution.eventRenderers.zeekName",{defaultMessage:"Zeek (formerly Bro)"}),lt=ke.i18n.translate("xpack.securitySolution.eventRenderers.zeekDescriptionPart1",{defaultMessage:"Summarizes events from the"}),ct=ke.i18n.translate("xpack.securitySolution.eventRenderers.zeekDescriptionPart2",{defaultMessage:"Network Security Monitoring (NSM) tool"}),ut={[v.d.alert]:we,[v.d.alerts]:je,[v.d.auditd]:Oe,[v.d.auditd_file]:Ce,[v.d.library]:Ge,[v.d.system_security_event]:Te,[v.d.system_dns]:De,[v.d.netflow]:Pe,[v.d.system]:tt,[v.d.system_endgame_process]:He,[v.d.registry]:We,[v.d.system_fim]:Le,[v.d.system_file]:qe,[v.d.system_socket]:Ze,[v.d.suricata]:"Suricata",[v.d.threat_match]:it,[v.d.zeek]:st,[v.d.plain]:""},dt=({children:e,url:t})=>r.a.createElement(i.EuiLink,{href:t,target:"_blank",rel:"noopener nofollow noreferrer","data-test-subj":"externalLink"},e),pt=[{id:v.d.alerts,name:ut[v.d.alerts],description:Se,example:C,searchableDescription:Se},{id:v.d.auditd,name:ut[v.d.auditd],description:r.a.createElement("span",null,r.a.createElement(dt,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-auditd.html"},Oe)," ",Ie),example:D,searchableDescription:`${Oe} ${Ie}`},{id:v.d.auditd_file,name:ut[v.d.auditd_file],description:r.a.createElement("span",null,r.a.createElement(dt,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-auditd.html"},Oe)," ",Me),example:q,searchableDescription:`${Ce} ${Me}`},{id:v.d.library,name:ut[v.d.library],description:$e,example:R,searchableDescription:$e},{id:v.d.system_security_event,name:ut[v.d.system_security_event],description:r.a.createElement("div",null,r.a.createElement("p",null,_e),r.a.createElement("br",null),r.a.createElement("p",null,Ne)),example:pe,searchableDescription:`${_e} ${Ne}`},{id:v.d.system_dns,name:ut[v.d.system_dns],description:Ae,example:ee,searchableDescription:Ae},{id:v.d.netflow,name:ut[v.d.netflow],description:r.a.createElement("div",null,r.a.createElement("p",null,ze),r.a.createElement("br",null),r.a.createElement("p",null,Be)),example:G,searchableDescription:`${ze} ${Be}`},{id:v.d.system,name:ut[v.d.system],description:r.a.createElement("div",null,r.a.createElement("p",null,at," ",r.a.createElement(dt,{url:"https://www.elastic.co/guide/en/beats/auditbeat/current/auditbeat-module-system.html"},tt)," ",nt),r.a.createElement("br",null),r.a.createElement("p",null,rt)),example:Q,searchableDescription:`${at} ${tt} ${nt} ${rt}`},{id:v.d.system_endgame_process,name:ut[v.d.system_endgame_process],description:r.a.createElement("div",null,r.a.createElement("p",null,Ve),r.a.createElement("br",null),r.a.createElement("p",null,Ue)),example:ne,searchableDescription:`${Ve} ${Ue}`},{id:v.d.registry,name:ut[v.d.registry],description:Ye,example:V,searchableDescription:Ye},{id:v.d.system_fim,name:ut[v.d.system_fim],description:Re,example:ce,searchableDescription:Re},{id:v.d.system_file,name:ut[v.d.system_file],description:Fe,example:se,searchableDescription:Fe},{id:v.d.system_socket,name:ut[v.d.system_socket],description:r.a.createElement("div",null,r.a.createElement("p",null,Ke),r.a.createElement("br",null),r.a.createElement("p",null,Qe)),example:ge,searchableDescription:`${Ke} ${Qe}`},{id:v.d.suricata,name:ut[v.d.suricata],description:r.a.createElement("p",null,Je," ",r.a.createElement(dt,{url:"https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-suricata.html"},Xe)," ",et),example:Y,searchableDescription:`${Je} ${Xe} ${et}`},{id:v.d.threat_match,name:ut[v.d.threat_match],description:ot,example:he,searchableDescription:`${it} ${ot}`},{id:v.d.zeek,name:ut[v.d.zeek],description:r.a.createElement("p",null,lt," ",r.a.createElement(dt,{url:"https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-zeek.html"},st)," ",ct),example:xe,searchableDescription:`${lt} ${st} ${ct}`}],mt=l()(i.EuiInMemoryTable).withConfig({displayName:"StyledEuiInMemoryTable",componentId:"sc-ietqpj-0"})([".euiTable{tr > *:last-child{display:none;}.euiTableHeaderCellCheckbox > .euiTableCellContent{display:none;}}"]),yt=l()(i.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-ietqpj-1"})(["overflow:auto;> div{padding:0;> div{margin:0;}}"]),gt=e=>{if(e)return r.a.createElement(yt,{grow:1},r.a.createElement(e,null))},ft={box:{incremental:!0,schema:!0}},bt=()=>r.a.createElement(r.a.Fragment,null),ht={sort:{field:"name",direction:"asc"}},vt=l.a.button.withConfig({displayName:"StyledNameButton",componentId:"sc-ietqpj-2"})(["text-align:left;"]),Et=({excludedRowRendererIds:e=[],setExcludedRowRendererIds:t})=>{const a=Object(n.useCallback)((a=>()=>{const n=Object(k.xor)([a.id],e);t(n)}),[e,t]),o=Object(n.useCallback)(((e,t)=>r.a.createElement(vt,{className:"kbn-resetFocusState",onClick:a(t)},e)),[a]),s=Object(n.useCallback)(((t,n)=>r.a.createElement(i.EuiCheckbox,{id:n.id,onChange:a(n),checked:!e.includes(n.id)})),[e,a]),l=Object(n.useMemo)((()=>[{field:"id",name:"",sortable:!1,width:"32px",render:s},{field:"name",name:"Name",sortable:!0,width:"10%",render:o},{field:"description",name:"Description",width:"25%",render:e=>e},{field:"example",name:"Example",width:"65%",render:gt},{field:"searchableDescription",name:"Searchable Description",sortable:!1,width:"0px",render:bt}]),[s,o]);return r.a.createElement(mt,{items:pt,itemId:"id",columns:l,search:ft,sorting:ht,isSelectable:!0})};Et.displayName="RowRenderersBrowserComponent";const xt=r.a.memo(Et);xt.displayName="RowRenderersBrowser";const kt=ke.i18n.translate("xpack.securitySolution.customizeEventRenderers.eventRenderersTitle",{defaultMessage:"Event Renderers"}),wt=ke.i18n.translate("xpack.securitySolution.customizeEventRenderers.customizeEventRenderersTitle",{defaultMessage:"Customize Event Renderers"}),jt=ke.i18n.translate("xpack.securitySolution.customizeEventRenderers.customizeEventRenderersDescription",{defaultMessage:"Event Renderers automatically convey the most relevant details in an event to reveal its story"}),St=ke.i18n.translate("xpack.securitySolution.customizeEventRenderers.enableAllRenderersButtonLabel",{defaultMessage:"Enable all"}),Ot=ke.i18n.translate("xpack.securitySolution.customizeEventRenderers.disableAllRenderersButtonLabel",{defaultMessage:"Disable all"}),It=l()(i.EuiModal).withConfig({displayName:"StyledEuiModal",componentId:"sc-m3n5c2-0"})([""," max-width:95vw;min-height:90vh;> .euiModal__flex{max-height:90vh;}"],(({theme:e})=>`margin-top: ${e.eui.euiSizeXXL};`)),Ct=l()(i.EuiModalBody).withConfig({displayName:"StyledEuiModalBody",componentId:"sc-m3n5c2-1"})([".euiModalBody__overflow{display:flex;align-items:stretch;overflow:hidden;> div{display:flex;flex-direction:column;flex:1;> div:first-child{flex:0;}.euiBasicTable{flex:1;overflow:auto;}}}"]),Mt=({timelineId:e})=>{const t=Object(o.useDispatch)(),a=Object(n.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),s=Object(y.a)((t=>{var n;return(null!==(n=a(t,e))&&void 0!==n?n:x.b).excludedRowRendererIds})),[l,c]=Object(n.useState)(!1),u=Object(n.useCallback)((a=>t(Object(E.setExcludedRowRendererIds)({id:e,excludedRowRendererIds:a}))),[t,e]),d=Object(n.useCallback)((()=>c(!l)),[l]),p=Object(n.useCallback)((()=>c(!1)),[]),g=Object(n.useCallback)((()=>{u(Object.values(v.d))}),[u]),f=Object(n.useCallback)((()=>{u([])}),[u]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiToolTip,{content:wt},r.a.createElement(i.EuiButtonIcon,{"aria-label":wt,"data-test-subj":"show-row-renderers-gear",iconType:"gear",onClick:d},kt)),l&&r.a.createElement(It,{onClose:p,"data-test-subj":"row-renderers-modal"},r.a.createElement(i.EuiModalHeader,null,r.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",direction:"row",gutterSize:"none"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiModalHeaderTitle,null,wt),r.a.createElement(i.EuiText,{size:"s"},jt)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiFlexGroup,null,r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{size:"s","data-test-subj":"disable-all",onClick:g},Ot)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{fill:!0,size:"s","data-test-subj":"enable-all",onClick:f},St)))))),r.a.createElement(Ct,null,r.a.createElement(xt,{excludedRowRendererIds:s,setExcludedRowRendererIds:u}))))},Tt=r.a.memo(Mt);var _t=a(562),Nt=a(1471);const Dt=ke.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.pinSelected",{defaultMessage:"Pin selected"}),At=ke.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectAll",{defaultMessage:"All"}),qt=ke.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectNone",{defaultMessage:"None"}),Ft=ke.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectPinned",{defaultMessage:"Pinned"}),Lt=ke.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.selectUnpinned",{defaultMessage:"Unpinned"}),Rt=ke.i18n.translate("xpack.securitySolution.timeline.eventsSelect.actions.unpinSelected",{defaultMessage:"Unpin selected"}),Pt=l.a.div.withConfig({displayName:"InputDisplay",componentId:"sc-oi2e53-0"})(["width:5px;"]);Pt.displayName="InputDisplay";const zt=l.a.div.withConfig({displayName:"PinIconContainer",componentId:"sc-oi2e53-1"})(["margin-right:5px;"]);zt.displayName="PinIconContainer";const Bt=l.a.div.withConfig({displayName:"PinActionItem",componentId:"sc-oi2e53-2"})(["display:flex;flex-direction:row;"]);Bt.displayName="PinActionItem";const Gt=r.a.memo((({text:e})=>r.a.createElement(i.EuiText,{size:"s",color:"subdued"},e)));Gt.displayName="DropdownDisplay";const $t=Object(s.createGlobalStyle)([".eventsSelectItem{width:100% !important;.euiContextMenu__icon{display:none !important;}}.eventsSelectDropdown{width:","px;}"],60),Ht=l.a.div.withConfig({displayName:"CheckboxContainer",componentId:"sc-1giocnz-0"})(["position:relative;"]);Ht.displayName="CheckboxContainer";const Vt=l.a.div.withConfig({displayName:"PositionedCheckbox",componentId:"sc-1giocnz-1"})(["left:7px;position:absolute;top:-28px;"]);Vt.displayName="PositionedCheckbox";const Ut=r.a.memo((({checkState:e,timelineId:t})=>r.a.createElement("div",{"data-test-subj":"events-select"},r.a.createElement(i.EuiSuperSelect,{className:"eventsSelectDropdown","data-test-subj":"events-select-dropdown",itemClassName:"eventsSelectItem",onChange:k.noop,options:[{inputDisplay:r.a.createElement(Pt,null),disabled:!0,dropdownDisplay:r.a.createElement(Gt,{text:At}),value:"select-all"},{inputDisplay:r.a.createElement(Pt,null),disabled:!0,dropdownDisplay:r.a.createElement(Gt,{text:qt}),value:"select-none"},{inputDisplay:r.a.createElement(Pt,null),disabled:!0,dropdownDisplay:r.a.createElement(Gt,{text:Ft}),value:"select-pinned"},{inputDisplay:r.a.createElement(Pt,null),disabled:!0,dropdownDisplay:r.a.createElement(Gt,{text:Lt}),value:"select-unpinned"},{inputDisplay:r.a.createElement(Pt,null),disabled:!0,dropdownDisplay:r.a.createElement(Bt,null,r.a.createElement(zt,null,r.a.createElement(Nt.a,{allowUnpinning:!0,isAlert:!1,pinned:!0})),r.a.createElement(Gt,{text:Dt})),value:"pin-selected"},{inputDisplay:r.a.createElement(Pt,null),disabled:!0,dropdownDisplay:r.a.createElement(Bt,null,r.a.createElement(zt,null,r.a.createElement(Nt.a,{allowUnpinning:!0,isAlert:!1,pinned:!1})),r.a.createElement(Gt,{text:Rt})),value:"unpin-selected"}]}),r.a.createElement(Ht,{"data-test-subj":"timeline-events-select-checkbox-container"},r.a.createElement(Vt,{"data-test-subj":"timeline-events-select-positioned-checkbox"},r.a.createElement(i.EuiCheckbox,{checked:"checked"===e,"data-test-subj":"events-select-checkbox",disabled:!0,id:`timeline-${t}-events-select`,indeterminate:"indeterminate"===e,onChange:k.noop}))),r.a.createElement($t,null))));Ut.displayName="EventsSelect";var Wt=a(1368);const Yt=l.a.div.withConfig({displayName:"SortingColumnsContainer",componentId:"sc-1ls1217-0"})(["button{color:",";}.euiPopover .euiButtonEmpty{padding:0;.euiButtonEmpty__text{display:none;}}"],(({theme:e})=>e.eui.euiColorPrimary)),Zt=l.a.div.withConfig({displayName:"FieldBrowserContainer",componentId:"sc-1ls1217-1"})([".euiToolTipAnchor{.euiButtonContent{padding:",";}button{color:",";}.euiButtonContent__icon{width:16px;height:16px;}.euiButtonEmpty__text{display:none;}}"],(({theme:e})=>`0 ${e.eui.euiSizeXS}`),(({theme:e})=>e.eui.euiColorPrimary)),Kt=l.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-1ls1217-2"})(["align-items:center;display:flex;"]),Qt=({width:e,browserFields:t,columnHeaders:a,isEventViewer:s=!1,isSelectAllChecked:l,onSelectAll:v,showEventsSelect:E,showSelectAllCheckbox:x,sort:k,tabType:w,timelineId:j,fieldBrowserOptions:S})=>{const{triggersActionsUi:O}=Object(f.i)().services,{globalFullScreen:I,setGlobalFullScreen:C}=Object(g.a)(),{timelineFullScreen:M,setTimelineFullScreen:T}=Object(g.c)(),_=Object(o.useDispatch)(),N=Object(n.useMemo)((()=>m.b.getTimelineByIdSelector()),[]),{defaultColumns:D}=Object(y.a)((e=>N(e,j))),A=Object(n.useCallback)((()=>{j===c.f.active?T(!M):C(!I)}),[j,T,M,C,I]),q=Object(n.useMemo)((()=>Object(u.b)({globalFullScreen:I,isActiveTimelines:Object(d.isActiveTimeline)(j),timelineFullScreen:M})),[I,M,j]),F=Object(n.useCallback)((e=>{v({isSelected:e.currentTarget.checked})}),[v]),L=Object(n.useCallback)((e=>_(m.a.updateSort({id:j,sort:e.map((({id:e,direction:t})=>{var n,r;const i=a.find((t=>t.id===e)),o=null!==(n=null==i?void 0:i.type)&&void 0!==n?n:"",s=null!==(r=null==i?void 0:i.esTypes)&&void 0!==r?r:[];return{columnId:e,columnType:o,esTypes:s,sortDirection:t}}))}))),[a,_,j]),R=Object(n.useMemo)((()=>{var e;return{onSort:L,columns:null!==(e=null==k?void 0:k.map((({columnId:e,sortDirection:t})=>({id:e,direction:t}))))&&void 0!==e?e:[]}}),[L,k]),P=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.reduce(((e,t)=>{var a;return{...e,[t.id]:null!==(a=t.displayAsText)&&void 0!==a?a:t.id}}),{}))&&void 0!==e?e:{}}),[a]),z=Object(n.useMemo)((()=>{var e;return null!==(e=null==a?void 0:a.map((({aggregatable:e,displayAsText:t,id:a,type:n})=>({id:a,isSortable:e,displayAsText:t,schema:n}))))&&void 0!==e?e:[]}),[a]),B=Object(n.useCallback)((()=>{_(m.a.updateColumns({id:j,columns:D}))}),[D,_,j]),G=Object(n.useCallback)((e=>{a.some((({id:t})=>t===e))?_(m.a.removeColumn({columnId:e,id:j})):_(m.a.upsertColumn({column:Object(p.a)(e,D),id:j,index:1}))}),[a,_,j,D]),$=Object(i.useDataGridColumnSorting)(z,R,{},[],P);return r.a.createElement(Kt,null,x&&r.a.createElement(h.o,{role:"checkbox"},r.a.createElement(h.p,{textAlign:"center",width:b.b},r.a.createElement(i.EuiCheckbox,{"data-test-subj":"select-all-events",id:"select-all-events",checked:l,onChange:F}))),r.a.createElement(h.o,{role:"button"},r.a.createElement(Zt,null,O.getFieldBrowser({browserFields:t,columnIds:a.map((({id:e})=>e)),onResetColumns:B,onToggleColumn:G,options:S}))),r.a.createElement(h.o,{role:"button"},r.a.createElement(Tt,{"data-test-subj":"row-renderers-browser",timelineId:j})),r.a.createElement(h.o,{role:"button"},r.a.createElement(h.p,{textAlign:"center",width:b.b},r.a.createElement(i.EuiToolTip,{content:q?_t.a:Wt.e},r.a.createElement(i.EuiButtonIcon,{"aria-label":Object(u.b)({globalFullScreen:I,isActiveTimelines:Object(d.isActiveTimeline)(j),timelineFullScreen:M})?_t.a:Wt.e,display:q?"fill":"empty",color:"primary","data-test-subj":Object(d.isActiveTimeline)(j)?"full-screen-active":"full-screen",iconType:"fullScreen",onClick:A})))),w!==c.g.eql&&r.a.createElement(h.o,{role:"button","data-test-subj":"timeline-sorting-fields"},r.a.createElement(h.p,{textAlign:"center",width:b.b},r.a.createElement(i.EuiToolTip,{content:Wt.l},r.a.createElement(Yt,null,$)))),E&&r.a.createElement(h.o,{role:"button"},r.a.createElement(h.p,{textAlign:"center",width:b.b},r.a.createElement(Ut,{checkState:"unchecked",timelineId:j}))))};Qt.displayName="HeaderActionsComponent";const Xt=r.a.memo(Qt)},1271:function(e,t,a){"use strict";a.d(t,"a",(function(){return Ce})),a.d(t,"b",(function(){return _e})),a.d(t,"c",(function(){return Le})),a.d(t,"e",(function(){return xe})),a.d(t,"d",(function(){return Fe})),a.d(t,"f",(function(){return Re.a}));var n=a(23),r=a.n(n),i=a(2),o=a.n(i),s=a(17),l=a(44),c=a.n(l),u=a(5);const d=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdated",{defaultMessage:"Last updated"}),p=u.i18n.translate("xpack.securitySolution.artifactCard.created",{defaultMessage:"Created"}),m=u.i18n.translate("xpack.securitySolution.artifactCard.lastUpdatedBy",{defaultMessage:"Updated by"}),y=u.i18n.translate("xpack.securitySolution.artifactCard.createdBy",{defaultMessage:"Created by"}),g=u.i18n.translate("xpack.securitySolution.artifactCard.globalEffectScope",{defaultMessage:"Applied globally"}),f=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope",{defaultMessage:"Applied to {count} {count, plural, one {policy} other {policies}}",values:{count:e}}),b=(e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.policyEffectScope.title",{defaultMessage:"Applied to the following {count, plural, one {policy} other {policies}}",values:{count:e}}),h=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator",{defaultMessage:"IS"}),v=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),E=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),x=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),k=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.nestedOperator",{defaultMessage:"has"}),w=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator",{defaultMessage:"is one of"}),j=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),S=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.existsOperator",{defaultMessage:"exists"}),O=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.listOperator",{defaultMessage:"included in"}),I=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.os",{defaultMessage:"OS"}),C=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.and",{defaultMessage:"AND"}),M=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.windows",{defaultMessage:"Windows"}),T=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.linux",{defaultMessage:"Linux"}),_=u.i18n.translate("xpack.securitySolution.artifactCard.conditions.macos",{defaultMessage:"Mac"}),N=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.expand",{defaultMessage:"Expand"}),D=u.i18n.translate("xpack.securitySolution.artifactExpandableCard.collpase",{defaultMessage:"Collapse"}),A=u.i18n.translate("xpack.securitySolution.artifactMinifiedCard.descriptionLabel",{defaultMessage:"Description"});var q=a(155),F=a(59),L=a.n(F),R=a(126);const P=Object(i.memo)((({bold:e,truncate:t,size:a="s",withTooltip:n=!1,"data-test-subj":r,children:l})=>{const c=Object(i.useMemo)((()=>L()({"eui-textTruncate":t,"eui-textBreakWord":!0})),[t]),u=Object(i.useMemo)((()=>e?o.a.createElement("strong",null,l):l),[e,l]);return o.a.createElement(s.EuiText,{className:c,size:a,"data-test-subj":r},n&&"string"==typeof l&&l.length>0&&l!==Object(R.e)()?o.a.createElement(s.EuiToolTip,{anchorClassName:c,content:l,position:"top"},o.a.createElement(o.a.Fragment,null,u)):u)}));P.displayName="TextValueDisplay";var z=a(115);const B=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1dvdnzg-0"})(["padding-top:2px;"]),G=Object(i.memo)((({date:e,type:t,"data-test-subj":a})=>{const n=Object(z.a)(a);return o.a.createElement(s.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"m","data-test-subj":a},o.a.createElement(B,{grow:!1},o.a.createElement(s.EuiIcon,{type:"calendar"})),o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(s.EuiFlexGroup,{responsive:!1,direction:"column",alignItems:"flexStart",gutterSize:"xs"},o.a.createElement(s.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":n("label")},o.a.createElement(P,null,"update"===t?d:p)),o.a.createElement(s.EuiFlexItem,{className:"eui-textTruncate","data-test-subj":n("value")},o.a.createElement(P,{bold:!0},o.a.createElement(q.b,{value:e,dateFormat:"M/D/YYYY"}))))))}));G.displayName="DateField";var $=a(51),H=a(1163);const V=Object(i.memo)((({items:e,button:t,panelPaddingSize:a,anchorPosition:n,maxWidth:l="32ch",maxHeight:c="255px",fixedWidth:u=!1,title:d,loading:p=!1,hoverInfo:m,isNavigationDisabled:y=!1,...g})=>{const f=Object(z.a)(g["data-test-subj"]),[b,h]=Object(i.useState)(!1),v=Object(i.useCallback)((()=>h(!1)),[h]),E=Object(i.useCallback)((()=>h(!b)),[b]),x=Object(i.useMemo)((()=>({"data-test-subj":f("popoverPanel")})),[f]),k=Object(i.useMemo)((()=>e.map(((e,t)=>{var a,n;return p?o.a.createElement(s.EuiSkeletonText,{lines:1,key:Object($.v4)(),"data-test-subj":null!==(n=e["data-test-subj"])&&void 0!==n?n:f(`item-loading-${t}`)}):o.a.createElement(H.a,r()({},e,{isNavigationDisabled:y,key:Object($.v4)(),"data-test-subj":null!==(a=e["data-test-subj"])&&void 0!==a?a:f(`item-${t}`),textTruncate:Boolean(l)||e.textTruncate,hoverInfo:m,onClick:t=>{if(v(),e.onClick)return e.onClick(t)}}))}))),[e,p,y,f,l,m,v]),w=Object(i.useMemo)((()=>{const e={className:"eui-yScroll",style:{}};return l&&!u&&(e.style.maxWidth=l),c&&(e.style.maxHeight=c),u&&(e.style.width=null!=l?l:"32ch"),e}),[l,u,c]);return o.a.createElement(s.EuiPopover,r()({},g,{anchorPosition:n,panelPaddingSize:a,panelProps:x,button:o.a.createElement("div",{className:"eui-displayInlineBlock","data-test-subj":f("triggerButtonWrapper"),onClick:E},t),isOpen:b,closePopover:v}),d?o.a.createElement(s.EuiPopoverTitle,{paddingSize:"m"},d):null,o.a.createElement(s.EuiContextMenuPanel,r()({},w,{items:k})))}));V.displayName="ContextMenuWithRouterSupport";const U=Object(i.memo)((({items:e,"data-test-subj":t,icon:a="boxesHorizontal"})=>{const n=Object(z.a)(t),[l,c]=Object(i.useState)(!1),d=Object(i.useCallback)((()=>c(!1)),[c]),p=Object(i.useCallback)((()=>c(!l)),[l]),m=Object(i.useMemo)((()=>({"data-test-subj":n("popoverPanel")})),[n]),y=Object(i.useMemo)((()=>e.map((e=>o.a.createElement(H.a,r()({},e,{key:Object($.v4)(),onClick:t=>{if(d(),e.onClick)return e.onClick(t)}}))))),[d,e]);return o.a.createElement(s.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",panelProps:m,"data-test-subj":t,button:o.a.createElement(s.EuiButtonIcon,{"data-test-subj":n("button"),iconType:a,onClick:p,"aria-label":u.i18n.translate("xpack.securitySolution.actionsContextMenu.label",{defaultMessage:"Open"})}),isOpen:l,closePopover:d},o.a.createElement(s.EuiContextMenuPanel,{items:y,"data-test-subj":n("contextMenuPanel")}))}));U.displayName="ActionsContextMenu";const W=Object(i.memo)((({actions:e,"data-test-subj":t})=>e&&e.length>0?o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(U,{items:e,icon:"boxesHorizontal","data-test-subj":t})):null));W.displayName="CardActionsFlexItem";const Y=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemSmallBottomMargin",componentId:"sc-1orjmip-0"})(["margin-bottom:4px !important;"]),Z=Object(i.memo)((({name:e,createdDate:t,updatedDate:a,actions:n,"data-test-subj":r})=>{const i=Object(z.a)(r);return o.a.createElement(s.EuiFlexGroup,{responsive:!1,alignItems:"flexStart","data-test-subj":r},o.a.createElement(Y,{grow:!0},o.a.createElement(s.EuiFlexGroup,{alignItems:"flexStart"},o.a.createElement(s.EuiFlexItem,{grow:!0},o.a.createElement(s.EuiTitle,{size:"s"},o.a.createElement("h3",{"data-test-subj":i("title")},e))),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"xl"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(G,{date:a,type:"update","data-test-subj":i("updated")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(G,{date:t,type:"create","data-test-subj":i("created")})))))),o.a.createElement(W,{actions:n,"data-test-subj":i("actions")}))}));Z.displayName="CardHeader";const K=c()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-1oz5dfu-0"})(["margin:6px;"]),Q=Object(i.memo)((({createdBy:e,updatedBy:t,"data-test-subj":a})=>{const n=Object(z.a)(a);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"l",responsive:!1,"data-test-subj":a},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(X,{label:y,value:e,"data-test-subj":n("createdBy")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(X,{label:m,value:t,"data-test-subj":n("updatedBy")})))}));Q.displayName="TouchedByUsers";const X=Object(i.memo)((({label:e,value:t,"data-test-subj":a})=>{const n=Object(z.a)(a);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"m",wrap:!1,responsive:!1,"data-test-subj":a},o.a.createElement(K,{grow:!1},o.a.createElement(s.EuiBadge,{"data-test-subj":n("label")},e)),o.a.createElement(K,{grow:!1},o.a.createElement(s.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center",wrap:!1},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiAvatar,{name:t,size:"s","data-test-subj":n("avatar")})),o.a.createElement(s.EuiFlexItem,{grow:!1,className:"eui-textTruncate","data-test-subj":n("value")},o.a.createElement(P,null,t)))))}));X.displayName="UserName";var J=a(47),ee=a(135);const te=c()("div").withConfig({displayName:"StyledWithContextMenuShiftedWrapper",componentId:"sc-d4sgp-0"})(["margin-left:-10px;"]),ae=c()(s.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-d4sgp-1"})(["height:10px !important;"]),ne=Object(i.memo)((({policies:e,loadingPoliciesList:t=!1,"data-test-subj":a})=>{const n=Object(z.a)(a),{canReadPolicyManagement:r}=Object(ee.a)().endpointPrivileges,[l,c]=Object(i.useMemo)((()=>e?["partial",f(e.length)]:["globe",g]),[e]),u=o.a.createElement(s.EuiFlexGroup,{responsive:!1,wrap:!1,alignItems:"center",gutterSize:"s","data-test-subj":a},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiIcon,{type:l,size:"s"})),o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":n("value")},o.a.createElement(P,{size:"xs"},c)));return e&&e.length?o.a.createElement(te,null,o.a.createElement(re,{policies:e,loadingPoliciesList:t,canReadPolicies:r,"data-test-subj":n("popupMenu")},u)):u}));ne.displayName="EffectScope";const re=Object(i.memo)((({policies:e,loadingPoliciesList:t=!1,canReadPolicies:a,children:n,"data-test-subj":r})=>{const l=Object(z.a)(r),c=Object(i.useMemo)((()=>a?o.a.createElement(ae,{flush:"right",size:"s",iconSide:"right",iconType:"popout"},o.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.contextMenuItemByRouter.viewDetails",defaultMessage:"View details"})):void 0),[a]);return o.a.createElement(V,{maxHeight:"235px",fixedWidth:!0,panelPaddingSize:"none",items:e,anchorPosition:e.length>1?"rightCenter":"rightUp","data-test-subj":r,loading:t,hoverInfo:c,button:o.a.createElement(s.EuiButtonEmpty,{size:"xs","data-test-subj":l("button")},n),title:b(e.length),isNavigationDisabled:!a})}));re.displayName="WithContextMenu";const ie=Object(i.memo)((({createdBy:e,updatedBy:t,policies:a,loadingPoliciesList:n=!1,"data-test-subj":r})=>{const i=Object(z.a)(r);return o.a.createElement(s.EuiFlexGroup,{alignItems:"center",responsive:!0,"data-test-subj":r},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(Q,{createdBy:e,updatedBy:t,"data-test-subj":i("touchedBy")})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(ne,{policies:a,loadingPoliciesList:n,"data-test-subj":i("effectScope")})))}));ie.displayName="CardSubHeader";var oe=a(139);const se=Object.freeze({linux:T,mac:_,macos:_,windows:M}),le=Object.freeze({[oe.d.NESTED]:k,[oe.d.MATCH_ANY]:w,[oe.d.MATCH]:h,[oe.d.WILDCARD]:E,[oe.d.EXISTS]:S,[oe.d.LIST]:O}),ce=Object.freeze({[oe.d.MATCH_ANY]:j,[oe.d.MATCH]:v,[oe.d.WILDCARD]:x}),ue=c()(s.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupNested",componentId:"sc-1oxtqy5-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeXL)),de=c()(s.EuiFlexItem).withConfig({displayName:"EuiFlexItemNested",componentId:"sc-1oxtqy5-1"})(["margin-bottom:6px !important;margin-top:6px !important;"]),pe=c()("span").withConfig({displayName:"StyledCondition",componentId:"sc-1oxtqy5-2"})(["margin-right:6px;"]),me=Object(i.memo)((({os:e,entries:t,"data-test-subj":a})=>{const n=Object(z.a)(a),r=Object(i.useMemo)((()=>e.map((e=>{var t;return null!==(t=se[e])&&void 0!==t?t:e})).join(", ")),[e]),l=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map((e=>o.a.createElement(s.EuiBadge,{color:"hollow"},e))):t,c=(e,t)=>{var a,n;return"nested"===e?"":"included"===t?null!==(a=le[e])&&void 0!==a?a:e:null!==(n=ce[e])&&void 0!==n?n:e},u=Object(i.useCallback)(((e,t)=>{if("nested"===e&&t.length)return t.map((({field:e,type:t,value:a,operator:r})=>o.a.createElement(ue,{"data-test-subj":n("nestedCondition"),key:e+t+a,direction:"row",alignItems:"center",gutterSize:"m",responsive:!1},o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiToken,{iconType:"tokenNested",size:"s"})),o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiExpression,{description:"",value:e,color:"subdued"})),o.a.createElement(de,{grow:!1},o.a.createElement(s.EuiExpression,{description:c(t,r),value:l(t,a)})))))}),[n]);return o.a.createElement("div",{"data-test-subj":a},o.a.createElement("div",{"data-test-subj":n("os")},o.a.createElement("strong",null,o.a.createElement(s.EuiExpression,{description:"",value:I}),o.a.createElement(s.EuiExpression,{description:h,value:r}))),t.map((({field:e,type:t,value:a,operator:r,entries:i=[]})=>o.a.createElement("div",{"data-test-subj":n("condition"),key:e+t+a},o.a.createElement("div",{className:"eui-xScroll"},o.a.createElement(s.EuiExpression,{description:o.a.createElement(pe,null,C),value:e,color:"subdued"}),o.a.createElement(s.EuiExpression,{description:c(t,r),value:l(t,a)})),u(t,i)))))}));me.displayName="CriteriaConditions";const ye=e=>"effectScope"in e;var ge=a(531);const fe=e=>(e=>{const t=e.filter((e=>e.startsWith(ge.b)));return t.some((e=>e===`${ge.b}all`))?{type:"global"}:{type:"policy",policies:t.map((e=>e.substr(ge.b.length)))}})(e.tags),be=e=>Object(i.useMemo)((()=>(e=>{var t;const a=e,{name:n,created_by:r,created_at:i,updated_at:o,updated_by:s,description:l="",entries:c}=a;return{name:n,created_by:r,created_at:i,updated_at:o,updated_by:s,description:l,comments:ye(a)?[]:a.comments,entries:c,os:ye(a)?[a.os]:null!==(t=a.os_types)&&void 0!==t?t:[],effectScope:ye(a)?a.effectScope:fe(a)}})(e)),[e]),he=c()(s.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-1qnczpg-0"})(["&.artifactEntryCard + &.artifactEntryCard{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),ve=Object(i.memo)((({className:e,...t})=>o.a.createElement(he,r()({},t,{hasBorder:!0,paddingSize:"none",className:`artifactEntryCard ${null!=e?e:""}`}))));ve.displayName="CardContainerPanel";const Ee=c()(s.EuiPanel).withConfig({displayName:"StyledEuiPanel",componentId:"sc-1aw8s5s-0"})(["padding:32px;&.top-section{padding-bottom:24px;}&.bottom-section{padding-top:24px;}&.artifact-entry-collapsible-card{padding:24px !important;}"]),xe=Object(i.memo)((e=>o.a.createElement(Ee,r()({},e,{hasBorder:!1,hasShadow:!1,paddingSize:"l"}))));xe.displayName="CardSectionPanel";var ke=a(45),we=a(1291);const je=c()(s.EuiAvatar).withConfig({displayName:"CustomEuiAvatar",componentId:"sc-3lb0zi-0"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightShade)),Se=Object(i.memo)((({comments:e,"data-test-subj":t})=>{const a=Object(z.a)(t),[n,r]=Object(i.useState)(!1),l=Object(i.useCallback)((()=>{r(!n)}),[r,n]),c=Object(i.useMemo)((()=>(e=>e.map((e=>({username:e.created_by,timestamp:o.a.createElement(q.b,{value:e.created_at,dateFormat:"MMM D, YYYY"}),event:we.b,timelineAvatar:o.a.createElement(je,{size:"s",name:e.created_by}),children:o.a.createElement(s.EuiText,{size:"s"},e.comment)}))))(e)),[e]),d=Object(i.useMemo)((()=>n?((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.hide",{defaultMessage:"Hide comments ({count})",values:{count:e}}))(e.length):((e=0)=>u.i18n.translate("xpack.securitySolution.artifactCard.comments.label.show",{defaultMessage:"Show comments ({count})",values:{count:e}}))(e.length)),[e.length,n]);return Object(ke.isEmpty)(e)?null:o.a.createElement("div",{"data-test-subj":t},o.a.createElement(s.EuiSpacer,{size:"s"}),o.a.createElement(s.EuiButtonEmpty,{onClick:l,flush:"left",size:"xs","data-test-subj":a("label")},d),o.a.createElement(s.EuiAccordion,{id:"1",arrowDisplay:"none",forceState:n?"open":"closed"},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiCommentList,{comments:c,"data-test-subj":a("list")})))}));Se.displayName="CardComments";const Oe=(e,t)=>Object(i.useMemo)((()=>"policy"===e.effectScope.type?null==e?void 0:e.effectScope.policies.map((e=>t&&t[e]?t[e]:{children:e})):void 0),[e.effectScope,t]),Ie=Object(i.memo)((({truncate:e,children:t,"data-test-subj":a,withTooltip:n})=>o.a.createElement(P,{size:"m",truncate:e,"data-test-subj":a,withTooltip:n},t||Object(R.e)())));Ie.displayName="ArtifactDescription";const Ce=Object(i.memo)((({item:e,policies:t,loadingPoliciesList:a=!1,actions:n,hideDescription:i=!1,hideComments:l=!1,"data-test-subj":c,...u})=>{const d=be(e),p=Object(z.a)(c),m=Oe(d,t);return o.a.createElement(ve,r()({},u,{"data-test-subj":c}),o.a.createElement(xe,{className:"top-section"},o.a.createElement(Z,{name:d.name,createdDate:d.created_at,updatedDate:d.updated_at,actions:n,"data-test-subj":p("header")}),o.a.createElement(ie,{createdBy:d.created_by,updatedBy:d.updated_by,policies:m,loadingPoliciesList:a,"data-test-subj":p("subHeader")}),!i&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(Ie,{"data-test-subj":p("description")},d.description)),l?null:o.a.createElement(o.a.Fragment,null,i&&o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(Se,{comments:d.comments,"data-test-subj":p("comments")}))),o.a.createElement(s.EuiHorizontalRule,{margin:"none"}),o.a.createElement(xe,{className:"bottom-section"},o.a.createElement(me,{os:d.os,entries:d.entries,"data-test-subj":p("criteriaConditions")})))}));Ce.displayName="ArtifactEntryCard";const Me=c()(s.EuiSplitPanel.Outer).withConfig({displayName:"CardContainerPanel",componentId:"sc-lh5b0s-0"})(["&.artifactEntryCardMinified + &.artifactEntryCardMinified{margin-top:",";}"],(({theme:e})=>e.eui.euiSizeL)),Te=c()(s.EuiSplitPanel.Inner).withConfig({displayName:"CustomSplitInnerPanel",componentId:"sc-lh5b0s-1"})(["background-color:"," !important;"],(({theme:e})=>e.eui.euiColorLightestShade)),_e=Object(i.memo)((({item:e,isSelected:t=!1,onToggleSelectedArtifact:a,"data-test-subj":n,...l})=>{var c;const u=be(e),d=Object(z.a)(n),[p,m]=Object(i.useState)("closed"),y=Object(i.useCallback)((()=>{m((e=>"closed"===e?"open":"closed"))}),[]),g=Object(i.useCallback)((()=>"open"===p?"Hide details":"Show details"),[p]),f=Object(i.useMemo)((()=>o.a.createElement(Te,null,o.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiCheckbox,{id:u.name,"data-test-subj":`${u.name}_checkbox`,checked:t,onChange:()=>a(!t)})),o.a.createElement(s.EuiFlexItem,null,o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",{"data-test-subj":d("title")},u.name)))))),[u.name,d,t,a]);return o.a.createElement(Me,r()({},l,{"data-test-subj":n,className:`${null!==(c=l.className)&&void 0!==c?c:""}  artifactEntryCardMinified`,id:u.name,hasShadow:!1,hasBorder:!0}),f,o.a.createElement(s.EuiSplitPanel.Inner,{paddingSize:"s"},o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},o.a.createElement(s.EuiTitle,{size:"xxs"},o.a.createElement("h5",{"data-test-subj":d("descriptionTitle")},A)),o.a.createElement(Ie,{"data-test-subj":d("description")},u.description)),o.a.createElement(s.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"s"},o.a.createElement(s.EuiButtonEmpty,{"data-test-subj":d("collapse"),color:"primary",size:"s",flush:"left",iconType:"open"===p?"arrowUp":"arrowDown",iconSide:"right",iconSize:"m",onClick:y,style:{fontWeight:400}},g()),o.a.createElement(s.EuiAccordion,{id:"showDetails",arrowDisplay:"none",forceState:p},o.a.createElement(me,{os:u.os,entries:u.entries,"data-test-subj":d("criteriaConditions")})))))}));_e.displayName="ArtifactEntryCardMinified";const Ne=Object(i.memo)((({expanded:e,onClick:t,"data-test-subj":a})=>o.a.createElement(s.EuiButtonIcon,{iconType:e?"arrowUp":"arrowDown",onClick:t,"data-test-subj":a,"aria-label":e?D:N})));Ne.displayName="CardExpandButton";const De=Object(i.memo)((({artifact:e,onExpandCollapse:t,policies:a,actions:n,expanded:r=!1,"data-test-subj":s})=>{const l=Object(z.a)(s),c=Oe(e,a),u=Object(i.useCallback)((()=>{t()}),[t]);return o.a.createElement(Fe,{"data-test-subj":s,expanded:r,expandToggle:o.a.createElement(Ne,{expanded:r,onClick:u,"data-test-subj":l("expandCollapse")}),name:o.a.createElement(P,{bold:!0,truncate:!r,withTooltip:!r},e.name),description:o.a.createElement(Ie,{truncate:!r,withTooltip:!r},e.description),effectScope:o.a.createElement(ne,{policies:c,"data-test-subj":l("effectScope")}),actionMenu:o.a.createElement(W,{actions:n,"data-test-subj":l("actions")})})}));De.displayName="CardCompressedHeader";const Ae=c.a.div.withConfig({displayName:"ButtonIconPlaceHolder",componentId:"sc-j6qhqr-0"})(["display:inline-block;width:",";height:",";"],(({theme:e})=>e.eui.euiSizeL),(({theme:e})=>e.eui.euiSizeL)),qe=c()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-j6qhqr-1"})(["&.flushTop,.flushTop{padding-top:0;margin-top:0;}"]),Fe=Object(i.memo)((({expanded:e,name:t,expandToggle:a,effectScope:n,actionMenu:r,description:l,"data-test-subj":c,flushTop:u})=>{const d=Object(z.a)(c),p=(e=>Object(i.useMemo)((()=>L()({"eui-textTruncate":!e})),[e]))(e),m=u?" flushTop":"";return o.a.createElement(qe,{responsive:!1,alignItems:"center","data-test-subj":c,className:m},o.a.createElement(s.EuiFlexItem,{grow:!1,className:m,"data-test-subj":d("expandCollapseHolder")},a),o.a.createElement(s.EuiFlexItem,{className:p+m},o.a.createElement(s.EuiFlexGroup,{alignItems:"center",className:m},o.a.createElement(s.EuiFlexItem,{grow:2,className:p+m,"data-test-subj":d("titleHolder")},t),o.a.createElement(s.EuiFlexItem,{grow:3,className:p+m,"data-test-subj":d("descriptionHolder")},l),o.a.createElement(s.EuiFlexItem,{grow:1,"data-test-subj":d("effectScopeHolder"),className:m},n))),!0===r?o.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":d("cardActionsPlaceholder"),className:m},o.a.createElement(Ae,null)):r)}));Fe.displayName="CardCompressedHeaderLayout";const Le=Object(i.memo)((({item:e,onExpandCollapse:t,policies:a,actions:n,expanded:i=!1,"data-test-subj":l,...c})=>{const u=be(e),d=Object(z.a)(l);return o.a.createElement(ve,r()({},c,{"data-test-subj":l}),o.a.createElement(xe,{className:"artifact-entry-collapsible-card"},o.a.createElement(De,{artifact:u,actions:n,policies:a,expanded:i,onExpandCollapse:t,"data-test-subj":d("header")})),i&&o.a.createElement(o.a.Fragment,null,o.a.createElement(s.EuiHorizontalRule,{margin:"xs"}),o.a.createElement(xe,null,o.a.createElement(me,{os:u.os,entries:u.entries,"data-test-subj":d("criteriaConditions")}))))}));Le.displayName="ArtifactEntryCollapsibleCard";var Re=a(1382)},1272:function(e,t,a){"use strict";a.d(t,"a",(function(){return se}));var n=a(2),r=a.n(n),i=a(44),o=a.n(i),s=a(45),l=a(17),c=a(175),u=a(139),d=a(5);const p=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.cancel",{defaultMessage:"Cancel"}),m=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.createRuleExceptionLabel",{defaultMessage:"Add rule exception"}),y=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.addEndpointException",{defaultMessage:"Add Endpoint Exception"}),g=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.title",{defaultMessage:"An error occured submitting exception"}),f=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.dismissButton",{defaultMessage:"Dismiss"}),b=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.submitError.message",{defaultMessage:"View toast for error details."}),h=d.i18n.translate("xpack.securitySolution.ruleExceptions.addException.success",{defaultMessage:"Rule exception added to shared exception list"}),v=d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception added"});var E=a(1440),x=a(1089);const k={initialItems:[],exceptionItems:[],exceptionItemMeta:{name:""},newComment:"",commentErrorExists:!1,itemConditionValidationErrorExists:!1,closeSingleAlert:!1,bulkCloseAlerts:!1,disableBulkClose:!1,bulkCloseIndex:void 0,selectedOs:void 0,exceptionListsToAddTo:[],addExceptionToRadioSelection:"add_to_rule",selectedRulesToAddTo:[],listType:u.b.RULE_DEFAULT,errorSubmitting:null,expireTime:void 0,expireErrorExists:!1};var w=a(1546),j=a(1547),S=a(1473),O=a(1531);const I=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addExceptionToRuleOrList.addToListsLabel",{defaultMessage:"Add to rule or lists"});var C=a(47),M=a(1527);const T=({possibleRules:e,isSingleRule:t,isBulkAction:a,selectedRadioOption:i,onRuleSelectionChange:o,onRadioChange:s})=>{const c=Object(n.useMemo)((()=>a&&null!=e?{id:"add_to_rules",label:r.a.createElement(l.EuiText,{"data-test-subj":"addToRulesRadioOption"},r.a.createElement(C.FormattedMessage,{defaultMessage:"Add to [{numRules}] selected rules: {ruleNames}",id:"xpack.securitySolution.exceptions.common.addToRulesOptionLabel",values:{numRules:e.length,ruleNames:r.a.createElement("span",{style:{fontWeight:"bold"}},e.map((({name:e})=>e)).join(","))}})),checked:"add_to_rules"===i,"data-test-subj":"addToRulesOptionsRadio",onChange:()=>{s("add_to_rules"),o(e)}}:t&&null!=e?{id:"add_to_rule",label:r.a.createElement(l.EuiText,{"data-test-subj":"addToRuleRadioOption"},r.a.createElement(C.FormattedMessage,{defaultMessage:"Add to this rule: {ruleName}",id:"xpack.securitySolution.exceptions.common.addToRuleOptionLabel",values:{ruleName:r.a.createElement("span",{style:{fontWeight:"bold"}},e[0].name)}})),checked:"add_to_rule"===i,"data-test-subj":"addToRuleOptionsRadio",onChange:()=>{s("add_to_rule"),o(e)}}:{id:"select_rules_to_add_to",label:r.a.createElement(l.EuiText,{"data-test-subj":"selectRulesToAddToRadioOption"},r.a.createElement(C.FormattedMessage,{defaultMessage:"Add to rules",id:"xpack.securitySolution.exceptions.common.selectRulesOptionLabel"})),checked:"select_rules_to_add_to"===i,"data-test-subj":"selectRulesToAddToOptionRadio",onChange:()=>s("select_rules_to_add_to")}),[a,e,t,i,s,o]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiRadio,c),"select_rules_to_add_to"===i&&r.a.createElement(M.a,{onRuleSelectionChange:o,initiallySelectedRules:[]}))},_=r.a.memo(T);_.displayName="ExceptionsAddToRulesOptions";const N=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsOptionLabel",{defaultMessage:"Add to shared exception lists"}),D=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.gotToSharedExceptions",{defaultMessage:"Manage shared exception lists"}),A=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltip",{defaultMessage:"Shared exception list is a group of exceptions. Select this option if you’d like to add this exception to shared exception lists."}),q=e=>d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsOptions.addToListsTooltipTitle",{values:{rulesCount:e},defaultMessage:"Shared exception list is a group of exceptions shared across rules. {rulesCount, plural, =1 {This rule currently has no shared} other {These rules currently have no commonly shared}} exception lists attached. To create one, visit the Shared Exception Lists page."});var F=a(1431);const L=d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.addToListsDescription",{defaultMessage:"After you create the exception, it is added to the exception lists you select."}),R=(d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.viewListDetailActionLabel",{defaultMessage:"View list detail"}),d.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToListsTableSelection.referencesFetchError",{defaultMessage:"Unable to load shared exception lists"}));var P=a(1370);const z=Object(n.memo)((({list:e,linkedList:t,onListLinkChange:a,dataTestSubj:i})=>{const o=Object(n.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),s=Object(n.useCallback)((({target:{checked:n}})=>{const r=n?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof a&&a(r)}),[t,a,e]);return r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiSwitch,{"data-test-subj":i,onChange:s,label:"",checked:o}))}));z.displayName="LinkListSwitch";var B=a(1103);const G=({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:a})=>{const{error:i,isLoading:o,pagination:s,lists:c,listTableColumnsWithLinkSwitch:d,onTableChange:p,addToSelectedListDescription:m}=(({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:a})=>{const[i,o]=Object(n.useState)([]),[s,l]=Object(n.useState)(!1),c=Object(n.useMemo)((()=>e?[]:t),[e,t]),[d,p]=Object(n.useState)([]),[m,y]=Object(n.useState)({pageIndex:0,initialPageSize:5,showPerPageOptions:!1}),[g,f]=Object(n.useState)(void 0),b=Object(n.useCallback)((async()=>{try{return l(!0),Object(F.c)(c.length?c:[{namespace_type:"single"}])}catch(e){f(R)}}),[c]),h=Object(n.useCallback)((async()=>{const e=await b();if(!e)return l(!1);const t=[];for(const a of Object.values(e))a.type===u.b.DETECTION&&t.push(a);o(t),l(!1)}),[b]);Object(n.useEffect)((()=>{h()}),[c,b,h]),Object(n.useEffect)((()=>{a(d.map((({referenced_rules:e,namespace_type:t,os_types:a,tags:n,...r})=>({...r,namespace_type:null!=t?t:"single",os_types:null!=a?a:[],tags:null!=n?n:[]}))))}),[d,a]);const v=Object(n.useMemo)((()=>[{field:"link",name:P.b,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>r.a.createElement(z,{dataTestSubj:"addToSharedListSwitch",list:t,linkedList:d,onListLinkChange:p})},...Object(B.d)()]),[d]),E=Object(n.useCallback)((({page:{index:e}})=>y({...m,pageIndex:e})),[m]);return{error:g,isLoading:s,pagination:m,lists:i,listTableColumnsWithLinkSwitch:v,addToSelectedListDescription:L,onTableChange:E}})({showAllSharedLists:e,sharedExceptionLists:t,onListSelectionChange:a});return r.a.createElement(l.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiText,{size:"s"},m),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiInMemoryTable,{sorting:!0,tableLayout:"auto",tableCaption:"Table of exception lists","data-test-subj":"addExceptionToSharedListsTable",error:i,items:c,loading:o,message:o?r.a.createElement(l.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPrompts-loading"}):void 0,columns:d,pagination:s,onTableChange:p})))},$=r.a.memo(G);$.displayName="ExceptionsAddToListsTable";var H=a(110);const V=({rulesCount:e,selectedRadioOption:t,sharedLists:a,onListsSelectionChange:i,onRadioChange:o})=>{const{navigateToApp:s}=Object(H.i)().services.application,[c,u]=Object(n.useState)(!1);return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiRadio,{id:"add_to_lists",label:r.a.createElement(l.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none",responsive:!1,"data-test-subj":"addToListsRadioOptionLabel"},r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiText,null,N)),r.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":"addToListsOption"},r.a.createElement(l.EuiPopover,{button:r.a.createElement(l.EuiButtonIcon,{iconType:"iInCircle",onClick:()=>u(!c)}),isOpen:c,closePopover:()=>u(!1),anchorPosition:"upCenter"},r.a.createElement("div",{style:{width:"300px"}},r.a.createElement(l.EuiText,{size:"s"},0===a.length?q(e):A)),r.a.createElement(l.EuiPopoverFooter,null,r.a.createElement(l.EuiButtonEmpty,{size:"s",iconType:"popout",iconSide:"right",onClick:()=>s("security",{openInNewTab:!0,path:"/exceptions"})},D))))),checked:"add_to_lists"===t,disabled:0===a.length&&e>0,onChange:()=>o("add_to_lists"),"data-test-subj":"addToListsRadioOption"}),"add_to_lists"===t&&(a.length>0||0===e)&&r.a.createElement($,{showAllSharedLists:0===e,sharedExceptionLists:a,onListSelectionChange:i,"data-test-subj":"exceptionsAddToListTable"}))},U=r.a.memo(V);U.displayName="ExceptionsAddToListsOptions";const W=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-oec11w-0"})(["",""],(()=>Object(i.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),Y=({rules:e,isBulkAction:t,selectedRadioOption:a,onListSelectionChange:i,onRuleSelectionChange:o,onRadioChange:s})=>{const c=Object(n.useMemo)((()=>null!=e&&1===e.length),[e]),d=Object(n.useMemo)((()=>{var t,a,n;if(null==e)return[];if(1===e.length)return null!==(t=null===(a=e[0].exceptions_list)||void 0===a?void 0:a.filter((e=>e.type===u.b.DETECTION)))&&void 0!==t?t:[];const r=null!==(n=null==e?void 0:e.map((e=>null!=e.exceptions_list?e.exceptions_list:[])))&&void 0!==n?n:[];r.sort(((e,t)=>e.length-t.length));const i=r.shift();return null!=i&&i.length?i.filter((e=>r.every((t=>t.some((({id:t})=>e.id===t)))))).filter((e=>e.type===u.b.DETECTION)):[]}),[e]),p=Object(n.useMemo)((()=>null!=e?e.length:0),[e]);return r.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemAddToRuleOrListSection"},r.a.createElement(W,{size:"xs"},r.a.createElement("h3",null,I)),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(_,{possibleRules:e,isSingleRule:c,isBulkAction:t,selectedRadioOption:a,onRuleSelectionChange:o,onRadioChange:s}),r.a.createElement(U,{rulesCount:p,selectedRadioOption:a,sharedLists:d,onListsSelectionChange:i,onRadioChange:s}))},Z=r.a.memo(Y);Z.displayName="ExceptionsAddToRulesOrLists";var K=a(117),Q=a(1475),X=a(163);var J=a(1532);const ee=["query","machine_learning","saved_query","threat_match"];var te=a(1060),ae=a(1548);const ne=o()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-v0j9bz-0"})(["",""],(()=>Object(i.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),re=o()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-v0j9bz-1"})(["",""],(()=>Object(i.css)(["&.builder-section{overflow-y:scroll;}"]))),ie=o()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-v0j9bz-2"})(["",""],(({theme:e})=>Object(i.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),oe=o()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-v0j9bz-3"})(["",""],(({theme:e})=>Object(i.css)(["padding:",";"],e.eui.euiSizeS))),se=Object(n.memo)((function({rules:e,isBulkAction:t,isEndpointItem:a,alertData:i,showAlertCloseOptions:o,isAlertDataLoading:I,alertStatus:C,sharedListToAddTo:M,onCancel:T,onConfirm:_}){const{isLoading:N,indexPatterns:D,getExtendedFields:A}=Object(S.a)(e),[q,F]=(()=>{const{addSuccess:e,addError:t,addWarning:a}=Object(K.a)(),[r,i]=(()=>{const[e,t]=Object(n.useState)(!1),a=Object(n.useRef)(null);return Object(n.useEffect)((()=>{const e=new AbortController;return a.current=async(a,n)=>{try{t(!0);const r=await Promise.all(n.map((async t=>Object(X.a)({items:a,ruleId:t.id,signal:e.signal}))));return t(!1),r.flatMap((e=>e))}catch(e){throw t(!1),e}},()=>{t(!1),e.abort()}}),[]),[e,a.current]})(),[o,s]=Object(Q.a)(),[l,c]=Object(n.useState)(!1),p=Object(n.useRef)(null),m=Object(n.useCallback)((e=>e.every((e=>u.i.is(e)))),[]),y=Object(n.useCallback)((e=>e.every((e=>u.n.is(e)||u.h.is(e)))),[]);return Object(n.useEffect)((()=>{const a=new AbortController;return p.current=async({itemsToAdd:a,listType:n,selectedRulesToAddTo:r,addToRules:o,addToSharedLists:l,sharedLists:p})=>{try{let t=[];if(c(!0),o&&null!=i&&n!==u.b.ENDPOINT&&m(a)){t=await i(a,r);const n=r.map((({name:e})=>e)).join(", ");e({title:v,text:(b=n,d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionToastSuccessText",{values:{ruleName:b},defaultMessage:"Exception has been added to rules - {ruleName}."}))})}else if((n===u.b.ENDPOINT||l)&&null!=s&&y(a)){t=await s(a);const n=p.map((({name:e})=>e));e({title:h,text:(f=n.join(","),d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.closeAlerts.successDetails",{values:{listNames:f},defaultMessage:"Rule exception has been added to shared lists: {listNames}."}))})}return c(!1),t}catch(e){throw c(!1),t(e,{title:g}),e}var f,b},()=>{a.abort()}}),[e,t,a,i,s,m,y]),[l||o||r,p.current]})(),[L,R]=Object(J.a)(),P=Object(te.b)(),z=Object(n.useMemo)((()=>null==e||1!==e.length||ee.includes(e[0].type)),[e]),G=Object(n.useMemo)((()=>t?"add_to_rules":1===(null==e?void 0:e.length)||void 0!==I?"add_to_rule":"select_rules_to_add_to"),[I,t,e]),$=Object(n.useMemo)((()=>a?u.b.ENDPOINT:M?u.b.DETECTION:u.b.RULE_DEFAULT),[a,M]),[{exceptionItemMeta:{name:H},listType:V,selectedOs:U,initialItems:W,exceptionItems:Y,disableBulkClose:se,bulkCloseAlerts:le,closeSingleAlert:ce,bulkCloseIndex:ue,addExceptionToRadioSelection:de,selectedRulesToAddTo:pe,exceptionListsToAddTo:me,newComment:ye,commentErrorExists:ge,itemConditionValidationErrorExists:fe,errorSubmitting:be,expireTime:he,expireErrorExists:ve},Ee]=Object(n.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:a}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[a[0]]:a[1]}}}case"setInitialExceptionItems":{const{items:a}=t;return{...e,initialItems:a}}case"setExceptionItems":{const{items:a}=t;return{...e,exceptionItems:a}}case"setConditionValidationErrorExists":{const{errorExists:a}=t;return{...e,itemConditionValidationErrorExists:a}}case"setComment":{const{comment:a}=t;return{...e,newComment:a}}case"setCommentError":{const{errorExists:a}=t;return{...e,commentErrorExists:a}}case"setCloseSingleAlert":{const{close:a}=t;return{...e,closeSingleAlert:a}}case"setBulkCloseAlerts":{const{bulkClose:a}=t;return{...e,bulkCloseAlerts:a}}case"setBulkCloseIndex":{const{bulkCloseIndex:a}=t;return{...e,bulkCloseIndex:a}}case"setSelectedOsOptions":{const{selectedOs:a}=t;return{...e,selectedOs:a}}case"setAddExceptionToLists":{const{listsToAddTo:a}=t;return{...e,exceptionListsToAddTo:a}}case"setListOrRuleRadioOption":{const{option:a}=t;return{...e,addExceptionToRadioSelection:a,listType:"add_to_lists"===a?u.b.DETECTION:u.b.RULE_DEFAULT,selectedRulesToAddTo:"add_to_lists"===a?[]:e.selectedRulesToAddTo}}case"setSelectedRulesToAddTo":{const{rules:a}=t;return{...e,selectedRulesToAddTo:a}}case"setListType":{const{listType:a}=t;return{...e,listType:a}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:a}=t;return{...e,disableBulkClose:a}}case"setErrorSubmitting":{const{err:a}=t;return{...e,errorSubmitting:a}}case"setExpireTime":{const{expireTime:a}=t;return{...e,expireTime:a}}case"setExpireError":{const{errorExists:a}=t;return{...e,expireErrorExists:a}}default:return e}}),{...k,addExceptionToRadioSelection:G,listType:$,selectedRulesToAddTo:null!=e?e:[]}),xe=Object(n.useMemo)((()=>null!=i),[i]),ke=Object(n.useCallback)((e=>{Ee({type:"setInitialExceptionItems",items:e})}),[Ee]),we=Object(n.useCallback)((e=>{Ee({type:"setExceptionItems",items:e})}),[Ee]),je=Object(n.useCallback)((e=>{Ee({type:"setListOrRuleRadioOption",option:e})}),[Ee]),Se=Object(n.useCallback)((e=>{Ee({type:"setSelectedRulesToAddTo",rules:e})}),[Ee]),Oe=Object(n.useCallback)((e=>{Ee({type:"setAddExceptionToLists",listsToAddTo:e})}),[Ee]),Ie=Object(n.useCallback)((e=>{Ee({type:"setExceptionItemMeta",value:e})}),[Ee]),Ce=Object(n.useCallback)((e=>{Ee({type:"setConditionValidationErrorExists",errorExists:e})}),[Ee]),Me=Object(n.useCallback)((e=>{Ee({type:"setSelectedOsOptions",selectedOs:e})}),[Ee]),Te=Object(n.useCallback)((e=>{Ee({type:"setComment",comment:e})}),[Ee]),_e=Object(n.useCallback)((e=>{Ee({type:"setCommentError",errorExists:e})}),[Ee]),Ne=Object(n.useCallback)((e=>{Ee({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[Ee]),De=Object(n.useCallback)((e=>{Ee({type:"setCloseSingleAlert",close:e})}),[Ee]),Ae=Object(n.useCallback)((e=>{Ee({type:"setBulkCloseAlerts",bulkClose:e})}),[Ee]),qe=Object(n.useCallback)((e=>{Ee({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[Ee]),Fe=Object(n.useCallback)((e=>{Ee({type:"setErrorSubmitting",err:e})}),[Ee]),Le=Object(n.useCallback)((e=>{Ee({type:"setExpireTime",expireTime:e})}),[Ee]),Re=Object(n.useCallback)((e=>{Ee({type:"setExpireError",errorExists:e})}),[Ee]);Object(n.useEffect)((()=>{if(i)switch(V){case u.b.ENDPOINT:return ke(Object(x.b)(c.k,H,i));case u.b.RULE_DEFAULT:{var t,a,n;const o=Object(x.k)({alertData:i,exceptionItemName:H,ruleCustomHighlightedFields:null!==(t=null==e||null===(a=e[0])||void 0===a||null===(n=a.investigation_fields)||void 0===n?void 0:n.field_names)&&void 0!==t?t:[]});if(o)return Te((r=i._id,d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.addRuleExceptionFromAlertComment",{values:{alertId:r},defaultMessage:"Exception conditions are pre-filled with relevant data from an alert with the alert id (_id): {alertId}."}))),ke([o])}}var r}),[V,H,i,e,ke,Te]);const Pe=Object(n.useMemo)((()=>xe?Object(x.n)(i):U?[...U]:[]),[xe,i,U]),ze=Object(n.useCallback)((async()=>{if(null!=F)try{const t=["add_to_rule","add_to_rules","select_rules_to_add_to"].includes(de),a=!(null==M||!M.length)||"add_to_lists"===de&&!Object(s.isEmpty)(me),n=null!=M&&M.length?M:me,r=Object(B.b)({itemName:H,commentToAdd:ye,addToRules:t,addToSharedLists:a,sharedLists:n,listType:V,selectedOs:Pe,expireTime:he,items:Y}),o=await F({itemsToAdd:r,selectedRulesToAddTo:pe,listType:V,addToRules:t&&!Object(s.isEmpty)(pe),addToSharedLists:a,sharedLists:n}),l=ce&&i?i._id:void 0,c=t?pe.map((({rule_id:e})=>e)):(null!=e?e:[]).map((({rule_id:e})=>e));null==R||Object(s.isEmpty)(c)||!le&&!ce||await R(c,o,l,ue),P(),_(!0,ce,le)}catch(e){Fe(e)}}),[M,F,de,H,ye,me,V,Pe,Y,pe,ce,i,e,R,le,_,ue,Fe,P,he]),Be=Object(n.useMemo)((()=>q||L||null!=be||""===H.trim()||Y.every((e=>0===e.entries.length))||fe||ge||ve||"add_to_lists"===de&&Object(s.isEmpty)(me)||"select_rules_to_add_to"===de&&Object(s.isEmpty)(pe)&&V===u.b.RULE_DEFAULT),[q,L,be,H,Y,fe,de,me,ve,pe,V,ge]),Ge=Object(n.useCallback)((()=>{Fe(null)}),[Fe]),$e=Object(n.useCallback)((()=>{T(!1)}),[T]),He=Object(n.useMemo)((()=>V===u.b.ENDPOINT?y:m),[V]);return r.a.createElement(l.EuiFlyout,{size:"l",onClose:$e,"data-test-subj":"addExceptionFlyout"},r.a.createElement(ie,null,r.a.createElement(l.EuiTitle,null,r.a.createElement("h2",{"data-test-subj":"exceptionFlyoutTitle"},He)),r.a.createElement(l.EuiSpacer,{size:"m"})),r.a.createElement(re,{className:"builder-section"},N&&r.a.createElement(l.EuiSkeletonText,{"data-test-subj":"loadingAddExceptionFlyout",lines:4}),null!=be&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiCallOut,{"data-test-subj":"addExceptionErrorCallOut",title:g,color:"danger",iconType:"warning"},r.a.createElement(l.EuiText,null,b),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiButton,{"data-test-subj":"addExceptionErrorDismissButton",color:"danger",onClick:Ge},f)),r.a.createElement(l.EuiSpacer,{size:"s"})),r.a.createElement(w.a,{exceptionItemName:H,onChange:Ie}),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(j.a,{exceptionItemName:H,allowLargeValueLists:z,exceptionListItems:W,exceptionListType:V,indexPatterns:D,rules:e,selectedOs:U,showOsTypeOptions:V===u.b.ENDPOINT&&!xe,isEdit:!1,onOsChange:Me,onExceptionItemAdd:we,onSetErrorExists:Ce,getExtendedFields:A}),V!==u.b.ENDPOINT&&!(null!=M&&M.length)&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(Z,{rules:e,isBulkAction:t,selectedRadioOption:de,onListSelectionChange:Oe,onRuleSelectionChange:Se,onRadioChange:je})),r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(E.a,{accordionTitle:r.a.createElement(ne,{size:"xs"},r.a.createElement("h3",null,(Ve=ye?1:0,d.i18n.translate("xpack.securitySolution.ruleExceptions.addExceptionFlyout.commentsTitle",{values:{comments:Ve},defaultMessage:"Add comments ({comments})"})))),initialIsOpen:!!ye,newCommentValue:ye,newCommentOnChange:Te,setCommentError:_e}),V!==u.b.ENDPOINT&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(ae.a,{expireTime:he,setExpireTime:Le,setExpireError:Re})),o&&r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiHorizontalRule,null),r.a.createElement(O.a,{exceptionListType:V,shouldCloseSingleAlert:ce,shouldBulkCloseAlert:le,disableBulkClose:se,exceptionListItems:Y,alertData:i,alertStatus:C,isAlertDataLoading:null!=I&&I,onDisableBulkClose:qe,onUpdateBulkCloseIndex:Ne,onBulkCloseCheckboxChange:Ae,onSingleAlertCloseCheckboxChange:De}))),r.a.createElement(l.EuiFlyoutFooter,null,r.a.createElement(oe,{justifyContent:"spaceBetween"},r.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionAddButton",onClick:$e},p),r.a.createElement(l.EuiButton,{"data-test-subj":"addExceptionConfirmButton",onClick:ze,isDisabled:Be,fill:!0},He))));var Ve}))},1273:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"c",(function(){return k})),a.d(t,"b",(function(){return le}));var n=a(17),r=a(44),i=a.n(r),o=a(2),s=a.n(o),l=a(892),c=a(1322),u=a(1308);const d=i()(n.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-p7dcu3-0"})([".euiFlyoutBody__overflow{display:flex;flex:1;overflow:hidden;.euiFlyoutBody__overflowContent{flex:1;overflow:hidden;padding:",";}}"],(({theme:e})=>`0 ${e.eui.euiSizeM} ${e.eui.euiSizeM}`)),p=({alertId:e,browserFields:t,detailsData:a,detailsEcsData:n,event:r,handleIsolationActionSuccess:i,handleOnEventClosed:o,hostName:p,isAlert:m,isDraggable:y,isReadOnly:g,isolateAction:f,isHostIsolationPanelOpen:b,isIsolateActionSuccessBannerVisible:h,loading:v,rawEventData:E,showAlertDetails:x,scopeId:k})=>s.a.createElement(d,null,h&&s.a.createElement(l.c,{hostName:p,alertId:e,isolateAction:f}),b?s.a.createElement(c.a,{details:a,cancelCallback:x,successCallback:i,isolateAction:f}):s.a.createElement(u.a,{browserFields:t,detailsData:a,detailsEcsData:n,event:r,isAlert:m,isDraggable:y,loading:v,rawEventData:E,scopeId:k,timelineTabType:"flyout",handleOnEventClosed:o,isReadOnly:g})),m=s.a.memo(p);var y=a(566),g=(a(13),a(1120)),f=a(1399);const b=({showAlertDetails:e,showExperimentalBadge:t,isolateAction:a})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiButtonEmpty,{iconType:"arrowLeft",iconSide:"left",flush:"left",onClick:e},s.a.createElement(n.EuiText,{size:"xs"},s.a.createElement("p",null,f.a))),s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(n.EuiTitle,null,s.a.createElement("h2",null,"isolateHost"===a?g.b:g.d))),s.a.createElement(n.EuiFlexItem,{grow:!1},t&&s.a.createElement(v,{label:f.f,size:"s",tooltipContent:f.g})))),h=s.a.memo(b);var v=i()(n.EuiBetaBadge).withConfig({displayName:"_StyledEuiBetaBadge",componentId:"sc-16ihl46-0"})(["display:inline-flex;"]);const E=({eventId:e,eventIndex:t,isAlert:a,isHostIsolationPanelOpen:n,isolateAction:r,loading:i,promptContextId:l,ruleName:c,showAlertDetails:d,timestamp:p,scopeId:m,refetchFlyoutData:g,getFieldsData:f})=>{const b=Object(o.useMemo)((()=>{var e;return!(!a||null===(e=f(y.a))||void 0===e||!e.length)}),[f,a]);return s.a.createElement(s.a.Fragment,null,n?s.a.createElement(h,{isolateAction:r,showAlertDetails:d,showExperimentalBadge:b}):s.a.createElement(u.b,{eventId:e,eventIndex:t,isAlert:a,loading:i,promptContextId:l,ruleName:c,timestamp:p,scopeId:m,refetchFlyoutData:g,getFieldsData:f}))},x=({eventId:e,eventIndex:t,isAlert:a,isHostIsolationPanelOpen:r,isolateAction:i,loading:o,promptContextId:l,ruleName:c,showAlertDetails:u,timestamp:d,scopeId:p,refetchFlyoutData:m,getFieldsData:y})=>s.a.createElement(n.EuiFlyoutHeader,{hasBorder:r},s.a.createElement(E,{eventId:e,eventIndex:t,isAlert:a,isHostIsolationPanelOpen:r,isolateAction:i,loading:o,promptContextId:l,ruleName:c,showAlertDetails:u,timestamp:d,scopeId:p,refetchFlyoutData:m,getFieldsData:y})),k=s.a.memo(x);var w=a(23),j=a.n(w),S=a(45),O=a(127),I=a(124),C=a(470),M=a(266),T=a(47),_=a(135),N=a(911),D=a(972),A=a(1552),q=a(1507),F=a(1484),L=a(1386),R=a(929),P=a(1486),z=a(212),B=a(130),G=a(1309),$=a(186),H=a(9),V=a(311),U=a(1330),W=a(226);var Y=a(1551),Z=a(1550),K=a(110),Q=a(1472),X=a(1487),J=a(1488);const ee=s.a.memo((({detailsData:e,ecsData:t,handleOnEventClosed:a,isHostIsolationPanelOpen:r,loadingEventDetails:i,onAddEventFilterClick:l,onAddExceptionTypeClick:c,onAddIsolationStatusClick:u,refetch:d,refetchFlyoutData:p,onOsqueryClick:m,scopeId:f})=>{var b;const h=Object(B.a)("tGridEnabled"),{loading:v,canWriteEventFilters:E}=Object(_.a)().endpointPrivileges,x=Object(o.useMemo)((()=>!v&&E),[E,v]),{osquery:k}=Object(K.i)().services,[w,j]=Object(o.useState)(!1),S=Object(o.useMemo)((()=>[{category:"kibana",field:"kibana.alert.rule.uuid",name:"ruleId"},{category:"kibana",field:"kibana.alert.rule.name",name:"ruleName"},{category:"kibana",field:"kibana.alert.workflow_status",name:"alertStatus"},{category:"event",field:"event.kind",name:"eventKind"},{category:"_id",field:"_id",name:"eventId"}].reduce(((t,a)=>({...t,[a.name]:Object(D.a)({category:a.category,field:a.field},e)})),{})),[e]),ee="event"===S.eventKind,te=Object(o.useMemo)((()=>{var e,a;return null==t||null===(e=t.agent)||void 0===e||null===(a=e.type)||void 0===a?void 0:a.includes("endpoint")}),[t]),ae=Object(o.useMemo)((()=>ee&&te),[ee,te]),ne=Object(o.useMemo)((()=>Object(D.a)({category:"agent",field:"agent.id"},e)),[e]),re=Object(o.useCallback)((()=>{j(!w)}),[w]),ie=Object(o.useCallback)((()=>{j(!1)}),[]),oe=Object(o.useCallback)((()=>{a(),j(!1)}),[a]),se=Object(o.useCallback)((e=>{u(e),j(!1)}),[u]),le=(({closePopover:e,detailsData:t,isHostIsolationPanelOpen:a,onAddIsolationStatusClick:n})=>{var r,i,s;const l=null===(r=Object(z.b)().services.application)||void 0===r||null===(i=r.capabilities)||void 0===i||null===(s=i.actions)||void 0===s?void 0:s.save,c=Object(B.a)("sentinelOneManualHostActionsEnabled"),{canIsolateHost:u,canUnIsolateHost:d}=Object(_.a)().endpointPrivileges,p=Object(o.useMemo)((()=>Object(N.b)({data:t||[]})),[t]),m=Object(o.useMemo)((()=>Object(y.c)({data:t||[]})),[t]),f=Object(o.useMemo)((()=>Object(D.a)({category:"agent",field:"agent.id"},t)),[t]),b=Object(o.useMemo)((()=>Object(y.b)(t)),[t]),h=Object(o.useMemo)((()=>Object(D.a)({category:"host",field:"host.os.name"},t)),[t]),v=Object(o.useMemo)((()=>Object(D.a)({category:"agent",field:"agent.version"},t)),[t]),{loading:E,isIsolated:x,agentStatus:k,capabilities:w}=(({agentId:e})=>{const[t,a]=Object(o.useState)(!1),[n,r]=Object(o.useState)([]),[i,s]=Object(o.useState)(),[l,c]=Object(o.useState)(0),[u,d]=Object(o.useState)(0),[p,m]=Object(o.useState)(!1);return Object(o.useEffect)((()=>{const t=new AbortController;let n,i=!0;return m(!0),Object(H.isEmpty)(e)||(async()=>{try{const o=await Object(V.g)({agentId:e,signal:t.signal});i&&(a(Object(W.b)(o.metadata)),o.metadata.Endpoint.capabilities&&r([...o.metadata.Endpoint.capabilities]),s(o.host_status),n=o.metadata.elastic.agent.id)}catch(e){if("AbortError"===e.name)return;i&&400===e.body.statusCode&&s($.c.UNENROLLED)}try{const{data:e}=await Object(U.a)(n);var o,l,u,p;i&&(c(null!==(o=null===(l=e[0].pending_actions)||void 0===l?void 0:l.isolate)&&void 0!==o?o:0),d(null!==(u=null===(p=e[0].pending_actions)||void 0===p?void 0:p.unisolate)&&void 0!==u?u:0))}catch(e){return}i&&m(!1)})(),()=>{i=!1,t.abort()}}),[e]),{loading:p,capabilities:n,isIsolated:t,agentStatus:i,pendingIsolation:l,pendingUnisolation:u}})({agentId:f}),{data:j}=Object(Y.a)({agentId:b}),S=Object(o.useMemo)((()=>{var e,t;return null==j||null===(e=j.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t[0]}),[j]),O=Object(o.useMemo)((()=>c&&m?"disconnected"===(null==S?void 0:S.networkStatus):x),[x,m,null==S?void 0:S.networkStatus,c]),I=Object(o.useMemo)((()=>p?Object(G.a)({osName:h,version:v,capabilities:w}):!!(c&&m&&S)&&S.isActive),[v,w,h,p,m,S,c]),C=Object(o.useCallback)((()=>{e(),n(O?"unisolateHost":"isolateHost")}),[e,O,n]),M=Object(o.useMemo)((()=>c&&m?!S||(null==S?void 0:S.isUninstalled)||(null==S?void 0:S.isPendingUninstall):k===$.c.UNENROLLED),[k,m,S,c]),T=Object(o.useMemo)((()=>[{key:"isolate-host-action-item","data-test-subj":"isolate-host-action-item",disabled:M,onClick:C,name:O?g.d:g.b}]),[O,C,M]);return Object(o.useMemo)((()=>a?[]:m&&c&&b&&S&&l||p&&I&&!E&&(u||O&&!d)?T:[]),[u,d,I,l,p,O,a,m,E,T,S,b,c])})({closePopover:ie,detailsData:e,onAddIsolationStatusClick:se,isHostIsolationPanelOpen:r}),ce=((e,t)=>{const{loading:a,canAccessResponseConsole:n}=Object(_.a)().endpointPrivileges,r=Object(o.useMemo)((()=>Object(N.c)(e||[])),[e]),i=Object(o.useMemo)((()=>Object(D.a)({category:"agent",field:"agent.id"},e)),[e]),{handleResponseActionsClick:l,isDisabled:c,tooltip:u}=Object(A.a)({endpointId:i,onClick:t});return Object(o.useMemo)((()=>{const e=[];return!a&&n&&r&&e.push({key:"endpointResponseActions-action-item","data-test-subj":"endpointResponseActions-action-item",disabled:c,toolTipContent:u,size:"s",onClick:l,name:s.a.createElement(T.FormattedMessage,{id:"xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.buttonLabel",defaultMessage:"Respond"})}),e}),[n,l,r,a,c,u])})(e,ie),ue=Object(o.useCallback)((e=>{c(e),j(!1)}),[c]),{exceptionActionItems:de}=Object(F.a)({isEndpointAlert:Object(N.a)({ecsData:t}),onAddExceptionTypeClick:ue}),pe=Object(o.useCallback)((()=>{l(),j(!1)}),[l]),{eventFilterActionItems:me}=Object(P.a)({onAddEventFilterClick:pe}),ye=Object(o.useCallback)((()=>{ie()}),[ie]),{actionItems:ge}=Object(L.a)({alertStatus:S.alertStatus,closePopover:oe,eventId:S.eventId,refetch:d,scopeId:f}),{alertTagsItems:fe,alertTagsPanels:be}=Object(X.a)({closePopover:ie,ecsRowData:null!=t?t:{_id:S.eventId},refetch:d}),he=Object(o.useCallback)((()=>{d&&d(),p&&p()}),[d,p]),{alertAssigneesItems:ve,alertAssigneesPanels:Ee}=Object(J.a)({closePopover:ie,ecsRowData:null!=t?t:{_id:S.eventId},refetch:he}),{investigateInTimelineActionItems:xe}=Object(R.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:ie}),ke=null==k?void 0:k.isOsqueryAvailable({agentId:ne}),we=Object(o.useCallback)((()=>{m(ne),j(!1)}),[m,j,ne]),je=Object(o.useMemo)((()=>Object(Q.a)({handleClick:we})),[we]),Se=Object(o.useMemo)((()=>!ee&&S.ruleId?[...ge,...fe,...ve,...de]:ae&&x?me:[]),[me,ae,x,de,ge,ee,S.ruleId,fe,ve]),Oe=[I.e.alertsOnAlertsPage,I.e.alertsOnRuleDetailsPage].includes(f),{addToCaseActionItems:Ie,handleAddToNewCaseClick:Ce}=Object(Z.a)({ecsData:t,nonEcsData:null!==(b=null==e?void 0:e.map((e=>({field:e.field,value:e.values}))))&&void 0!==b?b:[],onMenuItemClick:ye,onSuccess:p,isActiveTimelines:Object(O.isActiveTimeline)(f),isInDetections:Oe,refetch:d}),Me=Object(o.useMemo)((()=>[...h?Ie:[],...Se,...le,...ce,...ke?[je]:[],...xe]),[h,Ie,Se,le,ce,ke,je,xe]),Te=[{id:0,items:Me},...be,...Ee],_e=Object(o.useMemo)((()=>s.a.createElement(C.a,{onClick:Ce,step:M.a.addAlertToCase,tourId:M.b.alertsCases},s.a.createElement(n.EuiButton,{"data-test-subj":"take-action-dropdown-btn",fill:!0,iconSide:"right",iconType:"arrowDown",onClick:re},q.d))),[Ce,re]);return Me.length&&!i&&t?s.a.createElement(n.EuiPopover,{id:"AlertTakeActionPanel",button:_e,isOpen:w,closePopover:ie,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},s.a.createElement(n.EuiContextMenu,{size:"s",initialPanelId:0,panels:Te,"data-test-subj":"takeActionPanelMenu"})):null}));var te=a(1483),ae=a(1545),ne=a(1533),re=a(1485),ie=a(695),oe=a(1393);const se=({detailsData:e,detailsEcsData:t,handleOnEventClosed:a,isHostIsolationPanelOpen:r,isReadOnly:i,loadingEventDetails:l,onAddIsolationStatusClick:c,scopeId:u,refetchFlyoutData:d})=>{var p;const m=null!=t&&null!==(p=t.kibana)&&void 0!==p&&p.alert?null==t?void 0:t._id:null,y=Object(o.useMemo)((()=>{var t,a,n;return null!==(t=null===(a=Object(S.find)({category:"signal",field:"signal.rule.index"},e))||void 0===a?void 0:a.values)&&void 0!==t?t:null===(n=Object(S.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},e))||void 0===n?void 0:n.values}),[e]),g=Object(o.useMemo)((()=>Array.isArray(y)?y:void 0),[y]),f=Object(o.useMemo)((()=>{var t,a,n;return null!==(t=null===(a=Object(S.find)({category:"signal",field:"signal.rule.data_view_id"},e))||void 0===a?void 0:a.values)&&void 0!==t?t:null===(n=Object(S.find)({category:"kibana",field:"kibana.alert.rule.parameters.data_view_id"},e))||void 0===n?void 0:n.values}),[e]),b=Object(o.useMemo)((()=>Array.isArray(f)?f[0]:void 0),[f]),h=Object(o.useMemo)((()=>[{category:"signal",field:"signal.rule.id",name:"ruleId"},{category:"signal",field:"signal.rule.rule_id",name:"ruleRuleId"},{category:"signal",field:"signal.rule.name",name:"ruleName"},{category:"signal",field:"kibana.alert.workflow_status",name:"alertStatus"},{category:"_id",field:"_id",name:"eventId"}].reduce(((t,a)=>({...t,[a.name]:Object(D.a)({category:a.category,field:a.field},e)})),{})),[e]),{refetch:v}=Object(oe.a)({scopeId:u}),{exceptionFlyoutType:E,openAddExceptionFlyout:x,onAddExceptionTypeClick:k,onAddExceptionCancel:w,onAddExceptionConfirm:I}=Object(te.a)({refetch:v,isActiveTimelines:Object(O.isActiveTimeline)(u)}),{closeAddEventFilterModal:C,isAddEventFilterModalOpen:M,onAddEventFilterClick:T}=Object(re.a)(),[_,N]=Object(o.useState)(null),A=Object(o.useCallback)((()=>{N(null)}),[N]);return i?null:s.a.createElement(s.a.Fragment,null,s.a.createElement(n.EuiFlyoutFooter,{className:"side-panel-flyout-footer","data-test-subj":"side-panel-flyout-footer"},s.a.createElement(n.EuiFlexGroup,{justifyContent:"flexEnd"},s.a.createElement(n.EuiFlexItem,{grow:!1},t&&s.a.createElement(ee,{detailsData:e,ecsData:t,handleOnEventClosed:a,isHostIsolationPanelOpen:r,loadingEventDetails:l,onAddEventFilterClick:T,onAddExceptionTypeClick:k,onAddIsolationStatusClick:c,refetchFlyoutData:d,refetch:v,scopeId:u,onOsqueryClick:N})))),x&&null!=h.ruleId&&null!=h.ruleRuleId&&null!=h.eventId&&s.a.createElement(ae.a,j()({},h,{ruleIndices:g,ruleDataViewId:b,exceptionListType:E,onCancel:w,onConfirm:I})),M&&null!=t&&s.a.createElement(ne.a,{data:t,onCancel:C}),_&&null!=t&&s.a.createElement(ie.a,{agentId:_,defaultValues:m?{alertIds:[m]}:void 0,onClose:A,ecsData:t}))},le=s.a.memo(se)},1277:function(e,t,a){"use strict";a.d(t,"b",(function(){return S})),a.d(t,"a",(function(){return O})),a.d(t,"c",(function(){return I}));var n=a(45),r=a(142);let i,o;var s,l;!function(e){e.MALICIOUS_FILE="malicious_file",e.RANSOMWARE="ransomware",e.MEMORY_SIGNATURE="memory_signature",e.SHELLCODE_THREAD="shellcode_thread",e.BEHAVIOR="behavior"}(i||(i={})),function(e){e.PROCESS="process",e.FILE="file",e.NETWORK="network",e.REGISTRY="registry",e.MALWARE="malware"}(o||(o={})),s="host",l={"os.platform":"os.platform","os.name":"os.name","os.full":"os.full","os.family":"os.family","os.version":"os.version","os.kernel":"os.kernel"},Object.entries(l).reduce(((e,[t,a])=>(e[`${s}.${t}`]=`${s}.${a}`,e)),{});var c=a(215),u=a(197),d=a(1366),p=a(285),m=a(732),y=a(911),g=a(566);const f=`${d.h}.terms.field`,b=`${d.h}.terms.value`,h=`${d.h}.cardinality.field`,v=`${d.h}.cardinality.value`,E=`${d.h}.count`,x=[{id:"host.name"},{id:"agent.id",overrideField:p.a,label:c.b},{id:g.a,overrideField:p.a,label:c.b},{id:"user.name"},{id:"rule.name"},{id:"cloud.provider"},{id:"cloud.region"},{id:"cloud.provider"},{id:"cloud.region"},{id:"orchestrator.cluster.id"},{id:"orchestrator.cluster.name"},{id:"container.image.name"},{id:"container.image.tag"},{id:"orchestrator.namespace"},{id:"orchestrator.resource.parent.type"},{id:"orchestrator.resource.type"},{id:"process.executable"},{id:"file.path"},{id:r.R,label:c.z}];function k({primaryEventCategory:e,allEventCategories:t}){switch(e){case o.PROCESS:return[{id:"process.name"},{id:"process.parent.name"},{id:"process.args"}];case o.FILE:return[{id:"file.name"},{id:"file.hash.sha256"},{id:"file.directory"},{id:"process.name"}];case o.NETWORK:return[{id:"destination.address"},{id:"destination.port"},{id:"source.address"},{id:"source.port"},{id:"dns.question.name"},{id:"process.name"}];case o.REGISTRY:return[{id:"registry.key"},{id:"registry.value"},{id:"process.name"}];case o.MALWARE:return k({primaryEventCategory:o.FILE,allEventCategories:t});default:let e=[];return null!=t&&t.includes(o.FILE)&&(e=e.concat(k({primaryEventCategory:o.FILE}))),null!=t&&t.includes(o.PROCESS)&&(e=e.concat(k({primaryEventCategory:o.PROCESS}))),e}}function w(e,t){switch(e){case i.BEHAVIOR:return[{id:"rule.description",label:u.s},...k({...t,primaryEventCategory:void 0})];case i.SHELLCODE_THREAD:return[{id:"Target.process.executable"},{id:"Memory_protection.unique_key_v1"}];case i.RANSOMWARE:return[{id:"Ransomware.feature"},{id:"process.hash.sha256"},...k({...t,primaryEventCategory:void 0})];case i.MEMORY_SIGNATURE:return k({...t,primaryEventCategory:void 0});case i.MALICIOUS_FILE:return[{id:"file.Ext.quarantine_path",overrideField:p.j,label:c.x}];default:return[]}}function j(e){switch(e){case"threshold":return[{id:E,label:u.w},{id:f,overrideField:b,label:u.x},{id:h,label:u.v}];case"machine_learning":return[{id:`${r.J}.machine_learning_job_id`,legacyId:"signal.rule.machine_learning_job_id"},{id:`${r.J}.anomaly_threshold`,legacyId:"signal.rule.anomaly_threshold"}];case"threat_match":return[{id:`${r.J}.threat_index`,legacyId:"signal.rule.threat_index"},{id:`${r.J}.threat_query`,legacyId:"signal.rule.threat_query"}];case"new_terms":return[{id:d.c,label:u.o},{id:d.b,label:u.n}];default:return[]}}function S({eventCategories:e,eventCode:t,eventRuleType:a,highlightedFieldsOverride:r}){const i=[...(o=r,o.map((e=>({id:e})))),...x,...k(e),...w(t,e),...j(a)];var o;return Object(n.uniqBy)("id",i)}function O(e){const t=Object(n.find)({category:"event",field:"event.category"},e);let a,r;return Array.isArray(null==t?void 0:t.originalValue)?(a=null==t?void 0:t.originalValue[0],r=null==t?void 0:t.originalValue):(a=null==t?void 0:t.originalValue,a&&(r=[a])),{primaryEventCategory:a,allEventCategories:r}}const I=({data:e,browserFields:t,scopeId:a,eventId:i,isDraggable:o=!1,isReadOnly:s=!1,investigationFields:l,sentinelOneManualHostActionsEnabled:c})=>{var d,p;const E=O(e),k=Object(n.find)({category:"event",field:"event.code"},e),w=Array.isArray(null==k?void 0:k.originalValue)?null==k||null===(d=k.originalValue)||void 0===d?void 0:d[0]:null==k?void 0:k.originalValue,j=Object(n.find)({category:"kibana",field:r.R},e),I=S({eventCategories:E,eventCode:w,eventRuleType:Array.isArray(null==j?void 0:j.originalValue)?null==j||null===(p=j.originalValue)||void 0===p?void 0:p[0]:null==j?void 0:j.originalValue,highlightedFieldsOverride:null!=l?l:[]});return null!=e?I.reduce(((r,l)=>{var d;const p=e.find((e=>e.field===l.id||l.legacyId&&e.field===l.legacyId));if(!p||Object(n.isEmpty)(p.values))return r;p.field===l.legacyId&&(l.id=l.legacyId);const E=null!=l.linkField&&e.find((e=>e.field===l.linkField)),k={...Object(m.b)({item:p,linkValueField:E||void 0,contextId:a,scopeId:a,browserFields:t,eventId:i,field:l}),isDraggable:o,isReadOnly:s};if("agent.id"===l.id&&!Object(y.b)({data:e}))return r;if(l.id===g.a&&c&&!Object(g.c)({data:e}))return r;if(l.id===f){const t=function({values:e},t,a){const n=t.find((e=>e.field===b)),r=n&&n.values;if(Array.isArray(e)&&e.length>0&&Array.isArray(r)&&e.length===r.length)return e.map(((e,t)=>({title:e,description:{...a,values:[r[t]]}}))).filter((e=>!x.map((e=>e.id)).includes(e.title)))}(p,e,k);return t?[...r,...t]:r}if(l.id===h){const t=function({values:e},t,a){const n=t.find((e=>e.field===v)),r=n&&n.values;if(Array.isArray(e)&&1===e.length&&Array.isArray(r)&&e.length===r.length)return{title:u.v,description:{...a,values:[`count(${e[0]}) >= ${r[0]}`]}}}(p,e,k);return t?[...r,t]:r}return[...r,{title:null!==(d=l.label)&&void 0!==d?d:l.id,description:k}]}),[]):[]}},1286:function(e,t,a){"use strict";a.d(t,"i",(function(){return r})),a.d(t,"h",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"e",(function(){return d})),a.d(t,"g",(function(){return p})),a.d(t,"k",(function(){return m})),a.d(t,"j",(function(){return y}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.user.details.overview.userIdTitle",{defaultMessage:"User ID"}),i=n.i18n.translate("xpack.securitySolution.user.details.overview.userDomainTitle",{defaultMessage:"Domain"}),o=n.i18n.translate("xpack.securitySolution.user.details.overview.familyTitle",{defaultMessage:"Family"}),s=n.i18n.translate("xpack.securitySolution.user.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),l=n.i18n.translate("xpack.securitySolution.user.details.overview.osTitle",{defaultMessage:"Operating system"}),c=n.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),u=n.i18n.translate("xpack.securitySolution.user.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),d=n.i18n.translate("xpack.securitySolution.user.details.overview.inspectTitle",{defaultMessage:"User overview"}),p=n.i18n.translate("xpack.securitySolution.user.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),m=n.i18n.translate("xpack.securitySolution.user.details.overview.userRiskScoreTitle",{defaultMessage:"User risk score"}),y=n.i18n.translate("xpack.securitySolution.user.details.overview.userRiskLevel",{defaultMessage:"User risk level"})},1287:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"g",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"d",(function(){return l}));var n=a(5),r=a(348);a.d(t,"a",(function(){return r.a})),a.d(t,"c",(function(){return r.b})),a.d(t,"f",(function(){return r.c})),a.d(t,"h",(function(){return r.d}));const i=e=>n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.nameTitle",{defaultMessage:"{riskEntity} Name",values:{riskEntity:Object(r.d)(e)}}),o=n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.viewAllLabel",{defaultMessage:"View all"}),s=e=>n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.learnMore",{defaultMessage:"Learn more about {riskEntity} risk",values:{riskEntity:Object(r.d)(e,!0)}}),l=n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.lastUpdatedTitle",{defaultMessage:"Last updated"})},1288:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"k",(function(){return o})),a.d(t,"n",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"j",(function(){return u})),a.d(t,"m",(function(){return d})),a.d(t,"p",(function(){return p})),a.d(t,"o",(function(){return m})),a.d(t,"c",(function(){return y})),a.d(t,"r",(function(){return g})),a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"q",(function(){return h})),a.d(t,"i",(function(){return v})),a.d(t,"l",(function(){return E})),a.d(t,"h",(function(){return x}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.host.details.overview.hostIdTitle",{defaultMessage:"Host ID"}),i=n.i18n.translate("xpack.securitySolution.host.details.firstSeenTitle",{defaultMessage:"First seen"}),o=n.i18n.translate("xpack.securitySolution.host.details.lastSeenTitle",{defaultMessage:"Last seen"}),s=n.i18n.translate("xpack.securitySolution.host.details.overview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),l=n.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskScoreTitle",{defaultMessage:"Host risk score"}),c=n.i18n.translate("xpack.securitySolution.host.details.overview.hostRiskLevel",{defaultMessage:"Host risk level"}),u=n.i18n.translate("xpack.securitySolution.host.details.overview.ipAddressesTitle",{defaultMessage:"IP addresses"}),d=n.i18n.translate("xpack.securitySolution.host.details.overview.macAddressesTitle",{defaultMessage:"MAC addresses"}),p=n.i18n.translate("xpack.securitySolution.host.details.overview.platformTitle",{defaultMessage:"Platform"}),m=n.i18n.translate("xpack.securitySolution.host.details.overview.osTitle",{defaultMessage:"Operating system"}),y=n.i18n.translate("xpack.securitySolution.host.details.overview.familyTitle",{defaultMessage:"Family"}),g=n.i18n.translate("xpack.securitySolution.host.details.versionLabel",{defaultMessage:"Version"}),f=n.i18n.translate("xpack.securitySolution.host.details.architectureLabel",{defaultMessage:"Architecture"}),b=n.i18n.translate("xpack.securitySolution.host.details.overview.cloudProviderTitle",{defaultMessage:"Cloud provider"}),h=n.i18n.translate("xpack.securitySolution.host.details.overview.regionTitle",{defaultMessage:"Region"}),v=n.i18n.translate("xpack.securitySolution.host.details.overview.instanceIdTitle",{defaultMessage:"Instance ID"}),E=n.i18n.translate("xpack.securitySolution.host.details.overview.machineTypeTitle",{defaultMessage:"Machine type"}),x=n.i18n.translate("xpack.securitySolution.host.details.overview.inspectTitle",{defaultMessage:"Host overview"})},1289:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(56),r=a.n(n),i=a(2),o=a.n(i),s=a(17),l=a(877),c=a(272);const u=({range:e,setRange:t,loading:a})=>{const[n,u]=Object(i.useState)(e.from===c.a?r()().subtract(30,"d"):r()(e.from)),[d,p]=Object(i.useState)(e.to===c.b?r()():r()(e.to)),m=Object(i.useCallback)((()=>{n&&d&&n.isBefore(d)&&t({from:n.toISOString(),to:d.toISOString()})}),[d,t,n]),y=Object(i.useMemo)((()=>null==n?void 0:n.isBefore(d)),[n,d]);return o.a.createElement(s.EuiFlexGroup,null,o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiDatePickerRange,{"data-test-subj":"enrichment-query-range-picker",startDateControl:o.a.createElement(s.EuiDatePicker,{className:"start-picker",selected:n,onChange:u,startDate:n,endDate:d,isInvalid:!y,"aria-label":l.d,showTimeSelect:!0}),endDateControl:o.a.createElement(s.EuiDatePicker,{className:"end-picker",selected:d,onChange:p,startDate:n,endDate:d,isInvalid:!y,"aria-label":l.c,showTimeSelect:!0})})),o.a.createElement(s.EuiFlexItem,{grow:!1},o.a.createElement(s.EuiButton,{iconType:"refresh",onClick:m,isLoading:a,"data-test-subj":"enrichment-button",isDisabled:!y},l.m)))}},1290:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),r=a.n(n),i=a(1470),o=a(197),s=a(929);const l=({ariaLabel:e=o.j,ecsRowData:t,buttonType:a,onInvestigateInTimelineAlertClick:n})=>{const{investigateInTimelineAlertClick:l}=Object(s.a)({ecsRowData:t,onInvestigateInTimelineAlertClick:n});return r.a.createElement(i.a,{ariaLabel:e,content:o.i,dataTestSubj:"send-alert-to-timeline",iconType:"timeline",onClick:l,isDisabled:!1,buttonType:a})},c=r.a.memo(l)},1291:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"h",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),i=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),o=(n.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),n.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),n.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),n.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"})),s=(n.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),n.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),n.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),n.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),n.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),n.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"})),l=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),c=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),u=n.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),d=n.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"})},1292:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(117),r=a(532),i=a(557);const o=(e,t)=>{const{addError:a}=Object(n.a)();return Object(r.a)(e,{onError:e=>a(e,{title:i.b}),...t})}},1293:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(70),r=a(924);const i=(e,t={})=>{var a;return e.get(r.a,{...t,query:{...t.query,kuery:`${null!=t&&null!==(a=t.query)&&void 0!==a&&a.kuery?`${t.query.kuery} and `:""}${n.PACKAGE_POLICY_SAVED_OBJECT_TYPE}.package.name: endpoint`},version:n.API_VERSIONS.public.v1})}},1294:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(23),r=a.n(n),i=a(2),o=a.n(i),s=a(47),l=a(17),c=a(44),u=a.n(c),d=a(733);const p=u()(l.EuiButtonEmpty).withConfig({displayName:"EuiButtonEmptyStyled",componentId:"sc-1h0vyjj-0"})(["margin-bottom:",";.euiIcon{width:",";height:",";}.text{font-size:",";margin-inline-start:",";}"],(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeXS)),m=Object(i.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:a,...n})=>{const i=Object(d.a)(...a);return o.a.createElement(p,r()({"data-test-subj":"backToOrigin"},n,{flush:"left",size:"xs",iconType:"arrowLeft",href:t,onClick:i,textProps:{className:"text"}}),e||o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));m.displayName="BackToExternalAppButton"},1302:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return s})),a.d(t,"f",(function(){return l}));const n="network.bytes",r="network.community_id",i="network.direction",o="network.packets",s="network.protocol",l="network.transport"},1303:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(17),r=a(2),i=a.n(r),o=a(44),s=a.n(o),l=a(325),c=a(130),u=a(110),d=a(1417),p=a(215),m=a(264);const y=s.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-woclj6-0"})(["height:100%;position:relative;"]),g=({rawEventData:e,ecsData:t})=>{var a,r,o,s,g,f,b,h,v;const{services:{osquery:E}}=Object(u.i)(),x=Object(c.a)("responseActionsEnabled"),k=Object(c.a)("endpointResponseActionsEnabled"),w=e?Object(l.a)(e.fields):void 0,j=null==w||null===(a=w.kibana)||void 0===a||null===(r=a.alert)||void 0===r||null===(o=r.rule)||void 0===o||null===(s=o.parameters)||void 0===s?void 0:s[0].response_actions,S=!e||!x||k||!t||!(null!=j&&j.length),O=null!==(g=null==e?void 0:e._id)&&void 0!==g?g:"",{OsqueryResults:I,fetchAllLiveQueries:C}=E,{data:M}=C({kuery:`alert_ids: ( ${O} )`,alertId:O,skip:S});if(S)return;const T=j.filter((e=>e.action_type_id===m.b[".osquery"]));if(null==T||!T.length)return;const _=(null==M?void 0:M.data.items)||[],N=null==w||null===(f=w.kibana)||void 0===f||null===(b=f.alert)||void 0===b||null===(h=b.rule)||void 0===h||null===(v=h.name)||void 0===v?void 0:v[0],D=i.a.createElement(y,{"data-test-subj":"osqueryViewWrapper"},i.a.createElement(I,{ruleName:N,actionItems:_,ecsData:t}),i.a.createElement(n.EuiSpacer,{size:"s"}));return{id:d.b.osqueryView,"data-test-subj":"osqueryViewTab",name:p.u,append:i.a.createElement(n.EuiNotificationBadge,{"data-test-subj":"osquery-actions-notification"},_.length),content:D}}},1304:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.osquery.action.shortEmptyTitle",{defaultMessage:"Osquery is not available"}),i=n.i18n.translate("xpack.securitySolution.osquery.action.permissionDenied",{defaultMessage:"Permission denied"}),o=n.i18n.translate("xpack.securitySolution.osquery.action.unavailable",{defaultMessage:"The Osquery Manager integration is not added to the agent policy. To run queries on the host, add the Osquery Manager integration to the agent policy in Fleet."})},1305:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(1502);const r=e=>{var t;const a=null!=e&&e.fields?null==e?void 0:e.fields["kibana.alert.rule.parameters"]:null,r=a?null===(t=a[0])||void 0===t?void 0:t.threat:null;return r&&r.length>0?Object(n.m)({label:r[0].framework,threat:r}):null}},1306:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(17),r=a(2),i=a.n(r),o=a(44),s=a.n(o),l=a(1629),c=a.n(l);const u=s()(n.EuiFlexGroup).withConfig({displayName:"ThreatEuiFlexGroupStyles",componentId:"sc-14mwgam-0"})([".euiFlexItem{margin-bottom:0px;}"]),d=s()(n.EuiFlexItem).withConfig({displayName:"SubtechniqueFlexItem",componentId:"sc-14mwgam-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),p=s()(n.EuiButtonEmpty).withConfig({displayName:"TechniqueLinkItem",componentId:"sc-14mwgam-2"})([".euiIcon{width:8px;height:8px;}align-self:flex-start;"]),m=({threat:e,"data-test-subj":t="threat"})=>{const[o,s]=Object(r.useState)([]),[l,m]=Object(r.useState)([]),[y,g]=Object(r.useState)([]);return Object(r.useEffect)((()=>{!async function(){const e=await a.e(20).then(a.bind(null,1695));g(e.subtechniques),s(e.techniques),m(e.tactics)}()}),[]),i.a.createElement(u,{direction:"column","data-test-subj":t},e.map(((e,t)=>{const a=l.find((t=>t.id===e.tactic.id));return i.a.createElement(n.EuiFlexItem,{key:`${e.tactic.name}-${t}`},i.a.createElement(n.EuiLink,{"data-test-subj":"threatTacticLink",href:e.tactic.reference,target:"_blank"},null!=a?a.label:`${e.tactic.name} (${e.tactic.id})`),i.a.createElement(n.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},e.technique&&e.technique.map(((e,t)=>{var a;const r=o.find((t=>t.id===e.id));return i.a.createElement(n.EuiFlexItem,{key:null!==(a=null==r?void 0:r.id)&&void 0!==a?a:t},i.a.createElement(p,{"data-test-subj":"threatTechniqueLink",href:e.reference,target:"_blank",iconType:c.a,size:"xs"},null!=r?r.label:`${e.name} (${e.id})`),i.a.createElement(n.EuiFlexGroup,{gutterSize:"none",alignItems:"flexStart",direction:"column"},null!=e.subtechnique&&e.subtechnique.map(((e,t)=>{var a;const n=y.find((t=>t.id===e.id));return i.a.createElement(d,{key:null!==(a=null==n?void 0:n.id)&&void 0!==a?a:t},i.a.createElement(p,{"data-test-subj":"threatSubtechniqueLink",href:e.reference,target:"_blank",iconType:c.a,size:"xs"},null!=n?n.label:`${e.name} (${e.id})`))}))))}))))})))}},1307:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(17),o=a(1138),s=a(317);const l=({label:e})=>{const t=Object(s.b)("alert_suppression_rule_details");return r.a.createElement(r.a.Fragment,null,r.a.createElement(o.a,{label:e}),t&&r.a.createElement(i.EuiToolTip,{position:"top",content:t},r.a.createElement(i.EuiIcon,{type:"warning",size:"l",color:"#BD271E",style:{marginLeft:"8px"}})))}},1308:function(e,t,a){"use strict";a.d(t,"b",(function(){return j})),a.d(t,"a",(function(){return S}));var n=a(194),r=a(45),i=a(17),o=a(2),s=a.n(o),l=a(44),c=a.n(l),u=a(142),d=a(124),p=a(218),m=a(1493),y=a(377),g=a(1417),f=a(1399),b=a(215),h=a(155),v=a(1332),E=a(1393);const x=c()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-4qbs0b-0"})(["flex:0 1 auto;",""],(({theme:e})=>`margin-top: ${e.eui.euiSizeS};`)),k=c()(i.EuiFlexGroup).withConfig({displayName:"StyledFlexGroup",componentId:"sc-4qbs0b-1"})(["height:100%;"]),w=c()(i.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-4qbs0b-2"})(["&.euiFlexItem{flex:1 0 0;overflow:hidden;}"]),j=s.a.memo((({eventId:e,eventIndex:t,isAlert:a,loading:l,handleOnEventClosed:c,promptContextId:g,ruleName:k,timestamp:w,scopeId:j,refetchFlyoutData:S,getFieldsData:O})=>{const{hasAssistantPrivilege:I}=Object(y.a)(),C=Object(v.a)({_id:e,_index:t,timestamp:w}),{refetch:M}=Object(E.a)({scopeId:j}),T=Object(o.useMemo)((()=>{var e;return null!==(e=O(u.mb))&&void 0!==e?e:[]}),[O]),_=Object(o.useCallback)((()=>{M(),S()}),[M,S]);return s.a.createElement(x,{gutterSize:"none",justifyContent:"spaceBetween",wrap:!0},s.a.createElement(i.EuiFlexItem,{grow:!1},!l&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiTitle,{size:"s"},s.a.createElement("h4",null,a&&!Object(r.isEmpty)(k)?k:f.c)),w&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(h.c,{value:new Date(w)})))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiFlexGroup,{direction:"column",alignItems:"flexEnd",gutterSize:"none"},c&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButtonIcon,{iconType:"cross","aria-label":f.b,onClick:c})),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},I&&null!=g&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(n.g,{conversationId:a?b.e:b.i,promptContextId:g})),a&&C&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiCopy,{textToCopy:(N=C,`${N}&${p.a.eventFlyout}=(preview:!(),rightPanel:(id:document-details-right,params:(id:${e},indexName:${t},scopeId:${j})))`)},(e=>s.a.createElement(i.EuiButtonEmpty,{onClick:e,iconType:"share","data-test-subj":"copy-alert-flyout-link"},f.e)))))),a&&j!==d.e.rulePreview&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(m.a,{eventId:e,assignedUserIds:T,onAssigneesUpdated:_})))));var N}));j.displayName="ExpandableEventTitle";const S=s.a.memo((({browserFields:e,event:t,scopeId:a,timelineTabType:n,isAlert:r,isDraggable:o,loading:l,detailsData:c,detailsEcsData:u,rawEventData:d,handleOnEventClosed:p,isReadOnly:m})=>t.eventId?l?s.a.createElement(i.EuiSkeletonText,{lines:10}):s.a.createElement(k,{direction:"column",gutterSize:"none"},s.a.createElement(w,{grow:!0},s.a.createElement(g.a,{browserFields:e,data:null!=c?c:[],detailsEcsData:u,id:t.eventId,isAlert:r,isDraggable:o,rawEventData:d,scopeId:a,timelineTabType:n,handleOnEventClosed:p,isReadOnly:m}))):s.a.createElement(i.EuiTextColor,{color:"subdued"},f.d)));S.displayName="ExpandableEvent"},1309:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(603),r=a.n(n);const i={macos:!0,windows:!0};function o(e){return e.includes("-")?e.substring(0,e.indexOf("-")):e}const s=({osName:e,version:t,capabilities:a})=>!(!t||!(({currentVersion:e,minVersionRequired:t="7.14.0"})=>{try{const a=o(e);return r()(t,a)}catch(a){return window&&window.console&&window.console.warn(`SecuritySolution: isVersionSupported(): Unable to determine if current version [${e}] meets minimum version [${t}]. Error: ${a.message}`),!1}})({currentVersion:t}))&&(function(e){const t=o(e);return r()("7.15.0",t)}(t)?function(e=[]){return e.includes("isolation")}(a):function(e){return(({currentOs:e,supportedOss:t=i})=>!!t[e])({currentOs:e.toLowerCase()})}(e))},1319:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return ee})),a.d(t,"d",(function(){return ae})),a.d(t,"f",(function(){return A})),a.d(t,"e",(function(){return re})),a.d(t,"g",(function(){return V})),a.d(t,"h",(function(){return se})),a.d(t,"j",(function(){return Z})),a.d(t,"c",(function(){return le})),a.d(t,"i",(function(){return pe}));var n=a(2),r=a.n(n),i=a(17),o=a(5),s=a(63),l=a(4),c=a(1371),u=a(576);const d=Object(n.memo)((({handleRefresh:e,http:t,handleCloseFlyout:a,addSuccess:d,addError:p})=>{const{navigateToApp:m}=Object(s.useKibana)().services.application,{start:y,...g}=Object(c.a)(),f=Object(n.useRef)(new AbortController);let b;!function(e){e.name="name",e.description="description"}(b||(b={}));const[h,v]=Object(n.useState)({name:"",description:""}),E=({target:e},t)=>{const{value:a}=e;v({...h,[t]:a})};Object(n.useEffect)((()=>{null!=g.result&&m(l.l,{deepLinkId:l.yc.exceptions,path:`/details/${g.result.list_id}`})}),[g,m]);const x=Object(n.useCallback)((()=>{var e;g.loading||""===h.name||(f.current=new AbortController,y({http:t,signal:f.current.signal,name:h.name,description:null!==(e=h.description)&&void 0!==e?e:""}))}),[g.loading,h.name,h.description,y,t]),k=Object(n.useCallback)((t=>{d({text:Object(u.ob)(h.name),title:u.ib}),e(),a()}),[d,a,e,h]),w=Object(n.useCallback)((e=>{var t;e.message.includes("AbortError")||null!=e&&null!==(t=e.body)&&void 0!==t&&t.message.includes("AbortError")||p(e,{title:o.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListErrorTitle",{defaultMessage:"creation error"})})}),[p]);return Object(n.useEffect)((()=>{g.loading||(null!=g&&g.result?k(g.result):null!=g&&g.error&&w(null==g?void 0:g.error))}),[null==g?void 0:g.error,g.loading,g.result,w,k]),r.a.createElement(i.EuiFlyout,{ownFocus:!0,size:"s",onClose:a,"data-test-subj":"createSharedExceptionListFlyout"},r.a.createElement(i.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(i.EuiTitle,{size:"m"},r.a.createElement("h2",{"data-test-subj":"createSharedExceptionListTitle"},u.h))),r.a.createElement(i.EuiFlyoutBody,null,r.a.createElement(i.EuiText,null,u.f),r.a.createElement(i.EuiFieldText,{placeholder:u.g,value:h.name,onChange:e=>E(e,b.name),"aria-label":"Shared exception list name","data-test-subj":"createSharedExceptionListNameInput"}),r.a.createElement(i.EuiSpacer,null),r.a.createElement(i.EuiText,null,u.d),r.a.createElement(i.EuiTextArea,{placeholder:u.e,value:h.description,onChange:e=>E(e,b.description),"aria-label":"Shared exception list description","data-test-subj":"createSharedExceptionListDescriptionInput"})),r.a.createElement(i.EuiFlyoutFooter,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{iconType:"cross",onClick:a,flush:"left"},u.a)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{"data-test-subj":"exception-lists-form-create-shared",onClick:x,disabled:""===h.name},u.c)))))}));d.displayName="CreateSharedListFlyout";var p=a(179),m=a(139),y=a(738),g=a(44),f=a.n(g),b=a(55),h=a(1420),v=a(1272);const E=f()(i.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-19zoulh-0"})(["border-right:1px solid #d3dae6;padding:"," "," "," 0;"],b.euiThemeVars.euiSizeXS,b.euiThemeVars.euiSizeS,b.euiThemeVars.euiSizeXS),x=f()(i.EuiText).withConfig({displayName:"TextContainer",componentId:"sc-19zoulh-1"})(["width:max-content;"]),k=Object(n.memo)((({title:e,badgeString:t})=>r.a.createElement(i.EuiFlexGroup,{alignItems:"center"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(x,{grow:!0,size:"xs"},`${e}:`)),r.a.createElement(E,null,r.a.createElement(i.EuiBadge,null,t)))));k.displayName="TitleBadge";var w=a(155),j=a(56),S=a.n(j);const O=o.i18n.translate("xpack.securitySolution.exceptions.commentEventLabel",{defaultMessage:"added a comment"}),I=(o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemFullLabel",{defaultMessage:"Operating System"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToEndpointListLabel",{defaultMessage:"Add endpoint exception"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToDetectionsListLabel",{defaultMessage:"Add rule exception"}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addCommentPlaceholder",{defaultMessage:"Add a new comment..."}),o.i18n.translate("xpack.securitySolution.exceptions.viewer.addToClipboard",{defaultMessage:"Comment"}));o.i18n.translate("xpack.securitySolution.exceptions.clearExceptionsLabel",{defaultMessage:"Remove Exception List"}),o.i18n.translate("xpack.securitySolution.exceptions.fetchError",{defaultMessage:"Error fetching exception list"}),o.i18n.translate("xpack.securitySolution.exceptions.errorLabel",{defaultMessage:"Error"}),o.i18n.translate("xpack.securitySolution.exceptions.cancelLabel",{defaultMessage:"Cancel"}),o.i18n.translate("xpack.securitySolution.exceptions.modalErrorAccordionText",{defaultMessage:"Show rule reference information:"}),o.i18n.translate("xpack.securitySolution.exceptions.disassociateExceptionListError",{defaultMessage:"Failed to remove exception list"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindows",{defaultMessage:"Windows"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemMac",{defaultMessage:"macOS"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemWindowsAndMac",{defaultMessage:"Windows and macOS"}),o.i18n.translate("xpack.securitySolution.exceptions.operatingSystemLinux",{defaultMessage:"Linux"}),o.i18n.translate("xpack.securitySolution.exceptions.fetchingReferencesErrorToastTitle",{defaultMessage:"Error fetching exception references"});var C=a(1534);const M=e=>e.map((e=>({username:e.created_by,timestamp:S()(e.created_at).format("on MMM Do YYYY @ HH:mm:ss"),event:O,timelineAvatar:r.a.createElement(i.EuiAvatar,{size:"l",name:e.created_by.toUpperCase()}),children:r.a.createElement(i.EuiText,{size:"s"},e.comment),actions:r.a.createElement(C.a,{"data-test-subj":"copy-to-clipboard",text:e.comment,titleSummary:I})})));var T=a(137),_=a(922),N=a(237);const D=({referenceName:e,referenceId:t,external:a,dataTestSubj:n})=>r.a.createElement(T.k,{"data-test-subj":`linkToRuleSecuritySolutionLink${null!=n?n:""}`,deepLinkId:l.yc.rules,path:Object(N.c)(t,_.b.alerts),target:a?"_blank":void 0},e);D.displayName="LinkToRuleDetailsComponent";const A=r.a.memo(D);A.displayName="LinkToRuleDetails";var q=a(47),F=a(478);const L=f.a.span.withConfig({displayName:"StyledText",componentId:"sc-1q48q07-0"})(["font-weight:bold;color:",";"],(({theme:e})=>e.eui.euiColorDarkestShade)),R=f()(i.EuiFlexGroup).withConfig({displayName:"MyUtilities",componentId:"sc-1q48q07-1"})(["height:50px;"]),P=f.a.span.withConfig({displayName:"StyledCondition",componentId:"sc-1q48q07-2"})(["display:inline-block !important;vertical-align:middle !important;line-height:1;"]),z=({dataTestSubj:e,pagination:t,lastUpdated:a,exceptionsTitle:n})=>{const{pageSize:o,totalItemCount:s}=t;return r.a.createElement(R,{alignItems:"center",justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(F.a,null,r.a.createElement(F.d,null,r.a.createElement(F.c,null,r.a.createElement(F.e,{dataTestSubj:`${e}ShowingText`},r.a.createElement(q.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.paginationDetails",defaultMessage:"Showing {partOne} of {partTwo}",values:{partOne:r.a.createElement(L,null,`1-${Math.min(o,s)}`),partTwo:r.a.createElement(L,null,`${s}`)}})),n&&r.a.createElement(L,{"data-test-subj":`${e}exceptionsTitle`},n))))),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiText,{size:"s","data-test-subj":`${e}LastUpdated`},r.a.createElement(q.FormattedMessage,{id:"xpack.securitySolution.exceptions.viewer.lastUpdated",defaultMessage:"Updated {updated}",values:{updated:r.a.createElement(P,null,r.a.createElement(w.b,{value:a,tooltipAnchorClassName:"eui-textTruncate"}))}}))))};z.displayName="ExceptionsUtilityComponent";const B=r.a.memo(z);B.displayName="ExceptionsUtility";var G=a(1372),$=a(1159);const H=({isReadOnly:e,exceptions:t,listType:a,lastUpdated:i,pagination:o,emptyViewerTitle:s,emptyViewerBody:l,emptyViewerButtonText:c,viewerStatus:u,ruleReferences:d,hideUtility:p=!1,onDeleteException:g,onEditExceptionItem:f,onPaginationChange:b,onCreateExceptionListItem:h})=>{const v=Object($.a)("crudEndpointExceptions"),E=Object(n.useMemo)((()=>a===m.b.ENDPOINT?G.c:G.d),[a]),x=Object(n.useMemo)((()=>a===m.b.ENDPOINT?G.a:G.b),[a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.c,{viewerStatus:u,listType:a,ruleReferences:d,isReadOnly:e||!v,exceptions:t,emptyViewerTitle:s,emptyViewerBody:l,emptyViewerButtonText:c,pagination:o,lastUpdated:i,editActionLabel:E,deleteActionLabel:x,onPaginationChange:b,onEditExceptionItem:f,onDeleteException:g,getFormattedComments:M,securityLinkAnchorComponent:A,formattedDateComponent:w.a,onCreateExceptionListItem:h,exceptionsUtilityComponent:()=>p?null:r.a.createElement(B,{exceptionsTitle:G.e,pagination:o,lastUpdated:i})}))};H.displayName="ListExceptionItemsComponent";const V=r.a.memo(H);V.displayName="ListExceptionItems";var U=a(1437),W=a(1376),Y=a(1527);const Z=Object(n.memo)((({linkedRules:e,showButtonLoader:t,saveIsDisabled:a=!0,onSave:n,onCancel:o,onRuleSelectionChange:s})=>{const l=Object(i.useGeneratedHtmlId)({prefix:"complicatedFlyoutTitle"});return r.a.createElement(i.EuiFlyout,{hideCloseButton:!0,ownFocus:!0,onClose:o,"aria-labelledby":l},r.a.createElement(i.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(i.EuiTitle,{size:"m"},r.a.createElement("h2",{id:l},u.V)),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiText,{size:"s",color:"subdued"},u.Y)),r.a.createElement(i.EuiFlyoutBody,null,r.a.createElement(Y.a,{initiallySelectedRules:e,onRuleSelectionChange:s})),r.a.createElement(i.EuiFlyoutFooter,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{onClick:o,flush:"left"},u.X)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{"data-test-subj":"manageListRulesSaveButton",isLoading:t,disabled:a,onClick:n,fill:!0},u.Z)))))}));Z.displayName="ManageRules";var K=a(1378);const Q=p.css`
  z-index: 100;
  .euiAccordion__buttonContent {
    cursor: pointer;
    width: 100%;
  }
`,X=f()(i.EuiPanel).withConfig({displayName:"ExceptionPanel",componentId:"sc-11ogn3z-0"})(["margin:-"," "," 0 ",";"],b.euiThemeVars.euiSizeS,b.euiThemeVars.euiSizeM,b.euiThemeVars.euiSizeM),J=f()(i.EuiFlexGroup).withConfig({displayName:"ListHeaderContainer",componentId:"sc-11ogn3z-1"})(["padding:",";text-align:initial;"],b.euiThemeVars.euiSizeS),ee=Object(n.memo)((({exceptionsList:e,handleDelete:t,handleExport:a,handleDuplicate:n,readOnly:o})=>{const{linkedRules:s,showManageRulesFlyout:l,showManageButtonLoader:c,disableManageButton:d,onManageRules:p,onSaveManageRules:g,onCancelManageRules:f,onRuleSelectionChange:b}=Object(U.a)(e.list_id),{listId:E,listName:x,listType:w,createdAt:j,createdBy:S,exceptions:O,pagination:I,ruleReferences:C,toggleAccordion:M,openAccordionId:T,menuActionItems:_,listDescription:N,exceptionItemsCount:D,onEditExceptionItem:A,onDeleteException:q,onPaginationChange:F,setToggleAccordion:L,exceptionViewerStatus:R,showAddExceptionFlyout:P,showEditExceptionFlyout:z,exceptionToEdit:B,onAddExceptionClick:G,handleConfirmExceptionFlyout:$,handleCancelExceptionItemFlyout:H,goToExceptionDetail:Y,emptyViewerTitle:ee,emptyViewerBody:te,emptyViewerButtonText:ae,handleCancelExpiredExceptionsModal:ne,handleConfirmExpiredExceptionsModal:re,showIncludeExpiredExceptionsModal:ie}=Object(W.a)({exceptionsList:e,handleExport:a,handleDelete:t,handleDuplicate:n,handleManageRules:p});return r.a.createElement(i.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiPanel,{hasShadow:!1},r.a.createElement(i.EuiAccordion,{buttonProps:{className:Q},id:T,arrowDisplay:"none",onToggle:()=>L(!M),buttonContent:r.a.createElement(i.EuiPanel,null,r.a.createElement(J,{gutterSize:"m",alignItems:"flexStart"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonIcon,{iconType:M?"arrowDown":"arrowRight","aria-label":"Next"})),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFlexGroup,{direction:"column",key:E,alignItems:"flexStart",gutterSize:"none"},r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiText,{size:"m"},r.a.createElement(i.EuiLink,{"data-test-subj":"exception-list-name",onClick:Y},x))),r.a.createElement(i.EuiFlexItem,{grow:!0},r.a.createElement(i.EuiText,{size:"xs"},r.a.createElement(i.EuiTextColor,{color:"subdued"},N))))),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFlexGroup,{alignItems:"center"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(k,{title:u.i,badgeString:j})),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(k,{title:u.b,badgeString:S})),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(k,{title:u.l,badgeString:D})),r.a.createElement(i.EuiFlexItem,{"data-test-subj":"exceptionListCardLinkedRulesBadge"},r.a.createElement(k,{title:u.fb,badgeString:s.length.toString()})),r.a.createElement(i.EuiFlexItem,null,r.a.createElement(y.e,{disableActions:o,dataTestSubj:"sharedListOverflowCard",actions:_})))))),"data-test-subj":`exceptionsManagementListCard-${E}`},r.a.createElement(X,{hasBorder:!0},r.a.createElement(V,{isReadOnly:o,exceptions:O,listType:e.type,pagination:I,hideUtility:!0,viewerStatus:R,ruleReferences:C,onDeleteException:q,onEditExceptionItem:A,onPaginationChange:F,onCreateExceptionListItem:G,lastUpdated:null,emptyViewerTitle:ee,emptyViewerBody:te,emptyViewerButtonText:ae}))))),P?r.a.createElement(v.a,{rules:null,isBulkAction:!1,isEndpointItem:w===m.b.ENDPOINT,sharedListToAddTo:[e],onCancel:H,onConfirm:$,"data-test-subj":"addExceptionItemFlyoutInSharedLists",showAlertCloseOptions:!1}):null,z&&B?r.a.createElement(h.a,{list:e,itemToEdit:B,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:H,onConfirm:$,"data-test-subj":"editExceptionItemFlyoutInSharedLists"}):null,l?r.a.createElement(Z,{linkedRules:s,showButtonLoader:c,saveIsDisabled:d,onSave:g,onCancel:f,onRuleSelectionChange:b}):null,ie?r.a.createElement(K.b,{handleCloseModal:ne,onModalConfirm:re,action:ie}):null)}));ee.displayName="ExceptionsListCard";var te=a(1379);const ae=r.a.memo((({handleRefresh:e,http:t,addSuccess:a,addError:o,setDisplayImportListFlyout:s})=>{var l;const c=Object(n.useRef)(null),d=Object(i.useGeneratedHtmlId)({prefix:"filePicker"}),[p,m]=Object(n.useState)(null),[y,g]=Object(n.useState)(!1),[f,b]=Object(n.useState)(!1),[h,v]=Object(n.useState)(!1),E=Object(n.useCallback)((()=>{var e;null!==(e=c.current)&&void 0!==e&&e.fileInput&&(c.current.fileInput.value="",c.current.handleChange()),m(null),v(!1),b(!1),g(!1)}),[]),{start:x,...k}=Object(te.a)(),w=Object(n.useRef)(new AbortController),j=Object(n.useCallback)((()=>{!k.loading&&p&&(w.current=new AbortController,Array.from(p).forEach((e=>x({file:e,http:t,signal:w.current.signal,overwrite:y,overwriteExceptions:y,asNewList:f}))))}),[f,p,t,x,k.loading,y]),S=Object(n.useCallback)((t=>{E(),a({title:u.lb}),e()}),[E,a,e]),O=Object(n.useCallback)((e=>{e.forEach((e=>{e.error.message.includes("AbortError")||o(e.error.message,{title:u.kb})}))}),[o]);Object(n.useEffect)((()=>{var e;if(!k.loading)if(null!=k&&null!==(e=k.result)&&void 0!==e&&e.success)S(null==k?void 0:k.result);else{var t,a;const e=[];var n,r;null!=k&&null!==(t=k.error)&&void 0!==t&&t.body&&e.push({error:{...null==k||null===(n=k.error)||void 0===n?void 0:n.body}}),null!=k&&null!==(a=k.result)&&void 0!==a&&a.errors&&(null==k||null===(r=k.result)||void 0===r||r.errors.forEach((t=>{t.error.message.includes("already exists")&&v(!0),e.push(t)}))),O(e)}}),[O,S,null==k?void 0:k.error,k.loading,null==k?void 0:k.result,null==k||null===(l=k.result)||void 0===l?void 0:l.errors]);const I=Object(n.useCallback)((e=>{m(null!=e?e:null)}),[]);return r.a.createElement(i.EuiFlyout,{ownFocus:!0,size:"s",onClose:()=>s(!1)},r.a.createElement(i.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(i.EuiTitle,{size:"m"},r.a.createElement("h2",null,u.R))),r.a.createElement(i.EuiFlyoutBody,null,r.a.createElement(i.EuiText,null,u.Q),r.a.createElement(i.EuiFilePicker,{id:d,multiple:!0,ref:c,initialPromptText:u.U,onChange:I,display:"large","aria-label":"Use aria labels when no actual label is in use"}),h&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,null),r.a.createElement(i.EuiTextColor,{color:"danger"},u.T),r.a.createElement(i.EuiSpacer,null),r.a.createElement(i.EuiCheckbox,{id:"basicCheckboxId",label:u.S,checked:y,"data-test-subj":"importExceptionListOverwriteExistingCheckbox",onChange:e=>{g(!y),b(!1)}}),r.a.createElement(i.EuiCheckbox,{id:"createNewListCheckbox",label:u.P,"data-test-subj":"importExceptionListCreateNewCheckbox",checked:f,onChange:e=>{b(!f),g(!1)}}))),r.a.createElement(i.EuiFlyoutFooter,null,r.a.createElement(i.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{"data-test-subj":"exceptionListsImportFormCloseBTN",iconType:"cross",onClick:()=>s(!1),flush:"left"},u.a)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{"data-test-subj":"exception-lists-form-import-action",onClick:j,disabled:null==p||k.loading},u.jb)))))})),ne=({linkTitle:e,listId:t,external:a,dataTestSubj:n})=>r.a.createElement(T.k,{"data-test-subj":`linkToRuleSecuritySolutionLink${null!=n?n:""}`,deepLinkId:l.yc.exceptions,path:`/details/${t}`,target:a?"_blank":void 0},e);ne.displayName="LinkToListDetailsComponent";const re=r.a.memo(ne);re.displayName="LinkToListDetails";var ie=a(1380);const oe=({list:e,isReadOnly:t,refreshExceptions:a})=>{const{listName:n,exceptions:o,listType:s,lastUpdated:l,pagination:c,emptyViewerTitle:d,emptyViewerBody:p,emptyViewerButtonText:g,viewerStatus:f,ruleReferences:b,showAddExceptionFlyout:E,showEditExceptionFlyout:x,exceptionToEdit:k,exceptionViewerStatus:w,onSearch:j,onAddExceptionClick:S,onDeleteException:O,onEditExceptionItem:I,onPaginationChange:C,handleCancelExceptionItemFlyout:M,handleConfirmExceptionFlyout:T}=Object(ie.a)(e,a);return r.a.createElement(r.a.Fragment,null,E?r.a.createElement(v.a,{rules:null,isBulkAction:!1,isEndpointItem:s===m.b.ENDPOINT,sharedListToAddTo:[e],onCancel:M,onConfirm:T,"data-test-subj":"addExceptionItemFlyoutInList",showAlertCloseOptions:!1}):f===y.i.EMPTY||f===y.i.LOADING?r.a.createElement(y.a,{isReadOnly:t,viewerStatus:f,onEmptyButtonStateClick:S,title:u.B,body:u.y(n),buttonText:u.z}):r.a.createElement(i.EuiPanel,{hasBorder:!1,hasShadow:!1},r.a.createElement(r.a.Fragment,null,x&&k&&r.a.createElement(h.a,{list:e,itemToEdit:k,showAlertCloseOptions:!0,openedFromListDetailPage:!0,onCancel:M,onConfirm:T,"data-test-subj":"editExceptionItemFlyoutInList"}),r.a.createElement(y.g,{addExceptionButtonText:s===m.b.ENDPOINT?u.x:u.w,listType:s,onSearch:j,onAddExceptionClick:S,isSearching:f===y.i.SEARCHING,isButtonFilled:!1,buttonIconType:"plusInCircle"}),r.a.createElement(V,{viewerStatus:w,listType:s,ruleReferences:b,isReadOnly:t,exceptions:o,emptyViewerTitle:d,emptyViewerBody:p,emptyViewerButtonText:g,pagination:c,lastUpdated:l,onPaginationChange:C,onEditExceptionItem:I,onDeleteException:O,onCreateExceptionListItem:S}))))};oe.displayName="ListWithSearchComponent";const se=r.a.memo(oe);se.displayName="ListWithSearch";const le=({onRefresh:e,totalExceptionLists:t,setSort:a,sort:n,sortFields:o})=>{var s;const l=null==o?void 0:o.find((e=>e.field===(null==n?void 0:n.field)));return r.a.createElement(F.a,{border:!0},r.a.createElement(F.d,null,r.a.createElement(F.c,null,r.a.createElement(F.e,{dataTestSubj:"showingExceptionLists"},u.gb(t))),r.a.createElement(F.c,null,r.a.createElement(F.b,{dataTestSubj:"refreshRulesAction",iconSide:"left",iconType:"refresh",onClick:e},u.eb))),r.a.createElement(F.d,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(F.c,null,n&&r.a.createElement(F.b,{dataTestSubj:"sortExceptions",iconSide:"right",iconType:"asc"===n.order?"sortUp":"sortDown",popoverPanelPaddingSize:"s",popoverContent:()=>r.a.createElement(i.EuiContextMenuPanel,{size:"s",items:null==o?void 0:o.map((e=>{const t=(null==l?void 0:l.field)===e.field;let o=e.defaultOrder;return t&&(o="asc"===n.order?"desc":"asc"),r.a.createElement(i.EuiContextMenuItem,{key:e.field,onClick:()=>null==a?void 0:a({field:e.field,order:o})},r.a.createElement(ce,null,e.label," ",(null==l?void 0:l.field)===e.field&&r.a.createElement(ue,{type:"asc"===n.order?"sortUp":"sortDown"})))}))})},r.a.createElement(ce,null,u.hb," ",null==o||null===(s=o.find((e=>e.field===n.field)))||void 0===s?void 0:s.label))))))},ce=f()("div").withConfig({displayName:"SortMenuItem",componentId:"sc-1h5b7pp-0"})(["display:flex;align-items:center;"]),ue=f()(i.EuiIcon).withConfig({displayName:"SortIcon",componentId:"sc-1h5b7pp-1"})(["margin-left:8px;"]);le.displayName="ExceptionsTableUtilityBar";const de={strict:!0,fields:{created_by:{type:"string"},name:{type:"string"},type:{type:"string"},list_id:{type:"string"},tags:{type:"string"}}},pe=r.a.memo((({onSearch:e})=>r.a.createElement(i.EuiSearchBar,{"data-test-subj":"exceptionsHeaderSearch","aria-label":u.m,onChange:e,box:{"data-test-subj":"exceptionsHeaderSearchInput",placeholder:u.D,incremental:!1,schema:de}})));pe.displayName="ListsSearchBar"},1320:function(e,t,a){"use strict";a.d(t,"a",(function(){return V}));var n=a(2),r=a.n(n),i=a(17),o=a(49),s=a(152),l=a(1162),c=a(1554),u=a(1271),d=a(5),p=a(1434),m=a(23),y=a.n(m);const g=Object(n.memo)((e=>{const t=Object(n.useRef)(null),a=r.a.createElement(i.EuiButton,y()({buttonRef:t},e));return Object(n.useEffect)((()=>{t.current&&t.current.focus()}),[]),a}));g.displayName="AutoFocusButton";var f=a(115),b=a(1106),h=a(110),v=a(746);const E=Object.freeze({deleteActionFailure:(e,t)=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionFailure",{defaultMessage:'Unable to remove "{itemName}". Reason: {errorMessage}',values:{itemName:e,errorMessage:t}}),deleteActionSuccess:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteActionSuccess",{defaultMessage:'"{itemName}" has been removed',values:{itemName:e}})}),x=Object.freeze({deleteModalTitle:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalTitle",{defaultMessage:"Delete {itemName}",values:{itemName:e}}),deleteModalImpactTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactTitle",{defaultMessage:"Warning"}),deleteModalImpactInfo:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfo",{defaultMessage:"Deleting this entry will remove it from {count} associated {count, plural, one {policy} other {policies}}.",values:{count:Object(b.e)(e)?d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalImpactInfoAll",{defaultMessage:"all"}):Object(b.c)(e).length}}),deleteModalConfirmInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalConfirmInfo",{defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"}),deleteModalSubmitButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalSubmitButtonTitle",{defaultMessage:"Delete"}),deleteModalCancelButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.deleteModalCancelButtonTitle",{defaultMessage:"Cancel"})}),k=Object(n.memo)((({apiClient:e,item:t,onCancel:a,onSuccess:o,"data-test-subj":s,labels:l})=>{const c=Object(f.a)(s),{deleteArtifactItem:u,isLoading:d}=((e,t,a)=>{const r=Object(h.m)(),i=Object(v.c)(e,{onError:e=>{var n;r.addDanger(a.deleteActionFailure(t.name,(null===(n=e.body)||void 0===n?void 0:n.message)||e.message))},onSuccess:e=>{r.addSuccess(a.deleteActionSuccess(e.name))}});return Object(n.useMemo)((()=>({...i,deleteArtifactItem:i.mutateAsync})),[i])})(e,t,l),p=Object(n.useCallback)((()=>{u(t).then((()=>o()))}),[u,t,o]),m=Object(n.useCallback)((()=>{d||a()}),[d,a]);return r.a.createElement(i.EuiModal,{onClose:m,"data-test-subj":s},r.a.createElement(i.EuiModalHeader,{"data-test-subj":c("header")},r.a.createElement(i.EuiModalHeaderTitle,null,l.deleteModalTitle(t.name))),r.a.createElement(i.EuiModalBody,{"data-test-subj":c("body")},r.a.createElement(i.EuiText,null,r.a.createElement(i.EuiCallOut,{"data-test-subj":c("impactCallout"),title:l.deleteModalImpactTitle,color:"danger",iconType:"warning"},r.a.createElement("p",{"data-test-subj":c("impactCalloutInfo")},l.deleteModalImpactInfo(t))),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement("p",null,l.deleteModalConfirmInfo))),r.a.createElement(i.EuiModalFooter,null,r.a.createElement(i.EuiButtonEmpty,{onClick:m,isDisabled:d,"data-test-subj":c("cancelButton")},l.deleteModalCancelButtonTitle),r.a.createElement(g,{fill:!0,color:"danger",onClick:p,isLoading:d,isDisabled:d,"data-test-subj":c("submitButton")},l.deleteModalSubmitButtonTitle)))}));k.displayName="ArtifactDeleteModal";const w=Object.freeze({pageTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.pageTitle",{defaultMessage:"Artifact"}),pageAboutInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.aboutInfo",{defaultMessage:"A list of artifacts for endpoint"}),pageAddButtonTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.addButtonTitle",{defaultMessage:"Add artifact"}),emptyStateTitleNoEntries:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateTitleNoEntries",{defaultMessage:"There are no entries to display."}),emptyStateTitle:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateTitle",{defaultMessage:"Add your first artifact"}),emptyStateInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStateInfo",{defaultMessage:"Add an artifact"}),emptyStatePrimaryButtonLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.emptyStatePrimaryButtonLabel",{defaultMessage:"Add"}),searchPlaceholderInfo:d.i18n.translate("xpack.securitySolution.artifactListPage.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"}),getShowingCountLabel:e=>d.i18n.translate("xpack.securitySolution.artifactListPage.showingTotal",{defaultMessage:"Showing {total, plural, one {# artifact} other {# artifacts}}",values:{total:e}}),cardActionEditLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionEditLabel",{defaultMessage:"Edit artifact"}),cardActionDeleteLabel:d.i18n.translate("xpack.securitySolution.artifactListPage.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),...p.a,...x,...E});var j=a(1150),S=a(1427),O=a(1164),I=a(880),C=a(44),M=a.n(C),T=a(1098);const _=M()(i.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-1flznkw-0"})(["",""],(()=>Object(C.css)(["max-width:100%;"]))),N=Object(n.memo)((({onAdd:e,isAddDisabled:t=!1,backComponent:a,"data-test-subj":n,titleLabel:o,titleNoEntriesLabel:s,aboutInfo:l,primaryButtonLabel:c,secondaryAboutInfo:u,canCreateItems:d=!0})=>{const p=Object(f.a)(n);return r.a.createElement(T.a,null,d?r.a.createElement(_,{"data-test-subj":n,iconType:"plusInCircle",title:r.a.createElement("h2",{"data-test-subj":p("title")},o),body:r.a.createElement("div",{"data-test-subj":p("aboutInfo")},l,u?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,{size:"m"}),u):void 0),actions:[r.a.createElement(i.EuiButton,{fill:!0,isDisabled:t,onClick:e,"data-test-subj":p("addButton")},c),...a?[a]:[]]}):r.a.createElement(_,{"data-test-subj":n,iconType:"iInCircle",title:r.a.createElement("h2",{"data-test-subj":p("title-no-entries")},s)}))}));N.displayName="NoDataEmptyState";var D=a(1481),A=a(1385),q=a(50),F=a(178),L=a(530),R=a(1381),P=a(876);var z=a(531),B=a(47),G=a(733);const $=Object(n.memo)((({backButtonLabel:e,backButtonUrl:t,onBackButtonNavigateTo:a,...n})=>{const o=Object(G.a)(...a);return r.a.createElement(i.EuiButtonEmpty,y()({},n,{"data-test-subj":"backToOrigin",size:"s",href:t,onClick:o,textProps:{className:"text"}}),e||r.a.createElement(B.FormattedMessage,{id:"xpack.securitySolution.list.backButton",defaultMessage:"Back"}))}));$.displayName="BackToExternalAppSecondaryButton";var H=a(1294);const V=Object(n.memo)((({apiClient:e,ArtifactFormComponent:t,searchableFields:a=z.c,labels:d={},secondaryPageInfo:m,onFormSubmit:y,flyoutSize:g,"data-test-subj":b,allowCardEditAction:E=!0,allowCardCreateAction:x=!0,allowCardDeleteAction:C=!0})=>{var M,T;const{state:_}=Object(o.useLocation)(),B=Object(f.a)(b),G=Object(h.m)(),V=Object(s.b)(),U=Object(D.a)(E,x),W=Object(A.a)(),{urlParams:{filter:Y,includedPolicies:Z}}=Object(L.a)(),{isPageInitializing:K,isFetching:Q,data:X,uiPagination:J,doesDataExist:ee,error:te,refetch:ae}=((e,t)=>{const a=Object(s.b)(),{urlParams:{filter:r,includedPolicies:i}}=Object(L.a)(),{pagination:{page:o,pageSize:l}}=Object(P.b)(),c=((e,t,a)=>Object(n.useMemo)((()=>Object(R.a)({kuery:Object(R.b)(e,t),policies:a?a.split(","):[]})),[t,e,a]))(r,t,i),{data:u,isFetching:d,refetch:p}=Object(q.useQuery)(["does-data-exists",e],(async()=>e.hasData()),{enabled:!0,keepPreviousData:!0,refetchOnWindowFocus:!1}),[m,y]=Object(n.useState)({totalItemCount:0,pageSize:l,pageSizeOptions:[...F.f],pageIndex:o-1}),[g,f]=Object(n.useState)(!0),b=Object(v.e)(e,{page:o,perPage:l,filter:r,policies:i?i.split(","):[]},t),{data:h,isFetching:E,error:x,isSuccess:k}=b;return Object(n.useEffect)((()=>{a()&&g&&!d&&f(!1)}),[d,a,g]),Object(n.useEffect)((()=>{a()&&h&&!E&&k&&y((e=>({...e,pageIndex:h.page-1,pageSize:h.per_page,totalItemCount:h.total})))}),[E,a,k,h]),Object(n.useEffect)((()=>{!a()||E||d||x||"1"!==String(o)||c||!(h&&0===h.total&&u||h&&h.total>0&&!u)||p()}),[p,u,r,i,d,E,a,c,h,x,o]),Object(n.useMemo)((()=>({isPageInitializing:g,doesDataExist:null!=u&&u,uiPagination:m,...b})),[u,g,b,m])})(e,a);Object(n.useEffect)((()=>{var e;!Q&&te&&G.addDanger((null==te||null===(e=te.body)||void 0===e?void 0:e.message)||te.message)}),[te,G,Q]);const ne=Object(n.useMemo)((()=>{var e;return null!==(e=null==X?void 0:X.data)&&void 0!==e?e:[]}),[null==X?void 0:X.data]),[re,ie]=Object(n.useState)(void 0),[oe,se]=Object(n.useState)(void 0),le=Object(n.useMemo)((()=>({...w,...d})),[d]),ce=(({items:e,onAction:t,cardActionDeleteLabel:a,cardActionEditLabel:r,dataTestSubj:i,allowCardDeleteAction:o=!0,allowCardEditAction:s=!0})=>{const l=Object(f.a)(i),c=Object(h.m)(),{data:d}=Object(O.c)({onError:e=>{c.addDanger(Object(I.b)(e))}}),p=Object(u.f)(null==d?void 0:d.items),m=Object(n.useMemo)((()=>{const n={};for(const c of e){const e=[];s&&e.push({icon:"controlsHorizontal",onClick:()=>{t({type:"edit",item:c})},"data-test-subj":l("cardEditAction"),children:r}),o&&e.push({icon:"trash",onClick:()=>{t({type:"delete",item:c})},"data-test-subj":l("cardDeleteAction"),children:a}),n[c.id]={item:c,policies:p,"data-test-subj":i,actions:e.length>0?e:void 0,hideDescription:!c.description,hideComments:!c.comments.length}}return n}),[e,s,o,p,i,l,r,t,a]);return Object(n.useCallback)((e=>m[e.id]),[m])})({items:ne,onAction:Object(n.useCallback)((({type:e,item:t})=>{switch(e){case"edit":se(t),W({show:"edit",itemId:t.item_id});break;case"delete":ie(t)}}),[W]),cardActionDeleteLabel:le.cardActionDeleteLabel,cardActionEditLabel:le.cardActionEditLabel,dataTestSubj:B("card"),allowCardDeleteAction:C,allowCardEditAction:E}),ue=Object(O.c)({perPage:1e3,onError:e=>{G.addWarning(Object(I.b)(e))}}),de=function(e){const[t,a]=Object(n.useState)();return Object(n.useEffect)((()=>{e&&e.onBackButtonNavigateTo&&a(e)}),[e]),t}(_),pe=Object(n.useMemo)((()=>{if(de&&de.onBackButtonNavigateTo)return r.a.createElement($,de)}),[de]),me=Object(n.useMemo)((()=>{if(de&&de.onBackButtonNavigateTo)return r.a.createElement(H.a,de)}),[de]),ye=Object(n.useCallback)((()=>{W({show:"create"})}),[W]),ge=Object(n.useCallback)((({pageIndex:e,pageSize:t})=>{W({page:e+1,pageSize:t}),window.scrollTo({top:0,left:0,behavior:"smooth"})}),[W]),fe=Object(n.useCallback)(((e,t,a)=>{const n=e!==(null!=Y?Y:"")||t!==(null!=Z?Z:"");W({filter:""===e.trim()?void 0:e,includedPolicies:""===t.trim()?void 0:t}),a&&!n&&ae()}),[Y,Z,ae,W]),be=Object(n.useCallback)((()=>{V()&&(ie(void 0),ae())}),[V,ae]),he=Object(n.useCallback)((()=>{ie(void 0)}),[]),ve=Object(n.useCallback)((()=>{se(void 0),ae()}),[ae]),Ee=Object(n.useCallback)((()=>{se(void 0)}),[]),xe=Object(n.useMemo)((()=>{const e=le.pageAboutInfo?r.a.createElement("span",{"data-test-subj":"header-panel-subtitle"},le.pageAboutInfo):void 0,t=m?r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,{size:"m"}),m):void 0;return r.a.createElement(r.a.Fragment,null,e,t)}),[le.pageAboutInfo,m]);return K?r.a.createElement(j.a,{"data-test-subj":B("pageLoader")}):r.a.createElement(l.a,{headerBackComponent:me,hideHeader:!ee,title:le.pageTitle,subtitle:xe,actions:x&&r.a.createElement(i.EuiButton,{fill:!0,iconType:"plusInCircle",isDisabled:U,onClick:ye,"data-test-subj":B("pageAddButton")},le.pageAddButtonTitle),"data-test-subj":B("container")},U&&r.a.createElement(p.b,{apiClient:e,item:oe,onSuccess:ve,onClose:Ee,FormComponent:t,labels:le,size:g,submitHandler:y,policies:(null===(M=ue.data)||void 0===M?void 0:M.items)||[],policiesIsLoading:ue.isLoading,"data-test-subj":B("flyout")}),re&&r.a.createElement(k,{apiClient:e,item:re,labels:le,"data-test-subj":B("deleteModal"),onSuccess:be,onCancel:he}),ee?r.a.createElement(r.a.Fragment,null,r.a.createElement(S.a,{defaultValue:Y,onSearch:fe,placeholder:le.searchPlaceholderInfo,hasPolicyFilter:!0,policyList:null===(T=ue.data)||void 0===T?void 0:T.items,defaultIncludedPolicies:Z}),r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(i.EuiText,{color:"subdued",size:"xs","data-test-subj":B("showCount")},le.getShowingCountLabel(J.totalItemCount)),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(c.a,{items:ne,ItemComponent:u.a,itemComponentProps:ce,onChange:ge,error:te,loading:Q,pagination:J,contentClassName:"card-container","data-test-subj":B("list")})):r.a.createElement(N,{onAdd:ye,titleNoEntriesLabel:le.emptyStateTitleNoEntries,titleLabel:le.emptyStateTitle,aboutInfo:le.emptyStateInfo,primaryButtonLabel:le.emptyStatePrimaryButtonLabel,backComponent:pe,"data-test-subj":B("emptyState"),secondaryAboutInfo:m,canCreateItems:x}))}));V.displayName="ArtifactListPage"},1322:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(2),r=a.n(n),i=a(566),o=a(1506),s=a(17),l=a(73),c=a(1441),u=a(83),d=a(50),p=a(212);const m=({connectorId:e,subAction:t,subActionParams:a})=>{const{http:n}=Object(p.b)().services;return Object(d.useMutation)({mutationKey:["executeSubAction",e,t,a],mutationFn:()=>Object(u.executeAction)({id:e,params:{subAction:t,subActionParams:a},http:n})})};var y=a(1120),g=a(892);const f=r.a.memo((({sentinelOneAgentId:e,hostName:t,cancelCallback:a,successCallback:i})=>{const{data:o}=Object(c.a)({actionTypeId:l.SENTINELONE_CONNECTOR_ID}),u=Object(n.useMemo)((()=>null==o?void 0:o[0]),[o]),[d,p]=Object(n.useState)(!1),{mutateAsync:f,isLoading:b}=m({connectorId:null==u?void 0:u.id,subAction:l.SUB_ACTION.ISOLATE_HOST,subActionParams:{uuid:e}}),h=Object(n.useCallback)((()=>{}),[]),v=Object(n.useCallback)((async()=>{"ok"===(await f()).status&&(p(!0),i&&i())}),[f,i]),E=Object(n.useCallback)((()=>a()),[a]),x=Object(n.useMemo)((()=>r.a.createElement(g.a,{onClick:E,buttonText:y.c})),[E]),k=Object(n.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"m"}),r.a.createElement(g.b,{hostName:t,onCancel:E,onConfirm:v,isLoading:b,onChange:h,hideCommentField:!0}))),[t,E,v,b,h]);return d?x:k}));f.displayName="IsolateSentinelOneHost";const b=r.a.memo((({sentinelOneAgentId:e,hostName:t,cancelCallback:a,successCallback:i})=>{const[o,u]=Object(n.useState)(!1),{data:d}=Object(c.a)({actionTypeId:l.SENTINELONE_CONNECTOR_ID}),p=Object(n.useMemo)((()=>null==d?void 0:d[0]),[d]),{mutateAsync:f,isLoading:b}=m({connectorId:null==p?void 0:p.id,subAction:l.SUB_ACTION.RELEASE_HOST,subActionParams:{uuid:e}}),h=Object(n.useCallback)((async()=>{"ok"===(await f()).status&&(u(!0),i&&i())}),[i,f]),v=Object(n.useCallback)((()=>{}),[]),E=Object(n.useCallback)((()=>a()),[a]),x=Object(n.useMemo)((()=>r.a.createElement(g.a,{onClick:E,buttonText:y.c})),[E]),k=Object(n.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"m"}),r.a.createElement(g.d,{hostName:t,onCancel:E,onConfirm:h,onChange:v,isLoading:b,hideCommentField:!0}))),[t,E,h,v,b]);return o?x:k}));b.displayName="UnisolateSentinelOneHost";var h=a(972),v=a(47),E=a(117),x=a(553),k=a(311);const w=r.a.memo((({endpointId:e,hostName:t,casesInfo:a,cancelCallback:i,successCallback:o})=>{const[l,c]=Object(n.useState)(""),[u,d]=Object(n.useState)(!1),p=a.map((e=>e.id)),{loading:m,isolateHost:f}=(({endpointId:e,comment:t,caseIds:a})=>{const[r,i]=Object(n.useState)(!1),{addError:o}=Object(E.a)();return{loading:r,isolateHost:Object(n.useCallback)((async()=>{try{i(!0);const n=await Object(k.b)({endpointId:e,comment:t,caseIds:a&&a.length>0?a:void 0});return i(!1),!!n.action}catch(e){return i(!1),o(e.message,{title:x.b}),!1}}),[e,t,a,o])}})({endpointId:e,comment:l,caseIds:p}),b=Object(n.useCallback)((async()=>{const e=await f();d(e),e&&o&&o()}),[f,o]),h=Object(n.useCallback)((()=>i()),[i]),w=Object(n.useCallback)((({comment:e})=>c(e)),[]),j=Object(n.useMemo)((()=>a.length),[a]),S=Object(n.useMemo)((()=>r.a.createElement(g.a,{onClick:h,buttonText:y.c})),[h]),O=Object(n.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"m"}),r.a.createElement(g.b,{hostName:t,onCancel:h,onConfirm:b,onChange:w,comment:l,isLoading:m,messageAppend:r.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.impactedCases",defaultMessage:"This action will be added to {cases}.",values:{cases:r.a.createElement("b",null,Object(y.a)(j))}})}))),[t,h,b,w,l,m,j]);return u?S:O}));w.displayName="IsolateHost";const j=r.a.memo((({endpointId:e,hostName:t,casesInfo:a,cancelCallback:i,successCallback:o})=>{const[l,c]=Object(n.useState)(""),[u,d]=Object(n.useState)(!1),p=a.map((e=>e.id)),{loading:m,unIsolateHost:f}=(({endpointId:e,comment:t,caseIds:a})=>{const[r,i]=Object(n.useState)(!1),{addError:o}=Object(E.a)();return{loading:r,unIsolateHost:Object(n.useCallback)((async()=>{try{i(!0);const n=await Object(k.c)({endpointId:e,comment:t,caseIds:a&&a.length>0?a:void 0});return i(!1),!!n.action}catch(e){return i(!1),o(e.message,{title:x.b}),!1}}),[e,t,a,o])}})({endpointId:e,comment:l,caseIds:p}),b=Object(n.useCallback)((async()=>{const e=await f();d(e),e&&o&&o()}),[o,f]),h=Object(n.useCallback)((()=>i()),[i]),w=Object(n.useCallback)((({comment:e})=>c(e)),[]),j=Object(n.useMemo)((()=>a.length),[a]),S=Object(n.useMemo)((()=>r.a.createElement(g.a,{onClick:h,buttonText:y.c})),[h]),O=Object(n.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"m"}),r.a.createElement(g.d,{hostName:t,onCancel:h,onConfirm:b,onChange:w,comment:l,isLoading:m,messageAppend:r.a.createElement(v.FormattedMessage,{id:"xpack.securitySolution.detections.hostIsolation.impactedCases",defaultMessage:"This action will be added to {cases}.",values:{cases:r.a.createElement("b",null,Object(y.a)(j))}})}))),[t,h,b,w,l,m,j]);return u?S:O}));j.displayName="UnisolateHost";const S=r.a.memo((({details:e,cancelCallback:t,successCallback:a,isolateAction:s})=>{const l=Object(n.useMemo)((()=>Object(h.a)({category:"agent",field:"agent.id"},e)),[e]),c=Object(n.useMemo)((()=>Object(i.b)(e)),[e]),u=Object(n.useMemo)((()=>Object(h.a)({category:"host",field:"host.name"},e)),[e]),d=Object(n.useMemo)((()=>Object(h.a)({category:"_id",field:"_id"},e)),[e]),{casesInfo:p}=Object(o.a)({alertId:d});return c?"isolateHost"===s?r.a.createElement(f,{sentinelOneAgentId:c,hostName:u,cancelCallback:t,successCallback:a}):r.a.createElement(b,{sentinelOneAgentId:c,hostName:u,cancelCallback:t,successCallback:a}):"isolateHost"===s?r.a.createElement(w,{endpointId:l,hostName:u,casesInfo:p,cancelCallback:t,successCallback:a}):r.a.createElement(j,{endpointId:l,hostName:u,casesInfo:p,cancelCallback:t,successCallback:a})}));S.displayName="HostIsolationContent"},1323:function(e,t,a){"use strict";a.d(t,"a",(function(){return q}));var n=a(17),r=a(2),i=a.n(r),o=a(9),s=a(272),l=a(877),c=a(741);const u=e=>Object(c.e)(e)?l.j:l.g,d=({type:e})=>i.a.createElement(n.EuiToolTip,{content:u(e)},i.a.createElement(n.EuiIcon,{type:"iInCircle",size:"m"}));var p=a(44),m=a.n(p);const y=m.a.div.withConfig({displayName:"OverflowParent",componentId:"sc-sjnml3-0"})(["display:inline-grid;"]),g=m.a.div.withConfig({displayName:"OverflowContainer",componentId:"sc-sjnml3-1"})(["white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-weight:bold;"]),f=({field:e="",feedName:t="",value:a=""})=>{const r=`${e} ${a}${t?` ${l.e} ${t}`:""}`;return i.a.createElement(n.EuiToolTip,{content:a},i.a.createElement(y,{"data-test-subj":"enrichment-button-content"},i.a.createElement(g,null,r)))},b=m.a.h5.withConfig({displayName:"StyledH5",componentId:"sc-1i38kio-0"})(["line-height:1.7rem;"]),h=e=>i.a.createElement(n.EuiTitle,{size:"xxxs"},i.a.createElement(b,null,e));h.displayName="ThreatSummaryTitle";var v=a(159),E=a(962);const x=m()(n.EuiInMemoryTable).withConfig({displayName:"ThreatSummaryTable",componentId:"sc-1pwinz3-0"})([".euiTableHeaderCell,.euiTableRowCell{border:none;}.euiTableHeaderCell .euiTableCellContent{padding:0;}"]);var k=a(4),w=a(1469);const j=m()(n.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-mlcc85-0"})([".euiAccordion__triggerWrapper{background:",";border-radius:",";height:",";margin-bottom:",";padding-left:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeXL),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiSizeS)),S=[{field:"title",truncateText:!1,render:h,width:"220px",name:""},{field:"description",truncateText:!1,render:({fieldName:e,value:t})=>{const a=e.match(s.p)?i.a.createElement(n.EuiLink,{href:t,target:"_blank"},t):i.a.createElement("span",null,t);return i.a.createElement(n.EuiToolTip,{"data-test-subj":"message-tool-tip",content:i.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement("span",null,e)))},a)},name:""}],O=e=>Object.keys(e).sort().map((t=>({title:t.startsWith(k.J)?t.replace(`${k.J}`,"indicator"):t,description:{fieldName:t,value:Object(w.a)(e[t])}}))),I=({enrichment:e,index:t})=>{const{id:a="threat-details-item",field:r,feedName:o,type:s,value:u}=Object(c.c)(e),d=`${a}${r}`;return i.a.createElement(j,{id:d,key:d,initialIsOpen:!0,arrowDisplay:"right",buttonContent:i.a.createElement(f,{field:r,feedName:o,value:u}),extraAction:Object(c.e)(s)&&i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(v.b,{queryId:E.a,title:l.i}))},i.a.createElement(x,{columns:S,compressed:!0,"data-test-subj":`threat-details-view-${t}`,items:O(e)}))},C=({enrichments:e})=>i.a.createElement(i.a.Fragment,null,e.sort(((e,t)=>Object(c.d)(t)-Object(c.d)(e))).map(((t,a)=>i.a.createElement(i.a.Fragment,{key:`${t.id}`},i.a.createElement(I,{enrichment:t,index:a}),a<e.length-1&&i.a.createElement(n.EuiSpacer,{size:"m"})))));var M=a(47);const T=m.a.div.withConfig({displayName:"InlineBlock",componentId:"sc-oksmx3-0"})(["display:inline-block;line-height:1.7em;"]),_=({type:e})=>e?i.a.createElement(T,{"data-test-subj":"no-enrichments-found"},e===s.c.IndicatorMatchRule?l.k:i.a.createElement(M.FormattedMessage,{id:"xpack.securitySolution.enrichment.noInvestigationEnrichment",defaultMessage:"Additional threat intelligence wasn't found within the selected time frame. Try a different time frame, or {link} to collect threat intelligence for threat detection and matching.",values:{link:i.a.createElement(n.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/es-threat-intel-integrations.html",target:"_blank"},i.a.createElement(M.FormattedMessage,{id:"xpack.securitySolution.enrichment.investigationEnrichmentDocumentationLink",defaultMessage:"enable threat intelligence integrations"}))}})):null,N=({type:e})=>e?i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"baseline"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiTitle,{size:"xxxs"},i.a.createElement("h3",null,e===s.c.IndicatorMatchRule?l.f:l.h))),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(d,{type:e}))),i.a.createElement(n.EuiSpacer,{size:"s"})):null,D=({enrichments:e,type:t,loading:a,dataTestSubj:r,children:o})=>i.a.createElement("div",{"data-test-subj":r},i.a.createElement(N,{type:t}),o,Array.isArray(e)?i.a.createElement(C,{enrichments:e}):i.a.createElement(i.a.Fragment,null,i.a.createElement(_,{type:t}),a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiSpacer,{size:"m"}),i.a.createElement(n.EuiSkeletonText,{"data-test-subj":"loading-enrichments",lines:4})))),A=({enrichments:e,before:t=null,showInvestigationTimeEnrichments:a,loading:r,children:l})=>{const{[s.c.IndicatorMatchRule]:c,[s.c.InvestigationTime]:u,undefined:d}=Object(o.groupBy)(e,"matched.type");return i.a.createElement(i.a.Fragment,null,t,i.a.createElement(D,{dataTestSubj:"threat-match-detected",enrichments:c,type:s.c.IndicatorMatchRule}),a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiHorizontalRule,null),i.a.createElement(D,{dataTestSubj:"enriched-with-threat-intel",enrichments:u,type:s.c.InvestigationTime,loading:r},l)),d&&i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiHorizontalRule,null),c&&i.a.createElement(n.EuiSpacer,{size:"l"}),i.a.createElement(D,{enrichments:d,dataTestSubj:"matches-with-no-type"})))},q=i.a.memo(A)},1324:function(e,t,a){"use strict";a.d(t,"a",(function(){return D}));var n=a(2),r=a.n(n),i=a(44),o=a.n(i),s=a(17),l=a(47),c=a(183),u=a(135),d=a(50),p=a(3),m=a(9),y=a(200),g=a(325);let f,b;!function(e){e.asc="asc",e.desc="desc"}(f||(f={})),function(e){e.actions="responseActions",e.results="responseActionsResults"}(b||(b={}));var h=a(110);var v=a(1467),E=a(215),x=a(1304);const k=({type:e})=>{const t=Object(n.useMemo)((()=>{if("endpoint"===e)return{icon:"logoSecurity",name:"Elastic Defend"}}),[e]);return r.a.createElement(s.EuiEmptyPrompt,{iconType:t.icon,title:r.a.createElement("h2",null,x.b),titleSize:"xs",body:r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.responseActions.results.missingPrivileges",defaultMessage:"To access these results, ask your administrator for {integration} Kibana privileges.",values:{integration:r.a.createElement(s.EuiCode,null,t.name)}})})},w=({action:e,ruleName:t})=>{const{agent:a}=e,{action_id:i,expiration:o}=e.EndpointActions,{endpointPrivileges:{canAccessEndpointActionsLogManagement:c}}=Object(u.a)(),[m,g]=Object(n.useState)(!0),{data:E}=((e,{enabled:t,action:a,isLive:n=!1})=>{const{data:r}=Object(h.i)().services,{expiration:i,actionId:o,agent:s}=e;return Object(d.useQuery)({queryKey:["allResponsesResults",{actionId:o}],queryFn:async()=>{var e,t,a;const n=await Object(p.lastValueFrom)(r.search.search({actionId:o,expiration:i,sort:{order:f.desc,field:"@timestamp"},agents:(Array.isArray(s.id)?s.id:[s.id]).length,factoryQueryType:b.results},{strategy:y.m}));return{action_id:o,completedAt:null===(e=n.edges[0])||void 0===e||null===(t=e.fields)||void 0===t||null===(a=t["EndpointActions.completed_at"])||void 0===a?void 0:a[0],isExpired:n.isExpired,wasSuccessful:n.wasSuccessful,isCompleted:n.isCompleted,status:n.status}},select:e=>((e,t)=>{var a;const{rule:n}=e,{parameters:r,alert_id:i,comment:o,command:s,hosts:l}=e.EndpointActions.data;return{id:e.EndpointActions.action_id,agents:e.agent.id,parameters:r,...null!=i&&i.length?{alertIds:i}:{},...n?{ruleId:n.id,ruleName:n.name}:{},createdBy:(null===(a=e.rule)||void 0===a?void 0:a.name)||"unknown",comment:o,command:s,hosts:l,startedAt:e["@timestamp"],completedAt:null==t?void 0:t.completedAt,isCompleted:!(null==t||!t.isCompleted),isExpired:!(null==t||!t.isExpired),wasSuccessful:!(null==t||!t.isCompleted),status:t.status,agentState:{},errors:e.error?[e.error.message]:void 0}})(a,e),keepPreviousData:!0,enabled:t,refetchInterval:!!n&&5e3})})({actionId:i,expiration:o,agent:a},{enabled:c,action:e,isLive:m});Object(n.useEffect)((()=>{g((()=>{var e;return!E||!(null!==(e=E.errors)&&void 0!==e&&e.length)&&"pending"===E.status}))}),[E]);const x=E?j(E):"",w=Object(n.useMemo)((()=>null!=E&&E.hosts?Object.values(E.hosts)[0].name:""),[null==E?void 0:E.hosts]);return r.a.createElement(s.EuiComment,{username:t,timestamp:r.a.createElement(l.FormattedRelative,{value:e["@timestamp"]}),event:x,"data-test-subj":"endpoint-results-comment"},c?E?r.a.createElement(v.a,{action:E,"data-test-subj":`response-results-${w}`}):r.a.createElement(s.EuiLoadingSpinner,null):r.a.createElement(k,{type:"endpoint"}))},j=e=>{var t;return null!==(t=e.errors)&&void 0!==t&&t.length?E.g.failed(e.command):"pending"===e.status?E.g.pending(e.command):"successful"===e.status?E.g.executed(e.command):E.g.tried(e.command)},S=r.a.memo((({actions:e,ruleName:t,ecsData:a})=>{const{services:{osquery:i}}=Object(h.i)(),{OsqueryResult:o}=i,l=Object(n.useCallback)((e=>{if(O(e)){const n=e.action_id,i=e["@timestamp"];return r.a.createElement(o,{key:n,actionId:n,startDate:i,ruleName:t,ecsData:a})}return I(e)?r.a.createElement(w,{action:e,ruleName:t,key:e.EndpointActions.action_id}):null}),[o,a,t]);return r.a.createElement(r.a.Fragment,null,e.map((e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"s"}),l(e),r.a.createElement(s.EuiSpacer,{size:"s"})))))}));S.displayName="ResponseActionsResults";const O=e=>!(!e||!("input_type"in e)||"osquery"!==(null==e?void 0:e.input_type)),I=e=>{var t;return!(!e||!("EndpointActions"in e)||"endpoint"!==(null==e||null===(t=e.EndpointActions)||void 0===t?void 0:t.input_type))};var C=a(1417),M=a(130);const T=o.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-1y7ogme-0"})(["height:100%;position:relative;"]),_=o.a.div.withConfig({displayName:"InlineBlock",componentId:"sc-1y7ogme-1"})(["display:inline-block;line-height:1.7em;"]),N=()=>r.a.createElement(_,{"data-test-subj":c.y},r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.noDataDescription",defaultMessage:"There are no response actions defined for this event. To add some, edit the rule's settings and set up {link}.",values:{link:r.a.createElement(s.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/rules-ui-create.html#rule-response-action",target:"_blank"},r.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.noDataLinkText",defaultMessage:"response actions"}))}})),D=({rawEventData:e,ecsData:t})=>{var a,i,o,l,c;const u=Object(n.useMemo)((()=>({id:C.b.responseActionsView,"data-test-subj":"responseActionsViewTab",name:E.y})),[]),v=Object(M.a)("endpointResponseActionsEnabled"),x=e?Object(g.a)(e.fields):void 0,k=null==x||null===(a=x.kibana)||void 0===a||null===(i=a.alert)||void 0===i||null===(o=i.rule)||void 0===o||null===(l=o.parameters)||void 0===l?void 0:l[0].response_actions,w=!e||!v,j=null!==(c=null==e?void 0:e._id)&&void 0!==c?c:"",[O,I]=Object(n.useState)(!1),{data:_,isFetched:D}=((e,{enabled:t,isLive:a})=>{const{data:n}=Object(h.i)().services,{alertIds:r}=e;return Object(d.useQuery)({queryKey:["actions",{alertId:r[0]}],queryFn:async()=>{const e=await Object(p.lastValueFrom)(n.search.search({alertIds:r,sort:{order:f.desc,field:"@timestamp"},factoryQueryType:b.actions},{strategy:y.m})),t=Object(m.map)(Object(m.filter)(e.edges,"fields"),(e=>Object(g.a)(e.fields,!0)));return{...e,items:Object(m.compact)(t)}},enabled:t,refetchInterval:!!a&&5e3,keepPreviousData:!0})})({alertIds:[j]},{enabled:!w,isLive:O});if(Object(n.useEffect)((()=>{I((()=>{var e;return!(null==k||!k.length||null!=_&&null!==(e=_.items)&&void 0!==e&&e.length)}))}),[_,null==k?void 0:k.length]),w)return{...u,content:r.a.createElement(N,null)};{var A,q,F,L,R;const e=null==x||null===(A=x.kibana)||void 0===A||null===(q=A.alert)||void 0===q||null===(F=q.rule)||void 0===F||null===(L=F.name)||void 0===L?void 0:L[0],a=null!==(R=null==_?void 0:_.items)&&void 0!==R?R:[];return{...u,append:r.a.createElement(s.EuiNotificationBadge,{"data-test-subj":"response-actions-notification"},a.length),content:r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(T,{"data-test-subj":"responseActionsViewWrapper"},D&&a.length?r.a.createElement(S,{actions:a,ruleName:e,ecsData:t}):r.a.createElement(N,null)))}}}},1328:function(e,t,a){"use strict";a.d(t,"c",(function(){return h})),a.d(t,"d",(function(){return v})),a.d(t,"a",(function(){return E})),a.d(t,"b",(function(){return x})),a.d(t,"e",(function(){return I}));var n=a(17),r=a(61),i=a.n(r),o=a(2),s=a.n(o),l=a(44),c=a.n(l);const u=c.a.span.withConfig({displayName:"ArrowBody",componentId:"sc-11kjqat-0"})(["background-color:",";height:",";width:25px;"],(e=>e.theme.eui.euiColorLightShade),(({height:e})=>`${e}px`));u.displayName="ArrowBody";const d=s.a.memo((({direction:e})=>s.a.createElement(n.EuiIcon,{color:"subdued","data-test-subj":"arrow-icon",size:"s",type:e})));d.displayName="ArrowHead";var p=a(1620);const m=Object(p.scaleLinear)().domain([0,100]).range([1,4]).clamp(!0),y=e=>Array.isArray(e)&&1===e.length;var g=a(166),f=a(1100),b=a(1496);const h="source.bytes",v="source.packets",E="destination.bytes",x="destination.packets",k=c.a.span.withConfig({displayName:"Percent",componentId:"sc-19xyyc3-0"})(["margin-right:5px;"]);k.displayName="Percent";const w=c()(n.EuiFlexGroup).withConfig({displayName:"SourceDestinationArrowsContainer",componentId:"sc-19xyyc3-1"})(["margin:0 2px;.euiToolTipAnchor{white-space:nowrap;}"]);w.displayName="SourceDestinationArrowsContainer";const j=c()(n.EuiText).withConfig({displayName:"Data",componentId:"sc-19xyyc3-2"})(["margin:0 5px;"]);j.displayName="Data";const S=s.a.memo((({contextId:e,eventId:t,isDraggable:a,sourceBytes:r,sourceBytesPercent:o,sourcePackets:l})=>{const c=null!=o?m(o):1;return s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==r||isNaN(Number(r))?null:s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:h,id:`source-arrow-default-draggable-${e}-${t}-${h}-${r}`,isDraggable:a,value:r},s.a.createElement(j,{size:"xs"},null!=o?s.a.createElement(k,null,`(${i()(o).format("0.00")}%)`):null,s.a.createElement("span",null,s.a.createElement(f.a,{value:r}))))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==l||isNaN(Number(l))?null:s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:v,id:`source-arrow-default-draggable-${e}-${t}-${v}-${l}`,isDraggable:a,value:l},s.a.createElement(j,{size:"xs"},s.a.createElement("span",null,`${l} ${b.a}`)))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(d,{direction:"arrowRight"})))}));S.displayName="SourceArrow";const O=s.a.memo((({contextId:e,destinationBytes:t,destinationBytesPercent:a,destinationPackets:r,eventId:o,isDraggable:l})=>{const c=null!=a?m(a):1;return s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"center"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(d,{direction:"arrowLeft"})),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==t||isNaN(Number(t))?null:s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:E,id:`destination-arrow-default-draggable-${e}-${o}-${E}-${t}`,isDraggable:l,value:t},s.a.createElement(j,{size:"xs"},null!=a?s.a.createElement(k,null,`(${i()(a).format("0.00")}%)`):null,s.a.createElement("span",null,s.a.createElement(f.a,{value:t}))))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})),null==r||isNaN(Number(r))?null:s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(g.b,{field:x,id:`destination-arrow-default-draggable-${e}-${o}-${x}-${r}`,isDraggable:l,value:r},s.a.createElement(j,{size:"xs"},s.a.createElement("span",null,`${i()(r).format("0,0")} ${b.a}`)))),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(u,{height:null!=c?c:0})))}));O.displayName="DestinationArrow";const I=s.a.memo((({contextId:e,destinationBytes:t,destinationPackets:a,eventId:r,isDraggable:i,sourceBytes:o,sourcePackets:l})=>{const c=null!=o&&y(o)?o[0]:void 0,u=null!=l&&y(l)?l[0]:void 0,d=null!=t&&y(t)?t[0]:void 0,p=null!=a&&y(a)?a[0]:void 0,m=null!=c&&null!=d?(({numerator:e,denominator:t})=>{if(!(Math.abs(t)<Number.EPSILON)&&Number.isFinite(e)&&Number.isFinite(t))return e/t*100})({numerator:Number(c),denominator:Number(c)+Number(d)}):void 0,g=null!=m?100-m:void 0;return s.a.createElement(w,{alignItems:"center",justifyContent:"center",direction:"column",gutterSize:"none"},null!=c?s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(S,{contextId:e,eventId:r,isDraggable:i,sourceBytes:c,sourcePackets:u,sourceBytesPercent:m})):null,null!=d?s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(O,{contextId:e,destinationBytes:d,destinationPackets:p,destinationBytesPercent:g,eventId:r,isDraggable:i})):null)}));I.displayName="SourceDestinationArrows"},1331:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(23),r=a.n(n),i=a(2),o=a.n(i),s=a(17),l=a(5),c=a(47),u=a(44),d=a.n(u),p=a(135),m=a(1295),y=a(238),g=a(115),f=a(352),b=a(529);const h=()=>{},v={bordered:!0,showIcons:!1},E={className:"effected-policies-search"},x=d.a.div.withConfig({displayName:"StyledEuiSelectable",componentId:"sc-rb0j09-0"})([".effected-policies-search{border-bottom-left-radius:0;border-bottom-right-radius:0;}.euiSelectableList{border-top-left-radius:0;border-top-right-radius:0;border-top-width:0;}"]),k=d()(s.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemButtonGroup",componentId:"sc-rb0j09-1"})(["@media only screen and (max-width:","){align-items:center;}"],(e=>e.theme.eui.euiBreakpoints.m)),w=d()(s.EuiButtonGroup).withConfig({displayName:"StyledButtonGroup",componentId:"sc-rb0j09-2"})(["display:flex;justify-content:right;.euiButtonGroupButton{padding-right:",";}"],(e=>e.theme.eui.euiSizeL)),j=d.a.div.withConfig({displayName:"EffectivePolicyFormContainer",componentId:"sc-rb0j09-3"})([".policy-name .euiSelectableListItem__text{text-decoration:none !important;color:"," !important;}"],(e=>e.theme.eui.euiTextColor)),S=Object(i.memo)((({isGlobal:e,isPlatinumPlus:t,description:a,isLoading:n=!1,onChange:u,listProps:d,options:S,selected:O=[],disabled:I=!1,"data-test-subj":C,...M})=>{const{getAppUrl:T}=Object(f.a)(),{canReadPolicyManagement:_}=Object(p.a)().endpointPrivileges,N=Object(g.a)(C),D=Object(i.useMemo)((()=>[{id:"globalPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.global",{defaultMessage:"Global"}),iconType:e?"checkInCircleFilled":"empty","data-test-subj":N("global")},{id:"perPolicy",label:l.i18n.translate("xpack.securitySolution.endpoint.effectedPolicySelect.perPolicy",{defaultMessage:"Per Policy"}),iconType:e?"empty":"checkInCircleFilled","data-test-subj":N("perPolicy")}]),[N,e]),A=Object(i.useMemo)((()=>{const a=new Set(O.map((e=>e.id)));return S.map((n=>({label:n.name,className:"policy-name",prepend:o.a.createElement(s.EuiCheckbox,{id:Object(s.htmlIdGenerator)()(),onChange:h,checked:a.has(n.id),disabled:e||!t||I,"data-test-subj":`policy-${n.id}-checkbox`}),append:_?o.a.createElement(m.a,{href:T({path:Object(y.j)(n.id)}),appPath:Object(y.j)(n.id),target:"_blank","data-test-subj":N("policyLink")},o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.viewPolicyLinkLabel",defaultMessage:"View policy"})):null,policy:n,checked:a.has(n.id)?"on":void 0,disabled:e||!t||I,"data-test-subj":`policy-${n.id}`}))).sort((({label:e},{label:t})=>e.localeCompare(t)))}),[_,I,T,N,e,t,S,O]),q=Object(i.useCallback)((t=>{u({isGlobal:e,selected:t.filter((e=>e.checked)).map((e=>e.policy))})}),[e,u]),F=Object(i.useCallback)((e=>{u({isGlobal:"globalPolicy"===e,selected:O})}),[u,O]),L=Object(i.useCallback)(((e,t)=>o.a.createElement(o.a.Fragment,null,t,e)),[]);return o.a.createElement(j,null,o.a.createElement(s.EuiText,{size:"xs"},o.a.createElement("h3",null,o.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.effectedPolicySelect.assignmentSectionTitle",defaultMessage:"Assignment"}))),o.a.createElement(s.EuiSpacer,{size:"xs"}),o.a.createElement(s.EuiFlexGroup,null,o.a.createElement(s.EuiFlexItem,{grow:2},o.a.createElement(s.EuiText,{size:"s"},o.a.createElement("p",null,a||l.i18n.translate("xpack.securitySolution.effectedPolicySelect.assignmentSectionDescription",{defaultMessage:"Assign globally across all policies, or assign it to specific policies."})))),o.a.createElement(k,{grow:1},o.a.createElement(s.EuiFormRow,{fullWidth:!0,isDisabled:I},o.a.createElement(w,{legend:"Global Policy Toggle",options:D,idSelected:e?"globalPolicy":"perPolicy",onChange:F,color:"primary","data-test-subj":N("byPolicyGlobalButtonGroup"),isDisabled:I})))),o.a.createElement(s.EuiSpacer,null),!e&&(n?o.a.createElement(b.a,{size:"l","data-test-subj":N("policiesLoader")}):o.a.createElement(s.EuiFormRow,{fullWidth:!0},o.a.createElement(x,null,o.a.createElement(s.EuiSelectable,r()({},M,{options:A,listProps:d||v,onChange:q,searchProps:E,searchable:!0,"data-test-subj":N("policiesSelectable")}),L)))))}));S.displayName="EffectedPolicySelect"},1332:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a(4);a(99);var i=a(352);const o=({_id:e,_index:t,timestamp:a})=>{const{getAppUrl:o}=Object(i.a)(),s=(({alertId:e,index:t,timestamp:a})=>`${r.g}/${e}?index=${t}&timestamp=${a}`)({alertId:e,index:t,timestamp:a}),l=t.includes(r.Q);return Object(n.useMemo)((()=>{if(l)return null;const e=o({path:s});return`${window.location.origin}${e}`}),[l,o,s])}},1362:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.entityAnalytics.totalLabel",{defaultMessage:"Total"}),i=n.i18n.translate("xpack.securitySolution.entityAnalytics.hostsRiskDashboard.title",{defaultMessage:"Host Risk Scores"}),o=n.i18n.translate("xpack.securitySolution.entityAnalytics.usersRiskDashboard.title",{defaultMessage:"User Risk Scores"})},1368:function(e,t,a){"use strict";a.d(t,"i",(function(){return r})),a.d(t,"g",(function(){return i})),a.d(t,"h",(function(){return o})),a.d(t,"l",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"m",(function(){return c})),a.d(t,"n",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"k",(function(){return y})),a.d(t,"c",(function(){return g})),a.d(t,"j",(function(){return f})),a.d(t,"f",(function(){return b}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.timeline.body.openSessionViewLabel",{defaultMessage:"Open Session View"}),i=n.i18n.translate("xpack.securitySolution.timeline.body.notes.disableEventTooltip",{defaultMessage:"Notes may not be added here while editing a template timeline"}),o=n.i18n.translate("xpack.securitySolution.timeline.body.notes.addNoteTooltip",{defaultMessage:"Add note"}),s=n.i18n.translate("xpack.securitySolution.timeline.sortFieldsButton",{defaultMessage:"Sort fields"}),l=n.i18n.translate("xpack.securitySolution.timeline.fullScreenButton",{defaultMessage:"Full screen"}),c=n.i18n.translate("xpack.securitySolution.hoverActions.viewDetailsAriaLabel",{defaultMessage:"View details"}),u=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.hoverActions.viewDetailsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"View details for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),d=n.i18n.translate("xpack.securitySolution.hoverActions.investigateInResolverTooltip",{defaultMessage:"Analyze event"}),p=({ariaRowindex:e,columnValues:t,checked:a})=>n.i18n.translate("xpack.securitySolution.hoverActions.checkboxForRowAriaLabel",{values:{ariaRowindex:e,checked:a,columnValues:t},defaultMessage:"{checked, select, false {unchecked} true {checked}} checkbox for the alert or event in row {ariaRowindex}, with columns {columnValues}"}),m=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.hoverActions.investigateInResolverForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Analyze the alert or event in row {ariaRowindex}, with columns {columnValues}"}),y=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.hoverActions.sendAlertToTimelineForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Send the alert in row {ariaRowindex} to timeline, with columns {columnValues}"}),g=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.hoverActions.addNotesForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Add notes for the event in row {ariaRowindex} to timeline, with columns {columnValues}"}),f=({ariaRowindex:e,columnValues:t,isEventPinned:a})=>n.i18n.translate("xpack.securitySolution.hoverActions.pinEventForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t,isEventPinned:a},defaultMessage:"{isEventPinned, select, false {Pin} true {Unpin}} the event in row {ariaRowindex} to timeline, with columns {columnValues}"}),b=({ariaRowindex:e,columnValues:t})=>n.i18n.translate("xpack.securitySolution.hoverActions.moreActionsForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Select more actions for the alert or event in row {ariaRowindex}, with columns {columnValues}"})},1369:function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return y})),a.d(t,"g",(function(){return g})),a.d(t,"f",(function(){return f})),a.d(t,"e",(function(){return b})),a.d(t,"i",(function(){return h})),a.d(t,"h",(function(){return v}));var n=a(2),r=a.n(n),i=a(44),o=a.n(i),s=a(17),l=a(55),c=a(1157);const u=o()(s.EuiHealth).withConfig({displayName:"StyledEuiHealth",componentId:"sc-1rr4lsj-0"})(["line-height:inherit;"]),d=l.euiLightVars.euiColorVis0,p=l.euiLightVars.euiColorVis5,m=l.euiLightVars.euiColorVis7,y=l.euiLightVars.euiColorVis9,g=47,f=73,b=99,h=[{value:"low",inputDisplay:r.a.createElement(u,{color:d},c.i)},{value:"medium",inputDisplay:r.a.createElement(u,{color:p},c.j)},{value:"high",inputDisplay:r.a.createElement(u,{color:m},c.h)},{value:"critical",inputDisplay:r.a.createElement(u,{color:y},c.f)}],v={low:21,medium:g,high:f,critical:b}},1370:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"f",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"d",(function(){return c}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewListDetailActionLabel",{defaultMessage:"View list detail"}),i=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.viewRuleDetailActionLabel",{defaultMessage:"View rule detail"}),o=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.link_column",{defaultMessage:"Link"}),s=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.name_column",{defaultMessage:"Name"}),l=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.action_column",{defaultMessage:"Action"}),c=n.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.tags_column",{defaultMessage:"Tags"})},1371:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(152),r=a(4);const i=Object(n.d)((async({name:e,description:t,http:a,signal:n})=>await a.post(r.wc,{version:"2023-10-31",body:JSON.stringify({name:e,description:t}),headers:{"Content-Type":"application/json"},method:"POST",signal:n}))),o=()=>Object(n.a)(i)},1372:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"e",(function(){return l}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.edit.label",{defaultMessage:"Edit rule exception"}),i=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.endpoint.item.card.edit.label",{defaultMessage:"Edit endpoint exception"}),o=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.delete.label",{defaultMessage:"Delete rule exception"}),s=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.endpoint.item.card.delete.label",{defaultMessage:"Delete endpoint exception"}),l=n.i18n.translate("xpack.securitySolution.exceptions.list.utility.title",{defaultMessage:"rule exceptions"})},1373:function(e,t,a){"use strict";a.d(t,"T",(function(){return r})),a.d(t,"n",(function(){return i})),a.d(t,"L",(function(){return o})),a.d(t,"p",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"ab",(function(){return u})),a.d(t,"M",(function(){return d})),a.d(t,"u",(function(){return p})),a.d(t,"s",(function(){return m})),a.d(t,"t",(function(){return y})),a.d(t,"r",(function(){return g})),a.d(t,"q",(function(){return f})),a.d(t,"cb",(function(){return b})),a.d(t,"Q",(function(){return h})),a.d(t,"bb",(function(){return v})),a.d(t,"O",(function(){return E})),a.d(t,"P",(function(){return x})),a.d(t,"eb",(function(){return k})),a.d(t,"v",(function(){return w})),a.d(t,"R",(function(){return j})),a.d(t,"X",(function(){return S})),a.d(t,"Z",(function(){return O})),a.d(t,"Y",(function(){return I})),a.d(t,"G",(function(){return C})),a.d(t,"H",(function(){return M})),a.d(t,"F",(function(){return T})),a.d(t,"J",(function(){return _})),a.d(t,"I",(function(){return N})),a.d(t,"E",(function(){return D})),a.d(t,"N",(function(){return A})),a.d(t,"c",(function(){return q})),a.d(t,"K",(function(){return F})),a.d(t,"S",(function(){return L})),a.d(t,"d",(function(){return R})),a.d(t,"m",(function(){return P})),a.d(t,"o",(function(){return z})),a.d(t,"g",(function(){return B})),a.d(t,"f",(function(){return G})),a.d(t,"l",(function(){return $})),a.d(t,"j",(function(){return H})),a.d(t,"k",(function(){return V})),a.d(t,"h",(function(){return U})),a.d(t,"i",(function(){return W})),a.d(t,"e",(function(){return Y})),a.d(t,"db",(function(){return Z})),a.d(t,"W",(function(){return K})),a.d(t,"U",(function(){return Q})),a.d(t,"V",(function(){return X})),a.d(t,"w",(function(){return J})),a.d(t,"C",(function(){return ee})),a.d(t,"A",(function(){return te})),a.d(t,"z",(function(){return ae})),a.d(t,"B",(function(){return ne})),a.d(t,"D",(function(){return re})),a.d(t,"x",(function(){return ie})),a.d(t,"y",(function(){return oe}));var n=a(5);n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.idTitle",{defaultMessage:"List ID"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.listName",{defaultMessage:"Name"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.actionsTitle",{defaultMessage:"Actions"});const r=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.showingExceptionLists",{values:{totalLists:e},defaultMessage:"Showing {totalLists} {totalLists, plural, =1 {list} other {lists}}"}),i=(n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.rulesAssignedTitle",{defaultMessage:"Rules assigned to"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateCreatedTitle",{defaultMessage:"Date created"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.dateUpdatedTitle",{defaultMessage:"Last edited"}),n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.errorFetching",{defaultMessage:"Error fetching exception lists"})),o=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.filters.noExceptionsTitle",{defaultMessage:"No exception lists found"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptionLists.search.placeholder",{defaultMessage:"Search exception lists"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableTitle",{defaultMessage:"Shared Exception Lists"}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.tableSubtitle",{defaultMessage:"To view rule specific exceptions navigate to that rule's details page."}),u=e=>n.i18n.translate("xpack.securitySolution.exceptions.allExceptionsRowPerPage",{defaultMessage:"Rows per page: {rowSize}",values:{rowSize:e}}),d=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.allExceptions.filters.noListsBody",{defaultMessage:"We weren't able to find any exception lists."}),p=e=>n.i18n.translate("xpack.securitySolution.exceptions.list.export_success",{values:{listName:e},defaultMessage:'Exception list "{listName}" exported successfully'}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.exportError",{defaultMessage:"Exception list export error"}),y=e=>n.i18n.translate("xpack.securitySolution.exceptions.list.duplicate_success",{values:{listName:e},defaultMessage:'Exception list "{listName}" duplicated successfully'}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.duplicateError",{defaultMessage:"Exception list duplication error"}),f=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.deleteError",{defaultMessage:"Error occurred deleting exception list"}),b=e=>n.i18n.translate("xpack.securitySolution.exceptions.referenceModalSuccessDescription",{defaultMessage:"Exception list - {listId} - deleted successfully.",values:{listId:e}}),h=n.i18n.translate("xpack.securitySolution.exceptions.referenceModalTitle",{defaultMessage:"Remove exception list"}),v=e=>n.i18n.translate("xpack.securitySolution.exceptions.referenceModalDefaultDescription",{defaultMessage:"Are you sure you wish to DELETE exception list with the name {listName}?",values:{listName:e}}),E=n.i18n.translate("xpack.securitySolution.exceptions.referenceModalCancelButton",{defaultMessage:"Cancel"}),x=n.i18n.translate("xpack.securitySolution.exceptions.referenceModalDeleteButton",{defaultMessage:"Remove exception list"}),k=e=>n.i18n.translate("xpack.securitySolution.exceptions.referenceModalDescription",{defaultMessage:"This exception list is associated with ({referenceCount}) {referenceCount, plural, =1 {rule} other {rules}}. Removing this exception list will also remove its reference from the associated rules.",values:{referenceCount:e}}),w=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.searchPlaceholder",{defaultMessage:"Search by name or list_id:id"}),j=n.i18n.translate("xpack.securitySolution.detectionEngine.rules.all.exceptions.refresh",{defaultMessage:"Refresh"}),S=n.i18n.translate("xpack.securitySolution.exceptions.exceptionListsImportButton",{defaultMessage:"Import list"}),O=n.i18n.translate("xpack.securitySolution.lists.exceptionListImportSuccessTitle",{defaultMessage:"Exception list imported"}),I=n.i18n.translate("xpack.securitySolution.lists.exceptionListUploadError",{defaultMessage:"There was an error uploading the exception list."}),C=n.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.importExceptionList",{defaultMessage:"Import exception list"}),M=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutHeader",{defaultMessage:"Import shared exception list"}),T=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListFlyoutBody",{defaultMessage:"Select shared exception lists to import"}),_=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListWarning",{defaultMessage:"We found a pre-existing list with that id"}),N=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListOverwrite",{defaultMessage:"Overwrite the existing list"}),D=n.i18n.translate("xpack.securitySolution.exceptionsTable.importExceptionListAsNewList",{defaultMessage:"Create new list"}),A=n.i18n.translate("xpack.securitySolution.exceptions.badge.readOnly.tooltip",{defaultMessage:"Unable to create, edit or delete exceptions"}),q=n.i18n.translate("xpack.securitySolution.exceptions.exceptionListsCloseImportFlyout",{defaultMessage:"Close"}),F=n.i18n.translate("xpack.securitySolution.exceptions.exceptionListsFilePickerPrompt",{defaultMessage:"Select or drag and drop multiple files"}),L=n.i18n.translate("xpack.securitySolution.exceptionsTable.rulesCountLabel",{defaultMessage:"Rules"}),R=n.i18n.translate("xpack.securitySolution.exceptionsTable.createdBy",{defaultMessage:"Created By"}),P=n.i18n.translate("xpack.securitySolution.exceptionsTable.createdAt",{defaultMessage:"Date created"}),z=n.i18n.translate("xpack.securitySolution.exceptionsTable.exceptionsCountLabel",{defaultMessage:"Exceptions"}),B=n.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createSharedListButton",{defaultMessage:"Create shared list"}),G=n.i18n.translate("xpack.securitySolution.exceptions.manageExceptions.createItemButton",{defaultMessage:"Create exception item"}),$=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListTitle",{defaultMessage:"Create shared exception list"}),H=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameField",{defaultMessage:"Shared exception list name"}),V=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutNameFieldPlaceholder",{defaultMessage:"New exception list"}),U=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescription",{defaultMessage:"Description (optional)"}),W=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutDescriptionPlaceholder",{defaultMessage:"New exception list description"}),Y=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListFlyoutCreateButton",{defaultMessage:"Create shared exception list"}),Z=e=>n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessDescription",{defaultMessage:"List with name {listName} was created!",values:{listName:e}}),K=n.i18n.translate("xpack.securitySolution.exceptions.createSharedExceptionListSuccessTitle",{defaultMessage:"Created list"}),Q=n.i18n.translate("xpack.securitySolution.exceptions.sortBy",{defaultMessage:"Sort by:"}),X=n.i18n.translate("xpack.securitySolution.exceptions.sortByCreateAt",{defaultMessage:"Created At"}),J=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalCancelButton",{defaultMessage:"Cancel"}),ee=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalExportTitle",{defaultMessage:"Export exception list?"}),te=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalDuplicateTitle",{defaultMessage:"Duplicate exception list?"}),ae=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeDuplicateDescription",{defaultMessage:"You’re duplicating an exception list. Switch the toggle off to exclude expired exceptions."}),ne=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeExportDescription",{defaultMessage:"You’re exporting an exception list. Switch the toggle off to exclude expired exceptions."}),re=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalIncludeSwitchLabel",{defaultMessage:"Include expired exceptions"}),ie=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalConfirmDuplicateButton",{defaultMessage:"Duplicate"}),oe=n.i18n.translate("xpack.securitySolution.exceptions.expiredExceptionModalConfirmExportButton",{defaultMessage:"Export"})},1375:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2),r=a(163);const i=({exceptionLists:e})=>{const[t,a]=Object(n.useState)(!0),[i,o]=Object(n.useState)([]),[s,l]=Object(n.useState)({}),c=Object(n.useCallback)((t=>{const a=e.reduce(((e,{id:t,...a})=>(e[t]={...a,id:t,rules:[]},e)),{});return t.reduce(((e,t)=>{const a=t.exceptions_list;return null!=a&&a.length>0&&a.forEach((a=>{const n=e[a.id];null!=n&&(e[a.id]={...n,rules:[...n.rules,t]})})),e}),a)}),[e]);return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController;return(async()=>{if(0===e.length&&t)return a(!1),o([]),void l({});try{a(!0);const{data:e}=await Object(r.j)({pagination:{page:1,perPage:1e4},signal:n.signal}),i=c(e),s=Object.keys(i).map((e=>i[e]));o(s),l(i),t&&a(!1)}catch(e){t&&a(!1)}})(),()=>{t=!1,n.abort()}}),[e.length,c]),[t,i,s]}},1376:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(2),r=a(139),i=a(738),o=a(17),s=a(137),l=a(4),c=a(1377),u=a(576),d=a(1553),p=a(1378);const m=({exceptionsList:e,handleExport:t,handleDelete:a,handleDuplicate:m,handleManageRules:y})=>{const[g,f]=Object(n.useState)(i.i.LOADING),[b,h]=Object(n.useState)(),[v,E]=Object(n.useState)(!1),[x,k]=Object(n.useState)(!1),[w,j]=Object(n.useState)(null),{name:S,list_id:O,rules:I,type:C,created_by:M,created_at:T,description:_}=e,N=Object(n.useCallback)((()=>{f("")}),[f]),D=e=>{h(e),k(!0)},{lastUpdated:A,exceptionViewerStatus:q,exceptions:F,pagination:L,ruleReferences:R,fetchItems:P,onDeleteException:z,onPaginationChange:B}=Object(c.a)({list:e,deleteToastTitle:u.u,deleteToastBody:e=>u.t(e),errorToastBody:u.p,errorToastTitle:u.q,onEditListExceptionItem:D,onFinishFetchingExceptions:N});Object(n.useEffect)((()=>{P(null,i.i.LOADING)}),[P]);const[G,$]=Object(n.useState)(!1),H=Object(o.useGeneratedHtmlId)({prefix:"openAccordion"}),V=Object(d.a)(e),U=Object(n.useMemo)((()=>g===i.i.EMPTY?u.B:""),[g]),W=Object(n.useMemo)((()=>g===i.i.EMPTY?u.y(e.name):""),[e.name,g]),Y=Object(n.useMemo)((()=>e.type===r.b.ENDPOINT?u.A:u.z),[e.type]),Z=Object(n.useMemo)((()=>[{key:"Export",icon:"exportAction",label:u.O,onClick:a=>{C===r.b.ENDPOINT?t({id:e.id,listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:!0})():j(p.a.EXPORT)}},{key:"Duplicate",icon:"copy",label:u.k,disabled:V,onClick:e=>{j(p.a.DUPLICATE)}},{key:"Delete",icon:"trash",disabled:V,label:u.j,onClick:t=>{a({id:e.id,listId:e.list_id,namespaceType:e.namespace_type})()}},{key:"LinkRules",icon:"gear",disabled:V,label:u.W,onClick:e=>{y()}}]),[V,C,t,e.id,e.list_id,e.name,e.namespace_type,a,y]),K=Object(n.useCallback)((()=>{E(!0)}),[E]),Q=Object(n.useCallback)((e=>{E(!1),k(!1),e&&P()}),[P,E,k]),X=Object(n.useCallback)((()=>{j(p.a.EXPORT)}),[j]),J=Object(n.useCallback)((a=>{w===p.a.EXPORT&&t({id:e.id,listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:a})(),w===p.a.DUPLICATE&&m({listId:e.list_id,name:e.name,namespaceType:e.namespace_type,includeExpiredExceptions:a})()}),[w,t,e.id,e.list_id,e.name,e.namespace_type,m]),{onClick:ee}=Object(s.o)()({deepLinkId:l.yc.exceptions,path:`/details/${e.list_id}`});return{listId:O,listName:S,listDescription:_,createdAt:new Date(T).toDateString(),createdBy:M,listRulesCount:I.length.toString(),exceptionItemsCount:L.totalItemCount.toString(),listType:C,menuActionItems:Z,showAddExceptionFlyout:v,toggleAccordion:G,openAccordionId:H,viewerStatus:g,exceptionToEdit:b,showEditExceptionFlyout:x,lastUpdated:A,exceptions:F,ruleReferences:R,pagination:L,exceptionViewerStatus:q,onEditExceptionItem:D,onDeleteException:z,onPaginationChange:B,setToggleAccordion:$,onAddExceptionClick:K,handleConfirmExceptionFlyout:Q,handleCancelExceptionItemFlyout:()=>{E(!1),k(!1)},goToExceptionDetail:ee,emptyViewerTitle:U,emptyViewerBody:W,emptyViewerButtonText:Y,showIncludeExpiredExceptionsModal:w,onExportListClick:X,handleCancelExpiredExceptionsModal:()=>{j(null)},handleConfirmExpiredExceptionsModal:J}}},1377:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(738),i=a(110),o=a(1431);const s=({list:e,deleteToastTitle:t,deleteToastBody:a,errorToastTitle:s,errorToastBody:l,onEditListExceptionItem:c,onFinishFetchingExceptions:u})=>{const{services:d}=Object(i.i)(),{http:p}=d,m=Object(i.m)(),[y,g]=Object(n.useState)([]),[f,b]=Object(n.useState)({}),[h,v]=Object(n.useState)({pageIndex:0,pageSize:0,totalItemCount:0}),[E,x]=Object(n.useState)(null),[k,w]=Object(n.useState)(""),j=Object(n.useCallback)(((e,t,a)=>{null==m||m.addError(e,{title:t||s,toastMessage:a||l}),w(r.i.ERROR)}),[l,s,m]),S=Object(n.useCallback)((async()=>{try{const t=await Object(o.c)([e]);b(t)}catch(e){j(e)}}),[j,e,b]),O=Object(n.useCallback)(((e,t,a)=>{v(e),x(Date.now()),setTimeout((()=>{if(a===r.i.EMPTY_SEARCH)return w(t?"":a);w(t?"":r.i.EMPTY)}),200)}),[]),I=Object(n.useCallback)((async(t,a)=>{try{w(r.i.LOADING);const{data:n,pagination:i}=await Object(o.b)({http:p,...Object(o.g)(null,e,t)});g(n),S(),O(i,n.length,a),"function"==typeof u&&u()}catch(e){j(e)}}),[p,e,S,O,u,j]),C=Object(n.useCallback)((async({id:e,name:n,namespaceType:i})=>{try{w(r.i.LOADING),await Object(o.a)({id:e,http:p,namespaceType:i}),null==m||m.addSuccess({title:t,text:"function"==typeof a?a(n):""}),I()}catch(e){j(e)}}),[p,m,t,a,I,j]),M=Object(n.useCallback)((async e=>{I(e)}),[I]);return{exceptions:y,lastUpdated:E,pagination:h,exceptionViewerStatus:k,ruleReferences:f,fetchItems:I,onDeleteException:C,onEditExceptionItem:e=>{"function"==typeof c&&c(e)},onPaginationChange:M}}},1378:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l}));var n=a(2),r=a.n(n),i=a(17),o=a(576);const s={DUPLICATE:"duplicate",EXPORT:"export"},l=Object(n.memo)((({handleCloseModal:e,onModalConfirm:t,action:a})=>{const[l,c]=Object(n.useState)(!0),u=Object(n.useCallback)((()=>{c(!l)}),[c,l]),d=Object(n.useCallback)((()=>{t(l),e()}),[l,e,t]);return r.a.createElement(i.EuiConfirmModal,{title:a===s.EXPORT?o.M:o.K,onCancel:e,onConfirm:d,cancelButtonText:o.G,confirmButtonText:a===s.EXPORT?o.I:o.H,defaultFocusedButton:"confirm","data-test-subj":"includeExpiredExceptionsConfirmationModal"},r.a.createElement(i.EuiText,null,a===s.EXPORT?o.L:o.J),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiSwitch,{label:o.N,checked:l,onChange:u,"data-test-subj":"includeExpiredExceptionsConfirmationModalSwitch"}))}));l.displayName="IncludeExpiredExceptionsModal"},1379:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(175),r=a(152);const i=Object(r.d)((async({file:e,http:t,signal:a,overwrite:r,overwriteExceptions:i,asNewList:o})=>{const s=new FormData;return s.append("file",e),await t.post(`${n.s}/_import`,{body:s,query:{overwrite:r,overwrite_exceptions:i,as_new_list:o},headers:{"Content-Type":void 0},method:"POST",signal:a})})),o=()=>Object(r.a)(i)},1380:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a(139),i=a(738),o=a(576),s=a(1437);const l=(e,t)=>{const[a,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)(!1),[d,p]=Object(n.useState)(),[m,y]=Object(n.useState)(i.i.LOADING),g=Object(n.useCallback)((()=>{y("")}),[y]),f=e=>{p(e),u(!0)},{exceptionViewerStatus:b,exceptions:h,lastUpdated:v,pagination:E,ruleReferences:x,fetchItems:k,onDeleteException:w,onPaginationChange:j}=Object(s.b)({list:e,deleteToastTitle:o.u,deleteToastBody:e=>o.t(e),errorToastBody:o.p,errorToastTitle:o.q,onEditListExceptionItem:f,onFinishFetchingExceptions:g});Object(n.useEffect)((()=>{k(null,i.i.LOADING)}),[k,t]);const S=Object(n.useMemo)((()=>m===i.i.EMPTY?o.B:""),[m]),O=Object(n.useMemo)((()=>m===i.i.EMPTY?o.y(e.name):""),[e.name,m]),I=Object(n.useMemo)((()=>e.type===r.b.ENDPOINT?o.A:o.z),[e.type]),C=Object(n.useCallback)((async e=>{y(i.i.SEARCHING),k(e,i.i.EMPTY_SEARCH)}),[k,y]),M=Object(n.useCallback)((()=>{l(!0),k()}),[k,l]),T=Object(n.useCallback)((e=>{l(!1),u(!1),e&&k()}),[k,l,u]);return{exceptionViewerStatus:b,listName:e.name,exceptions:h,listType:e.type,lastUpdated:v,pagination:E,viewerStatus:m,emptyViewerTitle:S,emptyViewerBody:O,emptyViewerButtonText:I,ruleReferences:x,showAddExceptionFlyout:a,showEditExceptionFlyout:c,exceptionToEdit:d,onSearch:C,onAddExceptionClick:M,onDeleteException:w,onEditExceptionItem:f,onPaginationChange:j,handleCancelExceptionItemFlyout:()=>{l(!1),u(!1)},handleConfirmExceptionFlyout:T}}},1382:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a(110),i=a(238);const o=(e=[])=>{const{getAppUrl:t}=Object(r.c)();return Object(n.useMemo)((()=>e.reduce(((e,a)=>{var n;const r=a.id,o=Object(i.j)(r);return e[r]={href:t({path:o}),children:null!==(n=a.name)&&void 0!==n?n:r,target:"_blank"},e}),{})),[t,e])}},1385:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(49),r=a(2),i=a(9),o=a(530);const s=()=>{const e=Object(n.useLocation)(),t=Object(n.useHistory)(),{toUrlParams:a,urlParams:s}=Object(o.a)();return Object(r.useCallback)(((n,r=!1)=>{t.push({...e,search:a(r?n:Object(i.pickBy)({...s,...n},(e=>void 0!==e)))})}),[s,t,e,a])}},1391:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="_id"},1395:function(e,t,a){"use strict";a.d(t,"h",(function(){return d})),a.d(t,"j",(function(){return p})),a.d(t,"i",(function(){return m})),a.d(t,"k",(function(){return y})),a.d(t,"g",(function(){return g})),a.d(t,"b",(function(){return f})),a.d(t,"d",(function(){return b})),a.d(t,"c",(function(){return h})),a.d(t,"e",(function(){return v})),a.d(t,"a",(function(){return E})),a.d(t,"f",(function(){return j}));var n=a(17),r=a(45),i=a(2),o=a.n(i),s=a(44),l=a.n(s),c=a(166),u=a(1396);const d="source.geo.continent_name",p="source.geo.country_name",m="source.geo.country_iso_code",y="source.geo.region_name",g="source.geo.city_name",f="destination.geo.continent_name",b="destination.geo.country_name",h="destination.geo.country_iso_code",v="destination.geo.region_name",E="destination.geo.city_name",x=[{prop:"GeoContinentName",fieldName:"geo.continent_name"},{prop:"GeoCountryName",fieldName:"geo.country_name"},{prop:"GeoCountryIsoCode",fieldName:"geo.country_iso_code"},{prop:"GeoRegionName",fieldName:"geo.region_name"},{prop:"GeoCityName",fieldName:"geo.city_name"}],k=l()(n.EuiFlexItem).withConfig({displayName:"GeoFlexItem",componentId:"sc-19jrcd0-0"})(["margin-right:5px;"]);k.displayName="GeoFlexItem";const w=o.a.memo((({contextId:e,eventId:t,fieldName:a,isDraggable:i,values:s})=>null!=s?o.a.createElement(o.a.Fragment,null,Object(r.uniq)(s).map((r=>o.a.createElement(k,{grow:!1,key:`${e}-${t}-${a}-${r}`},o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},a===m||a===h?o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(u.a,{countryCode:r})):null,o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(c.b,{"data-test-subj":a,field:a,id:`geo-field-values-default-draggable-${e}-${t}-${a}-${r}`,isDraggable:i,tooltipContent:a,value:r}))))))):null));w.displayName="GeoFieldValues";const j=o.a.memo((e=>{const{contextId:t,eventId:a,isDraggable:i,type:s}=e,l=(e=>x.map((({prop:t,fieldName:a})=>({prop:`${e}${t}`,fieldName:`${e}.${a}`}))))(s);return o.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},Object(r.uniq)(l).map((n=>o.a.createElement(w,{contextId:t,eventId:a,fieldName:n.fieldName,isDraggable:i,key:n.fieldName,values:Object(r.get)(n.prop,e)}))))}));j.displayName="GeoFields"},1396:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return y}));var n=a(2),r=a.n(n),i=a(45),o=a(17),s=a(1625),l=a.n(s),c=a(1628),u=a(44);const d=a.n(u).a.span.withConfig({displayName:"FlagWrapper",componentId:"sc-pwsog3-0"})(["position:relative;top:1px;"]),p=e=>e&&2===e.length?e.toUpperCase().replace(/./g,(e=>String.fromCharCode(55356,56741+e.charCodeAt(0)))):null,m=Object(n.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{Object(n.useEffect)((()=>{t&&Object(i.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c)}),[]);const a=p(e);return null!==a?t?r.a.createElement(o.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},r.a.createElement(d,{"data-test-subj":"country-flag"},a)):r.a.createElement(d,{"data-test-subj":"country-flag"},a):null}));m.displayName="CountryFlag";const y=Object(n.memo)((({countryCode:e,displayCountryNameOnHover:t=!1})=>{const[a,s]=Object(n.useState)(!1);Object(n.useEffect)((()=>{Object(i.isEmpty)(l.a.getNames("en"))&&l.a.registerLocale(c),s(!0)}),[]);const u=p(e);return null!==u&&a?t?r.a.createElement(o.EuiToolTip,{position:"top",content:l.a.getName(e,"en")},r.a.createElement(d,{"data-test-subj":"country-flag"},u)):r.a.createElement(r.a.Fragment,null,r.a.createElement(d,{"data-test-subj":"country-flag"},u),` ${l.a.getName(e,"en")}`):null}));y.displayName="CountryFlagAndName"},1397:function(e,t,a){"use strict";a.d(t,"c",(function(){return m})),a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return f}));var n=a(17),r=a(45),i=a(2),o=a.n(i),s=a(44),l=a.n(s),c=a(166),u=a(1101),d=a(155),p=a(1544);const m="event.start",y="event.end",g=l()(n.EuiIcon).withConfig({displayName:"TimeIcon",componentId:"sc-181wv62-0"})(["margin-right:3px;position:relative;top:-1px;"]);g.displayName="TimeIcon";const f=o.a.memo((({contextId:e,eventDuration:t,eventId:a,eventEnd:i,eventStart:s,isDraggable:l})=>o.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"duration-and-start-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=t?Object(r.uniq)(t).map((t=>o.a.createElement(n.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:u.b,id:`duration-event-start-end-default-draggable-${e}-${a}-${u.b}-${t}`,isDraggable:l,name:name,tooltipContent:null,value:t},o.a.createElement(n.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(p.a,{maybeDurationNanoseconds:t,tooltipTitle:u.b})))))):null,null!=s?Object(r.uniq)(s).map((t=>o.a.createElement(n.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:m,id:`duration-event-start-end-default-draggable-${e}-${a}-${m}-${t}`,isDraggable:l,tooltipContent:null,value:t},o.a.createElement(n.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(d.a,{fieldName:m,value:t})))))):null,null!=i?Object(r.uniq)(i).map((t=>o.a.createElement(n.EuiFlexItem,{grow:!1,key:t},o.a.createElement(c.b,{field:y,id:`duration-event-start-end-default-draggable-${e}-${a}-${y}-${t}`,isDraggable:l,tooltipContent:null,value:t},o.a.createElement(n.EuiText,{size:"xs"},o.a.createElement(g,{size:"m",type:"clock"}),o.a.createElement(d.a,{fieldName:y,value:t})))))):null)));f.displayName="DurationEventStartEnd"},1398:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(166),o=a(267);const s=({args:e,contextId:t,eventId:a,processTitle:n,isDraggable:s})=>Object(o.e)(e)&&Object(o.e)(n)?null:r.a.createElement(r.a.Fragment,null,null!=e&&e.map(((e,n)=>r.a.createElement(o.c,{key:`${t}-args-${n}-${e}`,grow:!1,component:"span"},r.a.createElement(i.c,{contextId:`${t}-args-${n}-${e}`,eventId:a,field:"process.args",isDraggable:s,value:e,fieldType:"keyword",isAggregatable:!0})))),!Object(o.e)(n)&&r.a.createElement(o.c,{grow:!1,component:"span"},r.a.createElement(i.c,{contextId:t,eventId:a,field:"process.title",isDraggable:s,value:n,fieldType:"keyword",isAggregatable:!0})));s.displayName="ArgsComponent";const l=r.a.memo(s);l.displayName="Args"},1399:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return s})),a.d(t,"f",(function(){return l})),a.d(t,"g",(function(){return c})),a.d(t,"e",(function(){return u}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.closeEventDetailsLabel",{defaultMessage:"close"}),i=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.placeholder",{defaultMessage:"Select an event to show event details"}),o=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.eventTitleLabel",{defaultMessage:"Event details"}),s=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.alertTitleLabel",{defaultMessage:"Alert details"}),l=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.technicalPreviewLabel",{defaultMessage:"Technical Preview"}),c=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.technicalPreviewDescription",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),u=n.i18n.translate("xpack.securitySolution.timeline.expandableEvent.shareAlert",{defaultMessage:"Share alert"})},1417:function(e,t,a){"use strict";a.d(t,"b",(function(){return Et})),a.d(t,"a",(function(){return It}));var n=a(23),r=a.n(n),i=a(17),o=a(2),s=a.n(o),l=a(44),c=a.n(l),u=a(9),d=a(211),p=a(428),m=a(1324),y=a(130),g=a(1305),f=a(470),b=a(318),h=a(266),v=a(1542),E=a(468);const x=c.a.div.withConfig({displayName:"EuiCodeEditorContainer",componentId:"sc-a6c5kq-0"})([".euiCodeEditorWrapper{position:absolute;}"]),k=s.a.memo((({rawEventData:e})=>{const t=Object(o.useMemo)((()=>JSON.stringify(e,E.i,2)),[e]);return s.a.createElement(x,null,s.a.createElement(i.EuiCodeBlock,{language:"json",fontSize:"m",paddingSize:"m",isCopyable:!0,"data-test-subj":"jsonView"},t))}));k.displayName="JsonView";var w=a(877),j=a(47),S=a(306),O=a(125),I=a(126),C=a(1148),M=a(1097);const T=({risk:e,riskEntity:t,originalRisk:a})=>{var n,r,o,l,c,u,d,p;const m=t===O.v.host?null==e||null===(n=e.result)||void 0===n||null===(r=n[0])||void 0===r||null===(o=r.host)||void 0===o||null===(l=o.risk)||void 0===l?void 0:l.calculated_level:null==e||null===(c=e.result)||void 0===c||null===(u=c[0])||void 0===u||null===(d=u.user)||void 0===d||null===(p=d.risk)||void 0===p?void 0:p.calculated_level;return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:s.a.createElement(M.a,{title:w.n(t),riskScoreEntity:t}),toolTipTitle:s.a.createElement(M.a,{title:w.n(t),riskScoreEntity:t}),toolTipContent:s.a.createElement(j.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.riskDataTooltipContent",defaultMessage:"Risk level is displayed only when available for a {riskEntity}. Ensure {riskScoreDocumentationLink} is enabled within your environment.",values:{riskEntity:t,riskScoreDocumentationLink:s.a.createElement(C.a,{riskScoreEntity:t,title:w.o(t)})}})}),e.loading&&s.a.createElement(i.EuiLoadingSpinner,{"data-test-subj":"loading"}),!e.loading&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Z,{field:w.a(t),value:m?s.a.createElement(S.a,{severity:m,hideBackgroundColor:!0}):Object(I.e)()}),a&&m!==a&&s.a.createElement(s.a.Fragment,null,s.a.createElement(Z,{field:w.l(t),value:s.a.createElement(S.a,{severity:a,hideBackgroundColor:!0})})))))},_=s.a.memo(T);var N=a(45),D=a(275),A=a(741),q=a(1080),F=a(127);const L=c.a.span.withConfig({displayName:"EnrichmentFieldFeedName",componentId:"sc-1cy82j8-0"})(["white-space:nowrap;font-style:italic;"]),R=c()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1cy82j8-1"})([".inlineActions{opacity:0;}.inlineActions-popoverOpen{opacity:1;}&:hover{.inlineActions{opacity:1;}}"]),P=({browserField:e,data:t,eventId:a,index:n,feedName:r,scopeId:l,value:c,isDraggable:u,isReadOnly:d})=>{const p=Object(o.useMemo)((()=>({scopeId:l})),[l]);if(!t||!c)return null;const m=`alert-details-value-formatted-field-value-${l}-${a}-${t.field}-${c}-${n}-${r}`;return s.a.createElement(R,{key:m,direction:"row",gutterSize:"xs",alignItems:"center"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement("div",null,s.a.createElement(q.a,{contextId:l,eventId:m,fieldFormat:t.format,fieldName:t.field,fieldType:t.type,isDraggable:u,isObjectArray:t.isObjectArray,value:c,truncate:!1}),r&&s.a.createElement(L,null," ",w.e," ",r))),s.a.createElement(i.EuiFlexItem,null,c&&!d&&s.a.createElement(D.c,{data:{field:t.field,value:c},triggerId:D.d.DETAILS_FLYOUT,mode:D.a.INLINE,sourcererScopeId:Object(F.getSourcererScopeId)(l),metadata:p,visibleCellActions:3})))},z=({browserFields:e,data:t,enrichments:a,scopeId:n,eventId:r,isDraggable:o,isReadOnly:l})=>{const c=a.map(((a,n)=>{var r,i,o,s;const{field:l,type:c,feedName:u,value:d}=Object(A.c)(a),p=t.find((e=>e.field===l)),m=null!==(r=null==p?void 0:p.category)&&void 0!==r?r:"",y=Object(N.get)([m,"fields",null!=l?l:""],e);return{fieldsData:{field:null!=l?l:"",format:null!==(i=null==y?void 0:y.format)&&void 0!==i?i:"",type:null!==(o=null==y?void 0:y.type)&&void 0!==o?o:"",isObjectArray:null!==(s=null==p?void 0:p.isObjectArray)&&void 0!==s&&s},type:c,feedName:u,index:n,field:l,browserField:y,value:d}})),[d,p]=Object(u.partition)(c,(({type:e})=>Object(A.e)(e)));return s.a.createElement(s.a.Fragment,null,p.length>0&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:w.f,toolTipContent:w.g}),p.map((({fieldsData:e,index:t,field:a,feedName:i,browserField:c,value:u})=>s.a.createElement(Z,{key:a,field:a,value:s.a.createElement(P,{eventId:r,index:t,feedName:i,scopeId:n,value:u,data:e,browserField:c,isDraggable:o,isReadOnly:l})}))))),d.length>0&&s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiPanel,{hasBorder:!0,paddingSize:"s",grow:!1},s.a.createElement(K,{title:w.h,toolTipContent:w.j}),d.map((({fieldsData:e,index:t,field:a,feedName:i,browserField:c,value:u})=>s.a.createElement(Z,{key:a,field:a,value:s.a.createElement(P,{eventId:r,index:t,feedName:i,scopeId:n,value:u,data:e,browserField:c,isDraggable:o,isReadOnly:l})}))))))},B=s.a.memo(z);var G=a(413),$=a(898);const H=c()(i.EuiTitle).withConfig({displayName:"UppercaseEuiTitle",componentId:"sc-1az7ye2-0"})(["text-transform:uppercase;"]),V=({children:e})=>s.a.createElement(H,{size:"xxxs"},s.a.createElement("h5",null,e)),U=c()(i.EuiTitle).withConfig({displayName:"StyledEnrichmentFieldTitle",componentId:"sc-1az7ye2-1"})(["width:220px;"]),W=({title:e})=>s.a.createElement(U,{size:"xxxs"},s.a.createElement("h6",null,e)),Y=c()(i.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1az7ye2-2"})(["font-size:",";margin-top:",";"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiSizeS)),Z=({field:e,value:t})=>s.a.createElement(Y,{direction:"row",gutterSize:"none",responsive:!0,alignItems:"center","data-test-subj":"EnrichedDataRow"},s.a.createElement(i.EuiFlexItem,{style:{flexShrink:0},grow:!1},s.a.createElement(W,{title:e})),s.a.createElement(i.EuiFlexItem,{className:"eui-textBreakWord"},t)),K=({title:e,toolTipContent:t,toolTipTitle:a})=>s.a.createElement(i.EuiFlexGroup,{direction:"row",gutterSize:"none",alignItems:"center"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement(V,null,e)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement($.b,{toolTipContent:t,toolTipTitle:null!=a?a:e}))),Q=({browserFields:e,data:t,enrichments:a,eventId:n,scopeId:r,hostRisk:o,userRisk:l,isDraggable:c,isReadOnly:u})=>{var d,p,m,y;const g=null==t||null===(d=t.find((e=>"host.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===d||null===(p=d.values)||void 0===p?void 0:p[0],f=null==t||null===(m=t.find((e=>"user.risk.calculated_level"===(null==e?void 0:e.field))))||void 0===m||null===(y=m.values)||void 0===y?void 0:y[0],b=Object(G.a)("entity-analytics");return b||0!==a.length?s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiHorizontalRule,null),s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,w.b)),s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m",style:{flexGrow:0}},b&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(_,{riskEntity:O.v.host,risk:o,originalRisk:g})),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(_,{riskEntity:O.v.user,risk:l,originalRisk:f}))),s.a.createElement(B,{browserFields:e,data:t,enrichments:a,scopeId:r,eventId:n,isDraggable:c,isReadOnly:u}))):null},X=s.a.memo(Q);var J=a(1323),ee=a(215),te=a(1277);const ae=c()(i.EuiInMemoryTable).withConfig({displayName:"SummaryTable",componentId:"sc-12oammb-0"})([".inlineActions{opacity:0;}.flyoutTableHoverActions{.inlineActions-popoverOpen{opacity:1;}&:hover{.inlineActions{opacity:1;}}}"]);var ne=a(1394),re=a(732),ie=a(151);const oe={flexGrow:0},se=({data:e,eventId:t,fieldFromBrowserField:a,isDraggable:n,linkValue:r,scopeId:i,values:o,isReadOnly:l})=>{const c=Object(re.e)(e.field);return s.a.createElement(s.a.Fragment,null,s.a.createElement(ne.a,{contextId:i,data:e,eventId:t,fieldFromBrowserField:a,linkValue:r,isDraggable:n,style:oe,values:o}),i!==ie.f.active&&!l&&c&&s.a.createElement(D.c,{data:{field:e.field,value:o},triggerId:D.d.DETAILS_FLYOUT,mode:D.a.INLINE,visibleCellActions:3,sourcererScopeId:Object(F.getSourcererScopeId)(i),metadata:{scopeId:i}}))};se.displayName="SummaryValueCell";var le=a(379),ce=a(670),ue=a(879);const de=({data:e,eventId:t,fieldFromBrowserField:a,linkValue:n,scopeId:r,values:o})=>{const{loading:l,count:c}=Object(ue.a)({field:e.field,isActiveTimelines:r===ie.f.active,value:o,signalIndexName:null}),u=Object(ce.c)({contextId:r,eventId:t,field:e.field,fieldFormat:e.format,fieldFromBrowserField:a,fieldType:e.type,isObjectArray:e.isObjectArray,linkValue:n,values:o});return l?s.a.createElement(i.EuiLoadingSpinner,null):"number"==typeof c&&null!=u&&u.dataProviders&&null!=u&&u.dataProviders.length?s.a.createElement(le.a,{asEmptyButton:!0,dataProviders:u.dataProviders,filters:u.filters},s.a.createElement("span",{"data-test-subj":"alert-prevalence"},c)):Object(I.d)()};de.displayName="PrevalenceCell";const pe=[{field:"title",truncateText:!1,name:ee.o,textOnly:!0},{field:"description",truncateText:!1,render:se,name:ee.p}],me=[...pe,{field:"description",truncateText:!0,render:e=>s.a.createElement(de,e),name:s.a.createElement(s.a.Fragment,null,ee.m," ",s.a.createElement(i.EuiIconTip,{type:"iInCircle",color:"subdued",title:ee.m,content:s.a.createElement("span",null,ee.n)})),align:"right",width:"130px"}],ye={className:"flyoutTableHoverActions"},ge=({goToTable:e,rows:t,title:a,isReadOnly:n})=>{const r=n?pe:me;return s.a.createElement("div",null,s.a.createElement(i.EuiFlexGroup,null,s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,a))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiLink,{onClick:e,"data-test-subj":"summary-view-go-to-table-link"},s.a.createElement(i.EuiText,{size:"xs"},ee.F)))),s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(ae,{"data-test-subj":"summary-view",items:t,columns:r,rowProps:ye,compressed:!0}))},fe=s.a.memo(ge),be=({browserFields:e,data:t,eventId:a,isDraggable:n,scopeId:r,title:i,goToTable:l,isReadOnly:c,investigationFields:u})=>{const d=Object(y.a)("sentinelOneManualHostActionsEnabled"),p=Object(o.useMemo)((()=>Object(te.c)({browserFields:e,data:t,eventId:a,isDraggable:n,scopeId:r,isReadOnly:c,investigationFields:u,sentinelOneManualHostActionsEnabled:d})),[e,t,a,n,r,c,u,d]);return s.a.createElement(fe,{goToTable:l,isReadOnly:c,rows:p,title:i})},he=s.a.memo(be);var ve=a(962),Ee=a(1289),xe=a(404),ke=a(69),we=a(197),je=a(285);const Se=ke.euiStyled.div`
  margin-left: ${({theme:e})=>e.eui.euiSizeS};
`,Oe=Object(ke.euiStyled)(i.EuiPanel)`
  &&& {
    background-color: ${({theme:e})=>e.eui.euiColorLightestShade};
    padding: ${({theme:e})=>e.eui.euiSizeS};
    height: 78px;
  }

  &:hover {
    .inlineActions {
      opacity: 1;
      width: auto;
      transform: translate(0);
    }
  }

  .inlineActions {
    opacity: 0;
    width: 0;
    transform: translate(6px);
    transition: transform 50ms ease-in-out;

    &.inlineActions-popoverOpen {
      opacity: 1;
      width: auto;
      transform: translate(0);
    }
   }
`,Ie=({title:e,children:t})=>s.a.createElement(Oe,{borderRadius:"none",hasShadow:!1,hasBorder:!1,paddingSize:"s"},s.a.createElement(i.EuiText,{size:"s"},e),s.a.createElement(i.EuiSpacer,{size:"s"}),t);Ie.displayName="OverviewCard";const Ce=ke.euiStyled.div`
  /* Clamp text content to 2 lines */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
`;Ce.displayName="ClampedContent";const Me=({title:e,children:t,contextId:a,dataTestSubj:n,enrichedFieldInfo:r})=>s.a.createElement(Ie,{title:e},s.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(Ce,{"data-test-subj":n},t),s.a.createElement(Se,null,s.a.createElement(D.c,{data:{field:r.data.field,value:null==r?void 0:r.values},triggerId:D.d.DETAILS_FLYOUT,mode:D.a.INLINE,sourcererScopeId:Object(F.getSourcererScopeId)(a),metadata:{scopeId:a},visibleCellActions:3}))));Me.displayName="OverviewCardWithActions";var Te=a(1492),_e=a(567),Ne=a(283),De=a(763);const Ae=Object(ke.euiStyled)(i.EuiFlexGroup)`
  flex-grow: 0;
`,qe=s.a.memo((({browserFields:e,contextId:t,data:a,eventId:n,handleOnEventClosed:r,scopeId:l,isReadOnly:c})=>{const u=Object(o.useMemo)((()=>{const r=Object(N.find)({field:je.o,category:"kibana"},a);return r&&Object(re.b)({eventId:n,contextId:t,scopeId:l,browserFields:e,item:r})}),[e,t,a,n,l]),d=Object(o.useMemo)((()=>{const r=Object(N.find)({field:"kibana.alert.severity",category:"kibana"},a);return r&&Object(re.b)({eventId:n,contextId:t,scopeId:l,browserFields:e,item:r})}),[e,t,a,n,l]),p=Object(o.useMemo)((()=>{const r=Object(N.find)({field:"kibana.alert.risk_score",category:"kibana"},a);return r&&Object(re.b)({eventId:n,contextId:t,scopeId:l,browserFields:e,item:r})}),[e,t,a,n,l]),m=Object(o.useMemo)((()=>{const r=Object(N.find)({field:je.n,category:"kibana"},a),i=Object(N.find)({field:"kibana.alert.rule.uuid",category:"kibana"},a);return r&&Object(re.b)({eventId:n,contextId:t,scopeId:l,browserFields:e,item:r,linkValueField:i})}),[e,t,a,n,l]),y=Fe(u)&&!c?s.a.createElement(i.EuiFlexItem,{key:"status"},s.a.createElement(Me,{title:we.L,enrichedFieldInfo:u,contextId:t},s.a.createElement(Te.a,{eventId:n,contextId:t,enrichedFieldInfo:u,scopeId:l,handleOnEventClosed:r}))):null,g=Fe(d)?s.a.createElement(i.EuiFlexItem,{key:"severity"},c?s.a.createElement(Ie,{title:we.u},s.a.createElement(_e.a,{value:d.values[0]})):s.a.createElement(Me,{title:we.u,enrichedFieldInfo:d,contextId:t},s.a.createElement(_e.a,{value:d.values[0]}))):null,f=Fe(p)?s.a.createElement(i.EuiFlexItem,{key:"riskScore"},c?s.a.createElement(Ie,{title:we.q},p.values[0]):s.a.createElement(Me,{title:we.q,enrichedFieldInfo:p,contextId:t,dataTestSubj:"riskScore"},p.values[0])):null,b=Fe(m)&&!c?s.a.createElement(i.EuiFlexItem,{key:"ruleName"},s.a.createElement(Me,{title:we.r,enrichedFieldInfo:m,contextId:t},s.a.createElement(q.a,{contextId:t,eventId:n,value:m.values[0],fieldName:m.data.field,linkValue:m.linkValue,fieldType:m.data.type,fieldFormat:m.data.format,isDraggable:!1,truncate:!1}))):null,{width:h,ref:v}=Object(Ne.b)(),E=0===h||h&&h>=675,x=[y,g,f,b].filter(De.h),k=E?s.a.createElement(Ae,{gutterSize:"s"},x):s.a.createElement(s.a.Fragment,null,Object(N.chunk)(2,x).map(((e,t,{length:a})=>{const n=t<a-1;return s.a.createElement(o.Fragment,{key:t},s.a.createElement(Ae,{gutterSize:"s"},e),n&&s.a.createElement(i.EuiSpacer,{size:"s"}))})));return s.a.createElement("div",{ref:v},k)}));function Fe(e){return!!e&&Array.isArray(e.values)}qe.displayName="Overview";var Le=a(142),Re=a(39),Pe=a(568);function ze(e){return Boolean(e&&e.values&&e.values.length)}var Be=a(18),Ge=a(1064);const $e=Object(ke.euiStyled)(i.EuiAccordion)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
`,He=s.a.memo((({prefix:e,state:t,text:a,renderContent:n,onToggle:r=N.noop,extraAction:o,forceState:l})=>{const c=Object(i.useGeneratedHtmlId)({prefix:e});switch(t){case"loading":return s.a.createElement($e,{id:c,buttonContent:a,onToggle:r,isLoading:!0});case"error":return s.a.createElement($e,{id:c,buttonContent:s.a.createElement("span",null,s.a.createElement(i.EuiIcon,{type:"warning",color:"danger",style:{marginRight:"6px"}}),a),onToggle:r,extraAction:o});case"success":return s.a.createElement($e,{"tour-step":`${e}-accordion`,"data-test-subj":`${e}-accordion`,id:c,buttonContent:a,onToggle:r,paddingSize:"l",extraAction:o,forceState:l},n());default:return null}}));He.displayName="InsightAccordion";var Ve=a(155),Ue=a(1491);const We=["@timestamp","kibana.alert.rule.name","kibana.alert.severity"],Ye=[{field:"kibana.alert.rule.name",name:"Rule"},{field:"@timestamp",name:"@timestamp",render:e=>s.a.createElement(Ve.c,{value:new Date(e)})},{field:"kibana.alert.severity",name:"Severity",render:e=>s.a.createElement(_e.a,{value:e})}],Ze=s.a.memo((({alertIds:e})=>{const t=Object(o.useMemo)((()=>e.slice(0,10)),[e]),{loading:a,error:n,data:r}=Object(Ue.a)({alertIds:t,fields:We}),l=Object(o.useMemo)((()=>{if(r)return r.map((e=>e.fields))}),[r]);if(a)return s.a.createElement(i.EuiSkeletonText,{lines:2});if(n)return s.a.createElement(s.a.Fragment,null,Pe.p);if(l){const t=e.length>10;return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement("div",null,s.a.createElement("em",null,Pe.q),s.a.createElement(i.EuiSpacer,null)),s.a.createElement(i.EuiBasicTable,{compressed:!0,items:l,columns:Ye}))}return null}));Ze.displayName="SimpleAlertTable";const Ke=s.a.memo((({originalDocumentId:e,index:t,eventId:a,scopeId:n})=>{const[r,i]=Object(o.useState)(!1),[l,c]=Object(o.useState)({}),u=Object(o.useCallback)((e=>i(e)),[]),d=Object(o.useCallback)((()=>r?l.alertIds?s.a.createElement(Xe,{eventId:a,scopeId:n,alertIds:l.alertIds}):s.a.createElement(Qe,{index:t,originalDocumentId:e,eventId:a,isActiveTimelines:Object(F.isActiveTimeline)(null!=n?n:""),onCacheLoad:c}):null),[r,l.alertIds,t,e,a,n]);return s.a.createElement(He,{prefix:"RelatedAlertsByProcessAncestry",state:"success",text:l.alertIds?Object(Pe.h)(l.alertIds.length):Pe.g,renderContent:d,onToggle:u})}));Ke.displayName="RelatedAlertsByProcessAncestry";const Qe=({originalDocumentId:e,index:t,isActiveTimelines:a,onCacheLoad:n,eventId:r})=>{const{values:l}=t,{values:c}=e,u=Array.isArray(c)?c[0]:"",{loading:d,error:p,alertIds:m}=Object(Ge.a)({isActiveTimeline:a,documentId:u,indices:null!=l?l:[]});return Object(o.useEffect)((()=>{m&&0!==m.length&&n({alertIds:m})}),[m,n]),d?s.a.createElement(i.EuiLoadingSpinner,null):p?s.a.createElement(s.a.Fragment,null,Pe.j):m&&0!==m.length?null:s.a.createElement(s.a.Fragment,null,Pe.i)};Qe.displayName="FetchAndNotifyCachedAlertsByProcessAncestry";const Xe=({alertIds:e,eventId:t,scopeId:a})=>{const n=e&&e.length&&e.length>=5,r=Object(o.useMemo)((()=>e&&e.length?n?null:e.reduce(((e,n,r)=>{const i=`${a}-${t}-event.id-${r}-${n}`;return e.push(Object(ce.a)("_id",i,n)),e}),[]):null),[e,n,a,t]),l=Object(o.useMemo)((()=>n?[{meta:{alias:Pe.k,type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null),[e,n]);return r||l?s.a.createElement(s.a.Fragment,null,s.a.createElement(Ze,{alertIds:e}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:r,filters:l,"data-test-subj":"investigate-ancestry-in-timeline"},we.i)):null};Xe.displayName="ActualRelatedAlertsByProcessAncestry";var Je=a(526),et=a(110),tt=a(137),at=a(4);const nt=s.a.memo((({eventId:e})=>{const{services:{cases:t}}=Object(et.i)(),a=Object(et.m)(),[n,r]=Object(o.useState)(void 0),[i,l]=Object(o.useState)(!1),{activeStep:c,isTourShown:u}=Object(Je.b)(),d=Object(o.useMemo)((()=>c===h.a.viewCase&&u(h.b.alertsCases)),[c,u]),p=Object(o.useCallback)((()=>function(e=[]){const t=e.length;return s.a.createElement("span",null,s.a.createElement(j.FormattedMessage,{defaultMessage:"This alert was found in {caseCount}",id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content",values:{caseCount:s.a.createElement("strong",null,s.a.createElement(j.FormattedMessage,{id:"xpack.securitySolution.alertDetails.overview.insights_related_cases_found_content_count",defaultMessage:"{caseCount} {caseCount, plural, =0 {cases.} =1 {case:} other {cases:}}",values:{caseCount:t}}))}}),e.map((({id:t,title:a},n)=>t&&a?s.a.createElement("span",{key:t}," ",s.a.createElement(tt.a,{detailName:t,title:a,index:n},a),e[n+1]?",":""):s.a.createElement(s.a.Fragment,null))))}(n)),[n]),[m,y]=Object(o.useState)(!1);Object(o.useEffect)((()=>{if(!m)return;let n=!1;return(async()=>{let i=[];try{var o;e&&(i=null!==(o=await t.api.getRelatedCases(e,{owner:at.i}))&&void 0!==o?o:[])}catch(e){n||l(!0),a.addWarning(Object(Pe.c)(e))}n||(r(i),y(!1))})(),()=>{n=!0}}),[t.api,e,m,a]),Object(o.useEffect)((()=>{y(!0)}),[e]);let g="loading";return i?g="error":n&&(g="success"),s.a.createElement(He,{prefix:"RelatedCases",state:g,text:rt(g,null==n?void 0:n.length),renderContent:p,forceState:d?"open":void 0})}));function rt(e,t=0){switch(e){case"loading":return Pe.d;case"error":return Pe.b;case"success":return Object(Pe.a)(t);default:return""}}nt.displayName="RelatedCases";const it=s.a.memo((({browserFields:e,data:t,eventId:a,scopeId:n})=>{const{field:r,values:l}=t,{error:c,count:u,alertIds:d}=Object(ue.a)({field:r,value:l,isActiveTimelines:Object(F.isActiveTimeline)(n),signalIndexName:null,includeAlertIds:!0}),{fieldFromBrowserField:p}=Object(re.b)({browserFields:e,contextId:n,eventId:a,field:{id:t.field},scopeId:n,item:t}),m=Object(ce.c)({field:r,values:l,contextId:n,eventId:a,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),y=0===u;let g="loading";c?g="error":d&&(g="success");const f=Object(o.useCallback)((()=>d&&null!=m&&m.dataProviders?y&&"loading"!==g?Pe.s:s.a.createElement(s.a.Fragment,null,s.a.createElement(Ze,{alertIds:d}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},we.i)):null),[d,null==m?void 0:m.dataProviders,y,g]);return s.a.createElement(He,{prefix:"RelatedAlertsBySourceEvent",state:g,text:ot(g,u),renderContent:f})}));function ot(e,t){switch(e){case"loading":return Pe.u;case"error":return Pe.t;case"success":return Object(Pe.r)(t);default:return""}}it.displayName="RelatedAlertsBySourceEvent";const st=s.a.memo((({browserFields:e,data:t,eventId:a,scopeId:n})=>{const{field:r,values:l}=t,{error:c,count:u,alertIds:d}=Object(ue.a)({field:r,value:l,isActiveTimelines:Object(F.isActiveTimeline)(n),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0}),{fieldFromBrowserField:p}=Object(re.b)({browserFields:e,contextId:n,eventId:a,field:{id:t.field},scopeId:n,item:t}),m=Object(ce.c)({field:r,values:l,contextId:n,eventId:a,fieldFromBrowserField:p,fieldFormat:null==p?void 0:p.format,fieldType:null==p?void 0:p.type}),y=0===u;let g="loading";c?g="error":(d||y)&&(g="success");const f=Object(o.useCallback)((()=>d&&null!=m&&m.dataProviders?y&&"loading"!==g?Pe.m:s.a.createElement(s.a.Fragment,null,s.a.createElement(Ze,{alertIds:d}),s.a.createElement(i.EuiSpacer,null),s.a.createElement(le.a,{asEmptyButton:!1,dataProviders:null==m?void 0:m.dataProviders},we.i)):null),[d,null==m?void 0:m.dataProviders,y,g]);return s.a.createElement(He,{prefix:"RelatedAlertsBySession",state:g,text:lt(g,u),renderContent:f})}));function lt(e,t){switch(e){case"loading":return Pe.o;case"error":return Pe.n;case"success":return Object(Pe.l)(t);default:return""}}st.displayName="RelatedAlertsBySession";const ct=ke.euiStyled.div`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 12px;
  border-radius: 6px;
`,ut=Object(ke.euiStyled)(i.EuiIcon)`
  margin-right: 10px;
`,dt=s.a.memo((()=>{const{application:e}=Object(et.i)().services;return s.a.createElement(ct,null,s.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(ut,{size:"m",type:"lock"})),s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiText,{size:"s"},s.a.createElement(i.EuiLink,{color:"subdued",target:"_blank",href:e.getUrlForApp("management",{path:"stack/license_management/home"})},Pe.f)))))}));dt.displayName="RelatedAlertsUpsell";const pt=Object(ke.euiStyled)(i.EuiFlexItem)`
  border: 1px solid ${({theme:e})=>e.eui.euiColorLightShade};
  padding: 10px 8px;
  border-radius: 6px;
  display: inline-flex;
`,mt=s.a.memo((({browserFields:e,eventId:t,data:a,isReadOnly:n,scopeId:r})=>{const{cases:o}=Object(et.i)().services,l=Object(y.a)("insightsRelatedAlertsByProcessAncestry"),c=Object(Be.b)().isPlatinumPlus(),u=Object(N.find)({category:"kibana",field:"kibana.alert.ancestors.id"},a),d=Object(N.find)({category:"kibana",field:"kibana.alert.rule.parameters.index"},a),p=Object(N.find)({category:"agent",field:"agent.type"},a),m=Object(N.find)({category:"event",field:"event.module"},a),g=ze(Object(N.find)({category:"process",field:"process.entity_id"},a))&&function(e,t){return ze(e)&&("endpoint"===e.values[0]||"winlogbeat"===e.values[0]&&ze(t)&&"sysmon"===t.values[0])}(p,m),f=Object(N.find)({category:"process",field:"process.entry_leader.entity_id"},a),b=l&&ze(f),h=Object(N.find)({category:"kibana",field:"kibana.alert.original_event.id"},a),v=ze(h),E=Object(N.find)({category:"kibana",field:Le.cb},a),x=ze(E),k=o.helpers.canUseCases([Re.APP_ID]).read,w=l&&g&&u&&d;return n||!(k||g||v||b)?null:s.a.createElement("div",null,s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"m"},s.a.createElement(i.EuiFlexItem,null,s.a.createElement(i.EuiTitle,{size:"xxxs"},s.a.createElement("h5",null,Pe.e))),x&&s.a.createElement(pt,null,s.a.createElement("div",null,s.a.createElement(i.EuiIcon,{type:"layers",style:{marginLeft:"4px",marginRight:"8px"}}),Pe.v(parseInt(E.values[0],10)),s.a.createElement(i.EuiBetaBadge,{label:Pe.w,style:{verticalAlign:"middle",marginLeft:"8px"},size:"s"}))),k&&s.a.createElement(i.EuiFlexItem,null,s.a.createElement(nt,{eventId:t})),h&&h.values&&s.a.createElement(i.EuiFlexItem,null,s.a.createElement(it,{browserFields:e,data:h,eventId:t,scopeId:r})),f&&f.values&&s.a.createElement(i.EuiFlexItem,{"data-test-subj":"related-alerts-by-session"},s.a.createElement(st,{browserFields:e,data:f,eventId:t,scopeId:r})),w&&(c?s.a.createElement(i.EuiFlexItem,{"data-test-subj":"related-alerts-by-ancestry"},s.a.createElement(Ke,{originalDocumentId:u,index:d,eventId:t,scopeId:r})):s.a.createElement(i.EuiFlexItem,null,s.a.createElement(dt,null)))))}));mt.displayName="Insights";var yt=a(479);const gt={cursorStart:0,querySize:1};var ft=a(960),bt=a(267),ht=a(572),vt=a(1303);let Et;!function(e){e.tableView="table-view",e.jsonView="json-view",e.summaryView="summary-view",e.threatIntelView="threat-intel-view",e.osqueryView="osquery-results-view",e.responseActionsView="response-actions-results-view"}(Et||(Et={}));const xt=c()(i.EuiTabbedContent).withConfig({displayName:"StyledEuiTabbedContent",componentId:"sc-xa1bmm-0"})(["display:flex;flex:1;flex-direction:column;overflow:hidden;> [role='tabpanel']{display:flex;flex:1;flex-direction:column;overflow:hidden;overflow-y:auto;::-webkit-scrollbar{-webkit-appearance:none;width:7px;}::-webkit-scrollbar-thumb{border-radius:4px;background-color:rgba(0,0,0,0.5);-webkit-box-shadow:0 0 1px rgba(255,255,255,0.5);}}"]),kt=c.a.div.withConfig({displayName:"TabContentWrapper",componentId:"sc-xa1bmm-1"})(["height:100%;position:relative;"]),wt=c.a.div.withConfig({displayName:"RendererContainer",componentId:"sc-xa1bmm-2"})(["overflow-x:auto;padding-right:",";& ."," .euiFlexGroup{justify-content:flex-start;}"],(e=>e.theme.eui.euiSizeXS),bt.a),jt=c()(i.EuiFlexGroup).withConfig({displayName:"ThreatTacticContainer",componentId:"sc-xa1bmm-3"})(["flex-grow:0;flex-wrap:nowrap;& .euiFlexGroup{flex-wrap:nowrap;}"]),St=c.a.div.withConfig({displayName:"ThreatTacticDescription",componentId:"sc-xa1bmm-4"})(["padding-left:",";"],(e=>e.theme.eui.euiSizeL)),Ot=({browserFields:e,data:t,detailsEcsData:a,id:n,isAlert:l,isDraggable:c,rawEventData:E,scopeId:x,timelineTabType:w,handleOnEventClosed:j,isReadOnly:S})=>{const[I,C]=Object(o.useState)(Et.summaryView),M=Object(o.useCallback)((e=>C(e.id)),[]),T=Object(o.useCallback)((()=>C(Et.tableView)),[]),_=Object(o.useMemo)((()=>Object(A.b)(t)),[t]),N=Object(d.b)(t),{rule:D}=Object(p.a)(N.ruleId),q=Object(o.useMemo)((()=>l?Object(A.f)(t).map((e=>Object(A.g)(e))):[]),[t,l]),{result:F,loading:L,setRange:R,range:P}=Object(ve.c)(_),z=Object(o.useMemo)((()=>Object(g.a)(E)),[E]),B=Object(o.useMemo)((()=>L||null==F||!F.enrichments?q:Object(A.a)([...q,...F.enrichments])),[L,F,q]),G=B.length,{hostRisk:$,userRisk:H,isAuthorized:V}=(e=>{const{hostName:t,userName:a}=Object(d.b)(e),n=Object(o.useMemo)((()=>t?Object(O.B)([t]):void 0),[t]),{data:r,loading:i,isAuthorized:s,isModuleEnabled:l}=Object(yt.c)({filterQuery:n,pagination:gt,riskEntity:O.v.host,skip:!n}),c=Object(o.useMemo)((()=>({loading:i,isModuleEnabled:l,result:r})),[r,i,l]),u=Object(o.useMemo)((()=>a?Object(O.C)([a]):void 0),[a]),{data:p,loading:m,isAuthorized:y,isModuleEnabled:g}=Object(yt.c)({filterQuery:u,pagination:gt,riskEntity:O.v.user,skip:!u});return{userRisk:Object(o.useMemo)((()=>({loading:m,isModuleEnabled:g,result:p})),[m,g,p]),hostRisk:c,isAuthorized:s&&y}})(t),U=Object(o.useMemo)((()=>null!=a?Object(ft.a)({data:a,rowRenderers:ht.b}):null),[a]),W=Object(o.useMemo)((()=>Object(b.c)(x)),[x]),Y=Object(o.useMemo)((()=>G>0||V&&($||H)),[G,$,V,H]),Z=Object(y.a)("endpointResponseActionsEnabled"),K=Object(o.useMemo)((()=>{var r,o;return l?{id:Et.summaryView,name:ee.v,"data-test-subj":"overviewTab",content:s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(qe,{browserFields:e,contextId:x,data:t,eventId:n,scopeId:x,handleOnEventClosed:j,isReadOnly:S}),s.a.createElement(i.EuiSpacer,{size:"l"}),z&&z[0]&&s.a.createElement(jt,{alignItems:"flexStart",direction:"column",wrap:!1,gutterSize:"none"},s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiTitle,{size:"xxs"},s.a.createElement("h5",null,z[0].title)),s.a.createElement(St,null,z[0].description))),s.a.createElement(i.EuiSpacer,{size:"l"}),null!=U&&null!=a&&s.a.createElement("div",null,s.a.createElement(i.EuiTitle,{size:"xs"},s.a.createElement("h5",null,ee.c)),s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(wt,{"data-test-subj":"renderer"},U.renderRow({contextId:"event-details",data:a,isDraggable:null!=c&&c,scopeId:x}))),s.a.createElement(i.EuiHorizontalRule,null),s.a.createElement(he,{data:t,eventId:n,browserFields:e,isDraggable:c,scopeId:x,title:ee.l,isReadOnly:S,goToTable:T,investigationFields:null!==(r=null==D||null===(o=D.investigation_fields)||void 0===o?void 0:o.field_names)&&void 0!==r?r:[]}),s.a.createElement(i.EuiSpacer,{size:"xl"}),s.a.createElement(mt,{browserFields:e,eventId:n,data:t,scopeId:x,isReadOnly:S}),Y&&s.a.createElement(X,{isDraggable:c,hostRisk:$,userRisk:H,browserFields:e,data:t,eventId:n,scopeId:x,enrichments:B,isReadOnly:S}),L&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSkeletonText,{lines:2})),N.ruleId&&(null==D?void 0:D.note)&&s.a.createElement(xe.b,{basicData:N,ruleNote:D.note}))}:void 0}),[l,e,x,t,n,j,S,z,U,a,c,T,null==D?void 0:D.investigation_fields,null==D?void 0:D.note,Y,$,H,B,L,N]),Q=Object(o.useMemo)((()=>l&&!S?{id:Et.threatIntelView,"data-test-subj":"threatIntelTab",name:ee.C,append:s.a.createElement(s.a.Fragment,null,L?s.a.createElement(i.EuiLoadingSpinner,null):s.a.createElement(i.EuiNotificationBadge,{"data-test-subj":"enrichment-count-notification"},G)),content:s.a.createElement(J.a,{before:s.a.createElement(i.EuiSpacer,{size:"m"}),loading:L,enrichments:B,showInvestigationTimeEnrichments:!Object(u.isEmpty)(_)},s.a.createElement(s.a.Fragment,null,s.a.createElement(Ee.a,{setRange:R,loading:L,range:P}),s.a.createElement(i.EuiSpacer,{size:"m"})))}:void 0),[B,R,P,G,l,_,L,S]),te=Object(o.useMemo)((()=>({id:Et.tableView,"data-test-subj":"tableTab",name:ee.B,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"l"}),s.a.createElement(v.a,{browserFields:e,data:t,eventId:n,isDraggable:c,scopeId:x,timelineTabType:w,isReadOnly:S}))})),[e,t,n,c,x,w,S]),ae=Object(o.useMemo)((()=>({id:Et.jsonView,"data-test-subj":"jsonViewTab",name:ee.r,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(kt,{"data-test-subj":"jsonViewWrapper"},s.a.createElement(k,{rawEventData:E})))})),[E]),ne=Object(m.a)({rawEventData:E,...null!==a?{ecsData:a}:{}}),re=Object(vt.a)({rawEventData:E,...null!==a?{ecsData:a}:{}}),ie=Object(o.useMemo)((()=>Z?[ne]:[re]),[Z,re,ne]),oe=Object(o.useMemo)((()=>[K,Q,te,ae,...ie].filter((e=>!!e))),[K,Q,te,ae,ie]),se=Object(o.useMemo)((()=>{var e;return null!==(e=oe.find((e=>e.id===I)))&&void 0!==e?e:oe[0]}),[oe,I]),le=Object(o.useMemo)((()=>W?{"tour-step":Object(h.c)(3,h.b.alertsCases)}:{}),[W]);return s.a.createElement(f.a,{isTourAnchor:W,step:h.a.reviewAlertDetailsFlyout,tourId:h.b.alertsCases},s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(xt,r()({},le,{"data-test-subj":"eventDetails",tabs:oe,selectedTab:se,onTabClick:M,key:"event-summary-tabs"}))))};Ot.displayName="EventDetailsComponent";const It=s.a.memo(Ot)},1420:function(e,t,a){"use strict";a.d(t,"a",(function(){return H}));var n=a(45),r=a(2),i=a.n(r),o=a(44),s=a.n(o),l=a(17),c=a(139),u=a(56),d=a.n(u),p=a(231),m=a(1546),y=a(5);const g=y.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.title",{defaultMessage:"Linked to shared list"}),f=y.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToListSection.error",{defaultMessage:"Unable to fetch exception list."});var b=a(1103);const h=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1rq9jba-0"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),v=({isLoadingReferences:e,errorFetchingReferences:t,listAndReferences:a})=>{const[n,o]=Object(r.useState)(i.a.createElement(l.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemListsTableLoading"})),[s,c]=Object(r.useState)(void 0);return Object(r.useEffect)((()=>{t?c(f):e||o(void 0)}),[t,e]),i.a.createElement(l.EuiPanel,{paddingSize:"none",hasShadow:!1,"data-test-subj":"exceptionItemLinkedToListSection"},i.a.createElement(h,{size:"xs"},i.a.createElement("h3",null,g)),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiInMemoryTable,{tableCaption:"Table of exception lists",itemId:"id",message:n,loading:e,items:a,error:s,columns:Object(b.d)(),isSelectable:!1,sorting:!0,"data-test-subj":"exceptionItemSharedList"}))},E=i.a.memo(v);E.displayName="ExceptionsLinkedToLists";const x=y.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.linkedToRule.title",{defaultMessage:"Linked to rule"}),k=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-6bqv6k-0"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),w=({rule:e})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(k,{size:"xs","data-test-subj":"exceptionItemLinkedToRuleSection"},i.a.createElement("h3",null,x)),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(l.EuiInMemoryTable,{tableCaption:"Rules table",itemId:"id",items:[e],columns:Object(b.c)(),sorting:!0,"data-test-subj":"addExceptionToRulesTable"})),j=i.a.memo(w);j.displayName="ExceptionsLinkedToRule";var S=a(1531),O=a(1547),I=a(1473),C=a(1532),M=a(1474),T=a(1440);const _=y.i18n.translate("xpack.securitySolution.ruleExceptions.editException.cancel",{defaultMessage:"Cancel"}),N=y.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editExceptionTitle",{defaultMessage:"Edit rule exception"}),D=y.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editEndpointExceptionTitle",{defaultMessage:"Edit endpoint exception"}),A=y.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessTitle",{defaultMessage:"Rule exception updated"}),q=y.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastErrorTitle",{defaultMessage:"Error updating exception"});var F=a(117),L=a(1475),R=a(1548);const P=s()(l.EuiFlyoutHeader).withConfig({displayName:"FlyoutHeader",componentId:"sc-1j5dcqi-0"})(["",""],(({theme:e})=>Object(o.css)(["border-bottom:1px solid ",";"],e.eui.euiColorLightShade))),z=s()(l.EuiFlyoutBody).withConfig({displayName:"FlyoutBodySection",componentId:"sc-1j5dcqi-1"})(["",""],(()=>Object(o.css)(["&.builder-section{overflow-y:scroll;}"]))),B=s()(l.EuiFlexGroup).withConfig({displayName:"FlyoutFooterGroup",componentId:"sc-1j5dcqi-2"})(["",""],(({theme:e})=>Object(o.css)(["padding:",";"],e.eui.euiSizeS))),G=s()(l.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1j5dcqi-3"})(["",""],(()=>Object(o.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),$=({list:e,itemToEdit:t,rule:a,showAlertCloseOptions:o,openedFromListDetailPage:s,onCancel:u,onConfirm:g})=>{var f;const h=Object(r.useMemo)((()=>t.os_types),[t]),v=Object(r.useMemo)((()=>null!=a?[a]:null),[a]),x=Object(r.useMemo)((()=>e.type),[e]),{isLoading:k,indexPatterns:w,getExtendedFields:$}=Object(I.a)(v),[H,V]=(()=>{const{addSuccess:e,addError:t,addWarning:a}=Object(F.a)(),[n,i]=Object(L.a)(),[o,s]=Object(r.useState)(!1),l=Object(r.useRef)(null);return Object(r.useEffect)((()=>{let a=!0;const n=new AbortController;return l.current=async({itemsToUpdate:n})=>{var r,o;if(null!=i)try{s(!0),await i(n),e({title:A,text:(r=n.map((({name:e})=>e)).join(", "),o=n.length,y.i18n.translate("xpack.securitySolution.ruleExceptions.editException.editRuleExceptionToastSuccessText",{values:{exceptionItemName:r,numItems:o},defaultMessage:"{numItems, plural, =1 {Exception} other {Exceptions}} - {exceptionItemName} - {numItems, plural, =1 {has} other {have}} been updated."}))}),a&&s(!1)}catch(e){if(a)throw s(!1),t(e,{title:q}),new Error(e)}},()=>{a=!1,n.abort()}}),[e,t,a,i]),[o||n,l.current]})(),[U,W]=Object(C.a)(),[{exceptionItems:Y,exceptionItemMeta:{name:Z},newComment:K,commentErrorExists:Q,bulkCloseAlerts:X,disableBulkClose:J,bulkCloseIndex:ee,entryErrorExists:te,expireTime:ae,expireErrorExists:ne},re]=Object(r.useReducer)(((e,t)=>{switch(t.type){case"setExceptionItemMeta":{const{value:a}=t;return{...e,exceptionItemMeta:{...e.exceptionItemMeta,[a[0]]:a[1]}}}case"setComment":{const{comment:a}=t;return{...e,newComment:a}}case"setCommentError":{const{errorExists:a}=t;return{...e,commentErrorExists:a}}case"setBulkCloseAlerts":{const{bulkClose:a}=t;return{...e,bulkCloseAlerts:a}}case"setDisableBulkCloseAlerts":{const{disableBulkCloseAlerts:a}=t;return{...e,disableBulkClose:a}}case"setBulkCloseIndex":{const{bulkCloseIndex:a}=t;return{...e,bulkCloseIndex:a}}case"setExceptionItems":{const{items:a}=t;return{...e,exceptionItems:a}}case"setConditionValidationErrorExists":{const{errorExists:a}=t;return{...e,entryErrorExists:a}}case"setExpireTime":{const{expireTime:a}=t;return{...e,expireTime:a}}case"setExpireError":{const{errorExists:a}=t;return{...e,expireErrorExists:a}}default:return e}}),{exceptionItems:[t],exceptionItemMeta:{name:t.name},newComment:"",commentErrorExists:!1,bulkCloseAlerts:!1,disableBulkClose:!0,bulkCloseIndex:void 0,entryErrorExists:!1,expireTime:void 0!==t.expire_time?d()(t.expire_time):void 0,expireErrorExists:!1}),ie=Object(r.useMemo)((()=>null==a||!Object(p.b)(a.type)&&!Object(p.h)(a.type)&&!Object(p.e)(a.type)),[a]),[oe,se,le,ce]=Object(M.a)();Object(r.useEffect)((()=>{null!=ce&&ce([{id:e.id,listId:e.list_id,namespaceType:e.namespace_type}])}),[e,ce]);const ue=Object(r.useCallback)((e=>{re({type:"setExceptionItems",items:e})}),[re]),de=Object(r.useCallback)((e=>{re({type:"setExceptionItemMeta",value:e})}),[re]),pe=Object(r.useCallback)((e=>{re({type:"setComment",comment:e})}),[re]),me=Object(r.useCallback)((e=>{re({type:"setCommentError",errorExists:e})}),[re]),ye=Object(r.useCallback)((e=>{re({type:"setBulkCloseAlerts",bulkClose:e})}),[re]),ge=Object(r.useCallback)((e=>{re({type:"setDisableBulkCloseAlerts",disableBulkCloseAlerts:e})}),[re]),fe=Object(r.useCallback)((e=>{re({type:"setBulkCloseIndex",bulkCloseIndex:e})}),[re]),be=Object(r.useCallback)((e=>{re({type:"setConditionValidationErrorExists",errorExists:e})}),[re]),he=Object(r.useCallback)((e=>{re({type:"setExpireTime",expireTime:e})}),[re]),ve=Object(r.useCallback)((e=>{re({type:"setExpireError",errorExists:e})}),[re]),Ee=Object(r.useCallback)((()=>{u(!1)}),[u]),xe=Object(r.useCallback)((e=>e.every((e=>c.E.is(e)))),[]),ke=Object(r.useCallback)((async()=>{if(null!=V)try{const r=Object(b.a)({itemName:Z,commentToAdd:K,listType:x,selectedOs:t.os_types,expireTime:ae,items:Y});if(xe(r)){await V({itemsToUpdate:r});const t=null!=a?[a.rule_id]:[],i=null!=le?le[e.list_id].referenced_rules.map((({rule_id:e})=>e)):[],o=x===c.b.RULE_DEFAULT?t:i;null!=W&&!Object(n.isEmpty)(o)&&X&&await W(o,r,void 0,ee),g(!0)}}catch(e){u(!1)}}),[V,Z,K,x,t.os_types,Y,xe,a,le,e.list_id,W,X,g,ee,u,ae]),we=Object(r.useMemo)((()=>x===c.b.ENDPOINT?D:N),[x]),je=Object(r.useMemo)((()=>H||U||Y.every((e=>0===e.entries.length))||k||te||ne||Q),[k,te,Y,H,U,ne,Q]);return i.a.createElement(l.EuiFlyout,{size:"l",onClose:Ee,"data-test-subj":"editExceptionFlyout"},i.a.createElement(P,null,i.a.createElement(l.EuiTitle,null,i.a.createElement("h2",{"data-test-subj":"exceptionFlyoutTitle"},we)),i.a.createElement(l.EuiSpacer,{size:"m"})),i.a.createElement(z,{className:"builder-section"},k&&i.a.createElement(l.EuiSkeletonText,{"data-test-subj":"loadingEditExceptionFlyout",lines:4}),i.a.createElement(m.a,{exceptionItemName:Z,onChange:de}),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(O.a,{exceptionItemName:Z,allowLargeValueLists:ie,exceptionListItems:[t],exceptionListType:x,indexPatterns:w,rules:v,selectedOs:h,showOsTypeOptions:x===c.b.ENDPOINT,isEdit:!0,onExceptionItemAdd:ue,onSetErrorExists:be,getExtendedFields:$}),!s&&x===c.b.DETECTION&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(E,{isLoadingReferences:oe,errorFetchingReferences:se,listAndReferences:null!=le?[le[e.list_id]]:[]})),!s&&x===c.b.RULE_DEFAULT&&null!=a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(j,{rule:a})),i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(T.a,{accordionTitle:i.a.createElement(G,{size:"xs"},i.a.createElement("h3",null,(Se=null!==(f=t.comments.length)&&void 0!==f?f:0,y.i18n.translate("xpack.securitySolution.ruleExceptions.editExceptionFlyout.commentsTitle",{values:{comments:Se},defaultMessage:"Add comments ({comments})"})))),exceptionItemComments:t.comments,newCommentValue:K,newCommentOnChange:pe,setCommentError:me}),x!==c.b.ENDPOINT&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(R.a,{expireTime:ae,setExpireTime:he,setExpireError:ve})),o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiHorizontalRule,null),i.a.createElement(S.a,{exceptionListType:x,shouldBulkCloseAlert:X,disableBulkClose:J,exceptionListItems:Y,onDisableBulkClose:ge,onUpdateBulkCloseIndex:fe,onBulkCloseCheckboxChange:ye}))),i.a.createElement(l.EuiFlyoutFooter,null,i.a.createElement(B,{justifyContent:"spaceBetween"},i.a.createElement(l.EuiButtonEmpty,{"data-test-subj":"cancelExceptionEditButton",onClick:Ee},_),i.a.createElement(l.EuiButton,{"data-test-subj":"editExceptionConfirmButton",onClick:ke,isDisabled:je,fill:!0},we))));var Se},H=i.a.memo($);H.displayName="EditExceptionFlyout"},1424:function(e,t,a){"use strict";a.d(t,"a",(function(){return q}));var n=a(2),r=a.n(n),i=a(334),o=a(112),s=a(110),l=a(128),c=a(196),u=a(204),d=a(17),p=a(44),m=a.n(p),y=a(5);const g=y.i18n.translate("xpack.securitySolution.fieldBrowser.createFieldButton",{defaultMessage:"Create field"}),f=m()(d.EuiButton).withConfig({displayName:"StyledButton",componentId:"sc-1abg8tf-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeM)),b=y.i18n.translate("xpack.securitySolution.fieldBrowser.fieldName",{defaultMessage:"Name"}),h=y.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionLabel",{defaultMessage:"Description"}),v=y.i18n.translate("xpack.securitySolution.fieldBrowser.categoryLabel",{defaultMessage:"Category"}),E=y.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeLabel",{defaultMessage:"Runtime"}),x=y.i18n.translate("xpack.securitySolution.fieldBrowser.runtimeTitle",{defaultMessage:"Runtime Field"}),k=y.i18n.translate("xpack.securitySolution.fieldBrowser.actionsLabel",{defaultMessage:"Actions"}),w=y.i18n.translate("xpack.securitySolution.fieldBrowser.editButton",{defaultMessage:"Edit"}),j=y.i18n.translate("xpack.securitySolution.fieldBrowser.removeButton",{defaultMessage:"Remove"}),S=y.i18n.translate("xpack.securitySolution.fieldBrowser.editButtonDescription",{defaultMessage:"Edit runtime field"}),O=y.i18n.translate("xpack.securitySolution.fieldBrowser.removeButtonDescription",{defaultMessage:"Delete runtime field"});var I=a(732),C=a(126),M=a(439);const T=m()(d.EuiIcon).withConfig({displayName:"TypeIcon",componentId:"sc-1coc1q1-0"})(["margin:0 4px;position:relative;top:-1px;"]);T.displayName="TypeIcon";const _=m.a.span.withConfig({displayName:"Description",componentId:"sc-1coc1q1-1"})(["user-select:text;width:",";"],(({width:e})=>e));_.displayName="Description";const N=r.a.memo((({fieldId:e,highlight:t=""})=>r.a.createElement(d.EuiText,{size:"xs"},r.a.createElement(d.EuiHighlight,{"data-test-subj":`field-${e}-name`,search:t},e))));N.displayName="FieldName";var D=a(184),A=a(224);const q=({sourcererScope:e,editorActionsRef:t,removeColumn:a,upsertColumn:p})=>{const[m,q]=Object(n.useState)(null),{startTransaction:F}=Object(D.b)(),{indexFieldsSearch:L}=Object(i.b)(),{dataViewFieldEditor:R,data:{dataViews:P}}=Object(s.i)().services,z=Object(n.useMemo)((()=>l.e.scopeIdSelector()),[]),{missingPatterns:B,selectedDataViewId:G}=Object(o.a)((t=>z(t,e)));Object(n.useEffect)((()=>{let e=!1;return null==G||B.length||(async t=>{const a=await P.get(t);e||q(a)})(G),()=>{e=!0}}),[G,B,P]);const $=Object(n.useCallback)((e=>{if(m&&G){const n=R.openEditor({ctx:{dataView:m},fieldName:e,onSave:async n=>{F({name:A.c.FIELD_SAVED}),await L({dataViewId:G,cleanCache:!0});for(const t of n)e&&e!==t.name&&a(e),p({columnHeaderType:c.a,id:t.name,initialWidth:u.a},0);t&&(t.current=null)}});t&&(t.current={closeEditor:()=>{t.current=null,n()}})}}),[m,G,R,t,L,a,p,F]),H=Object(n.useCallback)((e=>{m&&G&&R.openDeleteModal({ctx:{dataView:m},fieldName:e,onDelete:async()=>{F({name:A.c.FIELD_DELETED}),await L({dataViewId:G}),a(e)}})}),[m,G,R,L,a,F]),V=Object(n.useMemo)((()=>null==R?void 0:R.userPermissions.editIndexPattern()),[null==R?void 0:R.userPermissions]),U=(({isAllowed:e,loading:t,openFieldEditor:a})=>{const i=Object(n.useCallback)((({onHide:e})=>r.a.createElement(f,{iconType:t?"none":"plusInCircle","aria-label":g,"data-test-subj":"create-field",onClick:()=>{a(),e()},isLoading:t},g)),[t,a]);return e?i:void 0})({isAllowed:V&&!!G,loading:!m,openFieldEditor:$}),W=(({hasFieldEditPermission:e,openFieldEditor:t,openDeleteFieldModal:a})=>Object(n.useCallback)((({highlight:n,onHide:i})=>{const o=e?[{name:w,description:S,type:"icon",icon:"pencil",isPrimary:!0,onClick:({name:e})=>{t(e),i()},available:({isRuntime:e})=>e,"data-test-subj":"actionEditRuntimeField"},{name:j,description:O,type:"icon",icon:"trash",color:"danger",isPrimary:!0,onClick:({name:e})=>{a(e),i()},available:({isRuntime:e})=>e,"data-test-subj":"actionDeleteRuntimeField"}]:[];return[{field:"name",name:b,render:(e,{type:t})=>r.a.createElement(d.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},r.a.createElement(d.EuiFlexItem,{grow:!1},r.a.createElement(d.EuiToolTip,{content:t},r.a.createElement(T,{"data-test-subj":`field-${e}-icon`,type:Object(I.d)(null!=t?t:null)}))),r.a.createElement(d.EuiFlexItem,{grow:!1},r.a.createElement(N,{fieldId:e,highlight:n}))),sortable:!0,width:"225px"},{field:"description",name:h,render:(e,{name:t})=>{return r.a.createElement(d.EuiToolTip,{content:e},r.a.createElement(r.a.Fragment,null,r.a.createElement(d.EuiScreenReaderOnly,{"data-test-subj":"descriptionForScreenReaderOnly"},r.a.createElement("p",null,(a=t,y.i18n.translate("xpack.securitySolution.fieldBrowser.descriptionForScreenReaderOnly",{values:{field:a},defaultMessage:"Description for field {field}:"})))),r.a.createElement(M.a,null,r.a.createElement(_,{width:o.length>0?"335px":"400px","data-test-subj":`field-${t}-description`},`${null!=e?e:Object(C.e)()}`))));var a},sortable:!0,width:o.length>0?"335px":"400px"},{field:"isRuntime",name:E,render:e=>e?r.a.createElement(d.EuiHealth,{color:"success",title:x}):null,sortable:!0,width:"80px"},{field:"category",name:v,render:(e,{name:t})=>r.a.createElement(d.EuiBadge,{"data-test-subj":`field-${t}-category`},e),sortable:!0,width:"115px"},...o.length>0?[{name:k,actions:o,width:"80px"}]:[]]}),[e,t,a]))({hasFieldEditPermission:V,openFieldEditor:$,openDeleteFieldModal:H});return Object(n.useMemo)((()=>({createFieldButton:U,getFieldTableColumns:W})),[U,W])}},1425:function(e,t,a){"use strict";a.d(t,"b",(function(){return j})),a.d(t,"c",(function(){return S})),a.d(t,"a",(function(){return _e}));var n=a(45),r=a(2),i=a.n(r),o=a(113),s=a(1069),l=a(17),c=a(166),u=a(1070),d=a(926),p=a(267),m=a(1068),y=a(1398),g=a(1500);const f=e=>null==e||"unset"===e.toLowerCase(),b=i.a.memo((({contextId:e,eventId:t,primary:a,secondary:n,isDraggable:r})=>f(a)&&f(n)?null:!f(a)&&f(n)?i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:r,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):f(a)&&!f(n)||a===n?i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:r,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):i.a.createElement(l.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.primary",isDraggable:r,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(p.c,{grow:!1,component:"span"},u.i),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:e,eventId:t,field:"auditd.summary.actor.secondary",isDraggable:r,value:n,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))));b.displayName="PrimarySecondary";const h=i.a.memo((({contextId:e,eventId:t,userName:a,primary:n,secondary:r,isDraggable:o})=>f(a)&&f(n)&&f(r)?null:f(a)||f(n)||f(r)||a!==n||a!==r?!f(a)&&f(n)&&f(r)?i.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:o,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"}):i.a.createElement(b,{contextId:e,eventId:t,isDraggable:o,primary:n,secondary:r}):i.a.createElement(c.c,{contextId:e,eventId:t,field:"user.name",isDraggable:o,value:a,iconType:"user",isAggregatable:!0,fieldType:"keyword"})));h.displayName="PrimarySecondaryUserInfo";const v=i.a.memo((({eventId:e,contextId:t,hostName:a,userName:n,primary:r,secondary:o,workingDirectory:s,session:l,isDraggable:d})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(p.c,{grow:!1,component:"span"},u.Vb),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.session",value:l,iconType:"number",isDraggable:d,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(h,{contextId:t,eventId:e,userName:n,primary:r,secondary:o,isDraggable:d})),null!=a&&i.a.createElement(p.c,{grow:!1,component:"span"},"@"),i.a.createElement(g.a,{contextId:t,eventId:e,workingDirectory:s,hostName:a,isDraggable:d}))));v.displayName="SessionUserHostWorkingDir";const E=i.a.memo((({id:e,contextId:t,hostName:a,userName:n,primary:r,processName:o,processPid:s,processExecutable:d,processTitle:g,secondary:f,workingDirectory:b,args:h,result:E,session:x,text:k,isDraggable:w})=>i.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(v,{eventId:e,contextId:t,hostName:a,userName:n,primary:r,secondary:f,workingDirectory:b,session:x,isDraggable:w}),null!=d&&i.a.createElement(p.c,{grow:!1,component:"span"},k),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,processPid:s,processName:o,processExecutable:d,isDraggable:w})),i.a.createElement(y.a,{eventId:e,args:h,contextId:t,isDraggable:w,processTitle:g}),null!=E&&i.a.createElement(p.c,{grow:!1,component:"span"},u.pc),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:w,queryValue:E,value:E,isAggregatable:!0,fieldType:"keyword"})))));E.displayName="AuditdGenericLine";const x=i.a.memo((({data:e,contextId:t,isDraggable:a,text:r,timelineId:o})=>{const s=e._id,c=Object(n.get)("auditd.session[0]",e),u=Object(n.get)("host.name[0]",e),m=Object(n.get)("user.name[0]",e),y=Object(n.get)("auditd.result[0]",e),g=Object(n.get)("process.pid[0]",e),f=Object(n.get)("process.name[0]",e),b=Object(n.get)("process.executable[0]",e),h=Object(n.get)("process.title[0]",e),v=Object(n.get)("process.working_directory[0]",e),x=Object(n.get)("auditd.summary.actor.primary[0]",e),k=Object(n.get)("auditd.summary.actor.secondary[0]",e),w=Object(n.get)("process.args",e);return null!=e.process?i.a.createElement(p.b,null,i.a.createElement(E,{id:s,contextId:t,text:r,hostName:u,userName:m,processName:f,processPid:g,processExecutable:b,processTitle:h,workingDirectory:v,args:w,session:c,primary:x,result:y,secondary:k,isDraggable:a}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:a,timelineId:o})):null}));x.displayName="AuditdGenericDetails";const k=i.a.memo((({id:e,contextId:t,hostName:a,userName:n,result:r,primary:o,secondary:s,filePath:d,processName:g,processPid:f,processExecutable:b,processTitle:h,workingDirectory:E,args:x,session:k,text:w,fileIcon:j,isDraggable:S})=>i.a.createElement(l.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(v,{eventId:e,contextId:t,hostName:a,userName:n,primary:o,secondary:s,workingDirectory:E,session:k,isDraggable:S}),(null!=d||null!=b)&&i.a.createElement(p.c,{grow:!1,component:"span"},w),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"file.path",isDraggable:S,value:d,iconType:j})),null!=b&&i.a.createElement(p.c,{grow:!1,component:"span"},u.kc),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(m.a,{contextId:t,endgamePid:void 0,endgameProcessName:void 0,eventId:e,isDraggable:S,processPid:f,processName:g,processExecutable:b})),i.a.createElement(y.a,{eventId:e,args:x,contextId:t,isDraggable:S,processTitle:h}),null!=r&&i.a.createElement(p.c,{grow:!1,component:"span"},u.pc),i.a.createElement(p.c,{grow:!1,component:"span"},i.a.createElement(c.c,{contextId:t,eventId:e,field:"auditd.result",isDraggable:S,queryValue:r,value:r})))));k.displayName="AuditdGenericFileLine";const w=i.a.memo((({data:e,contextId:t,text:a,fileIcon:r="document",timelineId:o,isDraggable:s})=>{const c=e._id,u=Object(n.get)("auditd.session[0]",e),m=Object(n.get)("host.name[0]",e),y=Object(n.get)("user.name[0]",e),g=Object(n.get)("auditd.result[0]",e),f=Object(n.get)("process.pid[0]",e),b=Object(n.get)("process.name[0]",e),h=Object(n.get)("process.executable[0]",e),v=Object(n.get)("process.title[0]",e),E=Object(n.get)("process.working_directory[0]",e),x=Object(n.get)("file.path[0]",e),w=Object(n.get)("auditd.summary.actor.primary[0]",e),j=Object(n.get)("auditd.summary.actor.secondary[0]",e),S=Object(n.get)("process.args",e);return null!=e.process?i.a.createElement(p.b,null,i.a.createElement(k,{id:c,contextId:t,text:a,hostName:m,userName:y,filePath:x,processName:b,processPid:f,processExecutable:h,processTitle:v,workingDirectory:E,args:S,session:u,primary:w,secondary:j,fileIcon:r,result:g,isDraggable:s}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:s,timelineId:o})):null}));w.displayName="AuditdGenericFileDetails";const j=({actionName:e,text:t})=>({id:o.d.auditd,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),r=Object(n.get)("event.action[0]",t);return null!=a&&"auditd"===a.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(s.a,null,i.a.createElement(x,{data:a,isDraggable:n,contextId:`${e}-${r}`,text:t,timelineId:r}))}),S=({actionName:e,text:t,fileIcon:a="document"})=>({id:o.d.auditd_file,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),r=Object(n.get)("event.action[0]",t);return null!=a&&"auditd"===a.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:n,isDraggable:r,scopeId:o})=>i.a.createElement(s.a,null,i.a.createElement(w,{contextId:`${e}-${o}`,data:n,fileIcon:a,isDraggable:r,text:t,timelineId:o}))}),O=j({actionName:"was-authorized",text:u.oc}),I=j({actionName:"started-session",text:u.Yb}),C=j({actionName:"logged-in",text:u.m}),M=j({actionName:"login",text:u.m}),T=j({actionName:"executed",text:u.gb}),_=j({actionName:"ended-session",text:u.eb}),N=j({actionName:"acquired-credentials",text:u.e}),D=j({actionName:"disposed-credentials",text:u.db}),A=j({actionName:"connected-to",text:u.T}),q=S({actionName:"opened-file",text:u.Db}),F=j({actionName:"changed-file-attributes-of",text:u.y}),L=S({actionName:"changed-file-permissions-of",text:u.A}),R=S({actionName:"changed-file-ownership-of",text:u.z}),P=j({actionName:"loaded-kernel-module",text:u.ob}),z=j({actionName:"unloaded-kernel-module",text:u.gc}),B=S({actionName:"created-directory",text:u.V,fileIcon:"folderOpen"}),G=S({actionName:"mounted",text:u.Bb}),$=S({actionName:"renamed",text:u.Ob}),H=S({actionName:"checked-metadata-of",text:u.S}),V=S({actionName:"checked-filesystem-metadata-of",text:u.Q}),U=S({actionName:"symlinked",text:u.dc}),W=S({actionName:"unmounted",text:u.ic}),Y=S({actionName:"deleted",text:u.Z}),Z=S({actionName:"changed-timestamp-of",text:u.N}),K=j({actionName:"listen-for-connections",text:u.mb}),Q=j({actionName:"bound-socket",text:u.t}),X=j({actionName:"received-from",text:u.Hb}),J=j({actionName:"sent-to",text:u.Ub}),ee=j({actionName:"killed-pid",text:u.lb}),te=j({actionName:"changed-identity-of",text:u.D}),ae=j({actionName:"changed-system-time",text:u.M}),ne=j({actionName:"make-device",text:u.ub}),re=j({actionName:"changed-system-name",text:u.L}),ie=j({actionName:"allocated-memory",text:u.h}),oe=j({actionName:"adjusted-scheduling-policy-of",text:u.Rb}),se=j({actionName:"added-user-account",text:u.g}),le=j({actionName:"caused-mac-policy-error",text:u.u}),ce=j({actionName:"loaded-firewall-rule-to",text:u.nb}),ue=j({actionName:"changed-promiscuous-mode-on-device",text:u.H}),de=j({actionName:"locked-account",text:u.rb}),pe=j({actionName:"unlocked-account",text:u.hc}),me=j({actionName:"added-group-account-to",text:u.f}),ye=j({actionName:"crashed-program",text:u.U}),ge=j({actionName:"attempted-execution-of-forbidden-program",text:u.hb}),fe=j({actionName:"used-suspcious-link",text:u.jc}),be=j({actionName:"used-suspicious-link",text:u.jc}),he=j({actionName:"failed-log-in-too-many-times-to",text:u.ib}),ve=j({actionName:"failed-login-too-many-times-to",text:u.ib}),Ee=j({actionName:"attempted-log-in-from-unusual-place-to",text:u.o}),xe=j({actionName:"attempted-login-from-unusual-place-to",text:u.o}),ke=j({actionName:"opened-too-many-sessions-to",text:u.Eb}),we=j({actionName:"attempted-log-in-during-unusual-hour-to",text:u.n}),je=j({actionName:"attempted-login-during-unusual-hour-to",text:u.n}),Se=j({actionName:"tested-file-system-integrity-of",text:u.ec}),Oe=j({actionName:"violated-selinux-policy",text:u.nc}),Ie=j({actionName:"violated-apparmor-policy",text:u.lc}),Ce=j({actionName:"changed-group",text:u.B}),Me=j({actionName:"changed-user-id",text:u.P}),Te=j({actionName:"changed-auditd-configuration",text:u.v}),_e=[T,C,M,O,N,_,D,I,A,q,F,L,R,P,z,B,G,$,H,V,U,W,Y,Z,K,Q,X,J,ee,te,ae,ne,re,ie,oe,se,me,ge,le,ue,ye,ce,de,fe,be,pe,he,ve,xe,ke,Ee,we,je,Se,Oe,Ie,Ce,Me,j({actionName:"changed-audit-configuration",text:u.v}),j({actionName:"refreshed-credentials",text:u.Jb}),j({actionName:"negotiated-crypto-key",text:u.Cb}),j({actionName:"crypto-officer-logged-in",text:u.X}),j({actionName:"crypto-officer-login",text:u.X}),j({actionName:"crypto-officer-logged-out",text:u.Y}),j({actionName:"crypto-officer-logout",text:u.Y}),j({actionName:"started-crypto-session",text:u.ac}),j({actionName:"access-result",text:u.d}),j({actionName:"aborted-auditd-startup",text:u.a}),j({actionName:"aborted-audit-startup",text:u.a}),j({actionName:"remote-audit-connected",text:u.Lb}),j({actionName:"remote-audit-disconnected",text:u.Mb}),j({actionName:"shutdown-audit",text:u.Wb}),j({actionName:"audit-error",text:u.p}),j({actionName:"reconfigured-auditd",text:u.Ib}),j({actionName:"reconfigured-audit",text:u.Ib}),j({actionName:"resumed-audit-logging",text:u.Pb}),j({actionName:"rotated-audit-logs",text:u.Qb}),j({actionName:"started-audit",text:u.Zb}),j({actionName:"deleted-group-account-from",text:u.ab}),j({actionName:"deleted-user-account",text:u.bb}),j({actionName:"changed-audit-feature",text:u.w}),j({actionName:"relabeled-filesystem",text:u.Kb}),j({actionName:"authenticated-to-group",text:u.q}),j({actionName:"changed-group-password",text:u.C}),j({actionName:"modified-group-account",text:u.xb}),j({actionName:"initialized-audit-subsystem",text:u.jb}),j({actionName:"modified-level-of",text:u.yb}),j({actionName:"overrode-label-of",text:u.Fb}),j({actionName:"changed-login-id-to",text:u.E}),j({actionName:"mac-permission",text:u.tb}),j({actionName:"changed-selinux-boolean",text:u.J}),j({actionName:"loaded-selinux-policy",text:u.qb}),j({actionName:"changed-selinux-enforcement",text:u.K}),j({actionName:"assigned-user-role-to",text:u.j}),j({actionName:"modified-role",text:u.zb}),j({actionName:"removed-use-role-from",text:u.Nb}),j({actionName:"removed-user-role-from",text:u.Nb}),Te,j({actionName:"violated-seccomp-policy",text:u.mc}),j({actionName:"started-service",text:u.bc}),j({actionName:"stopped-service",text:u.cc}),j({actionName:"booted-system",text:u.s}),j({actionName:"changed-to-runlevel",text:u.O}),j({actionName:"shutdown-system",text:u.Xb}),j({actionName:"sent-test",text:u.Tb}),j({actionName:"unknown",text:u.fc}),j({actionName:"sent-message",text:u.Sb}),j({actionName:"access-permission",text:u.c}),j({actionName:"authenticated",text:u.r}),j({actionName:"changed-password",text:u.G}),j({actionName:"ran-command",text:u.Gb}),j({actionName:"error",text:u.fb}),j({actionName:"logged-out",text:u.sb}),j({actionName:"logout",text:u.sb}),j({actionName:"changed-mac-configuration",text:u.F}),j({actionName:"loaded-mac-policy",text:u.pb}),j({actionName:"modified-user-account",text:u.Ab}),j({actionName:"changed-role-to",text:u.I}),j({actionName:"access-error",text:u.b}),j({actionName:"changed-configuration",text:u.x}),j({actionName:"issued-vm-control",text:u.kb}),j({actionName:"created-vm-image",text:u.W}),j({actionName:"deleted-vm-image",text:u.cb}),j({actionName:"checked-integrity-of",text:u.R}),j({actionName:"assigned-vm-id",text:u.k}),j({actionName:"migrated-vm-from",text:u.vb}),j({actionName:"migrated-vm-to",text:u.wb}),j({actionName:"assigned-vm-resource",text:u.l})]},1427:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(2),r=a.n(n),i=a(17),o=a(5),s=a(44),l=a.n(s),c=a(47),u=a(130);const d=o.i18n.translate("xpack.securitySolution.management.policiesSelector.globalEntries",{defaultMessage:"Global entries"}),p=o.i18n.translate("xpack.securitySolution.management.policiesSelector.unassignedEntries",{defaultMessage:"Unassigned entries"}),m=Object(n.memo)((({policies:e,onChangeSelection:t,defaultExcludedPolicies:a,defaultIncludedPolicies:o})=>{const{euiTheme:s}=Object(i.useEuiTheme)(),[l,m]=Object(n.useState)(!1),[g,f]=Object(n.useState)(""),[b,h]=Object(n.useState)([]),v=Object(u.a)("excludePoliciesInFilterEnabled");Object(n.useEffect)((()=>{const t=o?o.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},n=a?a.split(",").reduce(((e,t)=>({...e,[t]:!0})),{}):{},r=e=>t[e]?"on":n[e]?"off":void 0;h([...e.map((e=>({name:e.name,id:e.id,checked:r(e.id)}))),{name:d,id:"global",checked:r("global")},{name:p,id:"unassigned",checked:r("unassigned")}])}),[e]);const E=Object(n.useCallback)((()=>{m((e=>!e))}),[]),x=Object(n.useCallback)((()=>{m(!1)}),[]),k=Object(n.useCallback)((e=>{const t=e.target.value||"";f(t)}),[]),w=Object(n.useCallback)((e=>{if(!b[e])return;const a=[...b];switch(a[e].checked){case"on":a[e].checked=v?"off":void 0;break;case"off":a[e].checked=void 0;break;default:a[e].checked="on"}h(a),t(a)}),[b,t,v]),j=Object(n.useMemo)((()=>b.map(((e,t)=>e.name.toLowerCase().includes(g.toLowerCase())?r.a.createElement(i.EuiFilterSelectItem,{checked:e.checked,key:t,onClick:()=>w(t),"data-test-subj":`policiesSelector-popover-items-${e.id}`},e.name):null))),[b,g,w]),S=Object(n.useMemo)((()=>r.a.createElement(i.EuiFilterButton,{iconType:"arrowDown","data-test-subj":"policiesSelectorButton",onClick:E,isSelected:l,numFilters:b.length,hasActiveFilters:!!b.find((e=>"on"===e.checked)),numActiveFilters:b.filter((e=>"on"===e.checked)).length},r.a.createElement(i.EuiText,null,r.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.management.policiesSelector.label",defaultMessage:"Policies"})))),[l,b,E]);return r.a.createElement(i.EuiFlexGroup,{"data-test-subj":"policiesSelector",direction:"row",alignItems:"center",gutterSize:"l"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFilterGroup,null,r.a.createElement(i.EuiPopover,{button:S,isOpen:l,closePopover:x,panelPaddingSize:"none"},r.a.createElement(i.EuiPopoverTitle,{paddingSize:"s"},r.a.createElement(i.EuiFieldSearch,{"data-test-subj":"policiesSelectorSearch",compressed:!0,onChange:k,value:g})),r.a.createElement(y,{"data-test-subj":"policiesSelector-popover",className:"eui-yScroll",$_css:30*s.base},j)))))}));m.displayName="PoliciesSelector";var y=l()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-gji8ln-0"})((e=>({maxHeight:e.$_css}))),g=a(135);const f=Object(n.memo)((({defaultValue:e="",onSearch:t,placeholder:a,hasPolicyFilter:s,policyList:l,defaultIncludedPolicies:c,hideRefreshButton:u=!1})=>{const{canCreateArtifactsByPolicy:d}=Object(g.a)().endpointPrivileges,[p,y]=Object(n.useState)(e),[f,b]=Object(n.useState)(c||""),h=Object(n.useCallback)((e=>{const a=e.filter((e=>"on"===e.checked)).map((e=>e.id)).join(",");b(a),t(p,a,!1)}),[t,p]),v=Object(n.useCallback)((e=>y(e.target.value)),[y]),E=Object(n.useCallback)((()=>t(p,f,!0)),[t,p,f]),x=Object(n.useCallback)((e=>{t(e,f,!1)}),[t,f]);return r.a.createElement(i.EuiFlexGroup,{"data-test-subj":"searchExceptions",direction:"row",alignItems:"center",gutterSize:"m"},r.a.createElement(i.EuiFlexItem,null,r.a.createElement(i.EuiFieldSearch,{defaultValue:e,placeholder:a,onChange:v,onSearch:x,isClearable:!0,fullWidth:!0,"data-test-subj":"searchField"})),d&&s&&l?r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(m,{policies:l,defaultIncludedPolicies:c,onChangeSelection:h})):null,u?null:r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{iconType:"refresh",onClick:E,"data-test-subj":"searchButton"},o.i18n.translate("xpack.securitySolution.management.search.button",{defaultMessage:"Refresh"}))))}));f.displayName="SearchExceptions"},1431:function(e,t,a){"use strict";a.d(t,"g",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return c})),a.d(t,"d",(function(){return m})),a.d(t,"e",(function(){return y})),a.d(t,"i",(function(){return g})),a.d(t,"h",(function(){return f})),a.d(t,"f",(function(){return b}));var n=a(165),r=a(387),i=a(163);const o=(e,t,a)=>{const{pagination:n,search:r,filters:i}=a||{};let o=[],s=[];return Array.isArray(e)&&e.length?(o=e.map((e=>e.list_id)),s=e.map((e=>e.namespace_type))):t&&(o=[t.list_id],s=[t.namespace_type]),{listIds:o,namespaceTypes:s,pagination:n,search:r,filters:i}},s=async({namespaceTypes:e,listIds:t,http:a,pagination:i,search:o})=>{try{const s=new AbortController,{pageIndex:l,pageSize:c,totalItemCount:u}=i||{},{page:d,per_page:p,total:m,data:y}=await Object(n.m)({filter:void 0,http:a,listIds:null!=t?t:[],namespaceTypes:null!=e?e:[],search:o,pagination:{perPage:c,page:(l||0)+1,total:u},signal:s.signal});return{data:y.map((e=>Object(r.b)(e))),pagination:{pageIndex:d-1,pageSize:p,totalItemCount:m}}}catch(e){throw new Error(e)}},l=async e=>{try{const t=new AbortController,{references:a}=await Object(i.l)({lists:e.map((e=>({id:e.id,listId:e.list_id,namespaceType:e.namespace_type}))),signal:t.signal});return a.reduce(((e,t)=>({...e,...t})),{})}catch(e){throw new Error(e)}},c=async({id:e,namespaceType:t,http:a})=>{try{const r=new AbortController;await Object(n.e)({http:a,id:e,namespaceType:t,signal:r.signal})}catch(e){throw new Error(e)}};var u=a(350),d=a(85),p=a(531);const m=async({id:e,http:t})=>{try{const a=new AbortController,r=Object(u.h)({filters:{list_id:e},namespaceTypes:["single","agnostic"],hideLists:p.a}),i=["single","agnostic"].join(),{data:o}=await Object(n.l)({filters:r,http:t,signal:a.signal,namespaceTypes:i,pagination:{}});return a.abort(),o&&o.length?o[0]:null}catch(e){throw new Error(e)}},y=async e=>{try{const t=new AbortController,{data:a}=await Object(i.j)({signal:t.signal,pagination:{page:1,perPage:1e4}});return t.abort(),a.reduce(((t,a,n)=>{var r;return(null===(r=a.exceptions_list)||void 0===r?void 0:r.find((t=>t.list_id===e)))&&t.push(a),t}),[])}catch(e){throw new Error(e)}},g=async({list:e,http:t})=>{try{const a=new AbortController;await Object(n.u)({http:t,list:e,signal:a.signal}),a.abort()}catch(e){throw new Error(e)}},f=async({rules:e,listId:t})=>{try{if(!e.length)return;const a=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var n;const r=(null!==(n=e.exceptions_list)&&void 0!==n?n:[]).filter((({list_id:e})=>e!==t));await Object(i.p)({ruleProperties:{rule_id:e.rule_id,exceptions_list:r},signal:a.signal})}))}catch(e){throw new Error(e)}},b=async({rules:e,listId:t,id:a,listType:n,listNamespaceType:r})=>{try{if(!e.length)return;const o=new AbortController;await Object(d.asyncForEach)(e,(async e=>{var s;const l={list_id:t,id:a,type:n,namespace_type:r},c=[...null!==(s=e.exceptions_list)&&void 0!==s?s:[],l];await Object(i.p)({ruleProperties:{rule_id:e.rule_id,exceptions_list:c},signal:o.signal})}))}catch(e){throw new Error(e)}}},1434:function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return x}));var n=a(2),r=a.n(n),i=a(5),o=a(17),s=a(152),l=a(530),c=a(1481),u=a(115),d=a(1385),p=a(1150),m=a(110),y=a(1161),g=a(1478),f=a(135),b=a(1106),h=a(746);const v=Object.freeze({flyoutEditTitle:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditTitle",{defaultMessage:"Add artifact"}),flyoutCreateTitle:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateTitle",{defaultMessage:"Create artifact"}),flyoutCancelButtonLabel:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCancelButtonLabel",{defaultMessage:"Cancel"}),flyoutCreateSubmitButtonLabel:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add"}),flyoutEditSubmitButtonLabel:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitButtonLabel",{defaultMessage:"Save"}),flyoutDowngradedLicenseTitle:i.i18n.translate("xpack.securitySolution.artifactListPage.expiredLicenseTitle",{defaultMessage:"Expired License"}),flyoutDowngradedLicenseInfo:i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseInfo",{defaultMessage:"Your Kibana license has been downgraded. Future policy configurations will now be globally assigned to all policies."}),flyoutDowngradedLicenseDocsInfo:e=>i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutDowngradedLicenseDocsInfo",{defaultMessage:"For more information, see our documentation."}),flyoutEditItemLoadFailure:e=>i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditItemLoadFailure",{defaultMessage:"Failed to retrieve item for edit. Reason: {errorMessage}",values:{errorMessage:e}}),flyoutCreateSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.some_page.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.artifactListPage.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}})}),E=(e,t)=>({isValid:!1,item:null!=t?t:Object(y.a)(e)}),x=Object(n.memo)((({apiClient:e,item:t,policies:a,policiesIsLoading:i,FormComponent:y,onSuccess:x,onClose:k,submitHandler:w,labels:j={},"data-test-subj":S,size:O="m"})=>{var I,C;const{docLinks:{links:{securitySolution:M}}}=Object(m.i)().services,T=Object(u.a)(S),_=Object(m.m)(),N=Object(c.a)(),D=Object(d.a)(),{urlParams:A}=Object(l.a)(),q=Object(s.b)(),F=Object(n.useMemo)((()=>({...v,...j})),[j]),[L,R]=Object(n.useState)(!1),[P,z]=Object(n.useState)(void 0),B="edit"===A.show,G=B?"edit":"create",{isLoading:$,mutateAsync:H,error:V}=Object(g.a)(e,G),U=Object(n.useMemo)((()=>w?L:$),[L,$,w]),W=Object(n.useMemo)((()=>w?P:V),[P,V,w]),{isRefetching:Y,error:Z,refetch:K}=Object(h.d)(e,null!==(I=A.itemId)&&void 0!==I?I:"",void 0,{enabled:!1}),[Q,X]=Object(n.useState)(E.bind(null,e.listId,t)),J=((e,t)=>{const a=Object(f.a)().endpointPrivileges;return Object(n.useMemo)((()=>"edit"===t&&!a.canCreateArtifactsByPolicy&&Object(b.d)(e)),[a.canCreateArtifactsByPolicy,e,t])})({tags:null!==(C=Q.item.tags)&&void 0!==C?C:[]},G),ee=Object(n.useMemo)((()=>!!t||!!Q.item.item_id),[Q.item.item_id,t]),te=Object(n.useMemo)((()=>B&&!ee),[ee,B]),ae=Object(n.useCallback)((()=>{U||(D({...A,itemId:void 0,show:void 0},!0),k())}),[U,k,D,A]),ne=Object(n.useCallback)((({item:e,isValid:t})=>{q()&&X({item:e,isValid:t})}),[q]),re=Object(n.useCallback)((e=>{_.addSuccess(B?F.flyoutEditSubmitSuccess(e):F.flyoutCreateSubmitSuccess(e)),q()&&(D({...A,itemId:void 0,show:void 0},!0),x())}),[B,q,F,x,D,_,A]),ie=Object(n.useCallback)((()=>{w?(R(!0),w(Q.item,G).then(re).catch((e=>{q()&&z(e)})).finally((()=>{q()&&R(!1)}))):H(Q.item).then(re)}),[G,Q.item,re,q,H,w]);return Object(n.useEffect)((()=>{!B||ee||Z||!te||Y||K().then((({data:t})=>{t&&q()&&X(E(e.listId,t))}))}),[e.listId,Z,K,B,te,Y,ee,q]),Object(n.useEffect)((()=>{var e;B&&Z&&(_.addWarning(F.flyoutEditItemLoadFailure((null==Z||null===(e=Z.body)||void 0===e?void 0:e.message)||Z.message)),D({itemId:void 0,show:void 0}))}),[Z,B,F,D,_,A.itemId]),!N||Z?null:r.a.createElement(o.EuiFlyout,{size:O,onClose:ae,"data-test-subj":S},r.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0},r.a.createElement(o.EuiTitle,{size:"m"},r.a.createElement("h2",null,B?F.flyoutEditTitle:F.flyoutCreateTitle))),!te&&J&&r.a.createElement(o.EuiCallOut,{title:F.flyoutDowngradedLicenseTitle,color:"warning",iconType:"help","data-test-subj":T("expiredLicenseCallout")},F.flyoutDowngradedLicenseInfo," ",F.flyoutDowngradedLicenseDocsInfo(M)),r.a.createElement(o.EuiFlyoutBody,null,te&&r.a.createElement(p.a,{"data-test-subj":T("loader")}),!te&&r.a.createElement(y,{onChange:ne,disabled:U,item:Q.item,error:null!=W?W:void 0,mode:G,policies:a,policiesIsLoading:i})),!te&&r.a.createElement(o.EuiFlyoutFooter,null,r.a.createElement(o.EuiFlexGroup,{justifyContent:"spaceBetween"},r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButtonEmpty,{"data-test-subj":T("cancelButton"),onClick:ae,disabled:U},F.flyoutCancelButtonLabel)),r.a.createElement(o.EuiFlexItem,{grow:!1},r.a.createElement(o.EuiButton,{"data-test-subj":T("submitButton"),fill:!0,disabled:!Q.isValid||U,onClick:ie,isLoading:U},B?F.flyoutEditSubmitButtonLabel:F.flyoutCreateSubmitButtonLabel)))))}));x.displayName="ArtifactFlyout"},1435:function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"c",(function(){return y})),a.d(t,"a",(function(){return f}));var n=a(17),r=a(2),i=a.n(r),o=a(44),s=a.n(o),l=a(166),c=a(137),u=a(5);const d=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.clientCertLabel",{defaultMessage:"client cert"}),p=u.i18n.translate("xpack.securitySolution.certificate.fingerprint.serverCertLabel",{defaultMessage:"server cert"}),m="tls.client_certificate.fingerprint.sha1",y="tls.server_certificate.fingerprint.sha1",g=s.a.span.withConfig({displayName:"FingerprintLabel",componentId:"sc-1isap0l-0"})(["margin-right:5px;"]);g.displayName="FingerprintLabel";const f=i.a.memo((({eventId:e,certificateType:t,contextId:a,fieldName:r,isDraggable:o,value:s})=>i.a.createElement(l.c,{contextId:a,"data-test-subj":`${t}-certificate-fingerprint`,eventId:e,field:r,iconType:"snowflake",isDraggable:o,tooltipContent:i.a.createElement(n.EuiText,{size:"xs"},i.a.createElement("span",null,r)),value:s,isAggregatable:!0,fieldType:"keyword"},i.a.createElement(g,null,"client"===t?d:p),i.a.createElement(c.b,{certificateFingerprint:s||""}))));f.displayName="CertificateFingerprint"},1436:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return p}));var n=a(2),r=a.n(n),i=a(44),o=a.n(i),s=a(166),l=a(137);const c=a(5).i18n.translate("xpack.securitySolution.ja3.fingerprint.ja3.fingerprintLabel",{defaultMessage:"ja3"}),u="tls.fingerprints.ja3.hash",d=o.a.span.withConfig({displayName:"Ja3FingerprintLabel",componentId:"sc-94sjip-0"})(["margin-right:5px;"]);d.displayName="Ja3FingerprintLabel";const p=r.a.memo((({contextId:e,eventId:t,fieldName:a,isDraggable:n,value:i})=>r.a.createElement(s.c,{contextId:e,"data-test-subj":"ja3-hash",eventId:t,field:a,iconType:"snowflake",isDraggable:n,value:i,isAggregatable:!0,fieldType:"keyword"},r.a.createElement(d,null,c),r.a.createElement(l.e,{"data-test-subj":"ja3-hash-link",ja3Fingerprint:i||""}))));p.displayName="Ja3Fingerprint"},1437:function(e,t,a){"use strict";a.d(t,"b",(function(){return n.a})),a.d(t,"a",(function(){return b})),a(1375),a(1371),a(1376),a(1379);var n=a(1377),r=(a(1380),a(2)),i=a(738),o=a(387),s=a(9),l=a(531),c=a(213),u=a(4),d=a(110),p=a(1431),m=a(1553),y=a(576),g=a(1060);const f={contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"},b=e=>{const t=Object(d.m)(),{services:a}=Object(d.i)(),{http:n,notifications:b}=a,{navigateToApp:h}=a.application,{exportExceptionList:v,deleteExceptionList:E,duplicateExceptionList:x}=Object(o.c)(n),[{loading:k,canUserCRUD:w,canUserREAD:j}]=Object(c.b)(),[S,O]=Object(r.useState)(),[I,C]=Object(r.useState)(!1),[M,T]=Object(r.useState)(),[_,N]=Object(r.useState)(!1),[D,A]=Object(r.useState)([]),[q,F]=Object(r.useState)([]),[L,R]=Object(r.useState)(!0),[P,z]=Object(r.useState)(""),[B,G]=Object(r.useState)(),[$,H]=Object(r.useState)(!1),[V,U]=Object(r.useState)(f),[W,Y]=Object(r.useState)(!0),[Z,K]=Object(r.useState)(!1),Q=Object(g.b)(),X=Object(r.useMemo)((()=>({pageId:u.yc.exceptions,path:"",onNavigate:()=>{h(u.l,{deepLinkId:u.yc.exceptions,path:""})}})),[h]),J=Object(r.useCallback)(((e,a,n,r)=>{null==t||t.addError(e,{title:null!=n?n:"",toastMessage:null!=r?r:""}),z(null!=a?a:"")}),[t]),ee=Object(r.useCallback)((async e=>{const t=await Object(p.e)(e.list_id);A(t)}),[]),te=Object(r.useCallback)((async()=>{try{if(l.a.includes(e))return N(!0);O(!0);const t=await Object(p.d)({id:e,http:n});if(!t||!Object(m.b)(t))return O(!1),N(!0);if(T(t),await ee(t),O(!1),N(!1),Object(m.a)(t))return R(!1)}catch(e){J(e,i.i.ERROR,y.q,y.p)}}),[e,n,ee,J]);Object(r.useEffect)((()=>{te()}),[te]);const[ae,ne]=Object(r.useState)(!1),re=Object(r.useCallback)((async t=>{try{var a;M&&await Object(p.i)({http:n,list:{id:M.id,list_id:e,type:M.type,name:t.name,description:null!==(a=t.description)&&void 0!==a?a:"",namespace_type:M.namespace_type}})}catch(e){J(e)}}),[e,J,n,M]),ie=Object(r.useCallback)((async e=>{try{if(!M)return;await v({id:M.id,listId:M.list_id,includeExpiredExceptions:e,namespaceType:M.namespace_type,onError:e=>J(e),onSuccess:e=>{G(e),null==t||t.addSuccess(y.C(M.name))}})}catch(e){J(e,void 0,y.r,y.s)}}),[M,v,J,t]),oe=Object(r.useCallback)((async e=>{try{if(!M)return;await x({listId:M.list_id,includeExpiredExceptions:e,namespaceType:M.namespace_type,onError:e=>J(e),onSuccess:e=>{null==t||t.addSuccess(y.v(M.name)),h(u.l,{deepLinkId:u.yc.exceptions,path:`/details/${e.list_id}`})}})}catch(e){J(e,void 0,y.n,y.o)}}),[M,x,J,t,h]),se=Object(r.useCallback)((()=>{G(void 0)}),[]),le=Object(r.useCallback)((e=>()=>{b.toasts.addSuccess({title:y.nb(null!=e?e:V.listId)})}),[b.toasts,V.listId]),ce=Object(r.useCallback)((e=>{J(e)}),[J]),ue=Object(r.useCallback)((async()=>{try{if(!M)return;await E({id:M.id,namespaceType:M.namespace_type,onError:ce,onSuccess:le})}catch(e){J(e)}finally{U(f),H(!1),h(u.l,{deepLinkId:u.yc.exceptions,path:""})}}),[M,E,ce,le,J,h]),de=Object(r.useCallback)((()=>{try{if(!M)return;U({contentText:D.length?y.pb(D.length):y.mb(M.name),rulesReferences:D.map((({name:e})=>e)),isLoading:!0,listId:M.list_id,listNamespaceType:M.namespace_type}),H(!0)}catch(e){J(e)}}),[J,D,M]),pe=Object(r.useCallback)((()=>{H(!1),U({contentText:"",rulesReferences:[],isLoading:!1,listId:"",listNamespaceType:"single"})}),[]),me=Object(r.useCallback)((async()=>{try{await Object(p.h)({rules:D,listId:e}),ue()}catch(e){J(e)}}),[e,D,J,ue]),ye=Object(r.useCallback)((()=>{A(q),F(q),ne(!1),C(!1),Y(!0)}),[q]),ge=Object(r.useCallback)((()=>{ne(!0)}),[]),fe=Object(r.useCallback)((()=>q.filter((e=>!D.includes(e)))),[D,q]),be=Object(r.useCallback)((()=>D.filter((e=>!q.includes(e)))),[D,q]),he=Object(r.useCallback)((e=>{F(e),Y(!1)}),[]),ve=Object(r.useCallback)((async()=>{try{if(!M)return ne(!1);C(!0);const t=fe(),a=be();if(!t.length&&!a.length||Object(s.isEqual)(t,a))return ye();Promise.all([Object(p.h)({rules:a,listId:e}),Object(p.f)({rules:t,listId:e,id:M.id,listType:M.type,listNamespaceType:M.namespace_type})]).then((()=>{K(!0),ye()})).then((()=>K(!1))).then((()=>Q())).catch((e=>{J(e,void 0,y.E,y.F),C(!1)})).finally((()=>{te()}))}catch(e){J(e)}}),[M,fe,be,ye,e,Q,J,te]),Ee=Object(r.useCallback)((()=>{ne(!1)}),[]);return{isLoading:S||k,invalidListId:_,isReadOnly:!(w||!j),list:M,listName:null==M?void 0:M.name,listDescription:null==M?void 0:M.description,listId:e,canUserEditList:L,linkedRules:D,exportedList:B,handleOnDownload:se,viewerStatus:P,showManageRulesFlyout:ae,headerBackOptions:X,referenceModalState:V,showReferenceErrorModal:$,showManageButtonLoader:I,refreshExceptions:Z,disableManageButton:W,handleDelete:de,onDuplicateList:oe,onEditListDetails:re,onExportList:ie,onDeleteList:ue,onManageRules:ge,onSaveManageRules:ve,onCancelManageRules:Ee,onRuleSelectionChange:he,handleCloseReferenceErrorModal:pe,handleReferenceDelete:me}}},1440:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(2),r=a.n(n),i=a(44),o=a.n(i),s=a(17),l=a(4),c=a(5);const u=c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.unknownAvatarName",{defaultMessage:"Uknown"}),d=c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.addCommentPlaceholder",{defaultMessage:"Add a new comment..."});var p=a(110),m=a(1089);const y="exceptionCommentAccordionButton",g=o()(s.EuiAvatar).withConfig({displayName:"MyAvatar",componentId:"sc-ggp4j5-0"})(["",""],(({theme:e})=>Object(i.css)(["margin-right:",";"],e.eui.euiSizeS))),f=o()(s.EuiAccordion).withConfig({displayName:"CommentAccordion",componentId:"sc-ggp4j5-1"})(["",""],(({theme:e})=>Object(i.css)([".","{color:",";padding:"," 0;}"],y,e.eui.euiColorPrimary,e.eui.euiSizeM))),b=Object(n.memo)((function({exceptionItemComments:e,newCommentValue:t,accordionTitle:a,initialIsOpen:i=!1,newCommentOnChange:o,setCommentError:b}){const[h,v]=Object(n.useState)(!1),[E,x]=Object(n.useState)(!1),k=Object(p.f)(),w=null==k?void 0:k.fullName,j=null==k?void 0:k.username,S=null==k?void 0:k.email,O=Object(n.useMemo)((()=>w&&w.length>0?w:S&&S.length>0?S:j&&j.length>0?j:u),[w,S,j]);Object(n.useEffect)((()=>{b(h)}),[h,b]);const I=Object(n.useCallback)((e=>{o(e.target.value),v(e.target.value.length>l.Lb)}),[o]),C=Object(n.useCallback)((e=>{x(e)}),[]),M=Object(n.useMemo)((()=>{return e&&e.length>0?r.a.createElement(s.EuiText,{size:"s","data-test-subj":"ExceptionItemCommentsAccordionButton"},E?(e=>c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.hideCommentsLabel",{values:{comments:e},defaultMessage:"Hide ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))(e.length):(t=e.length,c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.showCommentsLabel",{values:{comments:t},defaultMessage:"Show ({comments}) {comments, plural, =1 {Comment} other {Comments}}"}))):null;var t}),[e,E]),T=Object(n.useMemo)((()=>e&&e.length>0?Object(m.j)(e):[]),[e]);return r.a.createElement("div",null,r.a.createElement(f,{initialIsOpen:i&&!!t,id:"add-exception-comments-accordion",buttonClassName:y,buttonContent:null!=a?a:M,"data-test-subj":"exceptionItemCommentsAccordion",onToggle:e=>C(e)},r.a.createElement(s.EuiCommentList,{comments:T}),r.a.createElement(s.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(s.EuiFlexItem,{grow:!1},r.a.createElement(g,{name:O,size:"l","data-test-subj":"exceptionItemCommentAvatar"})),r.a.createElement(s.EuiFlexItem,{grow:1},r.a.createElement(s.EuiFormRow,{fullWidth:!0,error:(_=l.Lb,c.i18n.translate("xpack.securitySolution.rule_exceptions.itemComments.maxLengthError",{values:{length:_},defaultMessage:"The length of the comment is too long. The maximum length is {length} characters."})),isInvalid:h},r.a.createElement(s.EuiTextArea,{placeholder:d,"aria-label":"Comment Input",value:t,onChange:I,fullWidth:!0,"data-test-subj":"newExceptionItemCommentTextArea"}))))));var _}))},1468:function(e,t,a){"use strict";(function(e,t){a(1605);var n=a(1606),r=a.n(n);a(94),a(9),a(1607),r.a.resolve(r.a.join(e,"..")),"\n/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License\n * 2.0 and the Server Side Public License, v 1; you may not use this file except\n * in compliance with, at your election, the Elastic License 2.0 or the Server\n * Side Public License, v 1.\n */\n// ---------------------------------- WARNING ----------------------------------\n// this file was generated, and should not be edited by hand\n// ---------------------------------- WARNING ----------------------------------\nimport * as rt from 'io-ts';\nimport { Either } from 'fp-ts/lib/Either';\n%%IMPORTS%%\nconst ISO_DATE_PATTERN = /^d{4}-d{2}-d{2}Td{2}:d{2}:d{2}.d{3}Z$/;\nexport const IsoDateString = new rt.Type<string, string, unknown>(\n  'IsoDateString',\n  rt.string.is,\n  (input, context): Either<rt.Errors, string> => {\n    if (typeof input === 'string' && ISO_DATE_PATTERN.test(input)) {\n      return rt.success(input);\n    } else {\n      return rt.failure(input, context);\n    }\n  },\n  rt.identity\n);\nexport type IsoDateStringC = typeof IsoDateString;\nexport const schemaUnknown = rt.unknown;\nexport const schemaUnknownArray = rt.array(rt.unknown);\nexport const schemaString = rt.string;\nexport const schemaStringArray = rt.array(schemaString);\nexport const schemaNumber = rt.number;\nexport const schemaNumberArray = rt.array(schemaNumber);\nexport const schemaDate = rt.union([IsoDateString, schemaNumber]);\nexport const schemaDateArray = rt.array(schemaDate);\nexport const schemaDateRange = rt.partial({\n  gte: schemaDate,\n  lte: schemaDate,\n});\nexport const schemaDateRangeArray = rt.array(schemaDateRange);\nexport const schemaStringOrNumber = rt.union([schemaString, schemaNumber]);\nexport const schemaStringOrNumberArray = rt.array(schemaStringOrNumber);\nexport const schemaBoolean = rt.boolean;\nexport const schemaBooleanArray = rt.array(schemaBoolean);\nconst schemaGeoPointCoords = rt.type({\n  type: schemaString,\n  coordinates: schemaNumberArray,\n});\nconst schemaGeoPointString = schemaString;\nconst schemaGeoPointLatLon = rt.type({\n  lat: schemaNumber,\n  lon: schemaNumber,\n});\nconst schemaGeoPointLocation = rt.type({\n  location: schemaNumberArray,\n});\nconst schemaGeoPointLocationString = rt.type({\n  location: schemaString,\n});\nexport const schemaGeoPoint = rt.union([\n  schemaGeoPointCoords,\n  schemaGeoPointString,\n  schemaGeoPointLatLon,\n  schemaGeoPointLocation,\n  schemaGeoPointLocationString,\n]);\nexport const schemaGeoPointArray = rt.array(schemaGeoPoint);\n// prettier-ignore\nconst %%schemaPrefix%%Required = %%REQUIRED_FIELDS%%;\nconst %%schemaPrefix%%Optional = %%OPTIONAL_FIELDS%%;\n\n// prettier-ignore\nexport const %%schemaPrefix%%Schema = rt.intersection([%%schemaPrefix%%Required, %%schemaPrefix%%Optional%%INCLUDED_SCHEMAS%%]);\n// prettier-ignore\nexport type %%schemaPrefix%% = rt.TypeOf<typeof %%schemaPrefix%%Schema>;\n\n".trim()}).call(this,"/",a(391))},1469:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>e?e[0]:void 0},1470:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),r=a.n(n),i=a(17),o=a(243),s=a(961);const l=({width:e=s.b,dataTestSubj:t,content:a,ariaLabel:n,iconType:l="",isDisabled:c=!1,onClick:u,children:d,buttonType:p="icon"})=>r.a.createElement(r.a.Fragment,null,"icon"===p&&r.a.createElement("div",null,r.a.createElement(o.l,{textAlign:"center",width:e},null!=d?d:r.a.createElement(i.EuiToolTip,{"data-test-subj":`${t}-tool-tip`,content:a},r.a.createElement(i.EuiButtonIcon,{"aria-label":n,"data-test-subj":`${t}-button`,iconType:l,isDisabled:c,onClick:u,size:"s"})))),"text"===p&&r.a.createElement(i.EuiContextMenuItem,{"aria-label":n,"data-test-subj":`${t}-button-menu-item`,disabled:c,onClick:u,color:"text",size:"s"},r.a.createElement(i.EuiText,{"data-test-subj":`${t}-button`,size:"m"},a)),"emptyButton"===p&&r.a.createElement(i.EuiButtonEmpty,{onClick:u,iconType:"timeline",flush:"right",size:"xs","data-test-subj":t},a));l.displayName="ActionIconItemComponent";const c=r.a.memo(l)},1471:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(17),r=a(45),i=a(2),o=a.n(i),s=a(113),l=a(592);const c=e=>e?"pinFilled":"pin",u=o.a.memo((({ariaLabel:e,allowUnpinning:t,isAlert:a,isDisabled:i,onClick:u=r.noop,pinned:d,timelineType:p})=>{const m=p===s.l.template,y=(({isAlert:e,isTemplate:t,isPinned:a})=>t?l.b(e):a?l.c(e):l.g(e))({isAlert:a,isTemplate:m,isPinned:d}),g=null!=e?e:y;return o.a.createElement(n.EuiButtonIcon,{"aria-label":g,"data-test-subj":"pin",iconType:c(d),onClick:u,isDisabled:i||m||!t,size:"s"})}));u.displayName="Pin"},1472:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(709);const r=({handleClick:e})=>({key:"osquery-action-item","data-test-subj":"osquery-action-item",onClick:e,size:"s",name:n.a})},1473:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),r=a(169),i=a(117),o=a(110),s=a(241),l=a(555),c=a(1530),u=a(340);const d=e=>{const{data:t,spaces:a}=Object(o.i)().services,{addWarning:d}=Object(i.a)(),[p,m]=Object(n.useState)(!1),[y,g]=Object(n.useState)(""),f=Object(n.useMemo)((()=>null!=e&&1===e.length),[e]),b=Object(n.useMemo)((()=>null!=e&&f&&"machine_learning"===e[0].type),[f,e]);Object(n.useEffect)((()=>{(async()=>{if(a){const e=await a.getActiveSpace();g(e.id)}})()}),[a]);const h=Object(n.useMemo)((()=>null!=e&&f?"data_view_id"in e[0]&&e[0].data_view_id||null:`security-solution-${y}`),[f,e,y]),v=Object(n.useMemo)((()=>null!=e&&f&&"esql"===e[0].type?Object(r.f)(null==e?void 0:e[0].query):!h&&null!=e&&f&&"index"in e[0]&&null!=e[0].index?e[0].index:[]),[h,f,e]),E=Object(n.useMemo)((()=>{var t;return b&&f&&null!=e&&null!==(t=Object(u.g)(e[0]))&&void 0!==t?t:[]}),[b,f,e]),{mlJobLoading:x,ruleIndices:k}=Object(c.a)(E),w=Object(n.useMemo)((()=>b&&k.length>0?k:null!=h?[]:v),[b,h,v,k]),[j,{indexPatterns:S,dataView:O}]=Object(s.b)(w,!1,"indexFields"),[I,C]=Object(n.useState)(null),[M,T]=Object(n.useState)(null);Object(n.useEffect)((()=>{(async()=>{if(""!==y&&h){m(!0);const e=await t.dataViews.get(h);m(!1),C(e),T(e.toSpec())}})()}),[h,t.dataViews,C,y]);const _=Object(n.useCallback)((async e=>{let a=[];const n=null!=M?M:O;if(!n)return a;try{a=await t.dataViews.getFieldsForIndexPattern(n,{pattern:"",includeUnmapped:!0,fields:e})}catch(e){d(e,{title:l.b})}return a}),[d,t.dataViews,M,O]);return{isLoading:j||x||p,indexPatterns:Object(n.useMemo)((()=>h&&null!=I?I:S),[h,I,S]),getExtendedFields:_}}},1474:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(163),i=a(110),o=a(1291);const s=()=>{const e=Object(i.m)(),[t,a]=Object(n.useState)(!0),[s,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)(null),d=Object(n.useRef)(null);return Object(n.useEffect)((()=>{let t=!0;const n=new AbortController;return d.current=async i=>{try{a(!0);const{references:e}=await Object(r.l)({lists:i,signal:n.signal}),o=e.reduce(((e,t)=>{const[[a,n]]=Object.entries(t);return e[a]=n,e}),{});t&&(a(!1),l(!1),u(o))}catch(n){t&&(l(!0),a(!1),e.addError(n,{title:o.c}))}},()=>{t=!1,n.abort()}}),[e]),[t,s,c,d.current]}},1475:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(387),i=a(1089),o=a(110);const s=()=>{const{services:{http:e}}=Object(o.i)(),[t,a]=Object(n.useState)(!1),s=Object(n.useRef)(null),{addExceptionListItem:l,updateExceptionListItem:c}=Object(r.c)(e);return Object(n.useEffect)((()=>{const e=new AbortController;return s.current=async e=>{try{a(!0);const t=await Promise.all(e.map((e=>{if("id"in e&&null!=e.id){const t=Object(i.i)(e);return c({listItem:t})}return l({listItem:e})})));return a(!1),t}catch(e){throw a(!1),e}},()=>{a(!1),e.abort()}}),[c,e,l]),[t,s.current]}},1478:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(746);const r=(e,t)=>{const a=Object(n.g)(e),r=Object(n.b)(e);return"create"===t?r:a}},1480:function(e,t,a){"use strict";a.d(t,"a",(function(){return y})),a.d(t,"e",(function(){return g})),a.d(t,"b",(function(){return f})),a.d(t,"d",(function(){return b})),a.d(t,"f",(function(){return h})),a.d(t,"g",(function(){return v})),a.d(t,"c",(function(){return x}));var n=a(2),r=a.n(n),i=a(5),o=a(47),s=a(17),l=a(135),c=a(110),u=a(1320),d=a(1107),p=a(1549),m=a(1108);const y=i.i18n.translate("xpack.securitySolution.eventFilters.aboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),g=i.i18n.translate("xpack.securitySolution.eventFilter.form.name.label",{defaultMessage:"Name"}),f=i.i18n.translate("xpack.securitySolution.eventFilter.form.description.placeholder",{defaultMessage:"Description"}),b=i.i18n.translate("xpack.securitySolution.eventFilter.form.name.error",{defaultMessage:"The name can't be empty"}),h=i.i18n.translate("xpack.securitySolution.eventFilter.form.os.label",{defaultMessage:"Select operating system"}),v=i.i18n.translate("xpack.securitySolution.eventFilter.form.rule.name",{defaultMessage:"Endpoint Event Filtering"}),E={pageTitle:i.i18n.translate("xpack.securitySolution.eventFilters.pageTitle",{defaultMessage:"Event Filters"}),pageAboutInfo:i.i18n.translate("xpack.securitySolution.eventFilters.pageAboutInfo",{defaultMessage:"Event filters exclude high volume or unwanted events from being written to Elasticsearch."}),pageAddButtonTitle:i.i18n.translate("xpack.securitySolution.eventFilters.pageAddButtonTitle",{defaultMessage:"Add event filter"}),getShowingCountLabel:e=>i.i18n.translate("xpack.securitySolution.eventFilters.showingTotal",{defaultMessage:"Showing {total} {total, plural, one {event filter} other {event filters}}",values:{total:e}}),cardActionEditLabel:i.i18n.translate("xpack.securitySolution.eventFilters.cardActionEditLabel",{defaultMessage:"Edit event filter"}),cardActionDeleteLabel:i.i18n.translate("xpack.securitySolution.eventFilters.cardActionDeleteLabel",{defaultMessage:"Delete event filter"}),flyoutCreateTitle:i.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateTitle",{defaultMessage:"Add event filter"}),flyoutEditTitle:i.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditTitle",{defaultMessage:"Edit event filter"}),flyoutCreateSubmitButtonLabel:i.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitButtonLabel",{defaultMessage:"Add event filter"}),flyoutCreateSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.eventFilters.flyoutCreateSubmitSuccess",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:e}}),flyoutEditSubmitSuccess:({name:e})=>i.i18n.translate("xpack.securitySolution.eventFilters.flyoutEditSubmitSuccess",{defaultMessage:'"{name}" has been updated.',values:{name:e}}),flyoutDowngradedLicenseDocsInfo:e=>r.a.createElement(r.a.Fragment,null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsInfo",defaultMessage:"For more information, see our "}),r.a.createElement(s.EuiLink,{target:"_blank",href:`${e.eventFilters}`},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.eventFilters.flyoutDowngradedLicenseDocsLink",defaultMessage:"Event filters documentation"}))),deleteActionSuccess:e=>i.i18n.translate("xpack.securitySolution.eventFilters.deleteSuccess",{defaultMessage:'"{itemName}" has been removed from event filters list.',values:{itemName:e}}),emptyStateTitleNoEntries:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStateTitleNoEntries",{defaultMessage:"There are no event filters to display."}),emptyStateTitle:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStateTitle",{defaultMessage:"Add your first event filter"}),emptyStateInfo:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStateInfo",{defaultMessage:"Add an event filter to exclude high volume or unwanted events from being written to Elasticsearch."}),emptyStatePrimaryButtonLabel:i.i18n.translate("xpack.securitySolution.eventFilters.emptyStatePrimaryButtonLabel",{defaultMessage:"Add event filter"}),searchPlaceholderInfo:i.i18n.translate("xpack.securitySolution.eventFilters.searchPlaceholderInfo",{defaultMessage:"Search on the fields below: name, description, comments, value"})},x=Object(n.memo)((()=>{const{canWriteEventFilters:e}=Object(l.a)().endpointPrivileges,t=Object(c.h)(),a=d.a.getInstance(t);return r.a.createElement(u.a,{apiClient:a,ArtifactFormComponent:p.a,labels:E,"data-test-subj":"EventFiltersListPage",searchableFields:m.d,flyoutSize:"l",allowCardCreateAction:e,allowCardEditAction:e,allowCardDeleteAction:e})}));x.displayName="EventFiltersList"},1481:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),r=a(530);const i=["create","edit"],o=(e=!0,t=!0)=>{var a;const o=null!==(a=Object(r.a)().urlParams.show)&&void 0!==a?a:"";return Object(n.useMemo)((()=>!!i.includes(o)&&("create"===o&&t||"edit"===o&&e)),[t,e,o])}},1483:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2);const r=({refetch:e,onRuleChange:t,isActiveTimelines:a})=>{const[r,i]=Object(n.useState)(!1),[o,s]=Object(n.useState)(null);return{exceptionFlyoutType:o,openAddExceptionFlyout:r,onAddExceptionTypeClick:Object(n.useCallback)((e=>{s(null!=e?e:null),i(!0)}),[]),onAddExceptionCancel:Object(n.useCallback)((()=>{s(null),i(!1)}),[]),onAddExceptionConfirm:Object(n.useCallback)(((n,r,o)=>{e&&(!1===a||o)&&e(),null!=t&&n&&t(),i(!1)}),[t,e,a])}}},1484:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a(139),i=a(1159),o=a(213),s=a(197);const l=({isEndpointAlert:e,onAddExceptionTypeClick:t})=>{const{exceptionActionItems:a}=(({isEndpointAlert:e,onAddExceptionTypeClick:t})=>{const[{canUserCRUD:a,hasIndexWrite:i}]=Object(o.b)(),l=Object(n.useCallback)((()=>{t()}),[t]),c=Object(n.useCallback)((()=>{t(r.b.ENDPOINT)}),[t]),u=!a||!i||!e,d=!a||!i;return{exceptionActionItems:Object(n.useMemo)((()=>d?[]:[{key:"add-endpoint-exception-menu-item","data-test-subj":"add-endpoint-exception-menu-item",disabled:u,onClick:c,name:s.d},{key:"add-exception-menu-item","data-test-subj":"add-exception-menu-item",disabled:d,onClick:l,name:s.g}]),[u,d,l,c])}})({isEndpointAlert:e,onAddExceptionTypeClick:t});return Object(i.a)("crudEndpointExceptions")?{exceptionActionItems:a}:{exceptionActionItems:a.map((e=>({...e,disabled:e.name===s.d})))}}},1485:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2);const r=()=>{const[e,t]=Object(n.useState)(!1),a=Object(n.useCallback)((()=>{t(!0)}),[]);return{closeAddEventFilterModal:Object(n.useCallback)((()=>{t(!1)}),[]),isAddEventFilterModalOpen:e,onAddEventFilterClick:a}}},1486:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2),r=a(197);const i=({onAddEventFilterClick:e,disabled:t=!1,tooltipMessage:a})=>({eventFilterActionItems:Object(n.useMemo)((()=>[{key:"add-event-filter-menu-item","data-test-subj":"add-event-filter-menu-item",onClick:e,disabled:t,toolTipContent:a,name:r.e}]),[e,t,a])})},1487:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),r=a(142),i=a(1522),o=a(262);const s=({closePopover:e,ecsRowData:t,refetch:a})=>{var s;const{hasIndexWrite:l}=Object(o.a)(),c=t._id,u=Object(n.useMemo)((()=>{var e,a,n,i;return[{_id:c,_index:null!==(e=t._index)&&void 0!==e?e:"",data:[{field:r.qb,value:null!==(a=null==t||null===(n=t.kibana)||void 0===n?void 0:n.alert.workflow_tags)&&void 0!==a?a:[]}],ecs:{_id:c,_index:null!==(i=t._index)&&void 0!==i?i:""}}]}),[c,t._index,null==t||null===(s=t.kibana)||void 0===s?void 0:s.alert.workflow_tags]),{alertTagsItems:d,alertTagsPanels:p}=Object(i.a)({refetch:a}),m=Object(n.useMemo)((()=>d.map((e=>({name:e.name,panel:e.panel,"data-test-subj":e["data-test-subj"],key:e.key})))),[d]);return{alertTagsItems:l?m:[],alertTagsPanels:Object(n.useMemo)((()=>p.map((t=>{const a=t.renderContent({closePopoverMenu:e,setIsBulkActionsLoading:()=>{},alertItems:u});return{title:t.title,content:a,id:t.id}}))),[u,p,e])}}},1488:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(9),r=a(2),i=a(142),o=a(1166),s=a(1536),l=a(262);const c=({closePopover:e,ecsRowData:t,refetch:a})=>{var c;const{hasIndexWrite:u}=Object(l.a)(),d=t._id,p=Object(r.useMemo)((()=>{var e,a,n,r;return[{_id:d,_index:null!==(e=t._index)&&void 0!==e?e:"",data:[{field:i.mb,value:null!==(a=null==t||null===(n=t.kibana)||void 0===n?void 0:n.alert.workflow_assignee_ids)&&void 0!==a?a:[]}],ecs:{_id:d,_index:null!==(r=t._index)&&void 0!==r?r:""}}]}),[d,t._index,null==t||null===(c=t.kibana)||void 0===c?void 0:c.alert.workflow_assignee_ids]),m=Object(r.useCallback)((()=>{e(),a&&a()}),[e,a]),{alertAssigneesItems:y,alertAssigneesPanels:g}=Object(s.a)({onAssigneesUpdate:m}),f=Object(r.useMemo)((()=>y.map((e=>({name:e.name,panel:e.panel,"data-test-subj":e["data-test-subj"],key:e.key,onClick:()=>{var t;return null===(t=e.onClick)||void 0===t?void 0:t.call(e,p,!1,n.noop,n.noop,n.noop)}})))),[p,y]);return{alertAssigneesItems:u?f:[],alertAssigneesPanels:Object(r.useMemo)((()=>g.map((t=>{const a=t.renderContent({closePopoverMenu:e,setIsBulkActionsLoading:()=>{},alertItems:p,refresh:m});return{title:t.title,content:a,id:t.id,width:o.a}}))),[p,g,e,m])}}},1496:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(5).i18n.translate("xpack.securitySolution.source.destination.packetsLabel",{defaultMessage:"pkts"})},1497:function(e,t,a){!function(e){"use strict";function t(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function a(e){let a=e,n=e;function r(e,t,a,r){for(null==a&&(a=0),null==r&&(r=e.length);a<r;){const i=a+r>>>1;n(e[i],t)<0?a=i+1:r=i}return a}return 1===e.length&&(a=(t,a)=>e(t)-a,n=function(e){return(a,n)=>t(e(a),n)}(e)),{left:r,center:function(e,t,n,i){null==n&&(n=0),null==i&&(i=e.length);const o=r(e,t,n,i-1);return o>n&&a(e[o-1],t)>-a(e[o],t)?o-1:o},right:function(e,t,a,r){for(null==a&&(a=0),null==r&&(r=e.length);a<r;){const i=a+r>>>1;n(e[i],t)>0?r=i:a=i+1}return a}}}function n(e){return null===e?NaN:+e}const r=a(t),i=r.right,o=r.left,s=a(n).center;function l(e,t){let a=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&++a;else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(r=+r)>=r&&++a}return a}function c(e){return 0|e.length}function u(e){return!(e>0)}function d(e){return"object"!=typeof e||"length"in e?e:Array.from(e)}function p(e,t){let a,n=0,r=0,i=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(a=t-r,r+=a/++n,i+=a*(t-r));else{let o=-1;for(let s of e)null!=(s=t(s,++o,e))&&(s=+s)>=s&&(a=s-r,r+=a/++n,i+=a*(s-r))}if(n>1)return i/(n-1)}function m(e,t){const a=p(e,t);return a?Math.sqrt(a):a}function y(e,t){let a,n;if(void 0===t)for(const t of e)null!=t&&(void 0===a?t>=t&&(a=n=t):(a>t&&(a=t),n<t&&(n=t)));else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(void 0===a?i>=i&&(a=n=i):(a>i&&(a=i),n<i&&(n=i)))}return[a,n]}class Adder{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let a=0;for(let n=0;n<this._n&&n<32;n++){const r=t[n],i=e+r,o=Math.abs(e)<Math.abs(r)?e-(i-r):r-(i-e);o&&(t[a++]=o),e=i}return t[a]=e,this._n=a+1,this}valueOf(){const e=this._partials;let t,a,n,r=this._n,i=0;if(r>0){for(i=e[--r];r>0&&(t=i,a=e[--r],i=t+a,n=a-(i-t),!n););r>0&&(n<0&&e[r-1]<0||n>0&&e[r-1]>0)&&(a=2*n,t=i+a,a==t-i&&(i=t))}return i}}class InternMap extends Map{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,a]of e)this.set(t,a)}get(e){return super.get(g(this,e))}has(e){return super.has(g(this,e))}set(e,t){return super.set(f(this,e),t)}delete(e){return super.delete(b(this,e))}}class InternSet extends Set{constructor(e,t=h){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const t of e)this.add(t)}has(e){return super.has(g(this,e))}add(e){return super.add(f(this,e))}delete(e){return super.delete(b(this,e))}}function g({_intern:e,_key:t},a){const n=t(a);return e.has(n)?e.get(n):a}function f({_intern:e,_key:t},a){const n=t(a);return e.has(n)?e.get(n):(e.set(n,a),a)}function b({_intern:e,_key:t},a){const n=t(a);return e.has(n)&&(a=e.get(a),e.delete(n)),a}function h(e){return null!==e&&"object"==typeof e?e.valueOf():e}function v(e){return e}function E(e,...t){return w(e,v,v,t)}function x(e,t,...a){return w(e,v,t,a)}function k(e){if(1!==e.length)throw new Error("duplicate key");return e[0]}function w(e,t,a,n){return function e(r,i){if(i>=n.length)return a(r);const o=new InternMap,s=n[i++];let l=-1;for(const e of r){const t=s(e,++l,r),a=o.get(t);a?a.push(e):o.set(t,[e])}for(const[t,a]of o)o.set(t,e(a,i));return t(o)}(e,0)}function j(e,t){return Array.from(t,(t=>e[t]))}function S(e,...a){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);let[n=t]=a;if(1===n.length||a.length>1){const r=Uint32Array.from(e,((e,t)=>t));return a.length>1?(a=a.map((t=>e.map(t))),r.sort(((e,n)=>{for(const r of a){const a=t(r[e],r[n]);if(a)return a}}))):(n=e.map(n),r.sort(((e,a)=>t(n[e],n[a])))),j(e,r)}return e.sort(n)}var O=Array.prototype.slice;function I(e){return function(){return e}}var C=Math.sqrt(50),M=Math.sqrt(10),T=Math.sqrt(2);function _(e,t,a){var n,r,i,o,s=-1;if(a=+a,(e=+e)==(t=+t)&&a>0)return[e];if((n=t<e)&&(r=e,e=t,t=r),0===(o=N(e,t,a))||!isFinite(o))return[];if(o>0){let a=Math.round(e/o),n=Math.round(t/o);for(a*o<e&&++a,n*o>t&&--n,i=new Array(r=n-a+1);++s<r;)i[s]=(a+s)*o}else{o=-o;let a=Math.round(e*o),n=Math.round(t*o);for(a/o<e&&++a,n/o>t&&--n,i=new Array(r=n-a+1);++s<r;)i[s]=(a+s)/o}return n&&i.reverse(),i}function N(e,t,a){var n=(t-e)/Math.max(0,a),r=Math.floor(Math.log(n)/Math.LN10),i=n/Math.pow(10,r);return r>=0?(i>=C?10:i>=M?5:i>=T?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(i>=C?10:i>=M?5:i>=T?2:1)}function D(e,t,a){let n;for(;;){const r=N(e,t,a);if(r===n||0===r||!isFinite(r))return[e,t];r>0?(e=Math.floor(e/r)*r,t=Math.ceil(t/r)*r):r<0&&(e=Math.ceil(e*r)/r,t=Math.floor(t*r)/r),n=r}}function A(e){return Math.ceil(Math.log(l(e))/Math.LN2)+1}function q(){var e=v,t=y,a=A;function n(n){Array.isArray(n)||(n=Array.from(n));var r,o,s=n.length,l=new Array(s);for(r=0;r<s;++r)l[r]=e(n[r],r,n);var c=t(l),u=c[0],d=c[1],p=a(l,u,d);if(!Array.isArray(p)){const e=d,a=+p;if(t===y&&([u,d]=D(u,d,a)),(p=_(u,d,a))[p.length-1]>=d)if(e>=d&&t===y){const e=N(u,d,a);isFinite(e)&&(e>0?d=(Math.floor(d/e)+1)*e:e<0&&(d=(Math.ceil(d*-e)+1)/-e))}else p.pop()}for(var m=p.length;p[0]<=u;)p.shift(),--m;for(;p[m-1]>d;)p.pop(),--m;var g,f=new Array(m+1);for(r=0;r<=m;++r)(g=f[r]=[]).x0=r>0?p[r-1]:u,g.x1=r<m?p[r]:d;for(r=0;r<s;++r)u<=(o=l[r])&&o<=d&&f[i(p,o,0,m)].push(n[r]);return f}return n.value=function(t){return arguments.length?(e="function"==typeof t?t:I(t),n):e},n.domain=function(e){return arguments.length?(t="function"==typeof e?e:I([e[0],e[1]]),n):t},n.thresholds=function(e){return arguments.length?(a="function"==typeof e?e:Array.isArray(e)?I(O.call(e)):I(e),n):a},n}function F(e,t){let a;if(void 0===t)for(const t of e)null!=t&&(a<t||void 0===a&&t>=t)&&(a=t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(a<r||void 0===a&&r>=r)&&(a=r)}return a}function L(e,t){let a;if(void 0===t)for(const t of e)null!=t&&(a>t||void 0===a&&t>=t)&&(a=t);else{let n=-1;for(let r of e)null!=(r=t(r,++n,e))&&(a>r||void 0===a&&r>=r)&&(a=r)}return a}function R(e,a,n=0,r=e.length-1,i=t){for(;r>n;){if(r-n>600){const t=r-n+1,o=a-n+1,s=Math.log(t),l=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*l*(t-l)/t)*(o-t/2<0?-1:1);R(e,a,Math.max(n,Math.floor(a-o*l/t+c)),Math.min(r,Math.floor(a+(t-o)*l/t+c)),i)}const t=e[a];let o=n,s=r;for(P(e,n,a),i(e[r],t)>0&&P(e,n,r);o<s;){for(P(e,o,s),++o,--s;i(e[o],t)<0;)++o;for(;i(e[s],t)>0;)--s}0===i(e[n],t)?P(e,n,s):(++s,P(e,s,r)),s<=a&&(n=s+1),a<=s&&(r=s-1)}return e}function P(e,t,a){const n=e[t];e[t]=e[a],e[a]=n}function z(e,t,a){if(n=(e=Float64Array.from(function*(e,t){if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(yield t);else{let a=-1;for(let n of e)null!=(n=t(n,++a,e))&&(n=+n)>=n&&(yield n)}}(e,a))).length){if((t=+t)<=0||n<2)return L(e);if(t>=1)return F(e);var n,r=(n-1)*t,i=Math.floor(r),o=F(R(e,i).subarray(0,i+1));return o+(L(e.subarray(i+1))-o)*(r-i)}}function B(e,t){let a,n=-1,r=-1;if(void 0===t)for(const t of e)++r,null!=t&&(a<t||void 0===a&&t>=t)&&(a=t,n=r);else for(let i of e)null!=(i=t(i,++r,e))&&(a<i||void 0===a&&i>=i)&&(a=i,n=r);return n}function G(e,t){let a,n=-1,r=-1;if(void 0===t)for(const t of e)++r,null!=t&&(a>t||void 0===a&&t>=t)&&(a=t,n=r);else for(let i of e)null!=(i=t(i,++r,e))&&(a>i||void 0===a&&i>=i)&&(a=i,n=r);return n}function $(e,t){return[e,t]}function H(e,a=t){if(1===a.length)return G(e,a);let n,r=-1,i=-1;for(const t of e)++i,(r<0?0===a(t,t):a(t,n)<0)&&(n=t,r=i);return r}var V=U(Math.random);function U(e){return function(t,a=0,n=t.length){let r=n-(a=+a);for(;r;){const n=e()*r--|0,i=t[r+a];t[r+a]=t[n+a],t[n+a]=i}return t}}function W(e){if(!(r=e.length))return[];for(var t=-1,a=L(e,Y),n=new Array(a);++t<a;)for(var r,i=-1,o=n[t]=new Array(r);++i<r;)o[i]=e[i][t];return n}function Y(e){return e.length}function Z(e){return e instanceof Set?e:new Set(e)}function K(e,t){const a=e[Symbol.iterator](),n=new Set;for(const e of t){if(n.has(e))continue;let t,r;for(;({value:t,done:r}=a.next());){if(r)return!1;if(n.add(t),Object.is(e,t))break}}return!0}e.Adder=Adder,e.InternMap=InternMap,e.InternSet=InternSet,e.ascending=t,e.bin=q,e.bisect=i,e.bisectCenter=s,e.bisectLeft=o,e.bisectRight=i,e.bisector=a,e.count=l,e.cross=function(...e){const t="function"==typeof e[e.length-1]&&function(e){return t=>e(...t)}(e.pop()),a=(e=e.map(d)).map(c),n=e.length-1,r=new Array(n+1).fill(0),i=[];if(n<0||a.some(u))return i;for(;;){i.push(r.map(((t,a)=>e[a][t])));let o=n;for(;++r[o]===a[o];){if(0===o)return t?i.map(t):i;r[o--]=0}}},e.cumsum=function(e,t){var a=0,n=0;return Float64Array.from(e,void 0===t?e=>a+=+e||0:r=>a+=+t(r,n++,e)||0)},e.descending=function(e,t){return t<e?-1:t>e?1:t>=e?0:NaN},e.deviation=m,e.difference=function(e,...t){e=new Set(e);for(const a of t)for(const t of a)e.delete(t);return e},e.disjoint=function(e,t){const a=t[Symbol.iterator](),n=new Set;for(const t of e){if(n.has(t))return!1;let e,r;for(;({value:e,done:r}=a.next())&&!r;){if(Object.is(t,e))return!1;n.add(e)}}return!0},e.every=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let a=-1;for(const n of e)if(!t(n,++a,e))return!1;return!0},e.extent=y,e.fcumsum=function(e,t){const a=new Adder;let n=-1;return Float64Array.from(e,void 0===t?e=>a.add(+e||0):r=>a.add(+t(r,++n,e)||0))},e.filter=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");const a=[];let n=-1;for(const r of e)t(r,++n,e)&&a.push(r);return a},e.fsum=function(e,t){const a=new Adder;if(void 0===t)for(let t of e)(t=+t)&&a.add(t);else{let n=-1;for(let r of e)(r=+t(r,++n,e))&&a.add(r)}return+a},e.greatest=function(e,a=t){let n,r=!1;if(1===a.length){let i;for(const o of e){const e=a(o);(r?t(e,i)>0:0===t(e,e))&&(n=o,i=e,r=!0)}}else for(const t of e)(r?a(t,n)>0:0===a(t,t))&&(n=t,r=!0);return n},e.greatestIndex=function(e,a=t){if(1===a.length)return B(e,a);let n,r=-1,i=-1;for(const t of e)++i,(r<0?0===a(t,t):a(t,n)>0)&&(n=t,r=i);return r},e.group=E,e.groupSort=function(e,a,n){return(1===a.length?S(x(e,a,n),(([e,a],[n,r])=>t(a,r)||t(e,n))):S(E(e,n),(([e,n],[r,i])=>a(n,i)||t(e,r)))).map((([e])=>e))},e.groups=function(e,...t){return w(e,Array.from,v,t)},e.histogram=q,e.index=function(e,...t){return w(e,v,k,t)},e.indexes=function(e,...t){return w(e,Array.from,k,t)},e.intersection=function(e,...t){e=new Set(e),t=t.map(Z);e:for(const a of e)for(const n of t)if(!n.has(a)){e.delete(a);continue e}return e},e.least=function(e,a=t){let n,r=!1;if(1===a.length){let i;for(const o of e){const e=a(o);(r?t(e,i)<0:0===t(e,e))&&(n=o,i=e,r=!0)}}else for(const t of e)(r?a(t,n)<0:0===a(t,t))&&(n=t,r=!0);return n},e.leastIndex=H,e.map=function(e,t){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof t)throw new TypeError("mapper is not a function");return Array.from(e,((a,n)=>t(a,n,e)))},e.max=F,e.maxIndex=B,e.mean=function(e,t){let a=0,n=0;if(void 0===t)for(let t of e)null!=t&&(t=+t)>=t&&(++a,n+=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(i=+i)>=i&&(++a,n+=i)}if(a)return n/a},e.median=function(e,t){return z(e,.5,t)},e.merge=function(e){return Array.from(function*(e){for(const t of e)yield*t}(e))},e.min=L,e.minIndex=G,e.nice=D,e.pairs=function(e,t=$){const a=[];let n,r=!1;for(const i of e)r&&a.push(t(n,i)),n=i,r=!0;return a},e.permute=j,e.quantile=z,e.quantileSorted=function(e,t,a=n){if(r=e.length){if((t=+t)<=0||r<2)return+a(e[0],0,e);if(t>=1)return+a(e[r-1],r-1,e);var r,i=(r-1)*t,o=Math.floor(i),s=+a(e[o],o,e);return s+(+a(e[o+1],o+1,e)-s)*(i-o)}},e.quickselect=R,e.range=function(e,t,a){e=+e,t=+t,a=(r=arguments.length)<2?(t=e,e=0,1):r<3?1:+a;for(var n=-1,r=0|Math.max(0,Math.ceil((t-e)/a)),i=new Array(r);++n<r;)i[n]=e+n*a;return i},e.reduce=function(e,t,a){if("function"!=typeof t)throw new TypeError("reducer is not a function");const n=e[Symbol.iterator]();let r,i,o=-1;if(arguments.length<3){if(({done:r,value:a}=n.next()),r)return;++o}for(;({done:r,value:i}=n.next()),!r;)a=t(a,i,++o,e);return a},e.reverse=function(e){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(e).reverse()},e.rollup=x,e.rollups=function(e,t,...a){return w(e,Array.from,t,a)},e.scan=function(e,t){const a=H(e,t);return a<0?void 0:a},e.shuffle=V,e.shuffler=U,e.some=function(e,t){if("function"!=typeof t)throw new TypeError("test is not a function");let a=-1;for(const n of e)if(t(n,++a,e))return!0;return!1},e.sort=S,e.subset=function(e,t){return K(t,e)},e.sum=function(e,t){let a=0;if(void 0===t)for(let t of e)(t=+t)&&(a+=t);else{let n=-1;for(let r of e)(r=+t(r,++n,e))&&(a+=r)}return a},e.superset=K,e.thresholdFreedmanDiaconis=function(e,t,a){return Math.ceil((a-t)/(2*(z(e,.75)-z(e,.25))*Math.pow(l(e),-1/3)))},e.thresholdScott=function(e,t,a){return Math.ceil((a-t)/(3.5*m(e)*Math.pow(l(e),-1/3)))},e.thresholdSturges=A,e.tickIncrement=N,e.tickStep=function(e,t,a){var n=Math.abs(t-e)/Math.max(0,a),r=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),i=n/r;return i>=C?r*=10:i>=M?r*=5:i>=T&&(r*=2),t<e?-r:r},e.ticks=_,e.transpose=W,e.union=function(...e){const t=new Set;for(const a of e)for(const e of a)t.add(e);return t},e.variance=p,e.zip=function(){return W(arguments)},Object.defineProperty(e,"__esModule",{value:!0})}(t)},1498:function(e,t,a){!function(e,t){"use strict";var a=new Date,n=new Date;function r(e,t,i,o){function s(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return s.floor=function(t){return e(t=new Date(+t)),t},s.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},s.round=function(e){var t=s(e),a=s.ceil(e);return e-t<a-e?t:a},s.offset=function(e,a){return t(e=new Date(+e),null==a?1:Math.floor(a)),e},s.range=function(a,n,r){var i,o=[];if(a=s.ceil(a),r=null==r?1:Math.floor(r),!(a<n&&r>0))return o;do{o.push(i=new Date(+a)),t(a,r),e(a)}while(i<a&&a<n);return o},s.filter=function(a){return r((function(t){if(t>=t)for(;e(t),!a(t);)t.setTime(t-1)}),(function(e,n){if(e>=e)if(n<0)for(;++n<=0;)for(;t(e,-1),!a(e););else for(;--n>=0;)for(;t(e,1),!a(e););}))},i&&(s.count=function(t,r){return a.setTime(+t),n.setTime(+r),e(a),e(n),Math.floor(i(a,n))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?s.filter(o?function(t){return o(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var i=r((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?r((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,a){t.setTime(+t+a*e)}),(function(t,a){return(a-t)/e})):i:null};var o=i.range;const s=1e3,l=60*s,c=60*l,u=24*c,d=7*u,p=30*u,m=365*u;var y=r((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getUTCSeconds()})),g=y.range,f=r((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*s)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getMinutes()})),b=f.range,h=r((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*s-e.getMinutes()*l)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getHours()})),v=h.range,E=r((e=>e.setHours(0,0,0,0)),((e,t)=>e.setDate(e.getDate()+t)),((e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/u),(e=>e.getDate()-1)),x=E.range;function k(e){return r((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*l)/d}))}var w=k(0),j=k(1),S=k(2),O=k(3),I=k(4),C=k(5),M=k(6),T=w.range,_=j.range,N=S.range,D=O.range,A=I.range,q=C.range,F=M.range,L=r((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),R=L.range,P=r((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));P.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,a){t.setFullYear(t.getFullYear()+a*e)})):null};var z=P.range,B=r((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCMinutes()})),G=B.range,$=r((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*c)}),(function(e,t){return(t-e)/c}),(function(e){return e.getUTCHours()})),H=$.range,V=r((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/u}),(function(e){return e.getUTCDate()-1})),U=V.range;function W(e){return r((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/d}))}var Y=W(0),Z=W(1),K=W(2),Q=W(3),X=W(4),J=W(5),ee=W(6),te=Y.range,ae=Z.range,ne=K.range,re=Q.range,ie=X.range,oe=J.range,se=ee.range,le=r((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),ce=le.range,ue=r((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));ue.every=function(e){return isFinite(e=Math.floor(e))&&e>0?r((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,a){t.setUTCFullYear(t.getUTCFullYear()+a*e)})):null};var de=ue.range;function pe(e,a,n,r,o,g){const f=[[y,1,s],[y,5,5*s],[y,15,15*s],[y,30,30*s],[g,1,l],[g,5,5*l],[g,15,15*l],[g,30,30*l],[o,1,c],[o,3,3*c],[o,6,6*c],[o,12,12*c],[r,1,u],[r,2,2*u],[n,1,d],[a,1,p],[a,3,3*p],[e,1,m]];function b(a,n,r){const o=Math.abs(n-a)/r,s=t.bisector((([,,e])=>e)).right(f,o);if(s===f.length)return e.every(t.tickStep(a/m,n/m,r));if(0===s)return i.every(Math.max(t.tickStep(a,n,r),1));const[l,c]=f[o/f[s-1][2]<f[s][2]/o?s-1:s];return l.every(c)}return[function(e,t,a){const n=t<e;n&&([e,t]=[t,e]);const r=a&&"function"==typeof a.range?a:b(e,t,a),i=r?r.range(e,+t+1):[];return n?i.reverse():i},b]}const[me,ye]=pe(ue,le,Y,V,$,B),[ge,fe]=pe(P,L,w,E,h,f);e.timeDay=E,e.timeDays=x,e.timeFriday=C,e.timeFridays=q,e.timeHour=h,e.timeHours=v,e.timeInterval=r,e.timeMillisecond=i,e.timeMilliseconds=o,e.timeMinute=f,e.timeMinutes=b,e.timeMonday=j,e.timeMondays=_,e.timeMonth=L,e.timeMonths=R,e.timeSaturday=M,e.timeSaturdays=F,e.timeSecond=y,e.timeSeconds=g,e.timeSunday=w,e.timeSundays=T,e.timeThursday=I,e.timeThursdays=A,e.timeTickInterval=fe,e.timeTicks=ge,e.timeTuesday=S,e.timeTuesdays=N,e.timeWednesday=O,e.timeWednesdays=D,e.timeWeek=w,e.timeWeeks=T,e.timeYear=P,e.timeYears=z,e.utcDay=V,e.utcDays=U,e.utcFriday=J,e.utcFridays=oe,e.utcHour=$,e.utcHours=H,e.utcMillisecond=i,e.utcMilliseconds=o,e.utcMinute=B,e.utcMinutes=G,e.utcMonday=Z,e.utcMondays=ae,e.utcMonth=le,e.utcMonths=ce,e.utcSaturday=ee,e.utcSaturdays=se,e.utcSecond=y,e.utcSeconds=g,e.utcSunday=Y,e.utcSundays=te,e.utcThursday=X,e.utcThursdays=ie,e.utcTickInterval=ye,e.utcTicks=me,e.utcTuesday=K,e.utcTuesdays=ne,e.utcWednesday=Q,e.utcWednesdays=re,e.utcWeek=Y,e.utcWeeks=te,e.utcYear=ue,e.utcYears=de,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(1497))},1499:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return u}));var n=a(17),r=a(45),i=a(2),o=a.n(i),s=a(166);const l="process.name",c="user.name",u=o.a.memo((({contextId:e,eventId:t,isDraggable:a,processName:i,userName:u})=>o.a.createElement(n.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"user-process",direction:"column",justifyContent:"center",gutterSize:"none"},null!=u?Object(r.uniq)(u).map((r=>o.a.createElement(n.EuiFlexItem,{grow:!1,key:r},o.a.createElement(s.c,{contextId:e,"data-test-subj":"user-name",eventId:t,field:c,isDraggable:a,value:r,iconType:"user",isAggregatable:!0,fieldType:"keyword"})))):null,null!=i?Object(r.uniq)(i).map((r=>o.a.createElement(n.EuiFlexItem,{grow:!1,key:r},o.a.createElement(s.c,{contextId:e,eventId:t,field:l,isDraggable:a,value:r,iconType:"console",isAggregatable:!0,fieldType:"keyword"})))):null)));u.displayName="UserProcess"},1500:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),r=a.n(n),i=a(166),o=a(1110),s=a(267);const l=r.a.memo((({contextId:e,eventId:t,hostName:a,workingDirectory:n,isDraggable:l})=>r.a.createElement(r.a.Fragment,null,r.a.createElement(s.c,{grow:!1,component:"span"},r.a.createElement(i.c,{contextId:e,eventId:t,field:"host.name",value:a,isDraggable:l,fieldType:"keyword",isAggregatable:!0})),null!=n&&r.a.createElement(s.c,{grow:!1,component:"span"},o.e),r.a.createElement(s.c,{grow:!1,component:"span"},r.a.createElement(i.c,{contextId:e,eventId:t,field:"process.working_directory",value:n,iconType:"folderOpen",isDraggable:l,fieldType:"keyword",isAggregatable:!0})))));l.displayName="HostWorkingDir"},1501:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(45),r=a(2),i=a.n(r),o=a(44),s=a.n(o),l=a(113),c=a(563),u=a(1435),d=a(1101),p=a(1391),m=a(927),y=a(1436),g=a(1520),f=a(1397),b=a(1499),h=a(878),v=a(1302),E=a(1395),x=a(1328),k=a(1069);const w=s.a.div.withConfig({displayName:"Details",componentId:"sc-1voakd9-0"})(["margin:5px 0;"]);w.displayName="Details";const j={id:l.d.netflow,isInstance:e=>"network_traffic"===`${Object(n.get)("event.category",e)}`.toLowerCase()||(e=>{const t=`${e}`.toLowerCase();return"network_flow"===t||"netflow_flow"===t})(Object(n.get)("event.action",e)),renderRow:({data:e,isDraggable:t,scopeId:a})=>i.a.createElement(k.a,null,i.a.createElement(w,null,i.a.createElement(g.a,{contextId:`netflow-row-renderer-render-row-${a}-${e._id}`,destinationBytes:Object(c.a)(Object(n.get)(x.a,e)),destinationGeoContinentName:Object(c.a)(Object(n.get)(E.b,e)),destinationGeoCountryName:Object(c.a)(Object(n.get)(E.d,e)),destinationGeoCountryIsoCode:Object(c.a)(Object(n.get)(E.c,e)),destinationGeoRegionName:Object(c.a)(Object(n.get)(E.e,e)),destinationGeoCityName:Object(c.a)(Object(n.get)(E.a,e)),destinationIp:Object(c.a)(Object(n.get)(m.a,e)),destinationPackets:Object(c.a)(Object(n.get)(x.b,e)),destinationPort:Object(c.a)(Object(n.get)(h.a,e)),eventDuration:Object(c.a)(Object(n.get)(d.b,e)),eventId:Object(n.get)(p.a,e),eventEnd:Object(c.a)(Object(n.get)(f.b,e)),eventStart:Object(c.a)(Object(n.get)(f.c,e)),isDraggable:t,networkBytes:Object(c.a)(Object(n.get)(v.a,e)),networkCommunityId:Object(c.a)(Object(n.get)(v.b,e)),networkDirection:Object(c.a)(Object(n.get)(v.c,e)),networkPackets:Object(c.a)(Object(n.get)(v.d,e)),networkProtocol:Object(c.a)(Object(n.get)(v.e,e)),processName:Object(c.a)(Object(n.get)(b.a,e)),sourceBytes:Object(c.a)(Object(n.get)(x.c,e)),sourceGeoContinentName:Object(c.a)(Object(n.get)(E.h,e)),sourceGeoCountryName:Object(c.a)(Object(n.get)(E.j,e)),sourceGeoCountryIsoCode:Object(c.a)(Object(n.get)(E.i,e)),sourceGeoRegionName:Object(c.a)(Object(n.get)(E.k,e)),sourceGeoCityName:Object(c.a)(Object(n.get)(E.g,e)),sourceIp:Object(c.a)(Object(n.get)(m.d,e)),sourcePackets:Object(c.a)(Object(n.get)(x.d,e)),sourcePort:Object(c.a)(Object(n.get)(h.c,e)),tlsClientCertificateFingerprintSha1:Object(c.a)(Object(n.get)(u.b,e)),tlsFingerprintsJa3Hash:Object(c.a)(Object(n.get)(y.a,e)),tlsServerCertificateFingerprintSha1:Object(c.a)(Object(n.get)(u.c,e)),transport:Object(c.a)(Object(n.get)(v.f,e)),userName:Object(c.a)(Object(n.get)(b.b,e))})))}},1502:function(e,t,a){"use strict";a.d(t,"g",(function(){return M})),a.d(t,"d",(function(){return T})),a.d(t,"m",(function(){return _})),a.d(t,"p",(function(){return N})),a.d(t,"e",(function(){return D})),a.d(t,"l",(function(){return A})),a.d(t,"k",(function(){return L})),a.d(t,"i",(function(){return R})),a.d(t,"q",(function(){return z})),a.d(t,"f",(function(){return B})),a.d(t,"j",(function(){return G})),a.d(t,"o",(function(){return $})),a.d(t,"n",(function(){return H})),a.d(t,"h",(function(){return U})),a.d(t,"a",(function(){return W})),a.d(t,"c",(function(){return Y})),a.d(t,"b",(function(){return Z}));var n=a(44),r=a.n(n),i=a(17),o=a(142),s=a(328),l=a(45),c=a(2),u=a.n(c),d=a(1279),p=a(79),m=a(247),y=a(1112),g=a(143),f=a(1503),b=a(1504),h=a(1113),v=a(567),E=a(307),x=a(126),k=a(1306),w=a(1307),j=a(1138);const S=r()(i.EuiFlexItem).withConfig({displayName:"NoteDescriptionContainer",componentId:"sc-1i3nngy-0"})(["height:105px;overflow-y:hidden;"]),O=e=>!Object(l.isEmpty)(e.join("")),I=r()(i.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-1i3nngy-1"})([".euiBadge__text{white-space:pre-wrap !important;}"]),C=r.a.div.withConfig({displayName:"Query",componentId:"sc-1i3nngy-2"})(["white-space:pre-wrap;"]),M=({field:e,filters:t,filterManager:a,query:n,savedId:r,savedQueryName:o,indexPatterns:s,queryLabel:c})=>{let d=[];const m=!Object(l.isEmpty)(r)&&!Object(l.isEmpty)(o);return m&&(d=[...d,{title:u.a.createElement(u.a.Fragment,null,h.t," "),description:u.a.createElement(u.a.Fragment,null,o," ")}]),Object(l.isEmpty)(t)||(a.setFilters(t),d=[...d,{title:u.a.createElement(u.a.Fragment,null,m?h.r:h.m," "),description:u.a.createElement(i.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},a.getFilters().map(((t,a)=>u.a.createElement(K,{grow:!1,key:`${e}-filter-${a}`},u.a.createElement(I,{color:"hollow"},null!=s?u.a.createElement(p.FilterBadgeGroup,{filters:[t],dataViews:[s]}):u.a.createElement(i.EuiLoadingSpinner,{size:"m"}))))))}]),Object(l.isEmpty)(n)||(d=[...d,{title:u.a.createElement(u.a.Fragment,null,m?h.s:null!=c?c:h.p),description:u.a.createElement(C,null,n)}]),d},T=e=>{let t=[];return Object(l.isEmpty)(e.eventCategoryField)||(t=[...t,{title:u.a.createElement(u.a.Fragment,null,h.f),description:u.a.createElement(u.a.Fragment,null,e.eventCategoryField)}]),Object(l.isEmpty)(e.tiebreakerField)||(t=[...t,{title:u.a.createElement(u.a.Fragment,null,h.h),description:u.a.createElement(u.a.Fragment,null,e.tiebreakerField)}]),Object(l.isEmpty)(e.timestampField)||(t=[...t,{title:u.a.createElement(u.a.Fragment,null,h.i),description:u.a.createElement(u.a.Fragment,null,e.timestampField)}]),t},_=({threat:e,label:t})=>e.length>0?[{title:t,description:u.a.createElement(k.a,{threat:e})}]:[],N=(e,t,a)=>O(a)?[{title:e,description:u.a.createElement(i.EuiText,{size:"s"},u.a.createElement("ul",null,a.map((e=>Object(l.isEmpty)(e)?null:u.a.createElement("li",{"data-test-subj":"unorderedListArrayDescriptionItem",key:`${t}-${e}`},e)))))}]:[],D=(e,t)=>{if(Object(l.isEmpty)(t))return[];const a=u.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},t.map((t=>Object(l.isEmpty)(t)?null:u.a.createElement(i.EuiFlexItem,{grow:!1,key:`${e}-${t}`},u.a.createElement(I,{"data-test-subj":"customHighlightedFieldsStringArrayDescriptionBadgeItem",color:"hollow"},t)))));return[{title:e,description:a}]},A=(e,t,a)=>O(a)?[{title:e,description:u.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},a.map((e=>Object(l.isEmpty)(e)?null:u.a.createElement(i.EuiFlexItem,{grow:!1,key:`${t}-${e}`},u.a.createElement(I,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},e)))))}]:[],q=r()(i.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-1i3nngy-3"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),F=r()(i.EuiFlexItem).withConfig({displayName:"OverrideValueColumn",componentId:"sc-1i3nngy-4"})(["width:30px;max-width:30px;overflow:hidden;text-overflow:ellipsis;"]),L=e=>[{title:f.a,description:u.a.createElement(v.a,{value:e.value})},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?f.d:"",description:u.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},u.a.createElement(q,null,u.a.createElement(i.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField${t}`},u.a.createElement(u.a.Fragment,null,`${e.field}:`))),u.a.createElement(F,null,u.a.createElement(i.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue${t}`},Object(x.a)(e.value))),u.a.createElement(i.EuiFlexItem,{grow:!1},u.a.createElement(i.EuiIcon,{type:"sortRight"})),u.a.createElement(i.EuiFlexItem,null,u.a.createElement(v.a,{"data-test-subj":`severityOverrideSeverity${t}`,value:e.severity})))}))):[]],R=e=>[{title:b.b,description:e.value},...e.isMappingChecked?e.mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?b.e:"",description:u.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},u.a.createElement(q,null,u.a.createElement(i.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField${t}`},u.a.createElement(u.a.Fragment,null,e.field))),u.a.createElement(i.EuiFlexItem,{grow:!1},u.a.createElement(i.EuiIcon,{type:"sortRight"})),u.a.createElement(i.EuiFlexItem,null,o.t))}))):[]],P=r()(i.EuiLink).withConfig({displayName:"MyRefUrlLink",componentId:"sc-1i3nngy-5"})(["word-break:break-word;"]),z=(e,t)=>O(t)?[{title:e,description:u.a.createElement(i.EuiText,{size:"s"},u.a.createElement("ul",null,t.filter((e=>!Object(l.isEmpty)(e))).map(((e,t)=>u.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},u.a.createElement(P,{href:e,external:!0,target:"_blank"},e))))))}]:[],B=(e,t)=>""!==t.trim()?[{title:e,description:u.a.createElement(S,null,u.a.createElement("div",{"data-test-subj":"noteDescriptionItem",className:"eui-yScrollWithShadows"},t))}]:[],G=(e,t)=>{switch(t){case"machine_learning":return[{title:e,description:h.n}];case"query":case"saved_query":return[{title:e,description:h.q}];case"threshold":return[{title:e,description:h.y}];case"eql":return[{title:e,description:h.j}];case"threat_match":return[{title:e,description:h.u}];case"new_terms":return[{title:e,description:h.o}];case"esql":return[{title:e,description:u.a.createElement(j.a,{label:h.l})}];default:return Object(g.a)(t)}},$=(e,t)=>[{title:e,description:u.a.createElement(u.a.Fragment,null,Object(l.isEmpty)(t.field[0])?`${h.x} >= ${t.value}`:`${h.w} ${Array.isArray(t.field)?t.field.join(","):t.field} >= ${t.value}`)}],H=(e,t)=>[{title:e,description:t.reduce(((e,t,a,{length:n})=>{const r=t.entries.reduce(((e,t,a,{length:n})=>1===n?`${t.field} ${y.d} ${t.value}`:0===a?`(${t.field} ${y.d} ${t.value})`:`${e} ${y.a} (${t.field} ${y.d} ${t.value})`),"");return 1===n?`${r}`:0===a?`(${r})`:`${e} ${y.e} (${r})`}),"")}],V=r()(i.EuiText).withConfig({displayName:"FieldTypeText",componentId:"sc-1i3nngy-6"})(["font-size:",";font-family:",";display:inline;"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily)),U=(e,t)=>Object(l.isEmpty)(t)?[]:[{title:e,description:u.a.createElement(i.EuiFlexGrid,{gutterSize:"s"},t.map(((e,a)=>u.a.createElement(i.EuiFlexItem,{grow:!1},u.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},u.a.createElement(i.EuiFlexItem,{grow:!1},u.a.createElement(d.a,{"data-test-subj":"field-type-icon",type:Object(s.c)(e.type),label:e.type})),u.a.createElement(i.EuiFlexItem,{grow:!1},u.a.createElement(V,{grow:!1,size:"s"},` ${e.name}${a+1!==t.length?", ":""}`)))))))}],W=(e,t)=>{if(Object(l.isEmpty)(t))return[];const a=u.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0},t.map((t=>Object(l.isEmpty)(t)?null:u.a.createElement(i.EuiFlexItem,{grow:!1,key:`${e}-${t}`},u.a.createElement(I,{"data-test-subj":"stringArrayDescriptionBadgeItem",color:"hollow"},t)))));return[{title:u.a.createElement(w.a,{label:e}),description:a}]},Y=(e,t,a)=>{const n=a===E.b.PerTimePeriod?`${t.value}${t.unit}`:h.b;return[{title:u.a.createElement(w.a,{label:e}),description:n}]},Z=(e,t)=>{if(Object(l.isEmpty)(t))return[];const a=t===m.a.suppress?h.c:h.a;return[{title:u.a.createElement(w.a,{label:e}),description:a}]};var K=r()(i.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-1i3nngy-7"})({width:"100%"})},1503:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"g",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"f",(function(){return d}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityTitle",{defaultMessage:"Default severity"}),i=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultSeverityTitle",{defaultMessage:"Severity"}),o=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceFieldTitle",{defaultMessage:"Source field"}),s=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.sourceValueTitle",{defaultMessage:"Source value"}),l=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.severityMappingTitle",{defaultMessage:"Severity override"}),c=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.defaultDescriptionLabel",{defaultMessage:"Select a severity level for all alerts generated by this rule."}),u=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDescriptionLabel",{defaultMessage:"Use source event values to override the default severity."}),d=n.i18n.translate("xpack.securitySolution.alerts.severityMapping.mappingDetailsLabel",{defaultMessage:"For multiple matches the highest severity match will apply. If no match is found, the default severity will be used."})},1504:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"f",(function(){return u})),a.d(t,"g",(function(){return d}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreTitle",{defaultMessage:"Risk score"}),i=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultRiskScoreTitle",{defaultMessage:"Default risk score"}),o=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreFieldTitle",{defaultMessage:"kibana.alert.risk_score"}),s=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.sourceFieldTitle",{defaultMessage:"Source field"}),l=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.riskScoreMappingTitle",{defaultMessage:"Risk score override"}),c=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.defaultDescriptionLabel",{defaultMessage:"Select a risk score for all alerts generated by this rule."}),u=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDescriptionLabel",{defaultMessage:"Use a source event value to override the default risk score."}),d=n.i18n.translate("xpack.securitySolution.alerts.riskScoreMapping.mappingDetailsLabel",{defaultMessage:"If value is out of bounds, or field is not present, the default risk score will be used."})},1505:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var n=a(2),r=a(1388);const i=["kibana.alert.workflow_assignee_ids","kibana.alert.workflow_user"],o=({alerts:e,columns:t})=>{const a=new Set;e.forEach((e=>{i.forEach((n=>{if(null!=t.find((e=>e.id===n))){const t=e[n];null==t||t.forEach((e=>a.add(e)))}}))}));const o=Object(r.a)({uids:a});return Object(n.useMemo)((()=>({profiles:o.data,isLoading:o.isLoading})),[o.data,o.isLoading])}},1506:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(9),r=a(2),i=a(4),o=a(117),s=a(311),l=a(553);const c=({alertId:e})=>{const[t,a]=Object(r.useState)(!1),[c,u]=Object(r.useState)([]),{addError:d}=Object(o.a)();return Object(r.useEffect)((()=>{let t=!0;return a(!0),Object(n.isEmpty)(e)||(async()=>{try{const a=await Object(s.f)({alertId:e,owner:[i.i]});t&&u(a)}catch(e){d(e.message,{title:l.a})}t&&a(!1)})(),()=>{t=!1}}),[e,d]),{loading:t,casesInfo:c}}},1507:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return s}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersTitle",{defaultMessage:"Additional filters"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showBuildingBlockTitle",{defaultMessage:"Include building block alerts"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.additionalFiltersActions.showOnlyThreatIndicatorAlerts",{defaultMessage:"Show only threat indicator alerts"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.alerts.utilityBar.takeActionTitle",{defaultMessage:"Take action"})},1508:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i}));var n=a(2);const r=a.n(n).a.createContext(null),i=()=>{var e;return null===(e=Object(n.useContext)(r))||void 0===e?void 0:e.current}},1520:function(e,t,a){"use strict";a.d(t,"a",(function(){return U}));var n=a(17),r=a(2),i=a.n(r),o=a(45),s=a(1435),l=a(1436);const c=i.a.memo((({contextId:e,eventId:t,isDraggable:a,tlsClientCertificateFingerprintSha1:r,tlsFingerprintsJa3Hash:c,tlsServerCertificateFingerprintSha1:u})=>i.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":"fingerprints-group",direction:"column",justifyContent:"center",gutterSize:"none"},null!=c?Object(o.uniq)(c).map((r=>i.a.createElement(n.EuiFlexItem,{grow:!1,key:r},i.a.createElement(l.b,{eventId:t,fieldName:l.a,contextId:e,isDraggable:a,value:r})))):null,null!=r?Object(o.uniq)(r).map((r=>i.a.createElement(n.EuiFlexItem,{grow:!1,key:r},i.a.createElement(s.a,{eventId:t,certificateType:"client",contextId:e,fieldName:s.b,isDraggable:a,value:r})))):null,null!=u?Object(o.uniq)(u).map((r=>i.a.createElement(n.EuiFlexItem,{grow:!1,key:r},i.a.createElement(s.a,{eventId:t,certificateType:"server",contextId:e,fieldName:s.c,isDraggable:a,value:r})))):null)));c.displayName="Fingerprints";var u=a(44),d=a.n(u),p=a(125),m=a(166),y=a(1302);const g="questionInCircle",f=e=>{if(null==e)return g;switch(`${e}`.toLowerCase()){case p.m.outbound:case p.m.outgoing:return"arrowUp";case p.m.inbound:case p.m.incoming:case p.m.listening:return"arrowDown";case p.m.external:return"globe";case p.m.internal:return"bullseye";case p.m.unknown:default:return g}},b=i.a.memo((({contextId:e,eventId:t,direction:a,isDraggable:n})=>i.a.createElement(m.c,{contextId:e,eventId:t,field:y.c,iconType:f(a),isDraggable:n,value:a,isAggregatable:!0,fieldType:"keyword"})));b.displayName="DirectionBadge";var h=a(1496),v=a(1100);const E=d()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-10udnrm-0"})(["margin-right:3px;"]);E.displayName="EuiFlexItemMarginRight";const x=d()(n.EuiText).withConfig({displayName:"Stats",componentId:"sc-10udnrm-1"})(["margin:0 5px;"]);x.displayName="Stats";const k=i.a.memo((({bytes:e,communityId:t,contextId:a,direction:r,eventId:s,isDraggable:l,packets:c,protocol:u,transport:d})=>i.a.createElement(n.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none"},null!=r?Object(o.uniq)(r).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(b,{contextId:a,direction:e,eventId:s,isDraggable:l})))):null,null!=u?Object(o.uniq)(u).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.c,{contextId:a,eventId:s,field:y.e,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=e?Object(o.uniq)(e).map((e=>isNaN(Number(e))?null:i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.b,{field:y.a,id:`network-default-draggable-${a}-${s}-${y.a}-${e}`,isDraggable:l,value:e},i.a.createElement(x,{size:"xs"},i.a.createElement("span",null,i.a.createElement(v.a,{value:e}))))))):null,null!=c?Object(o.uniq)(c).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.b,{field:y.d,id:`network-default-draggable-${a}-${s}-${y.d}-${e}`,isDraggable:l,value:e},i.a.createElement(x,{size:"xs"},i.a.createElement("span",null,`${e} ${h.a}`)))))):null,null!=d?Object(o.uniq)(d).map((e=>i.a.createElement(E,{grow:!1,key:e},i.a.createElement(m.c,{contextId:a,"data-test-subj":"network-transport",eventId:s,field:y.f,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null,null!=t?Object(o.uniq)(t).map((e=>i.a.createElement(n.EuiFlexItem,{grow:!1,key:e},i.a.createElement(m.c,{contextId:a,eventId:s,field:y.b,isDraggable:l,value:e,isAggregatable:!0,fieldType:"keyword"})))):null)));k.displayName="Network";var w=a(1328),j=a(136),S=a.n(j),O=a(927),I=a(1392),C=a(878),M=a(1110),T=a(1395);const _=d.a.span.withConfig({displayName:"IpPortSeparator",componentId:"sc-12b0nt-0"})(["margin:0 3px;"]);_.displayName="IpPortSeparator";const N=i.a.memo((({contextId:e,eventId:t,isDraggable:a,port:r,portFieldName:o})=>null!=r?i.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(_,{"data-test-subj":"ip-port-separator"},":")),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(I.a,{contextId:e,"data-test-subj":"port",eventId:t,fieldName:o,isDraggable:a,value:r}))):null));N.displayName="PortWithSeparator";const D=i.a.memo((({contextId:e,eventId:t,ip:a,ipFieldName:r,isDraggable:o,port:s,portFieldName:l})=>i.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(O.c,{contextId:e,"data-test-subj":"ip",eventId:t,fieldName:r,isDraggable:o,value:a})),i.a.createElement(n.EuiFlexItem,null,i.a.createElement(N,{contextId:e,eventId:t,isDraggable:o,port:s,portFieldName:l})))));D.displayName="IpWithPort";const A=d.a.div.withConfig({displayName:"Label",componentId:"sc-1ym4dlz-0"})(["font-weight:bold;margin-top:2px;"]),q=({destinationIp:e,sourceIp:t,type:a})=>"source"===a&&null!=t&&t.some((e=>!Object(o.isEmpty)(e)))||"destination"===a&&null!=e&&e.some((e=>!Object(o.isEmpty)(e))),F=({destinationPort:e,sourcePort:t,type:a})=>("source"===a&&null!=t?t:"destination"===a&&null!=e?e:[]).filter((e=>null!=e)).map((e=>`${e}`)).filter((e=>!Object(o.isEmpty)(e))),L=i.a.memo((({contextId:e,destinationIp:t,destinationPort:a,eventId:r,isDraggable:s,sourceIp:l,sourcePort:c,type:u})=>{const d="source"===u?l:t,p="source"===u?O.d:O.a,m="source"===u?c:a,y="source"===u?C.c:C.a;if(null==d)return null;const g=null!=m&&d.length===m.length?d.map(((e,t)=>({ip:e,port:null!=m[t]?`${m[t]}`:null}))):d.map((e=>({ip:e,port:null})));return i.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},Object(o.uniqWith)(S.a,g).map((t=>null!=t.ip&&i.a.createElement(n.EuiFlexItem,{grow:!1,key:t.ip},i.a.createElement(D,{contextId:e,"data-test-subj":`${u}-ip-and-port`,eventId:r,ip:t.ip,ipFieldName:p,isDraggable:s,port:t.port,portFieldName:y})))))}));L.displayName="IpAdressesWithPorts";const R=i.a.memo((({contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:a,destinationGeoCountryIsoCode:r,destinationGeoRegionName:o,destinationGeoCityName:s,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:y,sourceGeoRegionName:g,sourceGeoCityName:f,sourceIp:b,sourcePort:h,type:v})=>{const E="source"===v?M.i:M.c;return q({destinationIp:l,sourceIp:b,type:v})||(({destinationPort:e,sourcePort:t,type:a})=>F({destinationPort:e,sourcePort:t,type:a}).length>0)({destinationPort:c,sourcePort:h,type:v})?i.a.createElement(n.EuiBadge,{"data-test-subj":`${v}-ip-badge`,color:"hollow",title:""},i.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":`${v}-ip-group`,direction:"column",gutterSize:"xs"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(A,null,E)),i.a.createElement(n.EuiFlexItem,{grow:!1},q({destinationIp:l,sourceIp:b,type:v})?i.a.createElement(L,{contextId:e,destinationIp:l,destinationPort:c,eventId:u,isDraggable:d,sourceIp:b,sourcePort:h,type:v}):i.a.createElement(n.EuiFlexGroup,{gutterSize:"none"},F({destinationPort:c,sourcePort:h,type:v}).map(((t,a)=>i.a.createElement(n.EuiFlexItem,{key:`port-${t}-${a}`,grow:!1},i.a.createElement(I.a,{contextId:e,"data-test-subj":"port",eventId:u,fieldName:`${v}.port`,isDraggable:d,value:t})))))),i.a.createElement(n.EuiFlexItem,null,i.a.createElement(T.f,{contextId:e,destinationGeoContinentName:t,destinationGeoCountryName:a,destinationGeoCountryIsoCode:r,destinationGeoRegionName:o,destinationGeoCityName:s,eventId:u,isDraggable:d,sourceGeoContinentName:p,sourceGeoCountryName:m,sourceGeoCountryIsoCode:y,sourceGeoRegionName:g,sourceGeoCityName:f,type:v})))):null}));R.displayName="SourceDestinationIp";const P=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:y,sourceGeoContinentName:g,sourceGeoCountryName:f,sourceGeoCountryIsoCode:b,sourceGeoRegionName:h,sourceGeoCityName:v,sourcePackets:E,sourceIp:x,sourcePort:k})=>i.a.createElement(n.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(R,{contextId:e,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:g,sourceGeoCountryName:f,sourceGeoCountryIsoCode:b,sourceGeoRegionName:h,sourceGeoCityName:v,sourceIp:x,sourcePort:k,type:"source"})),i.a.createElement(w.e,{contextId:e,destinationBytes:t,destinationPackets:u,eventId:p,isDraggable:m,sourceBytes:y,sourcePackets:E}),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(R,{contextId:e,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPort:d,eventId:p,isDraggable:m,sourceGeoContinentName:g,sourceGeoCountryName:f,sourceGeoCountryIsoCode:b,sourceGeoRegionName:h,sourceGeoCityName:v,sourceIp:x,sourcePort:k,type:"destination"})))));P.displayName="SourceDestinationWithArrows";const z=d()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginTop",componentId:"sc-ru6rd-0"})(["margin-top:3px;"]);z.displayName="EuiFlexItemMarginTop";const B=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,networkBytes:y,networkCommunityId:g,networkDirection:f,networkPackets:b,networkProtocol:h,sourceBytes:v,sourceGeoContinentName:E,sourceGeoCountryName:x,sourceGeoCountryIsoCode:w,sourceGeoRegionName:j,sourceGeoCityName:S,sourceIp:O,sourcePackets:I,sourcePort:C,transport:M})=>i.a.createElement(n.EuiFlexGroup,{alignItems:"center",direction:"column",justifyContent:"center",gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(k,{bytes:y,packets:b,communityId:g,contextId:e,direction:f,eventId:p,isDraggable:m,protocol:h,transport:M})),i.a.createElement(z,{grow:!1},i.a.createElement(P,{contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:p,isDraggable:m,sourceBytes:v,sourceGeoContinentName:E,sourceGeoCountryName:x,sourceGeoCountryIsoCode:w,sourceGeoRegionName:j,sourceGeoCityName:S,sourceIp:O,sourcePackets:I,sourcePort:C})))));B.displayName="SourceDestination";var G=a(1397),$=a(1499);const H=d()(n.EuiFlexItem).withConfig({displayName:"EuiFlexItemMarginRight",componentId:"sc-ub9rva-0"})(["margin-right:10px;"]);H.displayName="EuiFlexItemMarginRight";const V=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventDuration:p,eventId:m,eventEnd:y,eventStart:g,isDraggable:f,networkBytes:b,networkCommunityId:h,networkDirection:v,networkPackets:E,networkProtocol:x,processName:k,sourceBytes:w,sourceGeoContinentName:j,sourceGeoCountryName:S,sourceGeoCountryIsoCode:O,sourceGeoRegionName:I,sourceGeoCityName:C,sourceIp:M,sourcePackets:T,sourcePort:_,transport:N,userName:D})=>i.a.createElement(n.EuiFlexGroup,{"data-test-subj":"netflow-columns",gutterSize:"none",justifyContent:"center",wrap:!0},i.a.createElement(H,{grow:!1},i.a.createElement($.c,{contextId:e,eventId:m,isDraggable:f,processName:k,userName:D})),i.a.createElement(H,{grow:!1},i.a.createElement(G.a,{contextId:e,eventDuration:p,eventId:m,eventEnd:y,eventStart:g,isDraggable:f})),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(B,{contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:c,destinationPackets:u,destinationPort:d,eventId:m,isDraggable:f,networkBytes:b,networkCommunityId:h,networkDirection:v,networkPackets:E,networkProtocol:x,sourceBytes:w,sourceGeoContinentName:j,sourceGeoCountryName:S,sourceGeoCountryIsoCode:O,sourceGeoRegionName:I,sourceGeoCityName:C,sourceIp:M,sourcePackets:T,sourcePort:_,transport:N})))));V.displayName="NetflowColumns";const U=i.a.memo((({contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:y,eventEnd:g,eventStart:f,isDraggable:b,networkBytes:h,networkCommunityId:v,networkDirection:E,networkPackets:x,networkProtocol:k,processName:w,sourceBytes:j,sourceGeoContinentName:S,sourceGeoCountryName:O,sourceGeoCountryIsoCode:I,sourceGeoRegionName:C,sourceGeoCityName:M,sourcePackets:T,sourceIp:_,sourcePort:N,tlsClientCertificateFingerprintSha1:D,tlsFingerprintsJa3Hash:A,tlsServerCertificateFingerprintSha1:q,transport:F,userName:L})=>i.a.createElement(n.EuiFlexGroup,{alignItems:"center","data-test-subj":"netflow-rows",direction:"column",justifyContent:"center",wrap:!0,gutterSize:"none"},i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(V,{contextId:e,destinationBytes:t,destinationGeoContinentName:a,destinationGeoCountryName:r,destinationGeoCountryIsoCode:o,destinationGeoRegionName:s,destinationGeoCityName:l,destinationIp:u,destinationPackets:d,destinationPort:p,eventDuration:m,eventId:y,eventEnd:g,eventStart:f,isDraggable:b,networkBytes:h,networkCommunityId:v,networkDirection:E,networkPackets:x,networkProtocol:k,processName:w,sourceBytes:j,sourceGeoContinentName:S,sourceGeoCountryName:O,sourceGeoCountryIsoCode:I,sourceGeoRegionName:C,sourceGeoCityName:M,sourceIp:_,sourcePackets:T,sourcePort:N,transport:F,userName:L})),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(c,{contextId:e,eventId:y,isDraggable:b,tlsClientCertificateFingerprintSha1:D,tlsFingerprintsJa3Hash:A,tlsServerCertificateFingerprintSha1:q})))));U.displayName="Netflow"},1522:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(17),r=a(2),i=a.n(r),o=a(262),s=a(142),l=a(4),c=a(110),u=a(925),d=a(9);const p=(e,t)=>e.checked?t.checked&&e.checked<=t.checked?1:-1:t.checked?1:0,m=(e,t)=>{const a=Object(d.intersection)(...e),n=Object(d.union)(...e);return Object(d.union)(n,t).map((e=>{let t={checked:void 0,"data-test-subj":"unselected-alert-tag"};return a.includes(e)?t={checked:"on","data-test-subj":"selected-alert-tag"}:n.includes(e)&&(t={checked:"mixed","data-test-subj":"mixed-alert-tag"}),{label:e,...t}})).sort(p)},y={selectableAlertTags:[],tagsToAdd:new Set,tagsToRemove:new Set},g=({alertItems:e,refresh:t,refetchQuery:a,setIsLoading:o,clearSelection:d,closePopoverMenu:p,onSubmit:g})=>{const[f]=Object(c.o)(l.x),b=Object(r.useMemo)((()=>e.map((e=>{var t,a;return null!==(t=null===(a=e.data.find((e=>e.field===s.qb)))||void 0===a?void 0:a.value)&&void 0!==t?t:[]}))),[e]),[{selectableAlertTags:h,tagsToAdd:v,tagsToRemove:E},x]=Object(r.useReducer)(((e,t)=>{switch(t.type){case"addAlertTag":{const{value:a}=t;return e.tagsToAdd.add(a),e.tagsToRemove.delete(a),e}case"removeAlertTag":{const{value:a}=t;return e.tagsToRemove.add(a),e.tagsToAdd.delete(a),e}case"setSelectableAlertTags":{const{value:a}=t;return{...e,selectableAlertTags:a}}default:return e}}),{...y,selectableAlertTags:m(b,f),tagsToAdd:new Set,tagsToRemove:new Set}),k=Object(r.useCallback)((e=>{x({type:"addAlertTag",value:e})}),[x]),w=Object(r.useCallback)((e=>{x({type:"removeAlertTag",value:e})}),[x]),j=Object(r.useCallback)((e=>{x({type:"setSelectableAlertTags",value:e})}),[x]),S=Object(r.useCallback)((async()=>{if(0===v.size&&0===E.size)return void p();const n=Array.from(v),r=Array.from(E),i=e.map((e=>e._id)),s={tags_to_add:n,tags_to_remove:r};null!=g&&(p(),await g(s,i,(()=>{a&&a(),t&&t(),d&&d()}),o))}),[p,v,E,e,a,t,d,o,g]),O=Object(r.useCallback)(((e,t,a)=>{"on"===a.checked?k(a.label):a.checked||w(a.label),j(e)}),[k,w,j]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(n.EuiSelectable,{searchable:!0,searchProps:{placeholder:u.i},"aria-label":u.i,options:h,onChange:O,emptyMessage:u.g,noMatchesMessage:u.h,"data-test-subj":"alert-tags-selectable-menu"},((e,t)=>i.a.createElement("div",null,i.a.createElement(n.EuiPopoverTitle,null,t),e))),i.a.createElement(n.EuiButton,{"data-test-subj":"alert-tags-update-button",fullWidth:!0,size:"s",onClick:S},u.d))},f=Object(r.memo)(g);var b=a(63),h=a(117);const v=({refetch:e})=>{const{hasIndexWrite:t}=Object(o.a)(),a=(()=>{const{http:e}=Object(b.useKibana)().services,{addSuccess:t,addError:a}=Object(h.a)(),n=Object(r.useRef)(null),i=Object(r.useCallback)(((e=0)=>t(u.A(e))),[t]),o=Object(r.useCallback)((e=>{a(e.message,{title:u.z})}),[a]);return Object(r.useEffect)((()=>{let e=!1;const t=new AbortController;return n.current=async(a,n,r,s)=>{try{s(!0);const o=await(async({tags:e,ids:t,signal:a})=>c.b.get().http.fetch(l.db,{method:"POST",version:"2023-10-31",body:JSON.stringify({tags:e,ids:t}),signal:a}))({tags:a,ids:n,signal:t.signal});e||(r(),s(!1),i(o.updated))}catch(t){e||(s(!1),o(t))}},()=>{e=!0,t.abort()}}),[e,o,i]),n.current})(),s=Object(r.useCallback)((async(e,t,n,r)=>{a&&await a(e,t,n,r)}),[a]),d=Object(r.useMemo)((()=>t?[{key:"manage-alert-tags","data-test-subj":"alert-tags-context-menu-item",name:u.e,panel:1,label:u.e,disableOnQuery:!0}]:[]),[t]),p=Object(r.useMemo)((()=>i.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},i.a.createElement(n.EuiFlexItem,{grow:!1},u.e),i.a.createElement(n.EuiFlexItem,{grow:!1},i.a.createElement(n.EuiIconTip,{content:u.f,position:"right"})))),[]),m=Object(r.useCallback)((({alertItems:t,refresh:a,setIsBulkActionsLoading:n,clearSelection:r,closePopoverMenu:o})=>i.a.createElement(f,{alertItems:t,refresh:a,refetchQuery:e,setIsLoading:n,clearSelection:r,closePopoverMenu:o,onSubmit:s})),[s,e]);return{alertTagsItems:d,alertTagsPanels:Object(r.useMemo)((()=>t?[{id:1,title:p,"data-test-subj":"alert-tags-context-menu-panel",renderContent:m}]:[]),[p,t,m])}}},1523:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(113),r=a(9),i=a(44),o=a.n(i),s=a(4),l=a(272);const c=o.a.div.withConfig({displayName:"HorizontalSpacer",componentId:"sc-1o769t7-0"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeXS));var u=a(17),d=a(2),p=a.n(d),m=a(1391),y=a(1069),g=a(45),f=a(47),b=a(166);const h=({contextId:e,eventId:t,isDraggable:a,sourceField:n,sourceValue:r})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-details-source-field",eventId:t,field:l.g,isDraggable:a,value:n,isAggregatable:!0,fieldType:"keyword"})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,p.a.createElement(f.FormattedMessage,{defaultMessage:"matched",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.matchedVerb"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-details-source-value",eventId:t,field:n,isDraggable:a,value:r,isAggregatable:!0,fieldType:"keyword"})));var v=a(1080);const E=({contextId:e,eventId:t,feedName:a,indicatorReference:n,indicatorType:r,isDraggable:i})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"threat-match-indicator-details",direction:"row",justifyContent:"center",gutterSize:"none",wrap:!0},r&&p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-type",eventId:t,field:l.h,isDraggable:i,value:r,isAggregatable:!0,fieldType:"keyword"})),a&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1,component:"span"},p.a.createElement(c,null,p.a.createElement(f.FormattedMessage,{defaultMessage:"provided by",id:"xpack.securitySolution.alerts.rowRenderers.cti.threatMatch.providerPreposition"}))),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(b.c,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-feedName",eventId:t,field:l.e,isDraggable:i,value:a,isAggregatable:!0,fieldType:"keyword"}))),n&&p.a.createElement(p.a.Fragment,null,p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(c,null,":")),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(v.a,{contextId:e,"data-test-subj":"threat-match-indicator-details-indicator-reference",eventId:t,fieldName:l.j,isDraggable:i,value:n,isAggregatable:!0,fieldType:"keyword"})))),x=({contextId:e,data:t,eventId:a,isDraggable:n})=>{const r={contextId:e,eventId:a,indicatorReference:Object(g.getOr)([],l.p,t)[0],feedName:Object(g.getOr)([],l.e,t)[0],indicatorType:Object(g.getOr)([],l.n,t)[0],isDraggable:n,sourceField:Object(g.get)(l.l,t)[0],sourceValue:Object(g.get)(l.k,t)[0]};return p.a.createElement(k,r)},k=({contextId:e,eventId:t,feedName:a,indicatorReference:n,indicatorType:r,isDraggable:i,sourceField:o,sourceValue:s})=>p.a.createElement(u.EuiFlexGroup,{alignItems:"center","data-test-subj":"threat-match-row",gutterSize:"s",justifyContent:"center"},p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(h,{contextId:e,eventId:t,isDraggable:i,sourceField:o,sourceValue:s})),p.a.createElement(u.EuiFlexItem,{grow:!1},p.a.createElement(E,{contextId:e,eventId:t,feedName:a,indicatorReference:n,indicatorType:r,isDraggable:i})));var w=a(1110);const j=o.a.div.withConfig({displayName:"SpacedContainer",componentId:"sc-e4rhpb-0"})(["margin:"," 0;"],(({theme:e})=>e.eui.euiSizeS)),S=({data:e,isDraggable:t,scopeId:a})=>{const n=Object(r.get)(e,s.rb),i=Object(r.get)(e,m.a),o=Object(d.useCallback)(((e="max")=>{const r="max"===e?n.slice(0,2):n;return p.a.createElement(y.a,{"data-test-subj":"threat-match-row-renderer"},p.a.createElement(j,null,r.map(((e,r)=>{const o=`threat-match-row-${a}-${i}-${r}`;return p.a.createElement(d.Fragment,{key:o},p.a.createElement(x,{contextId:o,data:e,eventId:i,isDraggable:t}),r<n.length-1&&p.a.createElement(u.EuiHorizontalRule,{margin:"s"}))}))))}),[n,i,t,a]),l=Object(d.useCallback)((()=>o("all")),[o]);return p.a.createElement(u.EuiFlexGroup,{direction:"column",justifyContent:"center",alignItems:"center",gutterSize:"none"},p.a.createElement(u.EuiFlexItem,null,o()),n.length>2&&p.a.createElement(u.EuiFlexItem,null,p.a.createElement(O,{title:Object(w.h)(n.length),renderChildren:l})))},O=({title:e,renderChildren:t})=>{const[a,n]=Object(d.useState)(!1),r=()=>n(!1);let i;return a&&(i=p.a.createElement(u.EuiModal,{onClose:r},p.a.createElement(u.EuiModalHeader,{"data-test-subj":"threat-match-row-modal"},p.a.createElement(u.EuiModalHeaderTitle,null,w.b)),p.a.createElement(u.EuiModalBody,null,t()),p.a.createElement(u.EuiModalFooter,null,p.a.createElement(u.EuiButton,{onClick:r,fill:!0},w.a)))),p.a.createElement("div",null,p.a.createElement(u.EuiButtonEmpty,{"data-test-subj":"threat-match-row-show-all",iconType:"popout",color:"primary",onClick:()=>n(!0)},e),i)},I={id:n.d.threat_match,isInstance:e=>(e=>{const t=Object(r.get)(e,s.rb);return null==t?[]:Array.isArray(t)?t:[t]})(e).some((e=>l.i.some((t=>!Object(r.isEmpty)(Object(r.get)(e,t)))))),renderRow:({data:e,isDraggable:t,scopeId:a})=>p.a.createElement(S,{data:e,isDraggable:t,scopeId:a})}},1525:function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var n=a(45),r=a(2),i=a.n(r),o=a(113),s=a(1069),l=a(17),c=a(44),u=a.n(c),d=a(926),p=a(544),m=a(174),y=a(137),g=a(564),f=a(267);const b=["IPv4","IPv6"];var h=a(166),v=a(153);const E="suricata.eve.alert.signature",x="suricata.eve.alert.signature_id",k=u()(l.EuiFlexItem).withConfig({displayName:"SignatureFlexItem",componentId:"sc-1paeiel-0"})(["min-width:77px;"]);k.displayName="SignatureFlexItem";const w=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1paeiel-1"})(["vertical-align:top;"]);w.displayName="Badge";const j=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-1paeiel-2"})(["margin-left:6px;"]);j.displayName="LinkFlexItem";const S=i.a.memo((({tokens:e})=>i.a.createElement(i.a.Fragment,null,e.map((e=>i.a.createElement(f.c,{key:e,grow:!1},i.a.createElement(l.EuiBadge,{iconType:"tag",color:"hollow",title:""},e)))))));S.displayName="Tokens";const O=i.a.memo((({id:e,isDraggable:t,signatureId:a})=>{const n=Object(r.useMemo)((()=>({and:[],enabled:!0,id:Object(m.i)(`suricata-draggable-signature-id-${e}-sig-${a}`),name:String(a),excluded:!1,kqlQuery:"",queryMatch:{field:x,value:a,operator:v.d}})),[e,a]),o=Object(r.useCallback)(((e,t,n)=>n.isDragging?i.a.createElement(p.a,null,i.a.createElement(g.a,{dataProvider:e})):i.a.createElement(l.EuiToolTip,{"data-test-subj":"signature-id-tooltip",content:x},i.a.createElement(w,{iconType:"number",color:"hollow",title:""},a))),[a]);return i.a.createElement(k,{grow:!1},i.a.createElement(p.b,{dataProvider:n,isDraggable:t,render:o,isAggregatable:!0,fieldType:"keyword"}))}));O.displayName="DraggableSignatureId";const I=i.a.memo((({contextId:e,id:t,isDraggable:a,signature:n,signatureId:r})=>{const o=(e=>e.trim().split(" ").reduce(((e,t,a)=>e.length===a&&t===t.toUpperCase()&&""!==t||b.includes(t)?[...e,t]:e),[]))(n);return i.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(O,{id:`draggable-signature-id-${e}-${t}`,isDraggable:a,signatureId:r}),i.a.createElement(S,{tokens:o}),i.a.createElement(j,{grow:!1},i.a.createElement(h.b,{"data-test-subj":"draggable-signature-link",field:E,id:`suricata-signature-default-draggable-${e}-${t}-${E}`,isDraggable:a,value:n,tooltipPosition:"bottom"},i.a.createElement("div",null,i.a.createElement(y.c,{link:n},n.split(" ").splice(o.length).join(" "))))))}));I.displayName="SuricataSignature";const C=u()(l.EuiFlexItem).withConfig({displayName:"LinkEuiFlexItem",componentId:"sc-i69i1c-0"})(["display:inline;"]);C.displayName="LinkEuiFlexItem";const M=i.a.memo((({signatureId:e})=>{const[t,o]=Object(r.useState)(void 0);return Object(r.useEffect)((()=>{let t=!0;return async function(){if(null!=e)try{const r=await(async e=>{const t=(await a.e(21).then(a.t.bind(null,1713,7))).db,r=(i=t,o=e,Object.prototype.hasOwnProperty.call(i,o)?t[e]:null);var i,o;return null!=r?Object(n.uniq)(r):[]})(e);t&&null!=r&&o(r)}catch(e){o(void 0)}else t&&o(void 0)}(),()=>{t=!1}}),[e]),i.a.createElement(l.EuiFlexGroup,{"data-test-subj":"suricataRefs",gutterSize:"none",justifyContent:"center",wrap:!0},t&&t.map((e=>i.a.createElement(C,{key:e,grow:!1},i.a.createElement(l.EuiLink,{href:e,color:"subdued",target:"_blank"},e)))))}));M.displayName="SuricataRefs";const T=u.a.div.withConfig({displayName:"Details",componentId:"sc-1y9aljy-0"})(["margin:5px 0;"]);T.displayName="Details";const _=i.a.memo((({data:e,isDraggable:t,timelineId:a})=>{const r=Object(n.get)("suricata.eve.alert.signature[0]",e),o=Object(n.get)("suricata.eve.alert.signature_id[0]",e);return null!=o&&null!=r?i.a.createElement(T,null,i.a.createElement(I,{contextId:`suricata-signature-${a}-${e._id}`,id:e._id,isDraggable:t,signature:r,signatureId:o}),i.a.createElement(M,{signatureId:o}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:t,timelineId:a})):null}));_.displayName="SuricataDetails";const N={id:o.d.suricata,isInstance:e=>{const t=Object(n.get)("event.module[0]",e);return null!=t&&"suricata"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:a})=>i.a.createElement(s.a,null,i.a.createElement(_,{data:e,isDraggable:t,timelineId:a}))}},1526:function(e,t,a){"use strict";a.d(t,"a",(function(){return U}));var n=a(45),r=a(2),i=a.n(r),o=a(113),s=a(1069),l=a(17),c=a(44),u=a.n(c),d=a(926),p=a(544),m=a(174),y=a(137),g=a(564),f=a(153),b=a(5);const h=b.i18n.translate("xpack.securitySolution.zeek.s0Description",{defaultMessage:"Connection attempt seen, no reply"}),v=b.i18n.translate("xpack.securitySolution.zeek.s1Description",{defaultMessage:"Connection established, not terminated"}),E=b.i18n.translate("xpack.securitySolution.zeek.s2Description",{defaultMessage:"Connection established and close attempt by originator seen (but no reply from responder)"}),x=b.i18n.translate("xpack.securitySolution.zeek.s3Description",{defaultMessage:"Connection established and close attempt by responder seen (but no reply from originator)"}),k=b.i18n.translate("xpack.securitySolution.zeek.sfDescription",{defaultMessage:"Normal SYN/FIN completion"}),w=b.i18n.translate("xpack.securitySolution.zeek.rejDescription",{defaultMessage:"Connection attempt rejected"}),j=b.i18n.translate("xpack.securitySolution.zeek.rstoODescription",{defaultMessage:"Connection established, originator aborted (sent a RST)"}),S=b.i18n.translate("xpack.securitySolution.zeek.rstrDescription",{defaultMessage:"Established, responder aborted"}),O=b.i18n.translate("xpack.securitySolution.zeek.rstosoDescription",{defaultMessage:"Originator sent a SYN followed by a RST, no SYN-ACK from the responder"}),I=b.i18n.translate("xpack.securitySolution.zeek.rstrhDescription",{defaultMessage:"Responder sent a SYN ACK followed by a RST, no SYN from the (purported) originator"}),C=b.i18n.translate("xpack.securitySolution.zeek.shDescription",{defaultMessage:"Originator sent a SYN followed by a FIN, no SYN ACK from the responder"}),M=b.i18n.translate("xpack.securitySolution.zeek.shrDescription",{defaultMessage:"Responder sent a SYN ACK followed by a FIN, no SYN from the originator"}),T=b.i18n.translate("xpack.securitySolution.zeek.othDescription",{defaultMessage:"No SYN seen, just midstream traffic"}),_=u()(l.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1b5gq3p-0"})(["vertical-align:top;"]);_.displayName="Badge";const N=u()(l.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-1b5gq3p-1"})(["margin-left:3px;"]);N.displayName="TokensFlexItem";const D=u()(l.EuiFlexItem).withConfig({displayName:"LinkFlexItem",componentId:"sc-1b5gq3p-2"})(["margin-left:6px;"]);D.displayName="LinkFlexItem";const A=e=>e,q=e=>{const t=e.split(".");return t.length>=2&&null!=t[1]?""!==t[1]?t[1]:t[0]:e},F=e=>`Dropped:${e}`,L=e=>`md5: ${e.substr(0,7)}...`,R=e=>`sha1: ${e.substr(0,7)}...`,P=i.a.memo((({id:e,field:t,isDraggable:a,value:n,stringRenderer:o=A})=>{const s=Object(r.useMemo)((()=>({and:[],enabled:!0,id:Object(m.i)(`draggable-zeek-element-draggable-wrapper-${e}-${t}-${n}`),name:String(n),excluded:!1,kqlQuery:"",queryMatch:{field:t,value:String(n),operator:f.d}})),[t,e,n]),c=Object(r.useCallback)(((e,a,r)=>r.isDragging?i.a.createElement(p.a,null,i.a.createElement(g.a,{dataProvider:e})):i.a.createElement(l.EuiToolTip,{"data-test-subj":"badge-tooltip",content:t},i.a.createElement(_,{iconType:"tag",color:"hollow",title:""},o(String(n))))),[t,o,n]);return null!=n?i.a.createElement(N,{grow:!1},i.a.createElement(p.b,{dataProvider:s,isDraggable:a,render:c,isAggregatable:!0,fieldType:"keyword"})):null}));P.displayName="DraggableZeekElement";const z=i.a.memo((({value:e,link:t})=>null!=e?null!=t?i.a.createElement(D,{grow:!1},i.a.createElement("div",null,i.a.createElement(y.c,{link:t},e))):i.a.createElement(D,{grow:!1},i.a.createElement("div",null,i.a.createElement(y.c,{link:e}))):null));z.displayName="Link";const B=i.a.memo((({value:e})=>null!=e?i.a.createElement(D,{grow:!1},i.a.createElement("div",null,i.a.createElement(y.j,{domain:e,overflowIndexStart:1,showDomain:!0,"data-test-subj":"reputationLinkSha"}))):null));B.displayName="TotalVirusLinkSha";const G={S0:h,S1:v,S2:E,S3:x,SF:k,REJ:w,RSTO:j,RSTR:S,RSTOS0:O,RSTRH:I,SH:C,SHR:M,OTH:T},$=i.a.memo((({data:e,isDraggable:t,timelineId:a})=>{const r=`zeek-signature-draggable-zeek-element-${a}-${e._id}`,o=Object(n.get)("zeek.session_id[0]",e),s=Object(n.get)("event.dataset[0]",e),c=Object(n.get)("zeek.ssl.version[0]",e),u=Object(n.get)("zeek.ssl.cipher[0]",e),d=Object(n.get)("zeek.connection.state[0]",e),p=Object(n.get)("zeek.connection.history[0]",e),m=Object(n.get)("zeek.notice.note[0]",e),y=Object(n.get)("zeek.notice.msg[0]",e),g=(e=>null!=e?String(e):null)(Object(n.get)("zeek.notice.dropped[0]",e)),f=Object(n.get)("zeek.dns.query[0]",e),b=Object(n.get)("zeek.dns.qclass_name[0]",e),h=Object(n.get)("http.request.method[0]",e),v=Object(n.get)("http.response.status_code[0]",e),E=Object(n.get)("url.original[0]",e),x=Object(n.get)("zeek.files.sha1[0]",e),k=Object(n.get)("zeek.files.md5[0]",e),w=(e=>{if(null!=e){const t=G[e];return null!=t?`${e} ${t}`:e}return null})(d),j=(e=>null!=e&&null!=G[e]?G[e]:null)(d);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(P,{id:r,field:"zeek.session_id",isDraggable:t,value:o}),i.a.createElement(P,{id:r,field:"event.dataset",isDraggable:t,value:s,stringRenderer:q}),i.a.createElement(P,{id:r,field:"zeek.files.sha1",isDraggable:t,value:x,stringRenderer:R}),i.a.createElement(P,{id:r,field:"zeek.files.md5",isDraggable:t,value:k,stringRenderer:L}),i.a.createElement(P,{id:r,field:"zeek.notice.dropped",isDraggable:t,value:g,stringRenderer:F}),i.a.createElement(P,{id:r,field:"zeek.ssl.version",isDraggable:t,value:c}),i.a.createElement(P,{id:r,field:"zeek.ssl.cipher",isDraggable:t,value:u}),i.a.createElement(P,{id:r,field:"zeek.connection.state",isDraggable:t,value:d}),i.a.createElement(P,{id:r,field:"http.request.method",isDraggable:t,value:h}),i.a.createElement(P,{id:r,field:"zeek.connection.history",isDraggable:t,value:p}),i.a.createElement(P,{id:r,field:"zeek.notice.note",isDraggable:t,value:m}),i.a.createElement(P,{id:r,field:"zeek.dns.query",isDraggable:t,value:f}),i.a.createElement(P,{id:r,field:"zeek.dns.qclass_name",isDraggable:t,value:b}),i.a.createElement(P,{id:r,field:"http.response.status_code",isDraggable:t,value:v})),i.a.createElement(l.EuiFlexGroup,{justifyContent:"center",gutterSize:"none"},i.a.createElement(z,{link:w,value:j}),i.a.createElement(z,{value:u}),i.a.createElement(z,{value:f}),i.a.createElement(z,{value:y}),i.a.createElement(z,{value:E}),i.a.createElement(B,{value:x})))}));$.displayName="ZeekSignature";const H=u.a.div.withConfig({displayName:"Details",componentId:"sc-1ixpiaf-0"})(["margin:5px 0;"]);H.displayName="Details";const V=i.a.memo((({data:e,isDraggable:t,timelineId:a})=>null!=e.zeek?i.a.createElement(H,null,i.a.createElement($,{data:e,isDraggable:t,timelineId:a}),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{data:e,isDraggable:t,timelineId:a})):null));V.displayName="ZeekDetails";const U={id:o.d.zeek,isInstance:e=>{const t=Object(n.get)("event.module[0]",e);return null!=t&&"zeek"===t.toLowerCase()},renderRow:({data:e,isDraggable:t,scopeId:a})=>i.a.createElement(s.a,null,i.a.createElement(V,{data:e,isDraggable:t,timelineId:a}))}},1527:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),r=a.n(n),i=a(17),o=a(9),s=a(5);const l=s.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.addToRulesTableSelection.addToSelectedRulesDescription",{defaultMessage:"After you create the exception, it is added to the rules you link. "});var c=a(1370),u=a(1103);const d=Object(n.memo)((({rule:e,linkedRules:t,onRuleLinkChange:a})=>{const o=Object(n.useMemo)((()=>Boolean(t.find((t=>t.id===e.id)))),[t,e.id]),s=Object(n.useCallback)((({target:{checked:n}})=>{const r=n?[...t,e]:null==t?void 0:t.filter((t=>t.id!==e.id));"function"==typeof a&&a(r)}),[t,a,e]);return r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiSwitch,{onChange:s,label:"",checked:o}))}));d.displayName="LinkRuleSwitch";var p=a(1292);const m=({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{isLoading:a,searchOptions:m,pagination:y,sortedRulesByLinkedRulesOnTop:g,rulesTableColumnsWithLinkSwitch:f,onTableChange:b,addToSelectedRulesDescription:h}=(({initiallySelectedRules:e,onRuleSelectionChange:t})=>{const{data:{rules:a}={rules:[],total:0},isFetched:i}=Object(p.a)({filterOptions:{filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:void 0,pagination:{page:1,perPage:1e4}}),[m,y]=Object(n.useState)({pageIndex:0,initialPageSize:25,showPerPageOptions:!1}),[g,f]=Object(n.useState)(e||[]);Object(n.useEffect)((()=>{t(g)}),[g,t]);const b=Object(n.useMemo)((()=>Object(o.sortBy)(a,[t=>null==e?void 0:e.find((e=>e.id===t.id))])),[e,a]),h=Object(n.useMemo)((()=>{const e=b.reduce(((e,t)=>{const{tags:a}=t;return a.forEach((t=>e.add(t))),e}),new Set);return Array.from(e).map((e=>({value:e,name:e,field:"tags"})))}),[b]),v=Object(n.useMemo)((()=>({box:{incremental:!0,schema:!0},filters:[{type:"field_value_selection",operator:"exact",name:s.i18n.translate("xpack.securitySolution.exceptions.addToRulesTable.tagsFilterLabel",{defaultMessage:"Tags"}),multiSelect:"or",options:h}]})),[h]),E=Object(n.useMemo)((()=>[{field:"link",name:c.b,align:"left","data-test-subj":"ruleActionLinkRuleSwitch",render:(e,t)=>r.a.createElement(d,{rule:t,linkedRules:g,onRuleLinkChange:f})},...Object(u.c)()]),[g]),x=Object(n.useCallback)((({page:{index:e}})=>y({...m,pageIndex:e})),[m]);return{isLoading:!i,pagination:m,searchOptions:v,sortedRulesByLinkedRulesOnTop:b,rulesTableColumnsWithLinkSwitch:E,addToSelectedRulesDescription:l,onTableChange:x}})({initiallySelectedRules:e,onRuleSelectionChange:t});return r.a.createElement(i.EuiPanel,{color:"subdued",borderRadius:"none",hasShadow:!1},r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiText,{size:"s"},h),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiInMemoryTable,{tableLayout:"auto",search:m,"data-test-subj":"addExceptionToRulesTable",tableCaption:"Rules table",items:g,loading:a,columns:f,message:a?r.a.createElement(i.EuiSkeletonText,{lines:4,"data-test-subj":"exceptionItemViewerEmptyPromptsLoading"}):void 0,pagination:y,onTableChange:b})))},y=r.a.memo(m);y.displayName="ExceptionsAddToRulesTable"},1530:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),r=a(169),i=a(690),o=a(152),s=a(385),l=a(731),c=a(117),u=a(110),d=a(210),p=a(1062);const m=Object(o.d)((async({http:e,jobIds:t,signal:a})=>e.fetch("/internal/ml/jobs/jobs",{method:"POST",version:"1",body:JSON.stringify({jobIds:t}),asSystemRequest:!0,signal:a}))),y=(e,t,a)=>{const y=Object(n.useMemo)((()=>null!=e?e:[]),[e]),{loading:g,jobs:f}=Object(i.a)(),b=Object(n.useMemo)((()=>f.filter((({id:e})=>y.includes(e)))),[f,y]),h=Object(n.useMemo)((()=>b.filter((({isInstalled:e})=>e)).map((e=>e.id))),[b]),{loading:v,jobs:E}=(e=>{const[t,a]=Object(n.useState)([]),{addError:r}=Object(c.a)(),i=Object(d.a)(),y=Object(u.h)(),{error:g,loading:f,result:b,start:h}=Object(o.a)(m),v=Object(s.a)(i),E=Object(l.a)(i);return Object(n.useEffect)((()=>{v&&E&&e.length>0&&h({http:y,jobIds:e})}),[y,v,E,h,e]),Object(n.useEffect)((()=>{b&&a(b)}),[b]),Object(n.useEffect)((()=>{g&&r(g,{title:p.a})}),[r,g]),{isLicensed:E,isMlUser:v,jobs:t,loading:f}})(h),x=Object(n.useMemo)((()=>{const e=E.map((e=>`.ml-anomalies-${e.results_index_name}`));return[...new Set(e)]}),[E]);return{mlJobLoading:g||v,ruleIndices:Object(n.useMemo)((()=>x.length>0?x:a?Object(r.f)(a):null!=t?t:[]),[t,a,x])}}},1531:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(2),r=a.n(n),i=a(44),o=a.n(i),s=a(17),l=a(322),c=a(241),u=a(139),d=a(350),p=a(5);const m=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.sectionTitle",{defaultMessage:"Alerts actions"}),y=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.singleAlertCloseLabel",{defaultMessage:"Close this alert"}),g=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel.disabled",{defaultMessage:"Close all alerts that match this exception and were generated by this rule (Lists and non-ECS fields are not supported)"}),f=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.bulkCloseLabel",{defaultMessage:"Close all alerts that match this exception and were generated by selected rule/s"}),b=p.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.alertsActions.endpointQuarantineText",{defaultMessage:"On all Endpoint hosts, quarantined files that match the exception are automatically restored to their original locations. This exception applies to all rules using Endpoint exceptions."}),h=o.a.section.withConfig({displayName:"FlyoutCheckboxesSection",componentId:"sc-1ggwgok-0"})(["overflow-y:inherit;height:auto;.euiFlyoutBody__overflowContent{padding-top:0;}"]),v=o()(s.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1ggwgok-1"})(["",""],(()=>Object(i.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),E=({isAlertDataLoading:e,exceptionListItems:t,exceptionListType:a,shouldCloseSingleAlert:i,shouldBulkCloseAlert:o,disableBulkClose:p,alertData:E,alertStatus:x,onDisableBulkClose:k,onUpdateBulkCloseIndex:w,onBulkCloseCheckboxChange:j,onSingleAlertCloseCheckboxChange:S})=>{const{loading:O,signalIndexName:I}=Object(l.a)(),C=Object(n.useMemo)((()=>null!==I?[I]:[]),[I]),[M,{indexPatterns:T}]=Object(c.b)(C),_=Object(n.useCallback)((e=>{j(e.currentTarget.checked)}),[j]),N=Object(n.useCallback)((e=>{null!=S&&S(e.currentTarget.checked)}),[S]);return Object(n.useEffect)((()=>{w(o&&null!=C?C:void 0)}),[C,w,o]),Object(n.useEffect)((()=>{!0===p&&j(!1)}),[p,j]),Object(n.useEffect)((()=>{!1===M&&!1===O&&k((e=>{for(const{entries:t}of e)for(const e of null!=t?t:[])if(Object(d.l)(e)===u.d.LIST)return!0;return!1})(t)||((e,t)=>{const a=e=>t.fields.some((({name:t})=>t===e.field));if(0===e.length)return!1;for(const{entries:t}of e)for(const e of null!=t?t:[])if("nested"===e.type){for(const t of e.entries)if(!1===a(t))return!0}else if(!1===a(e))return!0;return!1})(t,T)||t.every((e=>0===e.entries.length)))}),[k,t,M,O,T]),r.a.createElement(h,null,r.a.createElement(v,{size:"xs"},r.a.createElement("h3",null,m)),r.a.createElement(s.EuiSpacer,{size:"s"}),null!=E&&"closed"!==x&&r.a.createElement(s.EuiFormRow,{fullWidth:!0},r.a.createElement(s.EuiCheckbox,{"data-test-subj":"closeAlertOnAddExceptionCheckbox",id:"close-alert-on-add-add-exception-checkbox",label:y,checked:i,onChange:N,disabled:O||M||e})),r.a.createElement(s.EuiFormRow,{fullWidth:!0},r.a.createElement(s.EuiCheckbox,{"data-test-subj":"bulkCloseAlertOnAddExceptionCheckbox",id:"bulk-close-alert-on-add-add-exception-checkbox",label:p?g:f,checked:o,onChange:_,disabled:p||O||M||e})),"endpoint"===a&&r.a.createElement(r.a.Fragment,null,r.a.createElement(s.EuiSpacer,{size:"s"}),r.a.createElement(s.EuiText,{"data-test-subj":"addExceptionEndpointText",color:"subdued",size:"s"},b)))},x=r.a.memo(E);x.displayName="ExceptionItemsFlyoutAlertsActions"},1532:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),r=a(400),i=a(165),o=a(53),s=a(110);var l=a(1089),c=a(22),u=a(5);const d=u.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.error",{defaultMessage:"Failed to close alerts"});var p=a(117),m=a(1158);const y=()=>{const{addSuccess:e,addError:t,addWarning:a}=Object(p.a)(),[y,g]=Object(n.useState)(!1),f=Object(n.useRef)(null);return Object(n.useEffect)((()=>{let n=!0;const p=new AbortController;return f.current=async(y,f,b,h)=>{try{var v,E,x,k,w,j,S,O;let t,d;if(g(!0),null!=b&&(t=await Object(m.a)({signalIds:[b],status:"closed",signal:p.signal})),null!=h){const e=Object(r.c)(["open","acknowledged","in-progress"]),t=await(async(e,t,a,n,r,l=!0)=>{const c={fields:[],title:n.join()},{filter:u}=await Object(i.q)({http:s.b.get().http,exceptions:r,excludeExceptions:l,chunkSize:10}),d={query:e,language:t},p=((e,t)=>null!=t?[...e,t]:[...e])(a,u);return Object(o.buildEsQuery)(c,d,p,{allowLeadingWildcards:!0,queryStringOptions:{analyze_wildcard:!0},ignoreFilterIfFieldNotInIndex:!1,dateFormatTZ:"Zulu"})})("","kuery",[...y.flatMap((e=>Object(r.d)(e))),...e],h,Object(l.m)(f),!1);d=await Object(m.a)({query:t,status:"closed",signal:p.signal})}const C=(null!==(v=null===(E=t)||void 0===E?void 0:E.updated)&&void 0!==v?v:0)+(null!==(x=null===(k=d)||void 0===k?void 0:k.updated)&&void 0!==x?x:0),M=null!==(w=null===(j=t)||void 0===j?void 0:j.version_conflicts)&&void 0!==w?w:0+(null!==(S=null===(O=d)||void 0===O?void 0:O.version_conflicts)&&void 0!==S?S:0);n&&(g(!1),e((I=C,u.i18n.translate("xpack.securitySolution.ruleExceptions.logic.closeAlerts.success",{values:{numAlerts:I},defaultMessage:"Successfully updated {numAlerts} {numAlerts, plural, =1 {alert} other {alerts}}"}))),M>0&&a({title:c.f(M),text:c.g(C,M)}))}catch(e){n&&(g(!1),t(e,{title:d}))}var I},()=>{n=!1,p.abort()}}),[e,t,a]),[y,f.current]}},1533:function(e,t,a){"use strict";a.d(t,"a",(function(){return x}));var n=a(23),r=a.n(n),i=a(2),o=a.n(i),s=a(47),l=a(17),c=a(3),u=a(1478),d=a(1549),p=a(51),m=a(1108);const y=e=>{var t,a,n,r,i,o,s;return null!=e&&null!==(t=e.agent)&&void 0!==t&&null!==(a=t.type)&&void 0!==a&&a.includes("endpoint")?((null==e||null===(n=e.host)||void 0===n||null===(r=n.os)||void 0===r?void 0:r.name)||["windows"]).map((e=>e.toLowerCase())):null!==(i=null==e||null===(o=e.host)||void 0===o||null===(s=o.os)||void 0===s?void 0:s.family)&&void 0!==i?i:["windows"]},g=e=>{var t,a;return{comments:[],description:"",entries:e&&e.event&&e.process?[{field:"event.category",operator:"included",type:"match",value:(null!==(t=e.event.category)&&void 0!==t?t:[])[0]},{field:"process.executable",operator:"included",type:"match",value:(null!==(a=e.process.executable)&&void 0!==a?a:[])[0]}]:[{field:"",operator:"included",type:"match",value:""}],item_id:void 0,list_id:m.a,meta:{temporaryUuid:Object(p.v4)()},name:"",namespace_type:"agnostic",tags:["policy:all"],type:"simple",os_types:y(e)}};var f=a(110),b=a(1164),h=a(880),v=a(1107),E=a(5);const x=Object(i.memo)((({onCancel:e,data:t,...a})=>{var n,p;const m=Object(f.m)(),y=Object(f.h)(),{isLoading:x,mutateAsync:k}=Object(u.a)(v.a.getInstance(y),"create"),[w,j]=Object(i.useState)(),[S,O]=Object(i.useState)(!1),{data:{search:I}}=Object(f.i)().services,C=Object(b.c)({perPage:1e3,onError:e=>{m.addWarning(Object(h.b)(e))}}),[M,T]=Object(i.useState)(g(t)),_=Object(i.useMemo)((()=>C.isLoading||C.isRefetching),[C]);Object(i.useEffect)((()=>(t&&(async()=>{var e;if(!t||!t._index)return;const a=await Object(c.lastValueFrom)(I.search({params:{index:t._index,body:{query:{match:{_id:t._id}}}}}));j({...t,host:{...t.host,os:{...(null==t||null===(e=t.host)||void 0===e?void 0:e.os)||{},name:[a.rawResponse.hits.hits[0]._source.host.os.name]}}})})(),()=>{T(g())})),[]);const N=Object(i.useCallback)((()=>{_||x||e()}),[x,_,e]),D=Object(i.useCallback)((()=>k(M,{onSuccess:t=>{var a;m.addSuccess((a=t,E.i18n.translate("xpack.securitySolution.eventFilter.flyoutForm.creationSuccessToastTitle",{defaultMessage:'"{name}" has been added to the event filters list.',values:{name:null==a?void 0:a.name}}))),e()},onError:e=>{m.addError(e,{title:'There was an error creating the new event filter: "{error}"',message:{error:e.message}})}})),[M,e,k,m]),A=Object(i.useMemo)((()=>o.a.createElement(l.EuiButton,{"data-test-subj":"add-exception-confirm-button",fill:!0,disabled:!S||x||!!t&&!w||_,onClick:D,isLoading:_},t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.update.withData",defaultMessage:"Add endpoint event filter"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.confirm.create",defaultMessage:"Add event filter"}))),[t,w,D,S,x,_]),q=Object(i.useCallback)((e=>{e&&(O(e.isValid),T(e.item))}),[]);return o.a.createElement(l.EuiFlyout,r()({size:"l",onClose:N,"data-test-subj":"eventFiltersCreateFlyout"},a),o.a.createElement(l.EuiFlyoutHeader,{hasBorder:!0},o.a.createElement(l.EuiTitle,{size:"m"},o.a.createElement("h2",null,t?o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.title.create.withData",defaultMessage:"Add endpoint event filter"}):o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create",defaultMessage:"Add event filter"}))),t?o.a.createElement(l.EuiTextColor,{color:"subdued"},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.subtitle.create.withData",defaultMessage:"Endpoint security"})):null),o.a.createElement(l.EuiFlyoutBody,null,o.a.createElement(d.a,{allowSelectOs:!t,error:void 0,disabled:!1,item:M,mode:"create",onChange:q,policies:null!==(n=null==C||null===(p=C.data)||void 0===p?void 0:p.items)&&void 0!==n?n:[],policiesIsLoading:_})),o.a.createElement(l.EuiFlyoutFooter,null,o.a.createElement(l.EuiFlexGroup,{justifyContent:"spaceBetween"},o.a.createElement(l.EuiFlexItem,{grow:!1},o.a.createElement(l.EuiButtonEmpty,{isDisabled:x,"data-test-subj":"cancelExceptionAddButton",onClick:N},o.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.eventFiltersFlyout.actions.cancel",defaultMessage:"Cancel"}))),o.a.createElement(l.EuiFlexItem,{grow:!1},A))))}));x.displayName="EventFiltersFlyout"},1534:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(17),r=a(2),i=a.n(r),o=a(754),s=a(710),l=a(59),c=a.n(l),u=a(487),d=a.n(u),p=a(5);p.i18n.translate("xpack.securitySolution.clipboard.copy",{defaultMessage:"Copy"});const m=p.i18n.translate("xpack.securitySolution.clipboard.copied",{defaultMessage:"Copied"}),y=p.i18n.translate("xpack.securitySolution.clipboard.to.the.clipboard",{defaultMessage:"to the clipboard"}),g=p.i18n.translate("xpack.securitySolution.clipboard.copy.to.the.clipboard",{defaultMessage:"Copy to the clipboard"});var f=a(117);const b=({children:e,content:t,isHoverAction:a,onCopy:r,titleSummary:o,toastLifeTimeMs:s})=>{const{addSuccess:l}=Object(f.a)(),u=c()("copy-to-clipboard",{securitySolution__hoverActionButton:a});return i.a.createElement(n.EuiButtonIcon,{"aria-label":g,className:u,"data-test-subj":"clipboard",iconType:"copyClipboard",onClick:e=>{e.preventDefault(),e.stopPropagation();const a=d()(`${t}`,{debug:!0});null!=r&&r({content:t,isSuccess:a}),a&&l(`${m} ${o} ${y}`,{toastLifeTimeMs:s})}},e)},h=i.a.memo((({isHoverAction:e,keyboardShortcut:t="",text:a,titleSummary:r})=>i.a.createElement(n.EuiToolTip,{content:i.a.createElement(o.a,{additionalScreenReaderOnlyContext:a,content:s.a,shortcut:t,showShortcut:""!==t})},i.a.createElement(b,{content:a,isHoverAction:e,titleSummary:r,toastLifeTimeMs:800}))));h.displayName="WithCopyToClipboard"},1536:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(9),r=a(2),i=a.n(r),o=a(17),s=a(142),l=a(18),c=a(262),u=a(1166),d=a(1524),p=a(1389);const m=({alertItems:e,refresh:t,setIsLoading:a,clearSelection:o,closePopoverMenu:l,onSubmit:c})=>{const u=Object(r.useMemo)((()=>Object(n.intersection)(...e.map((e=>{var t,a;return null!==(t=null===(a=e.data.find((e=>e.field===s.mb)))||void 0===a?void 0:a.value)&&void 0!==t?t:[]})))),[e]),m=Object(r.useCallback)((async n=>{const r=Object(p.b)(n),i=r.filter((e=>e&&!u.includes(e))),s=u.filter((e=>e&&!r.includes(e)));if(0===i.length&&0===s.length)return void l();const d=e.map((e=>e._id)),m={add:i,remove:s};null!=c&&(l(),await c(m,d,(()=>{t&&t(),o&&o()}),a))}),[e,u,o,l,c,t,a]);return i.a.createElement("div",{"data-test-subj":"alert-assignees-selectable-menu"},i.a.createElement(d.a,{assignedUserIds:u,onAssigneesApply:m}))},y=Object(r.memo)(m);var g=a(925),f=a(1538);const b=({onAssigneesUpdate:e})=>{const t=Object(l.b)().isPlatinumPlus(),{hasIndexWrite:a}=Object(c.a)(),d=Object(f.a)(),p=Object(r.useCallback)((async(e,t,a,n)=>{d&&await d(e,t,a,n)}),[d]),m=Object(r.useCallback)((()=>{null==e||e()}),[e]),b=Object(r.useCallback)((async(e,t,a)=>{const r=e.map((e=>e._id)),i=Object(n.union)(...e.map((e=>{var t,a;return null!==(t=null===(a=e.data.find((e=>e.field===s.mb)))||void 0===a?void 0:a.value)&&void 0!==t?t:[]})));if(!i.length)return;const o={add:[],remove:i};d&&await d(o,r,m,a)}),[m,d]),h=Object(r.useMemo)((()=>a&&t?[{key:"manage-alert-assignees","data-test-subj":"alert-assignees-context-menu-item",name:g.c,panel:2,label:g.c,disableOnQuery:!0},{key:"remove-all-alert-assignees","data-test-subj":"remove-alert-assignees-menu-item",name:g.s,label:g.s,disableOnQuery:!0,onClick:b}]:[]),[a,t,b]),v=Object(r.useMemo)((()=>i.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},i.a.createElement(o.EuiFlexItem,{grow:!1},g.c))),[]),E=Object(r.useCallback)((({alertItems:e,refresh:t,setIsBulkActionsLoading:a,clearSelection:n,closePopoverMenu:r})=>i.a.createElement(y,{alertItems:e,refresh:()=>{m(),null==t||t()},setIsLoading:a,clearSelection:n,closePopoverMenu:r,onSubmit:p})),[p,m]);return{alertAssigneesItems:h,alertAssigneesPanels:Object(r.useMemo)((()=>a&&t?[{id:2,title:v,"data-test-subj":"alert-assignees-context-menu-panel",renderContent:E,width:u.a}]:[]),[v,a,t,E])}}},1545:function(e,t,a){"use strict";a.d(t,"b",(function(){return R})),a.d(t,"a",(function(){return P}));var n=a(2),r=a.n(n),i=a(17),o=a(9),s=a(48),l=a(139),c=a(45),u=a(124),d=a(428),p=a(961),m=a(127),y=a(1472),g=a(110),f=a(695),b=a(1089),h=a(135),v=a(243),E=a(1272),x=a(197),k=a(128),w=a(298),j=a(297),S=a(322),O=a(1533),I=a(1386),C=a(1483),M=a(1484),T=a(1485),_=a(592),N=a(1486),D=a(1550),A=a(911),q=a(1487),F=a(1488);const L=({ariaLabel:e=x.G,ariaRowindex:t,columnValues:a,disabled:l,ecsRowData:d,onRuleChange:b,scopeId:E,refetch:w})=>{var j,S,L,R,z,B,G,$,H,V,U,W,Y,Z,K,Q,X,J,ee;const[te,ae]=Object(n.useState)(!1),[ne,re]=Object(n.useState)(!1),ie=Object(n.useCallback)((()=>{ae(!1)}),[]),oe=Object(n.useMemo)((()=>k.d.globalQuery()),[]),se=Object(n.useMemo)((()=>k.d.timelineQueryByIdSelector()),[]),le=Object(s.useSelector)((e=>oe(e))),ce=Object(s.useSelector)((e=>se(e,E))),ue=null!=d&&null!==(de=d.kibana)&&void 0!==de&&de.alert?null==d?void 0:d._id:null;var de;const pe=Object(c.get)(0,null==d||null===(j=d.kibana)||void 0===j||null===(S=j.alert)||void 0===S||null===(L=S.rule)||void 0===L?void 0:L.uuid),me=Object(c.get)(0,null==d||null===(R=d.kibana)||void 0===R||null===(z=R.alert)||void 0===z||null===(B=z.rule)||void 0===B?void 0:B.rule_id),ye=Object(c.get)(0,null==d||null===(G=d.kibana)||void 0===G||null===($=G.alert)||void 0===$||null===(H=$.rule)||void 0===H?void 0:H.name),ge=[u.e.alertsOnAlertsPage,u.e.alertsOnRuleDetailsPage].includes(E),{addToCaseActionItems:fe}=Object(D.a)({ecsData:d,onMenuItemClick:ie,isActiveTimelines:Object(m.isActiveTimeline)(null!=E?E:""),ariaLabel:Object(_.a)({ariaRowindex:t,columnValues:a}),isInDetections:ge,refetch:w}),{loading:be,canWriteEventFilters:he}=Object(h.a)().endpointPrivileges,ve=Object(n.useMemo)((()=>!be&&he),[he,be]),Ee=Object(c.get)(0,null==d||null===(V=d.kibana)||void 0===V||null===(U=V.alert)||void 0===U?void 0:U.workflow_status),xe=Object(n.useMemo)((()=>{var e;return-1!==Object(o.indexOf)(null===(e=d.event)||void 0===e?void 0:e.kind,"event")}),[d]),ke=Object(n.useMemo)((()=>{var e,t;return null===(e=d.agent)||void 0===e||null===(t=e.type)||void 0===t?void 0:t.includes("endpoint")}),[d]),we=Object(n.useMemo)((()=>xe&&ke),[xe,ke]),je=Object(n.useMemo)((()=>E===u.e.hostsPageEvents||E===u.e.usersPageEvents),[E]),Se=Object(n.useCallback)((()=>{ae(!te)}),[te]),Oe=Object(n.useCallback)((()=>{ae(!1)}),[]),Ie=Object(n.useMemo)((()=>r.a.createElement(i.EuiToolTip,{position:"top",content:x.G},r.a.createElement(i.EuiButtonIcon,{"aria-label":e,"data-test-subj":"timeline-context-menu-button",size:"s",iconType:"boxesHorizontal","data-popover-open":te,onClick:Se,isDisabled:l}))),[l,Se,e,te]),Ce=e=>{e.forEach((e=>e.refetch&&e.refetch()))},Me=Object(n.useCallback)((()=>{Object(m.isActiveTimeline)(null!=E?E:"")?Ce([ce]):(Ce(le),w&&w())}),[E,le,ce,w]),Te=null!==(W=null===(Y=d["kibana.alert.rule.parameters"])||void 0===Y?void 0:Y.index)&&void 0!==W?W:null==d||null===(Z=d.signal)||void 0===Z||null===(K=Z.rule)||void 0===K?void 0:K.index,_e=null!==(Q=null===(X=d["kibana.alert.rule.parameters"])||void 0===X?void 0:X.data_view_id)&&void 0!==Q?Q:null==d||null===(J=d.signal)||void 0===J||null===(ee=J.rule)||void 0===ee?void 0:ee.data_view_id,{exceptionFlyoutType:Ne,openAddExceptionFlyout:De,onAddExceptionCancel:Ae,onAddExceptionConfirm:qe,onAddExceptionTypeClick:Fe}=Object(C.a)({refetch:Me,onRuleChange:b,isActiveTimelines:Object(m.isActiveTimeline)(null!=E?E:"")}),{closeAddEventFilterModal:Le,isAddEventFilterModalOpen:Re,onAddEventFilterClick:Pe}=Object(T.a)(),{actionItems:ze}=Object(I.a)({alertStatus:Ee,eventId:null==d?void 0:d._id,scopeId:E,refetch:Me,closePopover:Oe}),Be=Object(n.useCallback)((e=>{Fe(e),Oe()}),[Oe,Fe]),Ge=Object(n.useCallback)((()=>{Pe(),Oe()}),[Oe,Pe]),{exceptionActionItems:$e}=Object(M.a)({isEndpointAlert:Object(A.a)({ecsData:d}),onAddExceptionTypeClick:Be}),{eventFilterActionItems:He}=Object(N.a)({onAddEventFilterClick:Ge,disabled:!we||!je,tooltipMessage:je?void 0:x.f}),Ve=Object(n.useMemo)((()=>{var e;return Object(c.get)(0,null==d||null===(e=d.agent)||void 0===e?void 0:e.id)}),[d]),Ue=Object(n.useCallback)((()=>{re((e=>!e)),ae(!1)}),[]),{osqueryActionItems:We}=(({handleClick:e})=>{const t=Object(n.useMemo)((()=>Object(y.a)({handleClick:e})),[e]),a=Object(g.i)().services.application.capabilities.osquery;return{osqueryActionItems:null!=a&&a.writeLiveQueries||null!=a&&a.runSavedQueries?[t]:[]}})({handleClick:Ue}),{alertTagsItems:Ye,alertTagsPanels:Ze}=Object(q.a)({closePopover:Oe,ecsRowData:d,refetch:Me}),{alertAssigneesItems:Ke,alertAssigneesPanels:Qe}=Object(F.a)({closePopover:Oe,ecsRowData:d,refetch:Me}),Xe=Object(n.useMemo)((()=>!xe&&pe?[...fe,...ze,...Ye,...Ke,...$e,...Ve?We:[]]:[...fe,...ve?He:[],...Ve?We:[]]),[xe,pe,fe,ze,$e,Ve,We,He,ve,Ye,Ke]),Je=Object(n.useMemo)((()=>[{id:0,items:Xe},...Ze,...Qe]),[Ze,Qe,Xe]),et=Object(n.useMemo)((()=>r.a.createElement(f.a,{agentId:Ve,defaultValues:ue?{alertIds:[ue]}:void 0,onClose:Ue,ecsData:d})),[Ve,ue,d,Ue]);return r.a.createElement(r.a.Fragment,null,Xe.length>0&&r.a.createElement("div",{key:"actions-context-menu"},r.a.createElement(v.l,{textAlign:"center",width:p.b},r.a.createElement(i.EuiPopover,{id:"singlePanel",button:Ie,isOpen:te,closePopover:Oe,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},r.a.createElement(i.EuiContextMenu,{size:"s",initialPanelId:0,panels:Je,"data-test-subj":"actions-context-menu"})))),De&&pe&&me&&null!=ye&&null!=(null==d?void 0:d._id)&&r.a.createElement(P,{ruleId:pe,ruleRuleId:me,ruleIndices:Te,ruleDataViewId:_e,ruleName:ye,exceptionListType:Ne,eventId:null==d?void 0:d._id,onCancel:Ae,onConfirm:qe,alertStatus:Ee}),Re&&null!=d&&r.a.createElement(O.a,{data:d,onCancel:Le}),ne&&Ve&&null!=d&&et)},R=r.a.memo(L),P=({ruleId:e,ruleRuleId:t,ruleIndices:a,ruleDataViewId:i,ruleName:o,exceptionListType:s,eventId:c,onCancel:u,onConfirm:p,alertStatus:m})=>{const{loading:y,signalIndexName:g}=Object(S.a)(),{rule:f,loading:h}=Object(d.a)(e),{loading:v,data:x}=Object(w.a)({query:Object(b.a)(c),indexName:g,queryName:j.a.ADD_EXCEPTION_FLYOUT}),k=Object(n.useMemo)((()=>{if(!1===v){const e=null==x?void 0:x.hits.hits[0];if(!e)return;const{_id:t,_index:a,_source:n}=e;return{...n,_id:t,_index:a}}}),[null==x?void 0:x.hits.hits,v]),O=Object(n.useMemo)((()=>{var e,t,n;return null!=k&&null!=(null===(e=k["kibana.alert.rule.parameters"])||void 0===e?void 0:e.index)?Array.isArray(k["kibana.alert.rule.parameters"].index)?k["kibana.alert.rule.parameters"].index:[k["kibana.alert.rule.parameters"].index]:null!=k&&null!=(null==k||null===(t=k.signal)||void 0===t||null===(n=t.rule)||void 0===n?void 0:n.index)?Array.isArray(k.signal.rule.index)?k.signal.rule.index:[k.signal.rule.index]:a}),[k,a]),I=Object(n.useMemo)((()=>{var e;return null!=k&&null!=(null===(e=k["kibana.alert.rule.parameters"])||void 0===e?void 0:e.data_view_id)?k["kibana.alert.rule.parameters"].data_view_id:i}),[k,i]),C=Object(n.useMemo)((()=>f?[f]:null),[f]),M=v&&y||null==k||null==O&&null==I;return r.a.createElement(E.a,{rules:C,isEndpointItem:s===l.b.ENDPOINT,alertData:k,isAlertDataLoading:M||h,alertStatus:m,isBulkAction:!1,showAlertCloseOptions:!0,onCancel:u,onConfirm:p})}},1546:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),r=a.n(n),i=a(17),o=a(5);const s=o.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.nameLabel",{defaultMessage:"Exception name"}),l=o.i18n.translate("xpack.securitySolution.rule_exceptions.itemMeta.namePlaceholder",{defaultMessage:"Name your exception"}),c=({exceptionItemName:e,onChange:t})=>{const a=Object(n.useCallback)((e=>{t(["name",e.target.value])}),[t]);return r.a.createElement(i.EuiFormRow,{label:s,"data-test-subj":"exceptionFlyoutName"},r.a.createElement(i.EuiFieldText,{placeholder:l,value:e,onChange:a,"data-test-subj":"exceptionFlyoutNameInput"}))},u=r.a.memo(c);u.displayName="ExceptionsFlyoutMeta"},1547:function(e,t,a){"use strict";a.d(t,"a",(function(){return w}));var n=a(2),r=a.n(n),i=a(17),o=a(95),s=a(139),l=a(44),c=a.n(l),u=a(175),d=a(231),p=a(110),m=a(5);const y=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.conditionsTitle",{defaultMessage:"Conditions"}),g=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.infoLabel",{defaultMessage:"Alerts are generated when the rule's conditions are met, except when:"}),f=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningAdd",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception created will apply to all events in the sequence."}),b=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.sequenceWarningEdit",{defaultMessage:"This rule's query contains an EQL sequence statement. The exception modified will apply to all events in the sequence."}),h=m.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.itemConditions.operatingSystemPlaceHolder",{defaultMessage:"Select an operating system"});var v=a(1291);const E=[{label:v.g,value:["windows"]},{label:v.f,value:["macos"]},{label:v.e,value:["linux"]},{label:v.h,value:["windows","macos"]}],x=c()(i.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-x9h592-0"})(["",""],(()=>Object(l.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),k=({exceptionItemName:e,allowLargeValueLists:t,exceptionListItems:a,indexPatterns:l,rules:c,exceptionListType:m,showOsTypeOptions:k,selectedOs:w,isEdit:j,onOsChange:S,onExceptionItemAdd:O,onSetErrorExists:I,getExtendedFields:C})=>{const{http:M,unifiedSearch:T}=Object(p.i)().services,_=Object(n.useMemo)((()=>m===s.b.ENDPOINT),[m]),N=Object(n.useMemo)((()=>null!=c&&c.some((e=>"eql"===e.type&&Object(d.a)(e.query)))),[c]),D=Object(n.useMemo)((()=>{if(_)return"endpoint_list";const e=_?u.k:void 0;return j?a[0].list_id:e}),[_,j,a]),A=Object(n.useMemo)((()=>{const e=_?"agnostic":void 0;return j?a[0].namespace_type:e}),[a,j,_]),q=Object(n.useCallback)((({exceptionItems:e,errorExists:t})=>{O(e),I(t)}),[I,O]),F=Object(n.useCallback)((e=>{const t=e[0].value;null!=S&&S(t||void 0)}),[S]),L=Object(n.useMemo)((()=>({asPlainText:!0})),[]),R=Object(n.useMemo)((()=>E.filter((e=>w===e.value))),[w]),P=Object(n.useMemo)((()=>k&&void 0===w),[k,w]),z=Object(n.useMemo)((()=>j?b:f),[j]),B=Object(n.useMemo)((()=>{var e;return null!==(e=j?a[0].os_types:w)&&void 0!==e?e:[]}),[a,j,w]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(x,{size:"xs"},r.a.createElement("h3",null,y)),N&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiCallOut,{"data-test-subj":"eqlSequenceCallout",title:z}),r.a.createElement(i.EuiSpacer,null)),r.a.createElement(i.EuiSpacer,{size:"s"}),r.a.createElement(i.EuiText,{size:"s"},g),r.a.createElement(i.EuiSpacer,{size:"s"}),k&&!j&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiFormRow,{label:v.d},r.a.createElement(i.EuiComboBox,{placeholder:h,singleSelection:L,options:E,selectedOptions:R,onChange:F,isClearable:!1,"data-test-subj":"osSelectionDropdown"})),r.a.createElement(i.EuiSpacer,{size:"l"})),k&&j&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiText,{size:"xs","data-test-subj":"exceptionItemSelectedOs"},r.a.createElement("dl",null,r.a.createElement("dt",null,v.d),r.a.createElement("dd",null,(e=>e.reduce(((e,t)=>`${(e=>"linux"===e?v.e:"macos"===e?v.f:v.g)(t)}, ${e}`),"").slice(0,-2))(B)))),r.a.createElement(i.EuiSpacer,null)),Object(o.getExceptionBuilderComponentLazy)({allowLargeValueLists:t,httpService:M,autocompleteService:T.autocomplete,exceptionListItems:a,listType:m,osTypes:B,listId:D,listNamespaceType:A,exceptionItemName:e,indexPatterns:l,isOrDisabled:P,isAndDisabled:P,isNestedDisabled:P,dataTestSubj:"alertExceptionBuilder",idAria:"alertExceptionBuilder",onChange:q,isDisabled:P,allowCustomFieldOptions:!_,getExtendedFields:C}))},w=r.a.memo(k);w.displayName="ExceptionsConditions"},1548:function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(17),r=a(56),i=a.n(r),o=a(2),s=a.n(o),l=a(44),c=a.n(l),u=a(5);const d=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.expireTimeLabel",{defaultMessage:"Exception will expire at"}),p=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.exceptionExpireTime",{defaultMessage:"Exception Expiration"}),m=u.i18n.translate("xpack.securitySolution.rule_exceptions.flyoutComponents.expireTime.exceptionExpireTimeError",{defaultMessage:"Selected date and time must be in the future."}),y=c()(n.EuiTitle).withConfig({displayName:"SectionHeader",componentId:"sc-1t4zrw1-0"})(["",""],(()=>Object(l.css)(["font-weight:",";"],(({theme:e})=>e.eui.euiFontWeightSemiBold)))),g=({expireTime:e,setExpireTime:t,setExpireError:a})=>{const[r,l]=Object(o.useState)(e),[c,u]=Object(o.useState)(!1),[g,f]=Object(o.useState)([]),b=Object(o.useCallback)((e=>{l(null!=e?e:void 0),t(null!=e?e:void 0),null!=e&&e.isBefore()?(u(!0),f([m]),a(!0)):(u(!1),f([]),a(!1))}),[l,t,a]);return s.a.createElement("div",null,s.a.createElement(y,{size:"xs"},s.a.createElement("h3",null,p)),s.a.createElement(n.EuiSpacer,{size:"s"}),s.a.createElement(n.EuiFormRow,{error:g,isInvalid:c,label:d},s.a.createElement(n.EuiDatePicker,{showTimeSelect:!0,selected:r,isInvalid:c,onChange:b,onClear:()=>b(null),minDate:i()()})))},f=s.a.memo(g);f.displayName="ExceptionsExpireTime"},1549:function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(2),r=a.n(n),i=a(9),o=a(17),s=a(47),l=a(350),c=a(169),u=a(95),d=a(200),p=a(115),m=a(241),y=a(529),g=a(18),f=a(110),b=a(1106),h=a(1480),v=a(880),E=a(1108),x=a(1331),k=a(1165),w=a(1440),j=a(1107);const S=[c.c.MAC,c.c.WINDOWS,c.c.LINUX].map((e=>({value:e,inputDisplay:v.a[e]}))),O=e=>e.entries.map((e=>(delete e.id,e))),I=Object(n.memo)((({allowSelectOs:e=!0,item:t,policies:a,policiesIsLoading:v,onChange:I,mode:C})=>{const M=Object(p.a)("eventFilters-form"),{http:T}=Object(f.i)().services,_=Object(n.useCallback)((({field:e,query:t})=>new j.a(T).getSuggestions({field:e.name,query:t})),[T]),N=(D=_,Object(n.useMemo)((()=>({getQuerySuggestions:()=>{},hasQuerySuggestions:e=>!1,getValueSuggestions:D})),[D]));var D;const[A,q]=Object(n.useState)(!1),[F,L]=Object(n.useState)(!t.name),[R,P]=Object(n.useState)(""),[z,B]=Object(n.useState)(!1),[G,$]=Object(n.useState)(!1),[H,V]=Object(n.useState)([]),U=Object(g.b)().isPlatinumPlus(),W=Object(n.useMemo)((()=>Object(b.e)(t)),[t]),[Y,Z]=Object(n.useState)(!Object(k.d)(null==t?void 0:t.tags)),[K,Q]=Object(n.useState)(!1),X=Object(n.useMemo)((()=>[d.B]),[]),[J,{indexPatterns:ee}]=Object(m.b)(X,void 0,d.k),[te,ae]=Object(n.useState)(!!t.entries.length||!1),ne=Object(n.useMemo)((()=>null==t?void 0:t.comments),[]),re=Object(n.useMemo)((()=>U||"edit"===C&&(!W||Y&&W&&A)),[C,W,A,U,Y]),ie=Object(n.useMemo)((()=>!F&&!z&&!!t.entries.length&&t.entries.some((e=>""!==e.value||e.value.length))),[z,F,t.entries]),oe=Object(n.useCallback)((e=>{const a=e?{...t,...e}:t;O(a),I({item:a,isValid:ie&&te})}),[te,t,ie,I]);Object(n.useEffect)((()=>{!A&&t.tags&&Z(!Object(k.d)(t.tags))}),[t.tags,A]),Object(n.useEffect)((()=>{if(A)return;const e=t.tags?Object(b.c)({tags:t.tags}):[];if(!e.length)return;const n=a.filter((t=>e.includes(t.id)));V(n)}),[A,t,a]);const se=Object(n.useMemo)((()=>{const e=t;return e.entries=t.entries.length?t.entries:[{field:"",operator:"included",type:"match",value:""}],O(e),ae(!!t.entries.length),e}),[t]),le=Object(n.useCallback)((e=>{if(!t)return;const a=e.target.value.trim();L(!a),oe({name:a}),A||q(!0)}),[t,A,oe]),ce=Object(n.useMemo)((()=>{var e;return r.a.createElement(o.EuiFormRow,{label:h.e,fullWidth:!0,isInvalid:F&&G,error:h.d},r.a.createElement(o.EuiFieldText,{"aria-label":h.e,id:"eventFiltersFormInputName",defaultValue:null!==(e=null==t?void 0:t.name)&&void 0!==e?e:"","data-test-subj":M("name-input"),fullWidth:!0,maxLength:256,required:G,onChange:le,onBlur:()=>!G&&$(!0)}))}),[M,F,le,G,null==t?void 0:t.name]),ue=Object(n.useCallback)((e=>{t&&(A||q(!0),oe({description:e.target.value.toString().trim()}))}),[t,A,oe]),de=Object(n.useMemo)((()=>{var e;return r.a.createElement(o.EuiFormRow,{label:h.b,fullWidth:!0},r.a.createElement(o.EuiTextArea,{id:"eventFiltersFormInputDescription",defaultValue:null!==(e=null==t?void 0:t.description)&&void 0!==e?e:"",onChange:ue,fullWidth:!0,"data-test-subj":M("description-input"),"aria-label":h.b,maxLength:256}))}),[null==t?void 0:t.description,M,ue]),pe=Object(n.useMemo)((()=>{var e;return null!=t&&null!==(e=t.os_types)&&void 0!==e&&e.length?t.os_types[0]:c.c.WINDOWS}),[null==t?void 0:t.os_types]),me=Object(n.useCallback)((e=>{t&&(oe({os_types:[e],entries:t.entries}),A||q(!0))}),[t,A,oe]),ye=Object(n.useMemo)((()=>r.a.createElement(o.EuiFormRow,{label:h.f,fullWidth:!0},r.a.createElement(o.EuiSuperSelect,{name:"os",options:S,fullWidth:!0,valueOfSelected:pe,onChange:me}))),[me,pe]),ge=Object(n.useCallback)((e=>{t&&(P(e),oe({comments:[{comment:e}]}),A||q(!0))}),[t,A,oe]),fe=Object(n.useMemo)((()=>r.a.createElement(w.a,{exceptionItemComments:ne,newCommentValue:R,newCommentOnChange:ge,setCommentError:B})),[ne,ge,R]),be=Object(n.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiText,{size:"xs"},r.a.createElement("h3",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionTitle",defaultMessage:"Comments"}))),r.a.createElement(o.EuiSpacer,{size:"xs"}),r.a.createElement(o.EuiText,{size:"s"},r.a.createElement("p",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.commentsSectionDescription",defaultMessage:"Add a comment to your event filter."}))),r.a.createElement(o.EuiSpacer,{size:"m"}),fe)),[fe]),he=Object(n.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiText,{size:"xs"},r.a.createElement("h3",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.detailsSectionTitle",defaultMessage:"Details"}))),r.a.createElement(o.EuiSpacer,{size:"xs"}),r.a.createElement(o.EuiText,{size:"s"},r.a.createElement("p",null,h.a)),r.a.createElement(o.EuiSpacer,{size:"m"}),ce,de)),[ce,de]),ve=Object(n.useCallback)((e=>{var a,n,r,o,s,l,u,d,p;if(!A&&void 0===e.exceptionItems[0]||Object(i.isEqual)(null===(a=e.exceptionItems[0])||void 0===a?void 0:a.entries,null==t?void 0:t.entries)){var m;const t=(null===(m=e.exceptionItems[0])||void 0===m?void 0:m.entries.map((e=>e.field)))||[""];return Q((p=t.reduce(((e,t)=>(t in e?e[t]++:e[t]=1,e)),{}),Object.values(p).some((e=>e>1)))),void(A||q(!0))}const y=void 0!==e.exceptionItems[0]?{...e.exceptionItems[0],name:null!==(n=null==t?void 0:t.name)&&void 0!==n?n:"",description:null!==(r=null==t?void 0:t.description)&&void 0!==r?r:"",comments:null!==(o=null==t?void 0:t.comments)&&void 0!==o?o:[],os_types:null!==(s=null==t?void 0:t.os_types)&&void 0!==s?s:[c.c.WINDOWS],tags:null!==(l=null==t?void 0:t.tags)&&void 0!==l?l:[],meta:t.meta}:t,g=void 0!==e.exceptionItems[0]&&!(e.errorExists&&(null===(u=e.exceptionItems[0])||void 0===u||null===(d=u.entries)||void 0===d||!d.length));ae(g),oe(y),A||q(!0)}),[t,A,oe]),Ee=Object(n.useMemo)((()=>Object(u.getExceptionBuilderComponentLazy)({allowLargeValueLists:!1,httpService:T,autocompleteService:N,exceptionListItems:[se],listType:E.c,listId:E.a,listNamespaceType:"agnostic",ruleName:h.g,indexPatterns:ee,isOrDisabled:!0,isOrHidden:!0,isAndDisabled:!1,isNestedDisabled:!1,dataTestSubj:"alert-exception-builder",idAria:"alert-exception-builder",onChange:ve,operatorsList:l.b,osTypes:t.os_types})),[N,ve,T,ee,t,se]),xe=Object(n.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiText,{size:"xs"},r.a.createElement("h3",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionTitle",defaultMessage:"Conditions"}))),r.a.createElement(o.EuiSpacer,{size:"xs"}),r.a.createElement(o.EuiText,{size:"s"},r.a.createElement("p",null,e?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withOs",defaultMessage:"Select an operating system and add conditions."}):r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.criteriaSectionDescription.withoutOs",defaultMessage:"Add conditions."}))),r.a.createElement(o.EuiSpacer,{size:"m"}),e?r.a.createElement(r.a.Fragment,null,ye,r.a.createElement(o.EuiSpacer,null)):null,Ee)),[e,Ee,ye]),ke=Object(n.useCallback)((e=>{const t=e.isGlobal?[b.b]:e.selected.map((e=>`${b.a}${e.id}`));e.isGlobal||V(e.selected),oe({tags:t}),A||q(!0)}),[oe,A,V]),we=Object(n.useMemo)((()=>r.a.createElement(x.a,{selected:H,options:a,isGlobal:W,isLoading:v,isPlatinumPlus:U,onChange:ke,"data-test-subj":M("effectedPolicies")})),[H,a,W,v,U,ke,M]);return Object(n.useEffect)((()=>{oe()}),[oe]),J||!t?r.a.createElement(y.a,{size:"xl"}):r.a.createElement(o.EuiForm,{component:"div"},he,r.a.createElement(o.EuiHorizontalRule,null),xe,K&&r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiSpacer,{size:"xs"}),r.a.createElement(o.EuiText,{color:"subdued",size:"xs","data-test-subj":"duplicate-fields-warning-message"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventFilters.warningMessage.duplicateFields",defaultMessage:"Using multiples of the same filed values can degrade Endpoint performance and/or create ineffective rules"}))),re&&r.a.createElement(r.a.Fragment,null,r.a.createElement(o.EuiHorizontalRule,null),we),r.a.createElement(o.EuiHorizontalRule,null),be)}));I.displayName="EventFiltersForm"},1550:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(2),r=a.n(n),i=a(68),o=a(39),s=a(266),l=a(470);const c=()=>document.querySelector('[tour-step="create-case-submit"]'),u=()=>{const[e,t]=Object(n.useState)(s.a.createCase),a=Object(n.useCallback)((()=>{var e;null===(e=c())||void 0===e||e.scrollIntoView()}),[]),i=Object(n.useCallback)((()=>{t(s.a.submitCase),a(),setTimeout((()=>{var e;null===(e=c())||void 0===e||e.focus()}),500)}),[a]);return r.a.createElement(r.a.Fragment,null,e===s.a.createCase&&r.a.createElement(l.a,{onClick:i,step:s.a.createCase,tourId:s.b.alertsCases}),e===s.a.submitCase&&r.a.createElement(l.a,{step:s.a.submitCase,tourId:s.b.alertsCases}))};var d=a(526),p=a(110),m=a(197);const y=({onMenuItemClick:e,ariaLabel:t,ecsData:a,nonEcsData:l,onSuccess:c,isActiveTimelines:y,isInDetections:g,refetch:f})=>{const{cases:b}=Object(p.i)().services,h=b.helpers.canUseCases([o.APP_ID]),v=Object(n.useMemo)((()=>{var e,t;return null==a||null===(e=a.event)||void 0===e||null===(t=e.kind)||void 0===t?void 0:t.includes("signal")}),[a]),E=Object(n.useMemo)((()=>{var e,t;return null!=a&&a._id?[{alertId:null!==(e=null==a?void 0:a._id)&&void 0!==e?e:"",index:null!==(t=null==a?void 0:a._index)&&void 0!==t?t:"",type:i.AttachmentType.alert,rule:b.helpers.getRuleIdFromEvent({ecs:a,data:null!=l?l:[]})}]:[]}),[b.helpers,a,l]),{activeStep:x,incrementStep:k,setStep:w,isTourShown:j}=Object(d.b)(),S=()=>{c&&c(),f&&f()},O=Object(n.useCallback)((async()=>{j(s.b.alertsCases)&&w(s.b.alertsCases,s.a.viewCase)}),[w,j]),I=Object(n.useMemo)((()=>!j(s.b.alertsCases)||x!==s.a.addAlertToCase&&x!==s.a.createCase&&x!==s.a.submitCase?{}:{initialValue:s.d}),[x,j]),C=b.hooks.useCasesAddToNewCaseFlyout({onClose:e,onSuccess:S,afterCaseCreated:O,...I}),M=b.hooks.useCasesAddToExistingCaseModal({onClose:e,onSuccess:S}),T=Object(n.useCallback)((()=>{e(),C.open({attachments:E,...j(s.b.alertsCases)?{headerContent:r.a.createElement(u,null)}:{}}),j(s.b.alertsCases)&&x===s.a.addAlertToCase&&k(s.b.alertsCases)}),[e,C,E,j,x,k]),_=Object(n.useCallback)((()=>{e(),M.open({getAttachments:()=>E})}),[E,e,M]);return{addToCaseActionItems:Object(n.useMemo)((()=>(y||g)&&h.create&&h.read&&v?[{"aria-label":t,"data-test-subj":"add-to-existing-case-action",key:"add-to-existing-case-action",onClick:_,size:"s",name:m.k},{"aria-label":t,"data-test-subj":"add-to-new-case-action",key:"add-to-new-case-action",onClick:T,size:"s",name:m.l}]:[]),[t,_,T,h.create,h.read,g,y,v]),handleAddToNewCaseClick:T,handleAddToExistingCaseClick:_}}},1552:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),r=a(744),i=a(186),o=a(5);const s=o.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.notSupportedTooltip",{defaultMessage:"Add the Elastic Defend integration via Elastic Agent to enable this feature"}),l=o.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.unenrolledTooltip",{defaultMessage:"Host is no longer enrolled with the Elastic Defend integration"}),c=o.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.loadingTooltip",{defaultMessage:"Loading"}),u=o.i18n.translate("xpack.securitySolution.endpoint.detections.takeAction.responseActionConsole.generalMetadataErrorTooltip",{defaultMessage:"Failed to retrieve Endpoint metadata"}),d=({endpointId:e,onClick:t})=>{const a=Object(r.d)(),{data:o,isFetching:d,error:p}=Object(r.c)(e,{enabled:Boolean(e)}),[m,y]=Object(n.useMemo)((()=>{var e,t,a;return d?[!0,c]:p&&404===(null===(e=p.body)||void 0===e?void 0:e.statusCode)?[!0,s]:p&&400===(null===(t=p.body)||void 0===t?void 0:t.statusCode)&&null!==(a=p.body)&&void 0!==a&&a.message.includes("unenrolled")||(null==o?void 0:o.host_status)===i.c.UNENROLLED?[!0,l]:p?[!0,u]:[!1,void 0]}),[o,p,d]);return{handleResponseActionsClick:Object(n.useCallback)((()=>{o&&a(o.metadata),t&&t()}),[o,t,a]),isDisabled:m,tooltip:y}}},1553:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var n=a(139);const r=["endpoint_list"],i=e=>!!r.find((t=>t===e.list_id)),o=e=>n.o.is(e)},1554:function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(23),r=a.n(n),i=a(2),o=a.n(i),s=a(17),l=a(44),c=a.n(l),u=a(47),d=a(51),p=a(115),m=a(178);const y=c.a.div.withConfig({displayName:"RootContainer",componentId:"sc-ptw6hp-0"})(["position:relative;padding-top:",";.body{min-height:",";&-content{position:relative;}}"],(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeXXL)),g=Object(i.memo)((({"data-test-subj":e})=>o.a.createElement(s.EuiEmptyPrompt,{"data-test-subj":e,title:o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.endpoint.paginatedContent.noItemsFoundTitle",defaultMessage:"No items found"})})));g.displayName="DefaultNoItemsFound";const f=Object(i.memo)((({message:e,"data-test-subj":t})=>o.a.createElement(s.EuiText,{textAlign:"center","data-test-subj":t},o.a.createElement(s.EuiSpacer,{size:"m"}),o.a.createElement(s.EuiIcon,{type:"minusInCircle",color:"danger"})," ",e,o.a.createElement(s.EuiSpacer,{size:"m"}))));f.displayName="ErrorMessage";const b=Object(i.memo)((({items:e,ItemComponent:t,itemComponentProps:a,itemId:n,onChange:l,pagination:c,loading:u,noItemsMessage:b,error:h,contentClassName:v,"data-test-subj":E,"aria-label":x,className:k,children:w})=>{const[j]=Object(i.useState)(new WeakMap),S=Object(p.a)(E),O=Object(i.useMemo)((()=>Math.ceil(((null==c?void 0:c.totalItemCount)||1)/((null==c?void 0:c.pageSize)||1))),[null==c?void 0:c.pageSize,null==c?void 0:c.totalItemCount]);Object(i.useEffect)((()=>{!u&&O>0&&O<((null==c?void 0:c.pageIndex)||0)+1&&l({pageIndex:O-1,pageSize:(null==c?void 0:c.pageSize)||0})}),[O,l,c,u]);const I=Object(i.useCallback)((e=>{if(null!=c&&c.pageIndex){var t,a;const n=Math.floor((null!==(t=null==c?void 0:c.pageIndex)&&void 0!==t?t:m.b)*(null!==(a=null==c?void 0:c.pageSize)&&void 0!==a?a:m.c)/e);l({pageSize:e,pageIndex:isNaN(n)?m.b:n})}else l({pageSize:e,pageIndex:m.b})}),[l,c]),C=Object(i.useCallback)((e=>{l({pageIndex:e,pageSize:(null==c?void 0:c.pageSize)||m.c})}),[l,null==c?void 0:c.pageSize]),M=Object(i.useMemo)((()=>{if(h)return h instanceof Error?o.a.createElement(f,{message:h.message,"data-test-subj":S("error")}):"string"==typeof h?o.a.createElement(f,{message:h,"data-test-subj":S("error")}):h;const i=t;return e.length?e.map((e=>{let t;return n?t=e[n]:j.has(e)?t=j.get(e):(t=Object(d.v4)(),j.set(e,t)),o.a.createElement(i,r()({},a(e),{key:t}))})):u?void 0:b||o.a.createElement(g,{"data-test-subj":S("noResults")})}),[t,h,S,a,n,j,e,b,u]);return o.a.createElement(y,{"data-test-subj":E,"aria-label":x,className:k},u&&o.a.createElement(s.EuiProgress,{size:"xs",color:"primary",position:"absolute","data-test-subj":S("loader")}),o.a.createElement("div",{className:"body","data-test-subj":S("body")},o.a.createElement("div",{className:`body-content ${v}`},w||M)),c&&(w||e.length>0)&&o.a.createElement("div",{"data-test-subj":S("footer")},o.a.createElement(s.EuiSpacer,{size:"l"}),o.a.createElement(s.EuiTablePagination,{activePage:c.pageIndex,itemsPerPage:c.pageSize,itemsPerPageOptions:c.pageSizeOptions,pageCount:O,showPerPageOptions:c.showPerPageOptions,onChangeItemsPerPage:I,onChangePage:C})))}));b.displayName="PaginatedContent"},1605:function(e,t){},1606:function(e,t,a){(function(e){function a(e,t){for(var a=0,n=e.length-1;n>=0;n--){var r=e[n];"."===r?e.splice(n,1):".."===r?(e.splice(n,1),a++):a&&(e.splice(n,1),a--)}if(t)for(;a--;a)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var a=[],n=0;n<e.length;n++)t(e[n],n,e)&&a.push(e[n]);return a}t.resolve=function(){for(var t="",r=!1,i=arguments.length-1;i>=-1&&!r;i--){var o=i>=0?arguments[i]:e.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,r="/"===o.charAt(0))}return(r?"/":"")+(t=a(n(t.split("/"),(function(e){return!!e})),!r).join("/"))||"."},t.normalize=function(e){var i=t.isAbsolute(e),o="/"===r(e,-1);return(e=a(n(e.split("/"),(function(e){return!!e})),!i).join("/"))||i||(e="."),e&&o&&(e+="/"),(i?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,a){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var a=e.length-1;a>=0&&""===e[a];a--);return t>a?[]:e.slice(t,a-t+1)}e=t.resolve(e).substr(1),a=t.resolve(a).substr(1);for(var r=n(e.split("/")),i=n(a.split("/")),o=Math.min(r.length,i.length),s=o,l=0;l<o;l++)if(r[l]!==i[l]){s=l;break}var c=[];for(l=s;l<r.length;l++)c.push("..");return(c=c.concat(i.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),a=47===t,n=-1,r=!0,i=e.length-1;i>=1;--i)if(47===(t=e.charCodeAt(i))){if(!r){n=i;break}}else r=!1;return-1===n?a?"/":".":a&&1===n?"/":e.slice(0,n)},t.basename=function(e,t){var a=function(e){"string"!=typeof e&&(e+="");var t,a=0,n=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){a=t+1;break}}else-1===n&&(r=!1,n=t+1);return-1===n?"":e.slice(a,n)}(e);return t&&a.substr(-1*t.length)===t&&(a=a.substr(0,a.length-t.length)),a},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,a=0,n=-1,r=!0,i=0,o=e.length-1;o>=0;--o){var s=e.charCodeAt(o);if(47!==s)-1===n&&(r=!1,n=o+1),46===s?-1===t?t=o:1!==i&&(i=1):-1!==t&&(i=-1);else if(!r){a=o+1;break}}return-1===t||-1===n||0===i||1===i&&t===n-1&&t===a+1?"":e.slice(t,n)};var r="b"==="ab".substr(-1)?function(e,t,a){return e.substr(t,a)}:function(e,t,a){return t<0&&(t=e.length+t),e.substr(t,a)}}).call(this,a(391))},1607:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(0),r=a.n(n);const i="".padStart(2);class LineWriter{constructor(e="\n"){r()(this,"_indent",""),r()(this,"_lines",[]),r()(this,"_separator",void 0),this._indent="",this._lines=[],this._separator=e}addLine(e){this._lines.push(`${this._indent}${e}`)}addLineAndIndent(e){this._lines.push(`${this._indent}${e}`),this._indent=`${this._indent}${i}`}dedentAndAddLine(e){this._indent=this._indent.substr(2),this._lines.push(`${this._indent}${e}`)}indent(){this._indent=`${this._indent}${i}`}dedent(){this._indent=this._indent.substr(2)}getContent(){return this._lines.join(this._separator)}}const o=(e="\n")=>new LineWriter(e)},1608:function(e,t,a){e.exports=a.p+"94cccf20036d014924e63d4d595e88e1.svg"},1613:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),r=a(67),i=function(e,t){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])},i(e,t)};function o(e,t){function a(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}var s=function(){return s=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},s.apply(this,arguments)},l={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},c={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},u={width:"20px",height:"20px",position:"absolute"},d={top:s(s({},l),{top:"-5px"}),right:s(s({},c),{left:void 0,right:"-5px"}),bottom:s(s({},l),{top:void 0,bottom:"-5px"}),left:s(s({},c),{left:"-5px"}),topRight:s(s({},u),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:s(s({},u),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:s(s({},u),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:s(s({},u),{left:"-10px",top:"-10px",cursor:"nw-resize"})},p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return o(t,e),t.prototype.render=function(){return n.createElement("div",{className:this.props.className||"",style:s(s({position:"absolute",userSelect:"none"},d[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(n.PureComponent),m={width:"auto",height:"auto"},y=function(e,t,a){return Math.max(Math.min(e,a),t)},g=function(e,t){return Math.round(e/t)*t},f=function(e,t){return new RegExp(e,"i").test(t)},b=function(e){return Boolean(e.touches&&e.touches.length)},h=function(e,t,a){void 0===a&&(a=0);var n=t.reduce((function(a,n,r){return Math.abs(n-e)<Math.abs(t[a]-e)?r:a}),0),r=Math.abs(t[n]-e);return 0===a||r<a?t[n]:e},v=function(e){return"auto"===(e=e.toString())||e.endsWith("px")||e.endsWith("%")||e.endsWith("vh")||e.endsWith("vw")||e.endsWith("vmax")||e.endsWith("vmin")?e:e+"px"},E=function(e,t,a,n){if(e&&"string"==typeof e){if(e.endsWith("px"))return Number(e.replace("px",""));if(e.endsWith("%"))return t*(Number(e.replace("%",""))/100);if(e.endsWith("vw"))return a*(Number(e.replace("vw",""))/100);if(e.endsWith("vh"))return n*(Number(e.replace("vh",""))/100)}return e},x=["as","style","className","grid","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],k="__resizable_base__",w=function(e){function t(t){var a=e.call(this,t)||this;return a.ratio=1,a.resizable=null,a.parentLeft=0,a.parentTop=0,a.resizableLeft=0,a.resizableRight=0,a.resizableTop=0,a.resizableBottom=0,a.targetLeft=0,a.targetTop=0,a.appendBase=function(){if(!a.resizable||!a.window)return null;var e=a.parentNode;if(!e)return null;var t=a.window.document.createElement("div");return t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.transform="scale(0, 0)",t.style.left="0",t.style.flex="0 0 100%",t.classList?t.classList.add(k):t.className+=k,e.appendChild(t),t},a.removeBase=function(e){var t=a.parentNode;t&&t.removeChild(e)},a.ref=function(e){e&&(a.resizable=e)},a.state={isResizing:!1,width:void 0===(a.propsSize&&a.propsSize.width)?"auto":a.propsSize&&a.propsSize.width,height:void 0===(a.propsSize&&a.propsSize.height)?"auto":a.propsSize&&a.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},a.onResizeStart=a.onResizeStart.bind(a),a.onMouseMove=a.onMouseMove.bind(a),a.onMouseUp=a.onMouseUp.bind(a),a}return o(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||m},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var a=this.resizable.offsetWidth,n=this.resizable.offsetHeight,r=this.resizable.style.position;"relative"!==r&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:a,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:n,this.resizable.style.position=r}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,a=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&e.propsSize[t].toString().endsWith("%")){if(e.state[t].toString().endsWith("%"))return e.state[t].toString();var a=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/a[t]*100+"%"}return v(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?v(t.width):a("width"),height:t&&void 0!==t.height&&!this.state.isResizing?v(t.height):a("height")}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=this.appendBase();if(!e)return{width:0,height:0};var t=!1,a=this.parentNode.style.flexWrap;"wrap"!==a&&(t=!0,this.parentNode.style.flexWrap="wrap"),e.style.position="relative",e.style.minWidth="100%",e.style.minHeight="100%";var n={width:e.offsetWidth,height:e.offsetHeight};return t&&(this.parentNode.style.flexWrap=a),this.removeBase(e),n},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(this.resizable&&this.window){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0})}},t.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},t.prototype.createSizeForCssProperty=function(e,t){var a=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==a&&"auto"!==a?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){var a,n,r=this.props.boundsByDirection,i=this.state.direction,o=r&&f("left",i),s=r&&f("top",i);if("parent"===this.props.bounds){var l=this.parentNode;l&&(a=o?this.resizableRight-this.parentLeft:l.offsetWidth+(this.parentLeft-this.resizableLeft),n=s?this.resizableBottom-this.parentTop:l.offsetHeight+(this.parentTop-this.resizableTop))}else"window"===this.props.bounds?this.window&&(a=o?this.resizableRight:this.window.innerWidth-this.resizableLeft,n=s?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(a=o?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),n=s?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return a&&Number.isFinite(a)&&(e=e&&e<a?e:a),n&&Number.isFinite(n)&&(t=t&&t<n?t:n),{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var a=this.props.scale||1,n=this.props.resizeRatio||1,r=this.state,i=r.direction,o=r.original,s=this.props,l=s.lockAspectRatio,c=s.lockAspectRatioExtraHeight,u=s.lockAspectRatioExtraWidth,d=o.width,p=o.height,m=c||0,y=u||0;return f("right",i)&&(d=o.width+(e-o.x)*n/a,l&&(p=(d-y)/this.ratio+m)),f("left",i)&&(d=o.width-(e-o.x)*n/a,l&&(p=(d-y)/this.ratio+m)),f("bottom",i)&&(p=o.height+(t-o.y)*n/a,l&&(d=(p-m)*this.ratio+y)),f("top",i)&&(p=o.height-(t-o.y)*n/a,l&&(d=(p-m)*this.ratio+y)),{newWidth:d,newHeight:p}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,a,n){var r=this.props,i=r.lockAspectRatio,o=r.lockAspectRatioExtraHeight,s=r.lockAspectRatioExtraWidth,l=void 0===n.width?10:n.width,c=void 0===a.width||a.width<0?e:a.width,u=void 0===n.height?10:n.height,d=void 0===a.height||a.height<0?t:a.height,p=o||0,m=s||0;if(i){var g=(u-p)*this.ratio+m,f=(d-p)*this.ratio+m,b=(l-m)/this.ratio+p,h=(c-m)/this.ratio+p,v=Math.max(l,g),E=Math.min(c,f),x=Math.max(u,b),k=Math.min(d,h);e=y(e,v,E),t=y(t,x,k)}else e=y(e,l,c),t=y(t,u,d);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds&&"string"!=typeof this.props.bounds){var a=this.props.bounds.getBoundingClientRect();this.targetLeft=a.left,this.targetTop=a.top}if(this.resizable){var n=this.resizable.getBoundingClientRect(),r=n.left,i=n.top,o=n.right,s=n.bottom;this.resizableLeft=r,this.resizableRight=o,this.resizableTop=i,this.resizableBottom=s}},t.prototype.onResizeStart=function(e,t){if(this.resizable&&this.window){var a,n=0,r=0;if(e.nativeEvent&&function(e){return Boolean((e.clientX||0===e.clientX)&&(e.clientY||0===e.clientY))}(e.nativeEvent)?(n=e.nativeEvent.clientX,r=e.nativeEvent.clientY):e.nativeEvent&&b(e.nativeEvent)&&(n=e.nativeEvent.touches[0].clientX,r=e.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable&&!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var i=this.window.getComputedStyle(this.resizable);if("auto"!==i.flexBasis){var o=this.parentNode;if(o){var l=this.window.getComputedStyle(o).flexDirection;this.flexDir=l.startsWith("row")?"row":"column",a=i.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var c={original:{x:n,y:r,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:s(s({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:a};this.setState(c)}},t.prototype.onMouseMove=function(e){var t=this;if(this.state.isResizing&&this.resizable&&this.window){if(this.window.TouchEvent&&b(e))try{e.preventDefault(),e.stopPropagation()}catch(e){}var a=this.props,n=a.maxWidth,i=a.maxHeight,o=a.minWidth,s=a.minHeight,l=b(e)?e.touches[0].clientX:e.clientX,c=b(e)?e.touches[0].clientY:e.clientY,u=this.state,d=u.direction,p=u.original,m=u.width,y=u.height,f=this.getParentSize(),v=function(e,t,a,n,r,i,o){return n=E(n,e.width,t,a),r=E(r,e.height,t,a),i=E(i,e.width,t,a),o=E(o,e.height,t,a),{maxWidth:void 0===n?void 0:Number(n),maxHeight:void 0===r?void 0:Number(r),minWidth:void 0===i?void 0:Number(i),minHeight:void 0===o?void 0:Number(o)}}(f,this.window.innerWidth,this.window.innerHeight,n,i,o,s);n=v.maxWidth,i=v.maxHeight,o=v.minWidth,s=v.minHeight;var x=this.calculateNewSizeFromDirection(l,c),k=x.newHeight,w=x.newWidth,j=this.calculateNewMaxFromBoundary(n,i);this.props.snap&&this.props.snap.x&&(w=h(w,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(k=h(k,this.props.snap.y,this.props.snapGap));var S=this.calculateNewSizeFromAspectRatio(w,k,{width:j.maxWidth,height:j.maxHeight},{width:o,height:s});if(w=S.newWidth,k=S.newHeight,this.props.grid){var O=g(w,this.props.grid[0]),I=g(k,this.props.grid[1]),C=this.props.snapGap||0;w=0===C||Math.abs(O-w)<=C?O:w,k=0===C||Math.abs(I-k)<=C?I:k}var M={width:w-p.width,height:k-p.height};m&&"string"==typeof m&&(m.endsWith("%")?w=w/f.width*100+"%":m.endsWith("vw")?w=w/this.window.innerWidth*100+"vw":m.endsWith("vh")&&(w=w/this.window.innerHeight*100+"vh")),y&&"string"==typeof y&&(y.endsWith("%")?k=k/f.height*100+"%":y.endsWith("vw")?k=k/this.window.innerWidth*100+"vw":y.endsWith("vh")&&(k=k/this.window.innerHeight*100+"vh"));var T={width:this.createSizeForCssProperty(w,"width"),height:this.createSizeForCssProperty(k,"height")};"row"===this.flexDir?T.flexBasis=T.width:"column"===this.flexDir&&(T.flexBasis=T.height),r.flushSync((function(){t.setState(T)})),this.props.onResize&&this.props.onResize(e,d,this.resizable,M)}},t.prototype.onMouseUp=function(e){var t=this.state,a=t.isResizing,n=t.direction,r=t.original;if(a&&this.resizable){var i={width:this.size.width-r.width,height:this.size.height-r.height};this.props.onResizeStop&&this.props.onResizeStop(e,n,this.resizable,i),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:s(s({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,a=t.enable,r=t.handleStyles,i=t.handleClasses,o=t.handleWrapperStyle,s=t.handleWrapperClass,l=t.handleComponent;if(!a)return null;var c=Object.keys(a).map((function(t){return!1!==a[t]?n.createElement(p,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:r&&r[t],className:i&&i[t]},l&&l[t]?l[t]:null):null}));return n.createElement("div",{className:s,style:o},c)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,a){return-1!==x.indexOf(a)||(t[a]=e.props[a]),t}),{}),a=s(s(s({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(a.flexBasis=this.state.flexBasis);var r=this.props.as||"div";return n.createElement(r,s({ref:this.ref,style:a,className:this.props.className},t),this.state.isResizing&&n.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(n.PureComponent);t.Resizable=w},1620:function(e,t,a){!function(e,t,a,n,r,i){"use strict";function o(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}function s(e,t){switch(arguments.length){case 0:break;case 1:"function"==typeof e?this.interpolator(e):this.range(e);break;default:this.domain(e),"function"==typeof t?this.interpolator(t):this.range(t)}return this}const l=Symbol("implicit");function c(){var e=new Map,t=[],a=[],n=l;function r(r){var i=r+"",o=e.get(i);if(!o){if(n!==l)return n;e.set(i,o=t.push(r))}return a[(o-1)%a.length]}return r.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new Map;for(const n of a){const a=n+"";e.has(a)||e.set(a,t.push(n))}return r},r.range=function(e){return arguments.length?(a=Array.from(e),r):a.slice()},r.unknown=function(e){return arguments.length?(n=e,r):n},r.copy=function(){return c(t,a).unknown(n)},o.apply(r,arguments),r}function u(){var e,a,n=c().unknown(void 0),r=n.domain,i=n.range,s=0,l=1,d=!1,p=0,m=0,y=.5;function g(){var n=r().length,o=l<s,c=o?l:s,u=o?s:l;e=(u-c)/Math.max(1,n-p+2*m),d&&(e=Math.floor(e)),c+=(u-c-e*(n-p))*y,a=e*(1-p),d&&(c=Math.round(c),a=Math.round(a));var g=t.range(n).map((function(t){return c+e*t}));return i(o?g.reverse():g)}return delete n.unknown,n.domain=function(e){return arguments.length?(r(e),g()):r()},n.range=function(e){return arguments.length?([s,l]=e,s=+s,l=+l,g()):[s,l]},n.rangeRound=function(e){return[s,l]=e,s=+s,l=+l,d=!0,g()},n.bandwidth=function(){return a},n.step=function(){return e},n.round=function(e){return arguments.length?(d=!!e,g()):d},n.padding=function(e){return arguments.length?(p=Math.min(1,m=+e),g()):p},n.paddingInner=function(e){return arguments.length?(p=Math.min(1,e),g()):p},n.paddingOuter=function(e){return arguments.length?(m=+e,g()):m},n.align=function(e){return arguments.length?(y=Math.max(0,Math.min(1,e)),g()):y},n.copy=function(){return u(r(),[s,l]).round(d).paddingInner(p).paddingOuter(m).align(y)},o.apply(g(),arguments)}function d(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return d(t())},e}function p(e){return+e}var m=[0,1];function y(e){return e}function g(e,t){return(t-=e=+e)?function(a){return(a-e)/t}:(a=isNaN(t)?NaN:.5,function(){return a});var a}function f(e,t,a){var n=e[0],r=e[1],i=t[0],o=t[1];return r<n?(n=g(r,n),i=a(o,i)):(n=g(n,r),i=a(i,o)),function(e){return i(n(e))}}function b(e,a,n){var r=Math.min(e.length,a.length)-1,i=new Array(r),o=new Array(r),s=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),a=a.slice().reverse());++s<r;)i[s]=g(e[s],e[s+1]),o[s]=n(a[s],a[s+1]);return function(a){var n=t.bisect(e,a,1,r)-1;return o[n](i[n](a))}}function h(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function v(){var e,t,n,r,i,o,s=m,l=m,c=a.interpolate,u=y;function d(){var e,t,a,n=Math.min(s.length,l.length);return u!==y&&(e=s[0],t=s[n-1],e>t&&(a=e,e=t,t=a),u=function(a){return Math.max(e,Math.min(t,a))}),r=n>2?b:f,i=o=null,g}function g(t){return null==t||isNaN(t=+t)?n:(i||(i=r(s.map(e),l,c)))(e(u(t)))}return g.invert=function(n){return u(t((o||(o=r(l,s.map(e),a.interpolateNumber)))(n)))},g.domain=function(e){return arguments.length?(s=Array.from(e,p),d()):s.slice()},g.range=function(e){return arguments.length?(l=Array.from(e),d()):l.slice()},g.rangeRound=function(e){return l=Array.from(e),c=a.interpolateRound,d()},g.clamp=function(e){return arguments.length?(u=!!e||y,d()):u!==y},g.interpolate=function(e){return arguments.length?(c=e,d()):c},g.unknown=function(e){return arguments.length?(n=e,g):n},function(a,n){return e=a,t=n,d()}}function E(){return v()(y,y)}function x(e,a,r,i){var o,s=t.tickStep(e,a,r);switch((i=n.formatSpecifier(null==i?",f":i)).type){case"s":var l=Math.max(Math.abs(e),Math.abs(a));return null!=i.precision||isNaN(o=n.precisionPrefix(s,l))||(i.precision=o),n.formatPrefix(i,l);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(o=n.precisionRound(s,Math.max(Math.abs(e),Math.abs(a))))||(i.precision=o-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(o=n.precisionFixed(s))||(i.precision=o-2*("%"===i.type))}return n.format(i)}function k(e){var a=e.domain;return e.ticks=function(e){var n=a();return t.ticks(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,t){var n=a();return x(n[0],n[n.length-1],null==e?10:e,t)},e.nice=function(n){null==n&&(n=10);var r,i,o=a(),s=0,l=o.length-1,c=o[s],u=o[l],d=10;for(u<c&&(i=c,c=u,u=i,i=s,s=l,l=i);d-- >0;){if((i=t.tickIncrement(c,u,n))===r)return o[s]=c,o[l]=u,a(o);if(i>0)c=Math.floor(c/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,u=Math.floor(u*i)/i}r=i}return e},e}function w(e,t){var a,n=0,r=(e=e.slice()).length-1,i=e[n],o=e[r];return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),e[n]=t.floor(i),e[r]=t.ceil(o),e}function j(e){return Math.log(e)}function S(e){return Math.exp(e)}function O(e){return-Math.log(-e)}function I(e){return-Math.exp(-e)}function C(e){return isFinite(e)?+("1e"+e):e<0?0:e}function M(e){return function(t){return-e(-t)}}function T(e){var a,r,i=e(j,S),o=i.domain,s=10;function l(){return a=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}(s),r=function(e){return 10===e?C:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}(s),o()[0]<0?(a=M(a),r=M(r),e(O,I)):e(j,S),i}return i.base=function(e){return arguments.length?(s=+e,l()):s},i.domain=function(e){return arguments.length?(o(e),l()):o()},i.ticks=function(e){var n,i=o(),l=i[0],c=i[i.length-1];(n=c<l)&&(m=l,l=c,c=m);var u,d,p,m=a(l),y=a(c),g=null==e?10:+e,f=[];if(!(s%1)&&y-m<g){if(m=Math.floor(m),y=Math.ceil(y),l>0){for(;m<=y;++m)for(d=1,u=r(m);d<s;++d)if(!((p=u*d)<l)){if(p>c)break;f.push(p)}}else for(;m<=y;++m)for(d=s-1,u=r(m);d>=1;--d)if(!((p=u*d)<l)){if(p>c)break;f.push(p)}2*f.length<g&&(f=t.ticks(l,c,g))}else f=t.ticks(m,y,Math.min(y-m,g)).map(r);return n?f.reverse():f},i.tickFormat=function(e,t){if(null==t&&(t=10===s?".0e":","),"function"!=typeof t&&(t=n.format(t)),e===1/0)return t;null==e&&(e=10);var o=Math.max(1,s*e/i.ticks().length);return function(e){var n=e/r(Math.round(a(e)));return n*s<s-.5&&(n*=s),n<=o?t(e):""}},i.nice=function(){return o(w(o(),{floor:function(e){return r(Math.floor(a(e)))},ceil:function(e){return r(Math.ceil(a(e)))}}))},i}function _(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function N(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function D(e){var t=1,a=e(_(t),N(t));return a.constant=function(a){return arguments.length?e(_(t=+a),N(t)):t},k(a)}function A(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function q(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function F(e){return e<0?-e*e:e*e}function L(e){var t=e(y,y),a=1;return t.exponent=function(t){return arguments.length?1===(a=+t)?e(y,y):.5===a?e(q,F):e(A(a),A(1/a)):a},k(t)}function R(){var e=L(v());return e.copy=function(){return h(e,R()).exponent(e.exponent())},o.apply(e,arguments),e}function P(e){return Math.sign(e)*e*e}function z(e){return new Date(e)}function B(e){return e instanceof Date?+e:+new Date(+e)}function G(e,t,a,n,r,i,o,s,l,c){var u=E(),d=u.invert,p=u.domain,m=c(".%L"),y=c(":%S"),g=c("%I:%M"),f=c("%I %p"),b=c("%a %d"),v=c("%b %d"),x=c("%B"),k=c("%Y");function j(e){return(l(e)<e?m:s(e)<e?y:o(e)<e?g:i(e)<e?f:n(e)<e?r(e)<e?b:v:a(e)<e?x:k)(e)}return u.invert=function(e){return new Date(d(e))},u.domain=function(e){return arguments.length?p(Array.from(e,B)):p().map(z)},u.ticks=function(t){var a=p();return e(a[0],a[a.length-1],null==t?10:t)},u.tickFormat=function(e,t){return null==t?j:c(t)},u.nice=function(e){var a=p();return e&&"function"==typeof e.range||(e=t(a[0],a[a.length-1],null==e?10:e)),e?p(w(a,e)):u},u.copy=function(){return h(u,G(e,t,a,n,r,i,o,s,l,c))},u}function $(){var e,t,n,r,i,o=0,s=1,l=y,c=!1;function u(t){return null==t||isNaN(t=+t)?i:l(0===n?.5:(t=(r(t)-e)*n,c?Math.max(0,Math.min(1,t)):t))}function d(e){return function(t){var a,n;return arguments.length?([a,n]=t,l=e(a,n),u):[l(0),l(1)]}}return u.domain=function(a){return arguments.length?([o,s]=a,e=r(o=+o),t=r(s=+s),n=e===t?0:1/(t-e),u):[o,s]},u.clamp=function(e){return arguments.length?(c=!!e,u):c},u.interpolator=function(e){return arguments.length?(l=e,u):l},u.range=d(a.interpolate),u.rangeRound=d(a.interpolateRound),u.unknown=function(e){return arguments.length?(i=e,u):i},function(a){return r=a,e=a(o),t=a(s),n=e===t?0:1/(t-e),u}}function H(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function V(){var e=L($());return e.copy=function(){return H(e,V()).exponent(e.exponent())},s.apply(e,arguments)}function U(){var e,t,n,r,i,o,s,l=0,c=.5,u=1,d=1,p=y,m=!1;function g(e){return isNaN(e=+e)?s:(e=.5+((e=+o(e))-t)*(d*e<d*t?r:i),p(m?Math.max(0,Math.min(1,e)):e))}function f(e){return function(t){var n,r,i;return arguments.length?([n,r,i]=t,p=a.piecewise(e,[n,r,i]),g):[p(0),p(.5),p(1)]}}return g.domain=function(a){return arguments.length?([l,c,u]=a,e=o(l=+l),t=o(c=+c),n=o(u=+u),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),d=t<e?-1:1,g):[l,c,u]},g.clamp=function(e){return arguments.length?(m=!!e,g):m},g.interpolator=function(e){return arguments.length?(p=e,g):p},g.range=f(a.interpolate),g.rangeRound=f(a.interpolateRound),g.unknown=function(e){return arguments.length?(s=e,g):s},function(a){return o=a,e=a(l),t=a(c),n=a(u),r=e===t?0:.5/(t-e),i=t===n?0:.5/(n-t),d=t<e?-1:1,g}}function W(){var e=L(U());return e.copy=function(){return H(e,W()).exponent(e.exponent())},s.apply(e,arguments)}e.scaleBand=u,e.scaleDiverging=function e(){var t=k(U()(y));return t.copy=function(){return H(t,e())},s.apply(t,arguments)},e.scaleDivergingLog=function e(){var t=T(U()).domain([.1,1,10]);return t.copy=function(){return H(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleDivergingPow=W,e.scaleDivergingSqrt=function(){return W.apply(null,arguments).exponent(.5)},e.scaleDivergingSymlog=function e(){var t=D(U());return t.copy=function(){return H(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleIdentity=function e(t){var a;function n(e){return null==e||isNaN(e=+e)?a:e}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=Array.from(e,p),n):t.slice()},n.unknown=function(e){return arguments.length?(a=e,n):a},n.copy=function(){return e(t).unknown(a)},t=arguments.length?Array.from(t,p):[0,1],k(n)},e.scaleImplicit=l,e.scaleLinear=function e(){var t=E();return t.copy=function(){return h(t,e())},o.apply(t,arguments),k(t)},e.scaleLog=function e(){var t=T(v()).domain([1,10]);return t.copy=function(){return h(t,e()).base(t.base())},o.apply(t,arguments),t},e.scaleOrdinal=c,e.scalePoint=function(){return d(u.apply(null,arguments).paddingInner(1))},e.scalePow=R,e.scaleQuantile=function e(){var a,n=[],r=[],i=[];function s(){var e=0,a=Math.max(1,r.length);for(i=new Array(a-1);++e<a;)i[e-1]=t.quantileSorted(n,e/a);return l}function l(e){return null==e||isNaN(e=+e)?a:r[t.bisect(i,e)]}return l.invertExtent=function(e){var t=r.indexOf(e);return t<0?[NaN,NaN]:[t>0?i[t-1]:n[0],t<i.length?i[t]:n[n.length-1]]},l.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(t.ascending),s()},l.range=function(e){return arguments.length?(r=Array.from(e),s()):r.slice()},l.unknown=function(e){return arguments.length?(a=e,l):a},l.quantiles=function(){return i.slice()},l.copy=function(){return e().domain(n).range(r).unknown(a)},o.apply(l,arguments)},e.scaleQuantize=function e(){var a,n=0,r=1,i=1,s=[.5],l=[0,1];function c(e){return null!=e&&e<=e?l[t.bisect(s,e,0,i)]:a}function u(){var e=-1;for(s=new Array(i);++e<i;)s[e]=((e+1)*r-(e-i)*n)/(i+1);return c}return c.domain=function(e){return arguments.length?([n,r]=e,n=+n,r=+r,u()):[n,r]},c.range=function(e){return arguments.length?(i=(l=Array.from(e)).length-1,u()):l.slice()},c.invertExtent=function(e){var t=l.indexOf(e);return t<0?[NaN,NaN]:t<1?[n,s[0]]:t>=i?[s[i-1],r]:[s[t-1],s[t]]},c.unknown=function(e){return arguments.length?(a=e,c):c},c.thresholds=function(){return s.slice()},c.copy=function(){return e().domain([n,r]).range(l).unknown(a)},o.apply(k(c),arguments)},e.scaleRadial=function e(){var t,a=E(),n=[0,1],r=!1;function i(e){var n=function(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}(a(e));return isNaN(n)?t:r?Math.round(n):n}return i.invert=function(e){return a.invert(P(e))},i.domain=function(e){return arguments.length?(a.domain(e),i):a.domain()},i.range=function(e){return arguments.length?(a.range((n=Array.from(e,p)).map(P)),i):n.slice()},i.rangeRound=function(e){return i.range(e).round(!0)},i.round=function(e){return arguments.length?(r=!!e,i):r},i.clamp=function(e){return arguments.length?(a.clamp(e),i):a.clamp()},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return e(a.domain(),n).round(r).clamp(a.clamp()).unknown(t)},o.apply(i,arguments),k(i)},e.scaleSequential=function e(){var t=k($()(y));return t.copy=function(){return H(t,e())},s.apply(t,arguments)},e.scaleSequentialLog=function e(){var t=T($()).domain([1,10]);return t.copy=function(){return H(t,e()).base(t.base())},s.apply(t,arguments)},e.scaleSequentialPow=V,e.scaleSequentialQuantile=function e(){var a=[],n=y;function r(e){if(null!=e&&!isNaN(e=+e))return n((t.bisect(a,e,1)-1)/(a.length-1))}return r.domain=function(e){if(!arguments.length)return a.slice();a=[];for(let t of e)null==t||isNaN(t=+t)||a.push(t);return a.sort(t.ascending),r},r.interpolator=function(e){return arguments.length?(n=e,r):n},r.range=function(){return a.map(((e,t)=>n(t/(a.length-1))))},r.quantiles=function(e){return Array.from({length:e+1},((n,r)=>t.quantile(a,r/e)))},r.copy=function(){return e(n).domain(a)},s.apply(r,arguments)},e.scaleSequentialSqrt=function(){return V.apply(null,arguments).exponent(.5)},e.scaleSequentialSymlog=function e(){var t=D($());return t.copy=function(){return H(t,e()).constant(t.constant())},s.apply(t,arguments)},e.scaleSqrt=function(){return R.apply(null,arguments).exponent(.5)},e.scaleSymlog=function e(){var t=D(v());return t.copy=function(){return h(t,e()).constant(t.constant())},o.apply(t,arguments)},e.scaleThreshold=function e(){var a,n=[.5],r=[0,1],i=1;function s(e){return null!=e&&e<=e?r[t.bisect(n,e,0,i)]:a}return s.domain=function(e){return arguments.length?(n=Array.from(e),i=Math.min(n.length,r.length-1),s):n.slice()},s.range=function(e){return arguments.length?(r=Array.from(e),i=Math.min(n.length,r.length-1),s):r.slice()},s.invertExtent=function(e){var t=r.indexOf(e);return[n[t-1],n[t]]},s.unknown=function(e){return arguments.length?(a=e,s):a},s.copy=function(){return e().domain(n).range(r).unknown(a)},o.apply(s,arguments)},e.scaleTime=function(){return o.apply(G(r.timeTicks,r.timeTickInterval,r.timeYear,r.timeMonth,r.timeWeek,r.timeDay,r.timeHour,r.timeMinute,r.timeSecond,i.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},e.scaleUtc=function(){return o.apply(G(r.utcTicks,r.utcTickInterval,r.utcYear,r.utcMonth,r.utcWeek,r.utcDay,r.utcHour,r.utcMinute,r.utcSecond,i.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},e.tickFormat=x,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(1497),a(1621),a(1623),a(1498),a(1624))},1621:function(e,t,a){!function(e,t){"use strict";function a(e,t,a,n,r){var i=e*e,o=i*e;return((1-3*e+3*i-o)*t+(4-6*i+3*o)*a+(1+3*e+3*i-3*o)*n+o*r)/6}function n(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[r],o=e[r+1],s=r>0?e[r-1]:2*i-o,l=r<t-1?e[r+2]:2*o-i;return a((n-r/t)*t,s,i,o,l)}}function r(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),i=e[(r+t-1)%t],o=e[r%t],s=e[(r+1)%t],l=e[(r+2)%t];return a((n-r/t)*t,i,o,s,l)}}var i=e=>()=>e;function o(e,t){return function(a){return e+a*t}}function s(e,t){var a=t-e;return a?o(e,a>180||a<-180?a-360*Math.round(a/360):a):i(isNaN(e)?t:e)}function l(e){return 1==(e=+e)?c:function(t,a){return a-t?function(e,t,a){return e=Math.pow(e,a),t=Math.pow(t,a)-e,a=1/a,function(n){return Math.pow(e+n*t,a)}}(t,a,e):i(isNaN(t)?a:t)}}function c(e,t){var a=t-e;return a?o(e,a):i(isNaN(e)?t:e)}var u=function e(a){var n=l(a);function r(e,a){var r=n((e=t.rgb(e)).r,(a=t.rgb(a)).r),i=n(e.g,a.g),o=n(e.b,a.b),s=c(e.opacity,a.opacity);return function(t){return e.r=r(t),e.g=i(t),e.b=o(t),e.opacity=s(t),e+""}}return r.gamma=e,r}(1);function d(e){return function(a){var n,r,i=a.length,o=new Array(i),s=new Array(i),l=new Array(i);for(n=0;n<i;++n)r=t.rgb(a[n]),o[n]=r.r||0,s[n]=r.g||0,l[n]=r.b||0;return o=e(o),s=e(s),l=e(l),r.opacity=1,function(e){return r.r=o(e),r.g=s(e),r.b=l(e),r+""}}}var p=d(n),m=d(r);function y(e,t){t||(t=[]);var a,n=e?Math.min(t.length,e.length):0,r=t.slice();return function(i){for(a=0;a<n;++a)r[a]=e[a]*(1-i)+t[a]*i;return r}}function g(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function f(e,t){var a,n=t?t.length:0,r=e?Math.min(n,e.length):0,i=new Array(r),o=new Array(n);for(a=0;a<r;++a)i[a]=w(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(e){for(a=0;a<r;++a)o[a]=i[a](e);return o}}function b(e,t){var a=new Date;return e=+e,t=+t,function(n){return a.setTime(e*(1-n)+t*n),a}}function h(e,t){return e=+e,t=+t,function(a){return e*(1-a)+t*a}}function v(e,t){var a,n={},r={};for(a in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)a in e?n[a]=w(e[a],t[a]):r[a]=t[a];return function(e){for(a in n)r[a]=n[a](e);return r}}var E=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,x=new RegExp(E.source,"g");function k(e,t){var a,n,r,i=E.lastIndex=x.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(a=E.exec(e))&&(n=x.exec(t));)(r=n.index)>i&&(r=t.slice(i,r),s[o]?s[o]+=r:s[++o]=r),(a=a[0])===(n=n[0])?s[o]?s[o]+=n:s[++o]=n:(s[++o]=null,l.push({i:o,x:h(a,n)})),i=x.lastIndex;return i<t.length&&(r=t.slice(i),s[o]?s[o]+=r:s[++o]=r),s.length<2?l[0]?function(e){return function(t){return e(t)+""}}(l[0].x):function(e){return function(){return e}}(t):(t=l.length,function(e){for(var a,n=0;n<t;++n)s[(a=l[n]).i]=a.x(e);return s.join("")})}function w(e,a){var n,r=typeof a;return null==a||"boolean"===r?i(a):("number"===r?h:"string"===r?(n=t.color(a))?(a=n,u):k:a instanceof t.color?u:a instanceof Date?b:g(a)?y:Array.isArray(a)?f:"function"!=typeof a.valueOf&&"function"!=typeof a.toString||isNaN(a)?v:h)(e,a)}var j,S=180/Math.PI,O={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function I(e,t,a,n,r,i){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*a+t*n)&&(a-=e*l,n-=t*l),(s=Math.sqrt(a*a+n*n))&&(a/=s,n/=s,l/=s),e*n<t*a&&(e=-e,t=-t,l=-l,o=-o),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*S,skewX:Math.atan(l)*S,scaleX:o,scaleY:s}}function C(e,t,a,n){function r(e){return e.length?e.pop()+" ":""}return function(i,o){var s=[],l=[];return i=e(i),o=e(o),function(e,n,r,i,o,s){if(e!==r||n!==i){var l=o.push("translate(",null,t,null,a);s.push({i:l-4,x:h(e,r)},{i:l-2,x:h(n,i)})}else(r||i)&&o.push("translate("+r+t+i+a)}(i.translateX,i.translateY,o.translateX,o.translateY,s,l),function(e,t,a,i){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),i.push({i:a.push(r(a)+"rotate(",null,n)-2,x:h(e,t)})):t&&a.push(r(a)+"rotate("+t+n)}(i.rotate,o.rotate,s,l),function(e,t,a,i){e!==t?i.push({i:a.push(r(a)+"skewX(",null,n)-2,x:h(e,t)}):t&&a.push(r(a)+"skewX("+t+n)}(i.skewX,o.skewX,s,l),function(e,t,a,n,i,o){if(e!==a||t!==n){var s=i.push(r(i)+"scale(",null,",",null,")");o.push({i:s-4,x:h(e,a)},{i:s-2,x:h(t,n)})}else 1===a&&1===n||i.push(r(i)+"scale("+a+","+n+")")}(i.scaleX,i.scaleY,o.scaleX,o.scaleY,s,l),i=o=null,function(e){for(var t,a=-1,n=l.length;++a<n;)s[(t=l[a]).i]=t.x(e);return s.join("")}}}var M=C((function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?O:I(t.a,t.b,t.c,t.d,t.e,t.f)}),"px, ","px)","deg)"),T=C((function(e){return null==e?O:(j||(j=document.createElementNS("http://www.w3.org/2000/svg","g")),j.setAttribute("transform",e),(e=j.transform.baseVal.consolidate())?I((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):O)}),", ",")",")"),_=1e-12;function N(e){return((e=Math.exp(e))+1/e)/2}var D=function e(t,a,n){function r(e,r){var i,o,s=e[0],l=e[1],c=e[2],u=r[0],d=r[1],p=r[2],m=u-s,y=d-l,g=m*m+y*y;if(g<_)o=Math.log(p/c)/t,i=function(e){return[s+e*m,l+e*y,c*Math.exp(t*e*o)]};else{var f=Math.sqrt(g),b=(p*p-c*c+n*g)/(2*c*a*f),h=(p*p-c*c-n*g)/(2*p*a*f),v=Math.log(Math.sqrt(b*b+1)-b),E=Math.log(Math.sqrt(h*h+1)-h);o=(E-v)/t,i=function(e){var n,r=e*o,i=N(v),u=c/(a*f)*(i*(n=t*r+v,((n=Math.exp(2*n))-1)/(n+1))-function(e){return((e=Math.exp(e))-1/e)/2}(v));return[s+u*m,l+u*y,c*i/N(t*r+v)]}}return i.duration=1e3*o*t/Math.SQRT2,i}return r.rho=function(t){var a=Math.max(.001,+t),n=a*a;return e(a,n,n*n)},r}(Math.SQRT2,2,4);function A(e){return function(a,n){var r=e((a=t.hsl(a)).h,(n=t.hsl(n)).h),i=c(a.s,n.s),o=c(a.l,n.l),s=c(a.opacity,n.opacity);return function(e){return a.h=r(e),a.s=i(e),a.l=o(e),a.opacity=s(e),a+""}}}var q=A(s),F=A(c);function L(e){return function(a,n){var r=e((a=t.hcl(a)).h,(n=t.hcl(n)).h),i=c(a.c,n.c),o=c(a.l,n.l),s=c(a.opacity,n.opacity);return function(e){return a.h=r(e),a.c=i(e),a.l=o(e),a.opacity=s(e),a+""}}}var R=L(s),P=L(c);function z(e){return function a(n){function r(a,r){var i=e((a=t.cubehelix(a)).h,(r=t.cubehelix(r)).h),o=c(a.s,r.s),s=c(a.l,r.l),l=c(a.opacity,r.opacity);return function(e){return a.h=i(e),a.s=o(e),a.l=s(Math.pow(e,n)),a.opacity=l(e),a+""}}return n=+n,r.gamma=a,r}(1)}var B=z(s),G=z(c);e.interpolate=w,e.interpolateArray=function(e,t){return(g(t)?y:f)(e,t)},e.interpolateBasis=n,e.interpolateBasisClosed=r,e.interpolateCubehelix=B,e.interpolateCubehelixLong=G,e.interpolateDate=b,e.interpolateDiscrete=function(e){var t=e.length;return function(a){return e[Math.max(0,Math.min(t-1,Math.floor(a*t)))]}},e.interpolateHcl=R,e.interpolateHclLong=P,e.interpolateHsl=q,e.interpolateHslLong=F,e.interpolateHue=function(e,t){var a=s(+e,+t);return function(e){var t=a(e);return t-360*Math.floor(t/360)}},e.interpolateLab=function(e,a){var n=c((e=t.lab(e)).l,(a=t.lab(a)).l),r=c(e.a,a.a),i=c(e.b,a.b),o=c(e.opacity,a.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=i(t),e.opacity=o(t),e+""}},e.interpolateNumber=h,e.interpolateNumberArray=y,e.interpolateObject=v,e.interpolateRgb=u,e.interpolateRgbBasis=p,e.interpolateRgbBasisClosed=m,e.interpolateRound=function(e,t){return e=+e,t=+t,function(a){return Math.round(e*(1-a)+t*a)}},e.interpolateString=k,e.interpolateTransformCss=M,e.interpolateTransformSvg=T,e.interpolateZoom=D,e.piecewise=function(e,t){void 0===t&&(t=e,e=w);for(var a=0,n=t.length-1,r=t[0],i=new Array(n<0?0:n);a<n;)i[a]=e(r,r=t[++a]);return function(e){var t=Math.max(0,Math.min(n-1,Math.floor(e*=n)));return i[t](e-t)}},e.quantize=function(e,t){for(var a=new Array(t),n=0;n<t;++n)a[n]=e(n/(t-1));return a},Object.defineProperty(e,"__esModule",{value:!0})}(t,a(1622))},1622:function(e,t,a){!function(e){"use strict";function t(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function a(e,t){var a=Object.create(e.prototype);for(var n in t)a[n]=t[n];return a}function n(){}var r=.7,i=1/r,o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),p=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),m=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),y=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),g=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),f={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function b(){return this.rgb().formatHex()}function h(){return this.rgb().formatRgb()}function v(e){var t,a;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?(a=t[1].length,t=parseInt(t[1],16),6===a?E(t):3===a?new j(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===a?x(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===a?x(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=u.exec(e))?new j(t[1],t[2],t[3],1):(t=d.exec(e))?new j(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=p.exec(e))?x(t[1],t[2],t[3],t[4]):(t=m.exec(e))?x(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=y.exec(e))?C(t[1],t[2]/100,t[3]/100,1):(t=g.exec(e))?C(t[1],t[2]/100,t[3]/100,t[4]):f.hasOwnProperty(e)?E(f[e]):"transparent"===e?new j(NaN,NaN,NaN,0):null}function E(e){return new j(e>>16&255,e>>8&255,255&e,1)}function x(e,t,a,n){return n<=0&&(e=t=a=NaN),new j(e,t,a,n)}function k(e){return e instanceof n||(e=v(e)),e?new j((e=e.rgb()).r,e.g,e.b,e.opacity):new j}function w(e,t,a,n){return 1===arguments.length?k(e):new j(e,t,a,null==n?1:n)}function j(e,t,a,n){this.r=+e,this.g=+t,this.b=+a,this.opacity=+n}function S(){return"#"+I(this.r)+I(this.g)+I(this.b)}function O(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function I(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function C(e,t,a,n){return n<=0?e=t=a=NaN:a<=0||a>=1?e=t=NaN:t<=0&&(e=NaN),new _(e,t,a,n)}function M(e){if(e instanceof _)return new _(e.h,e.s,e.l,e.opacity);if(e instanceof n||(e=v(e)),!e)return new _;if(e instanceof _)return e;var t=(e=e.rgb()).r/255,a=e.g/255,r=e.b/255,i=Math.min(t,a,r),o=Math.max(t,a,r),s=NaN,l=o-i,c=(o+i)/2;return l?(s=t===o?(a-r)/l+6*(a<r):a===o?(r-t)/l+2:(t-a)/l+4,l/=c<.5?o+i:2-o-i,s*=60):l=c>0&&c<1?0:s,new _(s,l,c,e.opacity)}function T(e,t,a,n){return 1===arguments.length?M(e):new _(e,t,a,null==n?1:n)}function _(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}function N(e,t,a){return 255*(e<60?t+(a-t)*e/60:e<180?a:e<240?t+(a-t)*(240-e)/60:t)}t(n,v,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:b,formatHex:b,formatHsl:function(){return M(this).formatHsl()},formatRgb:h,toString:h}),t(j,w,a(n,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new j(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?r:Math.pow(r,e),new j(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:S,formatHex:S,formatRgb:O,toString:O})),t(_,T,a(n,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new _(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?r:Math.pow(r,e),new _(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,n=a+(a<.5?a:1-a)*t,r=2*a-n;return new j(N(e>=240?e-240:e+120,r,n),N(e,r,n),N(e<120?e+240:e-120,r,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const D=Math.PI/180,A=180/Math.PI,q=.96422,F=1,L=.82521,R=4/29,P=6/29,z=3*P*P,B=P*P*P;function G(e){if(e instanceof H)return new H(e.l,e.a,e.b,e.opacity);if(e instanceof Q)return X(e);e instanceof j||(e=k(e));var t,a,n=Y(e.r),r=Y(e.g),i=Y(e.b),o=V((.2225045*n+.7168786*r+.0606169*i)/F);return n===r&&r===i?t=a=o:(t=V((.4360747*n+.3850649*r+.1430804*i)/q),a=V((.0139322*n+.0971045*r+.7141733*i)/L)),new H(116*o-16,500*(t-o),200*(o-a),e.opacity)}function $(e,t,a,n){return 1===arguments.length?G(e):new H(e,t,a,null==n?1:n)}function H(e,t,a,n){this.l=+e,this.a=+t,this.b=+a,this.opacity=+n}function V(e){return e>B?Math.pow(e,1/3):e/z+R}function U(e){return e>P?e*e*e:z*(e-R)}function W(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Y(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Z(e){if(e instanceof Q)return new Q(e.h,e.c,e.l,e.opacity);if(e instanceof H||(e=G(e)),0===e.a&&0===e.b)return new Q(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*A;return new Q(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function K(e,t,a,n){return 1===arguments.length?Z(e):new Q(e,t,a,null==n?1:n)}function Q(e,t,a,n){this.h=+e,this.c=+t,this.l=+a,this.opacity=+n}function X(e){if(isNaN(e.h))return new H(e.l,0,0,e.opacity);var t=e.h*D;return new H(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(H,$,a(n,{brighter:function(e){return new H(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new H(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,a=isNaN(this.b)?e:e-this.b/200;return new j(W(3.1338561*(t=q*U(t))-1.6168667*(e=F*U(e))-.4906146*(a=L*U(a))),W(-.9787684*t+1.9161415*e+.033454*a),W(.0719453*t-.2289914*e+1.4052427*a),this.opacity)}})),t(Q,K,a(n,{brighter:function(e){return new Q(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker:function(e){return new Q(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb:function(){return X(this).rgb()}}));var J=-.14861,ee=1.78277,te=-.29227,ae=-.90649,ne=1.97294,re=ne*ae,ie=ne*ee,oe=ee*te-ae*J;function se(e,t,a,n){return 1===arguments.length?function(e){if(e instanceof le)return new le(e.h,e.s,e.l,e.opacity);e instanceof j||(e=k(e));var t=e.r/255,a=e.g/255,n=e.b/255,r=(oe*n+re*t-ie*a)/(oe+re-ie),i=n-r,o=(ne*(a-r)-te*i)/ae,s=Math.sqrt(o*o+i*i)/(ne*r*(1-r)),l=s?Math.atan2(o,i)*A-120:NaN;return new le(l<0?l+360:l,s,r,e.opacity)}(e):new le(e,t,a,null==n?1:n)}function le(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}t(le,se,a(n,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new le(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?r:Math.pow(r,e),new le(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*D,t=+this.l,a=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),r=Math.sin(e);return new j(255*(t+a*(J*n+ee*r)),255*(t+a*(te*n+ae*r)),255*(t+a*(ne*n)),this.opacity)}})),e.color=v,e.cubehelix=se,e.gray=function(e,t){return new H(e,0,0,null==t?1:t)},e.hcl=K,e.hsl=T,e.lab=$,e.lch=function(e,t,a,n){return 1===arguments.length?Z(e):new Q(a,t,e,null==n?1:n)},e.rgb=w,Object.defineProperty(e,"__esModule",{value:!0})}(t)},1623:function(e,t,a){!function(e){"use strict";function t(e,t){if((a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var a,n=e.slice(0,a);return[n.length>1?n[0]+n.slice(2):n,+e.slice(a+1)]}function a(e){return(e=t(Math.abs(e)))?e[1]:NaN}var n,r=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function i(e){if(!(t=r.exec(e)))throw new Error("invalid format: "+e);var t;return new o({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function o(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function s(e,a){var n=t(e,a);if(!n)return e+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}i.prototype=o.prototype,o.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var l={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>s(100*e,t),r:s,s:function(e,a){var r=t(e,a);if(!r)return e+"";var i=r[0],o=r[1],s=o-(n=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,l=i.length;return s===l?i:s>l?i+new Array(s-l+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+t(e,Math.max(0,a+s-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function c(e){return e}var u,d=Array.prototype.map,p=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function m(e){var t,r,o=void 0===e.grouping||void 0===e.thousands?c:(t=d.call(e.grouping,Number),r=e.thousands+"",function(e,a){for(var n=e.length,i=[],o=0,s=t[0],l=0;n>0&&s>0&&(l+s+1>a&&(s=Math.max(1,a-l)),i.push(e.substring(n-=s,n+s)),!((l+=s+1)>a));)s=t[o=(o+1)%t.length];return i.reverse().join(r)}),s=void 0===e.currency?"":e.currency[0]+"",u=void 0===e.currency?"":e.currency[1]+"",m=void 0===e.decimal?".":e.decimal+"",y=void 0===e.numerals?c:function(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}(d.call(e.numerals,String)),g=void 0===e.percent?"%":e.percent+"",f=void 0===e.minus?"−":e.minus+"",b=void 0===e.nan?"NaN":e.nan+"";function h(e){var t=(e=i(e)).fill,a=e.align,r=e.sign,c=e.symbol,d=e.zero,h=e.width,v=e.comma,E=e.precision,x=e.trim,k=e.type;"n"===k?(v=!0,k="g"):l[k]||(void 0===E&&(E=12),x=!0,k="g"),(d||"0"===t&&"="===a)&&(d=!0,t="0",a="=");var w="$"===c?s:"#"===c&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",j="$"===c?u:/[%p]/.test(k)?g:"",S=l[k],O=/[defgprs%]/.test(k);function I(e){var i,s,l,c=w,u=j;if("c"===k)u=S(e)+u,e="";else{var g=(e=+e)<0||1/e<0;if(e=isNaN(e)?b:S(Math.abs(e),E),x&&(e=function(e){e:for(var t,a=e.length,n=1,r=-1;n<a;++n)switch(e[n]){case".":r=t=n;break;case"0":0===r&&(r=n),t=n;break;default:if(!+e[n])break e;r>0&&(r=0)}return r>0?e.slice(0,r)+e.slice(t+1):e}(e)),g&&0==+e&&"+"!==r&&(g=!1),c=(g?"("===r?r:f:"-"===r||"("===r?"":r)+c,u=("s"===k?p[8+n/3]:"")+u+(g&&"("===r?")":""),O)for(i=-1,s=e.length;++i<s;)if(48>(l=e.charCodeAt(i))||l>57){u=(46===l?m+e.slice(i+1):e.slice(i))+u,e=e.slice(0,i);break}}v&&!d&&(e=o(e,1/0));var I=c.length+e.length+u.length,C=I<h?new Array(h-I+1).join(t):"";switch(v&&d&&(e=o(C+e,C.length?h-u.length:1/0),C=""),a){case"<":e=c+e+u+C;break;case"=":e=c+C+e+u;break;case"^":e=C.slice(0,I=C.length>>1)+c+e+u+C.slice(I);break;default:e=C+c+e+u}return y(e)}return E=void 0===E?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,E)):Math.max(0,Math.min(20,E)),I.toString=function(){return e+""},I}return{format:h,formatPrefix:function(e,t){var n=h(((e=i(e)).type="f",e)),r=3*Math.max(-8,Math.min(8,Math.floor(a(t)/3))),o=Math.pow(10,-r),s=p[8+r/3];return function(e){return n(o*e)+s}}}}function y(t){return u=m(t),e.format=u.format,e.formatPrefix=u.formatPrefix,u}y({thousands:",",grouping:[3],currency:["$",""]}),e.FormatSpecifier=o,e.formatDefaultLocale=y,e.formatLocale=m,e.formatSpecifier=i,e.precisionFixed=function(e){return Math.max(0,-a(Math.abs(e)))},e.precisionPrefix=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(a(t)/3)))-a(Math.abs(e)))},e.precisionRound=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,a(t)-a(e))+1},Object.defineProperty(e,"__esModule",{value:!0})}(t)},1624:function(e,t,a){!function(e,t){"use strict";function a(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function n(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function r(e,t,a){return{y:e,m:t,d:a,H:0,M:0,S:0,L:0}}function i(e){var i=e.dateTime,o=e.date,l=e.time,c=e.periods,u=e.days,d=e.shortDays,p=e.months,U=e.shortMonths,pe=m(c),je=y(c),Se=m(u),Oe=y(u),Ie=m(d),Ce=y(d),Me=m(p),Te=y(p),_e=m(U),Ne=y(U),De={a:function(e){return d[e.getDay()]},A:function(e){return u[e.getDay()]},b:function(e){return U[e.getMonth()]},B:function(e){return p[e.getMonth()]},c:null,d:q,e:q,f:z,g:Q,G:J,H:F,I:L,j:R,L:P,m:B,M:G,p:function(e){return c[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:ke,s:we,S:$,u:H,U:V,V:W,w:Y,W:Z,x:null,X:null,y:K,Y:X,Z:ee,"%":xe},Ae={a:function(e){return d[e.getUTCDay()]},A:function(e){return u[e.getUTCDay()]},b:function(e){return U[e.getUTCMonth()]},B:function(e){return p[e.getUTCMonth()]},c:null,d:te,e:te,f:oe,g:be,G:ve,H:ae,I:ne,j:re,L:ie,m:se,M:le,p:function(e){return c[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:ke,s:we,S:ce,u:ue,U:de,V:me,w:ye,W:ge,x:null,X:null,y:fe,Y:he,Z:Ee,"%":xe},qe={a:function(e,t,a){var n=Ie.exec(t.slice(a));return n?(e.w=Ce.get(n[0].toLowerCase()),a+n[0].length):-1},A:function(e,t,a){var n=Se.exec(t.slice(a));return n?(e.w=Oe.get(n[0].toLowerCase()),a+n[0].length):-1},b:function(e,t,a){var n=_e.exec(t.slice(a));return n?(e.m=Ne.get(n[0].toLowerCase()),a+n[0].length):-1},B:function(e,t,a){var n=Me.exec(t.slice(a));return n?(e.m=Te.get(n[0].toLowerCase()),a+n[0].length):-1},c:function(e,t,a){return Re(e,i,t,a)},d:S,e:S,f:_,g:x,G:E,H:I,I:I,j:O,L:T,m:j,M:C,p:function(e,t,a){var n=pe.exec(t.slice(a));return n?(e.p=je.get(n[0].toLowerCase()),a+n[0].length):-1},q:w,Q:D,s:A,S:M,u:f,U:b,V:h,w:g,W:v,x:function(e,t,a){return Re(e,o,t,a)},X:function(e,t,a){return Re(e,l,t,a)},y:x,Y:E,Z:k,"%":N};function Fe(e,t){return function(a){var n,r,i,o=[],l=-1,c=0,u=e.length;for(a instanceof Date||(a=new Date(+a));++l<u;)37===e.charCodeAt(l)&&(o.push(e.slice(c,l)),null!=(r=s[n=e.charAt(++l)])?n=e.charAt(++l):r="e"===n?" ":"0",(i=t[n])&&(n=i(a,r)),o.push(n),c=l+1);return o.push(e.slice(c,l)),o.join("")}}function Le(e,i){return function(o){var s,l,c=r(1900,void 0,1);if(Re(c,e,o+="",0)!=o.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(i&&!("Z"in c)&&(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(l=(s=n(r(c.y,0,1))).getUTCDay(),s=l>4||0===l?t.utcMonday.ceil(s):t.utcMonday(s),s=t.utcDay.offset(s,7*(c.V-1)),c.y=s.getUTCFullYear(),c.m=s.getUTCMonth(),c.d=s.getUTCDate()+(c.w+6)%7):(l=(s=a(r(c.y,0,1))).getDay(),s=l>4||0===l?t.timeMonday.ceil(s):t.timeMonday(s),s=t.timeDay.offset(s,7*(c.V-1)),c.y=s.getFullYear(),c.m=s.getMonth(),c.d=s.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),l="Z"in c?n(r(c.y,0,1)).getUTCDay():a(r(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(l+5)%7:c.w+7*c.U-(l+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,n(c)):a(c)}}function Re(e,t,a,n){for(var r,i,o=0,l=t.length,c=a.length;o<l;){if(n>=c)return-1;if(37===(r=t.charCodeAt(o++))){if(r=t.charAt(o++),!(i=qe[r in s?t.charAt(o++):r])||(n=i(e,a,n))<0)return-1}else if(r!=a.charCodeAt(n++))return-1}return n}return De.x=Fe(o,De),De.X=Fe(l,De),De.c=Fe(i,De),Ae.x=Fe(o,Ae),Ae.X=Fe(l,Ae),Ae.c=Fe(i,Ae),{format:function(e){var t=Fe(e+="",De);return t.toString=function(){return e},t},parse:function(e){var t=Le(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=Fe(e+="",Ae);return t.toString=function(){return e},t},utcParse:function(e){var t=Le(e+="",!0);return t.toString=function(){return e},t}}}var o,s={"-":"",_:" ",0:"0"},l=/^\s*\d+/,c=/^%/,u=/[\\^$*+?|[\]().{}]/g;function d(e,t,a){var n=e<0?"-":"",r=(n?-e:e)+"",i=r.length;return n+(i<a?new Array(a-i+1).join(t)+r:r)}function p(e){return e.replace(u,"\\$&")}function m(e){return new RegExp("^(?:"+e.map(p).join("|")+")","i")}function y(e){return new Map(e.map(((e,t)=>[e.toLowerCase(),t])))}function g(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.w=+n[0],a+n[0].length):-1}function f(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.u=+n[0],a+n[0].length):-1}function b(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.U=+n[0],a+n[0].length):-1}function h(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.V=+n[0],a+n[0].length):-1}function v(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.W=+n[0],a+n[0].length):-1}function E(e,t,a){var n=l.exec(t.slice(a,a+4));return n?(e.y=+n[0],a+n[0].length):-1}function x(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),a+n[0].length):-1}function k(e,t,a){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(a,a+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),a+n[0].length):-1}function w(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.q=3*n[0]-3,a+n[0].length):-1}function j(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.m=n[0]-1,a+n[0].length):-1}function S(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.d=+n[0],a+n[0].length):-1}function O(e,t,a){var n=l.exec(t.slice(a,a+3));return n?(e.m=0,e.d=+n[0],a+n[0].length):-1}function I(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.H=+n[0],a+n[0].length):-1}function C(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.M=+n[0],a+n[0].length):-1}function M(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.S=+n[0],a+n[0].length):-1}function T(e,t,a){var n=l.exec(t.slice(a,a+3));return n?(e.L=+n[0],a+n[0].length):-1}function _(e,t,a){var n=l.exec(t.slice(a,a+6));return n?(e.L=Math.floor(n[0]/1e3),a+n[0].length):-1}function N(e,t,a){var n=c.exec(t.slice(a,a+1));return n?a+n[0].length:-1}function D(e,t,a){var n=l.exec(t.slice(a));return n?(e.Q=+n[0],a+n[0].length):-1}function A(e,t,a){var n=l.exec(t.slice(a));return n?(e.s=+n[0],a+n[0].length):-1}function q(e,t){return d(e.getDate(),t,2)}function F(e,t){return d(e.getHours(),t,2)}function L(e,t){return d(e.getHours()%12||12,t,2)}function R(e,a){return d(1+t.timeDay.count(t.timeYear(e),e),a,3)}function P(e,t){return d(e.getMilliseconds(),t,3)}function z(e,t){return P(e,t)+"000"}function B(e,t){return d(e.getMonth()+1,t,2)}function G(e,t){return d(e.getMinutes(),t,2)}function $(e,t){return d(e.getSeconds(),t,2)}function H(e){var t=e.getDay();return 0===t?7:t}function V(e,a){return d(t.timeSunday.count(t.timeYear(e)-1,e),a,2)}function U(e){var a=e.getDay();return a>=4||0===a?t.timeThursday(e):t.timeThursday.ceil(e)}function W(e,a){return e=U(e),d(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),a,2)}function Y(e){return e.getDay()}function Z(e,a){return d(t.timeMonday.count(t.timeYear(e)-1,e),a,2)}function K(e,t){return d(e.getFullYear()%100,t,2)}function Q(e,t){return d((e=U(e)).getFullYear()%100,t,2)}function X(e,t){return d(e.getFullYear()%1e4,t,4)}function J(e,a){var n=e.getDay();return d((e=n>=4||0===n?t.timeThursday(e):t.timeThursday.ceil(e)).getFullYear()%1e4,a,4)}function ee(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+d(t/60|0,"0",2)+d(t%60,"0",2)}function te(e,t){return d(e.getUTCDate(),t,2)}function ae(e,t){return d(e.getUTCHours(),t,2)}function ne(e,t){return d(e.getUTCHours()%12||12,t,2)}function re(e,a){return d(1+t.utcDay.count(t.utcYear(e),e),a,3)}function ie(e,t){return d(e.getUTCMilliseconds(),t,3)}function oe(e,t){return ie(e,t)+"000"}function se(e,t){return d(e.getUTCMonth()+1,t,2)}function le(e,t){return d(e.getUTCMinutes(),t,2)}function ce(e,t){return d(e.getUTCSeconds(),t,2)}function ue(e){var t=e.getUTCDay();return 0===t?7:t}function de(e,a){return d(t.utcSunday.count(t.utcYear(e)-1,e),a,2)}function pe(e){var a=e.getUTCDay();return a>=4||0===a?t.utcThursday(e):t.utcThursday.ceil(e)}function me(e,a){return e=pe(e),d(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),a,2)}function ye(e){return e.getUTCDay()}function ge(e,a){return d(t.utcMonday.count(t.utcYear(e)-1,e),a,2)}function fe(e,t){return d(e.getUTCFullYear()%100,t,2)}function be(e,t){return d((e=pe(e)).getUTCFullYear()%100,t,2)}function he(e,t){return d(e.getUTCFullYear()%1e4,t,4)}function ve(e,a){var n=e.getUTCDay();return d((e=n>=4||0===n?t.utcThursday(e):t.utcThursday.ceil(e)).getUTCFullYear()%1e4,a,4)}function Ee(){return"+0000"}function xe(){return"%"}function ke(e){return+e}function we(e){return Math.floor(+e/1e3)}function je(t){return o=i(t),e.timeFormat=o.format,e.timeParse=o.parse,e.utcFormat=o.utcFormat,e.utcParse=o.utcParse,o}je({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Se="%Y-%m-%dT%H:%M:%S.%LZ";var Oe=Date.prototype.toISOString?function(e){return e.toISOString()}:e.utcFormat(Se);var Ie=+new Date("2000-01-01T00:00:00.000Z")?function(e){var t=new Date(e);return isNaN(t)?null:t}:e.utcParse(Se);e.isoFormat=Oe,e.isoParse=Ie,e.timeFormatDefaultLocale=je,e.timeFormatLocale=i,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(1498))},1625:function(e,t,a){"use strict";var n=a(1626),r=a(1627).remove,i={},o={},s={},l={},c={};function u(e){return String("000"+(e||"")).slice(-3)}function d(e){return s[e]}function p(e){return o[e]}function m(e){var t=u(e);return p(l[t])}function y(e){var t=u(e);return l[t]}function g(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return y(e);if(2===e.length)return e.toUpperCase();if(3===e.length)return d(e.toUpperCase())}if("number"==typeof e)return y(e)}n.forEach((function(e){var t=e;o[t[0]]=t[1],s[t[1]]=t[0],l[t[2]]=t[0],c[t[0]]=t[2]})),t.registerLocale=function(e){if(!e.locale)throw new TypeError("Missing localeData.locale");if(!e.countries)throw new TypeError("Missing localeData.countries");i[e.locale]=e.countries},t.alpha3ToAlpha2=d,t.alpha2ToAlpha3=p,t.alpha3ToNumeric=function(e){return c[d(e)]},t.alpha2ToNumeric=function(e){return c[e]},t.numericToAlpha3=m,t.numericToAlpha2=y,t.toAlpha3=function(e){if("string"==typeof e){if(/^[0-9]*$/.test(e))return m(e);if(2===e.length)return p(e.toUpperCase());if(3===e.length)return e.toUpperCase()}if("number"==typeof e)return m(e)},t.toAlpha2=g,t.getName=function(e,t){try{return i[t.toLowerCase()][g(e)]}catch(e){return}},t.getNames=function(e){var t=i[e.toLowerCase()];return void 0===t?{}:t},t.getAlpha2Code=function(e,t){try{var a,n=i[t.toLowerCase()];for(a in n)if(n.hasOwnProperty(a)&&n[a].toLowerCase()===e.toLowerCase())return a;return}catch(e){return}},t.getSimpleAlpha2Code=function(e,t){try{var a,n=i[t.toLowerCase()];for(a in n)if(n.hasOwnProperty(a)&&r(n[a].toLowerCase())===r(e.toLowerCase()))return a;return}catch(e){return}},t.getAlpha2Codes=function(){return o},t.getAlpha3Code=function(e,t){var a=this.getAlpha2Code(e,t);return a?this.toAlpha3(a):void 0},t.getSimpleAlpha3Code=function(e,t){var a=this.getSimpleAlpha2Code(e,t);return a?this.toAlpha3(a):void 0},t.getAlpha3Codes=function(){return s},t.getNumericCodes=function(){return l},t.langs=function(){return Object.keys(i)},t.isValid=function(e){if(!e)return!1;var t=e.toString().toUpperCase();return s.hasOwnProperty(t)||o.hasOwnProperty(t)||l.hasOwnProperty(t)}},1626:function(e){e.exports=JSON.parse('[["AF","AFG","004","ISO 3166-2:AF"],["AX","ALA","248","ISO 3166-2:AX"],["AL","ALB","008","ISO 3166-2:AL"],["DZ","DZA","012","ISO 3166-2:DZ"],["AS","ASM","016","ISO 3166-2:AS"],["AD","AND","020","ISO 3166-2:AD"],["AO","AGO","024","ISO 3166-2:AO"],["AI","AIA","660","ISO 3166-2:AI"],["AQ","ATA","010","ISO 3166-2:AQ"],["AG","ATG","028","ISO 3166-2:AG"],["AR","ARG","032","ISO 3166-2:AR"],["AM","ARM","051","ISO 3166-2:AM"],["AW","ABW","533","ISO 3166-2:AW"],["AU","AUS","036","ISO 3166-2:AU"],["AT","AUT","040","ISO 3166-2:AT"],["AZ","AZE","031","ISO 3166-2:AZ"],["BS","BHS","044","ISO 3166-2:BS"],["BH","BHR","048","ISO 3166-2:BH"],["BD","BGD","050","ISO 3166-2:BD"],["BB","BRB","052","ISO 3166-2:BB"],["BY","BLR","112","ISO 3166-2:BY"],["BE","BEL","056","ISO 3166-2:BE"],["BZ","BLZ","084","ISO 3166-2:BZ"],["BJ","BEN","204","ISO 3166-2:BJ"],["BM","BMU","060","ISO 3166-2:BM"],["BT","BTN","064","ISO 3166-2:BT"],["BO","BOL","068","ISO 3166-2:BO"],["BQ","BES","535","ISO 3166-2:BQ"],["BA","BIH","070","ISO 3166-2:BA"],["BW","BWA","072","ISO 3166-2:BW"],["BV","BVT","074","ISO 3166-2:BV"],["BR","BRA","076","ISO 3166-2:BR"],["IO","IOT","086","ISO 3166-2:IO"],["BN","BRN","096","ISO 3166-2:BN"],["BG","BGR","100","ISO 3166-2:BG"],["BF","BFA","854","ISO 3166-2:BF"],["BI","BDI","108","ISO 3166-2:BI"],["KH","KHM","116","ISO 3166-2:KH"],["CM","CMR","120","ISO 3166-2:CM"],["CA","CAN","124","ISO 3166-2:CA"],["CV","CPV","132","ISO 3166-2:CV"],["KY","CYM","136","ISO 3166-2:KY"],["CF","CAF","140","ISO 3166-2:CF"],["TD","TCD","148","ISO 3166-2:TD"],["CL","CHL","152","ISO 3166-2:CL"],["CN","CHN","156","ISO 3166-2:CN"],["CX","CXR","162","ISO 3166-2:CX"],["CC","CCK","166","ISO 3166-2:CC"],["CO","COL","170","ISO 3166-2:CO"],["KM","COM","174","ISO 3166-2:KM"],["CG","COG","178","ISO 3166-2:CG"],["CD","COD","180","ISO 3166-2:CD"],["CK","COK","184","ISO 3166-2:CK"],["CR","CRI","188","ISO 3166-2:CR"],["CI","CIV","384","ISO 3166-2:CI"],["HR","HRV","191","ISO 3166-2:HR"],["CU","CUB","192","ISO 3166-2:CU"],["CW","CUW","531","ISO 3166-2:CW"],["CY","CYP","196","ISO 3166-2:CY"],["CZ","CZE","203","ISO 3166-2:CZ"],["DK","DNK","208","ISO 3166-2:DK"],["DJ","DJI","262","ISO 3166-2:DJ"],["DM","DMA","212","ISO 3166-2:DM"],["DO","DOM","214","ISO 3166-2:DO"],["EC","ECU","218","ISO 3166-2:EC"],["EG","EGY","818","ISO 3166-2:EG"],["SV","SLV","222","ISO 3166-2:SV"],["GQ","GNQ","226","ISO 3166-2:GQ"],["ER","ERI","232","ISO 3166-2:ER"],["EE","EST","233","ISO 3166-2:EE"],["ET","ETH","231","ISO 3166-2:ET"],["FK","FLK","238","ISO 3166-2:FK"],["FO","FRO","234","ISO 3166-2:FO"],["FJ","FJI","242","ISO 3166-2:FJ"],["FI","FIN","246","ISO 3166-2:FI"],["FR","FRA","250","ISO 3166-2:FR"],["GF","GUF","254","ISO 3166-2:GF"],["PF","PYF","258","ISO 3166-2:PF"],["TF","ATF","260","ISO 3166-2:TF"],["GA","GAB","266","ISO 3166-2:GA"],["GM","GMB","270","ISO 3166-2:GM"],["GE","GEO","268","ISO 3166-2:GE"],["DE","DEU","276","ISO 3166-2:DE"],["GH","GHA","288","ISO 3166-2:GH"],["GI","GIB","292","ISO 3166-2:GI"],["GR","GRC","300","ISO 3166-2:GR"],["GL","GRL","304","ISO 3166-2:GL"],["GD","GRD","308","ISO 3166-2:GD"],["GP","GLP","312","ISO 3166-2:GP"],["GU","GUM","316","ISO 3166-2:GU"],["GT","GTM","320","ISO 3166-2:GT"],["GG","GGY","831","ISO 3166-2:GG"],["GN","GIN","324","ISO 3166-2:GN"],["GW","GNB","624","ISO 3166-2:GW"],["GY","GUY","328","ISO 3166-2:GY"],["HT","HTI","332","ISO 3166-2:HT"],["HM","HMD","334","ISO 3166-2:HM"],["VA","VAT","336","ISO 3166-2:VA"],["HN","HND","340","ISO 3166-2:HN"],["HK","HKG","344","ISO 3166-2:HK"],["HU","HUN","348","ISO 3166-2:HU"],["IS","ISL","352","ISO 3166-2:IS"],["IN","IND","356","ISO 3166-2:IN"],["ID","IDN","360","ISO 3166-2:ID"],["IR","IRN","364","ISO 3166-2:IR"],["IQ","IRQ","368","ISO 3166-2:IQ"],["IE","IRL","372","ISO 3166-2:IE"],["IM","IMN","833","ISO 3166-2:IM"],["IL","ISR","376","ISO 3166-2:IL"],["IT","ITA","380","ISO 3166-2:IT"],["JM","JAM","388","ISO 3166-2:JM"],["JP","JPN","392","ISO 3166-2:JP"],["JE","JEY","832","ISO 3166-2:JE"],["JO","JOR","400","ISO 3166-2:JO"],["KZ","KAZ","398","ISO 3166-2:KZ"],["KE","KEN","404","ISO 3166-2:KE"],["KI","KIR","296","ISO 3166-2:KI"],["KP","PRK","408","ISO 3166-2:KP"],["KR","KOR","410","ISO 3166-2:KR"],["KW","KWT","414","ISO 3166-2:KW"],["KG","KGZ","417","ISO 3166-2:KG"],["LA","LAO","418","ISO 3166-2:LA"],["LV","LVA","428","ISO 3166-2:LV"],["LB","LBN","422","ISO 3166-2:LB"],["LS","LSO","426","ISO 3166-2:LS"],["LR","LBR","430","ISO 3166-2:LR"],["LY","LBY","434","ISO 3166-2:LY"],["LI","LIE","438","ISO 3166-2:LI"],["LT","LTU","440","ISO 3166-2:LT"],["LU","LUX","442","ISO 3166-2:LU"],["MO","MAC","446","ISO 3166-2:MO"],["MK","MKD","807","ISO 3166-2:MK"],["MG","MDG","450","ISO 3166-2:MG"],["MW","MWI","454","ISO 3166-2:MW"],["MY","MYS","458","ISO 3166-2:MY"],["MV","MDV","462","ISO 3166-2:MV"],["ML","MLI","466","ISO 3166-2:ML"],["MT","MLT","470","ISO 3166-2:MT"],["MH","MHL","584","ISO 3166-2:MH"],["MQ","MTQ","474","ISO 3166-2:MQ"],["MR","MRT","478","ISO 3166-2:MR"],["MU","MUS","480","ISO 3166-2:MU"],["YT","MYT","175","ISO 3166-2:YT"],["MX","MEX","484","ISO 3166-2:MX"],["FM","FSM","583","ISO 3166-2:FM"],["MD","MDA","498","ISO 3166-2:MD"],["MC","MCO","492","ISO 3166-2:MC"],["MN","MNG","496","ISO 3166-2:MN"],["ME","MNE","499","ISO 3166-2:ME"],["MS","MSR","500","ISO 3166-2:MS"],["MA","MAR","504","ISO 3166-2:MA"],["MZ","MOZ","508","ISO 3166-2:MZ"],["MM","MMR","104","ISO 3166-2:MM"],["NA","NAM","516","ISO 3166-2:NA"],["NR","NRU","520","ISO 3166-2:NR"],["NP","NPL","524","ISO 3166-2:NP"],["NL","NLD","528","ISO 3166-2:NL"],["NC","NCL","540","ISO 3166-2:NC"],["NZ","NZL","554","ISO 3166-2:NZ"],["NI","NIC","558","ISO 3166-2:NI"],["NE","NER","562","ISO 3166-2:NE"],["NG","NGA","566","ISO 3166-2:NG"],["NU","NIU","570","ISO 3166-2:NU"],["NF","NFK","574","ISO 3166-2:NF"],["MP","MNP","580","ISO 3166-2:MP"],["NO","NOR","578","ISO 3166-2:NO"],["OM","OMN","512","ISO 3166-2:OM"],["PK","PAK","586","ISO 3166-2:PK"],["PW","PLW","585","ISO 3166-2:PW"],["PS","PSE","275","ISO 3166-2:PS"],["PA","PAN","591","ISO 3166-2:PA"],["PG","PNG","598","ISO 3166-2:PG"],["PY","PRY","600","ISO 3166-2:PY"],["PE","PER","604","ISO 3166-2:PE"],["PH","PHL","608","ISO 3166-2:PH"],["PN","PCN","612","ISO 3166-2:PN"],["PL","POL","616","ISO 3166-2:PL"],["PT","PRT","620","ISO 3166-2:PT"],["PR","PRI","630","ISO 3166-2:PR"],["QA","QAT","634","ISO 3166-2:QA"],["RE","REU","638","ISO 3166-2:RE"],["RO","ROU","642","ISO 3166-2:RO"],["RU","RUS","643","ISO 3166-2:RU"],["RW","RWA","646","ISO 3166-2:RW"],["BL","BLM","652","ISO 3166-2:BL"],["SH","SHN","654","ISO 3166-2:SH"],["KN","KNA","659","ISO 3166-2:KN"],["LC","LCA","662","ISO 3166-2:LC"],["MF","MAF","663","ISO 3166-2:MF"],["PM","SPM","666","ISO 3166-2:PM"],["VC","VCT","670","ISO 3166-2:VC"],["WS","WSM","882","ISO 3166-2:WS"],["SM","SMR","674","ISO 3166-2:SM"],["ST","STP","678","ISO 3166-2:ST"],["SA","SAU","682","ISO 3166-2:SA"],["SN","SEN","686","ISO 3166-2:SN"],["RS","SRB","688","ISO 3166-2:RS"],["SC","SYC","690","ISO 3166-2:SC"],["SL","SLE","694","ISO 3166-2:SL"],["SG","SGP","702","ISO 3166-2:SG"],["SX","SXM","534","ISO 3166-2:SX"],["SK","SVK","703","ISO 3166-2:SK"],["SI","SVN","705","ISO 3166-2:SI"],["SB","SLB","090","ISO 3166-2:SB"],["SO","SOM","706","ISO 3166-2:SO"],["ZA","ZAF","710","ISO 3166-2:ZA"],["GS","SGS","239","ISO 3166-2:GS"],["SS","SSD","728","ISO 3166-2:SS"],["ES","ESP","724","ISO 3166-2:ES"],["LK","LKA","144","ISO 3166-2:LK"],["SD","SDN","729","ISO 3166-2:SD"],["SR","SUR","740","ISO 3166-2:SR"],["SJ","SJM","744","ISO 3166-2:SJ"],["SZ","SWZ","748","ISO 3166-2:SZ"],["SE","SWE","752","ISO 3166-2:SE"],["CH","CHE","756","ISO 3166-2:CH"],["SY","SYR","760","ISO 3166-2:SY"],["TW","TWN","158","ISO 3166-2:TW"],["TJ","TJK","762","ISO 3166-2:TJ"],["TZ","TZA","834","ISO 3166-2:TZ"],["TH","THA","764","ISO 3166-2:TH"],["TL","TLS","626","ISO 3166-2:TL"],["TG","TGO","768","ISO 3166-2:TG"],["TK","TKL","772","ISO 3166-2:TK"],["TO","TON","776","ISO 3166-2:TO"],["TT","TTO","780","ISO 3166-2:TT"],["TN","TUN","788","ISO 3166-2:TN"],["TR","TUR","792","ISO 3166-2:TR"],["TM","TKM","795","ISO 3166-2:TM"],["TC","TCA","796","ISO 3166-2:TC"],["TV","TUV","798","ISO 3166-2:TV"],["UG","UGA","800","ISO 3166-2:UG"],["UA","UKR","804","ISO 3166-2:UA"],["AE","ARE","784","ISO 3166-2:AE"],["GB","GBR","826","ISO 3166-2:GB"],["US","USA","840","ISO 3166-2:US"],["UM","UMI","581","ISO 3166-2:UM"],["UY","URY","858","ISO 3166-2:UY"],["UZ","UZB","860","ISO 3166-2:UZ"],["VU","VUT","548","ISO 3166-2:VU"],["VE","VEN","862","ISO 3166-2:VE"],["VN","VNM","704","ISO 3166-2:VN"],["VG","VGB","092","ISO 3166-2:VG"],["VI","VIR","850","ISO 3166-2:VI"],["WF","WLF","876","ISO 3166-2:WF"],["EH","ESH","732","ISO 3166-2:EH"],["YE","YEM","887","ISO 3166-2:YE"],["ZM","ZMB","894","ISO 3166-2:ZM"],["ZW","ZWE","716","ISO 3166-2:ZW"],["XK","XKX","","ISO 3166-2:XK"]]')},1627:function(e,t){t.remove=function(e){return e.replace(/[^\u0000-\u007e]/g,(function(e){return n[e]||e}))};for(var a=[{base:" ",chars:" "},{base:"0",chars:"߀"},{base:"A",chars:"ⒶＡÀÁÂẦẤẪẨÃĀĂẰẮẴẲȦǠÄǞẢÅǺǍȀȂẠẬẶḀĄȺⱯ"},{base:"AA",chars:"Ꜳ"},{base:"AE",chars:"ÆǼǢ"},{base:"AO",chars:"Ꜵ"},{base:"AU",chars:"Ꜷ"},{base:"AV",chars:"ꜸꜺ"},{base:"AY",chars:"Ꜽ"},{base:"B",chars:"ⒷＢḂḄḆɃƁ"},{base:"C",chars:"ⒸＣꜾḈĆCĈĊČÇƇȻ"},{base:"D",chars:"ⒹＤḊĎḌḐḒḎĐƊƉᴅꝹ"},{base:"Dh",chars:"Ð"},{base:"DZ",chars:"ǱǄ"},{base:"Dz",chars:"ǲǅ"},{base:"E",chars:"ɛⒺＥÈÉÊỀẾỄỂẼĒḔḖĔĖËẺĚȄȆẸỆȨḜĘḘḚƐƎᴇ"},{base:"F",chars:"ꝼⒻＦḞƑꝻ"},{base:"G",chars:"ⒼＧǴĜḠĞĠǦĢǤƓꞠꝽꝾɢ"},{base:"H",chars:"ⒽＨĤḢḦȞḤḨḪĦⱧⱵꞍ"},{base:"I",chars:"ⒾＩÌÍÎĨĪĬİÏḮỈǏȈȊỊĮḬƗ"},{base:"J",chars:"ⒿＪĴɈȷ"},{base:"K",chars:"ⓀＫḰǨḲĶḴƘⱩꝀꝂꝄꞢ"},{base:"L",chars:"ⓁＬĿĹĽḶḸĻḼḺŁȽⱢⱠꝈꝆꞀ"},{base:"LJ",chars:"Ǉ"},{base:"Lj",chars:"ǈ"},{base:"M",chars:"ⓂＭḾṀṂⱮƜϻ"},{base:"N",chars:"ꞤȠⓃＮǸŃÑṄŇṆŅṊṈƝꞐᴎ"},{base:"NJ",chars:"Ǌ"},{base:"Nj",chars:"ǋ"},{base:"O",chars:"ⓄＯÒÓÔỒỐỖỔÕṌȬṎŌṐṒŎȮȰÖȪỎŐǑȌȎƠỜỚỠỞỢỌỘǪǬØǾƆƟꝊꝌ"},{base:"OE",chars:"Œ"},{base:"OI",chars:"Ƣ"},{base:"OO",chars:"Ꝏ"},{base:"OU",chars:"Ȣ"},{base:"P",chars:"ⓅＰṔṖƤⱣꝐꝒꝔ"},{base:"Q",chars:"ⓆＱꝖꝘɊ"},{base:"R",chars:"ⓇＲŔṘŘȐȒṚṜŖṞɌⱤꝚꞦꞂ"},{base:"S",chars:"ⓈＳẞŚṤŜṠŠṦṢṨȘŞⱾꞨꞄ"},{base:"T",chars:"ⓉＴṪŤṬȚŢṰṮŦƬƮȾꞆ"},{base:"Th",chars:"Þ"},{base:"TZ",chars:"Ꜩ"},{base:"U",chars:"ⓊＵÙÚÛŨṸŪṺŬÜǛǗǕǙỦŮŰǓȔȖƯỪỨỮỬỰỤṲŲṶṴɄ"},{base:"V",chars:"ⓋＶṼṾƲꝞɅ"},{base:"VY",chars:"Ꝡ"},{base:"W",chars:"ⓌＷẀẂŴẆẄẈⱲ"},{base:"X",chars:"ⓍＸẊẌ"},{base:"Y",chars:"ⓎＹỲÝŶỸȲẎŸỶỴƳɎỾ"},{base:"Z",chars:"ⓏＺŹẐŻŽẒẔƵȤⱿⱫꝢ"},{base:"a",chars:"ⓐａẚàáâầấẫẩãāăằắẵẳȧǡäǟảåǻǎȁȃạậặḁąⱥɐɑ"},{base:"aa",chars:"ꜳ"},{base:"ae",chars:"æǽǣ"},{base:"ao",chars:"ꜵ"},{base:"au",chars:"ꜷ"},{base:"av",chars:"ꜹꜻ"},{base:"ay",chars:"ꜽ"},{base:"b",chars:"ⓑｂḃḅḇƀƃɓƂ"},{base:"c",chars:"ｃⓒćĉċčçḉƈȼꜿↄ"},{base:"d",chars:"ⓓｄḋďḍḑḓḏđƌɖɗƋᏧԁꞪ"},{base:"dh",chars:"ð"},{base:"dz",chars:"ǳǆ"},{base:"e",chars:"ⓔｅèéêềếễểẽēḕḗĕėëẻěȅȇẹệȩḝęḙḛɇǝ"},{base:"f",chars:"ⓕｆḟƒ"},{base:"ff",chars:"ﬀ"},{base:"fi",chars:"ﬁ"},{base:"fl",chars:"ﬂ"},{base:"ffi",chars:"ﬃ"},{base:"ffl",chars:"ﬄ"},{base:"g",chars:"ⓖｇǵĝḡğġǧģǥɠꞡꝿᵹ"},{base:"h",chars:"ⓗｈĥḣḧȟḥḩḫẖħⱨⱶɥ"},{base:"hv",chars:"ƕ"},{base:"i",chars:"ⓘｉìíîĩīĭïḯỉǐȉȋịįḭɨı"},{base:"j",chars:"ⓙｊĵǰɉ"},{base:"k",chars:"ⓚｋḱǩḳķḵƙⱪꝁꝃꝅꞣ"},{base:"l",chars:"ⓛｌŀĺľḷḹļḽḻſłƚɫⱡꝉꞁꝇɭ"},{base:"lj",chars:"ǉ"},{base:"m",chars:"ⓜｍḿṁṃɱɯ"},{base:"n",chars:"ⓝｎǹńñṅňṇņṋṉƞɲŉꞑꞥлԉ"},{base:"nj",chars:"ǌ"},{base:"o",chars:"ⓞｏòóôồốỗổõṍȭṏōṑṓŏȯȱöȫỏőǒȍȏơờớỡởợọộǫǭøǿꝋꝍɵɔᴑ"},{base:"oe",chars:"œ"},{base:"oi",chars:"ƣ"},{base:"oo",chars:"ꝏ"},{base:"ou",chars:"ȣ"},{base:"p",chars:"ⓟｐṕṗƥᵽꝑꝓꝕρ"},{base:"q",chars:"ⓠｑɋꝗꝙ"},{base:"r",chars:"ⓡｒŕṙřȑȓṛṝŗṟɍɽꝛꞧꞃ"},{base:"s",chars:"ⓢｓśṥŝṡšṧṣṩșşȿꞩꞅẛʂ"},{base:"ss",chars:"ß"},{base:"t",chars:"ⓣｔṫẗťṭțţṱṯŧƭʈⱦꞇ"},{base:"th",chars:"þ"},{base:"tz",chars:"ꜩ"},{base:"u",chars:"ⓤｕùúûũṹūṻŭüǜǘǖǚủůűǔȕȗưừứữửựụṳųṷṵʉ"},{base:"v",chars:"ⓥｖṽṿʋꝟʌ"},{base:"vy",chars:"ꝡ"},{base:"w",chars:"ⓦｗẁẃŵẇẅẘẉⱳ"},{base:"x",chars:"ⓧｘẋẍ"},{base:"y",chars:"ⓨｙỳýŷỹȳẏÿỷẙỵƴɏỿ"},{base:"z",chars:"ⓩｚźẑżžẓẕƶȥɀⱬꝣ"}],n={},r=0;r<a.length;r+=1)for(var i=a[r].chars,o=0;o<i.length;o+=1)n[i[o]]=a[r].base;t.replacementList=a,t.diacriticsMap=n},1628:function(e){e.exports=JSON.parse('{"locale":"en","countries":{"AF":"Afghanistan","AL":"Albania","DZ":"Algeria","AS":"American Samoa","AD":"Andorra","AO":"Angola","AI":"Anguilla","AQ":"Antarctica","AG":"Antigua and Barbuda","AR":"Argentina","AM":"Armenia","AW":"Aruba","AU":"Australia","AT":"Austria","AZ":"Azerbaijan","BS":"Bahamas","BH":"Bahrain","BD":"Bangladesh","BB":"Barbados","BY":"Belarus","BE":"Belgium","BZ":"Belize","BJ":"Benin","BM":"Bermuda","BT":"Bhutan","BO":"Bolivia","BA":"Bosnia and Herzegovina","BW":"Botswana","BV":"Bouvet Island","BR":"Brazil","IO":"British Indian Ocean Territory","BN":"Brunei Darussalam","BG":"Bulgaria","BF":"Burkina Faso","BI":"Burundi","KH":"Cambodia","CM":"Cameroon","CA":"Canada","CV":"Cape Verde","KY":"Cayman Islands","CF":"Central African Republic","TD":"Chad","CL":"Chile","CN":"China","CX":"Christmas Island","CC":"Cocos (Keeling) Islands","CO":"Colombia","KM":"Comoros","CG":"Congo","CD":"Congo, the Democratic Republic of the","CK":"Cook Islands","CR":"Costa Rica","CI":"Cote D\'Ivoire","HR":"Croatia","CU":"Cuba","CY":"Cyprus","CZ":"Czech Republic","DK":"Denmark","DJ":"Djibouti","DM":"Dominica","DO":"Dominican Republic","EC":"Ecuador","EG":"Egypt","SV":"El Salvador","GQ":"Equatorial Guinea","ER":"Eritrea","EE":"Estonia","ET":"Ethiopia","FK":"Falkland Islands (Malvinas)","FO":"Faroe Islands","FJ":"Fiji","FI":"Finland","FR":"France","GF":"French Guiana","PF":"French Polynesia","TF":"French Southern Territories","GA":"Gabon","GM":"Gambia","GE":"Georgia","DE":"Germany","GH":"Ghana","GI":"Gibraltar","GR":"Greece","GL":"Greenland","GD":"Grenada","GP":"Guadeloupe","GU":"Guam","GT":"Guatemala","GN":"Guinea","GW":"Guinea-Bissau","GY":"Guyana","HT":"Haiti","HM":"Heard Island and Mcdonald Islands","VA":"Holy See (Vatican City State)","HN":"Honduras","HK":"Hong Kong","HU":"Hungary","IS":"Iceland","IN":"India","ID":"Indonesia","IR":"Iran, Islamic Republic of","IQ":"Iraq","IE":"Ireland","IL":"Israel","IT":"Italy","JM":"Jamaica","JP":"Japan","JO":"Jordan","KZ":"Kazakhstan","KE":"Kenya","KI":"Kiribati","KP":"North Korea","KR":"South Korea","KW":"Kuwait","KG":"Kyrgyzstan","LA":"Lao People\'s Democratic Republic","LV":"Latvia","LB":"Lebanon","LS":"Lesotho","LR":"Liberia","LY":"Libya","LI":"Liechtenstein","LT":"Lithuania","LU":"Luxembourg","MO":"Macao","MG":"Madagascar","MW":"Malawi","MY":"Malaysia","MV":"Maldives","ML":"Mali","MT":"Malta","MH":"Marshall Islands","MQ":"Martinique","MR":"Mauritania","MU":"Mauritius","YT":"Mayotte","MX":"Mexico","FM":"Micronesia, Federated States of","MD":"Moldova, Republic of","MC":"Monaco","MN":"Mongolia","MS":"Montserrat","MA":"Morocco","MZ":"Mozambique","MM":"Myanmar","NA":"Namibia","NR":"Nauru","NP":"Nepal","NL":"Netherlands","NC":"New Caledonia","NZ":"New Zealand","NI":"Nicaragua","NE":"Niger","NG":"Nigeria","NU":"Niue","NF":"Norfolk Island","MK":"North Macedonia, Republic of","MP":"Northern Mariana Islands","NO":"Norway","OM":"Oman","PK":"Pakistan","PW":"Palau","PS":"Palestinian Territory, Occupied","PA":"Panama","PG":"Papua New Guinea","PY":"Paraguay","PE":"Peru","PH":"Philippines","PN":"Pitcairn","PL":"Poland","PT":"Portugal","PR":"Puerto Rico","QA":"Qatar","RE":"Reunion","RO":"Romania","RU":"Russian Federation","RW":"Rwanda","SH":"Saint Helena","KN":"Saint Kitts and Nevis","LC":"Saint Lucia","PM":"Saint Pierre and Miquelon","VC":"Saint Vincent and the Grenadines","WS":"Samoa","SM":"San Marino","ST":"Sao Tome and Principe","SA":"Saudi Arabia","SN":"Senegal","SC":"Seychelles","SL":"Sierra Leone","SG":"Singapore","SK":"Slovakia","SI":"Slovenia","SB":"Solomon Islands","SO":"Somalia","ZA":"South Africa","GS":"South Georgia and the South Sandwich Islands","ES":"Spain","LK":"Sri Lanka","SD":"Sudan","SR":"Suriname","SJ":"Svalbard and Jan Mayen","SZ":"Swaziland","SE":"Sweden","CH":"Switzerland","SY":"Syrian Arab Republic","TW":"Taiwan","TJ":"Tajikistan","TZ":"Tanzania, United Republic of","TH":"Thailand","TL":"Timor-Leste","TG":"Togo","TK":"Tokelau","TO":"Tonga","TT":"Trinidad and Tobago","TN":"Tunisia","TR":"Turkey","TM":"Turkmenistan","TC":"Turks and Caicos Islands","TV":"Tuvalu","UG":"Uganda","UA":"Ukraine","AE":"United Arab Emirates","GB":"United Kingdom","US":"United States of America","UM":"United States Minor Outlying Islands","UY":"Uruguay","UZ":"Uzbekistan","VU":"Vanuatu","VE":"Venezuela","VN":"Viet Nam","VG":"Virgin Islands, British","VI":"Virgin Islands, U.S.","WF":"Wallis and Futuna","EH":"Western Sahara","YE":"Yemen","ZM":"Zambia","ZW":"Zimbabwe","AX":"Åland Islands","BQ":"Bonaire, Sint Eustatius and Saba","CW":"Curaçao","GG":"Guernsey","IM":"Isle of Man","JE":"Jersey","ME":"Montenegro","BL":"Saint Barthélemy","MF":"Saint Martin (French part)","RS":"Serbia","SX":"Sint Maarten (Dutch part)","SS":"South Sudan","XK":"Kosovo"}}')},1629:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iOCIgaGVpZ2h0PSI4IiBmaWxsPSJub25lIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIiBkPSJNMSAwSDB2OGg4VjdIMVYweiIgZmlsbD0iI0QzREFFNiIvPjwvc3ZnPg=="},183:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"z",(function(){return i})),a.d(t,"n",(function(){return s})),a.d(t,"w",(function(){return l})),a.d(t,"s",(function(){return c})),a.d(t,"q",(function(){return u})),a.d(t,"v",(function(){return d})),a.d(t,"o",(function(){return p})),a.d(t,"p",(function(){return m})),a.d(t,"r",(function(){return y})),a.d(t,"u",(function(){return g})),a.d(t,"t",(function(){return f})),a.d(t,"i",(function(){return b})),a.d(t,"D",(function(){return h})),a.d(t,"C",(function(){return v})),a.d(t,"k",(function(){return E})),a.d(t,"j",(function(){return x})),a.d(t,"B",(function(){return k})),a.d(t,"h",(function(){return w})),a.d(t,"b",(function(){return j})),a.d(t,"d",(function(){return S})),a.d(t,"c",(function(){return O})),a.d(t,"f",(function(){return I})),a.d(t,"e",(function(){return C})),a.d(t,"g",(function(){return M})),a.d(t,"A",(function(){return T})),a.d(t,"x",(function(){return N})),a.d(t,"y",(function(){return D})),a.d(t,"m",(function(){return A})),a.d(t,"l",(function(){return q}));var n=a(427);const r=`${n.a}AnalyzerGraph`,i=`${n.a}SessionView`,o=`${n.a}PrevalenceDetails`,s=`${o}DatePicker`,l=`${o}Upsell`,c=`${o}Table`,u=`${c}FieldCell`,d=`${c}ValueCell`,p=`${c}AlertCountCell`,m=`${c}DocCountCell`,y=`${c}HostPrevalenceCell`,g=`${c}UserPrevalenceCell`,f=`${c}UpsellCell`,b=`${n.a}EntitiesDetails`,h=`${n.a}UsersDetails`,v=`${h}RelatedHostsTable`,E=`${n.a}HostsDetails`,x=`${E}RelatedUsersTable`,k=`${n.a}ThreatIntelligenceDetailsLoading`,w=`${n.a}CorrelationsDetails`,j=`${w}AlertsByAncestrySection`,S=`${w}AlertsBySourceSection`,O=`${w}AlertsBySessionSection`,I=`${w}CasesSection`,C=`${I}Table`,M=`${w}SuppressedAlertsSection`,T=`${w}SuppressedAlertsSectionTechnicalPreview`,_=`${n.a}Response`,N=`${_}Details`,D=`${_}NoData`,A=`${n.a}InvestigationGuide`,q=`${A}Loading`},225:function(e,t,a){const n=a(173);e.exports=(e,t,a)=>new n(e,a).compare(new n(t,a))},231:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"h",(function(){return o})),a.d(t,"f",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"j",(function(){return p})),a.d(t,"i",(function(){return m}));var n=a(9);a(350);const r=e=>{if(null!=e){const t=e.trim().split(/[ \t\r\n]+/);return"sequence"===t[0]&&"where"!==t[1]}return!1},i=e=>"eql"===e,o=e=>"threshold"===e,s=e=>"query"===e||"saved_query"===e,l=e=>"threat_match"===e,c=e=>"machine_learning"===e,u=e=>"new_terms"===e,d=e=>"esql"===e,p=e=>Array.isArray(e)?e:Object(n.isEmpty)(e)?[]:[e],m=e=>Array.isArray(e)?e:[e]},267:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"e",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"f",(function(){return p})),a.d(t,"g",(function(){return m}));var n=a(17),r=a(45),i=a(44),o=a.n(i);const s="details",l=o.a.div.attrs((()=>({className:s}))).withConfig({displayName:"Details",componentId:"sc-1ucey7j-0"})(["margin:5px 0 5px 10px;& .euiBadge{margin:2px 0 2px 0;}& .euiFlexGroup{justify-content:center;}"]);l.displayName="Details";const c=o()(n.EuiFlexItem).withConfig({displayName:"TokensFlexItem",componentId:"sc-1ucey7j-1"})(["margin-left:3px;"]);function u(e){return Object(r.isNumber)(e)?!isFinite(e):Object(r.isEmpty)(e)}c.displayName="TokensFlexItem";const d=({eventCategory:e,eventDataset:t})=>"file"===(null==e?void 0:e.toLowerCase())||"file"===(null==t?void 0:t.toLowerCase())||"endpoint.events.file"===(null==t?void 0:t.toLowerCase()),p=e=>["process_stopped","termination_event"].includes(`${e}`.toLowerCase()),m=e=>["created","creation","deleted","deletion","file_create_event","file_delete_event","files-encrypted","load","modification","overwrite","rename"].includes(`${e}`.toLowerCase())},306:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(2),r=a.n(n),i=a(17),o=a(44),s=a.n(o),l=a(55),c=a(1061),u=a(666);const d=s.a.div.withConfig({displayName:"RiskBadge",componentId:"sc-1t9tm5r-0"})(["",""],(({theme:e,$severity:t,$hideBackgroundColor:a})=>Object(o.css)(["width:fit-content;padding-right:",";padding-left:",";",";"],e.eui.euiSizeS,e.eui.euiSizeXS,("Critical"===t||"High"===t)&&!a&&Object(o.css)(["background-color:",";border-radius:999px;"],Object(i.transparentize)(e.eui.euiColorDanger,.2))))),p=s.a.div.withConfig({displayName:"TooltipContainer",componentId:"sc-1t9tm5r-1"})(["padding:",";"],(({theme:e})=>e.eui.euiSizeS)),m=({severity:e,hideBackgroundColor:t=!1,toolTipContent:a})=>{const n=r.a.createElement(d,{color:l.euiLightVars.euiColorDanger,$severity:e,$hideBackgroundColor:t,"data-test-subj":"risk-score"},r.a.createElement(i.EuiHealth,{className:"eui-alignMiddle",color:c.b[e]},e));return null!=a?r.a.createElement(u.a,{hoverContent:r.a.createElement(p,null,a),render:()=>n}):n}},307:function(e,t,a){"use strict";let n,r,i;a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return i})),function(e){e.defineRule="define-rule",e.aboutRule="about-rule",e.scheduleRule="schedule-rule",e.ruleActions="rule-actions"}(n||(n={})),function(e){e.IndexPatterns="indexPatterns",e.DataView="dataView"}(r||(r={})),function(e){e.PerRuleExecution="per-rule-execution",e.PerTimePeriod="per-time-period"}(i||(i={}))},340:function(e,t,a){"use strict";a.d(t,"h",(function(){return E})),a.d(t,"g",(function(){return k})),a.d(t,"b",(function(){return j})),a.d(t,"f",(function(){return O})),a.d(t,"c",(function(){return M})),a.d(t,"i",(function(){return N})),a.d(t,"d",(function(){return z})),a.d(t,"e",(function(){return B})),a.d(t,"a",(function(){return G}));var n=a(65),r=a.n(n),i=a(56),o=a.n(i),s=a(234),l=a.n(s),c=(a(49),a(44)),u=a.n(c),d=a(17),p=a(175),m=a(182),y=a(231),g=a(143),f=a(1156),b=a(307),h=a(1369),v=a(27);const E=({rule:e,detailsView:t=!1})=>{const a=w(e);return{aboutRuleData:I(e,t),modifiedAboutRuleDetailsData:_(e),defineRuleData:a,scheduleRuleData:S(e),ruleActionsData:x(e)}},x=e=>{const{enabled:t,meta:a,actions:n=[],response_actions:r}=e;return{actions:null==n?void 0:n.map((e=>Object(f.d)(e))),responseActions:null==r?void 0:r.map(f.e),kibanaSiemAppUrl:"string"==typeof(null==a?void 0:a.kibana_siem_app_url)?a.kibana_siem_app_url:void 0,enabled:t}},k=e=>{if("machine_learning"===e.type)return"string"==typeof e.machine_learning_job_id?[e.machine_learning_job_id]:e.machine_learning_job_id},w=e=>{var t,a,n,r,i,o,s,l,c,u,d;return{ruleType:e.type,anomalyThreshold:"anomaly_threshold"in e?e.anomaly_threshold:50,machineLearningJobId:k(e)||[],index:"index"in e&&e.index||[],dataViewId:"data_view_id"in e?e.data_view_id:void 0,threatIndex:"threat_index"in e&&e.threat_index||[],threatQueryBar:{query:{query:"threat_query"in e&&e.threat_query||"",language:"threat_language"in e&&e.threat_language||""},filters:"threat_filters"in e&&e.threat_filters||[],saved_id:null},threatMapping:"threat_mapping"in e&&e.threat_mapping||[],queryBar:{query:{query:"query"in e&&e.query||"",language:"language"in e&&e.language||""},filters:"filters"in e&&e.filters||[],saved_id:"saved_id"in e&&e.saved_id||null},relatedIntegrations:null!==(t=e.related_integrations)&&void 0!==t?t:[],requiredFields:null!==(a=e.required_fields)&&void 0!==a?a:[],timeline:{id:null!==(n=e.timeline_id)&&void 0!==n?n:null,title:null!==(r=e.timeline_title)&&void 0!==r?r:null},threshold:{field:Object(y.j)("threshold"in e?null===(i=e.threshold)||void 0===i?void 0:i.field:void 0),value:`${"threshold"in e&&(null===(o=e.threshold)||void 0===o?void 0:o.value)||100}`,..."threshold"in e&&null!==(s=e.threshold)&&void 0!==s&&null!==(l=s.cardinality)&&void 0!==l&&l.length?{cardinality:{field:[`${e.threshold.cardinality[0].field}`],value:`${e.threshold.cardinality[0].value}`}}:{}},eqlOptions:{timestampField:"timestamp_field"in e?e.timestamp_field:void 0,eventCategoryField:"event_category_override"in e?e.event_category_override:void 0,tiebreakerField:"tiebreaker_field"in e?e.tiebreaker_field:void 0},dataSourceType:"data_view_id"in e&&e.data_view_id?b.a.DataView:b.a.IndexPatterns,newTermsFields:"new_terms_fields"in e&&e.new_terms_fields||[],historyWindowSize:"history_window_start"in e&&e.history_window_start?j(e.history_window_start):"7d",shouldLoadQueryDynamically:Boolean("saved_query"===e.type&&e.saved_id),groupByFields:"alert_suppression"in e&&e.alert_suppression&&"group_by"in e.alert_suppression&&e.alert_suppression.group_by||[],groupByRadioSelection:"alert_suppression"in e&&null!==(c=e.alert_suppression)&&void 0!==c&&c.duration?b.b.PerTimePeriod:b.b.PerRuleExecution,groupByDuration:"alert_suppression"in e&&(null===(u=e.alert_suppression)||void 0===u?void 0:u.duration)||{value:5,unit:"m"},suppressionMissingFields:"alert_suppression"in e&&e.alert_suppression&&"missing_fields_strategy"in e.alert_suppression&&e.alert_suppression.missing_fields_strategy||v.a,enableThresholdSuppression:Boolean("alert_suppression"in e&&(null===(d=e.alert_suppression)||void 0===d?void 0:d.duration))}},j=e=>e.startsWith("now-")?e.substring(4):e,S=e=>{const{interval:t,from:a}=e;return{interval:t,from:O(a,t)}},O=(e,t)=>{var a,n;const i=null!==(a=r.a.parse(e))&&void 0!==a?a:o()(),s=null!==(n=r.a.parse(`now-${t}`))&&void 0!==n?n:o()(),l=o.a.duration(s.diff(i)),c=Math.floor(l.asSeconds());return 0===c?"0s":c%3600==0?c/3600+"h":c%60==0?c/60+"m":`${c}s`},I=(e,t)=>{var a,n;const{name:r,description:i,note:o}=T(e,t),{author:s,building_block_type:l,exceptions_list:c,license:u,risk_score_mapping:d,rule_name_override:y,severity_mapping:g,timestamp_override:f,timestamp_override_fallback_disabled:b,references:h,severity:v,false_positives:E,risk_score:x,investigation_fields:k,tags:w,threat:j}=e,S="threat_indicator_path"in e?e.threat_indicator_path:void 0;return{author:s,isAssociatedToEndpointList:null!==(a=null==c?void 0:c.some((({id:e})=>e===p.k)))&&void 0!==a&&a,isBuildingBlock:void 0!==l,license:null!=u?u:"",ruleNameOverride:null!=y?y:"",timestampOverride:null!=f?f:"",timestampOverrideFallbackDisabled:b,name:r,description:i,note:o,references:h,severity:{value:v,mapping:M(g),isMappingChecked:g.length>0},tags:w,riskScore:{value:x,mapping:Object(m.d)(d),isMappingChecked:d.length>0},falsePositives:E,investigationFields:null!==(n=null==k?void 0:k.field_names)&&void 0!==n?n:[],threat:j,threatIndicatorPath:S}},C={low:0,medium:1,high:2,critical:3},M=e=>{const t=h.i.flatMap((t=>null==e.find((e=>e.severity===t.value))?[{field:"",value:"",operator:"equals",severity:t.value}]:[]));return[...e,...t].sort(((e,t)=>C[e.severity]-C[t.severity]))},T=(e,t)=>{const{name:a,description:n,note:r}=e;return t?{name:"",description:"",note:""}:{name:a,description:n,note:null!=r?r:""}},_=e=>{var t,a;return{note:null!==(t=e.note)&&void 0!==t?t:"",description:e.description,setup:null!==(a=e.setup)&&void 0!==a?a:""}},N=(e,t,a,n)=>!1===e||!1===t||!1===a||n,D=["id","name","description","false_positives","investigation_fields","rule_id","max_signals","risk_score","output_index","references","severity","timeline_id","timeline_title","threat","type","version"],A=["index","filters","language","query","saved_id","response_actions"],q=["filters","language","query","response_actions"],F=["anomaly_threshold","machine_learning_job_id"],L=["threshold",...A],R=e=>{switch(e){case"machine_learning":return F;case"threshold":return L;case"esql":return q;case"new_terms":case"threat_match":case"query":case"saved_query":case"eql":return A}Object(g.a)(e)},P=e=>({state:[{name:"signals_count",description:"state.signals_count"}],params:[],context:[{name:"results_link",description:"context.results_link",useWithTripleBracesInTemplates:!0},{name:"alerts",description:"context.alerts"},...e.map((e=>{const t=`rule.${e}`;return{name:t,description:`context.${t}`}}))]}),z=l()((e=>{if(!e)return{state:[],params:[]};const t=(e=>[...D,...R(e)].sort())(e);return P(t)})),B=()=>P((()=>{const e=[...D,...A,...F,...L].sort();return Array.from(new Set(e))})()),G=u()(d.EuiFlexItem).withConfig({displayName:"MaxWidthEuiFlexItem",componentId:"sc-15hicli-0"})(["max-width:1000px;overflow:hidden;"])},348:function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return p})),a.d(t,"d",(function(){return m})),a.d(t,"a",(function(){return g}));var n=a(5),r=a(125);const i=n.i18n.translate("xpack.securitySolution.riskScore.overview.hostTitle",{defaultMessage:"Host"}),o=n.i18n.translate("xpack.securitySolution.riskScore.overview.hosts",{defaultMessage:"Hosts"}),s=n.i18n.translate("xpack.securitySolution.riskScore.overview.userTitle",{defaultMessage:"User"}),l=n.i18n.translate("xpack.securitySolution.riskScore.overview.users",{defaultMessage:"Users"}),c=n.i18n.translate("xpack.securitySolution.riskScore.overview.entityTitle",{defaultMessage:"Entity"}),u=n.i18n.translate("xpack.securitySolution.riskScore.overview.entities",{defaultMessage:"Entities"}),d=e=>n.i18n.translate("xpack.securitySolution.riskScore.overview.riskScoreTitle",{defaultMessage:"{riskEntity} Risk Score",values:{riskEntity:m(e)}}),p=e=>n.i18n.translate("xpack.securitySolution.entityAnalytics.riskDashboard.riskLevelTitle",{defaultMessage:"{riskEntity} risk level",values:{riskEntity:m(e)}}),m=(e,t=!1,a=!1)=>{const n=y(e,a);return t?n.toLowerCase():n},y=(e,t)=>{switch(e){case r.v.host:return t?o:i;case r.v.user:return t?l:s;default:return t?u:c}},g=n.i18n.translate("xpack.securitySolution.riskScore.overview.alerts",{defaultMessage:"Alerts"})},529:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(17),r=a(345),i=a(2),o=a.n(i),s=a(44),l=a.n(s);const c=l.a.aside.withConfig({displayName:"Aside",componentId:"sc-tazcmx-0"})(["padding:",";",""],(({theme:e})=>e.eui.euiSizeM),(({overlay:e,overlayBackground:t,theme:a})=>e&&Object(s.css)(["background:",";bottom:0;left:0;position:absolute;right:0;top:0;z-index:",";"],t?Object(r.rgba)(t,.9):Object(r.rgba)(a.eui.euiColorEmptyShade,.9),a.eui.euiZLevel1)));c.displayName="Aside";const u=l()(n.EuiFlexGroup).attrs((()=>({alignItems:"center",direction:"column",gutterSize:"s",justifyContent:"center"}))).withConfig({displayName:"FlexGroup",componentId:"sc-tazcmx-1"})(["",""],(({overlay:e})=>e&&Object(s.css)(["height:100%;"])));u.displayName="FlexGroup";const d=o.a.memo((({children:e,overlay:t,overlayBackground:a,size:r})=>o.a.createElement(c,{overlay:t,overlayBackground:a},o.a.createElement(u,{overlay:{overlay:t}},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:r})),e&&o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiText,{color:"subdued",size:"s"},o.a.createElement("p",null,e)))))));d.displayName="Loader"},532:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(50),r=a(2),i=a(4),o=a(163),s=a(337);const l=["GET",i.kb],c=(e,t)=>Object(n.useQuery)([...l,e],(async({signal:t})=>{const a=await Object(o.j)({signal:t,...e});return{rules:a.data,total:a.total}}),{...s.a,staleTime:0,...t}),u=()=>{const e=Object(n.useQueryClient)();return Object(r.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])},d=()=>{const e=Object(n.useQueryClient)();return Object(r.useCallback)((t=>{e.setQueriesData(l,(e=>e?{rules:p(e.rules,t),total:e.total}:void 0))}),[e])};function p(e,t){const a=new Map(t.map((e=>[e.id,e])));return e.some((e=>a.has(e.id)))?e.map((e=>{var t;return null!==(t=a.get(e.id))&&void 0!==t?t:e})):e}},568:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"g",(function(){return i})),a.d(t,"h",(function(){return o})),a.d(t,"j",(function(){return s})),a.d(t,"k",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"o",(function(){return u})),a.d(t,"n",(function(){return d})),a.d(t,"m",(function(){return p})),a.d(t,"l",(function(){return m})),a.d(t,"u",(function(){return y})),a.d(t,"t",(function(){return g})),a.d(t,"s",(function(){return f})),a.d(t,"r",(function(){return b})),a.d(t,"d",(function(){return h})),a.d(t,"b",(function(){return v})),a.d(t,"a",(function(){return E})),a.d(t,"c",(function(){return x})),a.d(t,"p",(function(){return k})),a.d(t,"q",(function(){return w})),a.d(t,"f",(function(){return j})),a.d(t,"v",(function(){return S})),a.d(t,"w",(function(){return O}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights",{defaultMessage:"Insights"}),i=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry",{defaultMessage:"Related alerts by process ancestry"}),o=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} by process ancestry",values:{count:e}}),s=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_error",{defaultMessage:"Failed to fetch alerts."}),l=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.processAncestryFilter",{defaultMessage:"Process Ancestry Alert IDs"}),c=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_process_ancestry_empty",{defaultMessage:"There are no related alerts by process ancestry."}),u=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),d=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_error",{defaultMessage:"Failed to load related alerts by session"}),p=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_empty",{defaultMessage:"There are no related alerts by session"}),m=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_session_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by session",values:{count:e}}),y=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_loading",{defaultMessage:"Loading related alerts by source event"}),g=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_error",{defaultMessage:"Failed to load related alerts by source event"}),f=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_alerts_by_source_event_empty",{defaultMessage:"There are no related alerts by source event"}),b=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights_related_alerts_by_source_event_count",{defaultMessage:"{count} {count, plural, =1 {alert} other {alerts}} related by source event",values:{count:e}}),h=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_loading",{defaultMessage:"Loading related cases"}),v=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_error",{defaultMessage:"Failed to load related cases"}),E=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.related_cases_count",{defaultMessage:"{count} {count, plural, =1 {case} other {cases}} related to this alert",values:{count:e}}),x=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.relatedCasesFailure",{defaultMessage:'Unable to load related cases: "{error}"',values:{error:e}}),k=n.i18n.translate("xpack.securitySolution.alertDetails.overview.simpleAlertTable.error",{defaultMessage:"Failed to load the alerts."}),w=n.i18n.translate("xpack.securitySolution.alertDetails.overview.limitedAlerts",{defaultMessage:"Showing only the latest 10 alerts. View the rest of alerts in timeline."}),j=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.alertUpsellTitle",{defaultMessage:"Get more insights with a platinum subscription"}),S=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCount",{defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:e}}),O=n.i18n.translate("xpack.securitySolution.alertDetails.overview.insights.suppressedAlertsCountTechnicalPreview",{defaultMessage:"Technical Preview"})},572:function(e,t,a){"use strict";a.d(t,"b",(function(){return F})),a.d(t,"a",(function(){return L}));var n=a(1425),r=a(2),i=a.n(r),o=a(544),s=a(174),l=a(126),c=a(153),u=a(564),d=a(1489);const p={isInstance:(e,t)=>((e,t)=>-1===t.findIndex((t=>t.field===e)))(e,t),renderColumn:({columnName:e,eventId:t,field:a,isDraggable:n=!0,scopeId:r,truncate:p})=>n?i.a.createElement(o.b,{dataProvider:{enabled:!0,id:Object(s.i)(`empty-column-renderer-draggable-wrapper-${r}-${e}-${t}-${a.id}`),name:`${e}: ${Object(d.a)(null)}`,queryMatch:{field:a.id,value:Object(d.a)(null),displayValue:Object(l.e)(),operator:c.b},excluded:!0,kqlQuery:"",and:[]},isDraggable:n,key:`empty-column-renderer-draggable-wrapper-${r}-${e}-${t}-${a.id}`,render:(e,t,a)=>a.isDragging?i.a.createElement(o.a,null,i.a.createElement(u.a,{dataProvider:e})):i.a.createElement("span",null,Object(l.e)()),truncate:p,scopeId:r}):i.a.createElement("span",null,Object(l.e)())};var m=a(1501),y=a(45),g=a(1080);const f={isInstance:(e,t)=>((e,t)=>-1!==t.findIndex((t=>t.field===e)))(e,t),renderColumn:({asPlainText:e,columnName:t,eventId:a,field:n,isDraggable:r=!0,scopeId:o,truncate:s,values:c,linkValues:u})=>{return Array.isArray(c)&&0!==c.length?r?c.map(((l,c)=>{var d,p,m;return i.a.createElement(g.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${o}`,eventId:a,fieldFormat:null!==(d=n.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=n.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=n.type)&&void 0!==m?m:"",isDraggable:r,key:`plain-column-renderer-formatted-field-value-${o}-${t}-${a}-${n.id}-${l}-${c}`,linkValue:Object(y.head)(u),truncate:s,value:l})})):i.a.createElement(g.a,{asPlainText:e,contextId:`plain-column-renderer-formatted-field-value-${o}`,eventId:a,fieldFormat:null!==(d=n.format)&&void 0!==d?d:"",fieldName:t,isAggregatable:null!==(p=n.aggregatable)&&void 0!==p&&p,fieldType:null!==(m=n.type)&&void 0!==m?m:"",isDraggable:r,key:`plain-column-renderer-formatted-field-value-${o}-${t}-${a}-${n.id}`,linkValue:Object(y.head)(u),truncate:s,value:b(c)}):Object(l.d)();var d,p,m}};function b(e){return Array.isArray(e)?e.length>0?e.join(", "):e[0]:e}var h=a(1525);const v={isInstance:()=>!0,renderColumn:()=>Object(l.d)()};var E=a(1526),x=a(687),k=a(1523),w=a(17),j=a(124),S=a(285),O=a(960);const I={isInstance:Object(y.isEqual)(S.k),renderColumn:({columnName:e,ecsData:t,eventId:a,field:n,isDetails:r,isDraggable:o=!0,linkValues:s,rowRenderers:l=[],scopeId:c,truncate:u,values:d})=>r&&d&&t&&l?d.map(((r,o)=>i.a.createElement(C,{ecsData:t,key:`reason-column-renderer-value-${c}-${e}-${a}-${n.id}-${r}-${o}`,rowRenderers:l,scopeId:c,value:r}))):f.renderColumn({columnName:e,eventId:a,field:n,isDetails:r,isDraggable:o,linkValues:s,scopeId:c,truncate:u,values:d})},C=({ecsData:e,rowRenderers:t,scopeId:a,value:n})=>{const o=Object(r.useMemo)((()=>Object(O.a)({data:e,rowRenderers:t})),[e,t]),s=Object(r.useMemo)((()=>o&&o.renderRow({data:e,isDraggable:!1,scopeId:a})),[o,e,a]),l=Object(r.useMemo)((()=>a===j.e.rulePreview),[a]);return i.a.createElement(i.a.Fragment,null,o&&s&&!l?i.a.createElement(w.EuiPanel,{color:"subdued",className:"eui-xScroll","data-test-subj":"reason-cell-renderer"},i.a.createElement(w.EuiText,{size:"xs"},i.a.createElement("div",{className:"eui-displayInlineBlock"},s))):n)};var M=a(44);const T=a.n(M)()(w.EuiFlexItem).withConfig({displayName:"EventRenderedFlexItem",componentId:"sc-1jiiiew-0"})(["div:first-child{padding-left:0px;div{margin:0px;}}"]),_={isInstance:Object(y.isEqual)(S.d),renderColumn:({ecsData:e,columnName:t,eventId:a,field:n,isDetails:r,linkValues:o,rowRenderers:s=[],scopeId:l,truncate:c,values:u})=>e&&s?i.a.createElement(N,{ecsData:e,key:`reason-column-renderer-value-${l}-${t}-${a}-${n.id}`,rowRenderers:s,scopeId:l,values:u}):f.renderColumn({columnName:t,eventId:a,field:n,isDetails:r,isDraggable:!1,linkValues:o,scopeId:l,truncate:c,values:u})},N=({ecsData:e,rowRenderers:t,scopeId:a,values:n})=>{const o=Object(r.useMemo)((()=>Object(O.a)({data:e,rowRenderers:t})),[e,t]),s=Object(r.useMemo)((()=>o&&o.renderRow({data:e,isDraggable:!1,scopeId:a})),[o,e,a]);return i.a.createElement(w.EuiFlexGroup,{gutterSize:"none",direction:"column",className:"eui-fullWidth"},o&&s?i.a.createElement(T,{className:"eui-xScroll"},i.a.createElement("div",{className:"eui-displayInlineBlock",style:{width:"fit-content"}},s)):n&&i.a.createElement(w.EuiFlexItem,{"data-test-subj":"plain-text-reason"},n))};var D=a(1540),A=a(1505);const q={isInstance:(e,t,a)=>A.a.includes(e)&&!!a,renderColumn:({columnName:e,ecsData:t,eventId:a,field:n,isDetails:r,isDraggable:o=!0,linkValues:s,rowRenderers:l=[],scopeId:c,truncate:u,values:d,context:p})=>{var m;if(null!=p&&p.isLoading)return i.a.createElement(w.EuiLoadingSpinner,{size:"s"});const y=null!==(m=null==d?void 0:d.map((e=>{var t;return null==p||null===(t=p.profiles)||void 0===t?void 0:t.find((t=>e===t.uid))})))&&void 0!==m?m:[];return i.a.createElement(D.a,{userProfiles:y,maxVisibleAvatars:4})}},F=[k.a,...n.a,...x.k,h.a,E.a,m.a],L=[I,_,q,f,p,v]},576:function(e,t,a){"use strict";a.d(t,"B",(function(){return r})),a.d(t,"y",(function(){return i})),a.d(t,"A",(function(){return o})),a.d(t,"z",(function(){return s})),a.d(t,"x",(function(){return l})),a.d(t,"w",(function(){return c})),a.d(t,"q",(function(){return u})),a.d(t,"p",(function(){return d})),a.d(t,"u",(function(){return p})),a.d(t,"t",(function(){return m})),a.d(t,"X",(function(){return y})),a.d(t,"Z",(function(){return g})),a.d(t,"V",(function(){return f})),a.d(t,"W",(function(){return b})),a.d(t,"Y",(function(){return h})),a.d(t,"j",(function(){return v})),a.d(t,"O",(function(){return E})),a.d(t,"E",(function(){return x})),a.d(t,"F",(function(){return k})),a.d(t,"s",(function(){return w})),a.d(t,"k",(function(){return j})),a.d(t,"o",(function(){return S})),a.d(t,"gb",(function(){return O.T})),a.d(t,"m",(function(){return O.p})),a.d(t,"C",(function(){return O.u})),a.d(t,"r",(function(){return O.s})),a.d(t,"v",(function(){return O.t})),a.d(t,"n",(function(){return O.r})),a.d(t,"nb",(function(){return O.cb})),a.d(t,"db",(function(){return O.Q})),a.d(t,"mb",(function(){return O.bb})),a.d(t,"bb",(function(){return O.O})),a.d(t,"cb",(function(){return O.P})),a.d(t,"pb",(function(){return O.eb})),a.d(t,"D",(function(){return O.v})),a.d(t,"eb",(function(){return O.R})),a.d(t,"jb",(function(){return O.X})),a.d(t,"lb",(function(){return O.Z})),a.d(t,"kb",(function(){return O.Y})),a.d(t,"R",(function(){return O.H})),a.d(t,"Q",(function(){return O.F})),a.d(t,"T",(function(){return O.J})),a.d(t,"S",(function(){return O.I})),a.d(t,"P",(function(){return O.E})),a.d(t,"ab",(function(){return O.N})),a.d(t,"a",(function(){return O.c})),a.d(t,"U",(function(){return O.K})),a.d(t,"fb",(function(){return O.S})),a.d(t,"b",(function(){return O.d})),a.d(t,"i",(function(){return O.m})),a.d(t,"l",(function(){return O.o})),a.d(t,"h",(function(){return O.l})),a.d(t,"f",(function(){return O.j})),a.d(t,"g",(function(){return O.k})),a.d(t,"d",(function(){return O.h})),a.d(t,"e",(function(){return O.i})),a.d(t,"c",(function(){return O.e})),a.d(t,"ob",(function(){return O.db})),a.d(t,"ib",(function(){return O.W})),a.d(t,"hb",(function(){return O.U})),a.d(t,"G",(function(){return O.w})),a.d(t,"M",(function(){return O.C})),a.d(t,"K",(function(){return O.A})),a.d(t,"J",(function(){return O.z})),a.d(t,"L",(function(){return O.B})),a.d(t,"N",(function(){return O.D})),a.d(t,"H",(function(){return O.x})),a.d(t,"I",(function(){return O.y}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_title",{defaultMessage:"Create exceptions to this list"}),i=e=>n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_body",{values:{listName:e},defaultMessage:"There is no exception in your [{listName}]. Create rule exceptions to this list."}),o=n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button_endpoint",{defaultMessage:"Create endpoint exception"}),s=n.i18n.translate("xpack.securitySolution.exception.list.empty.viewer_button",{defaultMessage:"Create rule exception"}),l=n.i18n.translate("xpack.securitySolution.exception.list.search_bar_button_enpoint",{defaultMessage:"Add endpoint exception to list"}),c=n.i18n.translate("xpack.securitySolution.exception.list.search_bar_button",{defaultMessage:"Add rule exception to list"}),u=(n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorTitle",{defaultMessage:"Error searching"}),n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemSearchErrorBody",{defaultMessage:"An error occurred searching for exception items. Please try again."}),n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchError",{defaultMessage:"Unable to load exception items"})),d=n.i18n.translate("xpack.securitySolution.exceptions.list.exceptionItemsFetchErrorDescription",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),p=n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessTitle",{defaultMessage:"Exception deleted"}),m=e=>n.i18n.translate("xpack.securitySolution.exceptions.list.exception.item.card.exceptionItemDeleteSuccessText",{values:{itemName:e},defaultMessage:'"{itemName}" deleted successfully.'}),y=n.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_cancel",{defaultMessage:"Cancel"}),g=n.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_save",{defaultMessage:"Save"}),f=n.i18n.translate("xpack.securitySolution.exceptions.list.link_rules_header",{defaultMessage:"Link rules"}),b=n.i18n.translate("xpack.securitySolution.exceptions.list.link_rules_overflow_button_title",{defaultMessage:"Link rules"}),h=n.i18n.translate("xpack.securitySolution.exceptions.list.manage_rules_description",{defaultMessage:"Link or unlink rules to this exception list."}),v=n.i18n.translate("xpack.securitySolution.exceptionsTable.deleteExceptionList",{defaultMessage:"Delete exception list"}),E=n.i18n.translate("xpack.securitySolution.exceptionsTable.exportExceptionList",{defaultMessage:"Export exception list"}),x=n.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesError",{defaultMessage:"Manage rules error"}),k=n.i18n.translate("xpack.securitySolution.exceptionsTable.manageRulesErrorDescription",{defaultMessage:"An error occurred linking or unlinking rules"}),w=n.i18n.translate("xpack.securitySolution.exceptionsTable.exportListDescription",{defaultMessage:"An error occurred exporting a list"}),j=n.i18n.translate("xpack.securitySolution.exceptionsTable.duplicateExceptionList",{defaultMessage:"Duplicate exception list"}),S=n.i18n.translate("xpack.securitySolution.exceptionsTable.duplicateListDescription",{defaultMessage:"An error occurred duplicating a list"});a(1372);var O=a(1373)},603:function(e,t,a){const n=a(225);e.exports=(e,t,a)=>n(e,t,a)<=0},667:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(17),r=a(2),i=a.n(r),o=a(214);const s=({dataTestSubj:e,descriptionList:t})=>i.a.createElement(n.EuiFlexItem,{grow:!0},i.a.createElement(o.d,{"data-test-subj":e,listItems:t}))},670:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return y})),a.d(t,"c",(function(){return g}));var n=a(114),r=a(45),i=a(2),o=a(285),s=a(1367),l=a(1101),c=a(424),u=a(878),d=a(272),p=a(151);const m=(e,t,a,r=p.e,i=!1)=>({and:[],enabled:!0,id:Object(n.j)(t),name:e,excluded:i,kqlQuery:"",queryMatch:{field:e,value:a,operator:r,displayValue:Object(c.d)(a)}}),y=(e,t,a,n=p.e,r=!1)=>{const{and:i,...o}=m(e,t,a,n,r);return o},g=({contextId:e,eventId:t,field:a,fieldFormat:n,fieldFromBrowserField:c,fieldType:p,isObjectArray:y,linkValue:g,values:f})=>Object(i.useMemo)((()=>{if(null==f)return null;const i=Array.isArray(f)?f:[f];let b=[];return i.length>1&&(b=[{meta:{},query:{bool:{must:i.map((e=>({term:{[a]:e}})))}}}]),i.reduce(((i,b,h)=>{let v="",E=Object(r.isString)(b)?b:`${f}`;const x=`${e}-${t}-${a}-${h}-${b}`;if(null==c)return i.values.push(E),i;if(y||p===o.f||[o.i].includes(a))return i.values.push(E),i;if(p===o.h){if(v=`formatted-ip-data-provider-${e}-${a}-${b}-${t}`,Object(r.isString)(b)&&!Object(r.isEmpty)(b)){let e=b;try{e=JSON.parse(b)}catch(e){}return Object(r.isArray)(e)&&(E=e.join(","),e.forEach((e=>i.dataProviders.push(m(a,v,e))))),i.dataProviders.push(m(a,v,e)),i.values.push(E),i}}else u.b.some((e=>a===e))?v=`port-default-draggable-${x}`:a===l.b?v=`duration-default-draggable-${x}`:a===o.g?v=`event-details-value-default-draggable-${x}`:n===s.a?v=`bytes-default-draggable-${x}`:a===o.n?v=`event-details-value-default-draggable-${x}-${g}`:a===o.c?v=`event-details-value-default-draggable-${x}-${b}`:a===o.o?v=`alert-details-value-default-draggable-${x}`:a===o.a?(v=`event-details-value-default-draggable-${x}`,E="string"==typeof b?b:""):v=[o.m,o.l,o.e,d.j].includes(a)?`event-details-value-default-draggable-${x}-${b}`:`event-details-value-default-draggable-${x}`;return i.values.push(E),i.dataProviders.push(m(a,v,b)),i}),{values:[],dataProviders:[],filters:b})}),[e,t,a,n,c,p,y,g,f])},672:function(e,t,a){"use strict";a.d(t,"W",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"g",(function(){return s})),a.d(t,"r",(function(){return l})),a.d(t,"A",(function(){return c})),a.d(t,"B",(function(){return u})),a.d(t,"H",(function(){return d})),a.d(t,"e",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"i",(function(){return y})),a.d(t,"n",(function(){return g})),a.d(t,"q",(function(){return f})),a.d(t,"s",(function(){return b})),a.d(t,"t",(function(){return h})),a.d(t,"u",(function(){return v})),a.d(t,"v",(function(){return E})),a.d(t,"E",(function(){return x})),a.d(t,"k",(function(){return k})),a.d(t,"G",(function(){return w})),a.d(t,"F",(function(){return j})),a.d(t,"m",(function(){return S})),a.d(t,"l",(function(){return O})),a.d(t,"j",(function(){return I})),a.d(t,"p",(function(){return C})),a.d(t,"J",(function(){return M})),a.d(t,"o",(function(){return T})),a.d(t,"I",(function(){return _})),a.d(t,"z",(function(){return N})),a.d(t,"h",(function(){return D})),a.d(t,"w",(function(){return A})),a.d(t,"d",(function(){return q})),a.d(t,"a",(function(){return F})),a.d(t,"y",(function(){return L})),a.d(t,"x",(function(){return R})),a.d(t,"K",(function(){return P})),a.d(t,"L",(function(){return z})),a.d(t,"M",(function(){return B})),a.d(t,"D",(function(){return G})),a.d(t,"C",(function(){return $})),a.d(t,"N",(function(){return H})),a.d(t,"R",(function(){return V})),a.d(t,"P",(function(){return U})),a.d(t,"T",(function(){return W})),a.d(t,"Q",(function(){return Y})),a.d(t,"U",(function(){return Z})),a.d(t,"O",(function(){return K})),a.d(t,"S",(function(){return Q})),a.d(t,"V",(function(){return X}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.system.withResultDescription",{defaultMessage:"with result"}),i=n.i18n.translate("xpack.securitySolution.system.acceptedAConnectionViaDescription",{defaultMessage:"accepted a connection via"}),o=n.i18n.translate("xpack.securitySolution.system.attemptedLoginDescription",{defaultMessage:"attempted a login via"}),s=n.i18n.translate("xpack.securitySolution.system.disconnectedViaDescription",{defaultMessage:"disconnected via"}),l=n.i18n.translate("xpack.securitySolution.system.loggedOutDescription",{defaultMessage:"logged out via"}),c=(n.i18n.translate("xpack.securitySolution.system.usingDescription",{defaultMessage:"using"}),n.i18n.translate("xpack.securitySolution.system.processStartedDescription",{defaultMessage:"started process"})),u=n.i18n.translate("xpack.securitySolution.system.processStoppedDescription",{defaultMessage:"stopped process"}),d=n.i18n.translate("xpack.securitySolution.system.terminatedProcessDescription",{defaultMessage:"terminated process"}),p=n.i18n.translate("xpack.securitySolution.system.createdFileDescription",{defaultMessage:"created a file"}),m=n.i18n.translate("xpack.securitySolution.system.deletedFileDescription",{defaultMessage:"deleted a file"}),y=n.i18n.translate("xpack.securitySolution.rowRenderer.executedProcessDescription",{defaultMessage:"executed process"}),g=n.i18n.translate("xpack.securitySolution.rowRenderer.forkedProcessDescription",{defaultMessage:"forked process"}),f=n.i18n.translate("xpack.securitySolution.rowRenderer.loadedLibraryDescription",{defaultMessage:"loaded library"}),b=n.i18n.translate("xpack.securitySolution.rowRenderer.madeAHttpRequestViaDescription",{defaultMessage:"made a http request via"}),h=n.i18n.translate("xpack.securitySolution.rowRenderer.modifiedFileDescription",{defaultMessage:"modified a file"}),v=n.i18n.translate("xpack.securitySolution.rowRenderer.modifiedRegistryKeyDescription",{defaultMessage:"modified registry key"}),E=n.i18n.translate("xpack.securitySolution.rowRenderer.overwroteFileDescription",{defaultMessage:"overwrote a file"}),x=n.i18n.translate("xpack.securitySolution.rowRenderer.renamedFileDescription",{defaultMessage:"renamed a file"}),k=n.i18n.translate("xpack.securitySolution.system.existingProcessDescription",{defaultMessage:"is running process"}),w=n.i18n.translate("xpack.securitySolution.system.socketOpenedDescription",{defaultMessage:"opened a socket with"}),j=n.i18n.translate("xpack.securitySolution.system.socketClosedDescription",{defaultMessage:"closed a socket with"}),S=n.i18n.translate("xpack.securitySolution.system.existingUserDescription",{defaultMessage:"is an existing user"}),O=n.i18n.translate("xpack.securitySolution.system.existingSocketDescription",{defaultMessage:"is using an existing socket from"}),I=n.i18n.translate("xpack.securitySolution.system.existingPackageDescription",{defaultMessage:"is using an existing package"}),C=n.i18n.translate("xpack.securitySolution.system.invalidDescription",{defaultMessage:"attempted invalid usage of"}),M=n.i18n.translate("xpack.securitySolution.system.userChangedDescription",{defaultMessage:"user has changed"}),T=n.i18n.translate("xpack.securitySolution.system.hostDescription",{defaultMessage:"host information"}),_=n.i18n.translate("xpack.securitySolution.system.userAddedDescription",{defaultMessage:"user was added"}),N=n.i18n.translate("xpack.securitySolution.system.processErrorDescription",{defaultMessage:"encountered a process error with"}),D=n.i18n.translate("xpack.securitySolution.system.errorDescription",{defaultMessage:"encountered an error with"}),A=n.i18n.translate("xpack.securitySolution.system.packageInstalledDescription",{defaultMessage:"installed package"}),q=n.i18n.translate("xpack.securitySolution.system.packageSystemStartedDescription",{defaultMessage:"system started"}),F=n.i18n.translate("xpack.securitySolution.system.acceptedDescription",{defaultMessage:"accepted the user via"}),L=n.i18n.translate("xpack.securitySolution.system.packageUpdatedDescription",{defaultMessage:"updated package"}),R=n.i18n.translate("xpack.securitySolution.system.packageRemovedDescription",{defaultMessage:"removed package"}),P=n.i18n.translate("xpack.securitySolution.system.userRemovedDescription",{defaultMessage:"was removed"}),z=n.i18n.translate("xpack.securitySolution.system.viaDescription",{defaultMessage:"via"}),B=n.i18n.translate("xpack.securitySolution.system.viaParentProcessDescription",{defaultMessage:"via parent process"}),G=n.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasPreventedFromeEcryptingFilesDescription",{defaultMessage:"ransomware was prevented from encrypting files"}),$=n.i18n.translate("xpack.securitySolution.rowRenderer.ransomwareWasDetectedEcryptingFilesDescription",{defaultMessage:"ransomware was detected encrypting files"}),H=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedCreatingAMaliciousFileDescription",{defaultMessage:"was detected creating a malicious file"}),V=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromCreatingAMaliciousFileDescription",{defaultMessage:"was prevented from creating a malicious file"}),U=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedModifyingAMaliciousFileDescription",{defaultMessage:"was detected modifying a malicious file"}),W=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromModifyingAMaliciousFileDescription",{defaultMessage:"was prevented from modifying a malicious file"}),Y=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedRenamingAMaliciousFileDescription",{defaultMessage:"was detected renaming a malicious file"}),Z=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromRenamingAMaliciousFileDescription",{defaultMessage:"was prevented from renaming a malicious file"}),K=n.i18n.translate("xpack.securitySolution.rowRenderer.wasDetectedExecutingAMaliciousProcessDescription",{defaultMessage:"was detected executing a malicious process"}),Q=n.i18n.translate("xpack.securitySolution.rowRenderer.wasPreventedFromExecutingAMaliciousProcessDescription",{defaultMessage:"was prevented from executing a malicious process"}),X=n.i18n.translate("xpack.securitySolution.system.withExitCodeDescription",{defaultMessage:"with exit code"})},687:function(e,t,a){"use strict";a.d(t,"h",(function(){return Ee})),a.d(t,"b",(function(){return xe})),a.d(t,"f",(function(){return ke})),a.d(t,"c",(function(){return we})),a.d(t,"d",(function(){return je})),a.d(t,"g",(function(){return Se})),a.d(t,"j",(function(){return Oe})),a.d(t,"i",(function(){return Ie})),a.d(t,"a",(function(){return Ce})),a.d(t,"e",(function(){return Me})),a.d(t,"k",(function(){return It}));var n=a(45),r=a(2),i=a.n(r),o=a(113),s=a(17),l=a(267),c=a(926),u=a(166),d=a(1068),p=a(1500);const m=i.a.memo((({contextId:e,eventId:t,hostName:a,hostNameSeparator:n="@",isDraggable:r,userDomain:o,userDomainField:s="user.domain",userName:c,userNameField:d="user.name",workingDirectory:m})=>null!=c||null!=o||null!=a||null!=m?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:d,isDraggable:r,value:c,iconType:"user",fieldType:"keyword",isAggregatable:!0})),null!=o&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{"data-test-subj":"user-host-working-dir-domain-separator-text",grow:!1,component:"span"},"\\"),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:s,isDraggable:r,value:o,fieldType:"keyword",isAggregatable:!0}))),null!=a&&null!=c&&i.a.createElement(l.c,{grow:!1,component:"span"},n),i.a.createElement(p.a,{contextId:e,eventId:t,hostName:a,isDraggable:r,workingDirectory:m})):null));m.displayName="UserHostWorkingDir";var y=a(5);const g=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.askedForDescription",{defaultMessage:"asked for"}),f=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.responseCodeDescription",{defaultMessage:"response code:"}),b=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.viaDescription",{defaultMessage:"via"}),h=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.whichResolvedToDescription",{defaultMessage:", which resolved to"}),v=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.dns.withQuestionTypeDescription",{defaultMessage:"with question type"}),E=i.a.memo((({contextId:e,dnsQuestionName:t,dnsQuestionType:a,dnsResolvedIp:n,dnsResponseCode:r,eventCode:o,hostName:c,id:p,isDraggable:y,processExecutable:E,processName:x,processPid:k,userDomain:w,userName:j,winlogEventId:S})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{contextId:e,eventId:p,hostName:c,isDraggable:y,userDomain:w,userName:j,workingDirectory:void 0}),!Object(l.e)(t)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"asked-for",grow:!1},g),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.name",isDraggable:y,value:t,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(a)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"with-question-type",grow:!1},v),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.question.type",isDraggable:y,value:a,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(n)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"which-resolved-to",grow:!1},h),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.resolved_ip",isDraggable:y,value:n,isAggregatable:!0,fieldType:"ip"}))),!Object(l.e)(r)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span",grow:!1},"("),i.a.createElement(l.c,{component:"span","data-test-subj":"response-code",grow:!1},f),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"dns.response_code",isDraggable:y,value:r,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{component:"span",grow:!1},")")),i.a.createElement(l.c,{component:"span",grow:!1},b),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:p,isDraggable:y,processPid:k,processName:x,processExecutable:E})),(!Object(l.e)(o)||!Object(l.e)(S))&&i.a.createElement(i.a.Fragment,null,Object(l.e)(o)?i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,iconType:"logoWindows",field:"winlog.event_id",isDraggable:y,value:S,isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:p,field:"event.code",isDraggable:y,value:o,isAggregatable:!0,fieldType:"number"})))))));E.displayName="DnsRequestEventDetailsLine";const x=i.a.memo((({data:e,contextId:t,isDraggable:a,timelineId:r})=>{const o=Object(n.get)("dns.question.name[0]",e),u=Object(n.get)("dns.question.type[0]",e),d=Object(n.get)("dns.resolved_ip[0]",e),p=Object(n.get)("dns.response_code[0]",e),m=Object(n.get)("event.code[0]",e),y=Object(n.get)("host.name[0]",e),g=e._id,f=Object(n.get)("process.executable[0]",e),b=Object(n.get)("process.name[0]",e),h=Object(n.get)("process.pid[0]",e),v=Object(n.get)("user.domain[0]",e),x=Object(n.get)("user.name[0]",e),k=Object(n.get)("winlog.event_id[0]",e);return i.a.createElement(l.b,null,i.a.createElement(E,{contextId:t,dnsQuestionName:o,dnsQuestionType:u,dnsResolvedIp:d,dnsResponseCode:p,eventCode:m,hostName:y,id:g,isDraggable:a,processExecutable:f,processName:b,processPid:h,userDomain:v,userName:x,winlogEventId:k}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:e,isDraggable:a,timelineId:r}))}));x.displayName="DnsRequestEventDetails";const k=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.aLoginWasAttemptedUsingExplicitCredentialsDescription",{defaultMessage:"A login was attempted using explicit credentials"}),w=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.asRequestedBySubjectDescription",{defaultMessage:"as requested by subject"}),j=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogInDescription",{defaultMessage:"failed to log in"}),S=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endpoint.failedToLogOffDescription",{defaultMessage:"failed to log off"}),O=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.loggedOffDescription",{defaultMessage:"logged off"}),I=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeBatchDescription",{defaultMessage:"Batch"}),C=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeCachedInteractiveDescription",{defaultMessage:"Cached Interactive"}),M=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeInteractiveDescription",{defaultMessage:"Interactive"}),T=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkDescription",{defaultMessage:"Network"}),_=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNetworkCleartextDescription",{defaultMessage:"Network Cleartext"}),N=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeNewCredentialsDescription",{defaultMessage:"New Credentials"}),D=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeRemoteInteractiveDescription",{defaultMessage:"Remote Interactive"}),A=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeServiceDescription",{defaultMessage:"Service"}),q=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.logonTypeUnlockDescription",{defaultMessage:"Unlock"}),F=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.subjectLogonIdDescription",{defaultMessage:"subject logon ID"}),L=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.successfullyLoggedInDescription",{defaultMessage:"successfully logged in"}),R=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.targetLogonIdDescription",{defaultMessage:"target logon ID"}),P=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.toDescription",{defaultMessage:"to"}),z=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.usingLogonTypeDescription",{defaultMessage:"using logon type"}),B=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.viaDescription",{defaultMessage:"via"}),G=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.endgame.withSpecialPrivilegesDescription",{defaultMessage:"With special privileges,"}),$=e=>{if(Object(l.e)(e))return"";switch(e){case 2:return M;case 3:return T;case 4:return I;case 5:return A;case 7:return q;case 8:return _;case 9:return N;case 10:return D;case 11:return C;default:return`${e}`}},H=e=>"explicit_user_logon"===e||"user_logoff"===e,V=i.a.memo((({contextId:e,endgameLogonType:t,endgameSubjectDomainName:a,endgameSubjectLogonId:n,endgameSubjectUserName:r,endgameTargetDomainName:o,endgameTargetLogonId:c,endgameTargetUserName:p,eventAction:y,eventCode:g,eventOutcome:f,hostName:b,id:h,isDraggable:v,processExecutable:E,processName:x,processPid:I,userDomain:C,userName:M,winlogEventId:T})=>{const _=H(y)?o:C,N=(({eventAction:e,eventOutcome:t})=>{switch(e){case"explicit_user_logon":return"";case"log_off":case"user_logoff":return"failure"===(null==t?void 0:t.toLowerCase())?S:O;default:return"failure"===(null==t?void 0:t.toLowerCase())?j:L}})({eventAction:y,eventOutcome:f}),D=(e=>"explicit_user_logon"===e?P:"@")(y),A=H(y)?p:M,q=(e=>H(e)?"endgame.target_domain_name":"user.domain")(y),V=(e=>H(e)?"endgame.target_user_name":"user.name")(y);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},"admin_logon"===y&&i.a.createElement(l.c,{component:"span","data-test-subj":"with-special-privileges",grow:!1},G),"explicit_user_logon"===y&&i.a.createElement(l.c,{component:"span","data-test-subj":"a-login-was-attempted",grow:!1},k),i.a.createElement(m,{contextId:e,eventId:h,hostName:b,hostNameSeparator:D,isDraggable:v,userDomain:_,userDomainField:q,userName:A,userNameField:V,workingDirectory:void 0}),i.a.createElement(l.c,{component:"span","data-test-subj":"event-details",grow:!1},N),!Object(l.e)(t)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},z),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.logon_type",isDraggable:v,queryValue:String(t),value:`${t} - ${$(t)}`,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(c)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span",grow:!1},"("),i.a.createElement(l.c,{component:"span","data-test-subj":"using-logon-type",grow:!1},R),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.target_logon_id",isDraggable:v,value:c,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{component:"span",grow:!1},")")),i.a.createElement(l.c,{component:"span",grow:!1},B),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:h,isDraggable:v,processPid:I,processName:x,processExecutable:E})),!Object(l.e)(r)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"as-requested-by-subject",grow:!1},w),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_user_name",isDraggable:v,iconType:"user",value:r,isAggregatable:!0,fieldType:"keyword"}))),null!=a&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"subject-domain-name-domain-separator-text",grow:!1},"\\"),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_domain_name",isDraggable:v,value:a,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(n)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span",grow:!1},"("),i.a.createElement(l.c,{component:"span","data-test-subj":"subject-login-id",grow:!1},F),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"endgame.subject_logon_id",isDraggable:v,value:n,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{component:"span",grow:!1},")")),(!Object(l.e)(g)||!Object(l.e)(T))&&i.a.createElement(i.a.Fragment,null,Object(l.e)(g)?i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,iconType:"logoWindows",field:"winlog.event_id",value:T,isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:h,field:"event.code",value:g,isAggregatable:!0,fieldType:"keyword"})))))}));V.displayName="EndgameSecurityEventDetailsLine";const U=i.a.memo((({data:e,contextId:t,isDraggable:a,timelineId:r})=>{const o=Object(n.get)("endgame.logon_type[0]",e),u=Object(n.get)("endgame.subject_domain_name[0]",e),d=Object(n.get)("endgame.subject_logon_id[0]",e),p=Object(n.get)("endgame.subject_user_name[0]",e),m=Object(n.get)("endgame.target_logon_id[0]",e),y=Object(n.get)("endgame.target_domain_name[0]",e),g=Object(n.get)("endgame.target_user_name[0]",e),f=Object(n.get)("event.action[0]",e),b=Object(n.get)("event.code[0]",e),h=Object(n.get)("event.outcome[0]",e),v=Object(n.get)("host.name[0]",e),E=e._id,x=Object(n.get)("process.executable[0]",e),k=Object(n.get)("process.name[0]",e),w=Object(n.get)("process.pid[0]",e),j=Object(n.get)("user.domain[0]",e),S=Object(n.get)("user.name[0]",e),O=Object(n.get)("winlog.event_id[0]",e);return i.a.createElement(l.b,null,i.a.createElement(V,{contextId:t,endgameLogonType:o,endgameSubjectDomainName:u,endgameSubjectLogonId:d,endgameSubjectUserName:p,endgameTargetDomainName:y,endgameTargetLogonId:m,endgameTargetUserName:g,eventAction:f,eventCode:b,eventOutcome:h,hostName:v,id:E,isDraggable:a,processExecutable:x,processName:k,processPid:w,userDomain:j,userName:S,winlogEventId:O}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:e,timelineId:r}))}));U.displayName="EndgameSecurityEventDetails";const W=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.viaDescription",{defaultMessage:"via"}),Y=y.i18n.translate("xpack.securitySolution.timeline.body.renderers.registry.withNewValueDescription",{defaultMessage:"with new value"}),Z=({contextId:e,hostName:t,id:a,isDraggable:n,processName:o,processPid:c,registryKey:p,registryPath:y,text:g,userDomain:f,userName:b})=>{const h=Object(r.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"registry.key"),i.a.createElement("div",null,p))),[p]),v=Object(r.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement("div",null,"registry.path"),i.a.createElement("div",null,y))),[y]);return Object(l.e)(p)?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{contextId:e,eventId:a,hostName:t,isDraggable:n,userDomain:f,userName:b,workingDirectory:void 0}),!Object(l.e)(p)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"text",grow:!1},g),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:a,field:"registry.key",isDraggable:n,tooltipContent:h,value:p,isAggregatable:!0,fieldType:"keyword"}))),!Object(l.e)(y)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{component:"span","data-test-subj":"with-new-value",grow:!1},Y),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(u.c,{contextId:e,eventId:a,field:"registry.path",isDraggable:n,tooltipContent:v,value:y,isAggregatable:!0,fieldType:"keyword"}))),i.a.createElement(l.c,{component:"span",grow:!1},W),i.a.createElement(l.c,{component:"span",grow:!1},i.a.createElement(d.b,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:a,isDraggable:n,processPid:c,processName:o,processExecutable:void 0}))))},K=i.a.memo(Z),Q=({contextId:e,data:t,isDraggable:a,text:r})=>{const o=Object(n.get)("host.name[0]",t),s=t._id,c=Object(n.get)("process.name[0]",t),u=Object(n.get)("process.pid[0]",t),d=Object(n.get)("registry.key[0]",t),p=Object(n.get)("registry.path[0]",t),m=Object(n.get)("user.domain[0]",t),y=Object(n.get)("user.name[0]",t);return Object(l.e)(d)?null:i.a.createElement(l.b,null,i.a.createElement(K,{contextId:e,hostName:o,id:s,isDraggable:a,processName:c,processPid:u,registryKey:d,registryPath:p,text:r,userDomain:m,userName:y}))};Q.displayName="RegistryEventDetailsComponent";const X=i.a.memo(Q);var J=a(1069),ee=a(569),te=a(672);const ae=i.a.memo((({contextId:e,eventId:t,isDraggable:a,packageName:n,packageSummary:r,packageVersion:o})=>null!=n||null!=r||null!=o?i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:a,value:n,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:a,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.summary",isDraggable:a,value:r,isAggregatable:!0,fieldType:"keyword"}))):null));ae.displayName="Package";const ne=i.a.memo((({contextId:e,eventId:t,isDraggable:a,sshSignature:n,sshMethod:r})=>i.a.createElement(i.a.Fragment,null,null!=n&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.name",isDraggable:a,value:n,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),null!=r&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"system.audit.package.version",isDraggable:a,value:r,iconType:"document",isAggregatable:!0,fieldType:"keyword"})))));ne.displayName="AuthSsh";var re=a(214);const ie=i.a.memo((({contextId:e,hostName:t,id:a,isDraggable:n,message:r,outcome:o,packageName:c,packageSummary:p,packageVersion:y,processPid:g,processName:f,processExecutable:b,sshSignature:h,sshMethod:v,text:E,userDomain:x,userName:k,workingDirectory:w})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{contextId:e,eventId:a,hostName:t,isDraggable:n,userDomain:x,userName:k,workingDirectory:w}),i.a.createElement(l.c,{grow:!1,component:"span"},E),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(d.a,{contextId:e,endgamePid:void 0,endgameProcessName:void 0,eventId:a,isDraggable:n,processPid:g,processName:f,processExecutable:b})),null!=o&&i.a.createElement(l.c,{grow:!1,component:"span"},te.W),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"event.outcome",isDraggable:n,queryValue:o,value:o,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(ne,{contextId:e,eventId:a,isDraggable:n,sshSignature:h,sshMethod:v}),i.a.createElement(ae,{contextId:e,eventId:a,isDraggable:n,packageName:c,packageSummary:p,packageVersion:y})),null!=r&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(re.b,{iconType:"editorComment",color:"hollow",title:""},i.a.createElement(ee.a,{value:r}))))))));ie.displayName="SystemGenericLine";const oe=i.a.memo((({contextId:e,data:t,isDraggable:a,text:r,timelineId:o})=>{const u=t._id,d=null!=t.message?t.message[0]:null,p=Object(n.get)("host.name[0]",t),m=Object(n.get)("user.domain[0]",t),y=Object(n.get)("user.name[0]",t),g=Object(n.get)("event.outcome[0]",t),f=Object(n.get)("system.audit.package.name[0]",t),b=Object(n.get)("system.audit.package.summary[0]",t),h=Object(n.get)("system.audit.package.version[0]",t),v=Object(n.get)("process.pid[0]",t),E=Object(n.get)("process.name[0]",t),x=Object(n.get)("process.executable[0]",t),k=Object(n.get)("system.auth.ssh.signature[0]",t),w=Object(n.get)("system.auth.ssh.method[0]",t),j=Object(n.get)("process.working_directory[0]",t);return i.a.createElement(l.b,null,i.a.createElement(ie,{contextId:e,hostName:p,id:u,isDraggable:a,message:d,outcome:g,packageName:f,packageSummary:b,packageVersion:h,processExecutable:x,processPid:v,processName:E,sshMethod:w,sshSignature:k,text:r,userDomain:m,userName:y,workingDirectory:j}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:t,isDraggable:a,timelineId:o}))}));oe.displayName="SystemGenericDetails";var se=a(1398);const le=i.a.memo((({contextId:e,endgameExitCode:t,eventId:a,isDraggable:n,processExitCode:r,text:o})=>Object(l.e)(r)&&Object(l.e)(t)?null:i.a.createElement(i.a.Fragment,null,!Object(l.e)(o)&&i.a.createElement(l.c,{"data-test-subj":"exit-code-draggable-text",grow:!1,component:"span"},o),!Object(l.e)(r)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"process.exit_code",isDraggable:n,value:`${r}`,fieldType:"number",isAggregatable:!0})),!Object(l.e)(t)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.exit_code",isDraggable:n,value:t,fieldType:"number",isAggregatable:!0})))));le.displayName="ExitCodeDraggable";var ce=a(1110);const ue=i.a.memo((({contextId:e,endgameFileName:t,endgameFilePath:a,eventId:n,fileExtOriginalPath:r,fileName:o,filePath:s,isDraggable:c})=>{if(Object(l.e)(o)&&Object(l.e)(t)&&Object(l.e)(s)&&Object(l.e)(a))return null;const d=!Object(l.e)(s)||!Object(l.e)(a);return i.a.createElement(i.a.Fragment,null,Object(l.e)(o)?Object(l.e)(t)?null:i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.file_name",isDraggable:c,value:t,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"file.name",isDraggable:c,value:o,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),d&&i.a.createElement(l.c,{"data-test-subj":"in",grow:!1,component:"span"},ce.e),Object(l.e)(s)?Object(l.e)(a)?null:i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"endgame.file_path",isDraggable:c,value:a,iconType:"document",isAggregatable:!0,fieldType:"keyword"})):i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"file.path",isDraggable:c,value:s,iconType:"document",isAggregatable:!0,fieldType:"keyword"})),!Object(l.e)(r)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(l.c,{grow:!1,component:"span"},ce.d),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:n,field:"file.Ext.original.path",isDraggable:c,value:r,iconType:"document",isAggregatable:!0,fieldType:"keyword"}))))}));ue.displayName="FileDraggable";var de=a(44),pe=a.n(de);const me=pe()(s.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-ezi1kd-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),ye=i.a.memo((({contextId:e,eventId:t,fileHashSha256:a,isDraggable:n})=>Object(l.e)(a)?null:i.a.createElement(me,{alignItems:"center",direction:"column",gutterSize:"none"},i.a.createElement(l.c,{grow:!1,component:"div"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"file.hash.sha256",isDraggable:n,iconType:"number",value:a,isAggregatable:!0,fieldType:"keyword"})))));ye.displayName="FileHash";const ge=i.a.memo((({contextId:e,endgameParentProcessName:t,eventId:a,isDraggable:n,processParentName:r,processParentPid:o,processPpid:s,text:c})=>Object(l.e)(r)&&Object(l.e)(t)?null:i.a.createElement(i.a.Fragment,null,!Object(l.e)(c)&&i.a.createElement(l.c,{"data-test-subj":"parent-process-draggable-text",grow:!1,component:"span"},c),!Object(l.e)(r)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"process.parent.name",isDraggable:n,value:r,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(t)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"endgame.parent_process_name",isDraggable:n,value:t,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(o)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"process.parent.pid",isDraggable:n,queryValue:String(o),value:`(${String(o)})`,fieldType:"keyword",isAggregatable:!0})),!Object(l.e)(s)&&i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:e,eventId:a,field:"process.ppid",isDraggable:n,queryValue:String(s),value:`(${String(s)})`,fieldType:"keyword",isAggregatable:!0})))));ge.displayName="ParentProcessDraggable";const fe=pe()(s.EuiFlexGroup).withConfig({displayName:"HashFlexGroup",componentId:"sc-joyfnh-0"})(["margin:",";"],(({theme:e})=>e.eui.euiSizeXS)),be=i.a.memo((({contextId:e,eventId:t,isDraggable:a,processHashSha256:n})=>Object(l.e)(n)?null:i.a.createElement(fe,{alignItems:"center",direction:"column",gutterSize:"none"},i.a.createElement(l.c,{grow:!1,component:"div"},i.a.createElement(u.c,{contextId:e,eventId:t,field:"process.hash.sha256",iconType:"number",isDraggable:a,value:n,fieldType:"keyword",isAggregatable:!0})))));be.displayName="ProcessHash";const he=i.a.memo((({args:e,contextId:t,endgameExitCode:a,endgameFileName:n,endgameFilePath:r,endgameParentProcessName:o,endgamePid:c,endgameProcessName:p,eventAction:y,fileExtOriginalPath:g,fileHashSha256:f,fileName:b,filePath:h,hostName:v,id:E,isDraggable:x,message:k,outcome:w,packageName:j,processParentName:S,processParentPid:O,processExitCode:I,packageSummary:C,packageVersion:M,processExecutable:T,processHashSha256:_,processName:N,processPid:D,processPpid:A,processTitle:q,showMessage:F,skipRedundantFileDetails:L=!1,skipRedundantProcessDetails:R=!1,sshSignature:P,sshMethod:z,text:B,userDomain:G,userName:$,workingDirectory:H})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{alignItems:"center",justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(m,{eventId:E,contextId:t,isDraggable:x,userDomain:G,userName:$,workingDirectory:H,hostName:v}),i.a.createElement(l.c,{grow:!1,component:"span"},B),!L&&i.a.createElement(ue,{contextId:t,endgameFileName:n,endgameFilePath:r,eventId:E,fileExtOriginalPath:g,fileName:b,filePath:h,isDraggable:x}),Object(l.g)(y)&&i.a.createElement(l.c,{"data-test-subj":"via",grow:!1,component:"span"},te.L),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(d.b,{contextId:t,endgamePid:c,endgameProcessName:p,eventId:E,isDraggable:x,processPid:D,processName:N,processExecutable:T})),i.a.createElement(se.a,{args:e,contextId:t,eventId:E,processTitle:q,isDraggable:x}),i.a.createElement(le,{contextId:t,endgameExitCode:a,eventId:E,isDraggable:x,processExitCode:I,text:te.V}),!Object(l.f)(y)&&i.a.createElement(ge,{contextId:t,endgameParentProcessName:o,eventId:E,isDraggable:x,processParentName:S,processParentPid:O,processPpid:A,text:te.M}),null!=w&&i.a.createElement(l.c,{grow:!1,component:"span"},te.W),i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(u.c,{contextId:t,eventId:E,field:"event.outcome",isDraggable:x,queryValue:w,value:w,isAggregatable:!0,fieldType:"keyword"})),i.a.createElement(ne,{contextId:t,eventId:E,isDraggable:x,sshSignature:P,sshMethod:z}),i.a.createElement(ae,{contextId:t,eventId:E,isDraggable:x,packageName:j,packageSummary:C,packageVersion:M})),!L&&i.a.createElement(ye,{contextId:t,eventId:E,fileHashSha256:f,isDraggable:x}),!R&&i.a.createElement(be,{contextId:t,eventId:E,isDraggable:x,processHashSha256:_}),null!=k&&F&&i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiFlexGroup,{justifyContent:"center",gutterSize:"none",wrap:!0},i.a.createElement(l.c,{grow:!1,component:"span"},i.a.createElement(re.b,{iconType:"editorComment",color:"hollow",title:""},i.a.createElement(ee.a,{value:k}))))))));he.displayName="SystemGenericFileLine";const ve=i.a.memo((({contextId:e,data:t,isDraggable:a,showMessage:r=!0,skipRedundantFileDetails:o=!1,skipRedundantProcessDetails:u=!1,text:d,timelineId:p})=>{const m=t._id,y=null!=t.message?t.message[0]:null,g=Object(n.get)("host.name[0]",t),f=Object(n.get)("endgame.exit_code[0]",t),b=Object(n.get)("endgame.file_name[0]",t),h=Object(n.get)("endgame.file_path[0]",t),v=Object(n.get)("endgame.parent_process_name[0]",t),E=Object(n.get)("endgame.pid[0]",t),x=Object(n.get)("endgame.process_name[0]",t),k=Object(n.get)("event.action[0]",t),w=Object(n.get)("file.Ext.original.path[0]",t),j=Object(n.get)("file.hash.sha256[0]",t),S=Object(n.get)("file.name[0]",t),O=Object(n.get)("file.path[0]",t),I=Object(n.get)("user.domain[0]",t),C=Object(n.get)("user.name[0]",t),M=Object(n.get)("event.outcome[0]",t),T=Object(n.get)("system.audit.package.name[0]",t),_=Object(n.get)("system.audit.package.summary[0]",t),N=Object(n.get)("system.audit.package.version[0]",t),D=Object(n.get)("process.exit_code[0]",t),A=Object(n.get)("process.parent.name[0]",t),q=Object(n.get)("process.parent.pid[0]",t),F=Object(n.get)("process.hash.sha256[0]",t),L=Object(n.get)("process.pid[0]",t),R=Object(n.get)("process.ppid[0]",t),P=Object(n.get)("process.name[0]",t),z=Object(n.get)("system.auth.ssh.signature[0]",t),B=Object(n.get)("system.auth.ssh.method[0]",t),G=Object(n.get)("process.executable[0]",t),$=Object(n.get)("process.title[0]",t),H=Object(n.get)("process.working_directory[0]",t),V=Object(n.get)("process.args",t);return i.a.createElement(l.b,null,i.a.createElement(he,{id:m,contextId:e,text:d,hostName:g,endgameExitCode:f,endgameFileName:b,endgameFilePath:h,endgameParentProcessName:v,endgamePid:E,endgameProcessName:x,eventAction:k,fileExtOriginalPath:w,fileHashSha256:j,fileName:S,filePath:O,userDomain:I,userName:C,message:y,processExitCode:D,processParentName:A,processParentPid:q,processTitle:$,workingDirectory:H,args:V,packageName:T,packageSummary:_,packageVersion:N,processHashSha256:F,processName:P,processPid:L,processPpid:R,processExecutable:G,showMessage:r,skipRedundantFileDetails:o,skipRedundantProcessDetails:u,sshSignature:z,sshMethod:B,outcome:M,isDraggable:a}),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(c.a,{data:t,isDraggable:a,timelineId:p}))}));ve.displayName="SystemGenericFileDetails";const Ee=({actionName:e,text:t})=>({id:o.d.system,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),r=Object(n.get)("event.action[0]",t);return null!=a&&"system"===a.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(oe,{contextId:`${e}-${r}`,data:a,isDraggable:n,text:t,timelineId:r}))}),xe=({actionName:e,text:t})=>({id:o.d.system_file,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),r=Object(n.get)("event.category[0]",t),i=Object(n.get)("event.dataset[0]",t);return("process"===(null==r?void 0:r.toLowerCase())||"endpoint.events.process"===(null==i?void 0:i.toLowerCase()))&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{data:a,contextId:`endgame-process-${e}-${r}`,isDraggable:n,showMessage:!1,text:t,timelineId:r}))}),ke=({actionName:e,text:t})=>({id:o.d.system_fim,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),r=Object(n.get)("event.category[0]",t),i=Object(n.get)("event.dataset[0]",t);return Object(l.d)({eventCategory:r,eventDataset:i})&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{data:a,contextId:`fim-${e}-${r}`,isDraggable:n,showMessage:!1,text:t,timelineId:r}))}),we=({eventAction:e,eventCategory:t,eventType:a,skipRedundantFileDetails:r=!1,skipRedundantProcessDetails:s=!1,text:l})=>({id:o.d.alerts,isInstance:r=>{var i,o,s;const l=Object(n.get)("event.action",r),c=Object(n.get)("event.category",r),u=Object(n.get)("event.dataset[0]",r),d=Object(n.get)("event.type",r),p=null!==(i=null==l?void 0:l.includes(e))&&void 0!==i&&i,m=null!==(o=null==c?void 0:c.includes(t))&&void 0!==o&&o,y=null!==(s=null==d?void 0:d.includes(a))&&void 0!==s&&s;return"endpoint.alerts"===(null==u?void 0:u.toLowerCase())&&y&&m&&p},renderRow:({data:n,isDraggable:o,scopeId:c})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`endpoint-alerts-row-renderer-${e}-${t}-${a}-${c}`,data:n,isDraggable:o,showMessage:!1,skipRedundantFileDetails:r,skipRedundantProcessDetails:s,text:l,timelineId:c}))}),je=({actionName:e,text:t})=>({id:o.d.library,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),r=Object(n.get)("event.dataset[0]",t);return"endpoint.events.library"===(null==r?void 0:r.toLowerCase())&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`library-row-renderer-${e}-${r}`,data:a,isDraggable:n,showMessage:!1,text:t,timelineId:r}))}),Se=({actionName:e,text:t})=>({id:o.d.system_file,isInstance:t=>{const a=Object(n.get)("event.module[0]",t),r=Object(n.get)("event.action[0]",t);return null!=a&&"system"===a.toLowerCase()&&null!=r&&r.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`${e}-${r}`,data:a,isDraggable:n,text:t,timelineId:r}))}),Oe=({actionName:e,text:t})=>({id:o.d.system_socket,isInstance:t=>{const a=Object(n.get)("event.action[0]",t);return null!=a&&a.toLowerCase()===e},renderRow:({data:a,isDraggable:n,scopeId:r})=>i.a.createElement(J.a,null,i.a.createElement(ve,{contextId:`socket-${e}-${r}`,data:a,isDraggable:n,text:t,timelineId:r}))}),Ie=({actionName:e})=>({id:o.d.system_security_event,isInstance:t=>{const a=Object(n.get)("event.category[0]",t),r=Object(n.get)("event.action[0]",t),i=Object(n.get)("event.dataset[0]",t);return("authentication"===(null==a?void 0:a.toLowerCase())||"endpoint.events.security"===(null==i?void 0:i.toLowerCase()))&&(null==r?void 0:r.toLowerCase())===e},renderRow:({data:t,isDraggable:a,scopeId:n})=>i.a.createElement(J.a,null,i.a.createElement(U,{contextId:`authentication-${e}-${n}`,data:t,isDraggable:a,timelineId:n}))}),Ce=()=>({id:o.d.system_dns,isInstance:e=>{const t=Object(n.get)("dns.question.type[0]",e),a=Object(n.get)("dns.question.name[0]",e);return!Object(l.e)(t)&&!Object(l.e)(a)},renderRow:({data:e,isDraggable:t,scopeId:a})=>i.a.createElement(J.a,null,i.a.createElement(x,{contextId:`dns-request-${a}`,data:e,isDraggable:t,timelineId:a}))}),Me=({actionName:e,text:t})=>({id:o.d.registry,isInstance:t=>{const a=Object(n.get)("event.action[0]",t),r=Object(n.get)("event.dataset[0]",t);return"endpoint.events.registry"===(null==r?void 0:r.toLowerCase())&&(null==a?void 0:a.toLowerCase())===e},renderRow:({data:e,isDraggable:a,scopeId:n})=>i.a.createElement(J.a,null,i.a.createElement(X,{contextId:`registry-event-${n}`,data:e,isDraggable:a,text:t}))}),Te=Ee({actionName:"user_login",text:te.c}),_e=Se({actionName:"process_started",text:te.A}),Ne=xe({actionName:"creation_event",text:te.A}),De=xe({actionName:"start",text:te.A}),Ae=Me({actionName:"modification",text:te.u}),qe=Se({actionName:"process_stopped",text:te.B}),Fe=xe({actionName:"termination_event",text:te.H}),Le=xe({actionName:"end",text:te.H}),Re=ke({actionName:"file_create_event",text:te.e}),Pe=ke({actionName:"creation",text:te.e}),ze=ke({actionName:"created",text:te.e}),Be=ke({actionName:"file_delete_event",text:te.f}),Ge=ke({actionName:"deletion",text:te.f}),$e=ke({actionName:"modification",text:te.t}),He=ke({actionName:"overwrite",text:te.v}),Ve=ke({actionName:"rename",text:te.E}),Ue=ke({actionName:"deleted",text:te.f}),We=Se({actionName:"existing_process",text:te.k}),Ye=[{eventAction:"creation",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.R},{eventAction:"creation",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.N},{eventAction:"files-encrypted",eventCategory:"file",eventType:"denied",skipRedundantFileDetails:!0,text:te.D},{eventAction:"files-encrypted",eventCategory:"file",eventType:"allowed",skipRedundantFileDetails:!0,text:te.C},{eventAction:"modification",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.T},{eventAction:"modification",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.P},{eventAction:"rename",eventCategory:"file",eventType:"denied",skipRedundantProcessDetails:!0,text:te.U},{eventAction:"rename",eventCategory:"file",eventType:"allowed",skipRedundantProcessDetails:!0,text:te.Q},{eventAction:"execution",eventCategory:"process",eventType:"denied",skipRedundantFileDetails:!0,text:te.S},{eventAction:"execution",eventCategory:"process",eventType:"allowed",skipRedundantFileDetails:!0,text:te.O}].map((e=>we(e))),Ze=je({actionName:"load",text:te.q}),Ke=Oe({actionName:"socket_opened",text:te.G}),Qe=Oe({actionName:"socket_closed",text:te.F}),Xe=Oe({actionName:"ipv4_connection_accept_event",text:te.b}),Je=Oe({actionName:"connection_accepted",text:te.b}),et=Oe({actionName:"http_request",text:te.s}),tt=xe({actionName:"exec",text:te.i}),at=xe({actionName:"fork",text:te.n}),nt=Oe({actionName:"ipv6_connection_accept_event",text:te.b}),rt=Oe({actionName:"ipv4_disconnect_received_event",text:te.g}),it=Oe({actionName:"disconnect_received",text:te.g}),ot=Oe({actionName:"ipv6_disconnect_received_event",text:te.g}),st=Ie({actionName:"admin_logon"}),lt=Ie({actionName:"explicit_user_logon"}),ct=Ie({actionName:"user_logoff"}),ut=Ie({actionName:"user_logon"}),dt=Ie({actionName:"log_on"}),pt=Ce(),mt=Ee({actionName:"existing_user",text:te.m}),yt=Se({actionName:"existing_socket",text:te.l}),gt=Ee({actionName:"existing_package",text:te.j}),ft=Se({actionName:"invalid",text:te.p}),bt=Ee({actionName:"user_changed",text:te.J}),ht=Ee({actionName:"host",text:te.o}),vt=Ee({actionName:"user_added",text:te.I}),Et=Ee({actionName:"user_logout",text:te.r}),xt=Ie({actionName:"log_off"}),kt=Se({actionName:"process_error",text:te.z}),wt=Ee({actionName:"error:",text:te.h}),jt=Ee({actionName:"error",text:te.h}),St=Ee({actionName:"package_installed",text:te.w}),Ot=Ee({actionName:"boot",text:te.d}),It=[pt,st,lt,Re,Pe,Be,Ge,He,Ve,...Ye,Ze,$e,Ae,Xe,Je,et,tt,at,nt,rt,it,ot,Ne,De,Fe,Le,ct,ut,dt,ze,Ue,Ee({actionName:"accepted",text:te.a}),Ot,jt,wt,gt,We,yt,mt,ht,ft,Te,Et,xt,St,Ee({actionName:"package_updated",text:te.y}),Ee({actionName:"package_removed",text:te.x}),kt,_e,qe,Qe,Ke,vt,bt,Ee({actionName:"user_removed",text:te.K})]},730:function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(2),r=a.n(n),i=a(17),o=a(1529),s=a(126),l=a(155),c=a(125);let u;!function(e){e.FIRST_SEEN="first-seen",e.LAST_SEEN="last-seen"}(u||(u={}));const d=r.a.memo((({indexPatterns:e,field:t,type:a,value:d})=>{const[p,{firstSeen:m,lastSeen:y,errorMessage:g}]=Object(o.a)({field:t,value:d,order:a===u.FIRST_SEEN?c.b.asc:c.b.desc,defaultIndex:e}),f=Object(n.useMemo)((()=>a===u.FIRST_SEEN?m:y),[m,y,a]);return null!=g?r.a.createElement(i.EuiToolTip,{position:"top",content:g,"data-test-subj":"firstLastSeenErrorToolTip","aria-label":`firstLastSeenError-${a}`,id:`firstLastSeenError-${t}-${a}`},r.a.createElement(i.EuiIcon,{"aria-describedby":`firstLastSeenError-${t}-${a}`,type:"warning"})):r.a.createElement(r.a.Fragment,null,p&&r.a.createElement(i.EuiLoadingSpinner,{"data-test-subj":"loading-spinner",size:"m"}),p||null==f||"Invalid Date"!==new Date(f).toString()?!p&&null!==f&&r.a.createElement(i.EuiText,{"data-test-subj":"first-last-seen-value",size:"s"},r.a.createElement(l.b,{value:`${f}`})):f,!p&&null===f&&Object(s.d)())}));d.displayName="FirstLastSeen"},738:function(e,t,a){"use strict";a.d(t,"g",(function(){return c})),a.d(t,"a",(function(){return R})),a.d(t,"f",(function(){return z})),a.d(t,"c",(function(){return $})),a.d(t,"b",(function(){return $e})),a.d(t,"h",(function(){return Ue})),a.d(t,"i",(function(){return d})),a.d(t,"d",(function(){return st})),a.d(t,"e",(function(){return _e})),a.d(t,"j",(function(){return Le}));var n=a(2),r=a.n(n),i=a(17),o=a(13);const s={strict:!0,fields:{created_by:{type:"string"},description:{type:"string"},id:{type:"string"},item_id:{type:"string"},list_id:{type:"string"},name:{type:"string"},os_types:{type:"string"},tags:{type:"string"}}},l=({addExceptionButtonText:e,placeholdertext:t,canAddException:a,listType:r,isSearching:l,dataTestSubj:c,filters:u=[],isButtonFilled:d=!0,buttonIconType:p,onSearch:m,onAddExceptionClick:y})=>{const g=Object(n.useCallback)((({queryText:e})=>{m({search:e})}),[m]),f=Object(n.useCallback)((()=>{y(r)}),[y,r]);return Object(o.jsx)(i.EuiFlexGroup,{alignItems:"center"},Object(o.jsx)(i.EuiFlexItem,{grow:!0},Object(o.jsx)(i.EuiSearchBar,{box:{placeholder:t,incremental:!1,schema:s,"data-test-subj":`${c||""}searchBar`},filters:u,onChange:g})),!a&&Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiButton,{"data-test-subj":`${c||""}Button`,onClick:f,isDisabled:l,fill:d,iconType:p},e)))};l.displayName="SearchBarComponent";const c=r.a.memo(l);c.displayName="SearchBar";var u=a(55);let d,p;!function(e){e.ERROR="error",e.EMPTY="empty",e.EMPTY_SEARCH="empty_search",e.LOADING="loading",e.SEARCHING="searching",e.DELETING="deleting"}(d||(d={})),function(e){e.ENDPOINT="endpoint",e.DETECTION="empty",e.RULE_DEFAULT="empty_search"}(p||(p={}));var m=a(5);const y=m.i18n.translate("exceptionList-components.empty.viewer.state.empty.title",{defaultMessage:"Add exceptions to this list"}),g=m.i18n.translate("exceptionList-components.empty.viewer.state.empty.body",{defaultMessage:"There is no exception in your list. Create your first exception."}),f=m.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.search.title",{defaultMessage:"No results match your search criteria"}),b=m.i18n.translate("exceptionList-components.empty.viewer.state.empty_search.body",{defaultMessage:"Try modifying your search"}),h=m.i18n.translate("exceptionList-components.empty.viewer.state.error_title",{defaultMessage:"Unable to load exception items"}),v=m.i18n.translate("exceptionList-components.empty.viewer.state.error_body",{defaultMessage:"There was an error loading the exception items. Contact your administrator for help."}),E=m.i18n.translate("exceptionList-components.exception_list_header_export_action",{defaultMessage:"Export exception list"}),x=m.i18n.translate("exceptionList-components.exception_list_header_delete_action",{defaultMessage:"Delete exception list"}),k=m.i18n.translate("exceptionList-components.exception_list_header_duplicate_action",{defaultMessage:"Duplicate exception list"}),w=m.i18n.translate("exceptionList-components.exception_list_header_link_rules_button",{defaultMessage:"Link rules"}),j=e=>m.i18n.translate("exceptionList-components.exception_list_header_linked_rules",{values:{noOfRules:e},defaultMessage:"Linked to {noOfRules} rules"}),S=m.i18n.translate("exceptionList-components.exception_list_header_breadcrumb",{defaultMessage:"Shared Exception Lists"}),O=m.i18n.translate("exceptionList-components.exception_list_header_list_id",{defaultMessage:"List ID"}),I=m.i18n.translate("exceptionList-components.exception_list_header_name",{defaultMessage:"Add a name"}),C=m.i18n.translate("exceptionList-components.exception_list_header_description",{defaultMessage:"Add a description"}),M=m.i18n.translate("exceptionList-components.exception_list_header_edit_modal_save_button",{defaultMessage:"Save"}),T=m.i18n.translate("exceptionList-components.exception_list_header_edit_modal_cancel_button",{defaultMessage:"Cancel"}),_=m.i18n.translate("exceptionList-components.exception_list_header_Name_textbox",{defaultMessage:"Name"}),N=m.i18n.translate("exceptionList-components.exception_list_header_description_textbox",{defaultMessage:"Description (optional)"}),D=m.i18n.translate("exceptionList-components.exception_list_header_description_textboxexceptionList-components.exception_list_header_name_required_eror",{defaultMessage:"List name cannot be empty"});var A=a(1608),q=a.n(A);const F=Object(o.css)("margin:",u.euiThemeVars.euiSizeL," 0;padding:",u.euiThemeVars.euiSizeL," 0;",""),L=({title:e,body:t,buttonText:a,listType:r,isReadOnly:s,viewerStatus:l,onEmptyButtonStateClick:c})=>{const{euiTheme:u}=Object(i.useEuiTheme)(),p=Object(n.useMemo)((()=>{switch(l){case d.ERROR:return{color:"danger",iconType:"error",title:Object(o.jsx)("h2",{"data-test-subj":"errorTitle"},e||h),body:Object(o.jsx)("p",{"data-test-subj":"errorBody"},t||v),"data-test-subj":"errorViewerState"};case d.EMPTY:return{color:"subdued",iconType:"plusInCircle",iconColor:u.colors.darkestShade,title:Object(o.jsx)("h2",{"data-test-subj":"emptyTitle"},e||y),body:Object(o.jsx)("p",{"data-test-subj":"emptyBody"},t||g),"data-test-subj":"emptyViewerState",actions:[Object(o.jsx)(i.EuiButton,{"data-test-subj":"emptyStateButton",onClick:c,iconType:"plusInCircle",color:"primary",isDisabled:s,fill:!0},a||(n=r||"rule",m.i18n.translate("exceptionList-components.empty.viewer.state.empty.viewer_button",{values:{exceptionType:n},defaultMessage:"Create {exceptionType} exception"})))]};case d.EMPTY_SEARCH:return{color:"plain",layout:"horizontal",hasBorder:!0,hasShadow:!1,icon:Object(o.jsx)(i.EuiImage,{size:"fullWidth",alt:"",src:q.a}),title:Object(o.jsx)("h3",{"data-test-subj":"emptySearchTitle"},e||f),body:Object(o.jsx)("p",{"data-test-subj":"emptySearchBody"},t||b),"data-test-subj":"emptySearchViewerState"}}var n}),[l,u.colors.darkestShade,e,t,c,s,a,r]);return Object(o.jsx)(i.EuiSkeletonText,{lines:4,"data-test-subj":"loadingViewerState",isLoading:l===d.LOADING||l===d.SEARCHING},Object(o.jsx)(i.EuiPanel,{css:F,color:"empty_search"===l?"subdued":"transparent"},Object(o.jsx)(i.EuiEmptyPrompt,p)))},R=r.a.memo(L);R.displayName="EmptyViewerState";const P=({dataTestSubj:e,ariaLabel:t,pagination:a,onPaginationChange:r})=>{const{pageIndex:s,pageCount:l,pageSize:c,pageSizeOptions:u,handleItemsPerPageChange:d,handlePageIndexChange:p}=(({pagination:e,onPaginationChange:t})=>{const{pageIndex:a,totalItemCount:r,pageSize:i,pageSizeOptions:o}=e,s=Object(n.useMemo)((()=>isFinite(r/i)?Math.ceil(r/i):0),[i,r]),l=Object(n.useCallback)((e=>{t({pagination:{pageIndex:a,pageSize:e,totalItemCount:r}})}),[a,r,t]),c=Object(n.useCallback)((e=>{t({pagination:{pageIndex:e,pageSize:i,totalItemCount:r}})}),[i,r,t]);return{pageCount:s,pageIndex:a,pageSize:i,pageSizeOptions:o,handleItemsPerPageChange:l,handlePageIndexChange:c}})({pagination:a,onPaginationChange:r});return Object(o.jsx)(i.EuiTablePagination,{"data-test-subj":e,"aria-label":t,pageCount:l,activePage:s,itemsPerPage:c,onChangePage:p,onChangeItemsPerPage:d,itemsPerPageOptions:u})};P.displayName="PaginationComponent";const z=r.a.memo(P);z.displayName="Pagination";const B=Object(o.css)("margin:",u.euiThemeVars.euiSize," 0;&div:first-child{margin:",u.euiThemeVars.euiSizeXS," 0 ",u.euiThemeVars.euiSize,";}",""),G=({lastUpdated:e,viewerStatus:t,isReadOnly:a,exceptions:n,listType:s,ruleReferences:l,emptyViewerTitle:c,emptyViewerBody:u,emptyViewerButtonText:d,pagination:p,dataTestSubj:m,editActionLabel:y,deleteActionLabel:g,securityLinkAnchorComponent:f,exceptionsUtilityComponent:b,formattedDateComponent:h,getFormattedComments:v,onPaginationChange:E,onDeleteException:x,onEditExceptionItem:k,onCreateExceptionListItem:w})=>{const j=b;return!n.length||t?Object(o.jsx)(R,{isReadOnly:a,title:c,viewerStatus:t,buttonText:d,body:u,onEmptyButtonStateClick:w}):Object(o.jsx)(r.a.Fragment,null,Object(o.jsx)(j,{pagination:p,lastUpdated:e}),Object(o.jsx)(i.EuiFlexGroup,{direction:"column",gutterSize:"none",className:"eui-yScrollWithShadows"},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiFlexGroup,{css:B,"data-test-subj":`${m||""}exceptionsContainer`,direction:"column",gutterSize:"s"},n.map((e=>Object(o.jsx)(i.EuiFlexItem,{"data-test-subj":`${m||""}exceptionItemContainer`,grow:!1,key:e.id},Object(o.jsx)($e,{key:`${e.id}exceptionItemCardKey`,dataTestSubj:`${m||""}exceptionItemCard`,disableActions:a,exceptionItem:e,listType:s,ruleReferences:Object.keys(l).length&&l[e.list_id]?l[e.list_id].referenced_rules:[],editActionLabel:y,deleteActionLabel:g,onDeleteException:x,onEditException:k,securityLinkAnchorComponent:f,formattedDateComponent:h,getFormattedComments:v}))))))),Object(o.jsx)(z,{dataTestSubj:`${m||""}pagination`,pagination:p,onPaginationChange:E}))};G.displayName="ExceptionItemsComponent";const $=r.a.memo(G);$.displayName="ExceptionsItems";var H=a(179);const V=Object(o.css)("margin-left:",u.euiThemeVars.euiSizeXL,";margin-bottom:",u.euiThemeVars.euiSizeXS,";padding-top:",u.euiThemeVars.euiSizeXS,";",""),U=Object(H.cx)("eui-xScroll","\n  border: 1px;\n  border-color: #d3dae6;\n  border-style: solid;\n"),W=Object(o.css)("display:flex;align-items:center;margin-left:",u.euiThemeVars.euiSizeS,";",""),Y={name:"s5xdrg",styles:"display:flex;align-items:center"},Z=e=>m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.editItemButton",{values:{listType:e},defaultMessage:"Edit {listType} exception"}),K=e=>m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.deleteItemButton",{values:{listType:e},defaultMessage:"Delete {listType} exception"}),Q=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.createdLabel",{defaultMessage:"Created"}),X=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.updatedLabel",{defaultMessage:"Updated"}),J=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.expiresLabel",{defaultMessage:"Expires at"}),ee=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.expiredLabel",{defaultMessage:"Expired at"}),te=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.metaDetailsBy",{defaultMessage:"by"}),ae=e=>m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.showCommentsLabel",{values:{comments:e},defaultMessage:"Show {comments, plural, =1 {comment} other {comments}} ({comments})"}),ne=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator",{defaultMessage:"IS"}),re=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchOperator.not",{defaultMessage:"IS NOT"}),ie=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardMatchesOperator",{defaultMessage:"MATCHES"}),oe=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.wildcardDoesNotMatchOperator",{defaultMessage:"DOES NOT MATCH"}),se=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.nestedOperator",{defaultMessage:"has"}),le=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator",{defaultMessage:"is one of"}),ce=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.matchAnyOperator.not",{defaultMessage:"is not one of"}),ue=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator",{defaultMessage:"exists"}),de=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.existsOperator.not",{defaultMessage:"does not exist"}),pe=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator",{defaultMessage:"included in"}),me=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.listOperator.not",{defaultMessage:"is not included in"}),ye=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.and",{defaultMessage:"AND"}),ge=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.os",{defaultMessage:"OS"}),fe=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.windows",{defaultMessage:"Windows"}),be=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.linux",{defaultMessage:"Linux"}),he=m.i18n.translate("exceptionList-components.exceptions.exceptionItem.card.conditions.macos",{defaultMessage:"Mac"});var ve=a(139);const Ee=Object.freeze({linux:be,mac:he,macos:he,windows:fe}),xe=Object.freeze({[ve.d.NESTED]:se,[ve.d.MATCH_ANY]:le,[ve.d.MATCH]:ne,[ve.d.WILDCARD]:ie,[ve.d.EXISTS]:ue,[ve.d.LIST]:pe}),ke=Object.freeze({[ve.d.MATCH_ANY]:ce,[ve.d.MATCH]:re,[ve.d.WILDCARD]:oe,[ve.d.EXISTS]:de,[ve.d.LIST]:me}),we=(e,t)=>"match_any"===e&&Array.isArray(t)?t.map(((e,t)=>Object(o.jsx)(i.EuiBadge,{key:t,"data-test-subj":`matchAnyBadge${t}`,color:"hollow"},e))):null!=t?t:"",je=(e,t)=>{var a,n;return"nested"===e?"":"included"===t?null!==(a=xe[e])&&void 0!==a?a:e:null!==(n=ke[e])&&void 0!==n?n:e},Se=(e,t,a)=>Object(o.jsx)(r.a.Fragment,null,Object(o.jsx)(i.EuiExpression,{description:je(e,t),value:we(e,a),"data-test-subj":"entryValueExpression"}),Object(o.jsx)(Ue,{value:a})),Oe=Object(n.memo)((({entry:e,index:t,isNestedEntry:a=!1,dataTestSubj:n})=>{const{field:s,type:l}=e,c=(e=>"list"===e.type?e.list.id:"value"in e?e.value:"")(e),u="operator"in e?e.operator:"",d=`${s}${l}${c}${t}`;return Object(o.jsx)("div",{"data-test-subj":`${n||""}${d}EntryContent`,key:d},Object(o.jsx)("div",{css:Y},a?Object(o.jsx)(i.EuiFlexGroup,{responsive:!0,css:V,direction:"row",alignItems:"center",gutterSize:"m","data-test-subj":`${n||""}NestedEntry`},Object(o.jsx)(i.EuiToken,{"data-test-subj":"nstedEntryIcon",iconType:"tokenNested",size:"s"}),Object(o.jsx)("div",{css:W},Object(o.jsx)(i.EuiExpression,{description:"",value:s,color:"subdued"}),Se(l,u,c))):Object(o.jsx)(r.a.Fragment,null,Object(o.jsx)(i.EuiExpression,{description:0===t?"":ye,value:s,color:0===t?"primary":"subdued","data-test-subj":`${n||""}SingleEntry`}),Se(l,u,c))))}));Oe.displayName="EntryContent";const Ie=Object(n.memo)((({os:e,dataTestSubj:t})=>{const a=Object(n.useMemo)((()=>e.map((e=>{var t;return null!==(t=Ee[e])&&void 0!==t?t:e})).join(", ")),[e]);return a?Object(o.jsx)("div",{"data-test-subj":`${t||""}Os`},Object(o.jsx)("strong",null,Object(o.jsx)(i.EuiExpression,{"data-test-subj":"osLabel",description:"",value:ge}),Object(o.jsx)(i.EuiExpression,{"data-test-subj":"osValue",description:ne,value:a}))):null}));Ie.displayName="OsCondition";const Ce=Object(n.memo)((({os:e,entries:t,dataTestSubj:a})=>Object(o.jsx)(i.EuiPanel,{color:"subdued",hasBorder:!0,hasShadow:!1,"data-test-subj":a,className:U},null!=e&&e.length?Object(o.jsx)(Ie,{os:e,dataTestSubj:a}):null,t.map(((e,t)=>{const n="entries"in e?e.entries:[];return Object(o.jsx)("div",{key:`ExceptionItemCardConditionsContainer${t}`},Object(o.jsx)(Oe,{key:`entry${t}`,entry:e,index:t,dataTestSubj:a}),null!=n&&n.length?n.map(((e,n)=>Object(o.jsx)(Oe,{key:`nestedEntry${t}${n}`,entry:e,index:n,isNestedEntry:!0,dataTestSubj:a}))):null)})))));Ce.displayName="ExceptionItemCardConditions";const Me={name:"qeawqx",styles:"max-height:300px;height:100%;overflow-x:hidden;overflow-y:auto"},Te=({text:e,dataTestSubj:t,actions:a,disableActions:r,emptyButton:s,useCustomActions:l,iconType:c,iconSide:u="left",anchorPosition:d="downCenter",panelPaddingSize:p="s"})=>{const[m,y]=Object(n.useState)(!1),g=()=>y((e=>!e)),f=()=>y(!1),b=Object(n.useMemo)((()=>l||null===a?a:a.map((e=>Object(o.jsx)(i.EuiContextMenuItem,{"data-test-subj":`${t||""}ActionItem${e.key}`,key:e.key,icon:e.icon,disabled:e.disabled,layoutAlign:"center",onClick:t=>{f(),"function"==typeof e.onClick&&e.onClick(t)}},e.label)))),[a,t,l]);return Object(o.jsx)(i.EuiFlexGroup,{responsive:!0},Object(o.jsx)(i.EuiPopover,{button:s?Object(o.jsx)(i.EuiButtonEmpty,{isDisabled:r,onClick:g,iconType:c||void 0,iconSide:u,"data-test-subj":`${t||""}EmptyButton`,"aria-label":"Header menu Button Empty"},e):Object(o.jsx)(i.EuiButtonIcon,{isDisabled:r,onClick:g,iconType:c||"boxesHorizontal","data-test-subj":`${t||""}ButtonIcon`,"aria-label":"Header menu Button Icon"},e),onClick:e=>e.stopPropagation(),panelPaddingSize:p,isOpen:m,closePopover:f,anchorPosition:d,"data-test-subj":`${t||""}Items`},b?Object(o.jsx)(i.EuiContextMenuPanel,{css:Me,className:"eui-scrollBar","data-test-subj":`${t||""}MenuPanel`,size:"s",items:b}):null))};Te.displayName="HeaderMenuComponent";const _e=r.a.memo(Te);_e.displayName="HeaderMenu";const Ne=Object(n.memo)((({item:e,actions:t,disableActions:a=!1,dataTestSubj:n})=>Object(o.jsx)(i.EuiFlexGroup,{responsive:!0,"data-test-subj":n,justifyContent:"spaceBetween"},Object(o.jsx)(i.EuiFlexItem,{grow:9},Object(o.jsx)(i.EuiTitle,{size:"xs",textTransform:"uppercase","data-test-subj":`${n}Title`},Object(o.jsx)("h3",null,e.name))),Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(_e,{iconType:"boxesHorizontal",disableActions:a,actions:t,"aria-label":"Exception item actions menu",dataTestSubj:n,anchorPosition:"downCenter"})))));Ne.displayName="ExceptionItemCardHeader";const De=Object(o.css)("font-family:",u.euiThemeVars.euiFontFamily,";",""),Ae=Object(n.memo)((({label:e,lastUpdate:t,lastUpdateValue:a,dataTestSubj:n})=>Object(o.jsx)(i.EuiFlexGroup,{"data-test-subj":`${n||""}metaInfoDetails`,alignItems:"center",gutterSize:"s",wrap:!0,responsive:!0},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiText,{size:"xs",css:De},e)),Object(o.jsx)(i.EuiFlexItem,{grow:!1,"data-test-subj":`${n||""}lastUpdate`},Object(o.jsx)(i.EuiBadge,{color:"default",css:De},t)),null!=a&&Object(o.jsx)(r.a.Fragment,null,Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiText,{size:"xs",css:De},te)),Object(o.jsx)(i.EuiFlexItem,{grow:!1,"data-test-subj":`${n||""}lastUpdateValue`},Object(o.jsx)(i.EuiFlexGroup,{responsive:!0,gutterSize:"xs",alignItems:"center"},Object(o.jsx)(i.EuiFlexItem,{grow:!1},Object(o.jsx)(i.EuiBadge,{color:"hollow",css:De},a))))))));Ae.displayName="MetaInfoDetails";const qe=Object(o.css)("border-bottom:1px solid ",u.euiThemeVars.euiColorLightShade,";",""),Fe=Object(o.css)("color:",u.euiThemeVars.euiColorPrimary,";flex-basis:content;",""),Le=({dataTestSubj:e,linkedRules:t,securityLinkAnchorComponent:a,leftIcon:n=""})=>{if(!t.length||null===a)return null;const r=a;return t.map((a=>Object(o.jsx)(i.EuiContextMenuItem,{css:t.length>1?qe:"","data-test-subj":`${e||""}ActionItem${a.id}`,key:a.id},Object(o.jsx)(i.EuiFlexGroup,{gutterSize:"s",css:Fe},n?Object(o.jsx)(i.EuiFlexItem,{"data-test-subj":`${e||""}LeftIcon`,grow:!1},Object(o.jsx)(i.EuiIcon,{type:n})):null,Object(o.jsx)(i.EuiFlexItem,{css:Fe},Object(o.jsx)(r,{external:!0,referenceName:a.name,referenceId:a.id}))))))},Re=Object(o.css)("border-right:1px solid #d3dae6;padding:",u.euiThemeVars.euiSizeS," ",u.euiThemeVars.euiSizeM," ",u.euiThemeVars.euiSizeS," 0;",""),Pe=Object(n.memo)((({item:e,rules:t,dataTestSubj:a,securityLinkAnchorComponent:s,formattedDateComponent:l})=>{const c=l,u=Object(n.useMemo)((()=>Le({dataTestSubj:a,linkedRules:t,securityLinkAnchorComponent:s})),[a,t,s]),d=Object(n.useMemo)((()=>!!e.expire_time&&new Date(e.expire_time)<=new Date),[e]);return Object(o.jsx)(i.EuiFlexGroup,{alignItems:"center",responsive:!0,gutterSize:"s","data-test-subj":a},null!==c&&Object(o.jsx)(r.a.Fragment,null,Object(o.jsx)(i.EuiFlexItem,{css:Re,grow:!1},Object(o.jsx)(Ae,{label:Q,lastUpdate:Object(o.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentCreatedBy",fieldName:"created_at",value:e.created_at}),lastUpdateValue:e.created_by,dataTestSubj:`${a||""}CreatedBy`})),Object(o.jsx)(i.EuiFlexItem,{css:Re,grow:!1},Object(o.jsx)(Ae,{label:X,lastUpdate:Object(o.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentUpdatedBy",fieldName:"updated_at",value:e.updated_at}),lastUpdateValue:e.updated_by,dataTestSubj:`${a||""}UpdatedBy`})),null!=e.expire_time&&Object(o.jsx)(r.a.Fragment,null,Object(o.jsx)(i.EuiFlexItem,{css:Re,grow:!1},Object(o.jsx)(Ae,{label:d?ee:J,lastUpdate:Object(o.jsx)(c,{"data-test-subj":"{dataTestSubj||''}formattedDateComponentExpireTime",fieldName:"expire_time",value:e.expire_time}),dataTestSubj:`${a||""}ExpireTime`})))),Object(o.jsx)(i.EuiFlexItem,null,Object(o.jsx)(_e,{emptyButton:!0,useCustomActions:!0,iconType:"list",actions:u,disableActions:!1,text:(p=t.length,m.i18n.translate("exceptionList-components.exceptions.card.exceptionItem.affectedRules",{values:{numRules:p},defaultMessage:"Affects {numRules} {numRules, plural, =1 {rule} other {rules}}"})),dataTestSubj:a})));var p}));Pe.displayName="ExceptionItemCardMetaInfo";const ze=Object(o.css)("color:",u.euiThemeVars.euiColorPrimary,";",""),Be=Object(n.memo)((({comments:e,dataTestSubj:t})=>e.length?Object(o.jsx)(i.EuiFlexItem,{"data-test-subj":t},Object(o.jsx)(i.EuiAccordion,{id:"exceptionItemCardComments",buttonContent:Object(o.jsx)(i.EuiText,{size:"s",css:ze,"data-test-subj":`${t||""}TextButton`},ae(e.length)),arrowDisplay:"none","data-test-subj":"exceptionItemCardComments"},Object(o.jsx)(i.EuiPanel,{"data-test-subj":"accordionContentPanel",hasBorder:!0,hasShadow:!0,paddingSize:"m"},Object(o.jsx)(i.EuiCommentList,{"data-test-subj":"accordionCommentList",comments:e})))):null));Be.displayName="ExceptionItemCardComments";const Ge=({disableActions:e=!1,exceptionItem:t,listType:a,ruleReferences:r,dataTestSubj:s,editActionLabel:l,deleteActionLabel:c,securityLinkAnchorComponent:u,formattedDateComponent:d,getFormattedComments:p,onDeleteException:m,onEditException:y})=>{const{actions:g,formattedComments:f}=(({listType:e,editActionLabel:t,deleteActionLabel:a,exceptionItem:r,getFormattedComments:i,onEditException:o,onDeleteException:s})=>{const l=Object(n.useCallback)((()=>{s({id:r.id,name:r.name,namespaceType:r.namespace_type})}),[s,r.id,r.name,r.namespace_type]),c=Object(n.useCallback)((()=>{o(r)}),[o,r]),u=Object(n.useMemo)((()=>i(r.comments)),[r.comments,i]);return{actions:Object(n.useMemo)((()=>[{key:"edit",icon:"controlsHorizontal",label:t||Z(e),onClick:c},{key:"delete",icon:"trash",label:a||K(e),onClick:l}]),[t,e,a,l,c]),formattedComments:u}})({listType:a,editActionLabel:l,deleteActionLabel:c,exceptionItem:t,getFormattedComments:p,onEditException:y,onDeleteException:m});return Object(o.jsx)(i.EuiPanel,{key:`${t.id}exceptionItemPanel`,paddingSize:"l","data-test-subj":s||"",hasBorder:!0,hasShadow:!1},Object(o.jsx)(i.EuiFlexGroup,{responsive:!0,gutterSize:"m",direction:"column"},Object(o.jsx)(i.EuiFlexItem,{"data-test-subj":"exceptionItemCardHeaderContainer"},Object(o.jsx)(Ne,{item:t,actions:g,disableActions:e,dataTestSubj:"exceptionItemCardHeader"})),Object(o.jsx)(i.EuiFlexItem,{"data-test-subj":"exceptionItemCardMeta"},Object(o.jsx)(Pe,{item:t,rules:r,dataTestSubj:"exceptionItemCardMetaInfo",securityLinkAnchorComponent:u,formattedDateComponent:d})),Object(o.jsx)(i.EuiFlexItem,{"data-test-subj":"exceptionItemCardCondition"},Object(o.jsx)(Ce,{os:t.os_types,entries:t.entries,dataTestSubj:"exceptionItemCardConditions"})),f.length>0&&Object(o.jsx)(Be,{dataTestSubj:"exceptionsItemCommentAccordion",comments:f})))};Ge.displayName="ExceptionItemCardComponent";const $e=r.a.memo(Ge);$e.displayName="ExceptionItemCard";var He=a(1128);const Ve=Object(H.css)("display:inline;margin-left:",u.euiThemeVars.euiSizeXS,";",""),Ue=({value:e,tooltipIconType:t="iInCircle",tooltipIconText:a})=>{const{showSpaceWarningIcon:n,warningText:r}=(({value:e,tooltipIconText:t})=>({showSpaceWarningIcon:!!(Array.isArray(e)?e.find(He.d):Object(He.d)(e)),warningText:t||He.c.FIELD_SPACE_WARNING}))({value:e,tooltipIconText:a});return n&&e?Object(o.jsx)("div",{className:Ve},Object(o.jsx)(i.EuiToolTip,{position:"top",content:r},Object(o.jsx)(i.EuiIcon,{"data-test-subj":"valueWithSpaceWarningTooltip",type:t,color:"warning"}))):null},We=Object(o.css)("border-right:1px solid #d3dae6;padding:",u.euiThemeVars.euiSizeXS," ",u.euiThemeVars.euiSizeL," ",u.euiThemeVars.euiSizeXS," 0;",""),Ye={name:"95qvyx",styles:"width:max-content"},Ze=Object(o.css)("font-size:",u.euiThemeVars.euiFontSize,";color:",u.euiThemeVars.euiTextSubduedColor,";margin-left:",u.euiThemeVars.euiSizeXS,";",""),Ke=Object(o.css)("margin-top:-",u.euiThemeVars.euiSizeL,";margin-bottom:-",u.euiThemeVars.euiSizeL,";",""),Qe=Object(o.css)("font-size:",u.euiThemeVars.euiFontSizeXS,";",""),Xe=({dataTestSubj:e,linkedRules:t,securityLinkAnchorComponent:a,isReadonly:r,canUserEditList:s=!0,onDeleteList:l,onManageRules:c,onExportList:u,onDuplicateList:d})=>{const p=Object(n.useMemo)((()=>Le({leftIcon:"check",dataTestSubj:e,linkedRules:t,securityLinkAnchorComponent:a})),[e,t,a]);return Object(o.jsx)(i.EuiFlexGroup,{direction:"row",alignItems:"baseline",justifyContent:"center",responsive:!0,"data-test-subj":`${e||""}Container`,gutterSize:"l"},Object(o.jsx)(i.EuiFlexItem,{css:We},t.length?Object(o.jsx)(_e,{dataTestSubj:`${e||""}LinkedRulesMenu`,emptyButton:!0,useCustomActions:!0,text:j(t.length),actions:p,disableActions:!1,iconType:"arrowDown",iconSide:"right",panelPaddingSize:"none"}):Object(o.jsx)(i.EuiTextColor,{"data-test-subj":"noLinkedRules",css:Ye,color:"subdued"},j(t.length))),s&&Object(o.jsx)(i.EuiFlexItem,null,Object(o.jsx)(i.EuiButton,{"data-test-subj":`${e||""}LinkRulesButton`,fill:!0,onClick:()=>{"function"==typeof c&&c()}},w)),Object(o.jsx)(i.EuiFlexItem,null,Object(o.jsx)(_e,{iconType:"boxesHorizontal",dataTestSubj:`${e||""}MenuActions`,actions:[{key:"1",icon:"exportAction",label:E,onClick:()=>{"function"==typeof u&&u()}},{key:"2",icon:"copy",label:k,onClick:()=>{"function"==typeof d&&d()},disabled:!s},{key:"3",icon:"trash",label:x,onClick:()=>{"function"==typeof l&&l()},disabled:!s}],disableActions:r,anchorPosition:"downCenter"})))};Xe.displayName="MenuItemsComponent";const Je=r.a.memo(Xe);Je.displayName="MenuItems";const et=Object(o.css)("display:flex;width:fit-content;align-items:baseline;padding-bottom:",u.euiThemeVars.euiSizeS,";h1{margin-bottom:0;}",""),tt=Object(o.css)("button{margin-left:-",u.euiThemeVars.euiSizeM,";}",""),at=({isReadonly:e,dataTestSubj:t,text:a,onEdit:n,textCss:r})=>Object(o.jsx)(i.EuiFlexGroup,{css:et},Object(o.jsx)(i.EuiFlexItem,{grow:10},Object(o.jsx)("span",{css:r,"data-test-subj":`${t||""}Text`},a)),Object(o.jsx)(i.EuiFlexItem,{grow:!1,css:tt},e?null:Object(o.jsx)(i.EuiButtonIcon,{"data-test-subj":`${t||""}EditIcon`,"aria-label":"Edit Text List Header",iconType:"pencil",onClick:()=>"function"==typeof n?n():null})));at.displayName="TextWithEditComponent";const nt=r.a.memo(at);nt.displayName="TextWithEdit";const rt=({listDetails:e,onSave:t,onCancel:a})=>{const{error:r,modalFormId:s,newListDetails:l,showProgress:c,onBlur:u,onSubmit:d,onChange:p}=(({listDetails:e,onSave:t})=>{const a=Object(i.useGeneratedHtmlId)({prefix:"modalForm"}),[r,o]=Object(n.useState)(e),[s,l]=Object(n.useState)(!1),[c,u]=Object(n.useState)(void 0),d=Object(n.useCallback)((({target:e})=>{const{name:t,value:a}=e,n=a.trim();o({...r,[t]:n}),"name"===t&&u(n?void 0:D)}),[r]);return{error:c,modalFormId:a,newListDetails:r,showProgress:s,onBlur:d,onChange:({target:e})=>{const{name:t,value:a}=e;o({...r,[t]:a})},onSubmit:e=>{c||(l(!0),t(r),null==e||e.preventDefault())}}})({listDetails:e,onSave:t});return Object(o.jsx)(i.EuiModal,{"data-test-subj":"EditModal",onClose:a,initialFocus:"[name=popswitch]"},c&&Object(o.jsx)(i.EuiProgress,{"data-test-subj":"editModalProgess",size:"xs",position:"absolute"}),Object(o.jsx)(i.EuiModalHeader,null,Object(o.jsx)(i.EuiModalHeaderTitle,{"data-test-subj":"editModalTitle"},(y=e.name,m.i18n.translate("exceptionList-components.exception_list_header_edit_modal_name",{defaultMessage:"Edit {listName}",values:{listName:y}})))),Object(o.jsx)(i.EuiModalBody,null,Object(o.jsx)(i.EuiForm,{id:s,"data-test-subj":"editModalForm",component:"form",onSubmit:d},Object(o.jsx)(i.EuiFormRow,{error:r,isInvalid:!!r,fullWidth:!0,label:_},Object(o.jsx)(i.EuiFieldText,{fullWidth:!0,isInvalid:!!r,onBlur:u,"data-test-subj":"editModalNameTextField",name:"name",value:l.name,onChange:p})),Object(o.jsx)(i.EuiFormRow,{fullWidth:!0,label:N},Object(o.jsx)(i.EuiTextArea,{fullWidth:!0,"data-test-subj":"editModalDescriptionTextField",name:"description",value:l.description,onChange:p,onBlur:u})))),Object(o.jsx)(i.EuiModalFooter,null,Object(o.jsx)(i.EuiButtonEmpty,{"data-test-subj":"editModalCancelBtn",onClick:a},T),Object(o.jsx)(i.EuiButton,{"data-test-subj":"editModalSaveBtn",type:"submit",form:s,onClick:d,fill:!0},M)));var y};rt.displayName="EditModalComponent";const it=r.a.memo(rt);it.displayName="EditModal";const ot=({name:e,description:t,listId:a,linkedRules:r,isReadonly:s,dataTestSubj:l,securityLinkAnchorComponent:c,backOptions:u,canUserEditList:d=!0,onEditListDetails:p,onDeleteList:m,onManageRules:y,onExportList:g,onDuplicateList:f})=>{const{isModalVisible:b,listDetails:h,onEdit:v,onSave:E,onCancel:x}=(({name:e,description:t,onEditListDetails:a})=>{const[r,i]=Object(n.useState)(!1),[o,s]=Object(n.useState)({name:e,description:t});return{isModalVisible:r,listDetails:o,onEdit:()=>{i(!0)},onSave:e=>{s(e),"function"==typeof a&&a(e),setTimeout((()=>{i(!1)}),200)},onCancel:()=>{i(!1)}}})({name:e,description:t,onEditListDetails:p});return Object(o.jsx)("div",null,Object(o.jsx)(i.EuiPageHeader,{bottomBorder:!0,paddingSize:"none",pageTitle:Object(o.jsx)(nt,{dataTestSubj:`${l||""}Title`,text:h.name||I,isReadonly:s||!d,onEdit:v}),responsive:!0,"data-test-subj":`${l||""}PageHeader`,description:Object(o.jsx)("div",{css:Ke},Object(o.jsx)(nt,{dataTestSubj:`${l||""}Description`,textCss:Ze,isReadonly:s||!d,text:h.description||C,onEdit:v}),Object(o.jsx)("div",{css:et,"data-test-subj":`${l||""}ListID`},Object(o.jsx)(i.EuiText,{css:Ze},O,":"),Object(o.jsx)(i.EuiText,{css:Ze},a))),rightSideItems:[Object(o.jsx)(Je,{dataTestSubj:`${l||""}RightSideMenuItems`,linkedRules:r,isReadonly:s,canUserEditList:d,securityLinkAnchorComponent:c,onDeleteList:m,onManageRules:y,onExportList:g,onDuplicateList:f})],breadcrumbs:[{text:Object(o.jsx)("div",{"data-test-subj":`${l||""}Breadcrumb`,css:Qe},Object(o.jsx)(i.EuiIcon,{size:"s",type:"arrowLeft"}),S),color:"primary","aria-current":!1,href:u.path,onClick:e=>{e.preventDefault(),u.onNavigate(u.path)}}]}),b&&Object(o.jsx)(it,{listDetails:h,onSave:E,onCancel:x}))};ot.displayName="ExceptionListHeaderComponent";const st=r.a.memo(ot);st.displayName="ExceptionListHeader"},741:function(e,t,a){"use strict";a.d(t,"e",(function(){return w})),a.d(t,"f",(function(){return j})),a.d(t,"g",(function(){return S})),a.d(t,"c",(function(){return C})),a.d(t,"a",(function(){return T})),a.d(t,"b",(function(){return _})),a.d(t,"d",(function(){return N}));var n=a(9);const r={"@timestamp":{type:"date",array:!1,required:!0},"agent.build.original":{type:"keyword",array:!1,required:!1},"agent.ephemeral_id":{type:"keyword",array:!1,required:!1},"agent.id":{type:"keyword",array:!1,required:!1},"agent.name":{type:"keyword",array:!1,required:!1},"agent.type":{type:"keyword",array:!1,required:!1},"agent.version":{type:"keyword",array:!1,required:!1},"client.address":{type:"keyword",array:!1,required:!1},"client.as.number":{type:"long",array:!1,required:!1},"client.as.organization.name":{type:"keyword",array:!1,required:!1},"client.bytes":{type:"long",array:!1,required:!1},"client.domain":{type:"keyword",array:!1,required:!1},"client.geo.city_name":{type:"keyword",array:!1,required:!1},"client.geo.continent_code":{type:"keyword",array:!1,required:!1},"client.geo.continent_name":{type:"keyword",array:!1,required:!1},"client.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.country_name":{type:"keyword",array:!1,required:!1},"client.geo.location":{type:"geo_point",array:!1,required:!1},"client.geo.name":{type:"keyword",array:!1,required:!1},"client.geo.postal_code":{type:"keyword",array:!1,required:!1},"client.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"client.geo.region_name":{type:"keyword",array:!1,required:!1},"client.geo.timezone":{type:"keyword",array:!1,required:!1},"client.ip":{type:"ip",array:!1,required:!1},"client.mac":{type:"keyword",array:!1,required:!1},"client.nat.ip":{type:"ip",array:!1,required:!1},"client.nat.port":{type:"long",array:!1,required:!1},"client.packets":{type:"long",array:!1,required:!1},"client.port":{type:"long",array:!1,required:!1},"client.registered_domain":{type:"keyword",array:!1,required:!1},"client.subdomain":{type:"keyword",array:!1,required:!1},"client.top_level_domain":{type:"keyword",array:!1,required:!1},"client.user.domain":{type:"keyword",array:!1,required:!1},"client.user.email":{type:"keyword",array:!1,required:!1},"client.user.full_name":{type:"keyword",array:!1,required:!1},"client.user.group.domain":{type:"keyword",array:!1,required:!1},"client.user.group.id":{type:"keyword",array:!1,required:!1},"client.user.group.name":{type:"keyword",array:!1,required:!1},"client.user.hash":{type:"keyword",array:!1,required:!1},"client.user.id":{type:"keyword",array:!1,required:!1},"client.user.name":{type:"keyword",array:!1,required:!1},"client.user.roles":{type:"keyword",array:!0,required:!1},"cloud.account.id":{type:"keyword",array:!1,required:!1},"cloud.account.name":{type:"keyword",array:!1,required:!1},"cloud.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.instance.id":{type:"keyword",array:!1,required:!1},"cloud.instance.name":{type:"keyword",array:!1,required:!1},"cloud.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.account.id":{type:"keyword",array:!1,required:!1},"cloud.origin.account.name":{type:"keyword",array:!1,required:!1},"cloud.origin.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.id":{type:"keyword",array:!1,required:!1},"cloud.origin.instance.name":{type:"keyword",array:!1,required:!1},"cloud.origin.machine.type":{type:"keyword",array:!1,required:!1},"cloud.origin.project.id":{type:"keyword",array:!1,required:!1},"cloud.origin.project.name":{type:"keyword",array:!1,required:!1},"cloud.origin.provider":{type:"keyword",array:!1,required:!1},"cloud.origin.region":{type:"keyword",array:!1,required:!1},"cloud.origin.service.name":{type:"keyword",array:!1,required:!1},"cloud.project.id":{type:"keyword",array:!1,required:!1},"cloud.project.name":{type:"keyword",array:!1,required:!1},"cloud.provider":{type:"keyword",array:!1,required:!1},"cloud.region":{type:"keyword",array:!1,required:!1},"cloud.service.name":{type:"keyword",array:!1,required:!1},"cloud.target.account.id":{type:"keyword",array:!1,required:!1},"cloud.target.account.name":{type:"keyword",array:!1,required:!1},"cloud.target.availability_zone":{type:"keyword",array:!1,required:!1},"cloud.target.instance.id":{type:"keyword",array:!1,required:!1},"cloud.target.instance.name":{type:"keyword",array:!1,required:!1},"cloud.target.machine.type":{type:"keyword",array:!1,required:!1},"cloud.target.project.id":{type:"keyword",array:!1,required:!1},"cloud.target.project.name":{type:"keyword",array:!1,required:!1},"cloud.target.provider":{type:"keyword",array:!1,required:!1},"cloud.target.region":{type:"keyword",array:!1,required:!1},"cloud.target.service.name":{type:"keyword",array:!1,required:!1},"container.id":{type:"keyword",array:!1,required:!1},"container.image.name":{type:"keyword",array:!1,required:!1},"container.image.tag":{type:"keyword",array:!0,required:!1},"container.labels":{type:"object",array:!1,required:!1},"container.name":{type:"keyword",array:!1,required:!1},"container.runtime":{type:"keyword",array:!1,required:!1},"destination.address":{type:"keyword",array:!1,required:!1},"destination.as.number":{type:"long",array:!1,required:!1},"destination.as.organization.name":{type:"keyword",array:!1,required:!1},"destination.bytes":{type:"long",array:!1,required:!1},"destination.domain":{type:"keyword",array:!1,required:!1},"destination.geo.city_name":{type:"keyword",array:!1,required:!1},"destination.geo.continent_code":{type:"keyword",array:!1,required:!1},"destination.geo.continent_name":{type:"keyword",array:!1,required:!1},"destination.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.country_name":{type:"keyword",array:!1,required:!1},"destination.geo.location":{type:"geo_point",array:!1,required:!1},"destination.geo.name":{type:"keyword",array:!1,required:!1},"destination.geo.postal_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"destination.geo.region_name":{type:"keyword",array:!1,required:!1},"destination.geo.timezone":{type:"keyword",array:!1,required:!1},"destination.ip":{type:"ip",array:!1,required:!1},"destination.mac":{type:"keyword",array:!1,required:!1},"destination.nat.ip":{type:"ip",array:!1,required:!1},"destination.nat.port":{type:"long",array:!1,required:!1},"destination.packets":{type:"long",array:!1,required:!1},"destination.port":{type:"long",array:!1,required:!1},"destination.registered_domain":{type:"keyword",array:!1,required:!1},"destination.subdomain":{type:"keyword",array:!1,required:!1},"destination.top_level_domain":{type:"keyword",array:!1,required:!1},"destination.user.domain":{type:"keyword",array:!1,required:!1},"destination.user.email":{type:"keyword",array:!1,required:!1},"destination.user.full_name":{type:"keyword",array:!1,required:!1},"destination.user.group.domain":{type:"keyword",array:!1,required:!1},"destination.user.group.id":{type:"keyword",array:!1,required:!1},"destination.user.group.name":{type:"keyword",array:!1,required:!1},"destination.user.hash":{type:"keyword",array:!1,required:!1},"destination.user.id":{type:"keyword",array:!1,required:!1},"destination.user.name":{type:"keyword",array:!1,required:!1},"destination.user.roles":{type:"keyword",array:!0,required:!1},"dll.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"dll.code_signature.exists":{type:"boolean",array:!1,required:!1},"dll.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.status":{type:"keyword",array:!1,required:!1},"dll.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"dll.code_signature.team_id":{type:"keyword",array:!1,required:!1},"dll.code_signature.timestamp":{type:"date",array:!1,required:!1},"dll.code_signature.trusted":{type:"boolean",array:!1,required:!1},"dll.code_signature.valid":{type:"boolean",array:!1,required:!1},"dll.hash.md5":{type:"keyword",array:!1,required:!1},"dll.hash.sha1":{type:"keyword",array:!1,required:!1},"dll.hash.sha256":{type:"keyword",array:!1,required:!1},"dll.hash.sha512":{type:"keyword",array:!1,required:!1},"dll.hash.ssdeep":{type:"keyword",array:!1,required:!1},"dll.name":{type:"keyword",array:!1,required:!1},"dll.path":{type:"keyword",array:!1,required:!1},"dll.pe.architecture":{type:"keyword",array:!1,required:!1},"dll.pe.company":{type:"keyword",array:!1,required:!1},"dll.pe.description":{type:"keyword",array:!1,required:!1},"dll.pe.file_version":{type:"keyword",array:!1,required:!1},"dll.pe.imphash":{type:"keyword",array:!1,required:!1},"dll.pe.original_file_name":{type:"keyword",array:!1,required:!1},"dll.pe.product":{type:"keyword",array:!1,required:!1},"dns.answers":{type:"object",array:!0,required:!1},"dns.answers.class":{type:"keyword",array:!1,required:!1},"dns.answers.data":{type:"keyword",array:!1,required:!1},"dns.answers.name":{type:"keyword",array:!1,required:!1},"dns.answers.ttl":{type:"long",array:!1,required:!1},"dns.answers.type":{type:"keyword",array:!1,required:!1},"dns.header_flags":{type:"keyword",array:!0,required:!1},"dns.id":{type:"keyword",array:!1,required:!1},"dns.op_code":{type:"keyword",array:!1,required:!1},"dns.question.class":{type:"keyword",array:!1,required:!1},"dns.question.name":{type:"keyword",array:!1,required:!1},"dns.question.registered_domain":{type:"keyword",array:!1,required:!1},"dns.question.subdomain":{type:"keyword",array:!1,required:!1},"dns.question.top_level_domain":{type:"keyword",array:!1,required:!1},"dns.question.type":{type:"keyword",array:!1,required:!1},"dns.resolved_ip":{type:"ip",array:!0,required:!1},"dns.response_code":{type:"keyword",array:!1,required:!1},"dns.type":{type:"keyword",array:!1,required:!1},"ecs.version":{type:"keyword",array:!1,required:!0},"error.code":{type:"keyword",array:!1,required:!1},"error.id":{type:"keyword",array:!1,required:!1},"error.message":{type:"match_only_text",array:!1,required:!1},"error.stack_trace":{type:"wildcard",array:!1,required:!1},"error.type":{type:"keyword",array:!1,required:!1},"event.action":{type:"keyword",array:!1,required:!1},"event.agent_id_status":{type:"keyword",array:!1,required:!1},"event.category":{type:"keyword",array:!0,required:!1},"event.code":{type:"keyword",array:!1,required:!1},"event.created":{type:"date",array:!1,required:!1},"event.dataset":{type:"keyword",array:!1,required:!1},"event.duration":{type:"long",array:!1,required:!1},"event.end":{type:"date",array:!1,required:!1},"event.hash":{type:"keyword",array:!1,required:!1},"event.id":{type:"keyword",array:!1,required:!1},"event.ingested":{type:"date",array:!1,required:!1},"event.kind":{type:"keyword",array:!1,required:!1},"event.module":{type:"keyword",array:!1,required:!1},"event.original":{type:"keyword",array:!1,required:!1},"event.outcome":{type:"keyword",array:!1,required:!1},"event.provider":{type:"keyword",array:!1,required:!1},"event.reason":{type:"keyword",array:!1,required:!1},"event.reference":{type:"keyword",array:!1,required:!1},"event.risk_score":{type:"float",array:!1,required:!1},"event.risk_score_norm":{type:"float",array:!1,required:!1},"event.sequence":{type:"long",array:!1,required:!1},"event.severity":{type:"long",array:!1,required:!1},"event.start":{type:"date",array:!1,required:!1},"event.timezone":{type:"keyword",array:!1,required:!1},"event.type":{type:"keyword",array:!0,required:!1},"event.url":{type:"keyword",array:!1,required:!1},"faas.coldstart":{type:"boolean",array:!1,required:!1},"faas.execution":{type:"keyword",array:!1,required:!1},"faas.trigger":{type:"nested",array:!1,required:!1},"faas.trigger.request_id":{type:"keyword",array:!1,required:!1},"faas.trigger.type":{type:"keyword",array:!1,required:!1},"file.accessed":{type:"date",array:!1,required:!1},"file.attributes":{type:"keyword",array:!0,required:!1},"file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"file.code_signature.exists":{type:"boolean",array:!1,required:!1},"file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"file.code_signature.status":{type:"keyword",array:!1,required:!1},"file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"file.code_signature.timestamp":{type:"date",array:!1,required:!1},"file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"file.code_signature.valid":{type:"boolean",array:!1,required:!1},"file.created":{type:"date",array:!1,required:!1},"file.ctime":{type:"date",array:!1,required:!1},"file.device":{type:"keyword",array:!1,required:!1},"file.directory":{type:"keyword",array:!1,required:!1},"file.drive_letter":{type:"keyword",array:!1,required:!1},"file.elf.architecture":{type:"keyword",array:!1,required:!1},"file.elf.byte_order":{type:"keyword",array:!1,required:!1},"file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"file.elf.creation_date":{type:"date",array:!1,required:!1},"file.elf.exports":{type:"flattened",array:!0,required:!1},"file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"file.elf.header.class":{type:"keyword",array:!1,required:!1},"file.elf.header.data":{type:"keyword",array:!1,required:!1},"file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"file.elf.header.type":{type:"keyword",array:!1,required:!1},"file.elf.header.version":{type:"keyword",array:!1,required:!1},"file.elf.imports":{type:"flattened",array:!0,required:!1},"file.elf.sections":{type:"nested",array:!0,required:!1},"file.elf.sections.chi2":{type:"long",array:!1,required:!1},"file.elf.sections.entropy":{type:"long",array:!1,required:!1},"file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"file.elf.sections.name":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"file.elf.sections.type":{type:"keyword",array:!1,required:!1},"file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"file.elf.segments":{type:"nested",array:!0,required:!1},"file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"file.elf.segments.type":{type:"keyword",array:!1,required:!1},"file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"file.elf.telfhash":{type:"keyword",array:!1,required:!1},"file.extension":{type:"keyword",array:!1,required:!1},"file.fork_name":{type:"keyword",array:!1,required:!1},"file.gid":{type:"keyword",array:!1,required:!1},"file.group":{type:"keyword",array:!1,required:!1},"file.hash.md5":{type:"keyword",array:!1,required:!1},"file.hash.sha1":{type:"keyword",array:!1,required:!1},"file.hash.sha256":{type:"keyword",array:!1,required:!1},"file.hash.sha512":{type:"keyword",array:!1,required:!1},"file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"file.inode":{type:"keyword",array:!1,required:!1},"file.mime_type":{type:"keyword",array:!1,required:!1},"file.mode":{type:"keyword",array:!1,required:!1},"file.mtime":{type:"date",array:!1,required:!1},"file.name":{type:"keyword",array:!1,required:!1},"file.owner":{type:"keyword",array:!1,required:!1},"file.path":{type:"keyword",array:!1,required:!1},"file.pe.architecture":{type:"keyword",array:!1,required:!1},"file.pe.company":{type:"keyword",array:!1,required:!1},"file.pe.description":{type:"keyword",array:!1,required:!1},"file.pe.file_version":{type:"keyword",array:!1,required:!1},"file.pe.imphash":{type:"keyword",array:!1,required:!1},"file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"file.pe.product":{type:"keyword",array:!1,required:!1},"file.size":{type:"long",array:!1,required:!1},"file.target_path":{type:"keyword",array:!1,required:!1},"file.type":{type:"keyword",array:!1,required:!1},"file.uid":{type:"keyword",array:!1,required:!1},"file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.not_after":{type:"date",array:!1,required:!1},"file.x509.not_before":{type:"date",array:!1,required:!1},"file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"file.x509.public_key_size":{type:"long",array:!1,required:!1},"file.x509.serial_number":{type:"keyword",array:!1,required:!1},"file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"file.x509.subject.country":{type:"keyword",array:!0,required:!1},"file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"file.x509.version_number":{type:"keyword",array:!1,required:!1},"group.domain":{type:"keyword",array:!1,required:!1},"group.id":{type:"keyword",array:!1,required:!1},"group.name":{type:"keyword",array:!1,required:!1},"host.architecture":{type:"keyword",array:!1,required:!1},"host.boot.id":{type:"keyword",array:!1,required:!1},"host.cpu.usage":{type:"scaled_float",array:!1,required:!1,scaling_factor:1e3},"host.disk.read.bytes":{type:"long",array:!1,required:!1},"host.disk.write.bytes":{type:"long",array:!1,required:!1},"host.domain":{type:"keyword",array:!1,required:!1},"host.geo.city_name":{type:"keyword",array:!1,required:!1},"host.geo.continent_code":{type:"keyword",array:!1,required:!1},"host.geo.continent_name":{type:"keyword",array:!1,required:!1},"host.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.country_name":{type:"keyword",array:!1,required:!1},"host.geo.location":{type:"geo_point",array:!1,required:!1},"host.geo.name":{type:"keyword",array:!1,required:!1},"host.geo.postal_code":{type:"keyword",array:!1,required:!1},"host.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"host.geo.region_name":{type:"keyword",array:!1,required:!1},"host.geo.timezone":{type:"keyword",array:!1,required:!1},"host.hostname":{type:"keyword",array:!1,required:!1},"host.id":{type:"keyword",array:!1,required:!1},"host.ip":{type:"ip",array:!0,required:!1},"host.mac":{type:"keyword",array:!0,required:!1},"host.name":{type:"keyword",array:!1,required:!1},"host.network.egress.bytes":{type:"long",array:!1,required:!1},"host.network.egress.packets":{type:"long",array:!1,required:!1},"host.network.ingress.bytes":{type:"long",array:!1,required:!1},"host.network.ingress.packets":{type:"long",array:!1,required:!1},"host.os.family":{type:"keyword",array:!1,required:!1},"host.os.full":{type:"keyword",array:!1,required:!1},"host.os.kernel":{type:"keyword",array:!1,required:!1},"host.os.name":{type:"keyword",array:!1,required:!1},"host.os.platform":{type:"keyword",array:!1,required:!1},"host.os.type":{type:"keyword",array:!1,required:!1},"host.os.version":{type:"keyword",array:!1,required:!1},"host.pid_ns_ino":{type:"keyword",array:!1,required:!1},"host.risk.calculated_level":{type:"keyword",array:!1,required:!1},"host.risk.calculated_score":{type:"float",array:!1,required:!1},"host.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"host.risk.static_level":{type:"keyword",array:!1,required:!1},"host.risk.static_score":{type:"float",array:!1,required:!1},"host.risk.static_score_norm":{type:"float",array:!1,required:!1},"host.type":{type:"keyword",array:!1,required:!1},"host.uptime":{type:"long",array:!1,required:!1},"http.request.body.bytes":{type:"long",array:!1,required:!1},"http.request.body.content":{type:"wildcard",array:!1,required:!1},"http.request.bytes":{type:"long",array:!1,required:!1},"http.request.id":{type:"keyword",array:!1,required:!1},"http.request.method":{type:"keyword",array:!1,required:!1},"http.request.mime_type":{type:"keyword",array:!1,required:!1},"http.request.referrer":{type:"keyword",array:!1,required:!1},"http.response.body.bytes":{type:"long",array:!1,required:!1},"http.response.body.content":{type:"wildcard",array:!1,required:!1},"http.response.bytes":{type:"long",array:!1,required:!1},"http.response.mime_type":{type:"keyword",array:!1,required:!1},"http.response.status_code":{type:"long",array:!1,required:!1},"http.version":{type:"keyword",array:!1,required:!1},labels:{type:"object",array:!1,required:!1},"log.file.path":{type:"keyword",array:!1,required:!1},"log.level":{type:"keyword",array:!1,required:!1},"log.logger":{type:"keyword",array:!1,required:!1},"log.origin.file.line":{type:"long",array:!1,required:!1},"log.origin.file.name":{type:"keyword",array:!1,required:!1},"log.origin.function":{type:"keyword",array:!1,required:!1},"log.syslog":{type:"object",array:!1,required:!1},"log.syslog.facility.code":{type:"long",array:!1,required:!1},"log.syslog.facility.name":{type:"keyword",array:!1,required:!1},"log.syslog.priority":{type:"long",array:!1,required:!1},"log.syslog.severity.code":{type:"long",array:!1,required:!1},"log.syslog.severity.name":{type:"keyword",array:!1,required:!1},message:{type:"match_only_text",array:!1,required:!1},"network.application":{type:"keyword",array:!1,required:!1},"network.bytes":{type:"long",array:!1,required:!1},"network.community_id":{type:"keyword",array:!1,required:!1},"network.direction":{type:"keyword",array:!1,required:!1},"network.forwarded_ip":{type:"ip",array:!1,required:!1},"network.iana_number":{type:"keyword",array:!1,required:!1},"network.inner":{type:"object",array:!1,required:!1},"network.inner.vlan.id":{type:"keyword",array:!1,required:!1},"network.inner.vlan.name":{type:"keyword",array:!1,required:!1},"network.name":{type:"keyword",array:!1,required:!1},"network.packets":{type:"long",array:!1,required:!1},"network.protocol":{type:"keyword",array:!1,required:!1},"network.transport":{type:"keyword",array:!1,required:!1},"network.type":{type:"keyword",array:!1,required:!1},"network.vlan.id":{type:"keyword",array:!1,required:!1},"network.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress":{type:"object",array:!1,required:!1},"observer.egress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.egress.interface.id":{type:"keyword",array:!1,required:!1},"observer.egress.interface.name":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.egress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.egress.zone":{type:"keyword",array:!1,required:!1},"observer.geo.city_name":{type:"keyword",array:!1,required:!1},"observer.geo.continent_code":{type:"keyword",array:!1,required:!1},"observer.geo.continent_name":{type:"keyword",array:!1,required:!1},"observer.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.country_name":{type:"keyword",array:!1,required:!1},"observer.geo.location":{type:"geo_point",array:!1,required:!1},"observer.geo.name":{type:"keyword",array:!1,required:!1},"observer.geo.postal_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"observer.geo.region_name":{type:"keyword",array:!1,required:!1},"observer.geo.timezone":{type:"keyword",array:!1,required:!1},"observer.hostname":{type:"keyword",array:!1,required:!1},"observer.ingress":{type:"object",array:!1,required:!1},"observer.ingress.interface.alias":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.id":{type:"keyword",array:!1,required:!1},"observer.ingress.interface.name":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.id":{type:"keyword",array:!1,required:!1},"observer.ingress.vlan.name":{type:"keyword",array:!1,required:!1},"observer.ingress.zone":{type:"keyword",array:!1,required:!1},"observer.ip":{type:"ip",array:!0,required:!1},"observer.mac":{type:"keyword",array:!0,required:!1},"observer.name":{type:"keyword",array:!1,required:!1},"observer.os.family":{type:"keyword",array:!1,required:!1},"observer.os.full":{type:"keyword",array:!1,required:!1},"observer.os.kernel":{type:"keyword",array:!1,required:!1},"observer.os.name":{type:"keyword",array:!1,required:!1},"observer.os.platform":{type:"keyword",array:!1,required:!1},"observer.os.type":{type:"keyword",array:!1,required:!1},"observer.os.version":{type:"keyword",array:!1,required:!1},"observer.product":{type:"keyword",array:!1,required:!1},"observer.serial_number":{type:"keyword",array:!1,required:!1},"observer.type":{type:"keyword",array:!1,required:!1},"observer.vendor":{type:"keyword",array:!1,required:!1},"observer.version":{type:"keyword",array:!1,required:!1},"orchestrator.api_version":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.id":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.name":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.url":{type:"keyword",array:!1,required:!1},"orchestrator.cluster.version":{type:"keyword",array:!1,required:!1},"orchestrator.namespace":{type:"keyword",array:!1,required:!1},"orchestrator.organization":{type:"keyword",array:!1,required:!1},"orchestrator.resource.id":{type:"keyword",array:!1,required:!1},"orchestrator.resource.ip":{type:"ip",array:!0,required:!1},"orchestrator.resource.name":{type:"keyword",array:!1,required:!1},"orchestrator.resource.parent.type":{type:"keyword",array:!1,required:!1},"orchestrator.resource.type":{type:"keyword",array:!1,required:!1},"orchestrator.type":{type:"keyword",array:!1,required:!1},"organization.id":{type:"keyword",array:!1,required:!1},"organization.name":{type:"keyword",array:!1,required:!1},"package.architecture":{type:"keyword",array:!1,required:!1},"package.build_version":{type:"keyword",array:!1,required:!1},"package.checksum":{type:"keyword",array:!1,required:!1},"package.description":{type:"keyword",array:!1,required:!1},"package.install_scope":{type:"keyword",array:!1,required:!1},"package.installed":{type:"date",array:!1,required:!1},"package.license":{type:"keyword",array:!1,required:!1},"package.name":{type:"keyword",array:!1,required:!1},"package.path":{type:"keyword",array:!1,required:!1},"package.reference":{type:"keyword",array:!1,required:!1},"package.size":{type:"long",array:!1,required:!1},"package.type":{type:"keyword",array:!1,required:!1},"package.version":{type:"keyword",array:!1,required:!1},"process.args":{type:"keyword",array:!0,required:!1},"process.args_count":{type:"long",array:!1,required:!1},"process.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.code_signature.status":{type:"keyword",array:!1,required:!1},"process.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.command_line":{type:"wildcard",array:!1,required:!1},"process.elf.architecture":{type:"keyword",array:!1,required:!1},"process.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.elf.creation_date":{type:"date",array:!1,required:!1},"process.elf.exports":{type:"flattened",array:!0,required:!1},"process.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.elf.header.class":{type:"keyword",array:!1,required:!1},"process.elf.header.data":{type:"keyword",array:!1,required:!1},"process.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.elf.header.type":{type:"keyword",array:!1,required:!1},"process.elf.header.version":{type:"keyword",array:!1,required:!1},"process.elf.imports":{type:"flattened",array:!0,required:!1},"process.elf.sections":{type:"nested",array:!0,required:!1},"process.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.elf.segments":{type:"nested",array:!0,required:!1},"process.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.end":{type:"date",array:!1,required:!1},"process.entity_id":{type:"keyword",array:!1,required:!1},"process.entry_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.executable":{type:"keyword",array:!1,required:!1},"process.exit_code":{type:"long",array:!1,required:!1},"process.hash.md5":{type:"keyword",array:!1,required:!1},"process.hash.sha1":{type:"keyword",array:!1,required:!1},"process.hash.sha256":{type:"keyword",array:!1,required:!1},"process.hash.sha512":{type:"keyword",array:!1,required:!1},"process.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.name":{type:"keyword",array:!1,required:!1},"process.parent.args":{type:"keyword",array:!0,required:!1},"process.parent.args_count":{type:"long",array:!1,required:!1},"process.parent.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.exists":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.status":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.team_id":{type:"keyword",array:!1,required:!1},"process.parent.code_signature.timestamp":{type:"date",array:!1,required:!1},"process.parent.code_signature.trusted":{type:"boolean",array:!1,required:!1},"process.parent.code_signature.valid":{type:"boolean",array:!1,required:!1},"process.parent.command_line":{type:"wildcard",array:!1,required:!1},"process.parent.elf.architecture":{type:"keyword",array:!1,required:!1},"process.parent.elf.byte_order":{type:"keyword",array:!1,required:!1},"process.parent.elf.cpu_type":{type:"keyword",array:!1,required:!1},"process.parent.elf.creation_date":{type:"date",array:!1,required:!1},"process.parent.elf.exports":{type:"flattened",array:!0,required:!1},"process.parent.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.class":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.data":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.entrypoint":{type:"long",array:!1,required:!1},"process.parent.elf.header.object_version":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.header.version":{type:"keyword",array:!1,required:!1},"process.parent.elf.imports":{type:"flattened",array:!0,required:!1},"process.parent.elf.sections":{type:"nested",array:!0,required:!1},"process.parent.elf.sections.chi2":{type:"long",array:!1,required:!1},"process.parent.elf.sections.entropy":{type:"long",array:!1,required:!1},"process.parent.elf.sections.flags":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.name":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.physical_size":{type:"long",array:!1,required:!1},"process.parent.elf.sections.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"process.parent.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"process.parent.elf.segments":{type:"nested",array:!0,required:!1},"process.parent.elf.segments.sections":{type:"keyword",array:!1,required:!1},"process.parent.elf.segments.type":{type:"keyword",array:!1,required:!1},"process.parent.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"process.parent.elf.telfhash":{type:"keyword",array:!1,required:!1},"process.parent.end":{type:"date",array:!1,required:!1},"process.parent.entity_id":{type:"keyword",array:!1,required:!1},"process.parent.executable":{type:"keyword",array:!1,required:!1},"process.parent.exit_code":{type:"long",array:!1,required:!1},"process.parent.hash.md5":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha1":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha256":{type:"keyword",array:!1,required:!1},"process.parent.hash.sha512":{type:"keyword",array:!1,required:!1},"process.parent.hash.ssdeep":{type:"keyword",array:!1,required:!1},"process.parent.name":{type:"keyword",array:!1,required:!1},"process.parent.pe.architecture":{type:"keyword",array:!1,required:!1},"process.parent.pe.company":{type:"keyword",array:!1,required:!1},"process.parent.pe.description":{type:"keyword",array:!1,required:!1},"process.parent.pe.file_version":{type:"keyword",array:!1,required:!1},"process.parent.pe.imphash":{type:"keyword",array:!1,required:!1},"process.parent.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.parent.pe.product":{type:"keyword",array:!1,required:!1},"process.parent.pgid":{type:"long",array:!1,required:!1},"process.parent.pid":{type:"long",array:!1,required:!1},"process.parent.start":{type:"date",array:!1,required:!1},"process.parent.thread.id":{type:"long",array:!1,required:!1},"process.parent.thread.name":{type:"keyword",array:!1,required:!1},"process.parent.title":{type:"keyword",array:!1,required:!1},"process.parent.uptime":{type:"long",array:!1,required:!1},"process.parent.working_directory":{type:"keyword",array:!1,required:!1},"process.pe.architecture":{type:"keyword",array:!1,required:!1},"process.pe.company":{type:"keyword",array:!1,required:!1},"process.pe.description":{type:"keyword",array:!1,required:!1},"process.pe.file_version":{type:"keyword",array:!1,required:!1},"process.pe.imphash":{type:"keyword",array:!1,required:!1},"process.pe.original_file_name":{type:"keyword",array:!1,required:!1},"process.pe.product":{type:"keyword",array:!1,required:!1},"process.pgid":{type:"long",array:!1,required:!1},"process.pid":{type:"long",array:!1,required:!1},"process.session_leader.entity_id":{type:"keyword",array:!1,required:!1},"process.start":{type:"date",array:!1,required:!1},"process.thread.id":{type:"long",array:!1,required:!1},"process.thread.name":{type:"keyword",array:!1,required:!1},"process.title":{type:"keyword",array:!1,required:!1},"process.uptime":{type:"long",array:!1,required:!1},"process.working_directory":{type:"keyword",array:!1,required:!1},"registry.data.bytes":{type:"keyword",array:!1,required:!1},"registry.data.strings":{type:"wildcard",array:!0,required:!1},"registry.data.type":{type:"keyword",array:!1,required:!1},"registry.hive":{type:"keyword",array:!1,required:!1},"registry.key":{type:"keyword",array:!1,required:!1},"registry.path":{type:"keyword",array:!1,required:!1},"registry.value":{type:"keyword",array:!1,required:!1},"related.hash":{type:"keyword",array:!0,required:!1},"related.hosts":{type:"keyword",array:!0,required:!1},"related.ip":{type:"ip",array:!0,required:!1},"related.user":{type:"keyword",array:!0,required:!1},"rule.author":{type:"keyword",array:!0,required:!1},"rule.category":{type:"keyword",array:!1,required:!1},"rule.description":{type:"keyword",array:!1,required:!1},"rule.id":{type:"keyword",array:!1,required:!1},"rule.license":{type:"keyword",array:!1,required:!1},"rule.name":{type:"keyword",array:!1,required:!1},"rule.reference":{type:"keyword",array:!1,required:!1},"rule.ruleset":{type:"keyword",array:!1,required:!1},"rule.uuid":{type:"keyword",array:!1,required:!1},"rule.version":{type:"keyword",array:!1,required:!1},"server.address":{type:"keyword",array:!1,required:!1},"server.as.number":{type:"long",array:!1,required:!1},"server.as.organization.name":{type:"keyword",array:!1,required:!1},"server.bytes":{type:"long",array:!1,required:!1},"server.domain":{type:"keyword",array:!1,required:!1},"server.geo.city_name":{type:"keyword",array:!1,required:!1},"server.geo.continent_code":{type:"keyword",array:!1,required:!1},"server.geo.continent_name":{type:"keyword",array:!1,required:!1},"server.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.country_name":{type:"keyword",array:!1,required:!1},"server.geo.location":{type:"geo_point",array:!1,required:!1},"server.geo.name":{type:"keyword",array:!1,required:!1},"server.geo.postal_code":{type:"keyword",array:!1,required:!1},"server.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"server.geo.region_name":{type:"keyword",array:!1,required:!1},"server.geo.timezone":{type:"keyword",array:!1,required:!1},"server.ip":{type:"ip",array:!1,required:!1},"server.mac":{type:"keyword",array:!1,required:!1},"server.nat.ip":{type:"ip",array:!1,required:!1},"server.nat.port":{type:"long",array:!1,required:!1},"server.packets":{type:"long",array:!1,required:!1},"server.port":{type:"long",array:!1,required:!1},"server.registered_domain":{type:"keyword",array:!1,required:!1},"server.subdomain":{type:"keyword",array:!1,required:!1},"server.top_level_domain":{type:"keyword",array:!1,required:!1},"server.user.domain":{type:"keyword",array:!1,required:!1},"server.user.email":{type:"keyword",array:!1,required:!1},"server.user.full_name":{type:"keyword",array:!1,required:!1},"server.user.group.domain":{type:"keyword",array:!1,required:!1},"server.user.group.id":{type:"keyword",array:!1,required:!1},"server.user.group.name":{type:"keyword",array:!1,required:!1},"server.user.hash":{type:"keyword",array:!1,required:!1},"server.user.id":{type:"keyword",array:!1,required:!1},"server.user.name":{type:"keyword",array:!1,required:!1},"server.user.roles":{type:"keyword",array:!0,required:!1},"service.address":{type:"keyword",array:!1,required:!1},"service.environment":{type:"keyword",array:!1,required:!1},"service.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.id":{type:"keyword",array:!1,required:!1},"service.name":{type:"keyword",array:!1,required:!1},"service.node.name":{type:"keyword",array:!1,required:!1},"service.origin.address":{type:"keyword",array:!1,required:!1},"service.origin.environment":{type:"keyword",array:!1,required:!1},"service.origin.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.origin.id":{type:"keyword",array:!1,required:!1},"service.origin.name":{type:"keyword",array:!1,required:!1},"service.origin.node.name":{type:"keyword",array:!1,required:!1},"service.origin.state":{type:"keyword",array:!1,required:!1},"service.origin.type":{type:"keyword",array:!1,required:!1},"service.origin.version":{type:"keyword",array:!1,required:!1},"service.state":{type:"keyword",array:!1,required:!1},"service.target.address":{type:"keyword",array:!1,required:!1},"service.target.environment":{type:"keyword",array:!1,required:!1},"service.target.ephemeral_id":{type:"keyword",array:!1,required:!1},"service.target.id":{type:"keyword",array:!1,required:!1},"service.target.name":{type:"keyword",array:!1,required:!1},"service.target.node.name":{type:"keyword",array:!1,required:!1},"service.target.state":{type:"keyword",array:!1,required:!1},"service.target.type":{type:"keyword",array:!1,required:!1},"service.target.version":{type:"keyword",array:!1,required:!1},"service.type":{type:"keyword",array:!1,required:!1},"service.version":{type:"keyword",array:!1,required:!1},"source.address":{type:"keyword",array:!1,required:!1},"source.as.number":{type:"long",array:!1,required:!1},"source.as.organization.name":{type:"keyword",array:!1,required:!1},"source.bytes":{type:"long",array:!1,required:!1},"source.domain":{type:"keyword",array:!1,required:!1},"source.geo.city_name":{type:"keyword",array:!1,required:!1},"source.geo.continent_code":{type:"keyword",array:!1,required:!1},"source.geo.continent_name":{type:"keyword",array:!1,required:!1},"source.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.country_name":{type:"keyword",array:!1,required:!1},"source.geo.location":{type:"geo_point",array:!1,required:!1},"source.geo.name":{type:"keyword",array:!1,required:!1},"source.geo.postal_code":{type:"keyword",array:!1,required:!1},"source.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"source.geo.region_name":{type:"keyword",array:!1,required:!1},"source.geo.timezone":{type:"keyword",array:!1,required:!1},"source.ip":{type:"ip",array:!1,required:!1},"source.mac":{type:"keyword",array:!1,required:!1},"source.nat.ip":{type:"ip",array:!1,required:!1},"source.nat.port":{type:"long",array:!1,required:!1},"source.packets":{type:"long",array:!1,required:!1},"source.port":{type:"long",array:!1,required:!1},"source.registered_domain":{type:"keyword",array:!1,required:!1},"source.subdomain":{type:"keyword",array:!1,required:!1},"source.top_level_domain":{type:"keyword",array:!1,required:!1},"source.user.domain":{type:"keyword",array:!1,required:!1},"source.user.email":{type:"keyword",array:!1,required:!1},"source.user.full_name":{type:"keyword",array:!1,required:!1},"source.user.group.domain":{type:"keyword",array:!1,required:!1},"source.user.group.id":{type:"keyword",array:!1,required:!1},"source.user.group.name":{type:"keyword",array:!1,required:!1},"source.user.hash":{type:"keyword",array:!1,required:!1},"source.user.id":{type:"keyword",array:!1,required:!1},"source.user.name":{type:"keyword",array:!1,required:!1},"source.user.roles":{type:"keyword",array:!0,required:!1},"span.id":{type:"keyword",array:!1,required:!1},tags:{type:"keyword",array:!0,required:!1},"threat.enrichments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator":{type:"object",array:!1,required:!1},"threat.enrichments.indicator.as.number":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.enrichments.indicator.file.created":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.enrichments.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.enrichments.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.ip":{type:"ip",array:!1,required:!1},"threat.enrichments.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.enrichments.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.sightings":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.type":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.enrichments.indicator.url.port":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.enrichments.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.enrichments.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.enrichments.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.atomic":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.field":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.id":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.index":{type:"keyword",array:!1,required:!1},"threat.enrichments.matched.type":{type:"keyword",array:!1,required:!1},"threat.framework":{type:"keyword",array:!1,required:!1},"threat.group.alias":{type:"keyword",array:!0,required:!1},"threat.group.id":{type:"keyword",array:!1,required:!1},"threat.group.name":{type:"keyword",array:!1,required:!1},"threat.group.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.as.number":{type:"long",array:!1,required:!1},"threat.indicator.as.organization.name":{type:"keyword",array:!1,required:!1},"threat.indicator.confidence":{type:"keyword",array:!1,required:!1},"threat.indicator.description":{type:"keyword",array:!1,required:!1},"threat.indicator.email.address":{type:"keyword",array:!1,required:!1},"threat.indicator.file.accessed":{type:"date",array:!1,required:!1},"threat.indicator.file.attributes":{type:"keyword",array:!0,required:!1},"threat.indicator.file.code_signature.digest_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.exists":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.signing_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.status":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.subject_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.team_id":{type:"keyword",array:!1,required:!1},"threat.indicator.file.code_signature.timestamp":{type:"date",array:!1,required:!1},"threat.indicator.file.code_signature.trusted":{type:"boolean",array:!1,required:!1},"threat.indicator.file.code_signature.valid":{type:"boolean",array:!1,required:!1},"threat.indicator.file.created":{type:"date",array:!1,required:!1},"threat.indicator.file.ctime":{type:"date",array:!1,required:!1},"threat.indicator.file.device":{type:"keyword",array:!1,required:!1},"threat.indicator.file.directory":{type:"keyword",array:!1,required:!1},"threat.indicator.file.drive_letter":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.byte_order":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.cpu_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.creation_date":{type:"date",array:!1,required:!1},"threat.indicator.file.elf.exports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.header.abi_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.class":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.data":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.entrypoint":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.header.object_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.os_abi":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.header.version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.imports":{type:"flattened",array:!0,required:!1},"threat.indicator.file.elf.sections":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.sections.chi2":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.entropy":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.flags":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_offset":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.physical_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_address":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.sections.virtual_size":{type:"long",array:!1,required:!1},"threat.indicator.file.elf.segments":{type:"nested",array:!0,required:!1},"threat.indicator.file.elf.segments.sections":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.segments.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.elf.shared_libraries":{type:"keyword",array:!0,required:!1},"threat.indicator.file.elf.telfhash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.file.fork_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.gid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.group":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.md5":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha1":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha256":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.sha512":{type:"keyword",array:!1,required:!1},"threat.indicator.file.hash.ssdeep":{type:"keyword",array:!1,required:!1},"threat.indicator.file.inode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mime_type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mode":{type:"keyword",array:!1,required:!1},"threat.indicator.file.mtime":{type:"date",array:!1,required:!1},"threat.indicator.file.name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.owner":{type:"keyword",array:!1,required:!1},"threat.indicator.file.path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.architecture":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.company":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.description":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.file_version":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.imphash":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.original_file_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.pe.product":{type:"keyword",array:!1,required:!1},"threat.indicator.file.size":{type:"long",array:!1,required:!1},"threat.indicator.file.target_path":{type:"keyword",array:!1,required:!1},"threat.indicator.file.type":{type:"keyword",array:!1,required:!1},"threat.indicator.file.uid":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.file.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.file.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.file.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.file.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.indicator.first_seen":{type:"date",array:!1,required:!1},"threat.indicator.geo.city_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.continent_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.country_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.location":{type:"geo_point",array:!1,required:!1},"threat.indicator.geo.name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.postal_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_iso_code":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.region_name":{type:"keyword",array:!1,required:!1},"threat.indicator.geo.timezone":{type:"keyword",array:!1,required:!1},"threat.indicator.ip":{type:"ip",array:!1,required:!1},"threat.indicator.last_seen":{type:"date",array:!1,required:!1},"threat.indicator.marking.tlp":{type:"keyword",array:!1,required:!1},"threat.indicator.modified_at":{type:"date",array:!1,required:!1},"threat.indicator.port":{type:"long",array:!1,required:!1},"threat.indicator.provider":{type:"keyword",array:!1,required:!1},"threat.indicator.reference":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.bytes":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.data.strings":{type:"wildcard",array:!0,required:!1},"threat.indicator.registry.data.type":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.hive":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.key":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.path":{type:"keyword",array:!1,required:!1},"threat.indicator.registry.value":{type:"keyword",array:!1,required:!1},"threat.indicator.scanner_stats":{type:"long",array:!1,required:!1},"threat.indicator.sightings":{type:"long",array:!1,required:!1},"threat.indicator.type":{type:"keyword",array:!1,required:!1},"threat.indicator.url.domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.extension":{type:"keyword",array:!1,required:!1},"threat.indicator.url.fragment":{type:"keyword",array:!1,required:!1},"threat.indicator.url.full":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.original":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.password":{type:"keyword",array:!1,required:!1},"threat.indicator.url.path":{type:"wildcard",array:!1,required:!1},"threat.indicator.url.port":{type:"long",array:!1,required:!1},"threat.indicator.url.query":{type:"keyword",array:!1,required:!1},"threat.indicator.url.registered_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.scheme":{type:"keyword",array:!1,required:!1},"threat.indicator.url.subdomain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.top_level_domain":{type:"keyword",array:!1,required:!1},"threat.indicator.url.username":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.alternative_names":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.not_after":{type:"date",array:!1,required:!1},"threat.indicator.x509.not_before":{type:"date",array:!1,required:!1},"threat.indicator.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.public_key_exponent":{type:"long",array:!1,required:!1},"threat.indicator.x509.public_key_size":{type:"long",array:!1,required:!1},"threat.indicator.x509.serial_number":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.country":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"threat.indicator.x509.subject.locality":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organization":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"threat.indicator.x509.version_number":{type:"keyword",array:!1,required:!1},"threat.software.alias":{type:"keyword",array:!0,required:!1},"threat.software.id":{type:"keyword",array:!1,required:!1},"threat.software.name":{type:"keyword",array:!1,required:!1},"threat.software.platforms":{type:"keyword",array:!0,required:!1},"threat.software.reference":{type:"keyword",array:!1,required:!1},"threat.software.type":{type:"keyword",array:!1,required:!1},"threat.tactic.id":{type:"keyword",array:!0,required:!1},"threat.tactic.name":{type:"keyword",array:!0,required:!1},"threat.tactic.reference":{type:"keyword",array:!0,required:!1},"threat.technique.id":{type:"keyword",array:!0,required:!1},"threat.technique.name":{type:"keyword",array:!0,required:!1},"threat.technique.reference":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.id":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.name":{type:"keyword",array:!0,required:!1},"threat.technique.subtechnique.reference":{type:"keyword",array:!0,required:!1},"tls.cipher":{type:"keyword",array:!1,required:!1},"tls.client.certificate":{type:"keyword",array:!1,required:!1},"tls.client.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.client.hash.md5":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.client.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.client.issuer":{type:"keyword",array:!1,required:!1},"tls.client.ja3":{type:"keyword",array:!1,required:!1},"tls.client.not_after":{type:"date",array:!1,required:!1},"tls.client.not_before":{type:"date",array:!1,required:!1},"tls.client.server_name":{type:"keyword",array:!1,required:!1},"tls.client.subject":{type:"keyword",array:!1,required:!1},"tls.client.supported_ciphers":{type:"keyword",array:!0,required:!1},"tls.client.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.not_after":{type:"date",array:!1,required:!1},"tls.client.x509.not_before":{type:"date",array:!1,required:!1},"tls.client.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.client.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.client.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.client.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.client.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.client.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.client.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.client.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.curve":{type:"keyword",array:!1,required:!1},"tls.established":{type:"boolean",array:!1,required:!1},"tls.next_protocol":{type:"keyword",array:!1,required:!1},"tls.resumed":{type:"boolean",array:!1,required:!1},"tls.server.certificate":{type:"keyword",array:!1,required:!1},"tls.server.certificate_chain":{type:"keyword",array:!0,required:!1},"tls.server.hash.md5":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha1":{type:"keyword",array:!1,required:!1},"tls.server.hash.sha256":{type:"keyword",array:!1,required:!1},"tls.server.issuer":{type:"keyword",array:!1,required:!1},"tls.server.ja3s":{type:"keyword",array:!1,required:!1},"tls.server.not_after":{type:"date",array:!1,required:!1},"tls.server.not_before":{type:"date",array:!1,required:!1},"tls.server.subject":{type:"keyword",array:!1,required:!1},"tls.server.x509.alternative_names":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.issuer.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.issuer.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.not_after":{type:"date",array:!1,required:!1},"tls.server.x509.not_before":{type:"date",array:!1,required:!1},"tls.server.x509.public_key_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_curve":{type:"keyword",array:!1,required:!1},"tls.server.x509.public_key_exponent":{type:"long",array:!1,required:!1},"tls.server.x509.public_key_size":{type:"long",array:!1,required:!1},"tls.server.x509.serial_number":{type:"keyword",array:!1,required:!1},"tls.server.x509.signature_algorithm":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.common_name":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.country":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.distinguished_name":{type:"keyword",array:!1,required:!1},"tls.server.x509.subject.locality":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organization":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.organizational_unit":{type:"keyword",array:!0,required:!1},"tls.server.x509.subject.state_or_province":{type:"keyword",array:!0,required:!1},"tls.server.x509.version_number":{type:"keyword",array:!1,required:!1},"tls.version":{type:"keyword",array:!1,required:!1},"tls.version_protocol":{type:"keyword",array:!1,required:!1},"trace.id":{type:"keyword",array:!1,required:!1},"transaction.id":{type:"keyword",array:!1,required:!1},"url.domain":{type:"keyword",array:!1,required:!1},"url.extension":{type:"keyword",array:!1,required:!1},"url.fragment":{type:"keyword",array:!1,required:!1},"url.full":{type:"wildcard",array:!1,required:!1},"url.original":{type:"wildcard",array:!1,required:!1},"url.password":{type:"keyword",array:!1,required:!1},"url.path":{type:"wildcard",array:!1,required:!1},"url.port":{type:"long",array:!1,required:!1},"url.query":{type:"keyword",array:!1,required:!1},"url.registered_domain":{type:"keyword",array:!1,required:!1},"url.scheme":{type:"keyword",array:!1,required:!1},"url.subdomain":{type:"keyword",array:!1,required:!1},"url.top_level_domain":{type:"keyword",array:!1,required:!1},"url.username":{type:"keyword",array:!1,required:!1},"user.changes.domain":{type:"keyword",array:!1,required:!1},"user.changes.email":{type:"keyword",array:!1,required:!1},"user.changes.full_name":{type:"keyword",array:!1,required:!1},"user.changes.group.domain":{type:"keyword",array:!1,required:!1},"user.changes.group.id":{type:"keyword",array:!1,required:!1},"user.changes.group.name":{type:"keyword",array:!1,required:!1},"user.changes.hash":{type:"keyword",array:!1,required:!1},"user.changes.id":{type:"keyword",array:!1,required:!1},"user.changes.name":{type:"keyword",array:!1,required:!1},"user.changes.roles":{type:"keyword",array:!0,required:!1},"user.domain":{type:"keyword",array:!1,required:!1},"user.effective.domain":{type:"keyword",array:!1,required:!1},"user.effective.email":{type:"keyword",array:!1,required:!1},"user.effective.full_name":{type:"keyword",array:!1,required:!1},"user.effective.group.domain":{type:"keyword",array:!1,required:!1},"user.effective.group.id":{type:"keyword",array:!1,required:!1},"user.effective.group.name":{type:"keyword",array:!1,required:!1},"user.effective.hash":{type:"keyword",array:!1,required:!1},"user.effective.id":{type:"keyword",array:!1,required:!1},"user.effective.name":{type:"keyword",array:!1,required:!1},"user.effective.roles":{type:"keyword",array:!0,required:!1},"user.email":{type:"keyword",array:!1,required:!1},"user.full_name":{type:"keyword",array:!1,required:!1},"user.group.domain":{type:"keyword",array:!1,required:!1},"user.group.id":{type:"keyword",array:!1,required:!1},"user.group.name":{type:"keyword",array:!1,required:!1},"user.hash":{type:"keyword",array:!1,required:!1},"user.id":{type:"keyword",array:!1,required:!1},"user.name":{type:"keyword",array:!1,required:!1},"user.risk.calculated_level":{type:"keyword",array:!1,required:!1},"user.risk.calculated_score":{type:"float",array:!1,required:!1},"user.risk.calculated_score_norm":{type:"float",array:!1,required:!1},"user.risk.static_level":{type:"keyword",array:!1,required:!1},"user.risk.static_score":{type:"float",array:!1,required:!1},"user.risk.static_score_norm":{type:"float",array:!1,required:!1},"user.roles":{type:"keyword",array:!0,required:!1},"user.target.domain":{type:"keyword",array:!1,required:!1},"user.target.email":{type:"keyword",array:!1,required:!1},"user.target.full_name":{type:"keyword",array:!1,required:!1},"user.target.group.domain":{type:"keyword",array:!1,required:!1},"user.target.group.id":{type:"keyword",array:!1,required:!1},"user.target.group.name":{type:"keyword",array:!1,required:!1},"user.target.hash":{type:"keyword",array:!1,required:!1},"user.target.id":{type:"keyword",array:!1,required:!1},"user.target.name":{type:"keyword",array:!1,required:!1},"user.target.roles":{type:"keyword",array:!0,required:!1},"user_agent.device.name":{type:"keyword",array:!1,required:!1},"user_agent.name":{type:"keyword",array:!1,required:!1},"user_agent.original":{type:"keyword",array:!1,required:!1},"user_agent.os.family":{type:"keyword",array:!1,required:!1},"user_agent.os.full":{type:"keyword",array:!1,required:!1},"user_agent.os.kernel":{type:"keyword",array:!1,required:!1},"user_agent.os.name":{type:"keyword",array:!1,required:!1},"user_agent.os.platform":{type:"keyword",array:!1,required:!1},"user_agent.os.type":{type:"keyword",array:!1,required:!1},"user_agent.os.version":{type:"keyword",array:!1,required:!1},"user_agent.version":{type:"keyword",array:!1,required:!1},"vulnerability.category":{type:"keyword",array:!0,required:!1},"vulnerability.classification":{type:"keyword",array:!1,required:!1},"vulnerability.description":{type:"keyword",array:!1,required:!1},"vulnerability.enumeration":{type:"keyword",array:!1,required:!1},"vulnerability.id":{type:"keyword",array:!1,required:!1},"vulnerability.reference":{type:"keyword",array:!1,required:!1},"vulnerability.report_id":{type:"keyword",array:!1,required:!1},"vulnerability.scanner.vendor":{type:"keyword",array:!1,required:!1},"vulnerability.score.base":{type:"float",array:!1,required:!1},"vulnerability.score.environmental":{type:"float",array:!1,required:!1},"vulnerability.score.temporal":{type:"float",array:!1,required:!1},"vulnerability.score.version":{type:"keyword",array:!1,required:!1},"vulnerability.severity":{type:"keyword",array:!1,required:!1}};var i=a(142);const o={[i.a]:{type:"keyword",array:!1,required:!1},[i.c]:{type:"keyword",array:!0,required:!1},[i.e]:{type:"long",array:!1,required:!1},[i.f]:{type:"date",array:!1,required:!1},[i.j]:{type:"boolean",array:!1,required:!1},[i.k]:{type:"boolean",array:!0,required:!1},[i.q]:{type:"keyword",array:!0,required:!1},[i.o]:{type:"keyword",array:!1,required:!0},[i.p]:{type:"date",required:!1,array:!1},[i.s]:{type:"keyword",array:!1,required:!1,multi_fields:[{flat_name:`${i.s}.text`,name:"text",type:"match_only_text"}]},[i.v]:{type:"keyword",array:!1,required:!0},[i.w]:{type:"keyword",array:!1,required:!0},[i.C]:{type:"keyword",array:!1,required:!1},[i.G]:{type:"keyword",array:!1,required:!0},[i.J]:{array:!1,type:"flattened",ignore_above:4096,required:!1},[i.K]:{type:"keyword",array:!1,required:!0},[i.M]:{type:"long",array:!1,required:!0},[i.P]:{type:"keyword",array:!0,required:!1},[i.S]:{type:"keyword",array:!1,required:!0},[i.V]:{type:"keyword",array:!1,required:!0},[i.Y]:{type:"date",array:!1,required:!1},[i.Z]:{type:"keyword",array:!1,required:!0},[i.jb]:{type:"date_range",format:"epoch_millis||strict_date_optional_time",array:!1,required:!1},[i.kb]:{type:"keyword",array:!1,index:!1,required:!1,ignore_above:2048},[i.lb]:{type:"keyword",array:!1,required:!0},[i.ob]:{type:"keyword",array:!1,required:!1},[i.qb]:{type:"keyword",array:!0,required:!1},[i.mb]:{type:"keyword",array:!0,required:!1},[i.ub]:{type:"keyword",array:!1,required:!1},[i.vb]:{type:"keyword",array:!1,required:!1},[i.wb]:{type:"keyword",array:!0,required:!0},[i.xb]:{type:"keyword",array:!0,required:!1},[i.yb]:{type:"date",required:!0,array:!1},[i.zb]:{type:"version",array:!1,required:!1}};var s=a(609);const l=["constant_keyword"],c=["faas.trigger","faas.trigger.request_id","faas.trigger.type","host.cpu.system.norm.pct","host.cpu.user.norm.pct","host.fsstats.total_size.total","host.fsstats.total_size.used","host.fsstats.total_size.used.pct","host.load.norm.1","host.load.norm.5","host.load.norm.15","host.memory.actual.used.bytes","host.memory.actual.used.pct","host.memory.total","process.io.bytes","volume.bus_type","volume.default_access","volume.device_name","volume.device_type","volume.dos_name","volume.file_system_type","volume.mount_name","volume.nt_name","volume.product_id","volume.product_name","volume.removable","volume.serial_number","volume.size","volume.vendor_id","volume.vendor_name","volume.writable"],u=(Object.fromEntries(Object.entries(s.a).filter((([e,t])=>!l.includes(t.type)&&!c.includes(e))).map((([e,t])=>{const a=s.a[e];return[e,{type:a.type,array:a.normalize.includes("array"),required:!!a.required,...a.scaling_factor?{scaling_factor:a.scaling_factor}:{},...a.ignore_above?{ignore_above:a.ignore_above}:{},...a.multi_fields?{multi_fields:a.multi_fields}:{}}]}))),{[i.t]:{type:"float",array:!1,required:!1},[i.u]:{type:"keyword",array:!1,required:!1},[i.x]:{type:"date",array:!1,required:!1},[i.y]:{type:"keyword",array:!1,required:!1},[i.z]:{type:"keyword",array:!1,required:!1},[i.A]:{type:"keyword",array:!1,required:!1},[i.D]:{type:"keyword",array:!1,required:!1},[i.E]:{type:"keyword",array:!1,required:!1},[i.F]:{type:"keyword",array:!1,required:!1},[i.I]:{type:"keyword",array:!1,required:!1},[i.L]:{type:"keyword",array:!0,required:!1},[i.N]:{type:"keyword",array:!1,required:!1},[i.O]:{type:"keyword",array:!1,required:!1},[i.Q]:{type:"keyword",array:!1,required:!1},[i.R]:{type:"keyword",array:!1,required:!1},[i.T]:{type:"date",array:!1,required:!1},[i.U]:{type:"keyword",array:!1,required:!1},[i.W]:{type:"keyword",array:!1,required:!1},[i.X]:{type:"keyword",array:!1,required:!1},[i.cb]:{type:"long",array:!1,required:!1},[i.db]:{type:"date",array:!1,required:!1},[i.eb]:{type:"keyword",array:!0,required:!1},[i.fb]:{type:"date",array:!1,required:!1},[i.hb]:{type:"keyword",array:!0,required:!1},[i.ib]:{type:"keyword",array:!1,required:!1},[i.nb]:{type:"keyword",array:!1,required:!1},[i.rb]:{type:"keyword",array:!1,required:!1},[i.pb]:{type:"date",array:!1,required:!1},[i.tb]:{type:"keyword",array:!1,required:!1}}),d={[i.g]:{type:"scaled_float",scaling_factor:100,required:!1},[i.h]:{type:"scaled_float",scaling_factor:100,required:!1},[i.d]:{type:"object",array:!1,required:!1},[i.i]:{type:"scaled_float",scaling_factor:100,required:!1,array:!0},[i.l]:{type:"object",array:!0,required:!1},[i.m]:{type:"keyword",array:!1,required:!1},[i.n]:{type:"keyword",array:!1,required:!1}};a(1468);var p=a(45);function m(e,...t){const a=Object.keys(e).filter((e=>t.some((t=>{if(t===e)return!0;const a=e.split("."),n=t.split(".");return n.indexOf("*")===n.length-1&&a.every(((e,t)=>{const a=n.length-1<t?"*":n[t];return e===a||"*"===a}))}))));return Object(n.pick)(e,a)}i.w,i.mb,i.qb,i.X,i.t,i.J;const y={...m(o,"*"),...m(u,"*")};var g=a(4);const f=e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,t.toString()];case"object":try{return[...e,JSON.stringify(t)]}catch{return[...e,"Invalid Object"]}case"string":return[...e,t];default:return[...e,`${t}`]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[`${e}`];try{return[JSON.stringify(e)]}catch{return["Invalid Object"]}},b=["@timestamp","labels","message","tags"],h=e=>{const t=e.length>0?e[0]:null;if(null!=t&&!Object(p.isEmpty)(t.coordinates))try{return f({lon:t.coordinates[0],lat:t.coordinates[1]})}catch{return f(e)}return f(e)},v=(e,t,a)=>Object.keys(e).reduce(((n,i)=>{const o=e[i],s=null!=a?a:(e=>{const t=e.split(".")[0];return!Object(p.isEmpty)(t)&&b.includes(t)?"base":t})(i);if((e=>e.includes("geo.location")||e.includes("geoip.location"))(i))return[...n,{category:s,field:i,values:h(o),originalValue:h(o),isObjectArray:!0}];const l=(e=>{if(Array.isArray(e))return e.reduce(((e,t)=>{if(null!=t)switch(typeof t){case"number":case"boolean":return[...e,{str:t.toString()}];case"object":try{return[...e,{str:JSON.stringify(t),isObjectArray:!0}]}catch{return[...e,{str:"Invalid Object"}]}case"string":return[...e,{str:t}];default:return[...e,{str:`${t}`}]}return e}),[]);if(null==e)return[];if(Array.isArray(e)||"object"!=typeof e)return[{str:`${e}`}];try{return[{str:JSON.stringify(e),isObjectArray:!0}]}catch{return[{str:"Invalid Object"}]}})(o),c=l.map((({str:e})=>e)),u=l.some((e=>e.isObjectArray)),m=t?`${t}.${i}`:i;if(!u||void 0===Object.keys({...r,...y,...d}).find((e=>e===i)))return[...n,{category:s,field:m,values:c,originalValue:c,isObjectArray:u}];const f=((e,t)=>(null==t?void 0:t.includes(g.rb))||e===g.rb)(i,t)?[{category:s,field:m,values:c,originalValue:c,isObjectArray:u}]:[],E=Array.isArray(o)?o.reduce(((e,t)=>[...e,v(t,m,s)]),[]).flat():v(o,t,s),x=[...n,...E,...f].reduce(((e,t)=>({...e,...null!=e[t.field]?{[t.field]:{...t,originalValue:e[t.field].originalValue.includes(t.originalValue[0])?e[t.field].originalValue:[...e[t.field].originalValue,...t.originalValue],values:e[t.field].values.includes(t.values[0])?e[t.field].values:[...e[t.field].values,...t.values]}}:{[t.field]:t}})),{});return Object.values(x)}),[]);var E=a(272),x=a(490),k=a(1469);const w=e=>e===E.c.InvestigationTime,j=e=>{const t=e.find((({field:e,originalValue:t})=>e===g.rb&&t));if(!t)return[];const{originalValue:a}=t;return(Array.isArray(a)?a:[a]).reduce(((e,t)=>{try{const a=v(JSON.parse(t));e.push(a)}catch(e){}return e}),[])},S=e=>e.reduce(((e,t)=>(e[t.field]=t.originalValue,e)),{}),O=(e,t)=>Object(k.a)(e[t]),I=(e,t)=>O(e,t)||O(e,`threatintel.${t}`)||O(e,`threat.${t}`),C=e=>({id:O(e,E.m),field:O(e,E.l),value:O(e,E.k),type:O(e,E.n),feedName:I(e,E.e)}),M=e=>{const{id:t,field:a}=C(e);return`${t}${a}`},T=e=>{if(e.length<2)return e;const t=Object(n.groupBy)(e,M);return Object.values(t).map((e=>{var t;return null!==(t=e.find((e=>!w(O(e,E.n)))))&&void 0!==t?t:e[0]}))},_=e=>e.reduce(((e,t)=>{if(Object(x.b)(t.field)){const a=Object(k.a)(t.originalValue);if(a)return{...e,[t.field]:a}}return e}),{}),N=e=>{const t=I(e,E.f),a=Date.parse(null!=t?t:"no date");return Number.isInteger(a)?a:new Date(-1).valueOf()}},866:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),r=a(49),i=a(112),o=a(361),s=a(116),l=a(121),c=a(128);function u(e){const t=Object(n.useMemo)((()=>Object(o.i)()),[]),a=Object(n.useMemo)((()=>Object(o.b)()),[]),u=Object(n.useMemo)((()=>Object(o.d)()),[]),d=Object(i.a)((t=>u(e?t.inputs.timeline:t.inputs.global))),p=Object(i.a)((a=>t(e?a.inputs.timeline:a.inputs.global))),m=Object(i.a)((t=>a(e?t.inputs.timeline:t.inputs.global))),y=Object(n.useMemo)((()=>c.e.defaultDataViewSelector()),[]),g=Object(i.a)(y),{pathname:f}=Object(r.useLocation)(),{selectedPatterns:b}=Object(l.d)(Object(l.a)(f)),{selectedPatterns:h}=Object(l.d)(s.SourcererScopeName.timeline);return{selectedPatterns:Object(n.useMemo)((()=>e?[...new Set([...h,...g.patternList])]:[...new Set([...b,...g.patternList])]),[e,h,b,g.patternList]),from:p,to:m,shouldUpdate:d}}},874:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>null==e?[]:null!=e.host&&null!=e.host.name?[{fieldName:"host.name",fieldValue:e.host.name[0]}]:[]},877:function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"f",(function(){return o})),a.d(t,"h",(function(){return s})),a.d(t,"g",(function(){return l})),a.d(t,"j",(function(){return c})),a.d(t,"k",(function(){return u})),a.d(t,"i",(function(){return d})),a.d(t,"d",(function(){return p})),a.d(t,"c",(function(){return m})),a.d(t,"m",(function(){return y})),a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return f})),a.d(t,"l",(function(){return b})),a.d(t,"n",(function(){return h}));var n=a(5),r=a(348);a.d(t,"o",(function(){return r.c}));const i=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.feedNamePreposition",{defaultMessage:"from"}),o=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTitle",{defaultMessage:"Threat match detected"}),s=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTitle",{defaultMessage:"Enriched with threat intelligence"}),l=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.indicatorEnrichmentTooltipContent",{defaultMessage:"Shows available threat indicator matches."}),c=n.i18n.translate("xpack.securitySolution.eventDetails.ctiSummary.investigationEnrichmentTooltipContent",{defaultMessage:"Shows additional threat intelligence for the alert. The past 30 days were queried by default."}),u=(n.i18n.translate("xpack.securitySolution.alertDetails.noInvestigationEnrichmentsDescription",{defaultMessage:"This alert does not have supplemental threat intelligence data."}),n.i18n.translate("xpack.securitySolution.alertDetails.noEnrichmentsFoundDescription",{defaultMessage:"This alert does not have threat intelligence."})),d=n.i18n.translate("xpack.securitySolution.alertDetails.investigationTimeQueryTitle",{defaultMessage:"Enrichment with Threat Intelligence"}),p=n.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryStartDate",{defaultMessage:"Start date"}),m=n.i18n.translate("xpack.securitySolution.alertDetails.enrichmentQueryEndDate",{defaultMessage:"End date"}),y=n.i18n.translate("xpack.securitySolution.alertDetails.refresh",{defaultMessage:"Refresh"}),g=n.i18n.translate("xpack.securitySolution.alertDetails.overview.enrichedDataTitle",{defaultMessage:"Enriched data"}),f=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskLevel",{defaultMessage:"Current {riskEntity} risk level",values:{riskEntity:Object(r.d)(e,!0)}}),b=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.originalHostRiskLevel",{defaultMessage:"Original {riskEntity} risk level",values:{riskEntity:Object(r.d)(e,!0)}}),h=e=>n.i18n.translate("xpack.securitySolution.alertDetails.overview.hostRiskDataTitle",{defaultMessage:"{riskEntity} Risk Data",values:{riskEntity:Object(r.d)(e)}})},879:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),r=a(4),i=a(147),o=a(298),s=a(297),l=a(112),c=a(128);const u="countOfAlertsWithSameFieldAndValue",d=({field:e,value:t,isActiveTimelines:a,signalIndexName:r,includeAlertIds:d=!1,ignoreTimerange:m=!1})=>{const y=Object(l.a)((e=>c.d.timelineTimeRangeSelector(e))),g=Object(i.a)();let f,b;!1===m&&({to:f,from:b}=a?y:g);const[h]=Object(n.useState)((()=>p(e,t,b,f,d))),{loading:v,data:E,setQuery:x}=Object(o.a)({query:h,indexName:r,queryName:s.a.PREVALENCE});let k;if(Object(n.useEffect)((()=>{x(p(e,t,b,f,d))}),[x,e,t,b,f,d]),E){var w,j;const e=null===(w=E.aggregations)||void 0===w||null===(j=w[u])||void 0===j?void 0:j.buckets;e&&e.length>0&&(k=e[0].doc_count)}const S=!v&&void 0===k;return Object(n.useMemo)((()=>({loading:v,count:k,error:S,alertIds:null==E?void 0:E.hits.hits.map((({_id:e})=>e))})),[k,E,S,v])},p=(e,t,a,n,i)=>{const o=i?{size:r.O}:{size:0},s=i?{sort:{"@timestamp":"desc"}}:{},l=Array.isArray(t)&&1===t.length?t[0]:t;let c;return c={bool:{must:{match:{[e]:l}}}},void 0!==a&&void 0!==n&&(c={...c,bool:{...c.bool,filter:[{range:{"@timestamp":{gte:a,lte:n}}}]}}),Array.isArray(t)&&t.length>1&&(c={bool:{must:t.map((t=>({term:{[e]:t}})))}},void 0!==a&&void 0!==n&&c.bool.must.push({range:{"@timestamp":{gte:a,lte:n}}})),{...o,...s,_source:!1,aggs:{[u]:{terms:{field:e,size:r.O}}},query:c,runtime_mappings:{}}}},880:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o}));var n=a(5),r=a(169);n.i18n.translate("xpack.securitySolution.endpointsTab",{defaultMessage:"Endpoints"}),n.i18n.translate("xpack.securitySolution.policiesTab",{defaultMessage:"Policies"}),n.i18n.translate("xpack.securitySolution.trustedAppsTab",{defaultMessage:"Trusted applications"}),n.i18n.translate("xpack.securitySolution.eventFiltersTab",{defaultMessage:"Event filters"});const i={[r.c.WINDOWS]:n.i18n.translate("xpack.securitySolution.administration.os.windows",{defaultMessage:"Windows"}),[r.c.MAC]:n.i18n.translate("xpack.securitySolution.administration.os.macos",{defaultMessage:"Mac"}),[r.c.LINUX]:n.i18n.translate("xpack.securitySolution.administration.os.linux",{defaultMessage:"Linux"})},o=e=>n.i18n.translate("xpack.securitySolution.exceptions.failedLoadPolicies",{defaultMessage:'There was an error loading policies: "{error}"',values:{error:e.message}})},892:function(e,t,a){"use strict";a.d(t,"c",(function(){return h})),a.d(t,"b",(function(){return E})),a.d(t,"d",(function(){return x})),a.d(t,"a",(function(){return k}));var n=a(2),r=a.n(n),i=a(17),o=a(47),s=a(5);const l=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.cancel",{defaultMessage:"Cancel"}),c=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.confirm",{defaultMessage:"Confirm"}),u=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment",{defaultMessage:"Comment"}),d=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.comment.placeholder",{defaultMessage:"You may leave an optional note here."}),p=e=>s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolation.successfulMessage",{defaultMessage:"Isolation on host {hostName} successfully submitted",values:{hostName:e}}),m=e=>s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.unisolate.successfulMessage",{defaultMessage:"Release on host {hostName} successfully submitted",values:{hostName:e}}),y=s.i18n.translate("xpack.securitySolution.endpoint.hostisolation.unisolate",{defaultMessage:"release"}),g=s.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.isolated",{defaultMessage:"isolated"});var f=a(1506),b=a(137);const h=Object(n.memo)((({hostName:e,alertId:t,isolateAction:a="isolateHost",additionalInfo:s})=>r.a.createElement(i.EuiCallOut,{iconType:"check",color:"success",title:"isolateHost"===a?p(e):m(e),"data-test-subj":"isolateHost"===a?"hostIsolateSuccessMessage":"hostUnisolateSuccessMessage"},void 0!==t?(({alertIdForCase:e})=>{const{casesInfo:t}=Object(f.a)({alertId:e}),a=Object(n.useMemo)((()=>t.length),[t]),s=Object(n.useMemo)((()=>t.map(((e,t)=>r.a.createElement("li",{key:e.id},r.a.createElement(b.a,{detailName:e.id},r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.placeholderCase",defaultMessage:"{caseName}",values:{caseName:e.title}})))))),[t]);return r.a.createElement(r.a.Fragment,null,a>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.successfulIsolation.cases",defaultMessage:"This action has been attached to the following {caseCount, plural, one {case} other {cases}}:",values:{caseCount:a}}))),r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("ul",null,s))))})({alertIdForCase:t}):s)));h.displayName="EndpointIsolateSuccess";var v=a(1438);const E=Object(n.memo)((({hostName:e,onCancel:t,onConfirm:a,onChange:s,comment:p="",messageAppend:m,isLoading:y=!1,hideCommentField:g=!1})=>{const f=Object(n.useCallback)((e=>{s({comment:e.target.value})}),[s]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,null),r.a.createElement(i.EuiForm,{"data-test-subj":"endpointHostIsolationForm"},r.a.createElement(i.EuiFormRow,{fullWidth:!0},r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHost",defaultMessage:"Isolate host {hostName} from network.",values:{hostName:r.a.createElement("b",null,e)}}),r.a.createElement("br",null)),r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.isolateThisHostAbout",defaultMessage:"Isolating a host will disconnect it from the network. The host will only be able to communicate with the Kibana platform."})," ",m))),!g&&r.a.createElement(i.EuiFormRow,{label:u,fullWidth:!0},r.a.createElement(i.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:p,onChange:f})),r.a.createElement(i.EuiFormRow,{fullWidth:!0},r.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{onClick:t,disabled:y,"data-test-subj":"hostIsolateCancelButton"},l)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{fill:!0,onClick:a,disabled:y,isLoading:y,"data-test-subj":"hostIsolateConfirmButton"},c))))))}));E.displayName="EndpointIsolateForm";const x=Object(n.memo)((({hostName:e,onCancel:t,onConfirm:a,onChange:s,comment:p="",messageAppend:m,isLoading:f=!1,hideCommentField:b=!1})=>{const h=Object(n.useCallback)((e=>{s({comment:e.target.value})}),[s]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,null),r.a.createElement(i.EuiForm,{"data-test-subj":"endpointHostIsolationForm"},r.a.createElement(i.EuiFormRow,{fullWidth:!0},r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("p",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.hostIsolation.unIsolateThisHost",defaultMessage:"{hostName} is currently {isolated}. Are you sure you want to {unisolate} this host?",values:{hostName:r.a.createElement("b",null,e),isolated:r.a.createElement("b",null,g),unisolate:r.a.createElement("b",null,y)}})," ",m))),!b&&r.a.createElement(i.EuiFormRow,{label:u,fullWidth:!0},r.a.createElement(i.EuiTextArea,{"data-test-subj":"host_isolation_comment",fullWidth:!0,placeholder:d,value:p,onChange:h})),r.a.createElement(i.EuiFormRow,{fullWidth:!0},r.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{onClick:t,disabled:f,"data-test-subj":"hostIsolateCancelButton"},l)),r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButton,{fill:!0,onClick:a,disabled:f,isLoading:f},c))))))}));x.displayName="EndpointUnisolateForm";const k=r.a.memo((({onClick:e,buttonText:t})=>{const a=Object(n.useCallback)((()=>e()),[e]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.EuiSpacer,{size:"m"}),r.a.createElement(i.EuiFlexGroup,{gutterSize:"none",justifyContent:"flexEnd"},r.a.createElement(i.EuiFlexItem,{grow:!1},r.a.createElement(i.EuiButtonEmpty,{flush:"right",onClick:a,"data-test-subj":"hostIsolateSuccessCompleteButton"},r.a.createElement(i.EuiText,{size:"s"},r.a.createElement("p",null,t))))))}));k.displayName="ActionCompletionReturnButton"},896:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n=a(2),r=a(571),i=a(5);i.i18n.translate("xpack.securitySolution.overviewHost.errorSearchDescription",{defaultMessage:"An error has occurred on host overview search"});const o=i.i18n.translate("xpack.securitySolution.overviewHost.failSearchDescription",{defaultMessage:"Failed to run search on host overview"});var s=a(279);const l="hostsDetailsQuery",c=({endDate:e,hostName:t,indexNames:a,id:i=l,skip:c=!1,startDate:u})=>{const{loading:d,result:p,search:m,refetch:y,inspect:g}=Object(s.a)({factoryQueryType:r.c.details,initialResult:{hostDetails:{}},errorMessage:o,abort:c}),f=Object(n.useMemo)((()=>({endDate:e,hostDetails:p.hostDetails,id:i,inspect:g,isInspected:!1,refetch:y,startDate:u})),[e,p.hostDetails,i,g,y,u]),b=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:r.c.details,hostName:t,timerange:{interval:"12h",from:u,to:e}})),[e,t,a,u]);return Object(n.useEffect)((()=>{c||m(b)}),[b,m,c]),[d,f]}},898:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(17),r=a(2),i=a.n(r);const o=a(5).i18n.translate("xpack.securitySolution.overview.informationAriaLabel",{defaultMessage:"Information"});var s=a(1148);const l=({toolTipContent:e,toolTipTitle:t,width:a=270})=>{const[s,l]=Object(r.useState)(!1),c=Object(r.useCallback)((()=>{l(!s)}),[s,l]),u=Object(r.useCallback)((()=>{l(!1)}),[l]);return i.a.createElement(n.EuiPopover,{isOpen:s,closePopover:u,anchorPosition:"leftCenter",button:i.a.createElement(n.EuiButtonIcon,{color:"text",size:"xs",iconSize:"m",iconType:"iInCircle","aria-label":o,onClick:c})},t&&i.a.createElement(n.EuiPopoverTitle,null,t),i.a.createElement(n.EuiText,{size:"s",style:{width:`${a}px`}},e))},c=({riskScoreEntity:e})=>i.a.createElement(l,{toolTipContent:i.a.createElement(s.a,{riskScoreEntity:e}),width:200})},911:function(e,t,a){"use strict";a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return o}));var n=a(45);const r=e=>Object(n.some)({category:"kibana",field:"kibana.alert.rule.uuid"},e),i=({data:e})=>{var t;if(!r(e))return!1;const a=null===(t=Object(n.find)({field:"agent.type"},e))||void 0===t?void 0:t.values;return!!a&&"endpoint"===a[0]},o=({ecsData:e})=>{if(null==e)return!1;const t=Object(n.getOr)([],"kibana.alert.original_event.module",e),a=Object(n.getOr)([],"kibana.alert.original_event.kind",e);return t.includes("endpoint")&&a.includes("alert")}},922:function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return d})),a.d(t,"c",(function(){return p}));var n=a(2),r=a(139),i=a(45),o=a(1159),s=a(923),l=a(1105),c=a(1127);let u;!function(e){e.alerts="alerts",e.exceptions="rule_exceptions",e.endpointExceptions="endpoint_exceptions",e.executionResults="execution_results",e.executionEvents="execution_events"}(u||(u={}));const d={[u.alerts]:s.a,[u.exceptions]:l.e,[u.endpointExceptions]:l.d,[u.executionResults]:l.g,[u.executionEvents]:l.f},p=({rule:e,ruleId:t,isExistingRule:a,hasIndexRead:s})=>{const l=Object(n.useMemo)((()=>({[u.alerts]:{id:u.alerts,name:d[u.alerts],disabled:!1,href:`/rules/id/${t}/${u.alerts}`},[u.exceptions]:{id:u.exceptions,name:d[u.exceptions],disabled:null==e,href:`/rules/id/${t}/${u.exceptions}`},[u.endpointExceptions]:{id:u.endpointExceptions,name:d[u.endpointExceptions],disabled:null==e,href:`/rules/id/${t}/${u.endpointExceptions}`},[u.executionResults]:{id:u.executionResults,name:d[u.executionResults],disabled:!a,href:`/rules/id/${t}/${u.executionResults}`},[u.executionEvents]:{id:u.executionEvents,name:d[u.executionEvents],disabled:!a,href:`/rules/id/${t}/${u.executionEvents}`}})),[a,e,t]),[p,m]=Object(n.useState)(l),y=Object(c.e)(),g=Object(o.a)("showEndpointExceptions");return Object(n.useEffect)((()=>{const t=[];var a;(s||t.push(u.alerts),y.extendedLogging.isEnabled||t.push(u.executionEvents),g||t.push(u.endpointExceptions),null!=e)&&((null!==(a=e.exceptions_list)&&void 0!==a?a:[]).some((e=>e.type===r.b.ENDPOINT))||t.push(u.endpointExceptions));const n=Object(i.omit)(t,l);m(n)}),[g,s,e,l,y]),p}},923:function(e,t,a){"use strict";a.d(t,"k",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return o})),a.d(t,"j",(function(){return s})),a.d(t,"h",(function(){return l})),a.d(t,"i",(function(){return c})),a.d(t,"g",(function(){return u})),a.d(t,"f",(function(){return d})),a.d(t,"c",(function(){return p})),a.d(t,"m",(function(){return m})),a.d(t,"l",(function(){return y})),a.d(t,"d",(function(){return g})),a.d(t,"e",(function(){return f}));var n=a(5);const r=n.i18n.translate("xpack.securitySolution.detectionEngine.detectionsPageTitle",{defaultMessage:"Alerts"}),i=n.i18n.translate("xpack.securitySolution.detectionEngine.alertTitle",{defaultMessage:"Alerts"}),o=n.i18n.translate("xpack.securitySolution.detectionEngine.buttonManageRules",{defaultMessage:"Manage rules"}),s=n.i18n.translate("xpack.securitySolution.detectionEngine.noIndexTitle",{defaultMessage:"Let’s set up your detection engine"}),l=n.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsAndListsIndexesMessage",{defaultMessage:"You need permissions for the signals and lists indices."}),c=n.i18n.translate("xpack.securitySolution.detectionEngine.needsSignalsIndexMessage",{defaultMessage:"You need permissions for the signals index."}),u=n.i18n.translate("xpack.securitySolution.detectionEngine.needsListsIndexesMessage",{defaultMessage:"You need permissions for the lists indices."}),d=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.needsIndexPermissionsMessage",{values:{additionalContext:e},defaultMessage:"To use the detection engine, a user with the required cluster and index privileges must first access this page. {additionalContext} For more help, contact your Elastic Stack administrator."}),p=n.i18n.translate("xpack.securitySolution.detectionEngine.goToDocumentationButton",{defaultMessage:"View documentation"}),m=n.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedTitle",{defaultMessage:"Detection engine permissions required"}),y=n.i18n.translate("xpack.securitySolution.detectionEngine.userUnauthenticatedMsgBody",{defaultMessage:"You do not have the required permissions for viewing the detection engine. For more help, contact your administrator."}),g=n.i18n.translate("xpack.securitySolution.detectionEngine.mlRulesDisabledMessageTitle",{defaultMessage:"ML rules require Platinum License and ML Admin Permissions"}),f=e=>n.i18n.translate("xpack.securitySolution.detectionEngine.mlUnavailableTitle",{values:{totalRules:e},defaultMessage:"{totalRules} {totalRules, plural, =1 {rule requires} other {rules require}} Machine Learning to enable."})},924:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d}));var n=a(70);const r="/api/fleet",i=`${r}/package_policies`,o=`${r}/agent_status`,s=(e,t,a)=>e.get(`${i}/${t}`,{...a,version:n.API_VERSIONS.public.v1}),l=(e,t,a)=>e.post(`${i}/_bulk_get`,{...a,version:n.API_VERSIONS.public.v1,body:JSON.stringify({ids:t,ignoreMissing:!0})}),c=(e,t,a,r={})=>e.put(`${i}/${t}`,{...r,version:n.API_VERSIONS.public.v1,body:JSON.stringify(a)}),u=(e,t,a={})=>e.get(o,{...a,version:n.API_VERSIONS.public.v1,query:{policyId:t}}),d=async e=>{const t=n.epmRouteService.getInfoPath("endpoint"),a=(await e.get(t,{version:n.API_VERSIONS.public.v1})).item;if(!a)throw new Error("Endpoint package was not found.");return a}},926:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(45),r=a(2),i=a.n(r),o=a(563),s=a(1435),l=a(1101),c=a(1391),u=a(927),d=a(1436),p=a(1520),m=a(1397),y=a(878),g=a(1395),f=a(1328),b=a(1302);const h=i.a.memo((({data:e,timelineId:t,isDraggable:a})=>i.a.createElement(p.a,{contextId:`netflow-renderer-${t}-${e._id}`,destinationBytes:Object(o.a)(Object(n.get)(f.a,e)),destinationGeoContinentName:Object(o.a)(Object(n.get)(g.b,e)),destinationGeoCountryName:Object(o.a)(Object(n.get)(g.d,e)),destinationGeoCountryIsoCode:Object(o.a)(Object(n.get)(g.c,e)),destinationGeoRegionName:Object(o.a)(Object(n.get)(g.e,e)),destinationGeoCityName:Object(o.a)(Object(n.get)(g.a,e)),destinationIp:Object(o.a)(Object(n.get)(u.a,e)),destinationPackets:Object(o.a)(Object(n.get)(f.b,e)),destinationPort:Object(o.a)(Object(n.get)(y.a,e)),eventDuration:Object(o.a)(Object(n.get)(l.b,e)),eventId:Object(n.get)(c.a,e),eventEnd:Object(o.a)(Object(n.get)(m.b,e)),eventStart:Object(o.a)(Object(n.get)(m.c,e)),isDraggable:a,networkBytes:Object(o.a)(Object(n.get)(b.a,e)),networkCommunityId:Object(o.a)(Object(n.get)(b.b,e)),networkDirection:Object(o.a)(Object(n.get)(b.c,e)),networkPackets:Object(o.a)(Object(n.get)(b.d,e)),networkProtocol:Object(o.a)(Object(n.get)(b.e,e)),sourceBytes:Object(o.a)(Object(n.get)(f.c,e)),sourceGeoContinentName:Object(o.a)(Object(n.get)(g.h,e)),sourceGeoCountryName:Object(o.a)(Object(n.get)(g.j,e)),sourceGeoCountryIsoCode:Object(o.a)(Object(n.get)(g.i,e)),sourceGeoRegionName:Object(o.a)(Object(n.get)(g.k,e)),sourceGeoCityName:Object(o.a)(Object(n.get)(g.g,e)),sourceIp:Object(o.a)(Object(n.get)(u.d,e)),sourcePackets:Object(o.a)(Object(n.get)(f.d,e)),sourcePort:Object(o.a)(Object(n.get)(y.c,e)),tlsClientCertificateFingerprintSha1:Object(o.a)(Object(n.get)(s.b,e)),tlsFingerprintsJa3Hash:Object(o.a)(Object(n.get)(d.a,e)),tlsServerCertificateFingerprintSha1:Object(o.a)(Object(n.get)(s.c,e)),transport:Object(o.a)(Object(n.get)(b.f,e)),userName:void 0})));h.displayName="NetflowRenderer"},929:function(e,t,a){"use strict";a.d(t,"a",(function(){return j}));var n=a(2),r=a(48),i=a(5),o=a(142),s=a(139),l=a(387),c=a(203),u=a(134),d=a(110),p=a(122),m=a(113),y=a(118),g=a(1490),f=a(162),b=a(228),h=a(197),v=a(112),E=a(127),x=a(117),k=a(184),w=a(224);const j=({ecsRowData:e,onInvestigateInTimelineAlertClick:t})=>{const{addError:a}=Object(x.a)(),{data:{search:j,query:S}}=Object(d.i)().services,O=Object(r.useDispatch)(),{startTransaction:I}=Object(k.b)(),{services:C}=Object(d.i)(),{getExceptionFilterFromIds:M}=Object(l.c)(C.http),T=Object(n.useCallback)((async e=>{const t=(e=>{var t;let a=null!==(t=Object(E.getField)(e,o.B))&&void 0!==t?t:[],n=[];try{if(Array.isArray(a)&&0===a.length){var r;const t=null!==(r=Object(E.getField)(e,o.J))&&void 0!==r?r:{};if(t.length>0){var i;const e=JSON.parse(t[0]);a=null!==(i=null==e?void 0:e.exceptions_list)&&void 0!==i?i:[]}}else if(a&&a.list_id)return a.list_id.map(((e,t)=>{const n=a.type[t];return{exception_list_id:e,namespace_type:a.namespace_type[t],type:n}})).filter((e=>e.type===s.b.DETECTION))}catch(e){}return n=a.reduce(((e,t)=>{try{const a="string"==typeof t?JSON.parse(t):t;if(a.type===s.b.DETECTION){const t={exception_list_id:a.list_id,namespace_type:a.namespace_type};e.push(t)}}catch{}return e}),[]),n})(e);let n;return t.length>0&&await M({exceptionListIds:t,excludeExceptions:!0,chunkSize:20,alias:"Exceptions",onSuccess:e=>{n=e},onError:e=>{a(e,{title:i.i18n.translate("xpack.securitySolution.detectionEngine.alerts.fetchExceptionFilterFailure",{defaultMessage:"Error fetching exception filter."})})}}),n}),[a,M]),_=Object(n.useMemo)((()=>S.filterManager),[S.filterManager]),N=Object(n.useMemo)((()=>y.b.getTimelineByIdSelector()),[]),{filterManager:D}=Object(v.a)((e=>{var t,a;return null!==(t=N(e,null!==(a=p.c.active)&&void 0!==a?a:""))&&void 0!==t?t:u.b})),A=Object(n.useMemo)((()=>null!=D?D:_),[D,_]),q=Object(n.useCallback)((e=>O(y.a.updateIsLoading(e))),[O]),F=Object(b.a)({timelineId:p.c.active,timelineType:m.l.default}),L=Object(n.useCallback)((({from:e,timeline:t,to:a,ruleNote:n})=>{var r;F(),q({id:p.c.active,isLoading:!1}),Object(f.b)(O)({duplicate:!0,from:e,id:p.c.active,notes:[],timeline:{...t,filterManager:A,indexNames:null!==(r=t.indexNames)&&void 0!==r?r:[],show:!0},to:a,ruleNote:n})()}),[O,A,q,F]),R=Object(n.useCallback)((async()=>{Object(c.a)(),I({name:w.a.INVESTIGATE_IN_TIMELINE}),t&&t(),null!=e&&await Object(g.a)({createTimeline:L,ecsData:e,searchStrategyClient:j,updateTimelineIsLoading:q,getExceptionFilter:T})}),[I,L,e,t,j,q,T]);return{investigateInTimelineActionItems:Object(n.useMemo)((()=>[{key:"investigate-in-timeline-action-item","data-test-subj":"investigate-in-timeline-action-item",disabled:null==e,onClick:R,name:h.i}]),[e,R]),investigateInTimelineAlertClick:R}}},960:function(e,t,a){"use strict";a.d(t,"a",(function(){return U}));var n=a(45),r=a(17),i=a(2),o=a.n(i),s=a(44),l=a.n(s),c=a(166),u=a(151);const d="destination.ip",p="destination.port",m="event.category",y="file.name",g="host.name",f="kibana.alert.rule.name",b="kibana.alert.severity",h="process.parent.name",v="process.name",E="source.ip",x="source.port",k="user.name",w=[d,p,y,v,h,E,x],j=l()(r.EuiFlexGroup).withConfig({displayName:"AlertFieldFlexGroup",componentId:"sc-1itxfus-0"})(["flex-grow:0;gap:","px;"],(({$scopeId:e})=>e===u.f.active?0:3)),S=({contextId:e,eventId:t,field:a,fieldType:n="keyword",isAggregatable:i=!0,isDraggable:s,showSeparator:l,scopeId:u,value:d})=>o.a.createElement(j,{alignItems:"center","data-test-subj":"alertFieldBadge",$scopeId:u,gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement(c.c,{contextId:`${e}-alert-field`,eventId:t,field:a,fieldType:n,isAggregatable:i,isDraggable:s,scopeId:u,value:d})),l&&o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"separator"},", ")));S.displayName="AlertFieldBadgeComponent";const O=o.a.memo(S),I=({contextId:e,"data-test-subj":t="alertField",eventId:a,field:n,fieldType:i="keyword",isAggregatable:s=!0,isDraggable:l,prefix:c,suffix:u,scopeId:d,values:p})=>null!=p?o.a.createElement(j,{alignItems:"center","data-test-subj":t,$scopeId:d,gutterSize:"none"},null!=c&&o.a.createElement(r.EuiFlexItem,{"data-test-subj":"prefix",grow:!1},c),p.map(((t,c)=>o.a.createElement(r.EuiFlexItem,{key:`${t}-${c}`,grow:!1},o.a.createElement(O,{contextId:`${e}-alert-field`,eventId:a,field:n,fieldType:i,isAggregatable:s,isDraggable:l,showSeparator:c<p.length-1,scopeId:d,value:t})))),null!=u&&o.a.createElement(r.EuiFlexItem,{"data-test-subj":"suffix",grow:!1},u)):null;I.displayName="AlertFieldComponent";const C=o.a.memo(I);var M=a(113),T=a(267),_=a(1069),N=a(5);const D=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.alertLabel",{defaultMessage:"alert"}),A=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.byLabel",{defaultMessage:"by"}),q=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.createdLabel",{defaultMessage:"created"}),F=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.destinationLabel",{defaultMessage:"destination"}),L=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.eventLabel",{defaultMessage:"event"}),R=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.fileLabel",{defaultMessage:"file"}),P=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.onLabel",{defaultMessage:"on"}),z=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.parentProcessLabel",{defaultMessage:"parent process"}),B=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.processLabel",{defaultMessage:"process"}),G=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.sourceLabel",{defaultMessage:"source"}),$=N.i18n.translate("xpack.securitySolution.renderers.alertRenderer.withLabel",{defaultMessage:"with"}),H=l()(r.EuiFlexGroup).withConfig({displayName:"AlertRendererFlexGroup",componentId:"sc-fjuibw-0"})(["gap:",";"],(({theme:e})=>e.eui.euiSizeXS)),V={id:M.d.alert,isInstance:e=>{return null!==(a=null==(t=Object(n.get)("event.kind",e))?void 0:t.some((e=>null!=e.toLocaleLowerCase&&"signal"===e.toLowerCase())))&&void 0!==a&&a;var t,a},renderRow:({contextId:e="alert-renderer",data:t,isDraggable:a,scopeId:i})=>{const s=Object(n.get)("_id",t),l=Object(n.get)(d,t),c=Object(n.get)(p,t),u=Object(n.get)(m,t),j=Object(n.get)(y,t),S=Object(n.get)(g,t),O=Object(n.get)(f,t),I=Object(n.get)(b,t),M=Object(n.get)(v,t),N=Object(n.get)(h,t),V=Object(n.get)(E,t),U=Object(n.get)(x,t),W=Object(n.get)(k,t);return o.a.createElement(_.a,null,o.a.createElement(T.b,{"data-test-subj":"alertRenderer"},o.a.createElement(H,{alignItems:"center",gutterSize:"none",justifyContent:"center",wrap:!0},o.a.createElement(C,{contextId:e,"data-test-subj":m,eventId:s,field:m,isDraggable:a,scopeId:i,values:u}),o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"event"},` ${L} `)),(({data:e,fieldNames:t})=>t.some((t=>Object(n.has)(t,e))))({data:t,fieldNames:w})&&o.a.createElement(r.EuiFlexItem,{grow:!1},o.a.createElement("span",{"data-test-subj":"with"},` ${$} `)),o.a.createElement(C,{contextId:e,"data-test-subj":v,eventId:s,field:v,isDraggable:a,prefix:` ${B} `,suffix:", ",scopeId:i,values:M}),o.a.createElement(C,{contextId:e,"data-test-subj":h,eventId:s,field:h,isDraggable:a,prefix:` ${z} `,suffix:", ",scopeId:i,values:N}),o.a.createElement(C,{contextId:e,"data-test-subj":y,eventId:s,field:y,isDraggable:a,prefix:` ${R} `,suffix:", ",scopeId:i,values:j}),o.a.createElement(C,{contextId:e,"data-test-subj":E,eventId:s,field:E,isDraggable:a,prefix:` ${G} `,scopeId:i,values:V}),o.a.createElement(C,{contextId:e,"data-test-subj":x,eventId:s,field:x,isDraggable:a,prefix:":",suffix:", ",scopeId:i,values:U}),o.a.createElement(C,{contextId:e,"data-test-subj":d,eventId:s,field:d,isDraggable:a,prefix:` ${F} `,scopeId:i,values:l}),o.a.createElement(C,{contextId:e,"data-test-subj":p,eventId:s,field:p,isDraggable:a,prefix:":",suffix:", ",scopeId:i,values:c}),o.a.createElement(C,{contextId:e,"data-test-subj":k,eventId:s,field:k,isDraggable:a,prefix:` ${A} `,scopeId:i,values:W}),o.a.createElement(C,{contextId:e,"data-test-subj":g,eventId:s,field:g,isDraggable:a,prefix:` ${P} `,scopeId:i,values:S}),o.a.createElement(C,{contextId:e,"data-test-subj":b,eventId:s,field:b,isDraggable:a,prefix:` ${q} `,suffix:` ${D} `,scopeId:i,values:I}),o.a.createElement(C,{contextId:e,"data-test-subj":f,eventId:s,field:f,isDraggable:a,suffix:".",scopeId:i,values:O}))))}},U=({data:e,rowRenderers:t})=>{var a;const n=null!==(a=t.find((t=>t.isInstance(e))))&&void 0!==a?a:null;return V.isInstance(e)?null!=n?(({a:e,b:t,id:a})=>({id:a,isInstance:a=>e.isInstance(a)||t.isInstance(a),renderRow:({contextId:a,data:n,isDraggable:r,scopeId:i})=>o.a.createElement(o.a.Fragment,null,e.isInstance(n)&&e.renderRow({contextId:a,data:n,isDraggable:r,scopeId:i}),t.isInstance(n)&&t.renderRow({contextId:a,data:n,isDraggable:r,scopeId:i}))}))({a:V,b:n,id:n.id}):V:n}},961:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return U}));var n=a(55);const r=parseInt(n.euiThemeVars.euiSizeXL,10)-parseInt(n.euiThemeVars.euiSizeXS,10),i=e=>"signal"===e,o=e=>(e>0?e*r:r)+2*parseInt(n.euiThemeVars.euiDataGridCellPaddingM,10);var s=a(2),l=a.n(s),c=a(48),u=a(17),d=a(44),p=a.n(d),m=a(124),y=a(468),g=a(127),f=a(1063),b=a(118),h=a(151),v=a(327),E=a(113),x=a(135),k=a(1368),w=a(1470);const j=({ariaLabel:e,showNotes:t,timelineType:a,toggleShowNotes:n})=>{const{kibanaSecuritySolutionsPrivileges:r}=Object(x.a)();return l.a.createElement(w.a,null,l.a.createElement(v.d,{ariaLabel:e,"data-test-subj":"add-note",isDisabled:!1===r.crud,showNotes:t,timelineType:a,toggleShowNotes:n,toolTip:a===E.l.template?k.g:k.h}))};j.displayName="AddEventNoteActionComponent";const S=l.a.memo(j);var O=a(243),I=a(1471);const C=({ariaLabel:e,isAlert:t,noteIds:a,onPinClicked:n,eventIsPinned:i,timelineType:o})=>{const{kibanaSecuritySolutionsPrivileges:c}=Object(x.a)(),d=Object(s.useMemo)((()=>Object(y.g)({isPinned:i,isAlert:t,eventHasNotes:Object(y.b)(a),timelineType:o})),[i,t,a,o]);return l.a.createElement("div",{key:"timeline-action-pin-tool-tip"},l.a.createElement(O.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"timeline-action-pin-tool-tip",content:d},l.a.createElement(I.a,{ariaLabel:e,allowUnpinning:!Object(y.b)(a),"data-test-subj":"pin-event",isDisabled:!1===c.crud,isAlert:t,onClick:n,pinned:i,timelineType:o}))))};C.displayName="PinEventActionComponent";const M=l.a.memo(C);var T=a(112),_=a(134),N=a(184),D=a(18),A=a(189),q=a(224),F=a(14),L=a(130),R=a(1545),P=a(1290),z=a(526),B=a(266),G=a(318),$=a(470);const H=p.a.div.withConfig({displayName:"ActionsContainer",componentId:"sc-3eeodk-0"})(["align-items:center;display:flex;"]),V=({ariaRowindex:e,checked:t,columnValues:a,ecsData:n,eventId:o,eventIdToNoteIds:d,isEventPinned:p=!1,isEventViewer:v=!1,loadingEventIds:E,onEventDetailsPanelOpened:x,onRowSelected:w,onRuleChange:j,showCheckboxes:I,showNotes:C,timelineId:V,toggleShowNotes:U,refetch:W,setEventsLoading:Y})=>{const Z=Object(c.useDispatch)(),K=Object(L.a)("tGridEnabled"),Q=Object(s.useMemo)((()=>b.b.getTimelineByIdSelector()),[]),X=Object(T.b)((e=>(Object(g.isTimelineScope)(V)?Q(e,V):_.b).timelineType)),{startTransaction:J}=Object(N.b)(),ee=Object(D.b)().isEnterprise(),te=Object(s.useCallback)((e=>Z(b.a.pinEvent({id:V,eventId:e}))),[Z,V]),ae=Object(s.useCallback)((e=>Z(b.a.unPinEvent({id:V,eventId:e}))),[Z,V]),ne=Object(s.useCallback)((e=>w({eventIds:[o],isSelected:e.currentTarget.checked})),[o,w]),re=Object(s.useCallback)((()=>Object(y.f)({allowUnpinning:!d||!Object(y.b)(d[o]),eventId:o,onPinEvent:te,onUnPinEvent:ae,isEventPinned:p})),[d,o,p,te,ae]),ie=Object(y.e)(n),oe=Object(s.useMemo)((()=>{var e,t,a,r;return"signal"!==ie&&!(null!==(e=n.event)&&void 0!==e&&null!==(t=e.kind)&&void 0!==t&&t.includes("event")&&null!==(a=n.agent)&&void 0!==a&&null!==(r=a.type)&&void 0!==r&&r.includes("endpoint"))}),[n,ie]),se=!Object(f.a)(n),{setGlobalFullScreen:le}=Object(A.a)(),{setTimelineFullScreen:ce}=Object(A.c)(),ue=Object(g.getScopedActions)(V),de=Object(s.useCallback)((()=>{J({name:q.a.OPEN_ANALYZER});const e=document.querySelector(".euiDataGrid--fullScreen");ue&&Z(ue.updateGraphEventId({id:V,graphEventId:n._id})),V===h.f.active?(e&&ce(!0),Z(Object(F.setActiveTabTimeline)({id:V,activeTab:m.f.graph}))):e&&le(!0)}),[J,ue,V,Z,n._id,ce,le]),pe=Object(s.useMemo)((()=>{var e,t,a,r,i,o,s,l,c,u;const{process:d,_id:p,_index:m,timestamp:y,kibana:g}=n,f=null==d||null===(e=d.entry_leader)||void 0===e||null===(t=e.entity_id)||void 0===t?void 0:t[0],b=null==d||null===(a=d.entry_leader)||void 0===a||null===(r=a.start)||void 0===r?void 0:r[0],h=(null==g||null===(i=g.alert)||void 0===i||null===(o=i.ancestors)||void 0===o||null===(s=o.index)||void 0===s?void 0:s[0])||m;if(void 0===h||void 0===f||void 0===b)return null;const v=null==d||null===(l=d.entity_id)||void 0===l?void 0:l[0],E="signal"===ie||"eql"===ie?p:void 0;return{index:h,sessionEntityId:f,sessionStartTime:b,jumpToEntityId:v,jumpToCursor:E&&(null===(c=n.kibana)||void 0===c||null===(u=c.alert.original_time)||void 0===u?void 0:u[0])||y,investigatedAlertId:E}}),[n,ie]),me=Object(s.useCallback)((()=>{const e=document.querySelector(".euiDataGrid--fullScreen");J({name:q.a.OPEN_SESSION_VIEW}),V===h.f.active?(e&&ce(!0),null!==pe&&Z(Object(F.setActiveTabTimeline)({id:V,activeTab:m.f.session}))):e&&le(!0),null!==pe&&ue&&Z(ue.updateSessionViewConfig({id:V,sessionViewConfig:pe}))}),[J,V,pe,ce,Z,le,ue]),{activeStep:ye,isTourShown:ge,incrementStep:fe}=Object(z.b)(),be=Object(s.useMemo)((()=>ge(B.b.alertsCases)&&"signal"===ie&&Object(G.c)(V)&&1===e),[ge,e,ie,V]),he=Object(s.useCallback)((()=>{be&&ye===B.a.expandEvent&&ge(B.b.alertsCases)&&fe(B.b.alertsCases),x()}),[ye,fe,be,ge,x]);return l.a.createElement(H,null,I&&!K&&l.a.createElement("div",{key:"select-event-container","data-test-subj":"select-event-container"},l.a.createElement(O.l,{textAlign:"center",width:r},E.includes(o)?l.a.createElement(u.EuiLoadingSpinner,{size:"m","data-test-subj":"event-loader"}):l.a.createElement(u.EuiCheckbox,{"aria-label":k.d({ariaRowindex:e,columnValues:a,checked:t}),"data-test-subj":"select-event",id:o,checked:t,onChange:ne}))),l.a.createElement($.a,{isTourAnchor:be,onClick:he,step:B.a.expandEvent,tourId:B.b.alertsCases},l.a.createElement("div",{key:"expand-event"},l.a.createElement(O.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:k.m},l.a.createElement(u.EuiButtonIcon,{"aria-label":k.n({ariaRowindex:e,columnValues:a}),"data-test-subj":"expand-event",iconType:"expand",onClick:he,size:"s"}))))),l.a.createElement(l.a.Fragment,null,V!==h.f.active&&l.a.createElement(P.a,{ariaLabel:k.k({ariaRowindex:e,columnValues:a}),key:"investigate-in-timeline",ecsRowData:n}),!v&&U&&l.a.createElement(l.a.Fragment,null,l.a.createElement(S,{ariaLabel:k.c({ariaRowindex:e,columnValues:a}),key:"add-event-note",showNotes:null!=C&&C,toggleShowNotes:U,timelineType:X}),l.a.createElement(M,{ariaLabel:k.j({ariaRowindex:e,columnValues:a,isEventPinned:p}),isAlert:i(ie),key:"pin-event",onPinClicked:re,noteIds:d&&d[o]||[],eventIsPinned:p,timelineType:X})),l.a.createElement(R.b,{ariaLabel:k.f({ariaRowindex:e,columnValues:a}),ariaRowindex:e,columnValues:a,key:"alert-context-menu",ecsRowData:n,scopeId:V,disabled:oe,onRuleChange:j,refetch:W}),!1===se?l.a.createElement("div",null,l.a.createElement(O.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"view-in-analyzer-tool-tip",content:k.a},l.a.createElement(u.EuiButtonIcon,{"aria-label":k.b({ariaRowindex:e,columnValues:a}),"data-test-subj":"view-in-analyzer",iconType:"analyzeEvent",onClick:de,size:"s"})))):null,null===pe||!ee&&V!==m.e.kubernetesPageSessions?null:l.a.createElement("div",null,l.a.createElement(O.l,{textAlign:"center",width:r},l.a.createElement(u.EuiToolTip,{"data-test-subj":"expand-event-tool-tip",content:k.i},l.a.createElement(u.EuiButtonIcon,{"aria-label":k.n({ariaRowindex:e,columnValues:a}),"data-test-subj":"session-view-button",iconType:"sessionViewer",onClick:me,size:"s"}))))))};V.displayName="ActionsComponent";const U=l.a.memo(V);a(1270)},962:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return x})),a.d(t,"c",(function(){return j}));var n=a(152),r=a(64),i=a(54),o=a(490);const s=Object(n.d)((e=>(({data:e,defaultIndex:t,eventFields:a,filterQuery:n,timerange:r,signal:i})=>e.search.search({defaultIndex:t,eventFields:a,factoryQueryType:o.a.eventEnrichment,filterQuery:n,timerange:r},{strategy:"securitySolutionSearchStrategy",abortSignal:i}))(e).pipe(Object(r.filter)((e=>!Object(i.isRunningResponse)(e)))))),l=()=>Object(n.c)(s);var c=a(2),u=a(48),d=a(9),p=a(235),m=a.n(p),y=a(119),g=a(272),f=a(117),b=a(110),h=a(181);const v=a(5).i18n.translate("xpack.securitySolution.investigationEnrichment.requestError",{defaultMessage:"An error occurred while requesting threat intelligence"});var E=a(4);const x="investigation_time_enrichment",k=()=>{},w={enrichments:[]},j=e=>{const{addError:t}=Object(f.a)(),{data:a,uiSettings:n}=Object(b.i)().services,r=n.get(E.U),i=Object(u.useDispatch)(),[o,s]=Object(c.useState)({from:g.a,to:g.b}),{error:p,loading:j,result:S,start:O}=l(),I=Object(c.useCallback)((()=>{i(h.c.deleteOneQuery({inputId:y.a.global,id:x}))}),[i]);Object(c.useEffect)((()=>(!j&&S&&i(h.c.setQuery({inputId:y.a.global,id:x,inspect:{dsl:S.inspect.dsl,response:[JSON.stringify(S.rawResponse,null,2)]},loading:j,refetch:k})),I)),[I,i,j,S]),Object(c.useEffect)((()=>{p&&t(p,{title:v})}),[t,p]);const C=m()(e),M=m()(o);return Object(c.useEffect)((()=>{Object(d.isEmpty)(e)||Object(d.isEqual)(e,C)&&Object(d.isEqual)(o,M)||O({data:a,timerange:{...o,interval:""},defaultIndex:r,eventFields:e,filterQuery:""})}),[O,a,e,C,o,M,r]),{result:Object(d.isEmpty)(e)?w:S,range:o,setRange:s,loading:j}}}}]);