/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[17],{957:function(e,t,a){"use strict";a.d(t,"a",(function(){return jt}));var n=a(2),r=a.n(n),o=a(48),l=a(17),s=a(47),i=a(49),c=a(1093),d=a(161),u=a(44),m=a.n(u),p=a(489);function g(e,t,a){return t+(e>1?a*(e-1):0)}var b=a(55);function f(){return Object(n.useMemo)((()=>({copyableFieldBackground:b.euiThemeVars.euiColorLightShade,descriptionText:b.euiThemeVars.euiTextColor,full:b.euiThemeVars.euiColorFullShade,graphControls:b.euiThemeVars.euiColorDarkestShade,graphControlsBackground:b.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:b.euiThemeVars.euiColorLightShade,processBackingFill:`${b.euiThemeVars.euiColorPrimary}${b.darkMode?"1F":"0F"}`,resolverBackground:b.euiThemeVars.euiColorEmptyShade,resolverEdge:b.darkMode?b.euiThemeVars.euiColorLightShade:b.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:b.euiThemeVars.euiColorLightestShade,resolverEdgeText:b.darkMode?b.euiThemeVars.euiColorFullShade:b.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${b.euiThemeVars.euiColorDanger}${b.darkMode?"1F":"0F"}`,pillStroke:b.euiThemeVars.euiColorLightShade,linkColor:b.euiThemeVars.euiLinkColor})),[])}const v=m.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-15liy6m-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${g(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),E=m.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-15liy6m-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),y=r.a.memo((({className:e,edgeLineMetadata:t,startPosition:a,endPosition:n,projectionMatrix:o})=>{const l=Object(p.c)(a,o),i=Object(p.c)(n,o),[c]=o,d=f(),u=null==t?void 0:t.elapsedTime,m=Object(p.d)(l,i),b=g(c,10,7.5),y={left:`${l[0]}px`,top:`${l[1]}px`,width:`${m}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(p.b)(l,i)}rad)`};let h=50;return c<1&&(h+=1/c*(10*(1-c))),r.a.createElement(v,{className:e,style:y,resolverEdgeColor:d.resolverEdge,magFactorX:c,"data-test-subj":"resolver:graph:edgeline"},u&&r.a.createElement(E,{backgroundColor:d.resolverEdge,leftPct:h,scaledTypeSize:b,textColor:d.resolverEdgeText},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:u.duration,durationType:u.durationType}})))}));var h=a(5);const C={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:a(513).ResizeObserver,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},x=Object(n.createContext)(C),k=Object(n.memo)(m()(l.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-o40dfq-0"})([".euiDescriptionList__title{word-break:normal;}.euiDescriptionList__title,.euiDescriptionList__description{overflow-wrap:break-word;}"])),j=m()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-o40dfq-1"})(["overflow-wrap:break-word;"]),S=m()(l.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-o40dfq-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),w=m.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-o40dfq-3"})(["align-items:center;display:flex;flex-direction:row;"]),O=m.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-o40dfq-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),M=m.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-o40dfq-5"})([""]),T=m.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-o40dfq-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],O,M),D=m()(l.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-o40dfq-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),I=m()("time").withConfig({displayName:"StyledTime",componentId:"sc-o40dfq-8"})(["display:inline-block;text-align:start;"]);function L({id:e}){return Object(n.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function z(e,t,a){const r=L({id:e}),o=f(),l=Object(n.useMemo)((()=>({runningProcessCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.runningProcessCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.loadingCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},errorCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.errorCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:o.triggerBackingFill,cubeSymbol:`#${r.runningTriggerCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:b.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:o.processBackingFill,cubeSymbol:`#${r.terminatedProcessCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:b.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:o.triggerBackingFill,cubeSymbol:`#${r.terminatedTriggerCube}`,descriptionFill:o.descriptionText,descriptionText:h.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:b.euiThemeVars.euiColorDanger}})),[r,o]);return"terminated"===t?a?l.terminatedTriggerCube:l[P.processTerminated]:"running"===t?a?l[P.processCausedAlert]:l[P.processRan]:"error"===t?l[P.processError]:l[P.processLoading]}const P={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},F=Object(n.memo)((function({id:e,className:t,size:a="2.15em",state:n,isOrigin:o,"data-test-subj":l}){const{cubeSymbol:s,strokeColor:i}=z(e,n,!1),{processCubeActiveBacking:c}=L({id:e});return r.a.createElement(N,{className:t,width:a,height:a,viewBox:"0 0 34 34","data-test-subj":l,isOrigin:o,style:{verticalAlign:"middle"}},r.a.createElement("desc",null,h.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process}}",values:{state:n}})),o&&r.a.createElement("use",{xlinkHref:`#${c}`,fill:"transparent",x:0,y:-1,stroke:i,strokeDashoffset:0,width:"100%",height:"100%"}),r.a.createElement("use",{role:"presentation",xlinkHref:s,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),N=m.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-wfcaav-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),B=r.a.memo((function({children:e}){return r.a.createElement(r.a.Fragment,null,r.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,r.a.createElement("wbr",null)]}),[])]}return e})))}));var V=a(699);const A=m()(l.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-1bgkbkz-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),$=m.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-1bgkbkz-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),R=["fit-content(10em)","auto"],Z=m()(l.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-1bgkbkz-2"})(["text-transform:uppercase;"]),U=m()(l.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-1bgkbkz-3"})(["lineheight:'2.2em';"]),q=m()(l.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-1bgkbkz-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),_=m.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-1bgkbkz-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor)),G=r.a.memo((({id:e,className:t})=>{const a=Object(o.useDispatch)(),s=Object(o.useSelector)((t=>d.G(t.analyzer[e]))),{timestamp:i}=Object(n.useContext)(x),[c,u]=Object(n.useState)(null),m=f(),p=Object(n.useCallback)((e=>{u(e===c?null:e)}),[u,c]),g=Object(n.useCallback)((()=>u(null)),[]),b=Object(n.useCallback)((t=>{const n=parseFloat(t.target.value);!1===isNaN(n)&&a(Object(V.userSetZoomLevel)({id:e,zoomLevel:n}))}),[a,e]),v=Object(n.useCallback)((()=>{a(Object(V.userSetPositionOfCamera)({id:e,cameraView:[0,0]}))}),[a,e]),E=Object(n.useCallback)((()=>{a(Object(V.userClickedZoomOut)({id:e}))}),[a,e]),y=Object(n.useCallback)((()=>{a(Object(V.userClickedZoomIn)({id:e}))}),[a,e]),[C,k,j,S]=Object(n.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((t=>()=>{a(Object(V.userNudgedCamera)({id:e,direction:t,time:i()}))}))),[a,i,e]);return r.a.createElement(_,{className:t,$iconColor:m.graphControls,"data-test-subj":"resolver:graph-controls"},r.a.createElement($,null,r.a.createElement(H,{id:e,closePopover:g,isOpen:"schemaInfo"===c,setActivePopover:p}),r.a.createElement(W,{id:e,closePopover:g,isOpen:"nodeLegend"===c,setActivePopover:p})),r.a.createElement($,null,r.a.createElement(l.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},r.a.createElement("div",{className:"panning-controls-top"},r.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:C},r.a.createElement(l.EuiIcon,{type:"arrowUp"}))),r.a.createElement("div",{className:"panning-controls-middle"},r.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:S},r.a.createElement(l.EuiIcon,{type:"arrowLeft"})),r.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:v},r.a.createElement(l.EuiIcon,{type:"bullseye"})),r.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:k},r.a.createElement(l.EuiIcon,{type:"arrowRight"}))),r.a.createElement("div",{className:"panning-controls-bottom"},r.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:j},r.a.createElement(l.EuiIcon,{type:"arrowDown"})))),r.a.createElement(l.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},r.a.createElement("button",{title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:y},r.a.createElement(l.EuiIcon,{type:"plusInCircle"})),r.a.createElement(A,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:s,onChange:b}),r.a.createElement("button",{title:h.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:E},r.a.createElement(l.EuiIcon,{type:"minusInCircle"})))))})),H=({id:e,closePopover:t,setActivePopover:a,isOpen:s})=>{var i,c,u;const m=f(),p=Object(o.useSelector)((t=>d.F(t.analyzer[e]))),g=Object(n.useCallback)((()=>a("schemaInfo")),[a]),b=h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),v=h.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return r.a.createElement(l.EuiPopover,{button:r.a.createElement(q,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:b,"aria-label":b,onClick:g,iconType:"iInCircle",$backgroundColor:m.graphControlsBackground,$iconColor:m.graphControls,$borderColor:m.graphControlsBorderColor}),isOpen:s,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(l.EuiPopoverTitle,{style:{textTransform:"uppercase"}},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),r.a.createElement(l.EuiIconTip,{content:h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),r.a.createElement("div",{style:{maxWidth:"268px"}},r.a.createElement(k,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",columnWidths:R,align:"left",compressed:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(Z,{"data-test-subj":"resolver:graph-controls:schema-info:title"},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),r.a.createElement(l.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(B,null,null!==(i=null==p?void 0:p.dataSource)&&void 0!==i?i:v)),r.a.createElement(Z,{"data-test-subj":"resolver:graph-controls:schema-info:title"},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),r.a.createElement(l.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(B,null,null!==(c=null==p?void 0:p.schema.id)&&void 0!==c?c:v)),r.a.createElement(Z,{"data-test-subj":"resolver:graph-controls:schema-info:title"},h.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),r.a.createElement(l.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},r.a.createElement(B,null,null!==(u=null==p?void 0:p.schema.parent)&&void 0!==u?u:v))))))},W=({id:e,closePopover:t,setActivePopover:a,isOpen:o})=>{const s=Object(n.useCallback)((()=>a("nodeLegend")),[a]),i=f(),c=h.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return r.a.createElement(l.EuiPopover,{button:r.a.createElement(q,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:c,"aria-label":c,onClick:s,iconType:"node",$backgroundColor:i.graphControlsBackground,$iconColor:i.graphControls,$borderColor:i.graphControlsBorderColor}),isOpen:o,closePopover:t,anchorPosition:"leftCenter"},r.a.createElement(l.EuiPopoverTitle,{style:{textTransform:"uppercase"}},h.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),r.a.createElement("div",{style:{maxWidth:"212px"}},r.a.createElement(k,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",columnWidths:R,align:"left",compressed:!0},r.a.createElement(r.a.Fragment,null,r.a.createElement(Z,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(F,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),r.a.createElement(U,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(B,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),r.a.createElement(Z,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(F,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),r.a.createElement(U,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(B,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),r.a.createElement(Z,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(F,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),r.a.createElement(U,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(B,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),r.a.createElement(Z,{"data-test-subj":"resolver:graph-controls:node-legend:title"},r.a.createElement(F,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),r.a.createElement(U,{"data-test-subj":"resolver:graph-controls:node-legend:description"},r.a.createElement(B,null,h.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))};function K(e,t){return function(e,t){const a=Object(i.useHistory)(),r=Object(n.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),a.push(e)))}),[a,t,e]);return{href:a.createHref(e),onClick:r}}({search:Object(o.useSelector)((a=>d.D(a.analyzer[e])(t)))})}var Y=a(236),X=a(271);const Q=r.a.memo((({id:e,className:t,nodeID:a,nodeStats:o})=>{const l=Object(n.useMemo)((()=>void 0===o?[]:Object.entries(o.byCategory).map((([e,t])=>({prefix:r.a.createElement(Y.a,{count:t||0}),category:e})))),[o]);return void 0===l?null:r.a.createElement("ul",{className:`${t} options`,"aria-describedby":a},l.sort(((e,t)=>e.category.localeCompare(t.category))).map((t=>r.a.createElement(J,{id:e,pill:t,nodeID:a,key:t.category}))))})),J=({id:e,pill:t,nodeID:a})=>{const l=K(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:a,eventCategory:t.category}}),{pillStroke:s,resolverBackground:i}=f(),c=Object(n.useMemo)((()=>({border:`1.5px solid ${s}`,backgroundColor:i})),[s,i]),d=Object(o.useDispatch)(),{timestamp:u}=Object(n.useContext)(x),m=Object(n.useCallback)((t=>{l.onClick(t),d(Object(X.userSelectedResolverNode)({id:e,nodeID:a,time:u()}))}),[u,l,d,a,e]);return r.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:c,key:t.category},r.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:m},t.prefix," ",t.category))},ee=m()(Q).withConfig({displayName:"NodeSubMenu",componentId:"sc-bt8orj-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),te=m.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-bt8orj-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),ae=m()(l.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-bt8orj-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),ne=m.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-bt8orj-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),re=m()(l.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-bt8orj-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]);var oe=a(356),le=a(263),se=a(408),ie=a(444);const ce=m.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-tk4vjc-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),de=m.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-tk4vjc-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),ue=m.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-tk4vjc-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),me=m.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-tk4vjc-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),pe=r.a.memo((({id:e,className:t,position:a,node:i,nodeID:c,projectionMatrix:u,timeAtRender:m})=>{const b=`resolver:${e}`,v=L({id:e}),{timestamp:E}=Object(n.useContext)(x),[y,C]=Object(p.c)(a,u),[k]=u,j=Object(o.useSelector)((t=>d.a(t.analyzer[e]))),S=Object(o.useSelector)((t=>d.H(t.analyzer[e]))),w=Object(o.useSelector)((t=>d.y(t.analyzer[e]))),O=Object(o.useSelector)((t=>d.x(t.analyzer[e])(c))),M=Object(n.useCallback)((e=>Object(l.htmlIdGenerator)(b)(`${e}:node`)),[b]),T=Object(o.useSelector)((t=>d.c(t.analyzer[e])(c))),D=Object(o.useSelector)((t=>d.b(t.analyzer[e])(m)(c))),I=k>.8,P=k>=.55,F=(I?3.5:P?1:21)*k+5,N=360*(I?-.147413:-.147413-.08*(k-.5))*k,B=120*(I?-.53684:.2*-k*(1-k)/k-.53684)*k,V=Object(n.useMemo)((()=>({left:`${y+N}px`,top:`${C+B}px`,width:360*k+"px",height:120*k+"px"})),[y,k,N,B,C]),A=g(k,18.75,12.5),$=r.a.createRef(),R=f(),Z=Object(o.useSelector)((t=>d.v(t.analyzer[e])(c))),U="loading"===Z,{backingFill:q,cubeSymbol:_,descriptionText:G,isLabelFilled:H,labelButtonFill:W,strokeColor:Y}=z(e,Z,!1),Q=Object(n.useMemo)((()=>Object(l.htmlIdGenerator)("resolver")(`${c}:label`)),[c]),J=c===j,te=c===S,ae=c===w,ne=Object(o.useDispatch)(),re=K(e,{panelView:"nodeDetail",panelParameters:{nodeID:c}}),pe=Object(n.useCallback)((()=>{ne(Object(X.userFocusedOnResolverNode)({id:e,nodeID:c,time:E()}))}),[ne,c,E,e]),ge=Object(n.useCallback)((t=>{var a;null!==(a=$.current)&&void 0!==a&&a.beginElement&&$.current.beginElement(),"error"===Z?ne(Object(ie.userReloadedResolverNode)({id:e,nodeID:c})):(ne(Object(X.userSelectedResolverNode)({id:e,nodeID:c,time:E()})),re.onClick(t))}),[$,ne,c,re,Z,E,e]),be=Object(o.useSelector)((t=>d.I(t.analyzer[e])(i))),fe=oe.c(i),ve=Object(o.useSelector)((t=>se.a(d.u(t.analyzer[e])(String(i.id))))),Ee=Object(n.useMemo)((()=>void 0!==ve?le.l(ve):fe),[ve,fe]),ye=Object(n.useMemo)((()=>null===D?void 0:M(D)),[D,M]),he=Object(n.useMemo)((()=>M(c)),[M,c]);return r.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":c,className:`${t} kbn-resetFocusState`,role:"treeitem","aria-level":null===T?void 0:T,"aria-flowto":ye,"aria-labelledby":Q,"aria-haspopup":"true","aria-current":J?"true":void 0,"aria-selected":te?"true":void 0,style:V,id:he,tabIndex:-1},r.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{pe(),ge(e)},role:"img","aria-labelledby":Q,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},r.a.createElement(me,{isNodeLoading:U},r.a.createElement("use",{xlinkHref:`#${v.processCubeActiveBacking}`,fill:q,x:-15.35,y:-15.35,stroke:Y,width:22.5,height:22.5,className:"backing"}),ae&&r.a.createElement("use",{xlinkHref:`#${v.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:Y,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),r.a.createElement("use",{role:"presentation",xlinkHref:_,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},r.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:$})))),r.a.createElement(ce,{color:R.full,fontSize:A,topPct:F},r.a.createElement(de,{backgroundColor:R.resolverBackground,color:R.descriptionText,isDisplaying:P,"data-test-subj":"resolver:node:description"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event Â· {descriptionText}} false {{descriptionText}}}",values:{isEventBeingAnalyzed:ae,descriptionText:G}})),r.a.createElement("div",{className:"euiButton euiButton--small",id:Q,onClick:ge,onFocus:pe,tabIndex:-1,style:{backgroundColor:R.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},r.a.createElement(l.EuiButton,{iconSide:U?"right":"left",isLoading:U,color:W,fill:H,iconType:"error"===Z?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*k,32)}px`,maxWidth:(I?400:210*k)+"px"},tabIndex:-1,title:Ee,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":c},r.a.createElement(ue,{isShowingIcon:"loading"===Z||"error"===Z,className:"eui-textTruncate","data-test-subj":"euiButton__text"},h.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:Z,nodeName:Ee}})))),r.a.createElement(l.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:R.resolverBackground,display:I?"flex":"none",margin:"2px 0 0 0",padding:0}},r.a.createElement(l.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==be&&be>0&&r.a.createElement(ee,{id:e,buttonFill:R.resolverBackground,nodeStats:O,nodeID:c})))))})),ge=m()(pe).withConfig({displayName:"ProcessEventDot",componentId:"sc-tk4vjc-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var be=a(63);function fe({id:e}){const t=e;return Object(n.useMemo)((()=>{const e=`${t}-symbols`;return{runningProcessCube:`${e}-psRunningProcessCube`,runningTriggerCube:`${e}-psRunningTriggerCube`,terminatedProcessCube:`${e}-psTerminatedProcessCube`,terminatedTriggerCube:`${e}-psTerminatedTriggerCube`,loadingCube:`${e}-psLoadingCube`,errorCube:`${e}-psErrorCube`}}),[t])}const ve=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),Ee=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),ye=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),he=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),Ce=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),xe=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),ke=h.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),je=Object(n.memo)((({id:e,isDarkMode:t})=>{const a=fe({id:e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{stopColor:"#6D6D6D"}),r.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),r.a.createElement("linearGradient",{id:a.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),r.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),r.a.createElement("linearGradient",{id:a.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),r.a.createElement("stop",{offset:"1",stopColor:"#f66"})),t?r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),r.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),r.a.createElement("linearGradient",{id:a.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),r.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):r.a.createElement(r.a.Fragment,null,r.a.createElement("linearGradient",{id:a.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),r.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),r.a.createElement("linearGradient",{id:a.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},r.a.createElement("stop",{stopColor:"#DD0A73"}),r.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),Se=Object(n.memo)((({id:e,isDarkMode:t})=>{const a=L({id:e}),n=fe({id:e});return r.a.createElement(r.a.Fragment,null,r.a.createElement("symbol",{id:a.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},r.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),r.a.createElement("symbol",{id:a.loadingCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,ve),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:t?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),r.a.createElement("symbol",{id:a.errorCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,Ee),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.errorCube})`}),r.a.createElement("g",{opacity:"0.6"},r.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.errorCube})`}),r.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),r.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{id:a.runningProcessCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,ye),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningProcessCube})`}),r.a.createElement("g",{opacity:"0.5"},r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("symbol",{id:a.runningTriggerCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,he),r.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${n.runningTriggerCube})`}),r.a.createElement("g",{opacity:"0.5"},r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),r.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),r.a.createElement("symbol",{viewBox:"0 0 88 100",id:a.terminatedProcessCube},r.a.createElement("title",null,Ce),r.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:t?"#010101":"#fff"}),r.a.createElement("g",{opacity:"0.7"},r.a.createElement("path",{opacity:t?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${n.terminatedProcessCube})`}),r.a.createElement("path",{opacity:t?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),r.a.createElement("path",{opacity:t?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{id:a.terminatedTriggerCube,viewBox:"0 0 88 100"},r.a.createElement("title",null,xe),t&&r.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),r.a.createElement("g",{opacity:"0.6"},!t&&r.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),r.a.createElement("path",{opacity:t?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${n.terminatedTriggerCube})`}),r.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),r.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),r.a.createElement("symbol",{viewBox:"0 -3 88 106",id:a.processCubeActiveBacking},r.a.createElement("title",null,ke),r.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),we=Object(n.memo)((({id:e})=>{const t=Object(be.useUiSetting)("theme:darkMode");return r.a.createElement(Oe,null,r.a.createElement("defs",null,r.a.createElement(je,{id:e,isDarkMode:t}),r.a.createElement(Se,{id:e,isDarkMode:t})))})),Oe=m()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-zh7upd-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var Me=a(23),Te=a.n(Me);const De=Object(n.memo)((function({breadcrumbs:e}){const t=Object(n.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:a,resolverEdgeText:o}=f();return r.a.createElement(r.a.Fragment,null,r.a.createElement(S,{background:a,text:o,breadcrumbs:t,truncate:!1}))})),Ie=m.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-189s69h-0"})(["margin-right:5px;"]);function Le({id:e}){const t=h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),a=h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),o=K(e,{panelView:"nodes"}),s=Object(n.useMemo)((()=>[{text:a,...o}]),[o,a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(De,{breadcrumbs:s}),r.a.createElement(l.EuiSpacer,{size:"l"}),r.a.createElement(l.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},r.a.createElement(Ie,null,r.a.createElement(l.EuiLoadingSpinner,{size:"m"})),r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiText,{"data-test-subj":"resolver:panel:loading"},t))))}function ze({event:e}){var t,a,n,o,l,i,c,d,u,m,p,g,b,f,v,E,y,h,C;return Object(le.i)(e)?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(le.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(m=e.network)||void 0===m?void 0:m.forwarded_ip),networkDirection:String(null===(p=e.network)||void 0===p?void 0:p.direction)}}):null!==(a=e.kibana)&&void 0!==a&&null!==(n=a.alert)&&void 0!==n&&null!==(o=n.rule)&&void 0!==o&&o.name?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(g=e.kibana)||void 0===g||null===(b=g.alert)||void 0===b||null===(f=b.rule)||void 0===f?void 0:f.name)}}):null!==(l=e.file)&&void 0!==l&&l.path?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(v=e.file)||void 0===v?void 0:v.path)}}):null!==(i=e.registry)&&void 0!==i&&i.path?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(E=e.registry)||void 0===E?void 0:E.path)}}):null!==(c=e.registry)&&void 0!==c&&c.key?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(y=e.registry)||void 0===y?void 0:y.key)}}):null!==(d=e.dns)&&void 0!==d&&null!==(u=d.question)&&void 0!==u&&u.name?r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(h=e.dns)||void 0===h||null===(C=h.question)||void 0===C?void 0:C.name)}}):r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(le.b)(e)}})}var Pe=a(78),Fe=a.n(Pe);const Ne=h.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),Be=new Intl.DateTimeFormat(h.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function Ve(e){const t=Object(be.useUiSetting)("dateFormat"),a=Object(be.useUiSetting)("dateFormat:tz"),n="Browser"===a?Fe.a.tz.guess():a;if(!e)return;const r=new Date(e);return r&&Number.isFinite(r.getTime())?t?Fe.a.tz(r,n).format(t):Be.format(r):Ne}var Ae=a(325);const $e=Object(n.memo)((function({id:e,nodeID:t,eventCategory:a}){const n=Object(o.useSelector)((a=>d.g(a.analyzer[e])(t))),i=Object(o.useSelector)((t=>d.p(t.analyzer[e]))),c=Object(o.useSelector)((t=>d.h(t.analyzer[e])));return r.a.createElement(r.a.Fragment,null,i?r.a.createElement(ae,{hasBorder:!0},r.a.createElement(Le,{id:e})):r.a.createElement(ae,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},c||!n?r.a.createElement(l.EuiCallOut,{title:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"warning","data-test-subj":"resolver:nodeEventsInCategory:error"},r.a.createElement("p",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue,{id:e,nodeName:n.name,eventCategory:a,nodeID:t}),r.a.createElement(l.EuiSpacer,{size:"l"}),r.a.createElement(Ze,{id:e,eventCategory:a,nodeID:t}))))})),Re=Object(n.memo)((function({id:e,event:t,nodeID:a,eventCategory:n}){const o=Object(Ae.a)(t),i=le.g(o),c=le.e(o),d=le.p(o),u=Ve(i)||h.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),m=K(e,{panelView:"eventDetail",panelParameters:{nodeID:a,eventCategory:n,eventID:c,eventTimestamp:String(i),winlogRecordID:String(d)}});return r.a.createElement(r.a.Fragment,null,r.a.createElement(l.EuiText,null,r.a.createElement(D,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:le.d(o).join(", "),eventType:le.h(o).join(", ")},defaultMessage:"{category} {eventType}"})),r.a.createElement(I,{dateTime:u},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:u},defaultMessage:"@ {date}"}))),r.a.createElement(l.EuiSpacer,{size:"xs"}),r.a.createElement(l.EuiButtonEmpty,Te()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},m),r.a.createElement(ze,{event:o})))})),Ze=Object(n.memo)((function({id:e,eventCategory:t,nodeID:a}){const i=Object(o.useSelector)((t=>d.w(t.analyzer[e]))),c=Object(o.useDispatch)(),u=Object(n.useCallback)((()=>{c(Object(ie.userRequestedAdditionalRelatedEvents)({id:e}))}),[c,e]),m=Object(o.useSelector)((t=>d.o(t.analyzer[e]))),p=Object(o.useSelector)((t=>d.r(t.analyzer[e])));return r.a.createElement(r.a.Fragment,null,i.map(((o,s)=>r.a.createElement(n.Fragment,{key:s},r.a.createElement(Re,{id:e,nodeID:a,eventCategory:t,event:o}),s===i.length-1?null:r.a.createElement(l.EuiHorizontalRule,{margin:"m"})))),p&&r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiButton,{color:"primary",size:"s",fill:!0,onClick:u,isLoading:m,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),Ue=Object(n.memo)((function({id:e,nodeName:t,eventCategory:a,nodeID:n}){const l=Object(o.useSelector)((t=>d.K(t.analyzer[e])(n))),i=Object(o.useSelector)((t=>d.B(t.analyzer[e])(n,a))),c=K(e,{panelView:"nodes"}),u=K(e,{panelView:"nodeDetail",panelParameters:{nodeID:n}}),m=K(e,{panelView:"nodeEvents",panelParameters:{nodeID:n}});return r.a.createElement(De,{breadcrumbs:[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...c},{text:t,...u},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:l},defaultMessage:"{totalCount} Events"}),...m},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:i,category:a},defaultMessage:"{count} {category}"})}]})}));function qe({id:e,nodeID:t}){const a=Object(o.useSelector)((a=>se.a(d.u(a.analyzer[e])(t)))),n=Object(o.useSelector)((a=>d.x(a.analyzer[e])(t)));return void 0===a||void 0===n?r.a.createElement(ae,{hasBorder:!0},r.a.createElement(Le,{id:e})):r.a.createElement(ae,{hasBorder:!0},r.a.createElement(Ge,{id:e,nodeName:le.l(a),nodeID:t,totalEventCount:n.total}),r.a.createElement(l.EuiSpacer,{size:"l"}),r.a.createElement(_e,{id:e,nodeID:t,relatedStats:n}))}const _e=Object(n.memo)((function({id:e,nodeID:t,relatedStats:a}){const o=Object(n.useMemo)((()=>Object.entries(a.byCategory).map((([e,t])=>({eventType:e,count:t})))),[a.byCategory]),s=Object(n.useMemo)((()=>[{field:"count",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"20%",sortable:!0},{field:"eventType",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"80%",sortable:!0,render:a=>r.a.createElement(He,{id:e,nodeID:t,eventType:a},a)}]),[t,e]);return r.a.createElement(l.EuiInMemoryTable,{items:o,columns:s,sorting:!0})})),Ge=Object(n.memo)((function({id:e,nodeID:t,nodeName:a,totalEventCount:n}){return r.a.createElement(De,{breadcrumbs:[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...K(e,{panelView:"nodes"})},{text:a,...K(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}})},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:n},defaultMessage:"{totalCount} Events"}),...K(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}})}]})})),He=Object(n.memo)((({id:e,nodeID:t,eventType:a,children:n})=>{const o=K(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:a}});return r.a.createElement(l.EuiButtonEmpty,Te()({"data-test-subj":"resolver:panel:node-events:event-type-link"},o),n)})),We=m.a.div.withConfig({displayName:"StyledCopyableField",componentId:"sc-1sthks-0"})(["border-radius:3px;padding:4px;transition:background 0.2s ease;",":hover &{background-color:",";&:hover{background-color:",";color:#fff;}}"],ae,(e=>e.backgroundColor),(e=>e.activeBackgroundColor)),Ke=Object(n.memo)((({textToCopy:e,content:t})=>{var a;const{linkColor:o,copyableFieldBackground:s}=f(),[i,c]=Object(n.useState)(!1),d=null===(a=Object(be.useKibana)().services.notifications)||void 0===a?void 0:a.toasts,u=()=>c(!0),m=()=>c(!1),p=Object(n.useMemo)((()=>r.a.createElement(We,{backgroundColor:s,"data-test-subj":"resolver:panel:copyable-field-hover-area",activeBackgroundColor:o,onMouseEnter:u},t)),[t,s,o]),{writeTextToClipboard:g}=Object(n.useContext)(x),b=Object(n.useCallback)((async()=>{try{await g(e)}catch(e){d&&d.addError(e,{title:h.i18n.translate("xpack.securitySolution.resolver.panel.copyFailureTitle",{defaultMessage:"Copy Failure"})})}}),[e,d,g]);return r.a.createElement("div",{onMouseLeave:m},r.a.createElement(l.EuiPopover,{anchorPosition:"downCenter",button:p,closePopover:m,hasArrow:!1,isOpen:i,panelPaddingSize:"s"},r.a.createElement(l.EuiToolTip,{content:h.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"})},r.a.createElement(l.EuiButtonIcon,{"aria-label":h.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"}),color:"text","data-test-subj":"resolver:panel:clipboard",iconType:"copyClipboard",onClick:b}))))}));var Ye=a(1094);const Xe=Object(n.memo)((function({id:e,translatedErrorMessage:t}){const a=K(e,{panelView:"nodes"}),o=Object(n.useMemo)((()=>[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...a},{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(De,{breadcrumbs:o}),r.a.createElement(l.EuiSpacer,{size:"l"}),r.a.createElement(l.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},t),r.a.createElement(l.EuiSpacer,{size:"l"}),r.a.createElement(l.EuiButtonEmpty,a,h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),Qe=m()(F).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-f4b2od-0"})(["position:relative;"]),Je=["fit-content(10em)","auto"],et=h.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),tt=Object(n.memo)((function({id:e,nodeID:t}){const a=Object(o.useSelector)((a=>se.a(d.u(a.analyzer[e])(t))));return"loading"===Object(o.useSelector)((a=>d.v(a.analyzer[e])(t)))?r.a.createElement(ae,{hasBorder:!0},r.a.createElement(Le,{id:e})):a?r.a.createElement(ae,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},r.a.createElement(at,{id:e,nodeID:t,processEvent:a})):r.a.createElement(ae,{hasBorder:!0},r.a.createElement(Xe,{id:e,translatedErrorMessage:et}))})),at=Object(n.memo)((function({id:e,processEvent:t,nodeID:a}){const i=le.l(t),c=Object(o.useSelector)((t=>d.v(t.analyzer[e])(a))),u=Object(o.useSelector)((t=>d.C(t.analyzer[e])(a))),m=Ve(le.g(t)),p=Object(n.useMemo)((()=>{const e={title:"@timestamp",description:m},a={title:"process.executable",description:Object(Ye.d)(t)},n={title:"process.pid",description:Object(Ye.c)(t)},o={title:"user.name",description:le.o(t)};return[e,a,n,{title:"process.entity_id",description:le.c(t)},o,{title:"user.domain",description:le.n(t)},{title:"process.parent.pid",description:le.k(t)},{title:"process.hash.md5",description:le.j(t)},{title:"process.args",description:le.a(t)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:r.a.createElement(Ke,{textToCopy:String(e.description),content:r.a.createElement(B,null,String(e.description))})})))}),[m,t]),g=K(e,{panelView:"nodes"}),b=Object(n.useMemo)((()=>[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...g},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:i},defaultMessage:"Details for: {processName}"})}]),[i,g]),{descriptionText:f}=z(e,c,!1),v=K(e,{panelView:"nodeEvents",panelParameters:{nodeID:a}}),E=Object(n.useMemo)((()=>Object(l.htmlIdGenerator)("resolverTable")()),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(De,{breadcrumbs:b}),r.a.createElement(l.EuiSpacer,{size:"l"}),r.a.createElement(l.EuiTitle,{size:"xs"},r.a.createElement(j,{"aria-describedby":E},r.a.createElement(Qe,{id:e,"data-test-subj":"resolver:node-detail:title-icon",state:c}),r.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},r.a.createElement(B,null,i)))),r.a.createElement(l.EuiText,null,r.a.createElement(l.EuiTextColor,{color:"subdued"},r.a.createElement("span",{id:E},f))),r.a.createElement(l.EuiSpacer,{size:"s"}),r.a.createElement(l.EuiLink,Te()({},v,{"data-test-subj":"resolver:node-detail:node-events-link"}),r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:u},defaultMessage:"{relatedEventTotal} Events"})),r.a.createElement(l.EuiSpacer,{size:"l"}),r.a.createElement(k,{"data-test-subj":"resolver:node-detail",type:"column",columnWidths:Je,align:"left",titleProps:{"data-test-subj":"resolver:node-detail:entry-title",className:"desc-title"},descriptionProps:{"data-test-subj":"resolver:node-detail:entry-description"},compressed:!0,listItems:p}))})),nt=r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),rt=r.a.memo((function({numberOfEntries:e}){return r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),ot=r.a.memo((function({numberDisplayed:e}){return r.a.createElement(re,{size:"s",title:r.a.createElement(rt,{numberOfEntries:e})},r.a.createElement("p",null,nt))})),lt=Object(n.memo)((({id:e})=>{const t=Object(n.useMemo)((()=>[{field:"name",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(t,a)=>r.a.createElement(st,{id:e,name:t,nodeID:a.nodeID})},{field:"timestamp",name:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:e=>r.a.createElement(it,{eventDate:e})}]),[e]),a=Object(o.useSelector)(Object(n.useCallback)((t=>{const{processNodePositions:a}=d.s(t.analyzer[e]),n=[];for(const e of a.keys()){const t=oe.c(e),a=oe.b(e);void 0!==a&&n.push({name:t,timestamp:oe.e(e),nodeID:a})}return n}),[e])),s=a.length,i=Object(n.useMemo)((()=>[{text:h.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),c=Object(o.useSelector)((t=>d.k(t.analyzer[e]))),u=Object(o.useSelector)((t=>d.j(t.analyzer[e]))),m=Object(o.useSelector)((t=>d.l(t.analyzer[e]))),p=!0===c||!0===u||!0===m,g=Object(n.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return r.a.createElement(ae,{hasBorder:!0},r.a.createElement(De,{breadcrumbs:i}),p&&r.a.createElement(ot,{numberDisplayed:s}),r.a.createElement(l.EuiSpacer,{size:"l"}),r.a.createElement(l.EuiInMemoryTable,{rowProps:g,"data-test-subj":"resolver:node-list",items:a,columns:t,sorting:!0}))}));function st({id:e,name:t,nodeID:a}){const s=Object(o.useSelector)((t=>d.y(t.analyzer[e])===a)),i=Object(o.useSelector)((t=>d.v(t.analyzer[e])(a))),{descriptionText:c}=f(),u=K(e,{panelView:"nodeDetail",panelParameters:{nodeID:a}}),m=Object(o.useDispatch)(),{timestamp:p}=Object(n.useContext)(x),g=Object(n.useCallback)((t=>{u.onClick(t),m(Object(X.userSelectedResolverNode)({id:e,nodeID:a,time:p()}))}),[p,u,m,a,e]);return r.a.createElement(l.EuiButtonEmpty,{onClick:g,href:u.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":a},void 0===t?r.a.createElement(l.EuiBadge,{color:"warning"},h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):r.a.createElement(w,null,r.a.createElement(F,{id:e,state:i,isOrigin:s,"data-test-subj":"resolver:node-list:node-link:icon"}),r.a.createElement(T,null,s&&r.a.createElement(O,{color:c,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},h.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),r.a.createElement(M,{"data-test-subj":"resolver:node-list:node-link:title"},t))))}const it=Object(n.memo)((({eventDate:e})=>{const t=Ve(e);return t?r.a.createElement(Ke,{textToCopy:t,content:t}):r.a.createElement("span",null,"â")}));function ct(e){const t=[{path:[],value:e}],a=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:n,value:r}=e;Array.isArray(r)?t.push(...r.map((e=>({path:[...n],value:e})))):"object"==typeof r&&null!==r?t.push(...Object.keys(r).map((e=>({path:[...n,e],value:r[e]})))):null!=r&&a.push([n,r])}return a}const dt=h.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),ut=Object(n.memo)((function({id:e,nodeID:t,eventCategory:a}){const n=Object(o.useSelector)((t=>d.n(t.analyzer[e]))),l=Object(o.useSelector)((t=>d.q(t.analyzer[e]))),s=Object(o.useSelector)((a=>se.a(d.u(a.analyzer[e])(t)))),i=Object(o.useSelector)((a=>d.v(a.analyzer[e])(t))),c=n||l||"loading"===i,u=Object(o.useSelector)((t=>d.d(t.analyzer[e])));return c?r.a.createElement(ae,{hasBorder:!0},r.a.createElement(Le,{id:e})):u?r.a.createElement(mt,{id:e,nodeID:t,event:u,processEvent:s,eventType:a}):r.a.createElement(ae,{hasBorder:!0},r.a.createElement(Xe,{id:e,translatedErrorMessage:dt}))})),mt=Object(n.memo)((function({id:e,nodeID:t,event:a,eventType:n,processEvent:o}){const i=Ve(le.m(a))||h.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),c=o?le.l(o):null;return r.a.createElement(ae,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},r.a.createElement(gt,{id:e,nodeID:t,nodeName:c,event:a,breadcrumbEventCategory:n}),r.a.createElement(l.EuiSpacer,{size:"l"}),r.a.createElement(l.EuiText,{size:"s"},r.a.createElement(D,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:n,eventType:String(le.h(a))},defaultMessage:"{category} {eventType}"})),r.a.createElement(I,{dateTime:i},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:i},defaultMessage:"@ {date}"}))),r.a.createElement(l.EuiSpacer,{size:"m"}),r.a.createElement(bt,null,r.a.createElement(B,null,r.a.createElement(ze,{event:a}))),r.a.createElement(l.EuiSpacer,{size:"l"}),r.a.createElement(pt,{event:a}))}));function pt({event:e}){const t=Object(n.useMemo)((()=>{const t=[],a=Object(Ae.a)(e);for(const[e,n]of Object.entries(a)){if("agent"===e||"ecs"===e||"@timestamp"===e||!n)continue;const a={namespace:r.a.createElement(B,null,e),descriptions:ct(n).map((([t,a])=>{const n=[e,...t].join(".");return{title:r.a.createElement(B,null,n),description:r.a.createElement(Ke,{textToCopy:String(a),content:r.a.createElement(B,null,String(a))})}}))};t.push(a)}return t}),[e]);return r.a.createElement(r.a.Fragment,null,t.map((({namespace:e,descriptions:a},o)=>r.a.createElement(n.Fragment,{key:o},0===o?null:r.a.createElement(l.EuiSpacer,{size:"m"}),r.a.createElement(l.EuiTitle,{size:"xxxs"},r.a.createElement(l.EuiTextColor,{color:"subdued"},r.a.createElement(ft,null,e,r.a.createElement(vt,null)))),r.a.createElement(l.EuiSpacer,{size:"m"}),r.a.createElement(k,{type:"column",columnWidths:["fit-content(8em)","auto"],align:"left",titleProps:{className:"desc-title","data-test-subj":"resolver:panel:event-detail:event-field-title"},compressed:!0,listItems:a}),o===t.length-1?null:r.a.createElement(l.EuiSpacer,{size:"m"})))))}function gt({id:e,nodeID:t,nodeName:a,event:l,breadcrumbEventCategory:i}){const c=Object(o.useSelector)((a=>d.B(a.analyzer[e])(t,i))),u=Object(o.useSelector)((a=>d.C(a.analyzer[e])(t))),m=K(e,{panelView:"nodes"}),p=K(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}}),g=K(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}}),b=K(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:i}}),f=Object(n.useMemo)((()=>{const e=[{text:h.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...m},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:u},defaultMessage:"{totalCount} Events"}),...g},{text:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:c,category:i},defaultMessage:"{count} {category}"}),...b},{text:r.a.createElement(ze,{event:l})}];return a&&e.splice(1,0,{text:a,...p}),e}),[i,c,l,p,g,a,u,m,b]);return r.a.createElement(De,{breadcrumbs:f})}const bt=Object(n.memo)(m()(l.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-1monurs-0"})(["padding-right:1em;overflow-wrap:break-word;"])),ft=Object(n.memo)(m()("h3").withConfig({displayName:"StyledFlexTitle",componentId:"sc-1monurs-1"})(["align-items:center;display:flex;flex-flow:row;font-size:1.2em;"])),vt=Object(n.memo)((()=>r.a.createElement(l.EuiHorizontalRule,{margin:"none",size:"half"}))),Et=Object(n.memo)((function({id:e}){const t=Object(o.useSelector)((t=>d.z(t.analyzer[e])));return"nodeDetail"===t.panelView?r.a.createElement(tt,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEvents"===t.panelView?r.a.createElement(qe,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEventsInCategory"===t.panelView?r.a.createElement($e,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):"eventDetail"===t.panelView?r.a.createElement(ut,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):r.a.createElement(lt,{id:e})}));var yt=a(1131);const ht=m()(l.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-84kags-0"})(["align-self:flex-start;display:inline-block;"]),Ct=m()(l.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-84kags-1"})(["max-width:600px;margin:60px auto 0;"]),xt=()=>r.a.createElement(Ct,{"data-test-subj":"resolver:no-process-events",direction:"column"},r.a.createElement(l.EuiTitle,null,r.a.createElement("h4",null,h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),r.a.createElement(l.EuiSpacer,{size:"m"}),r.a.createElement(l.EuiText,{size:"s"},h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),r.a.createElement(l.EuiSpacer,{size:"m"}),r.a.createElement(l.EuiText,{size:"s"},h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),r.a.createElement(l.EuiSpacer,{size:"m"}),r.a.createElement(l.EuiText,{size:"s"},h.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),r.a.createElement(l.EuiSpacer,{size:"m"}),r.a.createElement(ht,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var kt=a(117);const jt=r.a.memo(r.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:a,indices:u,shouldUpdate:m,filters:p},g){!function(e){const t=Object(n.useRef)();t.current=Object(i.useLocation)().search;const a=Object(i.useHistory)(),r=Object(c.a)(e);Object(n.useEffect)((()=>{const e=r;return()=>{const n=new URLSearchParams(t.current);n.delete(e);const r={search:n.toString()};a.replace(r)}}),[r,a])}(a),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:a,filters:r,shouldUpdate:l}){const s=Object(o.useDispatch)(),c=Object(i.useLocation)().search;Object(n.useLayoutEffect)((()=>{s(Object(X.appReceivedNewExternalProperties)({id:t,databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:c,indices:a,shouldUpdate:l,filters:r}))}),[s,e,t,c,a,l,r])}({databaseDocumentID:t,resolverComponentInstanceID:a,indices:u,shouldUpdate:m,filters:p}),function({id:e}){const{addSuccess:t}=Object(kt.a)(),{from:a,to:r}=Object(o.useSelector)((t=>{const a=d.e(t.analyzer[e]);return{from:null!=a&&a.from?a.from:void 0,to:null!=a&&a.to?a.to:void 0}})),l=Ve(a),s=Ve(r),i=Object(n.useMemo)((()=>h.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:l,to:s}})),[l,s]);Object(n.useEffect)((()=>{(a||r)&&t(i)}),[t,i,a,r])}({id:a}),function({id:e}){const t=Object(o.useDispatch)(),a=e,r=Object(i.useLocation)().search,l=Object(n.useContext)(x),s=Object(o.useSelector)((t=>d.H(t.analyzer[e]))),c=Object(o.useSelector)((t=>d.g(t.analyzer[e]))),u=Object(yt.a)({locationSearch:r,resolverComponentInstanceID:a});let m;"nodes"!==u.panelView&&(m=u.panelParameters.nodeID),Object(n.useEffect)((()=>{m&&c(m)&&m!==s&&t(Object(X.userSelectedResolverNode)({id:e,nodeID:m,time:l.timestamp()}))}),[u.panelView,m,t,c,s,l,e])}({id:a});const{timestamp:b}=Object(n.useContext)(x),v=b(),{processNodePositions:E,connectingEdgeLineSegments:C}=Object(o.useSelector)((e=>d.O(e.analyzer[a])(v))),{projectionMatrix:k,ref:j,onMouseDown:S}=function({id:e}){const t=Object(o.useDispatch)(),a=Object(n.useContext)(x),[r,l]=Object(n.useState)(null),s=Object(o.useSelector)(Object(n.useCallback)((t=>d.A(t.analyzer[e])),[e])),i=Object(n.useRef)(),[c,u]=Object(n.useState)(s(a.timestamp())),m=Object(o.useSelector)((t=>d.N(t.analyzer[e]))),p=Object(o.useSelector)((t=>d.m(t.analyzer[e]))),[g,b]=function(){const{getBoundingClientRect:e}=Object(n.useContext)(x),[t,a]=Object(n.useState)(null),{ResizeObserver:r,requestAnimationFrame:o}=Object(n.useContext)(x),[l,s]=Object(n.useState)(null),i=Object(n.useCallback)((e=>{s(e)}),[]);return Object(n.useEffect)((()=>{null!==l&&a(e(l))}),[l,e]),Object(n.useEffect)((()=>{let t=window.scrollX,n=window.scrollY;const r=()=>{o((()=>{const r=window.scrollX,o=window.scrollY;null===l||t===r&&n===o||a(e(l)),t=r,n=o}))};return window.addEventListener("scroll",r,{passive:!0}),()=>{window.removeEventListener("scroll",r)}}),[l,o,e]),Object(n.useEffect)((()=>{if(null!==l){const t=new r((t=>{null!==l&&l===t[0].target&&a(e(l))}));return t.observe(l),()=>{t.disconnect()}}}),[r,l,e]),[t,i]}(),f=Object(n.useCallback)((e=>null===g?null:[e.clientX-g.x,e.clientY-g.y]),[g]),v=Object(n.useCallback)((n=>{const r=f(n);null!==r&&t(Object(V.userStartedPanning)({id:e,screenCoordinates:r,time:a.timestamp()}))}),[t,f,a,e]),E=Object(n.useCallback)((n=>{const r=f(n);r&&t(Object(V.userMovedPointer)({id:e,screenCoordinates:r,time:a.timestamp()}))}),[t,f,a,e]),y=Object(n.useCallback)((()=>{m&&t(Object(V.userStoppedPanning)({id:e,time:a.timestamp()}))}),[t,a,m,e]),h=Object(n.useCallback)((n=>{null!==g&&n.ctrlKey&&0!==n.deltaY&&0===n.deltaMode&&(n.preventDefault(),t(Object(V.userZoomed)({id:e,zoomChange:n.deltaY/-g.height,time:a.timestamp()})))}),[g,t,a,e]),C=Object(n.useCallback)((e=>{l(e),b(e)}),[b]);return Object(n.useEffect)((()=>(window.addEventListener("mouseup",y,{passive:!0}),()=>{window.removeEventListener("mouseup",y)})),[y]),Object(n.useEffect)((()=>(window.addEventListener("mousemove",E,{passive:!0}),()=>{window.removeEventListener("mousemove",E)})),[E]),Object(n.useEffect)((()=>{if(null!==r)return r.addEventListener("wheel",h),()=>{r.removeEventListener("wheel",h)}}),[r,h]),Object(n.useLayoutEffect)((()=>{i.current=s}),[s]),Object(n.useLayoutEffect)((()=>{u(s(a.timestamp()))}),[s,a]),Object(n.useLayoutEffect)((()=>{const e=a.timestamp();if(p(e)){let e=null;const t=()=>{const n=a.timestamp();void 0!==i.current&&u(i.current(n)),e=p(n)?a.requestAnimationFrame(t):null};return e=a.requestAnimationFrame(t),()=>{null!==e&&a.cancelAnimationFrame(e)}}}),[p,a]),Object(n.useEffect)((()=>{null!==g&&t(Object(V.userSetRasterSize)({id:e,dimensions:[g.width,g.height]}))}),[t,g,e]),{ref:C,onMouseDown:v,projectionMatrix:c}}({id:a}),w=Object(n.useCallback)((e=>{j(e),"function"==typeof g?g(e):null!==g&&(g.current=e)}),[j,g]),O=Object(o.useSelector)((e=>d.q(e.analyzer[a]))),M=Object(o.useSelector)((e=>d.i(e.analyzer[a]))),T=Object(o.useSelector)((e=>d.a(e.analyzer[a]))),D=Object(o.useSelector)((e=>d.E(e.analyzer[a]))),I=f();return r.a.createElement(te,{className:e,backgroundColor:I.resolverBackground},O?r.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},r.a.createElement(l.EuiLoadingSpinner,{size:"xl"})):M?r.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},r.a.createElement("div",null," ",r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):D?r.a.createElement(r.a.Fragment,null,r.a.createElement(ne,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:S,ref:w,role:"tree",tabIndex:0,"aria-activedescendant":T||void 0},C.map((({points:[e,t],metadata:a})=>r.a.createElement(y,{edgeLineMetadata:a,key:a.reactKey,startPosition:e,endPosition:t,projectionMatrix:k}))),[...E].map((([e,t])=>{const n=oe.b(e);if(void 0===n)throw new Error("Tried to render a node without an ID");return r.a.createElement(ge,{id:a,key:n,nodeID:n,position:t,projectionMatrix:k,node:e,timeAtRender:v})}))),r.a.createElement(Et,{id:a})):r.a.createElement(xt,null),r.a.createElement(G,{id:a}),r.a.createElement(we,{id:a}))})))}}]);