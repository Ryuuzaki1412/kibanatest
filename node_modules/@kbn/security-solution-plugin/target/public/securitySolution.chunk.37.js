/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[37],{1423:function(e,t,i){"use strict";i.d(t,"a",(function(){return T}));var a=i(2),n=i.n(a),l=i(3),r=i(44),o=i.n(r),s=i(136),u=i.n(s),d=i(17),c=i(19),m=i(79);const p=Object(a.memo)((({indexPattern:e,isLoading:t=!1,isRefreshPaused:i,filterQuery:l,filterManager:r,filters:o,refreshInterval:s,dataTestSubj:u,displayStyle:d})=>{const c=Object(a.useCallback)((e=>{r.setFilters(e)}),[r]),p=Object(a.useMemo)((()=>[e]),[e]);return n.a.createElement(m.SearchBar,{showSubmitButton:!1,filters:o,indexPatterns:p,isLoading:t,isRefreshPaused:i,query:l,onFiltersUpdated:c,refreshInterval:s,showAutoRefreshOnly:!1,showFilterBar:!0,showDatePicker:!1,showQueryInput:!1,showSaveQuery:!1,dataTestSubj:u,displayStyle:d})}));p.displayName="FilterBar";var g=i(117),b=i(475),E=i(9);const y=({ariaLabel:e,errors:t})=>{const[i,l]=Object(a.useState)(!1),r=Object(a.useCallback)((()=>{l(!i)}),[i]),o=Object(a.useCallback)((()=>{l(!1)}),[]);return n.a.createElement(d.EuiPopover,{"data-test-subj":"eql-validation-errors-popover",button:n.a.createElement(d.EuiButtonEmpty,{"data-test-subj":"eql-validation-errors-popover-button",iconType:"error",size:"s",color:"danger","aria-label":e,onClick:r},t.length),isOpen:i,closePopover:o,anchorPosition:"downCenter"},n.a.createElement("div",{"data-test-subj":"eql-validation-errors-popover-content"},n.a.createElement(d.EuiPopoverTitle,null,b.k),t.map(((e,t)=>n.a.createElement(d.EuiText,{key:t},e)))))};var f=i(110);const h=o()(d.EuiText).withConfig({displayName:"InlineText",componentId:"sc-yylwe5-0"})(["display:inline-block;"]),v=()=>{const e=Object(f.i)().services.docLinks.links.query.eql;return n.a.createElement(d.EuiLink,{external:!0,href:e,target:"_blank"},n.a.createElement(h,{size:"xs"},b.i))},x=o()(d.EuiFlexGroup).withConfig({displayName:"Container",componentId:"sc-x7d5ta-0"})(["border-radius:0;border-bottom-left-radius:6px;border-bottom-right-radius:6px;background:",";padding:"," ",";"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiSizeS)),O=o()(d.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-x7d5ta-1"})(["min-height:",";"],(({theme:e})=>e.eui.euiSizeXL)),F=o()(d.EuiFlexItem).withConfig({displayName:"FlexItemLeftBorder",componentId:"sc-x7d5ta-2"})(["border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),q=o()(d.EuiFlexItem).withConfig({displayName:"FlexItemWithMarginRight",componentId:"sc-x7d5ta-3"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),S=o()(d.EuiLoadingSpinner).withConfig({displayName:"Spinner",componentId:"sc-x7d5ta-4"})(["margin:0 ",";"],(({theme:e})=>e.eui.euiSizeS)),w={asPlainText:!0},j=({errors:e,isLoading:t,isSizeOptionDisabled:i,optionsData:l,optionsSelected:r,onOptionsChange:o})=>{var s;const[u,c]=Object(a.useState)(!1),[m,p]=Object(a.useState)(null!==(s=null==r?void 0:r.size)&&void 0!==s?s:100),g=Object(a.useRef)(),f=Object(a.useCallback)((()=>{c(!0)}),[]),h=Object(a.useCallback)((()=>{c(!1)}),[]),j=Object(a.useCallback)((e=>{o&&(e.length>0?o("eventCategoryField",e[0].label):o("eventCategoryField",void 0))}),[o]),C=Object(a.useCallback)((e=>{o&&(e.length>0?o("tiebreakerField",e[0].label):o("tiebreakerField",void 0))}),[o]),k=Object(a.useCallback)((e=>{o&&(e.length>0?o("timestampField",e[0].label):o("timestampField",void 0))}),[o]),I=Object(a.useCallback)((e=>{var t,i,a,n;o&&(p(null==e||null===(t=e.target)||void 0===t?void 0:t.value),null!==(i=g.current)&&void 0!==i&&i.cancel&&(null===(n=g.current)||void 0===n||n.cancel()),g.current=Object(E.debounce)((e=>o("size",e)),800),g.current(null==e||null===(a=e.target)||void 0===a?void 0:a.value))}),[o]),T=Object(a.useMemo)((()=>null!=(null==r?void 0:r.eventCategoryField)?[{label:null==r?void 0:r.eventCategoryField}]:void 0),[null==r?void 0:r.eventCategoryField]),P=Object(a.useMemo)((()=>null!=(null==r?void 0:r.tiebreakerField)?[{label:null==r?void 0:r.tiebreakerField}]:void 0),[null==r?void 0:r.tiebreakerField]),L=Object(a.useMemo)((()=>null!=(null==r?void 0:r.timestampField)?[{label:null==r?void 0:r.timestampField}]:void 0),[null==r?void 0:r.timestampField]);return n.a.createElement(x,null,n.a.createElement(O,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},n.a.createElement(d.EuiFlexItem,{grow:!1},n.a.createElement(d.EuiFlexGroup,null,n.a.createElement(d.EuiFlexItem,{grow:!1},e.length>0&&n.a.createElement(y,{ariaLabel:b.l,errors:e}),t&&n.a.createElement(S,{"data-test-subj":"eql-validation-loading",size:"m"})))),n.a.createElement(d.EuiFlexItem,{grow:!1},n.a.createElement(d.EuiFlexGroup,{gutterSize:"none",alignItems:"center",responsive:!1},!o&&n.a.createElement(d.EuiFlexItem,{grow:!1},n.a.createElement(v,null)),o&&n.a.createElement(n.a.Fragment,null,n.a.createElement(q,{grow:!1},n.a.createElement(v,null)),n.a.createElement(F,{grow:!1},n.a.createElement(d.EuiPopover,{button:n.a.createElement(d.EuiButtonIcon,{onClick:f,iconType:"controlsVertical",isDisabled:u,"aria-label":"eql settings","data-test-subj":"eql-settings-trigger"}),isOpen:u,closePopover:h,anchorPosition:"downCenter",ownFocus:!1},n.a.createElement(d.EuiPopoverTitle,null,b.j),n.a.createElement("div",{style:{width:"300px"}},!i&&n.a.createElement(d.EuiFormRow,{"data-test-subj":"eql-size-field",label:b.h,helpText:b.g},n.a.createElement(d.EuiFieldNumber,{value:m,onChange:I,min:1,max:1e4})),n.a.createElement(d.EuiFormRow,{"data-test-subj":"eql-event-category-field",label:b.b,helpText:b.a},n.a.createElement(d.EuiComboBox,{options:null==l?void 0:l.keywordFields,selectedOptions:T,singleSelection:w,onChange:j})),n.a.createElement(d.EuiFormRow,{"data-test-subj":"eql-tiebreaker-field",label:b.d,helpText:b.c},n.a.createElement(d.EuiComboBox,{options:null==l?void 0:l.nonDateFields,selectedOptions:P,singleSelection:w,onChange:C})),n.a.createElement(d.EuiFormRow,{"data-test-subj":"eql-timestamp-field",label:b.f,helpText:b.e},n.a.createElement(d.EuiComboBox,{options:null==l?void 0:l.dateFields,selectedOptions:L,singleSelection:w,onChange:k}))))))))))};var C=i(893);const k=o()(d.EuiTextArea).withConfig({displayName:"TextArea",componentId:"sc-u3oqty-0"})(["display:block;border:0;box-shadow:none;border-radius:0px;min-height:",";&:focus{box-shadow:none;}"],(({theme:e})=>e.eui.euiFormControlHeight)),I=o()(d.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-u3oqty-1"})(["border:",";border-radius:",";.euiFormRow__labelWrapper{background:",";border-top-left-radius:",";border-top-right-radius:",";padding:8px 10px;margin-bottom:0px;label{color:",";&.euiFormLabel-isInvalid{color:",";}}}"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiBorderRadius),(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiBorderRadius),(({theme:e})=>e.eui.euiBorderRadius),(({theme:e})=>e.eui.euiTextSubduedColor),(({theme:e})=>e.eui.euiColorDangerText)),T=({dataTestSubj:e,field:t,isLoading:i=!1,indexPattern:r,showFilterBar:o,idAria:s,optionsData:m,optionsSelected:E,isSizeOptionDisabled:y,onOptionsChange:h,onValidityChange:v,onValiditingChange:x})=>{const{addError:O}=Object(g.a)(),[F,q]=Object(a.useState)([]),{isValidating:S,value:w,setValue:T}=t,{isValid:P,message:L,messages:B,error:V}=Object(C.c)(t),{uiSettings:Q}=Object(f.i)().services,D=Object(a.useRef)(new c.FilterManager(Q));Object(a.useEffect)((()=>{null!=v&&v(P)}),[P,v]),Object(a.useEffect)((()=>{q(null!=B?B:[])}),[B]),Object(a.useEffect)((()=>{V&&O(V,{title:b.m})}),[V,O]),Object(a.useEffect)((()=>{x&&x(S)}),[S,x]),Object(a.useEffect)((()=>{let e=!0;const t=new l.Subscription;return D.current.setFilters([]),t.add(D.current.getUpdates$().subscribe({next:()=>{if(e){const e=D.current.getFilters(),{filters:t}=w;u()(t,e)||T({...w,filters:e})}}})),()=>{e=!1,t.unsubscribe()}}),[w,D,T]),Object(a.useEffect)((()=>{const{filters:e}=w;u()(e,D.current.getFilters())||D.current.setFilters(e)}),[w,D]);const R=Object(a.useCallback)((e=>{const t=e.target.value;x&&x(!0),q([]),T({filters:w.filters,query:{query:t,language:"eql"},saved_id:null})}),[w,T,x]);return n.a.createElement(I,{label:t.label,labelAppend:t.labelAppend,helpText:t.helpText,error:L,isInvalid:!P&&!S,fullWidth:!0,"data-test-subj":e,describedByIds:s?[s]:void 0},n.a.createElement(n.a.Fragment,null,n.a.createElement(k,{"data-test-subj":"eqlQueryBarTextInput",fullWidth:!0,isInvalid:!P&&!S,value:w.query.query,onChange:R}),n.a.createElement(j,{errors:F,isLoading:S,isSizeOptionDisabled:y,optionsData:m,optionsSelected:E,onOptionsChange:h}),o&&n.a.createElement(n.a.Fragment,null,n.a.createElement(d.EuiSpacer,{size:"s"}),n.a.createElement(p,{"data-test-subj":"eqlFilterBar",indexPattern:r,isLoading:i,isRefreshPaused:!1,filterQuery:w.query,filterManager:D.current,filters:D.current.getFilters()||[],displayStyle:"inPage"}))))}},1732:function(e,t,i){"use strict";i.r(t),i.d(t,"EqlTabContentComponent",(function(){return se})),i.d(t,"default",(function(){return ue}));var a=i(17),n=i(45),l=i(2),r=i.n(l),o=i(44),s=i.n(o),u=i(48),d=i(136),c=i.n(d),m=i(395),p=i(119),g=i(118),b=i(559),E=i(196),y=i(1418),f=i(1443),h=i(145),v=i(1517),x=i(122),O=i(400),F=i(593),q=i(360),S=i(1269),w=i(128),j=i(116),C=i(134),k=i(121),I=i(430),T=i(1555),P=i(189),L=i(282),B=i(745),V=i(9),Q=i(112),D=i(1423),R=i(893),N=i(146);const M=i(5).i18n.translate("xpack.securitySolution.timeline.EqlQueryBarLabel",{defaultMessage:"EQL query"});var z=i(57),_=i(353);const A={index:[],eqlQueryBar:{query:{query:"",language:"eql"},filters:[],saved_id:null}},$={index:{fieldsToValidateOnChange:["index","eqlQueryBar"],validations:[]},eqlQueryBar:{validations:[{validator:Object(R.a)(R.b,300)}]}},G=s()(N.e).withConfig({displayName:"HiddenUseField",componentId:"sc-jqevx7-0"})(["display:none;"]),H=Object(l.memo)((({timelineId:e})=>{var t;const i=Object(u.useDispatch)(),a=Object(l.useRef)(!0),[n,o]=Object(l.useState)(!1),[s,d]=Object(l.useState)(!1),c=Object(l.useMemo)((()=>Object(z.createSelector)(_.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eqlOptions)&&void 0!==t?t:{eventCategoryField:[{label:"event.category"}],tiebreakerField:[{label:""}],timestampField:[{label:"@timestamp"}],size:100,query:""}}))),[]),m=Object(Q.a)((t=>c(t,e))),{loading:p,indexPattern:b,selectedPatterns:E}=Object(k.d)(j.SourcererScopeName.timeline),y={...A,index:E.sort(),eqlQueryBar:{...A.eqlQueryBar,query:{query:null!==(t=m.query)&&void 0!==t?t:"",language:"eql"}}},{form:f}=Object(N.k)({defaultValue:y,options:{stripEmptyFields:!1},schema:$}),{getFields:h}=f,v=Object(l.useCallback)(((t,a)=>i(g.a.updateEqlOptions({id:e,field:t,value:a}))),[i,e]),[{eqlQueryBar:x}]=Object(N.m)({form:f,watch:["eqlQueryBar"]}),O=Object(l.useRef)(""),F=Object(l.useMemo)((()=>Object(V.isEmpty)(b.fields)?{keywordFields:[],dateFields:[],nonDateFields:[]}:{keywordFields:b.fields.filter((e=>{var t;return null===(t=e.esTypes)||void 0===t?void 0:t.includes("keyword")})).map((e=>({label:e.name}))),dateFields:b.fields.filter((e=>"date"===e.type)).map((e=>({label:e.name}))),nonDateFields:b.fields.filter((e=>"date"!==e.type)).map((e=>({label:e.name})))}),[b]);return Object(l.useEffect)((()=>{const{index:e}=h(),t=E.sort(),i=e.value.sort();Object(V.isEqual)(i,t)||e.setValue(t)}),[h,E]),Object(l.useEffect)((()=>{const{eqlQueryBar:e}=h();var t;return a.current&&(a.current=!1,d(!0),e.setValue({...A.eqlQueryBar,query:{query:null!==(t=m.query)&&void 0!==t?t:"",language:"eql"}})),()=>{a.current=!0}}),[h,m.query]),Object(l.useEffect)((()=>{null!=x&&O.current!==x.query.query&&n&&!s&&(O.current=x.query.query,i(g.a.updateEqlOptions({id:e,field:"query",value:`${x.query.query}`})),o(!1),d(!1))}),[i,x,n,s,e]),r.a.createElement(N.c,{form:f,"data-test-subj":"EqlQueryBarTimeline"},r.a.createElement(G,{key:"Index",path:"index"}),r.a.createElement(N.e,{key:"EqlQueryBar",path:"eqlQueryBar",component:D.a,componentProps:{optionsData:F,optionsSelected:m,onOptionsChange:v,onValidityChange:o,onValiditingChange:d,idAria:"timelineEqlQueryBar",isDisabled:p,isLoading:p,indexPattern:b,dataTestSubj:"timelineEqlQueryBar"},config:{...$.eqlQueryBar,label:M}}))}));var U=i(951),K=i(1321),W=i(18),X=i(1270);const J=s.a.div.withConfig({displayName:"EqlTabHeaderContainer",componentId:"sc-lpvn1k-0"})(["margin-top:",";width:100%;"],(e=>e.theme.eui.euiSizeS));J.displayName="EqlTabHeaderContainer";const Y=s()(a.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-lpvn1k-1"})(["align-items:stretch;box-shadow:none;display:flex;flex-direction:column;margin-top:"," padding:0;&.euiFlyoutHeader{","}"],(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>`padding: ${e.eui.euiSizeS} 0 0 0;`)),Z=s()(a.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-lpvn1k-2"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{overflow:hidden;mask-image:none;}.euiFlyoutBody__overflowContent{padding:0;height:100%;display:flex;}"]),ee=s()(a.EuiFlyoutFooter).withConfig({displayName:"StyledEuiFlyoutFooter",componentId:"sc-lpvn1k-3"})(["background:none;padding:0;&.euiFlyoutFooter{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0 0 0;`)),te=s()(a.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-lpvn1k-4"})(["margin:0;width:100%;overflow:hidden;"]),ie=s()(a.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-lpvn1k-5"})([""," overflow:hidden;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`)),ae=s.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-lpvn1k-6"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade));ae.displayName="VerticalRule";const ne=s()(a.EuiBadge).withConfig({displayName:"EventsCountBadge",componentId:"sc-lpvn1k-7"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),le=[],re=[],oe=[],se=({activeTab:e,columns:t,end:i,eqlOptions:o,expandedDetail:s,timelineId:d,isLive:c,itemsPerPage:w,itemsPerPageOptions:C,onEventClosed:V,renderCellValue:Q,rowRenderers:D,showExpandedDetails:R,start:N,timerangeKind:M})=>{var z;const _=Object(u.useDispatch)(),{query:A="",...$}=o,{portalNode:G}=Object(I.c)(),{setTimelineFullScreen:se,timelineFullScreen:ue}=Object(P.c)(),{browserFields:de,dataViewId:ce,loading:me,runtimeMappings:pe,selectedPatterns:ge}=Object(k.d)(j.SourcererScopeName.timeline),be=Object(W.b)().isEnterprise()?6:5,Ee=Object(n.isEmpty)(A),[ye,{events:fe,inspect:he,totalCount:ve,pageInfo:xe,loadPage:Oe,refreshedAt:Fe,refetch:qe}]=Object(b.a)({dataViewId:ce,endDate:i,eqlOptions:$,fields:[...(Object(n.isEmpty)(t)?E.b:t).map((e=>e.id)),...O.i],filterQuery:null!=A?A:"",id:d,indexNames:ge,language:"eql",limit:w,runtimeMappings:pe,skip:!!(null==me||me||Object(n.isEmpty)(N)||Object(n.isEmpty)(i)||Ee),startDate:N,timerangeKind:M}),Se=Object(l.useCallback)((()=>{var e;V({tabType:x.d.eql,id:d}),null!==(e=s[x.d.eql])&&void 0!==e&&e.panelView&&d===x.c.active&&R&&L.a.toggleExpandedDetail({})}),[V,d,s,R]);Object(l.useEffect)((()=>{_(g.a.updateIsLoading({id:d,isLoading:ye||me}))}),[me,d,ye,_]);const we=Object(l.useMemo)((()=>Object(U.a)(be).map((e=>({...e,headerCellRender:X.a})))),[be]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(m.a,{node:G},ve>=0?r.a.createElement(ne,null,ve):null),r.a.createElement(v.a,{id:`${d}-${x.d.eql}`,inputId:p.a.timeline,inspect:he,loading:ye,refetch:qe}),r.a.createElement(te,null,r.a.createElement(ie,{grow:2},r.a.createElement(Y,{"data-test-subj":`${e}-tab-flyout-header`,hasBorder:!1},r.a.createElement(a.EuiFlexGroup,{className:"euiScrollBar",alignItems:"flexStart",gutterSize:"s","data-test-subj":"timeline-date-picker-container",responsive:!1},ue&&null!=se&&r.a.createElement(F.b,{fullScreen:ue,setFullScreen:se}),r.a.createElement(a.EuiFlexItem,{grow:!1},e===x.d.eql&&r.a.createElement(K.a,{scope:j.SourcererScopeName.timeline})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(q.a,{width:"auto",id:p.a.timeline,timelineId:d})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(T.a,null)))),r.a.createElement(J,{"data-test-subj":"timelineHeader"},r.a.createElement(H,{timelineId:d})),r.a.createElement(S.a,null,r.a.createElement(Z,{"data-test-subj":`${x.d.eql}-tab-flyout-body`,className:"timeline-flyout-body"},r.a.createElement(y.a,{activePage:xe.activePage,browserFields:de,data:Ee?le:fe,id:d,refetch:qe,renderCellValue:Q,rowRenderers:D,sort:re,tabType:x.d.eql,totalPages:Object(h.h)({itemsCount:ve,itemsPerPage:w}),leadingControlColumns:we,trailingControlColumns:oe})),r.a.createElement(ee,{"data-test-subj":`${x.d.eql}-tab-flyout-footer`,className:"timeline-flyout-footer"},!Ee&&r.a.createElement(f.a,{activePage:null!==(z=null==xe?void 0:xe.activePage)&&void 0!==z?z:0,"data-test-subj":"timeline-footer",updatedAt:Fe,height:f.b,id:d,isLive:c,isLoading:ye||me,itemsCount:Ee?0:fe.length,itemsPerPage:w,itemsPerPageOptions:C,onChangePage:Oe,totalCount:Ee?0:ve})))),R&&r.a.createElement(r.a.Fragment,null,r.a.createElement(ae,null),r.a.createElement(ie,{grow:1},r.a.createElement(B.a,{browserFields:de,runtimeMappings:pe,tabType:x.d.eql,scopeId:d,handleOnPanelClosed:Se})))))},ue=Object(u.connect)((()=>{const e=g.b.getTimelineByIdSelector(),t=w.d.getTimelineSelector();return(i,{timelineId:a})=>{var n,l;const r=null!==(n=e(i,a))&&void 0!==n?n:C.b,o=t(i),{activeTab:s,columns:u,eqlOptions:d,expandedDetail:c,itemsPerPage:m,itemsPerPageOptions:p}=r;return{activeTab:s,columns:u,eqlOptions:d,end:o.timerange.to,expandedDetail:c,timelineId:a,isLive:"interval"===o.policy.kind,itemsPerPage:m,itemsPerPageOptions:p,showExpandedDetails:!!c[x.d.eql]&&!(null===(l=c[x.d.eql])||void 0===l||!l.panelView),start:o.timerange.from,timerangeKind:o.timerange.kind}}}),(e=>({onEventClosed:t=>{e(g.a.toggleDetailPanel(t))}})))(r.a.memo(se,((e,t)=>e.activeTab===t.activeTab&&((e,t)=>e.end===t.end&&e.start===t.start&&e.timerangeKind===t.timerangeKind)(e,t)&&c()(e.eqlOptions,t.eqlOptions)&&e.isLive===t.isLive&&e.itemsPerPage===t.itemsPerPage&&e.onEventClosed===t.onEventClosed&&e.showExpandedDetails===t.showExpandedDetails&&e.timelineId===t.timelineId&&c()(e.columns,t.columns)&&c()(e.itemsPerPageOptions,t.itemsPerPageOptions))))},475:function(e,t,i){"use strict";i.d(t,"m",(function(){return n})),i.d(t,"k",(function(){return l})),i.d(t,"l",(function(){return r})),i.d(t,"i",(function(){return o})),i.d(t,"j",(function(){return s})),i.d(t,"h",(function(){return u})),i.d(t,"g",(function(){return d})),i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return m})),i.d(t,"d",(function(){return p})),i.d(t,"c",(function(){return g})),i.d(t,"f",(function(){return b})),i.d(t,"e",(function(){return E}));var a=i(5);const n=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},893:function(e,t,i){"use strict";i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return b})),i.d(t,"c",(function(){return E}));var a=i(9),n=i(231),l=i(110),r=i(307),o=i(3),s=i(54);const u=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,d=e=>Object(a.has)(e,"error.type"),c=e=>e.error.root_cause.filter((e=>u(e.type))).map((e=>e.reason));var m=i(475);let p;!function(e){e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL"}(p||(p={}));const g=(e,t)=>{let i,a=[];return(...n)=>(i&&clearTimeout(i),i=setTimeout((()=>{const t=e(...n);a.forEach((e=>e(t))),a=[]}),t),new Promise((e=>a.push(e))))},b=async(...e)=>{const[{value:t,formData:i}]=e,{query:g}=t,b=g.query,{dataViewId:E,index:y,ruleType:f}=i;if(void 0===f&&!Object(a.isEmpty)(b)||Object(n.b)(f)&&!Object(a.isEmpty)(b))try{const{data:e}=l.b.get();let t=null==y?void 0:y.join(),n={};if(null!=E&&""!==E&&i.dataSourceType===r.a.DataView){const i=await e.dataViews.get(E);t=i.title,n=i.getRuntimeMappings()}const m=(new AbortController).signal,g=await(async({data:e,dataViewTitle:t,query:i,signal:n,runtimeMappings:l})=>{const{rawResponse:r}=await Object(o.firstValueFrom)(e.search.search({params:{index:t,body:{query:i,runtime_mappings:l,size:0}},options:{ignore:[400]}},{strategy:s.EQL_SEARCH_STRATEGY,abortSignal:n}));if((e=>d(e)&&u(Object(a.get)(e,"error.type")))(r))return{valid:!1,errors:c(r)};if(d(r))throw new Error(JSON.stringify(r));return{valid:!0,errors:[]}})({data:e,query:b,signal:m,dataViewTitle:t,runtimeMappings:n});if(!1===(null==g?void 0:g.valid))return{code:p.INVALID_EQL,message:"",messages:g.errors}}catch(e){return{code:p.FAILED_REQUEST,message:m.m,error:e}}},E=e=>{const t=e.errors.length>0,i=!e.isChangingValue&&!t;if(t){const[t]=e.errors,a=t.message;return t.code===p.INVALID_EQL?{isValid:i,message:a,messages:t.messages}:{isValid:i,message:a,error:t.error}}return{isValid:i,message:""}}}}]);