/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[16],{1123:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var i=a(2),n=a(5),s=a(48),l=a(128),r=a(112),o=a(121),c=a(116),u=a(334),d=a(117),m=a(110),p=a(477),b=a(149);const g=()=>{const{indicesExist:e,dataViewId:t}=Object(o.d)(c.SourcererScopeName.detections),{indexFieldsSearch:a}=Object(u.b)(),g=Object(s.useDispatch)(),{addError:y}=Object(d.a)(),f=Object(i.useRef)(new AbortController),{data:{dataViews:E}}=Object(m.i)().services,x=Object(i.useMemo)((()=>l.e.defaultDataViewSelector()),[]),k=Object(i.useMemo)((()=>l.e.signalIndexNameSelector()),[]),w=Object(r.a)(k),S=Object(r.a)(x),h=Object(i.useMemo)((()=>!S.title.includes(`${w}`)),[S.title,w]),j=Object(i.useMemo)((()=>!e&&!h),[e,h]),O=Object(i.useCallback)((()=>{null!==w&&(f.current.abort(),(async()=>{f.current=new AbortController;try{const e=await Object(p.a)({body:{patternList:S.title.split(",")},signal:f.current.signal,dataViewId:t,dataViewService:E});null!==w&&null!=e&&e.defaultDataView.patternList.includes(w)&&(a({dataViewId:e.defaultDataView.id}),g(b.a.setSourcererDataViews(e)))}catch(e){"AbortError"===e.name||y(e,{title:n.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:n.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})})}})())}),[y,t,E,S.title,g,a,w]);return{...j?{pollForSignalIndex:O}:{},signalIndexNeedsInit:h}}},1321:function(e,t,a){"use strict";a.d(t,"a",(function(){return Be}));var i=a(17),n=a(2),s=a.n(n),l=a(48),r=a(5);const o=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutTitle",{defaultMessage:"Data view cannot be modified on this page"}),c=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTitle",{defaultMessage:"This timeline uses a legacy data view selector"}),u=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutDeprecxatedTemplateTitle",{defaultMessage:"This timeline template uses a legacy data view selector"}),d=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTitle",{defaultMessage:"This timeline is out of date with the Security Data View"}),m=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutMissingPatternsTemplateTitle",{defaultMessage:"This timeline template is out of date with the Security Data View"}),p=r.i18n.translate("xpack.securitySolution.indexPatterns.callOutTimelineTitle",{defaultMessage:"Data view cannot be modified when show only detection alerts is selected"}),b=r.i18n.translate("xpack.securitySolution.indexPatterns.toggleToNewSourcerer.link",{defaultMessage:"here"}),g=r.i18n.translate("xpack.securitySolution.indexPatterns.dataViewLabel",{defaultMessage:"Data view"}),y=r.i18n.translate("xpack.securitySolution.indexPatterns.updateDataView",{defaultMessage:"Would you like to add this index pattern to Security Data View? Otherwise, we can recreate the data view without the missing index patterns."}),f=r.i18n.translate("xpack.securitySolution.indexPatterns.updateSecurityDataView",{defaultMessage:"Update Security Data View"}),E=r.i18n.translate("xpack.securitySolution.indexPatterns.continue",{defaultMessage:"Continue without adding"}),x=r.i18n.translate("xpack.securitySolution.indexPatterns.add",{defaultMessage:"Add index pattern"}),k=r.i18n.translate("xpack.securitySolution.indexPatterns.modifiedBadgeTitle",{defaultMessage:"Modified"}),w=r.i18n.translate("xpack.securitySolution.indexPatterns.alertsBadgeTitle",{defaultMessage:"Alerts"}),S=r.i18n.translate("xpack.securitySolution.indexPatterns.updateAvailableBadgeTitle",{defaultMessage:"Update available"}),h=r.i18n.translate("xpack.securitySolution.indexPatterns.securityDefaultDataViewLabel",{defaultMessage:"Security Default Data View"}),j=r.i18n.translate("xpack.securitySolution.indexPatterns.securityDataViewLabel",{defaultMessage:"Security Data View"}),O=r.i18n.translate("xpack.securitySolution.indexPatterns.selectDataView",{defaultMessage:"Data view selection"}),P=r.i18n.translate("xpack.securitySolution.indexPatterns.save",{defaultMessage:"Save"}),v=r.i18n.translate("xpack.securitySolution.indexPatterns.chooseDataViewLabel",{defaultMessage:"Choose data view"}),M=r.i18n.translate("xpack.securitySolution.indexPatterns.advancedOptionsTitle",{defaultMessage:"Advanced options"}),C=r.i18n.translate("xpack.securitySolution.indexPatterns.indexPatternsLabel",{defaultMessage:"Index patterns"}),D=r.i18n.translate("xpack.securitySolution.indexPatterns.descriptionsLabel",{defaultMessage:"These are the index patterns currently selected. Filtering out index patterns from your data view can help improve overall performance."}),T=r.i18n.translate("xpack.securitySolution.sourcerer.disabled",{defaultMessage:"The updates to the Data view require a page reload to take effect."}),I=r.i18n.translate("xpack.securitySolution.indexPatterns.update",{defaultMessage:"Update and recreate data view"}),V=r.i18n.translate("xpack.securitySolution.indexPatterns.resetButton",{defaultMessage:"Reset"}),N=r.i18n.translate("xpack.securitySolution.indexPatterns.closeButton",{defaultMessage:"Close"}),F=r.i18n.translate("xpack.securitySolution.indexPatterns.inactive",{defaultMessage:"Inactive index patterns"}),B=r.i18n.translate("xpack.securitySolution.indexPatterns.noData",{defaultMessage:"The index pattern on this timeline doesn't match any data streams, indices, or index aliases."}),L=r.i18n.translate("xpack.securitySolution.indexPatterns.pickIndexPatternsCombo",{defaultMessage:"Pick index patterns"}),R=r.i18n.translate("xpack.securitySolution.indexPatterns.onlyDetectionAlertsLabel",{defaultMessage:"Show only detection alerts"}),z=r.i18n.translate("xpack.securitySolution.indexPatterns.successToastTitle",{defaultMessage:"One or more settings require you to reload the page to take effect"}),A=r.i18n.translate("xpack.securitySolution.indexPatterns.reloadPageTitle",{defaultMessage:"Reload page"}),U=r.i18n.translate("xpack.securitySolution.indexPatterns.failureToastTitle",{defaultMessage:"Unable to update data view"});var q=a(149),W=a(112),$=a(116),_=a(392),Y=a(44),G=a.n(Y),H=a(55);const K=G()(i.EuiFormRow).withConfig({displayName:"FormRow",componentId:"sc-1x3qwn3-0"})(["display:",";max-width:none;"],(({$expandAdvancedOptions:e})=>e?"flex":"none")),Q=G()(i.EuiFormRow).withConfig({displayName:"StyledFormRow",componentId:"sc-1x3qwn3-1"})(["max-width:none;"]),X=G()(i.EuiButtonEmpty).withConfig({displayName:"StyledButtonEmpty",componentId:"sc-1x3qwn3-2"})(["&:enabled:focus,&:focus{background-color:transparent;}"]),J=G()(i.EuiButtonEmpty).withConfig({displayName:"ResetButton",componentId:"sc-1x3qwn3-3"})(["width:fit-content;&:enabled:focus,&:focus{background-color:transparent;}"]),Z=G.a.div.withConfig({displayName:"PopoverContent",componentId:"sc-1x3qwn3-4"})(["width:600px;"]),ee=G()(i.EuiBadge).withConfig({displayName:"StyledBadge",componentId:"sc-1x3qwn3-5"})(["margin-left:",";&,.euiBadge__text{cursor:pointer;}"],H.euiThemeVars.euiSizeXS),te=G.a.span.withConfig({displayName:"Blockquote",componentId:"sc-1x3qwn3-6"})(["",""],(({theme:e})=>Object(Y.css)(["display:block;border-color:",";border-left:",";margin:"," 0 "," ",";padding:",";"],e.eui.euiColorDarkShade,e.eui.euiBorderThick,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS,e.eui.euiSizeS))),ae=(e,t)=>e.filter((e=>e!==t));var ie=a(295),ne=a(110),se=a(554);const le=(e,t)=>Object(ie.b)(e).map((e=>({label:e,value:e,...null!=t?{disabled:!t.includes(e)}:{}})));var re=a(47);const oe=G()(i.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-1e562tk-0"})([".euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]),ce=s.a.memo((({isShowing:e,onDismissModal:t,onContinue:a,onUpdate:n,missingPatterns:l})=>e?s.a.createElement(oe,{onClose:t,"data-test-subj":"sourcerer-update-data-view-modal"},s.a.createElement(i.EuiModalHeader,null,s.a.createElement(i.EuiModalHeaderTitle,null,f)),s.a.createElement(i.EuiModalBody,null,s.a.createElement(i.EuiText,{size:"s"},s.a.createElement(i.EuiTextColor,{color:"subdued"},s.a.createElement("p",null,s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns",defaultMessage:"Security Data View is missing the following index patterns in order to recreate the previous timeline's data view: {callout}",values:{callout:s.a.createElement(te,null,l.join(", "))}}),y))),s.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(J,{"aria-label":E,"data-test-subj":"sourcerer-continue-close",flush:"left",onClick:a,title:E},E)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{"data-test-subj":"sourcerer-update-data-view",fill:!0,fullWidth:!0,onClick:n,size:"s"},x))))):null));ce.displayName="UpdateDefaultDataViewModal";var ue=a(151),de=a(113),me=a(118),pe=a(134);const be=({activePatterns:e,deadPatterns:t,selectedPatterns:a,timelineType:l})=>{const r=Object(n.useMemo)((()=>t.length>0?s.a.createElement(i.EuiToolTip,{content:s.a.createElement(ge,{activePatterns:e,selectedPatterns:a,timelineType:l})},s.a.createElement(i.EuiIcon,{type:"questionInCircle",title:F})):null),[e,t.length,a,l]);return l===de.l.template?s.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatterns",defaultMessage:"The active index patterns in this timeline template are{tooltip}: {callout}",values:{tooltip:r,callout:s.a.createElement(te,null,e.join(", "))}})):s.a.createElement("span",{"data-test-subj":"sourcerer-current-patterns-message"},s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatterns",defaultMessage:"The active index patterns in this timeline are{tooltip}: {callout}",values:{tooltip:r,callout:s.a.createElement(te,null,e.join(", "))}}))},ge=({activePatterns:e,selectedPatterns:t,timelineType:a})=>{const i=Object(n.useMemo)((()=>t.filter((t=>!e.includes(t))).join(", ")),[e,t]);return a===de.l.template?s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.noMatchData",defaultMessage:"The following index patterns are saved to this timeline template but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:i}}):s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.noMatchData",defaultMessage:"The following index patterns are saved to this timeline but do not match any data streams, indices, or index aliases: {aliases}",values:{aliases:i}})},ye=({timelineType:e,selectedPatterns:t})=>{const a=Object(n.useMemo)((()=>s.a.createElement(te,null,t.join(", "))),[t]);return e===de.l.template?s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.currentPatternsBad",defaultMessage:"The current index patterns in this timeline template are: {callout}",values:{callout:a}}):s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.currentPatternsBad",defaultMessage:"The current index patterns in this timeline are: {callout}",values:{callout:a}})},fe=({onReset:e,timelineType:t})=>t===de.l.template?s.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timelineTemplate.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:s.a.createElement(i.EuiLink,{onClick:e},b)}})):s.a.createElement("span",{"data-test-subj":"sourcerer-deprecated-message"},s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.timeline.toggleToNewSourcerer",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can recreate your temporary data view with the new data view selector. You can also manually select a data view {link}.",values:{link:s.a.createElement(i.EuiLink,{onClick:e},b)}})),Ee=({onReset:e,timelineType:t})=>t===de.l.template?s.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timelineTemplate.description",defaultMessage:"We have preserved your timeline template by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:s.a.createElement(i.EuiLink,{onClick:e},b)}})):s.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-message"},s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.timeline.description",defaultMessage:"We have preserved your timeline by creating a temporary data view. If you'd like to modify your data, we can add the missing index patterns to the Security Data View. You can also manually select a data view {link}.",values:{link:s.a.createElement(i.EuiLink,{onClick:e},b)}})),xe={deprecated:{title:{[de.l.default]:c,[de.l.template]:u},update:I},missingPatterns:{title:{[de.l.default]:d,[de.l.template]:m},update:x}},ke=s.a.memo((({activePatterns:e,indicesExist:t,isModified:a,onDismiss:l,onReset:r,onUpdate:o,selectedPatterns:c,missingPatterns:u})=>{const d=Object(n.useMemo)((()=>s.a.createElement(i.EuiButton,{"data-test-subj":"sourcerer-deprecated-update",fill:!0,fullWidth:!0,onClick:o,size:"s",disabled:!t},xe[a].update)),[t,a,o]),m=Object(n.useMemo)((()=>t?d:s.a.createElement(i.EuiToolTip,{position:"top",content:B,"data-test-subj":"sourcerer-tooltip"},d)),[t,d]),p=e&&e.length>0?c.filter((t=>!e.includes(t))):[],b=Object(n.useMemo)((()=>me.b.getTimelineByIdSelector()),[]),g=Object(W.a)((e=>{var t;return(null!==(t=b(e,ue.f.active))&&void 0!==t?t:pe.b).timelineType}));return s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiCallOut,{color:"warning","data-test-subj":"sourcerer-deprecated-callout",iconType:"warning",size:"s",title:xe[a].title[g]}),s.a.createElement(i.EuiSpacer,{size:"s"}),s.a.createElement(i.EuiText,{size:"s"},s.a.createElement(i.EuiTextColor,{color:"subdued"},s.a.createElement("p",null,e&&e.length>0?s.a.createElement(be,{timelineType:g,activePatterns:e,deadPatterns:p,selectedPatterns:c}):s.a.createElement(ye,{timelineType:g,selectedPatterns:c}),"deprecated"===a&&s.a.createElement(fe,{timelineType:g,onReset:r}),"missingPatterns"===a&&s.a.createElement(s.a.Fragment,null,s.a.createElement("span",{"data-test-subj":"sourcerer-missing-patterns-callout"},s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.missingPatterns.callout",defaultMessage:"Security Data View is missing the following index patterns: {callout}",values:{callout:s.a.createElement(te,null,u.join(", "))}})),s.a.createElement(Ee,{timelineType:g,onReset:r}))))),s.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(J,{"aria-label":N,"data-test-subj":"sourcerer-deprecated-close",flush:"left",onClick:l,title:N},N)),s.a.createElement(i.EuiFlexItem,{grow:!1},m)))}));ke.displayName="TemporarySourcererComp";const we=s.a.memo((({activePatterns:e,indicesExist:t,isModified:a,missingPatterns:i,onContinueWithoutUpdate:n,onDismiss:l,onReset:r,onUpdateStepOne:o,onUpdateStepTwo:c,selectedPatterns:u,isShowingUpdateModal:d,onDismissModal:m})=>s.a.createElement(s.a.Fragment,null,s.a.createElement(ke,{activePatterns:e,indicesExist:t,isModified:a,missingPatterns:i,onDismiss:l,onReset:r,onUpdate:o,selectedPatterns:u}),s.a.createElement(ce,{isShowing:d,missingPatterns:i,onDismissModal:m,onContinue:n,onUpdate:c}))));we.displayName="TemporarySourcerer";var Se=a(121),he=a(63),je=a(4);const Oe=G()(i.EuiButton).withConfig({displayName:"StyledRefreshButton",componentId:"sc-nuholq-0"})(["float:right;"]),Pe=s.a.memo((()=>{const e=Object(n.useCallback)((()=>{document.location.reload()}),[]);return s.a.createElement(Oe,{onClick:e,"data-test-subj":"page-refresh"},A)}));Pe.displayName="RefreshButton";var ve=a(117);const Me=({activePatterns:e,disabled:t,isModified:a,isOnlyDetectionAlerts:l,isPopoverOpen:r,isTimelineSourcerer:o,loading:c,onClick:u,selectedPatterns:d,signalIndexName:m})=>{const p=Object(n.useMemo)((()=>{switch(a){case"modified":return s.a.createElement(ee,{"data-test-subj":"sourcerer-modified-badge"},k);case"alerts":return s.a.createElement(ee,{"data-test-subj":"sourcerer-alerts-badge"},w);case"deprecated":return s.a.createElement(ee,{color:"warning","data-test-subj":"sourcerer-deprecated-badge"},S);case"missingPatterns":return s.a.createElement(ee,{color:"warning","data-test-subj":"sourcerer-missingPatterns-badge"},S);default:return null}}),[a]),b=Object(n.useMemo)((()=>o?i.EuiButton:X),[o]),y=Object(n.useMemo)((()=>s.a.createElement(b,{"aria-label":g,"data-test-subj":o?"timeline-sourcerer-trigger":"sourcerer-trigger",color:"primary",iconSide:"right",iconType:"arrowDown",disabled:t,isLoading:c,onClick:u,title:g},g,!t&&p)),[t,p,o,c,u,b]),f=Object(n.useMemo)((()=>t?T:(({isOnlyDetectionAlerts:e,isPopoverOpen:t,selectedPatterns:a,signalIndexName:i})=>t||e&&!i?null:(e?[i]:a).join(", "))({isOnlyDetectionAlerts:l,isPopoverOpen:r,selectedPatterns:null!=e?e:d,signalIndexName:m})),[e,t,l,r,d,m]);return f?s.a.createElement(i.EuiToolTip,{position:"top",content:f,"data-test-subj":"sourcerer-tooltip"},y):y},Ce=Object(n.memo)(Me),De=s.a.memo((({isOnlyDetectionAlerts:e,title:t})=>e?s.a.createElement(i.EuiCallOut,{"data-test-subj":"sourcerer-callout",iconType:"iInCircle",size:"s",title:t}):null));De.displayName="SourcererCallout";const Te=s.a.memo((({onChange:e,checked:t,isShow:a})=>a?s.a.createElement(Q,null,s.a.createElement(i.EuiCheckbox,{checked:t,"data-test-subj":"sourcerer-alert-only-checkbox",id:"sourcerer-alert-only-checkbox",label:R,onChange:e})):null));Te.displayName="AlertsCheckbox";const Ie=s.a.memo((({disableSave:e,isShow:t,onReset:a,onSave:n})=>t?s.a.createElement(Q,null,s.a.createElement(i.EuiFlexGroup,{alignItems:"center",justifyContent:"flexEnd"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(J,{"aria-label":V,"data-test-subj":"sourcerer-reset",flush:"left",onClick:a,title:V},V)),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{onClick:n,disabled:e,"data-test-subj":"sourcerer-save",fill:!0,fullWidth:!0,size:"s"},P)))):null));Ie.displayName="SaveButtons";var Ve=a(1123),Ne=a(157),Fe=a(218);const Be=s.a.memo((({scope:e})=>{const t=Object(l.useDispatch)(),a=e===$.SourcererScopeName.detections,r=e===$.SourcererScopeName.timeline,c=e===$.SourcererScopeName.default,u=Object(Ne.d)(Fe.a.sourcerer),d=Object(n.useMemo)((()=>q.d.getSourcererScopeSelector()),[]),{defaultDataView:m,kibanaDataViews:g,signalIndexName:y,sourcererScope:{selectedDataViewId:f,selectedPatterns:E,missingPatterns:x}}=Object(W.a)((t=>d(t,e))),{pollForSignalIndex:S}=Object(Ve.a)();Object(n.useEffect)((()=>{null!=S&&(r||a)&&S()}),[a,r,S]);const{activePatterns:P,indicesExist:T,loading:I}=Object(Se.d)(e),[V,N]=Object(n.useState)(P&&P.length>0?x.filter((e=>P.includes(e))):[]);Object(n.useEffect)((()=>{P&&P.length>0&&N(x.filter((e=>P.includes(e))))}),[P,x]);const[F,B]=Object(n.useState)(r&&E.join()===y),R=Object(n.useCallback)((()=>{B(r&&E.join()===y)}),[r,E,y]);Object(n.useEffect)((()=>{R()}),[E]);const A=a||r&&F,[Y,G]=Object(n.useState)(!1),[H,J]=Object(n.useState)(f),{allOptions:te,dataViewSelectOptions:oe,loadingIndexPatterns:ce,isModified:ue,handleOutsideClick:de,onChangeCombo:me,renderOption:pe,selectedOptions:be,setIndexPatternsByDataView:ge}=(({dataViewId:e,defaultDataViewId:t,isOnlyDetectionAlerts:a,kibanaDataViews:r,missingPatterns:o,scopeId:c,selectedDataViewId:u,selectedPatterns:d,signalIndexName:m})=>{const p=Object(l.useDispatch)(),{data:{dataViews:b}}=Object(ne.i)().services,g=Object(n.useRef)(!0),[y,f]=Object(n.useState)(!1),E=Object(n.useMemo)((()=>m?le([m]):[]),[m]),[x,S]=Object(n.useState)(a?E:le(d)),[O,P]=Object(n.useState)(null==e?"deprecated":o.length>0?"missingPatterns":""),{allPatterns:v,selectablePatterns:M}=Object(n.useMemo)((()=>{if(a&&m)return{allPatterns:[m],selectablePatterns:[m]};const t=r.find((t=>t.id===e));if(null==t)return{allPatterns:[],selectablePatterns:[]};const i=[...new Set(t.title.split(","))];return c===q.b.SourcererScopeName.default?{allPatterns:ae(i,m),selectablePatterns:ae(t.patternList,m)}:{allPatterns:i,selectablePatterns:t.patternList}}),[e,a,r,c,m]),C=Object(n.useMemo)((()=>le(v,M)),[v,M]),D=Object(n.useCallback)(((e,a=!1)=>c===$.SourcererScopeName.detections||a?E:le(Object(_.b)(r.find((t=>t.id===e)),c,m,e===t))),[E,r,c,m,t]),T=Object(n.useMemo)((()=>null!=e?D(e):[]),[e,D]),I=Object(n.useCallback)(((e,t)=>{if(null==t)return P("deprecated");if(o.length>0)return P("missingPatterns");if(a)return P("alerts");const i=T.length!==e.length||!T.every((t=>e.find((e=>t.value===e))));return P(i?"modified":"")}),[T,a,o.length]);Object(n.useEffect)((()=>{S(c===$.SourcererScopeName.detections?E:le(d))}),[d,c]),Object(n.useEffect)((()=>{I(d.map((e=>e)),u)}),[a,u,o,c,d]);const V=Object(n.useCallback)((e=>{S(e)}),[]),N=Object(n.useCallback)((({value:e})=>s.a.createElement("span",{"data-test-subj":"sourcerer-combo-option"},e)),[]),F=Object(n.useCallback)((async(e,t)=>{if(r.some((t=>t.id===e&&0===t.indexFields.length))){try{f(!0),S([]);const t=await Object(se.a)(e,b);g.current&&(p(q.a.setDataView(t)),S(a?E:le(t.patternList)))}catch(e){}f(!1)}else S(D(e,t))}),[E,p,D,a,r,b]),B=Object(n.useMemo)((()=>null!=e?(({dataViewId:e,defaultDataViewId:t,isModified:a,isOnlyDetectionAlerts:n,kibanaDataViews:l})=>n?[{inputDisplay:s.a.createElement("span",{"data-test-subj":"security-alerts-option-super"},s.a.createElement(i.EuiIcon,{type:"logoSecurity",size:"s"})," ",j,s.a.createElement(ee,{"data-test-subj":"security-alerts-option-badge"},w)),value:t}]:l.map((({title:n,id:l})=>({inputDisplay:l===t?s.a.createElement("span",{"data-test-subj":"security-option-super"},s.a.createElement(i.EuiIcon,{type:"logoSecurity",size:"s"})," ",h,a&&l===e&&s.a.createElement(ee,{"data-test-subj":"security-modified-option-badge"},k)):s.a.createElement("span",{"data-test-subj":"dataView-option-super"},s.a.createElement(i.EuiIcon,{type:"logoKibana",size:"s"})," ",n,a&&l===e&&s.a.createElement(ee,{"data-test-subj":"security-modified-option-badge"},k)),value:l}))))({dataViewId:e,defaultDataViewId:t,isModified:"modified"===O,isOnlyDetectionAlerts:a,kibanaDataViews:r}):[]),[e,t,O,a,r]);return Object(n.useEffect)((()=>(g.current=!0,()=>{g.current=!1})),[]),{allOptions:C,dataViewSelectOptions:B,loadingIndexPatterns:y,handleOutsideClick:Object(n.useCallback)((()=>{S(le(d))}),[d]),isModified:O,onChangeCombo:V,renderOption:N,selectedOptions:x,setIndexPatternsByDataView:F}})({dataViewId:H,defaultDataViewId:m.id,isOnlyDetectionAlerts:A,kibanaDataViews:g,missingPatterns:V,scopeId:e,selectedDataViewId:f,selectedPatterns:E,signalIndexName:y}),ye=Object(n.useCallback)((e=>{B(e.target.checked),J(m.id),ge(m.id,e.target.checked)}),[m.id,ge]),[fe,Ee]=Object(n.useState)(!1),[xe,ke]=Object(n.useState)(!1),Oe=Object(n.useCallback)((()=>{G((e=>!e)),Ee(!1)}),[]),Me=Object(n.useCallback)(((a,i,n)=>{t(q.a.setSelectedDataView({id:e,selectedDataViewId:a,selectedPatterns:i,shouldValidateSelectedPatterns:n})),c&&u({[$.SourcererScopeName.default]:{id:a,selectedPatterns:i}})}),[t,e,c,u]),Be=Object(n.useCallback)((e=>{J(e),ge(e)}),[ge]),Le=Object(n.useCallback)((()=>{J(m.id),ge(m.id),B(!1),N([])}),[m.id,ge]),Re=Object(n.useCallback)((()=>{const e=be.map((e=>e.label));null!=H&&Me(H,e),G(!1)}),[Me,H,be]),ze=Object(n.useCallback)((()=>{G(!1),Ee(!1)}),[]),Ae=Object(n.useCallback)((()=>{ke(!1);const e=E.filter((e=>m.patternList.includes(e)));Me(m.id,e),G(!1)}),[m.id,m.patternList,Me,E]),Ue=Object(n.useCallback)((()=>{0===V.length?Ae():ke(!0)}),[V,Ae]),[qe,We]=Object(n.useState)(!1),$e=(e=>{const{theme:t,uiSettings:a}=Object(ne.i)().services,{addSuccess:l,addError:r}=Object(ve.a)();return Object(n.useCallback)((async n=>{const[o,c]=await(async()=>{try{const e=[...a.get(je.I),...n];return[await a.set(je.I,Object(ie.a)(e)),null]}catch(e){return[!1,e]}})();return o?(l({color:"success",title:Object(he.toMountPoint)(z,{theme$:t.theme$}),text:Object(he.toMountPoint)(s.a.createElement(Pe,null),{theme$:t.theme$}),iconType:void 0,toastLifeTimeMs:6e5}),!0):(r(null!==c?c:new Error(U),{title:U,toastMessage:s.a.createElement(s.a.Fragment,null,s.a.createElement(re.FormattedMessage,{id:"xpack.securitySolution.indexPatterns.failureToastText",defaultMessage:"Unexpected error occurred on update. If you would like to modify your data, you can manually select a data view {link}.",values:{link:s.a.createElement(i.EuiLink,{onClick:e,"data-test-subj":"failureToastLink"},b)}}))}),!1)}),[r,l,e,t.theme$,a])})(Object(n.useCallback)((()=>{G(!0),Le()}),[Le])),_e=Object(n.useCallback)((async()=>{const e=await $e(V);ke(!1),G(!1),e&&(Me(m.id,null!=P?P:E,!1),We(!0))}),[P,m.id,V,Me,E,$e]);Object(n.useEffect)((()=>{J(f)}),[f]);const Ye=Object(n.useCallback)((()=>{J(f),N(x),R(),de()}),[de,R,f,x]),Ge=Object(n.useCallback)((()=>{Ee((e=>!e))}),[]);return T||e===$.SourcererScopeName.timeline?s.a.createElement(i.EuiPopover,{panelClassName:"sourcererPopoverPanel",button:s.a.createElement(Ce,{activePatterns:P,disabled:qe,isModified:ue,isOnlyDetectionAlerts:A,isPopoverOpen:Y,isTimelineSourcerer:r,loading:I,onClick:Oe,selectedPatterns:E,signalIndexName:y}),closePopover:ze,"data-test-subj":r?"timeline-sourcerer-popover":"sourcerer-popover",display:"block",isOpen:Y,ownFocus:!0,repositionOnScroll:!0},s.a.createElement(i.EuiOutsideClickDetector,{onOutsideClick:Ye},s.a.createElement(Z,null,s.a.createElement(i.EuiPopoverTitle,{"data-test-subj":"sourcerer-title"},s.a.createElement(s.a.Fragment,null,O)),s.a.createElement(De,{isOnlyDetectionAlerts:A,title:r?p:o}),s.a.createElement(i.EuiSpacer,{size:"s"}),null===H&&"deprecated"===ue||"missingPatterns"===ue?s.a.createElement(we,{activePatterns:P,indicesExist:T,isModified:ue,isShowingUpdateModal:xe,missingPatterns:V,onContinueWithoutUpdate:Ae,onDismiss:Oe,onDismissModal:()=>ke(!1),onReset:Le,onUpdateStepOne:"deprecated"===ue?Ue:_e,onUpdateStepTwo:_e,selectedPatterns:E}):s.a.createElement(i.EuiForm,{component:"form"},s.a.createElement(s.a.Fragment,null,s.a.createElement(Te,{isShow:r,checked:F,onChange:ye}),H&&s.a.createElement(Q,{label:v},s.a.createElement(i.EuiSuperSelect,{"data-test-subj":"sourcerer-select",isLoading:ce,disabled:A,fullWidth:!0,onChange:Be,options:oe,placeholder:v,valueOfSelected:H})),s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(X,{color:"text","data-test-subj":"sourcerer-advanced-options-toggle",iconType:fe?"arrowDown":"arrowRight",onClick:Ge},M),fe&&s.a.createElement(i.EuiSpacer,{size:"m"}),s.a.createElement(K,{isDisabled:ce,$expandAdvancedOptions:fe,helpText:A?void 0:D,label:C},s.a.createElement(i.EuiComboBox,{"data-test-subj":"sourcerer-combo-box",fullWidth:!0,isDisabled:A||ce,onChange:me,options:te,placeholder:L,renderOption:pe,selectedOptions:be})),s.a.createElement(Ie,{disableSave:0===be.length,isShow:!a,onReset:Le,onSave:Re})),s.a.createElement(i.EuiSpacer,{size:"s"}))))):null}));Be.displayName="Sourcerer"},1517:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var i=a(2),n=a.n(i),s=a(48),l=a(181);const r=({id:e,inputId:t,inspect:a,loading:n,refetch:r,skip:o})=>{const c=Object(s.useDispatch)();return Object(i.useEffect)((()=>{o||c(l.c.setQuery({id:e,inputId:t,inspect:a,loading:n,refetch:r}))}),[c,e,t,n,r,a,o]),null},o=n.a.memo(r)},1555:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var i=a(17),n=a(2),s=a.n(n),l=a(48),r=a(119),o=a(138),c=a(112),u=a(5);const d=u.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerTooltip",{defaultMessage:"Click to disable syncing of query time range with the current page’s time range"}),m=u.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerTooltip",{defaultMessage:"Click to sync the query time range with the current page’s time range."}),p=u.i18n.translate("xpack.securitySolution.timeline.properties.lockDatePickerDescription",{defaultMessage:"Lock global date picker to timeline date picker"}),b=u.i18n.translate("xpack.securitySolution.timeline.properties.unlockDatePickerDescription",{defaultMessage:"Unlock global date picker from timeline date picker"}),g=()=>{const e=Object(l.useDispatch)(),t=Object(n.useMemo)((()=>o.d.globalSelector()),[]),a=Object(c.b)((e=>t(e).linkTo.includes(r.a.timeline))),u=Object(n.useCallback)((()=>e(o.b.toggleTimelineLinkTo())),[e]);return s.a.createElement(i.EuiToolTip,{"data-test-subj":"timeline-date-picker-lock-tooltip",position:"top",content:a?d:m},s.a.createElement(i.EuiButtonIcon,{"data-test-subj":`timeline-date-picker-${a?"lock":"unlock"}-button`,color:"primary",size:"m",onClick:u,iconType:a?"lock":"lockOpen",display:a?"fill":"base","aria-label":a?b:p}))};g.displayName="TimelineDatePickerLockComponent";const y=s.a.memo(g)}}]);