/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[7],{1059:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(117),i=a(1060),r=a(557);const l=(e,t=!0)=>{const{addError:a}=Object(n.a)();return Object(i.a)(e,t?{onError:e=>{a(e,{title:r.b})}}:void 0)}},1060:function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return m}));var n=a(50),i=a(2),r=a(4),l=a(765),s=a(163),o=a(337);const u=["GET",r.jb],c=(e,t)=>Object(n.useQuery)([...u,e],(async({signal:t})=>{const a=await Object(s.h)({signal:t,id:e});return Object(l.a)(a)}),{...o.a,...t,staleTime:0,enabled:!!e}),d=()=>{const e=Object(n.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(u,{refetchType:"active"})}),[e])},m=()=>{const e=Object(n.useQueryClient)();return Object(i.useCallback)((t=>{e.setQueryData([...u,t.id],Object(l.a)(t))}),[e])}},1061:function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(55),i=a(125),r=a(668);const l=[i.x.unknown,i.x.low,i.x.moderate,i.x.high,i.x.critical],s={[i.x.unknown]:n.euiLightVars.euiColorMediumShade,[i.x.low]:r.b.low,[i.x.moderate]:r.b.medium,[i.x.high]:r.b.high,[i.x.critical]:r.b.critical},o={[i.x.unknown]:{start:0,stop:20},[i.x.low]:{start:20,stop:40},[i.x.moderate]:{start:40,stop:70},[i.x.high]:{start:70,stop:90},[i.x.critical]:{start:90,stop:100}}},1066:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2);const i=Object(n.createContext)(null)},1067:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a.n(n),r=a(17);const l=Object(n.memo)((({children:e,...t})=>i.a.createElement(r.EuiFlyoutBody,t,i.a.createElement(r.EuiPanel,{hasShadow:!1,color:"transparent"},e))));l.displayName="FlyoutBody"},1080:function(e,t,a){"use strict";a.d(t,"a",(function(){return le}));var n=a(17),i=a(45),r=a(2),l=a.n(r),s=a(566),o=a(1167),u=a(895),c=a(272),d=a(166),m=a(1367),b=a(1101),g=a(126),f=a(155),p=a(48),y=a(136),v=a.n(y),E=a(1066),h=a(127),j=a(245),O=a(544),k=a(174),x=a(1489),S=a(153),I=a(564),T=a(122),M=a(282),F=a(137);const A=({contextId:e,eventId:t,fieldName:a,address:n})=>`formatted-ip-data-provider-${e}-${a}-${n}-${t}`,w=({contextId:e,eventId:t,fieldName:a,address:n})=>({enabled:!0,id:Object(k.i)(A({contextId:e,eventId:t,fieldName:a,address:n})),name:`${a}: ${Object(x.a)(n)}`,queryMatch:{field:a,value:Object(x.a)(n),operator:S.d},excluded:!1,kqlQuery:"",and:[]}),C=({contextId:e,eventId:t,fieldName:a,fieldType:n,isAggregatable:i,isDraggable:s,truncate:o,value:u})=>{const c=Object(r.useMemo)((()=>`non-decorated-ip-draggable-wrapper-${A({contextId:e,eventId:t,fieldName:a,address:u})}`),[e,t,a,u]),d=Object(r.useMemo)((()=>w({contextId:e,eventId:t,fieldName:a,address:u})),[e,t,a,u]),m=Object(r.useMemo)((()=>"object"!=typeof u?Object(g.f)(u):Object(g.f)((e=>{try{return JSON.stringify(e)}catch(t){return`${e}`}})(u))),[u]),b=Object(r.useCallback)(((e,t,a)=>a.isDragging?l.a.createElement(O.a,null,l.a.createElement(I.a,{dataProvider:e})):m),[m]);return s?l.a.createElement(O.b,{dataProvider:d,fieldType:n,isAggregatable:i,isDraggable:s,key:c,render:b,truncate:o}):m},D=l.a.memo(C),N=({address:e,Component:t,contextId:a,eventId:n,fieldName:i,fieldType:s,isAggregatable:o,isButton:u,isDraggable:c,onClick:m,truncate:b,title:g})=>{const f=`address-links-draggable-wrapper-${A({contextId:a,eventId:n,fieldName:i,address:e})}`,y=Object(r.useMemo)((()=>w({contextId:a,eventId:n,fieldName:i,address:e})),[e,a,n,i]),v=Object(p.useDispatch)(),k=Object(r.useContext)(E.a),x=e&&(null==k?void 0:k.enableIpDetailsFlyout)&&(null==k?void 0:k.timelineID),S=Object(r.useCallback)((t=>{if(t.preventDefault(),m&&m(),k&&x){const{tabType:t,timelineID:a}=k,n={panelView:"networkDetail",params:{ip:e,flowTarget:i.includes(j.b.destination)?j.b.destination:j.b.source}},r=Object(h.getScopedActions)(a);r&&v(r.toggleDetailPanel({...n,id:a,tabType:t})),a===T.c.active&&t===T.d.query&&M.a.toggleExpandedDetail({...n})}}),[m,k,x,e,i,v]),C=Object(r.useMemo)((()=>t?l.a.createElement(F.h,{Component:t,ip:e,isButton:u,onClick:x?S:void 0,title:g}):l.a.createElement(d.a,{field:i,tooltipContent:i},l.a.createElement(F.h,{Component:t,ip:e,isButton:u,onClick:x?S:void 0,title:g}))),[t,e,i,u,x,S,g]),D=Object(r.useCallback)(((e,t,a)=>a.isDragging?l.a.createElement(O.a,null,l.a.createElement(I.a,{dataProvider:y})):C),[y,C]);return c?l.a.createElement(O.b,{dataProvider:y,isDraggable:c,fieldType:s,isAggregatable:o,key:f,render:D,truncate:b}):C},_=l.a.memo(N),$=({addresses:e,Component:t,contextId:a,eventId:n,fieldName:s,fieldType:o,isAggregatable:u,isButton:c,isDraggable:d,onClick:m,truncate:b,title:g})=>{const f=Object(r.useMemo)((()=>Object(i.uniq)(e)),[e]),p=Object(r.useMemo)((()=>f.map((e=>l.a.createElement(_,{key:e,address:e,Component:t,contextId:a,eventId:n,fieldName:s,fieldType:o,isAggregatable:u,isButton:c,isDraggable:d,onClick:m,truncate:b,title:g})))),[t,a,n,s,o,u,c,d,m,g,b,f]);return l.a.createElement(l.a.Fragment,null,p)},L=l.a.memo($,((e,t)=>e.contextId===t.contextId&&e.eventId===t.eventId&&e.fieldName===t.fieldName&&e.isAggregatable===t.isAggregatable&&e.fieldType===t.fieldType&&e.isDraggable===t.isDraggable&&e.truncate===t.truncate&&v()(e.addresses,t.addresses))),P=({Component:e,contextId:t,eventId:a,fieldName:n,fieldType:r,isAggregatable:s,isDraggable:o,isButton:u,onClick:c,title:d,truncate:m,value:b})=>{if(Object(i.isString)(b)&&!Object(i.isEmpty)(b)){try{const g=JSON.parse(b);if(Object(i.isArray)(g))return l.a.createElement(L,{addresses:g,Component:e,contextId:t,eventId:a,fieldName:n,fieldType:r,isAggregatable:s,isButton:u,isDraggable:o,onClick:c,title:d,truncate:m})}catch(e){}return l.a.createElement(L,{addresses:[b],Component:e,contextId:t,eventId:a,isButton:u,isDraggable:o,onClick:c,fieldName:n,fieldType:r,isAggregatable:s,truncate:m,title:d})}return l.a.createElement(D,{contextId:t,eventId:a,fieldName:n,fieldType:r,isAggregatable:s,isDraggable:o,truncate:m,value:b})},z=l.a.memo(P,((e,t)=>e.contextId===t.contextId&&e.eventId===t.eventId&&e.fieldName===t.fieldName&&e.isAggregatable===t.isAggregatable&&e.fieldType===t.fieldType&&e.isDraggable===t.isDraggable&&e.truncate===t.truncate&&v()(e.value,t.value)));var B=a(1392),R=a(878),U=a(439),Q=a(285),q=a(928),H=a(44);const G={open:"primary",acknowledged:"warning",closed:"default"},V=a.n(H)()(n.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-1keooo6-0"})(["text-transform:capitalize;"]),Y=({contextId:e,eventId:t,fieldName:a,fieldType:n,isAggregatable:s,isDraggable:o,value:u,onClick:c,onClickAriaLabel:m,iconSide:b,iconType:g})=>{const f=Object(r.useMemo)((()=>Object(i.getOr)("default",`${u}`,G)),[u]),p=l.a.createElement(V,{color:f,onClick:c,onClickAriaLabel:m,iconType:g,iconSide:b,"data-test-subj":"rule-status-badge"},u);return o?l.a.createElement(d.b,{field:a,id:`alert-details-value-default-draggable-${e}-${t}-${a}-${u}`,fieldType:n,isAggregatable:s,isDraggable:!1,value:`${u}`,tooltipContent:a},p):p},K=l.a.memo(Y);K.displayName="RuleStatus";const J=({fieldName:e,fieldType:t,isAggregatable:a,Component:n,contextId:s,eventId:o,isDraggable:u,isButton:c,onClick:m,title:b,value:f})=>{const y=Object(p.useDispatch)(),v=Object(r.useContext)(E.a),j=`${f}`,O=j&&(null==v?void 0:v.enableHostDetailsFlyout)&&(null==v?void 0:v.timelineID),k=Object(r.useCallback)((e=>{if(e.preventDefault(),m&&m(),v&&O){const{timelineID:e,tabType:t}=v,a={panelView:"hostDetail",params:{hostName:j}},n=Object(h.getScopedActions)(e);n&&y(n.toggleDetailPanel({...a,id:e,tabType:t})),e===T.c.active&&t===T.d.query&&M.a.toggleExpandedDetail({...a})}}),[m,v,O,j,y]),x=Object(r.useMemo)((()=>l.a.createElement(F.d,{Component:n,hostName:j,isButton:c,onClick:O?k:void 0,title:b},l.a.createElement(U.b,{"data-test-subj":"draggable-truncatable-content"},j))),[n,j,c,O,k,b]);return Object(i.isString)(f)&&j.length>0?u?l.a.createElement(d.b,{field:e,fieldType:t,isAggregatable:a,id:`event-details-value-default-draggable-${s}-${o}-${e}-${f}`,isDraggable:u,tooltipContent:e,value:j},x):x:Object(g.d)()},W=l.a.memo(J);W.displayName="HostName";var Z=a(144),X=a(124),ee=a(1519),te=a(130);const ae=({fieldName:e,Component:t,contextId:a,eventId:n,fieldType:s,isAggregatable:o,isDraggable:u,isButton:c,onClick:m,title:b,value:f})=>{const y=Object(p.useDispatch)(),v=Object(r.useContext)(E.a),j=Object(te.a)("newUserDetailsFlyout"),O=`${f}`,k=O&&(null==v?void 0:v.timelineID),{openRightPanel:x}=Object(Z.d)(),S=Object(r.useCallback)((e=>{if(e.preventDefault(),m&&m(),v&&k){const{timelineID:e,tabType:t}=v;if(j&&!Object(h.isTimelineScope)(e))x({id:ee.c,params:{userName:O,contextID:a,scopeId:X.e.alertsOnAlertsPage,isDraggable:u}});else{const a={panelView:"userDetail",params:{userName:O}},n=Object(h.getScopedActions)(e);n&&y(n.toggleDetailPanel({...a,id:e,tabType:t})),e===T.c.active&&t===T.d.query&&M.a.toggleExpandedDetail({...a})}}}),[m,v,j,k,x,O,a,u,y]),I=Object(r.useMemo)((()=>l.a.createElement(F.m,{Component:t,userName:O,isButton:c,onClick:k?S:void 0,title:b},l.a.createElement(U.b,{"data-test-subj":"draggable-truncatable-content"},O))),[O,c,k,S,t,b]);return Object(i.isString)(f)&&O.length>0?u?l.a.createElement(d.b,{field:e,id:`event-details-value-default-draggable-${a}-${n}-${e}-${f}`,fieldType:s,isAggregatable:o,isDraggable:u,tooltipContent:e,value:O},I):I:Object(g.d)()},ne=l.a.memo(ae);ne.displayName="UserName";const ie=[Q.i],re=({asPlainText:e,Component:t,contextId:a,eventId:r,fieldFormat:p,isAggregatable:y=!1,fieldName:v,fieldType:E="",fieldFromBrowserField:h,isButton:j,isObjectArray:O=!1,isDraggable:k=!0,onClick:x,onClickAriaLabel:S,title:I,truncate:T=!0,value:M,linkValue:F})=>{if(O||e)return l.a.createElement("span",{"data-test-subj":`formatted-field-${v}`},M);if(E===Q.h)return l.a.createElement(z,{Component:t,eventId:r,contextId:a,fieldName:v,fieldType:E,isAggregatable:y,isButton:j,isDraggable:k,value:Object(i.isNumber)(M)?String(M):M,onClick:x,title:I,truncate:T});if(E===Q.f)return l.a.createElement(l.a.Fragment,null,M);if(E===Q.b){const e=T?"eui-textTruncate eui-alignMiddle":void 0;return k?l.a.createElement(d.b,{field:v,fieldType:E,isAggregatable:y,id:`event-details-value-default-draggable-${a}-${r}-${v}-${M}`,isDraggable:k,tooltipContent:null,value:`${M}`},l.a.createElement(f.a,{className:e,fieldName:v,value:M})):l.a.createElement(f.a,{className:e,fieldName:v,value:M})}if(R.b.some((e=>v===e)))return l.a.createElement(B.a,{Component:t,contextId:a,eventId:r,fieldName:v,fieldType:E,isAggregatable:y,isDraggable:k,title:I,value:`${M}`});if(v===b.b)return l.a.createElement(b.a,{contextId:a,eventId:r,fieldName:v,fieldType:E,isAggregatable:y,isDraggable:k,value:`${M}`});if(v===Q.g)return l.a.createElement(W,{Component:t,contextId:a,eventId:r,fieldType:E,isAggregatable:y,fieldName:v,isDraggable:k,isButton:j,onClick:x,title:I,value:M});if(v===Q.p)return l.a.createElement(ne,{Component:t,contextId:a,eventId:r,fieldName:v,fieldType:E,isAggregatable:y,isDraggable:k,isButton:j,onClick:x,title:I,value:M});if(p===m.a)return l.a.createElement(m.b,{contextId:a,eventId:r,fieldName:v,fieldType:E,isAggregatable:y,isDraggable:k,value:`${M}`});if(v===Q.n)return l.a.createElement(q.a,{Component:t,contextId:a,eventId:r,fieldName:v,fieldType:E,isAggregatable:y,isDraggable:k,isButton:j,onClick:x,linkValue:F,title:I,truncate:T,value:M});if(v===Q.c)return Object(q.b)({contextId:a,eventId:r,fieldName:v,fieldType:E,isAggregatable:y,isDraggable:k,linkValue:F,truncate:T,value:M});if(v===Q.o)return l.a.createElement(K,{contextId:a,eventId:r,fieldName:v,fieldType:E,isAggregatable:y,isDraggable:k,value:M,onClick:x,onClickAriaLabel:S,iconType:j?"arrowDown":void 0,iconSide:j?"right":void 0});if(v===s.a||(null==h?void 0:h.name)===s.a)return l.a.createElement(o.b,{agentId:String(null!=M?M:"")});if(v===Q.a)return l.a.createElement(u.b,{endpointAgentId:String(null!=M?M:""),"data-test-subj":"endpointHostAgentStatus"});if([Q.m,Q.l,Q.e,c.j].includes(v))return Object(q.c)({contextId:a,Component:t,eventId:r,fieldName:v,fieldType:E,isAggregatable:y,isDraggable:k,truncate:T,title:I,value:M});if(ie.includes(v)||!k)return T&&!Object(i.isEmpty)(M)?l.a.createElement(U.b,{"data-test-subj":"truncatable-message"},l.a.createElement(n.EuiToolTip,{"data-test-subj":"message-tool-tip",content:l.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"none"},l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement("span",null,v)),l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement("span",null,M)))},l.a.createElement("span",{"data-test-subj":`formatted-field-${v}`},M))):l.a.createElement("span",{"data-test-subj":`formatted-field-${v}`},M);{const e=Object(g.f)(M),t=T?l.a.createElement(U.b,null,e):e;return l.a.createElement(d.b,{field:v,id:`event-details-value-default-draggable-${a}-${r}-${v}-${M}`,fieldType:null!=E?E:"",isAggregatable:y,isDraggable:k,value:`${M}`,tooltipContent:E===Q.b||E===b.b?null:v},t)}},le=l.a.memo(re)},1087:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(2),i=a(4),r=a(110);const l=async(e,t)=>r.b.get().http.fetch("/internal/ml/results/anomalies_table_data",{method:"POST",version:"1",body:JSON.stringify(e),asSystemRequest:!0,signal:t});var s=a(1464),o=a(117),u=a(1132),c=a(210),d=a(385);const m=e=>null==e?"":e.reduce(((e,t)=>`${e}${t.fieldName}:${t.fieldValue}`),""),b=(e,t)=>-1!==t?t:null==e?50:e<0?0:e>100?100:Math.floor(e),g=({criteriaFields:e=[],influencers:t=[],startDate:a,endDate:g,threshold:f=-1,skip:p=!1,filterQuery:y,jobIds:v,aggregationInterval:E})=>{const h=Object(c.a)(),j=Object(d.a)(h),{addError:O}=Object(o.a)(),k=Object(r.l)(),[x]=Object(r.o)(i.y),S=Object(n.useMemo)((()=>new Date(a).getTime()),[a]),I=Object(n.useMemo)((()=>new Date(g).getTime()),[g]),{fetch:T,data:M=null,isLoading:F,error:A}=Object(u.b)(u.a.ANOMALIES_TABLE,l,{disabled:p});return Object(n.useEffect)((()=>{A&&O(A,{title:s.a})}),[A,O]),Object(n.useEffect)((()=>{j&&v.length>0&&T({jobIds:v,criteriaFields:e,influencersFilterQuery:y,aggregationInterval:E,threshold:b(x,f),earliestMs:S,latestMs:I,influencers:t,dateFormatTz:k,maxRecords:500,maxExamples:10})}),[m(t),m(e),S,I,j,E,v.sort().join()]),[F,M]}},1096:function(e,t,a){"use strict";a.d(t,"e",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"f",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"a",(function(){return u})),a.d(t,"c",(function(){return c}));var n=a(4),i=a(110);const r=async({signal:e,params:t})=>i.b.get().http.fetch(n.kc,{version:"1",method:"POST",body:JSON.stringify(t),signal:e}),l=async({signal:e})=>i.b.get().http.fetch(n.gc,{version:"1",method:"GET",signal:e}),s=async()=>i.b.get().http.fetch(n.ec,{version:"1",method:"POST"}),o=async()=>i.b.get().http.fetch(n.dc,{version:"1",method:"POST"}),u=async()=>i.b.get().http.fetch(n.cc,{version:"1",method:"POST"}),c=async()=>i.b.get().http.fetch(n.fc,{version:"1",method:"GET"})},1100:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a.n(n),r=a(61),l=a.n(r),s=a(4),o=a(110);const u=({value:e})=>i.a.createElement(i.a.Fragment,null,(()=>{const[e]=Object(o.o)(s.B);return t=>((e,t)=>l()(e).format(t))(t,e)})()(e));u.displayName="PreferenceFormattedBytesComponent";const c=i.a.memo(u);c.displayName="PreferenceFormattedBytes"},1101:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(2),i=a.n(n),r=a(166),l=a(1544);const s="event.duration",o=i.a.memo((({contextId:e,eventId:t,fieldName:a,fieldType:n,isAggregatable:s,isDraggable:o,value:u})=>o?i.a.createElement(r.b,{id:`duration-default-draggable-${e}-${t}-${a}-${u}`,fieldType:n,isAggregatable:s,isDraggable:o,field:a,tooltipContent:null,value:u},i.a.createElement(l.a,{maybeDurationNanoseconds:u,tooltipTitle:a})):i.a.createElement(l.a,{maybeDurationNanoseconds:u,tooltipTitle:a})));o.displayName="Duration"},1110:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"i",(function(){return l})),a.d(t,"e",(function(){return s})),a.d(t,"g",(function(){return o})),a.d(t,"f",(function(){return u})),a.d(t,"h",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"a",(function(){return m}));var n=a(5);n.i18n.translate("xpack.securitySolution.timeline.tcp",{defaultMessage:"TCP"});const i=n.i18n.translate("xpack.securitySolution.timeline.destination",{defaultMessage:"Destination"}),r=n.i18n.translate("xpack.securitySolution.timeline.file.fromOriginalPathDescription",{defaultMessage:"from its original path"}),l=n.i18n.translate("xpack.securitySolution.timeline.source",{defaultMessage:"Source"}),s=n.i18n.translate("xpack.securitySolution.auditd.inDescription",{defaultMessage:"in"}),o=n.i18n.translate("xpack.securitySolution.auditd.nonExistentDescription",{defaultMessage:"an unknown process"}),u=n.i18n.translate("xpack.securitySolution.event.module.linkToElasticEndpointSecurityDescription",{defaultMessage:"Open in Endpoint Security"}),c=e=>n.i18n.translate("xpack.securitySolution.event.summary.threat_indicator.showMatches",{values:{count:e},defaultMessage:"Show all {count} indicator match alerts"}),d=n.i18n.translate("xpack.securitySolution.event.summary.threat_indicator.modal.allMatches",{defaultMessage:"All Indicator Matches"}),m=n.i18n.translate("xpack.securitySolution.event.summary.threat_indicator.modal.close",{defaultMessage:"Close"})},1111:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(23),i=a.n(n),r=a(2),l=a.n(r),s=a(17);const o=Object(r.memo)((({children:e,...t})=>l.a.createElement(s.EuiFlyoutHeader,i()({hasBorder:!0},t),l.a.createElement(s.EuiPanel,{hasShadow:!1,color:"transparent"},e))));o.displayName="FlyoutHeader"},1132:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return o}));var n=a(2),i=a(336);const r=(e,t)=>{switch(t.type){case"FETCH_INIT":return{...e,parameters:t.payload,isLoading:!0};case"FETCH_SUCCESS":return{...e,data:t.payload,isLoading:!1,error:void 0};case"FETCH_FAILURE":return{...e,error:t.payload,isLoading:!1};case"FETCH_REPEAT":return{...e,isLoading:!0};default:return e}},l=(e,t,{disabled:a=!1,initialParameters:l}={})=>{const{startTracking:s}=Object(i.a)(),[{parameters:o,data:u,isLoading:c,error:d},m]=Object(n.useReducer)(r,{data:void 0,isLoading:!a&&void 0!==l,error:void 0,parameters:l}),b=Object(n.useCallback)((e=>m({type:"FETCH_INIT",payload:e})),[]),g=Object(n.useCallback)((()=>m({type:"FETCH_REPEAT"})),[]);return Object(n.useEffect)((()=>{if(!1===c||void 0===o||a)return;let n=!1;const i=new AbortController;return(async()=>{const{endTracking:a}=s({name:e});try{const e=await t(o,i.signal);a("success"),n||m({type:"FETCH_SUCCESS",payload:e})}catch(e){a(i.signal.aborted?"aborted":"error"),n||m({type:"FETCH_FAILURE",payload:e})}})(),()=>{n=!0,i.abort()}}),[c,o,a,t,s,e]),{fetch:b,refetch:g,data:u,isLoading:c,error:d}};var s=a(4);const o={SECURITY_DASHBOARDS:`${s.l} fetch security dashboards`,SECURITY_TAGS:`${s.l} fetch security tags`,SECURITY_CREATE_TAG:`${s.l} fetch security create tag`,CTI_TAGS:`${s.l} fetch cti tags`,ANOMALIES_TABLE:`${s.l} fetch anomalies table data`,GET_RISK_SCORE_DEPRECATED:`${s.l} fetch is risk score deprecated`,ENABLE_RISK_SCORE:`${s.l} fetch enable risk score`,REFRESH_RISK_SCORE:`${s.l} fetch refresh risk score`,UPGRADE_RISK_SCORE:`${s.l} fetch upgrade risk score`}},1135:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(45),i=a(2),r=a(67),l=a.n(r),s=a(136),o=a.n(s),u=a(3),c=a(54),d=a(58),m=a(110),b=a(125),g=a(117),f=a(5);f.i18n.translate("xpack.securitySolution.timeline.failDescription",{defaultMessage:"An error has occurred"});const p=f.i18n.translate("xpack.securitySolution.timeline.failSearchDescription",{defaultMessage:"Failed to run search"}),y=({entityType:e=d.EntityType.EVENTS,indexName:t,eventId:a,runtimeMappings:r,skip:s})=>{const{data:f}=Object(m.i)().services,y=Object(i.useRef)((()=>Promise.resolve())),v=Object(i.useRef)(new AbortController),E=Object(i.useRef)(new u.Subscription),[h,j]=Object(i.useState)(!0),[O,k]=Object(i.useState)(null),{addError:x}=Object(g.a)(),[S,I]=Object(i.useState)(null),[T,M]=Object(i.useState)(null),[F,A]=Object(i.useState)(void 0),w=Object(i.useCallback)((e=>{if(null==e||s||Object(n.isEmpty)(e.eventId))return;const t=async()=>{v.current=new AbortController,j(!0),E.current=f.search.search(e,{strategy:"timelineSearchStrategy",abortSignal:v.current.signal}).subscribe({next:e=>{Object(c.isRunningResponse)(e)||Promise.resolve().then((()=>{l.a.unstable_batchedUpdates((()=>{j(!1),I(e.data||[]),A(e.rawResponse.hits.hits[0]),M(e.ecs||null),E.current.unsubscribe()}))}))},error:e=>{j(!1),x(e,{title:p}),E.current.unsubscribe()}})};E.current.unsubscribe(),v.current.abort(),t(),y.current=t}),[f.search,x,s]);return Object(i.useEffect)((()=>{k((n=>{const i={...null!=n?n:{},entityType:e,indexName:t,eventId:a,factoryQueryType:b.y.details,runtimeMappings:r};return o()(n,i)?n:i}))}),[e,a,t,r]),Object(i.useEffect)((()=>(w(O),()=>{E.current.unsubscribe(),v.current.abort()})),[O,w]),[h,S,F,T,y.current]}},1147:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>{const t=Object.entries(e);if(Array.isArray(t[0])){const[[e,a]]=t;return[e,a]}return[null,null]}},1158:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(311);const i=({status:e,query:t,signalIds:a,signal:i})=>{if(a&&a.length>0)return Object(n.j)({status:e,signalIds:a,signal:i}).then((({updated:e})=>({updated:null!=e?e:0,version_conflicts:0})));if(t)return Object(n.k)({status:e,query:t,signal:i}).then((({updated:e,version_conflicts:t})=>({updated:null!=e?e:0,version_conflicts:t})));throw new Error("Either query or signalIds must be provided")}},1166:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));const n=400,i=null},1167:function(e,t,a){"use strict";a.d(t,"a",(function(){return b})),a.d(t,"b",(function(){return f}));var n=a(17),i=a(2),r=a.n(i),l=a(44),s=a.n(l),o=a(186),u=a(1364),c=a(1149),d=a(1551),m=a(895);let b;!function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.DISCONNECTING="disconnecting",e.DISCONNECTED="disconnected"}(b||(b={}));const g=s()(n.EuiFlexGroup).withConfig({displayName:"EuiFlexGroupStyled",componentId:"sc-ymdn6m-0"})([".isolation-status{margin-left:",";}"],(({theme:e})=>e.eui.euiSizeS)),f=r.a.memo((({agentId:e,"data-test-subj":t})=>{var a;const{data:l,isFetched:s}=Object(d.a)({agentId:e}),f=Object(i.useMemo)((()=>{var e,t,a;const n=null==l||null===(e=l.data)||void 0===e||null===(t=e.data)||void 0===t||null===(a=t[0])||void 0===a?void 0:a.networkStatus;return n===b.DISCONNECTING?m.d:n===b.DISCONNECTED?m.c:n===b.CONNECTING?m.e:void 0}),[null==l||null===(a=l.data)||void 0===a?void 0:a.data]),p=Object(i.useMemo)((()=>{var e,t;return(e=>e?null!=e&&e.isActive?o.c.HEALTHY:o.c.OFFLINE:o.c.UNENROLLED)(null==l||null===(e=l.data)||void 0===e||null===(t=e.data)||void 0===t?void 0:t[0])}),[l]);return r.a.createElement(g,{gutterSize:"none",responsive:!1,className:"eui-textTruncate","data-test-subj":t},r.a.createElement(n.EuiFlexItem,{grow:!1},s?r.a.createElement(n.EuiBadge,{color:c.a[p],className:"eui-textTruncate"},Object(u.a)(p)):"-"),f&&r.a.createElement(n.EuiFlexItem,{grow:!1,className:"eui-textTruncate isolation-status"},r.a.createElement(n.EuiBadge,{color:"hollow","data-test-subj":t},r.a.createElement(r.a.Fragment,null,f))))}));f.displayName="SentinelOneAgentStatus"},1168:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(176);const i=(e,t)=>e===n.UsersType.details&&null!=t?[{fieldName:"user.name",fieldValue:t}]:[]},1169:function(e,t,a){"use strict";a.d(t,"d",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return b})),a.d(t,"a",(function(){return g}));var n=a(45),i=a(53),r=a(113),l=a(153);const s=["host.name","host.hostname","host.domain","host.id","host.ip","client.ip","destination.ip","server.ip","source.ip","network.community_id","user.name","process.name"],o=(e,t,a=console)=>{var n,i;const r=null!==(n=null===(i=t.find((t=>t.field===e)))||void 0===i?void 0:i.values)&&void 0!==n?n:null;return null==r?[]:"string"==typeof r?[r]:Array.isArray(r)&&r.every((e=>"string"==typeof e))?r:(a.trace("Data type that is not a string or string array detected:",r,"when trying to access field:",e,"from data object of:",t),[])},u=(e,t=[])=>{let a=t;return"is"===e.function&&s.includes(e.arguments[0].value)&&(a=[...a,{field:e.arguments[0].value,valueToChange:e.arguments[1].value}]),e.arguments.reduce(((e,t)=>"is"===t.function&&s.includes(t.arguments[0].value)?[...e,{field:t.arguments[0].value,valueToChange:t.arguments[1].value}]:t.arguments?u(t,e):e),a)},c=(e,t,a=r.l.default)=>a===r.l.default?""!==e.trim()?u(Object(i.fromKueryExpression)(e)).reduce(((e,a)=>{const n=o(a.field,t);return n.length?e.replace(a.valueToChange,n[0]):e}),e):"":e.trim(),d=(e,t)=>e.map((e=>{if("phrase"===e.meta.type&&null!=e.meta.key&&s.includes(e.meta.key)){const a=o(e.meta.key,t);a.length&&(e.meta.params={query:a[0]},e.query={match_phrase:{[e.meta.key]:a[0]}})}return e})),m=(e,t,a=r.l.default)=>{if(a!==r.l.template){if(s.includes(e.queryMatch.field)){const a=o(e.queryMatch.field,t);a.length&&(e.id=e.id.replace(e.name,a[0]),e.name=a[0],e.queryMatch.value=a[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0)}return e.type=l.a.default,e}if(a===r.l.template){var n;if(e.type===l.a.template&&":"===e.queryMatch.operator){const a=o(e.queryMatch.field,t);return a.length||(e.enabled=!1),e.id=e.id.replace(e.name,a[0]),e.name=a[0],e.queryMatch.value=a[0],e.queryMatch.displayField=void 0,e.queryMatch.displayValue=void 0,e.type=l.a.default,e}return e.type=null!==(n=e.type)&&void 0!==n?n:l.a.default,e}return e},b=(e,t,a=r.l.default)=>e.map((e=>{const i=m(e,t,a);return null==i.and||Object(n.isEmpty)(i.and)||(i.and=i.and.map((e=>m(e,t,a)))),i})),g=(e,t)=>[{range:{"@timestamp":{gte:e,lte:t,format:"strict_date_optional_time"}},meta:{type:"range",disabled:!1,negate:!1,alias:null,key:"@timestamp",params:{gte:e,lte:t,format:"strict_date_optional_time"}},$state:{store:i.FilterStateStore.APP_STATE}}]},1170:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(44),i=a.n(n),r=a(17);const l=i()(r.EuiInMemoryTable).withConfig({displayName:"BasicTable",componentId:"sc-1ir53m2-0"})(["tbody{th,td{vertical-align:top;}.euiTableCellContent{display:block;}}"]);l.displayName="BasicTable"},1276:function(e,t,a){"use strict";a.d(t,"a",(function(){return A}));var n=a(2),i=a.n(n),r=a(17),l=a(126),s=a(45),o=a(44),u=a.n(o),c=a(1461),d=a(1462),m=a(155),b=a(1147);const g=(e=[])=>e.filter((e=>!Object(s.isEmpty)(e))).map((e=>{const t=(e=>{const[t,a]=Object(b.a)(e);return null!=t&&null!=a?`${t}: "${a}"`:""})(e);return i.a.createElement(r.EuiFlexItem,{key:t,grow:!1},t)}));var f=a(5);const p=f.i18n.translate("xpack.securitySolution.ml.score.influencedByTitle",{defaultMessage:"Influenced By"}),y=f.i18n.translate("xpack.securitySolution.ml.score.maxAnomalyScoreTitle",{defaultMessage:"Max Anomaly Score"}),v=f.i18n.translate("xpack.securitySolution.ml.score.anomalyJobTitle",{defaultMessage:"Job"}),E=f.i18n.translate("xpack.securitySolution.ml.score.viewInMachineLearningLink",{defaultMessage:"View in Machine Learning"}),h=f.i18n.translate("xpack.securitySolution.ml.score.detectedTitle",{defaultMessage:"Detected"}),j=f.i18n.translate("xpack.securitySolution.ml.score.narrowToThisDateRangeLink",{defaultMessage:"Narrow to this date range"}),O=f.i18n.translate("xpack.securitySolution.ml.score.anomalousEntityTitle",{defaultMessage:"Anomalous Entity"});var k=a(1463);const x=u()(r.EuiText).withConfig({displayName:"LargeScore",componentId:"sc-vz3ecp-0"})(["font-size:45px;font-weight:lighter;"]);x.displayName="LargeScore";const S=(e,t,a,n,l,s)=>[{title:y,description:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(x,null,Object(d.a)(e.severity)))},{title:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"m"}),v),description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},s),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(k.a,{score:e,startDate:t,endDate:a,linkName:E})))},{title:h,description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(m.c,{value:new Date(e.time)})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLink,{"data-test-subj":"anomaly-description-narrow-range-link",onClick:()=>{l(e,n)},target:"_blank"},j)))},{title:O,description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},`${e.entityName}: "${e.entityValue}"`))},{title:p,description:i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1},g(e.influencers))}],I=u()(r.EuiIcon).withConfig({displayName:"Icon",componentId:"sc-1ms1asc-0"})(["vertical-align:text-bottom;cursor:pointer;"]);I.displayName="Icon";const T=({startDate:e,endDate:t,index:a=0,score:l,interval:s,narrowDateRange:o,jobName:u})=>{const[d,m]=Object(n.useState)(!1);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":"anomaly-score"},i.a.createElement(c.a,{index:a,score:l})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiPopover,{"data-test-subj":"anomaly-score-popover",id:"anomaly-score-popover",isOpen:d,onClick:()=>m(!d),closePopover:()=>m(!d),button:i.a.createElement(I,{type:"iInCircle"}),repositionOnScroll:!0},i.a.createElement(r.EuiDescriptionList,{"data-test-subj":"anomaly-description-list",listItems:S(l,e,t,s,o,u)}))))};T.displayName="AnomalyScoreComponent";const M=i.a.memo(T);M.displayName="AnomalyScore";const F=({anomalies:e,startDate:t,endDate:a,isLoading:n,narrowDateRange:o,limit:u,jobNameById:c})=>n?i.a.createElement(r.EuiLoadingSpinner,{"data-test-subj":"anomaly-score-spinner",size:"m"}):null==e||0===e.anomalies.length?Object(l.d)():i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1,"data-test-subj":"anomaly-scores"},((e,t)=>{const a=e.reduce(((e,t)=>{const a=t.jobId,n=t.severity;return(null==e[a]||e[a].severity<n)&&(e[a]=t),e}),{}),n=Object(s.toArray)(a).sort(((e,t)=>t.severity-e.severity));return null==t?n:n.slice(0,t)})(e.anomalies,u).map(((n,r)=>{var l;const s=(e=>`${e.jobId}-${e.severity}-${e.entityName}-${e.entityValue}`)(n);return i.a.createElement(M,{key:s,startDate:t,endDate:a,index:r,score:n,jobName:null!==(l=c[n.jobId])&&void 0!==l?l:n.jobId,interval:e.interval,narrowDateRange:o})}))));F.displayName="AnomalyScoresComponent";const A=i.a.memo(F);A.displayName="AnomalyScores"},1279:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(23),i=a.n(n),r=(a(2),a(59)),l=a.n(r),s=a(17),o=a(13);const u={iconType:"questionInCircle",color:"gray"},c={binary:{iconType:"tokenBinary"},boolean:{iconType:"tokenBoolean"},conflict:{iconType:"warning",color:"euiColorVis9",shape:"square"},date:{iconType:"tokenDate"},date_range:{iconType:"tokenDate"},dense_vector:{iconType:"tokenVectorDense"},geo_point:{iconType:"tokenGeo"},geo_shape:{iconType:"tokenGeo"},ip:{iconType:"tokenIP"},ip_range:{iconType:"tokenIP"},flattened:{iconType:"tokenFlattened"},match_only_text:{iconType:"tokenString"},murmur3:{iconType:"tokenSearchType"},number:{iconType:"tokenNumber"},number_range:{iconType:"tokenNumber"},rank_feature:{iconType:"tokenRankFeature"},rank_features:{iconType:"tokenRankFeatures"},histogram:{iconType:"tokenHistogram"},_source:{iconType:"editorCodeBlock",color:"gray"},point:{iconType:"tokenShape"},shape:{iconType:"tokenShape"},sparse_vector:{iconType:"tokenVectorSparse"},string:{iconType:"tokenString"},text:{iconType:"tokenString"},keyword:{iconType:"tokenKeyword"},gauge:{iconType:"tokenMetricGauge"},counter:{iconType:"tokenMetricCounter"},nested:{iconType:"tokenNested"},version:{iconType:"tokenTag"}};function d({type:e,label:t,size:a="s",scripted:n,className:r,...d}){const m=c[e]||u;return Object(o.jsx)(s.EuiToken,i()({},m,{className:l()("kbnFieldIcon",r),"aria-label":t||e,title:t||e,size:a,fill:n?"dark":void 0},d))}a(1615);Object.keys({xs:"kbnFieldButton--xs",s:"kbnFieldButton--s"})},1284:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(17);const i=(e,t,a)=>{if(e(),a){const e=a(t);Object(n.copyToClipboard)(e)}else Object(n.copyToClipboard)(t)}},1285:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(44),i=a.n(n),r=a(2),l=a.n(r),s=a(17),o=(a(13),a(144)),u=a(47),c=a(5),d=a(1360);const m=Object(r.memo)((({flyoutIsExpandable:e=!1,expandDetails:t,actions:a})=>{const{euiTheme:n}=Object(s.useEuiTheme)(),{closeLeftPanel:i,panels:m}=Object(o.d)(),g=!!m.left,f=Object(r.useCallback)((()=>i()),[i]),p=Object(r.useMemo)((()=>l.a.createElement(s.EuiButtonEmpty,{iconSide:"left",onClick:f,iconType:"arrowEnd",size:"s","data-test-subj":d.a,"aria-label":c.i18n.translate("xpack.securitySolution.flyout.right.header.collapseDetailButtonAriaLabel",{defaultMessage:"Collapse details"})},l.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.collapseDetailButtonLabel",defaultMessage:"Collapse details"}))),[f]),y=Object(r.useMemo)((()=>l.a.createElement(s.EuiButtonEmpty,{iconSide:"left",onClick:t,iconType:"arrowStart",size:"s","data-test-subj":d.b,"aria-label":c.i18n.translate("xpack.securitySolution.flyout.right.header.expandDetailButtonAriaLabel",{defaultMessage:"Expand details"})},l.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.expandDetailButtonLabel",defaultMessage:"Expand details"}))),[t]);return e||a?l.a.createElement(s.EuiFlyoutHeader,{hasBorder:!0},l.a.createElement(b,{direction:"row",justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none",responsive:!1,$_css:n.size.s,$_css2:n.size.xl,$_css3:n.size.xxl},l.a.createElement(s.EuiFlexItem,{grow:!1},e&&t&&(g?p:y)),a&&l.a.createElement(s.EuiFlexItem,{grow:!1,"data-test-subj":d.e},a))):null}));m.displayName="FlyoutNavigation";var b=i()(s.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-1l87qfd-0"})(["padding-left:",";padding-right:",";height:",";"],(e=>e.$_css),(e=>e.$_css2),(e=>e.$_css3))},1296:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return l}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.userProfiles.fetchCurrentUserProfile.failure",{defaultMessage:"Failed to find current user"}),r=n.i18n.translate("xpack.securitySolution.userProfiles.fetchUserProfiles.failure",{defaultMessage:"Failed to find users"}),l=n.i18n.translate("xpack.securitySolution.userProfiles.unknownUser.displayName",{defaultMessage:"Unknown"})},1297:function(e,t,a){"use strict";a.d(t,"a",(function(){return O}));var n=a(2),i=a(48),r=a(19),l=a(124),s=a(172),o=a(110),u=a(4),c=a(121),d=a(559),m=a(1298),b=a(162),g=a(118),f=a(228),p=a(197),y=a(122),v=a(113),E=a(1490);const{setEventsLoading:h,setSelected:j}=l.h,O=({localFilters:e,tableId:t,from:a,to:O,scopeId:k})=>{const[x,S]=Object(n.useState)(!1),{browserFields:I,dataViewId:T,runtimeMappings:M,indexPattern:F,selectedPatterns:A}=Object(c.d)(k),w=Object(i.useDispatch)(),{uiSettings:C}=Object(o.i)().services,{filters:D,dataTable:{selectAll:N,totalCount:_,sort:$,selectedEventIds:L}=l.q}=Object(i.useSelector)((e=>Object(m.a)(e,t))),P=Object(n.useMemo)((()=>Object(r.getEsQueryConfig)(C)),[C]),z=$.map((({columnId:e,columnType:t,esTypes:a,sortDirection:n})=>({field:e,direction:n,esTypes:null!=a?a:[],type:t}))),B=Object(n.useMemo)((()=>[...e,...D]),[e,D]),R=Object(s.d)({config:P,dataProviders:[],indexPattern:F,filters:B,kqlQuery:{query:"",language:"kuery"},browserFields:I,kqlMode:"filter"}),U=Object(n.useMemo)((()=>R?R.filterQuery:""),[R]),[,,Q]=Object(d.b)({dataViewId:T,endDate:O,startDate:a,id:t,fields:["_id","timestamp"],sort:z,indexNames:A,filterQuery:U,runtimeMappings:M,limit:Math.min(u.p,_),timerangeKind:"absolute"});Object(n.useEffect)((()=>{N&&_>u.p?S(!0):S(!1)}),[N,_]);const q=Object(f.a)({timelineId:y.c.active,timelineType:v.l.default}),H=Object(n.useCallback)((e=>w(g.a.updateIsLoading(e))),[w]),G=Object(n.useCallback)((({timeline:e,ruleNote:t,timeline:{filters:n}})=>{var i;q(),H({id:y.c.active,isLoading:!1}),Object(b.b)(w)({duplicate:!0,from:a,id:y.c.active,notes:[],timeline:{...e,indexNames:null!==(i=e.indexNames)&&void 0!==i?i:[],show:!0,filters:n},to:O,ruleNote:t})()}),[w,H,q,a,O]),V=Object(n.useCallback)((e=>{Object(E.b)(G,e.map((e=>e.ecs)),"KqlFilter"),w(j({id:t,isSelectAllChecked:!1,isSelected:!1,eventIds:L}))}),[w,G,L,t]),Y=Object(n.useCallback)(((e,a,n,i)=>{if(!e)return;if(a||N)return t===l.e.alertsOnAlertsPage?n(!0):w(h({id:t,isLoading:!0,eventIds:Object.keys(L)})),void Q((e=>{V(e.events),t===l.e.alertsOnAlertsPage?(n(!1),i()):w(h({id:t,isLoading:!1,eventIds:Object.keys(L)}))}));V(e),i()}),[w,L,t,Q,N,V]),K=Object(n.useMemo)((()=>x?`${p.F} ( max ${u.p} )`:p.F),[x]);return Object(n.useMemo)((()=>({label:K,key:"add-bulk-to-timeline","data-test-subj":"investigate-bulk-in-timeline",disableOnQuery:x,onClick:Y})),[x,K,Y])}},1298:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(124),i=a(57),r=a(580);const l=Object(i.createSelector)(Object(r.globalFiltersQuerySelector)(),Object(r.getTimelineSelector)(),Object(r.globalQuerySelector)(),Object(r.globalQuery)(),Object(r.timelineQueryByIdSelector)(),Object(n.o)(),((e,t,a,n,i,r)=>({filters:e,input:t,query:a,globalQueries:n,timelineQuery:i,dataTable:r})))},1299:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a.n(n),r=a(1300),l=a(1067);const s=({selectedTabId:e,tabs:t})=>{const a=Object(n.useMemo)((()=>{var a;return null===(a=t.find((t=>t.id===e)))||void 0===a?void 0:a.content}),[e,t]);return i.a.createElement(l.a,{"data-test-subj":r.a},a)};s.displayName="PanelContent"},1300:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return l})),a.d(t,"b",(function(){return s}));var n=a(427);const i=`${n.a}Body`,r=`${n.a}OverviewTab`,l=`${n.a}TableTab`,s=`${n.a}JsonTab`},1301:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var n=a(2),i=a.n(n),r=a(17),l=a(9),s=a(234),o=a.n(s),u=a(1394),c=a(1541),d=a(600),m=a(215),b=a(140),g=a(1542),f=a(151);const p=o()(((e,t)=>Object(l.get)(t,e)),((e,t)=>e[0].join()===t[0].join())),y=({browserFields:e,eventId:t,contextId:a,scopeId:n,getLinkValue:l,isDraggable:s})=>[{field:"field",name:i.a.createElement(r.EuiText,{size:"xs"},i.a.createElement("strong",null,m.k)),width:"30%",render:(e,t)=>i.a.createElement(c.a,{data:t,field:e,fieldMapping:void 0})},{field:"values",name:i.a.createElement(r.EuiText,{size:"xs"},i.a.createElement("strong",null,m.E)),width:"70%",render:(n,r)=>{const o=p([r.category,"fields",r.field],e);return i.a.createElement(d.a,{field:r.field,value:n,isObjectArray:r.isObjectArray},i.a.createElement(u.a,{contextId:a,data:r,eventId:t,fieldFromBrowserField:o,getLinkValue:l,isDraggable:s,values:n}))}}],v=Object(n.memo)((()=>{const{browserFields:e,dataFormattedForFieldBrowser:t,eventId:a,scopeId:n}=Object(b.b)();return i.a.createElement(g.a,{browserFields:e,data:t,eventId:a,isDraggable:!1,timelineTabType:f.g.query,scopeId:n,isReadOnly:!1,columnsProvider:y})}));v.displayName="TableTab"},1325:function(e,t,a){"use strict";a.d(t,"a",(function(){return P}));var n=a(17),i=a(2),r=a.n(i),l=a(1111),s=a(23),o=a.n(s),u=a(44),c=a.n(u);a(13);const d=Object(i.memo)((({children:e,...t})=>r.a.createElement(m,o()({size:"l",expand:!0},t),e)));d.displayName="FlyoutHeaderTabs";var m=c()(n.EuiTabs).withConfig({displayName:"_StyledEuiTabs",componentId:"sc-146ys67-0"})(["margin-bottom:-17px;"]),b=a(9),g=a(47),f=a(142),p=a(45),y=a(144),v=a(126),E=a(285),h=a(1492),j=a(140),O=a(732),k=a(600),x=a(133);function S(e){return!!e&&Array.isArray(e.values)}const I=()=>{const{closeFlyout:e}=Object(y.d)(),{eventId:t,browserFields:a,dataFormattedForFieldBrowser:l,scopeId:s,isPreview:o}=Object(j.b)(),u=Object(i.useMemo)((()=>{const e=Object(p.find)({field:E.o,category:"kibana"},l);return e&&Object(O.b)({eventId:t,contextId:s,scopeId:s,browserFields:a,item:e})}),[a,l,t,s]);return u&&S(u)?r.a.createElement(n.EuiFlexGroup,{direction:"column",gutterSize:"xs",responsive:!1},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiTitle,{size:"xxs","data-test-subj":x.cb},r.a.createElement("h3",null,r.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.statusTitle",defaultMessage:"Status"})))),r.a.createElement(n.EuiFlexItem,{grow:!1},u&&S(u)&&!o?r.a.createElement(k.a,{field:E.o,value:u.values[0]},r.a.createElement(h.a,{eventId:t,contextId:s,enrichedFieldInfo:u,scopeId:s,handleOnEventClosed:e})):Object(v.d)())):null};I.displayName="DocumentStatus";var T=a(567);const M=e=>"low"===e||"medium"===e||"high"===e||"critical"===e,F=Object(i.memo)((()=>{const{getFieldsData:e}=Object(j.b)(),t=e(f.X);if(!t)return null;let a;if("string"==typeof t&&M(t))a=t;else{if(!(Array.isArray(t)&&t.length>0&&M(t[0])))return null;a=t[0]}return r.a.createElement(k.a,{field:f.X,value:a},r.a.createElement(T.a,{value:a}))}));F.displayName="DocumentSeverity";const A=Object(i.memo)((()=>{const{getFieldsData:e}=Object(j.b)(),t=e(f.t);if(!t)return null;let a;if("string"==typeof t)a=t;else{if(!(Array.isArray(t)&&t.length>0))return null;a=t[0]}return r.a.createElement(n.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"xs",responsive:!1},r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(n.EuiTitle,{size:"xxs","data-test-subj":x.X},r.a.createElement("h3",null,r.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.riskScoreTitle",defaultMessage:"Risk score:"})))),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement("span",{"data-test-subj":x.Y},a)))}));A.displayName="RiskScore";var w=a(1393),C=a(211),D=a(155),N=a(928),_=a(1493),$=a(1495);const L=Object(i.memo)((()=>{const{dataFormattedForFieldBrowser:e,eventId:t,scopeId:a,isPreview:l,refetchFlyoutData:s,getFieldsData:o}=Object(j.b)(),{isAlert:u,ruleName:c,timestamp:d,ruleId:m}=Object(C.b)(e),p=Object(i.useMemo)((()=>l?r.a.createElement($.a,{title:c,iconType:"warning","data-test-subj":x.B}):r.a.createElement(N.a,{contextId:a,eventId:t,fieldName:E.n,fieldType:"string",isAggregatable:!1,isDraggable:!1,linkValue:m,value:c,openInNewTab:!0},r.a.createElement($.a,{title:c,iconType:"warning",isLink:!0,"data-test-subj":x.B}))),[c,m,t,a,l]),y=r.a.createElement(n.EuiTitle,{size:"s"},r.a.createElement("h2",null,r.a.createElement(g.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.headerTitle",defaultMessage:"Event details"}))),{refetch:v}=Object(w.a)({scopeId:a}),h=Object(i.useMemo)((()=>{var e;return null!==(e=o(f.mb))&&void 0!==e?e:[]}),[o]),O=Object(i.useCallback)((()=>{v(),s()}),[v,s]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(F,null),r.a.createElement(n.EuiSpacer,{size:"m"}),d&&r.a.createElement(D.c,{value:new Date(d)}),r.a.createElement(n.EuiSpacer,{size:"xs"}),r.a.createElement("div",{"data-test-subj":x.B},u&&!Object(b.isEmpty)(c)?p:y),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1},u&&!l&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(I,null)),r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(A,null)),u&&!l&&r.a.createElement(n.EuiFlexItem,{grow:!1},r.a.createElement(_.a,{eventId:t,assignedUserIds:h,onAssigneesUpdated:O}))))}));L.displayName="HeaderTitle";const P=Object(i.memo)((({selectedTabId:e,setSelectedTabId:t,tabs:a})=>{const i=a.map(((a,i)=>r.a.createElement(n.EuiTab,{onClick:()=>{return e=a.id,t(e);var e},isSelected:a.id===e,key:i,"data-test-subj":a["data-test-subj"]},a.name)));return r.a.createElement(l.a,null,r.a.createElement(L,null),r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(d,null,i))}));P.displayName="PanelHeader"},1326:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(50),i=a(481),r=a(110);const l=()=>r.b.get().http,s=({packages:e})=>Object(n.useQuery)(["installedIntegrations",{packages:e}],(async({signal:t})=>{var a;return null!==(a=(await(e=>{var t;const{packages:a,signal:n}=e;return l().fetch(i.a,{method:"GET",version:"1",query:{packages:null==a||null===(t=a.sort())||void 0===t?void 0:t.join(",")},signal:n})})({packages:e,signal:t})).installed_integrations)&&void 0!==a?a:[]}),{keepPreviousData:!0,staleTime:3e5,onError:e=>{}})},1329:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(2),i=a.n(n),r=a(101),l=a(17),s=a(5),o=a(47),u=a(1284);const c=`${a(427).a}JsonTabCopyToClipboard`;var d=a(140);const m=Object(n.memo)((()=>{const{searchHit:e,isPreview:t}=Object(d.b)(),a=JSON.stringify(e,null,2),m=Object(n.useRef)(null),[b,g]=Object(n.useState)();return Object(n.useEffect)((()=>{var e;const a=(null==m||null===(e=m.current)||void 0===e?void 0:e.getBoundingClientRect().top)||0,n=t?0:72,i=window.innerHeight-a-24-24-n;0!==i&&g(i)}),[g,t]),i.a.createElement(l.EuiFlexGroup,{ref:m,direction:"column",gutterSize:"none","data-test-subj":"jsonView"},i.a.createElement(l.EuiFlexItem,null,i.a.createElement(l.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(l.EuiFlexItem,{grow:!1},i.a.createElement(l.EuiCopy,{textToCopy:a},(e=>i.a.createElement(l.EuiButtonEmpty,{iconType:"copyClipboard",size:"xs","aria-label":s.i18n.translate("xpack.securitySolution.flyout.right.jsonTab.copyToClipboardButtonAriaLabel",{defaultMessage:"Copy to clipboard"}),"data-test-subj":c,onClick:()=>Object(u.a)(e,a),onKeyDown:()=>Object(u.a)(e,a)},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.right.jsonTab.copyToClipboardButtonLabel",defaultMessage:"Copy to clipboard"}))))))),i.a.createElement(l.EuiFlexItem,null,i.a.createElement(r.JsonCodeEditor,{json:e,height:b,hasLineNumbers:!0})))}));m.displayName="JsonTab"},133:function(e,t,a){"use strict";a.d(t,"B",(function(){return l})),a.d(t,"cb",(function(){return s})),a.d(t,"X",(function(){return o})),a.d(t,"Y",(function(){return u})),a.d(t,"bb",(function(){return c})),a.d(t,"e",(function(){return d})),a.d(t,"f",(function(){return m})),a.d(t,"d",(function(){return b})),a.d(t,"a",(function(){return g})),a.d(t,"Z",(function(){return f})),a.d(t,"o",(function(){return y})),a.d(t,"n",(function(){return v})),a.d(t,"U",(function(){return h})),a.d(t,"T",(function(){return j})),a.d(t,"S",(function(){return O})),a.d(t,"Q",(function(){return x})),a.d(t,"P",(function(){return S})),a.d(t,"O",(function(){return I})),a.d(t,"N",(function(){return T})),a.d(t,"L",(function(){return M})),a.d(t,"M",(function(){return F})),a.d(t,"H",(function(){return w})),a.d(t,"F",(function(){return C})),a.d(t,"E",(function(){return D})),a.d(t,"D",(function(){return N})),a.d(t,"G",(function(){return _})),a.d(t,"C",(function(){return $})),a.d(t,"J",(function(){return L})),a.d(t,"I",(function(){return P})),a.d(t,"A",(function(){return z})),a.d(t,"y",(function(){return B})),a.d(t,"x",(function(){return R})),a.d(t,"v",(function(){return U})),a.d(t,"w",(function(){return Q})),a.d(t,"z",(function(){return q})),a.d(t,"u",(function(){return H})),a.d(t,"r",(function(){return G})),a.d(t,"q",(function(){return V})),a.d(t,"s",(function(){return Y})),a.d(t,"p",(function(){return K})),a.d(t,"t",(function(){return J})),a.d(t,"K",(function(){return W})),a.d(t,"m",(function(){return Z})),a.d(t,"l",(function(){return X})),a.d(t,"k",(function(){return ee})),a.d(t,"j",(function(){return te})),a.d(t,"i",(function(){return ae})),a.d(t,"h",(function(){return ne})),a.d(t,"g",(function(){return ie})),a.d(t,"R",(function(){return re})),a.d(t,"db",(function(){return le})),a.d(t,"c",(function(){return se})),a.d(t,"b",(function(){return oe})),a.d(t,"ab",(function(){return ue})),a.d(t,"W",(function(){return de})),a.d(t,"V",(function(){return me}));var n=a(427),i=a(331);const r=`${n.a}Header`,l=`${r}Title`,s=`${r}StatusTitle`,o=`${r}RiskScoreTitle`,u=`${r}RiskScoreValue`,c=`${r}ShareButton`,d=`${r}AssigneesHeader`,m=`${r}AssigneesTitle`,b=`${r}AssigneesAddButton`,g=`${n.a}AboutSection`,f=(i.c,i.a,`${n.a}RuleSummaryButton`),p=`${n.a}Description`,y=`${p}Title`,v=`${p}Details`,E=`${n.a}Reason`,h=`${E}Title`,j=`${E}Details`,O=`${E}PreviewButton`,k=`${n.a}MitreAttack`,x=`${k}Title`,S=`${k}Details`,I=`${n.a}InvestigationSection`,T=(i.c,i.a,`${n.a}InvestigationGuide`),M=`${T}Button`,F=`${T}Loading`,A=`${n.a}HighlightedFields`,w=`${A}Title`,C=`${A}Details`,D=`${A}Cell`,N=`${A}BasicCell`,_=`${A}LinkedCell`,$=`${A}AgentStatusCell`,L=`${n.a}Insights`,P=`${n.a}InsightsEntities`,z=`${P}UserOverview`,B=`${z}Loading`,R=`${z}Link`,U=`${z}Domain`,Q=`${z}LastSeen`,q=`${z}RiskLevel`,H=`${P}HostOverview`,G=`${H}Loading`,V=`${H}Link`,Y=`${H}OsFamily`,K=`${H}LastSeen`,J=`${H}RiskLevel`,W=`${n.a}InsightsThreatIntelligence`,Z=`${n.a}Correlations`,X=`${Z}SuppressedAlerts`,ee=`${X}TechnicalPreview`,te=`${Z}RelatedCases`,ae=`${Z}RelatedAlertsBySession`,ne=`${Z}RelatedAlertsBySameSourceEvent`,ie=`${Z}RelatedAlertsByAncestry`,re=`${n.a}InsightsPrevalence`,le=`${n.a}Visualizations`,se=`${n.a}AnalyzerPreview`,oe=`${se}Loading`,ue=`${n.a}SessionPreview`,ce=`${n.a}Response`,de=`${ce}Section`,me=(i.c,i.a,`${ce}Button`)},1359:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a(45);const r=(e,t,a)=>{const n=a[e];return Array.isArray(n)?n.map((e=>Object(i.getOr)(null,t,e))).filter((e=>null!==e)):Object(i.getOr)(void 0,t,n)},l=e=>{const t=Object(n.useMemo)((()=>e),[e]),a=Object(n.useMemo)((()=>({})),[]),i=Object(n.useCallback)(((e,t)=>{a[e]=t}),[a]);return Object(n.useCallback)((e=>{let n;return n=Object.hasOwn(a,e)?a[e]:t?((e,t,a)=>{if(e&&t){if(Object.hasOwn(t,e))return t[e];{const n=(e=>{const t=(e=>{const t=RegExp("[.]","g"),a=[];let n=t.exec(e);for(;n;)a.push(n.index),n=t.exec(e);return a.reverse()})(e);return t.map((t=>[e.slice(0,t),e.slice(t+1)]))})(e);for(const[i,l]of n)if(Object.hasOwn(t,i)&&t[i]){const n=r(i,l,t);return a(e,n),n}}}})(e,t,i):void 0,Array.isArray(n)&&0===n.length?void 0:n}),[i,a,t])}},1360:function(e,t,a){"use strict";a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o})),a.d(t,"e",(function(){return u}));var n=a(427);const i=`${n.a}Error`,r=`${n.a}Loading`,l=`${n.a}Navigation`,s=`${l}ExpandDetailButton`,o=`${l}CollapseDetailButton`,u=`${l}Actions`},1361:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(578),r=a(112);const l=Object(i.getSelectedDataviewSelector)(),s=e=>{const t=Object(r.a)((t=>l(t,e)));return Object(n.useCallback)((e=>{const a=null==t?void 0:t.fields;return a&&a[e]}),[null==t?void 0:t.fields])}},1366:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return r})),a.d(t,"h",(function(){return l})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"d",(function(){return u})),a.d(t,"g",(function(){return c})),a.d(t,"f",(function(){return d}));var n=a(142);n.r,n.r,n.r;const i=`${n.r}.group.id`,r=(n.r,`${n.r}.original_time`),l=`${n.r}.threshold_result`,s=`${n.r}.new_terms`,o=`${n.J}.new_terms_fields`,u=`${n.r}.original_event`,c=(n.H,n.H,n.H,n.H,n.H,n.H,n.H,n.H,n.H,n.H,`${n.H}.timeline_id`),d=(n.H,n.H,`${n.H}.indices`)},1367:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o}));var n=a(2),i=a.n(n),r=a(166),l=a(1100);const s="bytes",o=i.a.memo((({contextId:e,eventId:t,fieldName:a,fieldType:n,isAggregatable:s,isDraggable:o,value:u,scopeId:c})=>o?i.a.createElement(r.b,{id:`bytes-default-draggable-${e}-${t}-${a}-${u}`,fieldType:n,isAggregatable:s,isDraggable:o,name:name,field:a,tooltipContent:null,value:u,scopeId:c},i.a.createElement(l.a,{value:`${u}`})):i.a.createElement(l.a,{value:`${u}`})));o.displayName="Bytes"},1386:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a(48),r=a(1482),l=a(127),s=a(262);const o=({alertStatus:e,closePopover:t,eventId:a,scopeId:o,refetch:u})=>{const c=Object(i.useDispatch)(),{hasIndexWrite:d}=Object(s.a)(),m=Object(n.useCallback)((()=>{t(),u&&u()}),[t,u]),b=Object(l.getScopedActions)(o),g=Object(n.useCallback)((({eventIds:e,isLoading:t})=>{b&&c(b.setEventsLoading({id:o,eventIds:e,isLoading:t}))}),[c,o,b]),f=Object(n.useCallback)((({eventIds:e,isDeleted:t})=>{b&&c(b.setEventsDeleted({id:o,eventIds:e,isDeleted:t}))}),[c,o,b]),p=Object(r.a)({eventIds:[a],currentStatus:e,setEventsLoading:g,setEventsDeleted:f,onUpdateSuccess:m,onUpdateFailure:m});return{actionItems:d?p:[]}}},1387:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={BULK_QUERY_STATUS_UPDATE:"Data table bulkQueryStatusUpdate",BULK_STATUS_UPDATE:"Data table bulkStatusUpdate",STATUS_UPDATE:"Data table statusUpdate"}},1388:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(50),i=a(110),r=a(117),l=a(1296);const s=({uids:e})=>{const{security:t}=Object(i.i)().services,{addError:a}=Object(r.a)();return Object(n.useQuery)(["useBulkGetUserProfiles",...e],(async()=>(async({security:e,uids:t})=>0===t.size?[]:e.userProfiles.bulkGet({uids:t,dataPath:"avatar"}))({security:t,uids:e})),{retry:!1,staleTime:1/0,onError:e=>{a(e,{title:l.c})}})}},1389:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return s}));var n=a(9),i=a(1166);const r=e=>{var t,a,n,i,r,l,s;return null!==(t=null!==(a=null===(n=e.user)||void 0===n||null===(i=n.full_name)||void 0===i?void 0:i.toLowerCase())&&void 0!==a?a:null===(r=e.user)||void 0===r||null===(l=r.email)||void 0===l?void 0:l.toLowerCase())&&void 0!==t?t:null===(s=e.user)||void 0===s?void 0:s.username.toLowerCase()},l=(e,t)=>((e,t)=>{if(!t)return;if(!e)return t;if(!t.find((t=>t.uid===e.uid)))return t;const a=t.filter((t=>t.uid!==e.uid));return[e,...a]})(e,(e=>{if(e)return Object(n.sortBy)(e,r)})(t)),s=e=>e.filter((e=>e!==i.b))},1390:function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return s}));var n=a(45),i=a(204),r=a(196);const l=(e,t)=>e?e.map((e=>{const a=e.id.split("."),i=a.length>1?a[0]:(({browserFields:e,field:t})=>Object(n.has)(`base.fields.${t}`,e)?"base":t)({field:e.id,browserFields:t});return{...e,...Object(n.get)([i,"fields",e.id],t)}})):[],s=(e,t)=>{var a;return{columnHeaderType:r.a,id:e,initialWidth:i.a,...null!==(a=t.find((t=>t.id===e)))&&void 0!==a?a:{}}}},1392:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a.n(n),r=a(166),l=a(126),s=a(137);const o=i.a.memo((({Component:e,contextId:t,eventId:a,fieldName:n,fieldType:o,isAggregatable:u,isDraggable:c,title:d,value:m})=>c?i.a.createElement(r.b,{"data-test-subj":"port",field:n,fieldType:o,isAggregatable:u,id:`port-default-draggable-${t}-${a}-${n}-${m}`,isDraggable:c,tooltipContent:n,value:m},i.a.createElement(s.i,{portOrServiceName:m||Object(l.e)(),Component:e,title:d})):i.a.createElement(s.i,{portOrServiceName:m||Object(l.e)(),Component:e,title:d})));o.displayName="Port"},1393:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(112),r=a(127),l=a(128);const s=({scopeId:e})=>{const t=l.d.globalQuery(),a=l.d.timelineQueryByIdSelector(),{globalQuery:s,timelineQuery:o}=Object(i.a)((n=>({globalQuery:t(n),timelineQuery:a(n,e)}))),u=e=>{e.forEach((e=>e.refetch&&e.refetch()))};return{refetch:Object(n.useCallback)((()=>{Object(r.isActiveTimeline)(e)?u([o]):u(s)}),[e,o,s])}}},1394:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),i=a.n(n),r=a(17),l=a(569),s=a(1080),o=a(285);const u=i.a.memo((({contextId:e,data:t,eventId:a,fieldFromBrowserField:n,getLinkValue:u,isDraggable:c=!1,linkValue:d,style:m,values:b})=>i.a.createElement(r.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":`event-field-${t.field}`,direction:"column",gutterSize:"none",style:m},null!=b&&b.map(((m,b)=>{var g;return null==n?i.a.createElement(r.EuiFlexItem,{grow:!1,key:`${b}-${m}`},i.a.createElement(r.EuiText,{size:"xs",key:`${b}-${m}`},m)):i.a.createElement(r.EuiFlexItem,{className:"eventFieldsTable__fieldValue",grow:!1,key:`${b}-${m}`},t.field===o.i?i.a.createElement(l.a,{value:m}):i.a.createElement(s.a,{contextId:`${e}-${a}-${t.field}-${b}-${m}`,eventId:a,fieldFormat:t.format,fieldName:t.field,fieldFromBrowserField:n,fieldType:t.type,isAggregatable:n.aggregatable,isDraggable:c,isObjectArray:t.isObjectArray,value:m,linkValue:null!==(g=u&&u(t.field))&&void 0!==g?g:d,truncate:!1}))})))));u.displayName="FieldValueCell"},140:function(e,t,a){"use strict";a.d(t,"a",(function(){return m})),a.d(t,"b",(function(){return b}));var n=a(2),i=a.n(n),r=a(124),l=a(901),s=a(491),o=a(394),u=a(211),c=a(428);const d=Object(n.createContext)(void 0),m=Object(n.memo)((({id:e,indexName:t,scopeId:a,children:m})=>{const{browserFields:b,dataAsNestedObject:g,dataFormattedForFieldBrowser:f,getFieldsData:p,loading:y,refetchFlyoutData:v,searchHit:E}=Object(l.a)({eventId:e,indexName:t}),{ruleId:h}=Object(u.b)(f),{rule:j}=Object(c.a)(h),O=Object(n.useMemo)((()=>{var n,i;return e&&t&&a&&g&&f&&E?{eventId:e,indexName:t,scopeId:a,browserFields:b,dataAsNestedObject:g,dataFormattedForFieldBrowser:f,searchHit:E,investigationFields:null!==(n=null==j||null===(i=j.investigation_fields)||void 0===i?void 0:i.field_names)&&void 0!==n?n:[],refetchFlyoutData:v,getFieldsData:p,isPreview:a===r.e.rulePreview}:void 0}),[e,j,t,a,b,g,f,E,v,p]);return y?i.a.createElement(o.a,null):O?i.a.createElement(d.Provider,{value:O},m):i.a.createElement(s.a,null)}));m.displayName="RightPanelProvider";const b=()=>{const e=Object(n.useContext)(d);if(!e)throw new Error("RightPanelContext can only be used within RightPanelContext provider");return e}},1422:function(e,t,a){"use strict";a.d(t,"b",(function(){return M})),a.d(t,"a",(function(){return F}));var n=a(2),i=a.n(n),r=a(44),l=a.n(r),s=a(17),o=(a(13),a(47)),u=a(45),c=a(142),d=a(5),m=a(63),b=a(68),g=a(124),f=a(147),p=a(116),y=a(1297),v=a(212);const E=(e,t)=>{const{cases:a}=Object(m.useKibana)().services,{addToExistingCase:r,addToNewCaseClick:l,addToNewTimeline:E}=((e,t)=>{const{from:a,to:i}=Object(f.a)(),r=Object(y.a)({localFilters:[],from:a,to:i,scopeId:p.SourcererScopeName.detections,tableId:g.e.riskInputs}),{cases:l}=Object(v.b)().services,s=null==l?void 0:l.hooks.useCasesAddToNewCaseFlyout({onSuccess:u.noop}),o=null==l?void 0:l.hooks.useCasesAddToExistingCaseModal(),d=Object(n.useMemo)((()=>e.map((e=>({alertId:e._id,index:e._index,type:b.AttachmentType.alert,rule:{id:Object(u.get)(c.V,e.fields)[0],name:Object(u.get)(c.G,e.fields)[0]}})))),[e]);return Object(n.useMemo)((()=>({addToExistingCase:()=>{t(),o.open({getAttachments:()=>d})},addToNewCaseClick:()=>{t(),s.open({attachments:d})},addToNewTimeline:()=>{t(),r.onClick(e.map((e=>({_id:e._id,_index:e._index,data:[],ecs:{_id:e._id,_index:e._index}}))),!1,u.noop,u.noop,u.noop)}})),[e,d,t,s,o,r])})(e,t),h=null==a?void 0:a.helpers.canUseCases([b.SECURITY_SOLUTION_OWNER]),j=(null==h?void 0:h.create)&&(null==h?void 0:h.read);return Object(n.useMemo)((()=>{var t;const a={name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.actions.addToNewTimeline",defaultMessage:"Add to new timeline"}),onClick:E},n=null!==(t=Object(u.get)(["fields",c.G],e[0]))&&void 0!==t?t:[""],m=d.i18n.translate("xpack.securitySolution.flyout.entityDetails.riskInputs.actions.title",{defaultMessage:"Risk input: {description}",values:{description:1===e.length?n[0]:d.i18n.translate("xpack.securitySolution.flyout.entityDetails.riskInputs.actions.titleDescription",{defaultMessage:"{quantity} selected",values:{quantity:e.length}})}});return[{title:i.a.createElement(s.EuiTextTruncate,{width:230,text:m}),id:0,items:j?[a,{name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.actions.addToNewCase",defaultMessage:"Add to new case"}),onClick:l},{name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.actions.addToExistingCase",defaultMessage:"Add to existing case"}),onClick:r}]:[a]}]}),[r,l,E,e,j])},h=({alert:e})=>{const[t,a]=Object(n.useState)(!1),r=Object(n.useCallback)((()=>a(!1)),[]),l=Object(n.useCallback)((()=>a((e=>!e))),[]),o=Object(n.useMemo)((()=>[e]),[e]),u=E(o,r);return i.a.createElement(s.EuiPopover,{"data-test-subj":"risk-inputs-actions",button:i.a.createElement(s.EuiButtonIcon,{onClick:l,iconType:"boxesHorizontal","aria-label":d.i18n.translate("xpack.securitySolution.flyout.entityDetails.riskInputs.actions.ariaLabel",{defaultMessage:"Actions"}),color:"text"}),isOpen:t,closePopover:r,panelPaddingSize:"none",anchorPosition:"downLeft"},i.a.createElement(s.EuiContextMenu,{initialPanelId:0,panels:u}))};var j=a(155);const O=i.a.memo((({selectedAlerts:e,pagination:t})=>{var a;const{euiTheme:r}=Object(s.useEuiTheme)(),[l,u]=Object(n.useState)(!1),c=Object(n.useCallback)((()=>u(!l)),[l]),d=Object(n.useCallback)((()=>u(!1)),[]),m=E(e,d),b=t.pageIndex+1,g=null!==(a=t.pageSize)&&void 0!==a?a:10,f=t.pageIndex*g+1,p=Math.min(t.totalItemCount,g*b);return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiFlexGroup,{"data-test-subj":"risk-input-utility-bar",alignItems:"center",justifyContent:"flexStart",gutterSize:"m"},i.a.createElement(k,{grow:!1,$_css:r.size.s},i.a.createElement(s.EuiText,{size:"xs"},t.totalItemCount<=1?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.utilityBar.selectionTextSingle",defaultMessage:"Showing {totalInputs} {riskInputs}",values:{totalInputs:t.totalItemCount,riskInputs:i.a.createElement("b",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.utilityBar.riskInput",defaultMessage:"Risk input"}))}}):i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.utilityBar.selectionTextRange",defaultMessage:"Showing {displayedRange} of {totalInputs} {riskInputs}",values:{displayedRange:i.a.createElement("b",null,`${f}-${p}`),totalInputs:t.totalItemCount,riskInputs:i.a.createElement("b",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.utilityBar.riskInputs",defaultMessage:"Risk inputs"}))}}))),i.a.createElement(s.EuiFlexItem,{grow:!1},e.length>0&&i.a.createElement(s.EuiPopover,{isOpen:l,closePopover:d,panelPaddingSize:"none",button:i.a.createElement(s.EuiButtonEmpty,{onClick:c,size:"xs",iconSide:"right",iconType:"arrowDown",flush:"left"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.utilityBar.text",defaultMessage:"{totalSelectedInputs} selected risk input",values:{totalSelectedInputs:e.length}}))},i.a.createElement(s.EuiContextMenu,{panels:m,initialPanelId:0})))))}));O.displayName="RiskInputsUtilityBar";var k=l()(s.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-k6rqc6-0"})(["padding:"," 0;"],(e=>e.$_css)),x=a(1491),S=a(1067);const I=({riskInputs:e})=>{const[t,a]=Object(n.useState)([]),r=Object(n.useMemo)((()=>e.map((({id:e})=>e))),[e]),{loading:l,data:d}=Object(x.a)({alertIds:r}),m=Object(n.useMemo)((()=>({onSelectionChange:e=>{a(e)},initialSelected:[],selectable:()=>!0})),[]),b=Object(n.useMemo)((()=>[{name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.actionsColumn",defaultMessage:"Actions"}),width:"80px",render:e=>i.a.createElement(h,{alert:e})},{field:"fields.@timestamp",name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.dateColumn",defaultMessage:"Date"}),truncateText:!1,mobileOptions:{show:!0},sortable:!0,width:"30%",render:e=>i.a.createElement(j.c,{value:new Date(e)})},{field:"fields","data-test-subj":"risk-input-table-description-cell",name:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.riskInputColumn",defaultMessage:"Risk input"}),truncateText:!0,mobileOptions:{show:!0},sortable:!0,render:e=>Object(u.get)(c.G,e)}]),[]),[g,f]=Object(n.useState)({index:0,size:10}),p=Object(n.useCallback)((({page:e})=>{f(e)}),[]),y=Object(n.useMemo)((()=>({totalItemCount:e.length,pageIndex:g.index,pageSize:g.size})),[g.index,g.size,e.length]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(T,{"data-test-subj":"risk-inputs-panel",$_css:Object(s.useEuiBackgroundColor)("subdued")},i.a.createElement(s.EuiTitle,null,i.a.createElement("h2",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.title",defaultMessage:"Risk Inputs"}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiTitle,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs.alertsTitle",defaultMessage:"Alerts"}))),i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(O,{pagination:y,selectedAlerts:t}),i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiInMemoryTable,{compressed:!0,loading:l,items:null!=d?d:[],columns:b,pagination:!0,sorting:!0,selection:m,onTableChange:p,isSelectable:!0,itemId:"_id"})))};I.displayName="RiskInputsPanelContent";var T=l()(S.a).withConfig({displayName:"_StyledFlyoutBody",componentId:"sc-yqxm24-0"})(["background-color:",";"],(e=>e.$_css));const M="all-risk-inputs",F=({riskInputs:e})=>i.a.createElement(I,{riskInputs:e});F.displayName="RiskInputsPanel"},1439:function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return k})),a.d(t,"c",(function(){return x}));var n=a(56),i=a.n(n),r=a(126),l=a(5);const s=l.i18n.translate("xpack.securitySolution.formatted.duration.noDurationTooltip",{defaultMessage:"no duration"}),o=l.i18n.translate("xpack.securitySolution.formatted.duration.invalidDurationTooltip",{defaultMessage:"invalid duration"}),u=l.i18n.translate("xpack.securitySolution.formatted.duration.aNanosecondTooltip",{defaultMessage:"a nanosecond"}),c=l.i18n.translate("xpack.securitySolution.formatted.duration.aFewNanosecondsTooltip",{defaultMessage:"a few nanoseconds"}),d=l.i18n.translate("xpack.securitySolution.formatted.duration.aMillisecondTooltip",{defaultMessage:"a millisecond"}),m=l.i18n.translate("xpack.securitySolution.formatted.duration.aFewMillisecondsTooltip",{defaultMessage:"a few milliseconds"}),b=l.i18n.translate("xpack.securitySolution.formatted.duration.aSecondTooltip",{defaultMessage:"a second"}),g=l.i18n.translate("xpack.securitySolution.formatted.duration.zeroNanosecondsTooltip",{defaultMessage:"zero nanoseconds"}),f=1e6,p=1e3,y=e=>Number.isInteger(e.milliseconds())?`${e.milliseconds()}ms`:`${e.milliseconds().toFixed(6)}ms`,v=e=>`${e.seconds().toFixed()}s${e.milliseconds()>0?` ${y(e)}`:""}`,E=e=>`${e.minutes()}m ${v(e)}`,h=e=>`${e.hours()}h ${E(e)}`,j=e=>`${e.days()}d ${h(e)}`,O=e=>`${e.years()>0||e.months()>0?`${e.months()}m `:""}${j(e)}`,k=e=>{const t=Number(e);if(null==e)return Object(r.e)();if(Number.isNaN(t)||t<0)return`${e}`;if(t<f)return`${t}ns`;const a=i.a.duration(t/f),n=a.asMilliseconds();return n<p?y(a):n<6e4?v(a):n<36e5?E(a):n<864e5?h(a):n<2592e6?j(a):n<31536e6?O(a):(e=>`${e.years()>0?`${e.years()}y `:""}${O(e)}`)(a)},x=e=>{if(null==e)return s;const t=Number(e);if(Number.isNaN(t)||t<0)return o;if(0===t)return g;if(1===t)return u;if(t<f)return c;if(t===f)return d;const a=t/f;return a<p?m:a===p?b:i.a.duration(a).humanize()}},1441:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(50),i=a(76);const r=a(5).i18n.translate("xpack.securitySolution.connectors.useLoadConnectors.errorMessage",{defaultMessage:"Error loading connectors. Please check your configuration and try again."});var l=a(110);const s=({actionTypeId:e,toasts:t})=>{const a=Object(l.h)();return Object(n.useQuery)(["load-connectors",e],(async()=>(await Object(i.loadAllActions)({http:a})).filter((t=>!t.isMissingSecrets&&t.actionTypeId===e))),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:r}))}})}},1461:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(2),i=a.n(n),r=a(275),l=a(214),s=a(1462);const o=({index:e=0,score:t})=>{const a=Object(s.a)(t.severity);return i.a.createElement(r.c,{mode:r.a.HOVER_DOWN,data:{value:t.entityValue,field:t.entityName},triggerId:r.d.DEFAULT,visibleCellActions:5},i.a.createElement(i.a.Fragment,null,0!==e&&i.a.createElement(i.a.Fragment,null,",",i.a.createElement(l.i,null)),a))};o.displayName="ScoreComponent";const u=i.a.memo(o);u.displayName="Score"},1462:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(2),i=a.n(n),r=a(17);const l=e=>String(Math.ceil(e));i.a.memo((({score:e})=>{const t=l(e),a=s(e);return i.a.createElement(r.EuiHealth,{color:a},t)})).displayName="ScoreHealth";const s=e=>e>=75?"#fe5050":e>=50?"#fba740":e>=25?"#fdec25":e>=3?"#8bc8fb":e>=0?"#d2e9f7":"#ffffff"},1463:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a.n(n),r=a(17),l=a(86),s=a(110);const o=({score:e,startDate:t,endDate:a,linkName:n})=>{const{services:{ml:o,http:u}}=Object(s.i)(),c=Object(l.useMlHref)(o,u.basePath.get(),{page:"explorer",pageState:{jobIds:[e.jobId],timeRange:{from:new Date(t).toISOString(),to:new Date(a).toISOString(),mode:"absolute"},refreshInterval:{pause:!0,value:0,display:"Off"}}},[e.jobId]);return c?i.a.createElement(r.EuiLink,{href:c,target:"_blank","data-test-subj":`explorer-link-${e.jobId}`},n):null}},1464:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=a(5).i18n.translate("xpack.securitySolution.components.ml.anomaly.errors.anomaliesTableFetchFailureTitle",{defaultMessage:"Anomalies table fetch failure"})},1482:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a(151),r=a(925),l=a(1158),s=a(117),o=a(184),u=a(1387);const c=({eventIds:e,currentStatus:t,query:a,setEventsLoading:c,showAlertStatusActions:d=!0,setEventsDeleted:m,onUpdateSuccess:b,onUpdateFailure:g,customBulkActions:f})=>{const{addSuccess:p,addError:y,addWarning:v}=Object(s.a)(),{startTransaction:E}=Object(o.b)(),h=Object(n.useCallback)(((e,t,a)=>{if(t>0)v({title:r.x(t),text:r.y(e,t)});else{let t;switch(a){case"closed":t=r.p(e);break;case"open":t=r.r(e);break;case"acknowledged":t=r.b(e)}p({title:t})}b&&b(e,t,a)}),[p,v,b]),j=Object(n.useCallback)(((e,t)=>{let a;switch(e){case"closed":a=r.o;break;case"open":a=r.q;break;case"acknowledged":a=r.a}y(t.message,{title:a}),g&&g(e,t)}),[y,g]),O=Object(n.useCallback)((async t=>{a?E({name:u.a.BULK_QUERY_STATUS_UPDATE}):e.length>1?E({name:u.a.BULK_STATUS_UPDATE}):E({name:u.a.STATUS_UPDATE});try{var n,i;c({eventIds:e,isLoading:!0});const s=await Object(l.a)({status:t,query:a&&JSON.parse(a),signalIds:e});if(m({eventIds:e,isDeleted:!0}),s.version_conflicts&&1===e.length)throw new Error(r.l);h(null!==(n=s.updated)&&void 0!==n?n:0,null!==(i=s.version_conflicts)&&void 0!==i?i:0,t)}catch(e){j(t,e)}finally{c({eventIds:e,isLoading:!1})}}),[c,e,a,m,h,j,E]);return Object(n.useMemo)((()=>{const n=[];d&&(t!==i.d&&n.push({key:"open","data-test-subj":"open-alert-status",onClick:()=>O(i.d),name:r.m}),t!==i.b&&n.push({key:"acknowledge","data-test-subj":"acknowledged-alert-status",onClick:()=>O(i.b),name:r.j}),t!==i.c&&n.push({key:"close","data-test-subj":"close-alert-status",onClick:()=>O(i.c),name:r.k}));const l=f?f.reduce(((t,n)=>{const i=!(!a||!n.disableOnQuery);return t.push({key:n.key,disabled:i,"data-test-subj":n["data-test-subj"],toolTipContent:i?n.disabledLabel:null,onClick:()=>n.onClick(e),name:n.label}),t}),[]):[];return[...n,...l]}),[t,f,e,O,a,d])}},1489:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(45);const i=e=>null==e?"":Object(n.isObject)(e)?JSON.stringify(e):Object(n.isNumber)(e)?e:e.toString()},1490:function(e,t,a){"use strict";a.d(t,"b",(function(){return $})),a.d(t,"a",(function(){return L}));var n=a(45),i=a(56),r=a.n(i),l=a(65),s=a.n(l),o=a(53),u=a(5),c=a(142),d=a(3),m=a(1366),b=a(122),g=a(113),f=a(573),p=a(134),y=a(162),v=a(172),E=a(127),h=a(1169),j=a(193),O=a(110),k=a(4),x=a(755),S=a(281);a(1158);const I=({ecs:e})=>{if(Array.isArray(e)){const t=e.reduce(((e,t)=>{const a=t.timestamp?new Date(t.timestamp):new Date;return e.includes(a.valueOf())?e:[...e,a.valueOf()]}),[]);return{from:new Date(Math.min(...t)).toISOString(),to:new Date(Math.max(...t)).toISOString()}}const t=e,a=Object(E.getField)(t,c.D),n=r.a.duration(r()().diff(s.a.parse(null!=a?a[0]:"now-1d"))),i=Object(E.getField)(t,c.yb),l=Array.isArray(i)?i[0]:i,o=r()(null!=l?l:new Date).toISOString();return{to:o,from:r()(o).subtract(n).toISOString()}},T=e=>{const t=Object(E.getField)(e,c.R);return"threshold"===t||Array.isArray(t)&&t.length>0&&"threshold"===t[0]},M=e=>{const t=Object(E.getField)(e,c.R);return"new_terms"===t||Array.isArray(t)&&t.length>0&&"new_terms"===t[0]},F=e=>null!=Object(E.getField)(e,c.cb),A=(e,t,a="Alert Ids")=>1===t.length?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:e,params:{query:t[0]}},query:{match_phrase:{_id:t[0]}},$state:{store:o.FilterStateStore.APP_STATE}}]:[{query:{bool:{filter:{ids:{values:t}}}},meta:{alias:a,negate:!1,disabled:!1,type:"phrases",key:e,value:t.join(),params:t},$state:{store:o.FilterStateStore.APP_STATE}}],w=(e,t)=>{const a=1===t.length;return[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${b.c.active}-alert-id-${t.join(",")}`,name:t.join(","),enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:a?t[0]:t,operator:a?":":"includes"}}]},C=(e,t,a)=>({filters:"KqlFilter"===t?A("_id",e,a):[],dataProviders:"dataProvider"===t?w("_id",e):[]}),D=async(e,t,a,n,i)=>{try{var l,o,d,g,f,y,v,h,j,I,T,M,F,A,w,C,D,N,_,$,L,P;const u=await O.b.get().http.fetch(k.gb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(x.a)([e._id]))}),S=(null!==(l=null==u?void 0:u.hits.hits.reduce(((e,{_id:t,_index:a,_source:n={}})=>[...e,{...Object(x.b)(n),_id:t,_index:a,timestamp:n["@timestamp"]}]),[]))&&void 0!==l?l:[])[0],z=Object(E.getField)(S,c.J),B=Object(E.getField)(S,c.y),R=(null!==(o=null!==(d=z.filters)&&void 0!==d?d:null===(g=S.signal)||void 0===g||null===(f=g.rule)||void 0===f?void 0:f.filters)&&void 0!==o?o:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),U=null!==(y=null!==(v=z.language)&&void 0!==v?v:null===(h=S.signal)||void 0===h||null===(j=h.rule)||void 0===j?void 0:j.language)&&void 0!==y?y:"kuery",Q=null!==(I=null!==(T=z.query)&&void 0!==T?T:null===(M=S.signal)||void 0===M||null===(F=M.rule)||void 0===F?void 0:F.query)&&void 0!==I?I:"",q=null!==(A=null!==(w=Object(E.getField)(S,m.f))&&void 0!==w?w:null===(C=S.signal)||void 0===C||null===(D=C.rule)||void 0===D?void 0:D.index)&&void 0!==A?A:[],{thresholdFrom:H,thresholdTo:G,dataProviders:V}=(e=>(Array.isArray(e)?e:[e]).reduce(((e,t)=>{var a,n,i,l;const o=null!==(a=Object(E.getField)(t,`${c.J}.threshold`))&&void 0!==a?a:null===(n=t.signal)||void 0===n||null===(i=n.rule)||void 0===i?void 0:i.threshold,u=Object(E.getField)(t,m.h),d=Object(E.getField)(t,m.e),g=Array.isArray(d)?d[0]:d,f=r()(g),p=((e,t)=>{const a=Object(E.getField)(e,c.D),n=Array.isArray(a)?a[0]:a,i=s.a.parse(n),l=r()(),o=r.a.duration(l.diff(i));return t.clone().subtract(o)})(t,f),y=Array.isArray(o.field)?o.field:[o.field];return{thresholdFrom:null!==(l=u.from)&&void 0!==l?l:p.toISOString(),thresholdTo:f.toISOString(),dataProviders:[...e.dataProviders,...y.reduce(((e,t,a)=>{const n=u.terms.filter((e=>e.field===t))[0].value,i=Array.isArray(n)?n[0]:n;if(!i)return e;const r=t.replace(".","-"),l={id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${b.c.active}-${r}-${i}`,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:t,value:i,operator:":"}};return 0===a?[...e,{...l,and:[]}]:(e[0].and.push(l),e)}),[])]}}),{dataProviders:[],thresholdFrom:"",thresholdTo:""}))(S),Y=await i(e),K=(null!==(N=n.filters)&&void 0!==N?N:R).concat(Y?[Y]:[]);return t({from:H,notes:null,timeline:{...p.b,columns:null!==(_=n.columns)&&void 0!==_?_:p.b.columns,description:`_id: ${S._id}`,filters:K,dataProviders:null!==($=n.dataProviders)&&void 0!==$?$:V,id:b.c.active,indexNames:q,dateRange:{start:H,end:G},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:U,expression:null!==(L=n.query)&&void 0!==L?L:Q},serializedQuery:null!==(P=n.query)&&void 0!==P?P:Q}}},to:G,ruleNote:a,ruleAuthor:B})}catch(a){const{toasts:n}=O.b.get().notifications;n.addError(a,{toastMessage:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createThresholdTimelineFailureTitle",{defaultMessage:"Failed to create threshold alert timeline"})});const i=S.a.toISOString(),r=S.b.toISOString();return t({from:i,notes:null,timeline:{...p.b,id:b.c.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},N=async(e,t,a,n,i)=>{try{var l,s,o,d,g,f,y,v,h,j,I,T,M,F,A,w,C,D,N,_,$,L;const u=await O.b.get().http.fetch(k.gb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(x.a)([e._id]))}),S=(null!==(l=null==u?void 0:u.hits.hits.reduce(((e,{_id:t,_index:a,_source:n={}})=>[...e,{...Object(x.b)(n),_id:t,_index:a,timestamp:n["@timestamp"]}]),[]))&&void 0!==l?l:[])[0],P=Object(E.getField)(S,c.J),z=(null!==(s=null!==(o=P.filters)&&void 0!==o?o:null===(d=S.signal)||void 0===d||null===(g=d.rule)||void 0===g?void 0:g.filters)&&void 0!==s?s:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),B=null!==(f=null!==(y=P.language)&&void 0!==y?y:null===(v=S.signal)||void 0===v||null===(h=v.rule)||void 0===h?void 0:h.language)&&void 0!==f?f:"kuery",R=null!==(j=null!==(I=P.query)&&void 0!==I?I:null===(T=S.signal)||void 0===T||null===(M=T.rule)||void 0===M?void 0:M.query)&&void 0!==j?j:"",U=null!==(F=null!==(A=Object(E.getField)(S,m.f))&&void 0!==A?A:null===(w=S.signal)||void 0===w||null===(C=w.rule)||void 0===C?void 0:C.index)&&void 0!==F?F:[],{from:Q,to:q,dataProviders:H}=(e=>{var t;const a=Array.isArray(e)?e[0]:e,n=Object(E.getField)(a,m.e),i=(null!==(t=Object(E.getField)(a,`${c.J}.new_terms_fields`))&&void 0!==t?t:[]).map(((e,t)=>{const n=e.replace(".","-"),i=Object(E.getField)(a,m.b)[t];return{id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${b.c.active}-${n}-${i}`,name:e,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e,value:i,operator:":"},and:[]}})),l=i.length?[{...i[0],and:i.slice(1)}]:[];return{from:n,to:r()().toISOString(),dataProviders:l}})(S),G=await i(e),V=(null!==(D=n.filters)&&void 0!==D?D:z).concat(G?[G]:[]);return t({from:Q,notes:null,timeline:{...p.b,columns:null!==(N=n.columns)&&void 0!==N?N:p.b.columns,description:`_id: ${S._id}`,filters:V,dataProviders:null!==(_=n.dataProviders)&&void 0!==_?_:H,id:b.c.active,indexNames:U,dateRange:{start:Q,end:q},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:B,expression:null!==($=n.query)&&void 0!==$?$:R},serializedQuery:null!==(L=n.query)&&void 0!==L?L:R}}},to:q,ruleNote:a})}catch(a){const{toasts:n}=O.b.get().notifications;n.addError(a,{toastMessage:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createNewTermsTimelineFailureTitle",{defaultMessage:"Failed to create new terms alert timeline"})});const i=S.a.toISOString(),r=S.b.toISOString();return t({from:i,notes:null,timeline:{...p.b,id:b.c.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},_=async(e,t,a,n,i)=>{try{var r,l,s,o,d,g,f,y,v,h,j,I,T,M,F,A,w,C,D,N,_,$;const u=await O.b.get().http.fetch(k.gb,{version:"2023-10-31",method:"POST",body:JSON.stringify(Object(x.a)([e._id]))}),S=(null!==(r=null==u?void 0:u.hits.hits.reduce(((e,{_id:t,_index:a,_source:n={}})=>[...e,{...Object(x.b)(n),_id:t,_index:a,timestamp:n["@timestamp"]}]),[]))&&void 0!==r?r:[])[0],L=Object(E.getField)(S,c.J),P=(null!==(l=null!==(s=L.filters)&&void 0!==s?s:null===(o=S.signal)||void 0===o||null===(d=o.rule)||void 0===d?void 0:d.filters)&&void 0!==l?l:[]).map((e=>null!=e.meta?e:{...e,meta:{}})),z=null!==(g=null!==(f=L.language)&&void 0!==f?f:null===(y=S.signal)||void 0===y||null===(v=y.rule)||void 0===v?void 0:v.language)&&void 0!==g?g:"kuery",B=null!==(h=null!==(j=L.query)&&void 0!==j?j:null===(I=S.signal)||void 0===I||null===(T=I.rule)||void 0===T?void 0:T.query)&&void 0!==h?h:"",R=null!==(M=null!==(F=Object(E.getField)(S,m.f))&&void 0!==F?F:null===(A=S.signal)||void 0===A||null===(w=A.rule)||void 0===w?void 0:w.index)&&void 0!==M?M:[],{from:U,to:Q,dataProviders:q}=(e=>{const t=Array.isArray(e)?e[0]:e,a=Object(E.getField)(t,c.fb),n=Object(E.getField)(t,c.db),i=Object(E.getField)(t,c.gb).map((e=>{const t=e.field.replace(".","-"),a=`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${b.c.active}-${t}-${e.value}`;return null==e.value?{id:a,name:t,enabled:!0,excluded:!0,kqlQuery:"",queryMatch:{field:e.field,value:"",operator:":*"}}:{id:a,name:t,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:e.field,value:e.value,operator:":"}}}));return{from:a,to:n,dataProviders:[{...i[0],and:i.slice(1)}]}})(S),H=await i(e),G=(null!==(C=n.filters)&&void 0!==C?C:P).concat(H?[H]:[]);return t({from:U,notes:null,timeline:{...p.b,columns:null!==(D=n.columns)&&void 0!==D?D:p.b.columns,description:`_id: ${S._id}`,filters:G,dataProviders:null!==(N=n.dataProviders)&&void 0!==N?N:q,id:b.c.active,indexNames:R,dateRange:{start:U,end:Q},eventType:"all",kqlQuery:{filterQuery:{kuery:{kind:z,expression:null!==(_=n.query)&&void 0!==_?_:B},serializedQuery:null!==($=n.query)&&void 0!==$?$:B}}},to:Q,ruleNote:a})}catch(a){const{toasts:n}=O.b.get().notifications;n.addError(a,{toastMessage:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailure",{defaultMessage:"Failed to create timeline for document _id: {id}",values:{id:e._id}}),title:u.i18n.translate("xpack.securitySolution.detectionEngine.alerts.createSuppressedTimelineFailureTitle",{defaultMessage:"Failed to create suppressed alert timeline"})});const i=S.a.toISOString(),r=S.b.toISOString();return t({from:i,notes:null,timeline:{...p.b,id:b.c.active,indexNames:[],dateRange:{start:i,end:r},eventType:"all"},to:r})}},$=(e,t,a="dataProvider",n)=>{const i=Array.isArray(t)?t.map((e=>e._id)):[],{to:r,from:l}=I({ecs:t}),{dataProviders:s,filters:o}=C(i,a,n||`${t.length} event IDs`);e({from:l,notes:null,timeline:{...p.b,dataProviders:s,id:b.c.active,indexNames:[],dateRange:{start:l,end:r},eventType:"all",filters:o,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:r})},L=async({createTimeline:e,ecsData:t,updateTimelineIsLoading:a,searchStrategyClient:i,getExceptionFilter:r})=>{const l=Array.isArray(t)?t[0]:t,s=Object(E.getField)(l,c.I),o=Object(E.getField)(l,c.y),u=Array.isArray(s)&&s.length>0?s[0]:"",O=Object(E.getField)(l,m.g),k=Object(n.isEmpty)(O)?"":Array.isArray(O)?O[0]:O,{to:x,from:S}=I({ecs:t});if(Object(n.isEmpty)(k)){if(T(l))return D(l,e,u,{},r);if(M(l))return N(l,e,u,{},r);if(F(l))return _(l,e,u,{},r);{let{dataProviders:a,filters:i}=C([l._id],"dataProvider");if((e=>{const t=Object(E.getField)(e,c.R),a=Object(E.getField)(e,m.a);return("eql"===t||Array.isArray(t)&&"eql"===t[0])&&(null==a?void 0:a.length)>0})(l)){const e=((e,t)=>{if(!Object(n.isEmpty)(e)&&Array.isArray(t)&&t.length>1)return{dataProviders:[],filters:A(m.a,t.reduce(((e,t)=>{const a=Object(E.getField)(t,m.a),n=Array.isArray(a)?a[0]:a;return e.includes(n)?e:[...e,n]}),[]))};if(!Array.isArray(t)||1===t.length){const e=Array.isArray(t)?t[0]:t,a=Object(E.getField)(e,m.a),n=Object(E.getFieldKey)(e,m.a),i=Array.isArray(a)?a[0]:a;return{dataProviders:[{and:[],id:`send-alert-to-timeline-action-default-draggable-event-details-value-formatted-field-value-${b.c.active}-alert-id-${i}`,name:e._id,enabled:!0,excluded:!1,kqlQuery:"",queryMatch:{field:n,value:i,operator:":"}}],filters:[]}}return{filters:[],dataProviders:[]}})([l._id],t);a=e.dataProviders,i=e.filters}return e({from:S,notes:null,timeline:{...p.b,dataProviders:a,id:b.c.active,indexNames:[],dateRange:{start:S,end:x},eventType:"all",filters:i,kqlQuery:{filterQuery:{kuery:{kind:"kuery",expression:""},serializedQuery:""}}},to:x,ruleNote:u,ruleAuthor:o})}}try{var w,$;a({id:b.c.active,isLoading:!0});const[t,s]=await Promise.all([Object(j.e)(k),Object(d.lastValueFrom)(i.search({defaultIndex:[],indexName:null!==(w=l._index)&&void 0!==w?w:"",eventId:l._id,factoryQueryType:f.c.details},{strategy:"timelineSearchStrategy"}))]),c=Object(n.getOr)({},"data.getOneTimeline",t),m=null!==($=s.data)&&void 0!==$?$:[];if(!Object(n.isEmpty)(c)){var L,P,z,B,R,U,Q;const t=Object(y.g)(c),{timeline:a,notes:n}=Object(y.c)(t,!0,null!==(L=t.timelineType)&&void 0!==L?L:g.l.default),i=Object(h.d)(null!==(P=null===(z=a.kqlQuery)||void 0===z||null===(B=z.filterQuery)||void 0===B||null===(R=B.kuery)||void 0===R?void 0:R.expression)&&void 0!==P?P:"",m,a.timelineType),s=Object(h.c)(null!==(U=a.filters)&&void 0!==U?U:[],m),d=Object(h.b)(null!==(Q=a.dataProviders)&&void 0!==Q?Q:[],m,a.timelineType);return T(l)?D(l,e,u,{filters:s,query:i,dataProviders:d,columns:a.columns},r):M(l)?N(l,e,u,{filters:s,query:i,dataProviders:d,columns:a.columns},r):F(l)?_(l,e,u,{filters:s,query:i,dataProviders:d,columns:a.columns},r):e({from:S,timeline:{...a,title:"",timelineType:g.l.default,templateTimelineId:null,status:g.k.draft,dataProviders:d,eventType:"all",filters:s,dateRange:{start:S,end:x},kqlQuery:{filterQuery:{kuery:{kind:null!==(q=null===(H=a.kqlQuery)||void 0===H||null===(G=H.filterQuery)||void 0===G||null===(V=G.kuery)||void 0===V?void 0:V.kind)&&void 0!==q?q:"kuery",expression:i},serializedQuery:Object(v.f)(i)}},noteIds:null!==(Y=null==n?void 0:n.map((e=>e.noteId)))&&void 0!==Y?Y:[],show:!0},to:x,ruleNote:u,ruleAuthor:o,notes:null!=n?n:null});var q,H,G,V,Y}}catch{return a({id:b.c.active,isLoading:!1}),e({from:S,notes:null,timeline:{...p.b,id:b.c.active,indexNames:[],dateRange:{start:S,end:x},eventType:"all"},to:x})}}},1491:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(298),r=a(297);const l=["*"],s=({alertIds:e,fields:t=l})=>{const[a]=Object(n.useState)((()=>o(e,t))),{loading:s,data:u,setQuery:c}=Object(i.a)({query:a,queryName:r.a.BY_ID});return Object(n.useEffect)((()=>{c(o(e,t))}),[c,e,t]),{loading:s,error:!s&&void 0===u,data:null==u?void 0:u.hits.hits}},o=(e,t)=>({fields:t,_source:!1,query:{ids:{values:e}}})},1492:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(17),i=a(2),r=a.n(i),l=a(1386),s=a(197),o=a(1080),u=a(128),c=a(112);const d=r.a.memo((({eventId:e,contextId:t,enrichedFieldInfo:a,scopeId:d,handleOnEventClosed:m})=>{const[b,g]=Object(i.useState)(!1),f=Object(i.useCallback)((()=>g(!b)),[b]),p=Object(i.useCallback)((()=>g(!1)),[]),y=Object(i.useCallback)((()=>{p(),m()}),[p,m]),v=Object(i.useMemo)((()=>u.d.globalQuery()),[]),E=Object(c.a)(v),h=Object(i.useCallback)((()=>{E.forEach((e=>e.refetch&&e.refetch()))}),[E]),{actionItems:j}=Object(l.a)({closePopover:y,eventId:e,scopeId:d,alertStatus:a.values[0],refetch:h}),O=Object(i.useMemo)((()=>[{id:0,items:j}]),[j]),k=Object(i.useMemo)((()=>j.length>0),[j]),x=Object(i.useMemo)((()=>r.a.createElement(o.a,{contextId:t,eventId:e,value:a.values[0],fieldName:a.data.field,linkValue:a.linkValue,fieldType:a.data.type,fieldFormat:a.data.format,isDraggable:!1,truncate:!1,isButton:k,onClick:k?f:void 0,onClickAriaLabel:s.z})),[t,e,a,f,k]);return k?r.a.createElement(n.EuiPopover,{button:x,isOpen:b,closePopover:p,panelPaddingSize:"none","data-test-subj":"alertStatus"},r.a.createElement(n.EuiPopoverTitle,{paddingSize:"m"},s.y),r.a.createElement(n.EuiContextMenu,{panels:O,initialPanelId:0,"data-test-subj":"event-details-alertStatusPopover"})):x}));d.displayName="StatusPopoverButton"},1493:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var n=a(9),i=a(2),r=a.n(i),l=a(17),s=a(5),o=a(47),u=a(126),c=a(317),d=a(18),m=a(262),b=a(1388),g=a(1389),f=a(1494),p=a(1540),y=a(1538),v=a(133);const E=Object(i.memo)((({togglePopover:e,isDisabled:t,toolTipMessage:a})=>r.a.createElement(l.EuiToolTip,{position:"bottom",content:a},r.a.createElement(l.EuiButtonIcon,{"aria-label":"Update assignees","data-test-subj":v.d,iconType:"plusInCircle",onClick:e,isDisabled:t}))));E.displayName="UpdateAssigneesButton";const h=Object(i.memo)((({eventId:e,assignedUserIds:t,onAssigneesUpdated:a,isPreview:h})=>{const j=Object(d.b)().isPlatinumPlus(),O=Object(c.b)("alert_assignments"),{hasIndexWrite:k}=Object(m.a)(),x=Object(y.a)(),S=Object(i.useMemo)((()=>new Set(t)),[t]),{data:I}=Object(b.a)({uids:S}),[T,M]=Object(i.useState)(!1),F=Object(i.useCallback)((()=>{a&&a()}),[a]),A=Object(i.useCallback)((()=>{M((e=>!e))}),[]),w=Object(i.useCallback)((async a=>{if(M(!1),x){const i=Object(g.b)(a),r={add:i.filter((e=>!t.includes(e))),remove:t.filter((e=>!i.includes(e)))};await x(r,[e],F,n.noop)}}),[t,e,F,x]);return r.a.createElement(l.EuiFlexGroup,{"data-test-subj":v.e,alignItems:"center",direction:"row",gutterSize:"xs",responsive:!1},r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(l.EuiTitle,{size:"xxs","data-test-subj":v.f},r.a.createElement("h3",null,r.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.assignedTitle",defaultMessage:"Assignees:"})))),h?Object(u.d)():r.a.createElement(l.EuiFlexGroup,{gutterSize:"none",responsive:!1},I&&r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(p.a,{userProfiles:I,maxVisibleAvatars:2})),r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(f.a,{assignedUserIds:t,button:r.a.createElement(E,{togglePopover:A,isDisabled:!k||!j,toolTipMessage:null!=O?O:s.i18n.translate("xpack.securitySolution.flyout.right.visualizations.assignees.popoverTooltip",{defaultMessage:"Assign alert"})}),isPopoverOpen:T,closePopover:A,onAssigneesApply:w}))))}));h.displayName="Assignees"},1494:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a.n(n),r=a(17),l=a(1166),s=a(1524);const o=Object(n.memo)((({assignedUserIds:e,showUnassignedOption:t,button:a,isPopoverOpen:n,closePopover:o,onSelectionChange:u,onAssigneesApply:c})=>{const d=Object(r.useGeneratedHtmlId)({prefix:"searchInput"});return i.a.createElement(r.EuiPopover,{panelPaddingSize:"none",initialFocus:`#${d}`,button:a,isOpen:n,panelStyle:{minWidth:l.a},closePopover:o},i.a.createElement(s.a,{searchInputId:d,assignedUserIds:e,showUnassignedOption:t,onSelectionChange:u,onAssigneesApply:c}))}));o.displayName="AssigneesPopover"},1495:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(44),i=a.n(n),r=a(2),l=a.n(r),s=a(17);a(13);const o=Object(r.memo)((({title:e,iconType:t,isLink:a=!1,"data-test-subj":n})=>{const{euiTheme:i}=Object(s.useEuiTheme)(),o=Object(r.useMemo)((()=>t?l.a.createElement(u,{type:t,size:"m",className:"eui-alignBaseline","data-test-subj":`${n}Icon`,$_css:i.size.xs}):null),[n,t,i.size.xs]),m=Object(r.useMemo)((()=>l.a.createElement(s.EuiTitle,{size:"s","data-test-subj":`${n}Text`},l.a.createElement(s.EuiTextColor,{color:a?i.colors.primaryText:void 0},l.a.createElement("span",null,e)))),[n,e,a,i.colors.primaryText]),b=Object(r.useMemo)((()=>l.a.createElement(c,{type:"popout",size:"m","data-test-subj":`${n}LinkIcon`,$_css2:i.size.xs})),[n,i.size.xs]);return l.a.createElement(s.EuiToolTip,{content:e},l.a.createElement(s.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"xs",responsive:!1},l.a.createElement(s.EuiFlexItem,null,l.a.createElement(d,null,o,m)),a&&l.a.createElement(s.EuiFlexItem,{grow:!1},b)))}));o.displayName="FlyoutTitle";var u=i()(s.EuiIcon).withConfig({displayName:"_StyledEuiIcon",componentId:"sc-fkcz97-0"})(["margin-right:",";"],(e=>e.$_css)),c=i()(s.EuiIcon).withConfig({displayName:"_StyledEuiIcon2",componentId:"sc-fkcz97-1"})(["margin-bottom:",";"],(e=>e.$_css2)),d=i()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-fkcz97-2"})(["word-break:break-word;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;text-overflow:ellipsis;"])},1519:function(e,t,a){"use strict";a.d(t,"c",(function(){return Ve})),a.d(t,"a",(function(){return Ye})),a.d(t,"b",(function(){return Je}));var n=a(2),i=a.n(n),r=a(144),l=a(1326),s=a(125),o=a(620),u=a(279),c=a(147),d=a(206);const m=(e="default")=>`logs-entityanalytics_entra_id.user-${e}`,b="managedUserDetailsQuery",g=(e="default")=>`logs-entityanalytics_okta.user-${e}`;var f=a(5);f.i18n.translate("xpack.securitySolution.timeline.userDetails.observedBadge",{defaultMessage:"OBSERVED"}),f.i18n.translate("xpack.securitySolution.timeline.userDetails.managedBadge",{defaultMessage:"MANAGED"}),f.i18n.translate("xpack.securitySolution.timeline.userDetails.userLabel",{defaultMessage:"User"});const p=f.i18n.translate("xpack.securitySolution.timeline.userDetails.failManagedUserDescription",{defaultMessage:"Failed to run search on user managed data"}),y=f.i18n.translate("xpack.securitySolution.timeline.userDetails.managedDataTitle",{defaultMessage:"Managed data"}),v=f.i18n.translate("xpack.securitySolution.timeline.userDetails.observedDataTitle",{defaultMessage:"Observed data"}),E=f.i18n.translate("xpack.securitySolution.timeline.userDetails.EntraDataPanelTitle",{defaultMessage:"Entra ID data"}),h=f.i18n.translate("xpack.securitySolution.timeline.userDetails.hideOktaDataPanelTitle",{defaultMessage:"Okta data"}),j=(f.i18n.translate("xpack.securitySolution.timeline.userDetails.riskScoreLabel",{defaultMessage:"Risk score"}),f.i18n.translate("xpack.securitySolution.timeline.userDetails.valuesColumnTitle",{defaultMessage:"Values"})),O=f.i18n.translate("xpack.securitySolution.timeline.userDetails.fieldColumnTitle",{defaultMessage:"Field"}),k=f.i18n.translate("xpack.securitySolution.timeline.userDetails.userIdLabel",{defaultMessage:"User ID"}),x=f.i18n.translate("xpack.securitySolution.timeline.userDetails.maxAnomalyScoreByJobLabel",{defaultMessage:"Max anomaly score by job"}),S=f.i18n.translate("xpack.securitySolution.timeline.userDetails.firstSeenLabel",{defaultMessage:"First seen"}),I=f.i18n.translate("xpack.securitySolution.timeline.userDetails.lastSeenLabel",{defaultMessage:"Last seen"}),T=f.i18n.translate("xpack.securitySolution.timeline.userDetails.hostOsNameLabel",{defaultMessage:"Operating system"}),M=f.i18n.translate("xpack.securitySolution.timeline.userDetails.familyLabel",{defaultMessage:"Family"}),F=f.i18n.translate("xpack.securitySolution.timeline.userDetails.ipAddressesLabel",{defaultMessage:"IP addresses"}),A=f.i18n.translate("xpack.securitySolution.timeline.userDetails.noActiveIntegrationTitle",{defaultMessage:"You don’t have any active asset repository integrations"}),w=f.i18n.translate("xpack.securitySolution.timeline.userDetails.noActiveIntegrationText",{defaultMessage:"Additional metadata from integrations may help you to manage and identify risky entities."}),C=f.i18n.translate("xpack.securitySolution.timeline.userDetails.addExternalIntegrationButton",{defaultMessage:"Add asset repository integrations"}),D=f.i18n.translate("xpack.securitySolution.timeline.userDetails.noAzureDataTitle",{defaultMessage:"No metadata found for this user"}),N=f.i18n.translate("xpack.securitySolution.timeline.userDetails.noAzureDataText",{defaultMessage:"If you expected to see metadata for this user, make sure you have configured your integrations properly."}),_=(f.i18n.translate("xpack.securitySolution.timeline.userDetails.closeButton",{defaultMessage:"close"}),f.i18n.translate("xpack.securitySolution.timeline.userDetails.observedUserInspectTitle",{defaultMessage:"Observed user"})),$=f.i18n.translate("xpack.securitySolution.timeline.userDetails.managedUserInspectTitle",{defaultMessage:"Managed user"}),L=["entityanalytics_entra_id","entityanalytics_okta"];var P=a(693),z=a(121),B=a(1529),R=a(176),U=a(1168),Q=a(565),q=a(479),H=a(403),G=a(394),V=a(1422),Y=a(1285),K=a(17),J=a(47);let W;!function(e){e.ENTRA="entityanalytics_entra_id.user",e.OKTA="entityanalytics_okta.user"}(W||(W={}));var Z=a(1170),X=a(44),ee=a.n(X),te=a(13),ae=a(45),ne=a(55),ie=a(48),re=a(116),le=a(464),se=a(126),oe=a(155),ue=a(1276),ce=a(433),de=a(119),me=a(158),be=a(127);const ge={name:O,field:"label",render:(e,{field:t})=>i.a.createElement(pe,{$_css:ne.euiLightVars.euiFontWeightMedium,$_css2:ne.euiLightVars.euiTitleColor},null!=e?e:t)},fe=({anomalies:e})=>{const{to:t,from:a}=Object(c.a)(),r=Object(ie.useDispatch)(),l=Object(n.useCallback)(((e,t)=>{const a=Object(ce.a)(e,t);r(Object(me.setAbsoluteRangeDatePicker)({id:de.a.global,from:a.from,to:a.to}))}),[r]);return i.a.createElement(ue.a,{anomalies:e.anomalies,startDate:a,endDate:t,isLoading:e.isLoading,narrowDateRange:l,jobNameById:e.jobNameById})};var pe=ee()("span").withConfig({displayName:"_StyledSpan",componentId:"sc-1eh5srw-0"})(["font-weight:",";color:",";"],(e=>e.$_css),(e=>e.$_css2)),ye=a(159),ve=a(110),Ee=a(216),he=a(1537);const je=({children:e,title:t,managedUser:a,indexName:l,eventId:s,tableType:o})=>{const u=Object(K.useEuiFontSize)("xxs").fontSize,c=Object(ae.get)("@timestamp[0]",a),{openLeftPanel:d}=Object(r.d)(),m=Object(n.useCallback)((()=>{d({id:he.b,params:{id:s,indexName:l,scopeId:o}})}),[d,s,l,o]);return i.a.createElement(Ee.a,{header:{title:t,iconType:"arrowStart",headerContent:c&&i.a.createElement(Oe,{$_css:u},i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.timeline.userDetails.updatedTime",defaultMessage:"Updated {time}",values:{time:i.a.createElement(oe.b,{value:c,dateFormat:"MMM D, YYYY",relativeThresholdInHrs:168})}})),link:{callback:m,tooltip:i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.showAssetDocument",defaultMessage:"Show asset details"})}},expand:{expandable:!1}},e)};var Oe=ee()("span").withConfig({displayName:"_StyledSpan",componentId:"sc-1drac13-0"})(["font-size:",";"],(e=>e.$_css)),ke=a(329);const xe=({managedUser:e,contextID:t,isDraggable:a})=>{var r,l;const s=null===(r=e.data)||void 0===r?void 0:r[W.ENTRA],o=null===(l=e.data)||void 0===l?void 0:l[W.OKTA],{getAppUrl:u}=Object(ve.c)(),c=Object(n.useMemo)((()=>u({appId:"integrations",path:"browse/security?q=entityanalytics"})),[u]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(ye.c,null,i.a.createElement(K.EuiAccordion,{isLoading:e.isLoading,initialIsOpen:!0,id:"managedUser-data","data-test-subj":"managedUser-data",buttonProps:{"data-test-subj":"managedUser-accordion-button"},buttonContent:i.a.createElement(K.EuiTitle,{size:"xs"},i.a.createElement("h5",null,y)),extraAction:i.a.createElement(ye.b,{queryId:b,title:$})},i.a.createElement(K.EuiSpacer,{size:"m"}),i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.timeline.userDetails.managed.description",defaultMessage:"Metadata from any asset repository integrations enabled in your environment."}),i.a.createElement(K.EuiSpacer,{size:"m"}),e.isLoading||e.isIntegrationEnabled?i.a.createElement(i.a.Fragment,null,s||o||e.isLoading?i.a.createElement(i.a.Fragment,null,s&&s.fields&&i.a.createElement(je,{title:E,managedUser:s.fields,indexName:s._index,eventId:s._id,tableType:R.UserAssetTableType.assetEntra},i.a.createElement(Se,{isDraggable:a,contextID:t,managedUser:s.fields,tableType:R.UserAssetTableType.assetEntra})),s&&o&&i.a.createElement(K.EuiSpacer,{size:"m"}),o&&o.fields&&i.a.createElement(je,{title:h,managedUser:o.fields,indexName:o._index,eventId:o._id,tableType:R.UserAssetTableType.assetOkta},i.a.createElement(Se,{isDraggable:a,contextID:t,managedUser:o.fields,tableType:R.UserAssetTableType.assetOkta}))):i.a.createElement(K.EuiCallOut,{"data-test-subj":"managedUser-no-data",title:D,color:"warning",iconType:"help"},i.a.createElement("p",null,N))):i.a.createElement(K.EuiPanel,{"data-test-subj":"managedUser-integration-disable-callout",hasShadow:!1,hasBorder:!0},i.a.createElement(K.EuiEmptyPrompt,{title:i.a.createElement("h2",null,A),titleSize:"s",body:i.a.createElement("p",null,w),actions:i.a.createElement(K.EuiButton,{fill:!0,href:c},C)})))))},Se=({managedUser:e,contextID:t,isDraggable:a,tableType:r})=>{const l=Object(n.useMemo)((()=>((e,t)=>[ge,{name:j,field:"value",render:(a,{field:n})=>n&&a?i.a.createElement(le.a,{rowItems:a.map((e=>a.toString())),attrName:n,idPrefix:e?`managedUser-${e}`:"managedUser",isDraggable:t,sourcererScopeId:re.SourcererScopeName.default}):Object(se.a)(a)}])(t,a)),[a,t]),s=((e,t)=>{const a=Object(ie.useSelector)((t=>ke.e.selectUserAssetTableById(t,e)));return Object(n.useMemo)((()=>a.fields.map((e=>({value:t[e],field:e})))),[t,a.fields])})(r,e);return i.a.createElement(Z.a,{"data-test-subj":"managedUser-table",columns:l,items:null!=s?s:[]})},Ie=({observedUser:e,contextID:t,scopeId:a,isDraggable:r})=>{const{euiTheme:l}=Object(K.useEuiTheme)(),s=(o=e,Object(n.useMemo)((()=>{var e,t,a,n,i,r,l;return o.details?[{label:k,values:null===(e=o.details.user)||void 0===e?void 0:e.id,field:"user.id"},{label:"Domain",values:null===(t=o.details.user)||void 0===t?void 0:t.domain,field:"user.domain"},{label:x,field:"anomalies",values:o.anomalies},{label:S,values:o.firstSeen.date?[o.firstSeen.date]:void 0,field:"@timestamp"},{label:I,values:o.lastSeen.date?[o.lastSeen.date]:void 0,field:"@timestamp"},{label:T,values:null===(a=o.details.host)||void 0===a||null===(n=a.os)||void 0===n?void 0:n.name,field:"host.os.name"},{label:M,values:null===(i=o.details.host)||void 0===i||null===(r=i.os)||void 0===r?void 0:r.family,field:"host.os.family"},{label:F,values:null===(l=o.details.host)||void 0===l?void 0:l.ip,field:"host.ip"}]:[]}),[o.details,o.anomalies,o.firstSeen,o.lastSeen]));var o;const u=Object(n.useMemo)((()=>((e,t,a)=>[ge,{name:j,field:"values",render:(n,{field:r})=>function(e,t){return"anomalies"===e}(r)&&n?i.a.createElement(fe,{anomalies:n}):"@timestamp"===r?i.a.createElement(oe.b,{value:Object(ae.head)(n)}):i.a.createElement(le.a,{rowItems:n,attrName:r,idPrefix:e?`observedUser-${e}`:"observedUser",isDraggable:a,sourcererScopeId:Object(be.getSourcererScopeId)(t)})}])(t,a,r)),[t,a,r]),c=Object(K.useEuiFontSize)("xxs").fontSize;return i.a.createElement(i.a.Fragment,null,i.a.createElement(ye.c,null,i.a.createElement(Fe,{initialIsOpen:!0,isLoading:e.isLoading,id:"observedUser-data","data-test-subj":"observedUser-data",buttonProps:{"data-test-subj":"observedUser-accordion-button",css:te.css`
              color: ${l.colors.primary};
            `},buttonContent:i.a.createElement(K.EuiTitle,{size:"xs"},i.a.createElement("h3",null,v)),extraAction:i.a.createElement(i.a.Fragment,null,i.a.createElement(Te,{$_css:l.size.s},i.a.createElement(ye.b,{queryId:P.a,title:_})),e.lastSeen.date&&i.a.createElement(Me,{$_css2:c},i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.timeline.userDetails.observedUserUpdatedTime",defaultMessage:"Updated {time}",values:{time:i.a.createElement(oe.b,{value:e.lastSeen.date,dateFormat:"MMM D, YYYY",relativeThresholdInHrs:168})}})))},i.a.createElement(K.EuiSpacer,{size:"m"}),i.a.createElement(Z.a,{loading:e.isLoading||e.firstSeen.isLoading||e.lastSeen.isLoading||e.anomalies.isLoading,"data-test-subj":"observedUser-table",columns:u,items:s}))))};var Te=ee()("span").withConfig({displayName:"_StyledSpan",componentId:"sc-czrrgy-0"})(["margin-right:",";"],(e=>e.$_css)),Me=ee()("span").withConfig({displayName:"_StyledSpan2",componentId:"sc-czrrgy-1"})(["font-size:",";"],(e=>e.$_css2)),Fe=ee()(K.EuiAccordion).withConfig({displayName:"_StyledEuiAccordion",componentId:"sc-czrrgy-2"})([".euiAccordion__optionalAction{margin-left:auto;}"]),Ae=a(330),we=a(51),Ce=a(1061);const De={from:"now-30d",to:"now"},Ne=i.a.memo((({riskScoreData:e,queryId:t})=>{var a;const{data:l}=e,o=l&&l.length>0?l[0]:void 0,{euiTheme:u}=Object(K.useEuiTheme)(),{openLeftPanel:c}=Object(r.d)(),d=Object(n.useCallback)((()=>{c({id:V.b,params:{riskInputs:null==o?void 0:o.user.risk.inputs}})}),[c,null==o?void 0:o.user.risk.inputs]),m=Object(n.useMemo)((()=>{var e,t,a;return(({spaceId:e,query:t,severity:a,riskEntity:n})=>{const i=[Object(we.v4)(),Object(we.v4)()],r=Object(we.v4)(),l=[Object(we.v4)(),Object(we.v4)(),Object(we.v4)()],o=n===s.v.user?s.w.userRiskScore:s.w.hostRiskScore;return{title:"Risk score summary",description:"",visualizationType:"lnsMetric",state:{visualization:{layerId:i[0],layerType:"data",metricAccessor:l[0],trendlineLayerId:i[1],trendlineLayerType:"metricTrendline",trendlineTimeAccessor:l[1],trendlineMetricAccessor:l[2],palette:{type:"palette",name:"custom",params:{steps:3,name:"custom",reverse:!1,rangeType:"number",rangeMin:0,rangeMax:null,progression:"fixed",colorStops:Ce.c.map((e=>({color:Ce.b[e],stop:Ce.a[e].start}))),stops:Ce.c.map((e=>({color:Ce.b[e],stop:Ce.a[e].stop}))),continuity:"above",maxSteps:5}},subtitle:a},query:{query:null!=t?t:"",language:"kuery"},filters:[],datasourceStates:{formBased:{layers:{[i[0]]:{columns:{[l[0]]:{label:"Risk",dataType:"number",operationType:"max",isBucketed:!1,scale:"ratio",sourceField:o,reducedTimeRange:"",params:{sortField:"@timestamp",format:{id:"number",params:{decimals:0,compact:!1}},emptyAsNull:!0},customLabel:!0}},columnOrder:[l[0]],incompleteColumns:{}},[i[1]]:{linkToLayers:[i[0]],columns:{[l[1]]:{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:s.w.timestamp,isBucketed:!0,scale:"interval",params:{interval:"auto",includeEmptyRows:!0,dropPartials:!1}},[l[2]]:{label:"Risk value",dataType:"number",operationType:"last_value",isBucketed:!1,scale:"ratio",sourceField:o,filter:{query:"",language:"kuery"},timeShift:"",reducedTimeRange:"",params:{sortField:"@timestamp",format:{id:"number",params:{decimals:0,compact:!1}}},customLabel:!0}},columnOrder:[l[1],l[2]],sampling:1,ignoreGlobalFilters:!1,incompleteColumns:{}}}},indexpattern:{layers:{}},textBased:{layers:{}}},internalReferences:[{type:"index-pattern",id:r,name:`indexpattern-datasource-layer-${i[0]}`},{type:"index-pattern",id:r,name:`indexpattern-datasource-layer-${i[1]}`}],adHocDataViews:{[r]:{id:r,title:`risk-score.risk-score-${null!=e?e:"default"}`,timeFieldName:"@timestamp",sourceFilters:[],fieldFormats:{},runtimeFieldMap:{},fieldAttrs:{},allowNoIndex:!1,name:`risk-score.risk-score-${null!=e?e:"default"}`}}},references:[]}})({severity:null==o||null===(e=o.user)||void 0===e||null===(t=e.risk)||void 0===t?void 0:t.calculated_level,query:`user.name: ${null==o||null===(a=o.user)||void 0===a?void 0:a.name}`,spaceId:"default",riskEntity:H.e.user})}),[o]),b=Object(n.useMemo)((()=>[{field:"category",name:i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.categoryColumnLabel",defaultMessage:"Category"}),truncateText:!1,mobileOptions:{show:!0},sortable:!0},{field:"count",name:i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.inputsColumnLabel",defaultMessage:"Inputs"}),truncateText:!1,mobileOptions:{show:!0},sortable:!0,dataType:"number"}]),[]),g=Object(K.useEuiFontSize)("xxs").fontSize,p=Object(n.useMemo)((()=>{var e,t;return[{category:f.i18n.translate("xpack.securitySolution.flyout.entityDetails.alertsGroupLabel",{defaultMessage:"Alerts"}),count:null!==(e=null==o||null===(t=o.user.risk.inputs)||void 0===t?void 0:t.length)&&void 0!==e?e:0}]}),[null==o||null===(a=o.user.risk.inputs)||void 0===a?void 0:a.length]);return i.a.createElement(K.EuiAccordion,{initialIsOpen:!0,id:"risk_summary",buttonProps:{css:te.css`
          color: ${u.colors.primary};
        `},buttonContent:i.a.createElement(K.EuiTitle,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.title",defaultMessage:"Risk summary"}))),extraAction:i.a.createElement(_e,{"data-test-subj":"risk-summary-updatedAt",$_css:g},o&&i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskUpdatedTime",defaultMessage:"Updated {time}",values:{time:i.a.createElement(oe.b,{value:o["@timestamp"],dateFormat:"MMM D, YYYY",relativeThresholdInHrs:168})}}))},i.a.createElement(K.EuiSpacer,{size:"m"}),i.a.createElement(Ee.a,{header:{title:i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.riskInputs",defaultMessage:"Risk inputs"}),link:{callback:d,tooltip:i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.showAllRiskInputs",defaultMessage:"Show all risk inputs"})},iconType:"arrowStart"},expand:{expandable:!1}},i.a.createElement(K.EuiFlexGroup,{gutterSize:"m",direction:"column"},i.a.createElement(K.EuiFlexItem,{grow:!1},i.a.createElement($e,null,o&&i.a.createElement(Ae.a,{applyGlobalQueriesAndFilters:!1,lensAttributes:m,id:"RiskSummary-risk_score_metric",timerange:De,width:"100%",height:126,disableOnClickFilter:!0,inspectTitle:i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.inspectVisualizationTitle",defaultMessage:"Risk Summary Visualization"})}))),i.a.createElement(K.EuiFlexItem,{grow:!1},i.a.createElement(ye.c,null,i.a.createElement(Le,null,i.a.createElement(Pe,{$_css2:ne.euiThemeVars.euiSize},i.a.createElement(ye.b,{queryId:t,title:i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.inspectTableTitle",defaultMessage:"Risk Summary Table"})})),i.a.createElement(K.EuiBasicTable,{"data-test-subj":"risk-summary-table",responsive:!1,columns:b,items:p,compressed:!0})))))),i.a.createElement(K.EuiSpacer,{size:"s"}))}));Ne.displayName="RiskSummary";var _e=ee()("span").withConfig({displayName:"_StyledSpan",componentId:"sc-13sok2c-0"})(["font-size:",";"],(e=>e.$_css)),$e=ee()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-13sok2c-1"})(["height:","px;"],126),Le=ee()("div").withConfig({displayName:"_StyledDiv2",componentId:"sc-13sok2c-2"})(["position:relative;"]),Pe=ee()("div").withConfig({displayName:"_StyledDiv3",componentId:"sc-13sok2c-3"})(["position:absolute;right:0;top:-",";"],(e=>e.$_css2)),ze=a(1067);const Be=({observedUser:e,managedUser:t,riskScoreState:a,contextID:n,scopeId:r,isDraggable:l})=>{var s;return i.a.createElement(ze.a,null,a.isModuleEnabled&&0!==(null===(s=a.data)||void 0===s?void 0:s.length)&&i.a.createElement(i.a.Fragment,null,i.a.createElement(Ne,{riskScoreData:a,queryId:Ye}),i.a.createElement(K.EuiHorizontalRule,{margin:"m"})),i.a.createElement(Ie,{observedUser:e,contextID:n,scopeId:r,isDraggable:l}),i.a.createElement(K.EuiHorizontalRule,{margin:"m"}),i.a.createElement(xe,{managedUser:t,contextID:n,isDraggable:l}))};var Re=a(28),Ue=a(527),Qe=a(137),qe=a(1111),He=a(1495);const Ge=({userName:e,observedUser:t,managedUser:a})=>{var r,l,s,o,u,c;const d=null===(r=a.data)||void 0===r||null===(l=r[W.OKTA])||void 0===l||null===(s=l.fields)||void 0===s?void 0:s["@timestamp"][0],m=null===(o=a.data)||void 0===o||null===(u=o[W.ENTRA])||void 0===u||null===(c=u.fields)||void 0===c?void 0:c["@timestamp"][0],b=!!d||!!m,g=Object(n.useMemo)((()=>Object(ae.max)([t.lastSeen.date,m,d].map((e=>e&&new Date(e))))),[d,m,t.lastSeen]);return i.a.createElement(qe.a,{"data-test-subj":"user-panel-header"},i.a.createElement(K.EuiFlexGroup,{gutterSize:"s",responsive:!1,direction:"column"},i.a.createElement(K.EuiFlexItem,{grow:!1},i.a.createElement(K.EuiText,{size:"xs","data-test-subj":"user-panel-header-lastSeen"},g&&i.a.createElement(oe.c,{value:g}),i.a.createElement(K.EuiSpacer,{size:"xs"}))),i.a.createElement(K.EuiFlexItem,{grow:!1},i.a.createElement(Qe.k,{deepLinkId:Re.c.users,path:Object(Ue.c)(e),target:"_blank",external:!1},i.a.createElement(He.a,{title:e,iconType:"user",isLink:!0}))),i.a.createElement(K.EuiFlexItem,{grow:!1},i.a.createElement(K.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},i.a.createElement(K.EuiFlexItem,{grow:!1},t.lastSeen.date&&i.a.createElement(K.EuiBadge,{"data-test-subj":"user-panel-header-observed-badge",color:"hollow"},i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.user.observedBadge",defaultMessage:"Observed"}))),i.a.createElement(K.EuiFlexItem,{grow:!1},b&&i.a.createElement(K.EuiBadge,{"data-test-subj":"user-panel-header-managed-badge",color:"hollow"},i.a.createElement(J.FormattedMessage,{id:"xpack.securitySolution.flyout.entityDetails.user.managedBadge",defaultMessage:"Managed"})))))))},Ve="user-panel",Ye="userPanelRiskScoreQuery",Ke={cursorStart:0,querySize:1},Je=({contextID:e,scopeId:t,userName:a,isDraggable:f})=>{const y=Object(n.useMemo)((()=>a?Object(s.C)([a]):void 0),[a]),v=Object(q.c)({riskEntity:H.e.user,filterQuery:y,onlyLatest:!1,pagination:Ke}),{inspect:E,refetch:h,loading:j}=v,{to:O,from:k,isInitializing:x,setQuery:S,deleteQuery:I}=Object(c.a)(),T=(e=>{const{selectedPatterns:t}=Object(z.d)(),{to:a,from:i,isInitializing:r,deleteQuery:l,setQuery:o}=Object(c.a)(),[u,{userDetails:m,inspect:b,refetch:g,id:f}]=Object(P.b)({endDate:a,startDate:i,userName:e,indexNames:t,skip:r});Object(d.b)({deleteQuery:l,inspect:b,refetch:g,setQuery:o,queryId:f,loading:u});const[p,{firstSeen:y}]=Object(B.a)({field:"user.name",value:e,defaultIndex:t,order:s.b.asc,filterQuery:s.l}),[v,{lastSeen:E}]=Object(B.a)({field:"user.name",value:e,defaultIndex:t,order:s.b.desc,filterQuery:s.l});return Object(n.useMemo)((()=>({details:m,isLoading:u,firstSeen:{date:y,isLoading:p},lastSeen:{date:E,isLoading:v}})),[y,E,p,v,u,m])})(a),M=((e,t)=>{var a;const{to:i,from:r,isInitializing:f,deleteQuery:y,setQuery:v}=Object(c.a)(),E=Object(o.a)(),{loading:h,result:{users:j},search:O,refetch:k,inspect:x}=Object(u.a)({factoryQueryType:s.z.managedDetails,initialResult:{users:{}},errorMessage:p}),S=Object(n.useMemo)((()=>E?[m(E),g(E)]:[]),[E]);Object(n.useEffect)((()=>{var a;!f&&S.length>0&&!t.isLoading&&e&&O({defaultIndex:S,userEmail:null===(a=t.details.user)||void 0===a?void 0:a.email,userName:e})}),[r,O,i,f,S,e,t.isLoading,null===(a=t.details.user)||void 0===a?void 0:a.email]);const{data:I,isLoading:T}=Object(l.a)({packages:L});Object(d.b)({deleteQuery:y,inspect:x,refetch:k,setQuery:v,queryId:b,loading:h});const M=Object(n.useMemo)((()=>!(null==I||!I.some((({package_name:e,is_enabled:t})=>t&&L.includes(e))))),[I]);return Object(n.useMemo)((()=>({data:j,isLoading:h||T,isIntegrationEnabled:M})),[M,T,h,j])})(a,T),{data:F}=v,A=F&&F.length>0?F[0]:void 0;Object(d.b)({deleteQuery:I,inspect:E,loading:j,queryId:Ye,refetch:h,setQuery:S});const{openLeftPanel:w}=Object(r.d)(),C=Object(n.useCallback)((()=>{w({id:V.b,params:{riskInputs:null==A?void 0:A.user.risk.inputs}})}),[w,null==A?void 0:A.user.risk.inputs]);return v.loading||T.isLoading||M.isLoading?i.a.createElement(G.a,null):i.a.createElement(Q.a,{criteriaFields:Object(U.a)(R.UsersType.details,a),startDate:k,endDate:O,skip:x},(({isLoadingAnomaliesData:n,anomaliesData:r,jobNameById:l})=>{const s={...T,anomalies:{isLoading:n,anomalies:r,jobNameById:l}};return i.a.createElement(i.a.Fragment,null,i.a.createElement(Y.a,{flyoutIsExpandable:!(null==A||!A.user.risk),expandDetails:C}),i.a.createElement(Ge,{userName:a,observedUser:s,managedUser:M}),i.a.createElement(Be,{managedUser:M,observedUser:s,riskScoreState:v,contextID:e,scopeId:t,isDraggable:!!f}))}))};Je.displayName="UserPanel"},1521:function(e,t,a){"use strict";a.d(t,"a",(function(){return g})),a.d(t,"b",(function(){return v}));var n=a(23),i=a.n(n),r=a(17),l=a(2),s=a.n(l);const o=97,u=2;function c(e,t){if(t&&t.color)return t.color;const a=m(e).codePointAt(0)||o;return r.VISUALIZATION_COLORS[a%r.VISUALIZATION_COLORS.length]}function d(e,t){if(t&&t.initials)return t.initials;const a=m(e).split(" "),n=Math.min(u,a.length);return a.splice(n,a.length),a.map((e=>e.substring(0,1))).join("")}function m(e){return e.full_name||e.email||e.username}var b=a(13);const g=({user:e,avatar:t,...a})=>{const{euiTheme:n}=Object(r.useEuiTheme)();if(!e)return Object(b.jsx)(r.EuiAvatar,i()({name:"",color:n.colors.lightestShade,initials:"?"},a));const l=m(e);return null!=t&&t.imageUrl?Object(b.jsx)(r.EuiAvatar,i()({name:l,imageUrl:t.imageUrl,color:"plain"},a)):Object(b.jsx)(r.EuiAvatar,i()({name:l,initials:d(e,t),initialsLength:u,color:c(e,t)},a))};var f=a(5),p=a(47);const y="null",v=({selectedOptions:e,defaultOptions:t,options:a,onChange:n,onSearchChange:i,isLoading:o=!1,singleSelection:u=!1,limit:c,height:d,loadingMessage:m,noMatchesMessage:v,emptyMessage:j,errorMessage:O,searchPlaceholder:k,searchInputId:x,selectedStatusMessage:S,limitReachedMessage:I,nullOptionLabel:T,defaultOptionsLabel:M,clearButtonLabel:F})=>{const[A,w]=Object(l.useState)([]),[C,D]=Object(l.useState)(""),N=e?e.length:0,_=!!c&&N>=c,$=()=>{a||w((a=>{const n=[...a],i=e?e.filter((e=>!n.find((t=>h(t,e))))).map((e=>E(e,T))):[],r=t?t.filter((e=>!n.find((t=>h(t,e)))&&!i.find((t=>h(t,e))))).map((e=>E(e,T))):[];if(r.length){const e=(e=>{let t=e.findIndex((e=>e.isGroupLabel));return-1===t&&(t=e.push({label:null!=M?M:f.i18n.translate("userProfileComponents.userProfilesSelectable.defaultOptionsLabel",{defaultMessage:"Suggested"}),isGroupLabel:!0})-1),t})(n);n.splice(e,0,...i),n.push(...r)}else n.push(...i);return n}))};return Object(l.useEffect)((()=>{a?w(a.map((e=>E(e,T)))):(w([]),$())}),[a]),Object(l.useEffect)($,[t,e]),Object(l.useEffect)((()=>{w((t=>t.map((t=>{if(e){var a;const n=void 0===e.find((e=>h(t,e)))?void 0:"on",i=!n&&_;return{...t,checked:n,disabled:i,prepend:t.data?Object(b.jsx)(g,{user:t.data.user,avatar:null===(a=t.data.data)||void 0===a?void 0:a.avatar,size:"s",isDisabled:i}):void 0}}return{...t,checked:void 0,disabled:void 0}}))))}),[a,t,e]),Object(b.jsx)(r.EuiSelectable,{options:A,onChange:t=>{if(!n)return;const a=t.filter((t=>!(t.isGroupLabel||"on"!==t.checked||e&&void 0!==e.find((e=>h(t,e)))))).map((e=>e.key===y?null:e.data));e&&!u&&e.forEach((e=>{const n=t.find((t=>h(t,e)));void 0!==n&&"on"!==n.checked||(n&&n.key===y?a.unshift(e):a.push(e))})),n(a)},style:{maxHeight:d},singleSelection:u,searchable:!0,searchProps:{placeholder:null!=k?k:f.i18n.translate("userProfileComponents.userProfilesSelectable.searchPlaceholder",{defaultMessage:"Search"}),value:C,onChange:e=>{D(e),null==i||i(e)},isLoading:o,isClearable:!o,id:x},isPreFiltered:!0,listProps:{onFocusBadge:!1},loadingMessage:m,noMatchesMessage:v,emptyMessage:j,errorMessage:O,renderOption:(e,t)=>e.user?Object(b.jsx)(r.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"s",responsive:!1},Object(b.jsx)(r.EuiFlexItem,null,Object(b.jsx)(r.EuiHighlight,{search:t},e.label)),e.user.email&&e.user.email!==e.label?Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiTextColor,{color:e.disabled?"disabled":"subdued"},t?Object(b.jsx)(r.EuiHighlight,{search:t},e.user.email):e.user.email)):void 0):Object(b.jsx)(r.EuiHighlight,{search:t},e.label)},((e,t)=>Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(r.EuiPanel,{hasShadow:!1,paddingSize:"s"},t,u?void 0:Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(r.EuiSpacer,{size:"s"}),Object(b.jsx)(r.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"s",responsive:!1},Object(b.jsx)(r.EuiFlexItem,{grow:!1},Object(b.jsx)(r.EuiText,{size:"xs",color:"subdued"},S?S(N):Object(b.jsx)(p.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.selectedStatusMessage",defaultMessage:"{count, plural, one {# user selected} other {# users selected}}",values:{count:N}}))),Object(b.jsx)(r.EuiFlexItem,{grow:!1},N?Object(b.jsx)(r.EuiButtonEmpty,{size:"xs",flush:"right",onClick:()=>null==n?void 0:n([]),style:{height:"1rem"}},null!=F?F:Object(b.jsx)(p.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.clearButtonLabel",defaultMessage:"Remove all users"})):void 0)))),c&&N>=c?Object(b.jsx)(s.a.Fragment,null,Object(b.jsx)(r.EuiHorizontalRule,{margin:"none"}),Object(b.jsx)(r.EuiCallOut,{title:I?I(c):Object(b.jsx)(p.FormattedMessage,{id:"userProfileComponents.userProfilesSelectable.limitReachedMessage",defaultMessage:"You've selected the maximum of {count, plural, one {# user} other {# users}}",values:{count:c}}),color:"warning",size:"s"})):void 0,Object(b.jsx)(r.EuiHorizontalRule,{margin:"none"}),e)))};function E(e,t){return e?{key:e.uid,label:m(e.user),data:e}:{key:y,label:null!=t?t:f.i18n.translate("userProfileComponents.userProfilesSelectable.nullOptionLabel",{defaultMessage:"No users"})}}function h(e,t){return e.key===(t?t.uid:y)}a(11),f.i18n.translate("userProfileComponents.updateUserProfile.notification.submitSuccessTitle",{defaultMessage:"Profile updated"}),f.i18n.translate("userProfileComponents.updateUserProfile.notification.requiresPageReloadDescription",{defaultMessage:"One or more settings require you to reload the page to take effect."})},1524:function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(45),i=a(2),r=a.n(i),l=a(17),s=a(1521),o=a(9),u=a(50),c=a(1296),d=a(110),m=a(117),b=a(5);const g=b.i18n.translate("xpack.securitySolution.assignees.applyButtonTitle",{defaultMessage:"Apply"}),f=b.i18n.translate("xpack.securitySolution.assignees.selectableSearchPlaceholder",{defaultMessage:"Search users"}),p=b.i18n.translate("xpack.securitySolution.assignees.clearFilters",{defaultMessage:"Clear filters"}),y=b.i18n.translate("xpack.securitySolution.assignees.noAssigneesLabel",{defaultMessage:"No assignees"});var v=a(1166),E=a(4);var h=a(1388),j=a(1389);const O="securitySolutionAssignees",k=`${O}ApplyPanel`,x=`${O}ApplyButton`,S=Object(i.memo)((({searchInputId:e,assignedUserIds:t,showUnassignedOption:a,onSelectionChange:O,onAssigneesApply:S})=>{const{data:I}=(()=>{const{security:e}=Object(d.i)().services,{addError:t}=Object(m.a)();return Object(u.useQuery)(["useGetCurrentUserProfile"],(async()=>(async({security:e})=>e.userProfiles.getCurrent({dataPath:"avatar"}))({security:e})),{retry:!1,staleTime:1/0,onError:e=>{t(e,{title:c.a})}})})(),T=Object(i.useMemo)((()=>new Set(Object(j.b)(t))),[t]),{isLoading:M,data:F}=Object(h.a)({uids:T}),[A,w]=Object(i.useState)(""),{isLoading:C,data:D}=(({searchTerm:e})=>{const{addError:t}=Object(m.a)();return Object(u.useQuery)(["useSuggestUsers",e],(async()=>(async({searchTerm:e})=>(async({searchTerm:e})=>d.b.get().http.fetch(E.cb,{method:"GET",version:"2023-10-31",query:{searchTerm:e}}))({searchTerm:e}))({searchTerm:e})),{retry:!1,staleTime:1/0,onError:e=>{t(e,{title:c.c})}})})({searchTerm:A}),N=Object(i.useMemo)((()=>{var e;const t=null!==(e=Object(j.a)(I,D))&&void 0!==e?e:[];return a&&Object(o.isEmpty)(A)?[v.b,...t]:t}),[I,A,a,D]),[_,$]=Object(i.useState)([]);Object(i.useEffect)((()=>{if(M||!F)return;const e=void 0!==t.find((e=>e===v.b))?[v.b,...F]:F;$(e)}),[t,F,M]);const L=Object(i.useCallback)((e=>{Object(n.isEqual)(e,_)||($(e),null==O||O(e.map((e=>{var t;return null!==(t=null==e?void 0:e.uid)&&void 0!==t?t:v.b}))))}),[O,_]),P=Object(i.useCallback)((()=>{const e=_.map((e=>{var t;return null!==(t=null==e?void 0:e.uid)&&void 0!==t?t:v.b}));null==S||S(e)}),[S,_]),z=Object(i.useCallback)((e=>(e=>b.i18n.translate("xpack.securitySolution.assignees.totalUsersAssigned",{defaultMessage:"{total, plural, one {# filter} other {# filters}} selected",values:{total:e}}))(e)),[]),B=M||C;return r.a.createElement("div",{"data-test-subj":k},r.a.createElement(s.b,{searchInputId:e,onSearchChange:e=>{w(e)},onChange:L,selectedStatusMessage:z,options:N,selectedOptions:_,isLoading:B,height:"full",singleSelection:!1,searchPlaceholder:f,clearButtonLabel:p,nullOptionLabel:y}),S&&r.a.createElement(l.EuiButton,{"data-test-subj":x,fullWidth:!0,size:"s",onClick:P,isDisabled:B},g))}));S.displayName="AssigneesPanel"},1529:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a(5);i.i18n.translate("xpack.securitySolution.firstLastSeenHost.errorSearchDescription",{defaultMessage:"An error has occurred on first last seen host search"});const r=i.i18n.translate("xpack.securitySolution.firstLastSeenHost.failSearchDescription",{defaultMessage:"Failed to run search on first last seen host"});var l=a(279),s=a(125);const o=({field:e,value:t,order:a,defaultIndex:i,filterQuery:o})=>{const{loading:u,result:c,search:d,error:m}=Object(l.a)({factoryQueryType:s.d,initialResult:{firstSeen:null,lastSeen:null},errorMessage:r});return Object(n.useEffect)((()=>{d({defaultIndex:i,field:e,value:t,order:a,filterQuery:o})}),[i,e,t,a,d,o]),[u,Object(n.useMemo)((()=>({firstSeen:c.firstSeen,lastSeen:c.lastSeen,errorMessage:m?m.toString():null})),[c,m])]}},1537:function(e,t,a){"use strict";a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return y}));var n=a(2),i=a.n(n),r=a(144),l=a(47),s=a(140),o=a(1325),u=a(1299),c=a(1329),d=a(1301),m=a(427);const b=`${m.a}AssetTableTab`,g=`${m.a}AssetJsonTab`,f="asset-document-details-left",p=[{id:"table","data-test-subj":b,name:i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.header.tableTabLabel",defaultMessage:"Table"}),content:i.a.createElement(d.a,null)},{id:"json","data-test-subj":g,name:i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.header.jsonTabLabel",defaultMessage:"JSON"}),content:i.a.createElement(c.a,null)}],y=Object(n.memo)((({path:e})=>{const{openLeftPanel:t}=Object(r.d)(),{eventId:a,indexName:l,scopeId:c}=Object(s.b)(),d=Object(n.useMemo)((()=>{var t;const a=p[0].id;return e&&null!==(t=p.map((e=>e.id)).find((t=>t===e.tab)))&&void 0!==t?t:a}),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(o.a,{tabs:p,selectedTabId:d,setSelectedTabId:e=>{t({id:f,path:{tab:e},params:{id:a,indexName:l,scopeId:c}})}}),i.a.createElement(u.a,{tabs:p,selectedTabId:d}))}));y.displayName="AssetDocumentLeftPanel"},1538:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(63),i=a(2),r=a(117),l=a(925),s=a(4),o=a(110);const u=()=>{const{http:e}=Object(n.useKibana)().services,{addSuccess:t,addError:a}=Object(r.a)(),u=Object(i.useRef)(null),c=Object(i.useCallback)(((e=0)=>t(l.w(e))),[t]),d=Object(i.useCallback)((e=>{a(e.message,{title:l.v})}),[a]);return Object(i.useEffect)((()=>{let e=!1;const t=new AbortController;return u.current=async(a,n,i,r)=>{try{r(!0);const l=await(async({assignees:e,ids:t,signal:a})=>o.b.get().http.fetch(s.bb,{method:"POST",version:"2023-10-31",body:JSON.stringify({assignees:e,ids:t}),signal:a}))({assignees:a,ids:n,signal:t.signal});e||(i(),r(!1),c(l.updated))}catch(t){e||(r(!1),d(t))}},()=>{e=!0,t.abort()}}),[e,d,c]),u.current}},1540:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),i=a.n(n),r=a(17),l=a(1521),s=a(1296);const o="securitySolutionUsers",u=`${o}AvatarsPanel`,c=`${o}AvatarsCountBadge`,d=Object(n.memo)((({userProfiles:e,maxVisibleAvatars:t})=>t&&e.length>t?i.a.createElement(r.EuiToolTip,{position:"top",content:e.map((e=>{var t;return i.a.createElement("div",null,e?null!==(t=e.user.email)&&void 0!==t?t:e.user.username:s.b)})),repositionOnScroll:!0},i.a.createElement(r.EuiNotificationBadge,{"data-test-subj":c,color:"subdued"},e.length)):i.a.createElement(r.EuiFlexGroup,{"data-test-subj":u,alignItems:"center",direction:"row",gutterSize:"xs"},e.map(((e,t)=>{var a,n;return i.a.createElement(r.EuiFlexItem,{key:t,grow:!1},i.a.createElement(l.a,{"data-test-subj":(n=null!==(a=null==e?void 0:e.user.username)&&void 0!==a?a:`Unknown-${t}`,`${o}Avatar-${n}`),user:null==e?void 0:e.user,avatar:null==e?void 0:e.data.avatar,size:"s"}))})))));d.displayName="UsersAvatarsPanel"},1541:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),i=a.n(n),r=a(17),l=a(9),s=a(1279),o=a(215),u=a(732),c=a(5);const d=i.a.memo((({data:e,field:t,fieldMapping:a,scripted:n})=>{const d=function(e){switch(e){case"boolean":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.booleanAriaLabel",{defaultMessage:"Boolean field"});case"conflict":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.conflictFieldAriaLabel",{defaultMessage:"Conflicting field"});case"date":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.dateFieldAriaLabel",{defaultMessage:"Date field"});case"geo_point":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.geoPointFieldAriaLabel",{defaultMessage:"Geo point field"});case"geo_shape":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.geoShapeFieldAriaLabel",{defaultMessage:"Geo shape field"});case"ip":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.ipAddressFieldAriaLabel",{defaultMessage:"IP address field"});case"murmur3":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.murmur3FieldAriaLabel",{defaultMessage:"Murmur3 field"});case"number":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.numberFieldAriaLabel",{defaultMessage:"Number field"});case"source":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.sourceFieldAriaLabel",{defaultMessage:"Source field"});case"string":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.stringFieldAriaLabel",{defaultMessage:"String field"});case"nested":return c.i18n.translate("xpack.securitySolution.fieldNameIcons.nestedFieldAriaLabel",{defaultMessage:"Nested field"});default:return c.i18n.translate("xpack.securitySolution.fieldNameIcons.unknownFieldAriaLabel",{defaultMessage:"Unknown field"})}}(e.type),m=a&&a.displayName?a.displayName:t,b=m!==t?`${t} (${m})`:t,g=null==a?void 0:a.isSubtypeMulti();return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexItem,{grow:!1,className:"eventFieldsTable__fieldIcon"},i.a.createElement(s.a,{"data-test-subj":"field-type-icon",type:e.type,label:d,scripted:n})),i.a.createElement(r.EuiFlexGroup,{wrap:!0,gutterSize:"none",responsive:!1,alignItems:"flexStart","data-test-subj":"field-name-cell"},i.a.createElement(r.EuiFlexItem,{className:"eventFieldsTable__fieldName eui-textBreakAll",grow:!1},i.a.createElement(r.EuiToolTip,{position:"top",content:Object(l.isEmpty)(e.description)?b:`${e.description} ${Object(u.c)(e.example)}`,delay:"long",anchorClassName:"eui-textBreakAll"},i.a.createElement(r.EuiText,{size:"xs","data-test-subj":"field-name"},t))),g&&i.a.createElement(r.EuiToolTip,{position:"top",delay:"long",content:o.t},i.a.createElement(r.EuiBadge,{title:"",className:"eventFieldsTable__multiFieldBadge",color:"default","data-test-subj":`eventFieldsTableRow-${t}-multifieldBadge`},o.s))))}));d.displayName="FieldNameCell"},1542:function(e,t,a){"use strict";a.d(t,"a",(function(){return C}));var n=a(45),i=a(17),r=a(2),l=a.n(r),s=a(345),o=a(44),u=a.n(o),c=a(66),d=a(124),m=a(127),b=a(756),g=a(118),f=a(241),p=a(1390),y=a(134),v=a(9),E=a(234),h=a.n(E),j=a(275),O=a(215),k=a(1394),x=a(1541);u()(i.EuiPanel).withConfig({displayName:"HoverActionsContainer",componentId:"sc-172eod5-0"})(["align-items:center;display:flex;flex-direction:row;height:25px;justify-content:center;left:5px;position:absolute;top:-10px;width:30px;"]).displayName="HoverActionsContainer";const S=h()(((e,t)=>Object(v.get)(t,e)),((e,t)=>e[0].join()===t[0].join())),I=({browserFields:e,eventId:t,contextId:a,scopeId:n,getLinkValue:r,isDraggable:s,isReadOnly:o})=>[...o?[]:[{field:"values",name:l.a.createElement(i.EuiText,{size:"xs"},l.a.createElement("strong",null,O.a)),sortable:!1,truncateText:!1,width:"132px",render:(e,t)=>l.a.createElement(j.c,{data:{field:t.field,value:e},triggerId:j.d.DETAILS_FLYOUT,mode:j.a.INLINE,visibleCellActions:3,sourcererScopeId:Object(m.getSourcererScopeId)(n),metadata:{scopeId:n,isObjectArray:t.isObjectArray}})}],{field:"field",className:"eventFieldsTable__fieldNameCell",name:l.a.createElement(i.EuiText,{size:"xs"},l.a.createElement("strong",null,O.k)),sortable:!0,truncateText:!1,render:(e,t)=>l.a.createElement(x.a,{data:t,field:e,fieldMapping:void 0})},{field:"values",className:"eventFieldsTable__fieldValueCell",name:l.a.createElement(i.EuiText,{size:"xs"},l.a.createElement("strong",null,O.E)),sortable:!0,truncateText:!1,render:(n,i)=>{const o=S([i.category,"fields",i.field],e);return l.a.createElement(k.a,{contextId:a,data:i,eventId:t,fieldFromBrowserField:o,getLinkValue:r,isDraggable:s,values:n})}}];var T=a(732),M=a(112);const F=u.a.div.withConfig({displayName:"TableWrapper",componentId:"sc-ljv1sr-0"})(["display:flex;flex:1;overflow:hidden;> div{display:flex;flex-direction:column;flex:1;overflow:hidden;> .euiFlexGroup:first-of-type{flex:0;}}"]),A=u()(i.EuiInMemoryTable).withConfig({displayName:"StyledEuiInMemoryTable",componentId:"sc-ljv1sr-1"})(["flex:1;overflow:auto;overflow-x:hidden;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}.eventFieldsTable__fieldIcon{padding-top:","px;}.eventFieldsTable__fieldName{line-height:",";padding:",";}.inlineActions{opacity:0;}.eventFieldsTable__tableRow{font-size:",";font-family:",";.inlineActions-popoverOpen{opacity:1;}&:hover{.inlineActions{opacity:1;}}}.eventFieldsTable__actionCell,.eventFieldsTable__fieldNameCell{align-items:flex-start;padding:",";}.eventFieldsTable__fieldValue{display:inline-block;word-break:break-all;word-wrap:break-word;white-space:pre-wrap;line-height:",";color:",";vertical-align:top;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(s.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner),(({theme:e})=>1.5*parseFloat(e.eui.euiSizeXS)),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily),(({theme:e})=>e.eui.euiSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiColorFullShade)),w=[25,50,100],C=l.a.memo((({browserFields:e,data:t,eventId:a,isDraggable:i,timelineTabType:s,scopeId:o,isReadOnly:u,columnsProvider:v=I})=>{const E=Object(r.useRef)(null),h=Object(r.useMemo)((()=>Object(m.isTimelineScope)(o)?g.b.getTimelineByIdSelector():Object(m.isInTableScope)(o)?d.j.getTableByIdSelector():void 0),[o]),j=Object(m.isTimelineScope)(o)?y.b:d.q,O=Object(M.a)((t=>{var a;const{columns:n}=null!==(a=h&&h(t,o))&&void 0!==a?a:j;return Object(p.b)(n,e)})),k=Object(r.useMemo)((()=>Object(f.a)(e)),[e]),x=Object(r.useMemo)((()=>Object(n.sortBy)(["field"],t).map(((e,t)=>({...e,...k[e.field],valuesConcatenated:null!=e.values?e.values.join():"",ariaRowindex:Object(c.arrayIndexToAriaIndex)(t)})))),[t,k]),S=Object(r.useCallback)((e=>{var a;const i=(null!==(a=O.find((t=>t.id===e)))&&void 0!==a?a:{}).linkField;if(!i)return null;const r=(null!=t?t:[]).find((e=>e.field===i)),l=Object(n.getOr)(null,"originalValue",r);return Array.isArray(l)?l[0]:l}),[t,O]),C=Object(r.useCallback)((({ariaRowindex:e,field:t})=>({...null!=e?{"data-rowindex":e}:{},className:"eventFieldsTable__tableRow","data-test-subj":`event-fields-table-row-${t}`})),[]),D=Object(r.useMemo)((()=>v({browserFields:e,eventId:a,contextId:`event-fields-browser-for-${o}-${s}`,scopeId:o,getLinkValue:S,isDraggable:i,isReadOnly:u})),[e,a,o,v,s,S,i,u]),N=Object(r.useCallback)((()=>{var e,t;null===(e=E.current)||void 0===e||null===(t=e.querySelector('input[type="search"]'))||void 0===t||t.focus()}),[]),_=Object(r.useCallback)((()=>{var e;null===(e=document.querySelector(`.${b.a}`))||void 0===e||e.focus()}),[]),$=Object(r.useCallback)((e=>{Object(c.isTab)(e)?Object(T.f)({containerElement:E.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:N,onSkipFocusAfterEventsTable:_}):Object(c.onKeyDownFocusHandler)({colindexAttribute:c.DATA_COLINDEX_ATTRIBUTE,containerElement:null==E?void 0:E.current,event:e,maxAriaColindex:3,maxAriaRowindex:t.length,onColumnFocused:n.noop,rowindexAttribute:c.DATA_ROWINDEX_ATTRIBUTE})}),[t,_,N]);Object(r.useEffect)((()=>{N()}),[N]);const{onTableChange:L,paginationTableProp:P}=(()=>{const[e,t]=Object(r.useState)({pageIndex:0});return{onTableChange:Object(r.useCallback)((({page:{index:e}})=>{t({pageIndex:e})}),[]),paginationTableProp:Object(r.useMemo)((()=>({...e,pageSizeOptions:w})),[e])}})();return l.a.createElement(F,{onKeyDown:$,ref:E},l.a.createElement(A,{className:T.a,items:x,itemId:"field",columns:D,onTableChange:L,pagination:P,rowProps:C,search:T.g,sorting:!1,"data-test-subj":"event-fields-browser"}))}));C.displayName="EventFieldsBrowser"},1544:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(2),i=a.n(n),r=a(1439),l=a(17),s=a(47),o=a(44);const u=a.n(o).a.p.withConfig({displayName:"P",componentId:"sc-1axlhrf-0"})(["margin-bottom:5px;"]);u.displayName="P";const c=i.a.memo((({maybeDurationNanoseconds:e,tooltipTitle:t})=>i.a.createElement(i.a.Fragment,null,null!=t?i.a.createElement(u,{"data-test-subj":"title"},t):null,i.a.createElement(u,{"data-test-subj":"humanized"},Object(r.c)(e)),i.a.createElement(u,{"data-test-subj":"raw-value"},i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.formattedDuration.tooltipLabel",defaultMessage:"raw"}),": ",e))));c.displayName="FormattedDurationTooltipContent";const d=i.a.memo((({children:e,maybeDurationNanoseconds:t,tooltipTitle:a})=>i.a.createElement(l.EuiToolTip,{"data-test-subj":"formatted-duration-tooltip",content:i.a.createElement(c,{maybeDurationNanoseconds:t,tooltipTitle:a})},i.a.createElement(i.a.Fragment,null,e))));d.displayName="FormattedDurationTooltip";const m=i.a.memo((({maybeDurationNanoseconds:e,tooltipTitle:t})=>i.a.createElement(d,{maybeDurationNanoseconds:e,tooltipTitle:t},i.a.createElement("div",{"data-test-subj":"formatted-duration"},Object(r.b)(e)))));m.displayName="FormattedDuration"},1551:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(9),i=a(73),r=a(130),l=a(83),s=a(50),o=a(212),u=a(1441),c=a(1167);const d=({agentId:e})=>{var t;const a=Object(r.a)("sentinelOneManualHostActionsEnabled"),{data:d}=Object(u.a)({actionTypeId:i.SENTINELONE_CONNECTOR_ID});return(({connectorId:e,subAction:t,subActionParams:a,disabled:n=!1,...i})=>{const{http:r}=Object(o.b)().services;return Object(s.useQuery)({queryKey:["useSubAction",e,t,a],queryFn:({signal:n})=>Object(l.executeAction)({id:e,params:{subAction:t,subActionParams:a},http:r,signal:n}),enabled:!n&&!!e&&!!t,...i})})({connectorId:null==d||null===(t=d[0])||void 0===t?void 0:t.id,subAction:i.SUB_ACTION.GET_AGENTS,subActionParams:{uuid:e},disabled:!a||Object(n.isEmpty)(e),refetchInterval:e=>{var t,a;const n=null==e||null===(t=e.data)||void 0===t||null===(a=t.data)||void 0===a?void 0:a[0].networkStatus;return!![c.a.CONNECTING,c.a.DISCONNECTING].includes(n)&&5e3}})}},1614:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2NCIgaGVpZ2h0PSI2NCIgdmlld0JveD0iMCAwIDY0IDY0Ij4KICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgPHBhdGggZmlsbD0iI0YwNEU5OCIgZD0iTTI5LDMyLjAwMDEgTDE1LjkzNSw5LjQzMjEgQzEzLjQ4LDUuMTk0MSA3LDYuOTM1MSA3LDExLjgzMjEgTDcsNTIuMTY4MSBDNyw1Ny4wNjUxIDEzLjQ4LDU4LjgwNjEgMTUuOTM1LDU0LjU2NzEgTDI5LDMyLjAwMDEgWiIvPgogICAgPHBhdGggZmlsbD0iI0ZBNzQ0RSIgZD0iTTM0Ljc3NzMsMzIuMDAwMSBMMzMuMzI3MywzNC41MDUxIEwyMC4yNjEzLDU3LjA3MzEgQzE5Ljg0NzMsNTcuNzg3MSAxOS4zNTMzLDU4LjQyNzEgMTguODAyMyw1OS4wMDAxIEwzNC45MjczLDU5LjAwMDEgQzM4LjcwNzMsNTkuMDAwMSA0Mi4yMjEzLDU3LjA2MDEgNDQuMjM2Myw1My44NjExIEw1OC4wMDAzLDMyLjAwMDEgTDM0Ljc3NzMsMzIuMDAwMSBaIi8+CiAgICA8cGF0aCBmaWxsPSIjMzQzNzQxIiBkPSJNNDQuMjM2MywxMC4xMzkyIEM0Mi4yMjEzLDYuOTQwMiAzOC43MDczLDUuMDAwMiAzNC45MjczLDUuMDAwMiBMMTguODAyMyw1LjAwMDIgQzE5LjM1MzMsNS41NzMyIDE5Ljg0NzMsNi4yMTIyIDIwLjI2MTMsNi45MjcyIEwzMy4zMjczLDI5LjQ5NDIgTDM0Ljc3NzMsMzIuMDAwMiBMNTguMDAwMywzMi4wMDAyIEw0NC4yMzYzLDEwLjEzOTIgWiIvPgogIDwvZz4KPC9zdmc+Cg=="},1615:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(1616);case"v8light":return a(1618)}},1616:function(e,t,a){var n=a(332),i=a(1617);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},1617:function(e,t,a){(t=a(333)(!1)).push([e.i,".kbnFieldButton{align-items:flex-start;border-radius:6px;display:flex;font-size:14px;font-size:1rem;line-height:1.71429rem;margin-bottom:4px;padding:0 8px;transition:box-shadow .15s cubic-bezier(.694,.0482,.335,1),background-color .15s cubic-bezier(.694,.0482,.335,1)}.kbnFieldButton-isActive,.kbnFieldButton:focus-within{outline:2px solid currentColor}.kbnFieldButton-isActive:focus-visible,.kbnFieldButton:focus-within:focus-visible{outline-style:auto}.kbnFieldButton-isActive:not(:focus-visible),.kbnFieldButton:focus-within:not(:focus-visible){outline:none}.kbnFieldButton__button{align-items:flex-start;display:flex;flex-grow:1;line-height:normal;padding:8px 0;text-align:left}.kbnFieldButton__fieldIcon{flex-shrink:0;line-height:0}.kbnFieldButton__name{flex-grow:1;padding:0 8px}.kbnFieldButton__infoIcon{align-items:center;display:flex;flex-shrink:0;justify-content:center;line-height:0;min-height:16px}.kbnFieldButton__fieldAction{margin-left:8px}.kbnFieldButton__dragHandle{margin-right:8px}.kbnFieldButton__dragHandle,.kbnFieldButton__fieldAction{line-height:32px}.kbnFieldButton--xs{font-size:12px}.kbnFieldButton--xs .kbnFieldButton__button{padding:4px 0}.kbnFieldButton--xs .kbnFieldButton__fieldAction{margin-left:4px}.kbnFieldButton--xs .kbnFieldButton__dragHandle,.kbnFieldButton--xs .kbnFieldButton__fieldAction{line-height:24px}.kbnFieldButton--flushBoth{padding-left:0;padding-right:0}",""]),e.exports=t},1618:function(e,t,a){var n=a(332),i=a(1619);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);n(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},1619:function(e,t,a){(t=a(333)(!1)).push([e.i,".kbnFieldButton{align-items:flex-start;border-radius:6px;display:flex;font-size:14px;font-size:1rem;line-height:1.71429rem;margin-bottom:4px;padding:0 8px;transition:box-shadow .15s cubic-bezier(.694,.0482,.335,1),background-color .15s cubic-bezier(.694,.0482,.335,1)}.kbnFieldButton-isActive,.kbnFieldButton:focus-within{outline:2px solid currentColor}.kbnFieldButton-isActive:focus-visible,.kbnFieldButton:focus-within:focus-visible{outline-style:auto}.kbnFieldButton-isActive:not(:focus-visible),.kbnFieldButton:focus-within:not(:focus-visible){outline:none}.kbnFieldButton__button{align-items:flex-start;display:flex;flex-grow:1;line-height:normal;padding:8px 0;text-align:left}.kbnFieldButton__fieldIcon{flex-shrink:0;line-height:0}.kbnFieldButton__name{flex-grow:1;padding:0 8px}.kbnFieldButton__infoIcon{align-items:center;display:flex;flex-shrink:0;justify-content:center;line-height:0;min-height:16px}.kbnFieldButton__fieldAction{margin-left:8px}.kbnFieldButton__dragHandle{margin-right:8px}.kbnFieldButton__dragHandle,.kbnFieldButton__fieldAction{line-height:32px}.kbnFieldButton--xs{font-size:12px}.kbnFieldButton--xs .kbnFieldButton__button{padding:4px 0}.kbnFieldButton--xs .kbnFieldButton__fieldAction{margin-left:4px}.kbnFieldButton--xs .kbnFieldButton__dragHandle,.kbnFieldButton--xs .kbnFieldButton__fieldAction{line-height:24px}.kbnFieldButton--flushBoth{padding-left:0;padding-right:0}",""]),e.exports=t},206:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return s}));var n=a(45),i=a(2),r=a.n(i);function l(e){var t;const a=t=>{const{deleteQuery:a,id:i,inspect:l=null,loading:o,refetch:u,setQuery:c,session:d}=t;s({deleteQuery:a,inspect:l,loading:o,queryId:i,refetch:u,session:d,setQuery:c});const m=Object(n.omit)(["refetch","setQuery"],t);return r.a.createElement(e,m)};return a.displayName=`ManageQuery (${null!==(t=null==e?void 0:e.displayName)&&void 0!==t?t:"Unknown"})`,a}const s=({setQuery:e,deleteQuery:t,refetch:a,inspect:n,loading:r,queryId:l,session:s})=>{Object(i.useEffect)((()=>{e({id:l,inspect:null!=n?n:null,loading:r,refetch:a,searchSessionId:null==s?void 0:s.current.start()})}),[t,e,l,a,n,r,s]),Object(i.useEffect)((()=>()=>{t&&t({id:l})}),[t,l])}},211:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(45),i=a(2),r=a(972),l=a(4);const s=e=>{const t=Object(n.some)({category:"kibana",field:"kibana.alert.rule.uuid"},e),a=Object(i.useMemo)((()=>t?Object(r.a)({category:"kibana",field:"kibana.alert.rule.uuid"},e):Object(r.a)({category:"signal",field:"signal.rule.id"},e)),[t,e]),l=Object(i.useMemo)((()=>Object(r.a)({category:"kibana",field:"kibana.alert.rule.name"},e)),[e]),s=Object(i.useMemo)((()=>Object(r.a)({category:"kibana",field:"kibana.alert.rule.description"},e)),[e]),o=Object(i.useMemo)((()=>Object(r.a)({category:"_id",field:"_id"},e)),[e]),u=Object(i.useMemo)((()=>Object(r.a)({category:"_index",field:"_index"},e)),[e]),c=Object(i.useMemo)((()=>Object(r.a)({category:"kibana",field:"kibana.alert.url"},e)),[e]),d=Object(i.useMemo)((()=>Object(r.a)({category:"agent",field:"agent.id"},e)),[e]),m=Object(i.useMemo)((()=>Object(r.a)({category:"host",field:"host.name"},e)),[e]),b=Object(i.useMemo)((()=>Object(r.a)({category:"user",field:"user.name"},e)),[e]),g=Object(i.useMemo)((()=>Object(r.a)({category:"base",field:"@timestamp"},e)),[e]);return Object(i.useMemo)((()=>({agentId:d,alertId:o,alertUrl:c,data:e,hostName:m,indexName:u,isAlert:t,ruleDescription:s,ruleId:a,ruleName:l,timestamp:g,userName:b})),[d,o,c,e,m,u,t,s,a,l,g,b])},o=(e,t="default")=>e.startsWith(`.internal${l.w}`)?`${l.w}-${t}`:e.startsWith(`.internal${l.Q}`)?`${l.Q}-${t}`:void 0},216:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(44),i=a.n(n),r=a(2),l=a.n(r),s=a(17),o=a(5);a(13);const u=({header:{title:e,link:t,iconType:a,headerContent:n},content:{loading:i,error:u}={loading:!1,error:!1},expand:{expandable:b,expandedOnFirstRender:g}={expandable:!1,expandedOnFirstRender:!1},"data-test-subj":f,children:p})=>{const[y,v]=Object(r.useState)(g),E=Object(r.useCallback)((()=>{v(!y)}),[v,y]),h=Object(r.useMemo)((()=>l.a.createElement(s.EuiButtonIcon,{"data-test-subj":`${f}ToggleIcon`,"aria-label":o.i18n.translate("xpack.securitySolution.flyout.shared.ExpandablePanelButtonIconAriaLabel",{defaultMessage:"Expandable panel toggle"}),color:"text",display:"empty",iconType:y?"arrowDown":"arrowRight",onClick:E,size:"xs"})),[f,y,E]),{euiTheme:j}=Object(s.useEuiTheme)(),O=Object(r.useMemo)((()=>l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1,"data-test-subj":`${f}LeftSection`},l.a.createElement(s.EuiFlexItem,{grow:!1},b&&p&&h),l.a.createElement(s.EuiFlexItem,{grow:!1},l.a.createElement(c,{color:null!=t&&t.callback?"primary":"text",type:a,"data-test-subj":`${f}TitleIcon`,$_css:j.size.s})),l.a.createElement(s.EuiFlexItem,{grow:!1},null!=t&&t.callback?l.a.createElement(s.EuiToolTip,{content:null==t?void 0:t.tooltip},l.a.createElement(d,{"data-test-subj":`${f}TitleLink`,onClick:null==t?void 0:t.callback},e)):l.a.createElement(s.EuiTitle,{size:"xxxs"},l.a.createElement(s.EuiText,{"data-test-subj":`${f}TitleText`},e)))))),[f,b,p,h,null==t?void 0:t.callback,a,j.size.s,null==t?void 0:t.tooltip,e]),k=Object(r.useMemo)((()=>n&&l.a.createElement(m,{grow:!1,"data-test-subj":`${f}RightSection`,$_css2:j.size.m},n)),[f,j.size.m,n]),x=Object(r.useMemo)((()=>!!p&&(!b||b&&y)),[p,b,y]),S=i?l.a.createElement(s.EuiSkeletonText,{"data-test-subj":`${f}Loading`,contentAriaLabel:o.i18n.translate("xpack.securitySolution.flyout.shared.expandablePanelLoadingAriaLabel",{defaultMessage:"expandable panel"})}):u?null:p;return l.a.createElement(s.EuiSplitPanel.Outer,{grow:!0,hasBorder:!0},l.a.createElement(s.EuiSplitPanel.Inner,{grow:!1,color:"subdued",paddingSize:"xs"},l.a.createElement(s.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},O,k)),x&&l.a.createElement(s.EuiSplitPanel.Inner,{paddingSize:"none"},l.a.createElement(s.EuiPanel,{"data-test-subj":`${f}Content`},S)))};u.displayName="ExpandablePanel";var c=i()(s.EuiIcon).withConfig({displayName:"_StyledEuiIcon",componentId:"sc-6xxggh-0"})(["margin:"," 0;"],(e=>e.$_css)),d=i()(s.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-6xxggh-1"})(["font-size:12px;font-weight:700;"]),m=i()(s.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-6xxggh-2"})(["margin-right:",";"],(e=>e.$_css2))},275:function(e,t,a){"use strict";a.d(t,"e",(function(){return d})),a.d(t,"c",(function(){return m}));var n=a(23),i=a.n(n),r=a(320),l=a(2),s=a.n(l),o=a(321);a.d(t,"d",(function(){return o.e})),a.d(t,"b",(function(){return o.d}));var u=a(116),c=a(1361);a.d(t,"a",(function(){return r.b}));const d=r.j,m=({sourcererScopeId:e=u.SourcererScopeName.default,data:t,children:a,...n})=>{const o=Object(c.a)(e),d=JSON.stringify(t),m=Object(l.useMemo)((()=>(Array.isArray(t)?t:[t]).map((({field:e,value:t})=>({field:o(e),value:t}))).filter((e=>!!e.field))),[d,o]);return m.length>0?s.a.createElement(r.a,i()({data:m},n),a):s.a.createElement(s.a.Fragment,null,a)}},279:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a(64),i=a(45),r=a(2),l=a(152),s=a(19),o=a(100),u=a(5);const c=e=>u.i18n.translate("xpack.securitySolution.searchStrategy.error",{values:{factoryQueryType:e},defaultMessage:"Failed to run search: {factoryQueryType}"});var d=a(127),m=a(110),b=a(117),g=a(336),f=a(4);const p={dsl:[],response:[]},y=({factoryQueryType:e,initialResult:t,errorMessage:a,abort:u=!1,showErrorToast:y=!0})=>{const v=Object(r.useRef)(new AbortController),E=Object(r.useRef)(i.noop),{addError:h}=Object(b.a)(),j=(e=>{const{data:t}=Object(m.i)().services,{startTracking:a}=Object(g.a)();return Object(r.useCallback)((({abortSignal:i,request:r})=>{const{endTracking:l}=a({name:`${f.l} searchStrategy ${e}`,spanName:"batched search"}),o=t.search.search({...r,factoryQueryType:e},{strategy:"securitySolutionSearchStrategy",abortSignal:i}).pipe(Object(n.filter)((e=>!Object(s.isRunningResponse)(e))));return o.subscribe({next:e=>{l("success")},error:()=>{l(i.aborted?"aborted":"error")}}),o}),[t.search,e,a])})(e),{start:O,error:k,result:x,loading:S}=Object(l.c)(j);Object(r.useEffect)((()=>{!y||null==k||k instanceof o.AbortError||h(k,{title:null!=a?a:c(e)})}),[h,k,a,e,y]);const I=Object(r.useCallback)((e=>{const t=()=>{v.current=new AbortController,O({request:e,abortSignal:v.current.signal})};v.current.abort(),t(),E.current=t}),[O]);Object(r.useEffect)((()=>()=>{v.current.abort()}),[]),Object(r.useEffect)((()=>{u&&v.current.abort()}),[u]);const[T,M]=Object(r.useMemo)((()=>x?[Object(i.omit)("rawResponse",x),Object(d.getInspectResponse)(x,p)]:[t,p]),[x,t]);return{loading:S,result:T,error:k,search:I,refetch:E.current,inspect:M}}},285:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"g",(function(){return i})),a.d(t,"p",(function(){return r})),a.d(t,"h",(function(){return l})),a.d(t,"f",(function(){return s})),a.d(t,"i",(function(){return o})),a.d(t,"c",(function(){return u})),a.d(t,"m",(function(){return c})),a.d(t,"l",(function(){return d})),a.d(t,"e",(function(){return m})),a.d(t,"n",(function(){return b})),a.d(t,"o",(function(){return g})),a.d(t,"a",(function(){return f})),a.d(t,"j",(function(){return p})),a.d(t,"k",(function(){return y})),a.d(t,"d",(function(){return v}));const n="date",i="host.name",r="user.name",l="ip",s="geo_point",o="message",u="event.module",c="rule.reference",d="reference.url",m="event.url",b="kibana.alert.rule.name",g="kibana.alert.workflow_status",f="agent.status",p="quarantined.path",y="kibana.alert.reason",v="eventSummary"},321:function(e,t,a){"use strict";a.d(t,"e",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"a",(function(){return o}));var n=a(239);let i,r,l,s;!function(e){e.DEFAULT="security-default-cellActions",e.DETAILS_FLYOUT="security-detailsFlyout-cellActions",e.ALERTS_COUNT="security-alertsCount-cellActions"}(i||(i={})),function(e){e.HISTOGRAM_TRIGGER="security-discoverInTimeline-histogramTrigger"}(r||(r={})),function(e){e.VIS_FILTER_ACTION="security-discoverInTimeline-visFilterAction"}(l||(l={})),function(e){e.FILTER="security-cellAction-type-filter",e.COPY="security-cellAction-type-copyToClipboard",e.ADD_TO_TIMELINE="security-cellAction-type-addToTimeline",e.INVESTIGATE_IN_NEW_TIMELINE="security-cellAction-type-investigateInNewTimeline",e.SHOW_TOP_N="security-cellAction-type-showTopN",e.TOGGLE_COLUMN="security-cellAction-type-toggleColumn"}(s||(s={}));const o={FILTER:n.c,COPY:n.a}},331:function(e,t,a){"use strict";a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return d}));var n=a(17),i=a(2),r=a.n(i);const l="closed",s="open",o=e=>e===l?s:l,u="Header",c="Content",d=({expanded:e,title:t,children:a,"data-test-subj":d})=>{const m=Object(n.useGeneratedHtmlId)({prefix:"accordion"}),{renderContent:b,toggle:g,state:f}=(e=>{const t=e?s:l,[a,n]=Object(i.useReducer)(o,t);return{renderContent:a===s,state:a,toggle:n}})(e),p=d+u,y=d+c,v=r.a.createElement(n.EuiTitle,{size:"xs","data-test-subj":p},r.a.createElement("h4",null,t));return r.a.createElement(n.EuiAccordion,{forceState:f,onToggle:g,id:m,buttonContent:v},r.a.createElement(n.EuiSpacer,{size:"m"}),r.a.createElement(n.EuiFlexGroup,{gutterSize:"none",direction:"column","data-test-subj":y},b&&a))};d.displayName="ExpandableSection"},332:function(e,t,a){"use strict";var n,i=function(){var e={};return function(t){if(void 0===e[t]){var a=document.querySelector(t);if(window.HTMLIFrameElement&&a instanceof window.HTMLIFrameElement)try{a=a.contentDocument.head}catch(e){a=null}e[t]=a}return e[t]}}(),r=[];function l(e){for(var t=-1,a=0;a<r.length;a++)if(r[a].identifier===e){t=a;break}return t}function s(e,t){for(var a={},n=[],i=0;i<e.length;i++){var s=e[i],o=t.base?s[0]+t.base:s[0],u=a[o]||0,c="".concat(o," ").concat(u);a[o]=u+1;var d=l(c),m={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(r[d].references++,r[d].updater(m)):r.push({identifier:c,updater:f(m,t),references:1}),n.push(c)}return n}function o(e){var t=document.createElement("style"),n=e.attributes||{};if(void 0===n.nonce){var r=a.nc;r&&(n.nonce=r)}if(Object.keys(n).forEach((function(e){t.setAttribute(e,n[e])})),"function"==typeof e.insert)e.insert(t);else{var l=i(e.insert||"head");if(!l)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");l.appendChild(t)}return t}var u,c=(u=[],function(e,t){return u[e]=t,u.filter(Boolean).join("\n")});function d(e,t,a,n){var i=a?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(e.styleSheet)e.styleSheet.cssText=c(t,i);else{var r=document.createTextNode(i),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(r,l[t]):e.appendChild(r)}}function m(e,t,a){var n=a.css,i=a.media,r=a.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),r&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(r))))," */")),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}var b=null,g=0;function f(e,t){var a,n,i;if(t.singleton){var r=g++;a=b||(b=o(t)),n=d.bind(null,a,r,!1),i=d.bind(null,a,r,!0)}else a=o(t),n=m.bind(null,a,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(a)};return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=(void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n));var a=s(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var n=0;n<a.length;n++){var i=l(a[n]);r[i].references--}for(var o=s(e,t),u=0;u<a.length;u++){var c=l(a[u]);0===r[c].references&&(r[c].updater(),r.splice(c,1))}a=o}}}},333:function(e,t,a){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var a=function(e,t){var a,n,i,r=e[1]||"",l=e[3];if(!l)return r;if(t&&"function"==typeof btoa){var s=(a=l,n=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),i="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),"/*# ".concat(i," */")),o=l.sources.map((function(e){return"/*# sourceURL=".concat(l.sourceRoot||"").concat(e," */")}));return[r].concat(o).concat([s]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(a,"}"):a})).join("")},t.i=function(e,a,n){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(n)for(var r=0;r<this.length;r++){var l=this[r][0];null!=l&&(i[l]=!0)}for(var s=0;s<e.length;s++){var o=[].concat(e[s]);n&&i[o[0]]||(a&&(o[2]?o[2]="".concat(a," and ").concat(o[2]):o[2]=a),t.push(o))}},t}},385:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=e=>e.capabilities.canGetJobs&&e.capabilities.canGetDatafeeds&&e.capabilities.canGetCalendars},386:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return d}));var n=a(50),i=a(2),r=a(1096),l=a(583),s=a(130);const o=["GET","FETCH_RISK_ENGINE_STATUS"],u=()=>{const e=Object(n.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(o,{refetchType:"active"})}),[e])},c=()=>{var e;const{data:t}=d();return null!==(e=null==t?void 0:t.isNewRiskScoreModuleInstalled)&&void 0!==e&&e},d=()=>{const e=Object(s.a)("riskScoringRoutesEnabled");return Object(n.useQuery)(o,(async({signal:t})=>{if(!e)return{isUpdateAvailable:!1,isNewRiskScoreModuleInstalled:!1,isNewRiskScoreModuleAvailable:e,risk_engine_status:null,legacy_risk_engine_status:null,is_max_amount_of_risk_engines_reached:!1};const a=await Object(r.d)({signal:t});return{isUpdateAvailable:(null==a?void 0:a.legacy_risk_engine_status)===l.a.ENABLED&&a.risk_engine_status===l.a.NOT_INSTALLED,isNewRiskScoreModuleInstalled:a.risk_engine_status!==l.a.NOT_INSTALLED,isNewRiskScoreModuleAvailable:e,...a}}))}},394:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(44),i=a.n(n),r=a(2),l=a.n(r),s=a(17),o=(a(13),a(1360));const u=({"data-test-subj":e=o.d})=>l.a.createElement(c,null,l.a.createElement(s.EuiLoadingSpinner,{size:"xxl","data-test-subj":e}));var c=i()(s.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-1k8lpq1-0"})(["align-items:center;justify-content:center;"])},413:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return l}));var n=a(2),i=a(110);const r=()=>{const[e,t]=Object(n.useState)(!1),a=Object(n.useCallback)((()=>{t(!1)}),[]);return[e,Object(n.useCallback)((()=>{t(!0)}),[]),a]},l=e=>{const{capabilities:t}=Object(i.i)().services.application;return!!t.siem[e]}},427:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="securitySolutionFlyout"},428:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(142),i=a(114),r=a(2),l=a(325),s=a(117),o=a(297),u=a(298),c=a(765),d=a(557),m=a(1059);const b=e=>({query:{bool:{filter:[{bool:{should:[{match:{"signal.rule.id":e}},{match:{[n.V]:e}}],minimum_should_match:1}}]}},size:1}),g=e=>{const{isFetching:t,data:a,error:n,refetch:l}=Object(m.a)(e,!1),{addError:g}=Object(s.a)(),f=!Object(i.u)(n),{loading:p,data:v}=Object(u.a)({query:b(e),skip:f,queryName:o.a.BY_RULE_ID});Object(r.useEffect)((()=>{null==n||Object(i.u)(n)||g(n,{title:d.b})}),[g,n]);const E=Object(r.useMemo)((()=>{const e=f?a:null==v?void 0:y(v);if(e)return Object(c.a)(e)}),[f,v,a]);return{error:n,loading:t||p,refresh:l,rule:null!=E?E:null,isExistingRule:f}},f=e=>{if(!e||!Array.isArray(e))return e},p=e=>e?{...e,investigation_fields:f(e.investigation_fields)}:e,y=e=>{var t,a,n,i;if(0===e.hits.hits.length)return;const r=e.hits.hits[0],s=null!==(t=null===(a=r._source.signal)||void 0===a?void 0:a.rule)&&void 0!==t?t:null===(n=r._source.kibana)||void 0===n||null===(i=n.alert)||void 0===i?void 0:i.rule;if(null==s){var o,u,c,d,m,b;const e=Object(l.a)(null!==(o=r._source)&&void 0!==o?o:{}),t={...null==e||null===(u=e.kibana)||void 0===u||null===(c=u.alert)||void 0===c?void 0:c.rule,...null==e||null===(d=e.kibana)||void 0===d||null===(m=d.alert)||void 0===m||null===(b=m.rule)||void 0===b?void 0:b.parameters};return delete t.parameters,p(t)}return p(s)}},433:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(56),i=a.n(n);const r=(e,t)=>"second"===t||"minute"===t||"hour"===t?{from:i()(e.time).subtract(1,"hour").toISOString(),to:i()(e.time).add(1,"hour").toISOString()}:{from:i()(e.time).subtract(1,"day").toISOString(),to:i()(e.time).add(1,"day").toISOString()}},464:function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"g",(function(){return j})),a.d(t,"d",(function(){return O})),a.d(t,"e",(function(){return k})),a.d(t,"f",(function(){return x})),a.d(t,"i",(function(){return S})),a.d(t,"h",(function(){return I})),a.d(t,"a",(function(){return M})),a.d(t,"c",(function(){return F}));var n=a(17),i=a(47),r=a(45),l=a(2),s=a.n(l),o=a(44),u=a.n(o),c=a(275),d=a(174),m=a(166),b=a(126),g=(a(155),a(137)),f=a(214),p=a(397),y=a(116),v=a(689);const E=u()(n.EuiFlexGroup).withConfig({displayName:"DraggableContainerFlexGroup",componentId:"sc-17s23cb-0"})(["flex-grow:unset;"]),h="ip-overview",j=(e,t,a,i)=>e.length>0&&e.every((e=>Object(r.getOr)(null,e,t)))?s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},e.map(((e,o)=>{const u=Object(r.getOr)("",e,t);return s.a.createElement(l.Fragment,{key:`${h}-${e}`},o?", ":"",s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(m.b,{id:`location-renderer-default-draggable-${h}-${a?`${a}-`:""}${e}`,isDraggable:null!=i&&i,field:e,value:u,isAggregatable:!0,fieldType:"keyword"})))}))):Object(b.d)(),O=(e,t,a,i)=>e&&e.organization&&e.organization.name&&e.number?s.a.createElement(n.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(m.b,{id:`autonomous-system-renderer-default-draggable-${h}-${a?`${a}-`:""}${t}.as.organization.name`,isDraggable:null!=i&&i,field:`${t}.as.organization.name`,value:e.organization.name})),s.a.createElement(n.EuiFlexItem,{grow:!1},"/"),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(m.b,{id:`autonomous-system-renderer-default-draggable-${h}-${a?`${a}-`:""}${t}.as.number`,isDraggable:!1,field:`${t}.as.number`,value:`${e.number}`,isAggregatable:!0,fieldType:"number"}))):Object(b.d)(),k=({contextID:e,host:t,isDraggable:a=!1,ipFilter:n,noLink:i})=>t.id&&t.ip&&(null==n||t.ip.includes(n))?s.a.createElement(s.a.Fragment,null,t.name&&null!=t.name[0]?s.a.createElement(m.b,{id:`host-id-renderer-default-draggable-${h}-${e?`${e}-`:""}host-id`,isDraggable:a,field:"host.id",value:t.id[0],isAggregatable:!0,fieldType:"keyword"},i?s.a.createElement(s.a.Fragment,null,t.id):s.a.createElement(g.d,{hostName:t.name[0]},t.id)):s.a.createElement(s.a.Fragment,null,t.id)):Object(b.d)(),x=(e,t,a,n)=>e&&e.name&&e.name[0]&&e.ip&&(null==t||e.ip.includes(t))?s.a.createElement(m.b,{id:`host-name-renderer-default-draggable-${h}-${a?`${a}-`:""}host-name`,isDraggable:null!=n&&n,field:"host.name",value:e.name[0],isAggregatable:!0,fieldType:"keyword"},s.a.createElement(g.d,{hostName:e.name[0]},e.name?e.name:Object(b.d)())):Object(b.d)(),S=e=>s.a.createElement(g.n,{domain:e},p.n),I=e=>s.a.createElement(g.j,{domain:e,direction:"column"}),T=({attrName:e,displayCount:t=1,idPrefix:a,isDraggable:i=!1,moreMaxHeight:r="200px",render:l,rowItems:o,sourcererScopeId:u})=>{if(null!=o&&o.length>0){const c=o.slice(0,t).map(((t,r)=>{const o=Object(d.i)(`default-field-renderer-default-draggable-${a}-${e}-${t}`);return s.a.createElement(n.EuiFlexItem,{key:o,grow:!1},0!==r&&s.a.createElement(s.a.Fragment,null,",",s.a.createElement(f.i,null)),"string"==typeof t&&s.a.createElement(m.b,{id:o,isDraggable:i,field:e,value:t,isAggregatable:!0,fieldType:"keyword"},l?l(t):t))}));return c.length>0?s.a.createElement(E,{alignItems:"center",gutterSize:"none",component:"span","data-test-subj":"DefaultFieldRendererComponent"},s.a.createElement(n.EuiFlexItem,{grow:!1},c," "),s.a.createElement(n.EuiFlexItem,{grow:!1},s.a.createElement(A,{attrName:e,idPrefix:a,moreMaxHeight:r,overflowIndexStart:t,render:l,rowItems:o,sourcererScopeId:u}))):Object(b.d)()}return Object(b.d)()},M=s.a.memo(T);M.displayName="DefaultFieldRenderer";const F=s.a.memo((({fieldName:e,idPrefix:t,moreMaxHeight:a,overflowIndexStart:i,render:r,values:o,sourcererScopeId:u})=>{const{timelineId:m}=Object(l.useContext)(v.b),g=Object(l.useMemo)((()=>o.slice(i).reduce(((a,i,l)=>{const o=Object(d.i)(`${t}-${e}-${i}-${l}`);return"string"==typeof i&&null!=e&&a.push(s.a.createElement(n.EuiFlexItem,{key:o},s.a.createElement(c.c,{key:o,mode:c.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:c.d.DEFAULT,data:{value:i,field:e},sourcererScopeId:null!=u?u:y.SourcererScopeName.default,metadata:{scopeId:null!=m?m:void 0}},s.a.createElement(s.a.Fragment,null,r?r(i):Object(b.a)(i))))),a}),[])),[o,i,t,e,m,r,u]);return s.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:a,paddingRight:"2px"}},s.a.createElement(n.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},g))}));F.displayName="MoreContainer";const A=s.a.memo((({attrName:e,idPrefix:t,moreMaxHeight:a,overflowIndexStart:r=5,render:o,rowItems:u,sourcererScopeId:c})=>{const[d,m]=Object(l.useState)(!1),b=Object(l.useCallback)((()=>m((e=>!e))),[]),g=Object(l.useMemo)((()=>s.a.createElement(s.a.Fragment,null," ,",s.a.createElement(n.EuiButtonEmpty,{size:"xs",onClick:b,"data-test-subj":"DefaultFieldRendererOverflow-button"},`+${u.length-r} `,s.a.createElement(i.FormattedMessage,{id:"xpack.securitySolution.fieldRenderers.moreLabel",defaultMessage:"More"})))),[b,r,u.length]);return s.a.createElement(n.EuiFlexItem,{grow:!1},u.length>r&&s.a.createElement(n.EuiPopover,{id:"popover",button:g,isOpen:d,closePopover:b,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},s.a.createElement(F,{fieldName:e,idPrefix:t,render:o,values:u,moreMaxHeight:a,overflowIndexStart:r,sourcererScopeId:c})))}));A.displayName="DefaultFieldRendererOverflow"},479:function(e,t,a){"use strict";a.d(t,"c",(function(){return j})),a.d(t,"d",(function(){return k})),a.d(t,"b",(function(){return x})),a.d(t,"a",(function(){return S}));var n=a(2),i=a(210),r=a(1132),l=a(110),s=a(4);const o=async e=>{const{indexName:t,entity:a}=e.query;return l.b.get().http.fetch(s.jc,{method:"GET",version:"1",query:{indexName:t,entity:a},asSystemRequest:!0,signal:e.signal})};var u=a(413);const c=(e,t)=>{const{isPlatinumOrTrialLicense:a,capabilitiesFetched:l}=Object(i.a)(),s=Object(u.a)("entity-analytics"),c=a&&s,{fetch:d,data:m,isLoading:b,error:g}=Object(r.b)(r.a.GET_RISK_SCORE_DEPRECATED,o),f=Object(n.useMemo)((()=>m||{isDeprecated:c,isEnabled:c}),[m]),p=Object(n.useCallback)((t=>{c&&d({query:{indexName:t,entity:e}})}),[c,d,e]);return Object(n.useEffect)((()=>{null!=t&&p(t)}),[t,p]),{error:g,isLoading:b||!l||null==t,refetch:p,isAuthorized:c,...f}};var d=a(209),m=a(125),b=a(5);b.i18n.translate("xpack.securitySolution.riskScore.errorSearchDescription",{defaultMessage:"An error has occurred on risk score search"});const g=b.i18n.translate("xpack.securitySolution.riskScore.failSearchDescription",{defaultMessage:"Failed to run search on risk score"});var f=a(117);const p=e=>{var t,a;return"index_not_found_exception"===(null===(t=e.attributes)||void 0===t||null===(a=t.caused_by)||void 0===a?void 0:a.type)};var y=a(620),v=a(279),E=a(386);const h={totalCount:0,data:void 0},j=({timerange:e,onlyLatest:t=!0,filterQuery:a,sort:i,skip:r=!1,pagination:l,riskEntity:s,includeAlertsCount:o=!1})=>{const u=Object(y.a)(),b=Object(E.b)(),j=u?s===m.v.host?Object(m.D)(u,t,b):Object(m.E)(u,t,b):void 0,O=s===m.v.host?m.u.hostsRiskScore:m.u.usersRiskScore,{querySize:k,cursorStart:x}=l||{},{addError:S}=Object(f.a)(),{isDeprecated:I,isEnabled:T,isAuthorized:M,isLoading:F,refetch:A}=c(s,j),{loading:w,result:C,search:D,refetch:N,inspect:_,error:$}=Object(v.a)({factoryQueryType:O,initialResult:h,abort:r,showErrorToast:!1}),L=Object(n.useCallback)((()=>{j&&(A(j),N())}),[j,N,A]),P=Object(n.useMemo)((()=>({data:C.data,inspect:_,refetch:L,totalCount:C.totalCount,isAuthorized:M,isDeprecated:I,isModuleEnabled:T,isInspected:!1})),[_,I,T,M,L,C.data,C.totalCount]),z=Object(n.useMemo)((()=>e?{to:e.to,from:e.from,interval:""}:void 0),[e]),B=Object(n.useMemo)((()=>j?{defaultIndex:[j],factoryQueryType:O,riskScoreEntity:s,includeAlertsCount:o,filterQuery:Object(d.a)(a),pagination:void 0!==x&&void 0!==k?{cursorStart:x,querySize:k}:void 0,sort:i,timerange:z,alertsTimerange:o?z:void 0}:null),[x,j,O,a,k,i,z,s,o]);return Object(n.useEffect)((()=>{$&&(p($)||S($,{title:g}))}),[S,$]),Object(n.useEffect)((()=>{r||F||null==B||!M||!T||I||D(B)}),[T,I,M,F,B,D,r]),{...P,loading:w||F}},O=b.i18n.translate("xpack.securitySolution.riskScore.kpi.failSearchDescription",{defaultMessage:"Failed to run search on risk score"}),k=({filterQuery:e,skip:t,riskEntity:a,timerange:i})=>{const{addError:r}=Object(f.a)(),l=Object(y.a)(),s=Object(E.b)(),o=l?a===m.v.host?Object(m.D)(l,!0,s):Object(m.E)(l,!0,s):void 0,{isDeprecated:u,isEnabled:d,isAuthorized:b,isLoading:g,refetch:h}=c(a,o),{loading:j,result:k,search:x,refetch:S,inspect:I,error:T}=Object(v.a)({factoryQueryType:m.u.kpiRiskScore,initialResult:{kpiRiskScore:m.c},abort:t,showErrorToast:!1}),M=!!T&&p(T),F=Object(n.useMemo)((()=>i?{to:i.to,from:i.from,interval:""}:void 0),[i]);Object(n.useEffect)((()=>{!t&&o&&!g&&b&&d&&!u&&x({filterQuery:e,defaultIndex:[o],entity:a,timerange:F})}),[o,x,e,t,a,F,d,u,b,g]);const A=Object(n.useCallback)((()=>{o&&(h(o),S())}),[o,S,h]);Object(n.useEffect)((()=>{T&&(p(T)||r(T,{title:O}))}),[r,T]);const w=Object(n.useMemo)((()=>{var e,t,a,n,i;if(!j&&!T)return{[m.x.unknown]:null!==(e=k.kpiRiskScore[m.x.unknown])&&void 0!==e?e:0,[m.x.low]:null!==(t=k.kpiRiskScore[m.x.low])&&void 0!==t?t:0,[m.x.moderate]:null!==(a=k.kpiRiskScore[m.x.moderate])&&void 0!==a?a:0,[m.x.high]:null!==(n=k.kpiRiskScore[m.x.high])&&void 0!==n?n:0,[m.x.critical]:null!==(i=k.kpiRiskScore[m.x.critical])&&void 0!==i?i:0}}),[k,j,T]);return{error:T,severityCount:w,loading:j,isModuleDisabled:M,refetch:A,inspect:I}};let x,S;!function(e){e.USERS_BY_RISK="UsersByRisk",e.USER_DETAILS_RISK_SCORE="UserDetailsRiskScore"}(x||(x={})),function(e){e.DEFAULT="HostRiskScore",e.HOST_DETAILS_RISK_SCORE="HostDetailsRiskScore",e.OVERVIEW_RISKY_HOSTS="OverviewRiskyHosts",e.HOSTS_BY_RISK="HostsByRisk"}(S||(S={}))},491:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(2),i=a.n(n),r=a(17),l=a(47),s=a(1360);const o=()=>i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiEmptyPrompt,{iconType:"error",color:"danger",title:i.a.createElement("h2",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.shared.errorTitle",defaultMessage:"Unable to display {title}.",values:{title:"data"}})),body:i.a.createElement("p",null,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.shared.errorDescription",defaultMessage:"There was an error displaying {message}.",values:{message:"data"}})),"data-test-subj":s.c}));o.displayName="FlyoutError"},557:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){return l}));var n=a(5);const i=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.rulesAndTimelines",{defaultMessage:"Failed to fetch Rules and Timelines"}),r=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.ruleManagementFiltersFetchFailure",{defaultMessage:"Failed to fetch rule filters"}),l=n.i18n.translate("xpack.securitySolution.containers.detectionEngine.addRuleFailDescription",{defaultMessage:"Failed to add Rule"});n.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedRuleAndTimelineFailDescription",{defaultMessage:"Failed to installed pre-packaged rules and timelines from elastic"}),n.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedRuleAndTimelineSuccesDescription",{defaultMessage:"Installed pre-packaged rules and timeline templates from elastic"}),n.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedRuleSuccesDescription",{defaultMessage:"Installed pre-packaged rules from elastic"}),n.i18n.translate("xpack.securitySolution.containers.detectionEngine.createPrePackagedTimelineSuccesDescription",{defaultMessage:"Installed pre-packaged timeline templates from elastic"})},565:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a.n(n),r=a(577),l=a(1087);const s=i.a.memo((({influencers:e,startDate:t,endDate:a,children:s,criteriaFields:o,skip:u})=>{const{jobNameById:c}=Object(r.a)(),d=Object(n.useMemo)((()=>Object.keys(c)),[c]),[m,b]=Object(l.a)({criteriaFields:o,influencers:e,startDate:t,endDate:a,skip:u,jobIds:d,aggregationInterval:"auto"});return i.a.createElement(i.a.Fragment,null,s({isLoadingAnomaliesData:m,anomaliesData:b,jobNameById:c}))}));s.displayName="AnomalyTableProvider"},566:function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return l})),a.d(t,"c",(function(){return s}));var n=a(45),i=a(972);const r="observer.serial_number",l=e=>Object(i.a)({category:"observer",field:r},e)||void 0,s=({data:e})=>{var t,a;if(a=e,!Object(n.some)({category:"kibana",field:"kibana.alert.rule.uuid"},a))return!1;const i=null===(t=Object(n.find)({field:"event.module"},e))||void 0===t?void 0:t.values;return!!i&&"sentinel_one"===i[0]}},567:function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(2),i=a.n(n),r=a(45),l=a(55),s=a(1102);const{euiColorVis0:o,euiColorVis5:u,euiColorVis7:c,euiColorVis9:d}=l.euiLightVars,m={low:o,medium:u,high:c,critical:d},b=({value:e,"data-test-subj":t="severity"})=>{var a;const n=Object(r.upperFirst)(e),l=null!==(a=m[e])&&void 0!==a?a:"subdued";return i.a.createElement(s.a,{healthColor:l,tooltipContent:n,dataTestSubj:t},n)},g=i.a.memo(b)},569:function(e,t,a){"use strict";a.d(t,"b",(function(){return f})),a.d(t,"a",(function(){return j}));var n=a(2),i=a.n(n),r=a(47),l=a(17),s=a(44),o=a.n(s),u=a(275),c=a(174),d=a(126),m=a(214),b=a(464);const g=o.a.div.withConfig({displayName:"Subtext",componentId:"sc-19v49l5-0"})(["font-size:",";"],(e=>e.theme.eui.euiFontSizeXS)),f=({values:e,fieldName:t,idPrefix:a,render:n,displayCount:r=5,maxOverflow:l=5})=>{if(null!=e&&e.length>0){const s=e.slice(0,r).map(((e,r)=>{const l=Object(c.i)(`${a}-${t}-${e}-${r}`);return i.a.createElement(u.c,{key:l,mode:u.a.HOVER_DOWN,visibleCellActions:5,showActionTooltips:!0,triggerId:u.d.DEFAULT,data:{value:e,field:t}},i.a.createElement(i.a.Fragment,null,n?n(e):Object(d.a)(e)))}));return s.length>0?i.a.createElement(i.a.Fragment,null,s," ",i.a.createElement(y,{fieldName:t,values:e,idPrefix:a,maxOverflowItems:l,overflowIndexStart:r})):Object(d.d)()}return Object(d.d)()},p=({fieldName:e,values:t,idPrefix:a,maxOverflowItems:n=5,overflowIndexStart:s=5})=>i.a.createElement(i.a.Fragment,null,t.length>s&&i.a.createElement(E,{count:t.length-s,idPrefix:a},i.a.createElement(l.EuiText,{size:"xs"},i.a.createElement(b.c,{fieldName:e,idPrefix:a,values:t,overflowIndexStart:s,moreMaxHeight:"none"}),t.length>s+n&&i.a.createElement("p",{"data-test-subj":"popover-additional-overflow"},i.a.createElement(l.EuiTextColor,{color:"subdued"},t.length-s-n," ",i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.tables.rowItemHelper.moreDescription",defaultMessage:"more not shown"}))))));p.displayName="RowItemOverflowComponent";const y=i.a.memo(p),v=({children:e,count:t,idPrefix:a})=>{const[s,o]=Object(n.useState)(!1),u=Object(n.useCallback)((()=>{o(!s)}),[s]);return i.a.createElement(g,null,i.a.createElement(l.EuiPopover,{button:i.a.createElement(l.EuiLink,{onClick:u,"data-test-subj":"overflow-button"},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.tables.rowItemHelper.overflowButtonDescription",defaultMessage:"+{count} More",values:{count:t}})),closePopover:()=>o(!s),id:`${a}-popover`,isOpen:s,panelClassName:"withHoverActions__popover",repositionOnScroll:!0},e))};v.displayName="PopoverComponent";const E=i.a.memo(v);E.displayName="Popover";const h=({value:e,showToolTip:t=!0,overflowLength:a=50})=>i.a.createElement("span",null,t?i.a.createElement(l.EuiToolTip,{"data-test-subj":"message-tooltip",content:"message"},i.a.createElement(i.a.Fragment,null,e.substring(0,a))):i.a.createElement(i.a.Fragment,null,e.substring(0,a)),e.length>a&&i.a.createElement(l.EuiToolTip,{content:e},i.a.createElement(m.f,{type:"boxesHorizontal"})));h.displayName="OverflowFieldComponent";const j=i.a.memo(h);j.displayName="OverflowField"},577:function(e,t,a){"use strict";a.d(t,"b",(function(){return m})),a.d(t,"a",(function(){return b}));var n=a(2),i=a(731),r=a(385),l=a(4);const s=e=>e.groups.some((e=>l.Nb.includes(e)));var o=a(117),u=a(1062),c=a(1137),d=a(210);const m=()=>{const{addError:e}=Object(o.a)(),t=Object(d.a)(),a=Object(r.a)(t),n=Object(i.a)(t),{isFetching:l,data:m=[]}=Object(c.a)({},{enabled:a&&n,onError:t=>{e(t,{title:u.a})}});return{isLicensed:n,isMlUser:a,jobs:m.filter(s),loading:l}},b=()=>{const{jobs:e,loading:t}=m();return{jobNameById:Object(n.useMemo)((()=>e.reduce(((e,t)=>{var a;return e[t.id]=null===(a=t.customSettings)||void 0===a?void 0:a.security_app_display_name,e}),{})),[e]),loading:t}}},600:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(2),i=a.n(n),r=a(140),l=a(127),s=a(211),o=a(321),u=a(275);const c=({field:e,value:t,isObjectArray:a,children:c})=>{const{dataFormattedForFieldBrowser:d,scopeId:m,isPreview:b}=Object(r.b)(),{isAlert:g}=Object(s.b)(d),f=g?u.d.DETAILS_FLYOUT:u.d.DEFAULT,p=Object(n.useMemo)((()=>({field:e,value:t})),[e,t]),y=Object(n.useMemo)((()=>({scopeId:m,isObjectArray:a})),[m,a]),v=Object(n.useMemo)((()=>b?[o.d.FILTER,o.d.TOGGLE_COLUMN]:[]),[b]);return i.a.createElement(u.c,{data:p,mode:u.a.HOVER_RIGHT,triggerId:f,visibleCellActions:6,sourcererScopeId:Object(l.getSourcererScopeId)(m),metadata:y,disabledActionTypes:v},c)};c.displayName="CellActions"},620:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(2),i=a(110);const r=()=>{const{spaces:e}=Object(i.i)().services,[t,a]=Object(n.useState)();return Object(n.useEffect)((()=>{e&&e.getActiveSpace().then((e=>a(e.id)))}),[e]),t}},668:function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return r}));const n={critical:"#E7664C",high:"#DA8B45",medium:"#D6BF57",low:"#54B399"},i=4,r=(e=0)=>Math.ceil(Math.min(e||0,100)/i)},693:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return c}));var n=a(2);const i=a(5).i18n.translate("xpack.securitySolution.userDetails.failSearchDescription",{defaultMessage:"Failed to run search on user details"});var r=a(545),l=a(423),s=a(279),o=a(130);const u="observedUsersDetailsQuery",c=({endDate:e,userName:t,indexNames:a,id:c=u,skip:d=!1,startDate:m})=>{const b=Object(o.a)("newUserDetailsFlyout"),{loading:g,result:f,search:p,refetch:y,inspect:v}=Object(s.a)({factoryQueryType:r.c.observedDetails,initialResult:{userDetails:{}},errorMessage:i,abort:d}),E=Object(n.useMemo)((()=>({endDate:e,userDetails:f.userDetails,id:c,inspect:v,refetch:y,startDate:m})),[e,c,v,y,f.userDetails,m]),h=Object(n.useMemo)((()=>({defaultIndex:a,factoryQueryType:r.c.observedDetails,userName:t,timerange:{interval:"12h",from:m,to:e},filterQuery:b?l.a:void 0})),[e,a,m,t,b]);return Object(n.useEffect)((()=>{d||p(h)}),[h,p,d]),[g,E]}},732:function(e,t,a){"use strict";a.d(t,"g",(function(){return o})),a.d(t,"c",(function(){return u})),a.d(t,"d",(function(){return c})),a.d(t,"a",(function(){return d})),a.d(t,"f",(function(){return b})),a.d(t,"b",(function(){return g})),a.d(t,"e",(function(){return p}));var n=a(45),i=a(66),r=a(215),l=a(285),s=a(566);const o={box:{incremental:!0,placeholder:r.w,schema:!0,"data-test-subj":"search-input"}},u=e=>Object(n.isEmpty)(e)?"":`Example: ${e}`,c=e=>{switch(e){case"string":case"keyword":return"string";case"number":case"long":case"float":return"number";case"date":return"clock";case"ip":case"geo_point":return"globe";default:return"questionInCircle"}},d="event-fields-table",m=e=>Object(i.elementOrChildrenHasFocus)(null==e?void 0:e.querySelector(`.${d}`)),b=({containerElement:e,keyboardEvent:t,onSkipFocusBeforeEventsTable:a,onSkipFocusAfterEventsTable:n})=>{const{shiftKey:r}=t,l=Object(i.getTableSkipFocus)({containerElement:e,getFocusedCell:i.getFocusedDataColindexCell,shiftKey:r,tableHasFocus:m,tableClassName:d});"SKIP_FOCUS_NOOP"!==l&&(Object(i.stopPropagationAndPreventDefault)(t),Object(i.handleSkipFocus)({onSkipFocusBackwards:a,onSkipFocusForward:n,skipFocus:l}))};function g({browserFields:e,contextId:t,eventId:a,field:i,item:r,linkValueField:l,scopeId:s}){var o,u,c,d;const m={contextId:t,eventId:a,fieldType:"string",linkValue:void 0,scopeId:s},b=Object(n.getOr)(null,"originalValue.0",l),g=null!==(o=r.category)&&void 0!==o?o:"",f=null!==(u=r.field)&&void 0!==u?u:"",p=Object(n.get)([g,"fields",f],e),y=null==i?void 0:i.overrideField;return{...m,data:{field:null!=y?y:f,format:null!==(c=null==p?void 0:p.format)&&void 0!==c?c:"",type:null!==(d=null==p?void 0:p.type)&&void 0!==d?d:"",isObjectArray:r.isObjectArray},values:r.values,linkValue:null!=b?b:void 0,fieldFromBrowserField:p}}const f={[l.a]:!0,[l.j]:!0,[s.a]:!0};function p(e){return!f[e]}},765:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return l}));var n=a(280),i=a(169);const r=e=>Object(n.flow)(o)(e),l=e=>s(e),s=e=>{if("threat_match"===e.type&&null!=e.threat_mapping){const t=e.threat_mapping.map((e=>{const t=e.entries.map((e=>Object(i.d)(e)));return Object(i.d)({entries:t})}));return{...e,threat_mapping:t}}return e},o=e=>{if("threat_match"===e.type&&null!=e.threat_mapping){const t=e.threat_mapping.map((e=>{const t=e.entries.map((e=>Object(i.j)(e)));return{...Object(i.j)(e),entries:t}}));return{...e,threat_mapping:t}}return e}},878:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r}));const n="destination.port",i="source.port",r=["client.port",n,"server.port",i,"url.port"]},901:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(28),i=a(620),r=a(211),l=a(202),s=a(116),o=a(121),u=a(1135),c=a(1359);const d=({eventId:e,indexName:t})=>{var a;const d=Object(i.a)(),m=t?null!==(a=Object(r.a)(t,d))&&void 0!==a?a:t:"",[{pageName:b}]=Object(l.a)(),g=b===n.c.detections?s.SourcererScopeName.detections:s.SourcererScopeName.default,f=Object(o.d)(g),[p,y,v,E,h]=Object(u.a)({indexName:m,eventId:null!=e?e:"",runtimeMappings:f.runtimeMappings,skip:!e}),j=Object(c.a)(null==v?void 0:v.fields);return{browserFields:f.browserFields,dataAsNestedObject:E,dataFormattedForFieldBrowser:y,getFieldsData:j,indexPattern:f.indexPattern,loading:p,refetchFlyoutData:h,searchHit:v}}},925:function(e,t,a){"use strict";a.d(t,"u",(function(){return l})),a.d(t,"t",(function(){return s})),a.d(t,"n",(function(){return o})),a.d(t,"x",(function(){return u})),a.d(t,"y",(function(){return c})),a.d(t,"p",(function(){return d})),a.d(t,"r",(function(){return m})),a.d(t,"b",(function(){return b})),a.d(t,"o",(function(){return g})),a.d(t,"q",(function(){return f})),a.d(t,"a",(function(){return p})),a.d(t,"l",(function(){return y})),a.d(t,"m",(function(){return v})),a.d(t,"j",(function(){return E})),a.d(t,"k",(function(){return h})),a.d(t,"A",(function(){return j})),a.d(t,"z",(function(){return O})),a.d(t,"i",(function(){return k})),a.d(t,"h",(function(){return x})),a.d(t,"g",(function(){return S})),a.d(t,"d",(function(){return I})),a.d(t,"e",(function(){return T})),a.d(t,"f",(function(){return M})),a.d(t,"w",(function(){return F})),a.d(t,"v",(function(){return A})),a.d(t,"c",(function(){return w})),a.d(t,"s",(function(){return C}));var n=a(5),i=a(124);const r=(e,t)=>{switch(e){case i.d.alert:return n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entityAlerts",{values:{count:t},defaultMessage:"{count, plural, =1 {alert} other {alerts}}"});case i.d.event:return n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entityEvents",{values:{count:t},defaultMessage:"{count, plural, =1 {event} other {events}}"});case i.d.session:return n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.entitySessions",{values:{count:t},defaultMessage:"{count, plural, =1 {session} other {sessions}}"})}},l=(e,t,a)=>n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.selectAllEntitiesTitle",{values:{entityPlural:r(e,a),totalFormatted:t,total:a},defaultMessage:"Select {total, plural, =1 {} other {all}} {totalFormatted} {entityPlural}"}),s=(e,t,a)=>n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.selectedEntitiesTitle",{values:{entityPlural:r(e,a),totalFormatted:t},defaultMessage:"Selected {totalFormatted} {entityPlural}"}),o=n.i18n.translate("xpack.securitySolution.toolbar.bulkActions.clearSelectionTitle",{defaultMessage:"Clear selection"}),u=e=>n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailed",{values:{conflicts:e},defaultMessage:"Failed to update { conflicts } {conflicts, plural, =1 {alert} other {alerts}}."}),c=(e,t)=>n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailedDetailed",{values:{updated:e,conflicts:t},defaultMessage:"{ updated } {updated, plural, =1 {alert was} other {alerts were}} updated successfully, but { conflicts } failed to update\n         because { conflicts, plural, =1 {it was} other {they were}} already being modified."}),d=e=>n.i18n.translate("xpack.securitySolution.bulkActions.closedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully closed {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),m=e=>n.i18n.translate("xpack.securitySolution.bulkActions.openedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully opened {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),b=e=>n.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully marked {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}} as acknowledged."}),g=n.i18n.translate("xpack.securitySolution.bulkActions.closedAlertFailedToastMessage",{defaultMessage:"Failed to close alert(s)."}),f=n.i18n.translate("xpack.securitySolution.bulkActions.openedAlertFailedToastMessage",{defaultMessage:"Failed to open alert(s)"}),p=n.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedAlertFailedToastMessage",{defaultMessage:"Failed to mark alert(s) as acknowledged"}),y=n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertStatusFailedSingleAlert",{defaultMessage:"Failed to update alert because it was already being modified."}),v=n.i18n.translate("xpack.securitySolution.bulkActions.openSelectedTitle",{defaultMessage:"Mark as open"}),E=n.i18n.translate("xpack.securitySolution.bulkActions.acknowledgedSelectedTitle",{defaultMessage:"Mark as acknowledged"}),h=n.i18n.translate("xpack.securitySolution.bulkActions.closeSelectedTitle",{defaultMessage:"Mark as closed"}),j=e=>n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertTagsSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully updated tags for {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),O=n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertTagsFailedToastMessage",{defaultMessage:"Failed to update alert tags."}),k=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuSearchPlaceholderMessage",{defaultMessage:"Search tags"}),x=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuSearchNoTagsFoundMessage",{defaultMessage:"No tags match current search"}),S=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsMenuEmptyMessage",{defaultMessage:"No alert tag options exist, add tag options in Kibana Advanced Settings."}),I=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsApplyButtonMessage",{defaultMessage:"Apply tags"}),T=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsContextMenuItemTitle",{defaultMessage:"Apply alert tags"}),M=n.i18n.translate("xpack.securitySolution.bulkActions.alertTagsContextMenuItemTooltip",{defaultMessage:"Change alert tag options in Kibana Advanced Settings."}),F=e=>n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertAssigneesSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully updated assignees for {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),A=n.i18n.translate("xpack.securitySolution.bulkActions.updateAlertAssigneesFailedToastMessage",{defaultMessage:"Failed to update alert assignees."}),w=n.i18n.translate("xpack.securitySolution.bulkActions.alertAssigneesContextMenuItemTitle",{defaultMessage:"Assign alert"}),C=n.i18n.translate("xpack.securitySolution.bulkActions.removeAlertAssignessContextMenuTitle",{defaultMessage:"Unassign alert"})},927:function(e,t,a){"use strict";a.d(t,"d",(function(){return l})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return u}));var n=a(2),i=a.n(n),r=a(1080);const l="source.ip",s="destination.ip",o="ip",u=i.a.memo((({contextId:e,eventId:t,fieldName:a,isDraggable:n,value:l})=>i.a.createElement(r.a,{contextId:e,"data-test-subj":"formatted-ip",eventId:t,fieldName:a,isDraggable:n,fieldType:o,value:l,truncate:!0})));u.displayName="Ip"},928:function(e,t,a){"use strict";a.d(t,"a",(function(){return x})),a.d(t,"b",(function(){return S})),a.d(t,"c",(function(){return M}));var n=a(17),i=a(45),r=a(2),l=a.n(r),s=a(44),o=a.n(s),u=a(166),c=a(126),d=a(237),m=a(439),b=a(226),g=a(1614),f=a.n(g),p=a(1110),y=a(129),v=a(164),E=a(110),h=a(4),j=a(137),O=a(284);const k=o()(n.EuiFlexItem).withConfig({displayName:"EventModuleFlexItem",componentId:"sc-14g85rc-0"})(["width:100%;"]),x=({children:e,Component:t,contextId:a,eventId:n,fieldName:s,fieldType:o,isAggregatable:b,isDraggable:g,isButton:f,onClick:p,linkValue:k,openInNewTab:x=!1,truncate:S,title:I,value:T})=>{const M=`${T}`,F=k,{search:A}=Object(v.l)(y.a.rules),{navigateToApp:w,getUrlForApp:C}=Object(E.i)().services.application,D=Object(r.useCallback)((e=>{e.preventDefault(),w(h.l,{deepLinkId:y.a.rules,path:Object(d.d)(null!=F?F:"",A),openInNewTab:x})}),[w,F,A,x]),N=Object(r.useMemo)((()=>C(h.l,{deepLinkId:y.a.rules,path:Object(d.d)(null!=F?F:"",A)})),[C,F,A]),_=`event-details-value-default-draggable-${a}-${n}-${s}-${T}-${F}`,$=Object(r.useMemo)((()=>{const a=S?l.a.createElement(m.b,{dataTestSubj:`formatted-field-${s}`},T):T;return f?l.a.createElement(O.b,{Component:t,dataTestSubj:"data-grid-host-details",href:N,iconType:"expand",onClick:null!=p?p:D,title:null!=I?I:M},e):t?l.a.createElement(t,{"aria-label":I,"data-test-subj":`view-${s}`,iconType:"link",onClick:D,title:I},null!=I?I:T):x?l.a.createElement(j.f,{onClick:D,href:N,"data-test-subj":"goToRuleDetails",target:"_blank",external:!1},null!=e?e:a):l.a.createElement(j.f,{onClick:D,href:N,"data-test-subj":"ruleName"},null!=e?e:a)}),[t,e,s,D,N,f,p,M,I,S,T,x]);return Object(i.isString)(T)&&M.length>0&&null!=F?g?l.a.createElement(u.b,{field:s,fieldType:o,isAggregatable:b,id:_,isDraggable:g,tooltipContent:T,value:T},$):$:null!=T?g?l.a.createElement(u.b,{field:s,fieldType:o,isAggregatable:b,id:_,isDraggable:g,tooltipContent:T,value:`${T}`},T):l.a.createElement(l.a.Fragment,null,T):Object(c.d)()},S=({contextId:e,eventId:t,fieldName:a,fieldType:r,isAggregatable:s,isDraggable:o,linkValue:d,truncate:g,value:y})=>{const v=`${y}`,E=d,h=g?l.a.createElement(m.b,null,y):y;return Object(i.isString)(y)&&v.length>0?l.a.createElement(n.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:null==E||Object(i.isEmpty)(E)?"spaceBetween":"flexStart"},l.a.createElement(k,null,o?l.a.createElement(u.b,{field:a,id:`event-details-value-default-draggable-${e}-${t}-${a}-${y}-${v}`,fieldType:r,isAggregatable:s,isDraggable:o,tooltipContent:y,value:y},h):l.a.createElement(l.a.Fragment,null,h)),null!=E&&((e,t)=>"endgame"===e.trim().toLocaleLowerCase()&&null!=t&&!Object(i.isEmpty)(t)&&!Object(b.c)(t)&&t.includes("/alerts/"))(v,E)&&l.a.createElement(n.EuiFlexItem,{grow:!1},l.a.createElement(n.EuiToolTip,{"data-test-subj":"event-module-link-to-elastic-endpoint-security",content:l.a.createElement(l.a.Fragment,null,l.a.createElement("p",null,p.f),l.a.createElement("p",null,E))},l.a.createElement(n.EuiLink,{href:E,target:"_blank"},l.a.createElement(n.EuiIcon,{type:f.a,size:"m"}))))):Object(c.d)()},I=({children:e,Component:t,dataTestSubj:a,href:i,onClick:r,title:s,iconType:o="link"})=>t?l.a.createElement(t,{"data-test-subj":a,href:i,iconType:o,onClick:r,title:s},null!=s?s:e):l.a.createElement(n.EuiLink,{"data-test-subj":a,target:"_blank",href:i},null!=s?s:e),T=l.a.memo(I),M=({contextId:e,Component:t,eventId:a,fieldName:n,fieldType:r,isAggregatable:s,isDraggable:o,truncate:d,title:g,value:f})=>{const p=`${f}`,y=!Object(b.c)(p),v=d?l.a.createElement(m.b,null,f):f,E=y?l.a.createElement(T,{Component:t,href:p,dataTestSubj:"ata-grid-url",title:g,iconType:"link"}):l.a.createElement(l.a.Fragment,null,v);return Object(i.isString)(f)&&p.length>0?o?l.a.createElement(u.b,{field:n,fieldType:r,isAggregatable:s,id:`event-details-value-default-draggable-${e}-${a}-${n}-${f}-${p}`,isDraggable:o,tooltipContent:f,value:f},E):E:Object(c.d)()}},972:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(45);const i=({category:e,field:t},a)=>{const i=(({category:e,field:t},a)=>{var i,r,l;const s="signal"===e?"kibana":"kibana"===e?"signal":e,o="signal"===e?t.replace("signal","kibana.alert").replace("rule.id","rule.uuid"):"kibana"===e?t.replace("kibana.alert","signal").replace("rule.uuid","rule.id"):t;return null!==(i=null===(r=Object(n.find)({category:e,field:t},a))||void 0===r?void 0:r.values)&&void 0!==i?i:null===(l=Object(n.find)({category:s,field:o},a))||void 0===l?void 0:l.values})({category:e,field:t},a);return i&&i.length>0?i[0]:""}}}]);