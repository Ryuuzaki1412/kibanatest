/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[44],{1084:function(e,t,a){"use strict";a.d(t,"a",(function(){return v}));var i=a(2),r=a.n(i),l=a(17),n=a(44),o=a.n(n),d=a(5);const s=d.i18n.translate("xpack.securitySolution.andOrBadge.and",{defaultMessage:"AND"}),c=d.i18n.translate("xpack.securitySolution.andOrBadge.or",{defaultMessage:"OR"}),u=o()(l.EuiBadge).withConfig({displayName:"RoundBadge",componentId:"sc-15mz0pi-0"})(["align-items:center;border-radius:100%;display:inline-flex;font-size:9px;height:34px;justify-content:center;margin:0 5px 0 5px;padding:7px 6px 4px 6px;user-select:none;width:40px;height:40px;.euiBadge__content{position:relative;top:-1px;}.euiBadge__text{text-overflow:clip;}"]);u.displayName="RoundBadge";const m=({type:e})=>r.a.createElement(u,{"data-test-subj":"and-or-badge",color:"hollow"},"and"===e?s:c);m.displayName="RoundedBadge";const p=Object(n.css)(["background:",";position:relative;width:2px;&:after{background:",";content:'';height:8px;right:-4px;position:absolute;width:10px;clip-path:circle();}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiColorLightShade)),g=o()(l.EuiFlexItem).withConfig({displayName:"TopAntenna",componentId:"sc-1s6c9rb-0"})([""," &:after{top:0;}"],p),b=o()(l.EuiFlexItem).withConfig({displayName:"BottomAntenna",componentId:"sc-1s6c9rb-1"})([""," &:after{bottom:0;}"],p),y=({type:e})=>r.a.createElement(l.EuiFlexGroup,{className:"andBadgeContainer",gutterSize:"none",direction:"column",alignItems:"center"},r.a.createElement(g,{"data-test-subj":"andOrBadgeBarTop",grow:1}),r.a.createElement(l.EuiFlexItem,{grow:!1},r.a.createElement(m,{type:e})),r.a.createElement(b,{"data-test-subj":"andOrBadgeBarBottom",grow:1}));y.displayName="RoundedBadgeAntenna";const v=r.a.memo((({type:e,includeAntennas:t=!1})=>t?r.a.createElement(y,{type:e}):r.a.createElement(m,{type:e})));v.displayName="AndOrBadge"},1724:function(e,t,a){"use strict";a.r(t),a.d(t,"QueryTabContentComponent",(function(){return Ot})),a.d(t,"default",(function(){return wt}));var i=a(17),r=a(45),l=a(2),n=a.n(l),o=a(44),d=a.n(o),s=a(48),c=a(136),u=a.n(c),m=a(395),p=a(19),g=a(54),b=a(119),y=a(319),v=a(118),h=a(559),f=a(110),E=a(196),x=a(1418),I=a(1443),O=a(114),w=a(517),j=a.n(w),S=a(55),P=a(113),C=a(112),k=a(134),F=a(5);const M=F.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),q=F.i18n.translate("xpack.securitySolution.timeline.callOut.immutable.message.description",{defaultMessage:"This prebuilt timeline template cannot be modified. To make changes, please duplicate this template and make modifications to the duplicate template."});var T=a(79),N=a(117),D=a(116),z=a(121),B=a(128),Q=a(360),$=a(712),R=a(1555),V=a(1321);const K=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterDescription",{defaultMessage:"Events from the data providers above are filtered by the adjacent KQL"}),L=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlTooltip",{defaultMessage:"Events from the data providers above are filtered by this KQL"}),A=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlPlaceholder",{defaultMessage:"Filter events"}),_=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterKqlSelectedText",{defaultMessage:"Filter"}),G=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchDescription",{defaultMessage:"Events from the data providers above are combined with results from the adjacent KQL"}),H=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlTooltip",{defaultMessage:"Events from the data providers above are combined with results from this KQL"}),U=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlPlaceholder",{defaultMessage:"Search events"}),W=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.searchKqlSelectedText",{defaultMessage:"Search"}),Y=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.dataProviderToggle.hiddenAndPopulated",{defaultMessage:"Click to access the query in the query builder"}),J=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.dataProviderToggle.visible",{defaultMessage:"Click to collapse the query builder"}),X=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.dataProviderToggle.hiddenAndEmpty",{defaultMessage:"Click to expand the empty query builder"}),Z=F.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.errorProcessingDataView",{defaultMessage:"Error processing Index Patterns"});var ee=a(292);const te=d.a.div.withConfig({displayName:"SearchOrFilterContainer",componentId:"sc-1xwjodn-0"})(["overflow-x:auto;overflow-y:hidden;"]);te.displayName="SearchOrFilterContainer",d()(i.EuiFlexItem).withConfig({displayName:"ModeFlexItem",componentId:"sc-1xwjodn-1"})(["user-select:none;"]).displayName="ModeFlexItem";const ae=n.a.memo((({dataProviders:e,isRefreshPaused:t,filters:a,filterManager:r,filterQuery:o,from:d,fromStr:s,kqlMode:c,timelineId:u,refreshInterval:m,savedQueryId:p,setFilters:g,setSavedQueryId:y,to:v,toStr:h,updateReduxTime:f,isDataProviderVisible:E,toggleDataProviderVisibility:x,timelineType:I})=>{const O=Object(l.useMemo)((()=>0===(null==e?void 0:e.length)),[e]),w=Object(l.useMemo)((()=>E?J:O?X:Y),[O,E]),j=Object(l.useMemo)((()=>O||E?"primary":"warning"),[O,E]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(te,null,n.a.createElement(i.EuiFlexGroup,{"data-test-subj":"timeline-search-or-filter",gutterSize:"xs",alignItems:"flexStart",responsive:!1},n.a.createElement(i.EuiFlexItem,{grow:!1,id:ee.a.DATA_VIEW},n.a.createElement(V.a,{scope:D.SourcererScopeName.timeline})),n.a.createElement(i.EuiFlexItem,{"data-test-subj":"timeline-search-or-filter-search-container",grow:1},n.a.createElement($.a,{dataProviders:e,filters:a,filterManager:r,filterQuery:o,from:d,fromStr:s,kqlMode:c,isRefreshPaused:t,refreshInterval:m,savedQueryId:p,setFilters:g,setSavedQueryId:y,timelineId:u,to:v,toStr:h,updateReduxTime:f})),I===P.l.default?n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(i.EuiToolTip,{content:w},n.a.createElement(i.EuiButtonIcon,{id:ee.a.DATA_PROVIDER,color:j,isSelected:E,iconType:"timeline","data-test-subj":"toggle-data-provider",size:"m",display:"base","aria-label":w,onClick:x}))):null,n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(R.a,null)),n.a.createElement(i.EuiFlexItem,{grow:!1,"data-test-subj":"timeline-date-picker-container"},n.a.createElement(Q.a,{width:"auto",id:b.a.timeline,timelineId:u,disabled:!1})))))}));ae.displayName="SearchOrFilter";var ie=a(14);const re=d()(i.EuiFlexGroup).withConfig({displayName:"FilterItemsContainer",componentId:"sc-1jxfrk1-0"})([""]),le=n.a.memo((({dataProviders:e,filters:t,filterManager:a,filterQuery:r,from:o,fromStr:d,isRefreshPaused:c,kqlMode:u,refreshInterval:m,savedQueryId:p,setFilters:g,setSavedQueryId:b,timelineId:y,to:h,toStr:E,updateKqlMode:x,updateReduxTime:I,timelineType:O})=>{const w=Object(s.useDispatch)(),{addError:j}=Object(N.a)(),[S,P]=Object(l.useState)(),{services:{data:k}}=Object(f.i)(),{indexPattern:F}=Object(z.d)(D.SourcererScopeName.timeline),M=Object(l.useMemo)((()=>v.b.dataProviderVisibilitySelector()),[]),q=Object(C.a)((e=>M(e,y)));Object(l.useEffect)((()=>{let e;var t;return null!=(t=F)&&"object"==typeof t&&Object.hasOwn(t,"getName")?P(F):r||(async()=>{try{e=await k.dataViews.create({title:F.title}),P(e)}catch(e){j(e,{title:Z})}})(),()=>{var t,a;null!==(t=e)&&void 0!==t&&t.id&&k.dataViews.clearInstanceCache(null===(a=e)||void 0===a?void 0:a.id)}}),[k.dataViews,F,r,j]);const B=Object(l.useMemo)((()=>null!=S?[S]:[]),[S]),Q=Object(l.useCallback)((e=>{a.setFilters(e)}),[a]),$=Object(l.useCallback)((e=>g({id:y,filters:e})),[y,g]),R=Object(l.useCallback)((e=>b({id:y,savedQueryId:e})),[y,b]),V=Object(l.useCallback)((()=>{w(Object(ie.setDataProviderVisibility)({id:y,isDataProviderVisible:!q}))}),[q,y,w]);return Object(l.useEffect)((()=>{(null==e?void 0:e.length)>0?w(Object(ie.setDataProviderVisibility)({id:y,isDataProviderVisible:!0})):0===(null==e?void 0:e.length)&&w(Object(ie.setDataProviderVisibility)({id:y,isDataProviderVisible:!1}))}),[e,w,y]),n.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"s"},n.a.createElement(i.EuiFlexItem,null,n.a.createElement(i.EuiFlexGroup,{className:"eui-scrollBar",direction:"row",alignItems:"center",gutterSize:"xs",responsive:!1},n.a.createElement(i.EuiFlexItem,{grow:!0},n.a.createElement(ae,{dataProviders:e,filters:t,filterManager:a,filterQuery:r,from:o,fromStr:d,isRefreshPaused:c,kqlMode:u,refreshInterval:m,savedQueryId:p,setFilters:$,setSavedQueryId:R,timelineId:y,to:h,toStr:E,updateKqlMode:x,updateReduxTime:I,toggleDataProviderVisibility:V,isDataProviderVisible:q,timelineType:O})))),t&&t.length>0?n.a.createElement(i.EuiFlexItem,null,n.a.createElement(re,{"data-test-subj":"timeline-filters-container",direction:"row",gutterSize:"xs",wrap:!0,responsive:!1},n.a.createElement(T.FilterItems,{filters:t,onFiltersUpdated:Q,indexPatterns:B}))):null)}),((e,t)=>e.filterManager===t.filterManager&&e.from===t.from&&e.fromStr===t.fromStr&&e.to===t.to&&e.toStr===t.toStr&&e.isRefreshPaused===t.isRefreshPaused&&e.refreshInterval===t.refreshInterval&&e.timelineId===t.timelineId&&u()(e.dataProviders,t.dataProviders)&&u()(e.filters,t.filters)&&u()(e.filterQuery,t.filterQuery)&&u()(e.kqlMode,t.kqlMode)&&u()(e.savedQueryId,t.savedQueryId)&&u()(e.timelineId,t.timelineId)&&e.timelineType===t.timelineType));le.displayName="StatefulSearchOrFilterComponent";const ne=Object(s.connect)((()=>{const e=v.b.getTimelineByIdSelector(),t=v.b.getKqlFilterKuerySelector(),a=B.d.getTimelineSelector(),i=B.d.getTimelinePolicySelector();return(l,{timelineId:n})=>{var o;const d=null!==(o=e(l,n))&&void 0!==o?o:k.b,s=a(l),c=i(l);return{dataProviders:d.dataProviders,filterQuery:t(l,n),filters:d.filters,from:s.timerange.from,fromStr:s.timerange.fromStr,isRefreshPaused:"manual"===c.kind,kqlMode:Object(r.getOr)("filter","kqlMode",d),refreshInterval:c.duration,savedQueryId:Object(r.getOr)(null,"savedQueryId",d),to:s.timerange.to,toStr:s.timerange.toStr,timelineType:d.timelineType}}}),(e=>({updateKqlMode:({id:t,kqlMode:a})=>e(v.a.updateKqlMode({id:t,kqlMode:a})),setSavedQueryId:({id:t,savedQueryId:a})=>e(v.a.setSavedQueryId({id:t,savedQueryId:a})),setFilters:({id:t,filters:a})=>e(v.a.setFilters({id:t,filters:a})),updateReduxTime:Object(Q.b)(e)})))(le);var oe=a(345),de=a(51),se=a(23),ce=a.n(se),ue=a(82);const me=d.a.div.withConfig({displayName:"ReactDndDropTarget",componentId:"sc-160stu-0"})(["transition:background-color 0.7s ease;width:100%;height:",";.flyout-overlay{.euiPanel{background-color:",";}}"," > div.timeline-drop-area{.drop-and-provider-timeline{display:none;}& + div{display:none !important;}}"],(({height:e})=>e),(e=>e.theme.eui.euiFormBackgroundColor),(e=>e.isDraggingOver?`\n    .drop-and-provider-timeline {\n      &:hover {\n        background-color: ${Object(oe.rgba)(e.theme.eui.euiColorSuccess,.3)};\n      }\n    }\n    .drop-and-provider-timeline:hover {\n        background-color: ${Object(oe.rgba)(e.theme.eui.euiColorSuccess,.3)};\n    }\n  > div.timeline-drop-area-empty {\n     color: ${e.theme.eui.euiColorSuccess};\n     background-color: ${Object(oe.rgba)(e.theme.eui.euiColorSuccess,.2)};\n\n     & .timeline-drop-area-empty__text {\n      color: ${e.theme.eui.euiColorSuccess};\n     }\n  }\n  > div.timeline-drop-area {\n    background-color: ${Object(oe.rgba)(e.theme.eui.euiColorSuccess,.2)};\n    .provider-item-filter-container div:first-child{\n      /* Override dragNdrop beautiful so we do not have our droppable moving around for no good reason */\n      transform: none !important;\n    }\n    .drop-and-provider-timeline {\n      display: block !important;\n      + div {\n        display: none;\n      }\n    }\n\n    & .euiFormHelpText {\n      color: ${e.theme.eui.euiColorSuccess};\n    }\n  }\n  .flyout-overlay {\n    .euiPanel {\n      background-color: ${e.theme.eui.euiColorLightShade};\n    }\n    + div {\n      /* Override dragNdrop beautiful so we do not have our droppable moving around for no good reason */\n      display: none !important;\n    }\n  }\n  `:""));me.displayName="ReactDndDropTarget";const pe=n.a.memo((({children:e=null,droppableId:t,height:a="100%",isDropDisabled:i=!1,type:r,render:o=null,renderClone:d})=>{const s=Object(l.useCallback)(((t,i)=>n.a.createElement(me,ce()({height:a,ref:t.innerRef},t.droppableProps,{isDraggingOver:i.isDraggingOver}),null==o?e:o({isDraggingOver:i.isDraggingOver}),t.placeholder)),[e,a,o]);return n.a.createElement(ue.Droppable,{isDropDisabled:i,droppableId:t,direction:"horizontal",type:r,renderClone:d},s)}));pe.displayName="DroppableWrapper";var ge=a(174),be=a(1084),ye=a(748),ve=a(424),he=a(153),fe=a(401);const Ee=d.a.div.withConfig({displayName:"AddFieldPopoverContainer",componentId:"sc-1r7cchu-0"})(["min-width:350px;"]),xe=({browserFields:e,timelineId:t})=>{const a=Object(s.useDispatch)(),[o,d]=Object(l.useState)(!1),c=Object(l.useMemo)((()=>v.b.getTimelineByIdSelector()),[]),{dataProviders:u,timelineType:m}=Object(C.a)((e=>Object(r.pick)(["dataProviders","timelineType"],c(e,t)))),p=Object(l.useCallback)((()=>d(!o)),[d,o]),g=Object(l.useCallback)((()=>d(!1)),[d]),b=Object(l.useCallback)((({andProviderId:e,excluded:i,field:r,id:l,operator:n,providerId:o,value:d,type:s})=>{Object(ve.b)({dataProviders:u,destination:{droppableId:`droppableId.timelineProviders.${t}.group.${u.length}`,index:0},dispatch:a,onAddedToTimeline:g,providerToAdd:{id:o,name:r,enabled:!0,excluded:i,kqlQuery:"",type:s,queryMatch:{displayField:void 0,displayValue:Object(ve.d)(d),field:r,value:d,operator:n},and:[]},timelineId:t})}),[u,t,a,g]),y=Object(l.useMemo)((()=>[{id:0,width:400,items:[{name:fe.a,icon:n.a.createElement(i.EuiIcon,{type:"plusInCircle",size:"m"}),panel:1},m===P.l.template?{disabled:m!==P.l.template,name:fe.b,icon:n.a.createElement(i.EuiIcon,{type:"visText",size:"m"}),panel:2}:null].filter((e=>null!==e))},{id:1,title:fe.a,width:400,content:n.a.createElement(ye.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:b,operator:":",timelineId:t,value:"",type:he.a.default,providerId:`${t}-${Object(de.v4)()}`})},{id:2,title:fe.b,width:400,content:n.a.createElement(ye.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:b,operator:":",timelineId:t,value:"",type:he.a.template,providerId:`${t}-${Object(de.v4)()}`})}]),[e,b,t,m]),h=Object(l.useMemo)((()=>m===P.l.template?n.a.createElement(i.EuiButton,{size:"s",onClick:p,"data-test-subj":"addField",iconType:"arrowDown",fill:!0,iconSide:"right"},n.a.createElement(i.EuiText,{size:"s"},fe.a)):n.a.createElement(i.EuiButtonEmpty,{size:"s",onClick:p,"data-test-subj":"addField",iconSide:"right"},n.a.createElement(i.EuiText,{size:"s"},`+ ${fe.a}`))),[p,m]),f=Object(l.useMemo)((()=>m===P.l.template?n.a.createElement(i.EuiContextMenu,{initialPanelId:0,panels:y}):n.a.createElement(ye.a,{browserFields:e,field:"",isExcluded:!1,onDataProviderEdited:b,operator:":",timelineId:t,value:"",type:he.a.default,providerId:`${t}-${Object(de.v4)()}`})),[e,b,y,t,m]);return n.a.createElement(i.EuiPopover,{id:"addFieldsPopover",button:h,isOpen:o,closePopover:g,anchorPosition:"downLeft",panelPaddingSize:"none",repositionOnScroll:!0},n.a.createElement(Ee,null,f))};xe.displayName="AddDataProviderPopoverComponent";const Ie=n.a.memo(xe);Ie.displayName="AddDataProviderPopover";const Oe=d()(i.EuiText).withConfig({displayName:"Text",componentId:"sc-1o1enwl-0"})(["overflow:hidden;margin:5px 0 5px 0;padding:3px;white-space:nowrap;"]);Oe.displayName="Text";const we=d()(i.EuiBadge).withConfig({displayName:"BadgeHighlighted",componentId:"sc-1o1enwl-1"})(["height:20px;margin:0 5px 0 5px;maxwidth:85px;minwidth:85px;"]);we.displayName="BadgeHighlighted";const je=d.a.span.withConfig({displayName:"HighlightedBackground",componentId:"sc-1o1enwl-2"})(["background-color:",";"],(e=>e.theme.eui.euiColorLightShade));je.displayName="HighlightedBackground";const Se=d.a.div.withConfig({displayName:"EmptyContainer",componentId:"sc-1o1enwl-3"})(["width:",";align-items:center;display:flex;flex-direction:column;flex-wrap:wrap;justify-content:center;user-select:none;align-content:center;",""],(e=>e.showSmallMsg?"60px":"auto"),(e=>e.showSmallMsg?`\n      border-right: 1px solid ${e.theme.eui.euiColorMediumShade};\n      margin-right: 10px;\n    `:"\n  min-height: 100px;\n  + div {\n    display: none !important;\n   }\n  "));Se.displayName="EmptyContainer";const Pe=d.a.div.withConfig({displayName:"NoWrap",componentId:"sc-1o1enwl-4"})(["align-items:center;display:flex;flex-direction:row;flex-wrap:no-wrap;"]);Pe.displayName="NoWrap";const Ce=n.a.memo((({showSmallMsg:e=!1,browserFields:t,timelineId:a})=>n.a.createElement(Se,{className:"timeline-drop-area-empty","data-test-subj":"empty",showSmallMsg:e},!e&&n.a.createElement(n.a.Fragment,null,n.a.createElement(Pe,null,n.a.createElement(Oe,{color:"subdued",size:"s",className:"timeline-drop-area-empty__text"},fe.f),n.a.createElement(je,null,n.a.createElement(we,{className:"highlighted-drop-target"},fe.o)),n.a.createElement(Oe,{color:"subdued",size:"s",className:"timeline-drop-area-empty__text"},fe.n),n.a.createElement(be.a,{type:"or"}),n.a.createElement(Oe,{color:"subdued",size:"s",className:"timeline-drop-area-empty__text"},fe.r)),n.a.createElement(Ie,{browserFields:t,timelineId:a})),e&&n.a.createElement(be.a,{type:"or"}))));Ce.displayName="Empty";var ke=a(694),Fe=a(753);const Me={alignItems:"center",display:"flex",height:"36px",minWidth:"125px"},qe=d.a.div.withConfig({displayName:"DroppableContainer",componentId:"sc-1sqk37k-0"})(["min-height:","px;height:auto !important;display:none;."," &:hover{display:flex;background-color:"," !important;}"],36,O.d,(({theme:e})=>Object(oe.rgba)(e.eui.euiColorSuccess,.2))),Te=d.a.span.withConfig({displayName:"Parens",componentId:"sc-1sqk37k-1"})(["color:",";font-size:32px;padding:2px;user-select:none;"],(({theme:e})=>e.eui.euiColorMediumShade)),Ne=d.a.div.withConfig({displayName:"AndOrBadgeContainer",componentId:"sc-1sqk37k-2"})(["span{visibility:",";}"],(({hideBadge:e})=>e?"hidden":"inherit")),De=d.a.div.withConfig({displayName:"LastAndOrBadgeInGroup",componentId:"sc-1sqk37k-3"})(["display:none;."," &{display:initial;}"],O.d),ze=d()(i.EuiFlexItem).withConfig({displayName:"OrFlexItem",componentId:"sc-1sqk37k-4"})(["padding-left:9px;"]);d()(i.EuiFormHelpText).withConfig({displayName:"TimelineEuiFormHelpText",componentId:"sc-1sqk37k-5"})(["padding-top:0px;position:absolute;bottom:0px;left:4px;"]).displayName="TimelineEuiFormHelpText";const Be=d()(i.EuiFlexItem).withConfig({displayName:"ParensContainer",componentId:"sc-1sqk37k-6"})(["align-self:center;"]),Qe=n.a.memo((({browserFields:e,timelineId:t,dataProviders:a})=>{const i=Object(l.useMemo)((()=>[...Object(ve.c)(a),...ve.a]),[a]),r=Object(l.useMemo)((()=>i.map(((r,l)=>n.a.createElement(Re,{key:`droppable-${l}`,group:r,groupIndex:l,isLastGroup:l===i.length-1,browserFields:e,timelineId:t,dataProviders:a})))),[e,i,a,t]);return n.a.createElement("div",null,r)}));Qe.displayName="Providers";const $e=n.a.memo((({browserFields:e,group:t,groupIndex:a,dataProvider:r,index:o,timelineId:d})=>{var c;const u=Object(l.useRef)(null),[m,p]=Object(l.useState)(!1),[,g]=Object(l.useState)(!1),b=Object(s.useDispatch)(),y=Object(l.useCallback)((()=>{g((e=>!e))}),[]),h=Object(l.useMemo)((()=>Object(ge.o)({dataProviderId:r.id,groupIndex:a,timelineId:d})),[r.id,a,d]),f=Object(l.useCallback)((()=>{const e={id:d,providerId:o>0?t[0].id:r.id,andProviderId:o>0?r.id:void 0};b(v.a.removeProvider(e))}),[r.id,b,t,o,d]),E=Object(l.useCallback)((()=>{const e={id:d,providerId:o>0?t[0].id:r.id,enabled:!r.enabled,andProviderId:o>0?r.id:void 0};b(v.a.updateDataProviderEnabled(e))}),[r.enabled,r.id,b,t,o,d]),x=Object(l.useCallback)((()=>{const e={id:d,providerId:o>0?t[0].id:r.id,excluded:!r.excluded,andProviderId:o>0?r.id:void 0};b(v.a.updateDataProviderExcluded(e))}),[r.excluded,r.id,b,t,o,d]),I=Object(l.useCallback)((()=>{const e={id:d,providerId:o>0?t[0].id:r.id,type:r.type===he.a.template?he.a.default:he.a.template,andProviderId:o>0?r.id:void 0};b(v.a.updateDataProviderType(e))}),[r.id,r.type,b,t,o,d]),w=Object(l.useCallback)((({andProviderId:e,excluded:t,field:a,operator:i,providerId:r,value:l})=>b(v.a.dataProviderEdited({andProviderId:e,excluded:t,field:a,id:d,operator:i,providerId:r,value:l}))),[b,d]),j=Object(l.useCallback)((()=>{var e;null===(e=u.current)||void 0===e||e.focus()}),[]),S=Object(l.useCallback)((()=>{p(!0)}),[]),{onBlur:P,onKeyDown:C}=Object(ke.a)({closePopover:y,draggableId:h,fieldName:r.queryMatch.field,keyboardHandlerRef:u,openPopover:S}),k=Object(l.useCallback)((e=>{u.current===document.activeElement&&C(e)}),[C]),F=String(null!==(c=r.queryMatch.displayValue)&&void 0!==c?c:r.queryMatch.value),M=Object(l.useCallback)(((a,l)=>{var s,c,g,b,y;return n.a.createElement("div",ce()({ref:a.innerRef},a.draggableProps,a.dragHandleProps,{style:(y=a.draggableProps.style,{...y,userSelect:"none"}),"data-test-subj":"providerContainer",tabIndex:-1}),n.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(Fe.a,{andProviderId:o>0?r.id:void 0,browserFields:e,deleteProvider:f,field:o>0?null!==(s=r.queryMatch.displayField)&&void 0!==s?s:r.queryMatch.field:null!==(c=t[0].queryMatch.displayField)&&void 0!==c?c:t[0].queryMatch.field,kqlQuery:o>0?r.kqlQuery:t[0].kqlQuery,isEnabled:o>0?r.enabled:t[0].enabled,isExcluded:o>0?r.excluded:t[0].excluded,isPopoverOpen:m,onDataProviderEdited:w,operator:o>0?null!==(g=r.queryMatch.operator)&&void 0!==g?g:he.d:null!==(b=t[0].queryMatch.operator)&&void 0!==b?b:he.d,register:r,providerId:o>0?t[0].id:r.id,timelineId:d,setIsPopoverOpen:p,toggleEnabledProvider:E,toggleExcludedProvider:x,toggleTypeProvider:I,displayValue:F,val:r.queryMatch.value,type:r.type,wrapperRef:u})),n.a.createElement(i.EuiFlexItem,{grow:!1},!l.isDragging&&(o<t.length-1?n.a.createElement(be.a,{type:"and"}):n.a.createElement(De,null,n.a.createElement(be.a,{type:"and"}))))))}),[e,r,F,t,w,f,E,x,I,o,m,u,p,d]);return n.a.createElement("div",{className:O.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:j,onBlur:P,onKeyDown:k,ref:u,role:"button",tabIndex:0},n.a.createElement(ue.Draggable,{disableInteractiveElementBlocking:!0,draggableId:h,index:o,key:r.id},M))}));$e.displayName="DataProvidersGroupItem";const Re=n.a.memo((({browserFields:e,timelineId:t,group:a,groupIndex:r,isLastGroup:o})=>{const d=Object(l.useMemo)((()=>Object(ge.p)({groupIndex:r,timelineId:t})),[r,t]),s=Object(l.useMemo)((()=>a.map(((i,l)=>n.a.createElement($e,{key:i.id,browserFields:e,dataProvider:i,index:l,timelineId:t,group:a,groupIndex:r})))),[e,a,r,t]),c=Object(l.useCallback)((e=>n.a.createElement(qe,ce()({className:o?"empty-providers-group":"",ref:e.innerRef,style:Me},e.droppableProps),s,e.placeholder)),[s,o]);return n.a.createElement(n.a.Fragment,null,0!==r&&n.a.createElement(i.EuiSpacer,{size:"xs"}),n.a.createElement(i.EuiFlexGroup,{"aria-label":fe.m(r),alignItems:"center",gutterSize:"none"},n.a.createElement(ze,{grow:!1},n.a.createElement(Ne,{hideBadge:0===r},n.a.createElement(be.a,{type:"or"}))),n.a.createElement(Be,{grow:!1},n.a.createElement(Te,null,"(")),n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(ue.Droppable,{droppableId:d,direction:"horizontal"},c)),n.a.createElement(Be,{grow:!1},n.a.createElement(Te,null,")")),o&&n.a.createElement(Ie,{browserFields:e,timelineId:t})))}));Re.displayName="DataProvidersGroup";const Ve=d.a.div.withConfig({displayName:"AndOrContainer",componentId:"sc-x7ceea-0"})(["position:relative;top:-1px;"]);Ve.displayName="AndOrContainer";const Ke={filter:{mode:"filter",description:K,kqlBarTooltip:L,placeholder:A,selectText:_},search:{mode:"search",description:G,kqlBarTooltip:H,placeholder:U,selectText:W}},Le=[{value:Ke.filter.mode,inputDisplay:n.a.createElement(Ve,null,n.a.createElement(be.a,{type:"and"}),Ke.filter.selectText),dropdownDisplay:n.a.createElement(n.a.Fragment,null,n.a.createElement(be.a,{type:"and"}),n.a.createElement("strong",null,Ke.filter.selectText),n.a.createElement(i.EuiSpacer,{size:"xs"}),n.a.createElement(i.EuiText,{size:"s",color:"subdued"},n.a.createElement("p",null,Ke.filter.description))),"data-test-subj":"kqlModePopoverFilter"},{value:Ke.search.mode,inputDisplay:n.a.createElement(Ve,null,n.a.createElement(be.a,{type:"or"}),Ke.search.selectText),dropdownDisplay:n.a.createElement(n.a.Fragment,null,n.a.createElement(be.a,{type:"or"}),n.a.createElement("strong",null,Ke.search.selectText),n.a.createElement(i.EuiSpacer,{size:"xs"}),n.a.createElement(i.EuiText,{size:"s",color:"subdued"},n.a.createElement("p",null,Ke.search.description))),"data-test-subj":"kqlModePopoverSearch"}],Ae=d.a.div.withConfig({displayName:"DropTargetDataProvidersContainer",componentId:"sc-iiyap4-0"})(["position:relative;."," & .drop-target-data-providers{background:",";border:0.2rem dashed ",";& .timeline-drop-area-empty__text{color:",";}& .euiFormHelpText{color:",";}}"],O.d,(({theme:e})=>Object(oe.rgba)(e.eui.euiColorSuccess,.1)),(({theme:e})=>e.eui.euiColorSuccess),(({theme:e})=>e.eui.euiColorSuccess),(({theme:e})=>e.eui.euiColorSuccess)),_e=d.a.div.withConfig({displayName:"DropTargetDataProviders",componentId:"sc-iiyap4-1"})(["display:flex;flex-direction:column;justify-content:flex-start;position:relative;border:0.2rem dashed ",";border-radius:5px;padding:"," 0;margin:0px 0 0px 0;max-height:33vh;min-height:100px;overflow:auto;resize:vertical;background-color:",";"],(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiFormBackgroundColor));_e.displayName="DropTargetDataProviders";const Ge="searchOrFilterPopover",He={className:Ge,panelClassName:Ge,panelMinWidth:350},Ue=d.a.div.withConfig({displayName:"CustomTooltipDiv",componentId:"sc-iiyap4-2"})(["position:relative;"]),We=n.a.memo((({timelineId:e})=>{const t=Object(s.useDispatch)(),{browserFields:a}=Object(z.d)(D.SourcererScopeName.timeline),r=Object(l.useMemo)((()=>v.b.getTimelineByIdSelector()),[]),o=Object(C.a)((t=>{var a;return(null!==(a=r(t,e))&&void 0!==a?a:k.b).isLoading})),d=Object(C.a)((t=>{var a;return(null!==(a=r(t,e))&&void 0!==a?a:k.b).dataProviders})),c=Object(l.useMemo)((()=>{return t=e,`${ge.h}${t}${Object(de.v4)()}`;var t}),[e]),u=Object(C.a)((t=>{var a;return(null!==(a=r(t,e))&&void 0!==a?a:k.b).kqlMode})),m=Object(l.useCallback)((a=>{t(Object(ie.updateKqlMode)({id:e,kqlMode:a}))}),[e,t]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(Ae,{"aria-label":fe.s,className:"drop-target-data-providers-container"},n.a.createElement(i.EuiFlexGroup,{direction:"row",justifyContent:"flexStart",gutterSize:"s"},n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(Ue,null,n.a.createElement(i.EuiToolTip,{className:"timeline-select-search-filter-tooltip",content:fe.l},n.a.createElement(i.EuiSuperSelect,{className:"timeline-select-search-or-filter","data-test-subj":"timeline-select-search-or-filter",hasDividers:!0,itemLayoutAlign:"top",itemClassName:"timelineSelectModeItemsClassName",onChange:m,options:Le,popoverProps:He,valueOfSelected:u})))),n.a.createElement(i.EuiFlexItem,{grow:!0},n.a.createElement(_e,{className:"drop-target-data-providers","data-test-subj":"dataProviders"},null!=d&&d.length?n.a.createElement(Qe,{browserFields:a,timelineId:e,dataProviders:d}):n.a.createElement(pe,{isDropDisabled:o,droppableId:c},n.a.createElement(Ce,{browserFields:a,timelineId:e})))))))}));We.displayName="DataProviders";const Ye=j.a.div`
  position: relative;
  width: 100%;
  transition: 0.5s ease-in-out;
  overflow: hidden;

  ${e=>e.$shouldShowQueryBuilder?"display: block; max-height: 300px; visibility: visible; margin-block-start: 0px;":`display: block; max-height: 0px; visibility: hidden; margin-block-start:-${S.euiThemeVars.euiSizeS};`}

  .${O.d} & {
    display: block;
    max-height: 300px;
    visibility: visible;
    margin-block-start: 0px;
  }
`,Je=({filterManager:e,show:t,showCallOutUnauthorizedMsg:a,status:r,timelineId:o})=>{const d=Object(l.useMemo)((()=>v.b.getTimelineByIdSelector()),[]),s=Object(l.useMemo)((()=>v.b.dataProviderVisibilitySelector()),[]),c=Object(C.a)((e=>{var t;return(null!==(t=d(e,o))&&void 0!==t?t:k.b).timelineType})),u=Object(C.a)((e=>{var t;return null!==(t=s(e,o))&&void 0!==t?t:k.b.isDataProviderVisible}))||c===P.l.template;return n.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"column"},n.a.createElement(i.EuiFlexItem,null,n.a.createElement(ne,{filterManager:e,timelineId:o})),a&&n.a.createElement(i.EuiFlexItem,null,n.a.createElement(i.EuiCallOut,{"data-test-subj":"timelineCallOutUnauthorized",title:M,color:"warning",iconType:"warning",size:"s"})),r===P.k.immutable&&n.a.createElement(i.EuiFlexItem,null,n.a.createElement(i.EuiCallOut,{"data-test-subj":"timelineImmutableCallOut",title:q,color:"primary",iconType:"warning",size:"s"})),t?n.a.createElement(Ye,{className:"data-providers-container",$shouldShowQueryBuilder:u},n.a.createElement(We,{timelineId:o})):null)},Xe=n.a.memo(Je);var Ze=a(145),et=a(172),tt=a(1517),at=a(122),it=a(400),rt=a(1269),lt=a(430),nt=a(189),ot=a(282),dt=a(745),st=a(593),ct=a(951),ut=a(18),mt=a(1270);const pt=d.a.div.withConfig({displayName:"QueryTabHeaderContainer",componentId:"sc-1q91qxc-0"})(["width:100%;"]);pt.displayName="TimelineHeaderContainer";const gt=d()(i.EuiFlyoutHeader).withConfig({displayName:"StyledEuiFlyoutHeader",componentId:"sc-1q91qxc-1"})(["align-items:stretch;box-shadow:none;display:flex;flex-direction:column;&.euiFlyoutHeader{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0 0 0;`)),bt=d()(i.EuiFlyoutBody).withConfig({displayName:"StyledEuiFlyoutBody",componentId:"sc-1q91qxc-2"})(["overflow-y:hidden;flex:1;.euiFlyoutBody__overflow{overflow:hidden;mask-image:none;}.euiFlyoutBody__overflowContent{padding:0;height:100%;display:flex;}"]),yt=d()(i.EuiFlyoutFooter).withConfig({displayName:"StyledEuiFlyoutFooter",componentId:"sc-1q91qxc-3"})(["background:none;&.euiFlyoutFooter{","}"],(({theme:e})=>`padding: ${e.eui.euiSizeS} 0;`)),vt=d()(i.EuiFlexGroup).withConfig({displayName:"FullWidthFlexGroup",componentId:"sc-1q91qxc-4"})(["margin:0;width:100%;overflow:hidden;"]),ht=d()(i.EuiFlexItem).withConfig({displayName:"ScrollableFlexItem",componentId:"sc-1q91qxc-5"})([""," overflow:hidden;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`));d()(i.EuiFlexItem).withConfig({displayName:"SourcererFlex",componentId:"sc-1q91qxc-6"})(["align-items:flex-end;"]).displayName="SourcererFlex";const ft=d.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-1q91qxc-7"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade));ft.displayName="VerticalRule";const Et=d()(i.EuiBadge).withConfig({displayName:"EventsCountBadge",componentId:"sc-1q91qxc-8"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),xt=[],It=[],Ot=({activeTab:e,columns:t,dataProviders:a,end:o,expandedDetail:d,filters:c,timelineId:u,isLive:O,itemsPerPage:w,itemsPerPageOptions:j,kqlMode:S,kqlQueryExpression:P,kqlQueryLanguage:k,onEventClosed:F,renderCellValue:M,rowRenderers:q,show:T,showCallOutUnauthorizedMsg:N,showExpandedDetails:B,start:Q,status:$,sort:R,timerangeKind:V})=>{var K;const L=Object(s.useDispatch)(),{portalNode:A}=Object(lt.d)(),{setTimelineFullScreen:_,timelineFullScreen:G}=Object(nt.c)(),{browserFields:H,dataViewId:U,loading:W,indexPattern:Y,runtimeMappings:J,selectedPatterns:X}=Object(z.d)(D.SourcererScopeName.timeline),{uiSettings:Z}=Object(f.i)().services,ee=Object(ut.b)().isEnterprise()?6:5,te=Object(l.useMemo)((()=>v.b.getTimelineByIdSelector()),[]),ae=Object(C.a)((e=>te(e,null!=u?u:at.c.active))).filterManager,ie=Object(l.useMemo)((()=>null!=ae?ae:new p.FilterManager(Z)),[ae,Z]),re=Object(l.useMemo)((()=>Object(g.getEsQueryConfig)(Z)),[Z]),le=Object(l.useMemo)((()=>({query:P.trim(),language:k})),[P,k]),ne=Object(et.d)({config:re,dataProviders:a,indexPattern:Y,browserFields:H,filters:c,kqlQuery:le,kqlMode:S});Object(y.a)({id:u,filterQuery:null==ne?void 0:ne.filterQuery,kqlError:null==ne?void 0:ne.kqlError,query:le,startDate:Q,endDate:o});const oe=Object(r.isEmpty)(a)&&Object(r.isEmpty)(c)&&Object(r.isEmpty)(le.query)&&void 0===(null==ne?void 0:ne.filterQuery),de=Object(l.useMemo)((()=>null!=ne&&null!=W&&!W&&!Object(r.isEmpty)(Q)&&!Object(r.isEmpty)(o)&&void 0!==(null==ne?void 0:ne.filterQuery)),[ne,o,W,Q]),se=R.map((({columnId:e,columnType:t,esTypes:a,sortDirection:i})=>({field:e,direction:i,esTypes:null!=a?a:[],type:t})));Object(l.useEffect)((()=>{L(v.a.initializeTimelineSettings({filterManager:ie,id:u}))}),[L,ie,u]);const[ce,{events:ue,inspect:me,totalCount:pe,pageInfo:ge,loadPage:be,refreshedAt:ye,refetch:ve}]=Object(h.a)({dataViewId:U,endDate:o,fields:[...(Object(r.isEmpty)(t)?E.b:t).map((e=>e.id)),...it.i],filterQuery:null==ne?void 0:ne.filterQuery,id:u,indexNames:X,language:le.language,limit:w,runtimeMappings:J,skip:!de,sort:se,startDate:Q,timerangeKind:V}),he=Object(l.useCallback)((()=>{var e;F({tabType:at.d.query,id:u}),null!==(e=d[at.d.query])&&void 0!==e&&e.panelView&&u===at.c.active&&B&&ot.a.toggleExpandedDetail({})}),[F,u,d,B]);Object(l.useEffect)((()=>{L(v.a.updateIsLoading({id:u,isLoading:ce||W}))}),[W,u,ce,L]);const fe=Object(l.useMemo)((()=>Object(ct.a)(ee).map((e=>({...e,headerCellRender:mt.a})))),[ee]),Ee=!oe&&pe>=0;return n.a.createElement(n.a.Fragment,null,n.a.createElement(m.a,{node:A},Ee?n.a.createElement(Et,null,pe):null),n.a.createElement(tt.a,{id:`${u}-${at.d.query}`,inputId:b.a.timeline,inspect:me,loading:ce,refetch:ve,skip:!de}),n.a.createElement(vt,{gutterSize:"none"},n.a.createElement(ht,{grow:2},n.a.createElement(gt,{"data-test-subj":`${e}-tab-flyout-header`,hasBorder:!1},n.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"column"},G&&null!=_&&n.a.createElement(i.EuiFlexItem,null,n.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},n.a.createElement(st.b,{fullScreen:G,setFullScreen:_}))),n.a.createElement(i.EuiFlexItem,{"data-test-subj":"timeline-date-picker-container"},n.a.createElement(pt,{"data-test-subj":"timelineHeader"},n.a.createElement(Xe,{filterManager:ie,show:T&&e===at.d.query,showCallOutUnauthorizedMsg:N,status:$,timelineId:u}))))),n.a.createElement(rt.a,null,n.a.createElement(bt,{"data-test-subj":`${at.d.query}-tab-flyout-body`,className:"timeline-flyout-body"},n.a.createElement(x.a,{activePage:ge.activePage,browserFields:H,data:oe?xt:ue,id:u,refetch:ve,renderCellValue:M,rowRenderers:q,sort:R,tabType:at.d.query,totalPages:Object(Ze.h)({itemsCount:pe,itemsPerPage:w}),leadingControlColumns:fe,trailingControlColumns:It})),n.a.createElement(yt,{"data-test-subj":`${at.d.query}-tab-flyout-footer`,className:"timeline-flyout-footer"},!oe&&n.a.createElement(I.a,{activePage:null!==(K=null==ge?void 0:ge.activePage)&&void 0!==K?K:0,"data-test-subj":"timeline-footer",updatedAt:ye,height:I.b,id:u,isLive:O,isLoading:ce||W,itemsCount:oe?0:ue.length,itemsPerPage:w,itemsPerPageOptions:j,onChangePage:be,totalCount:oe?0:pe})))),B&&n.a.createElement(n.a.Fragment,null,n.a.createElement(ft,null),n.a.createElement(ht,{grow:1},n.a.createElement(dt.a,{browserFields:H,handleOnPanelClosed:he,runtimeMappings:J,tabType:at.d.query,scopeId:u})))))},wt=Object(s.connect)((()=>{const e=v.b.getShowCallOutUnauthorizedMsg(),t=v.b.getTimelineByIdSelector(),a=v.b.getKqlFilterKuerySelector(),i=B.d.getTimelineSelector();return(l,{timelineId:n})=>{var o,d,s,c,u;const m=null!==(o=t(l,n))&&void 0!==o?o:k.b,p=i(l),{activeTab:g,columns:b,dataProviders:y,expandedDetail:v,filters:h,itemsPerPage:f,itemsPerPageOptions:E,kqlMode:x,show:I,sort:O,status:w,timelineType:j}=m,S=a(l,n),P="filter"===x&&h||[],C=Object(r.isEmpty)(y)&&Object(r.isEmpty)(null!==(d=null==S?void 0:S.expression)&&void 0!==d?d:"")&&"template"===j?" ":null!==(s=null==S?void 0:S.expression)&&void 0!==s?s:"",F=Object(r.isEmpty)(y)&&"template"===j?"kuery":null!==(c=null==S?void 0:S.kind)&&void 0!==c?c:"kuery";return{activeTab:g,columns:b,dataProviders:y,end:p.timerange.to,expandedDetail:v,filters:P,timelineId:n,isLive:"interval"===p.policy.kind,itemsPerPage:f,itemsPerPageOptions:E,kqlMode:x,kqlQueryExpression:C,kqlQueryLanguage:F,showCallOutUnauthorizedMsg:e(l),show:I,showExpandedDetails:!!v[at.d.query]&&!(null===(u=v[at.d.query])||void 0===u||!u.panelView),sort:O,start:p.timerange.from,status:w,timerangeKind:p.timerange.kind}}}),((e,{timelineId:t})=>({onEventClosed:t=>{e(v.a.toggleDetailPanel(t))}})))(n.a.memo(Ot,((e,t)=>((e,t)=>e.kqlMode===t.kqlMode&&e.kqlQueryExpression===t.kqlQueryExpression&&u()(e.filters,t.filters))(e,t)&&e.activeTab===t.activeTab&&((e,t)=>e.end===t.end&&e.start===t.start&&e.timerangeKind===t.timerangeKind)(e,t)&&e.isLive===t.isLive&&e.itemsPerPage===t.itemsPerPage&&e.onEventClosed===t.onEventClosed&&e.show===t.show&&e.showCallOutUnauthorizedMsg===t.showCallOutUnauthorizedMsg&&e.showExpandedDetails===t.showExpandedDetails&&e.status===t.status&&e.timelineId===t.timelineId&&u()(e.columns,t.columns)&&u()(e.dataProviders,t.dataProviders)&&u()(e.itemsPerPageOptions,t.itemsPerPageOptions)&&u()(e.sort,t.sort))))}}]);