/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[8],{115:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(2);const i=e=>Object(r.useCallback)(((t="")=>{if(e)return`${e}${t?`-${t}`:""}`}),[e])},135:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(2),i=n(891);const s=()=>Object(r.useContext)(i.a)},152:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return o}));var r=n(2);const i=()=>{const e=Object(r.useRef)(!1),t=Object(r.useCallback)((()=>e.current),[]),n=Object(r.useCallback)((()=>{e.current=!1}),[]);return Object(r.useEffect)((()=>(e.current=!0,n)),[n]),t},s=e=>{const t=i(),[n,s]=Object(r.useState)(!1),[c,a]=Object(r.useState)(),[o,l]=Object(r.useState)();return{error:c,loading:n,result:o,start:Object(r.useCallback)(((...n)=>{s(!0),l(void 0),a(void 0),e(...n).then((e=>t()&&l(e))).catch((e=>t()&&a(e))).finally((()=>t()&&s(!1)))}),[e,t])}};function c(e,t){switch(t.type){case"setResult":return{...e,result:t.result,loading:!1};case"setError":return{...e,error:t.error,loading:!1};case"load":return{loading:!0,result:void 0,error:void 0}}}const a=e=>{const t=i(),n=Object(r.useRef)(),[s,a]=Object(r.useReducer)(c,{loading:!1,error:void 0,result:void 0}),o=Object(r.useCallback)(((...r)=>{n.current&&n.current.unsubscribe(),a({type:"load"}),n.current=e(...r).subscribe((e=>{t()&&a({type:"setResult",result:e})}),(e=>{t()&&a({type:"setError",error:e})}))}),[e,t]);return Object(r.useEffect)((()=>()=>{n.current&&n.current.unsubscribe()}),[]),{result:s.result,error:s.error,loading:s.loading,start:o}},o=e=>t=>{const n=null!=t.signal?t.signal:(new AbortController).signal;return e({...t,signal:n})}},165:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"u",(function(){return b})),n.d(t,"v",(function(){return h})),n.d(t,"l",(function(){return y})),n.d(t,"j",(function(){return O})),n.d(t,"m",(function(){return m})),n.d(t,"k",(function(){return j})),n.d(t,"d",(function(){return E})),n.d(t,"e",(function(){return v})),n.d(t,"h",(function(){return x})),n.d(t,"p",(function(){return S})),n.d(t,"q",(function(){return w})),n.d(t,"g",(function(){return _})),n.d(t,"n",(function(){return I})),n.d(t,"o",(function(){return A})),n.d(t,"r",(function(){return C})),n.d(t,"f",(function(){return L})),n.d(t,"i",(function(){return P})),n.d(t,"s",(function(){return R})),n.d(t,"t",(function(){return N})),n.d(t,"c",(function(){return $}));var r=n(761),i=n(280),s=n(437),c=n(139),a=n(175),o=n(240),l=n(180);const u=async e=>Object(o.pipe)(await e(),Object(l.fold)((e=>Promise.reject(e)),(e=>Promise.resolve(e)))),d=e=>e instanceof Error?e:new Error(String(e)),p="2023-10-31",f=async({http:e,list:t,signal:n})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,list:t,signal:n})=>e.fetch(a.s,{body:JSON.stringify(t),method:"POST",signal:n,version:p}))({http:e,list:t,signal:n})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.o,e)))),Object(i.flow)(u))(),g=async({http:e,listItem:t,signal:n})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,listItem:t,signal:n})=>e.fetch(a.p,{body:JSON.stringify(t),method:"POST",signal:n,version:p}))({http:e,listItem:t,signal:n})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.n,e)))),Object(i.flow)(u))(),b=async({http:e,list:t,signal:n})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,list:t,signal:n})=>e.fetch(a.s,{body:JSON.stringify(t),method:"PUT",signal:n,version:p}))({http:e,list:t,signal:n})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.o,e)))),Object(i.flow)(u))(),h=async({http:e,listItem:t,signal:n})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,listItem:t,signal:n})=>e.fetch(a.p,{body:JSON.stringify(t),method:"PUT",signal:n,version:p}))({http:e,listItem:t,signal:n})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.n,e)))),Object(i.flow)(u))(),y=async({filters:e,http:t,namespaceTypes:n,pagination:o,signal:l,sort:f})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,filters:t,namespaceTypes:n,pagination:r,signal:i,sort:s})=>{const c={filter:t||void 0,namespace_type:n,page:r.page?`${r.page}`:"1",per_page:r.perPage?`${r.perPage}`:"20",sort_field:null!=s&&s.field?null==s?void 0:s.field:"exception-list.created_at",sort_order:null!=s&&s.order?null==s?void 0:s.order:"desc"};return e.fetch(`${a.s}/_find`,{method:"GET",query:c,signal:i,version:p})})({filters:e,http:t,namespaceTypes:n,pagination:o,signal:l,sort:f})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.t,e)))),Object(i.flow)(u))(),O=async({http:e,id:t,namespaceType:n,signal:o})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:r})=>e.fetch(a.s,{method:"GET",query:{id:t,namespace_type:n},signal:r,version:p}))({http:e,id:t,namespaceType:n,signal:o})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.o,e)))),Object(i.flow)(u))(),m=async({filter:e,http:t,listIds:n,namespaceTypes:o,pagination:l,search:f,signal:g})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,listIds:t,namespaceTypes:n,filter:r,pagination:i,search:s,signal:c})=>{const o={list_id:t.join(","),namespace_type:n.join(","),page:i.page?`${i.page}`:"1",per_page:i.perPage?`${i.perPage}`:"20",search:s,sort_field:"exception-list.created_at",sort_order:"desc",filter:r};return e.fetch(`${a.p}/_find`,{method:"GET",query:o,signal:c,version:p})})({filter:e,http:t,listIds:n,namespaceTypes:o,pagination:l,search:f,signal:g})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.s,e)))),Object(i.flow)(u))(),j=async({http:e,id:t,namespaceType:n,signal:o})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:r})=>e.fetch(a.p,{method:"GET",query:{id:t,namespace_type:n},signal:r,version:p}))({http:e,id:t,namespaceType:n,signal:o})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.n,e)))),Object(i.flow)(u))(),E=async({http:e,id:t,namespaceType:n,signal:o})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:r})=>e.fetch(a.s,{method:"DELETE",query:{id:t,namespace_type:n},signal:r,version:p}))({http:e,id:t,namespaceType:n,signal:o})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.o,e)))),Object(i.flow)(u))(),v=async({http:e,id:t,namespaceType:n,signal:o})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:r})=>e.fetch(a.p,{method:"DELETE",query:{id:t,namespace_type:n},signal:r,version:p}))({http:e,id:t,namespaceType:n,signal:o})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.n,e)))),Object(i.flow)(u))(),x=async({http:e,id:t,includeExpiredExceptions:n,listId:r,namespaceType:i,signal:s})=>e.fetch(`${a.s}/_export`,{method:"POST",query:{id:t,list_id:r,namespace_type:i,include_expired_exceptions:n},signal:s,version:p}),S=async({alias:e,chunkSize:t,exceptionListIds:n,excludeExceptions:r,http:i,signal:s})=>i.fetch(a.u,{method:"POST",version:"1",body:JSON.stringify({exception_list_ids:n,type:"exception_list_ids",alias:e,exclude_exceptions:r,chunk_size:t}),signal:s}),w=async({exceptions:e,alias:t,excludeExceptions:n,http:r,chunkSize:i,signal:s})=>r.fetch(a.u,{method:"POST",version:"1",body:JSON.stringify({exceptions:e,type:"exception_items",alias:t,exclude_exceptions:n,chunk_size:i}),signal:s}),_=async({http:e,includeExpiredExceptions:t,listId:n,namespaceType:r,signal:i})=>e.fetch(`${a.s}/_duplicate`,{method:"POST",query:{list_id:n,namespace_type:r,include_expired_exceptions:t},signal:i,version:p}),T="2023-10-31",I=async({cursor:e,http:t,pageIndex:n,pageSize:l,signal:p,sortField:f,sortOrder:g})=>Object(o.pipe)({cursor:null!=e?e.toString():void 0,page:null!=n?n.toString():void 0,per_page:null!=l?l.toString():void 0,sort_field:null!=f?f.toString():void 0,sort_order:g},(e=>Object(r.fromEither)(Object(s.c)(c.r,e))),Object(r.chain)((e=>Object(r.tryCatch)((()=>(async({http:e,cursor:t,page:n,per_page:r,signal:i,sort_field:s,sort_order:c})=>e.fetch(`${a.z}/_find`,{method:"GET",query:{cursor:t,page:n,per_page:r,sort_field:s,sort_order:c},signal:i,version:T}))({http:t,signal:p,...e})),d))),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.u,e)))),Object(i.flow)(u)),A=async({cursor:e,http:t,pageIndex:n,pageSize:l,signal:p})=>Object(o.pipe)({cursor:null!=e?e.toString():void 0,page:null!=n?n.toString():void 0,per_page:null!=l?l.toString():void 0},(e=>Object(r.fromEither)(Object(s.c)(c.r,e))),Object(r.chain)((e=>Object(r.tryCatch)((()=>(async({http:e,cursor:t,page:n,per_page:r,signal:i})=>e.fetch(`${a.v}`,{method:"GET",version:"1",query:{cursor:t,page:n,per_page:r},signal:i}))({http:t,signal:p,...e})),d))),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.v,e)))),Object(i.flow)(u)),C=async({file:e,http:t,listId:n,type:i,signal:l})=>Object(o.pipe)({list_id:n,type:i},(e=>Object(r.fromEither)(Object(s.c)(c.w,e))),Object(r.chain)((t=>Object(o.pipe)(Object(r.fromEither)(Object(s.c)(c.x,{file:e})),Object(r.map)((e=>({...e,...t})))))),Object(r.chain)((e=>Object(r.tryCatch)((()=>(async({file:e,http:t,list_id:n,type:r,signal:i})=>{const s=new FormData;return s.append("file",e),t.fetch(`${a.x}/_import`,{body:s,headers:{"Content-Type":void 0},method:"POST",query:{list_id:n,type:r},signal:i,version:T})})({http:t,signal:l,...e})),d))),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.A,e)))),u),L=async({deleteReferences:e,http:t,id:n,ignoreReferences:l,signal:p})=>Object(o.pipe)({deleteReferences:e,id:n,ignoreReferences:l},(e=>Object(r.fromEither)(Object(s.c)(c.j,e))),Object(r.chain)((e=>Object(r.tryCatch)((()=>(async({deleteReferences:e=!1,http:t,id:n,ignoreReferences:r=!1,signal:i})=>t.fetch(a.z,{method:"DELETE",query:{deleteReferences:e,id:n,ignoreReferences:r},signal:i,version:T}))({http:t,signal:p,...e})),d))),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.A,e)))),Object(i.flow)(u)),P=async({http:e,listId:t,signal:n})=>Object(o.pipe)({list_id:t},(e=>Object(r.fromEither)(Object(s.c)(c.q,e))),Object(r.chain)((t=>Object(r.tryCatch)((()=>(async({http:e,list_id:t,signal:n})=>e.fetch(`${a.x}/_export`,{method:"POST",query:{list_id:t},signal:n,version:T}))({http:e,signal:n,...t})),d))),Object(i.flow)(u)),R=async({http:e,signal:t})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,signal:t})=>e.fetch(a.w,{method:"GET",signal:t,version:T}))({http:e,signal:t})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.z,e)))),Object(i.flow)(u))(),N=async({http:e,signal:t})=>e.fetch(a.y,{method:"GET",signal:t,version:T}),$=async({http:e,signal:t})=>Object(i.flow)((()=>Object(r.tryCatch)((()=>(async({http:e,signal:t})=>e.fetch(a.w,{method:"POST",signal:t,version:T}))({http:e,signal:t})),d)),Object(r.chain)((e=>Object(r.fromEither)(Object(s.c)(c.e,e)))),Object(i.flow)(u))()},169:function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"j",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return d})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return O})),n.d(t,"g",(function(){return m}));var r=n(51);const i=e=>null!=e.id?e:{...e,id:Object(r.v4)()},s=e=>{const t=e;if(null!=t.id){const{id:e,...n}=t;return n}return e};var c=n(5);let a,o,l;c.i18n.translate("utils.wildcardWarning",{defaultMessage:"Using wildcards can impact Endpoint performance"}),c.i18n.translate("utils.filename.pathWarning",{defaultMessage:"Path may be formed incorrectly; verify value"}),function(e){e.HASH="process.hash.*",e.PATH="process.executable.caseless",e.SIGNER="process.Ext.code_signature"}(a||(a={})),function(e){e.HASH=".hash.",e.EXECUTABLE=".executable.caseless",e.PATH=".path",e.SIGNER=".Ext.code_signature"}(o||(o={})),function(e){e.LINUX="linux",e.MAC="macos",e.WINDOWS="windows"}(l||(l={}));const u=({os:e,type:t,value:n})=>{const r=e===l.WINDOWS?"\\":"/",i=n.split(r).pop();if(i)return"wildcard"!==t||1===(i.split("*").length||i.split("?").length)},d=({os:e,field:t,type:n,value:r})=>!["process.executable.caseless","file.path","file.path.text"].includes(t)||("wildcard"===n?e===l.WINDOWS?f(r):g(r):p({value:r,os:e})),p=({os:e,value:t})=>e===l.WINDOWS?/^[a-z]:(?:|\\\\[^<>:"'/\\|?*]+\\[^<>:"'/\\|?*]+|%\w+%|)[\\](?:[^<>:"'/\\|?*]+[\\/])*([^<>:"'/\\|?*])+$/i.test(t):/^(\/|(\/[\w\-]+)+|\/[\w\-]+\.[\w]+|(\/[\w-]+)+\/[\w\-]+\.[\w]+)$/i.test(t),f=e=>{const t=e[0],n=e.slice(-1),r=e.trim(),i=/\//.test(r);return 0!==e.length&&!(i||r.length!==e.length||"^"===t||"\\"===n||!b({path:e,isWindowsPath:!0}))},g=e=>{const t=e[0],n=e.slice(-1),r=e.trim();return 0!==e.length&&!(r.length!==e.length||"/"!==t||"/"===n||e.length>1024==1||!0===e.includes("//")||!b({path:e,isWindowsPath:!1}))},b=({path:e,isWindowsPath:t})=>{for(const n of e.split(t?"\\":"/"))if(!0===/[\*|\?]+/.test(n))return!0;return!1},h=e=>/\|\s+stats\s/i.test(e);var y=n(53);const O=e=>{const t=Object(y.getIndexPatternFromESQLQuery)(e);return m(t)},m=e=>e?e.split(",").map((e=>e.trim())):[]},185:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(45);const i=e=>Object(r.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`},186:function(e,t,n){"use strict";let r,i,s,c,a,o,l;n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return a})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),function(e){e.windows="windows",e.mac="mac",e.linux="linux"}(r||(r={})),function(e){e.is="is",e.matches="matches"}(i||(i={})),function(e){e.enrolled="enrolled",e.unenrolled="unenrolled"}(s||(s={})),function(e){e.UNHEALTHY="unhealthy",e.HEALTHY="healthy",e.OFFLINE="offline",e.UPDATING="updating",e.INACTIVE="inactive",e.UNENROLLED="unenrolled"}(c||(c={})),function(e){e.detect="detect",e.prevent="prevent",e.off="off"}(a||(a={})),function(e){e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported"}(o||(o={})),function(e){e.ENROLLED_AT="enrolled_at",e.HOSTNAME="metadata.host.hostname",e.HOST_STATUS="host_status",e.POLICY_NAME="metadata.Endpoint.policy.applied.name",e.POLICY_STATUS="metadata.Endpoint.policy.applied.status",e.HOST_OS_NAME="metadata.host.os.name",e.HOST_IP="metadata.host.ip",e.AGENT_VERSION="metadata.agent.version",e.LAST_SEEN="last_checkin"}(l||(l={}))},200:function(e,t,n){"use strict";n.d(t,"B",(function(){return s})),n.d(t,"C",(function(){return c})),n.d(t,"D",(function(){return a})),n.d(t,"v",(function(){return o})),n.d(t,"r",(function(){return u})),n.d(t,"q",(function(){return d})),n.d(t,"u",(function(){return p})),n.d(t,"g",(function(){return f})),n.d(t,"w",(function(){return g})),n.d(t,"x",(function(){return b})),n.d(t,"f",(function(){return h})),n.d(t,"s",(function(){return y})),n.d(t,"z",(function(){return O})),n.d(t,"p",(function(){return m})),n.d(t,"t",(function(){return j})),n.d(t,"y",(function(){return E})),n.d(t,"o",(function(){return v})),n.d(t,"n",(function(){return x})),n.d(t,"A",(function(){return S})),n.d(t,"e",(function(){return w})),n.d(t,"c",(function(){return _})),n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return I})),n.d(t,"d",(function(){return A})),n.d(t,"i",(function(){return C})),n.d(t,"h",(function(){return L})),n.d(t,"j",(function(){return P})),n.d(t,"k",(function(){return R})),n.d(t,"m",(function(){return N})),n.d(t,"l",(function(){return $}));var r=n(70),i=n(186);const s="logs-endpoint.events.*",c="metrics-endpoint.metadata_current_*",a="endpoint.metadata_current-default",o=".metrics-endpoint.metadata_united_default",l=(Object(r.getFileMetadataIndexName)("endpoint"),Object(r.getFileDataIndexName)("endpoint"),"/api/endpoint"),u=`${l}/metadata`,d=`${u}/{id}`,p=`${l}/metadata/transforms`,f=`${l}/policy_response`,g=`${l}/protection_updates_note/{package_policy_id}`,b=`${l}/suggestions/{suggestion_type}`,h=`${l}/action`,y=`${h}/isolate`,O=`${h}/unisolate`,m=`${h}/running_procs`,j=`${h}/kill_process`,E=`${h}/suspend_process`,v=`${h}/get_file`,x=`${h}/execute`,S=`${h}/upload`,w=`${l}/action_status`,_=`${h}/{action_id}`,T=`${h}/{action_id}/file/{file_id}`,I=`${h}/{action_id}/file/{file_id}/download`,A=`${h}/state`,C=i.a.ENROLLED_AT,L="desc",P={ES_CONNECTION_ERROR:-272,OUTPUT_SERVER_ERROR:-273},R="endpointFields",N="endpointSearchStrategy",$="endpointPackagePoliciesStatsStrategy"},310:function(e,t,n){"use strict";const r=n(968),i=n(969),s=n(970);function c(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function a(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}function o(e,t){return t.decode?i(e):e}function l(e){return Array.isArray(e)?e.sort():"object"==typeof e?l(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function u(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){const t=(e=u(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function f(e,t){c((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,r)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===r[e]&&(r[e]={}),r[e][t[1]]=n):r[e]=n};case"bracket":return(e,n,r)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==r[e]?r[e]=[].concat(r[e],n):r[e]=[n]:r[e]=n};case"comma":case"separator":return(t,n,r)=>{const i="string"==typeof n&&n.split("").indexOf(e.arrayFormatSeparator)>-1?n.split(e.arrayFormatSeparator).map((t=>o(t,e))):null===n?n:o(n,e);r[t]=i};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),r=Object.create(null);if("string"!=typeof e)return r;if(!(e=e.trim().replace(/^[?#&]/,"")))return r;for(const i of e.split("&")){let[e,c]=s(t.decode?i.replace(/\+/g," "):i,"=");c=void 0===c?null:["comma","separator"].includes(t.arrayFormat)?c:o(c,t),n(o(e,t),c,r)}for(const e of Object.keys(r)){const n=r[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=p(n[e],t);else r[e]=p(n,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce(((e,t)=>{const n=r[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=l(n):e[t]=n,e}),Object.create(null))}t.extract=d,t.parse=f,t.stringify=(e,t)=>{if(!e)return"";c((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],r=function(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const i=n.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[a(t,e),"[",i,"]"].join("")]:[...n,[a(t,e),"[",a(i,e),"]=",a(r,e)].join("")]};case"bracket":return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,[a(t,e),"[]"].join("")]:[...n,[a(t,e),"[]=",a(r,e)].join("")];case"comma":case"separator":return t=>(n,r)=>null==r||0===r.length?n:0===n.length?[[a(t,e),"=",a(r,e)].join("")]:[[n,a(r,e)].join(e.arrayFormatSeparator)];default:return t=>(n,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?n:null===r?[...n,a(t,e)]:[...n,[a(t,e),"=",a(r,e)].join("")]}}(t),i={};for(const t of Object.keys(e))n(t)||(i[t]=e[t]);const s=Object.keys(i);return!1!==t.sort&&s.sort(t.sort),s.map((n=>{const i=e[n];return void 0===i?"":null===i?a(n,t):Array.isArray(i)?i.reduce(r(n),[]).join("&"):a(n,t)+"="+a(i,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,r]=s(e,"#");return Object.assign({url:n.split("?")[0]||"",query:f(d(e),t)},t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:o(r,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const r=u(e.url).split("?")[0]||"",i=t.extract(e.url),s=t.parse(i,{sort:!1}),c=Object.assign(s,e.query);let o=t.stringify(c,n);o&&(o=`?${o}`);let l=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(l=`#${a(e.fragmentIdentifier,n)}`),`${r}${o}${l}`}},311:function(e,t,n){"use strict";n.d(t,"e",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"a",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"d",(function(){return b})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return y})),n.d(t,"f",(function(){return O})),n.d(t,"g",(function(){return m}));var r=n(68),i=n(4),s=n(200),c=n(110),a=n(621),o=n(488);const l=async({query:e,signal:t})=>c.b.get().http.fetch(i.gb,{version:"2023-10-31",method:"POST",body:JSON.stringify(e),signal:t}),u=async({query:e,status:t,signal:n})=>c.b.get().http.fetch(i.lb,{version:"2023-10-31",method:"POST",body:JSON.stringify({conflicts:"proceed",status:t,query:e}),signal:n}),d=async({signalIds:e,status:t,signal:n})=>c.b.get().http.fetch(i.lb,{version:"2023-10-31",method:"POST",body:JSON.stringify({status:t,signal_ids:e}),signal:n}),p=async({signal:e})=>c.b.get().http.fetch(i.eb,{version:"2023-10-31",method:"GET",signal:e}),f=async({signal:e})=>c.b.get().http.fetch(i.ab,{version:"2023-10-31",method:"GET",signal:e}),g=async({signal:e})=>c.b.get().http.fetch(i.fb,{version:"2023-10-31",method:"GET",signal:e}),b=async({signal:e})=>c.b.get().http.fetch(i.eb,{version:"2023-10-31",method:"POST",signal:e}),h=async({endpointId:e,comment:t="",caseIds:n})=>Object(a.a)({endpoint_ids:[e],comment:t,case_ids:n}),y=async({endpointId:e,comment:t="",caseIds:n})=>Object(a.b)({endpoint_ids:[e],comment:t,case_ids:n}),O=async({alertId:e,owner:t})=>c.b.get().http.fetch(Object(r.getCasesFromAlertsUrl)(e),{method:"get",query:{...t.length>0?{owner:t}:{}}}),m=async({agentId:e,signal:t})=>c.b.get().http.fetch(Object(o.a)(s.q,{id:e}),{method:"GET",signal:t,version:"2023-10-31"})},350:function(e,t,n){"use strict";n.d(t,"q",(function(){return s})),n.d(t,"o",(function(){return c})),n.d(t,"p",(function(){return a})),n.d(t,"g",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return h})),n.d(t,"h",(function(){return x})),n.d(t,"i",(function(){return S})),n.d(t,"m",(function(){return v})),n.d(t,"n",(function(){return w})),n.d(t,"c",(function(){return I})),n.d(t,"k",(function(){return A})),n.d(t,"l",(function(){return C})),n.d(t,"d",(function(){return L})),n.d(t,"e",(function(){return P})),n.d(t,"j",(function(){return N}));var r=n(5),i=n(139);const s={message:r.i18n.translate("lists.exceptions.isOperatorLabel",{defaultMessage:"is"}),operator:i.c.INCLUDED,type:i.d.MATCH,value:"is"},c={message:r.i18n.translate("lists.exceptions.isNotOperatorLabel",{defaultMessage:"is not"}),operator:i.c.EXCLUDED,type:i.d.MATCH,value:"is_not"},a={message:r.i18n.translate("lists.exceptions.isOneOfOperatorLabel",{defaultMessage:"is one of"}),operator:i.c.INCLUDED,type:i.d.MATCH_ANY,value:"is_one_of"},o={message:r.i18n.translate("lists.exceptions.isNotOneOfOperatorLabel",{defaultMessage:"is not one of"}),operator:i.c.EXCLUDED,type:i.d.MATCH_ANY,value:"is_not_one_of"},l={message:r.i18n.translate("lists.exceptions.existsOperatorLabel",{defaultMessage:"exists"}),operator:i.c.INCLUDED,type:i.d.EXISTS,value:"exists"},u={message:r.i18n.translate("lists.exceptions.doesNotExistOperatorLabel",{defaultMessage:"does not exist"}),operator:i.c.EXCLUDED,type:i.d.EXISTS,value:"does_not_exist"},d={message:r.i18n.translate("lists.exceptions.isInListOperatorLabel",{defaultMessage:"is in list"}),operator:i.c.INCLUDED,type:i.d.LIST,value:"is_in_list"},p={message:r.i18n.translate("lists.exceptions.isNotInListOperatorLabel",{defaultMessage:"is not in list"}),operator:i.c.EXCLUDED,type:i.d.LIST,value:"is_not_in_list"},f={message:r.i18n.translate("lists.exceptions.matchesOperatorLabel",{defaultMessage:"matches"}),operator:i.c.INCLUDED,type:i.d.WILDCARD,value:"matches"},g={message:r.i18n.translate("lists.exceptions.doesNotMatchOperatorLabel",{defaultMessage:"does not match"}),operator:i.c.EXCLUDED,type:i.d.WILDCARD,value:"does_not_match"},b=[s,c,a,o,f,g],h=[s,c,a,o,l,u,d,p,f,g];var y=n(175);const O=y.q,m=y.r;var j=n(9),E=n(45);const v=({namespaceType:e})=>e.map((e=>(({namespaceType:e})=>"agnostic"===e?m:O)({namespaceType:e}))),x=({filters:e,namespaceTypes:t,hideLists:n})=>{const r=v({namespaceType:t}),i=((e,t)=>Object.keys(e).map((n=>{const r=Object(E.get)(n,e);return Object(j.isArray)(r)||null!=r&&""!==r.trim()?`(${t.map((e=>{const t="name"===n?"name.text":"types"===n?"type":n;return Object(j.isArray)(r)?r.map((n=>`${e}.attributes.${t}:${n}`)).join(" OR "):`${e}.attributes.${t}:${r}`})).join(" OR ")})`:null})).filter((e=>null!=e)).join(" AND "))(e,r);return[i,...n.map((e=>`(${r.map((t=>`not ${t}.attributes.list_id: ${e}*`)).join(" AND ")})`))].filter((e=>""!==e.trim())).join(" AND ")},S=({lists:e,showDetection:t,showEndpoint:n})=>e.filter((e=>t?"detection"===e.type:!n||"endpoint"===e.type)).reduce(((e,{listId:t,namespaceType:n})=>({ids:[...e.ids,t],namespaces:[...e.namespaces,n]})),{ids:[],namespaces:[]}),w=e=>e.filter((({type:e})=>"list"===e)).length>0;var _=n(51),T=n(169);n(437),n(53),n(328);const I=e=>e.map((e=>"nested"===e.type?Object(T.d)({...e,entries:e.entries.map((e=>Object(T.d)(e)))}):Object(T.d)(e))),A=({listId:e,namespaceType:t,name:n})=>({comments:[],description:"Exception list item",entries:I([{field:"",operator:"included",type:"match",value:""}]),item_id:void 0,list_id:e,meta:{temporaryUuid:Object(_.v4)()},name:n,namespace_type:t,tags:[],type:"simple"}),C=e=>{switch(e.type){case"match":return i.d.MATCH;case"match_any":return i.d.MATCH_ANY;case"wildcard":return i.d.WILDCARD;case"list":return i.d.LIST;default:return i.d.EXISTS}},L=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time > "${t}" OR NOT ${e}.attributes.expire_time: *`)).join(",")},P=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time <= "${t}"`)).join(",")},R=e=>{let t=e.match(/.ds-(.*?)-[0-9]{4}\.[0-9]{2}\.[0-9]{2}-[0-9]{6}/);return t&&2===t.length?t[1]:(t=e.match(/.siem-(.*?)-[0-9]{6}/),t&&2===t.length?`.siem-${t[1]}`:e)},N=e=>{if(!e.conflictDescriptions)return null;const t=[];for(const[n,r]of Object.entries(e.conflictDescriptions)){const e=[],i={};r.forEach((e=>{const t=R(e);i[t]||(i[t]=0),i[t]++}));for(const[t,n]of Object.entries(i))e.push({name:t,count:n});e.sort(((e,t)=>t.count-e.count)),t.push({type:n,totalIndexCount:r.length,groupedIndices:e})}return t}},387:function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return v})),n.d(t,"h",(function(){return S})),n.d(t,"i",(function(){return _})),n.d(t,"j",(function(){return I})),n.d(t,"k",(function(){return C})),n.d(t,"l",(function(){return P}));var r=n(280),i=n(169);const s=e=>Object(r.flow)(c)(e),c=e=>{const t=e.entries.map((e=>"nested"===e.type?Object(i.d)({...e,entries:e.entries.map((e=>Object(i.d)(e)))}):Object(i.d)(e)));return{...e,entries:t}},a=e=>{const{entries:t}=e,n=t.map((e=>"nested"===e.type?Object(i.j)({...e,entries:e.entries.map((e=>Object(i.j)(e)))}):Object(i.j)(e)));return{...e,entries:n}},o=e=>{const{comments:t}=e;if(!t||!t.length)return e;const n=t.map((({comment:e,id:t})=>({comment:e,id:t})));return{...e,comments:n}};var l=n(2),u=n(165),d=n(350);const p=e=>Object(l.useMemo)((()=>({async addExceptionListItem({listItem:t}){const n=new AbortController,i=(s=t,Object(r.flow)(a)(s));var s;return u.b({http:e,listItem:i,signal:n.signal})},async deleteExceptionItem({id:t,namespaceType:n,onSuccess:r,onError:i}){const s=new AbortController;try{await u.e({http:e,id:t,namespaceType:n,signal:s.signal}),r()}catch(e){i(e)}},async deleteExceptionList({id:t,namespaceType:n,onSuccess:r,onError:i}){const s=new AbortController;try{await u.d({http:e,id:t,namespaceType:n,signal:s.signal}),r()}catch(e){i(e)}},async duplicateExceptionList({includeExpiredExceptions:t,listId:n,namespaceType:r,onError:i,onSuccess:s}){const c=new AbortController;try{s(await u.g({http:e,includeExpiredExceptions:t,listId:n,namespaceType:r,signal:c.signal}))}catch(e){i(e)}},async exportExceptionList({id:t,includeExpiredExceptions:n,listId:r,namespaceType:i,onError:s,onSuccess:c}){const a=new AbortController;try{c(await u.h({http:e,id:t,includeExpiredExceptions:n,listId:r,namespaceType:i,signal:a.signal}))}catch(e){s(e)}},async getExceptionItem({id:t,namespaceType:n,onSuccess:r,onError:i}){const c=new AbortController;try{r(s(await u.k({http:e,id:t,namespaceType:n,signal:c.signal})))}catch(e){i(e)}},async getExceptionList({id:t,namespaceType:n,onSuccess:r,onError:i}){const s=new AbortController;try{r(await u.j({http:e,id:t,namespaceType:n,signal:s.signal}))}catch(e){i(e)}},async getExceptionListsItems({lists:t,filter:n,pagination:r,showDetectionsListsOnly:i,showEndpointListsOnly:c,onSuccess:a,onError:o}){const l=new AbortController,{ids:p,namespaces:f}=Object(d.i)({lists:t,showDetection:i,showEndpoint:c});try{if(p.length>0&&f.length>0){const{data:t,page:i,per_page:c,total:o}=await u.m({filter:n,http:e,listIds:p,namespaceTypes:f,pagination:r,signal:l.signal});a({exceptions:t.map((e=>s(e))),pagination:{page:i,perPage:c,total:o}})}else a({exceptions:[],pagination:{page:0,perPage:null!=r.perPage?r.perPage:0,total:0}})}catch(e){o(e)}},async getExceptionFilterFromIds({exceptionListIds:t,chunkSize:n,alias:r,excludeExceptions:i,onSuccess:s,onError:c}){const a=new AbortController;try{const{filter:c}=await u.p({http:e,exceptionListIds:t,signal:a.signal,chunkSize:n,alias:r,excludeExceptions:i});s(c)}catch(e){c(e)}},async getExceptionFilterFromExceptions({exceptions:t,chunkSize:n,alias:r,excludeExceptions:i,onSuccess:s,onError:c}){const a=new AbortController;try{const{filter:c}=await u.q({http:e,exceptions:t,signal:a.signal,chunkSize:n,alias:r,excludeExceptions:i});s(c)}catch(e){c(e)}},async updateExceptionListItem({listItem:t}){const n=new AbortController,i=(s=t,Object(r.flow)(o,a)(s));var s;return u.v({http:e,listItem:i,signal:n.signal})}})),[e]);var f=n(152);const g=Object(f.d)(u.c),b=()=>Object(f.a)(g),h=e=>JSON.stringify(e),y=({pageIndex:e,pageSize:t})=>{const[n,r]=Object(l.useState)({}),i=Object(l.useCallback)((i=>{r({...n,[h({pageIndex:e+1,pageSize:t})]:i})}),[e,t]);let s;for(let r=e;r>=0&&(s=n[h({pageIndex:r,pageSize:t})],!s);r--);return[s,i]},O=Object(f.d)(u.f),m=()=>Object(f.a)(O),j={page:1,perPage:20,total:0},E={field:"created_at",order:"desc"},v=({errorMessage:e,http:t,initialPagination:n=j,filterOptions:r={},namespaceTypes:i,notifications:s,hideLists:c=[],initialSort:a=E})=>{const[o,p]=Object(l.useState)([]),[f,g]=Object(l.useState)(n),[b,h]=Object(l.useState)(a),[y,O]=Object(l.useState)(!0),m=Object(l.useRef)(),v=Object(l.useMemo)((()=>i.join(",")),[i]),x=Object(l.useMemo)((()=>Object(d.h)({filters:r,namespaceTypes:i,hideLists:c})),[i,r,c]),S=Object(l.useCallback)((async()=>{try{O(!0),m.current=new AbortController;const{page:e,per_page:n,total:r,data:i}=await Object(u.l)({filters:x,http:t,namespaceTypes:v,pagination:{page:f.page,perPage:f.perPage},sort:b,signal:m.current.signal});g({page:e,perPage:n,total:r}),p(i),O(!1)}catch(t){"AbortError"!==t.name&&(s.toasts.addError(t,{title:e}),p([]),g(j),O(!1))}}),[e,x,t,v,s.toasts,f.page,f.perPage,b]);return Object(l.useEffect)((()=>(S(),()=>{var e;null===(e=m.current)||void 0===e||e.abort()})),[S]),[y,o,f,g,S,b,h]},x=(Object(f.d)(u.i),Object(f.d)(u.n)),S=()=>Object(f.a)(x),w=Object(f.d)(u.o),_=()=>Object(f.a)(w),T=Object(f.d)(u.r),I=()=>Object(f.a)(T),A=Object(f.d)(u.s),C=()=>Object(f.a)(A),L=Object(f.d)(u.t),P=()=>Object(f.a)(L)},488:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));const r=(e,t)=>Object.keys(t).reduce(((e,n)=>e.replace(new RegExp(`\\{${n}\\}`,"g"),String(t[n]))),e)},575:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return a}));var r=n(9),i=n(420);function s(e,t){var n,r,i;return null!==(n=null===(r=e.packagePrivileges)||void 0===r||null===(i=r.endpoint)||void 0===i?void 0:i.actions[t].executePackageAction)&&void 0!==n&&n}function c(e,t){var n,r;return null!==(n=null===(r=e.endpointExceptionsPrivileges)||void 0===r?void 0:r.actions[t])&&void 0!==n&&n}const a=(e,t,n=[])=>{var a;const o=e.isPlatinumPlus(),l=e.isEnterprise(),u=n.includes("superuser"),d=s(t,"writeSecuritySolution"),p=s(t,"readSecuritySolution"),f=s(t,"writeEndpointList"),g=s(t,"readEndpointList"),b=s(t,"writePolicyManagement"),h=s(t,"readPolicyManagement"),y=s(t,"writeActionsLogManagement"),O=s(t,"readActionsLogManagement"),m=s(t,"writeHostIsolation"),j=s(t,"writeHostIsolationRelease"),E=s(t,"writeProcessOperations"),v=s(t,"writeTrustedApplications"),x=s(t,"readTrustedApplications"),S=s(t,"writeHostIsolationExceptions"),w=s(t,"readHostIsolationExceptions"),_=s(t,"accessHostIsolationExceptions"),T=s(t,"deleteHostIsolationExceptions"),I=s(t,"writeBlocklist"),A=s(t,"readBlocklist"),C=s(t,"writeEventFilters"),L=s(t,"readEventFilters"),P=s(t,"writeFileOperations"),R=s(t,"writeExecuteOperations"),N=c(t,"showEndpointExceptions"),$=c(t,"crudEndpointExceptions"),k={canWriteSecuritySolution:d,canReadSecuritySolution:p,canAccessFleet:null!==(a=null==t?void 0:t.fleet.all)&&void 0!==a&&a,canAccessEndpointManagement:u,canCreateArtifactsByPolicy:o,canWriteEndpointList:f,canReadEndpointList:g,canWritePolicyManagement:b,canReadPolicyManagement:h,canWriteActionsLogManagement:y,canReadActionsLogManagement:O&&l,canAccessEndpointActionsLogManagement:O&&o,canIsolateHost:m&&o,canUnIsolateHost:j,canKillProcess:E&&l,canSuspendProcess:E&&l,canGetRunningProcesses:E&&l,canAccessResponseConsole:!1,canWriteExecuteOperations:R&&l,canWriteFileOperations:P&&l,canWriteTrustedApplications:v,canReadTrustedApplications:x,canWriteHostIsolationExceptions:S&&o,canAccessHostIsolationExceptions:_&&o,canReadHostIsolationExceptions:w,canDeleteHostIsolationExceptions:T,canWriteBlocklist:I,canReadBlocklist:A,canWriteEventFilters:C,canReadEventFilters:L,canReadEndpointExceptions:N,canWriteEndpointExceptions:$};return k.canAccessResponseConsole=l&&Object.values(Object(r.omit)(i.g,"release")).some((e=>k[e])),k},o=()=>({canWriteSecuritySolution:!1,canReadSecuritySolution:!1,canAccessFleet:!1,canAccessEndpointActionsLogManagement:!1,canAccessEndpointManagement:!1,canCreateArtifactsByPolicy:!1,canWriteEndpointList:!1,canReadEndpointList:!1,canWritePolicyManagement:!1,canReadPolicyManagement:!1,canWriteActionsLogManagement:!1,canReadActionsLogManagement:!1,canIsolateHost:!1,canUnIsolateHost:!1,canKillProcess:!1,canSuspendProcess:!1,canGetRunningProcesses:!1,canAccessResponseConsole:!1,canWriteFileOperations:!1,canWriteExecuteOperations:!1,canWriteTrustedApplications:!1,canReadTrustedApplications:!1,canWriteHostIsolationExceptions:!1,canAccessHostIsolationExceptions:!1,canReadHostIsolationExceptions:!1,canDeleteHostIsolationExceptions:!1,canWriteBlocklist:!1,canReadBlocklist:!1,canWriteEventFilters:!1,canReadEventFilters:!1,canReadEndpointExceptions:!1,canWriteEndpointExceptions:!1})},621:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return c}));var r=n(110),i=n(200);const s=async e=>r.b.get().http.post(i.s,{body:JSON.stringify(e),version:"2023-10-31"}),c=async e=>r.b.get().http.post(i.z,{body:JSON.stringify(e),version:"2023-10-31"})},891:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return m}));var r=n(2),i=n.n(r),s=n(4),c=n(387),a=n(117),o=n(110),l=n(5);const u=l.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.readListsPrivileges.errorDescription",{defaultMessage:"Failed to retrieve lists privileges"}),d=l.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.detectionEnginePrivileges.errorFetching",{defaultMessage:"Failed to retrieve detection engine privileges"});var p=n(152),f=n(311);var g=n(9),b=n(18),h=n(575),y=n(902);const O=Object(r.createContext)({listPrivileges:{loading:!1,error:void 0,result:void 0},detectionEnginePrivileges:{loading:!1,error:void 0,result:void 0},endpointPrivileges:{loading:!0,...Object(h.b)()},kibanaSecuritySolutionsPrivileges:{crud:!1,read:!1}}),m=({kibanaCapabilities:e,children:t})=>{const n=!0===e[s.vc].crud,l=!0===e[s.vc].show,[m,j]=Object(r.useState)({crud:n,read:l}),E=((e=!0)=>{const t=Object(o.h)(),{lists:n}=Object(o.i)().services,{start:i,...s}=Object(c.l)(),{addError:l}=Object(a.a)(),d=Object(r.useRef)(new AbortController);return Object(r.useEffect)((()=>{const{loading:r,result:c,error:a}=s;!e||!n||r||c||a||(d.current.abort(),d.current=new AbortController,i({http:t,signal:d.current.signal}))}),[t,n,i,s,e]),Object(r.useEffect)((()=>()=>{d.current.abort()}),[]),Object(r.useEffect)((()=>{const e=s.error;null!=e&&l(e,{title:u})}),[l,s.error]),{loading:s.loading,error:s.error,result:s.result}})(l),v=((e=!0)=>{const{start:t,...n}=Object(p.a)(Object(p.d)(f.i)),{addError:i}=Object(a.a)(),s=Object(r.useRef)(new AbortController);return Object(r.useEffect)((()=>{const{loading:r,result:i,error:c}=n;!e||r||i||c||(s.current.abort(),s.current=new AbortController,t({signal:s.current.signal}))}),[t,n,e]),Object(r.useEffect)((()=>()=>{s.current.abort()}),[]),Object(r.useEffect)((()=>{const e=n.error;null!=e&&i(e,{title:d})}),[i,n.error]),n})(l),x=(()=>{var e,t;const n=Object(p.b)(),i=Object(o.f)(),s=Object(o.i)().services.fleet,c=null===(e=Object(y.b)())||void 0===e?void 0:e.fleet,a=null!==(t=null==s?void 0:s.authz)&&void 0!==t?t:null==c?void 0:c.authz,l=Object(b.b)(),[u,d]=Object(r.useState)(!1),[f,O]=Object(r.useState)([]),m=Object(r.useMemo)((()=>{const e=!u||!i;return Object.freeze({loading:e,...e||!a||Object(g.isEmpty)(i)?Object(h.b)():Object(h.a)(l,a,f)})}),[u,i,a,l,f]);return Object(r.useEffect)((()=>{(async()=>{i&&n()&&(O(null==i?void 0:i.roles),d(!0))})()}),[n,i]),m})();return Object(r.useEffect)((()=>{j((e=>e.read!==l||e.crud!==n?{read:l,crud:n}:e))}),[n,l]),i.a.createElement(O.Provider,{value:{listPrivileges:E,detectionEnginePrivileges:v,endpointPrivileges:x,kibanaSecuritySolutionsPrivileges:m}},t)}},902:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s}));var r=n(2);const i=n.n(r).a.createContext(void 0),s=()=>Object(r.useContext)(i)},968:function(e,t,n){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},969:function(e,t,n){"use strict";var r="%[a-f0-9]{2}",i=new RegExp("("+r+")|([^%]+?)","gi"),s=new RegExp("("+r+")+","gi");function c(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],c(n),c(r))}function a(e){try{return decodeURIComponent(e)}catch(r){for(var t=e.match(i)||[],n=1;n<t.length;n++)t=(e=c(t,n).join("")).match(i)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=s.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var r=a(n[0]);r!==n[0]&&(t[n[0]]=r)}n=s.exec(e)}t["%C2"]="�";for(var i=Object.keys(t),c=0;c<i.length;c++){var o=i[c];e=e.replace(new RegExp(o,"g"),t[o])}return e}(e)}}},970:function(e,t,n){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}}}]);