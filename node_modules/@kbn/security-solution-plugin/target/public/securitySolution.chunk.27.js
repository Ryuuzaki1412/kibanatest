/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[27,6,8,11,12,17],Array(111).concat([function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return i(t,e),t},s=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.z=void 0;const o=r(n(631));t.z=o,s(n(631),t),t.default=o},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(48),i=n(136),r=n.n(i);const s=e=>Object(a.useSelector)(e,a.shallowEqual),o=e=>Object(a.useSelector)(e,r.a)},function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"k",(function(){return A})),n.d(t,"d",(function(){return F})),n.d(t,"g",(function(){return N})),n.d(t,"l",(function(){return L})),n.d(t,"j",(function(){return q})),n.d(t,"e",(function(){return $})),n.d(t,"c",(function(){return U})),n.d(t,"m",(function(){return Z})),n.d(t,"i",(function(){return G})),n.d(t,"h",(function(){return Q})),n.d(t,"f",(function(){return W})),n.d(t,"n",(function(){return X})),n.d(t,"o",(function(){return te})),n.d(t,"b",(function(){return le}));var a=n(46),i=n(120),r=n(143),s=n(125);const o=Object(r.c)(a.array(a.string)),l=(a.intersection([a.type({eventId:a.string}),a.partial({pinnedEventId:Object(r.c)(a.string),timelineId:Object(r.c)(a.string)})]),a.intersection([a.type({timelineId:a.string,eventId:a.string}),a.partial({created:Object(r.c)(a.number),createdBy:Object(r.c)(a.string),updated:Object(r.c)(a.number),updatedBy:Object(r.c)(a.string)})])),u=a.intersection([a.type({pinnedEventId:a.string,version:a.string}),l,a.partial({timelineVersion:Object(r.c)(a.string)})]);var c=n(278);const d=a.exact(a.partial({id:a.string,rule_id:i.j,list_id:i.j,item_id:i.j})),p=a.exact(a.type({error:a.type({status_code:i.m,message:a.string})})),m=a.intersection([d,p]),f=a.intersection([a.type({timelineId:Object(r.c)(a.string)}),a.partial({eventId:Object(r.c)(a.string),note:Object(r.c)(a.string),created:Object(r.c)(a.number),createdBy:Object(r.c)(a.string),updated:Object(r.c)(a.number),updatedBy:Object(r.c)(a.string)})]),g=a.intersection([f,a.type({noteId:a.string,version:a.string}),a.partial({timelineVersion:Object(r.c)(a.string)})]),b=a.partial({aggregatable:Object(r.c)(a.boolean),category:Object(r.c)(a.string),columnHeaderType:Object(r.c)(a.string),description:Object(r.c)(a.string),example:Object(r.c)(a.string),indexes:Object(r.c)(a.array(a.string)),id:Object(r.c)(a.string),name:Object(r.c)(a.string),placeholder:Object(r.c)(a.string),searchable:Object(r.c)(a.boolean),type:Object(r.c)(a.string)}),y=a.partial({field:Object(r.c)(a.string),displayField:Object(r.c)(a.string),value:a.union([a.null,a.string,a.array(a.string)]),displayValue:Object(r.c)(a.string),operator:Object(r.c)(a.string)}),v=a.partial({id:Object(r.c)(a.string),name:Object(r.c)(a.string),enabled:Object(r.c)(a.boolean),excluded:Object(r.c)(a.boolean),kqlQuery:Object(r.c)(a.string),queryMatch:Object(r.c)(y)});let h;!function(e){e.default="default",e.template="template"}(h||(h={}));const E=a.union([a.literal(h.default),a.literal(h.template)]),x=a.partial({id:Object(r.c)(a.string),name:Object(r.c)(a.string),enabled:Object(r.c)(a.boolean),excluded:Object(r.c)(a.boolean),kqlQuery:Object(r.c)(a.string),queryMatch:Object(r.c)(y),and:Object(r.c)(a.array(v)),type:Object(r.c)(E)}),j=a.partial({alias:Object(r.c)(a.string),controlledBy:Object(r.c)(a.string),disabled:Object(r.c)(a.boolean),field:Object(r.c)(a.string),formattedValue:Object(r.c)(a.string),index:Object(r.c)(a.string),key:Object(r.c)(a.string),negate:Object(r.c)(a.boolean),params:Object(r.c)(a.string),type:Object(r.c)(a.string),value:Object(r.c)(a.string)}),O=a.partial({exists:Object(r.c)(a.string),meta:Object(r.c)(j),match_all:Object(r.c)(a.string),missing:Object(r.c)(a.string),query:Object(r.c)(a.string),range:Object(r.c)(a.string),script:Object(r.c)(a.string)}),S=a.partial({eventCategoryField:Object(r.c)(a.string),query:Object(r.c)(a.string),tiebreakerField:Object(r.c)(a.string),timestampField:Object(r.c)(a.string),size:Object(r.c)(a.union([a.string,a.number]))}),k=a.partial({kind:Object(r.c)(a.string),expression:Object(r.c)(a.string)}),w=a.partial({kuery:Object(r.c)(k),serializedQuery:Object(r.c)(a.string)}),T=a.partial({filterQuery:Object(r.c)(w)}),I=a.partial({start:Object(r.c)(a.union([a.string,a.number])),end:Object(r.c)(a.union([a.string,a.number]))}),C=a.partial({keySearch:Object(r.c)(a.string),favoriteDate:Object(r.c)(a.number),fullName:Object(r.c)(a.string),userName:Object(r.c)(a.string)}),M=a.partial({columnId:Object(r.c)(a.string),columnType:Object(r.c)(a.string),sortDirection:Object(r.c)(a.string)}),_=a.union([a.array(M),M]);let A;!function(e){e.active="active",e.draft="draft",e.immutable="immutable"}(A||(A={}));const P=a.union([a.literal(A.active),a.literal(A.draft),a.literal(A.immutable)]);let F;Object(r.c)(P),function(e){e.alert="alert",e.alerts="alerts",e.auditd="auditd",e.auditd_file="auditd_file",e.library="library",e.netflow="netflow",e.plain="plain",e.registry="registry",e.suricata="suricata",e.system="system",e.system_dns="system_dns",e.system_endgame_process="system_endgame_process",e.system_file="system_file",e.system_fim="system_fim",e.system_security_event="system_security_event",e.system_socket="system_socket",e.threat_match="threat_match",e.zeek="zeek"}(F||(F={}));const D=Object(r.b)(F,"RowRendererId");let N;!function(e){e.elastic="elastic",e.custom="custom"}(N||(N={}));const R=a.union([a.literal(N.elastic),a.literal(N.custom)]);let L;Object(r.c)(R),function(e){e.default="default",e.template="template"}(L||(L={}));const z=a.union([a.literal(L.template),a.literal(L.default)]),B=(Object(r.c)(z),a.partial({columns:Object(r.c)(a.array(b)),dataProviders:Object(r.c)(a.array(x)),dataViewId:Object(r.c)(a.string),description:Object(r.c)(a.string),eqlOptions:Object(r.c)(S),eventType:Object(r.c)(a.string),excludedRowRendererIds:Object(r.c)(a.array(D)),favorite:Object(r.c)(a.array(C)),filters:Object(r.c)(a.array(O)),indexNames:Object(r.c)(a.array(a.string)),kqlMode:Object(r.c)(a.string),kqlQuery:Object(r.c)(T),title:Object(r.c)(a.string),templateTimelineId:Object(r.c)(a.string),templateTimelineVersion:Object(r.c)(a.number),timelineType:Object(r.c)(z),dateRange:Object(r.c)(I),savedQueryId:Object(r.c)(a.string),sort:Object(r.c)(_),status:Object(r.c)(P),created:Object(r.c)(a.number),createdBy:Object(r.c)(a.string),updated:Object(r.c)(a.number),updatedBy:Object(r.c)(a.string),savedSearchId:Object(r.c)(a.string)})),q=a.intersection([B,a.type({savedObjectId:a.string,version:a.string}),a.partial({eventIdToNoteIds:a.array(g),noteIds:a.array(a.string),notes:a.array(g),pinnedEventIds:a.array(a.string),pinnedEventsSaveObject:a.array(u)})]),$=a.type({data:a.type({getOneTimeline:q})}),V=a.intersection([a.type({timeline:q,outcome:c.D}),a.partial({alias_target_id:c.C,alias_purpose:c.B})]),U=a.type({data:V}),H=a.type({timeline:a.array(q),totalCount:a.number}),Z=a.intersection([H,a.type({defaultTimelineCount:a.number,templateTimelineCount:a.number,elasticTemplateTimelineCount:a.number,customTemplateTimelineCount:a.number,favoriteCount:a.number})]),G=a.type({data:a.type({persistTimeline:a.intersection([a.partial({code:Object(r.c)(a.number),message:Object(r.c)(a.string)}),a.type({timeline:q})])})}),Q=a.union([a.type({status_code:a.number,message:a.string}),a.type({statusCode:a.number,message:a.string})]);let W;!function(e){e.title="title",e.description="description",e.updated="updated",e.created="created"}(W||(W={}));const K=a.union([a.literal(W.title),a.literal(W.description),a.literal(W.updated),a.literal(W.created)]),J=a.union([a.literal(s.b.asc),a.literal(s.b.desc)]),Y=a.type({sortField:K,sortOrder:J}),X=a.exact(a.type({success:a.boolean,success_count:i.m,timelines_installed:i.m,timelines_updated:i.m,errors:a.array(m)})),ee=a.partial({fullName:Object(r.c)(a.string),userName:Object(r.c)(a.string),favoriteDate:Object(r.c)(a.number)}),te=a.partial({savedObjectId:a.string,version:a.string,code:Object(r.c)(a.number),message:Object(r.c)(a.string),templateTimelineId:Object(r.c)(a.string),templateTimelineVersion:Object(r.c)(a.number),timelineType:Object(r.c)(z),favorite:Object(r.c)(a.array(ee))}),ne=a.type({pageIndex:a.number,pageSize:a.number}),ae=(a.partial({onlyUserFavorite:Object(r.c)(a.boolean),pageInfo:Object(r.c)(ne),search:Object(r.c)(a.string),sort:Object(r.c)(Y),status:Object(r.c)(P),timelineType:Object(r.c)(z)}),a.type({timelineType:z}),a.type({timelineType:z}),a.intersection([a.type({timeline:B}),a.partial({status:Object(r.c)(P),timelineId:Object(r.c)(a.string),templateTimelineId:Object(r.c)(a.string),templateTimelineVersion:Object(r.c)(a.number),timelineType:Object(r.c)(z),version:Object(r.c)(a.string)})]),a.partial({noteId:Object(r.c)(a.string)}),a.partial({searchIds:a.array(a.string)})),ie=a.type({savedObjectIds:a.array(a.string)}),re=(a.intersection([ie,ae]),a.type({file_name:a.string}),a.partial({ids:Object(r.c)(a.array(a.string))}),a.partial({template_timeline_id:a.string,id:a.string}),a.union([a.literal("true"),a.literal("false")])),se=(a.partial({only_user_favorite:Object(r.c)(re),page_index:Object(r.c)(a.string),page_size:Object(r.c)(a.string),search:Object(r.c)(a.string),sort_field:K,sort_order:J,status:Object(r.c)(P),timeline_type:Object(r.c)(z)}),Object(r.c)(a.array(f))),oe=Object(r.c)(a.array(f)),le=a.intersection([B,a.type({savedObjectId:Object(r.c)(a.string),version:Object(r.c)(a.string)}),a.type({globalNotes:oe,eventNotes:se,pinnedEventIds:o})]),ue=a.partial({_maxListeners:a.unknown,_readableState:a.unknown,_read:a.unknown,readable:a.boolean,_events:a.unknown,_eventsCount:a.number,_data:a.unknown,_position:a.number,_encoding:a.string}),ce=a.union([a.literal("true"),a.literal("false")]);a.intersection([a.type({file:a.intersection([ue,a.type({hapi:a.type({filename:a.string,headers:a.unknown})})])}),a.partial({isImmutable:ce})]),a.type({timeline:B,timelineId:Object(r.c)(a.string),version:Object(r.c)(a.string)}),a.type({timelineId:Object(r.c)(a.string),templateTimelineId:Object(r.c)(a.string),templateTimelineVersion:Object(r.c)(a.number),timelineType:Object(r.c)(z)}),a.intersection([a.type({note:f}),a.partial({overrideOwner:Object(r.c)(a.boolean),noteId:Object(r.c)(a.string),version:Object(r.c)(a.string)})]),a.type({timelinesToInstall:a.array(Object(r.c)(le)),timelinesToUpdate:a.array(Object(r.c)(le)),prepackagedTimelines:a.array(Object(r.c)(q))}),a.type({timeline:B,timelineIdToCopy:a.string})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=e=>Object(a.useCallback)(((t="")=>{if(e)return`${e}${t?`-${t}`:""}`}),[e])},function(e,t,n){"use strict";n.r(t),n.d(t,"SourcererScopeName",(function(){return i})),n.d(t,"initSourcererScope",(function(){return r})),n.d(t,"initDataView",(function(){return s})),n.d(t,"initialSourcererState",(function(){return o}));var a=n(58);let i;!function(e){e.default="default",e.detections="detections",e.timeline="timeline"}(i||(i={}));const r={loading:!1,selectedDataViewId:null,selectedPatterns:[],missingPatterns:[]},s={browserFields:a.EMPTY_BROWSER_FIELDS,id:"",indexFields:a.EMPTY_INDEX_FIELDS,fields:void 0,loading:!1,patternList:[],runtimeMappings:{},title:"",dataView:void 0},o={defaultDataView:s,kibanaDataViews:[],signalIndexName:null,sourcererScopes:{[i.default]:{...r,id:i.default},[i.detections]:{...r,id:i.detections},[i.timeline]:{...r,id:i.timeline}}}},,function(e,t,n){"use strict";var a=n(14);n.d(t,"a",(function(){return a}));var i=n(353);n.d(t,"b",(function(){return i}))},function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.global="global",e.timeline="timeline",e.socTrends="socTrends"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"c",(function(){return O})),n.d(t,"d",(function(){return S})),n.d(t,"a",(function(){return w})),n.d(t,"b",(function(){return I}));var a=n(2),i=n(48),r=n(5),s=n(49),o=n(149),l=n(116),u=n(213),c=n(118),d=n(4),p=n(151),m=n(112),f=n(392),g=n(117),b=n(477),y=n(334),v=n(241),h=n(157),E=n(218),x=n(295),j=n(110);const O=(e=l.SourcererScopeName.default)=>{const t=Object(i.useDispatch)(),{data:{dataViews:n}}=Object(j.i)().services,s=Object(a.useRef)(new AbortController),d=Object(a.useRef)(!0),v=Object(a.useRef)(!0),{loading:x,isSignalIndexExists:O,signalIndexName:k}=Object(u.c)(),w=Object(h.d)(E.a.sourcerer),T=Object(a.useMemo)((()=>o.d.getSourcererDataViewsSelector()),[]),{defaultDataView:I,signalIndexName:C}=Object(m.a)((e=>T(e))),{addError:M,addWarning:_}=Object(g.a)();Object(a.useEffect)((()=>{null!=I.error&&_({title:r.i18n.translate("xpack.securitySolution.sourcerer.permissions.title",{defaultMessage:"Write role required to generate data"}),text:r.i18n.translate("xpack.securitySolution.sourcerer.permissions.toastMessage",{defaultMessage:"Users with write permission need to access the Elastic Security app to initialize the app source data."})})}),[_,I.error]);const A=Object(a.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),P=Object(m.a)((e=>A(e,p.f.active))),F=Object(a.useMemo)((()=>o.d.getSourcererScopeSelector()),[]),{sourcererScope:{selectedDataViewId:D,selectedPatterns:N,missingPatterns:R}}=Object(m.a)((t=>F(t,e))),{selectedDataView:L,sourcererScope:{selectedDataViewId:z,selectedPatterns:B,missingPatterns:q}}=Object(m.a)((e=>F(e,l.SourcererScopeName.timeline))),{indexFieldsSearch:$}=Object(y.b)(),V=Object(a.useCallback)((n=>{null!=n?Object.keys(n).forEach((a=>{var i,r,s,u;a===l.SourcererScopeName.default&&e===l.SourcererScopeName.detections||t(o.a.setSelectedDataView({id:a,selectedDataViewId:null!==(i=null===(r=n[a])||void 0===r?void 0:r.id)&&void 0!==i?i:null,selectedPatterns:null!==(s=null===(u=n[a])||void 0===u?void 0:u.selectedPatterns)&&void 0!==s?s:[]}))})):D&&w({[l.SourcererScopeName.default]:{id:D,selectedPatterns:N}})}),[t,D,e,N,w]);Object(h.b)(E.a.sourcerer,V);const U=Object(a.useRef)([]);Object(a.useEffect)((()=>{[...new Set([D,z])].forEach(((e,t)=>{if(null!=e&&e.length>0&&!U.current.includes(e)){U.current=[...U.current,e];const n=0===t?l.SourcererScopeName.default:l.SourcererScopeName.timeline,a=e===D?0===N.length&&0===R.length:z===e&&0===q.length&&0===(null==L?void 0:L.patternList.length);$({dataViewId:e,scopeId:n,needToBeInit:a,...a&&n===l.SourcererScopeName.timeline?{skipScopeUpdate:B.length>0}:{}})}}))}),[$,R.length,D,N.length,z,q.length,L,B.length]),Object(a.useEffect)((()=>{!x&&null!=k&&null==C&&(null==P||null==P.savedObjectId)&&d.current&&I.id.length>0?(d.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:I.id,selectedPatterns:Object(f.b)(I,l.SourcererScopeName.timeline,k,!0)}))):null!=C&&(null==P||null==P.savedObjectId)&&d.current&&I.id.length>0&&(d.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.timeline,selectedDataViewId:I.id,selectedPatterns:Object(f.b)(I,l.SourcererScopeName.timeline,C,!0)})))}),[P,I,t,x,k,C]);const{dataViewId:H}=S(e),Z=Object(a.useCallback)((e=>{-1===I.title.indexOf(e)&&(s.current.abort(),(async a=>{s.current=new AbortController,t(o.a.setSourcererScopeLoading({loading:!0}));try{const i=await Object(b.a)({body:{patternList:a},signal:s.current.signal,dataViewService:n,dataViewId:H});null!=i&&i.defaultDataView.patternList.includes(e)&&($({dataViewId:i.defaultDataView.id}),t(o.a.setSourcererDataViews(i))),t(o.a.setSourcererScopeLoading({loading:!1}))}catch(e){"AbortError"===e.name||M(e,{title:r.i18n.translate("xpack.securitySolution.sourcerer.error.title",{defaultMessage:"Error updating Security Data View"}),toastMessage:r.i18n.translate("xpack.securitySolution.sourcerer.error.toastMessage",{defaultMessage:"Refresh the page"})}),t(o.a.setSourcererScopeLoading({loading:!1}))}})([...I.title.split(","),e]))}),[I.title,t,n,H,$,M]),G=Object(a.useCallback)((()=>{!x&&null!=k&&null==C&&I.id.length>0&&(Z(k),t(o.a.setSignalIndexName({signalIndexName:k})))}),[I.id.length,t,x,k,C,Z]);Object(a.useEffect)((()=>{G()}),[k]),Object(a.useEffect)((()=>{e===l.SourcererScopeName.detections&&O&&null!=k&&v.current&&I.id.length>0?(v.current=!1,t(o.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:I.id,selectedPatterns:Object(f.b)(I,l.SourcererScopeName.detections,k,!0)}))):e===l.SourcererScopeName.detections&&null!=C&&d.current&&I.id.length>0&&(v.current=!1,o.a.setSelectedDataView({id:l.SourcererScopeName.detections,selectedDataViewId:I.id,selectedPatterns:Object(f.b)(I,l.SourcererScopeName.detections,C,!0)}))}),[I,t,O,e,k,C])},S=(e=l.SourcererScopeName.default)=>{const{getDataViewsSelector:t,getSourcererDataViewSelector:n,getScopeSelector:i}=Object(a.useMemo)((()=>({getDataViewsSelector:o.d.getSourcererDataViewsSelector(),getSourcererDataViewSelector:o.d.sourcererDataViewSelector(),getScopeSelector:o.d.scopeIdSelector()})),[]),{defaultDataView:r,signalIndexName:s,selectedDataView:u,sourcererScope:{missingPatterns:c,selectedPatterns:d,loading:p}}=Object(m.a)((a=>{const r=i(a,e);return{...t(a),selectedDataView:n(a,r.selectedDataViewId),sourcererScope:r}})),g=Object(a.useMemo)((()=>Object(x.b)(d)),[d]),[b,h]=Object(a.useState)([]),[E,j]=Object(v.b)(b),O=Object(a.useMemo)((()=>{var e,t,n,a,i,r,s;return{...j,dataView:j.dataView,runtimeMappings:null!==(e=null===(t=j.dataView)||void 0===t?void 0:t.runtimeFieldMap)&&void 0!==e?e:{},title:null!==(n=null===(a=j.dataView)||void 0===a?void 0:a.title)&&void 0!==n?n:"",id:null!==(i=null===(r=j.dataView)||void 0===r?void 0:r.id)&&void 0!==i?i:null,loading:E,patternList:j.indexes,indexFields:j.indexPatterns.fields,fields:null===(s=j.dataView)||void 0===s?void 0:s.fields}}),[j,E]);Object(a.useEffect)((()=>{null==u||c.length>0?h(g):h([])}),[c,u,g]);const S=Object(a.useMemo)((()=>null==u||c.length>0?O:u),[O,c.length,u]),k=Object(a.useMemo)((()=>!(!p&&!S.loading)||Object(f.a)({scopeId:e,signalIndexName:s,patternList:S.patternList,isDefaultDataViewSelected:S.id===r.id})),[r.id,p,e,s,S.id,S.loading,S.patternList]),w=Object(a.useCallback)((()=>{const{browserFields:e}=Object(y.a)(S.patternList.join(","),S.fields);return e}),[S.fields,S.patternList]);return Object(a.useMemo)((()=>({browserFields:w(),dataViewId:S.id,indexPattern:{fields:S.indexFields,title:g.join(","),getName:()=>g.join(",")},indicesExist:k,loading:p||S.loading,runtimeMappings:S.runtimeMappings,patternList:S.title.split(","),selectedPatterns:g,...b.length>0?{activePatterns:S.patternList}:{},sourcererDataView:S.dataView})),[w,S,g,k,p,b.length])},k=[d.d,`${d.oc}/id/:id`,`${d.s}/:detailName`],w=e=>null==Object(s.matchPath)(e,{path:k,strict:!1})?l.SourcererScopeName.default:l.SourcererScopeName.detections,T=[d.d,d.v,`${d.oc}/id/:id`,d.Ab,d.Lc,d.Ob,d.Wb],I=e=>null!=Object(s.matchPath)(e,{path:T,strict:!1})},function(e,t,n){"use strict";n.d(t,"b",(function(){return a.IS_OPERATOR})),n.d(t,"a",(function(){return a.EXISTS_OPERATOR})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r}));var a=n(58);let i,r;!function(e){e.query="query",e.graph="graph",e.notes="notes",e.pinned="pinned",e.eql="eql",e.session="session",e.securityAssistant="securityAssistant",e.esql="esql"}(i||(i={})),function(e){e.active="timeline-1",e.casePage="timeline-case",e.test="timeline-test"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var a=n(45),i=n(2),r=n.n(i),s=n(704),o=n(168),l=n(492),u=n(249),c=n(250);const d=[{id:"default-system-prompt",content:c.b,name:c.a,promptType:"system"},{id:"CB9FA555-B59F-4F71-AFF9-8A891AC5BC28",content:c.d,name:c.c,promptType:"system"}],p={alerts:!1,assistantLangChain:!1,latestAlerts:20};var m=n(259),f=n(13);const g=r.a.createContext(void 0),b=({actionTypeRegistry:e,alertsIndexPattern:t,assistantAvailability:n,assistantStreamingEnabled:r=!1,assistantTelemetry:c,augmentMessageCodeBlocks:b,baseAllow:y,baseAllowReplacement:v,defaultAllow:h,defaultAllowReplacement:E,docLinks:x,basePath:j,basePromptContexts:O=[],baseQuickPrompts:S=[],baseSystemPrompts:k=d,children:w,getComments:T,http:I,getInitialConversations:C,modelEvaluatorEnabled:M=!1,nameSpace:_="elasticAssistantDefault",setConversations:A,setDefaultAllow:P,setDefaultAllowReplacement:F,title:D=u.c,toasts:N})=>{const[R,L]=Object(s.useLocalStorage)(`${_}.quickPrompts`,S),[z,B]=Object(s.useLocalStorage)(`${_}.systemPrompts`,k),[q,$]=Object(s.useLocalStorage)(`${_}.lastConversationId`),[V,U]=Object(s.useLocalStorage)(`${_}.knowledgeBase`,p),[H,Z]=Object(i.useState)({}),G=Object(i.useCallback)((e=>{Z((t=>null!=e&&null==t[e.id]?Object(l.b)({prevPromptContexts:t,promptContext:e}):t))}),[]),Q=Object(i.useCallback)((e=>Z((t=>null==t[e]?t:Object(a.omit)(e,t)))),[]),[W,K]=Object(i.useState)((e=>{})),[J,Y]=Object(i.useState)(m.b),[X,ee]=Object(i.useState)(C()),te=Object(i.useMemo)((()=>Object.keys(X).sort()),[X]);Object(i.useEffect)((()=>{ee(C())}),[C]);const ne=Object(i.useCallback)((e=>{if("function"==typeof e){const t=e;ee((e=>{const n=t(e);return A(n),n}))}else A(e),ee(e)}),[A]),ae=Object(i.useCallback)((e=>{var t;return null!==(t=null!=e?e:q)&&void 0!==t?t:o.d}),[q]),ie=Object(i.useMemo)((()=>({actionTypeRegistry:e,alertsIndexPattern:t,assistantAvailability:n,assistantStreamingEnabled:r,assistantTelemetry:c,augmentMessageCodeBlocks:b,allQuickPrompts:null!=R?R:[],allSystemPrompts:null!=z?z:[],baseAllow:Object(a.uniq)(y),baseAllowReplacement:Object(a.uniq)(v),basePath:j,basePromptContexts:O,baseQuickPrompts:S,baseSystemPrompts:k,conversationIds:te,conversations:X,defaultAllow:Object(a.uniq)(h),defaultAllowReplacement:Object(a.uniq)(E),docLinks:x,getComments:T,http:I,knowledgeBase:null!=V?V:p,modelEvaluatorEnabled:M,promptContexts:H,nameSpace:_,registerPromptContext:G,selectedSettingsTab:J,setAllQuickPrompts:L,setAllSystemPrompts:B,setConversations:ne,setDefaultAllow:P,setDefaultAllowReplacement:F,setKnowledgeBase:U,setSelectedSettingsTab:Y,setShowAssistantOverlay:K,showAssistantOverlay:W,title:D,toasts:N,unRegisterPromptContext:Q,getConversationId:ae,setLastConversationId:$})),[e,t,n,r,c,b,y,v,j,O,S,k,te,X,h,E,x,T,I,V,ae,R,z,M,_,ne,H,G,J,P,F,U,$,L,B,W,D,N,Q]);return Object(f.jsx)(g.Provider,{value:ie},w)},y=()=>{const e=r.a.useContext(g);if(null==e)throw new Error("useAssistantContext must be used within a AssistantProvider");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return Me})),n.d(t,"h",(function(){return a})),n.d(t,"j",(function(){return i})),n.d(t,"o",(function(){return xe})),n.d(t,"i",(function(){return Ke})),n.d(t,"q",(function(){return M})),n.d(t,"k",(function(){return I})),n.d(t,"l",(function(){return C})),n.d(t,"b",(function(){return h.Direction})),n.d(t,"r",(function(){return O})),n.d(t,"c",(function(){return w})),n.d(t,"f",(function(){return k})),n.d(t,"e",(function(){return x})),n.d(t,"d",(function(){return j})),n.d(t,"m",(function(){return R})),n.d(t,"g",(function(){return q})),n.d(t,"p",(function(){return L})),n.d(t,"n",(function(){return Se}));var a={};n.r(a),n.d(a,"createDataTable",(function(){return H})),n.d(a,"upsertColumn",(function(){return Z})),n.d(a,"applyDeltaToColumnWidth",(function(){return G})),n.d(a,"updateColumnOrder",(function(){return Q})),n.d(a,"updateColumnWidth",(function(){return W})),n.d(a,"toggleDetailPanel",(function(){return K})),n.d(a,"removeColumn",(function(){return J})),n.d(a,"updateIsLoading",(function(){return Y})),n.d(a,"updateColumns",(function(){return X})),n.d(a,"updateItemsPerPage",(function(){return ee})),n.d(a,"updateItemsPerPageOptions",(function(){return te})),n.d(a,"updateSort",(function(){return ne})),n.d(a,"setSelected",(function(){return ae})),n.d(a,"clearSelected",(function(){return ie})),n.d(a,"setEventsLoading",(function(){return re})),n.d(a,"clearEventsLoading",(function(){return se})),n.d(a,"setEventsDeleted",(function(){return oe})),n.d(a,"clearEventsDeleted",(function(){return le})),n.d(a,"initializeDataTableSettings",(function(){return ue})),n.d(a,"setDataTableSelectAll",(function(){return ce})),n.d(a,"updateGraphEventId",(function(){return de})),n.d(a,"updateSessionViewConfig",(function(){return pe})),n.d(a,"setTableUpdatedAt",(function(){return me})),n.d(a,"updateTotalCount",(function(){return fe})),n.d(a,"changeViewMode",(function(){return ge})),n.d(a,"updateShowBuildingBlockAlertsFilter",(function(){return be})),n.d(a,"updateShowThreatIndicatorAlertsFilter",(function(){return ye}));var i={};n.r(i),n.d(i,"tableByIdSelector",(function(){return he})),n.d(i,"getTableByIdSelector",(function(){return xe})),n.d(i,"getManageDataTableById",(function(){return Oe}));var r=n(23),s=n.n(r),o=n(17),l=n(45),u=n(234),c=n.n(u),d=n(2),p=n.n(d),m=n(48),f=n(44),g=n.n(f),b=n(5),y=n(320);const v=180;var h=n(58),E=n(46);let x,j;!function(e){e.usersPageEvents="users-page-events",e.hostsPageEvents="hosts-page-events",e.networkPageEvents="network-page-events",e.hostsPageSessions="hosts-page-sessions-v2",e.alertsOnRuleDetailsPage="alerts-rules-details-page",e.alertsOnAlertsPage="alerts-page",e.test="table-test",e.alternateTest="alternateTest",e.rulePreview="rule-preview",e.kubernetesPageSessions="kubernetes-page-sessions",e.alertsOnCasePage="alerts-case-page",e.alertsRiskInputs="alerts-risk-inputs",e.riskInputs="risk-inputs"}(x||(x={})),function(e){e.alert="alert",e.event="event",e.session="session"}(j||(j={}));const O={[x.alertsOnAlertsPage]:j.alert,[x.alertsOnCasePage]:j.alert,[x.alertsOnRuleDetailsPage]:j.alert,[x.hostsPageEvents]:j.event,[x.networkPageEvents]:j.event,[x.usersPageEvents]:j.event,[x.test]:j.event,[x.alternateTest]:j.event,[x.rulePreview]:j.event,[x.hostsPageSessions]:j.session,[x.kubernetesPageSessions]:j.session,[x.alertsRiskInputs]:j.alert,[x.riskInputs]:j.alert};let S,k;E.union([E.literal(x.usersPageEvents),E.literal(x.hostsPageEvents),E.literal(x.networkPageEvents),E.literal(x.hostsPageSessions),E.literal(x.alertsOnRuleDetailsPage),E.literal(x.alertsOnAlertsPage),E.literal(x.test),E.literal(x.rulePreview),E.literal(x.kubernetesPageSessions),E.literal(x.alertsOnCasePage),E.literal(x.alertsRiskInputs)]),function(e){e.destination="destination",e.source="source"}(S||(S={})),function(e){e.query="query",e.graph="graph",e.notes="notes",e.pinned="pinned",e.eql="eql",e.session="session"}(k||(k={}));const w="open",T=b.i18n.translate("securitySolutionPackages.dataTable.loadingEventsDataLabel",{defaultMessage:"Loading Events"}),I="not-filtered",C=[{columnHeaderType:I,id:"@timestamp",initialWidth:190,esTypes:["date"],type:"date"},{columnHeaderType:I,id:"message",initialWidth:v},{columnHeaderType:I,id:"event.category",initialWidth:v},{columnHeaderType:I,id:"event.action",initialWidth:v},{columnHeaderType:I,id:"host.name",initialWidth:v},{columnHeaderType:I,id:"source.ip",initialWidth:v},{columnHeaderType:I,id:"destination.ip",initialWidth:v},{columnHeaderType:I,id:"user.name",initialWidth:v}],M={defaultColumns:C,dataViewId:null,deletedEventIds:[],expandedDetail:{},filters:[],indexNames:[],isSelectAllChecked:!1,isLoading:!1,itemsPerPage:25,itemsPerPageOptions:[10,25,50,100],loadingEventIds:[],selectedEventIds:{},showCheckboxes:!1,sort:[{columnId:"@timestamp",columnType:"date",esTypes:["date"],sortDirection:"desc"}],selectAll:!1,graphEventId:"",sessionViewConfig:null,columns:C,queryFields:[],title:"",totalCount:0,viewMode:"gridView",additionalFilters:{showBuildingBlockAlerts:!1,showOnlyThreatIndicatorAlerts:!1}},_=e=>({defaultColumns:C,loadingText:T,documentType:"",selectAll:!1,id:e,isLoading:!1,queryFields:[],title:"",unit:e=>{return t=e,b.i18n.translate("securitySolutionPackages.dataTable.unit",{values:{totalCount:t},defaultMessage:"{totalCount, plural, =1 {alert} other {alerts}}"});var t},graphEventId:""});var A=n(13);const P={showSortAsc:!0,showSortDesc:!0,showHide:!1},F=({browserField:e,fieldName:t})=>{var n;const a=null!==(n=null==e?void 0:e.aggregatable)&&void 0!==n&&n;return["kibana.alert.ancestors.depth","kibana.alert.ancestors.id","kibana.alert.ancestors.rule","kibana.alert.ancestors.type","kibana.alert.original_event.action","kibana.alert.original_event.category","kibana.alert.original_event.code","kibana.alert.original_event.created","kibana.alert.original_event.dataset","kibana.alert.original_event.duration","kibana.alert.original_event.end","kibana.alert.original_event.hash","kibana.alert.original_event.id","kibana.alert.original_event.kind","kibana.alert.original_event.module","kibana.alert.original_event.original","kibana.alert.original_event.outcome","kibana.alert.original_event.provider","kibana.alert.original_event.risk_score","kibana.alert.original_event.risk_score_norm","kibana.alert.original_event.sequence","kibana.alert.original_event.severity","kibana.alert.original_event.start","kibana.alert.original_event.timezone","kibana.alert.original_event.type","kibana.alert.original_time","kibana.alert.reason","kibana.alert.rule.created_by","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.false_positives","kibana.alert.rule.from","kibana.alert.rule.uuid","kibana.alert.rule.immutable","kibana.alert.rule.interval","kibana.alert.rule.max_signals","kibana.alert.rule.name","kibana.alert.rule.note","kibana.alert.rule.references","kibana.alert.risk_score","kibana.alert.rule.rule_id","kibana.alert.severity","kibana.alert.rule.size","kibana.alert.rule.tags","kibana.alert.rule.threat","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.timeline_id","kibana.alert.rule.timeline_title","kibana.alert.rule.to","kibana.alert.rule.type","kibana.alert.rule.updated_by","kibana.alert.rule.version","kibana.alert.workflow_status"].includes(t)||a},D=e=>{switch(e){case"date":case"date_nanos":return"datetime";case"double":case"long":case"number":return"numeric";case"object":return"json";case"boolean":return"boolean";default:return}},N=[{columnHeaderType:I,id:"@timestamp",displayAsText:b.i18n.translate("securitySolutionPackages.dataTable.eventRenderedView.timestampTitle.column",{defaultMessage:"Timestamp"}),initialWidth:240,actions:!1,isExpandable:!1,isResizable:!1},{columnHeaderType:I,displayAsText:b.i18n.translate("securitySolutionPackages.dataTable.eventRenderedView.ruleTitle.column",{defaultMessage:"Rule"}),id:"kibana.alert.rule.name",initialWidth:230,linkField:"kibana.alert.rule.uuid",actions:!1,isExpandable:!1,isResizable:!1},{columnHeaderType:I,id:"eventSummary",displayAsText:b.i18n.translate("securitySolutionPackages.dataTable.eventRenderedView.eventSummary.column",{defaultMessage:"Event Summary"}),actions:!1,isExpandable:!1,isResizable:!1}],R=(e,t,n,a)=>e.reduce(((e,i)=>({...e,...a&&t.includes(i._id)?{[i._id]:i.data.filter((e=>n.includes(e.field)))}:{}})),{}),L=e=>{var t,n;return!Object(l.isEmpty)(null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n?void 0:n.building_block_type)},z=e=>{switch(e){case"asc":case"desc":return e;default:return"desc"}},B=({columns:e,columnHeaders:t})=>e.map((({id:e,direction:n})=>{var a,i;const r=t.find((t=>t.id===e)),s=null!==(a=null==r?void 0:r.type)&&void 0!==a?a:"",o=null!==(i=null==r?void 0:r.esTypes)&&void 0!==i?i:[];return{columnId:e,columnType:s,esTypes:o,sortDirection:n}})),q=(e,t,n,a)=>{const i=null!=a?a:{};L(e)?n({style:{...i,backgroundColor:`${t.eui.euiColorHighlight}`}}):n({style:{...i,backgroundColor:"inherit"}})},$=b.i18n.translate("securitySolutionPackages.dataTable.columnHeaders.flyout.pane.removeColumnButtonLabel",{defaultMessage:"Remove column"});var V=n(26);const U=n.n(V)()("x-pack/security_solution/data-table"),H=U("CREATE_DATA_TABLE"),Z=U("UPSERT_COLUMN"),G=U("APPLY_DELTA_TO_COLUMN_WIDTH"),Q=U("UPDATE_COLUMN_ORDER"),W=U("UPDATE_COLUMN_WIDTH"),K=U("TOGGLE_DETAIL_PANEL"),J=U("REMOVE_COLUMN"),Y=U("UPDATE_LOADING"),X=U("UPDATE_COLUMNS"),ee=U("UPDATE_ITEMS_PER_PAGE"),te=U("UPDATE_ITEMS_PER_PAGE_OPTIONS"),ne=U("UPDATE_SORT"),ae=U("SET_DATA_TABLE_SELECTED"),ie=U("CLEAR_DATA_TABLE_SELECTED"),re=U("SET_DATA_TABLE_EVENTS_LOADING"),se=U("CLEAR_DATA_TABLE_EVENTS_LOADING"),oe=U("SET_DATA_TABLE_EVENTS_DELETED"),le=U("CLEAR_DATA_TABLE_EVENTS_DELETED"),ue=U("INITIALIZE_DATA_TABLE"),ce=U("SET_DATA_TABLE_SELECT_ALL"),de=U("UPDATE_DATA_TABLE_GRAPH_EVENT_ID"),pe=U("UPDATE_DATA_TABLE_SESSION_VIEW_CONFIG"),me=U("SET_TABLE_UPDATED_AT"),fe=U("UPDATE_TOTAL_COUNT"),ge=U("CHANGE_ALERT_TABLE_VIEW_MODE"),be=U("UPDATE_BUILDING_BLOCK_ALERTS_FILTER"),ye=U("UPDATE_SHOW_THREAT_INDICATOR_ALERTS_FILTER");var ve=n(57);const he=Object(ve.createSelector)((e=>e.dataTable.tableById),(e=>e)),Ee=(e,t)=>e.dataTable.tableById[t],xe=()=>Object(ve.createSelector)(Ee,(e=>e)),je=(e,t)=>{return Object(l.getOr)(Object(l.getOr)((n=t,{...M,..._(n)}),["tableById",t],e),["dataTable","tableById",t],e);var n},Oe=()=>Object(ve.createSelector)(je,(({dataViewId:e,defaultColumns:t,isLoading:n,loadingText:a,queryFields:i,title:r,selectAll:s,graphEventId:o})=>({dataViewId:e,defaultColumns:t,isLoading:n,loadingText:a,queryFields:i,title:r,selectAll:s,graphEventId:o}))),Se=(e,t)=>e%t,ke=g.a.span`
  font-size: ${({theme:e})=>e.eui.euiFontSizeXS};
  font-weight: ${({theme:e})=>e.eui.euiFontWeightSemiBold};
  border-right: ${({theme:e})=>e.eui.euiBorderThin};
  margin-right: ${({theme:e})=>e.eui.euiSizeS};
  padding-right: ${({theme:e})=>e.eui.euiSizeM};
`,we=b.i18n.translate("securitySolutionPackages.dataTable.ariaLabel",{defaultMessage:"Alerts"}),Te=(e=!1)=>({border:"none",fontSize:"s",header:"underline",stripes:!0===e}),Ie=g.a.div`
  ul.euiPagination__list {
    li.euiPagination__item:last-child {
      ${({hideLastPage:e})=>e?"display:none":""};
    }
  }
  div .euiDataGridRowCell__contentWrapper {
    display: flex;
    align-items: center;
  }
  div .euiDataGridRowCell--lastColumn .euiDataGridRowCell__content {
    flex-grow: 0;
    width: 100%;
  }
  div .siemEventsTable__trSupplement--summary {
    display: block;
  }
`,Ce=c()(((e,t,n)=>{const a=(e=>Object(l.keyBy)("name",(e=>Object.values(e).reduce(((e,t)=>[...e,...Object.values(null!=t.fields?t.fields:{})]),[]))(e)))(t),i=n?N:e;return i?i.map((e=>{var t,n,i,r;const s=a[e.id],o={...e,...s,schema:null!==(t=e.schema)&&void 0!==t?t:D(null==s?void 0:s.type)},l=Object(A.jsx)(p.a.Fragment,null,null!==(n=null!==(i=e.display)&&void 0!==i?i:e.displayAsText)&&void 0!==n?n:e.id);return{...o,actions:null!==(r=e.actions)&&void 0!==r?r:P,defaultSortDirection:"desc",display:Object(A.jsx)(p.a.Fragment,null,l),isSortable:F({browserField:s,fieldName:e.id})}})):[]})),Me=p.a.memo((({additionalControls:e,browserFields:t,bulkActions:n=!0,data:r,fieldBrowserOptions:u,hasCrudPermissions:c,id:g,leadingControlColumns:b,loadPage:h,renderCellValue:E,rowRenderers:x,pagination:j,unitCountText:O,totalItems:S,rowHeightsOptions:k,isEventRenderedView:w=!1,getFieldBrowser:T,getFieldSpec:C,cellActionsTriggerId:_,...P})=>{const F=i.getTableByIdSelector(),D=(N=e=>{var t;return null!==(t=F(e,g))&&void 0!==t?t:M},Object(m.useSelector)(N,m.shallowEqual));var N;const{columns:R,selectedEventIds:L,showCheckboxes:V,sort:U,isLoading:H,defaultColumns:Z}=D,G=Ce(R,t,w),Q=Object(d.useRef)(null),W=Object(m.useDispatch)(),K=Object(d.useMemo)((()=>Object.keys(L).length),[L]),J=Object(d.useContext)(f.ThemeContext),Y=Object(d.useMemo)((()=>{var e,t;return!!c&&!(0===K||!V)&&("boolean"==typeof n?n:null===(e=(null==n||null===(t=n.customBulkActions)||void 0===t?void 0:t.length)||(null==n?void 0:n.alertStatusActions))||void 0===e||e)}),[c,K,V,n]),X=Object(d.useCallback)((()=>{W(a.updateColumns({id:g,columns:Z}))}),[Z,W,g]),ee=Object(d.useCallback)((e=>{var t,n,i;G.some((({id:t})=>e===t))?W(a.removeColumn({columnId:e,id:g})):W(a.upsertColumn({column:(t=e,n=Z,{columnHeaderType:I,id:t,initialWidth:v,...null!==(i=n.find((e=>e.id===t)))&&void 0!==i?i:{}}),id:g,index:1}))}),[G,W,g,Z]),te=Object(d.useMemo)((()=>({additionalControls:{left:{append:Object(A.jsx)(p.a.Fragment,null,H&&Object(A.jsx)(o.EuiProgress,{size:"xs",position:"absolute",color:"accent"}),Object(A.jsx)(ke,{"data-test-subj":"server-side-event-count"},O),null!=e?e:null,w?Object(A.jsx)(p.a.Fragment,null):T({browserFields:t,options:u,columnIds:G.map((({id:e})=>e)),onResetColumns:X,onToggleColumn:ee}))}},...Y||w?{showColumnSelector:!1,showSortSelector:!1,showFullScreenSelector:!1}:{showColumnSelector:{allowHide:!1,allowReorder:!0},showSortSelector:!0,showFullScreenSelector:!0},showDisplaySelector:!1})),[H,O,e,w,T,t,u,G,X,ee,Y]),ne=Object(d.useMemo)((()=>U.map((e=>({id:e.columnId,direction:z(e.sortDirection)})))),[U]),ae=Object(d.useCallback)((e=>{W(a.updateSort({id:g,sort:B({columns:e,columnHeaders:G})})),setTimeout((()=>{null!=h&&h(0)}),0)}),[G,W,g,h]),ie=Object(d.useMemo)((()=>G.map((({id:e})=>e))),[G]),re=Object(d.useCallback)((({columnId:e,width:t})=>{W(a.updateColumnWidth({columnId:e,id:g,width:t}))}),[W,g]),se=Object(d.useCallback)((e=>{W(a.updateColumnOrder({columnIds:e,id:g}))}),[W,g]),oe=Object(d.useMemo)((()=>({scopeId:g})),[g]),le=Object(d.useMemo)((()=>_?G.map((e=>{var t;return null!==(t=C(e.id))&&void 0!==t?t:{name:e.id,type:"",aggregatable:!1,searchable:!1}})):void 0),[_,G,C]),ue=Object(d.useCallback)(((e,t)=>{var n;const a=t%r.length;return null===(n=r[a].data.find((t=>t.field===e)))||void 0===n?void 0:n.value}),[r]),ce=Object(y.j)({triggerId:_,fields:le,getCellValue:ue,metadata:oe,dataGridRef:Q}),de=Object(d.useMemo)((()=>G.map(((e,t)=>{var n;return{...e,actions:{...e.actions,additional:[{iconType:"cross",label:$,onClick:()=>{W(a.removeColumn({id:g,columnId:e.id}))},size:"xs"}]},cellActions:null!==(n=ce[t])&&void 0!==n?n:[],visibleCellActions:3}}))),[G,ce,W,g]),pe=Object(d.useMemo)((()=>({columnId:e,rowIndex:n,colIndex:a,setCellProps:i,isDetails:s})=>{var o;const u=Se(n,j.pageSize),c=u<r.length?r[u].data:null,p=G.find((t=>t.id===e)),m=u<r.length?r[u]._id:null,f=u<r.length?r[u].ecs:null;return Object(d.useEffect)((()=>{const e={overflow:"hidden"};i({style:{...e}}),f&&c?q(f,J,i,e):i({style:{display:"none"}})}),[n,i,f,c]),null==c||null==p||null==m||null===f?null:E({asPlainText:!1,browserFields:t,columnId:p.id,data:c,ecsData:f,eventId:m,header:p,isDetails:s,isDraggable:!1,isExpandable:!0,isExpanded:!1,linkValues:Object(l.getOr)([],null!==(o=p.linkField)&&void 0!==o?o:"",f),rowIndex:n,colIndex:a,rowRenderers:x,setCellProps:i,scopeId:g,truncate:!s})}),[t,G,r,g,j.pageSize,E,x,J]);return Object(A.jsx)(p.a.Fragment,null,Object(A.jsx)(Ie,{hideLastPage:S>9999},Object(A.jsx)(o.EuiDataGrid,s()({},P,{id:"body-data-grid","data-test-subj":"body-data-grid","aria-label":we,columns:w?G:de,columnVisibility:{visibleColumns:ie,setVisibleColumns:se},gridStyle:Te(w),leadingControlColumns:b,toolbarVisibility:te,rowCount:S,renderCellValue:pe,sorting:{columns:ne,onSort:ae},onColumnResize:re,pagination:j,ref:Q,rowHeightsOptions:k}))))}));var _e=n(187),Ae=n(9);const Pe=({id:e,tableById:t,...n})=>{const a=t[e];return{...t,[e]:{...a,...M,...n,isLoading:!1}}},Fe=({column:e,id:t,index:n,tableById:a})=>{const i=a[t];if(-1!==i.columns.findIndex((t=>t.id===e.id))){const r=i.columns.filter((t=>t.id!==e.id));return r.splice(n,0,e),{...a,[t]:{...i,columns:r}}}const r=[...i.columns];return r.splice(n,0,e),{...a,[t]:{...i,columns:r}}},De=({id:e,columnId:t,tableById:n})=>{const a=n[e],i=a.columns.filter((e=>e.id!==t));return{...n,[e]:{...a,columns:i}}},Ne=({id:e,tableById:t,dataTableSettingsProps:n})=>{var a;const i=t[e];return null!=i&&i.initialized?t:{...t,[e]:{...M,..._(e),...i,...n,...!i||Object(Ae.isEmpty)(i.columns)&&!Object(Ae.isEmpty)(n.defaultColumns)?{columns:n.defaultColumns}:{},sort:null!==(a=n.sort)&&void 0!==a?a:M.sort,loadingEventIds:M.loadingEventIds,initialized:!0}}},Re=({id:e,columnId:t,delta:n,tableById:a})=>{var i;const r=a[e],s=r.columns.findIndex((e=>e.id===t));if(-1===s)return{...a,[e]:{...r}};const o=(null!==(i=r.columns[s].initialWidth)&&void 0!==i?i:v)+n,l=Math.max(70,o),u={...r.columns[s],initialWidth:l},c=[...r.columns.slice(0,s),u,...r.columns.slice(s+1)];return{...a,[e]:{...r,columns:c}}},Le=({columnIds:e,id:t,tableById:n})=>{const a=n[t],i=e.reduce(((e,t)=>{const n=a.columns.findIndex((e=>e.id===t));return-1!==n?[...e,a.columns[n]]:e}),[]);return{...n,[t]:{...a,columns:i}}},ze=({columnId:e,id:t,tableById:n,width:a})=>{const i=n[t],r=i.columns.map((t=>({...t,initialWidth:t.id===e?a:t.initialWidth})));return{...n,[t]:{...i,columns:r}}},Be=({id:e,columns:t,tableById:n})=>{const a=n[e];return{...n,[e]:{...a,columns:t}}},qe=({id:e,sort:t,tableById:n})=>{const a=n[e];return{...n,[e]:{...a,sort:t}}},$e=({id:e,itemsPerPage:t,tableById:n})=>{const a=n[e];return{...n,[e]:{...a,itemsPerPage:t}}},Ve=({id:e,itemsPerPageOptions:t,tableById:n})=>{const a=n[e];return{...n,[e]:{...a,itemsPerPageOptions:t}}},Ue=({id:e,eventIds:t,isDeleted:n,tableById:a})=>{const i=a[e],r=n?Object(l.union)(i.deletedEventIds,t):i.deletedEventIds.filter((e=>!t.includes(e))),s=Object.fromEntries(Object.entries(i.selectedEventIds).filter((([e])=>!r.includes(e)))),o=Object.keys(s).length>0&&i.isSelectAllChecked;return{...a,[e]:{...i,deletedEventIds:r,selectedEventIds:s,isSelectAllChecked:o}}},He=({id:e,eventIds:t,isLoading:n,tableById:a})=>{const i=a[e],r=n?Object(l.union)(i.loadingEventIds,t):i.loadingEventIds.filter((e=>!t.includes(e)));return{...a,[e]:{...i,loadingEventIds:r}}},Ze=({id:e,eventIds:t,isSelectAllChecked:n=!1,isSelected:a,tableById:i})=>{const r=i[e],s=a?{...r.selectedEventIds,...t}:Object(l.omit)(Object.keys(t),r.selectedEventIds);return{...i,[e]:{...r,selectedEventIds:s,isSelectAllChecked:n}}},Ge=e=>{var t;const{tabType:n,id:a,...i}=e,r=new Set(["eventDetail","hostDetail","networkDetail","userDetail"]),s=null!=n?n:"query",o={params:i.params?{...i.params}:{},panelView:i.panelView};return{[s]:r.has(null!==(t=i.panelView)&&void 0!==t?t:"")?o:{}}},Qe=({id:e,graphEventId:t,tableById:n})=>{const a=n[e];return{...n,[e]:{...a,graphEventId:t}}},We=({id:e,sessionViewConfig:t,tableById:n})=>{const a=n[e];return{...n,[e]:{...a,sessionViewConfig:t}}},Ke=Object(_e.reducerWithInitialState)({tableById:{}}).case(Z,((e,{column:t,id:n,index:a})=>({...e,tableById:Fe({column:t,id:n,index:a,tableById:e.tableById})}))).case(H,((e,t)=>({...e,tableById:Pe({...t,tableById:e.tableById})}))).case(ue,((e,{id:t,...n})=>({...e,tableById:Ne({id:t,tableById:e.tableById,dataTableSettingsProps:n})}))).case(K,((e,t)=>{var n;return{...e,tableById:{...e.tableById,[t.id]:{...e.tableById[t.id],expandedDetail:{...null===(n=e.tableById[t.id])||void 0===n?void 0:n.expandedDetail,...Ge(t)}}}}})).case(G,((e,{id:t,columnId:n,delta:a})=>({...e,tableById:Re({id:t,columnId:n,delta:a,tableById:e.tableById})}))).case(Q,((e,{id:t,columnIds:n})=>({...e,tableById:Le({columnIds:n,id:t,tableById:e.tableById})}))).case(W,((e,{id:t,columnId:n,width:a})=>({...e,tableById:ze({columnId:n,id:t,tableById:e.tableById,width:a})}))).case(J,((e,{id:t,columnId:n})=>({...e,tableById:De({id:t,columnId:n,tableById:e.tableById})}))).case(oe,((e,{id:t,eventIds:n,isDeleted:a})=>({...e,tableById:Ue({id:t,eventIds:n,tableById:e.tableById,isDeleted:a})}))).case(le,((e,{id:t})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],deletedEventIds:[]}}}))).case(re,((e,{id:t,eventIds:n,isLoading:a})=>({...e,tableById:He({id:t,eventIds:n,tableById:e.tableById,isLoading:a})}))).case(se,((e,{id:t})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],loadingEventIds:[]}}}))).case(ae,((e,{id:t,eventIds:n,isSelected:a,isSelectAllChecked:i})=>({...e,tableById:Ze({id:t,eventIds:n,tableById:e.tableById,isSelected:a,isSelectAllChecked:i})}))).case(ie,((e,{id:t})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],selectedEventIds:{},isSelectAllChecked:!1}}}))).case(Y,((e,{id:t,isLoading:n})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],isLoading:n}}}))).case(X,((e,{id:t,columns:n})=>({...e,tableById:Be({id:t,columns:n,tableById:e.tableById})}))).case(ne,((e,{id:t,sort:n})=>({...e,tableById:qe({id:t,sort:n,tableById:e.tableById})}))).case(ee,((e,{id:t,itemsPerPage:n})=>({...e,tableById:$e({id:t,itemsPerPage:n,tableById:e.tableById})}))).case(te,((e,{id:t,itemsPerPageOptions:n})=>({...e,tableById:Ve({id:t,itemsPerPageOptions:n,tableById:e.tableById})}))).case(ce,((e,{id:t,selectAll:n})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],selectAll:n}}}))).case(de,((e,{id:t,graphEventId:n})=>({...e,tableById:Qe({id:t,graphEventId:n,tableById:e.tableById})}))).case(pe,((e,{id:t,sessionViewConfig:n})=>({...e,tableById:We({id:t,sessionViewConfig:n,tableById:e.tableById})}))).case(me,((e,{id:t,updated:n})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],updated:n}}}))).case(fe,((e,{id:t,totalCount:n})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],totalCount:n}}}))).case(ge,((e,{id:t,viewMode:n})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],viewMode:n}}}))).case(be,((e,{id:t,showBuildingBlockAlerts:n})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],additionalFilters:{...e.tableById[t].additionalFilters,showBuildingBlockAlerts:n}}}}))).case(ye,((e,{id:t,showOnlyThreatIndicatorAlerts:n})=>({...e,tableById:{...e.tableById,[t]:{...e.tableById[t],additionalFilters:{...e.tableById[t].additionalFilters,showOnlyThreatIndicatorAlerts:n}}}}))).build()},function(e,t,n){"use strict";n.d(t,"b",(function(){return a.a})),n.d(t,"h",(function(){return i.f})),n.d(t,"i",(function(){return i.g})),n.d(t,"w",(function(){return i.v})),n.d(t,"x",(function(){return i.w})),n.d(t,"F",(function(){return i.D})),n.d(t,"c",(function(){return i.b})),n.d(t,"u",(function(){return i.t})),n.d(t,"D",(function(){return i.B})),n.d(t,"E",(function(){return i.C})),n.d(t,"B",(function(){return i.z})),n.d(t,"C",(function(){return i.A})),n.d(t,"A",(function(){return i.y})),n.d(t,"v",(function(){return i.u})),n.d(t,"k",(function(){return i.i})),n.d(t,"m",(function(){return i.l})),n.d(t,"s",(function(){return i.r})),n.d(t,"f",(function(){return i.d})),n.d(t,"g",(function(){return i.e})),n.d(t,"n",(function(){return i.m})),n.d(t,"o",(function(){return i.n})),n.d(t,"p",(function(){return i.o})),n.d(t,"r",(function(){return i.q})),n.d(t,"t",(function(){return i.s})),n.d(t,"q",(function(){return i.p})),n.d(t,"l",(function(){return i.k})),n.d(t,"a",(function(){return i.a})),n.d(t,"z",(function(){return i.x})),n.d(t,"d",(function(){return i.c})),n.d(t,"j",(function(){return r.b})),n.d(t,"y",(function(){return r.c})),n.d(t,"e",(function(){return r.a}));var a=n(445),i=n(294),r=n(573);n(58)},function(e,t,n){"use strict";n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"f",(function(){return g}));var a=n(45),i=n(2),r=n.n(i),s=n(44),o=n.n(s);const l=n(5).i18n.translate("xpack.securitySolution.emptyString.emptyStringDescription",{defaultMessage:"Empty string"}),u=o.a.span.withConfig({displayName:"EmptyWrapper",componentId:"sc-1h9raim-0"})(["color:",";"],(e=>e.theme.eui.euiColorMediumShade));u.displayName="EmptyWrapper";const c=()=>"â€”",d=()=>`(${l})`,p=()=>r.a.createElement(u,null,c()),m=()=>r.a.createElement(u,null,d()),f=e=>null==e?p():Object(a.isString)(e)&&""===e?m():r.a.createElement(r.a.Fragment,null,e),g=e=>null==e?p():""===e?m():r.a.createElement(r.a.Fragment,null,e)},function(e,t,n){"use strict";n.r(t),n.d(t,"parseRoute",(function(){return b})),n.d(t,"manageOldSiemRoutes",(function(){return y})),n.d(t,"getInspectResponse",(function(){return v})),n.d(t,"isDetectionsPath",(function(){return h})),n.d(t,"isDashboardViewPath",(function(){return E})),n.d(t,"isTourPath",(function(){return x})),n.d(t,"isThreatIntelligencePath",(function(){return j})),n.d(t,"getSubPluginRoutesByCapabilities",(function(){return O})),n.d(t,"isSubPluginAvailable",(function(){return S})),n.d(t,"getFieldKey",(function(){return T})),n.d(t,"getField",(function(){return I})),n.d(t,"isTimelineScope",(function(){return C})),n.d(t,"isInTableScope",(function(){return M})),n.d(t,"isAlertsPageScope",(function(){return _})),n.d(t,"getScopedActions",(function(){return A})),n.d(t,"getScopedSelectors",(function(){return P})),n.d(t,"isActiveTimeline",(function(){return F})),n.d(t,"getSourcererScopeId",(function(){return D}));var a=n(142),i=n(45),r=n(2),s=n.n(r),o=n(49),l=n(124),u=n(9),c=n(4),d=n(574),p=n(129),m=n(118),f=n(151),g=n(116);const b=e=>{if(!Object(i.isEmpty)(e.hash)){var t;const n=e.hash.split("?"),a=n.length>=1?`?${n[1]}`:"",i=n.length>0?n[0].split("/"):[];return{pageName:i.length>=1?i[1]:"",path:`/${null!==(t=i.slice(2).join("/"))&&void 0!==t?t:""}${a}`,search:a}}const n=e.search,a=e.pathname.split("/");return{pageName:a[3],path:`${a.length>4?`/${a.slice(4).join("/")}`:""}${n}`,search:n}},y=async e=>{const{application:t}=e,{pageName:n,path:a}=b(window.location);switch(n){case p.a.overview:t.navigateToApp(c.l,{deepLinkId:p.a.overview,replace:!0,path:a});break;case"ml-hosts":t.navigateToApp(c.l,{deepLinkId:p.a.hosts,replace:!0,path:`/ml-hosts${a}`});break;case p.a.hosts:t.navigateToApp(c.l,{deepLinkId:p.a.hosts,replace:!0,path:a});break;case"ml-network":t.navigateToApp(c.l,{deepLinkId:p.a.network,replace:!0,path:`/ml-network${a}`});break;case p.a.network:t.navigateToApp(c.l,{deepLinkId:p.a.network,replace:!0,path:a});break;case p.a.timelines:t.navigateToApp(c.l,{deepLinkId:p.a.timelines,replace:!0,path:a});break;case p.a.case:case"case":t.navigateToApp(c.l,{deepLinkId:p.a.case,replace:!0,path:a});break;case p.a.detections:case p.a.alerts:t.navigateToApp(c.l,{deepLinkId:p.a.alerts,replace:!0,path:a});break;case p.a.rules:t.navigateToApp(c.l,{deepLinkId:p.a.rules,replace:!0,path:a});break;case p.a.exceptions:t.navigateToApp(c.l,{deepLinkId:p.a.exceptions,replace:!0,path:a});break;default:t.navigateToApp(c.l,{deepLinkId:p.a.landing,replace:!0,path:a})}},v=(e,t)=>({dsl:Object(u.isObject)(null==e?void 0:e.inspect)&&null!=e&&e.inspect.dsl?e.inspect.dsl:(null==t?void 0:t.dsl)||[],response:null!=e?[JSON.stringify(e.rawResponse,null,2)]:null==t?void 0:t.response}),h=e=>!!Object(o.matchPath)(e,{path:`(${c.d}|${c.oc}|${c.vb})`,strict:!1}),E=e=>null!=Object(o.matchPath)(e,{path:`${c.u}/:detailName`,exact:!1,strict:!1}),x=e=>(e=>!!Object(o.matchPath)(e,{path:`${c.d}`,strict:!1}))(e)||(e=>!!Object(o.matchPath)(e,{path:`${c.s}/:detailName`,strict:!1}))(e),j=e=>!!Object(o.matchPath)(e,{path:`(${c.zc})`,strict:!1}),O=(e,t,n)=>Object.entries(e).reduce(((e,[a,i])=>{if(S(a,t))e.push(...i.routes);else{const t=e=>e.siem.privileges;e.push(...i.routes.map((e=>({path:e.path,component:()=>{const e=n.upselling.getPageUpselling(a);return e?s.a.createElement(e,null):s.a.createElement(d.b,{pageName:a,docLinkSelector:t})}}))))}return e}),[]),S=(e,t)=>"cases"===e?!0===t[c.r].read_cases:!0===t[c.vc].show,k={[a.V]:"signal.rule.id",[a.G]:"signal.rule.name",[`${a.J}.filters`]:"signal.rule.filters",[`${a.J}.language`]:"signal.rule.language",[`${a.J}.query`]:"signal.rule.query"},w={"signal.rule.id":a.V,"signal.rule.name":a.G,"signal.rule.filters":`${a.J}.filters`,"signal.rule.language":`${a.J}.language`,"signal.rule.query":`${a.J}.query`},T=(e,t)=>{var n,a;const r=(null!==(n=w[t])&&void 0!==n?n:t).replace("signal","kibana.alert"),s=(null!==(a=k[t])&&void 0!==a?a:t).replace("kibana.alert","signal");return Object(i.has)(r,e)?r:s},I=(e,t)=>{var n,a,r;const s=(null!==(n=w[t])&&void 0!==n?n:t).replace("signal","kibana.alert"),o=(null!==(a=k[t])&&void 0!==a?a:t).replace("kibana.alert","signal"),l=s.split(".");if(l.includes("parameters")&&"parameters"!==l[l.length-1]){const t=l.slice(0,l.length-1).join("."),n=Object(i.get)(t,e);return Object(i.get)(l[l.length-1],n)}return null!==(r=Object(i.get)(s,e))&&void 0!==r?r:Object(i.get)(o,e)},C=e=>Object.values(f.f).includes(e),M=e=>Object.values(l.e).includes(e),_=e=>[l.e.alertsOnAlertsPage,l.e.alertsOnRuleDetailsPage,l.e.alertsOnCasePage].includes(e),A=e=>C(e)?m.a:M(e)?l.h:void 0,P=e=>C(e)?m.a:M(e)?l.h:void 0,F=e=>e===f.f.active,D=e=>C(e)?g.SourcererScopeName.timeline:_(e)?g.SourcererScopeName.detections:g.SourcererScopeName.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b})),n.d(t,"d",(function(){return a.c})),n.d(t,"e",(function(){return a.d})),n.d(t,"c",(function(){return i.b})),n.d(t,"f",(function(){return r})),n(167),n(195),n(138),n(149),n(482);var a=n(582),i=n(342);const r=(e,t)=>n=>{const a={...n,getState:()=>e(n.getState())};return t(a)}},function(e,t,n){"use strict";var a=n(4);n.d(t,"a",(function(){return a.yc}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(48),i=n(16);const r=Object(i.b)(),s=e=>{const t=o();if(!t||!(e in t))throw new Error(`Invalid enable value ${e}. Allowed values are: ${r.join(", ")}`);return t[e]},o=()=>Object(a.useSelector)((({app:{enableExperimental:e}})=>e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var a=n(38).__importDefault(n(774));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.removeEventListener.apply(e,t)},t.isDeepEqual=a.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"j",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"m",(function(){return p})),n.d(t,"n",(function(){return m})),n.d(t,"o",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"p",(function(){return b})),n.d(t,"y",(function(){return y})),n.d(t,"A",(function(){return v})),n.d(t,"B",(function(){return h})),n.d(t,"C",(function(){return E})),n.d(t,"D",(function(){return x})),n.d(t,"d",(function(){return j})),n.d(t,"e",(function(){return O})),n.d(t,"f",(function(){return S})),n.d(t,"g",(function(){return k})),n.d(t,"E",(function(){return w})),n.d(t,"F",(function(){return T})),n.d(t,"G",(function(){return I})),n.d(t,"H",(function(){return C})),n.d(t,"J",(function(){return M})),n.d(t,"K",(function(){return _})),n.d(t,"L",(function(){return A})),n.d(t,"M",(function(){return P})),n.d(t,"Y",(function(){return F})),n.d(t,"Z",(function(){return D})),n.d(t,"ab",(function(){return N})),n.d(t,"bb",(function(){return R})),n.d(t,"z",(function(){return L})),n.d(t,"cb",(function(){return z})),n.d(t,"db",(function(){return B})),n.d(t,"N",(function(){return q})),n.d(t,"O",(function(){return $})),n.d(t,"Q",(function(){return V})),n.d(t,"T",(function(){return U})),n.d(t,"U",(function(){return H})),n.d(t,"R",(function(){return Z})),n.d(t,"S",(function(){return G})),n.d(t,"X",(function(){return Q})),n.d(t,"W",(function(){return W})),n.d(t,"s",(function(){return K})),n.d(t,"r",(function(){return J})),n.d(t,"w",(function(){return Y})),n.d(t,"P",(function(){return X})),n.d(t,"x",(function(){return ee})),n.d(t,"I",(function(){return te})),n.d(t,"V",(function(){return ne})),n.d(t,"t",(function(){return ae})),n.d(t,"v",(function(){return ie})),n.d(t,"u",(function(){return re}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.open.timeline.batchActionsTitle",{defaultMessage:"Bulk actions"}),r=a.i18n.translate("xpack.securitySolution.open.timeline.cancelButton",{defaultMessage:"Cancel"}),s=a.i18n.translate("xpack.securitySolution.open.timeline.collapseButton",{defaultMessage:"Collapse"}),o=a.i18n.translate("xpack.securitySolution.open.timeline.deleteButton",{defaultMessage:"Delete"}),l=a.i18n.translate("xpack.securitySolution.open.timeline.deleteSelectedButton",{defaultMessage:"Delete selected"}),u=a.i18n.translate("xpack.securitySolution.open.timeline.deleteWarningLabel",{defaultMessage:"You will not be able to recover this timeline or its notes once deleted."}),c=a.i18n.translate("xpack.securitySolution.open.timeline.deleteTemplateWarningLabel",{defaultMessage:"You will not be able to recover this timeline template or its notes once deleted."}),d=a.i18n.translate("xpack.securitySolution.open.timeline.descriptionTableHeader",{defaultMessage:"Description"}),p=a.i18n.translate("xpack.securitySolution.open.timeline.expandButton",{defaultMessage:"Expand"}),m=a.i18n.translate("xpack.securitySolution.open.timeline.exportFileNameTitle",{defaultMessage:"timelines_export"}),f=a.i18n.translate("xpack.securitySolution.open.timeline.exportSelectedButton",{defaultMessage:"Export selected"}),g=a.i18n.translate("xpack.securitySolution.open.timeline.favoriteSelectedButton",{defaultMessage:"Favorite selected"}),b=a.i18n.translate("xpack.securitySolution.open.timeline.favoritesTooltip",{defaultMessage:"Favorites"}),y=a.i18n.translate("xpack.securitySolution.open.timeline.lastModifiedTableHeader",{defaultMessage:"Last modified"}),v=a.i18n.translate("xpack.securitySolution.open.timeline.missingSavedObjectIdTooltip",{defaultMessage:"Missing savedObjectId"}),h=a.i18n.translate("xpack.securitySolution.open.timeline.modifiedByTableHeader",{defaultMessage:"Modified by"}),E=a.i18n.translate("xpack.securitySolution.open.timeline.notesTooltip",{defaultMessage:"Notes"}),x=a.i18n.translate("xpack.securitySolution.open.timeline.onlyFavoritesButtonLabel",{defaultMessage:"Only favorites"}),j=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineTooltip",{defaultMessage:"Create query rule from timeline"}),O=a.i18n.translate("xpack.securitySolution.open.timeline.createRuleFromTimelineEqlTooltip",{defaultMessage:"Create EQL rule from timeline"}),S=a.i18n.translate("xpack.securitySolution.open.timeline.createTemplateFromTimelineTooltip",{defaultMessage:"Create template from timeline"}),k=a.i18n.translate("xpack.securitySolution.open.timeline.createTimelineFromTemplateTooltip",{defaultMessage:"Create timeline from template"}),w=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTooltip",{defaultMessage:"Duplicate timeline"}),T=a.i18n.translate("xpack.securitySolution.open.timeline.openAsDuplicateTemplateTooltip",{defaultMessage:"Duplicate template"}),I=a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineButton",{defaultMessage:"Open Timelineâ€¦"}),C=a.i18n.translate("xpack.securitySolution.open.timeline.openTimelineTitle",{defaultMessage:"Open"}),M=a.i18n.translate("xpack.securitySolution.open.timeline.pinnedEventsTooltip",{defaultMessage:"Pinned events"}),_=a.i18n.translate("xpack.securitySolution.open.timeline.refreshTitle",{defaultMessage:"Refresh"}),A=a.i18n.translate("xpack.securitySolution.open.timeline.searchPlaceholder",{defaultMessage:"e.g. timeline name, or description"}),P=a.i18n.translate("xpack.securitySolution.open.timeline.searchTemplatePlaceholder",{defaultMessage:"e.g. template name, or description"}),F=a.i18n.translate("xpack.securitySolution.open.timeline.timelineNameTableHeader",{defaultMessage:"Timeline name"}),D=a.i18n.translate("xpack.securitySolution.open.timeline.timelineTemplateNameTableHeader",{defaultMessage:"Template name"}),N=a.i18n.translate("xpack.securitySolution.open.timeline.untitledTimelineLabel",{defaultMessage:"Untitled timeline"}),R=a.i18n.translate("xpack.securitySolution.open.timeline.withLabel",{defaultMessage:"with"}),L=a.i18n.translate("xpack.securitySolution.open.timeline.loadingLabel",{defaultMessage:"Loading..."}),z=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelinesMatchLabel",{defaultMessage:"0 timelines match the search criteria"}),B=a.i18n.translate("xpack.securitySolution.open.timeline.zeroTimelineTemplatesMatchLabel",{defaultMessage:"0 timeline templates match the search criteria"}),q=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTemplatesTitle",{values:{selectedTemplates:e},defaultMessage:"Selected {selectedTemplates} {selectedTemplates, plural, =1 {template} other {templates}}"}),$=e=>a.i18n.translate("xpack.securitySolution.open.timeline.selectedTimelinesTitle",{values:{selectedTimelines:e},defaultMessage:"Selected {selectedTimelines} {selectedTimelines, plural, =1 {timeline} other {timelines}}"}),V=a.i18n.translate("xpack.securitySolution.open.timeline.showingLabel",{defaultMessage:"Showing:"}),U=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully exported {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),H=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyExportedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully exported {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),Z=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelinesTitle",{values:{totalTimelines:e},defaultMessage:"Successfully deleted {totalTimelines, plural, =0 {all timelines} =1 {{totalTimelines} timeline} other {{totalTimelines} timelines}}"}),G=e=>a.i18n.translate("xpack.securitySolution.open.timeline.successfullyDeletedTimelineTemplatesTitle",{values:{totalTimelineTemplates:e},defaultMessage:"Successfully deleted {totalTimelineTemplates, plural, =0 {all timelines} =1 {{totalTimelineTemplates} timeline template} other {{totalTimelineTemplates} timeline templates}}"}),Q=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.timelinesTitle",{defaultMessage:"Timelines"}),W=a.i18n.translate("xpack.securitySolution.timelines.components.tabs.templatesTitle",{defaultMessage:"Templates"}),K=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.elasticTitle",{defaultMessage:"Elastic templates"}),J=a.i18n.translate("xpack.securitySolution.timelines.components.templateFilter.customizedTitle",{defaultMessage:"Custom templates"}),Y=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTimelineTitle",{defaultMessage:"Import"}),X=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.selectTimelineDescription",{defaultMessage:"Select a timeline or timeline template file to import"}),ee=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid timelines_export.ndjson file"}),te=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.overwriteDescription",{defaultMessage:"Automatically overwrite saved objects with the same timeline ID"}),ne=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.successfullyImportedTimelinesTitle",{values:{totalCount:e},defaultMessage:"Successfully imported {totalCount} {totalCount, plural, =1 {item} other {items}}"}),ae=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedTitle",{values:{totalTimelines:e},defaultMessage:"Failed to import {totalTimelines} {totalTimelines, plural, =1 {timeline} other {timelines}}"}),ie=a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importTitle",{defaultMessage:"Importâ€¦"}),re=e=>a.i18n.translate("xpack.securitySolution.timelines.components.importTimelineModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"})},,function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var a=n(122),i=n(113),r=n(196),s=n(335);const{from:o,to:l}=Object(s.a)({from:"",to:""},!1),u={activeTab:a.d.query,prevActiveTab:a.d.query,columns:r.b,documentType:"",defaultColumns:r.b,dataProviders:[],dataViewId:null,dateRange:{start:o,end:l},description:"",eqlOptions:{eventCategoryField:"event.category",tiebreakerField:"",timestampField:"@timestamp",query:"",size:100},eventType:"all",eventIdToNoteIds:{},excludedRowRendererIds:[],expandedDetail:{},highlightedDropAndProviderId:"",historyIds:[],indexNames:[],isFavorite:!1,isLive:!1,isLoading:!1,isSaving:!1,itemsPerPage:25,itemsPerPageOptions:[10,25,50,100],kqlMode:"filter",kqlQuery:{filterQuery:null},loadingEventIds:[],resolveTimelineConfig:void 0,queryFields:[],title:"",timelineType:i.l.default,templateTimelineId:null,templateTimelineVersion:null,noteIds:[],pinnedEventIds:{},pinnedEventsSaveObject:{},savedObjectId:null,selectAll:!1,sessionViewConfig:null,show:!1,sort:[{columnId:"@timestamp",columnType:"date",esTypes:["date"],sortDirection:"desc"}],status:i.k.draft,version:null,deletedEventIds:[],selectedEventIds:{},isSelectAllChecked:!1,filters:[],savedSearchId:null,savedSearch:null,isDiscoverSavedSearchLoaded:!1,isDataProviderVisible:!1},c=e=>({defaultColumns:r.b,documentType:"",selectAll:!1,id:e,isLoading:!1,queryFields:[],title:"",graphEventId:""})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(891);const r=()=>Object(a.useContext)(i.a)},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var a,i,r;if(Array.isArray(t)){if((a=t.length)!=n.length)return!1;for(i=a;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((a=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=a;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,r[i]))return!1;for(i=a;0!=i--;){var s=r[i];if(!e(t[s],n[s]))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";n.d(t,"g",(function(){return x.d})),n.d(t,"f",(function(){return x.c})),n.d(t,"o",(function(){return w})),n.d(t,"m",(function(){return C})),n.d(t,"d",(function(){return _})),n.d(t,"h",(function(){return D})),n.d(t,"a",(function(){return R})),n.d(t,"c",(function(){return L})),n.d(t,"i",(function(){return z})),n.d(t,"e",(function(){return B})),n.d(t,"b",(function(){return q})),n.d(t,"j",(function(){return Z})),n.d(t,"n",(function(){return G})),n.d(t,"l",(function(){return Q})),n.d(t,"k",(function(){return W}));var a=n(17),i=n(2),r=n.n(i),s=n(45),o=n(470),l=n(266),u=n(526),c=n(4),d=n(563),p=n(164),m=n(245),f=n(110),g=n(226),b=n(5),y=n(397);const v=e=>b.i18n.translate("xpack.securitySolution.cases.caseTable.caseDetailsLinkAria",{values:{detailName:e},defaultMessage:"click to visit case with title {detailName}"});var h=n(129),E=n(527),x=n(284),j=n(23),O=n.n(j),S=n(462),k=n(486);const w=()=>{const e=Object(S.b)(),t=Object(k.a)();return Object(i.useCallback)((({deepLinkId:n,path:a,onClick:i})=>{const r=t(n);return e({id:n,path:a,urlState:r,onClick:i})}),[e,t])},T=e=>(e=>r.a.memo((function({deepLinkId:t,...n}){const a=Object(k.a)()(t);return r.a.createElement(e,O()({id:t,urlState:a},n))})))(Object(S.d)(e)),I=({children:e,Component:t,userName:n,isButton:a,onClick:s,title:o,userTab:l})=>{const u=encodeURIComponent(n),{formatUrl:d,search:m}=Object(p.l)(h.a.users),{application:{navigateToApp:g},telemetry:b}=Object(f.i)().services,y=Object(i.useCallback)((e=>{e.preventDefault(),g(c.l,{deepLinkId:h.a.users,path:l?Object(E.a)(u,l,m):Object(E.c)(u,m)})}),[u,g,m,l]),v=Object(i.useMemo)((()=>d(l?Object(E.a)(u,l):Object(E.c)(u))),[d,u,l]),j=Object(i.useCallback)((e=>{b.reportEntityDetailsClicked({entity:"user"}),(null!=s?s:y)(e)}),[y,s,b]);return a?r.a.createElement(x.b,{Component:t,dataTestSubj:"data-grid-user-details",href:v,onClick:j,title:null!=o?o:n},e||n):r.a.createElement(x.c,{"data-test-subj":"users-link-anchor",onClick:j,href:v},e||n)},C=r.a.memo(I),M=({children:e,Component:t,hostName:n,isButton:a,onClick:s,title:o,hostTab:l})=>{const{formatUrl:u,search:d}=Object(p.l)(h.a.hosts),{application:{navigateToApp:m},telemetry:g}=Object(f.i)().services,b=encodeURIComponent(n),y=Object(i.useCallback)((e=>{e.preventDefault(),m(c.l,{deepLinkId:h.a.hosts,path:l?Object(p.i)(b,l,d):Object(p.d)(b,d)})}),[b,m,d,l]),v=Object(i.useMemo)((()=>u(l?Object(p.i)(b,l):Object(p.d)(b))),[u,b,l]),E=Object(i.useCallback)((e=>{g.reportEntityDetailsClicked({entity:"host"}),(null!=s?s:y)(e)}),[y,s,g]);return a?r.a.createElement(x.b,{Component:t,dataTestSubj:"data-grid-host-details",href:v,iconType:"expand",onClick:E,title:null!=o?o:n},e):r.a.createElement(x.c,{onClick:E,href:v,"data-test-subj":"host-details-button"},e||n)},_=r.a.memo(M),A=["http://","https://"],P=r.a.memo((({url:e,children:t,idx:n,overflowIndexStart:i=5,allItemsLimit:o=5})=>{const l=i-1,u=o-1,c=Math.max(0,Math.min(l,u)),d=A.some((t=>0===e.indexOf(t)));return e&&d&&!Object(g.c)(e)&&t?r.a.createElement(a.EuiToolTip,{content:e,position:"top","data-test-subj":"externalLinkTooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiLink,{href:e,target:"_blank",rel:"noopener","data-test-subj":"externalLink"},t),!Object(s.isNil)(n)&&n<c&&r.a.createElement(x.a,{"data-test-subj":"externalLinkComma"}))):null}));P.displayName="ExternalLink";const F=({Component:e,children:t,ip:n,flowTarget:a=m.a.source,isButton:o,onClick:l,title:u})=>{const c=w(),f=Object(i.useCallback)(((n,i)=>{const{onClick:s,href:m}=c({deepLinkId:h.a.network,path:Object(p.f)(encodeURIComponent(Object(d.c)(n)),a)}),f=null!=l?l:e=>s(e);return o?r.a.createElement(x.b,{Component:e,key:`${n}-${i}`,dataTestSubj:"data-grid-network-details",onClick:f,href:m,title:null!=u?u:n},t):r.a.createElement(x.c,{key:`${n}-${i}`,onClick:f,href:m,"data-test-subj":"network-details"},t||n)}),[t,e,a,c,l,o,u]);return Object(s.isArray)(n)?r.a.createElement(r.a.Fragment,null,n.map(f)):f(n,0)},D=r.a.memo(F),N=({index:e,children:t,detailName:n,title:a})=>{const{formatUrl:s,search:d}=Object(p.l)(h.a.case),{navigateToApp:m}=Object(f.i)().services.application,{activeStep:g,isTourShown:b}=Object(u.b)(),y=Object(i.useMemo)((()=>g===l.a.viewCase&&b(l.b.alertsCases)&&0===e),[g,e,b]),E=Object(i.useCallback)((async e=>(e&&e.preventDefault(),m(c.l,{deepLinkId:h.a.case,path:Object(p.a)({id:n,search:d})}))),[n,m,d]);return Object(i.useEffect)((()=>{var e;y&&(null===(e=document.querySelector('[tour-step="RelatedCases-accordion"]'))||void 0===e||e.scrollIntoView())}),[y]),r.a.createElement(o.a,{onClick:E,isTourAnchor:y,step:l.a.viewCase,tourId:l.b.alertsCases},r.a.createElement(x.c,{onClick:E,href:s(Object(p.a)({id:n})),"data-test-subj":"case-details-link","aria-label":v(null!=a?a:n)},t||n))},R=r.a.memo(N);R.displayName="CaseDetailsLink",r.a.memo((({children:e})=>{const{formatUrl:t,search:n}=Object(p.l)(h.a.case),{navigateToApp:a}=Object(f.i)().services.application,s=Object(i.useCallback)((async e=>(e.preventDefault(),a(c.l,{deepLinkId:h.a.case,path:Object(p.b)(n)}))),[a,n]);return r.a.createElement(x.c,{onClick:s,href:t(Object(p.b)())},e)})).displayName="CreateCaseLink";const L=r.a.memo((({children:e,link:t})=>{const n=Object(i.useMemo)((()=>`https://www.google.com/search?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(P,{url:n},e||t)}));L.displayName="GoogleLink";const z=r.a.memo((({Component:e,title:t,children:n,portOrServiceName:s})=>{var o;const l=Object(i.useMemo)((()=>`https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml?search=${encodeURIComponent(String(s))}`),[s]);return e?r.a.createElement(e,{href:l,"data-test-subj":"data-grid-port-or-service-name-link",title:t,iconType:"link"},null!==(o=null!=t?t:n)&&void 0!==o?o:s):r.a.createElement(x.e,null,r.a.createElement(a.EuiLink,{"data-test-subj":"port-or-service-name-link",href:l,target:"_blank"},n||s))}));z.displayName="PortOrServiceNameLink";const B=r.a.memo((({children:e,ja3Fingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ja3-fingerprints/${encodeURIComponent(t)}`),[t]);return r.a.createElement(a.EuiLink,{"data-test-subj":"ja3-fingerprint-link",href:n,target:"_blank"},e||t)}));B.displayName="Ja3FingerprintLink";const q=r.a.memo((({children:e,certificateFingerprint:t})=>{const n=Object(i.useMemo)((()=>`https://sslbl.abuse.ch/ssl-certificates/sha1/${encodeURIComponent(t)}`),[t]);return r.a.createElement(a.EuiLink,{"data-test-subj":"certificate-fingerprint-link",href:n,target:"_blank"},e||t)}));var $;function V(e){return e===$["virustotal.com"]||e===$["talosIntelligence.com"]}q.displayName="CertificateFingerprintLink",function(e){e["virustotal.com"]="virustotal.com",e["talosIntelligence.com"]="talosIntelligence.com"}($||($={}));const U={[$["virustotal.com"]]:y.m,[$["talosIntelligence.com"]]:y.l},H=({overflowIndexStart:e=5,allItemsLimit:t=5,showDomain:n=!1,domain:o,direction:l="row"})=>{const[u]=Object(f.o)(c.Gb),d=Object(i.useMemo)((()=>null==u?void 0:u.slice(0,t).filter((({url_template:e,name:t})=>!Object(s.isNil)(e)&&!Object(s.isNil)(t)&&!Object(g.c)(e))).map((({name:e,url_template:t})=>({name:V(e)?U[e]:e,url_template:t.replace("{{ip}}",encodeURIComponent(o))})))),[u,o,U,t]),p=Object(i.useCallback)((n=>{var a;return(e=>void 0!==e.url_template&&void 0!==e.name)(n)&&r.a.createElement(P,{url:n.url_template,overflowIndexStart:e,allItemsLimit:t},r.a.createElement(r.a.Fragment,null,null!==(a=n.name)&&void 0!==a?a:o))}),[t,o,e]);return(null==d?void 0:d.length)>0?r.a.createElement("section",null,r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",justifyContent:"center",direction:l,alignItems:"center","data-test-subj":"reputationLinkGroup"},r.a.createElement(a.EuiFlexItem,{grow:!0},null==d?void 0:d.slice(0,e).map((({name:t,url_template:a},i)=>r.a.createElement(P,{allItemsLimit:d.length,idx:i,overflowIndexStart:e,url:a,"data-test-subj":"externalLinkComponent",key:`reputationLink-${i}`},r.a.createElement(r.a.Fragment,null,n?o:null!=t?t:o))))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(x.f,{rowItems:d,render:p,moreMaxHeight:"200px",overflowIndexStart:e})))):null};H.displayName="ReputationLinkComponent";const Z=r.a.memo(H),G=r.a.memo((({children:e,domain:t})=>{const n=Object(i.useMemo)((()=>`https://www.iana.org/whois?q=${encodeURIComponent(t)}`),[t]);return r.a.createElement(P,{url:n},e||t)}));G.displayName="WhoIsLink";const Q=T(x.d),W=T(x.c)},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return a})),n.d(t,"d",(function(){return i}));var a=n(158),i=(n(579),n(580)),r=n(45),s=n(187),o=n(119),l=n(281),u=n(581);const{socTrends:c,...d}=Object(l.d)(!1),p={global:{timerange:{kind:"relative",...d},queries:[],policy:Object(l.c)(!1),linkTo:[o.a.timeline],query:{query:"",language:"kuery"},filters:[],fullScreen:!1},timeline:{timerange:{kind:"relative",...d},queries:[],policy:Object(l.c)(!1),linkTo:[o.a.global],query:{query:"",language:"kuery"},filters:[],fullScreen:!1}},m=e=>{const{from:t,fromStr:n,to:a,toStr:i,socTrends:r}=Object(l.d)(),{kind:s,duration:u}=Object(l.c)();return{global:{timerange:{kind:"relative",fromStr:n,toStr:i,from:t,to:a},queries:[],policy:{kind:s,duration:u},linkTo:[o.a.timeline,...e?[o.a.socTrends]:[]],query:{query:"",language:"kuery"},filters:[],fullScreen:!1},timeline:{timerange:{kind:"relative",fromStr:n,toStr:i,from:t,to:a},queries:[],policy:{kind:s,duration:u},linkTo:[o.a.global],query:{query:"",language:"kuery"},filters:[],fullScreen:!1},...e?{socTrends:{timerange:r,linkTo:[o.a.global],policy:{kind:s,duration:u}}}:{}}},f=Object(s.reducerWithInitialState)(p).case(a.setTimelineRangeDatePicker,((e,{from:t,to:n})=>({...e,global:{...e.global,linkTo:e.global.linkTo.filter((e=>e!==o.a.timeline))},timeline:{...e.timeline,timerange:{kind:"absolute",fromStr:void 0,toStr:void 0,from:t,to:n},linkTo:[]}}))).case(a.setAbsoluteRangeDatePicker,((e,{id:t,from:n,to:a,fromStr:i,toStr:r})=>{const s={kind:"absolute",fromStr:i,toStr:r,from:n,to:a};return Object(u.i)(t,s,e)})).case(a.setRelativeRangeDatePicker,((e,{id:t,fromStr:n,from:a,to:i,toStr:r})=>{const s={kind:"relative",fromStr:n,toStr:r,from:a,to:i};return Object(u.i)(t,s,e)})).case(a.setFullScreen,((e,{id:t,fullScreen:n})=>Object(u.h)(t,n,e))).case(a.deleteAllQuery,((e,{id:t})=>({...e,[t]:{...Object(r.get)(t,e),queries:e.global.queries.slice(e.global.queries.length)}}))).case(a.setQuery,((e,{inputId:t,id:n,inspect:a,loading:i,refetch:r,searchSessionId:s})=>Object(u.j)({inputId:t,id:n,inspect:a,loading:i,refetch:r,state:e,searchSessionId:s}))).case(a.deleteOneQuery,((e,{inputId:t,id:n})=>Object(u.b)({inputId:t,id:n,state:e}))).case(a.setDuration,((e,{id:t,duration:n})=>({...e,[t]:{...Object(r.get)(t,e),policy:{...Object(r.get)(`${t}.policy`,e),duration:n}}}))).case(a.startAutoReload,((e,{id:t})=>({...e,[t]:{...Object(r.get)(t,e),policy:{...Object(r.get)(`${t}.policy`,e),kind:"interval"}}}))).case(a.stopAutoReload,((e,{id:t})=>({...e,[t]:{...Object(r.get)(t,e),policy:{...Object(r.get)(`${t}.policy`,e),kind:"manual"}}}))).case(a.toggleTimelineLinkTo,(e=>Object(u.g)(e))).case(a.toggleSocTrendsLinkTo,(e=>Object(u.f)(e))).case(a.setInspectionParameter,((e,{id:t,inputId:n,isInspected:a,selectedInspectIndex:i,searchSessionId:r})=>Object(u.e)({id:t,inputId:n,isInspected:a,selectedInspectIndex:i,state:e,searchSessionId:r}))).case(a.removeLinkTo,((e,t)=>Object(u.d)(t,e))).case(a.addLinkTo,((e,t)=>Object(u.a)(t,e))).case(a.setFilterQuery,((e,{id:t,query:n,language:a})=>({...e,[t]:{...Object(r.get)(t,e),query:{query:n,language:a}}}))).case(a.setSavedQuery,((e,{id:t,savedQuery:n})=>({...e,[t]:{...Object(r.get)(t,e),savedQuery:n}}))).case(a.setSearchBarFilter,((e,{id:t,filters:n})=>({...e,[t]:{...Object(r.get)(t,e),filters:n}}))).build()},,,function(e,t,n){"use strict";n.d(t,"m",(function(){return r})),n.d(t,"K",(function(){return s})),n.d(t,"N",(function(){return o})),n.d(t,"I",(function(){return l})),n.d(t,"z",(function(){return u})),n.d(t,"P",(function(){return c})),n.d(t,"k",(function(){return d})),n.d(t,"j",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"D",(function(){return f})),n.d(t,"E",(function(){return g})),n.d(t,"F",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"q",(function(){return v})),n.d(t,"V",(function(){return h})),n.d(t,"W",(function(){return E})),n.d(t,"O",(function(){return x})),n.d(t,"H",(function(){return j})),n.d(t,"G",(function(){return O})),n.d(t,"y",(function(){return S})),n.d(t,"B",(function(){return k})),n.d(t,"M",(function(){return w})),n.d(t,"h",(function(){return T})),n.d(t,"U",(function(){return I})),n.d(t,"d",(function(){return C})),n.d(t,"b",(function(){return M})),n.d(t,"c",(function(){return _})),n.d(t,"l",(function(){return A})),n.d(t,"X",(function(){return R})),n.d(t,"f",(function(){return L})),n.d(t,"e",(function(){return z})),n.d(t,"T",(function(){return B})),n.d(t,"L",(function(){return q})),n.d(t,"C",(function(){return $})),n.d(t,"J",(function(){return V})),n.d(t,"ab",(function(){return U})),n.d(t,"bb",(function(){return H})),n.d(t,"o",(function(){return G})),n.d(t,"Y",(function(){return Q})),n.d(t,"Z",(function(){return W})),n.d(t,"S",(function(){return K})),n.d(t,"R",(function(){return J})),n.d(t,"Q",(function(){return Y})),n.d(t,"n",(function(){return ee})),n.d(t,"g",(function(){return te})),n.d(t,"x",(function(){return ne})),n.d(t,"t",(function(){return ie})),n.d(t,"s",(function(){return re})),n.d(t,"w",(function(){return se})),n.d(t,"u",(function(){return oe})),n.d(t,"v",(function(){return le})),n.d(t,"r",(function(){return ue})),n.d(t,"A",(function(){return de})),n.d(t,"a",(function(){return pe}));var a=n(111),i=n(182);const r=a.z.string().min(1).regex(/^(?! *$).+$/),s=a.z.string().uuid(),o=a.z.string(),l=a.z.string().min(1),u=a.z.string().min(1),c=a.z.number().int().min(1),d=(a.z.enum(["kuery","lucene","eql","esql"]).enum,a.z.enum(["kuery","lucene"])),p=(d.enum,a.z.boolean()),m=a.z.boolean(),f=a.z.string(),g=a.z.string().superRefine(i.c),b=a.z.string(),y=a.z.number().int().min(0).max(100),v=a.z.array(a.z.object({field:a.z.string(),operator:a.z.literal("equals"),value:a.z.string(),risk_score:y.optional()})),h=a.z.enum(["low","medium","high","critical"]),E=(h.enum,a.z.array(a.z.object({field:a.z.string(),operator:a.z.literal("equals"),severity:h,value:a.z.string()}))),x=a.z.array(a.z.string()),j=a.z.object({}).catchall(a.z.unknown()),O=a.z.string(),S=a.z.array(a.z.string()),k=a.z.array(a.z.string()),w=a.z.array(a.z.string()),T=a.z.string(),I=a.z.string(),C=a.z.string(),M=a.z.string(),_=a.z.string(),A=a.z.number().int().min(1),P=a.z.object({id:a.z.string(),name:a.z.string(),reference:a.z.string()}),F=a.z.object({id:a.z.string(),name:a.z.string(),reference:a.z.string(),subtechnique:a.z.array(P).optional()}),D=a.z.object({id:a.z.string(),name:a.z.string(),reference:a.z.string()}),N=a.z.object({framework:a.z.string(),tactic:D,technique:a.z.array(F).optional()}),R=a.z.array(N),L=a.z.array(a.z.string()),z=a.z.string(),B=a.z.string(),q=a.z.string(),$=a.z.array(a.z.unknown()),V=a.z.string(),U=a.z.string(),H=a.z.boolean(),Z=a.z.object({name:r,type:r,ecs:a.z.boolean()}),G=a.z.array(Z),Q=a.z.string(),W=a.z.string(),K=a.z.enum(["exactMatch","aliasMatch","conflict"]),J=(K.enum,a.z.string()),Y=a.z.enum(["savedObjectConversion","savedObjectImport"]),X=(Y.enum,a.z.object({package:r,version:r,integration:r.optional()})),ee=a.z.array(X),te=a.z.object({field_names:a.z.array(r).min(1)}),ne=a.z.union([a.z.enum(["no_actions","rule"]),a.z.string().regex(/^[1-9]\d*[smhd]$/)]),ae=a.z.enum(["onActiveAlert","onThrottleInterval","onActionGroupChange"]),ie=(ae.enum,a.z.object({summary:a.z.boolean(),notifyWhen:ae,throttle:ne.nullable()})),re=a.z.object({}).catchall(a.z.unknown()),se=a.z.object({}).catchall(a.z.unknown()),oe=a.z.string(),le=a.z.string(),ue=a.z.object({action_type_id:a.z.string(),group:oe,id:le,params:se,uuid:r.optional(),alerts_filter:re.optional(),frequency:ie.optional()}),ce=a.z.enum(["detection","rule_default","endpoint","endpoint_trusted_apps","endpoint_events","endpoint_host_isolation_exceptions","endpoint_blocklists"]),de=(ce.enum,a.z.object({id:r,list_id:r,type:ce,namespace_type:a.z.enum(["agnostic","single"])})),pe=a.z.object({value:a.z.number().int().min(1),unit:a.z.enum(["s","m","h"])})},function(e,t,n){"use strict";n.d(t,"r",(function(){return r})),n.d(t,"H",(function(){return s})),n.d(t,"a",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"q",(function(){return g})),n.d(t,"o",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"s",(function(){return v})),n.d(t,"v",(function(){return w})),n.d(t,"w",(function(){return T})),n.d(t,"C",(function(){return I})),n.d(t,"G",(function(){return C})),n.d(t,"J",(function(){return M})),n.d(t,"K",(function(){return _})),n.d(t,"M",(function(){return A})),n.d(t,"P",(function(){return P})),n.d(t,"S",(function(){return F})),n.d(t,"V",(function(){return N})),n.d(t,"Y",(function(){return h})),n.d(t,"Z",(function(){return E})),n.d(t,"jb",(function(){return x})),n.d(t,"kb",(function(){return D})),n.d(t,"lb",(function(){return j})),n.d(t,"mb",(function(){return k})),n.d(t,"ob",(function(){return O})),n.d(t,"qb",(function(){return S})),n.d(t,"wb",(function(){return o})),n.d(t,"yb",(function(){return a})),n.d(t,"zb",(function(){return l})),n.d(t,"t",(function(){return q})),n.d(t,"u",(function(){return $})),n.d(t,"x",(function(){return V})),n.d(t,"y",(function(){return U})),n.d(t,"z",(function(){return H})),n.d(t,"A",(function(){return Z})),n.d(t,"D",(function(){return G})),n.d(t,"E",(function(){return Q})),n.d(t,"F",(function(){return W})),n.d(t,"I",(function(){return K})),n.d(t,"L",(function(){return J})),n.d(t,"N",(function(){return Y})),n.d(t,"O",(function(){return X})),n.d(t,"Q",(function(){return ee})),n.d(t,"R",(function(){return te})),n.d(t,"T",(function(){return ne})),n.d(t,"U",(function(){return ae})),n.d(t,"W",(function(){return ie})),n.d(t,"X",(function(){return re})),n.d(t,"cb",(function(){return pe})),n.d(t,"db",(function(){return de})),n.d(t,"eb",(function(){return le})),n.d(t,"fb",(function(){return ce})),n.d(t,"gb",(function(){return oe})),n.d(t,"hb",(function(){return ue})),n.d(t,"ib",(function(){return me})),n.d(t,"nb",(function(){return fe})),n.d(t,"rb",(function(){return ge})),n.d(t,"pb",(function(){return be})),n.d(t,"tb",(function(){return R})),n.d(t,"ub",(function(){return L})),n.d(t,"vb",(function(){return z})),n.d(t,"xb",(function(){return B})),n.d(t,"b",(function(){return ye})),n.d(t,"g",(function(){return ve})),n.d(t,"h",(function(){return he})),n.d(t,"d",(function(){return Ee})),n.d(t,"i",(function(){return xe})),n.d(t,"l",(function(){return je})),n.d(t,"m",(function(){return Oe})),n.d(t,"n",(function(){return Se})),n.d(t,"B",(function(){return ke})),n.d(t,"sb",(function(){return we})),n.d(t,"ab",(function(){return Te})),n.d(t,"bb",(function(){return Ie}));const a="@timestamp",i="kibana",r=`${i}.alert`,s=`${r}.rule`,o=`${i}.space_ids`,l=`${i}.version`,u=`${r}.action_group`,c=`${r}.case_ids`,d=`${r}.duration.us`,p=`${r}.end`,m=`${r}.flapping`,f=`${r}.flapping_history`,g=`${r}.maintenance_window_ids`,b=`${r}.instance.id`,y=`${r}.last_detected`,v=`${r}.reason`,h=`${r}.start`,E=`${r}.status`,x=`${r}.time_range`,j=`${r}.uuid`,O=`${r}.workflow_status`,S=`${r}.workflow_tags`,k=`${r}.workflow_assignee_ids`,w=`${s}.category`,T=`${s}.consumer`,I=`${s}.execution.uuid`,C=`${s}.name`,M=`${s}.parameters`,_=`${s}.producer`,A=`${s}.revision`,P=`${s}.tags`,F=`${s}.rule_type_id`,D=`${r}.url`,N=`${s}.uuid`,R="ecs.version",L="event.action",z="event.kind",B="tags",q=`${r}.risk_score`,$=`${s}.author`,V=`${s}.created_at`,U=`${s}.created_by`,H=`${s}.description`,Z=`${s}.enabled`,G=`${s}.from`,Q=`${s}.interval`,W=`${s}.license`,K=`${s}.note`,J=`${s}.references`,Y=`${s}.rule_id`,X=`${s}.rule_name_override`,ee=`${s}.to`,te=`${s}.type`,ne=`${s}.updated_at`,ae=`${s}.updated_by`,ie=`${s}.version`,re=`${r}.severity`,se=`${r}.suppression`,oe=`${se}.terms`,le=`${oe}.field`,ue=`${oe}.value`,ce=`${se}.start`,de=`${se}.end`,pe=`${se}.docs_count`,me=`${r}.system_status`,fe=`${r}.workflow_reason`,ge=`${r}.workflow_user`,be=`${r}.workflow_status_updated_at`,ye=`${r}.building_block_type`,ve=`${r}.evaluation.threshold`,he=`${r}.evaluation.value`,Ee=`${r}.context`,xe=`${r}.evaluation.values`,je=`${r}.group`,Oe=`${je}.field`,Se=`${je}.value`,ke=`${s}.exceptions_list`,we={APM:"apm",LOGS:"logs",INFRASTRUCTURE:"infrastructure",OBSERVABILITY:"observability",SLO:"slo",SIEM:"siem",UPTIME:"uptime",ML:"ml"},Te=(Object.values(we).map((e=>e)),"recovered"),Ie="untracked";let Ce;!function(e){e.ErrorCount="apm.error_rate",e.TransactionErrorRate="apm.transaction_error_rate",e.TransactionDuration="apm.transaction_duration",e.Anomaly="apm.anomaly"}(Ce||(Ce={}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(46);const i=e=>a.union([e,a.null]),r=(e,t="enum")=>new a.Type(t,(t=>Object.values(e).includes(t)),((t,n)=>Object.values(e).includes(t)?a.success(t):a.failure(t,n)),(e=>e)),s=(e,t="Unknown Field in switch statement")=>{throw new Error(`${t}: ${e}`)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return P})),n.d(t,"a",(function(){return T}));var a=n(23),i=n.n(a),r=n(2),s=n(17);const o=Object(r.createContext)(void 0),l=()=>{const e=Object(r.useContext)(o);if(!e)throw new Error("ExpandableFlyoutContext can only be used within ExpandableFlyoutContext provider");return e};var u=n(13),c=n(9);const d="previewSection";var p=n(5);const m=p.i18n.translate("expandableFlyout.previewSection.backButton",{defaultMessage:"Back"}),f=p.i18n.translate("expandableFlyout.previewSection.closeButton",{defaultMessage:"Close"}),g=e=>Object(c.has)(e,"title")||Object(c.has)(e,"backgroundColor")||Object(c.has)(e,"textColor"),b=({component:e,showBackButton:t,leftPosition:n,banner:a})=>{const{euiTheme:i}=Object(s.useEuiTheme)(),{closePreviewPanel:r,previousPreviewPanel:o}=l(),c=n+4,p=Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiButtonIcon,{iconType:"cross",onClick:()=>r(),"data-test-subj":"previewSectionCloseButton","aria-label":f})),b=t?Object(u.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween",responsive:!1},Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiButtonEmpty,{size:"xs",iconType:"arrowLeft",iconSide:"left",onClick:()=>o(),"data-test-subj":"previewSectionBackButton","aria-label":m},m)),p):Object(u.jsx)(s.EuiFlexGroup,{justifyContent:"flexEnd",responsive:!1},p);return Object(u.jsx)("div",{css:Object(u.css)("position:absolute;top:4px;bottom:12px;right:4px;left:",c,"px;z-index:1000;","")},Object(u.jsx)(s.EuiSplitPanel.Outer,{css:Object(u.css)("margin:",i.size.xs,";box-shadow:0 0 4px 4px ",i.colors.darkShade,";",""),className:"eui-yScroll","data-test-subj":d},g(a)&&Object(u.jsx)(s.EuiSplitPanel.Inner,{grow:!1,color:a.backgroundColor,paddingSize:"none","data-test-subj":`${d}BannerPanel`},Object(u.jsx)(s.EuiText,{textAlign:"center",color:a.textColor,size:"s","data-test-subj":`${d}BannerText`},a.title)),Object(u.jsx)(s.EuiSplitPanel.Inner,{grow:!1,paddingSize:"s","data-test-subj":"previewSectionHeader"},b),Object(u.jsx)(s.EuiSplitPanel.Inner,{paddingSize:"none"},e)))};b.displayName="PreviewSection";const y=({component:e,width:t})=>{const n=Object(r.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(u.jsx)(s.EuiFlexItem,{grow:!1,style:n,"data-test-subj":"rightSection"},e)};y.displayName="RightSection";const v=({component:e,width:t})=>{const n=Object(r.useMemo)((()=>({height:"100%",width:`${t}px`})),[t]);return Object(u.jsx)(s.EuiFlexItem,{grow:!0,"data-test-subj":"leftSection",style:n},e)};v.displayName="LeftSection";const h={height:"100%"},E=({registeredPanels:e,...t})=>{var n,a;const o=(()=>{const[e,t]=Object(r.useState)(0);return Object(r.useLayoutEffect)((()=>{function e(){t(window.innerWidth)}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)}),[]),e})(),{closeFlyout:c,panels:d}=l(),{left:p,right:m,preview:f}=d,E=Object(r.useMemo)((()=>e.find((e=>e.key===(null==p?void 0:p.id)))),[p,e]),x=Object(r.useMemo)((()=>e.find((e=>e.key===(null==m?void 0:m.id)))),[m,e]),j=f?f[f.length-1]:void 0,O=g(null==j||null===(n=j.params)||void 0===n?void 0:n.banner)?null==j||null===(a=j.params)||void 0===a?void 0:a.banner:void 0,S=!!f&&f.length>1,k=Object(r.useMemo)((()=>e.find((e=>e.key===(null==j?void 0:j.id)))),[j,e]),w=null!=x&&null!=m,T=null!=E&&null!=p,I=null!=k&&null!=f,{rightSectionWidth:C,leftSectionWidth:M,flyoutWidth:_,previewSectionLeft:A}=(({windowWidth:e,showRight:t,showLeft:n,showPreview:a})=>{let i=0;if(t)if(e<992)i=Math.min(380,e);else{const t=(e-992)/928*370;i=Math.min(380+t,750)}let r=0;n&&(r=e<=1600?e-i-48:Math.min(80*(e-i)/100,1500));let s=0;return a&&(s=r),{rightSectionWidth:i,leftSectionWidth:r,flyoutWidth:t&&n?`${i+r}px`:`${i}px`,previewSectionLeft:s}})({windowWidth:o,showRight:w,showLeft:T,showPreview:I});return p||m||null!=f&&f.length?Object(u.jsx)(s.EuiFlyout,i()({},t,{size:_,ownFocus:!1,onClose:c}),Object(u.jsx)(s.EuiFlexGroup,{direction:E?"row":"column",wrap:!1,gutterSize:"none",style:h,responsive:!1},T?Object(u.jsx)(v,{component:E.component({...p}),width:M}):null,w?Object(u.jsx)(y,{component:x.component({...m}),width:C}):null),I?Object(u.jsx)(b,{component:k.component({...j}),showBackButton:S,leftPosition:A,banner:O}):null):null};E.displayName="ExpandableFlyout";var x=n(60),j=n(310);const O={namespaces:{},timeoutHandle:0},S="url:update",k=["popstate",S],w=(e,t)=>{O.namespaces[e]||(O.namespaces[e]={});const[n,a]=Object(r.useState)(void 0);return Object(r.useEffect)((()=>{const n=()=>{const n=new URLSearchParams(window.location.search).get(e),i=n?Object(x.decode)(n):{},r=null==i?void 0:i[t];O.namespaces[e][t]=r,a(r)};return n(),k.forEach((e=>window.addEventListener(e,n))),()=>k.forEach((e=>window.removeEventListener(e,n)))}),[t,e]),[n,Object(r.useCallback)((n=>{const a=O.namespaces[e][t],i="object"==typeof n&&"object"==typeof a&&!Array.isArray(n)&&!Array.isArray(a);O.namespaces[e][t]=i?{...a,...n}:n,O.timeoutHandle&&window.clearTimeout(O.timeoutHandle),O.timeoutHandle=window.setTimeout((()=>{const e=Object(j.parse)(location.search);for(const t in O.namespaces)Object.prototype.hasOwnProperty.call(O.namespaces,t)&&(e[t]=encodeURIComponent(Object(x.encode)(O.namespaces[t])));const t=Object(j.stringify)(e,{encode:!1});if(window.location.search===t)return;const n=`${window.location.hash}?${t}`;window.history.pushState({},"",n),window.dispatchEvent(new Event(S))}),0)}),[t,e])]},T="eventFlyout",I=({children:e})=>{const{setRightPanelState:t,rightPanelState:n}=(()=>{const[e,t]=w(T,"rightPanel");return{rightPanelState:e,setRightPanelState:t}})(),{setLeftPanelState:a,leftPanelState:i}=(()=>{const[e,t]=w(T,"leftPanel");return{leftPanelState:e,setLeftPanelState:t}})(),{previewState:s,setPreviewState:l}=(()=>{const[e,t]=w(T,"preview");return{previewState:e,setPreviewState:t}})(),c=Object(r.useMemo)((()=>({left:i,right:n,preview:s||[]})),[i,s,n]),d=Object(r.useCallback)((({right:e,left:n,preview:i})=>{t(e),a(n),l(i?[i]:[])}),[t,a,l]),p=Object(r.useCallback)((e=>{t(e)}),[t]),m=Object(r.useCallback)((e=>a(e)),[a]),f=Object(r.useCallback)((e=>l([...null!=s?s:[],e])),[s,l]),g=Object(r.useCallback)((()=>t(void 0)),[t]),b=Object(r.useCallback)((()=>a(void 0)),[a]),y=Object(r.useCallback)((()=>l([])),[l]),v=Object(r.useCallback)((()=>l(null==s?void 0:s.slice(0,s.length-1))),[s,l]),h=Object(r.useCallback)((()=>{t(void 0),a(void 0),l([])}),[t,a,l]),E=Object(r.useMemo)((()=>({panels:c,openFlyout:d,openRightPanel:p,openLeftPanel:m,openPreviewPanel:f,closeRightPanel:g,closeLeftPanel:b,closePreviewPanel:y,closeFlyout:h,previousPreviewPanel:v})),[c,d,p,m,f,g,b,y,h,v]);return Object(u.jsx)(o.Provider,{value:E},e)};let C;!function(e){e.openFlyout="open_flyout",e.openRightPanel="open_right_panel",e.openLeftPanel="open_left_panel",e.openPreviewPanel="open_preview_panel",e.closeRightPanel="close_right_panel",e.closeLeftPanel="close_left_panel",e.closePreviewPanel="close_preview_panel",e.previousPreviewPanel="previous_preview_panel",e.closeFlyout="close_flyout"}(C||(C={}));const M={left:void 0,right:void 0,preview:[]};function _(e,t){switch(t.type){case C.openFlyout:{const{left:e,right:n,preview:a}=t.payload;return{left:e,right:n,preview:a?[a]:[]}}case C.openRightPanel:return{...e,right:t.payload};case C.openLeftPanel:return{...e,left:t.payload};case C.openPreviewPanel:return{...e,preview:[...e.preview,t.payload]};case C.closeRightPanel:return{...e,right:void 0};case C.closeLeftPanel:return{...e,left:void 0};case C.closePreviewPanel:return{...e,preview:[]};case C.previousPreviewPanel:{const t=[...e.preview];return t.pop(),{...e,preview:t}}case C.closeFlyout:return{left:void 0,right:void 0,preview:[]};default:return e}}const A=({children:e})=>{const[t,n]=Object(r.useReducer)(_,M),a=Object(r.useCallback)((({right:e,left:t,preview:a})=>n({type:C.openFlyout,payload:{left:t,right:e,preview:a}})),[n]),i=Object(r.useCallback)((e=>n({type:C.openRightPanel,payload:e})),[]),s=Object(r.useCallback)((e=>n({type:C.openLeftPanel,payload:e})),[]),l=Object(r.useCallback)((e=>n({type:C.openPreviewPanel,payload:e})),[]),c=Object(r.useCallback)((()=>n({type:C.closeRightPanel})),[]),d=Object(r.useCallback)((()=>n({type:C.closeLeftPanel})),[]),p=Object(r.useCallback)((()=>n({type:C.closePreviewPanel})),[]),m=Object(r.useCallback)((()=>n({type:C.previousPreviewPanel})),[]),f=Object(r.useCallback)((()=>{n({type:C.closeFlyout})}),[]),g=Object(r.useMemo)((()=>({panels:t,openFlyout:a,openRightPanel:i,openLeftPanel:s,openPreviewPanel:l,closeRightPanel:c,closeLeftPanel:d,closePreviewPanel:p,closeFlyout:f,previousPreviewPanel:m})),[t,a,i,s,l,c,d,p,f,m]);return Object(u.jsx)(o.Provider,{value:g},e)},P=({children:e,storage:t="url"})=>"memory"===t?Object(u.jsx)(A,null,e):Object(u.jsx)(I,null,e)},function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"n",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"l",(function(){return v})),n.d(t,"b",(function(){return h})),n.d(t,"e",(function(){return E})),n.d(t,"i",(function(){return x})),n.d(t,"j",(function(){return j})),n.d(t,"m",(function(){return O})),n.d(t,"k",(function(){return C}));var a=n(45),i=n(66),r=n(425),s=n(143),o=n(172),l=n(153),u=n(243);const c=(e,t)=>e.reduce(((e,n)=>{const a=[n,...n.and].filter((e=>e.enabled));if(!a.length)return e;const i=a.map((e=>((e,t)=>{const{excluded:n,type:a,queryMatch:{field:i,operator:r,value:u}}=e,c=Object(o.c)(i,t),d=n?"NOT ":"";switch(r){case l.d:return S({browserFields:t,field:i,isExcluded:d,isFieldTypeNested:c,type:a,value:u});case l.b:return`${d}${T({browserFields:t,field:i,isFieldTypeNested:c})}`;case l.c:return k({field:i,isExcluded:d,value:u});default:Object(s.a)(r)}})(e,t))),r=i.join(" and ");return[...e,r]}),[]).filter((e=>!Object(a.isEmpty)(e))).reduce(((e,t,n,a)=>a.length<=1?t:n?`${e} or (${t})`:`(${t})`),""),d="event-column-view",p=({globalFullScreen:e,graphEventId:t})=>!e||!(e=>null!=e&&""!==e)(t),m="1",f=2,g="local-events-count-button",b=({itemsCount:e,itemsPerPage:t})=>0===e||0===t?0:Math.ceil(e/t),y=e=>Object(i.elementOrChildrenHasFocus)(null==e?void 0:e.querySelector(`.${u.a}`)),v=({containerElement:e,keyboardEvent:t,onSkipFocusBeforeEventsTable:n,onSkipFocusAfterEventsTable:a})=>{const{shiftKey:r}=t,s=Object(i.getTableSkipFocus)({containerElement:e,getFocusedCell:i.getFocusedAriaColindexCell,shiftKey:r,tableHasFocus:y,tableClassName:u.a});"SKIP_FOCUS_NOOP"!==s&&(Object(i.stopPropagationAndPreventDefault)(t),Object(i.handleSkipFocus)({onSkipFocusBackwards:n,onSkipFocusForward:a,skipFocus:s}))},h="active-timeline-button",E="timeline-flyout-button-bar",x=()=>{setTimeout((()=>{var e;null===(e=document.querySelector(`div.${E} .${h}`))||void 0===e||e.focus()}),0)},j=e=>{var t;null==e||null===(t=e.querySelector("div.siemUtilityBar__action:last-of-type button"))||void 0===t||t.focus()},O=()=>{var e;null===(e=document.querySelector("header.headerGlobalNav a.chrHeaderLogo"))||void 0===e||e.focus()},S=({browserFields:e,field:t,isExcluded:n,isFieldTypeNested:a,type:i,value:r})=>C(r)?`${n}${t} : ${JSON.stringify(r)}`:`${n}${i!==l.a.template?w({browserFields:e,field:t,isFieldTypeNested:a,value:r}):T({browserFields:e,field:t,isFieldTypeNested:a})}`,k=({field:e,isExcluded:t,value:n})=>C(n)?`${t}${I({field:e,value:n})}`:`${t}${e} : ${JSON.stringify(n)}`,w=({browserFields:e,field:t,isFieldTypeNested:n,value:a})=>n?Object(o.h)(t,a,e):Object(o.b)(t,e)?Object(o.e)(t,a):`${t} : ${Object(r.a)(a)}`,T=({browserFields:e,field:t,isFieldTypeNested:n})=>n?Object(o.g)(t,e).trim():`${t} ${l.b}`.trim(),I=({field:e,value:t})=>{const n=e.trim();return t.length?`${n} : (${t.map((e=>Object(a.isNumber)(e)?e:Object(r.b)(String(e).trim()))).join(" OR ")})`:`${n} : ''`},C=e=>Array.isArray(e)&&(e.every((e=>"string"==typeof e))||e.every((e=>"number"==typeof e)))},function(e,t,n){"use strict";var a=n(52);n.d(t,"j",(function(){return a.getUseField})),n.d(t,"i",(function(){return a.getFieldValidityAndErrorMessage})),n.d(t,"a",(function(){return a.FIELD_TYPES})),n.d(t,"c",(function(){return a.Form})),n.d(t,"e",(function(){return a.UseField})),n.d(t,"f",(function(){return a.UseMultiFields})),n.d(t,"k",(function(){return a.useForm})),n.d(t,"l",(function(){return a.useFormContext})),n.d(t,"m",(function(){return a.useFormData})),n.d(t,"g",(function(){return a.VALIDATION_TYPES}));var i=n(71);n.d(t,"b",(function(){return i.Field})),n.d(t,"d",(function(){return i.SelectField}));var r=n(81);n.d(t,"h",(function(){return r.fieldValidators}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(45),i=n(2),r=n(48),s=n(119),o=n(112),l=n(128),u=n(181);const c=()=>{const e=Object(r.useDispatch)(),{from:t,to:n}=Object(o.a)((e=>Object(a.pick)(["from","to"],l.d.globalTimeRangeSelector(e)))),[c,d]=Object(i.useState)(!0),p=Object(i.useRef)([]),m=Object(i.useCallback)((({id:t,inspect:n,loading:a,refetch:i,searchSessionId:r})=>{p.current=[...p.current,t],e(u.c.setQuery({inputId:s.a.global,id:t,inspect:n,loading:a,refetch:i,searchSessionId:r}))}),[e]),f=Object(i.useCallback)((({id:t})=>e(u.c.deleteOneQuery({inputId:s.a.global,id:t}))),[e]);return Object(i.useEffect)((()=>{d(!1)}),[]),Object(i.useEffect)((()=>()=>{p.current.length>0&&p.current.forEach((e=>f({id:e})))}),[f]),Object(i.useMemo)((()=>({isInitializing:c,from:t,to:n,setQuery:m,deleteQuery:f})),[f,t,c,m,n])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return h})),n.d(t,"g",(function(){return E})),n.d(t,"h",(function(){return Ge})),n.d(t,"c",(function(){return Qe})),n.d(t,"f",(function(){return We})),n.d(t,"d",(function(){return Ke})),n.d(t,"e",(function(){return Je}));var a=n(111),i=n(141),r=n(363),s=n(365),o=n(362),l=n(323),u=n(366),c=n(367),d=n(368),p=n(369);const m=a.z.object({name:i.I,description:i.z,risk_score:i.p,severity:i.V}),f=a.z.object({rule_name_override:i.J.optional(),timestamp_override:i.ab.optional(),timestamp_override_fallback_disabled:i.bb.optional(),timeline_id:i.Y.optional(),timeline_title:i.Z.optional(),outcome:i.S.optional(),alias_target_id:i.R.optional(),alias_purpose:i.Q.optional(),license:i.G.optional(),note:i.h.optional(),building_block_type:i.d.optional(),output_index:i.b.optional(),namespace:i.c.optional(),meta:i.H.optional(),investigation_fields:i.g.optional(),throttle:i.x.optional()}),g=a.z.object({version:i.P.optional(),tags:i.O.optional(),enabled:i.i.optional(),risk_score_mapping:i.q.optional(),severity_mapping:i.W.optional(),interval:i.D.optional(),from:i.E.optional(),to:i.F.optional(),actions:a.z.array(i.r).optional(),exceptions_list:a.z.array(i.A).optional(),author:i.y.optional(),false_positives:i.B.optional(),references:i.M.optional(),max_signals:i.l.optional(),threat:i.X.optional()}),b=m.merge(f).merge(g),y=m.partial().merge(f).merge(g),v=m.merge(f).merge(g.required()),h=a.z.object({id:i.K,rule_id:i.N,immutable:i.j,updated_at:a.z.string().datetime(),updated_by:a.z.string(),created_at:a.z.string().datetime(),created_by:a.z.string(),revision:a.z.number().int().min(0),related_integrations:i.n,required_fields:i.o,setup:i.U,execution_summary:r.a.optional()}),E=b.merge(a.z.object({rule_id:i.N.optional()})),x=b.merge(a.z.object({id:i.K.optional(),rule_id:i.N.optional()})),j=y.merge(a.z.object({id:i.K.optional(),rule_id:i.N.optional()})),O=v.merge(h),S=a.z.literal("eql"),k=a.z.object({type:a.z.literal("eql"),query:i.L,language:S}),w=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),event_category_override:s.a.optional(),tiebreaker_field:s.b.optional(),timestamp_field:s.c.optional()}),T=k.merge(w),I=k.merge(w),C=k.partial().merge(w),M=O.merge(I),_=E.merge(T),A=x.merge(T),P=j.merge(C),F=a.z.object({type:a.z.literal("query")}),D=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),response_actions:a.z.array(o.a).optional(),alert_suppression:l.a.optional()}),N=a.z.object({query:i.L.optional(),language:i.k.optional()}),R=F.merge(D).merge(N),L=F.partial().merge(D).merge(N),z=F.merge(D).merge(N.required()),B=O.merge(z),q=E.merge(R),$=x.merge(R),V=j.merge(L),U=a.z.object({type:a.z.literal("saved_query"),saved_id:i.T}),H=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),response_actions:a.z.array(o.a).optional(),alert_suppression:l.a.optional(),query:i.L.optional()}),Z=a.z.object({language:i.k.optional()}),G=U.merge(H).merge(Z),Q=U.partial().merge(H).merge(Z),W=U.merge(H).merge(Z.required()),K=O.merge(W),J=E.merge(G),Y=x.merge(G),X=j.merge(Q),ee=a.z.object({type:a.z.literal("threshold"),query:i.L,threshold:u.a}),te=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),alert_suppression:u.b.optional()}),ne=a.z.object({language:i.k.optional()}),ae=ee.merge(te).merge(ne),ie=ee.partial().merge(te).merge(ne),re=ee.merge(te).merge(ne.required()),se=O.merge(re),oe=E.merge(ae),le=x.merge(ae),ue=j.merge(ie),ce=a.z.object({type:a.z.literal("threat_match"),query:i.L,threat_query:c.g,threat_mapping:c.f,threat_index:c.d}),de=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional(),saved_id:i.T.optional(),threat_filters:c.c.optional(),threat_indicator_path:c.e.optional(),threat_language:i.k.optional(),concurrent_searches:c.a.optional(),items_per_search:c.b.optional()}),pe=a.z.object({language:i.k.optional()}),me=ce.merge(de).merge(pe),fe=ce.partial().merge(de).merge(pe),ge=ce.merge(de).merge(pe.required()),be=O.merge(ge),ye=E.merge(me),ve=x.merge(me),he=j.merge(fe),Ee=a.z.object({type:a.z.literal("machine_learning"),anomaly_threshold:d.a,machine_learning_job_id:d.b}),xe=Ee.partial(),je=Ee,Oe=Ee,Se=O.merge(je),ke=E.merge(Oe),we=x.merge(Oe),Te=j.merge(xe),Ie=a.z.object({type:a.z.literal("new_terms"),query:i.L,new_terms_fields:p.b,history_window_start:p.a}),Ce=a.z.object({index:i.f.optional(),data_view_id:i.e.optional(),filters:i.C.optional()}),Me=a.z.object({language:i.k.optional()}),_e=Ie.partial().merge(Ce).merge(Me),Ae=Ie.merge(Ce).merge(Me.required()),Pe=Ie.merge(Ce).merge(Me),Fe=O.merge(Ae),De=E.merge(Pe),Ne=x.merge(Pe),Re=j.merge(_e),Le=a.z.literal("esql"),ze=a.z.object({type:a.z.literal("esql"),language:Le,query:i.L}),Be=ze.partial(),qe=ze,$e=ze,Ve=O.merge(qe),Ue=E.merge($e),He=x.merge($e),Ze=j.merge(Be.partial()),Ge=a.z.discriminatedUnion("type",[T,R,G,ae,me,Oe,Pe,$e]),Qe=(a.z.union([C,L,Q,ie,fe,xe,_e,Be]),a.z.discriminatedUnion("type",[I,z,W,re,ge,je,Ae,qe]),a.z.discriminatedUnion("type",[_,q,J,oe,ye,ke,De,Ue])),We=a.z.discriminatedUnion("type",[A,$,Y,le,ve,we,Ne,He]),Ke=a.z.union([P,V,X,ue,he,Te,Re,Ze]),Je=a.z.discriminatedUnion("type",[M,B,K,se,be,Se,Fe,Ve])},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return b}));var a={};n.r(a),n.d(a,"setDataView",(function(){return s})),n.d(a,"setDataViewLoading",(function(){return o})),n.d(a,"setSignalIndexName",(function(){return l})),n.d(a,"setSourcererDataViews",(function(){return u})),n.d(a,"setSourcererScopeLoading",(function(){return c})),n.d(a,"setSelectedDataView",(function(){return d}));var i=n(26);const r=n.n(i)()("x-pack/security_solution/local/sourcerer"),s=r("SET_DATA_VIEW"),o=r("SET_DATA_VIEW_LOADING"),l=r("SET_SIGNAL_INDEX_NAME"),u=r("SET_SOURCERER_DATA_VIEWS"),c=r("SET_SOURCERER_SCOPE_LOADING"),d=r("SET_SELECTED_DATA_VIEW");var p=n(116),m=n(578),f=n(187),g=n(392);const b=Object(f.reducerWithInitialState)(p.initialSourcererState).case(l,((e,{signalIndexName:t})=>({...e,signalIndexName:t}))).case(o,((e,{id:t,loading:n})=>({...e,...t===e.defaultDataView.id?{defaultDataView:{...e.defaultDataView,loading:n}}:{},kibanaDataViews:e.kibanaDataViews.map((e=>e.id===t?{...e,loading:n}:e))}))).case(u,((e,{defaultDataView:t,kibanaDataViews:n})=>({...e,defaultDataView:{...e.defaultDataView,...t},kibanaDataViews:n.map((t=>{var n;return{...null!==(n=e.kibanaDataViews.find((({id:e})=>e===t.id)))&&void 0!==n?n:p.initDataView,...t}}))}))).case(c,((e,{id:t,loading:n})=>({...e,sourcererScopes:{...e.sourcererScopes,...null!=t?{[t]:{...e.sourcererScopes[t],loading:n}}:{[p.SourcererScopeName.default]:{...e.sourcererScopes[p.SourcererScopeName.default],loading:n},[p.SourcererScopeName.detections]:{...e.sourcererScopes[p.SourcererScopeName.detections],loading:n},[p.SourcererScopeName.timeline]:{...e.sourcererScopes[p.SourcererScopeName.timeline],loading:n}}}}))).case(d,((e,t)=>{const{shouldValidateSelectedPatterns:n=!0,...a}=t;return{...e,sourcererScopes:{...e.sourcererScopes,...Object(g.c)(e,a,n)}}})).case(s,((e,t)=>({...e,...t.id===e.defaultDataView.id?{defaultDataView:{...e.defaultDataView,...t}}:{},kibanaDataViews:e.kibanaDataViews.map((e=>e.id===t.id?{...e,...t}:e))}))).build()},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(111);let i,r,s,o,l,u,c;!function(e){e.details="hostDetails",e.hosts="hosts",e.overview="overviewHost",e.uncommonProcesses="uncommonProcesses"}(i||(i={})),function(e){e.dns="networkKpiDns",e.networkEvents="networkKpiNetworkEvents",e.tlsHandshakes="networkKpiTlsHandshakes",e.uniqueFlows="networkKpiUniqueFlows",e.uniquePrivateIps="networkKpiUniquePrivateIps"}(r||(r={})),function(e){e.kpiHosts="hostsKpiHosts",e.kpiUniqueIps="hostsKpiUniqueIps"}(s||(s={})),function(e){e.observedDetails="observedUserDetails",e.managedDetails="managedUserDetails",e.kpiTotalUsers="usersKpiTotalUsers",e.users="allUsers",e.authentications="authentications",e.kpiAuthentications="usersKpiAuthentications"}(o||(o={})),function(e){e.details="networkDetails",e.dns="dns",e.http="http",e.overview="overviewNetwork",e.tls="tls",e.topCountries="topCountries",e.topNFlow="topNFlow",e.users="users"}(l||(l={})),function(e){e.hostsRiskScore="hostsRiskScore",e.usersRiskScore="usersRiskScore",e.kpiRiskScore="kpiRiskScore"}(u||(u={})),function(e){e.eventEnrichment="eventEnrichment",e.dataSource="dataSource"}(c||(c={}));const d="matrixHistogram",p="firstlastseen";let m;!function(e){e.relatedHosts="relatedHosts",e.relatedUsers="relatedUsers"}(m||(m={}));const f=a.z.object({match:a.z.record(a.z.string(),a.z.object({query:a.z.string(),operator:a.z.string(),zero_terms_query:a.z.string()}))}),g=a.z.object({query_string:a.z.object({query:a.z.string(),analyze_wildcard:a.z.boolean()})}),b=a.z.object({term:a.z.record(a.z.string(),a.z.string())}),y=a.z.object({bool:a.z.object({filter:a.z.array(a.z.object({})),must:a.z.array(a.z.object({})),must_not:a.z.array(a.z.object({})),should:a.z.array(a.z.object({}))})}),v=a.z.object({range:a.z.record(a.z.string(),a.z.object({gte:a.z.number(),lte:a.z.number(),format:a.z.string()}))}),h=a.z.record(a.z.string(),a.z.any()),E=(a.z.union([v,g,f,b,y,h]),a.z.union([a.z.string(),a.z.any()]).optional()),x=a.z.object({interval:a.z.string(),from:a.z.string(),to:a.z.string()}),j=a.z.object({timerange:x.optional(),filterQuery:E,defaultIndex:a.z.array(a.z.string()).optional(),id:a.z.string().optional(),params:a.z.any().optional()}),O=j.extend({eventFields:a.z.record(a.z.unknown()),timerange:x,factoryQueryType:a.z.literal(c.eventEnrichment)}),S=j.extend({factoryQueryType:a.z.literal(c.dataSource)});var k=n(636);const w=a.z.union([a.z.object({dsl:a.z.array(a.z.string())}).nullable(),a.z.boolean()]).optional(),T=j.extend({order:k.b,field:a.z.string(),value:a.z.string(),factoryQueryType:a.z.literal(p)}),I=(a.z.object({firstSeen:a.z.string().nullable(),lastSeen:a.z.string().nullable(),inspect:w}).partial(),a.z.object({activePage:a.z.number(),cursorStart:a.z.number(),fakePossibleCount:a.z.number(),querySize:a.z.number()}).default({activePage:0,cursorStart:0,fakePossibleCount:0,querySize:0}));var C=n(227);const M=j.extend({sort:C.b,pagination:I,timerange:x,isNewRiskScoreModuleInstalled:a.z.boolean().default(!1),factoryQueryType:a.z.literal(i.hosts)}),_=j.extend({hostName:a.z.string(),skip:a.z.boolean().optional(),inspect:w,pagination:I.optional(),timerange:x,sort:C.b,factoryQueryType:a.z.literal(i.details)}),A=j.extend({factoryQueryType:a.z.literal(i.overview),timerange:x});var P=n(188);const F=j.extend({sort:P.a,pagination:I,timerange:x,factoryQueryType:a.z.literal(i.uncommonProcesses)}),D=j.extend({sort:C.b,pagination:I,timerange:x,factoryQueryType:a.z.literal(s.kpiHosts)}),N=j.extend({sort:C.b,pagination:I,timerange:x,factoryQueryType:a.z.literal(s.kpiUniqueIps)}),R=a.z.record(a.z.object({type:a.z.union([a.z.literal("boolean"),a.z.literal("date"),a.z.literal("double"),a.z.literal("geo_point"),a.z.literal("ip"),a.z.literal("keyword"),a.z.literal("long"),a.z.literal("lookup")]),script:a.z.union([a.z.string(),a.z.object({source:a.z.string()}),a.z.object({id:a.z.string(),params:a.z.record(a.z.any())})]).optional(),fetch_fields:a.z.array(a.z.string()).optional(),format:a.z.string().optional(),input_field:a.z.string().optional(),target_field:a.z.string().optional(),target_index:a.z.string().optional()})).optional();let L;!function(e){e.authentications="authentications",e.anomalies="anomalies",e.events="events",e.alerts="alerts",e.dns="dns",e.preview="preview"}(L||(L={}));const z=j.extend({histogramType:a.z.enum([L.alerts,L.anomalies,L.authentications,L.dns,L.events,L.preview]),stackByField:a.z.string().optional(),threshold:a.z.object({field:a.z.array(a.z.string()),value:a.z.string(),cardinality:a.z.object({field:a.z.array(a.z.string()),value:a.z.string()}).optional()}).optional(),inspect:w,isPtrIncluded:a.z.boolean().default(!1),includeMissingData:a.z.boolean().default(!0),runtimeMappings:R,timerange:x,factoryQueryType:a.z.literal(d)}),B=j.extend({ip:a.z.string().ip(),factoryQueryType:a.z.literal(l.details)}),q=j.extend({pagination:I,sort:C.b});let $;!function(e){e.dnsName="dnsName",e.queryCount="queryCount",e.uniqueDomains="uniqueDomains",e.dnsBytesIn="dnsBytesIn",e.dnsBytesOut="dnsBytesOut"}($||($={}));const V=q.extend({isPtrIncluded:a.z.boolean().default(!1),stackByField:a.z.string().optional(),sort:P.a,timerange:x,factoryQueryType:a.z.literal(l.dns)}),U=q.extend({ip:a.z.string().ip().optional(),defaultIndex:a.z.array(a.z.string()).min(1).optional(),timerange:x,sort:P.a,factoryQueryType:a.z.literal(l.http)}),H=j.extend({timerange:x,factoryQueryType:a.z.literal(r.dns)}),Z=j.extend({timerange:x,factoryQueryType:a.z.literal(r.networkEvents)}),G=j.extend({timerange:x,factoryQueryType:a.z.literal(r.tlsHandshakes)}),Q=j.extend({timerange:x,factoryQueryType:a.z.literal(r.uniqueFlows)}),W=j.extend({timerange:x,factoryQueryType:a.z.literal(r.uniquePrivateIps)}),K=j.extend({timerange:x,factoryQueryType:a.z.literal(l.overview)});let J;!function(e){e.destination="destination",e.source="source"}(J||(J={}));const Y=a.z.enum([J.destination,J.source]);let X;!function(e){e._id="_id"}(X||(X={}));const ee=q.extend({ip:a.z.string().optional(),flowTarget:Y,sort:P.a,timerange:x,factoryQueryType:a.z.literal(l.tls)}),te=q.extend({ip:a.z.string().ip().optional(),flowTarget:Y,sort:P.a,filterQuery:E,timerange:x,factoryQueryType:a.z.literal(l.topCountries)}),ne=q.extend({ip:a.z.string().ip().nullable().optional(),flowTarget:Y,sort:P.a,timerange:x,factoryQueryType:a.z.literal(l.topNFlow)});let ae;!function(e){e.name="name",e.count="count"}(ae||(ae={}));const ie=q.extend({ip:a.z.string().ip(),flowTarget:Y,sort:P.a,timerange:x,factoryQueryType:a.z.literal(l.users)}),re=j.extend({userName:a.z.string(),skip:a.z.boolean().optional(),from:a.z.string(),inspect:w,isNewRiskScoreModuleInstalled:a.z.boolean().default(!1),factoryQueryType:a.z.literal(m.relatedHosts)}),se=j.extend({hostName:a.z.string(),skip:a.z.boolean().optional(),from:a.z.string(),inspect:w,isNewRiskScoreModuleInstalled:a.z.boolean().default(!1),factoryQueryType:a.z.literal(m.relatedUsers)});let oe;!function(e){e.host="host",e.user="user"}(oe||(oe={}));const le=a.z.enum([oe.host,oe.user]);let ue;!function(e){e.timestamp="@timestamp",e.hostName="host.name",e.hostRiskScore="host.risk.calculated_score_norm",e.hostRisk="host.risk.calculated_level",e.userName="user.name",e.userRiskScore="user.risk.calculated_score_norm",e.userRisk="user.risk.calculated_level",e.alertsCount="alertsCount"}(ue||(ue={}));const ce=j.extend({alertsTimerange:x.optional(),riskScoreEntity:le,includeAlertsCount:a.z.boolean().optional(),onlyLatest:a.z.boolean().optional(),pagination:a.z.object({cursorStart:a.z.number(),querySize:a.z.number()}).optional(),sort:P.a.removeDefault().extend({field:a.z.enum([ue.timestamp,ue.hostName,ue.hostRiskScore,ue.hostRisk,ue.userName,ue.userRiskScore,ue.userRisk,ue.alertsCount])}).optional()}),de=ce.extend({factoryQueryType:a.z.literal(u.hostsRiskScore)}),pe=ce.extend({factoryQueryType:a.z.literal(u.usersRiskScore)}),me=(a.z.union([de,pe]),j.extend({entity:le,factoryQueryType:a.z.literal(u.kpiRiskScore)})),fe=j.extend({userName:a.z.string(),skip:a.z.boolean().optional(),timerange:x,inspect:w,factoryQueryType:a.z.literal(o.observedDetails)}),ge=j.extend({userName:a.z.string(),userEmail:a.z.array(a.z.string()).optional(),factoryQueryType:a.z.literal(o.managedDetails)}),be=j.extend({timerange:x,factoryQueryType:a.z.literal(o.kpiTotalUsers)}),ye=j.extend({timerange:x,factoryQueryType:a.z.literal(o.kpiAuthentications)});let ve;!function(e){e.name="name",e.domain="domain",e.lastSeen="lastSeen"}(ve||(ve={}));const he=q.extend({sort:P.a.removeDefault().extend({field:a.z.enum([ve.name,ve.lastSeen])}),timerange:x,isNewRiskScoreModuleInstalled:a.z.boolean().default(!1),factoryQueryType:a.z.literal(o.users)});let Ee;!function(e){e.userName="user.name",e.hostName="host.name"}(Ee||(Ee={}));const xe=q.extend({stackByField:a.z.enum([Ee.userName,Ee.hostName]),timerange:x,factoryQueryType:a.z.literal(o.authentications)});a.z.discriminatedUnion("factoryQueryType",[T,M,_,D,N,A,F,he,fe,ge,be,ye,xe,de,pe,me,re,se,B,V,U,K,ee,te,ne,ie,H,Z,G,Q,W,z,S,O])},function(e,t,n){"use strict";n.d(t,"e",(function(){return a.b})),n.d(t,"a",(function(){return a.a})),n.d(t,"g",(function(){return a.d})),n.d(t,"f",(function(){return a.c})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(122);const i="open",r="closed",s="acknowledged"},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return l}));var a=n(2);const i=()=>{const e=Object(a.useRef)(!1),t=Object(a.useCallback)((()=>e.current),[]),n=Object(a.useCallback)((()=>{e.current=!1}),[]);return Object(a.useEffect)((()=>(e.current=!0,n)),[n]),t},r=e=>{const t=i(),[n,r]=Object(a.useState)(!1),[s,o]=Object(a.useState)(),[l,u]=Object(a.useState)();return{error:s,loading:n,result:l,start:Object(a.useCallback)(((...n)=>{r(!0),u(void 0),o(void 0),e(...n).then((e=>t()&&u(e))).catch((e=>t()&&o(e))).finally((()=>t()&&r(!1)))}),[e,t])}};function s(e,t){switch(t.type){case"setResult":return{...e,result:t.result,loading:!1};case"setError":return{...e,error:t.error,loading:!1};case"load":return{loading:!0,result:void 0,error:void 0}}}const o=e=>{const t=i(),n=Object(a.useRef)(),[r,o]=Object(a.useReducer)(s,{loading:!1,error:void 0,result:void 0}),l=Object(a.useCallback)(((...a)=>{n.current&&n.current.unsubscribe(),o({type:"load"}),n.current=e(...a).subscribe((e=>{t()&&o({type:"setResult",result:e})}),(e=>{t()&&o({type:"setError",error:e})}))}),[e,t]);return Object(a.useEffect)((()=>()=>{n.current&&n.current.unsubscribe()}),[]),{result:r.result,error:r.error,loading:r.loading,start:l}},l=e=>t=>{const n=null!=t.signal?t.signal:(new AbortController).signal;return e({...t,signal:n})}},function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return s}));const a=":",i=":*",r="includes";let s;!function(e){e.default="default",e.template="template"}(s||(s={}))},function(e,t,n){"use strict";n.d(t,"cc",(function(){return i})),n.d(t,"Lb",(function(){return r})),n.d(t,"Nb",(function(){return s})),n.d(t,"ad",(function(){return o})),n.d(t,"Zc",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"bc",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"Bb",(function(){return p})),n.d(t,"dc",(function(){return m})),n.d(t,"f",(function(){return f})),n.d(t,"r",(function(){return g})),n.d(t,"p",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"q",(function(){return v})),n.d(t,"m",(function(){return h})),n.d(t,"t",(function(){return E})),n.d(t,"w",(function(){return x})),n.d(t,"g",(function(){return j})),n.d(t,"n",(function(){return O})),n.d(t,"i",(function(){return S})),n.d(t,"o",(function(){return k})),n.d(t,"j",(function(){return w})),n.d(t,"h",(function(){return T})),n.d(t,"v",(function(){return I})),n.d(t,"u",(function(){return C})),n.d(t,"W",(function(){return M})),n.d(t,"U",(function(){return _})),n.d(t,"V",(function(){return A})),n.d(t,"Y",(function(){return P})),n.d(t,"A",(function(){return F})),n.d(t,"l",(function(){return D})),n.d(t,"y",(function(){return N})),n.d(t,"k",(function(){return R})),n.d(t,"z",(function(){return L})),n.d(t,"X",(function(){return z})),n.d(t,"S",(function(){return B})),n.d(t,"K",(function(){return q})),n.d(t,"B",(function(){return $})),n.d(t,"M",(function(){return V})),n.d(t,"C",(function(){return U})),n.d(t,"E",(function(){return H})),n.d(t,"F",(function(){return Z})),n.d(t,"D",(function(){return G})),n.d(t,"L",(function(){return Q})),n.d(t,"N",(function(){return W})),n.d(t,"O",(function(){return K})),n.d(t,"G",(function(){return J})),n.d(t,"P",(function(){return Y})),n.d(t,"H",(function(){return X})),n.d(t,"T",(function(){return ee})),n.d(t,"J",(function(){return te})),n.d(t,"I",(function(){return ne})),n.d(t,"Q",(function(){return ae})),n.d(t,"R",(function(){return ie})),n.d(t,"Gb",(function(){return re})),n.d(t,"Pc",(function(){return se})),n.d(t,"Oc",(function(){return oe})),n.d(t,"Uc",(function(){return le})),n.d(t,"Sc",(function(){return ue})),n.d(t,"ab",(function(){return ce})),n.d(t,"Rc",(function(){return de})),n.d(t,"Cb",(function(){return pe})),n.d(t,"Qb",(function(){return me})),n.d(t,"Rb",(function(){return fe})),n.d(t,"Ab",(function(){return ge})),n.d(t,"Hb",(function(){return be})),n.d(t,"xb",(function(){return ye})),n.d(t,"mb",(function(){return ve})),n.d(t,"lb",(function(){return he})),n.d(t,"nb",(function(){return Ee})),n.d(t,"gb",(function(){return xe})),n.d(t,"ib",(function(){return je})),n.d(t,"hb",(function(){return Oe})),n.d(t,"pb",(function(){return Se})),n.d(t,"bb",(function(){return ke})),n.d(t,"ob",(function(){return we})),n.d(t,"eb",(function(){return Te})),n.d(t,"fb",(function(){return Ie})),n.d(t,"jb",(function(){return Ce})),n.d(t,"kb",(function(){return Me})),n.d(t,"cb",(function(){return _e})),n.d(t,"db",(function(){return Ae})),n.d(t,"Eb",(function(){return Pe})),n.d(t,"zb",(function(){return Fe})),n.d(t,"rb",(function(){return De})),n.d(t,"Db",(function(){return Ne})),n.d(t,"Xc",(function(){return Re})),n.d(t,"Qc",(function(){return Le})),n.d(t,"Fc",(function(){return ze})),n.d(t,"Yb",(function(){return Be})),n.d(t,"Hc",(function(){return qe})),n.d(t,"Sb",(function(){return $e})),n.d(t,"Xb",(function(){return Ve})),n.d(t,"Tb",(function(){return Ue})),n.d(t,"Ub",(function(){return He})),n.d(t,"Vb",(function(){return Ze})),n.d(t,"Wb",(function(){return Ge})),n.d(t,"sb",(function(){return Qe})),n.d(t,"b",(function(){return We})),n.d(t,"Nc",(function(){return Ke})),n.d(t,"Gc",(function(){return Je})),n.d(t,"tb",(function(){return Ye})),n.d(t,"a",(function(){return Xe})),n.d(t,"Mc",(function(){return et})),n.d(t,"c",(function(){return tt})),n.d(t,"Zb",(function(){return nt})),n.d(t,"qb",(function(){return at})),n.d(t,"ub",(function(){return it})),n.d(t,"Mb",(function(){return rt})),n.d(t,"Tc",(function(){return st})),n.d(t,"Ob",(function(){return ot})),n.d(t,"ac",(function(){return lt})),n.d(t,"Wc",(function(){return ut})),n.d(t,"Jb",(function(){return ct})),n.d(t,"Kb",(function(){return dt})),n.d(t,"x",(function(){return pt})),n.d(t,"Vc",(function(){return mt})),n.d(t,"wb",(function(){return ft})),n.d(t,"vb",(function(){return gt})),n.d(t,"ec",(function(){return bt})),n.d(t,"Z",(function(){return yt})),n.d(t,"Dc",(function(){return vt})),n.d(t,"Ec",(function(){return ht})),n.d(t,"Cc",(function(){return Et})),n.d(t,"Ac",(function(){return xt})),n.d(t,"Bc",(function(){return jt})),n.d(t,"pc",(function(){return Ot})),n.d(t,"qc",(function(){return St})),n.d(t,"nc",(function(){return kt})),n.d(t,"oc",(function(){return wt})),n.d(t,"hc",(function(){return Tt})),n.d(t,"ic",(function(){return It})),n.d(t,"fc",(function(){return Ct})),n.d(t,"gc",(function(){return Mt})),n.d(t,"yc",(function(){return _t})),n.d(t,"zc",(function(){return At})),n.d(t,"wc",(function(){return Pt})),n.d(t,"xc",(function(){return Ft})),n.d(t,"lc",(function(){return Dt})),n.d(t,"mc",(function(){return Nt})),n.d(t,"jc",(function(){return Rt})),n.d(t,"kc",(function(){return Lt})),n.d(t,"tc",(function(){return zt})),n.d(t,"vc",(function(){return Bt})),n.d(t,"uc",(function(){return qt})),n.d(t,"rc",(function(){return $t})),n.d(t,"sc",(function(){return Vt})),n.d(t,"Lc",(function(){return Ut})),n.d(t,"Ic",(function(){return Ht})),n.d(t,"Fb",(function(){return Zt})),n.d(t,"yb",(function(){return Gt})),n.d(t,"Jc",(function(){return Qt})),n.d(t,"Pb",(function(){return Wt})),n.d(t,"Yc",(function(){return Kt})),n.d(t,"Ib",(function(){return Jt})),n.d(t,"Kc",(function(){return Yt}));var a=n(5);const i=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.popoverTooltip.ariaLabel",{defaultMessage:"Tooltip for column: {columnName}",values:{columnName:e}}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.importRuleTitle",{defaultMessage:"Import rules"}),s=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.importValueListsButton",{defaultMessage:"Import value lists"}),o=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonTooltip",{defaultMessage:"Use value lists to create an exception when a field value matches a value found in a list"}),l=a.i18n.translate("xpack.securitySolution.lists.detectionEngine.rules.uploadValueListsButtonPrivilegesTooltip",{defaultMessage:"A user with manage cluster privileges must visit the Rules page before you can import value lists."}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addNewRuleTitle",{defaultMessage:"Create new rule"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.pageTitle",{defaultMessage:"Rules"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addPageTitle",{defaultMessage:"Create"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.editPageTitle",{defaultMessage:"Edit"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.refreshTitle",{defaultMessage:"Refresh"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.batchActionsTitle",{defaultMessage:"Bulk actions"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enableTitle",{defaultMessage:"Enable"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disableTitle",{defaultMessage:"Disable"}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.exportTitle",{defaultMessage:"Export"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicateTitle",{defaultMessage:"Duplicate"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTitle",{defaultMessage:"Delete"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.indexPatternsTitle",{defaultMessage:"Index patterns"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.tagsTitle",{defaultMessage:"Tags"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addTagsTitle",{defaultMessage:"Add tags"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.deleteTagsTitle",{defaultMessage:"Delete tags"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.applyTimelineTemplateTitle",{defaultMessage:"Apply Timeline template"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.addRuleActionsTitle",{defaultMessage:"Add rule actions"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.setScheduleTitle",{defaultMessage:"Update rule schedules"}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.contextMenuTitle",{defaultMessage:"Options"}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastTitle",{defaultMessage:"Rules updates are in progress"}),_=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} updating."}),A=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditWarningToastNotifyButtonLabel",{defaultMessage:"Notify me when done"}),P=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkExportConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be exported"}),F=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkEditConfirmationDeniedTitle",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule} other {# rules}} cannot be edited"}),D=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.bulkActionConfirmationPartlyTitle",{values:{customRulesCount:e},defaultMessage:"This action can only be applied to {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),N=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmationCancelButtonLabel",{defaultMessage:"Cancel"}),R=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkActionConfirmationCloseButtonLabel",{defaultMessage:"Close"}),L=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Edit {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),z=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkExportConfirmation.confirmButtonLabel",{values:{customRulesCount:e},defaultMessage:"Export {customRulesCount, plural, =1 {# custom rule} other {# custom rules}}"}),B=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.saveButtonLabel",{defaultMessage:"Save"}),q=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.cancelButtonLabel",{defaultMessage:"Cancel"}),$=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to add. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),V=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxHelpText",{defaultMessage:"Enter the pattern of Elasticsearch indices that you would like to delete. By default, the dropdown includes index patterns defined in Security Solution advanced settings."}),U=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsComboboxLabel",{defaultMessage:"Add index patterns for selected rules"}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.indexPatternsRequiredErrorMessage",{defaultMessage:"A minimum of one index pattern is required."}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsTitle",{defaultMessage:"Add index patterns"}),G=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addIndexPatternsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' index patterns"}),Q=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.dataViewsOverwriteCheckboxLabel",{defaultMessage:"Apply changes to rules configured with data views"}),W=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsComboboxLabel",{defaultMessage:"Delete index patterns for selected rules"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteIndexPatternsTitle",{defaultMessage:"Delete index patterns"}),J=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxHelpText",{defaultMessage:"Add one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),Y=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxHelpText",{defaultMessage:"Delete one or more tags for selected rules from the dropdown. You can also enter custom identifying tags and press Enter to begin a new one."}),X=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsComboboxLabel",{defaultMessage:"Add tags for selected rules"}),ee=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.tagsComoboxRequiredErrorMessage",{defaultMessage:"A minimum of one tag is required."}),te=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsTitle",{defaultMessage:"Add tags"}),ne=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.addTagsOverwriteCheckboxLabel",{defaultMessage:"Overwrite all selected rules' tags"}),ae=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsComboboxLabel",{defaultMessage:"Delete tags for selected rules"}),ie=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkActions.bulkEditFlyoutForm.deleteTagsTitle",{defaultMessage:"Delete tags"}),re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.exportFilenameTitle",{defaultMessage:"rules_export"}),se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchAriaLabel",{defaultMessage:"Search rules"}),oe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.searchPlaceholder",{defaultMessage:'Rule name, index pattern (e.g., "filebeat-*"), or MITRE ATT&CKâ„¢ tactic or technique (e.g., "Defense Evasion" or "TA0005")'}),le=(e,t,n)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.showingRulesTitle",{values:{firstInPage:e,lastOfPage:t,totalRules:n},defaultMessage:"Showing {firstInPage}-{lastOfPage} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ue=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectAllRulesTitle",{values:{totalRules:e},defaultMessage:"Select all {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.clearSelectionTitle",{defaultMessage:"Clear selection"}),de=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.selectedRulesTitle",{values:{selectedRules:e},defaultMessage:"Selected {selectedRules} {selectedRules, plural, =1 {rule} other {rules}}"}),pe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.editRuleSettingsDescription",{defaultMessage:"Edit rule settings"}),me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaActionsFeaturePrivileges",{defaultMessage:"You do not have Kibana Actions privileges"}),fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.lackOfKibanaSecurityPrivileges",{defaultMessage:"You do not have Kibana Security privileges"}),ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.duplicateRuleDescription",{defaultMessage:"Duplicate rule"}),be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.exportRuleDescription",{defaultMessage:"Export rule"}),ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.actions.deleteRuleDescription",{defaultMessage:"Delete rule"}),ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.ruleTitle",{defaultMessage:"Rule"}),he=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.riskScoreTitle",{defaultMessage:"Risk score"}),Ee=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.severityTitle",{defaultMessage:"Severity"}),xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastRunTitle",{defaultMessage:"Last run"}),je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastUpdateTitle",{defaultMessage:"Last updated"}),Oe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.lastResponseTitle",{defaultMessage:"Last response"}),Se=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.tagsTitle",{defaultMessage:"Tags"}),ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.enabledTitle",{defaultMessage:"Enabled"}),we=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.snoozeTitle",{defaultMessage:"Notify"}),Te=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimes",{defaultMessage:"Indexing Time (ms)"}),Ie=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.indexingTimesTooltip",{defaultMessage:"Total time spent indexing alerts during last Rule execution"}),Ce=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimes",{defaultMessage:"Query Time (ms)"}),Me=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.queryTimesTooltip",{defaultMessage:"Total time spent querying source indices during last Rule execution"}),_e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gap",{defaultMessage:"Last Gap (if any)"}),Ae=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.columns.gapTooltipSeeDocsDescription",{defaultMessage:"see documentation"}),Pe=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.rules",{defaultMessage:"Rules"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.tabs.monitoring",{defaultMessage:"Rule Monitoring"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.enabledRulesTitle",{defaultMessage:"Enabled rules"})),Fe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.disabledRulesTitle",{defaultMessage:"Disabled rules"}),De=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.customRulesTitle",{defaultMessage:"Custom rules"}),Ne=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.elasticRulesTitle",{defaultMessage:"Elastic rules"}),Re=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.tagsLabel",{defaultMessage:"Tags"}),Le=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.searchTagsPlaceholder",{defaultMessage:"Search tags"}),ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.rulesTagSearchText",{defaultMessage:"Rules tag search"}),Be=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noTagsAvailableDescription",{defaultMessage:"No tags available"}),qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.ruleExecutionStatusFilter",{defaultMessage:"Select rule execution status to filter by"}),$e=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesTitle",{defaultMessage:"No rules found"}),Ve=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.filters.noRulesBodyTitle",{defaultMessage:"We weren't able to find any rules with the above filters."}),Ue=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesTitle",{defaultMessage:"All Elastic rules have been installed"}),He=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.addRules.noRulesBodyTitle",{defaultMessage:"There are no prebuilt detection rules available for installation"}),Ze=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesTitle",{defaultMessage:"All Elastic rules are up to date"}),Ge=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.upgradeRules.noRulesBodyTitle",{defaultMessage:"There are currently no available updates to your installed Elastic rules."}),Qe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.defineRuleTitle",{defaultMessage:"Define rule"}),We=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.aboutRuleTitle",{defaultMessage:"About rule"}),Ke=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.scheduleRuleTitle",{defaultMessage:"Schedule rule"}),Je=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.ruleActionsTitle",{defaultMessage:"Rule actions"}),Ye=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepDefinitionTitle",{defaultMessage:"Definition"}),Xe=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepAboutTitle",{defaultMessage:"About"}),et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepScheduleTitle",{defaultMessage:"Schedule"}),tt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.stepActionsTitle",{defaultMessage:"Actions"}),nt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.optionalFieldDescription",{defaultMessage:"Optional"}),at=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.continueButtonTitle",{defaultMessage:"Continue"}),it=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.updateButtonTitle",{defaultMessage:"Update"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.deleteDescription",{defaultMessage:"Delete"})),rt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importRuleTitle",{defaultMessage:"Import"}),st=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.selectRuleDescription",{defaultMessage:"Select rules to import. Associated rule actions and exceptions can be included."}),ot=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.initialPromptTextDescription",{defaultMessage:"Select or drag and drop a valid rules_export.ndjson file"}),lt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteDescription",{defaultMessage:'Overwrite existing detection rules with conflicting "rule_id"'}),ut=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.successfullyImportedRulesTitle",{values:{totalRules:e},defaultMessage:"Successfully imported {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),ct=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedTitle",{values:{totalRules:e},defaultMessage:"Failed to import {totalRules} {totalRules, plural, =1 {rule} other {rules}}"}),dt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importFailedDetailedTitle",{values:{message:e},defaultMessage:"{message}"}),pt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.bulkDeleteConfirmationTitle",{defaultMessage:"Confirm bulk deletion"}),mt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.singleDeleteConfirmationTitle",{defaultMessage:"Confirm deletion"}),ft=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationConfirm",{defaultMessage:"Delete"}),gt=a.i18n.translate("xpack.securitySolution.detectionEngine.components.allRules.deleteConfirmationCancel",{defaultMessage:"Cancel"}),bt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverDescription",{defaultMessage:"Automatically refresh table"}),yt=(a.i18n.translate("xpack.securitySolution.detectionEngine.rules.refreshRulePopoverLabel",{defaultMessage:"Refresh settings"}),a.i18n.translate("xpack.securitySolution.detectionEngine.rules.clearRulesTableFilters",{defaultMessage:"Clear filters"})),vt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastTitle",{defaultMessage:"Rules exported"}),ht=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.successToastDescription",{values:{totalRules:t,exportedRules:e},defaultMessage:"Successfully exported {exportedRules} of {totalRules} {totalRules, plural, =1 {rule} other {rules}}."}),Et=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.prebuiltRulesExcludedToastDescription",{defaultMessage:"Prebuilt rules were excluded from the resulting file."}),xt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastTitle",{defaultMessage:"Error exporting rules"}),jt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.export.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to export."}),Ot=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastTitle",{defaultMessage:"Rules duplicated"}),St=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully duplicated {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),kt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastTitle",{defaultMessage:"Error duplicating rule"}),wt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.duplicate.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to duplicate."}),Tt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastTitle",{defaultMessage:"Rules deleted"}),It=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully deleted {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Ct=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastTitle",{defaultMessage:"Error deleting rules"}),Mt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.delete.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to delete."}),_t=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.successToastTitle",{defaultMessage:"Rules enabled"}),At=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkAction.enable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully enabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Pt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastTitle",{defaultMessage:"Error enabling rules"}),Ft=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.enable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to enable."}),Dt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastTitle",{defaultMessage:"Rules disabled"}),Nt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.successToastDescription",{values:{totalRules:e},defaultMessage:"Successfully disabled {totalRules, plural, =1 {{totalRules} rule} other {{totalRules} rules}}"}),Rt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastTitle",{defaultMessage:"Error disabling rules"}),Lt=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.disable.errorToastDescription",{values:{rulesCount:e},defaultMessage:"{rulesCount, plural, =1 {# rule is} other {# rules are}} failed to disable."}),zt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastTitle",{defaultMessage:"Rules updated"}),Bt=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successToastDescription",{values:{succeededRulesCount:e,skippedRulesCount:t},defaultMessage:"{succeededRulesCount, plural, =0 {} =1 {You've successfully updated # rule. } other {You've successfully updated # rules. }}\n        {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}\n        "}),qt=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.successIndexEditToastDescription",{defaultMessage:"If you did not select to apply changes to rules using Kibana data views, those rules were not updated and will continue using data views."}),$t=a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastTitle",{defaultMessage:"Error updating rules"}),Vt=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.rules.allRules.bulkActions.edit.errorToastDescription",{values:{failedRulesCount:e,skippedRulesCount:t},defaultMessage:"{failedRulesCount, plural, =0 {} =1 {# rule} other {# rules}} failed to update. {skippedRulesCount, plural, =0 {} =1 { # rule was skipped.} other { # rules were skipped.}}"}),Ut=(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.cancelButtonLabel",{defaultMessage:"Cancel"}),a.i18n.translate("xpack.securitySolution.hooks.useGetSavedQuery.errorToastMessage",{defaultMessage:"Failed to load the saved query"})),Ht=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextDescription",{defaultMessage:"Selected Detection Rules"}),Zt=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.explainThenSummarizeRuleDetails",{defaultMessage:"Please explain the selected rules above. For each rule, highlight why they are relevant, the query as published on Elastic's detection rules repository and an in-depth explanation of it, and what they typically mean for an organization if detected."}),Gt=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.detectionRulesConversationId",{defaultMessage:"Detection Rules"}),Qt=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleManagement.ruleManagementContextTooltip",{defaultMessage:"Add this alert as context"}),Wt=a.i18n.translate("xpack.securitySolution.addRules.installRuleButton",{defaultMessage:"Install rule"}),Kt=a.i18n.translate("xpack.securitySolution.addRules.upgradeRuleButton",{defaultMessage:"Update rule"}),Jt=a.i18n.translate("xpack.securitySolution.addRules.goBackToRulesTableButton",{defaultMessage:"Go back to installed Elastic rules"}),Yt=a.i18n.translate("xpack.securitySolution.ruleUpdates.documentationLink",{defaultMessage:"See what's new in Prebuilt Security Detection Rules"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var a=n(78),i=n.n(a),r=n(2),s=n.n(r),o=n(47),l=n(110),u=n(126),c=n(715),d=n(586);const p=s.a.memo((({value:e,dateFormat:t=Object(l.g)()})=>s.a.createElement(s.a.Fragment,null,i.a.tz(e,Object(l.l)()).format(t))));p.displayName="PreferenceFormattedDate";const m=({value:e})=>{if(null==e)return Object(u.f)(e);const t=Object(d.a)(e);if(!t.isValid())return Object(u.f)(e);const n=t.toDate();return s.a.createElement(p,{value:n})};m.displayName="PreferenceFormattedDateFromPrimitive";const f=e=>Array.isArray(e)&&"P1DT"===e[0]&&2===e.length,g=s.a.memo((({value:e})=>{const[t]=Object(l.o)("dateFormat:scaled"),n=Array.isArray(t)?t.find(f):null,a=Array.isArray(n)&&2===n.length?n[1]:"YYYY-MM-DD";return s.a.createElement(p,{dateFormat:a,value:e})}));g.displayName="PreferenceFormattedP1DTDate";const b=s.a.memo((({value:e,fieldName:t,className:n="",dateFormat:a})=>{if(null==e)return Object(u.f)(e);const i=Object(d.a)(e);return i.isValid()?s.a.createElement(c.a,{date:i.toDate(),fieldName:t,className:n},s.a.createElement(p,{value:i.toDate(),dateFormat:a})):Object(u.f)(e)}));b.displayName="FormattedDate";const y=s.a.memo((({value:e,dateFormat:t,tooltipFieldName:n,tooltipAnchorClassName:a,relativeThresholdInHrs:r=1})=>{if(null==e)return Object(u.f)(e);const l=Object(d.a)(e);if(!l.isValid())return Object(u.f)(e);const m=l.toDate(),f=i()(m).add(r,"hours").isBefore(new Date);return s.a.createElement(c.a,{date:m,fieldName:n,className:a},f?s.a.createElement(p,{"data-test-subj":"preference-time",value:m,dateFormat:t}):s.a.createElement(o.FormattedRelative,{"data-test-subj":"relative-time",value:m}))}));y.displayName="FormattedRelativePreferenceDate"},function(e,t,n){"use strict";e.exports=function(e){return e<-2}},function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"c",(function(){return y}));var a=n(2),i=n(45),r=n(48),s=n(235),o=n.n(s),l=n(60),u=n(203),c=n(112),d=n(610),p=n(202),m=n(20);const f=(e,t)=>{const n=Object(r.useDispatch)(),i=Object(u.f)(e);Object(a.useEffect)((()=>{const a=i();return n(d.a.registerUrlParam({key:e,initialValue:a})),t(a),()=>{n(d.a.deregisterUrlParam({key:e}))}}),[])},g=e=>{const t=Object(r.useDispatch)();return Object(a.useCallback)((n=>{t(d.a.updateUrlParam({key:e,value:n}))}),[t,e])},b=()=>{const e=Object(c.b)(d.c.selectGlobalUrlParam);return Object(a.useMemo)((()=>{const t={};return e?(Object.keys(e).forEach((n=>{const a=e[n];if(a&&("object"!=typeof a||!Object(i.isEmpty)(a)))try{t[n]=Object(l.encode)(a)}catch{}})),Object(u.b)(Object(i.pickBy)((e=>!Object(i.isEmpty)(e)),t))):""}),[e])},y=()=>{const[{pageName:e}]=Object(p.a)(),t=Object(c.b)(d.c.selectGlobalUrlParam),n=o()(t),r=Object(u.g)();Object(a.useEffect)((()=>{var a;const s=null!==(a=Object(m.b)(e))&&void 0!==a?a:{skipUrlState:!0},o={...t};s.skipUrlState&&Object.keys(o).forEach((e=>{o[e]=null})),Object(i.difference)(Object.keys(null!=n?n:{}),Object.keys(t)).forEach((e=>{o[e]=null})),Object.keys(o).length>0&&r(o)}),[n,t,e,r])}},function(e,t,n){"use strict";n.r(t),n.d(t,"setAbsoluteRangeDatePicker",(function(){return r})),n.d(t,"setTimelineRangeDatePicker",(function(){return s})),n.d(t,"setRelativeRangeDatePicker",(function(){return o})),n.d(t,"setDuration",(function(){return l})),n.d(t,"startAutoReload",(function(){return u})),n.d(t,"stopAutoReload",(function(){return c})),n.d(t,"setFullScreen",(function(){return d})),n.d(t,"setQuery",(function(){return p})),n.d(t,"deleteOneQuery",(function(){return m})),n.d(t,"setInspectionParameter",(function(){return f})),n.d(t,"deleteAllQuery",(function(){return g})),n.d(t,"toggleTimelineLinkTo",(function(){return b})),n.d(t,"toggleSocTrendsLinkTo",(function(){return y})),n.d(t,"removeLinkTo",(function(){return v})),n.d(t,"addLinkTo",(function(){return h})),n.d(t,"setFilterQuery",(function(){return E})),n.d(t,"setSavedQuery",(function(){return x})),n.d(t,"setSearchBarFilter",(function(){return j}));var a=n(26);const i=n.n(a)()("x-pack/security_solution/local/inputs"),r=i("SET_ABSOLUTE_RANGE_DATE_PICKER"),s=i("SET_TIMELINE_RANGE_DATE_PICKER"),o=i("SET_RELATIVE_RANGE_DATE_PICKER"),l=i("SET_DURATION"),u=i("START_KQL_AUTO_RELOAD"),c=i("STOP_KQL_AUTO_RELOAD"),d=i("SET_FULL_SCREEN"),p=i("SET_QUERY"),m=i("DELETE_QUERY"),f=i("SET_INSPECTION_PARAMETER"),g=i("DELETE_ALL_QUERY"),b=i("TOGGLE_TIMELINE_LINK_TO"),y=i("TOGGLE_SOC_TRENDS_LINK_TO"),v=i("REMOVE_LINK_TO"),h=i("ADD_LINK_TO"),E=i("SET_FILTER_QUERY"),x=i("SET_SAVED_QUERY"),j=i("SET_SEARCH_BAR_FILTER")},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"c",(function(){return p})),n.d(t,"b",(function(){return f}));var a=n(17),i=n(2),r=n.n(i),s=n(119),o=n(276),l=n(381),u=n(465),c=n(382);const d="inspectButtonComponent",p=({children:e,show:t=!0})=>r.a.createElement(o.a,{show:t,targetClassNames:[d]},e),m=({compact:e=!1,inputId:t=s.a.global,inspectIndex:n=0,isDisabled:i,multiple:o=!1,onCloseInspect:p,queryId:m="",showInspectButton:f=!0,title:g=""})=>{const{additionalRequests:b,additionalResponses:y,handleClick:v,handleCloseModal:h,isButtonDisabled:E,isShowingModal:x,loading:j,request:O,response:S}=Object(u.a)({inputId:t,inspectIndex:n,isDisabled:i,multiple:o,onCloseInspect:p,queryId:m});return r.a.createElement(r.a.Fragment,null,t===s.a.timeline&&!e&&f&&r.a.createElement(a.EuiButtonEmpty,{className:d,"aria-label":c.d,"data-test-subj":"inspect-empty-button",isDisabled:E,isLoading:j,onClick:v},c.d),(t===s.a.global||e)&&f&&r.a.createElement(a.EuiButtonIcon,{className:d,"aria-label":c.d,"data-test-subj":"inspect-icon-button",iconSize:"m",iconType:"inspect",isDisabled:E,title:c.d,onClick:v}),x&&null!==O&&null!==S&&r.a.createElement(l.a,{additionalRequests:b,additionalResponses:y,closeModal:h,"data-test-subj":"inspect-modal",inputId:t,request:O,response:S,title:g}))};m.displayName="InspectButtonComponent";const f=r.a.memo(m)},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(110),r=n(202);const s=e=>{var t;const[{pageName:n}]=Object(r.a)(),{services:{storage:s}}=Object(i.i)(),o=((e,t)=>t&&e.length>0?`kibana.siem:${t}.query.toggle:${e}`:null)(n,e),[l,u]=Object(a.useState)(null==o||null===(t=s.get(o))||void 0===t||t);Object(a.useEffect)((()=>{var e;null!=o&&u(null===(e=s.get(o))||void 0===e||e)}),[s,o]);const c=Object(a.useCallback)((e=>{null!=o&&(s.set(o,e),u(e))}),[s,o]);return e?{toggleStatus:l,setToggleStatus:c}:{toggleStatus:!0,setToggleStatus:()=>{}}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"e",(function(){return k})),n.d(t,"d",(function(){return w})),n.d(t,"f",(function(){return T})),n.d(t,"g",(function(){return C})),n.d(t,"c",(function(){return $})),n.d(t,"h",(function(){return V})),n.d(t,"b",(function(){return U}));var a=n(448),i=n(45),r=n(51),s=n(324),o=n.n(s),l=n(119),u=n(122),c=n(113),d=n(208),p=n(158),m=n(14),f=n(134),g=n(196),b=n(204),y=n(590),v=n(153),h=n(335),E=n(149),x=n(116),j=n(281),O=n(193);const S="open-timeline",k=({pinnedEventIds:e})=>null!=e?Object.keys(e).length:0,w=({eventIdToNoteIds:e,noteIds:t})=>(null!=e?Object.keys(e).reduce(((t,n)=>t+e[n].length),0):0)+(null!=t?t.length:0),T=({title:e})=>null==e||0===e.trim().length,I=(e,t)=>"__typename"===e?void 0:t,C=e=>JSON.parse(JSON.stringify(e),I),M=e=>{try{return JSON.parse(e)}catch{return e}},_=e=>Object.entries(e).reduce(((e,[t,n])=>"id"!==t&&null!=n?{...e,[t]:n}:e),{columnHeaderType:g.a,id:null!=e.id?e.id:"unknown",initialWidth:"@timestamp"===e.id?b.b:b.a}),A=e=>({$state:{store:"appState"},meta:{...e.meta,...e.meta&&null!=e.meta.field?{params:M(e.meta.field)}:{},...e.meta&&null!=e.meta.params?{params:M(e.meta.params)}:{},...e.meta&&null!=e.meta.value?{value:M(e.meta.value)}:{}},...null!=e.exists?{exists:M(e.exists)}:{},...null!=e.match_all?{exists:M(e.match_all)}:{},...null!=e.missing?{exists:M(e.missing)}:{},...null!=e.query?{query:M(e.query)}:{},...null!=e.range?{range:M(e.range)}:{},...null!=e.script?{exists:M(e.script)}:{}}),P=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(i.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):{},F=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,...null!=t.eventId?{[t.eventId]:t}:{}})),{}):{},D=(e,t)=>e?{}:null!=t?t.reduce(((e,t)=>({...e,[t]:!0})),{}):{},N=(e,t,n)=>n===c.l.default&&e.timelineType===c.l.template?e.templateTimelineId:t&&e.timelineType===c.l.template?Object(r.v4)():e.templateTimelineId,R=({and:e,...t})=>t.type===c.a.template?o()(t,{type:c.a.default,enabled:t.queryMatch.operator!==v.d,queryMatch:{value:t.queryMatch.operator===v.d?"":t.queryMatch.value}}):t,L=(e,t,n)=>e&&t&&n===c.l.default?t.map((e=>{var t,n;return{...R(e),and:null!==(t=null===(n=e.and)||void 0===n?void 0:n.map(R))&&void 0!==t?t:[]}})):t,z=(e,t,n)=>n&&e.timelineType!==n?"":t?`${e.title} - Duplicate`:e.title||"",B=(e,t,n)=>n&&e.timelineType!==n?c.k.draft:t?c.k.active:e.status,q=(e,t,n)=>{const i=e.timelineType===c.l.template,r={...e,columns:null!=e.columns?e.columns.map(_):g.b,defaultColumns:g.b,dateRange:e.status===c.k.immutable&&e.timelineType===c.l.template?{start:j.a.toISOString(),end:j.b.toISOString()}:e.dateRange,dataProviders:L(t,e.dataProviders,n),eventIdToNoteIds:P(t,e.eventIdToNoteIds),filters:null!=e.filters?e.filters.map(A):[],isFavorite:!t&&null!=e.favorite&&e.favorite.length>0,noteIds:t?[]:null!=e.noteIds?e.noteIds:[],pinnedEventIds:D(t,e.pinnedEventIds),pinnedEventsSaveObject:F(t,e.pinnedEventsSaveObject),id:t?"":e.savedObjectId,status:B(e,t,n),savedObjectId:t?null:e.savedObjectId,version:t?null:e.version,timelineType:null!=n?n:e.timelineType,title:z(e,t,n),templateTimelineId:N(e,t,n),templateTimelineVersion:t&&i?1:e.templateTimelineVersion};return Object.entries(r).reduce(((e,[t,n])=>null!=n?Object(a.set)(t,n,e):e),{...f.b,id:""})},$=(e,t=!1,n)=>{const{notes:a,...i}=e;return{notes:a,timeline:q(i,t,n)}},V=({activeTimelineTab:e=u.d.query,duplicate:t=!1,graphEventId:n="",timelineId:a,timelineType:r,onError:s,onOpenTimeline:o,openTimeline:l=!0,updateIsLoading:c,updateTimeline:d,savedSearchId:p})=>{c({id:u.c.active,isLoading:!0}),null==a?(d({id:u.c.active,duplicate:!1,notes:[],from:j.a.toISOString(),to:j.b.toISOString(),timeline:{...f.b,id:u.c.active,activeTab:e,show:l,initialized:!0,savedSearchId:null!=p?p:null}})(),c({id:u.c.active,isLoading:!1})):Promise.resolve(Object(O.j)(a)).then((a=>{const s=Object(i.getOr)(null,"data",a);if(!s)return;const c=C(s.timeline),{timeline:p,notes:m}=$(c,t,r);if(null!=o)o(p);else if(d){const{from:a,to:r}=Object(h.a)({from:Object(i.getOr)(null,"dateRange.start",p),to:Object(i.getOr)(null,"dateRange.end",p)});d({duplicate:t,from:a,id:u.c.active,notes:m,resolveTimelineConfig:{outcome:s.outcome,alias_target_id:s.alias_target_id,alias_purpose:s.alias_purpose},timeline:{...p,activeTab:e,graphEventId:n,show:l,dateRange:{start:a,end:r},savedSearchId:p.savedSearchId},to:r,preventSettingQuery:!0})()}})).catch((e=>{null!=s&&s(e,a)})).finally((()=>{c({id:u.c.active,isLoading:!1})}))},U=e=>({duplicate:t,id:n,forceNotes:a=!1,from:r,notes:s,resolveTimelineConfig:o,timeline:u,to:f,ruleNote:g,ruleAuthor:b,preventSettingQuery:v})=>()=>{let h=u;var O;if(t&&(h={...u,updated:void 0,changed:void 0,version:null}),Object(i.isEmpty)(h.indexNames)||e(E.a.setSelectedDataView({id:x.SourcererScopeName.timeline,selectedDataViewId:h.dataViewId,selectedPatterns:h.indexNames})),h.status===c.k.immutable&&h.timelineType===c.l.template?e(Object(p.setRelativeRangeDatePicker)({id:l.a.timeline,fromStr:"now-24h",toStr:"now",from:j.a.toISOString(),to:j.b.toISOString()})):e(Object(p.setTimelineRangeDatePicker)({from:r,to:f})),e(Object(m.addTimeline)({id:n,timeline:h,resolveTimelineConfig:o,savedTimeline:t})),v||null==h.kqlQuery||null==h.kqlQuery.filterQuery||null==h.kqlQuery.filterQuery.kuery||""===h.kqlQuery.filterQuery.kuery.expression||e(Object(m.applyKqlFilterQuery)({id:n,filterQuery:{kuery:{kind:null!==(O=h.kqlQuery.filterQuery.kuery.kind)&&void 0!==O?O:"kuery",expression:h.kqlQuery.filterQuery.kuery.expression||""},serializedQuery:h.kqlQuery.filterQuery.serializedQuery||""}})),t&&null!=g&&!Object(i.isEmpty)(g)){const t=Object(y.a)({newNote:g,user:b||"elastic"});e(Object(d.updateNote)({note:t})),e(Object(m.addNote)({noteId:t.id,id:n}))}t&&!a||e(Object(d.addNotes)({notes:null!=s?s.map((e=>{var t,n;return{created:null!=e.created?new Date(e.created):new Date,id:e.noteId,lastEdit:null!=e.updated?new Date(e.updated):new Date,note:e.note||"",user:e.updatedBy||"unknown",saveObjectId:e.noteId,version:e.version,eventId:null!==(t=e.eventId)&&void 0!==t?t:null,timelineId:null!==(n=e.timelineId)&&void 0!==n?n:null}})):[]}))}},function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"y",(function(){return m})),n.d(t,"p",(function(){return f})),n.d(t,"v",(function(){return g})),n.d(t,"j",(function(){return b})),n.d(t,"h",(function(){return y})),n.d(t,"k",(function(){return v})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return E})),n.d(t,"e",(function(){return x})),n.d(t,"q",(function(){return j})),n.d(t,"b",(function(){return O})),n.d(t,"n",(function(){return S})),n.d(t,"i",(function(){return k})),n.d(t,"l",(function(){return w})),n.d(t,"a",(function(){return T})),n.d(t,"o",(function(){return I})),n.d(t,"c",(function(){return C})),n.d(t,"m",(function(){return M})),n.d(t,"x",(function(){return _})),n.d(t,"w",(function(){return A})),n.d(t,"r",(function(){return P})),n.d(t,"s",(function(){return F})),n.d(t,"t",(function(){return D})),n.d(t,"u",(function(){return N}));var a=n(29),i=n(72),r=n(70),s=n(663),o=n(191),l=n(4),u=n(341),c=n(389),d=n(110);n(154);const p=async({rule:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),m=async({rule:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"PUT",version:"2023-10-31",body:JSON.stringify(e),signal:t}),f=async({ruleProperties:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"PATCH",version:"2023-10-31",body:JSON.stringify(e),signal:t}),g=async({rule:e,signal:t})=>d.b.get().http.fetch(l.ib,{method:"POST",version:"2023-10-31",body:JSON.stringify(e),signal:t}),b=async({filterOptions:e={filter:"",showCustomRules:!1,showElasticRules:!1,tags:[]},sortingOptions:t={field:"enabled",order:"desc"},pagination:n={page:1,perPage:20},signal:a})=>{const i=Object(s.a)(e),r={page:n.page,per_page:n.perPage,sort_field:t.field,sort_order:t.order,...""!==i?{filter:i}:{}};return d.b.get().http.fetch(l.kb,{method:"GET",version:"2023-10-31",query:r,signal:a})},y=async({id:e,signal:t})=>d.b.get().http.fetch(l.jb,{method:"GET",version:"2023-10-31",query:{id:e},signal:t}),v=async({ids:e,signal:t})=>{var n;return null===(n=(await d.b.get().http.fetch(a.INTERNAL_ALERTING_API_FIND_RULES_PATH,{method:"GET",query:{filter:e.map((e=>`alert.id:"alert:${e}"`)).join(" or "),fields:JSON.stringify(["muteAll","activeSnoozes","isSnoozedUntil","snoozeSchedule"]),per_page:e.length},signal:t})).data)||void 0===n?void 0:n.reduce(((e,{id:t,...n})=>{var a,i;return e[t]={muteAll:null!==(a=n.mute_all)&&void 0!==a&&a,activeSnoozes:null!==(i=n.active_snoozes)&&void 0!==i?i:[],isSnoozedUntil:n.is_snoozed_until?new Date(n.is_snoozed_until):void 0,snoozeSchedule:n.snooze_schedule},e}),{})},h=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connectors`,{method:"GET",signal:e}),E=async({filter:e,signal:t})=>d.b.get().http.fetch(o.f,{method:"POST",version:"1",body:JSON.stringify({filter:e}),signal:t}),x=e=>d.b.get().http.fetch(`${i.BASE_ACTION_API_PATH}/connector_types`,{method:"GET",signal:e,query:{feature_id:"siem"}});async function j({bulkAction:e,dryRun:t=!1}){const n={action:e.type,query:e.query,ids:e.ids,edit:e.type===o.b.edit?e.editPayload:void 0,duplicate:e.type===o.b.duplicate?e.duplicatePayload:void 0};return d.b.get().http.fetch(l.hb,{method:"POST",version:"2023-10-31",body:JSON.stringify(n),query:{dry_run:t}})}async function O(e){const t={action:o.b.export,query:e.query,ids:e.ids};return d.b.get().http.fetch(l.hb,{method:"POST",version:"2023-10-31",body:JSON.stringify(t)})}const S=async({fileToImport:e,overwrite:t=!1,overwriteExceptions:n=!1,overwriteActionConnectors:a=!1,signal:i})=>{const r=new FormData;return r.append("file",e),d.b.get().http.fetch(`${l.jb}/_import`,{method:"POST",version:"2023-10-31",headers:{"Content-Type":void 0},query:{overwrite:t,overwrite_exceptions:n,overwrite_action_connectors:a},body:r,signal:i})},k=async({signal:e})=>d.b.get().http.fetch(o.g,{method:"GET",version:"1",signal:e}),w=async({lists:e,signal:t})=>{const n=e.some((({id:e})=>void 0===e))?{namespace_types:e.map((({namespaceType:e})=>e)).join(",")}:{ids:e.map((({id:e})=>e)).join(","),list_ids:e.map((({listId:e})=>e)).join(","),namespace_types:e.map((({namespaceType:e})=>e)).join(",")};return d.b.get().http.fetch(c.a,{method:"GET",version:"1",query:n,signal:t})},T=async({ruleId:e,items:t,signal:n})=>d.b.get().http.fetch(`${l.jb}/${e}/exceptions`,{method:"POST",version:"2023-10-31",body:JSON.stringify({items:t}),signal:n}),I=({packageName:e,packageVersion:t,prerelease:n=!1,force:a=!0})=>d.b.get().http.post(r.epmRouteService.getInstallPath(e,t),{query:{prerelease:n},version:"2023-10-31",body:JSON.stringify({force:a})}),C=({packages:e,prerelease:t=!1})=>d.b.get().http.post(r.epmRouteService.getBulkInstallPath(),{query:{prerelease:t},version:"2023-10-31",body:JSON.stringify({packages:e})}),M=async({signal:e})=>d.b.get().http.fetch(u.a,{method:"GET",version:"1",signal:e}),_=async({signal:e})=>d.b.get().http.fetch(u.f,{method:"POST",version:"1",signal:e}),A=async({signal:e})=>d.b.get().http.fetch(u.e,{method:"POST",version:"1",signal:e}),P=async()=>d.b.get().http.fetch(u.b,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES"})}),F=async e=>d.b.get().http.fetch(u.b,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e})}),D=async()=>d.b.get().http.fetch(u.c,{method:"POST",version:"1",body:JSON.stringify({mode:"ALL_RULES",pick_version:"TARGET"})}),N=async e=>d.b.get().http.fetch(u.c,{method:"POST",version:"1",body:JSON.stringify({mode:"SPECIFIC_RULES",rules:e,pick_version:"TARGET"})})},function(e,t,n){"use strict";n.d(t,"c",(function(){return l.a})),n.d(t,"h",(function(){return l.d})),n.d(t,"d",(function(){return u.a})),n.d(t,"i",(function(){return u.b})),n.d(t,"e",(function(){return d})),n.d(t,"g",(function(){return p.b})),n.d(t,"f",(function(){return p.a})),n.d(t,"j",(function(){return m})),n.d(t,"k",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"l",(function(){return y})),n.d(t,"m",(function(){return v}));var a=n(45),i=n(2),r=n(462),s=n(486),o=n(352),l=n(237),u=n(229),c=(n(4),n(185));const d=(e,t)=>`/${e}${Object(c.a)(t)}`;var p=n(346);const m=(e,t)=>`/${e}${Object(c.a)(t)}`,f=(e,t)=>`?timeline=(id:'${e}',isOpen:!t${Object(a.isEmpty)(t)?")":`,graphEventId:'${t}')`}`,g=({id:e,search:t})=>`/${encodeURIComponent(e)}${Object(c.a)(null!=t?t:void 0)}`,b=e=>`/create${Object(c.a)(null!=e?e:void 0)}`,y=e=>{const{getAppUrl:t}=Object(o.a)(),n=Object(s.b)(e);return{formatUrl:Object(i.useCallback)(((i,{absolute:r=!1,skipSearch:s=!1}={})=>{const o=function(e,t,n){const[i,r]=e.split("?");return`${i}${n?Object(a.isEmpty)(r)?"":`?${r}`:Object(a.isEmpty)(r)?t:`?${r}${Object(a.isEmpty)(t)?"":`&${t}`}`}`}(i,n,s);return t({deepLinkId:e,path:o,absolute:r})}),[t,e,n]),search:n}},v=()=>{const e=Object(r.c)(),t=Object(s.a)();return Object(i.useCallback)((({deepLinkId:n,path:a="",absolute:i=!1,skipSearch:r=!1})=>{const s=r?"":t(n);return e({id:n,path:a,urlState:s,absolute:i})}),[e,t])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"u",(function(){return g})),n.d(t,"v",(function(){return b})),n.d(t,"l",(function(){return y})),n.d(t,"j",(function(){return v})),n.d(t,"m",(function(){return h})),n.d(t,"k",(function(){return E})),n.d(t,"d",(function(){return x})),n.d(t,"e",(function(){return j})),n.d(t,"h",(function(){return O})),n.d(t,"p",(function(){return S})),n.d(t,"q",(function(){return k})),n.d(t,"g",(function(){return w})),n.d(t,"n",(function(){return I})),n.d(t,"o",(function(){return C})),n.d(t,"r",(function(){return M})),n.d(t,"f",(function(){return _})),n.d(t,"i",(function(){return A})),n.d(t,"s",(function(){return P})),n.d(t,"t",(function(){return F})),n.d(t,"c",(function(){return D}));var a=n(761),i=n(280),r=n(437),s=n(139),o=n(175),l=n(240),u=n(180);const c=async e=>Object(l.pipe)(await e(),Object(u.fold)((e=>Promise.reject(e)),(e=>Promise.resolve(e)))),d=e=>e instanceof Error?e:new Error(String(e)),p="2023-10-31",m=async({http:e,list:t,signal:n})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,list:t,signal:n})=>e.fetch(o.s,{body:JSON.stringify(t),method:"POST",signal:n,version:p}))({http:e,list:t,signal:n})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.o,e)))),Object(i.flow)(c))(),f=async({http:e,listItem:t,signal:n})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,listItem:t,signal:n})=>e.fetch(o.p,{body:JSON.stringify(t),method:"POST",signal:n,version:p}))({http:e,listItem:t,signal:n})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.n,e)))),Object(i.flow)(c))(),g=async({http:e,list:t,signal:n})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,list:t,signal:n})=>e.fetch(o.s,{body:JSON.stringify(t),method:"PUT",signal:n,version:p}))({http:e,list:t,signal:n})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.o,e)))),Object(i.flow)(c))(),b=async({http:e,listItem:t,signal:n})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,listItem:t,signal:n})=>e.fetch(o.p,{body:JSON.stringify(t),method:"PUT",signal:n,version:p}))({http:e,listItem:t,signal:n})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.n,e)))),Object(i.flow)(c))(),y=async({filters:e,http:t,namespaceTypes:n,pagination:l,signal:u,sort:m})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,filters:t,namespaceTypes:n,pagination:a,signal:i,sort:r})=>{const s={filter:t||void 0,namespace_type:n,page:a.page?`${a.page}`:"1",per_page:a.perPage?`${a.perPage}`:"20",sort_field:null!=r&&r.field?null==r?void 0:r.field:"exception-list.created_at",sort_order:null!=r&&r.order?null==r?void 0:r.order:"desc"};return e.fetch(`${o.s}/_find`,{method:"GET",query:s,signal:i,version:p})})({filters:e,http:t,namespaceTypes:n,pagination:l,signal:u,sort:m})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.t,e)))),Object(i.flow)(c))(),v=async({http:e,id:t,namespaceType:n,signal:l})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(o.s,{method:"GET",query:{id:t,namespace_type:n},signal:a,version:p}))({http:e,id:t,namespaceType:n,signal:l})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.o,e)))),Object(i.flow)(c))(),h=async({filter:e,http:t,listIds:n,namespaceTypes:l,pagination:u,search:m,signal:f})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,listIds:t,namespaceTypes:n,filter:a,pagination:i,search:r,signal:s})=>{const l={list_id:t.join(","),namespace_type:n.join(","),page:i.page?`${i.page}`:"1",per_page:i.perPage?`${i.perPage}`:"20",search:r,sort_field:"exception-list.created_at",sort_order:"desc",filter:a};return e.fetch(`${o.p}/_find`,{method:"GET",query:l,signal:s,version:p})})({filter:e,http:t,listIds:n,namespaceTypes:l,pagination:u,search:m,signal:f})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.s,e)))),Object(i.flow)(c))(),E=async({http:e,id:t,namespaceType:n,signal:l})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(o.p,{method:"GET",query:{id:t,namespace_type:n},signal:a,version:p}))({http:e,id:t,namespaceType:n,signal:l})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.n,e)))),Object(i.flow)(c))(),x=async({http:e,id:t,namespaceType:n,signal:l})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(o.s,{method:"DELETE",query:{id:t,namespace_type:n},signal:a,version:p}))({http:e,id:t,namespaceType:n,signal:l})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.o,e)))),Object(i.flow)(c))(),j=async({http:e,id:t,namespaceType:n,signal:l})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,id:t,namespaceType:n,signal:a})=>e.fetch(o.p,{method:"DELETE",query:{id:t,namespace_type:n},signal:a,version:p}))({http:e,id:t,namespaceType:n,signal:l})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.n,e)))),Object(i.flow)(c))(),O=async({http:e,id:t,includeExpiredExceptions:n,listId:a,namespaceType:i,signal:r})=>e.fetch(`${o.s}/_export`,{method:"POST",query:{id:t,list_id:a,namespace_type:i,include_expired_exceptions:n},signal:r,version:p}),S=async({alias:e,chunkSize:t,exceptionListIds:n,excludeExceptions:a,http:i,signal:r})=>i.fetch(o.u,{method:"POST",version:"1",body:JSON.stringify({exception_list_ids:n,type:"exception_list_ids",alias:e,exclude_exceptions:a,chunk_size:t}),signal:r}),k=async({exceptions:e,alias:t,excludeExceptions:n,http:a,chunkSize:i,signal:r})=>a.fetch(o.u,{method:"POST",version:"1",body:JSON.stringify({exceptions:e,type:"exception_items",alias:t,exclude_exceptions:n,chunk_size:i}),signal:r}),w=async({http:e,includeExpiredExceptions:t,listId:n,namespaceType:a,signal:i})=>e.fetch(`${o.s}/_duplicate`,{method:"POST",query:{list_id:n,namespace_type:a,include_expired_exceptions:t},signal:i,version:p}),T="2023-10-31",I=async({cursor:e,http:t,pageIndex:n,pageSize:u,signal:p,sortField:m,sortOrder:f})=>Object(l.pipe)({cursor:null!=e?e.toString():void 0,page:null!=n?n.toString():void 0,per_page:null!=u?u.toString():void 0,sort_field:null!=m?m.toString():void 0,sort_order:f},(e=>Object(a.fromEither)(Object(r.c)(s.r,e))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({http:e,cursor:t,page:n,per_page:a,signal:i,sort_field:r,sort_order:s})=>e.fetch(`${o.z}/_find`,{method:"GET",query:{cursor:t,page:n,per_page:a,sort_field:r,sort_order:s},signal:i,version:T}))({http:t,signal:p,...e})),d))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.u,e)))),Object(i.flow)(c)),C=async({cursor:e,http:t,pageIndex:n,pageSize:u,signal:p})=>Object(l.pipe)({cursor:null!=e?e.toString():void 0,page:null!=n?n.toString():void 0,per_page:null!=u?u.toString():void 0},(e=>Object(a.fromEither)(Object(r.c)(s.r,e))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({http:e,cursor:t,page:n,per_page:a,signal:i})=>e.fetch(`${o.v}`,{method:"GET",version:"1",query:{cursor:t,page:n,per_page:a},signal:i}))({http:t,signal:p,...e})),d))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.v,e)))),Object(i.flow)(c)),M=async({file:e,http:t,listId:n,type:i,signal:u})=>Object(l.pipe)({list_id:n,type:i},(e=>Object(a.fromEither)(Object(r.c)(s.w,e))),Object(a.chain)((t=>Object(l.pipe)(Object(a.fromEither)(Object(r.c)(s.x,{file:e})),Object(a.map)((e=>({...e,...t})))))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({file:e,http:t,list_id:n,type:a,signal:i})=>{const r=new FormData;return r.append("file",e),t.fetch(`${o.x}/_import`,{body:r,headers:{"Content-Type":void 0},method:"POST",query:{list_id:n,type:a},signal:i,version:T})})({http:t,signal:u,...e})),d))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.A,e)))),c),_=async({deleteReferences:e,http:t,id:n,ignoreReferences:u,signal:p})=>Object(l.pipe)({deleteReferences:e,id:n,ignoreReferences:u},(e=>Object(a.fromEither)(Object(r.c)(s.j,e))),Object(a.chain)((e=>Object(a.tryCatch)((()=>(async({deleteReferences:e=!1,http:t,id:n,ignoreReferences:a=!1,signal:i})=>t.fetch(o.z,{method:"DELETE",query:{deleteReferences:e,id:n,ignoreReferences:a},signal:i,version:T}))({http:t,signal:p,...e})),d))),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.A,e)))),Object(i.flow)(c)),A=async({http:e,listId:t,signal:n})=>Object(l.pipe)({list_id:t},(e=>Object(a.fromEither)(Object(r.c)(s.q,e))),Object(a.chain)((t=>Object(a.tryCatch)((()=>(async({http:e,list_id:t,signal:n})=>e.fetch(`${o.x}/_export`,{method:"POST",query:{list_id:t},signal:n,version:T}))({http:e,signal:n,...t})),d))),Object(i.flow)(c)),P=async({http:e,signal:t})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,signal:t})=>e.fetch(o.w,{method:"GET",signal:t,version:T}))({http:e,signal:t})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.z,e)))),Object(i.flow)(c))(),F=async({http:e,signal:t})=>e.fetch(o.y,{method:"GET",signal:t,version:T}),D=async({http:e,signal:t})=>Object(i.flow)((()=>Object(a.tryCatch)((()=>(async({http:e,signal:t})=>e.fetch(o.w,{method:"POST",signal:t,version:T}))({http:e,signal:t})),d)),Object(a.chain)((e=>Object(a.fromEither)(Object(r.c)(s.e,e)))),Object(i.flow)(c))()},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return v}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(544),u=n(174),c=n(126),d=n(153),p=n(564);const m=({field:e,tooltipContent:t})=>null!=t?t:e,f=r.a.memo((({children:e,field:t,tooltipContent:n,tooltipPosition:i,value:s})=>(e=>null===e)(n)?r.a.createElement(r.a.Fragment,null,e||s):r.a.createElement(a.EuiToolTip,{"data-test-subj":`${t}-tooltip`,position:i,content:m({tooltipContent:n,field:t})},r.a.createElement(r.a.Fragment,null,e||s))));f.displayName="Content";const g=r.a.memo((({hideTopN:e=!1,id:t,isDraggable:n=!0,field:a,fieldType:s="",isAggregatable:o=!1,value:c,name:m,children:g,scopeId:b,tooltipContent:y,tooltipPosition:v,queryValue:h,truncate:E})=>{const x=Object(i.useMemo)((()=>{var e;return{and:[],enabled:!0,id:Object(u.i)(t),name:m||(null!==(e=null==c?void 0:c.toString())&&void 0!==e?e:""),excluded:!1,kqlQuery:"",queryMatch:{field:a,value:h||(null!=c?c:""),operator:d.d}}}),[a,t,m,h,c]),j=Object(i.useCallback)(((e,t,n)=>n.isDragging?r.a.createElement(l.a,null,r.a.createElement(p.a,{dataProvider:e})):r.a.createElement(f,{field:a,tooltipContent:y,tooltipPosition:v,value:c},g)),[g,a,y,v,c]);return null==c?null:r.a.createElement(l.b,{dataProvider:x,fieldType:s,isAggregatable:o,hideTopN:e,isDraggable:n,render:j,scopeId:b,truncate:E})}));g.displayName="DefaultDraggable";const b=o()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-1g0jgxk-0"})(["vertical-align:top;"]);b.displayName="Badge";const y=({contextId:e,eventId:t,field:n,value:a,iconType:i,isDraggable:s,isAggregatable:o,fieldType:l,name:u,color:d="hollow",children:p,scopeId:m,tooltipContent:f,queryValue:y})=>null!=a?r.a.createElement(g,{id:`draggable-badge-default-draggable-${e}-${t}-${n}-${a}`,isDraggable:s,isAggregatable:o,fieldType:l,field:n,name:u,value:a,scopeId:m,tooltipContent:f,queryValue:y},r.a.createElement(b,{iconType:i,color:d,title:""},p||(""!==a?a:Object(c.c)()))):null;y.displayName="DraggableBadgeComponent";const v=r.a.memo(y);v.displayName="DraggableBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return s})),n.d(t,"b",(function(){return l}));var a=n(208),i=n(422),r=n(187);const s={notesById:{},errors:[],enableExperimental:{...n(16).a}},o=({note:e,notesById:t})=>({...t,[e.id]:e}),l=Object(r.reducerWithInitialState)(s).case(a.addNotes,((e,{notes:t})=>({...e,notesById:t.reduce(((e,t)=>({...e,[t.id]:t})),{})}))).case(a.deleteNote,((e,{id:t})=>({...e,notesById:Object.fromEntries(Object.entries(e.notesById).filter((([e,n])=>n.id!==t&&n.saveObjectId!==t)))}))).case(a.updateNote,((e,{note:t})=>({...e,notesById:o({note:t,notesById:e.notesById})}))).case(a.addError,((e,{id:t,title:n,message:a})=>({...e,errors:e.errors.concat({id:t,title:n,message:a})}))).case(a.removeError,((e,{id:t})=>({...e,errors:e.errors.filter((e=>e.id!==t))}))).case(a.addErrorHash,((e,{id:t,hash:n,title:a,message:i})=>{const r=e.errors.findIndex((e=>e.id===t)),s=e.errors.find((e=>e.id===t))||{id:t,title:a,message:i};return-1===r?{...e,errors:e.errors.concat({...s,hash:n,displayError:!e.errors.some((e=>e.hash===n))})}:{...e,errors:[...e.errors.slice(0,r),{...s,hash:n,displayError:!e.errors.some((e=>e.hash===n))},...e.errors.slice(r+1)]}})).build()},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.welcomeConversationTitle",{defaultMessage:"Welcome"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.defaultConversationTitle",{defaultMessage:"Default"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.elasticAiAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.useConversation.elasticAiAssistantName",{defaultMessage:"Assistant"})},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"j",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"e",(function(){return b})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return h}));var a=n(51);const i=e=>null!=e.id?e:{...e,id:Object(a.v4)()},r=e=>{const t=e;if(null!=t.id){const{id:e,...n}=t;return n}return e};var s=n(5);let o,l,u;s.i18n.translate("utils.wildcardWarning",{defaultMessage:"Using wildcards can impact Endpoint performance"}),s.i18n.translate("utils.filename.pathWarning",{defaultMessage:"Path may be formed incorrectly; verify value"}),function(e){e.HASH="process.hash.*",e.PATH="process.executable.caseless",e.SIGNER="process.Ext.code_signature"}(o||(o={})),function(e){e.HASH=".hash.",e.EXECUTABLE=".executable.caseless",e.PATH=".path",e.SIGNER=".Ext.code_signature"}(l||(l={})),function(e){e.LINUX="linux",e.MAC="macos",e.WINDOWS="windows"}(u||(u={}));const c=({os:e,type:t,value:n})=>{const a=e===u.WINDOWS?"\\":"/",i=n.split(a).pop();if(i)return"wildcard"!==t||1===(i.split("*").length||i.split("?").length)},d=({os:e,field:t,type:n,value:a})=>!["process.executable.caseless","file.path","file.path.text"].includes(t)||("wildcard"===n?e===u.WINDOWS?m(a):f(a):p({value:a,os:e})),p=({os:e,value:t})=>e===u.WINDOWS?/^[a-z]:(?:|\\\\[^<>:"'/\\|?*]+\\[^<>:"'/\\|?*]+|%\w+%|)[\\](?:[^<>:"'/\\|?*]+[\\/])*([^<>:"'/\\|?*])+$/i.test(t):/^(\/|(\/[\w\-]+)+|\/[\w\-]+\.[\w]+|(\/[\w-]+)+\/[\w\-]+\.[\w]+)$/i.test(t),m=e=>{const t=e[0],n=e.slice(-1),a=e.trim(),i=/\//.test(a);return 0!==e.length&&!(i||a.length!==e.length||"^"===t||"\\"===n||!g({path:e,isWindowsPath:!0}))},f=e=>{const t=e[0],n=e.slice(-1),a=e.trim();return 0!==e.length&&!(a.length!==e.length||"/"!==t||"/"===n||e.length>1024==1||!0===e.includes("//")||!g({path:e,isWindowsPath:!1}))},g=({path:e,isWindowsPath:t})=>{for(const n of e.split(t?"\\":"/"))if(!0===/[\*|\?]+/.test(n))return!0;return!1},b=e=>/\|\s+stats\s/i.test(e);var y=n(53);const v=e=>{const t=Object(y.getIndexPatternFromESQLQuery)(e);return h(t)},h=e=>e?e.split(",").map((e=>e.trim())):[]},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(59),u=n.n(l),c=n(159),d=n(716),p=n(717);const m=o.a.header.withConfig({displayName:"Header",componentId:"sc-1q9aiyj-0"})(["&.toggle-expand{margin-bottom:",";}.no-margin{margin-top:0 !important;margin-bottom:0 !important;}"," margin-bottom:0;user-select:text;",""],(({theme:e})=>e.eui.euiSizeL),(({height:e})=>e&&Object(s.css)(["height:","px;"],e)),(({border:e})=>e&&Object(s.css)(["border-bottom:",";padding-bottom:",";"],(({theme:e})=>e.eui.euiBorderThin),(({theme:e})=>e.eui.euiSizeL))));m.displayName="Header";const f=({alignHeader:e,stackHeader:t})=>null!=e?e:t?void 0:"center",g=({alignHeader:e,border:t,children:n,outerDirection:s="column",growLeftSplit:o=!0,headerFilters:l,height:g,hideSubtitle:b=!1,id:y,inspectMultiple:v=!1,inspectTitle:h,isInspectDisabled:E,showInspectButton:x=!0,split:j,stackHeader:O,subtitle:S,title:k,titleSize:w="l",toggleQuery:T,toggleStatus:I=!0,tooltip:C,tooltipTitle:M})=>{const _=Object(i.useCallback)((()=>{T&&T(!I)}),[T,I]),A=u()({"toggle-expand":I,siemHeaderSection:!0});return r.a.createElement(m,{"data-test-subj":"header-section",border:t,height:g,className:A,$hideSubtitle:b},r.a.createElement(a.EuiFlexGroup,{"data-test-subj":"headerSectionOuterFlexGroup",direction:s,gutterSize:"xs",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:o},r.a.createElement(a.EuiFlexGroup,{alignItems:f({alignHeader:e,stackHeader:O}),"data-test-subj":"headerSectionInnerFlexGroup",direction:O?"column":"row",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,{grow:o,className:I?"":"no-margin"},r.a.createElement(a.EuiFlexGroup,{alignItems:"center",responsive:!1,gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{responsive:!1,gutterSize:"none",className:"header-section-titles"},T&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonIcon,{"data-test-subj":"query-toggle-header","aria-label":p.a(I),color:"text",display:"empty",iconType:I?"arrowDown":"arrowRight",onClick:_,size:"s",title:p.a(I)})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiTitle,{size:w},r.a.createElement("h4",{"data-test-subj":"header-section-title"},r.a.createElement("span",{className:"eui-textBreakNormal"},k),C&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiIconTip,{color:"subdued",title:M,content:C,size:"l",type:"iInCircle"}))))))),y&&I&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(c.b,{isDisabled:E,queryId:y,multiple:v,showInspectButton:x,title:null!=h?h:k})),l&&I&&r.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-filters",grow:!1},l))),n&&I&&r.a.createElement(a.EuiFlexItem,{"data-test-subj":"header-section-supplements",grow:!!j},n))),!b&&I&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(d.a,{"data-test-subj":"header-section-subtitle",items:S}))))},b=r.a.memo(g)},function(e,t,n){"use strict";var a=n(258);e.exports=function(e,t,n,i){var r=i?i-1:1/0,s=0;return function(i){return a(i)?(e.enter(n),o(i)):t(i)};function o(i){return a(i)&&s++<r?(e.consume(i),o):(e.exit(n),t(i))}}},function(e,t,n){"use strict";n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return g})),n.d(t,"g",(function(){return b})),n.d(t,"c",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"i",(function(){return E})),n.d(t,"d",(function(){return x}));var a=n(53),i=n(45),r=n(234),s=n.n(r),o=n(425),l=n(113),u=n(122);const c=(e,t)=>{try{return e?JSON.stringify(Object(a.toElasticsearchQuery)(Object(a.fromKueryExpression)(e),t)):""}catch(e){return""}},d=(e,t)=>`${e}: ${(e=>!isNaN(Number(e)))(t)?t:new Date(t.toString()).valueOf()}`,p=s()((e=>{const t=Object(i.get)("base",e);return null!=t&&null!=t.fields?Object.keys(t.fields):[]})),m=(e,t)=>{const n=e.split(".");return p(t).includes(e)?["base","fields",e]:[n[0],"fields",e]},f=(e,t)=>{const n=m(e,t),a=Object(i.get)(n,t);return null!=a&&"date"===a.type},g=(e,t,n)=>{const a=m(e,n),r=Object(i.get)(a,n),s=r.subType.nested.path;return`${s}: { ${e.replace(`${s}.`,"")}: ${"date"===r.type?`"${t}"`:t} }`},b=(e,t)=>{const n=m(e,t),a=Object(i.get)(n,t).subType.nested.path;return`${a}: { ${e.replace(`${a}.`,"")}: * }`},y=(e,t)=>{const n=m(e,t),a=Object(i.get)(n,t);return!(null==a||!a.subType||!a.subType.nested)},v=(e,t)=>({range:{"@timestamp":{gte:e,lt:t,format:"strict_date_optional_time"}},meta:{type:"range",disabled:!1,negate:!1,alias:null,key:"@timestamp",params:{gte:e,lt:t,format:"strict_date_optional_time"}},$state:{store:a.FilterStateStore.APP_STATE}}),h=e=>Object(i.isEmpty)(e)||Object(i.isEmpty)(e.filter((e=>!0===e.enabled))),E=({config:e,indexPattern:t,queries:n,filters:i})=>{try{return[JSON.stringify(Object(a.buildEsQuery)(t,n,i.filter((e=>!1===e.meta.disabled)),{nestedIgnoreUnmapped:!0,...e,dateFormatTZ:void 0})),void 0]}catch(e){return[void 0,e]}},x=({config:e,dataProviders:t=[],indexPattern:n,browserFields:a,filters:r=[],kqlQuery:s,kqlMode:c})=>{const p={query:"",language:s.language};if(h(t)&&Object(i.isEmpty)(s.query)&&Object(i.isEmpty)(r))return null;if(h(t)&&Object(i.isEmpty)(s.query)&&!Object(i.isEmpty)(r)){const[t,a]=E({config:e,queries:[p],indexPattern:n,filters:r});return{filterQuery:t,kqlError:a}}const m="filter"===c?"and":"or",v=((e,t)=>e.reduce(((e,n)=>{const a=[n,...n.and].filter((e=>e.enabled));if(!a.length)return e;const i=a.map((e=>((e,t)=>`${e.excluded?"NOT ":""}${e.queryMatch.operator!==u.a&&e.type!==l.a.template?y(e.queryMatch.field,t)?g(e.queryMatch.field,e.queryMatch.value,t):f(e.queryMatch.field,t)?d(e.queryMatch.field,e.queryMatch.value):`${e.queryMatch.field} : ${Array.isArray(e.queryMatch.value)?e.queryMatch.value:Object(o.a)(e.queryMatch.value)}`:y(e.queryMatch.field,t)?b(e.queryMatch.field,t):`${e.queryMatch.field} ${u.a}`}`.trim())(e,t))),r=i.join(" and ");return[...e,r]}),[]).filter((e=>!Object(i.isEmpty)(e))).reduce(((e,t,n,a)=>a.length<=1?t:n?`${e} or (${t})`:`(${t})`),""))(t,a),x=(j=s.query,Object(i.isEmpty)(j)?"":`(${j})`);var j;const O=v?`(${v})`:"",S=O&&x?m:"";p.query=`(${O} ${S} ${x})`;const[k,w]=E({config:e,queries:[p],indexPattern:n,filters:r});return{filterQuery:k,kqlError:w}}},function(e,t,n){const a=n(314),{MAX_LENGTH:i,MAX_SAFE_INTEGER:r}=n(315),{safeRe:s,t:o}=n(316),l=n(412),{compareIdentifiers:u}=n(514);class SemVer{constructor(e,t){if(t=l(t),e instanceof SemVer){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>i)throw new TypeError(`version is longer than ${i} characters`);a("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;const n=e.trim().match(t.loose?s[o.LOOSE]:s[o.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>r||this.major<0)throw new TypeError("Invalid major version");if(this.minor>r||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>r||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map((e=>{if(/^[0-9]+$/.test(e)){const t=+e;if(t>=0&&t<r)return t}return e})):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(a("SemVer.compare",this.version,this.options,e),!(e instanceof SemVer)){if("string"==typeof e&&e===this.version)return 0;e=new SemVer(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof SemVer||(e=new SemVer(e,this.options)),u(this.major,e.major)||u(this.minor,e.minor)||u(this.patch,e.patch)}comparePre(e){if(e instanceof SemVer||(e=new SemVer(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{const n=this.prerelease[t],i=e.prerelease[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}compareBuild(e){e instanceof SemVer||(e=new SemVer(e,this.options));let t=0;do{const n=this.build[t],i=e.build[t];if(a("prerelease compare",t,n,i),void 0===n&&void 0===i)return 0;if(void 0===i)return 1;if(void 0===n)return-1;if(n!==i)return u(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const e=Number(n)?1:0;if(!t&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[e];else{let a=this.prerelease.length;for(;--a>=0;)"number"==typeof this.prerelease[a]&&(this.prerelease[a]++,a=-2);if(-1===a){if(t===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(e)}}if(t){let a=[t,e];!1===n&&(a=[t]),0===u(this.prerelease[0],t)?isNaN(this.prerelease[1])&&(this.prerelease=a):this.prerelease=a}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}e.exports=SemVer},function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"c",(function(){return m})),n.d(t,"n",(function(){return f}));var a=n(45),i=n(114),r=n(124),s=n(204),o=n(127),l=n(181),u=n(424);n.d(t,"f",(function(){return i.g})),n.d(t,"h",(function(){return i.i})),n.d(t,"g",(function(){return i.h})),n.d(t,"l",(function(){return i.m})),n.d(t,"k",(function(){return i.l})),n.d(t,"p",(function(){return i.r})),n.d(t,"o",(function(){return i.q})),n.d(t,"m",(function(){return i.n})),n.d(t,"i",(function(){return i.j})),n.d(t,"q",(function(){return i.w})),n.d(t,"r",(function(){return i.x})),n.d(t,"j",(function(){return i.k})),n.d(t,"a",(function(){return i.b})),n.d(t,"b",(function(){return i.e}));const c=({activeTimelineDataProviders:e,dataProviders:t,dispatch:n,result:a,timelineId:r,noProviderFound:s=l.b.noProviderFound,onAddedToTimeline:o})=>{const c=Object(i.p)(a),d=t[c];d?Object(u.b)({dataProviders:e,destination:a.destination,dispatch:n,onAddedToTimeline:o,providerToAdd:d,timelineId:r}):n(s({id:c}))},d=({isAggregatable:e,fieldType:t,fieldName:n,hideTopN:a})=>{const i=["boolean","geo-point","geo-shape","ip","keyword","number","numeric","string"].includes(t),r=["kibana.alert.ancestors.depth","kibana.alert.ancestors.id","kibana.alert.ancestors.rule","kibana.alert.ancestors.type","kibana.alert.original_event.action","kibana.alert.original_event.category","kibana.alert.original_event.code","kibana.alert.original_event.created","kibana.alert.original_event.dataset","kibana.alert.original_event.duration","kibana.alert.original_event.end","kibana.alert.original_event.hash","kibana.alert.original_event.id","kibana.alert.original_event.kind","kibana.alert.original_event.module","kibana.alert.original_event.original","kibana.alert.original_event.outcome","kibana.alert.original_event.provider","kibana.alert.original_event.risk_score","kibana.alert.original_event.risk_score_norm","kibana.alert.original_event.sequence","kibana.alert.original_event.severity","kibana.alert.original_event.start","kibana.alert.original_event.timezone","kibana.alert.original_event.type","kibana.alert.original_time","kibana.alert.rule.created_by","kibana.alert.rule.description","kibana.alert.rule.enabled","kibana.alert.rule.false_positives","kibana.alert.rule.from","kibana.alert.rule.uuid","kibana.alert.rule.immutable","kibana.alert.rule.interval","kibana.alert.rule.max_signals","kibana.alert.rule.name","kibana.alert.rule.note","kibana.alert.rule.references","kibana.alert.risk_score","kibana.alert.rule.rule_id","kibana.alert.severity","kibana.alert.rule.size","kibana.alert.rule.tags","kibana.alert.rule.threat","kibana.alert.rule.threat.tactic.id","kibana.alert.rule.threat.tactic.name","kibana.alert.rule.threat.tactic.reference","kibana.alert.rule.threat.technique.id","kibana.alert.rule.threat.technique.name","kibana.alert.rule.threat.technique.reference","kibana.alert.rule.timeline_id","kibana.alert.rule.timeline_title","kibana.alert.rule.to","kibana.alert.rule.type","kibana.alert.rule.updated_by","kibana.alert.rule.version","kibana.alert.workflow_status"].includes(n);return!a&&(r||e&&i)},p={"kibana.alert.rule.name":"kibana.alert.rule.uuid","event.module":"rule.reference"},m=({browserFields:e,dispatch:t,result:n,scopeId:l,defaultsHeader:u})=>{var c;const d=Object(i.o)(n),m=(e=>Object(a.keyBy)("name",(e=>Object.values(e).reduce(((e,t)=>[...e,...Object.values(null!=t.fields?t.fields:{})]),[]))(e)))(e)[d],f=l!==r.e.alertsOnAlertsPage&&l!==r.e.alertsOnRuleDetailsPage||null===(c=u.find((e=>e.id===d)))||void 0===c?{}:c,g=Object(o.getScopedActions)(l);var b;null!=m&&g?t(g.upsertColumn({column:{category:m.category,columnHeaderType:"not-filtered",description:Object(a.isString)(m.description)?m.description:void 0,example:Object(a.isString)(m.example)?m.example:void 0,id:d,linkField:null!==(b=p[d])&&void 0!==b?b:void 0,type:m.type,aggregatable:m.aggregatable,initialWidth:s.a,...f},id:l,index:null!=n.destination?n.destination.index:0})):g&&t(g.upsertColumn({column:{columnHeaderType:"not-filtered",id:d,initialWidth:s.a},id:l,index:null!=n.destination?n.destination.index:0}))},f=e=>e.slice(e.lastIndexOf(".")+1)},,function(e,t,n){"use strict";let a,i,r,s;n.r(t),n.d(t,"UsersType",(function(){return a})),n.d(t,"UsersTableType",(function(){return i})),n.d(t,"UsersDetailsTableType",(function(){return r})),n.d(t,"UserAssetTableType",(function(){return s})),function(e){e.page="page",e.details="details",e.flyout="flyout"}(a||(a={})),function(e){e.allUsers="allUsers",e.authentications="authentications",e.anomalies="anomalies",e.risk="userRisk",e.events="events"}(i||(i={})),function(e){e.authentications="authentications",e.anomalies="anomalies",e.risk="userRisk",e.events="events"}(r||(r={})),function(e){e.assetEntra="userAssetEntra",e.assetOkta="userAssetOkta"}(s||(s={}))},function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"o",(function(){return r})),n.d(t,"r",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"l",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"k",(function(){return g})),n.d(t,"j",(function(){return b})),n.d(t,"i",(function(){return y})),n.d(t,"h",(function(){return v})),n.d(t,"g",(function(){return h})),n.d(t,"p",(function(){return E})),n.d(t,"q",(function(){return x}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.connectors.useLoadActionTypes.errorMessage",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into your Elastic Life. "}),r=a.i18n.translate("xpack.elasticAssistant.connectors.useLoadConnectors.errorMessage",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into your Elastic Life. "}),s=(a.i18n.translate("xpack.elasticAssistant.content.prompts.welcome.welcomeSecurityPrompt",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-source portal into Elastic Security. "}),a.i18n.translate("xpack.elasticAssistant.assistant.connectors.preconfiguredTitle",{defaultMessage:"Preconfigured"})),o=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.ariaLabel",{defaultMessage:"Conversation Selector"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelector.newConnectorOptions",{defaultMessage:"Add new Connector..."}),u=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelectorInline.connectorLabel",{defaultMessage:"Connector:"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorSelectorInline.connectorPlaceholder",{defaultMessage:"Select a Connector"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.title",{defaultMessage:"Add Generative AI Connector"}),p=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.description",{defaultMessage:"Configure a connector to continue the conversation"}),m=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.missingPrivilegesTitle",{defaultMessage:"Generative AI Connector Required"}),f=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.addConnectorButton.missingPrivilegesDescription",{defaultMessage:"Please contact your administrator to enable a Generative AI Connector."}),g=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.userYouTitle",{defaultMessage:"You"}),b=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.userAssistantTitle",{defaultMessage:"Assistant"}),y=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.timestampAtTitle",{defaultMessage:"at"}),v=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.skipTitle",{defaultMessage:"Click to skip..."}),h=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.setup.complete",{defaultMessage:"Connector setup complete!"}),E=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.calloutTitle",{defaultMessage:"The current conversation is missing a connector configuration"}),x=a.i18n.translate("xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.conversationSettingsLink",{defaultMessage:"Conversation Settings"})},,function(e,t,n){"use strict";e.exports=n(611)},,function(e,t,n){"use strict";var a=n(167);n.d(t,"a",(function(){return a.a}));var i=n(195);n.d(t,"b",(function(){return i.a}));var r=n(138);n.d(t,"c",(function(){return r.b}));var s=n(149);n.d(t,"d",(function(){return s.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return o}));var a=n(111);function i(e){return a.preprocess((e=>"string"==typeof e?""===e?[]:e.split(","):e),a.array(e))}const r=a.enum(["true","false"]).or(a.boolean()).transform((e=>"boolean"==typeof e?e:"true"===e)),s=5;function o(e){const t=[],n=e.issues;for(;n.length>0;){const e=n.shift();"invalid_union"!==e.code?t.push(l(e)):n.push(...e.unionErrors.flatMap((e=>e.issues)))}const a=t.length-s;return a>0&&(t.splice(s),t.push(`and ${a} more`)),t.join(", ")}function l(e){return 0===e.path.length?e.message:`${e.path.join(".")}: ${e.message}`}var u=n(65),c=n.n(u);function d(e,t){var n;n=e,!isNaN(Date.parse(n))||n.trim().startsWith("now")&&Boolean(c.a.parse(n))||t.addIssue({code:a.ZodIssueCode.custom,message:"Failed to parse date-math expression"})}const p=e=>e;function m(e,t){const n=t.safeParse(e);if(n.success)return n.data}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(2),i=n(110);const r={managed:!0},s=()=>{const{services:{apm:e}}=Object(i.i)();return{startTransaction:Object(a.useCallback)((({name:t,type:n="user-interaction",options:a})=>e.startTransaction(t,n,null!=a?a:r)),[e])}},o=e=>`Timeline search ${e}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(45);const i=e=>Object(a.isEmpty)(e)?"":`${null!=e&&e.startsWith("?")?e:`?${e}`}`},function(e,t,n){"use strict";let a,i,r,s,o,l,u;n.d(t,"e",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u})),function(e){e.windows="windows",e.mac="mac",e.linux="linux"}(a||(a={})),function(e){e.is="is",e.matches="matches"}(i||(i={})),function(e){e.enrolled="enrolled",e.unenrolled="unenrolled"}(r||(r={})),function(e){e.UNHEALTHY="unhealthy",e.HEALTHY="healthy",e.OFFLINE="offline",e.UPDATING="updating",e.INACTIVE="inactive",e.UNENROLLED="unenrolled"}(s||(s={})),function(e){e.detect="detect",e.prevent="prevent",e.off="off"}(o||(o={})),function(e){e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported"}(l||(l={})),function(e){e.ENROLLED_AT="enrolled_at",e.HOSTNAME="metadata.host.hostname",e.HOST_STATUS="host_status",e.POLICY_NAME="metadata.Endpoint.policy.applied.name",e.POLICY_STATUS="metadata.Endpoint.policy.applied.status",e.HOST_OS_NAME="metadata.host.os.name",e.HOST_IP="metadata.host.ip",e.AGENT_VERSION="metadata.agent.version",e.LAST_SEEN="last_checkin"}(u||(u={}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(111),i=n(636);const r=a.z.object({direction:i.b.default(i.a.desc),field:a.z.string().default("@timestamp")}).default({direction:i.a.desc,field:"@timestamp"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p}));var a=n(2),i=n(48),r=n(119),s=n(4),o=n(112),l=n(128),u=n(181);const c=()=>{var e;const t=Object(i.useDispatch)(),n=null!==(e=Object(o.b)(l.d.globalFullScreenSelector))&&void 0!==e&&e,c=Object(a.useCallback)((e=>{const n=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add(s.rc,"euiDataGrid__restrictBody"):!1!==n&&!1!==e||document.body.classList.remove(s.rc,"euiDataGrid__restrictBody"),t(u.c.setFullScreen({id:r.a.global,fullScreen:e}))}),[t]);return Object(a.useMemo)((()=>({globalFullScreen:n,setGlobalFullScreen:c})),[n,c])},d=()=>{var e;const t=Object(i.useDispatch)(),n=null!==(e=Object(o.b)(l.d.timelineFullScreenSelector))&&void 0!==e&&e,s=Object(a.useCallback)((e=>{const n=null!==document.querySelector(".euiDataGrid--fullScreen");e?document.body.classList.add("euiDataGrid__restrictBody"):!1!==n&&!1!==e||document.body.classList.remove("euiDataGrid__restrictBody"),t(u.c.setFullScreen({id:r.a.timeline,fullScreen:e}))}),[t]);return Object(a.useMemo)((()=>({timelineFullScreen:n,setTimelineFullScreen:s})),[n,s])},p=()=>{const{globalFullScreen:e}=c(),{timelineFullScreen:t}=d(),n=(()=>{const[e,t]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const e=document.body,n=new MutationObserver((n=>{for(const a of n)"class"===a.attributeName&&t(e.classList.contains("euiDataGrid__restrictBody"))}));return n.observe(e,{attributes:!0}),()=>n.disconnect()}),[]),e})();return e||t||n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"g",(function(){return p}));var a=n(4);const i="histogram-actions-trigger",r={[a.yc.hosts]:"host",[a.yc.users]:"user"},s=(e,t)=>{const n=r[e];return n&&t?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:`${n}.name`,params:{query:t}},query:{match_phrase:{[`${n}.name`]:t}}}]:[]},o=e=>{const t=r[e];return t&&e?[{query:{bool:{should:[{exists:{field:`${t}.name`}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:`{"query": {"bool": {"filter": [{"bool": {"should": [{"exists": {"field": "${t}.name"}}],"minimum_should_match": 1}}]}}}`}}]:[]},l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:"source.ip",params:{query:e}},query:{bool:{should:[{match_phrase:{"source.ip":e}},{match_phrase:{"destination.ip":e}}],minimum_should_match:1}}}]:[],u=[{query:{bool:{should:[{exists:{field:"source.ip"}},{exists:{field:"destination.ip"}}],minimum_should_match:1}},meta:{alias:"",disabled:!1,key:"bool",negate:!1,type:"custom",value:'{"bool":{"filter":[{"bool":{"should":[{"bool":{"should":[{"exists":{"field": "source.ip"}}],"minimum_should_match":1}},{"bool":{"should":[{"exists":{"field": "destination.ip"}}],"minimum_should_match":1}}],"minimum_should_match":1}}]}}'}}],c=e=>e.length>=1?[{meta:{type:"phrases",key:"_index",params:e,alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({match_phrase:{_index:e}}))),minimum_should_match:1}}}]:[],d=e=>(null!=e?e:[]).reduce(((e,t)=>{var n,a,i,r,s,o;return{requests:[...e.requests,JSON.stringify({body:null==t?void 0:t.json,index:(null!==(n=null==t||null===(a=t.stats)||void 0===a||null===(i=a.indexFilter)||void 0===i?void 0:i.value)&&void 0!==n?n:"").split(",")},null,2)],responses:[...e.responses,JSON.stringify(null!==(r=null==t||null===(s=t.response)||void 0===s||null===(o=s.json)||void 0===o?void 0:o.rawResponse)&&void 0!==r?r:{},null,2)]}}),{requests:[],responses:[]}),p=e=>e.reduce(((e,t)=>{try{return[...e,JSON.parse(t)]}catch(t){return e}}),[])},function(e,t,n){"use strict";n.d(t,"b",(function(){return O})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return N})),n.d(t,"d",(function(){return L})),n.d(t,"e",(function(){return G})),n.d(t,"g",(function(){return K.b})),n.d(t,"f",(function(){return K.a}));var a=n(111),i=n(182),r=n(148),s=n(141);const o=a.z.literal("RULE_NOT_MODIFIED"),l=a.z.object({id:a.z.string(),name:a.z.string().optional(),skip_reason:o}),u=a.z.object({id:a.z.string(),name:a.z.string().optional()}),c=a.z.enum(["IMMUTABLE","MACHINE_LEARNING_AUTH","MACHINE_LEARNING_INDEX_PATTERN","ESQL_INDEX_PATTERN"]),d=(c.enum,a.z.object({message:a.z.string(),status_code:a.z.number().int(),err_code:c.optional(),rules:a.z.array(u)})),p=a.z.object({updated:a.z.array(r.e),created:a.z.array(r.e),deleted:a.z.array(r.e),skipped:a.z.array(l)}),m=a.z.object({failed:a.z.number().int(),skipped:a.z.number().int(),succeeded:a.z.number().int(),total:a.z.number().int()}),f=a.z.object({success:a.z.boolean().optional(),status_code:a.z.number().int().optional(),message:a.z.string().optional(),rules_count:a.z.number().int().optional(),attributes:a.z.object({results:p,summary:m,errors:a.z.array(d).optional()})}),g=a.z.string(),b=a.z.object({query:a.z.string().optional(),ids:a.z.array(a.z.string()).min(1).optional()}),y=b.merge(a.z.object({action:a.z.literal("delete")})),v=b.merge(a.z.object({action:a.z.literal("disable")})),h=b.merge(a.z.object({action:a.z.literal("enable")})),E=b.merge(a.z.object({action:a.z.literal("export")})),x=b.merge(a.z.object({action:a.z.literal("duplicate"),duplicate:a.z.object({include_exceptions:a.z.boolean(),include_expired_exceptions:a.z.boolean()}).optional()})),j=a.z.enum(["rule","1h","1d","7d"]),O=(j.enum,a.z.enum(["enable","disable","export","delete","duplicate","edit"]).enum),S=a.z.enum(["add_tags","delete_tags","set_tags","add_index_patterns","delete_index_patterns","set_index_patterns","set_timeline","add_rule_actions","set_rule_actions","set_schedule"]).enum,k=a.z.object({group:s.u,id:s.v,params:s.w,frequency:s.t.optional(),alerts_filter:s.s.optional()}).strict(),w=a.z.object({type:a.z.enum(["add_rule_actions","set_rule_actions"]),value:a.z.object({throttle:j.optional(),actions:a.z.array(k)})}),T=a.z.object({type:a.z.literal("set_schedule"),value:a.z.object({interval:a.z.string().regex(/^[1-9]\d*[smh]$/),lookback:a.z.string().regex(/^[1-9]\d*[smh]$/)})}),I=a.z.object({type:a.z.enum(["add_index_patterns","delete_index_patterns","set_index_patterns"]),value:s.f,overwrite_data_views:a.z.boolean().optional()}),C=a.z.object({type:a.z.enum(["add_tags","delete_tags","set_tags"]),value:s.O}),M=a.z.object({type:a.z.literal("set_timeline"),value:a.z.object({timeline_id:s.Y,timeline_title:s.Z})}),_=a.z.union([C,I,M,w,T]),A=b.merge(a.z.object({action:a.z.literal("edit"),edit:a.z.array(_).min(1)}));a.z.object({dry_run:i.b.optional()}),a.z.union([y,v,h,E,x,A]),a.z.union([f,g]);var P=n(299);a.z.array(a.z.union([r.e,P.a])),a.z.array(r.c),a.z.array(a.z.object({id:s.K.optional(),rule_id:s.N.optional()})),a.z.array(r.d),a.z.array(r.f);var F=n(46),D=n(120);let N;!function(e){e.Enabled="enabled",e.Disabled="disabled"}(N||(N={}));const R=Object(D.r)("CoverageOverviewRuleActivity",N);let L;!function(e){e.Prebuilt="prebuilt",e.Custom="custom"}(L||(L={}));const z=Object(D.r)("CoverageOverviewRuleSource",L),B=F.partial({search_term:D.j,activity:Object(D.i)(R),source:Object(D.i)(z)}),q=(F.exact(F.partial({filter:B})),F.type({name:F.string,activity:R}));F.exact(F.type({coverage:F.record(F.string,Object(D.i)(F.string)),unmapped_rule_ids:F.array(F.string),rules_data:F.record(F.string,q)})),r.c,r.e,a.z.object({id:s.K.optional(),rule_id:s.N.optional()}),r.e,r.d,r.e,a.z.object({id:s.K.optional(),rule_id:s.N.optional()}),r.e,r.f,r.e;var $=n(139);const V={exported_count:F.number,exported_rules_count:F.number,missing_rules:F.array(F.exact(F.type({rule_id:D.j}))),missing_rules_count:F.number},U=F.intersection([F.exact(F.type({id:D.j,type:D.j})),F.exact(F.partial({reason:F.string}))]),H={exported_action_connector_count:F.number,missing_action_connection_count:F.number,missing_action_connections:F.array(F.exact(F.type({id:D.j,type:D.j}))),excluded_action_connection_count:F.number,excluded_action_connections:F.array(U)};F.intersection([F.exact(F.type(V)),F.exact(F.partial($.p)),F.exact(F.partial(H))]),a.z.object({exclude_export_details:i.b.optional().default(!1),file_name:a.z.string().optional().default("export.ndjson")}),a.z.object({objects:a.z.array(a.z.object({rule_id:s.N}))}).nullable();var Z=n(248);const G=a.z.enum(["created_at","createdAt","enabled","execution_summary.last_execution.date","execution_summary.last_execution.metrics.execution_gap_duration_s","execution_summary.last_execution.metrics.total_indexing_duration_ms","execution_summary.last_execution.metrics.total_search_duration_ms","execution_summary.last_execution.status","name","risk_score","riskScore","severity","updated_at","updatedAt"]);G.enum,a.z.object({fields:Object(i.a)(a.z.string()).optional(),filter:a.z.string().optional(),sort_field:G.optional(),sort_order:Z.a.optional(),page:a.z.coerce.number().int().min(1).optional().default(1),per_page:a.z.coerce.number().int().min(0).optional().default(20)}),a.z.object({page:a.z.number().int(),perPage:a.z.number().int(),total:a.z.number().int(),data:a.z.array(r.e)}),F.exact(F.type({rules_summary:F.type({custom_count:D.m,prebuilt_installed_count:D.m}),aggregated_fields:F.type({tags:F.array(F.string)})}));var Q=n(371);a.z.object({overwrite:i.b.optional().default(!1),overwrite_exceptions:i.b.optional().default(!1),overwrite_action_connectors:i.b.optional().default(!1),as_new_list:i.b.optional().default(!1)}),a.z.object({exceptions_success:a.z.boolean(),exceptions_success_count:a.z.number().int().min(0),exceptions_errors:a.z.array(P.a),rules_count:a.z.number().int().min(0),success:a.z.boolean(),success_count:a.z.number().int().min(0),errors:a.z.array(P.a),action_connectors_errors:a.z.array(P.a),action_connectors_warnings:a.z.array(Q.a),action_connectors_success:a.z.boolean(),action_connectors_success_count:a.z.number().int().min(0)}).strict();var W=n(247);W.b.and(W.f).and(W.c.partial().extend({rule_id:W.d,immutable:a.literal(!1).default(!1)})),s.O;var K=n(410)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>"string"==typeof e?e:Array.isArray(e)&&e.length>0&&"string"==typeof e[0]?e[0]:null!=t?t:null},function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"i",(function(){return y})),n.d(t,"f",(function(){return v})),n.d(t,"c",(function(){return h})),n.d(t,"g",(function(){return x})),n.d(t,"j",(function(){return j})),n.d(t,"e",(function(){return O})),n.d(t,"d",(function(){return S})),n.d(t,"h",(function(){return k})),n.d(t,"b",(function(){return w}));var a=n(180),i=n(280),r=n(240),s=n(9),o=n(68),l=n(113),u=n(4),c=n(110),d=n(480);const p=e=>new d.c([e]),m=e=>Object(r.pipe)(l.i.decode(e),Object(a.fold)(Object(o.throwErrors)(p),i.identity)),f=e=>Object(r.pipe)(l.h.decode(e),Object(a.fold)(Object(o.throwErrors)(p),i.identity)),g=async({timelineId:e,timeline:t,version:n,savedSearch:a})=>{let i=null,r=null;try{r=JSON.stringify({timeline:t,timelineId:e,version:n})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}try{if(t.savedSearchId&&a){const{savedSearch:e}=c.b.get();await e.save(a,{onTitleDuplicate:()=>({}),copyOnSave:!1})}}catch(e){return Promise.reject(new Error(`Failed to copy saved search: ${t.savedSearchId}`))}try{i=await c.b.get().http.patch(u.Jc,{method:"PATCH",body:r,version:"2023-10-31"})}catch(e){return Promise.resolve(f(e.body))}return m(i)},b=async({timelineId:e,timeline:t,savedSearch:n})=>{let a=null,i=null,r=null;try{if(t.savedSearchId&&n){const{savedSearch:e}=c.b.get(),t={...n};delete t.id,r=await e.save(t,{onTitleDuplicate:()=>({}),copyOnSave:!1})}}catch(e){return Promise.reject(new Error(`Failed to copy saved search: ${t.savedSearchId}`))}try{i=JSON.stringify({timeline:{...t,savedSearchId:r||t.savedSearchId},timelineIdToCopy:e})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}try{a=await c.b.get().http.post(u.Cc,{method:"POST",body:i,version:"1"})}catch(e){return Promise.resolve(f(e.body))}return m(a)},y=async({timelineId:e,timeline:t,version:n,savedSearch:a})=>{try{if(Object(s.isEmpty)(e)&&t.status===l.k.draft&&t){var i,r,o,d,p;const e=await E({timelineType:t.timelineType,templateTimelineId:null!==(i=t.templateTimelineId)&&void 0!==i?i:void 0,templateTimelineVersion:null!==(r=t.templateTimelineVersion)&&void 0!==r?r:void 0}),n=m(e),s=t.timelineType===l.l.template?{templateTimelineId:null!==(o=n.data.persistTimeline.timeline.templateTimelineId)&&void 0!==o?o:t.templateTimelineId,templateTimelineVersion:null!==(d=n.data.persistTimeline.timeline.templateTimelineVersion)&&void 0!==d?d:t.templateTimelineVersion}:{};return g({timelineId:n.data.persistTimeline.timeline.savedObjectId,timeline:{...t,...s},version:null!==(p=n.data.persistTimeline.timeline.version)&&void 0!==p?p:"",savedSearch:a})}return Object(s.isEmpty)(e)?(async({timeline:e})=>{let t;try{t=JSON.stringify({timeline:e})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}const n=await c.b.get().http.post(u.Jc,{method:"POST",body:t,version:"2023-10-31"});return m(n)})({timeline:t}):g({timelineId:null!=e?e:"-1",timeline:t,version:null!=n?n:"",savedSearch:a})}catch(e){return 403===e.status_code||403===e.body.status_code?Promise.resolve({data:{persistTimeline:{code:403,message:e.message||e.body.message,timeline:{...t,savedObjectId:"",version:""}}}}):Promise.resolve(e)}},v=async({fileToImport:e,signal:t})=>{const n=new FormData;return n.append("file",e),c.b.get().http.fetch(`${u.Gc}`,{method:"POST",headers:{"Content-Type":void 0},body:n,signal:t,version:"2023-10-31"})},h=({filename:e="timelines_export.ndjson",ids:t=[],signal:n})=>{let a;try{a=t.length>0?JSON.stringify({ids:t}):void 0}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return c.b.get().http.fetch(`${u.Ec}`,{method:"POST",body:a,query:{file_name:e},signal:n,version:"2023-10-31"})},E=async({timelineType:e,templateTimelineId:t,templateTimelineVersion:n})=>{let a;const i=e===l.l.template?{templateTimelineId:t,templateTimelineVersion:n}:{};try{a=JSON.stringify({timelineType:e,...i})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}const r=await c.b.get().http.post(u.Dc,{body:a,version:"2023-10-31"});return m(r)},x=async()=>{return e=await c.b.get().http.post(u.Hc,{version:"2023-10-31"}),Object(r.pipe)(l.n.decode(e),Object(a.fold)(Object(o.throwErrors)(p),i.identity));var e},j=async e=>{return t=await c.b.get().http.get(u.Ic,{query:{id:e},version:"2023-10-31"}),Object(r.pipe)(l.c.decode(t),Object(a.fold)(Object(o.throwErrors)(p),i.identity));var t},O=async e=>{const t=await c.b.get().http.get(u.Jc,{query:{template_timeline_id:e},version:"2023-10-31"});return n=t,Object(r.pipe)(l.e.decode(n),Object(a.fold)(Object(o.throwErrors)(p),i.identity));var n},S=async(e,t)=>{var n,s,d,m,f,g;return b=await c.b.get().http.fetch(u.Bc,{method:"GET",query:{...e.onlyUserFavorite?{only_user_favorite:e.onlyUserFavorite}:{},...null!=e&&null!==(n=e.pageInfo)&&void 0!==n&&n.pageSize?{page_size:e.pageInfo.pageSize}:{},...null!=e&&null!==(s=e.pageInfo)&&void 0!==s&&s.pageIndex?{page_index:e.pageInfo.pageIndex}:{},...e.search?{search:e.search}:{},...null!=e&&null!==(d=e.sort)&&void 0!==d&&d.sortField?{sort_field:null==e||null===(m=e.sort)||void 0===m?void 0:m.sortField}:{},...null!=e&&null!==(f=e.sort)&&void 0!==f&&f.sortOrder?{sort_order:null==e||null===(g=e.sort)||void 0===g?void 0:g.sortOrder}:{},...e.status?{status:e.status}:{},...e.timelineType?{timeline_type:e.timelineType}:{}},signal:t,version:"2023-10-31"}),Object(r.pipe)(l.m.decode(b),Object(a.fold)(Object(o.throwErrors)(p),i.identity));var b},k=async({timelineId:e,templateTimelineId:t,templateTimelineVersion:n,timelineType:s})=>{let d;try{d=JSON.stringify({timelineId:e,templateTimelineId:t,templateTimelineVersion:n,timelineType:s})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return m=await c.b.get().http.patch(u.Fc,{method:"PATCH",body:d,version:"2023-10-31"}),Object(r.pipe)(l.o.decode(m),Object(a.fold)(Object(o.throwErrors)(p),i.identity));var m},w=async(e,t)=>{let n;try{n=t?JSON.stringify({savedObjectIds:e,searchIds:t}):JSON.stringify({savedObjectIds:e})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return await c.b.get().http.delete(u.Jc,{method:"DELETE",body:n,version:"2023-10-31"})}},function(e,t,n){"use strict";n.d(t,"d",(function(){return a.a})),n.d(t,"j",(function(){return a.b})),n.d(t,"c",(function(){return St})),n.d(t,"a",(function(){return xt})),n.d(t,"f",(function(){return Ct})),n.d(t,"g",(function(){return At})),n.d(t,"k",(function(){return wt})),n.d(t,"i",(function(){return x.a})),n.d(t,"b",(function(){return K})),n.d(t,"e",(function(){return se.c})),n.d(t,"h",(function(){return se.d}));var a=n(123),i=n(2),r=n.n(i),s=n(17),o=n(302),l=n.n(o),u=n(44),c=n.n(u),d=n(67),p=n(13),m=n(253),f=n(221),g=n(388),b=n(250),y=n(45),v=n(51);const h=({currentReplacements:e,rawValue:t})=>{if(null!=e){const n=Object(y.invert)(e)[t];return null!=n?n:Object(v.v4)()}return Object(v.v4)()};var E=n(374),x=n(222);var j=n(249),O={name:"a4hmbt",styles:"position:absolute"};const S=({isDisabled:e,isLoading:t,onChatCleared:n,onSendMessage:a})=>Object(p.jsx)(s.EuiFlexGroup,{css:O,direction:"column",gutterSize:"xs"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiToolTip,{position:"right",content:j.b},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":j.b,color:"danger","data-test-subj":"clear-chat",display:"base",iconType:"cross",isDisabled:e,onClick:n}))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiToolTip,{position:"right",content:j.g},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":j.g,"data-test-subj":"submit-chat",color:"primary",display:"base",iconType:"returnKey",isDisabled:e,isLoading:t,onClick:a}))));var k=n(5);const w=k.i18n.translate("xpack.elasticAssistant.assistant.promptPlaceholder",{defaultMessage:"Ask me anything from 'summarize this alert' to 'help me build a query...'"}),T=c()(s.EuiTextArea)`
  min-height: 125px;
  padding-right: 42px;
`,I=Object(i.forwardRef)((({isDisabled:e=!1,value:t,onPromptSubmit:n,handlePromptChange:a,...r},s)=>{const o=Object(i.useCallback)((e=>{a(e.target.value)}),[a]),l=Object(i.useCallback)((e=>{var i;"Enter"===e.key&&!e.shiftKey&&t.trim().length>0?(e.preventDefault(),n(null===(i=e.target.value)||void 0===i?void 0:i.trim()),a("")):"Enter"!==e.key||e.shiftKey||0!==t.trim().length||(e.preventDefault(),e.stopPropagation())}),[t,n,a]);return Object(i.useEffect)((()=>{a(t)}),[a,t]),Object(p.jsx)(T,{className:"eui-scrollBar",inputRef:s,id:"prompt-textarea","data-test-subj":"prompt-textarea",fullWidth:!0,autoFocus:!0,disabled:e,placeholder:w,value:t,onChange:o,onKeyDown:l})}));I.displayName="PromptTextArea";var C={name:"zyunh5",styles:"left:-34px;position:relative;top:11px"},M={name:"1d3w5wq",styles:"width:100%"};const _=({handleButtonSendMessage:e,handleOnChatCleared:t,handlePromptChange:n,handleSendMessage:a,isDisabled:r,isLoading:o,shouldRefocusPrompt:l,userPrompt:u})=>{const c=Object(i.useRef)(null);Object(i.useEffect)((()=>{l&&c.current&&(null==c||c.current.focus())}),[l]);const d=Object(i.useMemo)((()=>r?"":null!=u?u:""),[r,u]),m=Object(i.useCallback)((()=>{var t,n,a;e(null!==(t=null===(n=c.current)||void 0===n||null===(a=n.value)||void 0===a?void 0:a.trim())&&void 0!==t?t:"")}),[e,c]);return Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"none",css:M},Object(p.jsx)(s.EuiFlexItem,null,Object(p.jsx)(I,{onPromptSubmit:a,ref:c,handlePromptChange:n,value:d,isDisabled:r})),Object(p.jsx)(s.EuiFlexItem,{css:C,grow:!1},Object(p.jsx)(S,{onChatCleared:t,isDisabled:r,isLoading:o,onSendMessage:m})))},A=k.i18n.translate("xpack.elasticAssistant.components.upgrade.upgradeTitle",{defaultMessage:"Manage license"}),P=k.i18n.translate("xpack.elasticAssistant.components.upgrade.upgradeButtonLabel",{defaultMessage:"Subscription plans"}),F=({basePath:e})=>Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"s",wrap:!0,"data-test-subj":"upgrade-buttons"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiButton,{href:"https://www.elastic.co/subscriptions",iconType:"popout",iconSide:"right",target:"_blank"},P)),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiButton,{href:`${e}/app/management/stack/license_management`,iconType:"gear",target:"_blank"},A))),D=r.a.memo(F);D.displayName="UpgradeButtons";var N={name:"1d3w5wq",styles:"width:100%"},R={name:"1d3w5wq",styles:"width:100%"};const L=({connectorPrompt:e,http:t,isAssistantEnabled:n,isWelcomeSetup:a})=>{const i=t.basePath.get();return n?a?Object(p.jsx)(s.EuiFlexGroup,{css:N},Object(p.jsx)(s.EuiFlexItem,{"data-test-subj":"connector-prompt"},e)):null:Object(p.jsx)(s.EuiFlexGroup,{justifyContent:"spaceAround",css:R},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(D,{basePath:i})))};var z=n(47),B=n(179),q=n(496),$=n(220),V=n(177),U=n(252);const H=Object(B.css)({name:"1azv1pg",styles:"height:32px;.euiSuperSelect{width:400px;}.euiSuperSelectControl{border:none;box-shadow:none;background:none;padding-left:0;}.euiFormControlLayoutIcons{right:14px;top:2px;}"}),Z=Object(B.css)({name:"94g3yr",styles:"overflow:hidden;text-overflow:ellipsis;max-width:400px"}),G=Object(B.css)({name:"gexgj1",styles:"overflow:hidden;text-overflow:ellipsis;max-width:400px;font-weight:normal;padding-bottom:5px;padding-left:0;padding-top:2px"}),Q=r.a.memo((({isDisabled:e=!1,selectedConnectorId:t,selectedConversation:n})=>{var r,o;const[l,u]=Object(i.useState)(!1),{actionTypeRegistry:c,assistantAvailability:d,http:m}=Object(a.b)(),{setApiConfig:g}=Object(f.a)(),{data:b}=Object($.a)({http:m}),y=null!==(r=null===(o=Object(i.useMemo)((()=>b?b.map((e=>({...e,connectorTypeTitle:Object(U.a)(c.get(e.actionTypeId))}))):[]),[c,b]).find((e=>e.id===t)))||void 0===o?void 0:o.name)&&void 0!==r?r:V.m,v=e||!d.hasConnectorsReadPrivilege,h=Object(i.useCallback)((()=>{u(!l)}),[l]),E=Object(i.useCallback)((e=>{const t=e.id;if("ADD_NEW_CONNECTOR"===t)return;const a=Object(U.b)(e),i=null==a?void 0:a.apiProvider,r=null==a?void 0:a.defaultModel;u(!1),null!=n&&g({conversationId:n.id,apiConfig:{...n.apiConfig,connectorId:t,connectorTypeTitle:e.connectorTypeTitle,provider:null!=i?i:null==a?void 0:a.apiProvider,model:null!=r?r:null==a?void 0:a.defaultModel}})}),[n,g]);return Object(p.jsx)(s.EuiFlexGroup,{alignItems:"center",className:H,direction:"row",gutterSize:"xs",justifyContent:"flexStart",responsive:!1},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiText,{size:"xs",color:"subdued"},V.l)),Object(p.jsx)(s.EuiFlexItem,null,l?Object(p.jsx)(q.a,{displayFancy:e=>Object(p.jsx)(s.EuiText,{className:Z,size:"xs"},e),isOpen:!0,isDisabled:v,selectedConnectorId:t,setIsOpen:u,onConnectorSelectionChange:E}):Object(p.jsx)("span",null,Object(p.jsx)(s.EuiButtonEmpty,{className:G,color:"text","data-test-subj":"connectorSelectorPlaceholderButton",iconSide:"right",iconType:"arrowDown",isDisabled:v,onClick:h,size:"xs"},y))))}));Q.displayName="ConnectorSelectorInline";const W={xl:64,l:48,m:32,s:24,xs:16},K=({size:e="s"})=>Object(p.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:W[e],height:W[e],viewBox:"0 0 64 64",fill:"none"},Object(p.jsx)("path",{fill:"#F04E98",d:"M36 28h24v36H36V28Z"}),Object(p.jsx)("path",{fill:"#00BFB3",d:"M4 46c0-9.941 8.059-18 18-18h6v36h-6c-9.941 0-18-8.059-18-18Z"}),Object(p.jsx)("path",{fill:"#343741",d:"M60 12c0 6.627-5.373 12-12 12s-12-5.373-12-12S41.373 0 48 0s12 5.373 12 12Z"}),Object(p.jsx)("path",{fill:"#FA744E",d:"M6 23C6 10.85 15.85 1 28 1v22H6Z"}));var J={name:"1y0ex1",styles:"max-width:400px"};const Y=({isDisabled:e=!1,title:t,docLinks:n,selectedConversation:a})=>{var r;const o=null==a||null===(r=a.apiConfig)||void 0===r?void 0:r.connectorId,{ELASTIC_WEBSITE_URL:l,DOC_LINK_VERSION:u}=n,c=`${l}guide/en/security/${u}/security-assistant.html`,d=Object(i.useMemo)((()=>Object(p.jsx)(s.EuiLink,{"aria-label":j.h,"data-test-subj":"externalDocumentationLink",external:!0,href:c,target:"_blank"},j.d)),[c]),m=Object(i.useMemo)((()=>Object(p.jsx)(z.FormattedMessage,{defaultMessage:"Responses from AI systems may not always be entirely accurate. For more information on the assistant feature and its usage, please reference the {documentationLink}.",id:"xpack.elasticAssistant.assistant.technicalPreview.tooltipContent",values:{documentationLink:d}})),[d]),[f,g]=Object(i.useState)(!1),b=Object(i.useCallback)((()=>g((e=>!e))),[]),y=Object(i.useCallback)((()=>g(!1)),[]);return Object(p.jsx)(s.EuiModalHeaderTitle,null,Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"m"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(K,{"data-test-subj":"titleIcon",size:"m"})),Object(p.jsx)(s.EuiFlexGroup,{direction:"column",gutterSize:"none",justifyContent:"center"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiTitle,{size:"s"},Object(p.jsx)("h3",null,t))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiPopover,{button:Object(p.jsx)(s.EuiButtonIcon,{"aria-label":j.h,"data-test-subj":"tooltipIcon",iconType:"iInCircle",onClick:b}),isOpen:f,closePopover:y,anchorPosition:"rightUp"},Object(p.jsx)(s.EuiText,{"data-test-subj":"tooltipContent",grow:!1,css:J},Object(p.jsx)(s.EuiText,{size:"s"},Object(p.jsx)("p",null,m))))))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(Q,{isDisabled:e||void 0===a,selectedConnectorId:o,selectedConversation:a})))))},X=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.defaultConversationTitle",{defaultMessage:"Conversations"}),ee=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.ariaLabel",{defaultMessage:"Conversation selector"}),te=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.placeholderTitle",{defaultMessage:"Select or type to create new..."}),ne=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.CustomOptionTextTitle",{defaultMessage:"Create new conversation:"}),ae=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.previousConversationTitle",{defaultMessage:"Previous conversation"}),ie=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.nextConversationTitle",{defaultMessage:"Next conversation"}),re=k.i18n.translate("xpack.elasticAssistant.assistant.conversationSelector.deleteConversationTitle",{defaultMessage:"Delete conversation"});var se=n(168);const oe=navigator.platform.toLowerCase().indexOf("mac")>=0,le=(e,t)=>0===e.indexOf(t)?e[e.length-1]:e[e.indexOf(t)-1];var ue={name:"1v0pok0",styles:"min-width:300px"},ce={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},de={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},pe={name:"1e5733u",styles:"width:calc(100% - 60px)"};const me=r.a.memo((({selectedConversationId:e=se.a,defaultConnectorId:t,defaultProvider:n,onConversationSelected:r,shouldDisableKeyboardShortcut:o=(()=>!1),isDisabled:u=!1})=>{const{allSystemPrompts:c,conversations:d}=Object(a.b)(),{deleteConversation:m,setConversation:g}=Object(f.a)(),b=Object(i.useMemo)((()=>Object.keys(d)),[d]),y=Object(i.useMemo)((()=>Object.values(d).map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.id}}))),[d]),[v,h]=Object(i.useState)((()=>{var t;return null!==(t=y.filter((t=>t.label===e)))&&void 0!==t?t:[]})),E=Object(i.useCallback)(((e,a=[])=>{if(!e||!e.trim().toLowerCase())return;const i=e.trim().toLowerCase(),s=c.find((e=>e.isNewConversationDefault));if(-1===a.findIndex((e=>e.label.trim().toLowerCase()===i))){const a={id:e,messages:[],apiConfig:{connectorId:t,provider:n,defaultSystemPromptId:null==s?void 0:s.id}};g({conversation:a})}r(e)}),[c,t,n,g,r]),x=Object(i.useCallback)((t=>{e===t&&r(le(b,t)),setTimeout((()=>{m(t)}),0)}),[b,m,e,r]),j=Object(i.useCallback)((e=>{0===e.length?h([]):-1!==y.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&r(null==e?void 0:e[0].label)}),[y,r]),O=Object(i.useCallback)((()=>{const t=le(b,e);r(t)}),[b,e,r]),S=Object(i.useCallback)((()=>{const t=((e,t)=>e.indexOf(t)+1>=e.length?e[0]:e[e.indexOf(t)+1])(b,e);r(t)}),[b,e,r]),k=Object(i.useCallback)((e=>{u||b.length<=1||("ArrowLeft"===e.key&&(oe?e.metaKey:e.ctrlKey)&&!o()&&(e.preventDefault(),O()),"ArrowRight"===e.key&&(oe?e.metaKey:e.ctrlKey)&&!o()&&(e.preventDefault(),S()))}),[b.length,u,O,S,o]);return l()("keydown",k),Object(i.useEffect)((()=>{h(y.filter((t=>t.label===e)))}),[y,e]),Object(p.jsx)(s.EuiFormRow,{label:X,display:"rowCompressed",css:ue},Object(p.jsx)(s.EuiComboBox,{"data-test-subj":"conversation-selector","aria-label":ee,customOptionText:`${ne} {searchValue}`,placeholder:te,singleSelection:{asPlainText:!0},options:y,selectedOptions:v,onChange:j,onCreateOption:E,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(p.jsx)(s.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween","data-test-subj":`convo-option-${a}`},Object(p.jsx)(s.EuiFlexItem,{component:"span",grow:!1,css:pe},Object(p.jsx)(s.EuiHighlight,{search:t,css:de},a)),!(null!=i&&i.isDefault)&&Object(p.jsx)(s.EuiFlexItem,{grow:!1,component:"span"},Object(p.jsx)(s.EuiToolTip,{position:"right",content:re},Object(p.jsx)(s.EuiButtonIcon,{iconType:"cross","aria-label":re,color:"danger",onClick:e=>{e.stopPropagation(),x(a)},"data-test-subj":"delete-option",css:ce}))))},compressed:!0,isDisabled:u,prepend:Object(p.jsx)(s.EuiToolTip,{content:`${ae} (âŒ˜ + â†)`,display:"block"},Object(p.jsx)(s.EuiButtonIcon,{iconType:"arrowLeft","aria-label":ae,onClick:O,disabled:u||b.length<=1})),append:Object(p.jsx)(s.EuiToolTip,{content:`${ie} (âŒ˜ + â†’)`,display:"block"},Object(p.jsx)(s.EuiButtonIcon,{iconType:"arrowRight","aria-label":ie,onClick:S,disabled:u||b.length<=1}))}))}));me.displayName="ConversationSelector";var fe=n(259),ge=n(493);const be=r.a.memo((({defaultConnectorId:e,defaultProvider:t,isDisabled:n=!1,isSettingsModalVisible:o,setIsSettingsModalVisible:l,selectedConversation:u,setSelectedConversationId:c})=>{const{toasts:d,setSelectedSettingsTab:m}=Object(a.b)(),f=Object(i.useCallback)((()=>{l(!1)}),[l]),g=Object(i.useCallback)((()=>{f()}),[f]),b=Object(i.useCallback)((()=>{f(),null==d||d.addSuccess({iconType:"check",title:ge.j})}),[f,d]),y=Object(i.useCallback)((()=>{m(fe.b),l(!0)}),[l,m]);return Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiToolTip,{position:"right",content:ge.i},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":ge.h,"data-test-subj":"settings",onClick:y,isDisabled:n,iconType:"gear",size:"xs"})),o&&Object(p.jsx)(fe.a,{defaultConnectorId:e,defaultProvider:t,selectedConversation:u,setSelectedConversationId:c,onClose:g,onSave:b}))}));be.displayName="AssistantSettingsButton";var ye={name:"1h6p4mk",styles:"width:335px"},ve={name:"1d3w5wq",styles:"width:100%"};const he=({currentConversation:e,defaultConnectorId:t,defaultProvider:n,docLinks:a,isDisabled:o,isSettingsModalVisible:l,onConversationSelected:u,onToggleShowAnonymizedValues:c,selectedConversationId:d,setIsSettingsModalVisible:m,setSelectedConversationId:f,shouldDisableKeyboardShortcut:g,showAnonymizedValues:b,title:y})=>{const v=Object(i.useMemo)((()=>null!=e.replacements&&Object.keys(e.replacements).length>0&&b),[e.replacements,b]);return Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiFlexGroup,{css:ve,alignItems:"center",justifyContent:"spaceBetween"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(Y,{isDisabled:o,docLinks:a,selectedConversation:e,title:y})),Object(p.jsx)(s.EuiFlexItem,{grow:!1,css:ye},Object(p.jsx)(me,{defaultConnectorId:t,defaultProvider:n,selectedConversationId:d,onConversationSelected:u,shouldDisableKeyboardShortcut:g,isDisabled:o}),Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiSpacer,{size:"s"}),Object(p.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"none",justifyContent:"spaceBetween"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiToolTip,{content:j.f,position:"left",repositionOnScroll:!0},Object(p.jsx)(s.EuiSwitch,{"data-test-subj":"showAnonymizedValues",checked:v,compressed:!0,disabled:null==e.replacements,label:j.e,onChange:c}))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(be,{defaultConnectorId:t,defaultProvider:n,isDisabled:o,isSettingsModalVisible:l,selectedConversation:e,setIsSettingsModalVisible:m,setSelectedConversationId:f})))))),Object(p.jsx)(s.EuiHorizontalRule,{margin:"m"}))};async function Ee({defaultAllow:e,defaultAllowReplacement:t,promptContext:n}){const a=await n.getPromptContext();return"string"==typeof a?{allow:[],allowReplacement:[],promptContextId:n.id,rawData:a}:{allow:[...e],allowReplacement:[...t],promptContextId:n.id,rawData:a}}const xe=c()(s.EuiButton)`
  margin-right: ${({theme:e})=>e.eui.euiSizeXS};
`,je=({defaultAllow:e,defaultAllowReplacement:t,promptContexts:n,selectedPromptContexts:a,setSelectedPromptContexts:r})=>{const o=Object(i.useMemo)((()=>Object(y.sortBy)("description",Object.values(n))),[n]),l=Object(i.useCallback)((async i=>{if(null==a[i]&&null!=n[i]){const a=await Ee({defaultAllow:e,defaultAllowReplacement:t,promptContext:n[i]});r((e=>({...e,[i]:a})))}}),[e,t,n,a,r]);return Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"none",wrap:!0},o.map((({description:e,id:t,getPromptContext:n,tooltip:i})=>{const r=Object(p.jsx)(xe,{"data-test-subj":`pillButton-${t}`,disabled:null!=a[t],iconSide:"left",iconType:"plus",onClick:()=>l(t)},e);return Object(p.jsx)(s.EuiFlexItem,{grow:!1,key:t},null!=a[t]?r:Object(p.jsx)(s.EuiToolTip,{content:i},r))})))},Oe=r.a.memo(je);var Se=n(373),ke=n(551),we={name:"1m5oqbf",styles:"white-space:pre-line;&:hover{cursor:pointer;text-decoration:underline;}"};const Te=({conversation:e,editingSystemPromptId:t,isSettingsModalVisible:n,onSystemPromptSelectionChange:o,setIsSettingsModalVisible:l})=>{const{allSystemPrompts:u}=Object(a.b)(),c=Object(i.useMemo)((()=>{var n;return void 0!==t?null!==(n=null==u?void 0:u.find((e=>e.id===t)))&&void 0!==n?n:null==u?void 0:u.find((t=>t.id===(null==e?void 0:e.apiConfig.defaultSystemPromptId))):void 0}),[u,null==e?void 0:e.apiConfig.defaultSystemPromptId,t]),[d,m]=r.a.useState(!1),f=Object(i.useCallback)((()=>{e&&o(void 0)}),[e,o]),g=Object(i.useCallback)((()=>m(!0)),[]);return Object(p.jsx)("div",null,null==c||d?Object(p.jsx)(ke.a,{allSystemPrompts:u,clearSelectedSystemPrompt:f,conversation:e,"data-test-subj":"systemPrompt",isClearable:!0,isEditing:d,isOpen:d,isSettingsModalVisible:n,onSystemPromptSelectionChange:o,selectedPrompt:c,setIsEditing:m,setIsSettingsModalVisible:l}):Object(p.jsx)(s.EuiFlexGroup,{alignItems:"flexStart",gutterSize:"none"},Object(p.jsx)(s.EuiFlexItem,{grow:!0},Object(p.jsx)(s.EuiText,{color:"subdued","data-test-subj":"systemPromptText",onClick:g,css:we},Object(y.isEmpty)(null==c?void 0:c.content)?Se.d:null==c?void 0:c.content)),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"none"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiToolTip,{content:Se.e},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":Se.e,"data-test-subj":"edit",iconType:"documentEdit",onClick:g}))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiToolTip,{content:Se.c},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":Se.c,"data-test-subj":"clear",iconType:"cross",onClick:f})))))))};Te.displayName="SystemPromptComponent";const Ie=r.a.memo(Te),Ce=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.commentsListAriaLabel",{defaultMessage:"List of comments"}),Me=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.editingPromptLabel",{defaultMessage:"editing prompt"}),_e=k.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.youLabel",{defaultMessage:"You"});var Ae=n(543),Pe=n(494);const Fe=({rawData:e})=>Object(p.jsx)(s.EuiCodeBlock,{"data-test-subj":"readOnlyContextViewer",isCopyable:!0},Object(b.e)(e));Fe.displayName="ReadOnlyContextViewerComponent";const De=r.a.memo(Fe);var Ne=n(552),Re=n(547),Le=n(372);const ze=k.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableDescription",{defaultMessage:"Available"}),Be=({total:e})=>{const t=Object(i.useMemo)((()=>(e=>k.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.availableStat.availableTooltip",{values:{total:e},defaultMessage:"{total} fields in this context are available to be included in the conversation"}))(e)),[e]);return Object(p.jsx)(s.EuiToolTip,{content:t},Object(p.jsx)(s.EuiStat,{"data-test-subj":"availableStat",description:ze,reverse:!0,title:e,titleSize:Le.a}))};Be.displayName="AvailableStatComponent";const qe=r.a.memo(Be),$e=c()(s.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeL};
`,Ve=({isDataAnonymizable:e,selectedPromptContext:t})=>{const{allowed:n,anonymized:a,total:r}=Object(i.useMemo)((()=>(({allow:e,allowReplacement:t,rawData:n})=>{const a={allowed:0,anonymized:0,denied:0,total:0};if("string"==typeof n)return a;{const i=Object.keys(n),r=new Set(t),s=new Set(e);return i.reduce(((e,t)=>({allowed:e.allowed+(Object(g.a)({allowSet:s,field:t})?1:0),anonymized:e.anonymized+(Object(g.a)({allowSet:s,field:t})&&Object(g.b)({allowReplacementSet:r,field:t})?1:0),denied:e.denied+(Object(g.c)({allowSet:s,field:t})?1:0),total:e.total+1})),a)}})(t)),[t]);return Object(p.jsx)(s.EuiFlexGroup,{alignItems:"center","data-test-subj":"stats",gutterSize:"none"},e&&Object(p.jsx)($e,{grow:!1},Object(p.jsx)(Ne.a,{allowed:n,total:r})),Object(p.jsx)($e,{grow:!1},Object(p.jsx)(Re.a,{anonymized:a,isDataAnonymizable:e})),e&&Object(p.jsx)($e,{grow:!1},Object(p.jsx)(qe,{total:r})))};Ve.displayName="StatsComponent";const Ue=r.a.memo(Ve),He=c.a.div`
  overflow-x: auto;
`,Ze=({selectedPromptContext:e,setSelectedPromptContexts:t})=>{const{defaultAllow:n,defaultAllowReplacement:r,setDefaultAllow:o,setDefaultAllowReplacement:l}=Object(a.b)(),u=Object(i.useMemo)((()=>Object(Pe.a)(e.rawData)),[e]),c=Object(i.useCallback)((a=>{const i=a.reduce(((e,{field:t,operation:n,update:a})=>Object(Pe.c)({field:t,operation:n,selectedPromptContext:e,update:a})),e);t((t=>({...t,[e.promptContextId]:i}))),Object(Pe.b)({defaultAllow:n,defaultAllowReplacement:r,setDefaultAllow:o,setDefaultAllowReplacement:l,updates:a})}),[n,r,e,o,l,t]);return Object(p.jsx)(He,{"data-test-subj":"dataAnonymizationEditor"},Object(p.jsx)(Ue,{isDataAnonymizable:u,selectedPromptContext:e}),Object(p.jsx)(s.EuiSpacer,{size:"s"}),"string"==typeof e.rawData?Object(p.jsx)(De,{rawData:e.rawData}):Object(p.jsx)(Ae.a,{allow:e.allow,allowReplacement:e.allowReplacement,onListUpdated:c,rawData:e.rawData}))},Ge=r.a.memo(Ze),Qe=k.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.selectedPromotContexts.removeContextTooltip",{defaultMessage:"Remove context"}),We=c.a.div`
  ${({$accordionState:e})=>"closed"===e?"height: 0px;":""}
  ${({$accordionState:e})=>"closed"===e?"overflow: hidden;":""}
  ${({$accordionState:e})=>"closed"===e?"position: absolute;":""}
`,Ke=({isNewConversation:e,promptContexts:t,selectedPromptContexts:n,setSelectedPromptContexts:a})=>{const[o,l]=r.a.useState("closed"),u=Object(i.useCallback)((()=>l((e=>"open"===e?"closed":"open"))),[]),c=Object(i.useCallback)((e=>{a((t=>Object(y.omit)(e,t)))}),[a]);return Object(y.isEmpty)(t)?null:Object(p.jsx)(s.EuiFlexGroup,{"data-test-subj":"selectedPromptContexts",direction:"column",gutterSize:"none"},Object.keys(n).sort().map((i=>{var r;return Object(p.jsx)(s.EuiFlexItem,{"data-test-subj":`selectedPromptContext-${i}`,grow:!1,key:i},e||Object.keys(n).length>1?Object(p.jsx)(s.EuiSpacer,{"data-test-subj":"spacer"}):null,Object(p.jsx)(s.EuiAccordion,{buttonContent:null===(r=t[i])||void 0===r?void 0:r.description,forceState:o,extraAction:Object(p.jsx)(s.EuiToolTip,{content:Qe},Object(p.jsx)(s.EuiButtonIcon,{"aria-label":Qe,"data-test-subj":`removePromptContext-${i}`,iconType:"cross",onClick:()=>c(i)})),id:i,onToggle:u,paddingSize:"s"},Object(p.jsx)(We,{$accordionState:o},Object(p.jsx)(Ge,{selectedPromptContext:n[i],setSelectedPromptContexts:a}))))})))},Je=r.a.memo(Ke),Ye=c()(s.EuiText)`
  white-space: pre-line;
`,Xe=({conversation:e,editingSystemPromptId:t,isNewConversation:n,isSettingsModalVisible:a,promptContexts:o,promptTextPreview:l,onSystemPromptSelectionChange:u,selectedPromptContexts:c,setIsSettingsModalVisible:d,setSelectedPromptContexts:m})=>{const f=Object(i.useMemo)((()=>Object(p.jsx)(r.a.Fragment,null,n&&Object(p.jsx)(Ie,{conversation:e,editingSystemPromptId:t,onSystemPromptSelectionChange:u,isSettingsModalVisible:a,setIsSettingsModalVisible:d}),Object(p.jsx)(Je,{isNewConversation:n,promptContexts:o,selectedPromptContexts:c,setSelectedPromptContexts:m}),Object(p.jsx)(Ye,{color:"subdued","data-test-subj":"previewText"},l))),[e,t,n,a,u,o,l,c,d,m]),g=Object(i.useMemo)((()=>[{children:f,event:Object(p.jsx)(s.EuiText,{"data-test-subj":"eventText",size:"xs"},Object(p.jsx)("i",null,Me)),timelineAvatar:Object(p.jsx)(s.EuiAvatar,{"data-test-subj":"userAvatar",name:"user",size:"l",color:"subdued",iconType:"userAvatar"}),timelineAvatarAriaLabel:_e,username:_e}]),[f]);return Object(p.jsx)(s.EuiCommentList,{"aria-label":Ce,comments:g})};Xe.displayName="PromptEditorComponent";const et=r.a.memo(Xe),tt=k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.addQuickPromptTitle",{defaultMessage:"Add quick prompt..."}),nt=k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.overflowAriaTitle",{defaultMessage:"Show overflow Quick Prompts"}),at=(k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),k.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"}),c()(s.EuiFlexGroup)`
  margin: 16px;
`),it=r.a.memo((({setInput:e,setIsSettingsModalVisible:t,trackPrompt:n})=>{const{allQuickPrompts:r,knowledgeBase:o,promptContexts:l,setSelectedSettingsTab:u}=Object(a.b)(),c=Object(i.useMemo)((()=>{const e=Object.values(l).map((e=>e.category));return o.assistantLangChain&&e.push("knowledge-base"),r.filter((t=>null==t.categories||0===t.categories.length||t.categories.some((t=>e.includes(t)))))}),[r,o.assistantLangChain,l]),[d,m]=Object(i.useState)(!1),f=Object(i.useCallback)((()=>m(!d)),[d]),g=Object(i.useCallback)((()=>m(!1)),[]),b=Object(i.useCallback)((t=>{e(t.prompt),t.isDefault?n(t.title):n("Custom")}),[e,n]),y=Object(i.useCallback)((e=>{b(e),g()}),[g,b]),v=Object(i.useCallback)((()=>{t(!0),u(fe.c)}),[t,u]);return Object(p.jsx)(at,{gutterSize:"s",alignItems:"center"},c.slice(0,5).map(((e,t)=>Object(p.jsx)(s.EuiFlexItem,{key:t,grow:!1},Object(p.jsx)(s.EuiBadge,{color:e.color,onClick:()=>b(e),onClickAriaLabel:e.title},e.title)))),c.length>5&&Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiPopover,{button:Object(p.jsx)(s.EuiBadge,{color:"hollow",iconType:"boxesHorizontal",onClick:f,onClickAriaLabel:nt}),isOpen:d,closePopover:g,anchorPosition:"rightUp"},Object(p.jsx)(s.EuiFlexGroup,{direction:"column",gutterSize:"s"},c.slice(5).map(((e,t)=>Object(p.jsx)(s.EuiFlexItem,{key:t,grow:!1},Object(p.jsx)(s.EuiBadge,{color:e.color,onClick:()=>y(e),onClickAriaLabel:e.title},e.title))))))),Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiButtonEmpty,{"data-test-subj":"addQuickPrompt",onClick:v,iconType:"plus",size:"xs"},tt)))}));it.displayName="QuickPrompts";var rt=n(548),st=n(549),ot=n(497);const lt=r.a.memo((({text:e,children:t,chunkSize:n=5,delay:a=100,onStreamingComplete:r})=>{const[s,o]=Object(i.useState)(a>0?"":e),[l,u]=Object(i.useState)(null==a||0===a);return Object(i.useEffect)((()=>{0===a&&(null==r||r())}),[]),Object(i.useEffect)((()=>{if(l||0===a)return void o(e);let t=0;u(!1);const i=setInterval((()=>{if(t>=e.length)return null==r||r(),u(!0),void clearInterval(i);const a=e.substring(t,t+n);o((e=>e+a)),t+=n}),a);return()=>{clearInterval(i)}}),[e,n,a,r,l]),t?Object(p.jsx)("div",null,t(s,l)):Object(p.jsx)("div",null,s)}));lt.displayName="StreamingText";var ut=n(73);const ct=r.a.memo((({setIsConnectorModalVisible:e})=>{const{assistantAvailability:t}=Object(a.b)(),n=t.hasConnectorsAllPrivilege?V.d:V.c,r=t.hasConnectorsAllPrivilege?V.a:V.b,o=Object(i.useCallback)((()=>{null==e||e(!0)}),[e]);return Object(p.jsx)(s.EuiFlexGroup,{gutterSize:"l",justifyContent:"spaceAround"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(s.EuiCard,{"data-test-subj":"connectorButton",layout:"horizontal",icon:Object(p.jsx)(s.EuiIcon,{size:"xl",type:ut.OpenAILogo}),title:n,description:r,onClick:t.hasConnectorsAllPrivilege?o:void 0})))}));ct.displayName="ConnectorButton";const dt=e=>{const{messages:t,...n}=e;return{...n,messages:t.map((e=>{const{presentation:t,...n}=e;return{...n,presentation:void 0}}))}},pt=e=>!e.messages.some((e=>void 0!==e.presentation)),mt=c.a.div`
  margin-bottom: 10px;
`,ft=c()(s.EuiText)`
  margin-top: 20px;
`,gt=r.a.memo((({isConnectorConfigured:e,isSettingsModalVisible:t,setIsSettingsModalVisible:n})=>{const{assistantAvailability:o,setSelectedSettingsTab:l}=Object(a.b)(),u=Object(i.useCallback)((()=>{t||(n(!0),l(fe.b))}),[t,n,l]),c=o.hasConnectorsAllPrivilege||o.hasConnectorsReadPrivilege&&e;return Object(p.jsx)(r.a.Fragment,null,c?Object(p.jsx)(s.EuiCallOut,{"data-test-subj":"connectorMissingCallout",color:"danger",iconType:"controlsVertical",size:"m",title:V.p},Object(p.jsx)("p",null," ",Object(p.jsx)(z.FormattedMessage,{defaultMessage:"Select a connector above or from the {link} to continue",id:"xpack.elasticAssistant.assistant.connectors.connectorMissingCallout.calloutDescription",values:{link:Object(p.jsx)(s.EuiLink,{onClick:u},V.q)}}))):Object(p.jsx)(ct,null))}));gt.displayName="ConnectorMissingCallout";var bt={name:"hbng6e",styles:"align-items:flex-start;flex-direction:column"},yt={name:"hbng6e",styles:"align-items:flex-start;flex-direction:column"},vt={name:"r5hahk",styles:"margin-right:20px"},ht={name:"r5hahk",styles:"margin-right:20px"};const Et=({conversationId:e,embeddedLayout:t=!1,promptContextId:n="",shouldRefocusPrompt:o=!1,showTitle:l=!0,setConversationId:u})=>{var c,y;const{assistantTelemetry:v,augmentMessageCodeBlocks:j,assistantAvailability:{isAssistantEnabled:O},conversations:S,defaultAllow:k,defaultAllowReplacement:w,docLinks:T,getComments:I,http:C,promptContexts:M,setLastConversationId:A,getConversationId:P,title:F,allSystemPrompts:D}=Object(a.b)(),[N,R]=Object(i.useState)({}),z=Object(i.useMemo)((()=>Object.keys(N).length),[N]),{amendMessage:B,createConversation:q}=Object(f.a)(),{data:H,isSuccess:Z}=Object($.a)({http:C}),G=Object(i.useMemo)((()=>{var e;return null===(e=Object(E.b)(H))||void 0===e?void 0:e.id}),[H]),Q=Object(i.useMemo)((()=>{var e,t;return null===(e=Object(E.b)(H))||void 0===e||null===(t=e.config)||void 0===t?void 0:t.apiProvider}),[H]),[W,J]=Object(i.useState)(O?P(e):se.d);Object(i.useEffect)((()=>{u&&u(W)}),[W,u]);const Y=Object(i.useMemo)((()=>{var e;return null!==(e=S[W])&&void 0!==e?e:q({conversationId:W})}),[S,q,W]),X=Object(i.useMemo)((()=>{var e;return!Object.keys(S).some((e=>null!=S[e].apiConfig.connectorId))&&0===(null!==(e=null==H?void 0:H.length)&&void 0!==e?e:0)}),[null==H?void 0:H.length,S]),ee=X||!O,te=Object(i.useMemo)((()=>Object(E.a)(Y,O)),[Y,O]),[ne,ae]=Object(i.useState)(!1);Object(i.useEffect)((()=>{if(Z&&(null==H||!H.length))return A(se.d);Y.excludeFromLastConversationStorage||A(Y.id)}),[Z,null==H?void 0:H.length,Y,A]);const{comments:ie,prompt:re}=(({conversation:e=st.a,onSetupComplete:t})=>{var n,r,o,l;const{appendMessage:u,setApiConfig:c,setConversation:d}=Object(f.a)(),m=Object(i.useRef)(null),{actionTypeRegistry:g,conversations:b,http:y}=Object(a.b)(),{data:v,isSuccess:h,refetch:E}=Object($.a)({http:y}),x=h&&!(null==v||!v.length),[j,O]=Object(i.useState)(!1),[S,k]=Object(i.useState)((()=>pt(e))),{data:w}=Object(ot.a)({http:y}),[T,I]=Object(i.useState)(null),C=Object(i.useMemo)((()=>{var t,n,a;return null!==(t=null===(n=e.theme)||void 0===n||null===(a=n.user)||void 0===a?void 0:a.name)&&void 0!==t?t:V.k}),[null===(n=e.theme)||void 0===n||null===(r=n.user)||void 0===r?void 0:r.name]),M=Object(i.useMemo)((()=>{var t,n,a;return null!==(t=null===(n=e.theme)||void 0===n||null===(a=n.assistant)||void 0===a?void 0:a.name)&&void 0!==t?t:V.j}),[null===(o=e.theme)||void 0===o||null===(l=o.assistant)||void 0===l?void 0:l.name]),_=Object(i.useMemo)((()=>e.messages.length-1),[e.messages.length]),[A,P]=Object(i.useState)(x||pt(e)?_:0),F=Object(i.useRef)(void 0),D=Object(i.useCallback)((()=>{var t,n,a;if(A!==_)return F.current=window.setTimeout((()=>{var e;return null===(e=m.current)||void 0===e||e.scrollIntoView({block:"end"}),P(A+1)}),null!==(t=null===(n=e.messages[A])||void 0===n||null===(a=n.presentation)||void 0===a?void 0:a.delay)&&void 0!==t?t:0),()=>clearTimeout(F.current);clearTimeout(F.current)}),[e.messages,A,_]),N=Object(i.useCallback)((()=>{var n;k(!0),null===(n=m.current)||void 0===n||n.scrollIntoView({block:"end"}),null==t||t(),d({conversation:dt(e)})}),[e,t,d]),R=Object(i.useCallback)((()=>{P(_)}),[_]),L=Object(i.useCallback)(((t,n,a)=>{var i,r,o;null!=e.messages[n].timestamp&&0!==e.messages[n].timestamp.length||(e.messages[n].timestamp=(new Date).toLocaleString());const l=n===a-1,u=null!==(i=null==t||null===(r=t.presentation)||void 0===r?void 0:r.stream)&&void 0!==i&&i&&A!==a-1;return Object(p.jsx)(lt,{text:null!==(o=t.content)&&void 0!==o?o:"",delay:u?50:0,onStreamingComplete:l?N:D},((e,t)=>Object(p.jsx)(s.EuiText,null,Object(p.jsx)(s.EuiMarkdownFormat,{className:`message-${n}`},e),Object(p.jsx)("span",{ref:m}))))}),[e.messages,A,N,D]),z=Object(i.useMemo)((()=>e.messages.slice(0,A+1).map(((t,n)=>({username:"user"===t.role?C:M,children:L(t,n,e.messages.length),timelineAvatar:Object(p.jsx)(s.EuiAvatar,{name:V.j,size:"l",color:"subdued",iconType:K}),timestamp:`${V.i}: ${t.timestamp}`})))),[M,L,e.messages,A,C]),B=Object(i.useCallback)((t=>{const n=Object(U.b)(t),a=Object(U.a)(g.get(t.actionTypeId));Object.values(b).forEach((e=>{c({conversationId:e.id,apiConfig:{...e.apiConfig,connectorId:t.id,connectorTypeTitle:a,provider:null==n?void 0:n.apiProvider,model:null==n?void 0:n.defaultModel}})})),null==E||E(),O(!1),u({conversationId:e.id,message:{role:"assistant",content:V.g,timestamp:(new Date).toLocaleString()}})}),[g,u,e.id,b,E,c]);return{comments:z,prompt:Object(p.jsx)("div",{"data-test-subj":"prompt"},S&&Object(p.jsx)(mt,null,Object(p.jsx)(ct,{setIsConnectorModalVisible:O})),!S&&Object(p.jsx)(ft,{color:"subdued",size:"xs"},Object(p.jsx)(s.EuiTextAlign,{textAlign:"center"},Object(p.jsx)(s.EuiBadge,{color:"hollow","data-test-subj":"skip-setup-button",onClick:R,onClickAriaLabel:V.h},V.h))),j&&Object(p.jsx)(rt.a,{actionTypeRegistry:g,actionTypes:w,onClose:()=>O(!1),onSaveConnector:B,onSelectActionType:e=>I(e),selectedActionType:T}))}})({conversation:te}),oe=X&&null!==(c=te.theme)&&void 0!==c&&c.title?null===(y=te.theme)||void 0===y?void 0:y.title:F,[le,ue]=Object(i.useState)(""),[ce,de]=Object(i.useState)(!1),[pe,me]=Object(i.useState)(null),[fe,ge]=Object(i.useState)(!1),[be,ye]=Object(i.useState)(!1),[ve,xe]=Object(i.useState)(),[je,Se]=Object(i.useState)(!1);Object(i.useLayoutEffect)((()=>{setTimeout((()=>{xe(j(Y))}),0)}),[j,Y]);const ke=Object(i.useMemo)((()=>ee||fe),[fe,ee]);Object(i.useEffect)((()=>{const e=()=>{const e=document.querySelectorAll(".euiCodeBlock__controls");Se(e.length>0)};e();const t=new MutationObserver(e);return t.observe(document.body,{subtree:!0,childList:!0}),()=>{t.disconnect()}}),[]);const we=Object(i.useRef)(null);Object(i.useEffect)((()=>{var e;const t=null===(e=we.current)||void 0===e?void 0:e.parentElement;t&&(t.scrollTop=t.scrollHeight)}));const Te=(e,t)=>t?Object(p.jsx)("span",{ref:we},e):Object(p.jsx)(r.a.Fragment,null,e),Ie=Object(i.useMemo)((()=>Object(x.b)({allSystemPrompts:D,conversation:Y})),[D,Y]),[Ce,Me]=Object(i.useState)(null==Ie?void 0:Ie.id),_e=Object(i.useCallback)((e=>{var t;J(e),Me(null===(t=Object(x.b)({allSystemPrompts:D,conversation:S[e]}))||void 0===t?void 0:t.id)}),[D,S]),Ae=Object(i.useCallback)((e=>{Me(e)}),[]);[...document.getElementsByClassName("euiCodeBlock")].forEach((e=>e.style.minHeight="75px"));const Pe=Object(i.useCallback)((e=>{null!=ye&&ye(e.target.checked)}),[ye]);Object(i.useEffect)((()=>{if(Y.messages.length||e!==W)return;if(ce)return;const t=M[n];null!=t&&(de(!0),Object.keys(N).includes(t.id)||(async()=>{const e=await Ee({defaultAllow:k,defaultAllowReplacement:w,promptContext:t});R((n=>({...n,[t.id]:e})))})(),null!=t.suggestedUserPrompt&&me(t.suggestedUserPrompt))}),[Y.messages,M,n,e,W,N,ce,k,w]),Object(i.useEffect)((()=>{var e;const t=null!==(e=null==H?void 0:H.some((e=>{var t;return e.id===(null===(t=Y.apiConfig)||void 0===t?void 0:t.connectorId)})))&&void 0!==e&&e;ge(!t)}),[H,Y]);const Fe=Object(i.useCallback)((()=>null==ve?void 0:ve.map(((e,t)=>Object(p.jsx)("span",{key:`${t}`},e.map(((e,n)=>{const a=e.getControlContainer,i=null==a?void 0:a();return Object(p.jsx)("span",{key:`${t}+${n}`},i?Object(d.createPortal)(e.button,i):Object(p.jsx)(r.a.Fragment,null))})))))),[ve]),{handleButtonSendMessage:De,handleOnChatCleared:Ne,handlePromptChange:Re,handleSendMessage:Le,handleRegenerateResponse:ze,isLoading:Be}=(({allSystemPrompts:e,currentConversation:t,editingSystemPromptId:n,http:r,selectedPromptContexts:s,setEditingSystemPromptId:o,setPromptTextPreview:l,setSelectedPromptContexts:u,setUserPrompt:c})=>{const{isLoading:d,sendMessages:p}=(()=>{const{alertsIndexPattern:e,assistantStreamingEnabled:t,defaultAllow:n,defaultAllowReplacement:r,knowledgeBase:s}=Object(a.b)(),[o,l]=Object(i.useState)(!1);return{isLoading:o,sendMessages:Object(i.useCallback)((async({apiConfig:a,http:i,messages:o,onNewReplacements:u,replacements:c})=>{l(!0);try{return await Object(m.b)({alerts:s.alerts,alertsIndexPattern:e,allow:n,allowReplacement:r,apiConfig:a,assistantLangChain:s.assistantLangChain,assistantStreamingEnabled:t,http:i,replacements:c,messages:o,size:s.latestAlerts,onNewReplacements:u})}finally{l(!1)}}),[e,t,n,r,s.alerts,s.assistantLangChain,s.latestAlerts])}})(),{appendMessage:y,appendReplacements:v,clearConversation:j,removeLastMessage:O}=Object(f.a)(),S=Object(i.useCallback)((async a=>{var i;const o=e=>v({conversationId:t.id,replacements:e}),c=e.find((e=>e.id===n)),d=await async function({currentReplacements:e,getAnonymizedValue:t=h,isNewChat:n,onNewReplacements:a,promptText:i,selectedPromptContexts:r,selectedSystemPrompt:s}){var o;const l=Object.keys(r).sort().map((n=>{const i=Object(g.d)({allow:r[n].allow,allowReplacement:r[n].allowReplacement,currentReplacements:e,getAnonymizedValue:t,onNewReplacements:a,rawData:r[n].rawData});return`${Object(b.e)(i)}`}));return{content:`${n?`${null!==(o=null==s?void 0:s.content)&&void 0!==o?o:""}\n\n`:""}${l}\n\n${i}`,role:"user",timestamp:(new Date).toLocaleString()}}({isNewChat:0===t.messages.length,currentReplacements:t.replacements,onNewReplacements:o,promptText:a,selectedPromptContexts:s,selectedSystemPrompt:c}),m=y({conversationId:t.id,message:d});u({}),l("");const f=await p({apiConfig:t.apiConfig,http:r,messages:m,onNewReplacements:o,replacements:null!==(i=t.replacements)&&void 0!==i?i:{}}),x=Object(E.d)(f);y({conversationId:t.id,message:x})}),[e,y,v,t.apiConfig,t.id,t.messages.length,t.replacements,n,r,s,p,l,u]),k=Object(i.useCallback)((async()=>{var e;const n=O(t.id),a=await p({apiConfig:t.apiConfig,http:r,messages:n,onNewReplacements:e=>v({conversationId:t.id,replacements:e}),replacements:null!==(e=t.replacements)&&void 0!==e?e:{}}),i=Object(E.d)(a);y({conversationId:t.id,message:i})}),[y,v,t.apiConfig,t.id,t.replacements,r,O,p]);return{handleButtonSendMessage:Object(i.useCallback)((e=>{S(e),c("")}),[S,c]),handleOnChatCleared:Object(i.useCallback)((()=>{var n;const a=null===(n=Object(x.b)({allSystemPrompts:e,conversation:t}))||void 0===n?void 0:n.id;l(""),c(""),u({}),j(t.id),o(a)}),[e,j,t,o,l,u,c]),handlePromptChange:e=>{l(e),c(e)},handleSendMessage:S,handleRegenerateResponse:k,isLoading:d}})({allSystemPrompts:D,currentConversation:Y,setPromptTextPreview:ue,setUserPrompt:me,editingSystemPromptId:Ce,http:C,setEditingSystemPromptId:Me,selectedPromptContexts:N,setSelectedPromptContexts:R}),qe=Object(i.useMemo)((()=>Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiCommentList,{comments:I({currentConversation:Y,showAnonymizedValues:be,amendMessage:B,regenerateMessage:ze,isFetchingResponse:Be}),css:ht}),0!==Y.messages.length&&z>0&&Object(p.jsx)(s.EuiSpacer,{size:"m"}),(0===Y.messages.length||z>0)&&Object(p.jsx)(et,{conversation:Y,editingSystemPromptId:Ce,isNewConversation:0===Y.messages.length,isSettingsModalVisible:ne,promptContexts:M,promptTextPreview:le,onSystemPromptSelectionChange:Ae,selectedPromptContexts:N,setIsSettingsModalVisible:ae,setSelectedPromptContexts:R}))),[B,Y,Ce,I,Ae,ze,Be,ne,M,le,N,z,be]),$e=Object(i.useMemo)((()=>ee?Object(p.jsx)(s.EuiCommentList,{comments:ie,css:vt}):qe),[ie,ee,qe]),Ve=Object(i.useCallback)((e=>{null==v||v.reportAssistantQuickPrompt({conversationId:W,promptTitle:e})}),[v,W]);return Te(Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiModalHeader,{css:yt},l&&Object(p.jsx)(he,{currentConversation:Y,defaultConnectorId:G,defaultProvider:Q,docLinks:T,isDisabled:ee,isSettingsModalVisible:ne,onConversationSelected:_e,onToggleShowAnonymizedValues:Pe,selectedConversationId:W,setIsSettingsModalVisible:ae,setSelectedConversationId:J,showAnonymizedValues:be,title:oe}),Fe(),!ee&&Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(Oe,{defaultAllow:k,defaultAllowReplacement:w,promptContexts:M,selectedPromptContexts:N,setSelectedPromptContexts:R}),Object.keys(M).length>0&&Object(p.jsx)(s.EuiSpacer,{size:"s"}))),Object(p.jsx)(s.EuiModalBody,null,Te(Object(p.jsx)(r.a.Fragment,null,$e,!ee&&fe&&Z&&Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(s.EuiSpacer,null),Object(p.jsx)(s.EuiFlexGroup,{justifyContent:"spaceAround"},Object(p.jsx)(s.EuiFlexItem,{grow:!1},Object(p.jsx)(gt,{isConnectorConfigured:(null==H?void 0:H.length)>0,isSettingsModalVisible:ne,setIsSettingsModalVisible:ae}))))),!t)),Object(p.jsx)(s.EuiModalFooter,{css:bt},Object(p.jsx)(L,{connectorPrompt:re,http:C,isAssistantEnabled:O,isWelcomeSetup:X}),Object(p.jsx)(_,{isDisabled:ke,shouldRefocusPrompt:o,userPrompt:pe,handleButtonSendMessage:De,handleOnChatCleared:Ne,handlePromptChange:Re,handleSendMessage:Le,handleRegenerateResponse:ze,isLoading:Be}),!ee&&Object(p.jsx)(it,{setInput:me,setIsSettingsModalVisible:ae,trackPrompt:Ve}))),t)};Et.displayName="AssistantComponent";const xt=r.a.memo(Et),jt=navigator.platform.toLowerCase().indexOf("mac")>=0,Ot=c()(s.EuiModal)`
  ${({theme:e})=>`margin-top: ${e.eui.euiSizeXXL};`}
  min-width: 95vw;
  min-height: 25vh;
`,St=r.a.memo((()=>{const[e,t]=Object(i.useState)(!1),[n,s]=Object(i.useState)(se.d),[o,u]=Object(i.useState)(),{assistantTelemetry:c,setShowAssistantOverlay:d,getConversationId:m}=Object(a.b)(),f=Object(i.useCallback)((()=>({showOverlay:e,promptContextId:n,conversationId:a})=>{const i=m(a);e&&(null==c||c.reportAssistantInvoked({conversationId:i,invokedBy:"click"})),t(e),u(n),s(i)}),[c,m]);Object(i.useEffect)((()=>{d(f)}),[d,f]);const g=Object(i.useCallback)((()=>{e||(s(m()),null==c||c.reportAssistantInvoked({invokedBy:"shortcut",conversationId:m()})),t(!e)}),[c,e,m]),b=Object(i.useCallback)((e=>{";"===e.key&&(jt?e.metaKey:e.ctrlKey)&&(e.preventDefault(),g())}),[g]);l()("keydown",b);const y=Object(i.useCallback)((()=>{t(!1),u(void 0),s(n)}),[n]),v=Object(i.useCallback)((()=>{y()}),[y]);return Object(p.jsx)(r.a.Fragment,null,e&&Object(p.jsx)(Ot,{onClose:v,"data-test-subj":"ai-assistant-modal"},Object(p.jsx)(xt,{conversationId:n,promptContextId:o})))}));St.displayName="AssistantOverlay";var kt=n(492);const wt=(e,t,n,r,s,o,l)=>{const u=Object(i.useMemo)((()=>e),[e]),c=Object(i.useMemo)((()=>n),[n]),d=Object(i.useMemo)((()=>r),[r]),p=Object(i.useMemo)((()=>null!=s?s:Object(kt.a)()),[s]),m=Object(i.useMemo)((()=>null!=o?o:void 0),[o]),f=Object(i.useMemo)((()=>l),[l]),{registerPromptContext:g,showAssistantOverlay:b,unRegisterPromptContext:y}=Object(a.b)(),v=Object(i.useCallback)((e=>{null!=p&&b({showOverlay:e,promptContextId:p,conversationId:null!=t?t:void 0})}),[b,t,p]);return Object(i.useEffect)((()=>(y(p),g({category:u,description:c,getPromptContext:d,id:p,suggestedUserPrompt:m,tooltip:f}),()=>y(p))),[u,c,d,m,f,p,g,y]),{promptContextId:p,showAssistantOverlay:v}},Tt=k.i18n.translate("xpack.elasticAssistant.assistant.newChat.newChatButton",{defaultMessage:"Chat"}),It=({category:e,color:t="primary",children:n=Tt,conversationId:a,description:r,getPromptContext:o,iconType:l,promptContextId:u,suggestedUserPrompt:c,tooltip:d})=>{const{showAssistantOverlay:m}=wt(e,null!=a?a:null,r,o,null!=u?u:null,c,d),f=Object(i.useCallback)((()=>{m(!0)}),[m]),g=Object(i.useMemo)((()=>{if(null!==l)return null!=l?l:"discuss"}),[l]);return Object(i.useMemo)((()=>Object(p.jsx)(s.EuiButtonEmpty,{color:t,"data-test-subj":"newChat",onClick:f,iconType:g},n)),[n,g,f,t])};It.displayName="NewChatComponent";const Ct=r.a.memo(It),Mt=k.i18n.translate("xpack.elasticAssistant.assistant.newChatById.newChatByIdButton",{defaultMessage:"Chat"}),_t=({children:e=Mt,conversationId:t,iconType:n,promptContextId:r,iconOnly:o=!1})=>{const{showAssistantOverlay:l}=Object(a.b)(),u=Object(i.useCallback)((()=>l({conversationId:t,promptContextId:r,showOverlay:!0})),[t,r,l]),c=Object(i.useMemo)((()=>{if(null!==n)return null!=n?n:"discuss"}),[n]);return Object(i.useMemo)((()=>o?Object(p.jsx)(s.EuiToolTip,{content:Mt},Object(p.jsx)(s.EuiButtonIcon,{"data-test-subj":"newChatById",iconType:null!=c?c:"discuss",onClick:u,color:"text","aria-label":Mt})):Object(p.jsx)(s.EuiButtonEmpty,{"data-test-subj":"newChatById",iconType:c,onClick:u,"aria-label":Mt},e)),[e,c,u,o])};_t.displayName="NewChatByIdComponent";const At=r.a.memo(_t);k.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.user.thenSummarizeSuggestedKqlAndEqlQueries",{defaultMessage:"Evaluate the event from the context above and format your output neatly in markdown syntax for my Elastic Security case."}),k.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.user.finallySuggestInvestigationGuideAndFormatAsMarkdown",{defaultMessage:"Add your description, recommended actions and bulleted triage steps. Use the MITRE ATT&CK data provided to add more context and recommendations from MITRE, and hyperlink to the relevant pages on MITRE's website. Be sure to include the user and host risk score data from the context. Your response should include steps that point to Elastic Security specific features, including endpoint response actions, the Elastic Agent OSQuery manager integration (with example osquery queries), timelines and entity analytics and link to all the relevant Elastic Security documentation."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return g})),n.d(t,"b",(function(){return v}));var a={};n.r(a),n.d(a,"registerProvider",(function(){return o})),n.d(a,"unRegisterProvider",(function(){return l})),n.d(a,"noProviderFound",(function(){return u}));var i={};n.r(i),n.d(i,"getDataProvidersSelector",(function(){return p}));var r=n(26);const s=n.n(r)()("x-pack/security_solution/local/drag_and_drop"),o=s("REGISTER_PROVIDER"),l=s("UNREGISTER_PROVIDER"),u=s("NO_PROVIDER_FOUND");var c=n(57);const d=e=>e.dragAndDrop.dataProviders,p=()=>Object(c.createSelector)(d,(e=>e));var m=n(45),f=n(187);const g={dataProviders:{}},b=({provider:e,dataProviders:t})=>({...t,[e.id]:e}),y=({id:e,dataProviders:t})=>Object(m.omit)(e,t),v=Object(f.reducerWithInitialState)(g).case(o,((e,{provider:t})=>({...e,dataProviders:b({provider:t,dataProviders:e.dataProviders})}))).case(l,((e,{id:t})=>({...e,dataProviders:y({id:t,dataProviders:e.dataProviders})}))).build()},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(204);const i="not-filtered",r=[{columnHeaderType:i,id:"@timestamp",initialWidth:a.b,esTypes:["date"],type:"date"},{columnHeaderType:i,id:"message",initialWidth:a.a},{columnHeaderType:i,id:"event.category",initialWidth:a.a},{columnHeaderType:i,id:"event.action",initialWidth:a.a},{columnHeaderType:i,id:"host.name",initialWidth:a.a},{columnHeaderType:i,id:"source.ip",initialWidth:a.a},{columnHeaderType:i,id:"destination.ip",initialWidth:a.a},{columnHeaderType:i,id:"user.name",initialWidth:a.a}]},function(e,t,n){"use strict";n.d(t,"J",(function(){return i})),n.d(t,"A",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"W",(function(){return o})),n.d(t,"r",(function(){return l})),n.d(t,"t",(function(){return u})),n.d(t,"s",(function(){return c})),n.d(t,"u",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"q",(function(){return m})),n.d(t,"m",(function(){return f})),n.d(t,"w",(function(){return g})),n.d(t,"x",(function(){return b})),n.d(t,"v",(function(){return y})),n.d(t,"n",(function(){return v})),n.d(t,"o",(function(){return h})),n.d(t,"i",(function(){return E})),n.d(t,"h",(function(){return x})),n.d(t,"j",(function(){return j})),n.d(t,"g",(function(){return O})),n.d(t,"e",(function(){return S})),n.d(t,"f",(function(){return k})),n.d(t,"d",(function(){return w})),n.d(t,"C",(function(){return T})),n.d(t,"I",(function(){return I})),n.d(t,"c",(function(){return C})),n.d(t,"B",(function(){return M})),n.d(t,"H",(function(){return _})),n.d(t,"b",(function(){return A})),n.d(t,"G",(function(){return P})),n.d(t,"y",(function(){return F})),n.d(t,"z",(function(){return D})),n.d(t,"L",(function(){return N})),n.d(t,"k",(function(){return R})),n.d(t,"l",(function(){return L})),n.d(t,"F",(function(){return z})),n.d(t,"K",(function(){return B})),n.d(t,"M",(function(){return q})),n.d(t,"N",(function(){return $})),n.d(t,"V",(function(){return V})),n.d(t,"O",(function(){return U})),n.d(t,"P",(function(){return H})),n.d(t,"U",(function(){return Z})),n.d(t,"S",(function(){return G})),n.d(t,"R",(function(){return Q})),n.d(t,"Q",(function(){return W})),n.d(t,"T",(function(){return K})),n.d(t,"E",(function(){return J})),n.d(t,"D",(function(){return Y}));var a=n(5);a.i18n.translate("xpack.securitySolution.detectionEngine.pageTitle",{defaultMessage:"Detection engine"}),a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.documentTypeTitle",{defaultMessage:"Alerts"});const i=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.openAlertsTitle",{defaultMessage:"Open"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.closedAlertsTitle",{defaultMessage:"Closed"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.acknowledgedAlertsTitle",{defaultMessage:"Acknowledged"}),o=(a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.loadingAlertsTitle",{defaultMessage:"Loading Alerts"}),a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.totalCountOfAlertsTitle",{defaultMessage:"alerts"})),l=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleTitle",{defaultMessage:"Rule"}),u=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleNameTitle",{defaultMessage:"Rule name"}),c=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.ruleDescriptionTitle",{defaultMessage:"Rule description"}),d=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.severityTitle",{defaultMessage:"Severity"}),p=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.reasonTitle",{defaultMessage:"Reason"}),m=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.riskScoreTitle",{defaultMessage:"Risk Score"}),f=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.assigneesTitle",{defaultMessage:"Assignees"}),g=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdCount",{defaultMessage:"Event Count"}),b=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdTerms",{defaultMessage:"Threshold Terms"}),y=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.thresholdCardinality",{defaultMessage:"Event Cardinality"}),v=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.newTerms",{defaultMessage:"New Terms"}),h=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.newTermsFields",{defaultMessage:"New Terms fields"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.investigateInTimelineTitle",{defaultMessage:"Investigate in timeline"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.cannotInvestigateInTimelineTitle",{defaultMessage:"Please navigate to a page with timeline to investigate"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.investigateInTimelineAriaLabel",{defaultMessage:"Send alert to timeline"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addException",{defaultMessage:"Add rule exception"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEventFilter",{defaultMessage:"Add Endpoint event filter"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEventFilter.disabled.tooltip",{defaultMessage:"Endpoint event filters can be created from the Events section of the Hosts page."}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addEndpointException",{defaultMessage:"Add Endpoint exception"}),T=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.closedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully closed {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."}),I=(a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.alertDurationTitle",{defaultMessage:"Alert duration"}),e=>a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.openedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully opened {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}}."})),C=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.acknowledgedAlertSuccessToastMessage",{values:{totalAlerts:e},defaultMessage:"Successfully marked {totalAlerts} {totalAlerts, plural, =1 {alert} other {alerts}} as acknowledged."}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.closedAlertFailedToastMessage",{defaultMessage:"Failed to close alert(s)."}),_=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.openedAlertFailedToastMessage",{defaultMessage:"Failed to open alert(s)"}),A=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.acknowledgedAlertFailedToastMessage",{defaultMessage:"Failed to mark alert(s) as acknowledged"}),P=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.moreActionsAriaLabel",{defaultMessage:"More actions"}),F=(a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.statusTitle",{defaultMessage:"Status"}),a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overview.changeAlertStatus",{defaultMessage:"Change alert status"})),D=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overview.clickToChangeAlertStatus",{defaultMessage:"Click to change alert status"}),N=a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.overviewTable.signalStatusTitle",{defaultMessage:"Status"}),R=(a.i18n.translate("xpack.securitySolution.eventsViewer.alerts.defaultHeaders.triggeredTitle",{defaultMessage:"Triggered"}),a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addToCase",{defaultMessage:"Add to existing case"})),L=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addToNewCase",{defaultMessage:"Add to new case"}),z=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.actions.addBulkToTimeline",{defaultMessage:"Investigate in timeline"}),B=a.i18n.translate("xpack.securitySolution.sessionsView.sessionsTitle",{defaultMessage:"Sessions"}),q=(a.i18n.translate("xpack.securitySolution.detectionEngine.groups.additionalActions.takeAction",{defaultMessage:"Take actions"}),a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.alertsCount",{defaultMessage:"Alerts:"})),$=a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.hostsCount",{defaultMessage:"Hosts:"}),V=(a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.ipsCount",{defaultMessage:"IP's:"}),a.i18n.translate("xpack.securitySolution.detectionEngine.selectGroup.title",{defaultMessage:"Group alerts by"}),a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.usersCount",{defaultMessage:"Users:"})),U=a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.rulesCount",{defaultMessage:"Rules:"}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity",{defaultMessage:"Severity:"}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity.multi",{defaultMessage:"Multi"}),G=a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity.low",{defaultMessage:"Low"}),Q=a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity.high",{defaultMessage:"High"}),W=a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity.critical",{defaultMessage:"Critical"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.groups.stats.severity.medium",{defaultMessage:"Medium"}),J=a.i18n.translate("xpack.securitySolution.detectionsEngine.grouping.inspectTitle",{defaultMessage:"Grouping query"}),Y={timestamp:a.i18n.translate("xpack.securitySolution.EventRenderedView.timestampTitle.column",{defaultMessage:"Timestamp"}),rule:a.i18n.translate("xpack.securitySolution.EventRenderedView.ruleTitle.column",{defaultMessage:"Rule"}),eventSummary:a.i18n.translate("xpack.securitySolution.EventRenderedView.eventSummary.column",{defaultMessage:"Event Summary"})}},function(e,t,n){"use strict";n.d(t,"l",(function(){return i})),n.d(t,"k",(function(){return r})),n.d(t,"m",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"n",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"o",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"j",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"q",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"g",(function(){return v})),n.d(t,"h",(function(){return h})),n.d(t,"a",(function(){return E}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.visualizationActions.moreActions",{defaultMessage:"More actions"}),r=a.i18n.translate("xpack.securitySolution.visualizationActions.inspect",{defaultMessage:"Inspect"}),s=a.i18n.translate("xpack.securitySolution.visualizationActions.openInLens",{defaultMessage:"Open in Lens"}),o=a.i18n.translate("xpack.securitySolution.visualizationActions.addToNewCase",{defaultMessage:"Add to new case"}),l=a.i18n.translate("xpack.securitySolution.visualizationActions.addToExistingCase",{defaultMessage:"Add to existing case"}),u=a.i18n.translate("xpack.securitySolution.visualizationActions.addToCaseSuccessContent",{defaultMessage:"Successfully added visualization to the case"}),c=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.sourceChartLabel",{defaultMessage:"Src."}),d=a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueIps.destinationChartLabel",{defaultMessage:"Dest."}),p=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.successChartLabel",{defaultMessage:"Succ."}),m=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.successChartLabel",{defaultMessage:"Success"}),f=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.failChartLabel",{defaultMessage:"Fail"}),g=a.i18n.translate("xpack.securitySolution.visualizationActions.userAuthentications.authentication.failureChartLabel",{defaultMessage:"Failure"}),b=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.uniqueCountLabel",{values:{field:e},defaultMessage:"Unique count of {field}"}),y=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.topValueLabel",{values:{field:e},defaultMessage:"Top values of {field}"}),v=a.i18n.translate("xpack.securitySolution.visualizationActions.countLabel",{defaultMessage:"Count of records"}),h=e=>a.i18n.translate("xpack.securitySolution.visualizationActions.countOfFieldLabel",{values:{field:e},defaultMessage:"Count of {field}"}),E=a.i18n.translate("xpack.securitySolution.visualizationActions.addedToLibrary",{defaultMessage:"Added to library"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(17),s=n(44);const o=n.n(s)()(r.EuiText).withConfig({displayName:"CodeBlock",componentId:"sc-s548fn-0"})(["font-family:",";"],(e=>e.theme.eui.euiCodeFontFamily)),l=Object(a.memo)((({children:e,inline:t=!1,textColor:n="default",bold:a=!1})=>i.a.createElement(o,{size:"relative",color:n,className:t?"eui-displayInline":""},a?i.a.createElement("strong",null,e):e)));l.displayName="ConsoleCodeBlock"},function(e,t,n){"use strict";n.d(t,"B",(function(){return r})),n.d(t,"C",(function(){return s})),n.d(t,"D",(function(){return o})),n.d(t,"v",(function(){return l})),n.d(t,"r",(function(){return c})),n.d(t,"q",(function(){return d})),n.d(t,"u",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"w",(function(){return f})),n.d(t,"x",(function(){return g})),n.d(t,"f",(function(){return b})),n.d(t,"s",(function(){return y})),n.d(t,"z",(function(){return v})),n.d(t,"p",(function(){return h})),n.d(t,"t",(function(){return E})),n.d(t,"y",(function(){return x})),n.d(t,"o",(function(){return j})),n.d(t,"n",(function(){return O})),n.d(t,"A",(function(){return S})),n.d(t,"e",(function(){return k})),n.d(t,"c",(function(){return w})),n.d(t,"b",(function(){return T})),n.d(t,"a",(function(){return I})),n.d(t,"d",(function(){return C})),n.d(t,"i",(function(){return M})),n.d(t,"h",(function(){return _})),n.d(t,"j",(function(){return A})),n.d(t,"k",(function(){return P})),n.d(t,"m",(function(){return F})),n.d(t,"l",(function(){return D}));var a=n(70),i=n(186);const r="logs-endpoint.events.*",s="metrics-endpoint.metadata_current_*",o="endpoint.metadata_current-default",l=".metrics-endpoint.metadata_united_default",u=(Object(a.getFileMetadataIndexName)("endpoint"),Object(a.getFileDataIndexName)("endpoint"),"/api/endpoint"),c=`${u}/metadata`,d=`${c}/{id}`,p=`${u}/metadata/transforms`,m=`${u}/policy_response`,f=`${u}/protection_updates_note/{package_policy_id}`,g=`${u}/suggestions/{suggestion_type}`,b=`${u}/action`,y=`${b}/isolate`,v=`${b}/unisolate`,h=`${b}/running_procs`,E=`${b}/kill_process`,x=`${b}/suspend_process`,j=`${b}/get_file`,O=`${b}/execute`,S=`${b}/upload`,k=`${u}/action_status`,w=`${b}/{action_id}`,T=`${b}/{action_id}/file/{file_id}`,I=`${b}/{action_id}/file/{file_id}/download`,C=`${b}/state`,M=i.a.ENROLLED_AT,_="desc",A={ES_CONNECTION_ERROR:-272,OUTPUT_SERVER_ERROR:-273},P="endpointFields",F="endpointSearchStrategy",D="endpointPackagePoliciesStatsStrategy"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(2),i=n.n(a),r=n(124),s=n(901),o=n(491),l=n(394),u=n(211),c=n(428);const d=Object(a.createContext)(void 0),p=Object(a.memo)((({id:e,indexName:t,scopeId:n,children:p})=>{const{browserFields:m,dataAsNestedObject:f,dataFormattedForFieldBrowser:g,getFieldsData:b,loading:y,searchHit:v}=Object(s.a)({eventId:e,indexName:t}),{ruleId:h}=Object(u.b)(g),{rule:E}=Object(c.a)(h),x=Object(a.useMemo)((()=>{var a,i;return e&&t&&n&&f&&g&&v?{eventId:e,indexName:t,scopeId:n,browserFields:m,dataAsNestedObject:f,dataFormattedForFieldBrowser:g,searchHit:v,investigationFields:null!==(a=null==E||null===(i=E.investigation_fields)||void 0===i?void 0:i.field_names)&&void 0!==a?a:[],getFieldsData:b,isPreview:n===r.e.rulePreview}:void 0}),[e,t,n,m,f,g,v,null==E?void 0:E.investigation_fields,b]);return y?i.a.createElement(l.a,null):x?i.a.createElement(d.Provider,{value:x},p):i.a.createElement(o.a,null)}));p.displayName="LeftPanelProvider";const m=()=>{const e=Object(a.useContext)(d);if(!e)throw new Error("LeftPanelContext can only be used within LeftPanelContext provider");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(698);const r=()=>Object(a.useContext)(i.a)},function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"f",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"g",(function(){return f})),n.d(t,"a",(function(){return g}));var a=n(60),i=n(310),r=n(15),s=n(49),o=n(2),l=n(129);const u=e=>e===l.a.alerts||e===l.a.rules||e===l.a.rulesAdd||e===l.a.rulesCreate||e===l.a.exceptions,c=e=>e.substring(1),d=(e,t)=>{const n=Object(i.parse)(e,{sort:!1})[t];return Array.isArray(n)?n[0]:n},p=e=>Object(o.useCallback)((()=>{const t=d(c(window.location.search),e);return Object(a.safeDecode)(null!=t?t:"")}),[e]),m=e=>Object(i.stringify)(r.url.encodeQuery(e),{sort:!1,encode:!1}),f=()=>{const e=Object(s.useHistory)();return Object(o.useCallback)((t=>{const n=window.location.search,r=Object(i.parse)(n,{sort:!1});Object.keys(t).forEach((e=>{const n=t[e];if(null!=n&&""!==n)try{r[e]=Object(a.encode)(n)}catch{console.error("Unable to encode url param value")}else delete r[e]}));const s=m(r);c(n)!==s&&e.replace({search:s})}),[e])},g=()=>{window.history.pushState({},"",window.location.href)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r}));const a=180,i=70,r=190},function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var a=n(23),i=n.n(a),r=n(59),s=n.n(r),o=n(2),l=n.n(o),u=n(44),c=n.n(u),d=n(189),p=n(214);const m=c.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1kulm59-0"})(["&.securitySolutionWrapper--fullHeight{height:100%;display:flex;flex-direction:column;flex:1 1 auto;}&.securitySolutionWrapper--noPadding{padding:0;display:flex;flex-direction:column;flex:1 1 auto;}"]);m.displayName="Wrapper";const f=({children:e,className:t,style:n,noPadding:a,noTimeline:r,...u})=>{const{globalFullScreen:c,setGlobalFullScreen:f}=Object(d.a)();Object(o.useEffect)((()=>{f(!1)}),[f]);const g=s()(t,{securitySolutionWrapper:!0,"securitySolutionWrapper--noPadding":a,"securitySolutionWrapper--withTimeline":!r,"securitySolutionWrapper--fullHeight":c});return l.a.createElement(m,i()({className:g,style:n},u),e,l.a.createElement(p.a,null))},g=l.a.memo(f)},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useRef(!1),t=a.useCallback((function(){return e.current}),[]);return a.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},function(e,t,n){"use strict";n.r(t),n.d(t,"updateNote",(function(){return r})),n.d(t,"addNotes",(function(){return s})),n.d(t,"deleteNote",(function(){return o})),n.d(t,"addError",(function(){return l})),n.d(t,"removeError",(function(){return u})),n.d(t,"addErrorHash",(function(){return c}));var a=n(26);const i=n.n(a)()("x-pack/security_solution/local/app"),r=i("UPDATE_NOTE"),s=i("ADD_NOTE"),o=i("DELETE_NOTE"),l=i("ADD_ERRORS"),u=i("REMOVE_ERRORS"),c=i("ADD_ERROR_HASH")},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(45);const i=e=>Object(a.isString)(e)?e:JSON.stringify(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(749);const r=()=>Object(a.useContext)(i.a)},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m}));var a=n(45),i=n(2),r=n.n(i),s=n(262),o=n(322);const l={canUserCRUD:null,canUserREAD:null,hasIndexManage:null,hasIndexMaintenance:null,hasIndexWrite:null,hasIndexRead:null,hasIndexUpdateDelete:null,isSignalIndexExists:null,isAuthenticated:null,hasEncryptionKey:null,loading:!0,signalIndexName:null,signalIndexMappingOutdated:null},u=(e,t)=>{switch(t.type){case"updateLoading":return{...e,loading:t.loading};case"updateHasIndexManage":return{...e,hasIndexManage:t.hasIndexManage};case"updateHasIndexMaintenance":return{...e,hasIndexMaintenance:t.hasIndexMaintenance};case"updateHasIndexWrite":return{...e,hasIndexWrite:t.hasIndexWrite};case"updateHasIndexRead":return{...e,hasIndexRead:t.hasIndexRead};case"updateHasIndexUpdateDelete":return{...e,hasIndexUpdateDelete:t.hasIndexUpdateDelete};case"updateIsSignalIndexExists":return{...e,isSignalIndexExists:t.isSignalIndexExists};case"updateIsAuthenticated":return{...e,isAuthenticated:t.isAuthenticated};case"updateHasEncryptionKey":return{...e,hasEncryptionKey:t.hasEncryptionKey};case"updateSignalIndexName":return{...e,signalIndexName:t.signalIndexName};case"updateSignalIndexMappingOutdated":return{...e,signalIndexMappingOutdated:t.signalIndexMappingOutdated};case"updateCanUserCRUD":return{...e,canUserCRUD:t.canUserCRUD};case"updateCanUserREAD":return{...e,canUserREAD:t.canUserREAD};default:return e}},c=Object(i.createContext)([l,()=>a.noop]),d=()=>Object(i.useContext)(c),p=({children:e})=>r.a.createElement(c.Provider,{value:Object(i.useReducer)(u,l)},e),m=()=>{const[{canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:a,hasIndexWrite:r,hasIndexRead:l,hasIndexUpdateDelete:u,isSignalIndexExists:c,isAuthenticated:p,hasEncryptionKey:m,loading:f,signalIndexName:g,signalIndexMappingOutdated:b},y]=d(),{loading:v,isAuthenticated:h,hasEncryptionKey:E,hasIndexManage:x,hasIndexMaintenance:j,hasIndexUpdateDelete:O,hasIndexWrite:S,hasIndexRead:k,hasKibanaCRUD:w,hasKibanaREAD:T}=Object(s.a)(),{loading:I,signalIndexExists:C,signalIndexName:M,signalIndexMappingOutdated:_,createDeSignalIndex:A}=Object(o.a)();return Object(i.useEffect)((()=>{f||e===w||y({type:"updateCanUserCRUD",canUserCRUD:w})}),[y,f,e,w]),Object(i.useEffect)((()=>{f||t===T||y({type:"updateCanUserREAD",canUserREAD:T})}),[y,f,t,T]),Object(i.useEffect)((()=>{f!==(v||I)&&y({type:"updateLoading",loading:v||I})}),[y,f,v,I]),Object(i.useEffect)((()=>{f||n===x||null==x||y({type:"updateHasIndexManage",hasIndexManage:x})}),[y,f,n,x]),Object(i.useEffect)((()=>{f||r===S||null==S||y({type:"updateHasIndexWrite",hasIndexWrite:S})}),[y,f,r,S]),Object(i.useEffect)((()=>{f||l===k||null==k||y({type:"updateHasIndexRead",hasIndexRead:k})}),[y,f,l,k]),Object(i.useEffect)((()=>{f||u===O||null==O||y({type:"updateHasIndexUpdateDelete",hasIndexUpdateDelete:O})}),[y,f,u,O]),Object(i.useEffect)((()=>{f||a===j||null==j||y({type:"updateHasIndexMaintenance",hasIndexMaintenance:j})}),[y,f,a,j]),Object(i.useEffect)((()=>{f||c===C||null==C||y({type:"updateIsSignalIndexExists",isSignalIndexExists:C})}),[y,f,c,C]),Object(i.useEffect)((()=>{f||p===h||null==h||y({type:"updateIsAuthenticated",isAuthenticated:h})}),[y,f,p,h]),Object(i.useEffect)((()=>{f||m===E||null==E||y({type:"updateHasEncryptionKey",hasEncryptionKey:E})}),[y,f,m,E]),Object(i.useEffect)((()=>{f||g===M||null==M||y({type:"updateSignalIndexName",signalIndexName:M})}),[y,f,g,M]),Object(i.useEffect)((()=>{f||b===_||null==_||y({type:"updateSignalIndexMappingOutdated",signalIndexMappingOutdated:_})}),[y,f,b,_]),Object(i.useEffect)((()=>{p&&m&&n&&(null!=c&&!c||null!=b&&b)&&null!=A&&A()}),[A,p,m,c,n,b]),{loading:f,isSignalIndexExists:c,isAuthenticated:p,hasEncryptionKey:m,canUserCRUD:e,canUserREAD:t,hasIndexManage:n,hasIndexMaintenance:a,hasIndexWrite:r,hasIndexRead:l,hasIndexUpdateDelete:u,signalIndexName:g,signalIndexMappingOutdated:b}}},function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return f}));var a=n(17),i=n(44),r=n.n(i);const s=r.a.div.withConfig({displayName:"SecuritySolutionAppWrapper",componentId:"sc-2kezi3-0"})(["display:flex;flex-direction:column;flex:1 1 auto;width:100%;"]);s.displayName="SecuritySolutionAppWrapper";const o=()=>Object(i.css)([".euiOverlayMask[data-relative-to-header='below']{top:0 !important;}.euiFlyout{top:0 !important;height:100% !important;}"]),l=Object(i.createGlobalStyle)([".euiDataGridRowCell__popover{max-width:815px !important;max-height:none !important;overflow:hidden;.expandable-top-value-button{&.euiButtonEmpty:focus{background-color:transparent;}}&.euiPopover__panel[data-popover-open]{padding:8px 0;min-width:65px;}.euiPopoverFooter{border:0;margin-top:0;.euiFlexGroup{flex-direction:column;}}.euiText + .euiPopoverFooter{border-top:1px solid ",";margin-top:",";}}.euiPanel-loading-hide-border{border:none;}body.euiBody-hasOverlayMask{.euiDataGridRowCell__popover[data-popover-open],.withHoverActions__popover[data-popover-open]{visibility:hidden !important;}}.euiScreenReaderOnly{clip:rect(1px,1px,1px,1px);clip-path:inset(50%);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;}"],(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiSizeS)),u=r()(a.EuiDescriptionList).withConfig({displayName:"DescriptionListStyled",componentId:"sc-2kezi3-1"})(["",""],(({theme:e})=>`\n    word-break: break-word;\n    dt {\n      font-size: ${e.eui.euiFontSizeXS} !important;\n    }\n    dd {\n      width: fit-content;\n    }\n    dd > div {\n      width: fit-content;\n    }\n  `));u.displayName="DescriptionListStyled";const c=r()(a.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-2kezi3-2"})(["margin-left:5px;"]);c.displayName="CountBadge";const d=r.a.span.withConfig({displayName:"Spacer",componentId:"sc-2kezi3-3"})(["margin-left:5px;"]);d.displayName="Spacer";const p=r()(a.EuiBadge).withConfig({displayName:"Badge",componentId:"sc-2kezi3-4"})(["vertical-align:top;"]);p.displayName="Badge";const m=r()(a.EuiIcon).withConfig({displayName:"MoreRowItems",componentId:"sc-2kezi3-5"})(["margin-left:5px;"]);m.displayName="MoreRowItems";const f=r()(a.EuiFlexGroup).withConfig({displayName:"OverviewWrapper",componentId:"sc-2kezi3-6"})(["position:relative;.euiButtonIcon{position:absolute;right:",";top:6px;z-index:2;}"],(e=>e.theme.eui.euiSizeM));f.displayName="OverviewWrapper"},function(e,t,n){"use strict";n.d(t,"C",(function(){return i})),n.d(t,"q",(function(){return r})),n.d(t,"v",(function(){return s})),n.d(t,"l",(function(){return o})),n.d(t,"o",(function(){return l})),n.d(t,"p",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"n",(function(){return d})),n.d(t,"B",(function(){return p})),n.d(t,"r",(function(){return m})),n.d(t,"u",(function(){return f})),n.d(t,"y",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"E",(function(){return y})),n.d(t,"w",(function(){return v})),n.d(t,"b",(function(){return h})),n.d(t,"x",(function(){return E})),n.d(t,"z",(function(){return x})),n.d(t,"t",(function(){return j})),n.d(t,"s",(function(){return O})),n.d(t,"a",(function(){return S})),n.d(t,"c",(function(){return k})),n.d(t,"F",(function(){return w})),n.d(t,"g",(function(){return T})),n.d(t,"A",(function(){return I})),n.d(t,"D",(function(){return C})),n.d(t,"e",(function(){return M})),n.d(t,"d",(function(){return _})),n.d(t,"f",(function(){return A})),n.d(t,"i",(function(){return P})),n.d(t,"h",(function(){return F})),n.d(t,"j",(function(){return D}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.alertDetails.threatIntel",{defaultMessage:"Threat Intel"}),r=a.i18n.translate("xpack.securitySolution.alertDetails.overview.investigationGuide",{defaultMessage:"Investigation guide"}),s=a.i18n.translate("xpack.securitySolution.alertDetails.overview",{defaultMessage:"Overview"}),o=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields",{defaultMessage:"Highlighted fields"}),l=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.field",{defaultMessage:"Field"}),u=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.value",{defaultMessage:"Value"}),c=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalence",{defaultMessage:"Alert prevalence"}),d=a.i18n.translate("xpack.securitySolution.alertDetails.overview.highlightedFields.alertPrevalenceTooltip",{defaultMessage:"The total count of alerts with the same value within the currently selected timerange. This value is not affected by additional filters."}),p=a.i18n.translate("xpack.securitySolution.eventDetails.table",{defaultMessage:"Table"}),m=a.i18n.translate("xpack.securitySolution.eventDetails.jsonView",{defaultMessage:"JSON"}),f=a.i18n.translate("xpack.securitySolution.eventDetails.osqueryView",{defaultMessage:"Osquery Results"}),g=a.i18n.translate("xpack.securitySolution.eventDetails.responseActionsView",{defaultMessage:"Response Results"}),b=a.i18n.translate("xpack.securitySolution.eventDetails.field",{defaultMessage:"Field"}),y=a.i18n.translate("xpack.securitySolution.eventDetails.value",{defaultMessage:"Value"}),v=(a.i18n.translate("xpack.securitySolution.eventDetails.description",{defaultMessage:"Description"}),a.i18n.translate("xpack.securitySolution.eventDetails.filter.placeholder",{defaultMessage:"Filter by Field, Value, or Description..."})),h=a.i18n.translate("xpack.securitySolution.detections.alerts.agentStatus",{defaultMessage:"Agent status"}),E=a.i18n.translate("xpack.securitySolution.detections.alerts.quarantinedFilePath",{defaultMessage:"Quarantined file path"}),x=a.i18n.translate("xpack.securitySolution.detections.alerts.ruleType",{defaultMessage:"Rule type"}),j=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldTooltipContent",{defaultMessage:"Multi-fields can have multiple values per field"}),O=a.i18n.translate("xpack.securitySolution.eventDetails.multiFieldBadge",{defaultMessage:"multi-field"}),S=a.i18n.translate("xpack.securitySolution.eventDetails.table.actions",{defaultMessage:"Actions"}),k=a.i18n.translate("xpack.securitySolution.eventDetails.alertReason",{defaultMessage:"Alert reason"}),w=a.i18n.translate("xpack.securitySolution.eventDetails.viewAllFields",{defaultMessage:"View all fields in table"}),T=Object.freeze({tried:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.tried",{values:{command:e},defaultMessage:"tried to execute {command} command"}),executed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.executed",{values:{command:e},defaultMessage:"executed {command} command"}),pending:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.pending",{values:{command:e},defaultMessage:"is executing {command} command"}),failed:e=>a.i18n.translate("xpack.securitySolution.eventDetails.responseActions.endpoint.failed",{values:{command:e},defaultMessage:"failed to execute {command} command"})}),I=a.i18n.translate("xpack.securitySolution.eventDetails.summaryView",{defaultMessage:"summary"}),C=a.i18n.translate("xpack.securitySolution.eventDetails.timelineView",{defaultMessage:"Timeline"}),M=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewConversationId",{defaultMessage:"Alert summary"}),_=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextDescription",{defaultMessage:"Alert (from {view})",values:{view:e}}),A=a.i18n.translate("xpack.securitySolution.alertSummaryView.alertSummaryViewContextTooltip",{defaultMessage:"Add this alert as context"}),P=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewConversationId",{defaultMessage:"Event summary"}),F=e=>a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextDescription",{defaultMessage:"Event (from {view})",values:{view:e}}),D=a.i18n.translate("xpack.securitySolution.alertSummaryView.eventSummaryViewContextTooltip",{defaultMessage:"Add this event as context"})},,function(e,t,n){class Range{constructor(e,t){if(t=i(t),e instanceof Range)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new Range(e.raw,t);if(e instanceof r)return this.raw=e.value,this.set=[[e]],this.format(),this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((e=>this.parseRange(e.trim()))).filter((e=>e.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const e=this.set[0];if(this.set=this.set.filter((e=>!g(e[0]))),0===this.set.length)this.set=[e];else if(this.set.length>1)for(const e of this.set)if(1===e.length&&b(e[0])){this.set=[e];break}}this.format()}format(){return this.range=this.set.map((e=>e.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(e){const t=((this.options.includePrerelease&&m)|(this.options.loose&&f))+":"+e,n=a.get(t);if(n)return n;const i=this.options.loose,o=i?l[u.HYPHENRANGELOOSE]:l[u.HYPHENRANGE];e=e.replace(o,I(this.options.includePrerelease)),s("hyphen replace",e),e=e.replace(l[u.COMPARATORTRIM],c),s("comparator trim",e),e=e.replace(l[u.TILDETRIM],d),s("tilde trim",e),e=e.replace(l[u.CARETTRIM],p),s("caret trim",e);let b=e.split(" ").map((e=>v(e,this.options))).join(" ").split(/\s+/).map((e=>T(e,this.options)));i&&(b=b.filter((e=>(s("loose invalid filter",e,this.options),!!e.match(l[u.COMPARATORLOOSE]))))),s("range list",b);const y=new Map,h=b.map((e=>new r(e,this.options)));for(const e of h){if(g(e))return[e];y.set(e.value,e)}y.size>1&&y.has("")&&y.delete("");const E=[...y.values()];return a.set(t,E),E}intersects(e,t){if(!(e instanceof Range))throw new TypeError("a Range is required");return this.set.some((n=>y(n,t)&&e.set.some((e=>y(e,t)&&n.every((n=>e.every((e=>n.intersects(e,t)))))))))}test(e){if(!e)return!1;if("string"==typeof e)try{e=new o(e,this.options)}catch(e){return!1}for(let t=0;t<this.set.length;t++)if(C(this.set[t],e,this.options))return!0;return!1}}e.exports=Range;const a=new(n(1247))({max:1e3}),i=n(412),r=n(540),s=n(314),o=n(173),{safeRe:l,t:u,comparatorTrimReplace:c,tildeTrimReplace:d,caretTrimReplace:p}=n(316),{FLAG_INCLUDE_PRERELEASE:m,FLAG_LOOSE:f}=n(315),g=e=>"<0.0.0-0"===e.value,b=e=>""===e.value,y=(e,t)=>{let n=!0;const a=e.slice();let i=a.pop();for(;n&&a.length;)n=a.every((e=>i.intersects(e,t))),i=a.pop();return n},v=(e,t)=>(s("comp",e,t),e=j(e,t),s("caret",e),e=E(e,t),s("tildes",e),e=S(e,t),s("xrange",e),e=w(e,t),s("stars",e),e),h=e=>!e||"x"===e.toLowerCase()||"*"===e,E=(e,t)=>e.trim().split(/\s+/).map((e=>x(e,t))).join(" "),x=(e,t)=>{const n=t.loose?l[u.TILDELOOSE]:l[u.TILDE];return e.replace(n,((t,n,a,i,r)=>{let o;return s("tilde",e,t,n,a,i,r),h(n)?o="":h(a)?o=`>=${n}.0.0 <${+n+1}.0.0-0`:h(i)?o=`>=${n}.${a}.0 <${n}.${+a+1}.0-0`:r?(s("replaceTilde pr",r),o=`>=${n}.${a}.${i}-${r} <${n}.${+a+1}.0-0`):o=`>=${n}.${a}.${i} <${n}.${+a+1}.0-0`,s("tilde return",o),o}))},j=(e,t)=>e.trim().split(/\s+/).map((e=>O(e,t))).join(" "),O=(e,t)=>{s("caret",e,t);const n=t.loose?l[u.CARETLOOSE]:l[u.CARET],a=t.includePrerelease?"-0":"";return e.replace(n,((t,n,i,r,o)=>{let l;return s("caret",e,t,n,i,r,o),h(n)?l="":h(i)?l=`>=${n}.0.0${a} <${+n+1}.0.0-0`:h(r)?l="0"===n?`>=${n}.${i}.0${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${a} <${+n+1}.0.0-0`:o?(s("replaceCaret pr",o),l="0"===n?"0"===i?`>=${n}.${i}.${r}-${o} <${n}.${i}.${+r+1}-0`:`>=${n}.${i}.${r}-${o} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${r}-${o} <${+n+1}.0.0-0`):(s("no pr"),l="0"===n?"0"===i?`>=${n}.${i}.${r}${a} <${n}.${i}.${+r+1}-0`:`>=${n}.${i}.${r}${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${r} <${+n+1}.0.0-0`),s("caret return",l),l}))},S=(e,t)=>(s("replaceXRanges",e,t),e.split(/\s+/).map((e=>k(e,t))).join(" ")),k=(e,t)=>{e=e.trim();const n=t.loose?l[u.XRANGELOOSE]:l[u.XRANGE];return e.replace(n,((n,a,i,r,o,l)=>{s("xRange",e,n,a,i,r,o,l);const u=h(i),c=u||h(r),d=c||h(o),p=d;return"="===a&&p&&(a=""),l=t.includePrerelease?"-0":"",u?n=">"===a||"<"===a?"<0.0.0-0":"*":a&&p?(c&&(r=0),o=0,">"===a?(a=">=",c?(i=+i+1,r=0,o=0):(r=+r+1,o=0)):"<="===a&&(a="<",c?i=+i+1:r=+r+1),"<"===a&&(l="-0"),n=`${a+i}.${r}.${o}${l}`):c?n=`>=${i}.0.0${l} <${+i+1}.0.0-0`:d&&(n=`>=${i}.${r}.0${l} <${i}.${+r+1}.0-0`),s("xRange return",n),n}))},w=(e,t)=>(s("replaceStars",e,t),e.trim().replace(l[u.STAR],"")),T=(e,t)=>(s("replaceGTE0",e,t),e.trim().replace(l[t.includePrerelease?u.GTE0PRE:u.GTE0],"")),I=e=>(t,n,a,i,r,s,o,l,u,c,d,p,m)=>`${n=h(a)?"":h(i)?`>=${a}.0.0${e?"-0":""}`:h(r)?`>=${a}.${i}.0${e?"-0":""}`:s?`>=${n}`:`>=${n}${e?"-0":""}`} ${l=h(u)?"":h(c)?`<${+u+1}.0.0-0`:h(d)?`<${u}.${+c+1}.0-0`:p?`<=${u}.${c}.${d}-${p}`:e?`<${u}.${c}.${+d+1}-0`:`<=${l}`}`.trim(),C=(e,t,n)=>{for(let n=0;n<e.length;n++)if(!e[n].test(t))return!1;if(t.prerelease.length&&!n.includePrerelease){for(let n=0;n<e.length;n++)if(s(e[n].semver),e[n].semver!==r.ANY&&e[n].semver.prerelease.length>0){const a=e[n].semver;if(a.major===t.major&&a.minor===t.minor&&a.patch===t.patch)return!0}return!1}return!0}},function(e,t,n){"use strict";n.d(t,"b",(function(){return I})),n.d(t,"a",(function(){return C}));var a=n(144),i=n(157),r=n(48),s=n(2),o=n(119),l=n(110),u=n(128),c=n(138),d=n(45),p=n(130),m=n(335),f=n(360);var g=n(235),b=n.n(g),y=n(203),v=n(202);var h=n(60),E=n(151),x=n(162),j=n(118),O=n(112),S=n(49);const k=({search:e,urlKey:t})=>Object(y.c)(Object(y.d)(e),t);var w=n(124),T=n(4);const I=()=>{Object(i.c)(),(()=>{const e=Object(r.useDispatch)(),{filterManager:t,savedQueries:n}=Object(l.i)().services.data.query,a=Object(s.useMemo)((()=>u.d.globalFiltersQuerySelector()),[]),d=Object(r.useSelector)(a),p=Object(s.useCallback)((t=>{null!=t&&e(c.b.setFilterQuery({id:o.a.global,query:t.query,language:t.language}))}),[e]),m=Object(s.useCallback)((n=>{null!=n?(t.setFilters(n),e(c.b.setSearchBarFilter({id:o.a.global,filters:n}))):(t.setAppFilters(d),e(c.b.setSearchBarFilter({id:o.a.global,filters:t.getFilters()})))}),[t,e,d]),f=Object(s.useCallback)((a=>{null!=a&&""!==a&&n.getSavedQuery(a).then((n=>{const a=n.attributes.filters||[],i=n.attributes.query;t.setFilters(a),e(c.b.setSearchBarFilter({id:o.a.global,filters:a})),e(c.b.setFilterQuery({id:o.a.global,...i})),e(c.b.setSavedQuery({id:o.a.global,savedQuery:n}))}))}),[e,t,n]);Object(i.b)(C.appQuery,p),Object(i.b)(C.filters,m),Object(i.b)(C.savedQuery,f)})(),(()=>{const e=Object(r.useDispatch)(),t=Object(p.a)("socTrendsEnabled"),n=Object(s.useCallback)((n=>((e,t,n)=>{if(null!=e){const a={linkTo:Object(d.get)("global.linkTo",e)},i=Object(d.get)("global.timerange.kind",e),r={linkTo:Object(d.get)("timeline.linkTo",e)},s=Object(d.get)("timeline.timerange.kind",e),l={linkTo:Object(d.get)("socTrends.linkTo",e)},u=Object(d.get)("socTrends.timerange.kind",e);if(n&&(Object(d.isEmpty)(l.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.socTrends])):t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(d.isEmpty)(a.linkTo)?(t(c.b.removeLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.removeLinkTo([o.a.global,o.a.socTrends]))):(t(c.b.addLinkTo([o.a.global,o.a.timeline])),n&&t(c.b.addLinkTo([o.a.global,o.a.socTrends]))),Object(d.isEmpty)(r.linkTo)?t(c.b.removeLinkTo([o.a.global,o.a.timeline])):t(c.b.addLinkTo([o.a.global,o.a.timeline])),s){if("absolute"===s){const n=Object(m.a)(Object(d.get)("timeline.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.timeline}))}if("relative"===s){const n=Object(m.a)(Object(d.get)("timeline.timerange",e));n.from=Object(f.c)(n.fromStr),n.to=Object(f.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.timeline}))}}if(i){if("absolute"===i){const n=Object(m.a)(Object(d.get)("global.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.global}))}if("relative"===i){const n=Object(m.a)(Object(d.get)("global.timerange",e));n.from=Object(f.c)(n.fromStr),n.to=Object(f.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.global}))}}if(n&&u){if("absolute"===u){const n=Object(m.a)(Object(d.get)("socTrends.timerange",e));t(c.b.setAbsoluteRangeDatePicker({...n,id:o.a.socTrends}))}if("relative"===u){const n=Object(m.a)(Object(d.get)("socTrends.timerange",e));n.from=Object(f.c)(n.fromStr),n.to=Object(f.c)(n.toStr,{roundUp:!0}),t(c.b.setRelativeRangeDatePicker({...n,id:o.a.socTrends}))}}}})(n,e,t)),[e,t]);Object(i.b)(C.timerange,n)})(),(()=>{const[{pageName:e}]=Object(v.a)(),t=Object(r.useDispatch)(),n=b()(e),a=Object(s.useMemo)((()=>u.d.inputsSelector()),[]),i=Object(r.useSelector)(a),{timerange:l}=i.global,{timerange:d}=i.timeline;Object(s.useEffect)((()=>{((e,t)=>e&&t&&t!==e&&Object(y.e)(e))(e,n)&&("relative"===d.kind&&t(c.b.setRelativeRangeDatePicker({...d,from:Object(f.c)(d.fromStr),to:Object(f.c)(d.toStr,{roundUp:!0}),id:o.a.timeline})),"relative"===l.kind&&t(c.b.setRelativeRangeDatePicker({...l,from:Object(f.c)(l.fromStr),to:Object(f.c)(l.toStr,{roundUp:!0}),id:o.a.global})))}),[e,n,t,d,l])})(),(()=>{const e=Object(r.useDispatch)(),t=Object(p.a)("timelineEsqlTabDisabled"),n=Object(s.useCallback)((n=>{null!=n&&Object(x.h)({activeTimelineTab:n.activeTab===E.g.esql&&t?E.g.query:n.activeTab,duplicate:!1,graphEventId:n.graphEventId,timelineId:n.id,openTimeline:n.isOpen,updateIsLoading:t=>e(j.a.updateIsLoading(t)),updateTimeline:Object(x.b)(e),savedSearchId:n.savedSearchId})}),[e,t]);Object(s.useEffect)((()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get(C.timeline);if(!e)return;const t=Object(h.safeDecode)(e);n(t)};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[n]),Object(i.b)(C.timeline,n)})(),(()=>{const e=Object(i.d)(C.timeline),t=Object(s.useMemo)((()=>j.b.getTimelineByIdSelector()),[]),{activeTab:n,graphEventId:a,show:r,savedObjectId:o,savedSearchId:l}=Object(O.b)((e=>{var n;return null!==(n=t(e,E.f.active))&&void 0!==n?n:{}}));Object(s.useEffect)((()=>{const t={...o?{id:o}:{},isOpen:r,activeTab:n,graphEventId:null!=a?a:"",savedSearchId:l||void 0};e(t)}),[n,a,o,r,e,l])})(),(()=>{var e;const t=Object(s.useMemo)((()=>j.b.getTimelineByIdSelector()),[]),n=Object(O.b)((e=>t(e,E.f.active))),{search:a}=Object(S.useLocation)(),i=b()(a),o=null!==(e=null==n?void 0:n.savedObjectId)&&void 0!==e?e:"",l=Object(r.useDispatch)(),[u,c]=Object(s.useMemo)((()=>{const e=k({urlKey:C.timeline,search:null!=i?i:""}),t=k({urlKey:C.timeline,search:a});return null!=e&&null!=t?[Object(h.safeDecode)(e),Object(h.safeDecode)(t)]:[null,null]}),[i,a]),d=null==u?void 0:u.id,{id:p,activeTab:m,graphEventId:f}=c||{};Object(s.useEffect)((()=>{p&&p!==d&&p!==o&&Object(x.h)({activeTimelineTab:null!=m?m:E.g.query,duplicate:!1,graphEventId:f,timelineId:p,openTimeline:!0,updateIsLoading:e=>l(j.a.updateIsLoading(e)),updateTimeline:Object(x.b)(l)})}),[o,l,d,p,m,f])})(),(()=>{const[e]=Object(l.o)(T.nb),[t,n]=Object(s.useState)(null),[a,o]=Object(s.useState)(!1),u=Object(r.useDispatch)(),c=w.j.getTableByIdSelector(),d=Object(O.b)((e=>{var t;return null!==(t=c(e,w.e.alertsOnAlertsPage))&&void 0!==t?t:w.q})),p=Object(s.useCallback)((t=>{!e&&null!=t&&t.panelView&&n(t)}),[e]),m=Object(s.useCallback)((()=>{const{initialized:n,isLoading:a,totalCount:i,additionalFilters:r}=d,s=n&&!a&&i>0;!e&&t&&(r&&r.showBuildingBlockAlerts||u(w.h.updateShowBuildingBlockAlertsFilter({id:w.e.alertsOnAlertsPage,showBuildingBlockAlerts:!0})),s&&(o(!0),u(w.h.toggleDetailPanel({id:w.e.alertsOnAlertsPage,...t}))))}),[d,u,e,t]);Object(s.useEffect)((()=>{a||m()}),[a,m]);const f=e?"":C.eventFlyout;Object(i.b)(f,p)})(),(()=>{const e=Object(i.d)(C.eventFlyout),{pathname:t}=Object(S.useLocation)(),n=Object(r.useDispatch)(),a=w.j.getTableByIdSelector(),{expandedDetail:o}=Object(O.b)((e=>{var t;return null!==(t=a(e,w.e.alertsOnAlertsPage))&&void 0!==t?t:w.q}));Object(s.useEffect)((()=>{var a;const i=t===T.d;i&&null!=o&&null!=o&&o.query?e(o.query.panelView?o.query:null):!i&&null!=o&&null!==(a=o.query)&&void 0!==a&&a.panelView&&(n(w.h.toggleDetailPanel({id:w.e.alertsOnAlertsPage})),e(null))}),[n,o,t,e])})()},C={appQuery:"query",eventFlyout:a.a,filters:"filters",savedQuery:"savedQuery",sourcerer:"sourcerer",timeline:"timeline",timerange:"timerange",pageFilter:"pageFilters",rulesTable:"rulesTable"}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var a=n(111);const i=a.z.enum(["going to run","running","partial failure","failed","succeeded"]),r=i.enum,s=a.z.number().int()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(50),i=n(76),r=n(177);const s=["elastic-assistant, load-connectors"],o=({http:e,toasts:t})=>Object(a.useQuery)(s,(async()=>(await Object(i.loadAllActions)({http:e})).filter((e=>!e.isMissingSecrets&&[".bedrock",".gen-ai"].includes(e.actionTypeId)))),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:r.o}))}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(123),r=n(168),s=n(222);const o={id:r.a,messages:[],apiConfig:{},theme:{title:r.c,titleIcon:"logoSecurity",assistant:{name:r.b,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}}},l=()=>{const{allSystemPrompts:e,assistantTelemetry:t,setConversations:n}=Object(i.b)(),r=Object(a.useCallback)((e=>{let t=[];return n((n=>{const a=n[e];if(null!=a){t=a.messages.slice(0,a.messages.length-1);const i={...a,messages:t};return{...n,[e]:i}}return n})),t}),[n]);return{amendMessage:Object(a.useCallback)((({conversationId:e,content:t})=>{n((n=>{const a=n[e];if(null!=a){const{messages:i,...r}=a,s=i[i.length-1],o={...r,messages:s?[...i.slice(0,-1),{...s,content:t}]:[...i]};return{...n,[e]:o}}return n}))}),[n]),appendMessage:Object(a.useCallback)((({conversationId:e,message:a})=>{null==t||t.reportAssistantMessageSent({conversationId:e,role:a.role});let i=[];return n((t=>{const n=t[e];if(null!=n){i=[...n.messages,a];const r={...n,messages:i};return{...t,[e]:r}}return t})),i}),[t,n]),appendReplacements:Object(a.useCallback)((({conversationId:e,replacements:t})=>{let a=t;return n((n=>{const i=n[e];if(null!=i){a={...i.replacements,...t};const r={...i,replacements:a};return{...n,[e]:r}}return n})),a}),[n]),clearConversation:Object(a.useCallback)((t=>{n((n=>{var a;const i=n[t],r=null===(a=Object(s.b)({allSystemPrompts:e,conversation:i}))||void 0===a?void 0:a.id;if(null!=i){const e={...i,apiConfig:{...i.apiConfig,defaultSystemPromptId:r},messages:[],replacements:void 0};return{...n,[t]:e}}return n}))}),[e,n]),createConversation:Object(a.useCallback)((({conversationId:t,messages:a})=>{var i;const r=null===(i=Object(s.b)({allSystemPrompts:e,conversation:void 0}))||void 0===i?void 0:i.id,l={...o,apiConfig:{...o.apiConfig,defaultSystemPromptId:r},id:t,messages:null!=a?a:[]};return n((e=>{if(null!=e[t])throw new Error("Conversation already exists!");return{...e,[t]:{...l}}})),l}),[e,n]),deleteConversation:Object(a.useCallback)((e=>{let t;return n((n=>{const{[e]:a,...i}=n;return t=a,null!=a?i:n})),t}),[n]),removeLastMessage:r,setApiConfig:Object(a.useCallback)((({conversationId:e,apiConfig:t})=>{n((n=>{const a=n[e];if(null!=a){const i={...a,apiConfig:t};return{...n,[e]:i}}return n}))}),[n]),setConversation:Object(a.useCallback)((({conversation:e})=>{n((t=>({...t,[e.id]:e})))}),[n])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));const a=e=>{const t=[...e.matchAll(/```(\w+)?\s([\s\S]*?)```/g)],n={eql:["Event Query Language","EQL sequence query","EQL"],esql:["Elasticsearch Query Language","ESQL","ES|QL","SQL"],kql:["Kibana Query Language","KQL Query","KQL"],dsl:["Elasticsearch QueryDSL","Elasticsearch Query DSL","Elasticsearch DSL","Query DSL","DSL"]};return t.map((t=>{let a=t[1]||"no-type";if("no-type"===a||"json"===a){const i=t.index||0,r=e.slice(0,i);for(const[e,t]of Object.entries(n))if(t.some((e=>r.toLowerCase().includes(e.toLowerCase())))){a=e;break}}const i=t[2].trim(),r=t.index||0;return{type:a,content:i,start:r,end:r+t[0].length}}))},i=({allSystemPrompts:e,conversation:t})=>{var n;const a=e.find((e=>{var n;return e.id===(null==t||null===(n=t.apiConfig)||void 0===n?void 0:n.defaultSystemPromptId)})),i=e.find((e=>e.isNewConversationDefault));return null!==(n=null!=a?a:i)&&void 0!==n?n:null==e?void 0:e[0]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e){return(e+1)%1e6};t.default=function(){return a.useReducer(i,0)[1]}},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return u}));var a=n(4);const i={ENABLE:`${a.l} singleRuleActions enable`,DISABLE:`${a.l} singleRuleActions disable`,DUPLICATE:`${a.l} singleRuleActions duplicate`,EXPORT:`${a.l} singleRuleActions export`,DELETE:`${a.l} singleRuleActions delete`,PREVIEW:`${a.l} singleRuleActions preview`,SAVE:`${a.l} singleRuleActions save`},r={ENABLE:`${a.l} bulkRuleActions enable`,DISABLE:`${a.l} bulkRuleActions disable`,DUPLICATE:`${a.l} bulkRuleActions duplicate`,EXPORT:`${a.l} bulkRuleActions export`,DELETE:`${a.l} bulkRuleActions delete`,EDIT:`${a.l} bulkRuleActions edit`},s={REFRESH:`${a.l} rulesTable refresh`,FILTER:`${a.l} rulesTable filter`,LOAD_PREBUILT:`${a.l} rulesTable loadPrebuilt`},o={SAVE:`${a.l} timeline save`,DUPLICATE:`${a.l} timeline duplicate`,DELETE:`${a.l} timeline delete`,BULK_DELETE:`${a.l} timeline bulkDelete`},l={OPEN_ANALYZER:`${a.l} alerts openAnalyzer`,OPEN_SESSION_VIEW:`${a.l} alerts openSessionView`,INVESTIGATE_IN_TIMELINE:`${a.l} alerts investigateInTimeline`},u={FIELD_SAVED:`${a.l} fieldBrowser fieldSaved`,FIELD_DELETED:`${a.l} fieldBrowser fieldDeleted`}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(45);const i=e=>{var t;return Boolean(null===(t=e.Endpoint.state)||void 0===t?void 0:t.isolation)},r=["http:","https:"],s=e=>{try{if(null!=e){if(""===e)return!1;{const t=new URL(e);if(r.includes(t.protocol)&&e.startsWith(`${t.protocol}//`))return!1}}}catch(e){}return!0};function o(e){return Object(a.isNumber)(e)||!Object(a.isEmpty)(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(188);let i;!function(e){e.lastSeen="lastSeen",e.hostName="hostName",e.success="success"}(i||(i={}));const r=a.a},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(48),l=n(17),u=n(119),c=n(196),d=n(118),p=n(189),m=n(122),f=n(113),g=n(112),b=n(138),y=n(149),v=n(116),h=n(167),E=n(460);const x=({timelineId:e,timelineType:t,onClick:n})=>{const a=Object(o.useDispatch)(),i=Object(r.useMemo)((()=>y.d.defaultDataViewSelector()),[]),{id:s,patternList:l}=Object(g.a)(i),{timelineFullScreen:f,setTimelineFullScreen:x}=Object(p.c)(),j=Object(g.a)(b.d.globalTimeRangeSelector),{resetDiscoverAppState:O}=Object(E.a)(),S=Object(r.useCallback)((({id:e,show:n,timeRange:i})=>{const r=null!=i?i:j;e===m.c.active&&f&&x(!1),a(y.a.setSelectedDataView({id:v.SourcererScopeName.timeline,selectedDataViewId:s,selectedPatterns:l})),a(d.a.createTimeline({columns:c.b,dataViewId:s,id:e,indexNames:l,show:n,timelineType:t,updated:void 0})),a(b.b.addLinkTo([u.a.global,u.a.timeline])),a(h.a.addNotes({notes:[]})),i&&a(b.b.removeLinkTo([u.a.timeline,u.a.global])),"absolute"===r.kind?a(b.b.setAbsoluteRangeDatePicker({...r,id:u.a.timeline})):"relative"===r.kind&&a(b.b.setRelativeRangeDatePicker({...r,id:u.a.timeline}))}),[a,j,s,l,x,f,t]);return Object(r.useCallback)((a=>{S({id:e,show:!0,timelineType:t,timeRange:null==a?void 0:a.timeRange}),"function"==typeof n&&n(),O()}),[S,e,t,n,O])},j=({timelineId:e,timelineType:t,onClick:n})=>{const a=x({timelineId:e,timelineType:t,onClick:n});return{getButton:Object(r.useCallback)((({outline:e,title:n,iconType:r="plusInCircle",fill:o=!0})=>{const u={iconType:r,onClick:()=>a(),fill:o},c=t===f.l.template?"template-timeline-new":"timeline-new",{fill:d,...p}=u;return e?s.a.createElement(l.EuiButton,i()({"data-test-subj":`${c}-with-border`},u),n):s.a.createElement(l.EuiButtonEmpty,i()({"data-test-subj":c,color:"text"},p),n)}),[a,t])}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n(4);var a=n(185);const i=(e,t)=>`/${e}${Object(a.a)(t)}`,r=(e,t)=>`/name/${e}${Object(a.a)(t)}`,s=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`},function(e,t,n){"use strict";let a,i;n.r(t),n.d(t,"HostsType",(function(){return a})),n.d(t,"HostsTableType",(function(){return i})),function(e){e.page="page",e.details="details"}(a||(a={})),function(e){e.authentications="authentications",e.hosts="allHosts",e.events="events",e.uncommonProcesses="uncommonProcesses",e.anomalies="anomalies",e.risk="hostRisk",e.sessions="sessions"}(i||(i={}))},,function(e,t,n){"use strict";n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u}));const a=["started","opened"],i=["starting","stopping","opening","closing"],r=["deleted","failed"],s=(e,t)=>a.includes(e)&&a.includes(t),o=(e,t)=>i.includes(e)||i.includes(t),l=(e,t)=>r.includes(e)||r.includes(t),u=e=>"machine_learning"===e},function(e,t,n){"use strict";n.d(t,"a",(function(){return fe})),n.d(t,"f",(function(){return ge})),n.d(t,"c",(function(){return be})),n.d(t,"d",(function(){return ye})),n.d(t,"e",(function(){return ve})),n.d(t,"b",(function(){return he}));var a=n(2),i=n.n(a),r=n(144),s=n(44),o=n.n(s),l=n(17),u=(n(13),n(47)),c=n(5),d=n(201),p=n(427);const m=`${p.a}VisualizeTab`,f=`${m}ButtonGroup`,g=`${m}SessionViewButton`,b=`${m}GraphAnalyzerButton`,y=`${p.a}InsightsTab`,v=`${y}ButtonGroup`,h=`${y}EntitiesButton`,E=`${y}ThreatIntelligenceButton`,x=`${y}PrevalenceButton`,j=`${y}CorrelationsButton`,O=`${p.a}InvestigationsTabContent`,S=`${p.a}ResponseTabContent`;var k=n(183),w=n(906),T=n(866),I=n(127);const C="analyze_graph",M=()=>{const{eventId:e}=Object(d.b)(),t="flyout",{from:n,to:r,shouldUpdate:s,selectedPatterns:o}=Object(T.a)(Object(I.isActiveTimeline)(t)),l=Object(a.useMemo)((()=>({from:n,to:r})),[n,r]);return i.a.createElement("div",{"data-test-subj":k.a},i.a.createElement(w.a,{databaseDocumentID:e,resolverComponentInstanceID:t,indices:o,shouldUpdate:s,filters:l}))};M.displayName="AnalyzeGraph";var _=n(313),A=n(192),P=n(110);const F="session-view",D=()=>{const{sessionView:e}=Object(P.i)().services,{getFieldsData:t,indexName:n}=Object(d.b)(),a=Object(A.a)(t(_.b)),r=Object(A.a)(t(_.c))||"",s=Object(A.a)(t(_.d))||"",o=a||n;return i.a.createElement("div",{"data-test-subj":k.z},e.getSessionView({index:o,sessionEntityId:r,sessionStartTime:s,isFullScreen:!0}))};D.displayName="SessionView";var N=n(224),R=n(184);const L=[{id:F,label:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.sessionViewButtonLabel",defaultMessage:"Session View"}),"data-test-subj":g},{id:C,label:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.analyzerGraphButtonLabel",defaultMessage:"Analyzer Graph"}),"data-test-subj":b}],z=Object(a.memo)((()=>{var e,t,n,s,o;const{eventId:u,indexName:p,scopeId:m}=Object(d.b)(),{panels:g,openLeftPanel:b}=Object(r.d)(),[y,v]=Object(a.useState)(null!==(e=null===(t=g.left)||void 0===t||null===(n=t.path)||void 0===n?void 0:n.subTab)&&void 0!==e?e:F),{startTransaction:h}=Object(R.b)(),E=Object(a.useCallback)((e=>{v(e),e===C&&h({name:N.a.OPEN_ANALYZER}),b({id:fe,path:{tab:ge,subTab:e},params:{id:u,indexName:p,scopeId:m}})}),[h,u,p,m,b]);return Object(a.useEffect)((()=>{var e,t,n,a;null!==(e=g.left)&&void 0!==e&&null!==(t=e.path)&&void 0!==t&&t.subTab&&v(null===(n=g.left)||void 0===n||null===(a=n.path)||void 0===a?void 0:a.subTab)}),[null===(s=g.left)||void 0===s||null===(o=s.path)||void 0===o?void 0:o.subTab]),i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiButtonGroup,{color:"primary",name:"coarsness",legend:c.i18n.translate("xpack.securitySolution.flyout.left.visualize.buttonGroupLegendLabel",{defaultMessage:"Visualize options"}),options:L,idSelected:y,onChange:e=>E(e),buttonSize:"compressed",isFullWidth:!0,"data-test-subj":f}),i.a.createElement(l.EuiSpacer,{size:"m"}),y===F&&i.a.createElement(D,null),y===C&&i.a.createElement(M,null))}));z.displayName="VisualizeTab";var B=n(907),q=n(404),$=n(394);const V=()=>{const{dataFormattedForFieldBrowser:e,isPreview:t}=Object(d.b)(),{loading:n,error:a,basicAlertData:r,ruleNote:s}=Object(B.a)({dataFormattedForFieldBrowser:e});return i.a.createElement("div",{"data-test-subj":k.m},t?i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.previewMessage",defaultMessage:"Investigation guide is not available in alert preview."}):n?i.a.createElement($.a,{"data-test-subj":k.l}):!a&&r.ruleId&&s?i.a.createElement(q.b,{basicData:r,ruleNote:s,showTitle:!1,showFullView:!0}):i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.noDataDescription",defaultMessage:"There's no investigation guide for this rule. {documentation} to add one.",values:{documentation:i.a.createElement(l.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/rules-ui-management.html#edit-rules-settings",target:"_blank"},i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigation.noDataLinkText",defaultMessage:"Edit the rule's settings"}))}}))};V.displayName="InvestigationGuide";const U=Object(a.memo)((()=>i.a.createElement(l.EuiPanel,{"data-test-subj":O,hasShadow:!1},i.a.createElement(V,null))));U.displayName="InvestigationTab";var H=n(416),Z=n(965),G=n(909),Q=n(959);const W=[{id:H.a,label:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entitiesButtonLabel",defaultMessage:"Entities"}),"data-test-subj":h},{id:Z.a,label:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.threatIntelligenceButtonLabel",defaultMessage:"Threat intelligence"}),"data-test-subj":E},{id:G.a,label:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalenceButtonLabel",defaultMessage:"Prevalence"}),"data-test-subj":x},{id:Q.a,label:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlationsButtonLabel",defaultMessage:"Correlations"}),"data-test-subj":j}],K=Object(a.memo)((()=>{var e,t,n;const{eventId:s,indexName:o,scopeId:u}=Object(d.b)(),{openLeftPanel:p,panels:m}=Object(r.d)(),f=null!==(e=null===(t=m.left)||void 0===t||null===(n=t.path)||void 0===n?void 0:n.subTab)&&void 0!==e?e:H.a,g=Object(a.useCallback)((e=>{p({id:fe,path:{tab:be,subTab:e},params:{id:s,indexName:o,scopeId:u}})}),[s,o,u,p]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiButtonGroup,{color:"primary",name:"coarsness",legend:c.i18n.translate("xpack.securitySolution.flyout.left.insights.buttonGroupLegendLabel",{defaultMessage:"Insights options"}),options:W,idSelected:f,onChange:g,buttonSize:"compressed",isFullWidth:!0,"data-test-subj":v}),i.a.createElement(l.EuiSpacer,{size:"m"}),f===H.a&&i.a.createElement(H.b,null),f===Z.a&&i.a.createElement(Z.b,null),f===G.a&&i.a.createElement(G.b,null),f===Q.a&&i.a.createElement(Q.b,null))}));K.displayName="InsightsTab";const J=`${p.a}VisualizeTab`,Y=`${p.a}InsightsTab`,X=`${p.a}InvestigationTab`,ee=`${p.a}ResponseTab`;var te=n(130),ne=n(1303),ae=n(1324);const ie=o.a.div.withConfig({displayName:"ExtendedFlyoutWrapper",componentId:"sc-qxbnld-0"})(["figure{background-color:white"]),re=()=>{const{searchHit:e,dataAsNestedObject:t,isPreview:n}=Object(d.b)(),a=Object(te.a)("endpointResponseActionsEnabled"),r=Object(ae.a)({rawEventData:e,ecsData:t}),s=Object(ne.a)({rawEventData:e,ecsData:t});return i.a.createElement("div",{"data-test-subj":k.x},n?i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.previewMessage",defaultMessage:"Response is not available in alert preview."}):i.a.createElement(i.a.Fragment,null,i.a.createElement(l.EuiTitle,{size:"xxxs"},i.a.createElement("h5",null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.responseTitle",defaultMessage:"Responses"}))),i.a.createElement(l.EuiSpacer,{size:"s"}),i.a.createElement(ie,null,a?null==r?void 0:r.content:null==s?void 0:s.content)))};re.displayName="ResponseDetails";const se=Object(a.memo)((()=>i.a.createElement(l.EuiPanel,{"data-test-subj":S,hasShadow:!1},i.a.createElement(re,null))));se.displayName="ResponseTab";const oe=[{id:"visualize","data-test-subj":J,name:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.visualize.tabLabel",defaultMessage:"Visualize"}),content:i.a.createElement(z,null),visible:!1},{id:"insights","data-test-subj":Y,name:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.tabLabel",defaultMessage:"Insights"}),content:i.a.createElement(K,null),visible:!0},{id:"investigation","data-test-subj":X,name:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.investigations.tabLabel",defaultMessage:"Investigation"}),content:i.a.createElement(U,null),visible:!0},{id:"response","data-test-subj":ee,name:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.left.response.tabLabel",defaultMessage:"Response"}),content:i.a.createElement(se,null),visible:!0}];var le=n(1111);const ue=Object(a.memo)((({selectedTabId:e,setSelectedTabId:t})=>{const n=oe.filter((e=>e.visible)).map(((n,a)=>i.a.createElement(l.EuiTab,{onClick:()=>{return e=n.id,t(e);var e},isSelected:n.id===e,key:a,"data-test-subj":n["data-test-subj"]},n.name)));return i.a.createElement(ce,{$_css:Object(l.useEuiBackgroundColor)("subdued")},i.a.createElement(l.EuiTabs,{size:"l",expand:!0},n))}));ue.displayName="PanelHeader";var ce=o()(le.a).withConfig({displayName:"_StyledFlyoutHeader",componentId:"sc-1qgelk0-0"})(["background-color:",";padding-bottom:0 !important;border-block-end:none !important;"],(e=>e.$_css)),de=n(1067);const pe=({selectedTabId:e})=>{const t=Object(a.useMemo)((()=>{var t;return null===(t=oe.filter((e=>e.visible)).find((t=>t.id===e)))||void 0===t?void 0:t.content}),[e]);return i.a.createElement(me,{$_css:Object(l.useEuiBackgroundColor)("subdued")},t)};pe.displayName="PanelContent";var me=o()(de.a).withConfig({displayName:"_StyledFlyoutBody",componentId:"sc-1pfozwl-0"})(["background-color:",";"],(e=>e.$_css));const fe="document-details-left",ge="visualize",be="insights",ye="investigation",ve="response",he=Object(a.memo)((({path:e})=>{const{openLeftPanel:t}=Object(r.d)(),{eventId:n,indexName:s,scopeId:o}=Object(d.b)(),l=Object(a.useMemo)((()=>{var t;const n=oe.filter((e=>e.visible)),a=n[0].id;return e&&null!==(t=n.map((e=>e.id)).find((t=>t===e.tab)))&&void 0!==t?t:a}),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(ue,{selectedTabId:l,setSelectedTabId:e=>{t({id:fe,path:{tab:e},params:{id:n,indexName:s,scopeId:o}})}}),i.a.createElement(pe,{selectedTabId:l}))}));he.displayName="LeftPanel"},function(e,t,n){"use strict";var a=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function i(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!((i=e[n])===(r=t[n])||a(i)&&a(r)))return!1;var i,r;return!0}e.exports=function(e,t){void 0===t&&(t=i);var n=null;function a(){for(var a=[],i=0;i<arguments.length;i++)a[i]=arguments[i];if(n&&n.lastThis===this&&t(a,n.lastArgs))return n.lastResult;var r=e.apply(this,a);return n={lastResult:r,lastArgs:a,lastThis:this},r}return a.clear=function(){n=null},a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef();return a.useEffect((function(){t.current=e})),t.current}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(17),i=n(5),r=n(47),s=n(2),o=n.n(s);const l=({count:e})=>{const[t,n,l]=Object(s.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const n=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),a={compactThousands:i.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},r=new Map([[1,""],[1e3,a.compactThousands],[1e6,a.compactMillions],[1e9,a.compactBillions],[1e12,a.compactTrillions]]),s=i.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),o=null!==(t=r.get(n))&&void 0!==t?t:"";return[Math.floor(e/n),o,e/n%1>Number.EPSILON?s:""]}(e||0)),[e]);return null==e?null:0===e?o.a.createElement(o.a.Fragment,null,0):o.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:o.a.createElement(a.EuiI18nNumber,{value:t}),scale:n,hasRemainder:l}})},u=o.a.memo(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n(185);const i=e=>`${Object(a.a)(e)}`,r=e=>`${Object(a.a)(e)}`,s=(e,t)=>`/id/${e}${Object(a.a)(t)}`,o=(e,t,n)=>`/id/${e}/${t}${Object(a.a)(n)}`,l=(e,t)=>`/id/${e}/edit${Object(a.a)(t)}`},,function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));const a="cellAction-filter",i="cellAction-copy";let r;!function(e){e.HOVER_DOWN="hover-down",e.HOVER_RIGHT="hover-right",e.INLINE="inline"}(r||(r={}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g}));var a=n(45),i=n(234),r=n.n(i),s=n(2),o=n(110),l=n(555),u=n(334),c=n(117);const d=e=>Object(a.keyBy)("name",function(e){const t=[];for(const n of Object.values(e))n.fields&&t.push(...Object.values(n.fields));return t}(e)),p=r()(((e,t)=>t&&t.length>0?{fields:t.map((e=>Object(a.pick)(["name","searchable","type","aggregatable","esTypes","subType","conflictDescriptions"],e))),title:e}:{fields:[],title:e}),((e,t)=>e[0]===t[0]&&e[1].length===t[1].length)),m={},f={fields:[],title:""},g=(e,t=!1,n="indexFields")=>{const{data:i}=Object(o.i)().services,r=Object(s.useRef)(new AbortController),d=Object(s.useRef)([]),[g,b]=Object(s.useState)({browserFields:m,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),{addError:y}=Object(c.a)(),v=Object(s.useCallback)((t=>{(async()=>{try{b({...g,loading:!0}),r.current=new AbortController;const e=await i.dataViews.create({title:t.join(","),allowNoIndex:!0}),n=e.toSpec(),{browserFields:a}=Object(u.a)(t,n.fields);d.current=e.getIndexPattern().split(","),b({loading:!1,dataView:n,browserFields:a,indexes:e.getIndexPattern().split(","),indexExists:e.getIndexPattern().split(",").length>0,indexPatterns:p(e.getIndexPattern(),e.fields)})}catch(t){b({browserFields:m,indexes:e,indexExists:!0,indexPatterns:f,dataView:void 0,loading:!1}),y(null==t?void 0:t.message,{title:l.a})}})()}),[y,i.dataViews,e,g]);return Object(s.useEffect)((()=>(Object(a.isEmpty)(e)||Object(a.isEqual)(d.current,e)||v(e),()=>{r.current.abort()})),[e,d]),[g.loading,g]}},function(e,t,n){e.exports=n(24)(2967)},function(e,t,n){"use strict";n.d(t,"B",(function(){return c})),n.d(t,"A",(function(){return p})),n.d(t,"z",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"s",(function(){return b})),n.d(t,"v",(function(){return y})),n.d(t,"q",(function(){return v})),n.d(t,"r",(function(){return h})),n.d(t,"o",(function(){return E})),n.d(t,"p",(function(){return x})),n.d(t,"j",(function(){return j})),n.d(t,"u",(function(){return O})),n.d(t,"t",(function(){return S})),n.d(t,"x",(function(){return k})),n.d(t,"w",(function(){return w})),n.d(t,"m",(function(){return T})),n.d(t,"n",(function(){return I})),n.d(t,"b",(function(){return C})),n.d(t,"k",(function(){return M})),n.d(t,"l",(function(){return _})),n.d(t,"c",(function(){return A})),n.d(t,"f",(function(){return P})),n.d(t,"g",(function(){return F})),n.d(t,"d",(function(){return D})),n.d(t,"e",(function(){return N})),n.d(t,"h",(function(){return R})),n.d(t,"y",(function(){return L}));var a=n(17),i=n(345),r=n(44),s=n.n(r),o=n(114),l=n(145),u=n(296);const c=s.a.div.attrs((({className:e=""})=>({className:`securitySolutionTimeline__container ${e}`}))).withConfig({displayName:"TimelineContainer",componentId:"sc-1fubmdc-0"})(["height:100%;display:flex;flex-direction:column;position:relative;"]),d="securitySolutionTimeline__body",p=Object(r.createGlobalStyle)(["body."," .","{overflow:hidden;}"],o.e,d),m=s.a.div.attrs((({className:e=""})=>({className:`${d} ${e}`}))).withConfig({displayName:"TimelineBody",componentId:"sc-1fubmdc-1"})(["height:auto;overflow:auto;scrollbar-width:thin;flex:1;display:block;&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner));m.displayName="TimelineBody";const f="siemEventsTable",g=s.a.div.attrs((({className:e="",$columnCount:t,columnWidths:n,$activePage:a,$rowCount:i,$totalPages:r})=>({"aria-label":Object(u.c)({activePage:a+1,totalPages:r}),"aria-colcount":`${t}`,"aria-rowcount":`${i+1}`,className:`siemEventsTable ${e}`,role:"grid",style:{minWidth:`${n}px`},tabindex:"-1"}))).withConfig({displayName:"EventsTable",componentId:"sc-1fubmdc-2"})(["padding:3px;"]),b=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__thead ${e}`,role:"rowgroup"}))).withConfig({displayName:"EventsThead",componentId:"sc-1fubmdc-3"})(["background-color:",";border-bottom:"," solid ",";position:sticky;top:0;z-index:",";"],(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiBorderWidthThick),(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiZLevel1)),y=s.a.div.attrs((({className:e})=>({"aria-rowindex":"1",className:`siemEventsTable__trHeader ${e}`,role:"row"}))).withConfig({displayName:"EventsTrHeader",componentId:"sc-1fubmdc-4"})(["display:flex;"]),v=s.a.div.attrs((({className:e=""})=>({"aria-colindex":`${l.a}`,className:`siemEventsTable__thGroupActions ${e}`,role:"columnheader",tabIndex:"0"}))).withConfig({displayName:"EventsThGroupActions",componentId:"sc-1fubmdc-5"})(["display:flex;flex:0 0 ",";min-width:0;padding-left:",";"],(({actionsColumnWidth:e,isEventViewer:t})=>`${t?e:e+4}px`),(({isEventViewer:e})=>e?"0;":"4px;")),h=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__thGroupData ${e}`}))).withConfig({displayName:"EventsThGroupData",componentId:"sc-1fubmdc-6"})(["display:flex;> div:hover .siemEventsHeading__handle{display:",";opacity:1;visibility:visible;}"],(({isDragging:e})=>e?"none":"block")),E=s.a.div.attrs((({className:e="",role:t="columnheader"})=>({className:`siemEventsTable__th ${e}`,role:t}))).withConfig({displayName:"EventsTh",componentId:"sc-1fubmdc-7"})(["align-items:center;display:flex;flex-shrink:0;min-width:0;.siemEventsTable__thGroupActions &:first-child:last-child{flex:1;}.siemEventsTable__thGroupData &:hover{background-color:",";cursor:move;cursor:grab;}> div:focus{outline:0;}[data-rbd-placeholder-context-id]{display:none !important;}"],(({theme:e})=>e.eui.euiTableHoverColor)),x=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__thContent ${e}`}))).withConfig({displayName:"EventsThContent",componentId:"sc-1fubmdc-8"})(["font-size:",";font-weight:",";line-height:",";min-width:0;padding:",";text-align:",";width:",";> button.euiButtonIcon,> .euiToolTipAnchor > button.euiButtonIcon{margin-left:",";}"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiFontWeightSemiBold),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS),(({textAlign:e})=>e),(({width:e})=>null!=e?`${e}px`:"100%"),(({theme:e})=>`-${e.eui.euiSizeXS}`)),j=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__tbody ${e}`,role:"rowgroup"}))).withConfig({displayName:"EventsTbody",componentId:"sc-1fubmdc-9"})(["overflow-x:hidden;"]),O=s.a.div.attrs((({className:e="",$ariaRowindex:t})=>({"aria-rowindex":`${t}`,className:`siemEventsTable__trGroup ${e}`,role:"row"}))).withConfig({displayName:"EventsTrGroup",componentId:"sc-1fubmdc-10"})(["border-bottom:"," solid ",";",";",";",";&:hover{background-color:",";}",""],(({theme:e})=>e.eui.euiBorderWidthThin),(({theme:e})=>e.eui.euiColorLightShade),(({theme:e,eventType:t,isEvenEqlSequence:n,showLeftBorder:a})=>a?`border-left: 4px solid\n    ${"raw"===t?e.eui.euiColorLightShade:"eql"===t&&n?e.eui.euiColorPrimary:"eql"!==t||n?e.eui.euiColorWarning:e.eui.euiColorAccent}`:""),(({isBuildingBlockType:e})=>e?"background: repeating-linear-gradient(127deg, rgba(245, 167, 0, 0.2), rgba(245, 167, 0, 0.2) 1px, rgba(245, 167, 0, 0.05) 2px, rgba(245, 167, 0, 0.05) 10px);":""),(({eventType:e,isEvenEqlSequence:t})=>"eql"===e?t?"background: repeating-linear-gradient(127deg, rgba(0, 107, 180, 0.2), rgba(0, 107, 180, 0.2) 1px, rgba(0, 107, 180, 0.05) 2px, rgba(0, 107, 180, 0.05) 10px);":"background: repeating-linear-gradient(127deg, rgba(221, 10, 115, 0.2), rgba(221, 10, 115, 0.2) 1px, rgba(221, 10, 115, 0.05) 2px, rgba(221, 10, 115, 0.05) 10px);":""),(({theme:e})=>e.eui.euiTableHoverColor),(({isExpanded:e,theme:t})=>e&&`\n    background: ${t.eui.euiTableSelectedColor};\n\n    &:hover {\n      ${t.eui.euiTableHoverSelectedColor}\n    }\n  `)),S=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__trData ${e}`}))).withConfig({displayName:"EventsTrData",componentId:"sc-1fubmdc-11"})(["display:flex;"]),k=s.a.div.attrs((({width:e})=>({role:"dialog",style:{width:e-40+"px"}}))).withConfig({displayName:"EventsTrSupplementContainer",componentId:"sc-1fubmdc-12"})([""]),w=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__trSupplement ${e}`}))).withConfig({displayName:"EventsTrSupplement",componentId:"sc-1fubmdc-13"})(["display:",";font-size:",";line-height:",";padding-left:",";.euiAccordion + div{background-color:",";padding:0 ",";border:1px solid ",";border-radius:",";}"],(({$display:e})=>null!=e?e:"inline-block"),(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeM),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiSizeS),(({theme:e})=>e.eui.euiColorLightShade),(({theme:e})=>e.eui.euiSizeXS)),T=s.a.div.attrs((({className:e=""})=>({"aria-colindex":`${l.a}`,className:`siemEventsTable__tdGroupActions ${e}`,role:"gridcell"}))).withConfig({displayName:"EventsTdGroupActions",componentId:"sc-1fubmdc-14"})(["align-items:center;display:flex;flex:0 0 ",";min-width:0;"],(({width:e})=>`${e}px`)),I=s.a.div.attrs((({className:e=""})=>({className:`siemEventsTable__tdGroupData ${e}`}))).withConfig({displayName:"EventsTdGroupData",componentId:"sc-1fubmdc-15"})(["display:flex;"]),C="siemEventsTable__td",M=s.a.div.attrs((({className:e="",$ariaColumnIndex:t,width:n})=>{const a={className:`siemEventsTable__td ${e}`,role:"gridcell",style:{flexBasis:n?`${n}px`:"auto"}};return null!=t?{...a,"aria-colindex":`${t}`}:a})).withConfig({displayName:"EventsTd",componentId:"sc-1fubmdc-16"})(["align-items:center;display:flex;flex-shrink:0;min-width:0;.siemEventsTable__tdGroupActions &:first-child:last-child{flex:1;}"]),_=s.a.div.attrs((({className:e})=>({className:`siemEventsTable__tdContent ${null!=e?e:""}`}))).withConfig({displayName:"EventsTdContent",componentId:"sc-1fubmdc-17"})(["font-size:",";line-height:",";min-width:0;padding:",";text-align:",";width:",";button.euiButtonIcon{margin-left:",";}"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiLineHeight),(({theme:e})=>e.eui.euiSizeXS),(({textAlign:e})=>e),(({width:e})=>null!=e?`${e}px`:"100%"),(({theme:e})=>`-${e.eui.euiSizeXS}`)),A=s.a.div.attrs((({className:e=""})=>({className:`siemEventsHeading ${e}`}))).withConfig({displayName:"EventsHeading",componentId:"sc-1fubmdc-18"})(["align-items:center;display:flex;&:hover{cursor:",";}"],(({isLoading:e})=>e?"wait":"grab")),P=s.a.button.attrs((({className:e=""})=>({className:`siemEventsHeading__title siemEventsHeading__title--aggregatable ${e}`,type:"button"}))).withConfig({displayName:"EventsHeadingTitleButton",componentId:"sc-1fubmdc-19"})(["align-items:center;display:flex;font-weight:inherit;min-width:0;&:hover,&:focus{color:",";text-decoration:underline;}&:hover{cursor:pointer;}& > * + *{margin-left:",";}"],(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiSizeXS)),F=s.a.span.attrs((({className:e})=>({className:`siemEventsHeading__title siemEventsHeading__title--notAggregatable ${e}`}))).withConfig({displayName:"EventsHeadingTitleSpan",componentId:"sc-1fubmdc-20"})(["min-width:0;"]),D=s.a.div.attrs((({className:e=""})=>({className:`siemEventsHeading__extra ${e}`}))).withConfig({displayName:"EventsHeadingExtra",componentId:"sc-1fubmdc-21"})(["margin-left:auto;margin-right:2px;&.siemEventsHeading__extra--close{opacity:0;transition:all "," ease;visibility:hidden;.siemEventsTable__th:hover &{opacity:1;visibility:visible;}}"],(({theme:e})=>e.eui.euiAnimSpeedNormal)),N=s.a.div.attrs((({className:e=""})=>({className:`siemEventsHeading__handle ${e}`}))).withConfig({displayName:"EventsHeadingHandle",componentId:"sc-1fubmdc-22"})(["background-color:",";height:100%;opacity:0;transition:all "," ease;visibility:hidden;width:",";&:hover{background-color:",";cursor:col-resize;}"],(({theme:e})=>e.eui.euiBorderColor),(({theme:e})=>e.eui.euiAnimSpeedNormal),(({theme:e})=>e.eui.euiBorderWidthThick),(({theme:e})=>e.eui.euiColorPrimary)),R=s()(a.EuiLoadingSpinner).withConfig({displayName:"EventsLoading",componentId:"sc-1fubmdc-23"})(["margin:0 2px;vertical-align:middle;"]),L=s.a.div.attrs((({$isVisible:e=!1})=>({style:{display:e?"block":"none"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-1fubmdc-24"})([""])},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"j",(function(){return r})),n.d(t,"l",(function(){return s})),n.d(t,"k",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"g",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"d",(function(){return g}));var a=n(5);a.i18n.translate("xpack.securitySolution.timeline.properties.timelineDescription",{defaultMessage:"Timeline Description"});const i=a.i18n.translate("xpack.securitySolution.timeline.properties.addToFavoriteButtonLabel",{defaultMessage:"Add to favorites"}),r=a.i18n.translate("xpack.securitySolution.timeline.properties.removeFromFavoritesButtonLabel",{defaultMessage:"Remove from favorites"}),s=a.i18n.translate("xpack.securitySolution.timeline.properties.untitledTimelinePlaceholder",{defaultMessage:"Untitled timeline"}),o=a.i18n.translate("xpack.securitySolution.timeline.properties.untitledTemplatePlaceholder",{defaultMessage:"Untitled template"}),l=a.i18n.translate("xpack.securitySolution.timeline.properties.descriptionPlaceholder",{defaultMessage:"Add a description"}),u=a.i18n.translate("xpack.securitySolution.timeline.properties.notesButtonLabel",{defaultMessage:"Notes"}),c=a.i18n.translate("xpack.securitySolution.timeline.properties.newTimelineButtonLabel",{defaultMessage:"Create new Timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.properties.newTemplateTimelineButtonLabel",{defaultMessage:"Create new Timeline template"}),p=a.i18n.translate("xpack.securitySolution.timeline.properties.addTimelineButtonLabel",{defaultMessage:"Add new timeline or template"}),m=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToCaseButtonLabel",{defaultMessage:"Attach to case"}),f=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToNewCaseButtonLabel",{defaultMessage:"Attach to new case"}),g=a.i18n.translate("xpack.securitySolution.timeline.properties.attachToExistingCaseButtonLabel",{defaultMessage:"Attach to existing case"})},function(e,t,n){"use strict";let a,i,r,s,o,l,u,c,d;n.d(t,"c",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"g",(function(){return p.e})),function(e){e.inbound="inbound",e.outbound="outbound",e.internal="internal",e.external="external",e.incoming="incoming",e.outgoing="outgoing",e.listening="listening",e.unknown="unknown"}(a||(a={})),function(e){e.bytes_in="bytes_in",e.bytes_out="bytes_out",e.flows="flows",e.destination_ips="destination_ips",e.source_ips="source_ips"}(i||(i={})),function(e){e.client="client",e.destination="destination",e.server="server",e.source="source"}(r||(r={})),function(e){e.destination="destination",e.source="source"}(s||(s={})),function(e){e.dnsName="dnsName",e.queryCount="queryCount",e.uniqueDomains="uniqueDomains",e.dnsBytesIn="dnsBytesIn",e.dnsBytesOut="dnsBytesOut"}(o||(o={})),function(e){e.domains="domains",e.lastHost="lastHost",e.lastSourceIp="lastSourceIp",e.methods="methods",e.path="path",e.requestCount="requestCount",e.statuses="statuses"}(l||(l={})),function(e){e.dns="networkKpiDns",e.networkEvents="networkKpiNetworkEvents",e.tlsHandshakes="networkKpiTlsHandshakes",e.uniqueFlows="networkKpiUniqueFlows",e.uniquePrivateIps="networkKpiUniquePrivateIps"}(u||(u={})),function(e){e._id="_id"}(c||(c={})),function(e){e.name="name",e.count="count"}(d||(d={}));var p=n(150)},,function(e,t,n){"use strict";var a=n(141);n.d(t,"d",(function(){return a.N}));var i=n(148);n.d(t,"b",(function(){return i.a})),n.d(t,"c",(function(){return i.b})),n.d(t,"e",(function(){return i.g})),n.d(t,"f",(function(){return i.h})),n(365),n(368),n(369);var r=n(323);n.d(t,"a",(function(){return r.b})),n(367),n(366)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(111).z.enum(["asc","desc"]);a.enum},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return d}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.clearChat",{defaultMessage:"Clear chat"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.defaultAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedToggleLabel",{defaultMessage:"Show anonymized"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.settings.showAnonymizedTooltip",{defaultMessage:"Show the anonymized values sent to and from the assistant"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.submitMessage",{defaultMessage:"Submit message"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.apiErrorTitle",{defaultMessage:"An error occurred sending your message."}),c=a.i18n.translate("xpack.elasticAssistant.documentationLinks.ariaLabel",{defaultMessage:"Click to open Elastic Assistant documentation in a new tab"}),d=a.i18n.translate("xpack.elasticAssistant.documentationLinks.documentation",{defaultMessage:"documentation"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return p}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.youAreAHelpfulExpertAssistant",{defaultMessage:"You are a helpful, expert assistant who answers questions about Elastic Security."}),r=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.useTheFollowingContextToAnswer",{defaultMessage:"Use the following context to answer questions:"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.ifYouDontKnowTheAnswer",{defaultMessage:"Do not answer questions unrelated to Elastic Security."}),o=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroPersonality",{defaultMessage:"Provide the most detailed and relevant answer possible, as if you were relaying this information back to a cyber security expert."}),l=`${i} ${s}\n${r}`,u=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.defaultSystemPromptName",{defaultMessage:"Default system prompt"}),c=`${i} ${s}\n${o}\n${r}`,d=a.i18n.translate("xpack.elasticAssistant.assistant.content.prompts.system.superheroSystemPromptName",{defaultMessage:"Enhanced system prompt"}),p=e=>`CONTEXT:\n"""\n${e}\n"""`},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={SYSTEM_PROMPT_SELECTOR:"systemPromptSelector",CONVERSATIONS_MULTISELECTOR:"conversationMultiSelector",ADD_SYSTEM_PROMPT:"addSystemPrompt",PROMPT_SUPERSELECT:"promptSuperSelect",CONVERSATIONS_MULTISELECTOR_OPTION:e=>`conversationMultiSelectorOption-${e}`,SETTINGS_MODAL:"settingsModal",SYSTEM_PROMPT_MODAL:{ID:"systemPromptModal",PROMPT_TEXT:"systemPromptModalPromptText",TOGGLE_ALL_DEFAULT_CONVERSATIONS:"systemPromptModalToggleDefaultConversations",SAVE:"systemPromptModalSave",CANCEL:"systemPromptModalCancel"}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a=e=>{if(null==e||!e.isPreconfigured)return null==e?void 0:e.config},i=e=>{var t;return null!==(t=e.actionTypeTitle)&&void 0!==t?t:e.id}},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return d}));var a=n(73),i=n(249),r=n(498),s=n(374);const o=async({alerts:e,alertsIndexPattern:t,allow:n,allowReplacement:o,assistantLangChain:l,assistantStreamingEnabled:u,http:c,messages:d,onNewReplacements:p,replacements:m,apiConfig:f,signal:g,size:b})=>{var y;const v=d.map((e=>({role:e.role,content:e.content}))),h=(null==f?void 0:f.provider)===a.OpenAiProviderType.OpenAi?{model:null!==(y=f.model)&&void 0!==y?y:r.a,messages:v,n:1,stop:null,temperature:.2}:{messages:v},E=u&&!l,x=Object(s.e)({alerts:e,alertsIndexPattern:t,allow:n,allowReplacement:o,replacements:m,size:b}),j=E?{params:{subActionParams:h,subAction:"invokeStream"},assistantLangChain:l,...x}:{params:{subActionParams:h,subAction:"invokeAI"},assistantLangChain:l,...x};try{var O,S,k,w,T;if(E){var I,C;const e=await c.fetch(`/internal/elastic_assistant/actions/connector/${null==f?void 0:f.connectorId}/_execute`,{method:"POST",body:JSON.stringify(j),signal:g,asResponse:E,rawResponse:E}),t=null==e||null===(I=e.response)||void 0===I||null===(C=I.body)||void 0===C?void 0:C.getReader();return t?{response:t,isStream:!0,isError:!1}:{response:`${i.a}\n\nCould not get reader from response`,isError:!0,isStream:!1}}const t=await c.fetch(`/internal/elastic_assistant/actions/connector/${null==f?void 0:f.connectorId}/_execute`,{method:"POST",body:JSON.stringify(j),headers:{"Content-Type":"application/json"},signal:g});if("ok"!==t.status||!t.data)return t.service_message?{response:`${i.a}\n\n${t.service_message}`,isError:!0,isStream:!1}:{response:i.a,isError:!0,isStream:!1};const n=null!=(null===(O=t.trace_data)||void 0===O?void 0:O.trace_id)&&null!=(null===(S=t.trace_data)||void 0===S?void 0:S.transaction_id)?{traceId:null===(k=t.trace_data)||void 0===k?void 0:k.trace_id,transactionId:null===(w=t.trace_data)||void 0===w?void 0:w.transaction_id}:void 0;return p(null!==(T=t.replacements)&&void 0!==T?T:{}),{response:Object(s.f)({alerts:e,assistantLangChain:l})?Object(s.c)(t.data):t.data,isError:!1,isStream:!1,traceData:n}}catch(e){var M,_;const t=null==e||null===(M=e.response)||void 0===M||null===(_=M.body)||void 0===_?void 0:_.getReader,n=E&&"function"==typeof t?t.call(e.response.body):null;var A,P;return n?{response:n,isStream:!0,isError:!0}:{response:`${i.a}\n\n${null!==(A=null==e||null===(P=e.body)||void 0===P?void 0:P.message)&&void 0!==A?A:null==e?void 0:e.message}`,isError:!0,isStream:!1}}},l=async({http:e,resource:t,signal:n})=>{try{const a=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(a,{method:"GET",signal:n})}catch(e){return e}},u=async({http:e,resource:t,signal:n})=>{try{const a=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(a,{method:"POST",signal:n})}catch(e){return e}},c=async({http:e,resource:t,signal:n})=>{try{const a=`/internal/elastic_assistant/knowledge_base/${t||""}`;return await e.fetch(a,{method:"DELETE",signal:n})}catch(e){return e}},d=async({http:e,evalParams:t,signal:n})=>{try{var a,i,r,s,o,l;const u="/internal/elastic_assistant/evaluate",c={agents:null==t||null===(a=t.agents.sort())||void 0===a?void 0:a.join(","),datasetName:null==t?void 0:t.datasetName,evaluationType:null==t||null===(i=t.evaluationType.sort())||void 0===i?void 0:i.join(","),evalModel:null==t||null===(r=t.evalModel.sort())||void 0===r?void 0:r.join(","),outputIndex:null==t?void 0:t.outputIndex,models:null==t||null===(s=t.models.sort())||void 0===s?void 0:s.join(","),projectName:null==t?void 0:t.projectName,runName:null==t?void 0:t.runName};return await e.fetch(u,{method:"POST",body:JSON.stringify({dataset:JSON.parse(null!==(o=null==t?void 0:t.dataset)&&void 0!==o?o:"[]"),evalPrompt:null!==(l=null==t?void 0:t.evalPrompt)&&void 0!==l?l:""}),headers:{"Content-Type":"application/json"},query:c,signal:n})}catch(e){return e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(300);t.default=function(e,t){var n=i.useFirstMountState();a.useEffect((function(){if(!n)return e()}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){void 0===e&&(e={});var t=a.useState(e),n=t[0],i=t[1];return[n,a.useCallback((function(e){i((function(t){return Object.assign({},t,e instanceof Function?e(t):e)}))}),[i])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect(e,[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(303));t.default=function(e){var t=i.useRef(0),n=i.useState(e),a=n[0],s=n[1],o=i.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){s(e)}))}),[]);return r.default((function(){cancelAnimationFrame(t.current)})),[a,o]}},function(e,t,n){"use strict";e.exports=function(e){return-2===e||-1===e||32===e}},function(e,t,n){"use strict";n.d(t,"b",(function(){return on})),n.d(t,"c",(function(){return ln})),n.d(t,"d",(function(){return un})),n.d(t,"a",(function(){return xn}));var a=n(2),i=n.n(a),r=n(17),s=n(44),o=n.n(s),l=n(13),u=n(493),c=n(123),d=n(251),p=n(543),m=n(494),f=n(552),g=n(547),b=n(5);b.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph1",{defaultMessage:"The fields below are allowed by default"}),b.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutParagraph2",{defaultMessage:"Optionally enable anonymization for these fields"}),b.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.calloutTitle",{defaultMessage:"Anonymization defaults"});const y=b.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsTitle",{defaultMessage:"Anonymization"}),v=b.i18n.translate("xpack.elasticAssistant.dataAnonymization.settings.anonymizationSettings.settingsDescription",{defaultMessage:"When adding Prompt Context throughout the Security App that may contain sensitive information, you can choose which fields are sent, and whether to enable anonymization for these fields. This will replace the field's value with a random string before sending the conversation. Helpful defaults are provided below."}),h=o()(r.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeL};
`,E=({defaultAllow:e,defaultAllowReplacement:t,pageSize:n,setUpdatedDefaultAllow:s,setUpdatedDefaultAllowReplacement:o})=>{const{baseAllow:u,baseAllowReplacement:d}=Object(c.b)(),b=Object(a.useCallback)((n=>{Object(m.b)({defaultAllow:e,defaultAllowReplacement:t,setDefaultAllow:s,setDefaultAllowReplacement:o,updates:n})}),[e,t,s,o]),E=Object(a.useCallback)((()=>{s(u),o(d)}),[u,d,s,o]),x=Object(a.useMemo)((()=>{const n=new Set(e);return t.reduce(((e,t)=>n.has(t)?e+1:e),0)}),[e,t]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,y)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"xs"},v),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center","data-test-subj":"summary",gutterSize:"none"},Object(l.jsx)(h,{grow:!1},Object(l.jsx)(f.a,{allowed:e.length,total:e.length})),Object(l.jsx)(h,{grow:!1},Object(l.jsx)(g.a,{anonymized:x,isDataAnonymizable:!0}))),Object(l.jsx)(r.EuiSpacer,{size:"s"}),Object(l.jsx)(p.a,{allow:e,allowReplacement:t,onListUpdated:b,onReset:E,rawData:null,pageSize:n}))};E.displayName="AnonymizationSettingsComponent";const x=i.a.memo(E);var j=n(47),O=n(73),S=n(45);const k=b.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsTitle",{defaultMessage:"Conversations"}),w=b.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.settingsDescription",{defaultMessage:"Create and manage conversations with the Elastic AI Assistant."}),T=b.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.connectorTitle",{defaultMessage:"Connector"}),I=b.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptTitle",{defaultMessage:"System Prompt"}),C=b.i18n.translate("xpack.elasticAssistant.assistant.conversations.settings.promptHelpTextTitle",{defaultMessage:"Context provided as part of every conversation"});var M=n(495),_=n(496),A=n(551),P=n(498);const F=b.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.defaultConversationTitle",{defaultMessage:"Conversations"}),D=b.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.ariaLabel",{defaultMessage:"Conversation selector"}),N=b.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.placeholderTitle",{defaultMessage:"Select or type to create new..."}),R=b.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.CustomOptionTextTitle",{defaultMessage:"Create new conversation:"}),L=b.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.previousConversationTitle",{defaultMessage:"Previous conversation"}),z=b.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.nextConversationTitle",{defaultMessage:"Next conversation"}),B=b.i18n.translate("xpack.elasticAssistant.assistant.conversationSelectorSettings.deleteConversationTitle",{defaultMessage:"Delete conversation"});var q={name:"1v0pok0",styles:"min-width:300px"},$={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},V={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},U={name:"1e5733u",styles:"width:calc(100% - 60px)"};const H=i.a.memo((({conversations:e,onConversationDeleted:t,onConversationSelectionChange:n,selectedConversationId:i})=>{const s=Object(a.useMemo)((()=>Object.keys(e)),[e]),[o,u]=Object(a.useState)((()=>Object.values(e).map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.id,"data-test-subj":e.id}})))),c=Object(a.useMemo)((()=>{var e;return i&&null!==(e=o.filter((e=>e.label===i)))&&void 0!==e?e:[]}),[o,i]),d=Object(a.useCallback)((t=>{var a,i;const r=0===t.length?void 0:null!==(a=Object.values(e).find((e=>{var n;return e.id===(null===(n=t[0])||void 0===n?void 0:n.label)})))&&void 0!==a?a:null===(i=t[0])||void 0===i?void 0:i.label;n(r)}),[n,e]),p=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||u([...o,a]),d([a])}),[o,d]),m=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[o,d]),f=Object(a.useCallback)((e=>{var n;u(o.filter((t=>t.label!==e))),(null==c||null===(n=c[0])||void 0===n?void 0:n.label)===e&&d([]),t(e)}),[o,d,t,c]),g=Object(a.useCallback)((()=>{const e=((e,t="")=>0===e.indexOf(t)?e[e.length-1]:e[e.indexOf(t)-1])(s,i),t=o.filter((t=>t.label===e));d(t)}),[s,o,d,i]),b=Object(a.useCallback)((()=>{const e=((e,t="")=>e.indexOf(t)+1>=e.length?e[0]:e[e.indexOf(t)+1])(s,i),t=o.filter((t=>t.label===e));d(t)}),[s,o,d,i]);return Object(l.jsx)(r.EuiFormRow,{label:F,display:"rowCompressed",css:q},Object(l.jsx)(r.EuiComboBox,{"aria-label":D,customOptionText:`${R} {searchValue}`,placeholder:N,singleSelection:{asPlainText:!0},options:o,selectedOptions:c,onChange:m,onCreateOption:p,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(l.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:U},Object(l.jsx)(r.EuiHighlight,{search:t,css:V},a)),!(null!=i&&i.isDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(r.EuiToolTip,{position:"right",content:B},Object(l.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":B,color:"danger","data-test-subj":"delete-conversation",onClick:e=>{e.stopPropagation(),f(a)},css:$}))))},compressed:!0,prepend:Object(l.jsx)(r.EuiButtonIcon,{iconType:"arrowLeft","data-test-subj":"arrowLeft","aria-label":L,onClick:g,disabled:s.length<=1}),append:Object(l.jsx)(r.EuiButtonIcon,{iconType:"arrowRight","data-test-subj":"arrowRight","aria-label":z,onClick:b,disabled:s.length<=1})}))}));H.displayName="ConversationSelectorSettings";var Z=n(222),G=n(220),Q=n(252);const W=i.a.memo((({allSystemPrompts:e,defaultConnectorId:t,defaultProvider:n,selectedConversation:s,onSelectedConversationChange:o,conversationSettings:u,http:c,setUpdatedConversationSettings:d,isDisabled:p=!1})=>{const m=Object(a.useMemo)((()=>Object(Z.b)({allSystemPrompts:e,conversation:void 0})),[e]),f=Object(a.useMemo)((()=>Object(Z.b)({allSystemPrompts:e,conversation:s})),[e,s]),{data:g,isSuccess:b}=Object(G.a)({http:c}),y=Object(a.useCallback)((e=>{const a="string"==typeof e?{id:null!=e?e:"",messages:[],apiConfig:{connectorId:t,provider:n,defaultSystemPromptId:null==m?void 0:m.id}}:e;null!=a&&d((e=>({...e,[a.id]:a}))),o(a)}),[t,n,null==m?void 0:m.id,o,d]),v=Object(a.useCallback)((e=>{d((t=>{const{[e]:n,...a}=t;return null!=n?a:t}))}),[d]),h=Object(a.useCallback)((e=>{null!=s&&d((t=>({...t,[s.id]:{...s,apiConfig:{...s.apiConfig,defaultSystemPromptId:e}}})))}),[s,d]),E=Object(a.useMemo)((()=>{const e=null==s?void 0:s.apiConfig.connectorId;if(b)return null==g?void 0:g.find((t=>t.id===e))}),[b,g,null==s?void 0:s.apiConfig.connectorId]),x=Object(a.useMemo)((()=>null==s?void 0:s.apiConfig.provider),[null==s?void 0:s.apiConfig.provider]),F=Object(a.useCallback)((e=>{if(null!=s){const t=Object(Q.b)(e);d((n=>({...n,[s.id]:{...s,apiConfig:{...s.apiConfig,connectorId:null==e?void 0:e.id,provider:null==t?void 0:t.apiProvider,model:null==t?void 0:t.defaultModel}}})))}}),[s,d]),D=Object(a.useMemo)((()=>{var e,t;const n=null===(e=Object(Q.b)(E))||void 0===e?void 0:e.defaultModel;return null!==(t=null==s?void 0:s.apiConfig.model)&&void 0!==t?t:n}),[E,null==s?void 0:s.apiConfig.model]),N=Object(a.useCallback)((e=>{null!=s&&d((t=>({...t,[s.id]:{...s,apiConfig:{...s.apiConfig,model:e}}})))}),[s,d]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,k)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},w),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(H,{selectedConversationId:null==s?void 0:s.id,conversations:u,onConversationDeleted:v,onConversationSelectionChange:y}),Object(l.jsx)(r.EuiFormRow,{"data-test-subj":"prompt-field",display:"rowCompressed",fullWidth:!0,label:I,helpText:C},Object(l.jsx)(A.a,{allSystemPrompts:e,compressed:!0,conversation:s,isEditing:!0,isDisabled:p,onSystemPromptSelectionChange:h,selectedPrompt:f,showTitles:!0,isSettingsModalVisible:!0,setIsSettingsModalVisible:S.noop})),Object(l.jsx)(r.EuiFormRow,{"data-test-subj":"connector-field",display:"rowCompressed",label:T,helpText:Object(l.jsx)(r.EuiLink,{href:`${c.basePath.get()}/app/management/insightsAndAlerting/triggersActionsConnectors/connectors`,target:"_blank",external:!0},Object(l.jsx)(j.FormattedMessage,{id:"xpack.elasticAssistant.assistant.settings.connectorHelpTextTitle",defaultMessage:"Kibana Connector to make requests with"}))},Object(l.jsx)(_.a,{isDisabled:p,onConnectorSelectionChange:F,selectedConnectorId:null==E?void 0:E.id})),!1===(null==E?void 0:E.isPreconfigured)&&x===O.OpenAiProviderType.OpenAi&&Object(l.jsx)(r.EuiFormRow,{"data-test-subj":"model-field",display:"rowCompressed",label:M.c,helpText:M.b},Object(l.jsx)(P.b,{onModelSelectionChange:N,selectedModel:D})))}));W.displayName="ConversationSettings";const K=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsTitle",{defaultMessage:"Evaluation"}),J=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.settingsDescription",{defaultMessage:"Run predictions and evaluations against test data sets using different models (connectors), agents, and evaluation schemes."}),Y=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsTitle",{defaultMessage:"ðŸƒ Run Details"}),X=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runDetailsDescription",{defaultMessage:"Configure test run details like project, run name, dataset, and output index"}),ee=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsTitle",{defaultMessage:"ðŸ”® Predictions"}),te=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.predictionDetailsDescription",{defaultMessage:"Choose models (connectors) and corresponding agents the dataset should run against"}),ne=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsTitle",{defaultMessage:"ðŸ§® Evaluation (Optional)"}),ae=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationDetailsDescription",{defaultMessage:"Evaluate prediction results using a specific model (connector) and evaluation criterion"}),ie=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectLabel",{defaultMessage:"Project"}),re=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectDescription",{defaultMessage:"LangSmith project to write results to"}),se=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.projectPlaceholder",{defaultMessage:"8.12 Testing"}),oe=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameLabel",{defaultMessage:"Run name"}),le=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNameDescription",{defaultMessage:"Name for this specific test run"}),ue=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.runNamePlaceholder",{defaultMessage:"8.12 ESQL Query Generation"}),ce=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsLabel",{defaultMessage:"Connectors / Models"}),de=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.connectorsDescription",{defaultMessage:"Select whichever models you want to evaluate the dataset against"}),pe=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsLabel",{defaultMessage:"Agents"}),me=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.agentsDescription",{defaultMessage:"Select the agents (i.e. RAG algos) to evaluate the dataset against"}),fe=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelLabel",{defaultMessage:"Evaluator Model"}),ge=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorModelDescription",{defaultMessage:"Model to perform the final evaluation with"}),be=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeLabel",{defaultMessage:"Evaluation type"}),ye=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationTypeDescription",{defaultMessage:'Type of evaluation to perform, e.g. "correctness" "esql-validator", or "custom" and provide your own evaluation prompt'}),ve=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptLabel",{defaultMessage:"Evaluation prompt"}),he=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluationPromptDescription",{defaultMessage:"Prompt template given `input`, `reference` and `prediction` template variables"}),Ee=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexLabel",{defaultMessage:"Output index"}),xe=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorOutputIndexDescription",{defaultMessage:'Index to write results to. Must be prefixed with ".kibana-elastic-ai-assistant-"'}),je=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorDatasetLabel",{defaultMessage:"Dataset"}),Oe=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetLabel",{defaultMessage:"LangSmith"}),Se=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetDescription",{defaultMessage:"Name of dataset hosted on LangSmith to evaluate"}),ke=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.langsmithDatasetPlaceholder",{defaultMessage:"ESQL Query Generation"}),we=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetLabel",{defaultMessage:"Custom"}),Te=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.customDatasetDescription",{defaultMessage:'Custom dataset to evaluate. Array of objects with "input" and "references" properties'}),Ie=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.performEvaluationTitle",{defaultMessage:"Perform evaluation..."}),Ce=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactDiscoverLinkText",{defaultMessage:"Discover"}),Me=b.i18n.translate("xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactApmLinkText",{defaultMessage:"APM"});var _e=n(177),Ae=n(50),Pe=n(253);const Fe=["elastic-assistant","perform-evaluation"],De=["DefaultAgentExecutor","OpenAIFunctionsExecutor"],Ne=[{label:"correctness"},{label:"esql-validator",disabled:!0},{label:"custom",disabled:!0}];var Re={name:"1sl5m7u",styles:"min-height:330px"},Le={name:"vc763q",styles:"min-height:300px"},ze={name:"1bs7qd7",styles:"&:hover{text-decoration:none;}"},Be={name:"yz1nei",styles:"margin-top:16px"};const qe=i.a.memo((({onEvaluationSettingsChange:e})=>{var t,n;const{actionTypeRegistry:s,basePath:o,http:u}=Object(c.b)(),{data:d}=Object(G.a)({http:u}),{data:p,mutate:m,isLoading:f}=(({http:e,toasts:t})=>Object(Ae.useMutation)(Fe,(t=>Object(Pe.d)({http:e,evalParams:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:b.i18n.translate("xpack.elasticAssistant.evaluation.evaluationError",{defaultMessage:"Error performing evaluation..."})}))}}))({http:u}),[g,y]=Object(a.useState)(),v=Object(a.useCallback)((e=>{y(e.target.value)}),[y]),[h,E]=Object(a.useState)(),x=Object(a.useCallback)((e=>{E(e.target.value)}),[E]),[O,S]=Object(a.useState)(".kibana-elastic-ai-assistant-evaluation-results"),k=Object(a.useCallback)((e=>{S(e.target.value)}),[S]),[w,T]=Object(a.useState)(!0),I=Object(a.useMemo)((()=>Object(l.jsx)(r.EuiText,{size:"xs",css:Be},je," (",Object(l.jsx)(r.EuiLink,{color:w?"primary":"text",onClick:()=>T(!0)},Oe)," / ",Object(l.jsx)(r.EuiLink,{color:w?"text":"primary",onClick:()=>T(!1)},we),")")),[w]),[C,M]=Object(a.useState)(),_=Object(a.useCallback)((e=>{M(e.target.value)}),[M]),[A,P]=Object(a.useState)(JSON.stringify([{input:"As an expert user of Elastic Security, please generate an accurate and valid ESQL query to detect the use case below. Your response should be formatted to be able to use immediately in an Elastic Security timeline or detection rule. Take your time with the answer, and really make sure you check your knowledge really well on all the functions I am asking for. check it multiple times if you need to. I cannot afford for queries to be inaccurate. Assume I am using the Elastic Common Schema. Ensure the answers are formatted in a way which is easily copyable.\n\nWrite an ESQL query for detecting cryptomining activity on an AWS EC2 instance.",reference:'FROM metrics-apm*\n| WHERE metricset.name == ""transaction"" AND metricset.interval == ""1m""\n| EVAL bucket = AUTO_BUCKET(transaction.duration.histogram, 50, <start-date>, <end-date>)\n| STATS avg_duration = AVG(transaction.duration.histogram) BY bucket'}],null,2)),F=Object(a.useCallback)((e=>{P(e.target.value)}),[P]),[D,N]=Object(a.useState)([]),R=Object(a.useCallback)((e=>{N(e)}),[N]),L=Object(r.euiPaletteComplementary)(null!==(t=null==d?void 0:d.length)&&void 0!==t?t:0),z=Object(a.useMemo)((()=>{var e;return null!==(e=null==d?void 0:d.map(((e,t)=>{var n;const a=null===(n=Object(Q.b)(e))||void 0===n?void 0:n.apiProvider,i=null!=a?a:Object(Q.a)(s.get(e.actionTypeId)),r=e.isPreconfigured?_e.r:i;return{key:e.id,label:`${e.name} (${r})`,color:L[t]}})))&&void 0!==e?e:[]}),[s,d,L]),[B,q]=Object(a.useState)([]),$=Object(a.useCallback)((e=>{q(e)}),[q]),V=Object(a.useCallback)((e=>{const t=e.trim();t&&q([...B,{label:t}])}),[B]),U=Object(a.useMemo)((()=>De.map((e=>({label:e})))),[]),[H,Z]=Object(a.useState)([]),W=Object(a.useCallback)((e=>{Z(e)}),[Z]),qe=Object(a.useCallback)((e=>{const t=e.trim();t&&Z([{label:t}])}),[Z]),$e=Object(a.useMemo)((()=>Ne),[]),[Ve,Ue]=Object(a.useState)([]),He=Object(a.useCallback)((e=>{Ue(e)}),[Ue]),[Ze,Ge]=Object(a.useState)("For the below input: \n\n{{input}} \n\na prediction: \n\n{{prediction}} \n\nwas made. How's it stack up against this reference: \n\n{{reference}} \n\nReturn output in a succinct sentence ranking on a simple grading rubric focused on correctness."),Qe=Object(a.useCallback)((e=>{Ge(e.target.value)}),[Ge]),We=0===D.length||0===B.length||0===O.length,Ke=Object(a.useCallback)((async()=>{const e={models:D.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),agents:B.map((e=>e.label)),dataset:w?void 0:A,datasetName:w?C:void 0,evalModel:Ve.flatMap((e=>{var t;return null!==(t=e.key)&&void 0!==t?t:[]})),evalPrompt:Ze,evaluationType:H.map((e=>e.label)),outputIndex:O,projectName:g,runName:h};m(e)}),[C,A,Ze,O,m,g,h,B,H,Ve,D,w]),Je=Object(a.useMemo)((()=>{var e;return((e,t)=>`${e}/app/discover#/?_g=(filters:!(),refreshInterval:(pause:!t,value:60000),time:(from:now-1y%2Fd,to:now))&_a=(columns:!(evaluationId,runName,totalAgents,totalInput,totalRequests,input,reference,prediction,evaluation.value,evaluation.reasoning,connectorName,connectorName.keyword,evaluation.__run.runId,evaluation.__run.runId.keyword,evaluation.score,evaluationEnd,evaluationId.keyword,evaluationStart,input.keyword,inputExampleId,inputExampleId.keyword,evaluationDuration,prediction.keyword,predictionResponse.reason.sendToLLM,predictionResponse.status,ConnectorId,predictionResponse.value.data,predictionResponse.value.data.keyword,predictionResponse.value.status,predictionResponse.value.trace_data.trace_id,predictionResponse.value.trace_data.trace_id.keyword,predictionResponse.value.trace_data.transaction_id,predictionResponse.value.trace_data.transaction_id.keyword,reference.keyword,runName.keyword),filters:!(),grid:(columns:('@timestamp':(width:212),ConnectorId:(width:133),connectorName:(width:181),connectorName.keyword:(width:229),evaluation.__run.runId:(width:282),evaluation.__run.runId.keyword:(width:245),evaluation.reasoning:(width:336),evaluation.reasoning.keyword:(width:232),evaluation.score:(width:209),evaluation.value:(width:156),evaluationDuration:(width:174),evaluationEnd:(width:151),evaluationId:(width:130),evaluationId.keyword:(width:186),evaluationStart:(width:202),input:(width:347),input.keyword:(width:458),prediction:(width:264),prediction.keyword:(width:313),predictionResponse.value.connector_id:(width:294),predictionResponse.value.trace_data.trace_id:(width:278),predictionResponse.value.trace_data.transaction_id.keyword:(width:177),reference:(width:305),reference.keyword:(width:219),runName:(width:405),totalAgents:(width:125),totalInput:(width:111),totalRequests:(width:138))),hideChart:!t,index:ce1b41cb-6298-4612-a33c-ba85b3c18ec7,interval:auto,query:(esql:'from%20.kibana-elastic-ai-assistant-evaluation-results%20%0A%7C%20keep%20@timestamp,%20evaluationId,%20runName,%20totalAgents,%20totalInput,%20totalRequests,%20input,%20reference,%20prediction,%20evaluation.value,%20evaluation.reasoning,%20connectorName,%20*%0A%7C%20drop%20evaluation.reasoning.keyword%0A%7C%20rename%20predictionResponse.value.connector_id%20as%20ConnectorId%0A%7C%20where%20evaluationId%20%3D%3D%20%22${t}%22%0A%7C%20sort%20@timestamp%20desc%0A%7C%20limit%20100%0A%0A%0A'),rowHeight:15,sort:!(!('@timestamp',desc)))`)(o,null!==(e=null==p?void 0:p.evaluationId)&&void 0!==e?e:"")}),[o,p]),Ye=Object(a.useMemo)((()=>{var e;return((e,t)=>`${e}/app/apm/traces/explorer/waterfall?comparisonEnabled=false&detailTab=timeline&environment=ENVIRONMENT_ALL&kuery=&query=%22labels.evaluationId%22:%20%22${t}%22&rangeFrom=now-1y&rangeTo=now&showCriticalPath=false&traceId=451662121b1f5e6c44084ad7415b9409&transactionId=5f1392fa04766025&type=kql&waterfallItemId=`)(o,null!==(e=null==p?void 0:p.evaluationId)&&void 0!==e?e:"")}),[o,p]),Xe=(e,t)=>Object(l.jsx)("div",null,Object(l.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiTitle,{size:"xs"},Object(l.jsx)("h3",null,e)))),Object(l.jsx)(r.EuiText,{size:"s"},Object(l.jsx)("p",null,Object(l.jsx)(r.EuiTextColor,{color:"subdued"},t)))),et=Object(a.useMemo)((()=>Xe(Y,X)),[]),tt=Object(a.useMemo)((()=>Xe(ee,te)),[]),nt=Object(a.useMemo)((()=>Xe(ne,ae)),[]),at=ze;return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,K)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},J),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiAccordion,{id:Y,arrowDisplay:"right",buttonContent:et,buttonProps:{paddingSize:"s",css:at},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(l.jsx)(r.EuiFlexGroup,null,Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:ie,helpText:re},Object(l.jsx)(r.EuiFieldText,{"aria-label":"project-textfield",compressed:!0,onChange:v,placeholder:se,value:g}))),Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:oe,helpText:le},Object(l.jsx)(r.EuiFieldText,{"aria-label":"run-name-textfield",compressed:!0,onChange:x,placeholder:ue,value:h})))),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:I,fullWidth:!0,helpText:w?Se:Te},w?Object(l.jsx)(r.EuiFieldText,{"aria-label":"dataset-name-textfield",compressed:!0,onChange:_,placeholder:ke,value:C}):Object(l.jsx)(r.EuiTextArea,{"aria-label":"evaluation-dataset-textarea",compressed:!0,css:Le,fullWidth:!0,onChange:F,value:A})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:Ee,fullWidth:!0,helpText:xe},Object(l.jsx)(r.EuiFieldText,{value:O,onChange:k,"aria-label":"evaluation-output-index-textfield"}))),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiAccordion,{id:ee,arrowDisplay:"right",buttonContent:tt,buttonProps:{paddingSize:"s",css:at},element:"fieldset",initialIsOpen:!0,paddingSize:"s"},Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:ce,helpText:de},Object(l.jsx)(r.EuiComboBox,{"aria-label":"model-selector",compressed:!0,options:z,selectedOptions:D,onChange:R})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:pe,helpText:me},Object(l.jsx)(r.EuiComboBox,{"aria-label":"agent-selector",compressed:!0,onCreateOption:V,options:U,selectedOptions:B,onChange:$}))),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiAccordion,{id:ne,arrowDisplay:"right",element:"fieldset",buttonProps:{paddingSize:"s",css:at},buttonContent:nt,paddingSize:"s"},Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:fe,helpText:ge},Object(l.jsx)(r.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,options:z,selectedOptions:Ve,singleSelection:{asPlainText:!0},onChange:He})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:be,helpText:ye},Object(l.jsx)(r.EuiComboBox,{"aria-label":"evaluation-type-select",compressed:!0,onChange:W,onCreateOption:qe,options:$e,selectedOptions:H,singleSelection:{asPlainText:!0}})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:ve,fullWidth:!0,helpText:he},Object(l.jsx)(r.EuiTextArea,{"aria-label":"evaluation-prompt-textarea",compressed:!0,css:Re,disabled:"custom"!==(null===(n=H[0])||void 0===n?void 0:n.label),fullWidth:!0,onChange:Qe,value:Ze}))),Object(l.jsx)(r.EuiHorizontalRule,null),Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiButton,{size:"s",type:"submit",isDisabled:We,isLoading:f,onClick:Ke,fill:!0},Ie)),Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)(j.FormattedMessage,{defaultMessage:"Fun Facts: Watch the Kibana server logs for progress, and view results in {discover} / {apm} once complete. Will take (many) minutes depending on dataset, and closing this dialog will cancel the evaluation!",id:"xpack.elasticAssistant.assistant.settings.evaluationSettings.evaluatorFunFactText",values:{discover:Object(l.jsx)(r.EuiLink,{external:!0,href:Je,target:"_blank"},Ce),apm:Object(l.jsx)(r.EuiLink,{external:!0,href:Ye,target:"_blank"},Me)}})))),Object(l.jsx)(r.EuiSpacer,{size:"s"}))}));qe.displayName="EvaluationSettings";const $e=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsLabel",{defaultMessage:"Alerts"}),Ve=(b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.askQuestionsAboutLabel",{defaultMessage:"Ask questions about the"}),b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.yourAnonymizationSettingsLabel",{defaultMessage:"Your anonymization settings will apply to these alerts."})),Ue=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.selectFewerAlertsLabel",{defaultMessage:"Send fewer alerts if the model's context window is too small."}),He=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.alertsRangeSliderLabel",{defaultMessage:"Alerts range"}),Ze=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsTitle",{defaultMessage:"Knowledge Base"}),Ge=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsBadgeTitle",{defaultMessage:"Experimental"}),Qe=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.settingsDescription",{defaultMessage:"Powered by ELSER, the Knowledge Base enables the ability to recall documents and other relevant context within your conversation."}),We=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseLabel",{defaultMessage:"Knowledge Base"}),Ke=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseTooltip",{defaultMessage:"ELSER must be configured to enable the Knowledge Base"}),Je=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseDescription",{defaultMessage:"Index where Knowledge Base docs are stored"}),Ye=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.initializeKnowledgeBaseButton",{defaultMessage:"Initialize"}),Xe=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.deleteKnowledgeBaseButton",{defaultMessage:"Delete"}),et=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserLabel",{defaultMessage:"ELSER Configured"}),tt=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserMachineLearningDescription",{defaultMessage:"Machine Learning"}),nt=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.elserSeeDocsDescription",{defaultMessage:"See docs"}),at=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlLabel",{defaultMessage:"ES|QL Knowledge Base Documents"}),it=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlDescription",{defaultMessage:"Knowledge Base docs for generating ES|QL queries"}),rt=b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.esqlInstalledDescription",{defaultMessage:"ES|QL Knowledge Base docs loaded"}),st=({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{const n=Object(r.useGeneratedHtmlId)({prefix:"inputRangeSlider"}),s=Object(a.useCallback)((n=>{t({...e,alerts:n.target.checked})}),[e,t]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiFormRow,{display:"columnCompressedSwitch",label:$e,css:Object(l.css)(".euiFormRow__labelWrapper{min-width:",95,"px!important;}","")},Object(l.jsx)(r.EuiSwitch,{checked:e.alerts,compressed:!0,"data-test-subj":"alertsSwitch",label:$e,onChange:s,showLabel:!1})),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(l.jsx)(r.EuiFlexItem,{css:Object(l.css)("width:",300,"px;",""),grow:!1},Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiRange,{"aria-label":He,compressed:!0,"data-test-subj":"alertsRange",disabled:!e.alerts,id:n,max:100,min:10,onChange:n=>t({...e,latestAlerts:Number(n.currentTarget.value)}),showTicks:!0,step:10,value:e.latestAlerts}),Object(l.jsx)(r.EuiSpacer,{size:"s"})),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,(o=e.latestAlerts,b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.latestAndRiskiestOpenAlertsLabel",{defaultMessage:"Send AI Assistant information about your {alertsCount} newest and riskiest open or acknowledged alerts.",values:{alertsCount:o}}))))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,Ve))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiText,{color:"subdued",size:"xs"},Object(l.jsx)("span",null,Ue)))));var o},ot=i.a.memo(st),lt=["elastic-assistant","knowledge-base-status"],ut=()=>{const e=Object(Ae.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(lt,{refetchType:"active"})}),[e])},ct=["elastic-assistant","delete-knowledge-base"],dt=["elastic-assistant","post-knowledge-base"],pt="esql";var mt={name:"1tyyxc3",styles:"padding-left:20px"},ft={name:"1tyyxc3",styles:"padding-left:20px"},gt={name:"1tyyxc3",styles:"padding-left:20px"},bt={name:"nvudtm",styles:"padding-left:5px"},yt={name:"1xr0ypo",styles:".euiFormRow__labelWrapper{min-width:95px!important;}"};const vt=i.a.memo((({knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t})=>{var n,s,o;const{http:u}=Object(c.b)(),{data:d,isLoading:p,isFetching:m}=(({http:e,resource:t,toasts:n})=>Object(Ae.useQuery)(lt,(async({signal:n})=>Object(Pe.c)({http:e,resource:t,signal:n})),{retry:!1,keepPreviousData:!0,onError:e=>{"AbortError"!==e.name&&(null==n||n.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:b.i18n.translate("xpack.elasticAssistant.knowledgeBase.statusError",{defaultMessage:"Error fetching Knowledge Base Status"})}))}}))({http:u,resource:pt}),{mutate:f,isLoading:g}=(({http:e,toasts:t})=>{const n=ut();return Object(Ae.useMutation)(dt,(t=>Object(Pe.e)({http:e,resource:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:b.i18n.translate("xpack.elasticAssistant.knowledgeBase.setupError",{defaultMessage:"Error setting up Knowledge Base"})}))},onSettled:()=>{n()}})})({http:u}),{mutate:y,isLoading:v}=(({http:e,toasts:t})=>{const n=ut();return Object(Ae.useMutation)(ct,(t=>Object(Pe.a)({http:e,resource:null!=t?t:void 0})),{onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:b.i18n.translate("xpack.elasticAssistant.knowledgeBase.deleteError",{defaultMessage:"Error deleting Knowledge Base"})}))},onSettled:()=>{n()}})})({http:u}),h=null!==(n=null==d?void 0:d.elser_exists)&&void 0!==n&&n,E=null!==(s=(null==d?void 0:d.index_exists)&&(null==d?void 0:d.pipeline_exists))&&void 0!==s&&s,x=null!==(o=null==d?void 0:d.esql_exists)&&void 0!==o&&o,O=p||m||g||v,S=e.assistantLangChain&&(null==d?void 0:d.elser_exists),k=e.assistantLangChain&&S&&E,w=!(null!=d&&d.elser_exists||e.assistantLangChain),T=h?"success":"subdued",I=E?"success":"subdued",C=x?"success":"subdued",M=Object(a.useCallback)((n=>{t({...e,assistantLangChain:n.target.checked}),n.target.checked&&null!=d&&d.elser_exists&&f(pt)}),[null==d?void 0:d.elser_exists,e,t,f]),_=Object(a.useMemo)((()=>O?Object(l.jsx)(r.EuiLoadingSpinner,{size:"s"}):Object(l.jsx)(r.EuiToolTip,{content:w&&Ke,position:"right"},Object(l.jsx)(r.EuiSwitch,{showLabel:!1,"data-test-subj":"assistantLangChainSwitch",disabled:w,checked:e.assistantLangChain,onChange:M,label:We,compressed:!0}))),[O,w,e.assistantLangChain,M]),A=Object(a.useCallback)((e=>{e?f():y()}),[y,f]),P=Object(a.useMemo)((()=>O||!S?Object(l.jsx)(i.a.Fragment,null):Object(l.jsx)(r.EuiButtonEmpty,{color:E?"danger":"primary",flush:"left","data-test-subj":"knowledgeBaseActionButton",onClick:()=>A(!E),size:"xs"},E?Xe:Ye)),[S,E,O,A]),F=Object(a.useMemo)((()=>E?Object(l.jsx)("span",{"data-test-subj":"kb-installed"},(".kibana-elastic-ai-assistant-kb",b.i18n.translate("xpack.elasticAssistant.assistant.settings.knowledgeBaseSettings.knowledgeBaseInstalledDescription",{defaultMessage:"Initialized to `{kbIndexPattern}`",values:{kbIndexPattern:".kibana-elastic-ai-assistant-kb"}}))," ",P):Object(l.jsx)("span",{"data-test-subj":"install-kb"},Je," ",P)),[E,P]),D=Object(a.useCallback)((e=>{e?f(pt):y(pt)}),[y,f]),N=Object(a.useMemo)((()=>O||!k?Object(l.jsx)(i.a.Fragment,null):Object(l.jsx)(r.EuiButtonEmpty,{color:x?"danger":"primary",flush:"left","data-test-subj":"esqlEnableButton",onClick:()=>D(!x),size:"xs"},x?Xe:Ye)),[O,k,x,D]),R=Object(a.useMemo)((()=>x?Object(l.jsx)("span",{"data-test-subj":"esql-installed"},rt," ",N):Object(l.jsx)("span",{"data-test-subj":"install-esql"},it," ",N)),[N,x]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,Ze," ",Object(l.jsx)(r.EuiBetaBadge,{iconType:"beaker",label:Ge,size:"s",color:"hollow"}))),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},Qe),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFormRow,{display:"columnCompressedSwitch",label:We,css:yt},_),Object(l.jsx)(r.EuiSpacer,{size:"s"}),Object(l.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"s",css:bt},Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)("div",null,Object(l.jsx)(r.EuiHealth,{color:T},et),Object(l.jsx)(r.EuiText,{size:"xs",color:"subdued",css:gt},Object(l.jsx)(j.FormattedMessage,{defaultMessage:"Configure ELSER within {machineLearning} to get started. {seeDocs}",id:"xpack.elasticAssistant.assistant.settings.knowledgeBasedSettings.knowledgeBaseDescription",values:{machineLearning:Object(l.jsx)(r.EuiLink,{external:!0,href:u.basePath.prepend("/app/ml/trained_models"),target:"_blank"},tt),seeDocs:Object(l.jsx)(r.EuiLink,{external:!0,href:"https://www.elastic.co/guide/en/machine-learning/current/ml-nlp-elser.html#download-deploy-elser",target:"_blank"},nt)}})))),Object(l.jsx)(r.EuiFlexItem,null,Object(l.jsx)("div",null,Object(l.jsx)(r.EuiHealth,{color:I},We),Object(l.jsx)(r.EuiText,{size:"xs",color:"subdued",css:ft},F))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)("span",null,Object(l.jsx)(r.EuiHealth,{color:C},at),Object(l.jsx)(r.EuiText,{size:"xs",color:"subdued",css:mt},R)))),Object(l.jsx)(r.EuiSpacer,{size:"s"}),Object(l.jsx)(ot,{knowledgeBase:e,setUpdatedKnowledgeBaseSettings:t}))}));vt.displayName="KnowledgeBaseSettings";const ht=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsTitle",{defaultMessage:"Quick Prompts"}),Et=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.settingsDescription",{defaultMessage:"Create and manage Quick Prompts. Quick Prompts are shortcuts to common actions."}),xt=(b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.modalTitle",{defaultMessage:"Quick Prompts"}),b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.nameLabel",{defaultMessage:"Name"})),jt=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptLabel",{defaultMessage:"Prompt"}),Ot=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.promptPlaceholder",{defaultMessage:"Enter a Quick Prompt"}),St=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.badgeColorLabel",{defaultMessage:"Badge color"}),kt=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsLabel",{defaultMessage:"Contexts"}),wt=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.settings.contextsHelpText",{defaultMessage:"Select the Prompt Contexts that this Quick Prompt will be available for. Selecting none will make this Quick Prompt available at all times."}),Tt=(b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalCancelButtonTitle",{defaultMessage:"Cancel"}),b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.modalSaveButtonTitle",{defaultMessage:"Save"}),b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."})),It=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.deletePromptTitle",{defaultMessage:"Delete Quick Prompt"}),Ct=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.quickPromptSelector.customOptionText",{defaultMessage:"Create new Quick Prompt named"});var Mt={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},_t={name:"d3v9zr",styles:"overflow:hidden"},At={name:"1e5733u",styles:"width:calc(100% - 60px)"};const Pt=i.a.memo((({isDisabled:e=!1,quickPrompts:t,onQuickPromptDeleted:n,onQuickPromptSelectionChange:i,selectedQuickPrompt:s})=>{const[o,u]=Object(a.useState)(t.map((e=>{var t;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t},label:e.title,"data-test-subj":e.title,color:e.color}}))),c=Object(a.useMemo)((()=>s?[{value:{isDefault:!0},label:s.title,color:s.color}]:[]),[s]),d=Object(a.useCallback)((e=>{var n,a;const r=0===e.length?void 0:null!==(n=t.find((t=>{var n;return t.title===(null===(n=e[0])||void 0===n?void 0:n.label)})))&&void 0!==n?n:null===(a=e[0])||void 0===a?void 0:a.label;i(r)}),[i,t]),p=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||u([...o,a]),d([a])}),[d,o]),m=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[d,o]),f=Object(a.useCallback)((e=>{var t;u(o.filter((t=>t.label!==e))),(null==c||null===(t=c[0])||void 0===t?void 0:t.label)===e&&d([]),n(e)}),[d,n,o,c]);return Object(l.jsx)(r.EuiComboBox,{"data-test-subj":"quickPromptSelector","aria-label":Tt,compressed:!0,isDisabled:e,placeholder:Tt,customOptionText:`${Ct} {searchValue}`,singleSelection:!0,options:o,selectedOptions:c,onChange:m,onCreateOption:p,renderOption:(e,t,n)=>{const{color:a,label:i,value:s}=e;return Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween"},Object(l.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:At},Object(l.jsx)(r.EuiHealth,{color:a,css:_t},Object(l.jsx)(r.EuiHighlight,{search:t},i))),!(null!=s&&s.isDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiToolTip,{position:"right",content:It},Object(l.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":It,"data-test-subj":"delete-quick-prompt",color:"danger",onClick:e=>{e.stopPropagation(),f(i)},css:Mt}))))},fullWidth:!0})}));Pt.displayName="QuickPromptSelector";const Ft=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.ariaLabel",{defaultMessage:"Select Prompt Context categories this Quick Prompt will be available for."}),Dt=b.i18n.translate("xpack.elasticAssistant.assistant.quickPrompts.promptContextSelector.placeholderLabel",{defaultMessage:"(Quick Prompt will always be visible)."}),Nt=i.a.memo((({isDisabled:e,onPromptContextSelectionChange:t,promptContexts:n,selectedPromptContexts:i=[]})=>{const s=Object(a.useMemo)((()=>n.map((e=>({value:{category:e.category},label:e.description,"data-test-subj":e.description})))),[n]),o=Object(a.useMemo)((()=>null!=i?i.map((e=>({value:{category:e.category},label:e.description}))):[]),[i]),u=Object(a.useCallback)((e=>{const a=n.filter((t=>e.some((e=>t.description===e.label))));t(a)}),[t,n]),c=Object(a.useCallback)((e=>{0===e.length?u([]):-1!==s.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&u(e)}),[u,s]);return Object(l.jsx)(r.EuiComboBox,{"aria-label":Ft,compressed:!0,fullWidth:!0,isDisabled:e,placeholder:Dt,options:s,selectedOptions:o,onChange:c,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(l.jsx)("span",{className:n},Object(l.jsx)(r.EuiHighlight,{search:t},a),Object(l.jsx)("span",null,` / (${null==i?void 0:i.category})`))}})}));Nt.displayName="PromptContextSelector";const Rt="#D36086";var Lt={name:"xpz1vu",styles:"min-height:150px"};const zt=i.a.memo((({onSelectedQuickPromptChange:e,quickPromptSettings:t,selectedQuickPrompt:n,setUpdatedQuickPromptSettings:s})=>{const{basePromptContexts:o}=Object(c.b)(),u=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.prompt)&&void 0!==e?e:""}),[null==n?void 0:n.prompt]),d=Object(a.useCallback)((e=>{null!=n&&s((t=>t.some((e=>e.title===n.title))?t.map((t=>t.title===n.title?{...t,prompt:e.target.value}:t)):t))}),[n,s]),p=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.color)&&void 0!==e?e:Rt}),[null==n?void 0:n.color]),m=Object(a.useCallback)(((e,{hex:t,isValid:a})=>{null!=n&&s((t=>t.some((e=>e.title===n.title))?t.map((t=>t.title===n.title?{...t,color:e}:t)):t))}),[n,s]),f=Object(a.useMemo)((()=>{var e;return null!==(e=o.filter((e=>{var t;return null==n||null===(t=n.categories)||void 0===t?void 0:t.some((t=>(null==e?void 0:e.category)===t))})))&&void 0!==e?e:[]}),[o,null==n?void 0:n.categories]),g=Object(a.useCallback)((e=>{null!=n&&s((t=>t.some((e=>e.title===n.title))?t.map((t=>t.title===n.title?{...t,categories:e.map((e=>e.category))}:t)):t))}),[n,s]),b=Object(a.useCallback)((t=>{const n="string"==typeof t?{title:null!=t?t:"",prompt:"",color:Rt,categories:[]}:t;null!=n&&s((e=>e.some((e=>e.title===n.title))?e:[...e,n])),e(n)}),[e,s]),y=Object(a.useCallback)((e=>{s((t=>t.filter((t=>t.title!==e))))}),[s]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,ht)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},Et),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFormRow,{label:xt,display:"rowCompressed",fullWidth:!0},Object(l.jsx)(Pt,{onQuickPromptDeleted:y,onQuickPromptSelectionChange:b,quickPrompts:t,selectedQuickPrompt:n})),Object(l.jsx)(r.EuiFormRow,{label:jt,display:"rowCompressed",fullWidth:!0},Object(l.jsx)(r.EuiTextArea,{compressed:!0,disabled:null==n,fullWidth:!0,"data-test-subj":"quick-prompt-prompt",onChange:d,placeholder:Ot,value:u,css:Lt})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",fullWidth:!0,label:kt,helpText:wt},Object(l.jsx)(Nt,{isDisabled:null==n,onPromptContextSelectionChange:g,promptContexts:o,selectedPromptContexts:f})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:St},Object(l.jsx)(r.EuiColorPicker,{color:p,compressed:!0,disabled:null==n,onChange:m})))}));zt.displayName="AddQuickPromptModal";const Bt=b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsTitle",{defaultMessage:"System Prompts"}),qt=b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.settingsDescription",{defaultMessage:"Create and manage System Prompts. System Prompts are configurable chunks of context that are always sent for a given conversation."}),$t=(b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.modalTitle",{defaultMessage:"System Prompts"}),b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.nameLabel",{defaultMessage:"Name"})),Vt=b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptLabel",{defaultMessage:"Prompt"}),Ut=b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.promptPlaceholder",{defaultMessage:"Enter a System Prompt"}),Ht=b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsLabel",{defaultMessage:"Default conversations"}),Zt=b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultNewConversationTitle",{defaultMessage:"Use as default for all new conversations"}),Gt=b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.settings.defaultConversationsHelpText",{defaultMessage:"Conversations that should use this System Prompt by default"}),Qt=(b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"}),b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"}),i.a.memo((({conversations:e,isDisabled:t=!1,onConversationSelectionChange:n,selectedConversations:i=[]})=>{const s=Object(a.useMemo)((()=>e.map((e=>({label:e.id,"data-test-subj":d.a.CONVERSATIONS_MULTISELECTOR_OPTION(e.id)})))),[e]),o=Object(a.useMemo)((()=>null!=i?i.map((e=>({label:e.id}))):[]),[i]),u=Object(a.useCallback)((t=>{const a=e.filter((e=>t.some((t=>e.id===t.label))));n(a)}),[n,e]),c=Object(a.useCallback)((e=>{0===e.length?u([]):-1!==s.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&u(e)}),[u,s]);return Object(l.jsx)(r.EuiComboBox,{"aria-label":Ht,compressed:!0,"data-test-subj":d.a.CONVERSATIONS_MULTISELECTOR,isDisabled:t,fullWidth:!0,options:s,selectedOptions:o,onChange:c})})));Qt.displayName="ConversationMultiSelector";const Wt=b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.ariaLabel",{defaultMessage:"Select or type to create new..."}),Kt=b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.deletePromptTitle",{defaultMessage:"Delete System Prompt"}),Jt=b.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.systemPromptModal.systemPromptSelector.customOptionText",{defaultMessage:"Create new System Prompt named"});var Yt={name:"4109g5",styles:"visibility:hidden;.parentFlexGroup:hover &{visibility:visible;}"},Xt={name:"1gz2b5f",styles:"overflow:hidden;text-overflow:ellipsis"},en={name:"qhxz92",styles:"max-width:100%"},tn={name:"1e5733u",styles:"width:calc(100% - 60px)"};const nn=i.a.memo((({autoFocus:e=!1,systemPrompts:t,onSystemPromptDeleted:n,onSystemPromptSelectionChange:i,selectedSystemPrompt:s})=>{const[o,u]=Object(a.useState)(t.map((e=>{var t,n;return{value:{isDefault:null!==(t=e.isDefault)&&void 0!==t&&t,isNewConversationDefault:null!==(n=e.isNewConversationDefault)&&void 0!==n&&n},label:e.name,"data-test-subj":`${d.a.SYSTEM_PROMPT_SELECTOR}-${e.id}`}}))),c=Object(a.useMemo)((()=>{var e,t;return s?[{value:{isDefault:null!==(e=s.isDefault)&&void 0!==e&&e,isNewConversationDefault:null!==(t=s.isNewConversationDefault)&&void 0!==t&&t},label:s.name}]:[]}),[s]),p=Object(a.useCallback)((e=>{var n,a;const r=0===e.length?void 0:null!==(n=t.find((t=>{var n;return t.name===(null===(n=e[0])||void 0===n?void 0:n.label)})))&&void 0!==n?n:null===(a=e[0])||void 0===a?void 0:a.label;i(r)}),[i,t]),m=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||u([...o,a]),p([a])}),[p,o]),f=Object(a.useCallback)((e=>{0===e.length?p([]):-1!==o.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&p(e)}),[p,o]),g=Object(a.useCallback)((e=>{var t;u(o.filter((t=>t.label!==e))),(null==c||null===(t=c[0])||void 0===t?void 0:t.label)===e&&p([]),n(e)}),[p,n,o,c]);return Object(l.jsx)(r.EuiComboBox,{"aria-label":Wt,className:"systemPromptSelector",compressed:!0,"data-test-subj":d.a.SYSTEM_PROMPT_SELECTOR,fullWidth:!0,placeholder:Wt,customOptionText:`${Jt} {searchValue}`,singleSelection:{asPlainText:!0},options:o,selectedOptions:c,onChange:f,onCreateOption:m,renderOption:(e,t,n)=>{const{label:a,value:i}=e;return Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",className:"parentFlexGroup",component:"span",justifyContent:"spaceBetween","data-test-subj":"systemPromptOptionSelector"},Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span",css:tn},Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",component:"span",gutterSize:"s"},Object(l.jsx)(r.EuiFlexItem,{component:"span",grow:!1,css:en},Object(l.jsx)(r.EuiHighlight,{search:t,css:Xt},a)),(null==i?void 0:i.isNewConversationDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(r.EuiToolTip,{position:"right",content:Zt},Object(l.jsx)(r.EuiIcon,{type:"starFilled"}))))),!(null!=i&&i.isDefault)&&Object(l.jsx)(r.EuiFlexItem,{grow:!1,component:"span"},Object(l.jsx)(r.EuiToolTip,{position:"right",content:Kt},Object(l.jsx)(r.EuiButtonIcon,{iconType:"cross","aria-label":Kt,color:"danger","data-test-subj":"delete-prompt",onClick:e=>{e.stopPropagation(),g(a)},css:Yt}))))},autoFocus:e})}));nn.displayName="SystemPromptSelector";var an={name:"xpz1vu",styles:"min-height:150px"};const rn=i.a.memo((({conversationSettings:e,onSelectedSystemPromptChange:t,selectedSystemPrompt:n,setUpdatedSystemPromptSettings:s,setUpdatedConversationSettings:o,systemPromptSettings:u})=>{const c=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.content)&&void 0!==e?e:""}),[null==n?void 0:n.content]),p=Object(a.useCallback)((e=>{null!=n&&s((t=>t.some((e=>e.id===n.id))?t.map((t=>t.id===n.id?{...t,content:e.target.value}:t)):t))}),[n,s]),m=Object(a.useMemo)((()=>Object.values(e)),[e]),f=Object(a.useMemo)((()=>null!=n?Object.values(e).filter((e=>e.apiConfig.defaultSystemPromptId===n.id)):[]),[e,n]),g=Object(a.useCallback)((e=>{const t=e.map((e=>e.id));null!=n&&o((e=>Object(S.keyBy)("id",Object.values(e).map((e=>({...e,apiConfig:{...e.apiConfig,defaultSystemPromptId:t.includes(e.id)?null==n?void 0:n.id:e.apiConfig.defaultSystemPromptId===(null==n?void 0:n.id)?void 0:e.apiConfig.defaultSystemPromptId}}))))))}),[n,o]),b=Object(a.useMemo)((()=>{var e;return null!==(e=null==n?void 0:n.isNewConversationDefault)&&void 0!==e&&e}),[null==n?void 0:n.isNewConversationDefault]),y=Object(a.useCallback)((e=>{const t=e.target.checked;null!=n&&s((e=>e.map((e=>({...e,isNewConversationDefault:n.id===e.id&&t})))))}),[n,s]),v=Object(a.useCallback)((e=>{const n="string"==typeof e?{id:null!=e?e:"",content:"",name:null!=e?e:"",promptType:"system"}:e;null!=n&&s((e=>e.some((e=>e.id===n.id))?e:[...e,n])),t(n)}),[t,s]),h=Object(a.useCallback)((e=>{s((t=>t.filter((t=>t.id!==e))))}),[s]);return Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiTitle,{size:"s"},Object(l.jsx)("h2",null,Bt)),Object(l.jsx)(r.EuiSpacer,{size:"xs"}),Object(l.jsx)(r.EuiText,{size:"s"},qt),Object(l.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:$t,fullWidth:!0},Object(l.jsx)(nn,{onSystemPromptDeleted:h,onSystemPromptSelectionChange:v,systemPrompts:u,selectedSystemPrompt:n})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",label:Vt,fullWidth:!0},Object(l.jsx)(r.EuiTextArea,{"data-test-subj":d.a.SYSTEM_PROMPT_MODAL.PROMPT_TEXT,disabled:null==n,onChange:p,placeholder:Ut,value:c,compressed:!0,fullWidth:!0,css:an})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed",fullWidth:!0,helpText:Gt,label:Ht},Object(l.jsx)(Qt,{conversations:m,isDisabled:null==n,onConversationSelectionChange:g,selectedConversations:f})),Object(l.jsx)(r.EuiFormRow,{display:"rowCompressed"},Object(l.jsx)(r.EuiCheckbox,{"data-test-subj":d.a.SYSTEM_PROMPT_MODAL.TOGGLE_ALL_DEFAULT_CONVERSATIONS,disabled:null==n,id:"defaultNewConversation",label:Object(l.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(l.jsx)(r.EuiFlexItem,null,Zt),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiIcon,{type:b?"starFilled":"starEmpty"}))),checked:b,onChange:y,compressed:!0})))}));rn.displayName="SystemPromptSettings";const sn=o()(r.EuiModal)`
  width: 800px;
  height: 575px;
`,on="CONVERSATION_TAB",ln="QUICK_PROMPTS_TAB",un="SYSTEM_PROMPTS_TAB",cn="ANONYMIZATION_TAB",dn="KNOWLEDGE_BASE_TAB",pn="EVALUATION_TAB";var mn={name:"1r962iv",styles:"padding:4px"},fn={name:"1tk8yx0",styles:"padding:8px"},gn={name:"zd35ug",styles:"max-height:550px;overflow-y:scroll"},bn={name:"16zl6ct",styles:"position:absolute;top:11px;left:14px"},yn={name:"16zl6ct",styles:"position:absolute;top:11px;left:14px"},vn={name:"57t0bw",styles:"position:relative;transform:rotateY(180deg);top:-7px"},hn={name:"15ag9ng",styles:"position:relative;top:-10px"},En={name:"18wygtw",styles:"min-inline-size:unset!important;max-width:104px"};const xn=i.a.memo((({defaultConnectorId:e,defaultProvider:t,onClose:n,onSave:s,selectedConversation:o,setSelectedConversationId:p})=>{const{modelEvaluatorEnabled:m,http:f,selectedSettingsTab:g,setSelectedSettingsTab:b}=Object(c.b)(),{conversationSettings:y,defaultAllow:v,defaultAllowReplacement:h,knowledgeBase:E,quickPromptSettings:j,systemPromptSettings:O,setUpdatedConversationSettings:S,setUpdatedDefaultAllow:k,setUpdatedDefaultAllowReplacement:w,setUpdatedKnowledgeBaseSettings:T,setUpdatedQuickPromptSettings:I,setUpdatedSystemPromptSettings:C,saveSettings:M}=(()=>{const{allQuickPrompts:e,allSystemPrompts:t,conversations:n,defaultAllow:i,defaultAllowReplacement:r,knowledgeBase:s,setAllQuickPrompts:o,setAllSystemPrompts:l,setConversations:u,setDefaultAllow:d,setDefaultAllowReplacement:p,setKnowledgeBase:m}=Object(c.b)(),[f,g]=Object(a.useState)(n),[b,y]=Object(a.useState)(e),[v,h]=Object(a.useState)(t),[E,x]=Object(a.useState)(i),[j,O]=Object(a.useState)(r),[S,k]=Object(a.useState)(s),w=Object(a.useCallback)((()=>{g(n),y(e),k(s),h(t),x(i),O(r)}),[e,t,n,i,r,s]),T=Object(a.useCallback)((()=>{o(b),l(v),u(f),m(S),d(E),p(j)}),[o,l,u,d,p,m,f,E,j,S,b,v]);return{conversationSettings:f,defaultAllow:E,defaultAllowReplacement:j,knowledgeBase:S,quickPromptSettings:b,resetSettings:w,systemPromptSettings:v,saveSettings:T,setUpdatedDefaultAllow:x,setUpdatedDefaultAllowReplacement:O,setUpdatedConversationSettings:g,setUpdatedKnowledgeBaseSettings:k,setUpdatedQuickPromptSettings:y,setUpdatedSystemPromptSettings:h}})(),[_,A]=Object(a.useState)((()=>y[o.id])),P=Object(a.useCallback)((e=>{A(e)}),[]);Object(a.useEffect)((()=>{null!=_&&A(y[_.id])}),[y,_]);const[F,D]=Object(a.useState)(),N=Object(a.useCallback)((e=>{D(e)}),[]);Object(a.useEffect)((()=>{null!=F&&D(j.find((e=>e.title===F.title)))}),[j,F]);const[R,L]=Object(a.useState)(),z=Object(a.useCallback)((e=>{L(e)}),[]);Object(a.useEffect)((()=>{null!=R&&L(O.find((e=>e.id===R.id)))}),[R,O]);const B=Object(a.useCallback)((()=>{const e=null==y[o.id],t=Object.keys(y)[0];e&&null!=t&&p(y[t].id),M(),s()}),[y,o.id,s,M,p]);return Object(l.jsx)(sn,{"data-test-subj":d.a.SETTINGS_MODAL,onClose:n},Object(l.jsx)(r.EuiPage,{paddingSize:"none"},Object(l.jsx)(r.EuiPageSidebar,{paddingSize:"xs",css:En},Object(l.jsx)(r.EuiKeyPadMenu,null,Object(l.jsx)(r.EuiKeyPadMenuItem,{id:on,label:u.c,isSelected:g===on,onClick:()=>b(on),"data-test-subj":`${on}-button`},Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"xl",css:hn}),Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"l",css:vn}))),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:ln,label:u.f,isSelected:g===ln,onClick:()=>b(ln),"data-test-subj":`${ln}-button`},Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"xxl"}),Object(l.jsx)(r.EuiIcon,{type:"bolt",size:"s",color:"warning",css:yn}))),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:un,label:u.k,isSelected:g===un,onClick:()=>b(un),"data-test-subj":`${un}-button`},Object(l.jsx)(r.EuiIcon,{type:"editorComment",size:"xxl"}),Object(l.jsx)(r.EuiIcon,{type:"storage",size:"s",color:"success",css:bn})),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:cn,label:u.a,isSelected:g===cn,onClick:()=>b(cn),"data-test-subj":`${cn}-button`},Object(l.jsx)(r.EuiIcon,{type:"eyeClosed",size:"l"})),Object(l.jsx)(r.EuiKeyPadMenuItem,{id:dn,label:u.e,isSelected:g===dn,onClick:()=>b(dn),"data-test-subj":`${dn}-button`},Object(l.jsx)(r.EuiIcon,{type:"notebookApp",size:"l"})),m&&Object(l.jsx)(r.EuiKeyPadMenuItem,{id:pn,label:u.d,isSelected:g===pn,onClick:()=>b(pn),"data-test-subj":`${pn}-button`},Object(l.jsx)(r.EuiIcon,{type:"crossClusterReplicationApp",size:"l"})))),Object(l.jsx)(r.EuiPageBody,{paddingSize:"none",panelled:!0},Object(l.jsx)(r.EuiSplitPanel.Outer,{grow:!0},Object(l.jsx)(r.EuiSplitPanel.Inner,{className:"eui-scrollBar",grow:!0,css:gn},g===on&&Object(l.jsx)(W,{defaultConnectorId:e,defaultProvider:t,conversationSettings:y,setUpdatedConversationSettings:S,allSystemPrompts:O,selectedConversation:_,isDisabled:null==_,onSelectedConversationChange:P,http:f}),g===ln&&Object(l.jsx)(zt,{quickPromptSettings:j,onSelectedQuickPromptChange:N,selectedQuickPrompt:F,setUpdatedQuickPromptSettings:I}),g===un&&Object(l.jsx)(rn,{conversationSettings:y,systemPromptSettings:O,onSelectedSystemPromptChange:z,selectedSystemPrompt:R,setUpdatedConversationSettings:S,setUpdatedSystemPromptSettings:C}),g===cn&&Object(l.jsx)(x,{defaultAllow:v,defaultAllowReplacement:h,pageSize:5,setUpdatedDefaultAllow:k,setUpdatedDefaultAllowReplacement:w}),g===dn&&Object(l.jsx)(vt,{knowledgeBase:E,setUpdatedKnowledgeBaseSettings:T}),g===pn&&Object(l.jsx)(qe,null)),Object(l.jsx)(r.EuiSplitPanel.Inner,{grow:!1,color:"subdued",css:fn},Object(l.jsx)(r.EuiModalFooter,{css:mn},Object(l.jsx)(r.EuiButtonEmpty,{size:"s","data-test-subj":"cancel-button",onClick:n},u.b),Object(l.jsx)(r.EuiButton,{size:"s",type:"submit","data-test-subj":"save-button",onClick:B,fill:!0},u.g)))))))}));xn.displayName="AssistantSettings"},function(e,t,n){"use strict";n.d(t,"a",(function(){return R})),n.d(t,"b",(function(){return L})),n.d(t,"c",(function(){return z})),n.d(t,"d",(function(){return B}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(5),l=n(17),u=n(47),c=n(44),d=n.n(c),p=n(59),m=n.n(p),f=n(115);const g=d()(l.EuiPanel).withConfig({displayName:"EuiPanelStyled",componentId:"sc-n74boe-0"})(["&.full-height,.full-height{height:100%;}.is-not-scrollable{overflow:hidden;}.is-scrollable{overflow:auto;}"]),b=Object(r.memo)((({pageTitle:e,pageDescription:t,pageBody:n,actions:a,headerHasBottomBorder:i,restrictWidth:o,paddingSize:u="l",scrollableBody:c=!1,headerBackComponent:d,children:p,"data-test-subj":b})=>{const y=!(e||t||a||d),v=Object(f.a)(b),h=Object(r.useMemo)((()=>Array.isArray(a)?a:a?[a]:void 0),[a]),E=Object(r.useMemo)((()=>({gutterSize:"s"})),[]),x=Object(r.useMemo)((()=>m()({"is-scrollable":c,"is-not-scrollable":!c,"full-height":!0})),[c]),j=Object(r.useMemo)((()=>y?null:s.a.createElement(l.EuiFlexGroup,{direction:"column",gutterSize:"none",alignItems:"flexStart",wrap:!1,responsive:!1},d&&s.a.createElement(l.EuiFlexItem,{grow:!1},d),s.a.createElement(l.EuiSpacer,{size:"m"}),s.a.createElement(l.EuiFlexItem,{grow:!1},s.a.createElement(l.EuiTitle,{size:"l"},s.a.createElement("span",{"data-test-subj":v("titleHolder")},e))))),[v,d,y,e]);return s.a.createElement(g,{hasShadow:!1,paddingSize:u,"data-test-subj":b,className:"full-height",color:"transparent"},s.a.createElement(l.EuiFlexGroup,{direction:"column",responsive:!1,gutterSize:"none",className:"full-height","data-test-subj":v("root")},!y&&s.a.createElement(l.EuiFlexItem,{grow:!1,"data-test-subj":v("headerContainer")},s.a.createElement(l.EuiPageHeader,{pageTitle:j,description:t,bottomBorder:i,rightSideItems:h,rightSideGroupProps:E,restrictWidth:o,alignItems:"bottom","data-test-subj":v("header")}),s.a.createElement(l.EuiSpacer,{size:"l"})),s.a.createElement(l.EuiFlexItem,{grow:!1},n),s.a.createElement(l.EuiFlexItem,{grow:!0,className:x,"data-test-subj":v("consoleBody")},s.a.createElement("div",{role:"main",className:"full-height"},p))))}));b.displayName="PageLayout";var y=n(49),v=n(152),h=n(189),E=n(214);const x=d.a.div.withConfig({displayName:"OverlayRootContainer",componentId:"sc-vostrz-0"})(["border:none;display:block;position:fixed;overflow:hidden;top:var(--euiFixedHeadersOffset,0);bottom:0;right:0;height:calc(100% - var(--euiFixedHeadersOffset,0));width:100%;z-index:",";background-color:",";&.scrolling{overflow:auto;}&.hidden{display:none;}&.padding-xs{padding:",";}&.padding-s{padding:",";}&.padding-m{padding:",";}&.padding-l{padding:",";}&.padding-xl{padding:",";}&.fullScreen{top:0;height:100%;}.fullHeight{height:100%;}"],(({theme:{eui:e}})=>e.euiZFlyout),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeM),(({theme:{eui:e}})=>e.euiSizeL),(({theme:{eui:e}})=>e.euiSizeXL)),j="securitySolution-pageOverlay",O=`${j}-isVisible`,S=`${j}-lock`,k=`${j}-fullScreen`,w=`${j}-overSecuritySolutionPageWrapper`,T=Object(c.createGlobalStyle)(["body.","{overflow:hidden;}body.","{","}"],S,k,E.e),I=()=>{document.body.classList.remove(O)},C=()=>{document.body.classList.remove(S)},M=()=>{document.body.classList.remove(k)},_=()=>{document.body.classList.remove(w)},A=Object(r.memo)((({children:e,onHide:t,isHidden:n=!1,enableScrolling:a=!0,hideOnUrlPathnameChange:i=!0,lockDocumentBody:o=!0,appendAsBodyLastNode:u=!0,paddingSize:c,zIndex:d,"data-test-subj":p})=>{const{pathname:f}=Object(y.useLocation)(),g=Object(v.b)(),b=Object(h.b)(),[E,A]=Object(r.useState)(null),P=Object(r.useRef)(),F=Object(r.useCallback)((e=>{P.current=e}),[]),D=Object(r.useMemo)((()=>{const e={};return d&&(e.zIndex=d),e}),[d]),N=Object(r.useMemo)((()=>m()({[j]:!0,scrolling:a,hidden:n,fullScreen:b,"eui-scrollBar":a,"padding-xs":"xs"===c,"padding-s":"s"===c,"padding-m":"m"===c,"padding-l":"l"===c,"padding-xl":"xl"===c})),[a,n,c,b]);return Object(r.useEffect)((()=>{g()&&A((e=>n?null:e||(u&&P.current&&document.body.appendChild(P.current),f)))}),[u,n,g,f]),Object(r.useEffect)((()=>{g()&&i&&!n&&E&&E!==f&&t()}),[i,n,g,t,E,f]),Object(r.useEffect)((()=>{if(g()){const e=Boolean(document.querySelector(".securitySolutionWrapper"));n?(I(),C(),M(),_()):(document.body.classList.add(O),o&&document.body.classList.add(S),b&&document.body.classList.add(k),e&&document.body.classList.add(w))}return()=>{C(),I(),M(),_()}}),[n,g,o,b]),s.a.createElement(l.EuiPortal,{portalRef:F},s.a.createElement(x,{"data-test-subj":p,className:N,style:D},s.a.createElement(l.EuiFocusTrap,{"data-test-subj":"trap-focus",className:"fullHeight"},e)),s.a.createElement(T,null))}));A.displayName="PageOverlay";const P=o.i18n.translate("xpack.securitySolution.consolePageOverlay.backButtonLabel",{defaultMessage:"Back"}),F=Object(r.memo)((({console:e,onHide:t,isHidden:n,body:a,actions:i,pageTitle:o="",showCloseButton:c=!1})=>{const d=Object(f.a)("consolePageOverlay"),p=Object(r.useCallback)((e=>{e.preventDefault(),t()}),[t]),m=Object(r.useMemo)((()=>n?{}:{pageTitle:o,pageBody:a,headerHasBottomBorder:!1,"data-test-subj":d("layout"),headerBackComponent:s.a.createElement(l.EuiButtonEmpty,{flush:"left",size:"s",iconType:"arrowLeft",onClick:p,"data-test-subj":d("header-back-link")},P),actions:c?[s.a.createElement(l.EuiButton,{fill:!0,onClick:p,minWidth:"auto","data-test-subj":d("doneButton")},s.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.consolePageOverlay.doneButtonLabel",defaultMessage:"Done"})),...null!=i?i:[]]:[...null!=i?i:[]]}),[i,a,d,p,n,o,c]);return s.a.createElement(A,{isHidden:n,"data-test-subj":"consolePageOverlay",onHide:t,paddingSize:"l",enableScrolling:!1},s.a.createElement(b,m,e))}));F.displayName="ConsolePageOverlay";var D=n(685);const N=s.a.createContext(void 0),R=Object(r.memo)((({storage:e={},children:t})=>{const[n,a]=Object(r.useState)(e),[o]=Object(r.useState)(new Map),l=Object(r.useRef)();l.current=n;const u=Object(r.useCallback)((e=>{var t;if(null===(t=l.current)||void 0===t||!t[e])throw new Error(`Console with id ${e} not found`)}),[]),c=Object(r.useCallback)((e=>{u(e),a((t=>{const n={...t};return Object.entries(n).forEach((([e,t])=>{t.isOpen&&(n[e]={...t,isOpen:!1})})),n[e]={...n[e],isOpen:!0},n}))}),[u]),d=Object(r.useCallback)((e=>{u(e),a((t=>({...t,[e]:{...t[e],isOpen:!1}})))}),[u]),p=Object(r.useCallback)((e=>{u(e),a((t=>{const n={...t};return delete n[e],n}))}),[u]),m=Object(r.useCallback)((e=>{var t;if(null!==(t=l.current)&&void 0!==t&&t[e])return l.current[e].client}),[]),f=Object(r.useCallback)((()=>Object.values(n).map((e=>e.client))),[n]),g=Object(r.useCallback)((e=>{var t;return!(null===(t=l.current)||void 0===t||!t[e])&&l.current[e].isOpen}),[]),b=Object(r.useCallback)((({id:e,meta:t,consoleProps:r,...o})=>{if(n[e])throw new Error(`Console with id ${e} already registered`);const l=Symbol(e),u=c.bind(null,e),m=d.bind(null,e),f=p.bind(null,e),b=g.bind(null,e),y={PageBodyComponent:void 0,PageTitleComponent:void 0,ActionComponents:void 0,...o,client:{id:e,meta:t,show:()=>{setTimeout(u,0)},hide:()=>{setTimeout(m,0)},terminate:()=>{setTimeout(f,0)},isVisible:()=>b()},consoleProps:r,console:s.a.createElement(D.a,i()({},r,{managedKey:l,key:e})),isOpen:!1,key:l};return a((t=>({...t,[e]:y}))),y.client}),[n,d,g,c,p]),y=Object(r.useMemo)((()=>({register:b,show:c,hide:d,terminate:p,getOne:m,getList:f})),[f,m,d,b,c,p]),v=Object(r.useMemo)((()=>({client:y,internal:{getManagedConsole:e=>Object.values(n).find((t=>t.key===e)),getManagedConsoleState:e=>o.get(e),storeManagedConsoleState(e,t){o.set(e,t)}}})),[y,o,n]),h=Object(r.useMemo)((()=>Object.values(n).find((e=>e.isOpen))),[n]),E=Object(r.useMemo)((()=>{var e;return null!==(e=null==h?void 0:h.client.meta)&&void 0!==e?e:{}}),[null==h?void 0:h.client.meta]),x=Object(r.useCallback)((()=>{h&&y.hide(h.client.id)}),[y,h]);return s.a.createElement(N.Provider,{value:v},t,h&&s.a.createElement(F,{onHide:x,console:s.a.createElement(D.a,i()({},h.consoleProps,{managedKey:h.key,key:h.client.id})),isHidden:!h,pageTitle:h.PageTitleComponent&&s.a.createElement(h.PageTitleComponent,{meta:E}),body:h.PageBodyComponent&&s.a.createElement(h.PageBodyComponent,{meta:E}),actions:h.ActionComponents&&h.ActionComponents.map((e=>s.a.createElement(e,{meta:E}))),showCloseButton:h.showCloseButton}))}));R.displayName="ConsoleManager";const L=()=>{const e=Object(r.useContext)(N);if(!e)throw new Error("ConsoleManagerContext not found");return e.client},z=e=>{const t=Object(r.useContext)(N);if(e&&t)return t.internal.getManagedConsole(e)},B=e=>{const t=Object(r.useContext)(N);return Object(r.useMemo)((()=>e&&t?[()=>t.internal.getManagedConsoleState(e),n=>{t.internal.getManagedConsole(e)&&t.internal.storeManagedConsoleState(e,n)}]:[void 0,void 0]),[t,e])}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(135);const r=()=>{const[e,t]=Object(a.useState)({isAuthenticated:null,hasEncryptionKey:null,hasIndexManage:null,hasIndexRead:null,hasIndexWrite:null,hasIndexUpdateDelete:null,hasIndexMaintenance:null,hasKibanaCRUD:!1,hasKibanaREAD:!1}),{detectionEnginePrivileges:n,kibanaSecuritySolutionsPrivileges:{crud:r,read:s}}=Object(i.a)();return Object(a.useEffect)((()=>{null!=n.error&&t({isAuthenticated:!1,hasEncryptionKey:!1,hasIndexManage:!1,hasIndexRead:!1,hasIndexWrite:!1,hasIndexUpdateDelete:!1,hasIndexMaintenance:!1,hasKibanaCRUD:r,hasKibanaREAD:s})}),[n.error,r,s]),Object(a.useEffect)((()=>{if(null!=n.result){const e=n.result;if(null!=e.index&&Object.keys(e.index).length>0){const n=Object.keys(e.index)[0];t({isAuthenticated:e.is_authenticated,hasEncryptionKey:e.has_encryption_key,hasIndexManage:e.index[n].manage&&e.cluster.manage,hasIndexMaintenance:e.index[n].maintenance,hasIndexRead:e.index[n].read,hasIndexWrite:e.index[n].create||e.index[n].create_doc||e.index[n].index||e.index[n].write,hasIndexUpdateDelete:e.index[n].write,hasKibanaCRUD:r,hasKibanaREAD:s})}}}),[n.result,r,s]),{loading:n.loading,...e}}},,function(e,t,n){"use strict";var a=n(362);n.d(t,"a",(function(){return a.b})),n.d(t,"b",(function(){return a.c}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"g",(function(){return v})),n.d(t,"h",(function(){return h})),n.d(t,"f",(function(){return E})),n.d(t,"d",(function(){return x})),n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return O}));var a=n(62),i=n(17),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(4),c=n(110);const d="100%",p=l.a.div.withConfig({displayName:"WrappedByAutoSizerComponent",componentId:"sc-1gxuxf9-0"})([""," position:relative;&:hover{z-index:100;}"],(e=>`\n    height: ${null!=e.height?e.height:d};\n  `));p.displayName="WrappedByAutoSizer";const m=s.a.memo(p);let f;!function(e){e.BAR="bar",e.AREA="area",e.LINE="line"}(f||(f={}));const g={chartMargins:{left:0,right:0,top:4,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.05}},b=()=>({baseTheme:Object(c.n)(u.C)?a.DARK_THEME:a.LIGHT_THEME,theme:g}),y={rotation:0,rendering:"canvas",showLegend:!1,showLegendExtra:!1,debug:!1,legendPosition:a.Position.Bottom},v=(e,t)=>{const n=e||t;return n?`${n}px`:d},h=(e,t)=>{const n=e||t;return n?`${n}px`:"100%"},E=e=>Array.isArray(e)&&e.every((e=>Array.isArray(e.value)&&e.value.every((({y:e})=>0===e)))),x=l.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1gxuxf9-1"})(["position:relative;"]),j=l()(i.EuiFlexGroup).withConfig({displayName:"ChartWrapper",componentId:"sc-1gxuxf9-2"})(["z-index:0;"]),O=l()(i.EuiFlexGroup).withConfig({displayName:"BarChartWrapper",componentId:"sc-1gxuxf9-3"})(["z-index:0;padding-right:20px;"])},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return c}));var a=n(5);let i,r;!function(e){e.rules="rules",e.alertsCases="alertsCases"}(i||(i={})),function(e){e[e.none=0]="none",e[e.pointToAlertName=1]="pointToAlertName",e[e.expandEvent=2]="expandEvent",e[e.reviewAlertDetailsFlyout=3]="reviewAlertDetailsFlyout",e[e.addAlertToCase=4]="addAlertToCase",e[e.createCase=5]="createCase",e[e.submitCase=6]="submitCase",e[e.viewCase=7]="viewCase"}(r||(r={}));const s={minWidth:360,maxWidth:360,offset:10,repositionOnScroll:!0,ownFocus:!0,initialFocus:'[tour-step="nextButton"]'},o=(e,t)=>`tourStepAnchor-${t}-${e}`,l=[{...s,step:r.pointToAlertName,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourTitle",{defaultMessage:"Examine the Alerts Table"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.ruleNameStep.tourContent",{defaultMessage:"To help you practice triaging alerts, here is the alert from the rule that we enabled in the previous step."}),anchorPosition:"downCenter",dataTestSubj:o(r.pointToAlertName,i.alertsCases),initialFocus:'button[tour-step="nextButton"]'},{...s,step:r.expandEvent,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourTitle",{defaultMessage:"Review the alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.openFlyout.tourContent",{defaultMessage:"Some information is provided at-a-glance in the table, but for full details, you'll want to open the alert."}),anchorPosition:"rightUp",dataTestSubj:o(r.expandEvent,i.alertsCases)},{...s,step:r.reviewAlertDetailsFlyout,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourTitle",{defaultMessage:"Explore alert details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.flyoutOverview.tourContent",{defaultMessage:"Learn more about alerts by checking out all the information available."}),anchor:`[tour-step="${o(r.reviewAlertDetailsFlyout,i.alertsCases)}"] span.euiTab__content`,offset:20,anchorPosition:"leftUp",dataTestSubj:o(r.reviewAlertDetailsFlyout,i.alertsCases)},{...s,step:r.addAlertToCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.addToCase.tourContent",{defaultMessage:'From the Take action menu, select "Add to new case".'}),anchorPosition:"upRight",dataTestSubj:o(r.addAlertToCase,i.alertsCases)},{...s,step:r.createCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourTitle",{defaultMessage:"Add Case details"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.tourContent",{defaultMessage:"Provide the relevant information to create the case. We have included sample text for you."}),anchor:'[tour-step="create-case-flyout"] label',anchorPosition:"leftUp",dataTestSubj:o(r.createCase,i.alertsCases),offset:20,repositionOnScroll:!1},{...s,step:r.submitCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourTitle",{defaultMessage:"Create a case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.submitCase.tourContent",{defaultMessage:'Press "Create case" to continue.'}),anchor:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]',anchorPosition:"leftUp",hideNextButton:!0,dataTestSubj:o(r.submitCase,i.alertsCases),offset:20,ownFocus:!1,initialFocus:'[tour-step="create-case-flyout"] [tour-step="create-case-submit"]'},{...s,step:r.viewCase,title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourTitle",{defaultMessage:"View the case"}),content:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.viewCase.tourContent",{defaultMessage:"Cases are shown under Insights, in the alert details."}),anchorPosition:"rightUp",dataTestSubj:o(r.viewCase,i.alertsCases)}],u={title:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.title",{defaultMessage:"This is a test case"}),description:a.i18n.translate("xpack.securitySolution.guided_onboarding.tour.createCase.description",{defaultMessage:"Add a description and other relevant information. The alert will be added to the case."})},c={[i.rules]:[],[i.alertsCases]:l}},,function(e,t,n){"use strict";e.exports=n(613)},function(e,t,n){"use strict";e.exports=n(619)},function(e,t,n){"use strict";const a=n(624);e.exports=function(e,...t){if(!e){if(1===t.length&&t[0]instanceof Error)throw t[0];throw new a(t)}}},,function(e,t,n){"use strict";n.d(t,"k",(function(){return i})),n.d(t,"l",(function(){return r})),n.d(t,"m",(function(){return s})),n.d(t,"n",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"f",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"j",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return v})),n.d(t,"o",(function(){return h}));var a=n(4);const i="matched.atomic",r="matched.field",s="matched.id",o="matched.type",l=[i,r,o],u=`${a.rb}.${r}`,c=`${a.rb}.${o}`,d="indicator.first_seen",p="indicator.reference",m="feed.name",f=`${a.rb}.${p}`;let g;!function(e){e.InvestigationTime="investigation_time",e.IndicatorMatchRule="indicator_match_rule"}(g||(g={}));const b={"file.hash.md5":`${a.J}.file.hash.md5`,"file.hash.sha1":`${a.J}.file.hash.sha1`,"file.hash.sha256":`${a.J}.file.hash.sha256`,"file.pe.imphash":`${a.J}.file.pe.imphash`,"file.elf.telfhash":`${a.J}.file.elf.telfhash`,"file.hash.ssdeep":`${a.J}.file.hash.ssdeep`,"source.ip":`${a.J}.ip`,"destination.ip":`${a.J}.ip`,"url.full":`${a.J}.url.full`,"registry.path":`${a.J}.registry.path`},y="now-30d",v="now",h="_others_ti_"},function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var a=n(46),i=n(120);a.string,a.boolean;const r=a.string,s=(a.union([r,a[void 0]]),i.m),o=a.keyof({open:null,closed:null,acknowledged:null,"in-progress":null}),l=a.keyof({abort:null,proceed:null}),u=a.array(a.string),c=a.object,d=a.array(a.string),p=a.record(a.string,a.type({all:a.boolean,maintenance:a.boolean,manage_ilm:a.boolean,read:a.boolean,create_index:a.boolean,read_cross_cluster:a.boolean,index:a.boolean,monitor:a.boolean,delete:a.boolean,manage:a.boolean,delete_index:a.boolean,create_doc:a.boolean,view_index_metadata:a.boolean,create:a.boolean,manage_follow_index:a.boolean,manage_leader_index:a.boolean,write:a.boolean})),m=(a.type({username:a.string,has_all_requested:a.boolean,cluster:a.type({monitor_ml:a.boolean,manage_ccr:a.boolean,manage_index_templates:a.boolean,monitor_watcher:a.boolean,monitor_transform:a.boolean,read_ilm:a.boolean,manage_security:a.boolean,manage_own_api_key:a.boolean,manage_saml:a.boolean,all:a.boolean,manage_ilm:a.boolean,manage_ingest_pipelines:a.boolean,read_ccr:a.boolean,manage_rollup:a.boolean,monitor:a.boolean,manage_watcher:a.boolean,manage:a.boolean,manage_transform:a.boolean,manage_token:a.boolean,manage_ml:a.boolean,manage_pipeline:a.boolean,monitor_rollup:a.boolean,transport_client:a.boolean,create_snapshot:a.boolean}),index:p,is_authenticated:a.boolean,has_encryption_key:a.boolean}),a.type({tags_to_add:a.array(a.string),tags_to_remove:a.array(a.string)}));a.string},function(e,t,n){e.exports=n(24)(288)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(45);const l=s.a.div.withConfig({displayName:"StyledDiv",componentId:"sc-we8ln-0"})(["width:100%;display:flex;flex-grow:1;> *{max-width:100%;}",""],(({targetClassNames:e})=>Object(r.css)(["","{pointer-events:none;opacity:0;transition:opacity "," ease;}","{pointer-events:auto;opacity:1;}"],e.map((e=>`.${e}`)).join(", "),(e=>Object(o.getOr)(250,"theme.eui.euiAnimSpeedNormal",e)),e.map((e=>`&:hover .${e}`)).join(", ")))),u=i.a.memo((({show:e=!0,targetClassNames:t,children:n})=>e?i.a.createElement(l,{"data-test-subj":"hoverVisibilityContainer",targetClassNames:t},n):i.a.createElement(i.a.Fragment,null,n)));u.displayName="HoverVisibilityContainer"},function(e,t,n){"use strict";n.d(t,"c",(function(){return h})),n.d(t,"l",(function(){return K})),n.d(t,"m",(function(){return S})),n.d(t,"a",(function(){return k})),n.d(t,"b",(function(){return T})),n.d(t,"e",(function(){return J})),n.d(t,"f",(function(){return Y})),n.d(t,"g",(function(){return X})),n.d(t,"h",(function(){return I})),n.d(t,"i",(function(){return M})),n.d(t,"n",(function(){return Z})),n.d(t,"t",(function(){return ee})),n.d(t,"r",(function(){return te})),n.d(t,"p",(function(){return ne})),n.d(t,"o",(function(){return re})),n.d(t,"s",(function(){return se})),n.d(t,"q",(function(){return oe})),n.d(t,"j",(function(){return ue})),n.d(t,"k",(function(){return ce})),n.d(t,"d",(function(){return l}));var a=n(120),i=n(46);const r=i.recursion("saved_object_attribute_single",(()=>i.union([i.string,i.number,i.boolean,i.null,i[void 0],o]))),s=i.recursion("saved_object_attribute",(()=>i.union([r,i.array(r)]))),o=i.recursion("saved_object_attributes",(()=>i.record(i.string,s))),l=i.union([i.literal("no_actions"),i.literal("rule"),Object(a.p)({allowedUnits:["s","m","h","d"]})]),u=i.boolean,c=i.union([i.literal("onActionGroupChange"),i.literal("onActiveAlert"),i.literal("onThrottleInterval")]),d=i.type({summary:u,notifyWhen:c,throttle:i.union([l,i.null])}),p=i.string,m=i.string,f=i.string,g=a.j,b=o,y=i.partial({query:i.union([i[void 0],i.intersection([i.strict({kql:i.string,filters:i.array(i.intersection([i.type({meta:i.partial({alias:i.union([i.string,i.null]),disabled:i.boolean,negate:i.boolean,controlledBy:i.string,group:i.string,index:i.string,isMultiIndex:i.boolean,type:i.string,key:i.string,params:i.any,value:i.string})}),i.partial({$state:i.type({store:i.any}),query:i.record(i.string,i.any)})]))}),i.partial({dsl:i.string})])]),timeframe:i.union([i[void 0],i.strict({timezone:i.string,days:i.array(i.union([i.literal(1),i.literal(2),i.literal(3),i.literal(4),i.literal(5),i.literal(6),i.literal(7)])),hours:i.strict({start:i.string,end:i.string})})])}),v=i.exact(i.intersection([i.type({group:p,id:m,action_type_id:f,params:b}),i.partial({uuid:g,alerts_filter:y,frequency:d})])),h=i.array(v),E=i.exact(i.intersection([i.type({group:p,id:m,actionTypeId:f,params:b}),i.partial({uuid:g,alertsFilter:y,frequency:d})]));i.array(E),new i.Type("DefaultActionsArray",h.is,((e,t)=>null==e?i.success([]):h.validate(e,t)),i.identity),new i.Type("DefaultExportFileName",i.string.is,((e,t)=>null==e?i.success("export.ndjson"):i.string.validate(e,t)),i.identity);var x=n(437);const j=new i.Type("From",i.string.is,((e,t)=>(e=>"string"==typeof e)(e)&&null==Object(x.a)(e)?i.failure(e,t,'Failed to parse "from" on rule param'):i.string.validate(e,t)),i.identity),O=(new i.Type("DefaultFromString",i.string.is,((e,t)=>null==e?i.success("now-6m"):j.validate(e,t)),i.identity),new i.Type("DefaultIntervalString",i.string.is,((e,t)=>null==e?i.success("5m"):i.string.validate(e,t)),i.identity),i.keyof({eql:null,kuery:null,lucene:null,esql:null})),S=(i.union([O,i[void 0]]),new i.Type("DefaultLanguageString",i.string.is,((e,t)=>null==e?i.success("kuery"):O.validate(e,t)),i.identity),a.n),k=(i.union([S,i[void 0]]),new i.Type("DefaultMaxSignals",i.number.is,((e,t)=>null==e?i.success(100):S.validate(e,t)),i.identity),new i.Type("DefaultPerPage",i.number.is,((e,t)=>null==e?i.success(1):"string"==typeof e?a.n.validate(parseInt(e,10),t):a.n.validate(e,t)),i.identity),new i.Type("DefaultPerPage",i.number.is,((e,t)=>null==e?i.success(20):"string"==typeof e?a.n.validate(parseInt(e,10),t):a.n.validate(e,t)),i.identity),new i.Type("RiskScore",i.number.is,((e,t)=>"number"==typeof e&&Number.isSafeInteger(e)&&e>=0&&e<=100?i.success(e):i.failure(e,t)),i.identity)),w=i.exact(i.type({field:i.string,value:i.string,operator:a.t,risk_score:i.union([k,i[void 0]])})),T=i.array(w),I=(new i.Type("DefaultRiskScoreMappingArray",T.is,((e,t)=>null==e?i.success([]):T.validate(e,t)),i.identity),i.keyof({low:null,medium:null,high:null,critical:null})),C=i.exact(i.type({field:i.string,operator:a.t,value:i.string,severity:I})),M=i.array(C),_=(new i.Type("DefaultSeverityMappingArray",M.is,((e,t)=>null==e?i.success([]):M.validate(e,t)),i.identity),i.string),A=i.string,P=i.string,F=i.type({id:_,name:A,reference:P}),D=i.string,N=i.string,R=i.string,L=i.type({id:D,name:N,reference:R}),z=i.array(L),B=i.string,q=i.string,$=i.string,V=i.intersection([i.exact(i.type({id:B,name:q,reference:$})),i.exact(i.partial({subtechnique:z}))]),U=i.array(V),H=i.string,Z=i.intersection([i.exact(i.type({framework:H,tactic:F})),i.exact(i.partial({technique:U}))]),G=i.array(Z);i.union([G,i[void 0]]),new i.Type("DefaultThreatArray",G.is,((e,t)=>null==e?i.success([]):G.validate(e,t)),i.identity),new i.Type("DefaultToString",i.string.is,((e,t)=>null==e?i.success("now"):i.string.validate(e,t)),i.identity);var Q=n(51);new i.Type("DefaultUuid",i.string.is,((e,t)=>null==e?i.success(Object(Q.v4)()):a.j.validate(e,t)),i.identity);const W=Object(a.i)(i.string),K=(i.union([W,i[void 0]]),i.union([i.string,W])),J=(i.union([K,i[void 0]]),new i.Type("referencesWithDefaultArray",i.array(i.string).is,((e,t)=>null==e?i.success([]):i.array(i.string).validate(e,t)),i.identity),i.string),Y=j,X=i.string,ee=i.string,te=(i.union([ee,i[void 0]]),i.string),ne=(i.union([te,i[void 0]]),i.array(i.unknown)),ae=(i.union([ne,i[void 0]]),i.exact(i.type({field:a.j,type:i.keyof({mapping:null}),value:a.j}))),ie=i.array(ae),re=i.exact(i.type({entries:ie})),se=Object(a.i)(re,"NonEmptyArray<ThreatMap>"),oe=(i.union([se,i[void 0]]),i.array(i.string)),le=(i.union([oe,i[void 0]]),i.union([O,i[void 0]])),ue=(i.union([le,i[void 0]]),a.n),ce=(i.union([ue,i[void 0]]),a.n),de=(i.union([ce,i[void 0]]),i.keyof({eql:null,machine_learning:null,query:null,saved_query:null,threshold:null,threat_match:null,new_terms:null,esql:null}));i.union([de,i[void 0]])},function(e,t,n){"use strict";n.d(t,"v",(function(){return o})),n.d(t,"y",(function(){return l})),n.d(t,"t",(function(){return u})),n.d(t,"o",(function(){return c})),n.d(t,"A",(function(){return d})),n.d(t,"z",(function(){return m})),n.d(t,"s",(function(){return f})),n.d(t,"r",(function(){return g})),n.d(t,"n",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"x",(function(){return v})),n.d(t,"h",(function(){return h})),n.d(t,"E",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"e",(function(){return S})),n.d(t,"j",(function(){return k})),n.d(t,"F",(function(){return w})),n.d(t,"g",(function(){return T})),n.d(t,"c",(function(){return I})),n.d(t,"w",(function(){return C})),n.d(t,"q",(function(){return M})),n.d(t,"u",(function(){return _})),n.d(t,"L",(function(){return A})),n.d(t,"M",(function(){return P})),n.d(t,"m",(function(){return D})),n.d(t,"I",(function(){return N})),n.d(t,"J",(function(){return R})),n.d(t,"D",(function(){return L})),n.d(t,"C",(function(){return z})),n.d(t,"B",(function(){return B})),n.d(t,"l",(function(){return $})),n.d(t,"d",(function(){return U})),n.d(t,"K",(function(){return H})),n.d(t,"H",(function(){return Z})),n.d(t,"k",(function(){return Q})),n.d(t,"f",(function(){return W})),n.d(t,"a",(function(){return ee})),n.d(t,"G",(function(){return ie})),n.d(t,"N",(function(){return Xe})),n.d(t,"i",(function(){return nt}));var a=n(46),i=n(139),r=n(120),s=n(277);const o=r.q,l=a.string,u=r.j,c=r.j,d=r.w,p=(a.boolean,a.boolean),m=a.array(a.string),f=a.UnknownRecord,g=a.string,b=a.array(a.string),y=a.array(a.string),v=a.array(a.string),h=a.string,E=a.string,x=a.string,j=a.string,O=a.string,S=i.y,k=s.m,w=a.array(s.n),T=a.array(a.string),I=a.string,C=a.string,M=a.array(a.unknown),_=a.string,A=a.string,P=a.boolean,F=a.exact(a.type({name:r.j,type:r.j,ecs:a.boolean})),D=a.array(F),N=a.string,R=a.string,L=a.union([a.literal("exactMatch"),a.literal("aliasMatch"),a.literal("conflict")]),z=a.string,B=a.union([a.literal("savedObjectConversion"),a.literal("savedObjectImport")]),q=a.exact(a.intersection([a.type({package:r.j,version:r.j}),a.partial({integration:r.j})])),$=a.array(q),V=a.exact(a.type({field_names:Object(r.i)(r.j)})),U=a.string,H=a.string,Z=a.string;var G=n(4);const Q=Object(r.h)({codec:a.string,minSize:1,maxSize:G.Mb}),W=r.j;var K=n(323);const J=Object(r.r)("AlertSuppressionMissingFields",K.b),Y=Object(r.h)({codec:a.string,minSize:1,maxSize:3}),X=a.type({value:r.n,unit:a.keyof({s:null,m:null,h:null})}),ee=a.intersection([a.exact(a.type({group_by:Y})),a.exact(a.partial({duration:X,missing_fields_strategy:J}))]),te=(a.intersection([a.exact(a.type({groupBy:Y})),a.exact(a.partial({duration:X,missingFieldsStrategy:J}))]),a.exact(a.type({field:a.union([a.string,a.array(a.string)]),value:r.n}))),ne=a.exact(a.type({field:a.array(a.string),value:r.n})),ae=a.exact(a.type({field:a.string,value:r.m})),ie=a.intersection([te,a.exact(a.partial({cardinality:a.array(ae)}))]);a.intersection([ne,a.exact(a.partial({cardinality:a.array(ae)}))]),a.intersection([ne,a.exact(a.type({cardinality:a.array(ae)}))]),n(9);var re=n(180);const se=e=>""===e;a.brand(a.string,(e=>{return!se(t=e)&&!t.includes(" ")&&!t.split(",").some(se);var t}),"IndexPattern"),new a.Type("JSON",a.any.is,((e,t)=>re.either.chain(a.string.validate(e,t),(n=>{try{return a.success(JSON.parse(n))}catch(n){return a.failure(e,t)}}))),(e=>JSON.stringify(e))),new a.Type("isoToEpochRt",a.number.is,((e,t)=>re.either.chain(a.string.validate(e,t),(n=>{const i=new Date(n).getTime();return isNaN(i)?a.failure(e,t):a.success(i)}))),(e=>new Date(e).toISOString())),new a.Type("ToNumber",a.number.is,((e,t)=>{const n=Number(e);return isNaN(n)?a.failure(e,t):a.success(n)}),a.identity),new a.Type("ToBoolean",a.boolean.is,(e=>{let t;return t="string"==typeof e?"true"===e:!!e,a.success(t)}),a.identity),a.brand(a.string,(e=>e.length>0),"NonEmptyString");var oe=n(240);var le=n(56),ue=n.n(le);a.brand(a.string,(e=>ue()(e,!0).isValid()),"Date");var ce=n(65),de=n.n(ce);new a.Type("datemath",a.string.is,((e,t)=>Object(oe.pipe)(a.string.validate(e,t),Object(re.chain)((e=>(e=>{const t=de.a.parse(e);return!(!t||!t.isValid())})(e)?a.success(e):a.failure(e,t))))),String),n(280);const pe=/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3,9}Z$/,me=new a.Type("DateFromStringOrNumber",(e=>"string"==typeof e),((e,t)=>"string"==typeof e?pe.test(e)?a.success(e):a.failure(e,t):Object(oe.pipe)(a.number.validate(e,t),Object(re.chain)((e=>{const n=ue()(e);return n.isValid()?a.success(n.toISOString()):a.failure(e,t)})))),String),fe=a.type({time:me,tiebreaker:a.number}),ge=(a.intersection([fe,a.partial({gid:a.string,fromAutoReload:a.boolean})]),a.string),be=(a.union([ge,a[void 0]]),a.type({agents:a.array(a.string),allAgentsSelected:a.boolean,platformsSelected:a.array(a.string),policiesSelected:a.array(a.string)})),ye=(a.union([be,a[void 0]]),a.string),ve=(a.union([ye,a[void 0]]),a.string),he=a.union([ve,a[void 0]]),Ee=a.string,xe=(a.union([Ee,a[void 0]]),a.string),je=a.union([xe,a[void 0]]),Oe=a.string,Se=(a.union([Oe,a[void 0]]),Re=60,Le=900,new a.Type("InRange",(e=>"number"==typeof e&&e>=Re&&e<=Le),((e,t)=>"number"==typeof e&&e>=Re&&e<=Le?a.success(e):a.failure(e,t)),a.identity)),ke=(a.union([Se,a[void 0]]),a.boolean),we=a.union([ke,a[void 0]]),Te=a.boolean,Ie=a.union([Te,a[void 0]]),Ce=a.string,Me=a.union([Ce,a[void 0]]),_e=a.string,Ae=(a.union([_e,a[void 0]]),a.type({name:a.union([a.string,a[void 0]]),url:a.union([a.string,a[void 0]])})),Pe=(a.union([Ae,a[void 0]]),a.record(a.string,a.partial({field:a.string,value:a.union([a.string,a.array(a.string)])}))),Fe=a.union([Pe,a[void 0]]),De=(a.union([a.array(a.string),a[void 0]]),a.array(a.type({id:ge,query:Ee,ecs_mapping:Fe,version:je,platform:he,removed:Ie,snapshot:we}))),Ne=a.record(a.string,a.type({query:Ee,id:ge,ecs_mapping:Fe,version:je,platform:he,saved_query_id:Me,removed:Ie,snapshot:we}));var Re,Le;a.union([De,Ne]),a.union([De,a[void 0]]);var ze=n(420);const Be=a.type({command:a.keyof((qe=ze.a,Object.fromEntries(qe.map((e=>[e,null]))))),comment:a.union([a.string,a[void 0]])});var qe;const $e=a.type({query:a.union([a.string,a[void 0]]),ecs_mapping:a.union([Pe,a[void 0]]),queries:a.union([De,a[void 0]]),pack_id:a.union([a.string,a[void 0]]),saved_query_id:a.union([a.string,a[void 0]])}),Ve=a.type({query:a.union([a.string,a[void 0]]),ecsMapping:a.union([Pe,a[void 0]]),queries:a.union([De,a[void 0]]),packId:a.union([a.string,a[void 0]]),savedQueryId:a.union([a.string,a[void 0]])}),Ue=a.strict({actionTypeId:a.literal(".osquery"),params:Ve}),He=a.strict({actionTypeId:a.literal(".endpoint"),params:Be}),Ze=a.union([Ue,He]),Ge=(a.union([a.array(Ze),a[void 0]]),a.strict({action_type_id:a.literal(".osquery"),params:$e})),Qe=a.strict({action_type_id:a.literal(".endpoint"),params:Be}),We=a.union([Ge,Qe]),Ke=a.array(We);var Je=n(273);const Ye=({required:e,optional:t,defaultable:n})=>({create:a.intersection([a.exact(a.type(e)),a.exact(a.partial(t)),a.exact(a.partial(n))]),patch:a.intersection([a.partial(e),a.partial(t),a.partial(n)]),response:a.intersection([a.exact(a.type(e)),a.exact(a.type(Xe(t))),a.exact(a.type(n))])}),Xe=e=>Object.keys(e).reduce(((t,n)=>(t[n]=a.union([e[n],a[void 0]]),t)),{}),et=Ye({required:{name:u,description:c,risk_score:s.a,severity:s.h},optional:{rule_name_override:_,timestamp_override:A,timestamp_override_fallback_disabled:P,timeline_id:N,timeline_title:R,outcome:L,alias_target_id:z,alias_purpose:B,license:g,note:h,building_block_type:x,output_index:j,namespace:O,meta:f,investigation_fields:V,throttle:s.d},defaultable:{version:d,tags:m,enabled:p,risk_score_mapping:s.b,severity_mapping:s.i,interval:s.e,from:s.f,to:s.g,actions:s.c,exceptions_list:S,author:b,false_positives:y,references:v,max_signals:k,threat:w}}),tt=r.m,nt=(a.partial({total_search_duration_ms:tt,total_indexing_duration_ms:tt,total_enrichment_duration_ms:tt,execution_gap_duration_s:tt}),et.create,a.intersection([et.create,a.exact(a.partial({rule_id:l}))]),a.keyof({kuery:null,lucene:null})),at=a.literal("eql"),it=Ye({required:{type:a.literal("eql"),language:at,query:C},optional:{index:T,data_view_id:I,filters:M,timestamp_field:H,event_category_override:U,tiebreaker_field:Z},defaultable:{}}),rt=a.literal("esql"),st=Ye({required:{type:a.literal("esql"),language:rt,query:C},optional:{},defaultable:{}}),ot=Ye({required:{type:a.literal("threat_match"),query:C,threat_query:s.t,threat_mapping:s.s,threat_index:s.q},optional:{index:T,data_view_id:I,filters:M,saved_id:Je.e,threat_filters:s.p,threat_indicator_path:s.r,threat_language:nt,concurrent_searches:s.j,items_per_search:s.k},defaultable:{language:nt}}),lt=Ye({required:{type:a.literal("query")},optional:{index:T,data_view_id:I,filters:M,saved_id:Je.e,response_actions:Ke,alert_suppression:ee},defaultable:{query:C,language:nt}}),ut=Ye({required:{type:a.literal("saved_query"),saved_id:Je.e},optional:{index:T,data_view_id:I,query:C,filters:M,response_actions:Ke,alert_suppression:ee},defaultable:{language:nt}}),ct=Ye({required:{type:a.literal("threshold"),query:C,threshold:ie},optional:{index:T,data_view_id:I,filters:M,saved_id:Je.e},defaultable:{language:nt}}),dt=Ye({required:{type:a.literal("machine_learning"),anomaly_threshold:Je.c,machine_learning_job_id:s.l},optional:{},defaultable:{}}),pt=Ye({required:{type:a.literal("new_terms"),query:C,new_terms_fields:Q,history_window_start:W},optional:{index:T,data_view_id:I,filters:M},defaultable:{language:nt}});a.union([it.create,st.create,ot.create,lt.create,ut.create,ct.create,dt.create,pt.create])},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return g}));var a=n(65),i=n.n(a),r=n(56),s=n.n(r),o=n(45),l=n(634),u=n(4),c=n(110);const d=s()().subtract(24,"hours"),p=s()(),m=(e=!0)=>{const t=e?c.b.get().uiSettings.get(u.A):null,n=Object(o.isString)(null==t?void 0:t.from)&&(null==t?void 0:t.from)||u.H,a=Object(o.isString)(null==t?void 0:t.to)&&(null==t?void 0:t.to)||u.Y,i=g(n,d).toISOString(),r=g(a,p,!0).toISOString();return{from:i,fromStr:n,to:r,toStr:a,socTrends:Object(l.b)({to:r,from:i})}},f=(e=!0)=>{const t=e?c.b.get().uiSettings.get(u.z):null,n=Object(o.isNumber)(null==t?void 0:t.value)&&(null==t?void 0:t.value)||u.L;return{kind:!Object(o.isBoolean)(null==t?void 0:t.pause)||null!=t&&t.pause?u.K:"interval",duration:n}},g=(e,t,n=!1,a,r)=>{const s=i.a.parse(e,{roundUp:n,momentInstance:a,forceNow:r});return null!=s&&s.isValid()?s:t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(0),i=n.n(a),r=n(122);const s=new class ActiveTimelineEvents{constructor(){i()(this,"_activePage",0),i()(this,"_expandedDetail",{}),i()(this,"_pageName",""),i()(this,"_request",null),i()(this,"_response",null),i()(this,"_eqlRequest",null),i()(this,"_eqlResponse",null)}getActivePage(){return this._activePage}setActivePage(e){this._activePage=e}getExpandedDetail(){return this._expandedDetail}toggleExpandedDetail(e){const t=r.d.query,n=this._expandedDetail[t];let a;var i,s;if("eventDetail"===(null==n?void 0:n.panelView))a="eventDetail"===(null==e?void 0:e.panelView)&&(null==e||null===(i=e.params)||void 0===i?void 0:i.eventId)===(null==n||null===(s=n.params)||void 0===s?void 0:s.eventId);else if("hostDetail"===(null==n?void 0:n.panelView)){var o,l;a="hostDetail"===(null==e?void 0:e.panelView)&&(null==e||null===(o=e.params)||void 0===o?void 0:o.hostName)===(null==n||null===(l=n.params)||void 0===l?void 0:l.hostName)}else if("networkDetail"===(null==n?void 0:n.panelView)){var u,c;a="networkDetail"===(null==e?void 0:e.panelView)&&(null==e||null===(u=e.params)||void 0===u?void 0:u.ip)===(null==n||null===(c=n.params)||void 0===c?void 0:c.ip)}this._expandedDetail=a?{}:{[t]:{...e}}}setExpandedDetail(e){this._expandedDetail=e}getPageName(){return this._pageName}setPageName(e){this._pageName=e}getRequest(){return this._request}setRequest(e){this._request=e}getResponse(){return this._response}setResponse(e){this._response=e}getEqlRequest(){return this._eqlRequest}setEqlRequest(e){this._eqlRequest=e}getEqlResponse(){return this._eqlResponse}setEqlResponse(e){this._eqlResponse=e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p}));var a=n(45),i=n(2),r=n(873),s=n.n(r),o=n(62),l=n(78),u=n.n(l);const c=(e,t)=>{const n=null!=t?t:((e,t)=>{const n=t.diff(e,"days");return n<=1&&!e.isSame(t)?2:n})(u()(e[0]),u()(e[1])),a=Object(o.niceTimeFormatByDay)(n);return Object(o.timeFormatter)(a)},d=(e=100)=>{const[t,n]=Object(i.useState)({width:0,height:0}),r=Object(i.useMemo)((()=>Object(a.throttle)(e,n)),[e]),{ref:o}=s()({onResize:r});return{ref:o,...t}},p=(e,t,n,a)=>{Object(i.useEffect)((()=>{!async function(){const i=await(null==e?void 0:e.getVariation(t,n));i&&a(i)}()}),[e,t,n,a])}},function(e,t,n){"use strict";n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"f",(function(){return b}));var a=n(2),i=n.n(a),r=n(17),s=n(44),o=n.n(s),l=n(47),u=n(126);const c=({children:e,...t})=>i.a.createElement(r.EuiButton,t,e),d=({children:e,...t})=>i.a.createElement(r.EuiLink,t,e),p=o()("span").withConfig({displayName:"Comma",componentId:"sc-11tqw5g-0"})(["margin-right:5px;margin-left:5px;&::after{content:' ,';}"]);p.displayName="Comma";const m=({children:e,Component:t,dataTestSubj:n,href:a,onClick:r,title:s,iconType:o="expand"})=>t?i.a.createElement(t,{"data-test-subj":n,href:a,iconType:o,onClick:r,title:s},null!=s?s:e):i.a.createElement(c,{"data-test-subj":n,href:a,onClick:r},null!=s?s:e),f=i.a.memo(m),g=o.a.div.withConfig({displayName:"PortContainer",componentId:"sc-11tqw5g-1"})(["& svg{position:relative;top:-1px;}"]),b=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t=5,render:n,rowItems:s})=>{const[o,u]=Object(a.useState)(!1),c=Object(a.useCallback)((()=>u((e=>!e))),[]),d=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null," ,",i.a.createElement(r.EuiButtonEmpty,{size:"xs",onClick:c},`+${s.length-t} `,i.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.reputationLinks.moreLabel",defaultMessage:"More"})))),[c,t,s.length]);return i.a.createElement(r.EuiFlexItem,{grow:!1},s.length>t&&i.a.createElement(r.EuiPopover,{id:"popover",button:d,isOpen:o,closePopover:c,repositionOnScroll:!0,panelClassName:"withHoverActions__popover"},i.a.createElement(y,{render:n,rowItems:s,moreMaxHeight:e,overflowIndexStart:t})))}));b.displayName="ReputationLinksOverflow";const y=i.a.memo((({moreMaxHeight:e,overflowIndexStart:t,render:n,rowItems:s})=>{const o=Object(a.useMemo)((()=>s.slice(t).map(((e,t)=>{var a;return i.a.createElement(r.EuiFlexItem,{grow:1,key:`${e}-${t}`},null!==(a=n&&n(e))&&void 0!==a?a:Object(u.a)(e))}))),[t,n,s]);return i.a.createElement("div",{"data-test-subj":"more-container",className:"eui-yScroll",style:{maxHeight:e,paddingRight:"2px"}},i.a.createElement(r.EuiFlexGroup,{gutterSize:"s",direction:"column","data-test-subj":"overflow-items"},o))}));y.displayName="MoreReputationLinksContainer"},,function(e,t,n){"use strict";var a=n(1183);e.exports=function(e,t,n,i){var r,s=e.length,o=0;if(t=t<0?-t>s?0:s+t:t>s?s:t,n=n>0?n:0,i.length<1e4)(r=Array.from(i)).unshift(t,n),a.apply(e,r);else for(n&&a.apply(e,[t,n]);o<i.length;)(r=i.slice(o,o+1e4)).unshift(t,0),a.apply(e,r),o+=1e4,t+=1e4}},function(e,t,n){"use strict";e.exports=function(e){return e<0||32===e}},function(e,t,n){"use strict";var a=n(533);e.exports=function(e){return function(t){return e.test(a(t))}}},function(e,t,n){"use strict";n.d(t,"g",(function(){return c.a})),n.d(t,"a",(function(){return d.b})),n.d(t,"b",(function(){return d.c})),n.d(t,"c",(function(){return d.d})),n.d(t,"d",(function(){return d.f})),n.d(t,"e",(function(){return p.f})),n.d(t,"f",(function(){return p.g}));var a=n(111),i=n(141);const r=a.z.object({add:a.z.array(i.m),remove:a.z.array(i.m)}),s=a.z.array(i.m).min(1);a.z.object({assignees:r,ids:s});var o=n(46),l=(n(264),n(247)),u=(n(299),n(370),n(273)),c=n(248);n(371),o.exact(o.type({tags:u.b,ids:u.a})),n(481),n(341),n(389);var d=n(191),p=n(290);l.e.and(l.f).and(a.object({invocationCount:a.number(),timeframeEnd:a.string()}));var m=n(120);o.exact(o.partial({query:o.object,aggs:o.object,size:m.m,track_total_hits:o.boolean,_source:o.union([o.boolean,o.string,o.array(o.string)]),fields:o.array(o.string),runtime_mappings:o.unknown,sort:o.object})),o.intersection([o.type({status:u.h}),o.partial({conflicts:u.d,signal_ids:u.f,query:u.g})]);const f=o.partial({requests_per_second:o.number,size:m.n,slices:m.m});o.intersection([o.exact(o.type({index:o.array(o.string)})),o.exact(f)]),o.exact(o.type({migration_ids:o.array(o.string)})),o.exact(o.type({migration_ids:o.array(o.string)}));var g=n(277);o.exact(o.type({from:g.f}))},function(e,t,n){"use strict";n.d(t,"h",(function(){return x})),n.d(t,"i",(function(){return j})),n.d(t,"j",(function(){return O})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"c",(function(){return S})),n.d(t,"f",(function(){return y.a})),n.d(t,"g",(function(){return y.b})),n.d(t,"a",(function(){return k}));var a=n(46),i=n(120);let r,s;!function(e){e.last_hour="last_hour",e.last_day="last_day",e.last_week="last_week",e.last_month="last_month",e.last_year="last_year",e.custom_range="custom_range"}(r||(r={})),function(e){e.minute="minute",e.hour="hour",e.day="day",e.week="week",e.month="month"}(s||(s={}));const o=a.union([a.exact(a.type({type:a.literal(r.last_hour),granularity:a.literal(s.minute)})),a.exact(a.type({type:a.literal(r.last_day),granularity:a.union([a.literal(s.minute),a.literal(s.hour)])})),a.exact(a.type({type:a.literal(r.last_week),granularity:a.union([a.literal(s.hour),a.literal(s.day)])})),a.exact(a.type({type:a.literal(r.last_month),granularity:a.union([a.literal(s.day),a.literal(s.week)])})),a.exact(a.type({type:a.literal(r.last_year),granularity:a.union([a.literal(s.week),a.literal(s.month)])})),a.exact(a.type({type:a.literal(r.custom_range),granularity:a.union([a.literal(s.minute),a.literal(s.hour),a.literal(s.day),a.literal(s.week),a.literal(s.month)]),from:i.g,to:i.g}))]);a.exact(a.partial({interval:o,debug:a.boolean})),a.exact(a.intersection([a.type({rule_id:i.j}),a.partial({interval:o,debug:a.boolean})])),a.exact(a.partial({interval:o,debug:a.boolean})),a.exact(a.type({}));var l=n(111),u=n(182);const c=l.z.enum(["trace","debug","info","warn","error"]),d=c.enum,p=l.z.enum(["message","status-change","execution-metrics"]),m=p.enum,f=l.z.object({timestamp:l.z.string().datetime(),sequence:l.z.number().int(),level:c,type:p,execution_id:l.z.string().min(1),message:l.z.string()});var g=n(248),b=n(370);l.z.object({search_term:l.z.string().optional(),event_types:Object(u.a)(p).optional().default([]),log_levels:Object(u.a)(c).optional().default([]),date_start:l.z.string().datetime().optional(),date_end:l.z.string().datetime().optional(),sort_order:g.a.optional().default("desc"),page:l.z.coerce.number().int().optional().default(1),per_page:l.z.coerce.number().int().optional().default(20)}),l.z.object({ruleId:l.z.string().min(1)}),l.z.object({events:l.z.array(f),pagination:b.a});var y=n(219);const v=l.z.object({execution_uuid:l.z.string(),timestamp:l.z.string().datetime(),duration_ms:l.z.number().int(),status:l.z.string(),message:l.z.string(),num_active_alerts:l.z.number().int(),num_new_alerts:l.z.number().int(),num_recovered_alerts:l.z.number().int(),num_triggered_actions:l.z.number().int(),num_succeeded_actions:l.z.number().int(),num_errored_actions:l.z.number().int(),total_search_duration_ms:l.z.number().int(),es_search_duration_ms:l.z.number().int(),schedule_delay_ms:l.z.number().int(),timed_out:l.z.boolean(),indexing_duration_ms:l.z.number().int(),search_duration_ms:l.z.number().int(),gap_duration_s:l.z.number().int(),security_status:l.z.string(),security_message:l.z.string()}),h=l.z.enum(["timestamp","duration_ms","gap_duration_s","indexing_duration_ms","search_duration_ms","schedule_delay_ms"]);h.enum,l.z.object({start:l.z.string().datetime(),end:l.z.string().datetime(),query_text:l.z.string().optional().default(""),status_filters:Object(u.a)(y.a).optional().default([]),sort_field:h.optional().default("timestamp"),sort_order:g.a.optional().default("desc"),page:l.z.coerce.number().int().optional().default(1),per_page:l.z.coerce.number().int().optional().default(20)}),l.z.object({ruleId:l.z.string().min(1)}),l.z.object({events:l.z.array(v).optional(),total:l.z.number().int().optional()});var E=n(4);E.Db,E.Db,E.Db;const x=`${E.Db}/health/_setup`,j=(E.Db,e=>`${E.Db}/rules/${e}/execution/events`),O=(E.Db,e=>`${E.Db}/rules/${e}/execution/results`);let S;n(364),function(e){e.trace="trace",e.debug="debug",e.info="info",e.warn="warn",e.error="error",e.off="off"}(S||(S={})),n(143),n(363);const k=c.options},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="row-renderer-example"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return p}));var a=n(17),i=n(2),r=n.n(i),s=n(47),o=n(113),l=n(151),u=n(516);const c={ACTION_MENU:"timeline-action-menu",DATA_VIEW:"timeline-data-view",DATA_PROVIDER:"toggle-data-provider",SAVE_TIMELINE:"save-timeline-action",ADD_TO_FAVORITES:"add-to-favorites"},d=[{title:u.o,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.newTimeline.description",defaultMessage:"Click {newButton} to create a new Timeline. Click {openButton} to open an existing one.",values:{newButton:r.a.createElement(a.EuiCode,null,u.i),openButton:r.a.createElement(a.EuiCode,null,u.k)}})),anchor:c.ACTION_MENU},{title:u.a,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.addToFavorites.description",defaultMessage:"Click to favorite your Timeline so you can quickly find it later."})),anchor:c.ADD_TO_FAVORITES},{timelineTab:l.g.query,title:u.b,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.changeDataView.description",defaultMessage:"Click the {dataViewButton} menu to choose the event or alert data that you want to display.",values:{dataViewButton:r.a.createElement(a.EuiCode,null," ",u.e)}})),anchor:c.DATA_VIEW},{timelineType:o.l.default,timelineTab:l.g.query,title:u.d,content:r.a.createElement(a.EuiText,null,u.c),anchor:c.DATA_PROVIDER},{title:u.m,content:r.a.createElement(a.EuiText,null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.timeline.tour.saveTimeline.description",defaultMessage:"Click {saveButton} to manually save new changes. While saving your Timeline, you can {editButton} its name and description or save it as a new Timeline.",values:{saveButton:r.a.createElement(a.EuiCode,null,u.l),editButton:r.a.createElement(a.EuiCode,null,u.f)}})),anchor:c.SAVE_TIMELINE}],p={currentTourStep:1,isTourActive:!0,tourPopoverWidth:300,tourSubtitle:u.n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.chart.dataAllValuesZerosTitle",{defaultMessage:"All values returned zero"}),r=a.i18n.translate("xpack.securitySolution.chart.dataNotAvailableTitle",{defaultMessage:"Chart Data Not Available"}),s=a.i18n.translate("xpack.securitySolution.chart.emptyValueLabel",{defaultMessage:"empty value"})},function(e,t,n){"use strict";n.d(t,"f",(function(){return a.b})),n.d(t,"g",(function(){return a.c})),n.d(t,"v",(function(){return i.d})),n.d(t,"w",(function(){return i.e})),n.d(t,"D",(function(){return i.k})),n.d(t,"b",(function(){return i.a})),n.d(t,"t",(function(){return i.b})),n.d(t,"B",(function(){return i.i})),n.d(t,"C",(function(){return i.j})),n.d(t,"z",(function(){return i.g})),n.d(t,"A",(function(){return i.h})),n.d(t,"y",(function(){return i.f})),n.d(t,"u",(function(){return i.c})),n.d(t,"h",(function(){return r.a})),n.d(t,"i",(function(){return r.b})),n.d(t,"j",(function(){return r.c})),n.d(t,"l",(function(){return s.c})),n.d(t,"r",(function(){return s.i})),n.d(t,"d",(function(){return s.a})),n.d(t,"e",(function(){return s.b})),n.d(t,"m",(function(){return s.d})),n.d(t,"n",(function(){return s.e})),n.d(t,"o",(function(){return s.f})),n.d(t,"q",(function(){return s.h})),n.d(t,"s",(function(){return s.j})),n.d(t,"p",(function(){return s.g})),n.d(t,"k",(function(){return o.b})),n.d(t,"a",(function(){return o.a})),n.d(t,"x",(function(){return o.c})),n.d(t,"c",(function(){return l.b})),n(490);var a=n(571),i=n(608),r=n(606),s=n(245),o=n(545),l=n(150);n(417)},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a=e=>{const t=e.reduce(((e,t)=>t.trim().startsWith("-")?{includes:e.includes,excludes:[...e.excludes,t]}:{includes:[...e.includes,t],excludes:e.excludes}),{includes:[],excludes:[]});return[...t.includes.sort(),...t.excludes.sort()]},i=e=>a([...new Set(e.reduce(((e,t)=>[...t.split(","),...e]),[]))])},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return c}));var a=n(5),i=n(113);const r=a.i18n.translate("xpack.securitySolution.timeline.defaultTimelineTitle",{defaultMessage:"None"}),s=a.i18n.translate("xpack.securitySolution.timeline.defaultTimelineDescription",{defaultMessage:"Timeline offered by default when creating new timeline."}),o=({activePage:e,totalPages:t})=>a.i18n.translate("xpack.securitySolution.timeline.eventsTableAriaLabel",{values:{activePage:e,totalPages:t},defaultMessage:"events; Page {activePage} of {totalPages}"}),l=e=>a.i18n.translate("xpack.securitySolution.timeline.searchBoxPlaceholder",{values:{timeline:e===i.l.template?"Timeline template":"Timeline"},defaultMessage:"e.g. {timeline} name or description"}),u=a.i18n.translate("xpack.securitySolution.timeline.flyoutTimelineTemplateLabel",{defaultMessage:"Timeline template"}),c=a.i18n.translate("xpack.securitySolution.timeline.participantsTitle",{defaultMessage:"Participants"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(4);const i={ADD_EXCEPTION_FLYOUT:`${a.l} fetchAlerts addExceptionFlyout`,ALERTS_COUNT_BY_STATUS:`${a.l} fetchAlerts byRulebyCount`,ALERTS_GROUPING:`${a.l} fetchAlerts grouping`,BY_ID:`${a.l} fetchAlerts byId`,BY_RULE_BY_STATUS:`${a.l} fetchAlerts byRulebyStatus`,BY_RULE_ID:`${a.l} fetchAlerts byRuleId`,BY_SEVERITY:`${a.l} fetchAlerts bySeverity`,BY_STATUS:`${a.l} fetchAlerts byStatus`,CASES:`${a.l} fetchAlerts cases`,COUNT:`${a.l} fetchAlerts count`,HISTOGRAM:`${a.l} fetchAlerts histogram`,PREVALENCE:`${a.l} fetchAlerts prevalence`,SOC_TRENDS:`${a.l} fetchAlerts socTrends`,TREE_MAP:`${a.l} fetchAlerts treeMap`,VULNERABLE_HOSTS:`${a.l} fetchAlerts vulnerableHosts`,VULNERABLE_USERS:`${a.l} fetchAlerts vulnerableUsers`}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(9),i=n(2),r=n(311),s=n(336);const o=({fetchMethod:e=r.e,query:t,indexName:n,skip:o,queryName:l})=>{const[u,c]=Object(i.useState)(t),[d,p]=Object(i.useState)({data:null,response:"",request:"",setQuery:c,refetch:null}),[m,f]=Object(i.useState)(!1),g=((e,t)=>{const{startTracking:n}=Object(s.a)();return Object(i.useMemo)((()=>async a=>{const{endTracking:i}=n({name:t});let r;try{r=await e(a),i("success")}catch(e){throw i(a.signal.aborted?"aborted":"error"),e}return r}),[e,t,n])})(e,l);return Object(i.useEffect)((()=>{let e=!0;const t=new AbortController,i=async()=>{try{f(!0);const r=await g({query:u,signal:t.signal});var a;e&&p({data:r,response:JSON.stringify(r,null,2),request:JSON.stringify({index:null!==(a=[n])&&void 0!==a?a:[""],body:u},null,2),setQuery:c,refetch:i})}catch(t){e&&p({data:null,response:"",request:"",setQuery:c,refetch:i})}e&&f(!1)};return Object(a.isEmpty)(u)||o||i(),o&&(f(!1),e=!1,t.abort()),()=>{e=!1,t.abort()}}),[u,n,o,g]),{loading:m,...d}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(111),i=n(141);const r=a.z.object({id:a.z.string().optional(),rule_id:i.N.optional(),list_id:a.z.string().min(1).optional(),item_id:a.z.string().min(1).optional(),error:a.z.object({status_code:a.z.number().int().min(400),message:a.z.string()})}).strict()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var a=n(2);t.useFirstMountState=function(){var e=a.useRef(!0);return e.current?(e.current=!1,!0):e.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveHookState=void 0,t.resolveHookState=function(e,t){return"function"==typeof e?e(t):e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131).isClient?window:null,r=function(e){return!!e.addEventListener},s=function(e){return!!e.on};t.default=function(e,t,n,o){void 0===n&&(n=i),a.useEffect((function(){if(t&&n)return r(n)?n.addEventListener(e,t,o):s(n)&&n.on(e,t,o),function(){r(n)?n.removeEventListener(e,t,o):s(n)&&n.off(e,t,o)}}),[e,t,n,JSON.stringify(o)])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(256));t.default=function(e){var t=i.useRef(e);t.current=e,r.default((function(){return function(){return t.current()}}))}},function(e,t,n){const a=n(173);e.exports=(e,t,n=!1)=>{if(e instanceof a)return e;try{return new a(e,t)}catch(e){if(!n)return null;throw e}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return y}));var a=n(2),i=n.n(a),r=n(11),s=n.n(r),o=n(3),l=n(49),u=n(692),c=n(127),d=n(110),p=n(266);const m={activeStep:0,endTourStep:()=>{},incrementStep:()=>{},isTourShown:()=>!1,setStep:()=>{}},f=Object(a.createContext)(m),g=({children:e})=>{var t,n,r,l;const{guidedOnboarding:c}=Object(d.i)().services,m=s()(null!==(t=null==c||null===(n=c.guidedOnboardingApi)||void 0===n?void 0:n.isGuideStepActive$(u.a,p.b.rules).pipe(Object(o.timeout)(3e4),Object(o.catchError)((e=>Object(o.of)(!1)))))&&void 0!==t?t:Object(o.of)(!1),!1),g=s()(null!==(r=null==c||null===(l=c.guidedOnboardingApi)||void 0===l?void 0:l.isGuideStepActive$(u.a,p.b.alertsCases).pipe(Object(o.timeout)(3e4),Object(o.catchError)((e=>Object(o.of)(!1)))))&&void 0!==r?r:Object(o.of)(!1),!1),b=Object(a.useMemo)((()=>({[p.b.rules]:m,[p.b.alertsCases]:g})),[m,g]),y=Object(a.useCallback)((e=>b[e]),[b]),[v,h]=Object(a.useState)(1),E=Object(a.useCallback)((e=>{h((t=>(t>=p.e[e].length?0:t)+1))}),[]),x=Object(a.useCallback)(((e,t)=>{t<=p.e[e].length&&h(t)}),[]),[j,O]=Object(a.useState)(null);Object(a.useEffect)((()=>{if(!j||null==c||!c.guidedOnboardingApi)return;let e=!1;return(async()=>{var t;await(null==c||null===(t=c.guidedOnboardingApi)||void 0===t?void 0:t.completeGuideStep(u.a,j)),e||(O(null),h(1))})(),()=>{e=!0}}),[j,c]);const S=Object(a.useCallback)((e=>{O(e)}),[]),k=Object(a.useMemo)((()=>({activeStep:v,endTourStep:S,incrementStep:E,isTourShown:y,setStep:x})),[v,S,E,y,x]);return i.a.createElement(f.Provider,{value:k},e)},b=({children:e})=>{const{pathname:t}=Object(l.useLocation)(),n=Object(a.useMemo)((()=>Object(c.isTourPath)(t)?g:f.Provider),[t]);return i.a.createElement(n,{value:m},e)},y=()=>{const e=Object(a.useContext)(f);if(!e)throw new Error("useTourContext can only be called inside of TourContext!");return e}},,,,,function(e,t,n){"use strict";const a=n(968),i=n(969),r=n(970);function s(e){if("string"!=typeof e||1!==e.length)throw new TypeError("arrayFormatSeparator must be single character string")}function o(e,t){return t.encode?t.strict?a(e):encodeURIComponent(e):e}function l(e,t){return t.decode?i(e):e}function u(e){return Array.isArray(e)?e.sort():"object"==typeof e?u(Object.keys(e)).sort(((e,t)=>Number(e)-Number(t))).map((t=>e[t])):e}function c(e){const t=e.indexOf("#");return-1!==t&&(e=e.slice(0,t)),e}function d(e){const t=(e=c(e)).indexOf("?");return-1===t?"":e.slice(t+1)}function p(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):!t.parseBooleans||null===e||"true"!==e.toLowerCase()&&"false"!==e.toLowerCase()||(e="true"===e.toLowerCase()),e}function m(e,t){s((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);const n=function(e){let t;switch(e.arrayFormat){case"index":return(e,n,a)=>{t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),t?(void 0===a[e]&&(a[e]={}),a[e][t[1]]=n):a[e]=n};case"bracket":return(e,n,a)=>{t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),t?void 0!==a[e]?a[e]=[].concat(a[e],n):a[e]=[n]:a[e]=n};case"comma":case"separator":return(t,n,a)=>{const i="string"==typeof n&&n.split("").indexOf(e.arrayFormatSeparator)>-1?n.split(e.arrayFormatSeparator).map((t=>l(t,e))):null===n?n:l(n,e);a[t]=i};default:return(e,t,n)=>{void 0!==n[e]?n[e]=[].concat(n[e],t):n[e]=t}}}(t),a=Object.create(null);if("string"!=typeof e)return a;if(!(e=e.trim().replace(/^[?#&]/,"")))return a;for(const i of e.split("&")){let[e,s]=r(t.decode?i.replace(/\+/g," "):i,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:l(s,t),n(l(e,t),s,a)}for(const e of Object.keys(a)){const n=a[e];if("object"==typeof n&&null!==n)for(const e of Object.keys(n))n[e]=p(n[e],t);else a[e]=p(n,t)}return!1===t.sort?a:(!0===t.sort?Object.keys(a).sort():Object.keys(a).sort(t.sort)).reduce(((e,t)=>{const n=a[t];return Boolean(n)&&"object"==typeof n&&!Array.isArray(n)?e[t]=u(n):e[t]=n,e}),Object.create(null))}t.extract=d,t.parse=m,t.stringify=(e,t)=>{if(!e)return"";s((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);const n=n=>t.skipNull&&null==e[n]||t.skipEmptyString&&""===e[n],a=function(e){switch(e.arrayFormat){case"index":return t=>(n,a)=>{const i=n.length;return void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,[o(t,e),"[",i,"]"].join("")]:[...n,[o(t,e),"[",o(i,e),"]=",o(a,e)].join("")]};case"bracket":return t=>(n,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,[o(t,e),"[]"].join("")]:[...n,[o(t,e),"[]=",o(a,e)].join("")];case"comma":case"separator":return t=>(n,a)=>null==a||0===a.length?n:0===n.length?[[o(t,e),"=",o(a,e)].join("")]:[[n,o(a,e)].join(e.arrayFormatSeparator)];default:return t=>(n,a)=>void 0===a||e.skipNull&&null===a||e.skipEmptyString&&""===a?n:null===a?[...n,o(t,e)]:[...n,[o(t,e),"=",o(a,e)].join("")]}}(t),i={};for(const t of Object.keys(e))n(t)||(i[t]=e[t]);const r=Object.keys(i);return!1!==t.sort&&r.sort(t.sort),r.map((n=>{const i=e[n];return void 0===i?"":null===i?o(n,t):Array.isArray(i)?i.reduce(a(n),[]).join("&"):o(n,t)+"="+o(i,t)})).filter((e=>e.length>0)).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);const[n,a]=r(e,"#");return Object.assign({url:n.split("?")[0]||"",query:m(d(e),t)},t&&t.parseFragmentIdentifier&&a?{fragmentIdentifier:l(a,t)}:{})},t.stringifyUrl=(e,n)=>{n=Object.assign({encode:!0,strict:!0},n);const a=c(e.url).split("?")[0]||"",i=t.extract(e.url),r=t.parse(i,{sort:!1}),s=Object.assign(r,e.query);let l=t.stringify(s,n);l&&(l=`?${l}`);let u=function(e){let t="";const n=e.indexOf("#");return-1!==n&&(t=e.slice(n)),t}(e.url);return e.fragmentIdentifier&&(u=`#${o(e.fragmentIdentifier,n)}`),`${a}${l}${u}`}},function(e,t,n){"use strict";n.d(t,"e",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"i",(function(){return f})),n.d(t,"d",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return y})),n.d(t,"f",(function(){return v})),n.d(t,"g",(function(){return h}));var a=n(68),i=n(4),r=n(200),s=n(110),o=n(621),l=n(488);const u=async({query:e,signal:t})=>s.b.get().http.fetch(i.gb,{version:"2023-10-31",method:"POST",body:JSON.stringify(e),signal:t}),c=async({query:e,status:t,signal:n})=>s.b.get().http.fetch(i.lb,{version:"2023-10-31",method:"POST",body:JSON.stringify({conflicts:"proceed",status:t,query:e}),signal:n}),d=async({signalIds:e,status:t,signal:n})=>s.b.get().http.fetch(i.lb,{version:"2023-10-31",method:"POST",body:JSON.stringify({status:t,signal_ids:e}),signal:n}),p=async({signal:e})=>s.b.get().http.fetch(i.eb,{version:"2023-10-31",method:"GET",signal:e}),m=async({signal:e})=>s.b.get().http.fetch(i.ab,{version:"2023-10-31",method:"GET",signal:e}),f=async({signal:e})=>s.b.get().http.fetch(i.fb,{version:"2023-10-31",method:"GET",signal:e}),g=async({signal:e})=>s.b.get().http.fetch(i.eb,{version:"2023-10-31",method:"POST",signal:e}),b=async({endpointId:e,comment:t="",caseIds:n})=>Object(o.a)({endpoint_ids:[e],comment:t,case_ids:n}),y=async({endpointId:e,comment:t="",caseIds:n})=>Object(o.b)({endpoint_ids:[e],comment:t,case_ids:n}),v=async({alertId:e,owner:t})=>s.b.get().http.fetch(Object(a.getCasesFromAlertsUrl)(e),{method:"get",query:{...t.length>0?{owner:t}:{}}}),h=async({agentId:e,signal:t})=>s.b.get().http.fetch(Object(l.a)(r.q,{id:e}),{method:"GET",signal:t,version:"2023-10-31"})},function(e,t,n){e.exports=n(24)(1634)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return l}));const a="kibana.alert.ancestors.id",i="kibana.alert.rule.parameters.index",r="kibana.alert.rule.indices",s="process.entry_leader.entity_id",o="process.entry_leader.start",l="kibana.alert.ancestors.index"},function(e,t,n){(function(t){const n="object"==typeof t&&Object({IS_KIBANA_DISTRIBUTABLE:"true"})&&Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG&&/\bsemver\b/i.test(Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};e.exports=n}).call(this,n(391))},function(e,t){const n=Number.MAX_SAFE_INTEGER||9007199254740991;e.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:n,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}},function(e,t,n){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:i,MAX_LENGTH:r}=n(315),s=n(314),o=(t=e.exports={}).re=[],l=t.safeRe=[],u=t.src=[],c=t.t={};let d=0;const p="[a-zA-Z0-9-]",m=[["\\s",1],["\\d",r],[p,i]],f=(e,t,n)=>{const a=(e=>{for(const[t,n]of m)e=e.split(`${t}*`).join(`${t}{0,${n}}`).split(`${t}+`).join(`${t}{1,${n}}`);return e})(t),i=d++;s(e,i,t),c[e]=i,u[i]=t,o[i]=new RegExp(t,n?"g":void 0),l[i]=new RegExp(a,n?"g":void 0)};f("NUMERICIDENTIFIER","0|[1-9]\\d*"),f("NUMERICIDENTIFIERLOOSE","\\d+"),f("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${p}*`),f("MAINVERSION",`(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})\\.(${u[c.NUMERICIDENTIFIER]})`),f("MAINVERSIONLOOSE",`(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})\\.(${u[c.NUMERICIDENTIFIERLOOSE]})`),f("PRERELEASEIDENTIFIER",`(?:${u[c.NUMERICIDENTIFIER]}|${u[c.NONNUMERICIDENTIFIER]})`),f("PRERELEASEIDENTIFIERLOOSE",`(?:${u[c.NUMERICIDENTIFIERLOOSE]}|${u[c.NONNUMERICIDENTIFIER]})`),f("PRERELEASE",`(?:-(${u[c.PRERELEASEIDENTIFIER]}(?:\\.${u[c.PRERELEASEIDENTIFIER]})*))`),f("PRERELEASELOOSE",`(?:-?(${u[c.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[c.PRERELEASEIDENTIFIERLOOSE]})*))`),f("BUILDIDENTIFIER",`${p}+`),f("BUILD",`(?:\\+(${u[c.BUILDIDENTIFIER]}(?:\\.${u[c.BUILDIDENTIFIER]})*))`),f("FULLPLAIN",`v?${u[c.MAINVERSION]}${u[c.PRERELEASE]}?${u[c.BUILD]}?`),f("FULL",`^${u[c.FULLPLAIN]}$`),f("LOOSEPLAIN",`[v=\\s]*${u[c.MAINVERSIONLOOSE]}${u[c.PRERELEASELOOSE]}?${u[c.BUILD]}?`),f("LOOSE",`^${u[c.LOOSEPLAIN]}$`),f("GTLT","((?:<|>)?=?)"),f("XRANGEIDENTIFIERLOOSE",`${u[c.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),f("XRANGEIDENTIFIER",`${u[c.NUMERICIDENTIFIER]}|x|X|\\*`),f("XRANGEPLAIN",`[v=\\s]*(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:\\.(${u[c.XRANGEIDENTIFIER]})(?:${u[c.PRERELEASE]})?${u[c.BUILD]}?)?)?`),f("XRANGEPLAINLOOSE",`[v=\\s]*(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[c.XRANGEIDENTIFIERLOOSE]})(?:${u[c.PRERELEASELOOSE]})?${u[c.BUILD]}?)?)?`),f("XRANGE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAIN]}$`),f("XRANGELOOSE",`^${u[c.GTLT]}\\s*${u[c.XRANGEPLAINLOOSE]}$`),f("COERCE",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?(?:$|[^\\d])`),f("COERCERTL",u[c.COERCE],!0),f("LONETILDE","(?:~>?)"),f("TILDETRIM",`(\\s*)${u[c.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",f("TILDE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAIN]}$`),f("TILDELOOSE",`^${u[c.LONETILDE]}${u[c.XRANGEPLAINLOOSE]}$`),f("LONECARET","(?:\\^)"),f("CARETTRIM",`(\\s*)${u[c.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",f("CARET",`^${u[c.LONECARET]}${u[c.XRANGEPLAIN]}$`),f("CARETLOOSE",`^${u[c.LONECARET]}${u[c.XRANGEPLAINLOOSE]}$`),f("COMPARATORLOOSE",`^${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]})$|^$`),f("COMPARATOR",`^${u[c.GTLT]}\\s*(${u[c.FULLPLAIN]})$|^$`),f("COMPARATORTRIM",`(\\s*)${u[c.GTLT]}\\s*(${u[c.LOOSEPLAIN]}|${u[c.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",f("HYPHENRANGE",`^\\s*(${u[c.XRANGEPLAIN]})\\s+-\\s+(${u[c.XRANGEPLAIN]})\\s*$`),f("HYPHENRANGELOOSE",`^\\s*(${u[c.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[c.XRANGEPLAINLOOSE]})\\s*$`),f("STAR","(<|>)?=?\\s*\\*"),f("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),f("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u}));var a=n(2),i=n(11),r=n.n(i),s=n(438);const o=e=>{const t=Object(s.b)(),n=r()(t.sections$,t.getSectionsValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},l=e=>{const t=Object(s.b)(),n=r()(t.messages$,t.getMessagesValue());return Object(a.useMemo)((()=>{var t;return null!==(t=null==n?void 0:n.get(e))&&void 0!==t?t:null}),[e,n])},u=e=>{const t=Object(s.b)(),n=Object(a.useMemo)((()=>t.getPageUpselling(e)),[e,t]);return null!=n?n:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return y})),n.d(t,"b",(function(){return v}));var a=n(142),i=n(124),r=n(122),s=n(116),o=n(521);const l=[i.e.alertsOnAlertsPage,i.e.alertsOnRuleDetailsPage,i.e.alertsOnCasePage,r.c.casePage],u=[{value:"all",inputDisplay:o.b,"data-test-subj":"option-all"}],c=[{value:"raw",inputDisplay:o.d,"data-test-subj":"option-raw"}],d=[{value:"alert",inputDisplay:o.a,"data-test-subj":"option-alert"}],p=[...c,...d],m=e=>{switch(e){case"all":return u;case"raw":return c;case"alert":return d;default:return p}},f=e=>!!e&&l.includes(e),g=[a.a,a.b,a.e,a.f,a.g,a.h,a.o,a.r,a.H,a.w,a.K,a.s,a.t,a.Z,a.nb,a.ob,a.rb,a.u,a.x,a.y,a.z,a.A,a.D,a.E,a.F,a.G,a.I,a.J,a.L,a.N,a.O,a.P,a.Q,a.R,a.S,a.T,a.U,a.V,a.v,a.W,a.X,a.Y,a.ib,a.lb,"signal.rule.building_block_type","signal.rule.id","signal.rule.name","signal.rule.threat_mapping","signal.status"],b=({tableId:e,view:t})=>"raw"===t&&f(e),y=({filters:e,tableId:t,view:n})=>b({tableId:t,view:n})?e.filter((e=>!g.includes(`${e.meta.key}`))):e,v=({scopeId:e,view:t})=>b({tableId:e,view:t})?s.SourcererScopeName.default:f(e)?s.SourcererScopeName.detections:e===r.c.active?s.SourcererScopeName.timeline:s.SourcererScopeName.default},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(48),r=n(128),s=n(167),o=n(117),l=n(112);const u=({id:e,filterQuery:t,kqlError:n,query:u,startDate:c,endDate:d})=>{const{addError:p}=Object(o.a)(),m=Object(i.useDispatch)(),f=Object(a.useMemo)((()=>r.a.errorsSelector()),[]),g=Object(l.a)(f),b=null==n?void 0:n.name,y=null==n?void 0:n.message;Object(a.useEffect)((()=>{if(!t&&y&&b){const t=y.split("").reduce(((e,t)=>(e<<5)-e+t.charCodeAt(0)|0),0).toString();m(s.a.addErrorHash({id:e,hash:t,title:b,message:[y]}))}}),[e,t,p,u,c,d,m,y,b]),Object(a.useEffect)((()=>{const t=g.find((t=>t.id===e));null!=t&&t.displayError&&null!=n&&(delete n.stack,p(n,{title:n.name}))}),[p,g,e,n])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a.b})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return z})),n.d(t,"j",(function(){return $})),n.d(t,"g",(function(){return ae})),n.d(t,"h",(function(){return ue})),n.d(t,"i",(function(){return pe})),n.d(t,"d",(function(){return ce})),n.d(t,"e",(function(){return me})),n.d(t,"f",(function(){return Q}));var a=n(239),i=n(45),r=n(2),s=n.n(r),o=n(13);const l=Object(r.createContext)(null),u=({children:e,getTriggerCompatibleActions:t})=>{const n=Object(r.useMemo)((()=>({getActions:e=>t(e.trigger.id,e).then((e=>Object(i.orderBy)(["order","id"],["asc","asc"],e)))})),[t]);return Object(o.jsx)(l.Provider,{value:n},e)},c=()=>{const e=Object(r.useContext)(l);if(!e)throw new Error("No CellActionsContext found. Please wrap the application with CellActionsProvider");return e};var d=n(17),p=n(23),m=n.n(p);const f=({action:e,actionContext:t,showTooltip:n,onClick:a})=>{const i=Object(r.useMemo)((()=>({iconType:e.getIconType(t),onClick:()=>{e.execute(t),a&&a()},"data-test-subj":`actionItem-${e.id}`,"aria-label":e.getDisplayName(t)})),[e,t,a]);return i.iconType?n?Object(o.jsx)(d.EuiToolTip,{content:e.getDisplayNameTooltip?e.getDisplayNameTooltip(t):""},Object(o.jsx)(d.EuiButtonIcon,m()({},i,{iconSize:"s"}))):Object(o.jsx)(d.EuiButtonIcon,m()({},i,{iconSize:"s"})):null},g=(e,t)=>t<=1?{extraActions:e,visibleActions:[]}:e.length<=t?{extraActions:[],visibleActions:e}:{visibleActions:e.slice(0,t-1),extraActions:e.slice(t-1,e.length)};var b=n(55),y=n(5);const v=e=>y.i18n.translate("cellActions.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:e},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."}),h=y.i18n.translate("cellActions.extraActionsAriaLabel",{defaultMessage:"Extra actions"}),E=y.i18n.translate("cellActions.showMoreActionsLabel",{defaultMessage:"More actions"}),x=y.i18n.translate("cellActions.actionsAriaLabel",{defaultMessage:"Actions"}),j=Object(o.css)("color:",b.euiThemeVars.euiColorPrimaryText,";",""),O=({anchorPosition:e,actions:t,actionContext:n,isOpen:a,closePopOver:i,button:r})=>Object(o.jsx)(d.EuiPopover,{button:r,isOpen:a,closePopover:i,panelPaddingSize:"xs",anchorPosition:e,hasArrow:!0,repositionOnScroll:!0,ownFocus:!0,"data-test-subj":"extraActionsPopOver","aria-label":h},Object(o.jsx)(k,{actions:t,actionContext:n,closePopOver:i})),S=({anchorPosition:e,anchorRef:t,actionContext:n,isOpen:a,closePopOver:i,actions:r})=>t.current?Object(o.jsx)(d.EuiWrappingPopover,{"aria-label":h,button:t.current,isOpen:a,closePopover:i,panelPaddingSize:"xs",anchorPosition:e,hasArrow:!1,repositionOnScroll:!0,ownFocus:!0,attachToAnchor:!1,"data-test-subj":"extraActionsPopOverWithAnchor"},Object(o.jsx)(k,{actions:r,actionContext:n,closePopOver:i})):null,k=({actionContext:e,actions:t,closePopOver:n})=>{const a=Object(r.useMemo)((()=>t.map((t=>Object(o.jsx)(d.EuiContextMenuItem,{css:j,key:t.id,icon:t.getIconType(e),"aria-label":t.getDisplayName(e),"data-test-subj":`actionItem-${t.id}`,onClick:()=>{n(),t.execute(e)}},t.getDisplayName(e))))),[e,t,n]);return Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)(d.EuiScreenReaderOnly,null,Object(o.jsx)("p",null,v(e.data.map((({field:e})=>e.name)).join(", ")))),Object(o.jsx)(d.EuiContextMenuPanel,{size:"s",items:a}))},w=({onClick:e,showTooltip:t})=>t?Object(o.jsx)(d.EuiToolTip,{content:E},Object(o.jsx)(d.EuiButtonIcon,{"data-test-subj":"showExtraActionsButton","aria-label":E,iconType:"boxesHorizontal",onClick:e})):Object(o.jsx)(d.EuiButtonIcon,{"data-test-subj":"showExtraActionsButton","aria-label":E,iconType:"boxesHorizontal",onClick:e});var T=n(407),I=n.n(T),C=n(419),M=n.n(C);const _=e=>{if(e)throw e},A=(e,t)=>Object(r.useMemo)((()=>P(e,t)),[e,t]),P=(e,t=[])=>e?e.filter((({type:e})=>!(null!=t&&t.includes(e)))):void 0,F=({actionContext:e,anchorPosition:t,showActionTooltips:n,visibleCellActions:a,disabledActionTypes:i})=>{const{value:s}=((e,t={})=>{const{getActions:n}=c(),{error:a,value:i,loading:r}=I()((()=>n(e)),[]),s=A(i,t.disabledActionTypes);return _(a),{value:s,loading:r}})(e,{disabledActionTypes:i}),{extraActions:l,visibleActions:u}=((e,t)=>Object(r.useMemo)((()=>g(null!=e?e:[],t)),[e,t]))(null!=s?s:[],a),[p,m]=Object(r.useState)(!1),b=Object(r.useCallback)((()=>m((e=>!e))),[]),y=Object(r.useCallback)((()=>m(!1)),[]),v=Object(r.useMemo)((()=>Object(o.jsx)(w,{onClick:b,showTooltip:n})),[b,n]);return Object(o.jsx)(d.EuiFlexGroup,{responsive:!1,alignItems:"flexStart",gutterSize:"none","data-test-subj":"inlineActions",className:"inlineActions "+(p?"inlineActions-popoverOpen":"")},u.map((t=>Object(o.jsx)(d.EuiFlexItem,{grow:!1,key:`action-item-${t.id}`},Object(o.jsx)(f,{action:t,actionContext:e,showTooltip:n})))),l.length>0?Object(o.jsx)(d.EuiFlexItem,{grow:!1},Object(o.jsx)(O,{actions:l,actionContext:e,anchorPosition:t,button:v,closePopOver:y,isOpen:p})):null)};var D=n(9);const N={minWidth:"24px"},R=Object(o.css)("padding:0 ",b.euiThemeVars.euiSizeS,";",""),L=({anchorPosition:e,children:t,visibleCellActions:n,actionContext:a,showActionTooltips:i,disabledActionTypes:l})=>{const u=Object(r.useRef)(null),[p,m]=Object(r.useState)(!1),[y,h]=Object(r.useState)(!1),[{value:E},j]=((e={})=>{const{getActions:t}=c(),[{error:n,value:a,loading:i},r]=M()(t,[]),s=A(a,e.disabledActionTypes);return _(n),[{value:s,loading:i},r]})({disabledActionTypes:l}),{visibleActions:O,extraActions:k}=Object(r.useMemo)((()=>g(null!=E?E:[],n)),[E,n]),T=Object(r.useMemo)((()=>Object(D.debounce)((()=>{document.body.classList.contains("is-dragging")||h(!0)}),100)),[]);Object(r.useEffect)((()=>()=>{T.cancel()}),[T]);const I=Object(r.useCallback)((()=>{T.cancel(),h(!1)}),[T]),C=Object(r.useCallback)((()=>m(!1)),[m]),P=Object(r.useCallback)((()=>{m(!0),I()}),[I,m]),F=Object(r.useCallback)((async()=>{p||(void 0===E&&j(a),T())}),[p,E,T,j,a]),L=Object(r.useMemo)((()=>Object(o.jsx)("div",{ref:u,onMouseEnter:F,onClick:C},t)),[F,C,t]),z=Object(r.useMemo)((()=>"rightCenter"===e?{marginTop:b.euiThemeVars.euiSizeS}:{}),[e]);return Object(o.jsx)(s.a.Fragment,null,Object(o.jsx)("div",{onMouseLeave:I},Object(o.jsx)(d.EuiPopover,{panelStyle:{...N,...z},anchorPosition:e,button:L,closePopover:I,hasArrow:!1,isOpen:y,panelPaddingSize:"none",repositionOnScroll:!0,ownFocus:!1,"data-test-subj":"hoverActionsPopover","aria-label":x},y&&Object(o.jsx)("div",{css:R},Object(o.jsx)(d.EuiScreenReaderOnly,null,Object(o.jsx)("p",null,v(a.data.map((({field:e})=>e.name)).join(", ")))),O.map((e=>Object(o.jsx)(f,{key:e.id,action:e,actionContext:a,showTooltip:i,onClick:I}))),k.length>0&&Object(o.jsx)(w,{onClick:P,showTooltip:i})))),Object(o.jsx)(S,{anchorPosition:e,actions:k,anchorRef:u,actionContext:a,closePopOver:C,isOpen:p}))},z=({data:e,triggerId:t,children:n,mode:s,showActionTooltips:l=!0,visibleCellActions:u=3,disabledActionTypes:c=[],metadata:p,className:m})=>{const f=Object(r.useRef)(null),g=Object(r.useMemo)((()=>Object(i.isArray)(e)?e:[e]),[e]),b=Object(r.useMemo)((()=>({data:g,trigger:{id:t},nodeRef:f,metadata:p})),[g,t,p]),y=Object(r.useMemo)((()=>s===a.b.HOVER_DOWN?"downCenter":"rightCenter"),[s]),v=`cellActions-renderContent-${g.map((({field:e})=>e.name)).join("-")}`;return s===a.b.HOVER_DOWN||s===a.b.HOVER_RIGHT?Object(o.jsx)("div",{className:m,ref:f,"data-test-subj":v},Object(o.jsx)(L,{anchorPosition:y,actionContext:b,showActionTooltips:l,visibleCellActions:u,disabledActionTypes:c},n)):Object(o.jsx)(d.EuiFlexGroup,{responsive:!1,alignItems:"center",ref:f,gutterSize:"none",justifyContent:"flexStart",className:m,"data-test-subj":v},Object(o.jsx)(d.EuiFlexItem,{grow:!1},n),Object(o.jsx)(d.EuiFlexItem,{grow:!1},Object(o.jsx)(F,{anchorPosition:y,actionContext:b,showActionTooltips:l,visibleCellActions:u,disabledActionTypes:c})))},B=[()=>Object(o.jsx)(d.EuiLoadingSpinner,{size:"s","data-test-subj":"dataGridColumnCellAction-loading"})],q=[],$=({fields:e,getCellValue:t,triggerId:n,metadata:a,dataGridRef:i,disabledActionTypes:s=[]})=>{const o=Object(r.useMemo)((()=>{if(n&&null!=e&&e.length)return e.map((e=>({data:[{field:e}],trigger:{id:n},metadata:a})))}),[e,n,a]),{loading:l,value:u}=((e,t={})=>{const{getActions:n}=c(),{error:a,...i}=I()((()=>{var a;return Promise.all(null!==(a=null==e?void 0:e.map((e=>n(e).then((e=>{var n;return null!==(n=P(e,t.disabledActionTypes))&&void 0!==n?n:[]})))))&&void 0!==a?a:[])}),[e]);return _(a),i})(o,{disabledActionTypes:s});return Object(r.useMemo)((()=>l?null!=e&&e.length?e.map((()=>B)):q:n&&null!=u&&u.length&&null!=e&&e.length?u.length!==e.length?q:u.map(((r,s)=>r.map((r=>V({action:r,field:e[s],getCellValue:t,metadata:a,triggerId:n,dataGridRef:i}))))):q),[u,e,t,l,a,n,i])},V=({action:e,field:t,getCellValue:n,metadata:a,triggerId:i,dataGridRef:s})=>function({Component:l,rowIndex:u,isExpanded:c}){const d=Object(r.useRef)(null),p=Object(r.useRef)(null),m=Object(r.useMemo)((()=>{const{name:e}=t,r=n(e,u);return{data:[{field:t,value:r}],trigger:{id:i},nodeRef:d,metadata:a}}),[u]),f=Object(r.useCallback)((async()=>{m.nodeRef.current=await U({dataGrid:s.current,isExpanded:c,buttonRef:p}),e.execute(m)}),[m,c]);return Object(o.jsx)(l,{buttonRef:p,"aria-label":e.getDisplayName(m),title:e.getDisplayName(m),"data-test-subj":`dataGridColumnCellAction-${e.id}`,iconType:e.getIconType(m),onClick:f},e.getDisplayName(m))},U=({dataGrid:e,isExpanded:t,buttonRef:n})=>new Promise((a=>{const i=t?document.querySelector('div[role="gridcell"].euiDataGridRowCell--open'):H(n.current);null==e||e.closeCellPopover(),setTimeout((()=>{var e;a(null!==(e=null==i?void 0:i.firstElementChild)&&void 0!==e?e:null)}))})),H=e=>null==e?null:"DIV"===e.nodeName&&"gridcell"===e.getAttribute("role")?e:H(e.parentElement);var Z=n(487),G=n.n(Z);const Q=e=>t=>{const n=e(t);return W(n)},W=e=>{const t=t=>J(e,t);return t.combine=t=>{const n=K(e,t);return W(n)},t},K=(e,t)=>Y(e,t),J=(e,t)=>Y(e,t),Y=(e,t)=>{const{isCompatible:n,execute:a,...i}=t;let r=e.isCompatible;n&&(r=a?n:async t=>await e.isCompatible(t)&&await n(t));const s=null!=a?a:e.execute;return{...e,isCompatible:r,execute:s,...i}};var X=n(343),ee=n(344);const te=y.i18n.translate("cellActions.actions.copyToClipboard.displayName",{defaultMessage:"Copy to Clipboard"}),ne=y.i18n.translate("cellActions.actions.copyToClipboard.successMessage",{defaultMessage:"Copied to the clipboard"}),ae=Q((({notifications:e})=>({type:a.a,getIconType:()=>"copyClipboard",getDisplayName:()=>te,getDisplayNameTooltip:()=>te,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&null!=n.name&&Object(X.b)(n.type)},execute:async({data:t})=>{var n,a;const r=null===(n=t[0])||void 0===n?void 0:n.field,s=null===(a=t[0])||void 0===a?void 0:a.value,o=Object(X.a)(Object(X.d)(s));if(!Object(X.c)(o))return void e.toasts.addWarning({title:ee.a});const l=o.map((e=>Object(i.isString)(e)?`"${(e=>e.replace(/"/g,'\\"'))(e)}"`:e)).join(" AND "),u=""!==l?`${r.name}: ${l}`:r.name;G()(u,{debug:!0})&&e.toasts.addSuccess({title:ne},{toastLifeTimeMs:800})}})));var ie=n(53);const re=e=>0===e.length||e.every((e=>""===e)),se=({key:e,negate:t,value:n})=>({meta:{key:e,negate:t,type:ie.FILTERS.PHRASE,params:{query:n.toString()}},query:{match_phrase:{[e]:{query:n.toString()}}}}),oe=({key:e,value:t,negate:n})=>0===t.length?(({key:e,negate:t})=>({meta:{key:e,negate:t,type:ie.FILTERS.EXISTS,value:"exists"},query:{exists:{field:e}}}))({key:e,negate:n}):t.length>1?(({values:e,key:t,negate:n})=>({meta:{key:t,negate:n,type:ie.FILTERS.COMBINED,relation:ie.BooleanRelation.AND,params:e.map((e=>se({key:t,value:e})))}}))({key:e,negate:n,values:t}):se({key:e,negate:n,value:t[0]}),le=y.i18n.translate("cellActions.actions.filterIn",{defaultMessage:"Filter In"}),ue=Q((({filterManager:e,notifications:{toasts:t}})=>({type:a.c,getIconType:()=>"plusInCircle",getDisplayName:()=>le,getDisplayNameTooltip:()=>le,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&!!n.name&&Object(X.b)(n.type)},execute:async({data:n})=>{var a,i;const r=null===(a=n[0])||void 0===a?void 0:a.field,s=null===(i=n[0])||void 0===i?void 0:i.value,o=Object(X.a)(Object(X.d)(s));Object(X.c)(o)?ce({filterManager:e,fieldName:r.name,value:o}):t.addWarning({title:ee.a})}}))),ce=({filterManager:e,fieldName:t,value:n})=>{if(null!=e){const a=oe({key:t,value:n,negate:re(n)});e.addFilters(a)}},de=y.i18n.translate("cellActions.actions.filterOut",{defaultMessage:"Filter Out"}),pe=Q((({filterManager:e,notifications:{toasts:t}})=>({type:a.c,getIconType:()=>"minusInCircle",getDisplayName:()=>de,getDisplayNameTooltip:()=>de,isCompatible:async({data:e})=>{var t;const n=null===(t=e[0])||void 0===t?void 0:t.field;return 1===e.length&&!!n.name&&Object(X.b)(n.type)},execute:async({data:n})=>{var a,i;const r=null===(a=n[0])||void 0===a?void 0:a.field,s=null===(i=n[0])||void 0===i?void 0:i.value,o=Object(X.a)(Object(X.d)(s));Object(X.c)(o)?me({filterManager:e,fieldName:r.name,value:o}):t.addWarning({title:ee.a})}}))),me=({filterManager:e,fieldName:t,value:n})=>{if(null!=e){const a=oe({key:t,value:n,negate:!re(n)});e.addFilters(a)}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(114),r=n(117),s=n(311),o=n(553),l=n(262);const u=()=>{const[e,t]=Object(a.useState)(!0),[n,u]=Object(a.useState)({signalIndexExists:null,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:null}),{addError:c}=Object(r.a)(),{hasIndexRead:d}=Object(l.a)();return Object(a.useEffect)((()=>{let e=!0;const n=new AbortController,a=async()=>{try{t(!0);const a=await Object(s.h)({signal:n.signal});e&&null!=a&&u({signalIndexExists:!0,signalIndexName:a.name,signalIndexMappingOutdated:a.index_mapping_outdated,createDeSignalIndex:r})}catch(t){e&&(u({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:r}),Object(i.v)(t)&&404!==t.body.status_code&&c(t,{title:o.c}))}e&&t(!1)},r=async()=>{let l=!1;try{t(!0),await Object(s.d)({signal:n.signal}),e&&(l=!0,a())}catch(t){e&&(Object(i.v)(t)&&409===t.body.status_code?a():(u({signalIndexExists:!1,signalIndexName:null,signalIndexMappingOutdated:null,createDeSignalIndex:r}),c(t,{title:o.d})))}e&&!l&&t(!1)};return d?a():t(!1),()=>{e=!1,n.abort()}}),[c,d]),{loading:e,...n}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return l}));var a=n(111),i=n(141);const r=a.z.enum(["doNotSuppress","suppress"]),s=r.enum,o=a.z.array(a.z.string()).min(1).max(3),l=a.z.object({group_by:o,duration:i.a.optional(),missing_fields_strategy:r.optional()});a.z.object({groupBy:o,duration:i.a.optional(),missingFieldsStrategy:r.optional()})},function(e,t,n){"use strict";var a=function(e){return function(e){return!!e&&"object"==typeof e}(e)&&!function(e){var t=Object.prototype.toString.call(e);return"[object RegExp]"===t||"[object Date]"===t||function(e){return e.$$typeof===i}(e)}(e)},i="function"==typeof Symbol&&Symbol.for?Symbol.for("react.element"):60103;function r(e,t){return!1!==t.clone&&t.isMergeableObject(e)?u((n=e,Array.isArray(n)?[]:{}),e,t):e;var n}function s(e,t,n){return e.concat(t).map((function(e){return r(e,n)}))}function o(e){return Object.keys(e).concat(function(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter((function(t){return Object.propertyIsEnumerable.call(e,t)})):[]}(e))}function l(e,t){try{return t in e}catch(e){return!1}}function u(e,t,n){(n=n||{}).arrayMerge=n.arrayMerge||s,n.isMergeableObject=n.isMergeableObject||a,n.cloneUnlessOtherwiseSpecified=r;var i=Array.isArray(t);return i===Array.isArray(e)?i?n.arrayMerge(e,t,n):function(e,t,n){var a={};return n.isMergeableObject(e)&&o(e).forEach((function(t){a[t]=r(e[t],n)})),o(t).forEach((function(i){(function(e,t){return l(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))})(e,i)||(l(e,i)&&n.isMergeableObject(t[i])?a[i]=function(e,t){if(!t.customMerge)return u;var n=t.customMerge(e);return"function"==typeof n?n:u}(i,n)(e[i],t[i],n):a[i]=r(t[i],n))})),a}(e,t,n):r(t,n)}u.all=function(e,t){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce((function(e,n){return u(e,n,t)}),{})};var c=u;e.exports=c},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(9);const i=(e,t=!1)=>{if(Array.isArray(e))return e;const n={};return Object.entries(e).forEach((([e,i])=>{const r=t&&Array.isArray(i)&&1===i.length;Object(a.merge)(n,Object(a.setWith)({},e,r?i[0]:i,Object))})),n}},function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(4);const i=`${a.jb}/prepackaged`,r=`${a.Db}/prebuilt_rules`,s=`${i}/_status`,o=`${r}/status`,l=`${r}/upgrade/_review`,u=`${r}/upgrade/_perform`,c=`${r}/installation/_review`,d=`${r}/installation/_perform`},function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return x}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(48),u=n(113),c=n(118),d=n(112),p=n(244),m=n(228),f=n(134),g=n(292);o()(a.EuiBadge).withConfig({displayName:"NotesCountBadge",componentId:"sc-v4xtfs-0"})(["margin-left:5px;"]).displayName="NotesCountBadge";const b=({timelineId:e,compact:t})=>{const n=Object(l.useDispatch)(),s=Object(i.useMemo)((()=>c.b.getTimelineByIdSelector()),[]),o=Object(d.b)((t=>{var n;return(null!==(n=s(t,e))&&void 0!==n?n:f.b).isFavorite})),m=Object(d.b)((t=>{var n;return(null!==(n=s(t,e))&&void 0!==n?n:f.b).status}))===u.k.immutable,b=Object(i.useCallback)((()=>n(c.a.updateIsFavorite({id:e,isFavorite:!o}))),[n,e,o]),y=o?p.j:p.b;return t?r.a.createElement(a.EuiButtonIcon,{id:g.a.ADD_TO_FAVORITES,iconType:o?"starFilled":"starEmpty",iconSize:"m",isSelected:o,onClick:b,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,disabled:m,"aria-label":y,title:y}):r.a.createElement(a.EuiButton,{id:g.a.ADD_TO_FAVORITES,isSelected:o,fill:o,iconType:o?"starFilled":"starEmpty",onClick:b,"data-test-subj":`timeline-favorite-${o?"filled":"empty"}-star`,disabled:m,"aria-label":y,title:y},y)};b.displayName="AddToFavoritesButtonComponent";const y=r.a.memo(b),v=r.a.memo((({onClick:e,outline:t=!1,timelineId:n,title:a=p.h})=>{const{getButton:i}=Object(m.b)({timelineId:n,timelineType:u.l.default,onClick:e});return i({outline:t,title:a})}));v.displayName="NewTimeline";const h="notes-button",E=r.a.memo((({ariaLabel:e=p.i,isDisabled:t,toggleShowNotes:n,timelineType:i})=>{const s=i===u.l.template;return r.a.createElement(a.EuiButtonIcon,{"aria-label":e,className:h,"data-test-subj":"timeline-notes-button-small",disabled:t,iconType:"editorComment",onClick:n,size:"s",isDisabled:s})}));E.displayName="SmallNotesButton";const x=r.a.memo((({ariaLabel:e,isDisabled:t,showNotes:n,timelineType:i,toggleShowNotes:s,toolTip:o})=>n?r.a.createElement(E,{ariaLabel:e,isDisabled:t,toggleShowNotes:s,timelineType:i}):r.a.createElement(a.EuiToolTip,{content:o||"","data-test-subj":"timeline-notes-tool-tip"},r.a.createElement(E,{ariaLabel:e,isDisabled:t,toggleShowNotes:s,timelineType:i}))));x.displayName="NotesButton"},,function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return v}));var a=n(426),i=n(176),r=n(447),s=n(187),o=n(448),l=n(409);const u=e=>({...e.page.queries,[i.UsersTableType.allUsers]:{...e.page.queries[i.UsersTableType.allUsers],activePage:l.a}}),c=({tableById:e,tableId:t,fieldName:n})=>{const a=e[t];return a.fields.includes(n)?e:{...e,[t]:{...a,fields:[n,...a.fields]}}},d=({tableId:e,fieldName:t,tableById:n})=>{const a=n[e],i=a.fields.filter((e=>e!==t));return{...n,[e]:{...a,fields:i}}};var p=n(445),m=n(125),f=n(423);const g={[i.UserAssetTableType.assetOkta]:["user.id","user.profile.first_name","user.profile.last_name","user.profile.primaryPhone","user.profile.mobile_phone","user.profile.job_title","user.geo.city_name","user.geo.country_iso_code"],[i.UserAssetTableType.assetEntra]:["user.id","user.first_name","user.last_name","user.phone","user.job_title","user.work.location_name"]};var b=n(660);const y=e=>{var t,n;const a=Object(b.a)(e);return{page:{queries:{[i.UsersTableType.allUsers]:{activePage:l.a,limit:l.b,sort:{field:f.b.lastSeen,direction:p.a.desc}},[i.UsersTableType.authentications]:{activePage:l.a,limit:l.b},[i.UsersTableType.risk]:{activePage:l.a,limit:l.b,sort:{field:m.w.userRiskScore,direction:p.a.desc},severitySelection:[]},[i.UsersTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[i.UsersTableType.events]:{activePage:l.a,limit:l.b}}},details:{queries:{[i.UsersTableType.anomalies]:{jobIdSelection:[],intervalSelection:"auto"},[i.UsersTableType.events]:{activePage:l.a,limit:l.b}}},flyout:{queries:{[i.UserAssetTableType.assetEntra]:null!==(t=a&&a[i.UserAssetTableType.assetEntra])&&void 0!==t?t:{fields:g[i.UserAssetTableType.assetEntra]},[i.UserAssetTableType.assetOkta]:null!==(n=a&&a[i.UserAssetTableType.assetOkta])&&void 0!==n?n:{fields:g[i.UserAssetTableType.assetOkta]}}}}},v=e=>Object(s.reducerWithInitialState)(y(e)).case(a.setUsersTablesActivePageToZero,(e=>({...e,page:{...e.page,queries:u(e)}}))).case(a.updateTableActivePage,((e,{activePage:t,tableType:n})=>({...e,page:{...e.page,queries:{...e.page.queries,[n]:{...e.page.queries[n],activePage:t}}}}))).case(a.updateTableLimit,((e,{limit:t,tableType:n})=>({...e,page:{...e.page,queries:{...e.page.queries,[n]:{...e.page.queries[n],limit:t}}}}))).case(a.updateTableSorting,((e,{sort:t,tableType:n})=>({...e,page:{...e.page,queries:{...e.page.queries,[n]:{...e.page.queries[n],sort:t,activePage:l.a}}}}))).case(a.updateUserRiskScoreSeverityFilter,((e,{severitySelection:t})=>({...e,page:{...e.page,queries:{...e.page.queries,[i.UsersTableType.risk]:{...e.page.queries[i.UsersTableType.risk],severitySelection:t,activePage:l.a}}}}))).case(a.updateUsersAnomaliesJobIdFilter,((e,{jobIds:t,usersType:n})=>"page"===n?Object(o.set)("page.queries.anomalies.jobIdSelection",t,e):Object(o.set)("details.queries.anomalies.jobIdSelection",t,e))).case(a.updateUsersAnomaliesInterval,((e,{interval:t,usersType:n})=>"page"===n?Object(o.set)("page.queries.anomalies.intervalSelection",t,e):Object(o.set)("details.queries.anomalies.intervalSelection",t,e))).case(a.addUserAssetTableField,((e,{fieldName:t,tableId:n})=>({...e,flyout:{...e.flyout,queries:c({fieldName:t,tableId:n,tableById:e.flyout.queries})}}))).case(a.removeUserAssetTableField,((e,{fieldName:t,tableId:n})=>({...e,flyout:{...e.flyout,queries:d({tableId:n,fieldName:t,tableById:e.flyout.queries})}}))).build()},function(e,t,n){"use strict";n.d(t,"a",(function(){return G}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(48),l=n(44),u=n.n(l),c=n(595),d=n(112),p=n(138),m=n(596),f=n(119),g=n(396),b=n(47),y=n(75),v=n(17),h=n(158),E=n(110),x=n(522),j=n(212),O=n(523),S=n(524),k=n(550),w=n(198),T=n(382);const I=({callback:e})=>({id:"openInLens",getDisplayName:e=>w.m,getIconType:e=>"visArea",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},order:0}),C=({callback:e,disabled:t})=>({id:"saveToLibrary",getDisplayName:e=>w.a,getIconType:e=>"save",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:1}),M=({callback:e,disabled:t})=>({id:"addToExistingCase",getDisplayName:e=>w.c,getIconType:e=>"casesApp",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:2}),_=({callback:e,disabled:t})=>({id:"addToNewCase",getDisplayName:e=>w.d,getIconType:e=>"casesApp",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:3}),A=({callback:e,disabled:t})=>({id:"inspect",getDisplayName:e=>T.d,getIconType:e=>"inspect",type:"actionButton",isCompatible:async e=>!0,async execute(t){e()},disabled:t,order:4});var P=n(128),F=n(381),D=n(190),N=n(116),R=n(339);const L=[y.ACTION_CUSTOMIZE_PANEL],z=u.a.div.withConfig({displayName:"LensComponentWrapper",componentId:"sc-1ajgxgj-0"})(["height:",";width:",";"," .embPanel__header{z-index:2;position:absolute;right:0;}.expExpressionRenderer__expression{padding:2px 0 0 0 !important;}.legacyMtrVis__container{padding:0;}"],(({$height:e})=>e?`${e}px`:"auto"),(({width:e})=>null!=e?e:"auto"),(({$addHoverActionsPadding:e})=>e?".embPanel__header { top: -24px; }":"")),B={requests:void 0,responses:void 0,isLoading:!0},q=({applyGlobalQueriesAndFilters:e=!0,extraActions:t,extraOptions:n,getLensAttributes:a,height:i,id:l,inputsModelId:u=f.a.global,inspectTitle:c,lensAttributes:p,onLoad:m,scopeId:g=N.SourcererScopeName.default,stackByField:w,timerange:T,width:q,withActions:V=!0,disableOnClickFilter:U=!1})=>{var H,Z,G,Q;const W=Object(r.useMemo)((()=>({height:null!=i?i:"100%",minWidth:"100px",width:null!=q?q:"100%"})),[i,q]),{lens:K,data:{actions:{createFiltersFromValueClickAction:J}}}=Object(E.i)().services,Y=Object(o.useDispatch)(),[X,ee]=Object(r.useState)(!1),[te,ne]=Object(r.useState)(B),ae=P.d.globalQueryByIdSelector(),{searchSessionId:ie}=Object(d.a)((e=>ae(e,l))),re=Object(x.a)({applyGlobalQueriesAndFilters:e,extraOptions:n,getLensAttributes:a,lensAttributes:p,scopeId:g,stackByField:w,title:""}),se=null==re||null===(H=re.state)||void 0===H||null===(Z=H.visualization)||void 0===Z?void 0:Z.preferredSeriesType,oe="lnsLegacyMetric"!==(null==re?void 0:re.visualizationType)&&"lnsPie"!==(null==re?void 0:re.visualizationType),le=K.EmbeddableComponent,ue=Object(r.useMemo)((()=>({onInspectActionClicked:()=>{ee(!0)},isDisabled:te.isLoading})),[te.isLoading]),ce=(({attributes:e,extraActions:t,inspectActionProps:n,timeRange:a,withActions:i})=>{const{lens:s}=Object(j.b)().services,{navigateToPrefilledEditor:o}=s,[l,u]=Object(r.useState)(["inspect","addToNewCase","addToExistingCase","saveToLibrary","openInLens"]);Object(r.useEffect)((()=>{!1===i&&u([])}),[i]);const c=Object(r.useCallback)((()=>{a&&e&&o({id:"",timeRange:a,attributes:e},{openInNewTab:!0})}),[e,o,a]),{disabled:d,onAddToExistingCaseClicked:p}=Object(O.a)({lensAttributes:e,timeRange:a}),{onAddToNewCaseClicked:m,disabled:f}=Object(S.a)({timeRange:a,lensAttributes:e}),{openSaveVisualizationFlyout:g,disableVisualizations:b}=Object(k.a)({attributes:e});return Object(r.useMemo)((()=>null==l?void 0:l.reduce(((e,t)=>"inspect"===t&&null!=n?[...e,A({callback:null==n?void 0:n.onInspectActionClicked,disabled:null==n?void 0:n.isDisabled})]:"addToExistingCase"===t?[...e,M({callback:p,disabled:d})]:"addToNewCase"===t?[...e,_({callback:m,disabled:f})]:"openInLens"===t?[...e,I({callback:c})]:"saveToLibrary"===t?[...e,C({callback:g,disabled:b})]:e),[])),[l,n,p,d,m,f,c,g,b]).concat(null!=t?t:[]).map(((e,t,n)=>({...e,order:Math.max(n.length-(1+t),0)})))})({attributes:re,extraActions:t,inspectActionProps:ue,timeRange:T,withActions:V}),de=Object(r.useCallback)((()=>{ee(!1)}),[]),pe=Object(r.useCallback)((({range:e})=>{const[t,n]=e;Y(Object(h.setAbsoluteRangeDatePicker)({id:u,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[Y,u]),me=Object(r.useMemo)((()=>{var e;const[t,...n]=null!==(e=te.requests)&&void 0!==e?e:[];return{request:t,additionalRequests:n}}),[te.requests]),fe=Object(r.useMemo)((()=>{var e;const[t,...n]=null!==(e=te.responses)&&void 0!==e?e:[];return{response:t,additionalResponses:n}}),[te.responses]),ge=Object(r.useCallback)(((e,t)=>{var n;if(!t)return;const a=Object(D.f)(null==t||null===(n=t.requests)||void 0===n?void 0:n.getRequests());ne({requests:a.requests,responses:a.responses,isLoading:e}),null!=m&&m({requests:a.requests,responses:a.responses,isLoading:e})}),[m]),be=Object(r.useCallback)((()=>async e=>{if(!$(e)||"area"!==se||U)return void e.preventDefault();const[{query:t}]=await J({data:e.data,negate:e.negate}),n=null==t?void 0:t.range["@timestamp"];null!=n&&n.gte&&null!=n&&n.lt&&pe({range:[n.gte,n.lt]})}),[J,pe,se,U]),ye=Object(r.useMemo)((()=>{var e,t;return null!=(null==re||null===(e=re.state)||void 0===e?void 0:e.adHocDataViews)?Object.values(null==re||null===(t=re.state)||void 0===t?void 0:t.adHocDataViews).reduce(((e,t)=>(null!=(null==t?void 0:t.name)&&e.push(null==t?void 0:t.name),e)),[]):null}),[null==re||null===(G=re.state)||void 0===G?void 0:G.adHocDataViews]);return ie?!re||null!=(null==te?void 0:te.responses)&&0===(null==te||null===(Q=te.responses)||void 0===Q?void 0:Q.length)?s.a.createElement(v.EuiFlexGroup,null,s.a.createElement(v.EuiFlexItem,{grow:1},s.a.createElement(v.EuiEmptyPrompt,{body:s.a.createElement(v.EuiText,{size:"xs"},s.a.createElement(b.FormattedMessage,{id:"xpack.securitySolution.lensEmbeddable.NoDataToDisplay.title",defaultMessage:"No data to display"}))})),s.a.createElement(v.EuiFlexItem,{grow:!1},s.a.createElement(R.a,{extraActions:t,getLensAttributes:a,inputId:u,isInspectButtonDisabled:!0,lensAttributes:re,queryId:l,stackByField:w,timerange:T,title:c,withDefaultActions:!1}))):s.a.createElement(s.a.Fragment,null,re&&ie&&s.a.createElement(z,{$height:i,width:q,$addHoverActionsPadding:oe},s.a.createElement(le,{id:l,style:W,timeRange:T,attributes:re,disabledActions:L,onLoad:ge,onBrushEnd:pe,onFilter:be,viewMode:y.ViewMode.VIEW,withDefaultActions:!1,extraActions:ce,searchSessionId:ie,showInspector:!1,syncTooltips:!1,syncCursor:!1})),X&&null!=me.request&&null!=fe.response&&s.a.createElement(F.a,{adHocDataViews:ye,additionalRequests:me.additionalRequests,additionalResponses:fe.additionalResponses,closeModal:de,"data-test-subj":"inspect-modal",inputId:u,request:me.request,response:fe.response,title:c})):null},$=e=>Array.isArray(e.data)&&"column"in e.data[0],V=s.a.memo(q);var U=n(121),H=n(347);const Z=e=>{var t,n;const a=Object(o.useDispatch)(),{inputId:u=f.a.global,id:b,isDonut:y,label:v,donutTextWrapperClassName:h,onLoad:E,...x}=e,{session:j,refetchByRestartingSession:O,refetchByDeletingSession:S}=Object(g.a)({inputId:u,queryId:b}),{indicesExist:k}=Object(U.d)(x.scopeId),w=Object(r.useRef)(x.timerange),T=p.d.globalQueryByIdSelector(),{searchSessionId:I}=Object(d.a)((e=>T(e,b))),C=Object(H.a)({visualizationId:b}),M=null!=C&&0!==(null===(t=C[0])||void 0===t||null===(n=t.hits)||void 0===n?void 0:n.total),_=M?Object(l.css)(["top:40%;right:12%;"]):Object(l.css)(["top:66%;right:12%;"]),A=Object(r.useCallback)((({requests:e,responses:t,isLoading:n})=>{a(p.b.setQuery({inputId:u,id:b,searchSessionId:j.current.start(),refetch:O,loading:n,inspect:{dsl:e,response:t}})),"function"==typeof E&&E({requests:e,responses:t,isLoading:n})}),[a,u,b,j,O,E]);return Object(r.useEffect)((()=>{var e,t;(!k&&(null===(e=w.current)||void 0===e?void 0:e.from)!==x.timerange.from||(null===(t=w.current)||void 0===t?void 0:t.to)!==x.timerange.to)&&(w.current=x.timerange,a(p.b.deleteOneQuery({inputId:u,id:b})))}),[a,b,k,u,x.timerange]),Object(r.useEffect)((()=>{I||setTimeout((()=>{a(p.b.setQuery({inputId:u,id:b,searchSessionId:j.current.start(),refetch:M?O:S,loading:!1,inspect:null}))}),200)}),[a,u,b,j,M,O,I,S]),Object(r.useEffect)((()=>()=>{a(p.b.deleteOneQuery({inputId:u,id:b}))}),[a,b,u]),(x.getLensAttributes||x.lensAttributes)&&x.timerange?y?s.a.createElement(m.b,{isChartEmbeddablesEnabled:!0,dataExists:M,label:v,title:M?s.a.createElement(c.a,{count:null===(P=C[0])||void 0===P||null===(F=P.hits)||void 0===F?void 0:F.total}):null,donutTextWrapperClassName:h,donutTextWrapperStyles:_},s.a.createElement(V,i()({},x,{id:b,onLoad:A}))):s.a.createElement(V,i()({},x,{id:b,onLoad:A})):null;var P,F},G=s.a.memo(Z)},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var a=n(2),i=n(48),r=n(234),s=n.n(r),o=n(83),l=n(110),u=n(149),c=n(116),d=n(554),p=n(555),m=n(117);const f=s()(((e,t)=>{if(null==t)return{browserFields:{}};{const e={};for(const[n,a]of Object.entries(t)){const t=Object(o.getCategory)(n);null==e[t]&&(e[t]={fields:{}});const i=e[t].fields;i&&(i[n]=a)}return{browserFields:e}}}),((e,t)=>{var n,a;return e[0]===t[0]&&(null===(n=e[1])||void 0===n?void 0:n.length)===(null===(a=t[1])||void 0===a?void 0:a.length)})),g=()=>{const{data:e}=Object(l.i)().services,t=Object(a.useRef)({}),n=Object(a.useRef)({}),r=Object(i.useDispatch)(),{addError:s}=Object(m.a)(),o=Object(a.useCallback)((({id:e,loading:t})=>{r(u.a.setDataViewLoading({id:e,loading:t}))}),[r]);return{indexFieldsSearch:Object(a.useCallback)((({dataViewId:a,scopeId:i=c.SourcererScopeName.default,needToBeInit:l=!1,cleanCache:m=!1,skipScopeUpdate:f=!1})=>(n.current[a]&&n.current[a].unsubscribe(),t.current[a]&&t.current[a].abort(),(async()=>{try{t.current={...t.current,[a]:new AbortController},o({id:a,loading:!0});const n=await Object(d.a)(a,e.dataViews,m);l&&i&&!f&&r(u.a.setSelectedDataView({id:i,selectedDataViewId:a,selectedPatterns:n.patternList})),r(u.a.setDataView({...n,loading:!1}))}catch(e){s(null==e?void 0:e.message,{title:p.a})}})())),[o,e.dataViews,r,s])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(281),i=n(586);const r=(e,t=!0)=>{const n=Object(i.a)(e.to),r=Object(i.a)(e.from),{to:s,from:o}=Object(a.d)(t),l=n.isValid()?n.toISOString():s,u=r.isValid()?r.toISOString():o;return{...e,to:l,from:u}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(184);const r=()=>{const{startTransaction:e}=Object(i.b)();return{startTracking:Object(a.useCallback)((({name:t,spanName:n="fetch"})=>{const a=e({name:t,type:"http-request",options:{managed:!1}}),i=null==a?void 0:a.startSpan(n,"http-request",{blocking:!0});return{endTracking:e=>{null==a||a.addLabels({result:e}),null==i||i.end()}}}),[e])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a={refetchIntervalInBackground:!1,staleTime:3e5}},function(e,t,n){"use strict";let a,i,r;n.r(t),n.d(t,"NetworkType",(function(){return a})),n.d(t,"NetworkTableType",(function(){return i})),n.d(t,"NetworkDetailsTableType",(function(){return r})),function(e){e.page="page",e.details="details"}(a||(a={})),function(e){e.alerts="alerts",e.dns="dns",e.http="http",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.tls="tls",e.anomalies="anomalies"}(i||(i={})),function(e){e.http="http",e.tls="tls",e.topCountriesDestination="topCountriesDestination",e.topCountriesSource="topCountriesSource",e.topNFlowDestination="topNFlowDestination",e.topNFlowSource="topNFlowSource",e.users="users",e.anomalies="anomalies"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(119),u=n(212),c=n(381),d=n(465),p=n(522),m=n(523),f=n(524),g=n(550),b=n(198),y=n(190),v=n(116),h=n(117);const E=o.a.div.withConfig({displayName:"Wrapper",componentId:"sc-9cci34-0"})(["&.viz-actions{position:absolute;top:0;right:0;z-index:1;}&.histogram-viz-actions{padding:",";}"],(({theme:e})=>e.eui.euiSizeS)),x=({applyGlobalQueriesAndFilters:e=!0,className:t,extraActions:n,extraOptions:s,getLensAttributes:o,inputId:x=l.a.global,inspectIndex:j=0,isInspectButtonDisabled:O,isMultipleQuery:S,lensAttributes:k,onCloseInspect:w,queryId:T,timerange:I,title:C,scopeId:M=v.SourcererScopeName.default,stackByField:_,withDefaultActions:A=!0})=>{const{lens:P}=Object(u.b)().services,{canUseEditor:F,navigateToPrefilledEditor:D,SaveModalComponent:N}=P,[R,L]=Object(i.useState)(!1),[z,B]=Object(i.useState)(!1),[q,$]=Object(i.useState)(!1),{addSuccess:V}=Object(h.a)(),U=Object(i.useCallback)((()=>{$(!1),V(b.a)}),[V]),H=Object(i.useCallback)((()=>{$(!1)}),[]),Z=F(),G=Object(i.useCallback)((()=>{L(!R)}),[R]),Q=()=>{L(!1)},W=Object(p.a)({applyGlobalQueriesAndFilters:e,extraOptions:s,getLensAttributes:o,lensAttributes:k,scopeId:M,stackByField:_,title:""}),K=`stat-${T}`,{disabled:J,onAddToExistingCaseClicked:Y}=Object(m.a)({onAddToCaseClicked:Q,lensAttributes:W,timeRange:I}),{onAddToNewCaseClicked:X,disabled:ee}=Object(f.a)({onClick:Q,timeRange:I,lensAttributes:W}),te=Object(i.useCallback)((()=>{Q(),I&&W&&D({id:"",timeRange:I,attributes:W},{openInNewTab:!0})}),[W,D,I]),{openSaveVisualizationFlyout:ne,disableVisualizations:ae}=Object(g.a)({attributes:W}),ie=Object(i.useCallback)((()=>{Q(),B(!0)}),[]),re=Object(i.useCallback)((()=>{B(!1),w&&w()}),[w]),{additionalRequests:se,additionalResponses:oe,handleClick:le,handleCloseModal:ue,isButtonDisabled:ce,request:de,response:pe}=Object(d.a)({inputId:x,inspectIndex:j,isDisabled:O,multiple:S,onCloseInspect:re,onClick:ie,queryId:T}),me=Object(i.useMemo)((()=>{var e;const t={};return[...(null!==(e=null==n?void 0:n.map((e=>r.a.createElement(a.EuiContextMenuItem,{icon:null==e?void 0:e.getIconType(t),key:e.id,onClick:()=>e.execute(t),"data-test-subj":`viz-actions-${e.id}`},e.getDisplayName(t)))))&&void 0!==e?e:[])||[],...A?[r.a.createElement(a.EuiContextMenuItem,{icon:"inspect",key:"visualizationActionsInspect",onClick:le,disabled:ce,"data-test-subj":"viz-actions-inspect"},b.k),r.a.createElement(a.EuiContextMenuItem,{disabled:ee,icon:"plusInCircle",key:"visualizationActionsAddToNewCase",onClick:X,"data-test-subj":"viz-actions-add-to-new-case"},b.d),r.a.createElement(a.EuiContextMenuItem,{disabled:J,"data-test-subj":"viz-actions-add-to-existing-case",icon:"plusInCircle",key:"visualizationActionsAddToExistingCase",onClick:Y},b.c),...Z?[r.a.createElement(a.EuiContextMenuItem,{icon:"visArea",key:"visualizationActionsSaveVisualization","data-test-subj":"viz-actions-save-visualization",disabled:ae,onClick:ne},b.a)]:[],r.a.createElement(a.EuiContextMenuItem,{icon:"visArea",key:"visualizationActionsOpenInLens","data-test-subj":"viz-actions-open-in-lens",disabled:ae,onClick:te},b.m)]:[]]}),[Z,ce,ae,n,le,J,ee,Y,X,te,ne,A]),fe=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonIcon,{"aria-label":b.l,className:y.a,"data-test-subj":K,iconType:"boxesHorizontal",onClick:G})),[K,G]);return r.a.createElement(E,{className:t},me.length>0&&r.a.createElement(a.EuiPopover,{button:fe,isOpen:R,closePopover:Q,panelPaddingSize:"none",anchorPosition:"downLeft",panelClassName:"withHoverActions__popover","data-test-subj":"viz-actions-popover"},r.a.createElement(a.EuiContextMenuPanel,{"data-test-subj":"viz-actions-panel",size:"s",items:me})),z&&null!==de&&null!==pe&&r.a.createElement(c.a,{additionalRequests:se,additionalResponses:oe,closeModal:ue,inputId:x,request:de,response:pe,title:C}),q&&Z&&r.a.createElement(N,{initialInput:W,onSave:U,onClose:H}))};x.displayName="VisualizationActionsComponent";const j=r.a.memo(x)},,function(e,t,n){"use strict";n.d(t,"d",(function(){return b.d})),n.d(t,"a",(function(){return b.a})),n.d(t,"f",(function(){return b.f})),n.d(t,"c",(function(){return b.c})),n.d(t,"e",(function(){return b.e})),n.d(t,"b",(function(){return b.b}));var a=n(111);a.z.object({rules_custom_installed:a.z.number().int().min(0),rules_installed:a.z.number().int().min(0),rules_not_installed:a.z.number().int().min(0),rules_not_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_not_installed:a.z.number().int().min(0),timelines_not_updated:a.z.number().int().min(0)}).strict(),a.z.object({rules_installed:a.z.number().int().min(0),rules_updated:a.z.number().int().min(0),timelines_installed:a.z.number().int().min(0),timelines_updated:a.z.number().int().min(0)}).strict();var i=n(46);const r=i.exact(i.type({rule_id:i.string,version:i.number})),s=i.exact(i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(r)})),o=i.exact(i.type({mode:i.literal("ALL_RULES")}));let l;i.union([o,s]),function(e){e.ALREADY_INSTALLED="ALREADY_INSTALLED"}(l||(l={}));var u=n(120);let c;!function(e){e.BASE="BASE",e.CURRENT="CURRENT",e.TARGET="TARGET"}(c||(c={}));const d=Object(u.r)("PickVersionValues",c),p=i.exact(i.intersection([i.type({rule_id:i.string,revision:i.number,version:i.number}),i.partial({pick_version:d})])),m=i.exact(i.intersection([i.type({mode:i.literal("SPECIFIC_RULES"),rules:i.array(p)}),i.partial({pick_version:d})])),f=i.exact(i.intersection([i.type({mode:i.literal("ALL_RULES")}),i.partial({pick_version:d})]));let g;i.union([f,m]),function(e){e.RULE_UP_TO_DATE="RULE_UP_TO_DATE"}(g||(g={}));var b=n(326),y=n(278);const v=e=>i.intersection([i.exact(i.type(e.required)),i.exact(i.type(Object(y.N)(e.optional)))]);var h=n(273);let E;!function(e){e.index_patterns="index_patterns",e.data_view="data_view"}(E||(E={}));const x=i.exact(i.type({type:i.literal(E.index_patterns),index_patterns:y.g})),j=i.exact(i.type({type:i.literal(E.data_view),data_view_id:y.c})),O=i.union([x,j]);let S;!function(e){e.inline_query="inline_query",e.saved_query="saved_query"}(S||(S={}));const k=i.exact(i.type({type:i.literal(S.inline_query),query:y.w,language:y.i,filters:y.q})),w=i.exact(i.type({type:i.literal(S.saved_query),saved_query_id:h.e})),T=i.union([k,w]),I=i.exact(i.type({query:y.w,language:i.literal("eql"),filters:y.q})),C=i.exact(i.type({query:y.w,language:i.literal("esql")})),M=i.exact(i.type({interval:Object(u.p)({allowedUnits:["s","m","h"]}),lookback:Object(u.p)({allowedUnits:["s","m","h"]})})),_=i.exact(i.type({field_name:y.u})),A=i.exact(i.type({field_name:y.L,fallback_disabled:y.M})),P=i.exact(i.type({timeline_id:y.I,timeline_title:y.J})),F=i.exact(i.type({type:y.b}));var D=n(277);const N=v({required:{rule_id:y.y,version:y.A,meta:y.s,name:y.t,tags:y.z,description:y.o,severity:D.h,severity_mapping:D.i,risk_score:D.a,risk_score_mapping:D.b,references:y.x,false_positives:y.p,threat:y.F,note:y.h,setup:y.E,related_integrations:y.l,required_fields:y.m,author:y.n,license:y.r,rule_schedule:M,actions:D.c,throttle:D.d,exceptions_list:y.e,max_signals:y.j},optional:{rule_name_override:_,timestamp_override:A,timeline_template:P,building_block:F}}),R=v({required:{type:i.literal("query"),kql_query:T},optional:{data_source:O,alert_suppression:y.a}}),L=v({required:{type:i.literal("saved_query"),kql_query:T},optional:{data_source:O,alert_suppression:y.a}}),z=v({required:{type:i.literal("eql"),eql_query:I},optional:{data_source:O,event_category_override:y.d,timestamp_field:y.K,tiebreaker_field:y.H}}),B=v({required:{type:i.literal("esql"),esql_query:C},optional:{}}),q=v({required:{type:i.literal("threat_match"),kql_query:T,threat_query:k,threat_index:D.q,threat_mapping:D.s},optional:{data_source:O,threat_indicator_path:D.r,concurrent_searches:D.j,items_per_search:D.k}}),$=v({required:{type:i.literal("threshold"),kql_query:T,threshold:y.G},optional:{data_source:O}}),V=v({required:{type:i.literal("machine_learning"),machine_learning_job_id:D.l,anomaly_threshold:h.c},optional:{}}),U=v({required:{type:i.literal("new_terms"),kql_query:k,new_terms_fields:y.k,history_window_start:y.f},optional:{data_source:O}});let H,Z;i.intersection([N,i.union([R,L,z,B,q,$,V,U])]),n(9),Symbol("MissingVersion"),function(e){e.StockValueNoUpdate="BASE=A, CURRENT=A, TARGET=A",e.StockValueCanUpdate="BASE=A, CURRENT=A, TARGET=B",e.CustomizedValueNoUpdate="BASE=A, CURRENT=B, TARGET=A",e.CustomizedValueSameUpdate="BASE=A, CURRENT=B, TARGET=B",e.CustomizedValueCanUpdate="BASE=A, CURRENT=B, TARGET=C"}(H||(H={})),function(e){e.Current="CURRENT",e.Target="TARGET",e.Merged="MERGED",e.Conflict="CONFLICT"}(Z||(Z={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return he})),n.d(t,"b",(function(){return we}));var a=n(80),i=n(1146),r=n(661),s=n(3),o=n(1145),l=n.n(o),u=n(124),c=n(635),d=n(4),p=n(21),m=n(167),f=n(118),g=n(14),b=n(138),y=n(482),v=n(45),h=n(53),E=n(64),x=n(113),j=n(208),O=n(193),S=n(393),k=n(585),w=n(0),T=n.n(w);const I=new class manage_timeline_id_ManageEpicTimelineId{constructor(){T()(this,"timelineId",null),T()(this,"version",null),T()(this,"templateTimelineId",null),T()(this,"templateVersion",null)}getTimelineId(){return this.timelineId}getTimelineVersion(){return this.version}getTemplateTimelineId(){return this.templateTimelineId}getTemplateTimelineVersion(){return this.templateVersion}setTimelineId(e){this.timelineId=e}setTimelineVersion(e){this.version=e}setTemplateTimelineId(e){this.templateTimelineId=e}setTemplateTimelineVersion(e){this.templateVersion=e}},C=new s.Subject;var M=n(110);const _=new Set([g.addNote.type,g.addNoteToEvent.type]);function A(e){return _.has(e.type)}const P=(e,t)=>null!=e?t[e].note:"",F=new Set([g.pinEvent.type,g.unPinEvent.type]);function D(e){return F.has(e.type)}const N=new Set([g.updateIsFavorite.type]);function R(e){return N.has(e.type)}var L=n(763);const z=e=>e&&e.toLowerCase().startsWith("timeline"),B=()=>(e,t,{selectAllTimelineQuery:n,selectNotesByIdSelector:a,timelineByIdSelector:i,timelineTimeRangeSelector:r,kibana$:o})=>{const l=t.pipe(Object(E.map)(i),Object(E.filter)(L.h)),u=t.pipe(Object(E.map)((e=>n()(e,S.a))),Object(E.filter)(L.h)),c=t.pipe(Object(E.map)(a),Object(E.filter)(L.h)),p=t.pipe(Object(E.map)(r),Object(E.filter)(L.h));return Object(s.merge)(e.pipe(Object(E.withLatestFrom)(l),Object(E.filter)((([e,t])=>{const n=Object(v.get)("payload.id",e),a=t[n];if(e.type===j.addError.type)return!0;if(z(n)&&null!=a&&null!=a.status&&x.k.immutable===a.status)return!1;if(e.type===g.createTimeline.type&&z(n))I.setTimelineVersion(null),I.setTimelineId(null),I.setTemplateTimelineId(null),I.setTemplateTimelineVersion(null);else{if(e.type===g.addTimeline.type&&z(n)){const t=Object(v.get)("payload.timeline",e);return I.setTimelineId(t.savedObjectId),I.setTimelineVersion(t.version),I.setTemplateTimelineId(t.templateTimelineId),I.setTemplateTimelineVersion(t.templateTimelineVersion),Object(v.getOr)(!1,"payload.savedTimeline",e)}if(e.type===g.saveTimeline.type&&!a.isSaving&&z(n))return!0}})),Object(E.mergeMap)((([e])=>(C.next({action:e}),s.EMPTY)))),C.pipe(Object(E.withLatestFrom)(l,c,p),Object(E.concatMap)((([t,n,a,i])=>{const r=Object(v.get)("action",t),p=I.getTimelineId(),m=I.getTimelineVersion(),f=I.getTemplateTimelineId(),b=I.getTemplateTimelineVersion();if(A(r))return((e,t,n,a,i,r)=>Object(s.from)((async({note:e,noteId:t,version:n,overrideOwner:a})=>{let i;try{i=JSON.stringify({noteId:t,version:n,note:e,overrideOwner:a})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return await M.b.get().http.patch(d.Rb,{method:"PATCH",body:i,version:"2023-10-31"})})({noteId:null,version:null,note:{eventId:"eventId"in e.payload?e.payload.eventId:void 0,note:P(e.payload.noteId,t),timelineId:I.getTimelineId()}})).pipe(Object(E.withLatestFrom)(a,i,r),Object(E.mergeMap)((([t,n,a,i])=>{const r=e.payload.noteId,s=Object(v.get)("data.persistNote",t),o=403===s.code?[Object(g.showCallOutUnauthorizedMsg)()]:[];return null!=i.refetch&&i.refetch(),[...o,null==n[e.payload.id].savedObjectId?Object(g.updateTimeline)({id:e.payload.id,timeline:{...n[e.payload.id],savedObjectId:s.note.timelineId||null,version:s.note.timelineVersion||null}}):null,Object(j.updateNote)({note:{...a[r],created:null!=s.note.updated?new Date(s.note.updated):a[r].created,user:null!=s.note.updatedBy?s.note.updatedBy:a[r].user,saveObjectId:s.note.noteId,version:s.note.version}}),Object(g.endTimelineSaving)({id:e.payload.id})].filter(Boolean)})),Object(E.startWith)(Object(g.startTimelineSaving)({id:e.payload.id})),Object(E.takeUntil)(n.pipe(Object(E.withLatestFrom)(a),Object(E.filter)((([e,t])=>e.type===j.addError.type||e.type===g.endTimelineSaving.type&&null!=t[Object(v.get)("payload.id",e)].savedObjectId&&(I.setTimelineId(t[Object(v.get)("payload.id",e)].savedObjectId),I.setTimelineVersion(t[Object(v.get)("payload.id",e)].version),!0)))))))(r,a,e,l,c,u);if(D(r))return((e,t,n,a,i)=>Object(s.from)((async({eventId:e,pinnedEventId:t,timelineId:n})=>{let a;try{a=JSON.stringify({eventId:e,pinnedEventId:t,timelineId:n})}catch(e){return Promise.reject(new Error(`Failed to stringify query: ${JSON.stringify(e)}`))}return await M.b.get().http.patch(d.Xb,{method:"PATCH",body:a,version:"2023-10-31"})})({pinnedEventId:null!=t[e.payload.id].pinnedEventsSaveObject[e.payload.eventId]?t[e.payload.id].pinnedEventsSaveObject[e.payload.eventId].pinnedEventId:null,eventId:e.payload.eventId,timelineId:I.getTimelineId()})).pipe(Object(E.withLatestFrom)(a,i),Object(E.mergeMap)((([t,n,a])=>{const i=n[e.payload.id],r=Object(v.get)("data.persistPinnedEventOnTimeline",t),s=r&&403===r.code?[Object(g.showCallOutUnauthorizedMsg)()]:[];return null!=a.refetch&&a.refetch(),[null!=r?Object(g.updateTimeline)({id:e.payload.id,timeline:{...i,savedObjectId:null==i.savedObjectId&&null!=r.timelineId?r.timelineId:i.savedObjectId,version:null==i.version&&null!=r.timelineVersion?r.timelineVersion:i.version,pinnedEventIds:{...i.pinnedEventIds,[e.payload.eventId]:!0},pinnedEventsSaveObject:{...i.pinnedEventsSaveObject,[e.payload.eventId]:r}}}):Object(g.updateTimeline)({id:e.payload.id,timeline:{...i,pinnedEventIds:Object(v.omit)(e.payload.eventId,i.pinnedEventIds),pinnedEventsSaveObject:Object(v.omit)(e.payload.eventId,i.pinnedEventsSaveObject)}}),...s,Object(g.endTimelineSaving)({id:e.payload.id})].filter(Boolean)})),Object(E.startWith)(Object(g.startTimelineSaving)({id:e.payload.id})),Object(E.takeUntil)(n.pipe(Object(E.withLatestFrom)(a),Object(E.filter)((([e,t])=>e.type===j.addError.type||e.type===g.endTimelineSaving.type&&null!=t[Object(v.get)("payload.id",e)].savedObjectId&&(I.setTimelineId(t[Object(v.get)("payload.id",e)].savedObjectId),I.setTimelineVersion(t[Object(v.get)("payload.id",e)].version),!0)))))))(r,n,e,l,u);if(R(r))return((e,t,n,a,i)=>{var r;return Object(s.from)(Object(O.h)({timelineId:I.getTimelineId(),templateTimelineId:t[e.payload.id].templateTimelineId,templateTimelineVersion:t[e.payload.id].templateTimelineVersion,timelineType:null!==(r=t[e.payload.id].timelineType)&&void 0!==r?r:x.l.default})).pipe(Object(E.withLatestFrom)(a,i),Object(E.mergeMap)((([t,n,a])=>{const i=n[e.payload.id],r=Object(v.get)("data.persistFavorite",t),s=403===r.code?[Object(g.showCallOutUnauthorizedMsg)()]:[];return null!=a.refetch&&a.refetch(),[...s,Object(g.updateTimeline)({id:e.payload.id,timeline:{...i,isFavorite:null!=r.favorite&&r.favorite.length>0,savedObjectId:r.savedObjectId||null,version:r.version||null}}),Object(g.endTimelineSaving)({id:e.payload.id})].filter(Boolean)})),Object(E.startWith)(Object(g.startTimelineSaving)({id:e.payload.id})),Object(E.takeUntil)(n.pipe(Object(E.withLatestFrom)(a),Object(E.filter)((([e,t])=>e.type===j.addError.type||e.type===g.endTimelineSaving.type&&null!=t[Object(v.get)("payload.id",e)].savedObjectId&&(I.setTimelineId(t[Object(v.get)("payload.id",e)].savedObjectId),I.setTimelineVersion(t[Object(v.get)("payload.id",e)].version),I.setTemplateTimelineId(t[Object(v.get)("payload.id",e)].templateTimelineId),I.setTemplateTimelineVersion(t[Object(v.get)("payload.id",e)].templateTimelineVersion),!0))))))})(r,n,e,l,u);if(function(e){return e.type===g.saveTimeline.type}(r)){const t=r,a=n[r.payload.id].savedSearch;return Object(s.from)(t.payload.saveAsNew&&p?Object(O.a)({timelineId:p,timeline:{...$(n[r.payload.id],i),templateTimelineId:f,templateTimelineVersion:b},savedSearch:a}):Object(O.i)({timelineId:p,version:m,timeline:{...$(n[r.payload.id],i),templateTimelineId:f,templateTimelineVersion:b},savedSearch:a})).pipe(Object(E.withLatestFrom)(l,u,o),Object(E.mergeMap)((([e,t,n,a])=>{var i,s,o,l,u,c,d;if(function(e){return"status_code"in e||"statusCode"in e}(e)){const t=function(e){return"status_code"in e?{errorCode:e.status_code,message:e.message}:"statusCode"in e?{errorCode:e.statusCode,message:e.message}:void 0}(e);return 409===(null==t?void 0:t.errorCode)?a.notifications.toasts.addDanger({title:k.f,text:k.e}):a.notifications.toasts.addDanger({title:k.h,text:null!==(i=null==t?void 0:t.message)&&void 0!==i?i:k.g}),[Object(g.endTimelineSaving)({id:r.payload.id})]}const p=e.data.persistTimeline;return null==p?(a.notifications.toasts.addDanger({title:k.h,text:k.g}),[Object(g.endTimelineSaving)({id:r.payload.id})]):403===p.code?[Object(g.showCallOutUnauthorizedMsg)(),Object(g.endTimelineSaving)({id:r.payload.id})]:(null!=n.refetch&&n.refetch(),[Object(g.updateTimeline)({id:r.payload.id,timeline:{...t[r.payload.id],updated:null!==(s=p.timeline.updated)&&void 0!==s?s:void 0,savedObjectId:p.timeline.savedObjectId,version:p.timeline.version,status:null!==(o=p.timeline.status)&&void 0!==o?o:x.k.active,timelineType:null!==(l=p.timeline.timelineType)&&void 0!==l?l:x.l.default,templateTimelineId:null!==(u=p.timeline.templateTimelineId)&&void 0!==u?u:null,templateTimelineVersion:null!==(c=p.timeline.templateTimelineVersion)&&void 0!==c?c:null,savedSearchId:null!==(d=p.timeline.savedSearchId)&&void 0!==d?d:null,isSaving:!1}}),Object(g.setChanged)({id:r.payload.id,changed:!1}),Object(g.endTimelineSaving)({id:r.payload.id})])})),Object(E.startWith)(Object(g.startTimelineSaving)({id:r.payload.id})),Object(E.takeUntil)(e.pipe(Object(E.withLatestFrom)(l),Object(E.filter)((([e,t])=>e.type===g.endTimelineSaving.type&&null!=t[Object(v.get)("payload.id",e)].savedObjectId&&(I.setTimelineId(t[Object(v.get)("payload.id",e)].savedObjectId),I.setTimelineVersion(t[Object(v.get)("payload.id",e)].version),I.setTemplateTimelineId(t[Object(v.get)("payload.id",e)].templateTimelineId),I.setTemplateTimelineVersion(t[Object(v.get)("payload.id",e)].templateTimelineVersion),!0))))))}return s.EMPTY}))))},q={columns:null,dataProviders:null,dataViewId:null,description:null,eqlOptions:null,eventType:null,excludedRowRendererIds:null,filters:null,kqlMode:null,kqlQuery:null,indexNames:null,title:null,timelineType:x.l.default,templateTimelineVersion:null,templateTimelineId:null,dateRange:null,savedQueryId:null,sort:null,status:null,savedSearchId:null},$=(e,t)=>Object.keys(q).reduce(((n,a)=>{if(Object(v.has)(a,e)){if("kqlQuery"===a)return Object(v.set)(`${a}.filterQuery`,Object(v.get)(`${a}.filterQuery`,e),n);if("dateRange"===a)return Object(v.set)(`${a}`,{start:t.from,end:t.to},n);if("columns"===a&&null!=Object(v.get)(a,e))return Object(v.set)(a,Object(v.get)(a,e).map((e=>Object(v.omit)(["initialWidth","width","__typename","esTypes"],e))),n);if("filters"===a&&null!=Object(v.get)(a,e)){const t=Object(v.get)(a,e);return Object(v.set)(a,null!=t?t.map((e=>{const t=Object(v.omit)(["$state"],e);return{...t,meta:{...t.meta,field:(Object(h.isMatchAllFilter)(t)||Object(h.isPhraseFilter)(t)||Object(h.isPhrasesFilter)(t)||Object(h.isRangeFilter)(t))&&null!=t.meta.field?V(t.meta.field):null,value:null!=t.meta.value?V(t.meta.value):null,params:null!=t.meta.params?V(t.meta.params):null},...Object(h.isMatchAllFilter)(t)?{query:{match_all:V(t.query.match_all)}}:{match_all:null},...Object(h.isExistsFilter)(t)&&null!=t.query.exists?{query:{exists:V(t.query.exists)}}:{exists:null},...!Object(h.isQueryStringFilter)(t)&&null==Object(v.get)("query",t)||null==t.query?{query:null}:{query:V(t.query)},...Object(h.isRangeFilter)(t)&&null!=t.query.range?{query:{range:V(t.query.range)}}:{range:null},...Object(h.isScriptedRangeFilter)(t)&&null!=t.query.script?{query:{script:V(t.query.script)}}:{script:null}}})):[],n)}return Object(v.set)(a,Object(v.get)(a,e),n)}return n}),q),V=e=>{try{return Object(v.isObject)(e)?JSON.stringify(e):Object(v.toString)(e)}catch{return""}},U=new Set([g.applyKqlFilterQuery.type,g.addProvider.type,g.dataProviderEdited.type,g.removeProvider.type,g.setExcludedRowRendererIds.type,g.setFilters.type,g.setSavedQueryId.type,g.updateDataProviderEnabled.type,g.updateDataProviderExcluded.type,g.updateDataProviderType.type,g.updateEqlOptions.type,g.updateKqlMode.type,g.updateProviders.type,g.updateTitleAndDescription.type,g.updateDataView.type,g.removeColumn.type,g.updateColumns.type,g.updateSort.type,g.updateRange.type,g.upsertColumn.type,g.updateSavedSearch.type]);var H=n(587);const{applyDeltaToColumnWidth:Z,changeViewMode:G,removeColumn:Q,toggleDetailPanel:W,updateColumnOrder:K,updateColumns:J,updateColumnWidth:Y,updateIsLoading:X,updateItemsPerPage:ee,updateShowBuildingBlockAlertsFilter:te,updateSort:ne,upsertColumn:ae}=u.h,ie=e=>null!==e,re=new Set([Q.type,ae.type,Z.type,J.type,K.type,Y.type,ee.type,ne.type,G.type,te.type,g.updateTotalCount.type,X.type,W.type]);var se=n(329),oe=n(447),le=n(660);const ue=e=>null!==e,{removeUserAssetTableField:ce,addUserAssetTableField:de}=se.c,pe=new Set([ce.type,de.type]);var me=n(116),fe=n(477),ge=n(1278);function be(e){return e?{timeRange:{from:e.from,to:e.to}}:[]}var ye=n(149);let ve=null;const he=async(e,t,n,a,i)=>{var r,o,u,p,m;let f={name:null};try{!0===e.application.capabilities[d.vc].show&&(f=await e.http.fetch(d.eb,{version:"2023-10-31",method:"GET"}))}catch{f={name:null}}const g=e.uiSettings.get(d.I);let b,v;try{var h,E;const e=await Object(fe.a)({body:{patternList:[...g,...null!=f.name?[f.name]:[]]},dataViewService:t.data.dataViews,dataViewId:`${d.D}-${null===(h=await(null===(E=t.spaces)||void 0===E?void 0:E.getActiveSpace()))||void 0===h?void 0:h.id}`});if(void 0===e)throw new Error("");b={...me.initDataView,...e.defaultDataView},v=e.kibanaDataViews.map((e=>({...me.initDataView,...e})))}catch(e){b={...me.initDataView,error:e},v=[]}const x={kibana:e},j=new s.BehaviorSubject(x),O={timeline:{...n.timelines.store.initialState.timeline,timelineById:{...n.timelines.store.initialState.timeline.timelineById}}},S={dataTable:{tableById:{...n.alerts.storageDataTables.tableById,...n.rules.storageDataTables.tableById,...n.exceptions.storageDataTables.tableById,...n.explore.exploreDataTables.hosts.tableById,...n.explore.exploreDataTables.network.tableById,...n.explore.exploreDataTables.users.tableById}}},k={groups:c.b},w=l()(O.timeline,null!==(r=null===(o=t.timelines)||void 0===o?void 0:o.getTimelineReducer())&&void 0!==r?r:{},n.timelines.store.reducer.timeline),T=Object(y.a)({...n.explore.store.initialState,...O,...n.management.store.initialState},{defaultDataView:b,kibanaDataViews:v,signalIndexName:f.name,enableExperimental:i},S,k,{analyzer:{}}),I={...n.explore.store.reducer,timeline:w,...n.management.store.reducer};return ke(T,I,j.pipe(Object(s.pluck)("kibana")),a,[...null!==(u=n.management.store.middleware)&&void 0!==u?u:[],...null!==(p=n.explore.store.middleware)&&void 0!==p?p:[],null!==(m=Object(ge.a)((C=e,{relatedEvents:async({entityID:e,timeRange:t,indexPatterns:n})=>({...await C.http.post("/api/endpoint/resolver/events",{query:{},body:JSON.stringify({indexPatterns:n,...be(t),filter:JSON.stringify({bool:{filter:[{term:{"process.entity_id":e}},{bool:{must_not:{term:{"event.category":"process"}}}}]}})})}),entityID:e}),eventsWithEntityIDAndCategory({entityID:e,category:t,after:n,timeRange:a,indexPatterns:i}){const r={query:{afterEvent:n,limit:25},body:{...be(a),indexPatterns:i}};return"alert"===t?C.http.post("/api/endpoint/resolver/events",{query:r.query,body:JSON.stringify({...r.body,entityType:"alerts",eventID:e})}):C.http.post("/api/endpoint/resolver/events",{query:r.query,body:JSON.stringify({...r.body,filter:JSON.stringify({bool:{filter:[{term:{"process.entity_id":e}},{term:{"event.category":t}}]}})})})},async nodeData({ids:e,timeRange:t,indexPatterns:n,limit:a}){const i={query:{limit:a},body:JSON.stringify({indexPatterns:n,...be(t),filter:JSON.stringify({bool:{filter:[{terms:{"process.entity_id":e}},{term:{"event.category":"process"}}]}})})};return(await C.http.post("/api/endpoint/resolver/events",i)).events},async event({nodeID:e,eventID:t,eventCategory:n,eventTimestamp:a,winlogRecordID:i,timeRange:r,indexPatterns:s}){const o=void 0===t?{bool:{filter:[{terms:{"event.category":n}},{term:{"process.entity_id":e}},{term:{"@timestamp":a}},{term:{"winlog.record_id":i}}]}}:{bool:{filter:[{term:{"event.id":t}}]}};if(!1===n.includes("alert")){const e=await C.http.post("/api/endpoint/resolver/events",{query:{limit:1},body:JSON.stringify({indexPatterns:s,...be(r),filter:JSON.stringify(o)})}),[t]=e.events;return null!=t?t:null}{const e=await C.http.post("/api/endpoint/resolver/events",{query:{limit:1},body:JSON.stringify({indexPatterns:s,...be(r),entityType:"alertDetail",eventID:t})}),[n]=e.events;return null!=n?n:null}},resolverTree:async({dataId:e,schema:t,timeRange:n,indices:a,ancestors:i,descendants:r})=>C.http.post("/api/endpoint/resolver/tree",{body:JSON.stringify({ancestors:i,descendants:r,timeRange:n,schema:t,nodes:[e],indexPatterns:a})}),entities:async({_id:e,indices:t,signal:n})=>C.http.get("/api/endpoint/resolver/entity",{signal:n,query:{_id:e,indices:t}})})))&&void 0!==m?m:[]]);var C},Ee=[g.updateTimeline.type,g.addTimeline.type,g.initializeTimelineSettings.type],xe=e=>{if(e.type===ye.a.setDataView.type)return{...e,payload:{...e.payload,dataView:"dataView",browserFields:"browserFields",indexFields:"indexFields",fields:"fields"}};if(Ee.includes(e.type)){const{type:t,payload:n}=e;if(t===g.addTimeline.type||t===g.updateTimeline.type)return{...e,payload:{...n,timeline:Oe(n.timeline)}};if(t===g.initializeTimelineSettings.type)return{...e,payload:{...n,timeline:Oe(n.timeline)}}}return e},je=e=>({...e,browserFields:"browserFields",indexFields:"indexFields",fields:"fields",dataView:"dataView"}),Oe=e=>({...e,filterManager:"filterManager",footerText:"footerText",loadingText:"loadingText"}),Se=e=>e.sourcerer?{...e,sourcerer:{...e.sourcerer,defaultDataView:je(e.sourcerer.defaultDataView),kibanaDataViews:e.sourcerer.kibanaDataViews.map(je)}}:e,ke=(e,t,n,o,l)=>{const c={name:"Kibana Security Solution",actionsBlacklist:["USER_MOVED_POINTER","USER_SET_RASTER_SIZE"],actionSanitizer:xe,stateSanitizer:Se},d=Object(i.composeWithDevTools)(c),h={kibana$:n,selectAllTimelineQuery:b.d.globalQueryByIdSelector,selectNotesByIdSelector:m.c.selectNotesByIdSelector,timelineByIdSelector:f.b.timelineByIdSelector,timelineTimeRangeSelector:b.d.timelineTimeRangeSelector,tableByIdSelector:u.j.tableByIdSelector,storage:o},x=Object(r.createEpicMiddleware)({dependencies:h}),j=Object(a.applyMiddleware)(x,p.g,...null!=l?l:[]);return ve=Object(a.createStore)(Object(y.b)(t),e,d(j)),x.run(Object(r.combineEpics)(B(),(e=>e.pipe(Object(E.filter)((e=>U.has(e.type))),Object(E.map)((e=>Object(g.setChanged)({id:Object(v.get)("payload.id",e),changed:!0}))))),(e=>e.pipe(Object(E.filter)(R),Object(E.mergeMap)((e=>(C.next({action:e}),s.EMPTY))))),(e=>e.pipe(Object(E.filter)(A),Object(E.switchMap)((e=>(C.next({action:e}),s.EMPTY))))),(e=>e.pipe(Object(E.filter)(D),Object(E.mergeMap)((e=>(C.next({action:e}),s.EMPTY))))),((e,t,{tableByIdSelector:n,storage:a})=>{const i=t.pipe(Object(E.map)(n),Object(E.filter)(ie));return e.pipe(Object(E.delay)(500),Object(E.withLatestFrom)(i),Object(E.tap)((([e,t])=>{if(re.has(e.type)&&a){const n=Object(v.get)("payload.id",e);Object(H.a)(a,n,t[n])}})),Object(E.ignoreElements)())}),((e,t,{storage:n})=>{const a=t.pipe(Object(E.map)(oe.selectUserAssetTables),Object(E.filter)(ue));return e.pipe(Object(E.delay)(500),Object(E.withLatestFrom)(a),Object(E.tap)((([e,t])=>{if(pe.has(e.type)){const a=Object(v.get)("payload.tableId",e);Object(le.b)(n,a,t[a])}})),Object(E.ignoreElements)())}))),ve},we=()=>ve},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return u}));var a=n(328),i=n(45);const r=[a.b.DATE,a.b.IP,a.b.STRING,a.b.NUMBER,a.b.BOOLEAN],s=e=>r.includes(e),o=e=>e.every((e=>Object(i.isString)(e)||Object(i.isNumber)(e)||Object(i.isBoolean)(e)))&&(e=>e.every((t=>typeof t==typeof e[0])))(e),l=e=>e.filter((e=>null!=e)),u=e=>Array.isArray(e)?e:[e]},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("cellActions.actions.incompatibility.warningMessage",{defaultMessage:"The action can not be executed because the value and type are incompatible"})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(23),i=n(991),r=n(992),s=n(993),o=n(994);function l(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var u=l(a),c=l(i),d=l(r),p=l(s),m=l(o);function f(){var e;return(e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e]}var g={symbols:{"!":{postfix:{symbol:"!",f:function e(t){return t%1||!(+t>=0)?NaN:t>170?1/0:0===t?1:t*e(t-1)},notation:"postfix",precedence:6,rightToLeft:0,argCount:1},symbol:"!",regSymbol:"!"},"^":{infix:{symbol:"^",f:function(e,t){return Math.pow(e,t)},notation:"infix",precedence:5,rightToLeft:1,argCount:2},symbol:"^",regSymbol:"\\^"},"*":{infix:{symbol:"*",f:function(e,t){return e*t},notation:"infix",precedence:4,rightToLeft:0,argCount:2},symbol:"*",regSymbol:"\\*"},"/":{infix:{symbol:"/",f:function(e,t){return e/t},notation:"infix",precedence:4,rightToLeft:0,argCount:2},symbol:"/",regSymbol:"/"},"+":{infix:{symbol:"+",f:function(e,t){return e+t},notation:"infix",precedence:2,rightToLeft:0,argCount:2},prefix:{symbol:"+",f:f,notation:"prefix",precedence:3,rightToLeft:0,argCount:1},symbol:"+",regSymbol:"\\+"},"-":{infix:{symbol:"-",f:function(e,t){return e-t},notation:"infix",precedence:2,rightToLeft:0,argCount:2},prefix:{symbol:"-",f:function(e){return-e},notation:"prefix",precedence:3,rightToLeft:0,argCount:1},symbol:"-",regSymbol:"-"},",":{infix:{symbol:",",f:function(){return Array.of.apply(Array,arguments)},notation:"infix",precedence:1,rightToLeft:0,argCount:2},symbol:",",regSymbol:","},"(":{prefix:{symbol:"(",f:f,notation:"prefix",precedence:0,rightToLeft:0,argCount:1},symbol:"(",regSymbol:"\\("},")":{postfix:{symbol:")",f:void 0,notation:"postfix",precedence:0,rightToLeft:0,argCount:1},symbol:")",regSymbol:"\\)"},min:{func:{symbol:"min",f:function(){return Math.min.apply(Math,arguments)},notation:"func",precedence:0,rightToLeft:0,argCount:1},symbol:"min",regSymbol:"min\\b"},max:{func:{symbol:"max",f:function(){return Math.max.apply(Math,arguments)},notation:"func",precedence:0,rightToLeft:0,argCount:1},symbol:"max",regSymbol:"max\\b"},sqrt:{func:{symbol:"sqrt",f:function(e){return Math.sqrt(e)},notation:"func",precedence:0,rightToLeft:0,argCount:1},symbol:"sqrt",regSymbol:"sqrt\\b"}}},b=function(e){function t(t){var n;return n=e.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+t+" for more information.")||this,c.default(n)}return d.default(t,e),t}(p.default(Error)),y=/((?!\w)a|na|hc|mc|dg|me[r]?|xe|ni(?![a-zA-Z])|mm|cp|tp|xp|q(?!s)|hv|xamv|nimv|wv|sm|s(?!\D|$)|ged|darg?|nrut)/g;function v(e,t){var n,a=e.pop();return t.push(a.f.apply(a,(n=[]).concat.apply(n,t.splice(-a.argCount)))),a.precedence}function h(e){return e.split("").reverse().join("")}var E=/--[\S]*/g;function x(e){return e.charAt(0).toUpperCase()+e.slice(1)}var j=["Top","Right","Bottom","Left"];function O(e,t){if(!e)return t.toLowerCase();var n=e.split("-");if(n.length>1)return n.splice(1,0,t),n.reduce((function(e,t){return""+e+x(t)}));var a=e.replace(/([a-z])([A-Z])/g,"$1"+t+"$2");return e===a?""+e+t:a}function S(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i=n[0],r=n[1],s=void 0===r?i:r,o=n[2],l=void 0===o?i:o,u=n[3];return function(e,t){for(var n={},a=0;a<t.length;a+=1)(t[a]||0===t[a])&&(n[O(e,j[a])]=t[a]);return n}(e,[i,s,l,void 0===u?s:u])}function k(e,t){return e.substr(-t.length)===t}var w=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function T(e,t){if("string"!=typeof e)return t?[e,void 0]:e;var n=e.match(w);return t?(console.warn("stripUnit's unitReturn functionality has been marked for deprecation in polished 4.0. It's functionality has been been moved to getValueAndUnit."),n?[parseFloat(e),n[2]]:[e,void 0]):n?parseFloat(e):e}var I=function(e){return function(t,n){void 0===n&&(n="16px");var a=t,i=n;if("string"==typeof t){if(!k(t,"px"))throw new b(69,e,t);a=T(t)}if("string"==typeof n){if(!k(n,"px"))throw new b(70,e,n);i=T(n)}if("string"==typeof a)throw new b(71,t,e);if("string"==typeof i)throw new b(72,n,e);return""+a/i+e}},C=I("em"),M=/^([+-]?(?:\d+|\d*\.\d+))([a-z]*|%)$/;function _(e){if("string"!=typeof e)return[e,""];var t=e.match(M);return t?[parseFloat(e),t[2]]:[e,void 0]}var A={minorSecond:1.067,majorSecond:1.125,minorThird:1.2,majorThird:1.25,perfectFourth:1.333,augFourth:1.414,perfectFifth:1.5,minorSixth:1.6,goldenSection:1.618,majorSixth:1.667,minorSeventh:1.778,majorSeventh:1.875,octave:2,majorTenth:2.5,majorEleventh:2.667,majorTwelfth:3,doubleOctave:4},P=I("rem");function F(e,t,n,a){void 0===n&&(n="320px"),void 0===a&&(a="1200px");var i=_(e),r=i[0],s=i[1],o=_(t),l=o[0],u=o[1],c=_(n),d=c[0],p=c[1],m=_(a),f=m[0],g=m[1];if("number"!=typeof d||"number"!=typeof f||!p||!g||p!==g)throw new b(47);if("number"!=typeof r||"number"!=typeof l||s!==u)throw new b(48);if(s!==p||u!==g)throw new b(75);var y=(r-l)/(d-f);return"calc("+(l-y*f).toFixed(2)+(s||"")+" + "+(100*y).toFixed(2)+"vw)"}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var N,R,L=/^\s*data:([a-z]+\/[a-z-]+(;[a-z-]+=[a-z-]+)?)?(;charset=[a-z0-9-]+)?(;base64)?,[a-z0-9!$&',()*+,;=\-._~:@/?%\s]*\s*$/i,z={woff:"woff",woff2:"woff2",ttf:"truetype",otf:"opentype",eot:"embedded-opentype",svg:"svg",svgz:"svg"};function B(e,t){return t?' format("'+z[e]+'")':""}function q(e,t,n,a){var i=[];return t&&i.push(function(e){return e.map((function(e){return'local("'+e+'")'})).join(", ")}(t)),e&&i.push(function(e,t,n){return function(e){return!!e.replace(/\s+/g," ").match(L)}(e)?'url("'+e+'")'+B(t[0],n):t.map((function(t){return'url("'+e+"."+t+'")'+B(t,n)})).join(", ")}(e,n,a)),i.join(", ")}function $(e){return void 0===e&&(e=1.3),"\n    @media only screen and (-webkit-min-device-pixel-ratio: "+e+"),\n    only screen and (min--moz-device-pixel-ratio: "+e+"),\n    only screen and (-o-min-device-pixel-ratio: "+e+"/1),\n    only screen and (min-resolution: "+Math.round(96*e)+"dpi),\n    only screen and (min-resolution: "+e+"dppx)\n  "}function V(e){for(var t="",n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];for(var r=0;r<e.length;r+=1)if(t+=e[r],r===a.length-1&&a[r]){var s=a.filter((function(e){return!!e}));s.length>1?(t=t.slice(0,-1),t+=", "+a[r]):1===s.length&&(t+=""+a[r])}else a[r]&&(t+=a[r]+" ");return t.trim()}var U={easeInBack:"cubic-bezier(0.600, -0.280, 0.735, 0.045)",easeInCirc:"cubic-bezier(0.600,  0.040, 0.980, 0.335)",easeInCubic:"cubic-bezier(0.550,  0.055, 0.675, 0.190)",easeInExpo:"cubic-bezier(0.950,  0.050, 0.795, 0.035)",easeInQuad:"cubic-bezier(0.550,  0.085, 0.680, 0.530)",easeInQuart:"cubic-bezier(0.895,  0.030, 0.685, 0.220)",easeInQuint:"cubic-bezier(0.755,  0.050, 0.855, 0.060)",easeInSine:"cubic-bezier(0.470,  0.000, 0.745, 0.715)",easeOutBack:"cubic-bezier(0.175,  0.885, 0.320, 1.275)",easeOutCubic:"cubic-bezier(0.215,  0.610, 0.355, 1.000)",easeOutCirc:"cubic-bezier(0.075,  0.820, 0.165, 1.000)",easeOutExpo:"cubic-bezier(0.190,  1.000, 0.220, 1.000)",easeOutQuad:"cubic-bezier(0.250,  0.460, 0.450, 0.940)",easeOutQuart:"cubic-bezier(0.165,  0.840, 0.440, 1.000)",easeOutQuint:"cubic-bezier(0.230,  1.000, 0.320, 1.000)",easeOutSine:"cubic-bezier(0.390,  0.575, 0.565, 1.000)",easeInOutBack:"cubic-bezier(0.680, -0.550, 0.265, 1.550)",easeInOutCirc:"cubic-bezier(0.785,  0.135, 0.150, 0.860)",easeInOutCubic:"cubic-bezier(0.645,  0.045, 0.355, 1.000)",easeInOutExpo:"cubic-bezier(1.000,  0.000, 0.000, 1.000)",easeInOutQuad:"cubic-bezier(0.455,  0.030, 0.515, 0.955)",easeInOutQuart:"cubic-bezier(0.770,  0.000, 0.175, 1.000)",easeInOutQuint:"cubic-bezier(0.860,  0.000, 0.070, 1.000)",easeInOutSine:"cubic-bezier(0.445,  0.050, 0.550, 0.950)"},H=function(e,t,n){var a=""+n[0]+(n[1]||""),i=""+n[0]/2+(n[1]||""),r=""+t[0]+(t[1]||""),s=""+t[0]/2+(t[1]||"");switch(e){case"top":return"0 "+i+" "+r+" "+i;case"topLeft":return a+" "+r+" 0 0";case"left":return s+" "+a+" "+s+" 0";case"bottomLeft":return a+" 0 0 "+r;case"bottom":return r+" "+i+" 0 "+i;case"bottomRight":return"0 0 "+a+" "+r;case"right":return s+" 0 "+s+" "+a;default:return"0 "+a+" "+r+" 0"}};function Z(e){return Math.round(255*e)}function G(e,t,n){return Z(e)+","+Z(t)+","+Z(n)}function Q(e,t,n,a){if(void 0===a&&(a=G),0===t)return a(n,n,n);var i=(e%360+360)%360/60,r=(1-Math.abs(2*n-1))*t,s=r*(1-Math.abs(i%2-1)),o=0,l=0,u=0;i>=0&&i<1?(o=r,l=s):i>=1&&i<2?(o=s,l=r):i>=2&&i<3?(l=r,u=s):i>=3&&i<4?(l=s,u=r):i>=4&&i<5?(o=s,u=r):i>=5&&i<6&&(o=r,u=s);var c=n-r/2;return a(o+c,l+c,u+c)}var W={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},K=/^#[a-fA-F0-9]{6}$/,J=/^#[a-fA-F0-9]{8}$/,Y=/^#[a-fA-F0-9]{3}$/,X=/^#[a-fA-F0-9]{4}$/,ee=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/i,te=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i,ne=/^hsl\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,ae=/^hsla\(\s*(\d{0,3}[.]?[0-9]+)\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*(\d{1,3}[.]?[0-9]?)%\s*,\s*([-+]?[0-9]*[.]?[0-9]+)\s*\)$/i;function ie(e){if("string"!=typeof e)throw new b(3);var t=function(e){if("string"!=typeof e)return e;var t=e.toLowerCase();return W[t]?"#"+W[t]:e}(e);if(t.match(K))return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16)};if(t.match(J)){var n=parseFloat((parseInt(""+t[7]+t[8],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[2],16),green:parseInt(""+t[3]+t[4],16),blue:parseInt(""+t[5]+t[6],16),alpha:n}}if(t.match(Y))return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16)};if(t.match(X)){var a=parseFloat((parseInt(""+t[4]+t[4],16)/255).toFixed(2));return{red:parseInt(""+t[1]+t[1],16),green:parseInt(""+t[2]+t[2],16),blue:parseInt(""+t[3]+t[3],16),alpha:a}}var i=ee.exec(t);if(i)return{red:parseInt(""+i[1],10),green:parseInt(""+i[2],10),blue:parseInt(""+i[3],10)};var r=te.exec(t.substring(0,50));if(r)return{red:parseInt(""+r[1],10),green:parseInt(""+r[2],10),blue:parseInt(""+r[3],10),alpha:parseFloat(""+r[4])};var s=ne.exec(t);if(s){var o="rgb("+Q(parseInt(""+s[1],10),parseInt(""+s[2],10)/100,parseInt(""+s[3],10)/100)+")",l=ee.exec(o);if(!l)throw new b(4,t,o);return{red:parseInt(""+l[1],10),green:parseInt(""+l[2],10),blue:parseInt(""+l[3],10)}}var u=ae.exec(t.substring(0,50));if(u){var c="rgb("+Q(parseInt(""+u[1],10),parseInt(""+u[2],10)/100,parseInt(""+u[3],10)/100)+")",d=ee.exec(c);if(!d)throw new b(4,t,c);return{red:parseInt(""+d[1],10),green:parseInt(""+d[2],10),blue:parseInt(""+d[3],10),alpha:parseFloat(""+u[4])}}throw new b(5)}function re(e){return function(e){var t,n=e.red/255,a=e.green/255,i=e.blue/255,r=Math.max(n,a,i),s=Math.min(n,a,i),o=(r+s)/2;if(r===s)return void 0!==e.alpha?{hue:0,saturation:0,lightness:o,alpha:e.alpha}:{hue:0,saturation:0,lightness:o};var l=r-s,u=o>.5?l/(2-r-s):l/(r+s);switch(r){case n:t=(a-i)/l+(a<i?6:0);break;case a:t=(i-n)/l+2;break;default:t=(n-a)/l+4}return t*=60,void 0!==e.alpha?{hue:t,saturation:u,lightness:o,alpha:e.alpha}:{hue:t,saturation:u,lightness:o}}(ie(e))}var se=function(e){return 7===e.length&&e[1]===e[2]&&e[3]===e[4]&&e[5]===e[6]?"#"+e[1]+e[3]+e[5]:e};function oe(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function le(e){return oe(Math.round(255*e))}function ue(e,t,n){return se("#"+le(e)+le(t)+le(n))}function ce(e,t,n){return Q(e,t,n,ue)}function de(e,t,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return ce(e,t,n);if("object"==typeof e&&void 0===t&&void 0===n)return ce(e.hue,e.saturation,e.lightness);throw new b(1)}function pe(e,t,n,a){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof a)return a>=1?ce(e,t,n):"rgba("+Q(e,t,n)+","+a+")";if("object"==typeof e&&void 0===t&&void 0===n&&void 0===a)return e.alpha>=1?ce(e.hue,e.saturation,e.lightness):"rgba("+Q(e.hue,e.saturation,e.lightness)+","+e.alpha+")";throw new b(2)}function me(e,t,n){if("number"==typeof e&&"number"==typeof t&&"number"==typeof n)return se("#"+oe(e)+oe(t)+oe(n));if("object"==typeof e&&void 0===t&&void 0===n)return se("#"+oe(e.red)+oe(e.green)+oe(e.blue));throw new b(6)}function fe(e,t,n,a){if("string"==typeof e&&"number"==typeof t){var i=ie(e);return"rgba("+i.red+","+i.green+","+i.blue+","+t+")"}if("number"==typeof e&&"number"==typeof t&&"number"==typeof n&&"number"==typeof a)return a>=1?me(e,t,n):"rgba("+e+","+t+","+n+","+a+")";if("object"==typeof e&&void 0===t&&void 0===n&&void 0===a)return e.alpha>=1?me(e.red,e.green,e.blue):"rgba("+e.red+","+e.green+","+e.blue+","+e.alpha+")";throw new b(7)}var ge=function(e){return"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue&&("number"!=typeof e.alpha||void 0===e.alpha)},be=function(e){return"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue&&"number"==typeof e.alpha},ye=function(e){return"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness&&("number"!=typeof e.alpha||void 0===e.alpha)},ve=function(e){return"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness&&"number"==typeof e.alpha};function he(e){if("object"!=typeof e)throw new b(8);if(be(e))return fe(e);if(ge(e))return me(e);if(ve(e))return pe(e);if(ye(e))return de(e);throw new b(8)}function Ee(e,t,n){return function(){var a=n.concat(Array.prototype.slice.call(arguments));return a.length>=t?e.apply(this,a):Ee(e,t,a)}}function xe(e){return Ee(e,e.length,[])}function je(e,t){if("transparent"===t)return t;var n=re(t);return he(u.default({},n,{hue:n.hue+parseFloat(e)}))}var Oe=xe(je);function Se(e,t,n){return Math.max(e,Math.min(t,n))}function ke(e,t){if("transparent"===t)return t;var n=re(t);return he(u.default({},n,{lightness:Se(0,1,n.lightness-parseFloat(e))}))}var we=xe(ke);function Te(e,t){if("transparent"===t)return t;var n=re(t);return he(u.default({},n,{saturation:Se(0,1,n.saturation-parseFloat(e))}))}var Ie=xe(Te);function Ce(e){if("transparent"===e)return 0;var t=ie(e),n=Object.keys(t).map((function(e){var n=t[e]/255;return n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4)})),a=n[0],i=n[1],r=n[2];return parseFloat((.2126*a+.7152*i+.0722*r).toFixed(3))}function Me(e,t){var n=Ce(e),a=Ce(t);return parseFloat((n>a?(n+.05)/(a+.05):(a+.05)/(n+.05)).toFixed(2))}function _e(e,t){if("transparent"===t)return t;var n=re(t);return he(u.default({},n,{lightness:Se(0,1,n.lightness+parseFloat(e))}))}var Ae=xe(_e);function Pe(e,t,n){if("transparent"===t)return n;if("transparent"===n)return t;if(0===e)return n;var a=ie(t),i=u.default({},a,{alpha:"number"==typeof a.alpha?a.alpha:1}),r=ie(n),s=u.default({},r,{alpha:"number"==typeof r.alpha?r.alpha:1}),o=i.alpha-s.alpha,l=2*parseFloat(e)-1,c=((l*o==-1?l:l+o)/(1+l*o)+1)/2,d=1-c;return fe({red:Math.floor(i.red*c+s.red*d),green:Math.floor(i.green*c+s.green*d),blue:Math.floor(i.blue*c+s.blue*d),alpha:i.alpha*(parseFloat(e)/1)+s.alpha*(1-parseFloat(e)/1)})}var Fe=xe(Pe);function De(e,t){if("transparent"===t)return t;var n=ie(t),a="number"==typeof n.alpha?n.alpha:1;return fe(u.default({},n,{alpha:Se(0,1,(100*a+100*parseFloat(e))/100)}))}var Ne=xe(De),Re="#000",Le="#fff";function ze(e,t){if("transparent"===t)return t;var n=re(t);return he(u.default({},n,{saturation:Se(0,1,n.saturation+parseFloat(e))}))}var Be=xe(ze);function qe(e,t){return"transparent"===t?t:he(u.default({},re(t),{hue:parseFloat(e)}))}var $e=xe(qe);function Ve(e,t){return"transparent"===t?t:he(u.default({},re(t),{lightness:parseFloat(e)}))}var Ue=xe(Ve);function He(e,t){return"transparent"===t?t:he(u.default({},re(t),{saturation:parseFloat(e)}))}var Ze=xe(He);function Ge(e,t){return"transparent"===t?t:Fe(parseFloat(e),"rgb(0, 0, 0)",t)}var Qe=xe(Ge);function We(e,t){return"transparent"===t?t:Fe(parseFloat(e),"rgb(255, 255, 255)",t)}var Ke=xe(We);function Je(e,t){if("transparent"===t)return t;var n=ie(t),a="number"==typeof n.alpha?n.alpha:1;return fe(u.default({},n,{alpha:Se(0,1,+(100*a-100*parseFloat(e)).toFixed(2)/100)}))}var Ye=xe(Je),Xe=["top","right","bottom","left"];function et(e,t){return e(t?":"+t:"")}function tt(e,t,n){if(!t)throw new b(67);if(0===e.length)return et(t,null);for(var a=[],i=0;i<e.length;i+=1){if(n&&n.indexOf(e[i])<0)throw new b(68);a.push(et(t,e[i]))}return a.join(",")}var nt=[void 0,null,"active","focus","hover"];function at(e){return"button"+e+',\n  input[type="button"]'+e+',\n  input[type="reset"]'+e+',\n  input[type="submit"]'+e}var it=["absolute","fixed","relative","static","sticky"],rt=[void 0,null,"active","focus","hover"];function st(e){return'input[type="color"]'+e+',\n    input[type="date"]'+e+',\n    input[type="datetime"]'+e+',\n    input[type="datetime-local"]'+e+',\n    input[type="email"]'+e+',\n    input[type="month"]'+e+',\n    input[type="number"]'+e+',\n    input[type="password"]'+e+',\n    input[type="search"]'+e+',\n    input[type="tel"]'+e+',\n    input[type="text"]'+e+',\n    input[type="time"]'+e+',\n    input[type="url"]'+e+',\n    input[type="week"]'+e+",\n    input:not([type])"+e+",\n    textarea"+e}t.adjustHue=Oe,t.animation=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var a=Array.isArray(t[0]);if(!a&&t.length>8)throw new b(64);return{animation:t.map((function(e){if(a&&!Array.isArray(e)||!a&&Array.isArray(e))throw new b(65);if(Array.isArray(e)&&e.length>8)throw new b(66);return Array.isArray(e)?e.join(" "):e})).join(", ")}},t.backgroundImages=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{backgroundImage:t.join(", ")}},t.backgrounds=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{background:t.join(", ")}},t.between=F,t.border=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];var i;return"string"==typeof e&&Xe.indexOf(e)>=0?((i={})["border"+x(e)+"Width"]=n[0],i["border"+x(e)+"Style"]=n[1],i["border"+x(e)+"Color"]=n[2],i):(n.unshift(e),{borderWidth:n[0],borderStyle:n[1],borderColor:n[2]})},t.borderColor=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return S.apply(void 0,["borderColor"].concat(t))},t.borderRadius=function(e,t){var n,a,i=x(e);if(!t&&0!==t)throw new b(62);if("Top"===i||"Bottom"===i)return(n={})["border"+i+"RightRadius"]=t,n["border"+i+"LeftRadius"]=t,n;if("Left"===i||"Right"===i)return(a={})["borderTop"+i+"Radius"]=t,a["borderBottom"+i+"Radius"]=t,a;throw new b(63)},t.borderStyle=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return S.apply(void 0,["borderStyle"].concat(t))},t.borderWidth=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return S.apply(void 0,["borderWidth"].concat(t))},t.buttons=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return tt(t,at,nt)},t.clearFix=function(e){var t;return void 0===e&&(e="&"),(t={})[e+"::after"]={clear:"both",content:'""',display:"table"},t},t.complement=function(e){if("transparent"===e)return e;var t=re(e);return he(u.default({},t,{hue:(t.hue+180)%360}))},t.cover=function(e){return void 0===e&&(e=0),{position:"absolute",top:e,right:e,bottom:e,left:e}},t.cssVar=function(e,t){if(!e||!e.match(E)){if(t)return e;throw new b(73)}var n;if("undefined"!=typeof document&&null!==document.documentElement&&(n=getComputedStyle(document.documentElement).getPropertyValue(e)),n)return n.trim();throw new b(74)},t.darken=we,t.desaturate=Ie,t.directionalProperty=S,t.ellipsis=function(e){return void 0===e&&(e="100%"),{display:"inline-block",maxWidth:e,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",wordWrap:"normal"}},t.em=C,t.fluidRange=function(e,t,n){if(void 0===t&&(t="320px"),void 0===n&&(n="1200px"),!Array.isArray(e)&&"object"!=typeof e||null===e)throw new b(49);if(Array.isArray(e)){for(var a,i={},r={},s=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(e);!(a=s()).done;){var o,l,c=a.value;if(!c.prop||!c.fromSize||!c.toSize)throw new b(50);r[c.prop]=c.fromSize,i["@media (min-width: "+t+")"]=u.default({},i["@media (min-width: "+t+")"],((o={})[c.prop]=F(c.fromSize,c.toSize,t,n),o)),i["@media (min-width: "+n+")"]=u.default({},i["@media (min-width: "+n+")"],((l={})[c.prop]=c.toSize,l))}return u.default({},r,i)}var d,p,m;if(!e.prop||!e.fromSize||!e.toSize)throw new b(51);return(m={})[e.prop]=e.fromSize,m["@media (min-width: "+t+")"]=((d={})[e.prop]=F(e.fromSize,e.toSize,t,n),d),m["@media (min-width: "+n+")"]=((p={})[e.prop]=e.toSize,p),m},t.fontFace=function(e){var t=e.fontFamily,n=e.fontFilePath,a=e.fontStretch,i=e.fontStyle,r=e.fontVariant,s=e.fontWeight,o=e.fileFormats,l=void 0===o?["eot","woff2","woff","ttf","svg"]:o,u=e.formatHint,c=void 0!==u&&u,d=e.localFonts,p=e.unicodeRange,m=e.fontDisplay,f=e.fontVariationSettings,g=e.fontFeatureSettings;if(!t)throw new b(55);if(!n&&!d)throw new b(52);if(d&&!Array.isArray(d))throw new b(53);if(!Array.isArray(l))throw new b(54);var y={"@font-face":{fontFamily:t,src:q(n,d,l,c),unicodeRange:p,fontStretch:a,fontStyle:i,fontVariant:r,fontWeight:s,fontDisplay:m,fontVariationSettings:f,fontFeatureSettings:g}};return JSON.parse(JSON.stringify(y))},t.getContrast=Me,t.getLuminance=Ce,t.getValueAndUnit=_,t.grayscale=function(e){return"transparent"===e?e:he(u.default({},re(e),{saturation:0}))},t.hiDPI=$,t.hideText=function(){return{textIndent:"101%",overflow:"hidden",whiteSpace:"nowrap"}},t.hideVisually=function(){return{border:"0",clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:"0",position:"absolute",whiteSpace:"nowrap",width:"1px"}},t.hsl=de,t.hslToColorString=function(e){if("object"==typeof e&&"number"==typeof e.hue&&"number"==typeof e.saturation&&"number"==typeof e.lightness)return e.alpha&&"number"==typeof e.alpha?pe({hue:e.hue,saturation:e.saturation,lightness:e.lightness,alpha:e.alpha}):de({hue:e.hue,saturation:e.saturation,lightness:e.lightness});throw new b(45)},t.hsla=pe,t.invert=function(e){if("transparent"===e)return e;var t=ie(e);return he(u.default({},t,{red:255-t.red,green:255-t.green,blue:255-t.blue}))},t.lighten=Ae,t.linearGradient=function(e){var t=e.colorStops,n=e.fallback,a=e.toDirection,i=void 0===a?"":a;if(!t||t.length<2)throw new b(56);return{backgroundColor:n||t[0].replace(/,\s+/g,",").split(" ")[0].replace(/,(?=\S)/g,", "),backgroundImage:V(N||(N=m.default(["linear-gradient(","",")"])),i,t.join(", ").replace(/,(?=\S)/g,", "))}},t.margin=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return S.apply(void 0,["margin"].concat(t))},t.math=function(e,t){var n=h(e),a=n.match(y);if(a&&!a.every((function(e){return e===a[0]})))throw new b(41);return""+function(e,t){var n,a=function(e){var t={};return t.symbols=e?u.default({},g.symbols,e.symbols):u.default({},g.symbols),t}(t),i=[a.symbols["("].prefix],r=[],s=new RegExp("\\d+(?:\\.\\d+)?|"+Object.keys(a.symbols).map((function(e){return a.symbols[e]})).sort((function(e,t){return t.symbol.length-e.symbol.length})).map((function(e){return e.regSymbol})).join("|")+"|(\\S)","g");s.lastIndex=0;var o=!1;do{var l=(n=s.exec(e))||[")",void 0],c=l[0],d=l[1],p=a.symbols[c],m=p&&!p.prefix&&!p.func,f=!p||!p.postfix&&!p.infix;if(d||(o?f:m))throw new b(37,n?n.index:e.length,e);if(o){var y=p.postfix||p.infix;do{var h=i[i.length-1];if((y.precedence-h.precedence||h.rightToLeft)>0)break}while(v(i,r));o="postfix"===y.notation,")"!==y.symbol&&(i.push(y),o&&v(i,r))}else if(p){if(i.push(p.prefix||p.func),p.func&&(!(n=s.exec(e))||"("!==n[0]))throw new b(38,n?n.index:e.length,e)}else r.push(+c),o=!0}while(n&&i.length);if(i.length)throw new b(39,n?n.index:e.length,e);if(n)throw new b(40,n?n.index:e.length,e);return r.pop()}(h(n.replace(y,"")),t)+(a?h(a[0]):"")},t.meetsContrastGuidelines=function(e,t){var n=Me(e,t);return{AA:n>=4.5,AALarge:n>=3,AAA:n>=7,AAALarge:n>=4.5}},t.mix=Fe,t.modularScale=function(e,t,n){if(void 0===t&&(t="1em"),void 0===n&&(n=1.333),"number"!=typeof e)throw new b(42);if("string"==typeof n&&!A[n])throw new b(43);var a="string"==typeof t?_(t):[t,""],i=a[0],r=a[1],s="string"==typeof n?A[n]:n;if("string"==typeof i)throw new b(44,t);return""+i*Math.pow(s,e)+(r||"")},t.normalize=function(){var e;return[(e={html:{lineHeight:"1.15",textSizeAdjust:"100%"},body:{margin:"0"},main:{display:"block"},h1:{fontSize:"2em",margin:"0.67em 0"},hr:{boxSizing:"content-box",height:"0",overflow:"visible"},pre:{fontFamily:"monospace, monospace",fontSize:"1em"},a:{backgroundColor:"transparent"},"abbr[title]":{borderBottom:"none",textDecoration:"underline"}},e["b,\n    strong"]={fontWeight:"bolder"},e["code,\n    kbd,\n    samp"]={fontFamily:"monospace, monospace",fontSize:"1em"},e.small={fontSize:"80%"},e["sub,\n    sup"]={fontSize:"75%",lineHeight:"0",position:"relative",verticalAlign:"baseline"},e.sub={bottom:"-0.25em"},e.sup={top:"-0.5em"},e.img={borderStyle:"none"},e["button,\n    input,\n    optgroup,\n    select,\n    textarea"]={fontFamily:"inherit",fontSize:"100%",lineHeight:"1.15",margin:"0"},e["button,\n    input"]={overflow:"visible"},e["button,\n    select"]={textTransform:"none"},e['button,\n    html [type="button"],\n    [type="reset"],\n    [type="submit"]']={WebkitAppearance:"button"},e['button::-moz-focus-inner,\n    [type="button"]::-moz-focus-inner,\n    [type="reset"]::-moz-focus-inner,\n    [type="submit"]::-moz-focus-inner']={borderStyle:"none",padding:"0"},e['button:-moz-focusring,\n    [type="button"]:-moz-focusring,\n    [type="reset"]:-moz-focusring,\n    [type="submit"]:-moz-focusring']={outline:"1px dotted ButtonText"},e.fieldset={padding:"0.35em 0.625em 0.75em"},e.legend={boxSizing:"border-box",color:"inherit",display:"table",maxWidth:"100%",padding:"0",whiteSpace:"normal"},e.progress={verticalAlign:"baseline"},e.textarea={overflow:"auto"},e['[type="checkbox"],\n    [type="radio"]']={boxSizing:"border-box",padding:"0"},e['[type="number"]::-webkit-inner-spin-button,\n    [type="number"]::-webkit-outer-spin-button']={height:"auto"},e['[type="search"]']={WebkitAppearance:"textfield",outlineOffset:"-2px"},e['[type="search"]::-webkit-search-decoration']={WebkitAppearance:"none"},e["::-webkit-file-upload-button"]={WebkitAppearance:"button",font:"inherit"},e.details={display:"block"},e.summary={display:"list-item"},e.template={display:"none"},e["[hidden]"]={display:"none"},e),{"abbr[title]":{textDecoration:"underline dotted"}}]},t.opacify=Ne,t.padding=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return S.apply(void 0,["padding"].concat(t))},t.parseToHsl=re,t.parseToRgb=ie,t.position=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return it.indexOf(e)>=0&&e?u.default({},S.apply(void 0,[""].concat(n)),{position:e}):S.apply(void 0,["",e].concat(n))},t.radialGradient=function(e){var t=e.colorStops,n=e.extent,a=void 0===n?"":n,i=e.fallback,r=e.position,s=void 0===r?"":r,o=e.shape,l=void 0===o?"":o;if(!t||t.length<2)throw new b(57);return{backgroundColor:i||t[0].split(" ")[0],backgroundImage:V(R||(R=m.default(["radial-gradient(","","","",")"])),s,l,a,t.join(", "))}},t.readableColor=function(e,t,n,a){void 0===t&&(t=Re),void 0===n&&(n=Le),void 0===a&&(a=!0);var i=Ce(e)>.179,r=i?t:n;return!a||Me(e,r)>=4.5?r:i?Re:Le},t.rem=P,t.retinaImage=function(e,t,n,a,i){var r;if(void 0===n&&(n="png"),void 0===i&&(i="_2x"),!e)throw new b(58);var s=n.replace(/^\./,""),o=a?a+"."+s:""+e+i+"."+s;return(r={backgroundImage:"url("+e+"."+s+")"})[$()]=u.default({backgroundImage:"url("+o+")"},t?{backgroundSize:t}:{}),r},t.rgb=me,t.rgbToColorString=function(e){if("object"==typeof e&&"number"==typeof e.red&&"number"==typeof e.green&&"number"==typeof e.blue)return"number"==typeof e.alpha?fe({red:e.red,green:e.green,blue:e.blue,alpha:e.alpha}):me({red:e.red,green:e.green,blue:e.blue});throw new b(46)},t.rgba=fe,t.saturate=Be,t.setHue=$e,t.setLightness=Ue,t.setSaturation=Ze,t.shade=Qe,t.size=function(e,t){return void 0===t&&(t=e),{height:e,width:t}},t.stripUnit=T,t.textInputs=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return tt(t,st,rt)},t.timingFunctions=function(e){return U[e]},t.tint=Ke,t.toColorString=he,t.transitions=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(Array.isArray(t[0])&&2===t.length){var a=t[1];if("string"!=typeof a)throw new b(61);return{transition:t[0].map((function(e){return e+" "+a})).join(", ")}}return{transition:t.join(", ")}},t.transparentize=Ye,t.triangle=function(e){var t=e.pointingDirection,n=e.height,a=e.width,i=e.foregroundColor,r=e.backgroundColor,s=void 0===r?"transparent":r,o=_(a),l=_(n);if(isNaN(l[0])||isNaN(o[0]))throw new b(60);return u.default({width:"0",height:"0",borderColor:s},function(e,t){switch(e){case"top":case"bottomRight":return{borderBottomColor:t};case"right":case"bottomLeft":return{borderLeftColor:t};case"bottom":case"topLeft":return{borderTopColor:t};case"left":case"topRight":return{borderRightColor:t};default:throw new b(59)}}(t,i),{borderStyle:"solid",borderWidth:H(t,l,o)})},t.wordWrap=function(e){return void 0===e&&(e="break-word"),{overflowWrap:e,wordWrap:e,wordBreak:"break-word"===e?"break-all":e}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(245),i=n(558),r=n(185);const s=e=>`${Object(r.a)(e)}`,o=(e,t,n,s=i.a.flows)=>`/ip/${e}/${t||a.a.source}/${s}${Object(r.a)(n)}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(190),r=n(112),s=n(128);const o=({visualizationId:e})=>{const t=s.d.globalQueryByIdSelector(),{inspect:n}=Object(r.a)((n=>t(n,e)));return Object(a.useMemo)((()=>n?Object(i.g)(null==n?void 0:n.response):null),[n])}},,function(e,t,n){"use strict";var a=n(414);e.exports=function(e){return a({},e)}},function(e,t,n){"use strict";n.d(t,"q",(function(){return r})),n.d(t,"o",(function(){return s})),n.d(t,"p",(function(){return o})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"h",(function(){return O})),n.d(t,"i",(function(){return S})),n.d(t,"m",(function(){return j})),n.d(t,"n",(function(){return k})),n.d(t,"c",(function(){return I})),n.d(t,"k",(function(){return C})),n.d(t,"l",(function(){return M})),n.d(t,"d",(function(){return _})),n.d(t,"e",(function(){return A})),n.d(t,"j",(function(){return F}));var a=n(5),i=n(139);const r={message:a.i18n.translate("lists.exceptions.isOperatorLabel",{defaultMessage:"is"}),operator:i.c.INCLUDED,type:i.d.MATCH,value:"is"},s={message:a.i18n.translate("lists.exceptions.isNotOperatorLabel",{defaultMessage:"is not"}),operator:i.c.EXCLUDED,type:i.d.MATCH,value:"is_not"},o={message:a.i18n.translate("lists.exceptions.isOneOfOperatorLabel",{defaultMessage:"is one of"}),operator:i.c.INCLUDED,type:i.d.MATCH_ANY,value:"is_one_of"},l={message:a.i18n.translate("lists.exceptions.isNotOneOfOperatorLabel",{defaultMessage:"is not one of"}),operator:i.c.EXCLUDED,type:i.d.MATCH_ANY,value:"is_not_one_of"},u={message:a.i18n.translate("lists.exceptions.existsOperatorLabel",{defaultMessage:"exists"}),operator:i.c.INCLUDED,type:i.d.EXISTS,value:"exists"},c={message:a.i18n.translate("lists.exceptions.doesNotExistOperatorLabel",{defaultMessage:"does not exist"}),operator:i.c.EXCLUDED,type:i.d.EXISTS,value:"does_not_exist"},d={message:a.i18n.translate("lists.exceptions.isInListOperatorLabel",{defaultMessage:"is in list"}),operator:i.c.INCLUDED,type:i.d.LIST,value:"is_in_list"},p={message:a.i18n.translate("lists.exceptions.isNotInListOperatorLabel",{defaultMessage:"is not in list"}),operator:i.c.EXCLUDED,type:i.d.LIST,value:"is_not_in_list"},m={message:a.i18n.translate("lists.exceptions.matchesOperatorLabel",{defaultMessage:"matches"}),operator:i.c.INCLUDED,type:i.d.WILDCARD,value:"matches"},f={message:a.i18n.translate("lists.exceptions.doesNotMatchOperatorLabel",{defaultMessage:"does not match"}),operator:i.c.EXCLUDED,type:i.d.WILDCARD,value:"does_not_match"},g=[r,s,o,l,m,f],b=[r,s,o,l,u,c,d,p,m,f];var y=n(175);const v=y.q,h=y.r;var E=n(9),x=n(45);const j=({namespaceType:e})=>e.map((e=>(({namespaceType:e})=>"agnostic"===e?h:v)({namespaceType:e}))),O=({filters:e,namespaceTypes:t,hideLists:n})=>{const a=j({namespaceType:t}),i=((e,t)=>Object.keys(e).map((n=>{const a=Object(x.get)(n,e);return Object(E.isArray)(a)||null!=a&&""!==a.trim()?`(${t.map((e=>{const t="name"===n?"name.text":"types"===n?"type":n;return Object(E.isArray)(a)?a.map((n=>`${e}.attributes.${t}:${n}`)).join(" OR "):`${e}.attributes.${t}:${a}`})).join(" OR ")})`:null})).filter((e=>null!=e)).join(" AND "))(e,a);return[i,...n.map((e=>`(${a.map((t=>`not ${t}.attributes.list_id: ${e}*`)).join(" AND ")})`))].filter((e=>""!==e.trim())).join(" AND ")},S=({lists:e,showDetection:t,showEndpoint:n})=>e.filter((e=>t?"detection"===e.type:!n||"endpoint"===e.type)).reduce(((e,{listId:t,namespaceType:n})=>({ids:[...e.ids,t],namespaces:[...e.namespaces,n]})),{ids:[],namespaces:[]}),k=e=>e.filter((({type:e})=>"list"===e)).length>0;var w=n(51),T=n(169);n(437),n(53),n(328);const I=e=>e.map((e=>"nested"===e.type?Object(T.d)({...e,entries:e.entries.map((e=>Object(T.d)(e)))}):Object(T.d)(e))),C=({listId:e,namespaceType:t,name:n})=>({comments:[],description:"Exception list item",entries:I([{field:"",operator:"included",type:"match",value:""}]),item_id:void 0,list_id:e,meta:{temporaryUuid:Object(w.v4)()},name:n,namespace_type:t,tags:[],type:"simple"}),M=e=>{switch(e.type){case"match":return i.d.MATCH;case"match_any":return i.d.MATCH_ANY;case"wildcard":return i.d.WILDCARD;case"list":return i.d.LIST;default:return i.d.EXISTS}},_=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time > "${t}" OR NOT ${e}.attributes.expire_time: *`)).join(",")},A=e=>{const t=(new Date).toISOString();return e.map((e=>`${e}.attributes.expire_time <= "${t}"`)).join(",")},P=e=>{let t=e.match(/.ds-(.*?)-[0-9]{4}\.[0-9]{2}\.[0-9]{2}-[0-9]{6}/);return t&&2===t.length?t[1]:(t=e.match(/.siem-(.*?)-[0-9]{6}/),t&&2===t.length?`.siem-${t[1]}`:e)},F=e=>{if(!e.conflictDescriptions)return null;const t=[];for(const[n,a]of Object.entries(e.conflictDescriptions)){const e=[],i={};a.forEach((e=>{const t=P(e);i[t]||(i[t]=0),i[t]++}));for(const[t,n]of Object.entries(i))e.push({name:t,count:n});e.sort(((e,t)=>t.count-e.count)),t.push({type:n,totalIndexCount:a.length,groupedIndices:e})}return t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(17),i=n(345),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(61),c=n.n(u),d=n(4),p=n(166),m=n(110),f=n(293),g=n(226);const b=l()(a.EuiFlexItem).withConfig({displayName:"CountFlexItem",componentId:"sc-1yje3m6-0"})(["",""],(({theme:e})=>`margin-right: ${e.eui.euiSizeS};`)),y=s.a.memo((({value:e})=>Object(g.a)(e)?s.a.createElement(s.a.Fragment,null,e):s.a.createElement("em",{"data-test-subj":"value-wrapper-empty"},f.c)));y.displayName="ValueWrapper";const v=({legendItem:e})=>{const[t]=Object(m.o)(d.P),{color:n,count:i,dataProviderId:r,field:o,scopeId:l,value:u}=e;return s.a.createElement(a.EuiText,{size:"xs"},s.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none",responsive:!1},null!=n&&s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiHealth,{"data-test-subj":"legend-color",color:n})),s.a.createElement(a.EuiFlexItem,{grow:!0},s.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"none",responsive:!1},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(p.b,{"data-test-subj":`legend-item-${r}`,field:o,hideTopN:!0,id:r,isDraggable:!1,scopeId:l,value:u},null==e.render?s.a.createElement(y,{value:u}):e.render({field:o,value:u}))),null!=i&&s.a.createElement(b,{"data-test-subj":"legendItemCount",grow:!1},c()(i).format(t))))))};v.displayName="DraggableLegendItemComponent";const h=s.a.memo(v),E=l.a.div.withConfig({displayName:"DraggableLegendContainer",componentId:"sc-94chus-0"})(["height:",";overflow:auto;scrollbar-width:thin;width:100%;@media only screen and (min-width:","){width:165px;}min-width:",";&::-webkit-scrollbar{height:",";width:",";}&::-webkit-scrollbar-thumb{background-clip:content-box;background-color:",";border:"," solid transparent;}&::-webkit-scrollbar-corner,&::-webkit-scrollbar-track{background-color:transparent;}"],(({height:e})=>`${e}px`),(({theme:e})=>e.eui.euiBreakpoints.m),(({$minWidth:e})=>`${e}px`),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>e.eui.euiScrollBar),(({theme:e})=>Object(i.rgba)(e.eui.euiColorDarkShade,.5)),(({theme:e})=>e.eui.euiScrollBarCorner)),x=({className:e,height:t=0,legendItems:n,minWidth:i=165})=>0===n.length?null:s.a.createElement(E,{className:e,"data-test-subj":"draggable-legend",height:0===t?175:t,$minWidth:i},s.a.createElement(a.EuiText,{size:"xs"},s.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"none"},n.map((e=>s.a.createElement(a.EuiFlexItem,{key:e.dataProviderId,grow:!1},s.a.createElement(h,{legendItem:e}),s.a.createElement(a.EuiSpacer,{"data-test-subj":"draggable-legend-spacer",size:"s"})))))));x.displayName="DraggableLegendComponent";const j=s.a.memo(x)},,function(e,t,n){"use strict";n.r(t),n.d(t,"selectTimeline",(function(){return r})),n.d(t,"selectInsertTimeline",(function(){return s})),n.d(t,"timelineByIdSelector",(function(){return o})),n.d(t,"getShowCallOutUnauthorizedMsg",(function(){return l})),n.d(t,"getTimelineByIdSelector",(function(){return u})),n.d(t,"getKqlFilterQuerySelector",(function(){return c})),n.d(t,"getKqlFilterKuerySelector",(function(){return d})),n.d(t,"dataProviderVisibilitySelector",(function(){return p}));var a=n(57);const i=e=>e.timeline.showCallOutUnauthorizedMsg,r=(e,t)=>e.timeline.timelineById[t],s=e=>e.timeline.insertTimeline,o=Object(a.createSelector)((e=>e.timeline.timelineById),(e=>e)),l=()=>Object(a.createSelector)(i,(e=>e)),u=()=>Object(a.createSelector)(r,(e=>e)),c=()=>Object(a.createSelector)(r,(e=>e&&e.kqlQuery&&e.kqlQuery.filterQuery&&e.kqlQuery.filterQuery.kuery?e.kqlQuery.filterQuery.kuery.expression:null)),d=()=>Object(a.createSelector)(r,(e=>e&&e.kqlQuery&&e.kqlQuery.filterQuery&&e.kqlQuery.filterQuery.kuery?e.kqlQuery.filterQuery.kuery:null)),p=()=>Object(a.createSelector)(r,(e=>e.isDataProviderVisible))},function(e,t,n){"use strict";const a=n(270),i={};e.exports=function(e,t,n){if(!1===t||null==t)return e;"string"==typeof(n=n||{})&&(n={separator:n});const r=Array.isArray(t);a(!r||!n.separator,"Separator option no valid for array-based chain");const s=r?t:t.split(n.separator||".");let o=e;for(let e=0;e<s.length;++e){let r=s[e];const l=n.iterables&&i.iterables(o);if(Array.isArray(o)||"set"===l){const e=Number(r);Number.isInteger(e)&&(r=e<0?o.length+e:e)}if(!o||"function"==typeof o&&!1===n.functions||!l&&void 0===o[r]){a(!n.strict||e+1===s.length,"Missing segment",r,"in reach path ",t),a("object"==typeof o||!0===n.functions||"function"!=typeof o,"Invalid segment",r,"in reach path ",t),o=n.default;break}o=l?"set"===l?[...o][r]:o.get(r):o[r]}return o},i.iterables=function(e){return e instanceof Set?"set":e instanceof Map?"map":void 0}},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.getParsedType=t.ZodParsedType=t.objectUtil=t.util=void 0,function(e){e.assertEqual=e=>e,e.assertIs=function(e){},e.assertNever=function(e){throw new Error},e.arrayToEnum=e=>{const t={};for(const n of e)t[n]=n;return t},e.getValidEnumValues=t=>{const n=e.objectKeys(t).filter((e=>"number"!=typeof t[t[e]])),a={};for(const e of n)a[e]=t[e];return e.objectValues(a)},e.objectValues=t=>e.objectKeys(t).map((function(e){return t[e]})),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t},e.find=(e,t)=>{for(const n of e)if(t(n))return n},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(a=t.util||(t.util={})),(t.objectUtil||(t.objectUtil={})).mergeShapes=(e,t)=>({...e,...t}),t.ZodParsedType=a.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),t.getParsedType=e=>{switch(typeof e){case"undefined":return t.ZodParsedType.undefined;case"string":return t.ZodParsedType.string;case"number":return isNaN(e)?t.ZodParsedType.nan:t.ZodParsedType.number;case"boolean":return t.ZodParsedType.boolean;case"function":return t.ZodParsedType.function;case"bigint":return t.ZodParsedType.bigint;case"symbol":return t.ZodParsedType.symbol;case"object":return Array.isArray(e)?t.ZodParsedType.array:null===e?t.ZodParsedType.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?t.ZodParsedType.promise:"undefined"!=typeof Map&&e instanceof Map?t.ZodParsedType.map:"undefined"!=typeof Set&&e instanceof Set?t.ZodParsedType.set:"undefined"!=typeof Date&&e instanceof Date?t.ZodParsedType.date:t.ZodParsedType.object;default:return t.ZodParsedType.unknown}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(196),i=n(204),r=n(197),s=n(764);const o={columnHeaderType:a.a,displayAsText:r.m,id:"kibana.alert.workflow_assignee_ids",initialWidth:i.b},l=e=>{var t,n;const i=null!==(t=null==e||null===(n=e.isPlatinumPlus)||void 0===n?void 0:n.call(e))&&void 0!==t&&t;return[{columnHeaderType:a.a,displayAsText:r.u,id:"kibana.alert.severity",initialWidth:105},{columnHeaderType:a.a,displayAsText:r.q,id:"kibana.alert.risk_score",initialWidth:100},{columnHeaderType:a.a,displayAsText:r.p,id:"kibana.alert.reason",initialWidth:450},{columnHeaderType:a.a,id:"host.name"},i?{columnHeaderType:a.a,id:"host.risk.calculated_level"}:null,{columnHeaderType:a.a,id:"user.name"},i?{columnHeaderType:a.a,id:"user.risk.calculated_level"}:null,{columnHeaderType:a.a,id:"process.name"},{columnHeaderType:a.a,id:"file.name"},{columnHeaderType:a.a,id:"source.ip"},{columnHeaderType:a.a,id:"destination.ip"}].filter((e=>null!=e))},u=e=>[{columnHeaderType:a.a,id:"@timestamp",initialWidth:i.b+10},{columnHeaderType:a.a,displayAsText:r.r,id:"kibana.alert.rule.name",initialWidth:i.a,linkField:"kibana.alert.rule.uuid"},o,...l(e)],c=e=>[{columnHeaderType:a.a,id:"kibana.alert.original_time",initialWidth:i.b+10},...l(e)],d=[{columnHeaderType:a.a,id:"@timestamp",displayAsText:r.D.timestamp,initialWidth:s.b+50,actions:!1,isExpandable:!1,isResizable:!1},{columnHeaderType:a.a,displayAsText:r.D.rule,id:"kibana.alert.rule.name",initialWidth:s.a+50,linkField:"kibana.alert.rule.uuid",actions:!1,isExpandable:!1,isResizable:!1},{columnHeaderType:a.a,id:"eventSummary",displayAsText:r.D.eventSummary,actions:!1,isExpandable:!1,isResizable:!1}]},function(e,t,n){var a=n(450),i=n(451);e.exports=function(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=a(e.prototype),r=e.apply(n,t);return i(r)?r:n}}},function(e,t,n){e.exports=n(24)(318)},function(e,t,n){"use strict";n.d(t,"c",(function(){return x})),n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return O}));var a=n(65),i=n.n(a),r=n(17),s=n(45),o=n(2),l=n.n(o),u=n(48),c=n(136),d=n.n(c),p=n(581),m=n(4),f=n(118),g=n(110),b=n(181),y=n(119),v=n(361);const h={fill:!1},E=l.a.memo((({duration:e,end:t,fromStr:n,id:a,isLoading:i,kqlQuery:u,policy:c,queries:d,setDuration:p,showUpdateButton:f=!0,start:b,startAutoReload:y,stopAutoReload:v,timelineId:E,toStr:j,updateReduxTime:O,disabled:S,width:k="restricted",compressed:w=!1})=>{const[T,I]=Object(o.useState)([]),C=Object(o.useCallback)((({start:e,end:n})=>{const i=e.includes("now")||n.includes("now"),{kqlHaveBeenUpdated:r}=O({end:n,id:a,isInvalid:!1,isQuickSelection:i,kql:u,start:e,timelineId:E,hasRangeChanged:!1}),s=x(e),o=i?x(n,{roundUp:!0}):x(n);!d||r||i&&(b!==s||t!==o)||_(d)}),[t,a,u,d,b,E,O]),M=Object(o.useCallback)((({isPaused:t,refreshInterval:i})=>{const r=null!=n&&n.includes("now")||null!=j&&j.includes("now");e!==i&&p({id:a,duration:i}),t&&"interval"===c?v({id:a}):t||"manual"!==c||y({id:a}),d&&!t&&(!r||r&&"now"!==j)&&_(d)}),[n,j,e,c,p,a,v,y,d]),_=e=>{e.forEach((e=>e.refetch&&e.refetch()))},A=Object(o.useCallback)((({start:e,end:t,isInvalid:n})=>{const i=e.includes("now")||t.includes("now");if(!n){O({end:t,id:a,isInvalid:n,isQuickSelection:i,kql:u,start:e,timelineId:E,hasRangeChanged:!0});const r=[{start:e,end:t},...Object(s.take)(9,T.filter((n=>!(n.start===e&&n.end===t))))];I(r)}}),[O,a,u,E,T]),P=null!=j?j:new Date(t).toISOString(),F=null!=n?n:new Date(b).toISOString(),[D]=Object(g.o)(m.W),N=Object(s.isEmpty)(D)?[]:D.map((({from:e,to:t,display:n})=>({start:e,end:t,label:n})));return l.a.createElement(r.EuiSuperDatePicker,{commonlyUsedRanges:N,end:P,isLoading:i,isPaused:"manual"===c,onRefresh:C,onRefreshChange:M,onTimeChange:A,recentlyUsedRanges:T,refreshInterval:e,showUpdateButton:f,start:F,isDisabled:S,width:k,compressed:w,updateButtonProps:h})}),((e,t)=>e.duration===t.duration&&e.end===t.end&&e.fromStr===t.fromStr&&e.id===t.id&&e.isLoading===t.isLoading&&e.policy===t.policy&&e.setDuration===t.setDuration&&e.start===t.start&&e.startAutoReload===t.startAutoReload&&e.stopAutoReload===t.stopAutoReload&&e.timelineId===t.timelineId&&e.disabled===t.disabled&&e.toStr===t.toStr&&e.updateReduxTime===t.updateReduxTime&&d()(e.kqlQuery,t.kqlQuery)&&d()(e.queries,t.queries))),x=(e,t)=>{const n=i.a.parse(e,t);return null!=n&&n.isValid()?n.toISOString():""},j=e=>({end:t,id:n,isQuickSelection:a,kql:i,start:r,timelineId:s,hasRangeChanged:o})=>{const l=x(r);let u=x(t,{roundUp:!0});var c;return a?e(t===r?b.c.setAbsoluteRangeDatePicker({id:n,fromStr:r,toStr:t,from:l,to:u}):b.c.setRelativeRangeDatePicker({id:n,fromStr:r,toStr:t,from:l,to:u})):(u=x(t),e(b.c.setAbsoluteRangeDatePicker({id:n,from:x(r),to:x(t)}))),null!=s&&o&&e(f.a.updateRange({id:s,start:l,end:u})),i&&i.refetch?{kqlHaveBeenUpdated:null!==(c=i.refetch(e))&&void 0!==c&&c}:{kqlHaveBeenUpdated:!1}};E.displayName="SuperDatePickerComponent";const O=Object(u.connect)((()=>{const e=Object(v.a)(),t=Object(v.b)(),n=Object(v.c)(),a=Object(v.d)(),i=Object(v.e)(),r=Object(v.f)(),o=Object(v.g)(),l=Object(v.h)(),u=Object(v.i)(),c=Object(v.j)();return(d,{id:m})=>{const f=Object(s.getOr)({},`inputs.${m}`,d);return{duration:e(f),end:t(f),fromStr:n(f),kind:i(f),policy:o(f),start:u(f),toStr:c(f),isLoading:!1,...Object(p.c)(f)&&(m===y.a.timeline||m===y.a.global)&&{isLoading:a(f),kqlQuery:r(f),queries:l(d,m)}}}}),(e=>({startAutoReload:({id:t})=>e(b.c.startAutoReload({id:t})),stopAutoReload:({id:t})=>e(b.c.stopAutoReload({id:t})),setDuration:({id:t,duration:n})=>e(b.c.setDuration({id:t,duration:n})),updateReduxTime:j(e)})))(E)},function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g})),n.d(t,"j",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"h",(function(){return v})),n.d(t,"f",(function(){return h}));var a=n(9),i=n(57),r=n(119);const s=e=>e.policy,o=e=>e.timerange,l=e=>e.queries,u=(e,t)=>{const n=e.inputs[t];return Object(a.isEmpty)(n.linkTo)?n.queries:n.linkTo.reduce(((t,n)=>{if(n===r.a.socTrends)return t;const a=e.inputs[n];return[...t,...a.queries]}),n.queries)},c=()=>Object(i.createSelector)(s,(e=>e.kind)),d=()=>Object(i.createSelector)(s,(e=>e.duration)),p=()=>Object(i.createSelector)(o,(e=>e.kind)),m=()=>Object(i.createSelector)(o,(e=>e.from)),f=()=>Object(i.createSelector)(o,(e=>e.to)),g=()=>Object(i.createSelector)(o,(e=>e.fromStr)),b=()=>Object(i.createSelector)(o,(e=>e.toStr)),y=()=>Object(i.createSelector)(l,(e=>e.some((e=>!0===e.loading)))),v=()=>Object(i.createSelector)(u,(e=>e.filter((e=>"kql"!==e.id)))),h=()=>Object(i.createSelector)(l,(e=>e.find((e=>"kql"===e.id))))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return g}));var a=n(111);const i=a.z.enum([".osquery",".endpoint"]),r=i.enum,s=a.z.object({}).catchall(a.z.object({field:a.z.string().optional(),value:a.z.union([a.z.string(),a.z.array(a.z.string())]).optional()})),o=a.z.object({id:a.z.string(),query:a.z.string(),ecs_mapping:s.optional(),version:a.z.string().optional(),platform:a.z.string().optional(),removed:a.z.boolean().optional(),snapshot:a.z.boolean().optional()}),l=a.z.object({query:a.z.string().optional(),ecs_mapping:s.optional(),queries:a.z.array(o).optional(),pack_id:a.z.string().optional(),saved_query_id:a.z.string().optional(),timeout:a.z.number().optional()}),u=a.z.object({query:a.z.string().optional(),ecsMapping:s.optional(),queries:a.z.array(o).optional(),packId:a.z.string().optional(),savedQueryId:a.z.string().optional(),timeout:a.z.number().optional()}),c=a.z.object({action_type_id:a.z.literal(".osquery"),params:l}),d=a.z.object({actionTypeId:a.z.literal(".osquery"),params:u}),p=a.z.object({command:a.z.literal("isolate"),comment:a.z.string().optional()}),m=a.z.object({action_type_id:a.z.literal(".endpoint"),params:p}),f=a.z.object({actionTypeId:a.z.literal(".endpoint"),params:p}),g=a.z.union([c,m]);a.z.union([d,f])},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(111),i=n(219),r=n(364);const s=a.z.object({last_execution:a.z.object({date:a.z.string().datetime(),status:i.a,status_order:i.c,message:a.z.string(),metrics:r.a})})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(111);const i=a.z.object({total_search_duration_ms:a.z.number().int().min(0).optional(),total_indexing_duration_ms:a.z.number().int().min(0).optional(),total_enrichment_duration_ms:a.z.number().int().min(0).optional(),execution_gap_duration_s:a.z.number().int().min(0).optional()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(111);const i=a.z.string(),r=a.z.string(),s=a.z.string()},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(111),i=n(141);const r=a.z.array(a.z.object({field:a.z.string(),value:a.z.number().int().min(0)})),s=a.z.number().int().min(1),o=a.z.union([a.z.string(),a.z.array(a.z.string())]),l=a.z.array(a.z.string()),u=a.z.object({field:o,value:s,cardinality:r.optional()}),c=(a.z.object({field:l,value:s,cardinality:r.optional()}),a.z.object({field:l,value:s,cardinality:r}),a.z.object({duration:i.a}))},function(e,t,n){"use strict";n.d(t,"g",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(111),i=n(141);const r=a.z.string(),s=a.z.array(a.z.object({entries:a.z.array(a.z.object({field:i.m,type:a.z.literal("mapping"),value:i.m}))})).min(1),o=a.z.array(a.z.string()),l=a.z.array(a.z.unknown()),u=a.z.string(),c=a.z.number().int().min(1),d=a.z.number().int().min(1)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(111);const i=a.z.number().int().min(0),r=a.z.union([a.z.string(),a.z.array(a.z.string()).min(1)])},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(111),i=n(141);const r=a.z.array(a.z.string()).min(1).max(3),s=i.m},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(111);const i=a.z.number().int().min(1),r=a.z.number().int().min(0),s=a.z.object({page:i,per_page:r,total:a.z.number().int().min(0)})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(111);const i=a.z.object({type:a.z.string(),message:a.z.string(),actionPath:a.z.string(),buttonLabel:a.z.string().optional()})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a="xs"},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"d",(function(){return l}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addSystemPromptTooltip",{defaultMessage:"Add system prompt"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.clearSystemPrompt",{defaultMessage:"Clear system prompt"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.selectASystemPromptPlaceholder",{defaultMessage:"Select a system prompt"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.addNewSystemPrompt",{defaultMessage:"Add new system prompt..."}),l=a.i18n.translate("xpack.elasticAssistant.assistant.firstPromptEditor.emptyPrompt",{defaultMessage:"(empty prompt)"})},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return u}));var a=n(549);const i=e=>{const{response:t,isStream:n,isError:a}=e,i=(new Date).toLocaleString();return e?{role:"assistant",...n?{reader:t}:{content:t},timestamp:i,isError:a,traceData:e.traceData}:{role:"assistant",content:"Error: Response from LLM API is empty or undefined.",timestamp:i,isError:!0}},r=(e,t)=>t?{...e,messages:[...e.messages,...a.a.messages]}:0===e.messages.length||e.messages[e.messages.length-1].content!==a.b[0].content?{...e,messages:[...e.messages,...a.b]}:e,s=e=>1===(null==e?void 0:e.length)?e[0]:void 0,o=e=>{const t=e.match(/```json\n([\s\S]+)\n```/);if(t)try{var n;return null!==(n=JSON.parse(t[1]).action_input)&&void 0!==n?n:e}catch{}return e},l=({alerts:e,alertsIndexPattern:t,allow:n,allowReplacement:a,replacements:i,size:r})=>e?{...t?{alertsIndexPattern:t}:void 0,...n?{allow:n}:void 0,...a?{allowReplacement:a}:void 0,...i?{replacements:i}:void 0,...r?{size:r}:void 0}:{},u=({alerts:e,assistantLangChain:t})=>t||e},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){var i=a.useRef(void 0);i.current&&n(t,i.current)||(i.current=t),a.useEffect(e,i.current)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef(!1),i=a.useRef(),r=a.useRef(e),s=a.useCallback((function(){return n.current}),[]),o=a.useCallback((function(){n.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){n.current=!0,r.current()}),t)}),[t]),l=a.useCallback((function(){n.current=null,i.current&&clearTimeout(i.current)}),[]);return a.useEffect((function(){r.current=e}),[e]),a.useEffect((function(){return o(),l}),[t]),[s,l,o]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(18),i=n(110),r=n(4);const s=()=>{var e,t,n,s,o;const l=Object(a.b)().isEnterprise(),u=Object(i.i)().services.application.capabilities,c=!0===(null===(e=u[r.n])||void 0===e?void 0:e["ai-assistant"]),d=!0===(null===(t=u.actions)||void 0===t?void 0:t.show)&&!0===(null===(n=u.actions)||void 0===n?void 0:n.execute);return{hasAssistantPrivilege:c,hasConnectorsAllPrivilege:d&&!0===(null===(s=u.actions)||void 0===s?void 0:s.delete)&&!0===(null===(o=u.actions)||void 0===o?void 0:o.save),hasConnectorsReadPrivilege:d,isAssistantEnabled:l}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=(a=n(2))&&"object"==typeof a&&"default"in a?a:{default:a},r=e=>"checkbox"===e.type,s=e=>e instanceof Date,o=e=>null==e;const l=e=>"object"==typeof e;var u=e=>!o(e)&&!Array.isArray(e)&&l(e)&&!s(e),c=e=>u(e)&&e.target?r(e.target)?e.target.checked:e.target.value:e,d=(e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)),p="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function m(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(p&&(e instanceof Blob||e instanceof FileList)||!n&&!u(e))return e;if(t=n?[]:{},n||(e=>{const t=e.constructor&&e.constructor.prototype;return u(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const n in e)e.hasOwnProperty(n)&&(t[n]=m(e[n]));else t=e}return t}var f=e=>Array.isArray(e)?e.filter(Boolean):[],g=e=>void 0===e,b=(e,t,n)=>{if(!t||!u(e))return n;const a=f(t.split(/[,[\].]+?/)).reduce(((e,t)=>o(e)?e:e[t]),e);return g(a)||a===e?g(e[t])?n:e[t]:a};const y="blur",v="focusout",h="change",E="onChange",x="onSubmit",j="all",O="pattern",S="required",k=i.default.createContext(null),w=()=>i.default.useContext(k);var T=(e,t,n,a=!0)=>{const i={defaultValues:t._defaultValues};for(const r in e)Object.defineProperty(i,r,{get:()=>{const i=r;return t._proxyFormState[i]!==j&&(t._proxyFormState[i]=!a||j),n&&(n[i]=!0),e[i]}});return i},I=e=>u(e)&&!Object.keys(e).length,C=(e,t,n,a)=>{n(e);const{name:i,...r}=e;return I(r)||Object.keys(r).length>=Object.keys(t).length||Object.keys(r).find((e=>t[e]===(!a||j)))},M=e=>Array.isArray(e)?e:[e],_=(e,t,n)=>n&&t?e===t:!e||!t||e===t||M(e).some((e=>e&&(e.startsWith(t)||t.startsWith(e))));function A(e){const t=i.default.useRef(e);t.current=e,i.default.useEffect((()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}}),[e.disabled])}function P(e){const t=w(),{control:n=t.control,disabled:a,name:r,exact:s}=e||{},[o,l]=i.default.useState(n._formState),u=i.default.useRef(!0),c=i.default.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),d=i.default.useRef(r);return d.current=r,A({disabled:a,next:e=>u.current&&_(d.current,e.name,s)&&C(e,c.current,n._updateFormState)&&l({...n._formState,...e}),subject:n._subjects.state}),i.default.useEffect((()=>(u.current=!0,c.current.isValid&&n._updateValid(!0),()=>{u.current=!1})),[n]),T(o,n,c.current,!1)}var F=e=>"string"==typeof e,D=(e,t,n,a,i)=>F(e)?(a&&t.watch.add(e),b(n,e,i)):Array.isArray(e)?e.map((e=>(a&&t.watch.add(e),b(n,e)))):(a&&(t.watchAll=!0),n);function N(e){const t=w(),{control:n=t.control,name:a,defaultValue:r,disabled:s,exact:o}=e||{},l=i.default.useRef(a);l.current=a,A({disabled:s,subject:n._subjects.values,next:e=>{_(l.current,e.name,o)&&c(m(D(l.current,n._names,e.values||n._formValues,!1,r)))}});const[u,c]=i.default.useState(n._getWatch(a,r));return i.default.useEffect((()=>n._removeUnmounted())),u}var R=e=>/^\w*$/.test(e),L=e=>f(e.replace(/["|']|\]/g,"").split(/\.|\[/));function z(e,t,n){let a=-1;const i=R(t)?[t]:L(t),r=i.length,s=r-1;for(;++a<r;){const t=i[a];let r=n;if(a!==s){const n=e[t];r=u(n)||Array.isArray(n)?n:isNaN(+i[a+1])?{}:[]}e[t]=r,e=e[t]}return e}function B(e){const t=w(),{name:n,control:a=t.control,shouldUnregister:r}=e,s=d(a._names.array,n),o=N({control:a,name:n,defaultValue:b(a._formValues,n,b(a._defaultValues,n,e.defaultValue)),exact:!0}),l=P({control:a,name:n}),u=i.default.useRef(a.register(n,{...e.rules,value:o}));return u.current=a.register(n,e.rules),i.default.useEffect((()=>{const e=a._options.shouldUnregister||r,t=(e,t)=>{const n=b(a._fields,e);n&&(n._f.mount=t)};if(t(n,!0),e){const e=m(b(a._options.defaultValues,n));z(a._defaultValues,n,e),g(b(a._formValues,n))&&z(a._formValues,n,e)}return()=>{(s?e&&!a._state.action:e)?a.unregister(n):t(n,!1)}}),[n,a,s,r]),{field:{name:n,value:o,onChange:i.default.useCallback((e=>u.current.onChange({target:{value:c(e),name:n},type:h})),[n]),onBlur:i.default.useCallback((()=>u.current.onBlur({target:{value:b(a._formValues,n),name:n},type:y})),[n,a]),ref:e=>{const t=b(a._fields,n);t&&e&&(t._f.ref={focus:()=>e.focus(),select:()=>e.select(),setCustomValidity:t=>e.setCustomValidity(t),reportValidity:()=>e.reportValidity()})}},formState:l,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!b(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!b(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!b(l.touchedFields,n)},error:{enumerable:!0,get:()=>b(l.errors,n)}})}}const q="post";var $=(e,t,n,a,i)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[a]:i||!0}}:{};const V=(e,t,n)=>{for(const a of n||Object.keys(e)){const n=b(e,a);if(n){const{_f:e,...a}=n;if(e&&t(e.name)){if(e.ref.focus){e.ref.focus();break}if(e.refs&&e.refs[0].focus){e.refs[0].focus();break}}else u(a)&&V(a,t)}}};var U=()=>{const e="undefined"==typeof performance?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const n=(16*Math.random()+e)%16|0;return("x"==t?n:3&n|8).toString(16)}))},H=(e,t,n={})=>n.shouldFocus||g(n.shouldFocus)?n.focusName||`${e}.${g(n.focusIndex)?t:n.focusIndex}.`:"",Z=e=>({isOnSubmit:!e||e===x,isOnBlur:"onBlur"===e,isOnChange:e===E,isOnAll:e===j,isOnTouch:"onTouched"===e}),G=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))))),Q=(e,t,n)=>{const a=f(b(e,n));return z(a,"root",t[n]),z(e,n,a),e},W=e=>"boolean"==typeof e,K=e=>"file"===e.type,J=e=>"function"==typeof e,Y=e=>{if(!p)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},X=e=>F(e),ee=e=>"radio"===e.type,te=e=>e instanceof RegExp;const ne={value:!1,isValid:!1},ae={value:!0,isValid:!0};var ie=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!g(e[0].attributes.value)?g(e[0].value)||""===e[0].value?ae:{value:e[0].value,isValid:!0}:ae:ne}return ne};const re={isValid:!1,value:null};var se=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),re):re;function oe(e,t,n="validate"){if(X(e)||Array.isArray(e)&&e.every(X)||W(e)&&!e)return{type:n,message:X(e)?e:"",ref:t}}var le=e=>u(e)&&!te(e)?e:{value:e,message:""},ue=async(e,t,n,a,i)=>{const{ref:s,refs:l,required:c,maxLength:d,minLength:p,min:m,max:f,pattern:y,validate:v,name:h,valueAsNumber:E,mount:x,disabled:j}=e._f,k=b(t,h);if(!x||j)return{};const w=l?l[0]:s,T=e=>{a&&w.reportValidity&&(w.setCustomValidity(W(e)?"":e||""),w.reportValidity())},C={},M=ee(s),_=r(s),A=M||_,P=(E||K(s))&&g(s.value)&&g(k)||Y(s)&&""===s.value||""===k||Array.isArray(k)&&!k.length,D=$.bind(null,h,n,C),N=(e,t,n,a="maxLength",i="minLength")=>{const r=e?t:n;C[h]={type:e?a:i,message:r,ref:s,...D(e?a:i,r)}};if(i?!Array.isArray(k)||!k.length:c&&(!A&&(P||o(k))||W(k)&&!k||_&&!ie(l).isValid||M&&!se(l).isValid)){const{value:e,message:t}=X(c)?{value:!!c,message:c}:le(c);if(e&&(C[h]={type:S,message:t,ref:w,...D(S,t)},!n))return T(t),C}if(!(P||o(m)&&o(f))){let e,t;const a=le(f),i=le(m);if(o(k)||isNaN(k)){const n=s.valueAsDate||new Date(k),r=e=>new Date((new Date).toDateString()+" "+e),o="time"==s.type,l="week"==s.type;F(a.value)&&k&&(e=o?r(k)>r(a.value):l?k>a.value:n>new Date(a.value)),F(i.value)&&k&&(t=o?r(k)<r(i.value):l?k<i.value:n<new Date(i.value))}else{const n=s.valueAsNumber||(k?+k:k);o(a.value)||(e=n>a.value),o(i.value)||(t=n<i.value)}if((e||t)&&(N(!!e,a.message,i.message,"max","min"),!n))return T(C[h].message),C}if((d||p)&&!P&&(F(k)||i&&Array.isArray(k))){const e=le(d),t=le(p),a=!o(e.value)&&k.length>+e.value,i=!o(t.value)&&k.length<+t.value;if((a||i)&&(N(a,e.message,t.message),!n))return T(C[h].message),C}if(y&&!P&&F(k)){const{value:e,message:t}=le(y);if(te(e)&&!k.match(e)&&(C[h]={type:O,message:t,ref:s,...D(O,t)},!n))return T(t),C}if(v)if(J(v)){const e=oe(await v(k,t),w);if(e&&(C[h]={...e,...D("validate",e.message)},!n))return T(e.message),C}else if(u(v)){let e={};for(const a in v){if(!I(e)&&!n)break;const i=oe(await v[a](k,t),w,a);i&&(e={...i,...D(a,i.message)},T(i.message),n&&(C[h]=e))}if(!I(e)&&(C[h]={ref:w,...e},!n))return C}return T(!0),C};function ce(e,t){return[...e,...M(t)]}var de=e=>Array.isArray(e)?e.map((()=>{})):void 0;function pe(e,t,n){return[...e.slice(0,t),...M(n),...e.slice(t)]}var me=(e,t,n)=>Array.isArray(e)?(g(e[n])&&(e[n]=void 0),e.splice(n,0,e.splice(t,1)[0]),e):[];function fe(e,t){return[...M(t),...M(e)]}var ge=(e,t)=>g(t)?[]:function(e,t){let n=0;const a=[...e];for(const e of t)a.splice(e-n,1),n++;return f(a).length?a:[]}(e,M(t).sort(((e,t)=>e-t))),be=(e,t,n)=>{e[t]=[e[n],e[n]=e[t]][0]};function ye(e,t){const n=Array.isArray(t)?t:R(t)?[t]:L(t),a=1===n.length?e:function(e,t){const n=t.slice(0,-1).length;let a=0;for(;a<n;)e=g(e)?a++:e[t[a++]];return e}(e,n),i=n.length-1,r=n[i];return a&&delete a[r],0!==i&&(u(a)&&I(a)||Array.isArray(a)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!g(e[t]))return!1;return!0}(a))&&ye(e,n.slice(0,-1)),e}var ve=(e,t,n)=>(e[t]=n,e);function he(){let e=[];return{get observers(){return e},next:t=>{for(const n of e)n.next&&n.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}}var Ee=e=>o(e)||!l(e);function xe(e,t){if(Ee(e)||Ee(t))return e===t;if(s(e)&&s(t))return e.getTime()===t.getTime();const n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(const i of n){const n=e[i];if(!a.includes(i))return!1;if("ref"!==i){const e=t[i];if(s(n)&&s(e)||u(n)&&u(e)||Array.isArray(n)&&Array.isArray(e)?!xe(n,e):n!==e)return!1}}return!0}var je=e=>"select-multiple"===e.type,Oe=e=>Y(e)&&e.isConnected,Se=e=>{for(const t in e)if(J(e[t]))return!0;return!1};function ke(e,t={}){const n=Array.isArray(e);if(u(e)||n)for(const n in e)Array.isArray(e[n])||u(e[n])&&!Se(e[n])?(t[n]=Array.isArray(e[n])?[]:{},ke(e[n],t[n])):o(e[n])||(t[n]=!0);return t}function we(e,t,n){const a=Array.isArray(e);if(u(e)||a)for(const a in e)Array.isArray(e[a])||u(e[a])&&!Se(e[a])?g(t)||Ee(n[a])?n[a]=Array.isArray(e[a])?ke(e[a],[]):{...ke(e[a])}:we(e[a],o(t)?{}:t[a],n[a]):n[a]=!xe(e[a],t[a]);return n}var Te=(e,t)=>we(e,t,ke(t)),Ie=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:a})=>g(e)?e:t?""===e?NaN:e?+e:e:n&&F(e)?new Date(e):a?a(e):e;function Ce(e){const t=e.ref;if(!(e.refs?e.refs.every((e=>e.disabled)):t.disabled))return K(t)?t.files:ee(t)?se(e.refs).value:je(t)?[...t.selectedOptions].map((({value:e})=>e)):r(t)?ie(e.refs).value:Ie(g(t.value)?e.ref.value:t.value,e)}var Me=e=>g(e)?e:te(e)?e.source:u(e)?te(e.value)?e.value.source:e.value:e;function _e(e,t,n){const a=b(e,n);if(a||R(n))return{error:a,name:n};const i=n.split(".");for(;i.length;){const a=i.join("."),r=b(t,a),s=b(e,a);if(r&&!Array.isArray(r)&&n!==a)return{name:n};if(s&&s.type)return{name:a,error:s};i.pop()}return{name:n}}const Ae={mode:x,reValidateMode:E,shouldFocusError:!0};function Pe(e={},t){let n,a={...Ae,...e},i={submitCount:0,isDirty:!1,isLoading:J(a.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:{}},l={},h=(u(a.defaultValues)||u(a.values))&&m(a.defaultValues||a.values)||{},E=a.shouldUnregister?{}:m(h),x={action:!1,mount:!1,watch:!1},O={mount:new Set,unMount:new Set,array:new Set,watch:new Set},S=0;const k={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},w={values:he(),array:he(),state:he()},T=e.resetOptions&&e.resetOptions.keepDirtyValues,C=Z(a.mode),_=Z(a.reValidateMode),A=a.criteriaMode===j,P=async e=>{if(k.isValid||e){const e=a.resolver?I((await q()).errors):await $(l,!0);e!==i.isValid&&w.state.next({isValid:e})}},N=e=>k.isValidating&&w.state.next({isValidating:e}),R=(e,t,n,a)=>{const i=b(l,e);if(i){const r=b(E,e,g(n)?b(h,e):n);g(r)||a&&a.defaultChecked||t?z(E,e,t?r:Ce(i._f)):X(e,r),x.mount&&P()}},L=(e,t,n,a,r)=>{let s=!1,o=!1;const l={name:e};if(!n||a){k.isDirty&&(o=i.isDirty,i.isDirty=l.isDirty=U(),s=o!==l.isDirty);const n=xe(b(h,e),t);o=b(i.dirtyFields,e),n?ye(i.dirtyFields,e):z(i.dirtyFields,e,!0),l.dirtyFields=i.dirtyFields,s=s||k.dirtyFields&&o!==!n}if(n){const t=b(i.touchedFields,e);t||(z(i.touchedFields,e,n),l.touchedFields=i.touchedFields,s=s||k.touchedFields&&t!==n)}return s&&r&&w.state.next(l),s?l:{}},B=(t,a,r,s)=>{const o=b(i.errors,t),l=k.isValid&&W(a)&&i.isValid!==a;var u;if(e.delayError&&r?(u=()=>((e,t)=>{z(i.errors,e,t),w.state.next({errors:i.errors})})(t,r),n=e=>{clearTimeout(S),S=setTimeout(u,e)},n(e.delayError)):(clearTimeout(S),n=null,r?z(i.errors,t,r):ye(i.errors,t)),(r?!xe(o,r):o)||!I(s)||l){const e={...s,...l&&W(a)?{isValid:a}:{},errors:i.errors,name:t};i={...i,...e},w.state.next(e)}N(!1)},q=async e=>a.resolver(E,a.context,((e,t,n,a)=>{const i={};for(const n of e){const e=b(t,n);e&&z(i,n,e._f)}return{criteriaMode:n,names:[...e],fields:i,shouldUseNativeValidation:a}})(e||O.mount,l,a.criteriaMode,a.shouldUseNativeValidation)),$=async(e,t,n={valid:!0})=>{for(const r in e){const s=e[r];if(s){const{_f:e,...r}=s;if(e){const r=O.array.has(e.name),o=await ue(s,E,A,a.shouldUseNativeValidation&&!t,r);if(o[e.name]&&(n.valid=!1,t))break;!t&&(b(o,e.name)?r?Q(i.errors,o,e.name):z(i.errors,e.name,o[e.name]):ye(i.errors,e.name))}r&&await $(r,t,n)}}return n.valid},U=(e,t)=>(e&&t&&z(E,e,t),!xe(re(),h)),H=(e,t,n)=>D(e,O,{...x.mount?E:g(t)?h:F(e)?{[e]:t}:t},n,t),X=(e,t,n={})=>{const a=b(l,e);let i=t;if(a){const n=a._f;n&&(!n.disabled&&z(E,e,Ie(t,n)),i=Y(n.ref)&&o(t)?"":t,je(n.ref)?[...n.ref.options].forEach((e=>e.selected=i.includes(e.value))):n.refs?r(n.ref)?n.refs.length>1?n.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(i)?!!i.find((t=>t===e.value)):i===e.value))):n.refs[0]&&(n.refs[0].checked=!!i):n.refs.forEach((e=>e.checked=e.value===i)):K(n.ref)?n.ref.value="":(n.ref.value=i,n.ref.type||w.values.next({name:e,values:{...E}})))}(n.shouldDirty||n.shouldTouch)&&L(e,i,n.shouldTouch,n.shouldDirty,!0),n.shouldValidate&&ie(e)},te=(e,t,n)=>{for(const a in t){const i=t[a],r=`${e}.${a}`,o=b(l,r);!O.array.has(e)&&Ee(i)&&(!o||o._f)||s(i)?X(r,i,n):te(r,i,n)}},ne=(e,n,a={})=>{const r=b(l,e),s=O.array.has(e),u=m(n);z(E,e,u),s?(w.array.next({name:e,values:{...E}}),(k.isDirty||k.dirtyFields)&&a.shouldDirty&&w.state.next({name:e,dirtyFields:Te(h,E),isDirty:U(e,u)})):!r||r._f||o(u)?X(e,u,a):te(e,u,a),G(e,O)&&w.state.next({...i}),w.values.next({name:e,values:{...E}}),!x.mount&&t()},ae=async e=>{const t=e.target;let r=t.name,s=!0;const o=b(l,r);if(o){let d,p;const m=t.type?Ce(o._f):c(e),f=e.type===y||e.type===v,g=!((u=o._f).mount&&(u.required||u.min||u.max||u.maxLength||u.minLength||u.pattern||u.validate)||a.resolver||b(i.errors,r)||o._f.deps)||((e,t,n,a,i)=>!i.isOnAll&&(!n&&i.isOnTouch?!(t||e):(n?a.isOnBlur:i.isOnBlur)?!e:!(n?a.isOnChange:i.isOnChange)||e))(f,b(i.touchedFields,r),i.isSubmitted,_,C),h=G(r,O,f);z(E,r,m),f?(o._f.onBlur&&o._f.onBlur(e),n&&n(0)):o._f.onChange&&o._f.onChange(e);const x=L(r,m,f,!1),j=!I(x)||h;if(!f&&w.values.next({name:r,type:e.type,values:{...E}}),g)return k.isValid&&P(),j&&w.state.next({name:r,...h?{}:x});if(!f&&h&&w.state.next({...i}),N(!0),a.resolver){const{errors:e}=await q([r]),t=_e(i.errors,l,r),n=_e(e,l,t.name||r);d=n.error,r=n.name,p=I(e)}else d=(await ue(o,E,A,a.shouldUseNativeValidation))[r],s=isNaN(m)||m===b(E,r,m),s&&(d?p=!1:k.isValid&&(p=await $(l,!0)));s&&(o._f.deps&&ie(o._f.deps),B(r,p,d,x))}var u},ie=async(e,t={})=>{let n,r;const s=M(e);if(N(!0),a.resolver){const t=await(async e=>{const{errors:t}=await q();if(e)for(const n of e){const e=b(t,n);e?z(i.errors,n,e):ye(i.errors,n)}else i.errors=t;return t})(g(e)?e:s);n=I(t),r=e?!s.some((e=>b(t,e))):n}else e?(r=(await Promise.all(s.map((async e=>{const t=b(l,e);return await $(t&&t._f?{[e]:t}:t)})))).every(Boolean),(r||i.isValid)&&P()):r=n=await $(l);return w.state.next({...!F(e)||k.isValid&&n!==i.isValid?{}:{name:e},...a.resolver||!e?{isValid:n}:{},errors:i.errors,isValidating:!1}),t.shouldFocus&&!r&&V(l,(e=>e&&b(i.errors,e)),e?s:O.mount),r},re=e=>{const t={...h,...x.mount?E:{}};return g(e)?t:F(e)?b(t,e):e.map((e=>b(t,e)))},se=(e,t)=>({invalid:!!b((t||i).errors,e),isDirty:!!b((t||i).dirtyFields,e),isTouched:!!b((t||i).touchedFields,e),error:b((t||i).errors,e)}),oe=(e,t,n)=>{const a=(b(l,e,{_f:{}})._f||{}).ref;z(i.errors,e,{...t,ref:a}),w.state.next({name:e,errors:i.errors,isValid:!1}),n&&n.shouldFocus&&a&&a.focus&&a.focus()},le=(e,t={})=>{for(const n of e?M(e):O.mount)O.mount.delete(n),O.array.delete(n),t.keepValue||(ye(l,n),ye(E,n)),!t.keepError&&ye(i.errors,n),!t.keepDirty&&ye(i.dirtyFields,n),!t.keepTouched&&ye(i.touchedFields,n),!a.shouldUnregister&&!t.keepDefaultValue&&ye(h,n);w.values.next({values:{...E}}),w.state.next({...i,...t.keepDirty?{isDirty:U()}:{}}),!t.keepIsValid&&P()},ce=(e,t={})=>{let n=b(l,e);const i=W(t.disabled);return z(l,e,{...n||{},_f:{...n&&n._f?n._f:{ref:{name:e}},name:e,mount:!0,...t}}),O.mount.add(e),n?i&&z(E,e,t.disabled?void 0:b(E,e,Ce(n._f))):R(e,!0,t.value),{...i?{disabled:t.disabled}:{},...a.progressive?{required:!!t.required,min:Me(t.min),max:Me(t.max),minLength:Me(t.minLength),maxLength:Me(t.maxLength),pattern:Me(t.pattern)}:{},name:e,onChange:ae,onBlur:ae,ref:i=>{if(i){ce(e,t),n=b(l,e);const a=g(i.value)&&i.querySelectorAll&&i.querySelectorAll("input,select,textarea")[0]||i,s=(e=>ee(e)||r(e))(a),o=n._f.refs||[];if(s?o.find((e=>e===a)):a===n._f.ref)return;z(l,e,{_f:{...n._f,...s?{refs:[...o.filter(Oe),a,...Array.isArray(b(h,e))?[{}]:[]],ref:{type:a.type,name:e}}:{ref:a}}}),R(e,!1,void 0,a)}else n=b(l,e,{}),n._f&&(n._f.mount=!1),(a.shouldUnregister||t.shouldUnregister)&&(!d(O.array,e)||!x.action)&&O.unMount.add(e)}}},de=()=>a.shouldFocusError&&V(l,(e=>e&&b(i.errors,e)),O.mount),pe=(e,t)=>async n=>{n&&(n.preventDefault&&n.preventDefault(),n.persist&&n.persist());let r=m(E);if(w.state.next({isSubmitting:!0}),a.resolver){const{errors:e,values:t}=await q();i.errors=e,r=t}else await $(l);ye(i.errors,"root"),I(i.errors)?(w.state.next({errors:{}}),await e(r,n)):(t&&await t({...i.errors},n),de(),setTimeout(de)),w.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:I(i.errors),submitCount:i.submitCount+1,errors:i.errors})},me=(n,a={})=>{const r=n||h,s=m(r),o=n&&!I(n)?s:h;if(a.keepDefaultValues||(h=r),!a.keepValues){if(a.keepDirtyValues||T)for(const e of O.mount)b(i.dirtyFields,e)?z(o,e,b(E,e)):ne(e,b(o,e));else{if(p&&g(n))for(const e of O.mount){const t=b(l,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(Y(e)){const t=e.closest("form");if(t){t.reset();break}}}}l={}}E=e.shouldUnregister?a.keepDefaultValues?m(h):{}:m(o),w.array.next({values:{...o}}),w.values.next({values:{...o}})}O={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!x.mount&&t(),x.mount=!k.isValid||!!a.keepIsValid,x.watch=!!e.shouldUnregister,w.state.next({submitCount:a.keepSubmitCount?i.submitCount:0,isDirty:a.keepDirty?i.isDirty:!(!a.keepDefaultValues||xe(n,h)),isSubmitted:!!a.keepIsSubmitted&&i.isSubmitted,dirtyFields:a.keepDirtyValues?i.dirtyFields:a.keepDefaultValues&&n?Te(h,n):{},touchedFields:a.keepTouched?i.touchedFields:{},errors:a.keepErrors?i.errors:{},isSubmitting:!1,isSubmitSuccessful:!1})},fe=(e,t)=>me(J(e)?e(E):e,t);return{control:{register:ce,unregister:le,getFieldState:se,handleSubmit:pe,setError:oe,_executeSchema:q,_getWatch:H,_getDirty:U,_updateValid:P,_removeUnmounted:()=>{for(const e of O.unMount){const t=b(l,e);t&&(t._f.refs?t._f.refs.every((e=>!Oe(e))):!Oe(t._f.ref))&&le(e)}O.unMount=new Set},_updateFieldArray:(e,t=[],n,a,r=!0,s=!0)=>{if(a&&n){if(x.action=!0,s&&Array.isArray(b(l,e))){const t=n(b(l,e),a.argA,a.argB);r&&z(l,e,t)}if(s&&Array.isArray(b(i.errors,e))){const t=n(b(i.errors,e),a.argA,a.argB);r&&z(i.errors,e,t),((e,t)=>{!f(b(e,t)).length&&ye(e,t)})(i.errors,e)}if(k.touchedFields&&s&&Array.isArray(b(i.touchedFields,e))){const t=n(b(i.touchedFields,e),a.argA,a.argB);r&&z(i.touchedFields,e,t)}k.dirtyFields&&(i.dirtyFields=Te(h,E)),w.state.next({name:e,isDirty:U(e,t),dirtyFields:i.dirtyFields,errors:i.errors,isValid:i.isValid})}else z(E,e,t)},_getFieldArray:t=>f(b(x.mount?E:h,t,e.shouldUnregister?b(h,t,[]):[])),_reset:me,_resetDefaultValues:()=>J(a.defaultValues)&&a.defaultValues().then((e=>{fe(e,a.resetOptions),w.state.next({isLoading:!1})})),_updateFormState:e=>{i={...i,...e}},_subjects:w,_proxyFormState:k,get _fields(){return l},get _formValues(){return E},get _state(){return x},set _state(e){x=e},get _defaultValues(){return h},get _names(){return O},set _names(e){O=e},get _formState(){return i},set _formState(e){i=e},get _options(){return a},set _options(e){a={...a,...e}}},trigger:ie,register:ce,handleSubmit:pe,watch:(e,t)=>J(e)?w.values.subscribe({next:n=>e(H(void 0,t),n)}):H(e,t,!0),setValue:ne,getValues:re,reset:fe,resetField:(e,t={})=>{b(l,e)&&(g(t.defaultValue)?ne(e,b(h,e)):(ne(e,t.defaultValue),z(h,e,t.defaultValue)),t.keepTouched||ye(i.touchedFields,e),t.keepDirty||(ye(i.dirtyFields,e),i.isDirty=t.defaultValue?U(e,b(h,e)):U()),t.keepError||(ye(i.errors,e),k.isValid&&P()),w.state.next({...i}))},clearErrors:e=>{e&&M(e).forEach((e=>ye(i.errors,e))),w.state.next({errors:e?i.errors:{}})},unregister:le,setError:oe,setFocus:(e,t={})=>{const n=b(l,e),a=n&&n._f;if(a){const e=a.refs?a.refs[0]:a.ref;e.focus&&(e.focus(),t.shouldSelect&&e.select())}},getFieldState:se}}t.Controller=e=>e.render(B(e)),t.Form=function(e){const t=w(),[n,a]=i.default.useState(!1),{control:r=t.control,onSubmit:s,children:o,action:l,method:u=q,headers:c,encType:d,onError:p,render:m,onSuccess:f,validateStatus:g,...y}=e,v=async t=>{let n=!1,a="";await r.handleSubmit((async e=>{const i=new FormData;let o="";try{o=JSON.stringify(e)}catch(e){}for(const t of r._names.mount)i.append(t,b(e,t));if(s&&s({data:e,event:t,method:u,formData:i,formDataJson:o}),l)try{const e=[c&&c["Content-Type"],d].some((e=>e&&e.includes("json"))),t=await fetch(l,{method:u,headers:{...c,...d?{"Content-Type":d}:{}},body:e?o:i});t&&(g?!g(t.status):t.status<200||t.status>=300)?(n=!0,p&&p({response:t}),a=String(t.status)):f&&f({response:t})}catch(e){n=!0,p&&p({error:e})}}))(t),n&&e.control&&(e.control._subjects.state.next({isSubmitSuccessful:!1}),e.control.setError("root.server",{type:a}))};return i.default.useEffect((()=>{a(!0)}),[]),m?i.default.createElement(i.default.Fragment,null,m({submit:v})):i.default.createElement("form",{noValidate:n,action:l,method:u,encType:d,onSubmit:v,...y},o)},t.FormProvider=e=>{const{children:t,...n}=e;return i.default.createElement(k.Provider,{value:n},t)},t.appendErrors=$,t.get=b,t.set=z,t.useController=B,t.useFieldArray=function(e){const t=w(),{control:n=t.control,name:a,keyName:r="id",shouldUnregister:s}=e,[o,l]=i.default.useState(n._getFieldArray(a)),u=i.default.useRef(n._getFieldArray(a).map(U)),c=i.default.useRef(o),d=i.default.useRef(a),p=i.default.useRef(!1);d.current=a,c.current=o,n._names.array.add(a),e.rules&&n.register(a,e.rules),A({next:({values:e,name:t})=>{if(t===d.current||!t){const t=b(e,d.current);Array.isArray(t)&&(l(t),u.current=t.map(U))}},subject:n._subjects.array});const f=i.default.useCallback((e=>{p.current=!0,n._updateFieldArray(a,e)}),[n,a]);return i.default.useEffect((()=>{if(n._state.action=!1,G(a,n._names)&&n._subjects.state.next({...n._formState}),p.current&&(!Z(n._options.mode).isOnSubmit||n._formState.isSubmitted))if(n._options.resolver)n._executeSchema([a]).then((e=>{const t=b(e.errors,a),i=b(n._formState.errors,a);(i?!t&&i.type||t&&(i.type!==t.type||i.message!==t.message):t&&t.type)&&(t?z(n._formState.errors,a,t):ye(n._formState.errors,a),n._subjects.state.next({errors:n._formState.errors}))}));else{const e=b(n._fields,a);e&&e._f&&ue(e,n._formValues,n._options.criteriaMode===j,n._options.shouldUseNativeValidation,!0).then((e=>!I(e)&&n._subjects.state.next({errors:Q(n._formState.errors,e,a)})))}n._subjects.values.next({name:a,values:{...n._formValues}}),n._names.focus&&V(n._fields,(e=>!!e&&e.startsWith(n._names.focus||""))),n._names.focus="",n._updateValid()}),[o,a,n]),i.default.useEffect((()=>(!b(n._formValues,a)&&n._updateFieldArray(a),()=>{(n._options.shouldUnregister||s)&&n.unregister(a)})),[a,n,r,s]),{swap:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);be(i,e,t),be(u.current,e,t),f(i),l(i),n._updateFieldArray(a,i,be,{argA:e,argB:t},!1)}),[f,a,n]),move:i.default.useCallback(((e,t)=>{const i=n._getFieldArray(a);me(i,e,t),me(u.current,e,t),f(i),l(i),n._updateFieldArray(a,i,me,{argA:e,argB:t},!1)}),[f,a,n]),prepend:i.default.useCallback(((e,t)=>{const i=M(m(e)),r=fe(n._getFieldArray(a),i);n._names.focus=H(a,0,t),u.current=fe(u.current,i.map(U)),f(r),l(r),n._updateFieldArray(a,r,fe,{argA:de(e)})}),[f,a,n]),append:i.default.useCallback(((e,t)=>{const i=M(m(e)),r=ce(n._getFieldArray(a),i);n._names.focus=H(a,r.length-1,t),u.current=ce(u.current,i.map(U)),f(r),l(r),n._updateFieldArray(a,r,ce,{argA:de(e)})}),[f,a,n]),remove:i.default.useCallback((e=>{const t=ge(n._getFieldArray(a),e);u.current=ge(u.current,e),f(t),l(t),n._updateFieldArray(a,t,ge,{argA:e})}),[f,a,n]),insert:i.default.useCallback(((e,t,i)=>{const r=M(m(t)),s=pe(n._getFieldArray(a),e,r);n._names.focus=H(a,e,i),u.current=pe(u.current,e,r.map(U)),f(s),l(s),n._updateFieldArray(a,s,pe,{argA:e,argB:de(t)})}),[f,a,n]),update:i.default.useCallback(((e,t)=>{const i=m(t),r=ve(n._getFieldArray(a),e,i);u.current=[...r].map(((t,n)=>t&&n!==e?u.current[n]:U())),f(r),l([...r]),n._updateFieldArray(a,r,ve,{argA:e,argB:i},!0,!1)}),[f,a,n]),replace:i.default.useCallback((e=>{const t=M(m(e));u.current=t.map(U),f([...t]),l([...t]),n._updateFieldArray(a,[...t],(e=>e),{},!0,!1)}),[f,a,n]),fields:i.default.useMemo((()=>o.map(((e,t)=>({...e,[r]:u.current[t]||U()})))),[o,r])}},t.useForm=function(e={}){const t=i.default.useRef(),[n,a]=i.default.useState({isDirty:!1,isValidating:!1,isLoading:J(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:{},defaultValues:J(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...Pe(e,(()=>a((e=>({...e}))))),formState:n});const r=t.current.control;return r._options=e,A({subject:r._subjects.state,next:e=>{C(e,r._proxyFormState,r._updateFormState,!0)&&a({...r._formState})}}),i.default.useEffect((()=>{e.values&&!xe(e.values,r._defaultValues)?r._reset(e.values,r._options.resetOptions):r._resetDefaultValues()}),[e.values,r]),i.default.useEffect((()=>{r._state.mount||(r._updateValid(),r._state.mount=!0),r._state.watch&&(r._state.watch=!1,r._subjects.state.next({...r._formState})),r._removeUnmounted()})),t.current.formState=T(n,r),t.current},t.useFormContext=w,t.useFormState=P,t.useWatch=N},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(17),l=n(48),u=n(128),c=n(119),d=n(138),p=n(14),m=n(181),f=n(116),g=n(122),b=n(113),y=n(228),v=n(197),h=n(112);const E=({asEmptyButton:e,children:t,dataProviders:n,filters:a,timeRange:E,keepDataView:x,iconType:j,...O})=>{const S=Object(l.useDispatch)(),k=Object(r.useMemo)((()=>u.e.getSourcererDataViewsSelector()),[]),{defaultDataView:w,signalIndexName:T}=Object(h.a)((e=>k(e))),I=n&&n.find((e=>"template"===e.type)),C=Object(y.a)({timelineId:g.c.active,timelineType:I?b.l.template:b.l.default}),M=Object(r.useCallback)((()=>{(n||a)&&(E?C({timeRange:E}):C(),n&&S(Object(p.updateProviders)({id:g.c.active,providers:n})),a&&S(Object(p.setFilters)({id:g.c.active,filters:a})),x||S(m.d.setSelectedDataView({id:f.SourcererScopeName.timeline,selectedDataViewId:w.id,selectedPatterns:[T||""]})),S(d.b.removeLinkTo([c.a.timeline,c.a.global])))}),[n,C,S,w.id,T,a,E,x]);return e?s.a.createElement(o.EuiButtonEmpty,{"aria-label":v.i,onClick:M,flush:"right",size:"xs",iconType:j},t):s.a.createElement(o.EuiButton,i()({"aria-label":v.i,onClick:M},O),t)};E.displayName="InvestigateInTimelineButton"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(17),s=n(542),o=n(317);const l=Object(a.forwardRef)((({onChange:e,value:t,ariaLabel:n,editorId:l,dataTestSubj:u,height:c,autoFocusDisabled:d,setIsMarkdownInvalid:p},m)=>{const[f,g]=Object(a.useState)([]),b=Object(a.useCallback)(((e,{messages:t})=>{g(e?[e]:t),p(!!e)}),[p]),y=Object(a.useRef)(null);Object(a.useEffect)((()=>{var e,t;d||null===(e=y.current)||void 0===e||null===(t=e.textarea)||void 0===t||t.focus()}),[d]);const v=Object(o.b)("investigation_guide"),h=Object(a.useMemo)((()=>Object(s.d)({insightsUpsellingMessage:v})),[v]);return Object(a.useImperativeHandle)(m,(()=>{var e,t;if(!y.current)return null;const n=null===(e=y.current)||void 0===e||null===(t=e.textarea)||void 0===t?void 0:t.closest(".euiMarkdownEditor");return{...y.current,toolbar:null==n?void 0:n.querySelector(".euiMarkdownEditorToolbar")}})),i.a.createElement(r.EuiMarkdownEditor,{ref:y,"aria-label":n,editorId:l,onChange:e,value:t,uiPlugins:h,parsingPluginList:s.a,processingPluginList:s.c,onParse:b,errors:f,"data-test-subj":u,height:c})}));l.displayName="MarkdownEditorComponent";const u=Object(a.memo)(l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return v}));var a=n(17),i=n(61),r=n.n(i),s=n(2),o=n.n(s),l=n(44),u=n.n(l),c=n(49),d=n(4),p=n(382),m=n(121),f=n(116);const g=u()(a.EuiModal).withConfig({displayName:"MyEuiModal",componentId:"sc-67qpo8-0"})(["width:min(768px,calc(100vw - 16px));min-height:41vh;.euiModal__flex{width:60vw;}.euiCodeBlock{height:auto !important;max-width:718px;}"]);g.displayName="MyEuiModal";const b=function(e){try{return e.map((e=>JSON.parse(e)))}catch{return[]}},y=(e=[])=>1===e.length&&e[0]===d.Vb?o.a.createElement("i",null,p.f):e.length>0?e.filter((e=>e!==d.Vb)).join(", "):p.k,v=({adHocDataViews:e,additionalRequests:t,additionalResponses:n,closeModal:i,inputId:l,request:u,response:d,title:v})=>{var h,E,x,j;const{pathname:O}=Object(c.useLocation)(),{selectedPatterns:S}=Object(m.d)("timeline"===l?f.SourcererScopeName.timeline:Object(m.a)(O)),k=[u,...null!=t?t:[]],w=[d,...null!=n?n:[]],T=b(k),I=b(w),C=Object(s.useMemo)((()=>{var e,t;return(null!==(e=null===(t=T[0])||void 0===t?void 0:t.index)&&void 0!==e?e:[]).every((e=>S.includes(e.trim())))}),[T,S]),M=[{title:o.a.createElement("span",{"data-test-subj":"index-pattern-title"},p.b," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:p.c,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"index-pattern-description"},o.a.createElement("p",null,y(null!=e&&e.length>0?e:null!==(h=null===(E=T[0])||void 0===E?void 0:E.index)&&void 0!==h?h:[])),!C&&o.a.createElement("p",null,o.a.createElement("small",null,o.a.createElement("i",{"data-test-subj":"not-sourcerer-msg"},p.e))))},{title:o.a.createElement("span",{"data-test-subj":"query-time-title"},p.g," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:p.h,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"query-time-description"},0===(null===(x=I[0])||void 0===x?void 0:x.took)?"0ms":null!==(j=I[0])&&void 0!==j&&j.took?`${r()(I[0].took).format("0,0")}ms`:p.k)},{title:o.a.createElement("span",{"data-test-subj":"request-timestamp-title"},p.i," ",o.a.createElement(a.EuiIconTip,{color:"subdued",content:p.j,type:"iInCircle"})),description:o.a.createElement("span",{"data-test-subj":"request-timestamp-description"},(new Date).toISOString())}],_=[{id:"statistics",name:"Statistics",content:o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiDescriptionList,{listItems:M,type:"responsiveColumn",columnWidths:[3,7]}))},{id:"request",name:"Request",content:T.length>0?T.map(((e,t)=>o.a.createElement(s.Fragment,{key:t},o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},(e=>{try{return JSON.stringify(e,null,2)}catch{return p.k}})(e.body))))):o.a.createElement(a.EuiCodeBlock,null,p.k)},{id:"response",name:"Response",content:I.length>0?w.map(((e,t)=>o.a.createElement(s.Fragment,{key:t},o.a.createElement(a.EuiSpacer,null),o.a.createElement(a.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"m",color:"dark",overflowHeight:300,isCopyable:!0},e)))):o.a.createElement(a.EuiCodeBlock,null,p.k)}];return o.a.createElement(g,{onClose:i,"data-test-subj":"modal-inspect-euiModal"},o.a.createElement(a.EuiModalHeader,null,o.a.createElement(a.EuiModalHeaderTitle,null,p.d," ",v)),o.a.createElement(a.EuiModalBody,null,o.a.createElement(a.EuiTabbedContent,{tabs:_,initialSelectedTab:_[0],autoFocus:"selected"})),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButton,{onClick:i,fill:!0,"data-test-subj":"modal-inspect-close"},p.a)))}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"k",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"f",(function(){return f}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.inspectDescription",{defaultMessage:"Inspect"}),r=a.i18n.translate("xpack.securitySolution.inspect.modal.closeTitle",{defaultMessage:"Close"}),s=a.i18n.translate("xpack.securitySolution.inspect.modal.somethingWentWrongDescription",{defaultMessage:"Sorry about that, something went wrong."}),o=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternLabel",{defaultMessage:"Index pattern"}),l=a.i18n.translate("xpack.securitySolution.inspect.modal.indexPatternDescription",{defaultMessage:"The index pattern that connected to the Elasticsearch indices. These indices can be configured in Kibana > Advanced Settings."}),u=a.i18n.translate("xpack.securitySolution.inspectPatternDifferent",{defaultMessage:"This element has a unique index pattern separate from the data view setting."}),c=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeLabel",{defaultMessage:"Query time"}),d=a.i18n.translate("xpack.securitySolution.inspect.modal.queryTimeDescription",{defaultMessage:"The time it took to process the query. Does not include the time to send the request or parse it in the browser."}),p=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampLabel",{defaultMessage:"Request timestamp"}),m=a.i18n.translate("xpack.securitySolution.inspect.modal.reqTimestampDescription",{defaultMessage:"Time when the start of the request has been logged"}),f=a.i18n.translate("xpack.securitySolution.inspect.modal.noAlertIndexFound",{defaultMessage:"No alert index found"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"c",(function(){return c}));var a=n(62),i=n(45),r=n(283);const s=e=>e.toLocaleString(),o=({chartHeight:e,from:t,legendPosition:n,to:i,onBrushEnd:o,yTickFormatter:l,showLegend:u})=>({series:{xScaleType:a.ScaleType.Time,yScaleType:a.ScaleType.Linear,stackAccessors:["g"]},axis:{xTickFormatter:Object(r.a)([t,i]),yTickFormatter:null!=l?l:s,tickSize:8},settings:{legendPosition:null!=n?n:a.Position.Right,onBrushEnd:o,showLegend:null==u||u,showLegendExtra:!0,theme:{scales:{barsPadding:.08},chartMargins:{left:0,right:0,top:0,bottom:0},chartPaddings:{left:0,right:0,top:0,bottom:0}}},customHeight:null!=e?e:174}),l=["#1EA593","#2B70F7","#CE0060","#38007E","#FCA5D3","#F37020","#E49E29","#B0916F","#7B000B","#34130C","#GGGGGG"],u=([e,t])=>({key:e,value:t}),c=(e,t)=>{if(!e)return[];const n=Object(i.groupBy)("g",e),a=Object(i.toPairs)(n);return Object(i.map)(u,a).map(((e,n)=>{var a;const r=Object(i.get)(e.key,t);return{...e,color:null!==(a=null==r?void 0:r.color)&&void 0!==a?a:l[n]}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"k",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"m",(function(){return g})),n.d(t,"n",(function(){return b})),n.d(t,"o",(function(){return y})),n.d(t,"p",(function(){return v})),n.d(t,"f",(function(){return h}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.addToCaseSuccessToast",{defaultMessage:"Successfully added data quality results to the case"}),r=(a.i18n.translate("xpack.securitySolution.dataQualityDashboard.betaBadge",{defaultMessage:"Beta"}),a.i18n.translate("xpack.securitySolution.overview.ilmPhaseCold",{defaultMessage:"cold"})),s=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.pageTitle",{defaultMessage:"Data Quality"}),o=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.datePicker.tooltip",{defaultMessage:"Data quality checks are ran on data that was ingested during the Search Boost window. The default window range is 7 days."}),l=a.i18n.translate("xpack.securitySolution.dataQualityDashboard.elasticCommonSchemaReferenceLink",{defaultMessage:"Elastic Common Schema (ECS)"}),u=(a.i18n.translate("xpack.securitySolution.overview.eventsTitle",{defaultMessage:"Event count"}),a.i18n.translate("xpack.securitySolution.overview.ilmPhaseFrozen",{defaultMessage:"frozen"})),c=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseHot",{defaultMessage:"hot"}),d=a.i18n.translate("xpack.securitySolution.overview.newsFeedSidebarTitle",{defaultMessage:"Security news"}),p=a.i18n.translate("xpack.securitySolution.overview.recentTimelinesSidebarTitle",{defaultMessage:"Recent timelines"}),m=a.i18n.translate("xpack.securitySolution.overview.signalCountTitle",{defaultMessage:"Alert trend"}),f=e=>a.i18n.translate("xpack.securitySolution.overview.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}),g=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseUnmanaged",{defaultMessage:"unmanaged"}),b=a.i18n.translate("xpack.securitySolution.overview.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),y=a.i18n.translate("xpack.securitySolution.overview.viewEventsButtonLabel",{defaultMessage:"View events"}),v=a.i18n.translate("xpack.securitySolution.overview.ilmPhaseWarm",{defaultMessage:"warm"}),h=a.i18n.translate("xpack.securitySolution.detectionResponse.pageTitle",{defaultMessage:"Detection & Response"});a.i18n.translate("xpack.securitySolution.entityAnalytics.technicalPreviewLabel",{defaultMessage:"Technical Preview"})},,,function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return y})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return j})),n.d(t,"h",(function(){return S})),n.d(t,"i",(function(){return w})),n.d(t,"j",(function(){return I})),n.d(t,"k",(function(){return M})),n.d(t,"l",(function(){return A}));var a=n(280),i=n(169);const r=e=>Object(a.flow)(s)(e),s=e=>{const t=e.entries.map((e=>"nested"===e.type?Object(i.d)({...e,entries:e.entries.map((e=>Object(i.d)(e)))}):Object(i.d)(e)));return{...e,entries:t}},o=e=>{const{entries:t}=e,n=t.map((e=>"nested"===e.type?Object(i.j)({...e,entries:e.entries.map((e=>Object(i.j)(e)))}):Object(i.j)(e)));return{...e,entries:n}},l=e=>{const{comments:t}=e;if(!t||!t.length)return e;const n=t.map((({comment:e,id:t})=>({comment:e,id:t})));return{...e,comments:n}};var u=n(2),c=n(165),d=n(350);const p=e=>Object(u.useMemo)((()=>({async addExceptionListItem({listItem:t}){const n=new AbortController,i=(r=t,Object(a.flow)(o)(r));var r;return c.b({http:e,listItem:i,signal:n.signal})},async deleteExceptionItem({id:t,namespaceType:n,onSuccess:a,onError:i}){const r=new AbortController;try{await c.e({http:e,id:t,namespaceType:n,signal:r.signal}),a()}catch(e){i(e)}},async deleteExceptionList({id:t,namespaceType:n,onSuccess:a,onError:i}){const r=new AbortController;try{await c.d({http:e,id:t,namespaceType:n,signal:r.signal}),a()}catch(e){i(e)}},async duplicateExceptionList({includeExpiredExceptions:t,listId:n,namespaceType:a,onError:i,onSuccess:r}){const s=new AbortController;try{r(await c.g({http:e,includeExpiredExceptions:t,listId:n,namespaceType:a,signal:s.signal}))}catch(e){i(e)}},async exportExceptionList({id:t,includeExpiredExceptions:n,listId:a,namespaceType:i,onError:r,onSuccess:s}){const o=new AbortController;try{s(await c.h({http:e,id:t,includeExpiredExceptions:n,listId:a,namespaceType:i,signal:o.signal}))}catch(e){r(e)}},async getExceptionItem({id:t,namespaceType:n,onSuccess:a,onError:i}){const s=new AbortController;try{a(r(await c.k({http:e,id:t,namespaceType:n,signal:s.signal})))}catch(e){i(e)}},async getExceptionList({id:t,namespaceType:n,onSuccess:a,onError:i}){const r=new AbortController;try{a(await c.j({http:e,id:t,namespaceType:n,signal:r.signal}))}catch(e){i(e)}},async getExceptionListsItems({lists:t,filter:n,pagination:a,showDetectionsListsOnly:i,showEndpointListsOnly:s,onSuccess:o,onError:l}){const u=new AbortController,{ids:p,namespaces:m}=Object(d.i)({lists:t,showDetection:i,showEndpoint:s});try{if(p.length>0&&m.length>0){const{data:t,page:i,per_page:s,total:l}=await c.m({filter:n,http:e,listIds:p,namespaceTypes:m,pagination:a,signal:u.signal});o({exceptions:t.map((e=>r(e))),pagination:{page:i,perPage:s,total:l}})}else o({exceptions:[],pagination:{page:0,perPage:null!=a.perPage?a.perPage:0,total:0}})}catch(e){l(e)}},async getExceptionFilterFromIds({exceptionListIds:t,chunkSize:n,alias:a,excludeExceptions:i,onSuccess:r,onError:s}){const o=new AbortController;try{const{filter:s}=await c.p({http:e,exceptionListIds:t,signal:o.signal,chunkSize:n,alias:a,excludeExceptions:i});r(s)}catch(e){s(e)}},async getExceptionFilterFromExceptions({exceptions:t,chunkSize:n,alias:a,excludeExceptions:i,onSuccess:r,onError:s}){const o=new AbortController;try{const{filter:s}=await c.q({http:e,exceptions:t,signal:o.signal,chunkSize:n,alias:a,excludeExceptions:i});r(s)}catch(e){s(e)}},async updateExceptionListItem({listItem:t}){const n=new AbortController,i=(r=t,Object(a.flow)(l,o)(r));var r;return c.v({http:e,listItem:i,signal:n.signal})}})),[e]);var m=n(152);const f=Object(m.d)(c.c),g=()=>Object(m.a)(f),b=e=>JSON.stringify(e),y=({pageIndex:e,pageSize:t})=>{const[n,a]=Object(u.useState)({}),i=Object(u.useCallback)((i=>{a({...n,[b({pageIndex:e+1,pageSize:t})]:i})}),[e,t]);let r;for(let a=e;a>=0&&(r=n[b({pageIndex:a,pageSize:t})],!r);a--);return[r,i]},v=Object(m.d)(c.f),h=()=>Object(m.a)(v),E={page:1,perPage:20,total:0},x={field:"created_at",order:"desc"},j=({errorMessage:e,http:t,initialPagination:n=E,filterOptions:a={},namespaceTypes:i,notifications:r,hideLists:s=[],initialSort:o=x})=>{const[l,p]=Object(u.useState)([]),[m,f]=Object(u.useState)(n),[g,b]=Object(u.useState)(o),[y,v]=Object(u.useState)(!0),h=Object(u.useRef)(),j=Object(u.useMemo)((()=>i.join(",")),[i]),O=Object(u.useMemo)((()=>Object(d.h)({filters:a,namespaceTypes:i,hideLists:s})),[i,a,s]),S=Object(u.useCallback)((async()=>{try{v(!0),h.current=new AbortController;const{page:e,per_page:n,total:a,data:i}=await Object(c.l)({filters:O,http:t,namespaceTypes:j,pagination:{page:m.page,perPage:m.perPage},sort:g,signal:h.current.signal});f({page:e,perPage:n,total:a}),p(i),v(!1)}catch(t){"AbortError"!==t.name&&(r.toasts.addError(t,{title:e}),p([]),f(E),v(!1))}}),[e,O,t,j,r.toasts,m.page,m.perPage,g]);return Object(u.useEffect)((()=>(S(),()=>{var e;null===(e=h.current)||void 0===e||e.abort()})),[S]),[y,l,m,f,S,g,b]},O=(Object(m.d)(c.i),Object(m.d)(c.n)),S=()=>Object(m.a)(O),k=Object(m.d)(c.o),w=()=>Object(m.a)(k),T=Object(m.d)(c.r),I=()=>Object(m.a)(T),C=Object(m.d)(c.s),M=()=>Object(m.a)(C),_=Object(m.d)(c.t),A=()=>Object(m.a)(_)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n(45),n(51);const a=({allowSet:e,field:t})=>e.has(t),i=({allowSet:e,field:t})=>!e.has(t),r=({allowReplacementSet:e,field:t})=>e.has(t),s=({allowSet:e,allowReplacementSet:t,currentReplacements:n,field:i,getAnonymizedValue:s,rawData:o})=>{var l;return(null!==(l=o[i])&&void 0!==l?l:[]).reduce(((o,l)=>{const u=`${l}`;if(a({allowSet:e,field:i})&&r({allowReplacementSet:t,field:i})){const e=`${s({currentReplacements:n,rawValue:u})}`;return{anonymizedValues:[...o.anonymizedValues,e],replacements:{...o.replacements,[e]:u}}}return a({allowSet:e,field:i})?{anonymizedValues:[...o.anonymizedValues,u],replacements:{...o.replacements}}:o}),{anonymizedValues:[],replacements:{}})},o=({allow:e,allowReplacement:t,currentReplacements:n,getAnonymizedValue:i,onNewReplacements:r,rawData:o})=>{if("string"==typeof o)return o;const l=(({allow:e,allowReplacement:t,currentReplacements:n,getAnonymizedValue:i,getAnonymizedValues:r,rawData:s})=>Object.keys(s).reduce(((o,l)=>{const u=new Set(t),c=new Set(e);if(a({allowSet:c,field:l})){const{anonymizedValues:e,replacements:t}=r({allowReplacementSet:u,allowSet:c,currentReplacements:n,field:l,getAnonymizedValue:i,rawData:s});return{anonymizedData:{...o.anonymizedData,[l]:e},replacements:{...o.replacements,...t}}}return o}),{anonymizedData:{},replacements:{}}))({allow:e,allowReplacement:t,currentReplacements:n,rawData:o,getAnonymizedValue:i,getAnonymizedValues:s});return null!=r&&r(l.replacements),u=l.anonymizedData,Object.keys(u).sort().map((e=>`${e},${u[e].join(",")}`)).join("\n");var u}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(46),i=n(139),r=n(120);a.exact(a.type({id:r.q})),a.exact(a.type({items:a.array(i.i)})),a.exact(a.type({name:a.string,description:a.string}));var s=n(278);a.intersection([a.exact(a.type({namespace_types:i.a})),a.exact(a.partial({ids:r.k,list_ids:r.k}))]);const o=a.exact(a.type({name:s.t,id:s.v,rule_id:s.y,exception_lists:i.y})),l=a.intersection([i.o,a.exact(a.type({referenced_rules:a.array(o)}))]),u=a.record(i.B,l);a.exact(a.type({references:a.array(u)}));var c=n(4);const d=`${c.Db}/rules`,p=(c.jb,`${d}/exceptions/_find_references`)},function(e,t,n){"use strict";n.d(t,"b",(function(){return x})),n.d(t,"a",(function(){return j.a}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(45),l=n(17),u=n(461),c=n.n(u),d=n(47),p=n(542);const m=({disableLinks:e,href:t,target:n,children:a,...i})=>s.a.createElement(l.EuiToolTip,{content:t},s.a.createElement(l.EuiLink,{href:e?void 0:t,"data-test-subj":"markdown-link",rel:"nofollow",target:"_blank"},a)),f=Object(r.memo)(m);var g=n(110),b=n(18),y=n(5);const v=y.i18n.translate("xpack.securitySolution.markdown.platinumWarning",{defaultMessage:"The following markdown may make use of subscription features"}),h=y.i18n.translate("xpack.securitySolution.markdown.invalid",{defaultMessage:"Invalid markdown detected"}),E=({children:e,disableLinks:t,textSize:n="m"})=>{const a=Object(r.useMemo)((()=>e=>s.a.createElement(f,i()({},e,{disableLinks:t}))),[t]),u=Object(o.cloneDeep)(p.c);u[1][1].components.a=a;const m=Object(b.b)().isAtLeast("platinum"),{application:y}=Object(g.i)().services,E=Object(r.useMemo)((()=>{if(!1===m){const t=String(e);return p.b.some((e=>new RegExp(e).test(t)))}return!1}),[e,m]),x=Object(r.useMemo)((()=>c()().use(p.a).use(u)),[u]),j=Object(r.useMemo)((()=>{try{return x.processSync(e),null}catch(e){return String(e.message)}}),[e,x]);return s.a.createElement(s.a.Fragment,null,E&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.EuiCallOut,{title:v,color:"primary",iconType:"lock"},s.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkPrefix",defaultMessage:"To use these interactive markdown features, you must {link}.",values:{link:s.a.createElement(l.EuiLink,{href:y.getUrlForApp("management",{path:"stack/license_management/home"})},s.a.createElement(d.FormattedMessage,{id:"xpack.securitySolution.markdown.premiumPluginLinkSuffix",defaultMessage:"start a trial or upgrade your subscription"}))}})),s.a.createElement(l.EuiSpacer,{size:"s"})),null!==j&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.EuiCallOut,{title:h,color:"danger",iconType:"error"},j),s.a.createElement(l.EuiSpacer,{size:"s"})),s.a.createElement(l.EuiMarkdownFormat,{parsingPluginList:p.a,processingPluginList:u,textSize:n},e))};E.displayName="MarkdownRendererComponent";const x=Object(r.memo)(E);var j=n(380);n(463)},function(e,t,n){e.exports=n(24)(652)},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return u}));var a=n(9),i=n(116),r=n(295);const s=(e,t,n)=>{switch(e){case i.SourcererScopeName.default:return Object(r.b)(t.filter((e=>e!==n)));case i.SourcererScopeName.detections:return null!=n?[n]:[];case i.SourcererScopeName.timeline:return Object(r.b)(t)}},o=(e,t,n,a)=>{const i=null!=e&&null!==e.id?e.patternList:[];return a?s(t,i,n):Object(r.b)(i)},l=(e,t,n)=>{var l;const{id:u,...c}=t,d=e.kibanaDataViews.find((e=>e.id===c.selectedDataViewId)),p=Object(r.a)(c.selectedPatterns);let m=[];if(null==d||d.id===e.defaultDataView.id){const t=Object(r.a)((null!=d?d:e.defaultDataView).title.split(","));m=p.filter((e=>!t.includes(e)))}let f=n&&null!=d&&0===m.length&&d.id!==e.defaultDataView.id&&d.patternList.length>0?p.filter((t=>null!=d&&d.patternList.includes(t)||null==e.signalIndexName||e.signalIndexName===t)):p;const g=e.signalIndexName;return f=s(u,f,g),{[u]:{...e.sourcererScopes[u],...c,selectedDataViewId:null!==(l=null==d?void 0:d.id)&&void 0!==l?l:null,selectedPatterns:f,missingPatterns:m,...Object(a.isEmpty)(f)&&u!==i.SourcererScopeName.timeline?{selectedPatterns:o(null!=d?d:e.defaultDataView,u,e.signalIndexName,(null!=d?d:e.defaultDataView).id===e.defaultDataView.id)}:{},loading:!1}}},u=({patternList:e,scopeId:t,signalIndexName:n,isDefaultDataViewSelected:a})=>t===i.SourcererScopeName.detections?e.includes(`${n}`):t===i.SourcererScopeName.default&&a?e.filter((e=>e!==n)).length>0:e.length>0},function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return y}));var a=n(45),i=n(234),r=n.n(i),s=n(2),o=n(48),l=n(446),u=n(119),c=n(480),d=n(138),p=n(585),m=n(113),f=n(193);const g="FETCH_ALL_TIMELINES",b=r()(((e,t)=>t.map((e=>{var t;return{created:e.created,description:e.description,eventIdToNoteIds:null!=e.eventIdToNoteIds?e.eventIdToNoteIds.reduce(((e,t)=>{if(null!=t.eventId){const n=Object(a.getOr)([],t.eventId,e);return{...e,[t.eventId]:[...n,t.noteId]}}return e}),{}):null,excludedRowRendererIds:e.excludedRowRendererIds,favorite:e.favorite,noteIds:e.noteIds,notes:null!=e.notes?e.notes.map((e=>({...e,savedObjectId:e.noteId}))):null,pinnedEventIds:null!=e.pinnedEventIds?e.pinnedEventIds.reduce(((e,t)=>({...e,[t]:!0})),{}):null,savedObjectId:e.savedObjectId,savedSearchId:e.savedSearchId,status:e.status,title:e.title,updated:e.updated,updatedBy:e.updatedBy,timelineType:null!==(t=e.timelineType)&&void 0!==t?t:m.l.default,templateTimelineId:e.templateTimelineId,queryType:Object(l.b)(e)}})))),y=()=>{const e=Object(o.useDispatch)(),[,t]=Object(c.f)(),[n,a]=Object(s.useState)({loading:!1,totalCount:0,timelines:null,customTemplateTimelineCount:0,defaultTimelineCount:0,elasticTemplateTimelineCount:0,templateTimelineCount:0,favoriteCount:0}),i=Object(s.useCallback)((async({onlyUserFavorite:n,pageInfo:i,search:r,sort:s,status:o,timelineType:l})=>{let m=!1;const y=new AbortController,v=async()=>{try{var h,E,x,j,O,S,k;a((e=>({...e,loading:!0})));const t={onlyUserFavorite:n,pageInfo:i,search:r,sort:s,status:o,timelineType:l},c=await Object(f.d)(t,y.signal),p=null!==(h=null==c?void 0:c.totalCount)&&void 0!==h?h:0,w=null!==(E=null==c?void 0:c.timeline)&&void 0!==E?E:[],T=null!==(x=null==c?void 0:c.customTemplateTimelineCount)&&void 0!==x?x:0,I=null!==(j=null==c?void 0:c.defaultTimelineCount)&&void 0!==j?j:0,C=null!==(O=null==c?void 0:c.elasticTemplateTimelineCount)&&void 0!==O?O:0,M=null!==(S=null==c?void 0:c.templateTimelineCount)&&void 0!==S?S:0,_=null!==(k=null==c?void 0:c.favoriteCount)&&void 0!==k?k:0;m||(e(d.b.setQuery({inputId:u.a.global,id:g,loading:!1,refetch:v,inspect:null})),a({loading:!1,totalCount:p,timelines:b(JSON.stringify(t),w),customTemplateTimelineCount:T,defaultTimelineCount:I,elasticTemplateTimelineCount:C,templateTimelineCount:M,favoriteCount:_}))}catch(e){m||(Object(c.e)({title:p.c,error:e.body&&e.body.message?new Error(e.body.message):e,dispatchToaster:t}),a({loading:!1,totalCount:0,timelines:[],customTemplateTimelineCount:0,defaultTimelineCount:0,elasticTemplateTimelineCount:0,templateTimelineCount:0,favoriteCount:0}))}};return v(),()=>{m=!0,y.abort()}}),[e,t]);return Object(s.useEffect)((()=>()=>{e(d.b.deleteOneQuery({inputId:u.a.global,id:g}))}),[e]),{...n,fetchAllTimeline:i}}},,function(e,t,n){"use strict";n.d(t,"c",(function(){return p})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a,i=n(2),r=n(67),s=(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o="html",l="svg",u=function(e,t){var n,a,i,r={};if(e===o)i=document.createElement("div");else{if(e!==l)throw new Error('Invalid element type "'+e+'" for createPortalNode: must be "html" or "svg".');i=document.createElementNS("http://www.w3.org/2000/svg","g")}if(t&&"object"==typeof t)for(var s=0,u=Object.entries(t.attributes);s<u.length;s++){var c=u[s],d=c[0],p=c[1];i.setAttribute(d,p)}var m={element:i,elementType:e,setPortalProps:function(e){r=e},getInitialPortalProps:function(){return r},mount:function(t,i){if(i!==a){if(m.unmount(),t!==n&&!function(e,t){if(t===o)return e instanceof HTMLElement;if(t===l)return e instanceof SVGElement;throw new Error('Unrecognized element type "'+t+'" for validateElementType.')}(t,e))throw new Error('Invalid element type for portal: "'+e+'" portalNodes must be used with '+e+" elements, but OutPortal is within <"+t.tagName+">.");t.replaceChild(m.element,i),n=t,a=i}},unmount:function(e){e&&e!==a||n&&a&&(n.replaceChild(a,m.element),n=void 0,a=void 0)}};return m},c=function(e){function t(t){var n=e.call(this,t)||this;return n.addPropsChannel=function(){Object.assign(n.props.node,{setPortalProps:function(e){n.setState({nodeProps:e})}})},n.state={nodeProps:n.props.node.getInitialPortalProps()},n}return s(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,n=t.children,a=t.node;return r.createPortal(i.Children.map(n,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),a.element)},t}(i.PureComponent),d=function(e){function t(t){var n=e.call(this,t)||this;return n.placeholderNode=i.createRef(),n.passPropsThroughPortal(),n}return s(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node;this.currentPortalNode=e;var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node;this.currentPortalNode&&e!==this.currentPortalNode&&(this.currentPortalNode.unmount(this.placeholderNode.current),this.currentPortalNode=e);var t=this.placeholderNode.current,n=t.parentNode;e.mount(n,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent),p=u.bind(null,o);u.bind(null,l)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n(48),r=n(112),s=n(110),o=n(128),l=n(181),u=n(119);const c=({inputId:e,queryId:t,skip:n})=>{const c=Object(i.useDispatch)(),{data:d}=Object(s.i)().services,p=Object(a.useRef)(d.search.session),m=o.d.globalQueryByIdSelector(),f=o.d.timelineQueryByIdSelector(),{selectedInspectIndex:g}=Object(r.a)((n=>e===u.a.global?m(n,t):f(n,t))),b=Object(a.useCallback)((()=>{const e=p.current.start();c(l.c.setInspectionParameter({id:t,selectedInspectIndex:g,isInspected:!1,inputId:u.a.global,searchSessionId:n?void 0:e}))}),[c,t,g,n]),y=Object(a.useCallback)((()=>{c(l.c.deleteOneQuery({inputId:u.a.global,id:t}))}),[c,t]);return{session:p,refetchByRestartingSession:b,refetchByDeletingSession:y}}},function(e,t,n){"use strict";n.d(t,"i",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"o",(function(){return d})),n.d(t,"n",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"m",(function(){return f})),n.d(t,"l",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return y})),n.d(t,"g",(function(){return v}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.locationTitle",{defaultMessage:"Location"}),r=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.autonomousSystemTitle",{defaultMessage:"Autonomous system"}),s=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.maxAnomalyScoreByJobTitle",{defaultMessage:"Max anomaly score by job"}),o=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.firstSeenTitle",{defaultMessage:"First seen"}),l=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.lastSeenTitle",{defaultMessage:"Last seen"}),u=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostIdTitle",{defaultMessage:"Host ID"}),c=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.hostNameTitle",{defaultMessage:"Host name"}),d=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.whoIsTitle",{defaultMessage:"WhoIs"}),p=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewWhoisTitle",{defaultMessage:"iana.org"}),m=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.ipReputationTitle",{defaultMessage:"Reputation"}),f=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewVirusTotalTitle.",{defaultMessage:"virustotal.com"}),g=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.viewTalosIntelligenceTitle",{defaultMessage:"talosIntelligence.com"}),b=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asSourceDropDownOptionLabel",{defaultMessage:"As Source"}),y=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.asDestinationDropDownOptionLabel",{defaultMessage:"As Destination"}),v=a.i18n.translate("xpack.securitySolution.network.ipDetails.ipOverview.inspectTitle",{defaultMessage:"IP overview"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return p}));var a=n(2),i=n(49),r=n(5),s=n(117),o=n(121),l=n(241),u=n(728);const c=({setQuery:e,response:t,request:n,refetch:i,uniqueQueryId:r,deleteQuery:s,loading:o,searchSessionId:l})=>{Object(a.useEffect)((()=>(null!=i&&null!=e&&e({id:r,inspect:{dsl:[n],response:[t]},loading:o,refetch:i,searchSessionId:l}),()=>{s&&s({id:r})})),[e,o,t,n,i,r,s,l])};function d(e){var t;const n=null==e?void 0:e.subType;return!(null==n||null===(t=n.nested)||void 0===t||!t.path)}const p=e=>{const{pathname:t}=Object(i.useLocation)(),{addError:n}=Object(s.a)(),{browserFields:c}=Object(o.d)(Object(o.a)(t));return Object(a.useCallback)((()=>{try{return function(e,t){const n=[];for(const[a,i]of Object.entries(e))t?i.aggregatable&&Object(u.a)(i.type)&&!d(i)&&n.push({label:a,value:a}):!0===i.aggregatable&&n.push({label:a,value:a});return n}(Object(l.a)(c),e)}catch(e){return n(e,{title:r.i18n.translate("xpack.securitySolution.useStackByFields.error.title",{defaultMessage:"Error fetching fields"}),toastMessage:r.i18n.translate("xpack.securitySolution.useStackByFields.error.toastMessage",{defaultMessage:"This error indicates an exceedingly large number of fields in an index"})}),[]}}),[n,c,e])}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return l}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByLabel",{defaultMessage:"Group by"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByPlaceholder",{defaultMessage:"Select a field to stack by"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.stackByAriaLabel",{defaultMessage:"Stack the alerts histogram by a field value"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.stackByOptions.groupByTopLabel",{defaultMessage:"Group by top"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"i",(function(){return f}));var a=n(142),i=n(124),r=n(357);const s=e=>{const t="acknowledged"===e?{bool:{should:[{term:{[a.ob]:e}},{term:{[a.ob]:"in-progress"}}]}}:{term:{[a.ob]:e}};return[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:a.ob,params:{query:e}},query:t}]},o=e=>[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>({term:{[a.ob]:e}})))}}}],l=e=>e?[{meta:{alias:null,negate:!1,disabled:!1,type:"phrase",key:a.N,params:{query:e}},query:{match_phrase:{[a.N]:e}}}]:[],u=e=>e?[]:[{meta:{alias:null,negate:!0,disabled:!1,type:"exists",key:a.b,value:"exists"},query:{exists:{field:a.b}}}],c=e=>e?[{meta:{alias:null,disabled:!1,negate:!1,key:"kibana.alert.rule.type",type:"term"},query:{term:{"kibana.alert.rule.type":"threat_match"}}}]:[],d=e=>e.length?[{meta:{alias:null,negate:!1,disabled:!1},query:{bool:{should:e.map((e=>e?{term:{[a.mb]:e}}:{bool:{must_not:{exists:{field:a.mb}}}}))}}}]:[],p=e=>({...i.q,columns:Object(r.c)(e),showCheckboxes:!0}),m=e=>({...p(e),columns:Object(r.d)(e),defaultColumns:Object(r.d)(e),sort:[{columnId:"kibana.alert.original_time",columnType:"date",esTypes:["date"],sortDirection:"desc"}],showCheckboxes:!1}),f=["@timestamp","kibana.alert.workflow_status","kibana.alert.workflow_tags","kibana.alert.workflow_assignee_ids","kibana.alert.group.id","kibana.alert.original_time","kibana.alert.building_block_type","kibana.alert.rule.from","kibana.alert.rule.name","kibana.alert.rule.to","kibana.alert.rule.uuid","kibana.alert.rule.rule_id","kibana.alert.rule.type","kibana.alert.suppression.docs_count","kibana.alert.original_event.kind","kibana.alert.original_event.module","file.path","file.Ext.code_signature.subject_name","file.Ext.code_signature.trusted","file.hash.sha256","host.os.family","event.code","process.entry_leader.entity_id"]},function(e,t,n){"use strict";n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return r})),n.d(t,"g",(function(){return s})),n.d(t,"h",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"k",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"p",(function(){return g})),n.d(t,"q",(function(){return b})),n.d(t,"r",(function(){return y})),n.d(t,"u",(function(){return v})),n.d(t,"t",(function(){return h})),n.d(t,"v",(function(){return E})),n.d(t,"x",(function(){return x})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return O})),n.d(t,"w",(function(){return S})),n.d(t,"s",(function(){return k})),n.d(t,"m",(function(){return w})),n.d(t,"l",(function(){return T}));var a=n(5);a.i18n.translate("xpack.securitySolution.dataProviders.and",{defaultMessage:"AND"});const i=a.i18n.translate("xpack.securitySolution.dataProviders.deleteDataProvider",{defaultMessage:"Delete"}),r=a.i18n.translate("xpack.securitySolution.dataProviders.dropAnything",{defaultMessage:"Drop anything"}),s=(a.i18n.translate("xpack.securitySolution.dataProviders.edit",{defaultMessage:"Edit"}),a.i18n.translate("xpack.securitySolution.dataProviders.editMenuItem",{defaultMessage:"Edit filter"})),o=a.i18n.translate("xpack.securitySolution.dataProviders.editTitle",{defaultMessage:"EDIT FILTER"}),l=a.i18n.translate("xpack.securitySolution.dataProviders.excludeDataProvider",{defaultMessage:"Exclude results"}),u=a.i18n.translate("xpack.securitySolution.dataProviders.existsLabel",{defaultMessage:"exists"}),c=(a.i18n.translate("xpack.securitySolution.dataProviders.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dataProviders.filterForFieldPresentLabel",{defaultMessage:"Filter for field present"})),d=a.i18n.translate("xpack.securitySolution.dataProviders.convertToFieldLabel",{defaultMessage:"Convert to field"}),p=a.i18n.translate("xpack.securitySolution.dataProviders.convertToTemplateFieldLabel",{defaultMessage:"Convert to template field"}),m=a.i18n.translate("xpack.securitySolution.dataProviders.highlighted",{defaultMessage:"highlighted"}),f=a.i18n.translate("xpack.securitySolution.dataProviders.hereToBuildAn",{defaultMessage:"here to build an"}),g=a.i18n.translate("xpack.securitySolution.dataProviders.includeDataProvider",{defaultMessage:"Include results"}),b=a.i18n.translate("xpack.securitySolution.dataProviders.not",{defaultMessage:"NOT"}),y=(a.i18n.translate("xpack.securitySolution.dataProviders.or",{defaultMessage:"or"}),a.i18n.translate("xpack.securitySolution.dataProviders.query",{defaultMessage:"query"})),v=(a.i18n.translate("xpack.securitySolution.dataProviders.toggle",{defaultMessage:"toggle"}),a.i18n.translate("xpack.securitySolution.dataProviders.reEnableDataProvider",{defaultMessage:"Re-enable"})),h=a.i18n.translate("xpack.securitySolution.dataProviders.removeDataProvider",{defaultMessage:"Remove Data Provider"}),E=({field:e,value:t})=>a.i18n.translate("xpack.securitySolution.dataProviders.showOptionsDataProviderAriaLabel",{values:{field:e,value:t},defaultMessage:"{field} {value} Press enter for options, or press space to begin dragging"}),x=a.i18n.translate("xpack.securitySolution.dataProviders.temporaryDisableDataProvider",{defaultMessage:"Temporarily disable"}),j=(a.i18n.translate("xpack.securitySolution.dataProviders.valuePlaceholder",{defaultMessage:"value"}),a.i18n.translate("xpack.securitySolution.dataProviders.addFieldPopoverButtonLabel",{defaultMessage:"Add field"})),O=a.i18n.translate("xpack.securitySolution.dataProviders.addTemplateFieldPopoverButtonLabel",{defaultMessage:"Add template field"}),S=a.i18n.translate("xpack.securitySolution.dataProviders.templateFieldLabel",{defaultMessage:"Template field"}),k=a.i18n.translate("xpack.securitySolution.dataProviders.queryAreaAriaLabel",{defaultMessage:"You are in the timeline query area, which contains groups of data providers that query for events"}),w=e=>a.i18n.translate("xpack.securitySolution.dataProviders.groupAreaAriaLabel",{values:{group:e},defaultMessage:"You are in group {group}"}),T=a.i18n.translate("xpack.securitySolution.timeline.searchOrFilter.filterOrSearchWithKql",{defaultMessage:"Filter or Search with KQL"})},,function(e,t,n){"use strict";n.d(t,"e",(function(){return o.b})),n.d(t,"d",(function(){return o.a})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"c",(function(){return m}));var a=n(46);const i=a.record(a.string,a.string);let r,s;a.exact(a.partial({host:i,user:i})),function(e){e.global="global_identifier",e.riskCategory="risk_category"}(r||(r={})),function(e){e.category_1="category_1"}(s||(s={})),a.keyof({user:null,host:null}),a.type({start:a.string,end:a.string});var o=n(583);const l="risk-score",u=(e="default")=>`${l}.risk-score-latest-${e}`,c=(e="default")=>`${l}.risk-score-${e}`,d=1,p=["manage_index_templates","manage_transform"],m=Object.freeze({"risk-score.risk-score-*":["read","write"]})},function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return x}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(215),u=n(390),c=n(5);const d=c.i18n.translate("xpack.securitySolution.alertDetails.summary.readMore",{defaultMessage:"Read More"}),p=c.i18n.translate("xpack.securitySolution.alertDetails.summary.readLess",{defaultMessage:"Read Less"}),m=o()(a.EuiButtonEmpty).withConfig({displayName:"ReadMore",componentId:"sc-1cdn95f-0"})(["span.euiButtonContent{padding:0;}"]),f=o.a.div.withConfig({displayName:"ExpandedContent",componentId:"sc-1cdn95f-1"})(["max-height:33vh;overflow-wrap:break-word;overflow-x:hidden;overflow-y:auto;"]),g=o.a.div.withConfig({displayName:"StyledLineClamp",componentId:"sc-1cdn95f-2"})(["display:-webkit-box;-webkit-line-clamp:",";-webkit-box-orient:vertical;overflow:hidden;max-height:","em;height:","em;"],3,(({lineClampHeight:e})=>e),(({lineClampHeight:e})=>e)),b=({children:e,lineClampHeight:t=5.5})=>{const[n,a]=Object(i.useState)(null),[s,o]=(e=>{const[t,n]=Object(i.useState)(null),a=Object(i.useRef)(null);return Object(i.useEffect)((()=>{var e,t,i,r,s,o,l,u,c;null!=(null===(e=a.current)||void 0===e?void 0:e.clientHeight)&&((null!==(t=null==a||null===(i=a.current)||void 0===i?void 0:i.scrollHeight)&&void 0!==t?t:0)>(null!==(r=null==a||null===(s=a.current)||void 0===s?void 0:s.clientHeight)&&void 0!==r?r:0)&&n(!0),(null!==(o=null===(l=a.current)||void 0===l?void 0:l.scrollHeight)&&void 0!==o?o:0)<=(null!==(u=null==a||null===(c=a.current)||void 0===c?void 0:c.clientHeight)&&void 0!==u?u:0)&&n(!1))}),[a,e]),[t,a]})(e),l=Object(i.useCallback)((()=>{a((e=>!e))}),[]);return n?r.a.createElement(r.a.Fragment,null,r.a.createElement(f,{"data-test-subj":"expanded-line-clamp"},r.a.createElement("p",null,e)),s&&r.a.createElement(m,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},p)):r.a.createElement(r.a.Fragment,null,null==s||!0===s?r.a.createElement(g,{"data-test-subj":"styled-line-clamp",ref:o,lineClampHeight:t},e):e,s&&r.a.createElement(m,{onClick:l,size:"s","data-test-subj":"summary-view-readmore"},d))},y=r.a.memo(b),v=o.a.div.withConfig({displayName:"Indent",componentId:"sc-1pv3muo-0"})(["padding:0 8px;word-break:break-word;"]),h=Object(i.createContext)({}),E=({basicData:e,ruleNote:t,showFullView:n=!1,showTitle:i=!0})=>r.a.createElement(h.Provider,{value:e},i&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"l"}),r.a.createElement(a.EuiTitle,{size:"xxxs","data-test-subj":"summary-view-guide"},r.a.createElement("h5",null,l.q)),r.a.createElement(a.EuiSpacer,{size:"s"})),r.a.createElement(v,null,n?r.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-full-view"},r.a.createElement(u.b,null,t)):r.a.createElement(a.EuiText,{size:"xs","data-test-subj":"investigation-guide-clamped"},r.a.createElement(y,{lineClampHeight:4.5},r.a.createElement(u.b,null,t))))),x=r.a.memo(E)},function(e,t,n){"use strict";n.d(t,"a",(function(){return k})),n.d(t,"d",(function(){return w})),n.d(t,"e",(function(){return T})),n.d(t,"c",(function(){return C})),n.d(t,"b",(function(){return M}));var a=n(17),i=n(194),r=n(2),s=n.n(r),o=n(23),l=n.n(o),u=n(48),c=n(112),d=n(128),p=n(181),m=n(138),f=n(119),g=n(116),b=n(122),y=n(113),v=n(197),h=n(228),E=n(14),x=n(460),j=n(665),O=n(130);const S=({asEmptyButton:e,children:t,dataProviders:n,filters:o,timeRange:S,keepDataView:k,...w})=>{var T,I;const C=Object(u.useDispatch)(),{showAssistantOverlay:M}=Object(i.j)(),[_]=Object(j.a)(),{discoverStateContainer:A}=Object(x.a)(),P=Object(O.a)("timelineEsqlTabDisabled"),F=Object(r.useMemo)((()=>d.e.getSourcererDataViewsSelector()),[]),{defaultDataView:D,signalIndexName:N}=Object(c.a)((e=>F(e))),R=n&&n.find((e=>"template"===e.type)),L=Object(h.a)({timelineId:b.c.active,timelineType:R?y.l.template:y.l.default}),z=Object(r.useCallback)((()=>{if(M({showOverlay:!1}),n||o){var e,t,a;if("esql"===(null==n||null===(e=n[0])||void 0===e?void 0:e.queryType)||"sql"===(null==n||null===(t=n[0])||void 0===t?void 0:t.queryType))return null===(a=A.current)||void 0===a||a.appState.update({query:{esql:n[0].kqlQuery}}),C(Object(E.setActiveTabTimeline)({id:b.c.active,activeTab:b.d.esql})),void C(Object(E.showTimeline)({id:b.c.active,show:!0}));if(S?L({timeRange:S}):L(),n)switch(C(Object(E.updateDataView)({id:b.c.active,dataViewId:"security-solution-default",indexNames:["logs-*"]})),n[0].queryType){case"eql":C(Object(E.updateEqlOptions)({id:b.c.active,field:"query",value:n[0].kqlQuery})),C(Object(E.setActiveTabTimeline)({id:b.c.active,activeTab:b.d.eql}));break;case"kql":C(Object(E.applyKqlFilterQuery)({id:b.c.active,filterQuery:{kuery:{kind:"kuery",expression:n[0].kqlQuery},serializedQuery:n[0].kqlQuery}})),C(Object(E.setActiveTabTimeline)({id:b.c.active,activeTab:b.d.query}));break;case"dsl":const e={meta:{type:"custom",disabled:!1,negate:!1,alias:n[0].name,key:"query",value:n[0].kqlQuery},query:JSON.parse(n[0].kqlQuery)};C(Object(E.setFilters)({id:b.c.active,filters:[e]})),C(Object(E.setActiveTabTimeline)({id:b.c.active,activeTab:b.d.query}))}o&&C(Object(E.setFilters)({id:b.c.active,filters:o})),k||C(p.d.setSelectedDataView({id:g.SourcererScopeName.timeline,selectedDataViewId:D.id,selectedPatterns:[N||""]})),C(m.b.removeLinkTo([f.a.timeline,f.a.global]))}}),[M,n,o,S,k,C,L,A,D.id,N]),B=_?v.i:v.h,q=!_;return"esql"!==(null==n||null===(T=n[0])||void 0===T?void 0:T.queryType)&&"sql"!==(null==n||null===(I=n[0])||void 0===I?void 0:I.queryType)||!P?e?s.a.createElement(a.EuiButtonEmpty,{"aria-label":B,onClick:z,isDisabled:q,color:"text",flush:"both",size:"xs"},s.a.createElement(a.EuiToolTip,{position:"right",content:B},s.a.createElement(s.a.Fragment,null,t))):s.a.createElement(a.EuiButton,l()({"aria-label":B,isDisabled:q,onClick:z},w),s.a.createElement(a.EuiToolTip,{position:"right",content:B},s.a.createElement(s.a.Fragment,null,t))):null};S.displayName="SendToTimelineButton";const k="securityAssistant",w=e=>e.map((e=>`Rule Name:${e.name}\nRule Description:${e.description}`)).join("\n\n"),T=e=>e.filter((({field:e})=>!e.startsWith("signal."))).reduce(((e,{field:t,values:n})=>({...e,[t]:null!=n?n:[]})),{}),I=["kql","dsl","eql","esql","sql"],C=({messageContent:e,replacements:t})=>null!=t?Object.keys(t).reduce(((e,n)=>e.replaceAll(n,t[n])),e):e,M=e=>e.messages.map((({content:t})=>Object(i.i)(C({messageContent:null!=t?t:"",replacements:e.replacements})))).map(((t,n)=>t.map(((t,i)=>{var r;return{...t,getControlContainer:()=>document.querySelectorAll(`.message-${n} .euiCodeBlock__controls`)[i],button:I.includes(t.type)?s.a.createElement(S,{asEmptyButton:!0,dataProviders:[{id:"assistant-data-provider",name:`Assistant Query from conversation ${e.id}`,enabled:!0,excluded:!1,queryType:t.type,kqlQuery:null!==(r=t.content)&&void 0!==r?r:"",queryMatch:{field:"host.name",operator:":",value:"test"},and:[]}],keepDataView:!0},s.a.createElement(a.EuiIcon,{type:"timeline"})):null}}))))},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return E}));var a=n(9),i=n(2),r=n.n(i),s=n(474),o=n(4),l=n(735),u=n(218),c=n(110),d=n(203),p=n(1292),m=n(602),f=n(1115),g=n(881),b=n(182);const y=Object(i.createContext)(null),v=({children:e})=>{var t,n,a,l,v,h,E,j,O;const[S]=Object(c.o)(o.S),{sessionStorage:k}=Object(c.i)().services,{filter:w,sorting:T,pagination:I}=function(){const e=Object(d.f)(u.a.rulesTable),{services:{sessionStorage:t}}=Object(c.i)(),n=e(),a=function(e){try{return e.get(m.c)}catch{return null}}(t);if(!n&&!a)return{};const[i,r,s]=function(e,t){var n,a,i,r,s,l,u,c;const d=Object(b.e)(e,g.b),p=Object(b.e)(t,g.b),m={searchTerm:null!==(n=null==d?void 0:d.searchTerm)&&void 0!==n?n:null==p?void 0:p.searchTerm,source:null!==(a=null==d?void 0:d.source)&&void 0!==a?a:null==p?void 0:p.source,tags:null!==(i=null==d?void 0:d.tags)&&void 0!==i?i:null==p?void 0:p.tags,enabled:null!==(r=null==d?void 0:d.enabled)&&void 0!==r?r:null==p?void 0:p.enabled,ruleExecutionStatus:null!==(s=null==d?void 0:d.ruleExecutionStatus)&&void 0!==s?s:null==p?void 0:p.ruleExecutionStatus},f=Object(b.e)(e,g.c),y=Object(b.e)(t,g.c),v={field:null!==(l=null==f?void 0:f.field)&&void 0!==l?l:null==y?void 0:y.field,order:null!==(u=null==f?void 0:f.order)&&void 0!==u?u:null==y?void 0:y.order},h=Object(b.e)(e,g.e),E=Object(b.e)(t,g.d),x={page:null==h?void 0:h.page,perPage:null!==(c=null==h?void 0:h.perPage)&&void 0!==c?c:null==E?void 0:E.perPage};return x.perPage&&(x.perPage<0||x.perPage>o.pc)&&delete x.perPage,[m,v,x]}(n,a);return{filter:i,sorting:r,pagination:s}}(),[C,M]=Object(i.useState)({filter:null!==(t=null==w?void 0:w.searchTerm)&&void 0!==t?t:f.a.filter,tags:null!==(n=null==w?void 0:w.tags)&&void 0!==n?n:f.a.tags,showCustomRules:null!==(a=(null==w?void 0:w.source)===g.a.Custom)&&void 0!==a?a:f.a.showCustomRules,showElasticRules:null!==(l=(null==w?void 0:w.source)===g.a.Prebuilt)&&void 0!==l?l:f.a.showElasticRules,enabled:null==w?void 0:w.enabled,ruleExecutionStatus:null!==(v=null==w?void 0:w.ruleExecutionStatus)&&void 0!==v?v:f.a.ruleExecutionStatus}),[_,A]=Object(i.useState)({field:null!==(h=null==T?void 0:T.field)&&void 0!==h?h:f.d.field,order:null!==(E=null==T?void 0:T.order)&&void 0!==E?E:f.d.order}),[P,F]=Object(i.useState)(!1),[D,N]=Object(i.useState)(S.on),[R,L]=Object(i.useState)({ids:[],action:null}),[z,B]=Object(i.useState)(!1),[q,$]=Object(i.useState)(null!==(j=null==I?void 0:I.page)&&void 0!==j?j:f.b),[V,U]=Object(i.useState)(null!==(O=null==I?void 0:I.perPage)&&void 0!==O?O:f.c),[H,Z]=Object(i.useState)([]),G=Object(i.useRef)(null),Q=R.ids.length>0,W=Object(i.useMemo)((()=>({page:q,perPage:V})),[q,V]),K=Object(i.useCallback)((e=>{M((t=>({...t,...e}))),$(1),Z([]),F(!1)}),[]),J=Object(i.useCallback)((()=>{Z([]),F(!1)}),[]),Y=Object(d.g)(),X=Object(i.useCallback)((()=>{M({filter:f.a.filter,showElasticRules:f.a.showElasticRules,showCustomRules:f.a.showCustomRules,tags:f.a.tags,enabled:void 0,ruleExecutionStatus:f.a.ruleExecutionStatus}),A({field:f.d.field,order:f.d.order}),$(f.b),U(f.c),Y({[u.a.rulesTable]:null}),k.remove(m.c)}),[M,A,$,U,Y,k]);Object(i.useEffect)((()=>{var e;H.length>0?(N(!1),null==G.current&&(G.current=D)):(N(null!==(e=G.current)&&void 0!==e?e:D),G.current=null)}),[H,D]);const{data:{rules:ee,total:te}={rules:[],total:0},refetch:ne,dataUpdatedAt:ae,isFetched:ie,isFetching:re,isLoading:se,isRefetching:oe}=Object(p.a)({filterOptions:C,sortingOptions:_,pagination:W},{refetchOnWindowFocus:D&&!Q,refetchOnReconnect:D&&!Q,refetchInterval:D&&!Q&&S.value,keepPreviousData:!0}),{data:le,isLoading:ue,isFetching:ce,isError:de,refetch:pe}=Object(s.a)(ee.map((e=>e.id)),{enabled:ee.length>0}),me=Object(i.useCallback)((async()=>{const e=await ne();return await pe(),e}),[ne,pe]),fe=Object(i.useMemo)((()=>({reFetchRules:me,setFilterOptions:K,setIsAllSelected:F,setIsRefreshOn:N,setLoadingRules:L,setPage:$,setPerPage:U,setSelectedRuleIds:Z,setSortingOptions:A,clearRulesSelection:J,setIsPreflightInProgress:B,clearFilters:X})),[me,K,F,N,L,$,U,Z,A,J,B,X]),ge=Object(i.useMemo)((()=>({state:{rules:ee,rulesSnoozeSettings:{data:null!=le?le:{},isLoading:ue,isFetching:ce,isError:de},pagination:{page:q,perPage:V,total:te},filterOptions:C,isPreflightInProgress:z,isActionInProgress:Q,isAllSelected:P,isFetched:ie,isFetching:re,isLoading:se,isRefetching:oe,isRefreshOn:D,lastUpdated:ae,loadingRuleIds:R.ids,loadingRulesAction:R.action,selectedRuleIds:H,sortingOptions:_,isDefault:x(C,_,{page:q,perPage:V,total:te})},actions:fe})),[ee,le,ue,ce,de,q,V,te,C,z,Q,P,ie,re,se,oe,D,ae,R.ids,R.action,H,_,fe]);return r.a.createElement(y.Provider,{value:ge},e)},h=()=>{const e=Object(i.useContext)(y);return Object(l.a)(e,"useRulesTableContext should be used inside RulesTableContextProvider"),e},E=()=>Object(i.useContext)(y);function x(e,t,n){return Object(a.isEqual)(e,f.a)&&Object(a.isEqual)(t,f.d)&&n.page===f.b&&n.perPage===f.c}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(419));t.default=function(e,t){void 0===t&&(t=[]);var n=r.default(e,t,{loading:!0}),a=n[0],s=n[1];return i.useEffect((function(){s()}),[s]),a}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a=10,i=0},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(4);const i=`${a.Db}/rules/_rule_management_filters`,r=`${a.Db}/rules/_coverage_overview`},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=function(){const e=this.Parser,t=e.prototype.blockTokenizers,n=e.prototype.blockMethods;t.osquery=function(e,t,n){if(!1===t.startsWith("!{osquery"))return!1;const a=t[9];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i="!{osquery",r={};if("{"===a){let n="",a=0;for(let e=9;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}i+=n;try{r=JSON.parse(n)}catch(t){const n=e.now();this.file.fail(`Unable to parse osquery JSON configuration: ${t}`,{line:n.line,column:n.column+9})}}return i+="}",e(i)({type:"osquery",configuration:r})},n.splice(n.indexOf("text"),0,"osquery")}},function(e,t){const n=Object.freeze({loose:!0}),a=Object.freeze({});e.exports=e=>e?"object"!=typeof e?n:e:a},,function(e,t,n){"use strict";var a=Object.assign;e.exports=a},function(e,t,n){"use strict";n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n(154),i=n(232),r=n(923);const s=e=>"boolean"==typeof e,o=(e,t)=>{var n;return null==e||!((null===(n=e.actions)||void 0===n?void 0:n.length)>0&&s(t))||t},l=e=>null==e||e,u=(e,t,n,s)=>null==e?void 0:Object(i.d)(e.type)&&!t?r.d:o(e,n)?l(s)?void 0:a.Rb:a.Qb},function(e,t,n){"use strict";n.d(t,"a",(function(){return J})),n.d(t,"b",(function(){return Y}));var a=n(2),i=n.n(a),r=n(17),s=n(47),o=n(201),l=n(192),u=n(48),c=n(51),d=n(216),p=n(1095),m=n(565),f=n(159),g=n(137),b=n(125),y=n(306),v=n(464),h=n(127),E=n(211),x=n(321),j=n(275);const O=({field:e,value:t,isObjectArray:n,children:r})=>{const{dataFormattedForFieldBrowser:s,scopeId:l,isPreview:u}=Object(o.b)(),{isAlert:c}=Object(E.b)(s),d=c?j.d.DETAILS_FLYOUT:j.d.DEFAULT,p=Object(a.useMemo)((()=>({field:e,value:t})),[e,t]),m=Object(a.useMemo)((()=>({scopeId:l,isObjectArray:n})),[l,n]),f=Object(a.useMemo)((()=>u?[x.d.FILTER,x.d.TOGGLE_COLUMN]:[]),[u]);return i.a.createElement(j.c,{data:p,mode:j.a.HOVER_RIGHT,triggerId:d,visibleCellActions:6,sourcererScopeId:Object(h.getSourcererScopeId)(l),metadata:m,disabledActionTypes:f},r)};O.displayName="CellActions";var S=n(119),k=n(147),w=n(121),T=n(433),I=n(158),C=n(874),M=n(206),_=n(693),A=n(417),P=n(279),F=n(5);const D=F.i18n.translate("xpack.securitySolution.flyout.entities.failRelatedHostsDescription",{defaultMessage:"Failed to run search on related hosts"});var N=n(386),R=n(210),L=n(126),z=n(183),B=n(348),q=n(413);const $=Object(M.a)(p.a),V=Object(M.a)(f.c),U=({userName:e,timestamp:t,scopeId:n})=>{const{to:o,from:l,deleteQuery:p,setQuery:h,isInitializing:E}=Object(k.a)(),{selectedPatterns:x}=Object(w.d)(),j=Object(u.useDispatch)(),M=Object(a.useMemo)((()=>`entities-users-details-${Object(c.v4)()}`),[]),F=Object(a.useMemo)((()=>`entities-users-related-hosts-${Object(c.v4)()}`),[]),U=Object(q.a)("entity-analytics"),H=Object(R.a)().isPlatinumOrTrialLicense&&U,Z=Object(a.useCallback)(((e,t)=>{const n=Object(T.a)(e,t);j(Object(I.setAbsoluteRangeDatePicker)({id:S.a.global,from:n.from,to:n.to}))}),[j]),[G,{inspect:Q,userDetails:W,refetch:K}]=Object(_.b)({id:M,startDate:l,endDate:o,userName:e,indexNames:x,skip:0===x.length}),{loading:J,inspect:Y,relatedHosts:X,totalCount:ee,refetch:te}=(({userName:e,indexNames:t,from:n,skip:i=!1})=>{const{loading:r,result:s,search:o,refetch:l,inspect:u}=Object(P.a)({factoryQueryType:A.a.relatedHosts,initialResult:{totalCount:0,relatedHosts:[]},errorMessage:D,abort:i}),c=Object(N.b)(),d=Object(a.useMemo)((()=>({inspect:u,totalCount:s.totalCount,relatedHosts:s.relatedHosts,refetch:l,loading:r})),[u,l,s.totalCount,s.relatedHosts,r]),p=Object(a.useMemo)((()=>({defaultIndex:t,factoryQueryType:A.a.relatedHosts,userName:e,from:n,isNewRiskScoreModuleInstalled:c})),[t,n,e,c]);return Object(a.useEffect)((()=>{i||o(p)}),[p,o,i]),d})({userName:e,indexNames:x,from:t,skip:0===x.length}),ne=Object(a.useMemo)((()=>[{field:"host",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsNameColumnLabel",defaultMessage:"Name"}),render:e=>i.a.createElement(r.EuiText,{grow:!1,size:"xs"},i.a.createElement(O,{field:"host.name",value:e},e))},{field:"ip",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsIpColumnLabel",defaultMessage:"Ip addresses"}),render:e=>i.a.createElement(v.a,{rowItems:e,attrName:"host.ip",idPrefix:"",isDraggable:!1,render:e=>null!=e?i.a.createElement(g.h,{ip:e}):Object(L.d)()})},...H?[{field:"risk",name:Object(B.b)(b.v.host),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(y.a,{severity:e}):Object(L.d)()}]:[]]),[H]),ae=Object(a.useMemo)((()=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"m",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiIcon,{type:"storage"})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxxs"},i.a.createElement(r.EuiText,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsCountLabel",defaultMessage:"Related hosts: {count}",values:{count:ee}})))))),[ee]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.userDetailsTitle",defaultMessage:"User"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{header:{title:e,iconType:"user",headerContent:ae},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":z.D},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.userDetailsInfoTitle",defaultMessage:"User information"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(m.a,{criteriaFields:Object(C.a)(W),startDate:l,endDate:o,skip:E},(({isLoadingAnomaliesData:t,anomaliesData:n,jobNameById:a})=>i.a.createElement($,{id:M,isInDetailsSidePanel:!1,data:W,anomaliesData:n,isLoadingAnomaliesData:t,loading:G,startDate:l,endDate:o,narrowDateRange:Z,setQuery:h,refetch:K,inspect:Q,userName:e,indexPatterns:x,jobNameById:a}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(r.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsTitle",defaultMessage:"Related hosts"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsTooltip",defaultMessage:"After this alert was generated, {userName} logged into these hosts. Check if this activity is normal.",values:{userName:e}})},i.a.createElement(r.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"})))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(V,{id:F,inspect:Y,loading:J,setQuery:h,deleteQuery:p,refetch:te},i.a.createElement(r.EuiInMemoryTable,{columns:ne,items:X,loading:J,"data-test-subj":z.C,pagination:{pageSize:4,showPerPageOptions:!1},message:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsNoDataDescription",defaultMessage:"No hosts identified"})}),i.a.createElement(f.b,{queryId:F,title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedHostsInspectButtonTitle",defaultMessage:"Related hosts"}),inspectIndex:0})))))};var H=n(1133),Z=n(896);const G=F.i18n.translate("xpack.securitySolution.flyout.entities.failRelatedUsersDescription",{defaultMessage:"Failed to run search on related users"}),Q=Object(M.a)(H.a),W=Object(M.a)(f.c),K=({hostName:e,timestamp:t,scopeId:n})=>{const{to:o,from:l,deleteQuery:p,setQuery:h,isInitializing:E}=Object(k.a)(),{selectedPatterns:x}=Object(w.d)(),j=Object(u.useDispatch)(),M=Object(a.useMemo)((()=>`entities-hosts-details-${Object(c.v4)()}`),[]),_=Object(a.useMemo)((()=>`entities-hosts-related-users-${Object(c.v4)()}`),[]),F=Object(q.a)("entity-analytics"),D=Object(R.a)().isPlatinumOrTrialLicense&&F,$=Object(a.useCallback)(((e,t)=>{const n=Object(T.a)(e,t);j(Object(I.setAbsoluteRangeDatePicker)({id:S.a.global,from:n.from,to:n.to}))}),[j]),[V,{inspect:U,hostDetails:H,refetch:K}]=Object(Z.b)({id:M,startDate:l,endDate:o,hostName:e,indexNames:x,skip:0===x.length}),{loading:J,inspect:Y,relatedUsers:X,totalCount:ee,refetch:te}=(({hostName:e,indexNames:t,from:n,skip:i=!1})=>{const r=Object(N.b)(),{loading:s,result:o,search:l,refetch:u,inspect:c}=Object(P.a)({factoryQueryType:A.a.relatedUsers,initialResult:{totalCount:0,relatedUsers:[]},errorMessage:G,abort:i}),d=Object(a.useMemo)((()=>({inspect:c,totalCount:o.totalCount,relatedUsers:o.relatedUsers,refetch:u,loading:s})),[c,u,o.totalCount,o.relatedUsers,s]),p=Object(a.useMemo)((()=>({defaultIndex:t,factoryQueryType:A.a.relatedUsers,hostName:e,from:n,isNewRiskScoreModuleInstalled:r})),[t,n,e,r]);return Object(a.useEffect)((()=>{i||l(p)}),[p,l,i]),d})({hostName:e,indexNames:x,from:t,skip:0===x.length}),ne=Object(a.useMemo)((()=>[{field:"user",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersNameColumnLabel",defaultMessage:"Name"}),render:e=>i.a.createElement(r.EuiText,{grow:!1,size:"xs"},i.a.createElement(O,{field:"user.name",value:e},e))},{field:"ip",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersIpColumnLabel",defaultMessage:"Ip addresses"}),render:e=>i.a.createElement(v.a,{rowItems:e,attrName:"host.ip",idPrefix:"",isDraggable:!1,render:e=>null!=e?i.a.createElement(g.h,{ip:e}):Object(L.d)()})},...D?[{field:"risk",name:Object(B.b)(b.v.user),truncateText:!1,mobileOptions:{show:!0},sortable:!1,render:e=>null!=e?i.a.createElement(y.a,{severity:e}):Object(L.d)()}]:[]]),[D]),ae=Object(a.useMemo)((()=>i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiIcon,{type:"user"})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxxs"},i.a.createElement(r.EuiText,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersCountLabel",defaultMessage:"Related users: {count}",values:{count:ee}})))))),[ee]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.hostDetailsTitle",defaultMessage:"Host"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(d.a,{header:{title:e,iconType:"storage",headerContent:ae},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":z.k},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.hostDetailsInfoTitle",defaultMessage:"Host information"}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(m.a,{criteriaFields:Object(C.a)(H),startDate:l,endDate:o,skip:E},(({isLoadingAnomaliesData:t,anomaliesData:n,jobNameById:a})=>i.a.createElement(Q,{id:M,hostName:e,data:H,indexNames:x,jobNameById:a,anomaliesData:n,isLoadingAnomaliesData:t,isInDetailsSidePanel:!1,loading:V,startDate:l,endDate:o,narrowDateRange:$,setQuery:h,refetch:K,inspect:U,deleteQuery:p}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(r.EuiFlexGroup,{direction:"row",gutterSize:"xs",alignItems:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiTitle,{size:"xxs"},i.a.createElement("h4",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersTitle",defaultMessage:"Related users"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersTooltip",defaultMessage:"After this alert was generated, these users logged into {hostName}. Check if this activity is normal.",values:{hostName:e}})},i.a.createElement(r.EuiIcon,{color:"subdued",type:"iInCircle",className:"eui-alignTop"})))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(W,{id:_,inspect:Y,loading:J,setQuery:h,deleteQuery:p,refetch:te},i.a.createElement(r.EuiInMemoryTable,{columns:ne,items:X,loading:J,"data-test-subj":z.j,pagination:{pageSize:4,showPerPageOptions:!1},message:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersNoDataDescription",defaultMessage:"No users identified"})}),i.a.createElement(f.b,{queryId:_,title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.relatedUsersInspectButtonTitle",defaultMessage:"Related users"}),inspectIndex:0})))))};K.displayName="HostDetails";const J="entities-details",Y=()=>{const{getFieldsData:e,scopeId:t}=Object(o.b)(),n=Object(l.a)(e("host.name")),a=Object(l.a)(e("user.name")),u=Object(l.a)(e("@timestamp")),c=u&&(n||a),d=a&&u,p=n&&u;return i.a.createElement(i.a.Fragment,null,c?i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"m","data-test-subj":z.i},d&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(U,{userName:a,timestamp:u,scopeId:t})),p&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(K,{hostName:n,timestamp:u,scopeId:t}))):i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.entities.noDataDescription",defaultMessage:"Host and user information are unavailable for this alert."}))};Y.displayName="EntitiesDetails"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a.f}));var a=n(150)},function(e,t,n){"use strict";e.exports=n(618)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(207));t.default=function(e,t,n){void 0===t&&(t=[]),void 0===n&&(n={loading:!1});var s=i.useRef(0),o=r.default(),l=i.useState(n),u=l[0],c=l[1],d=i.useCallback((function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=++s.current;return c((function(e){return a.__assign(a.__assign({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return o()&&i===s.current&&c({value:e,loading:!1}),e}),(function(e){return o()&&i===s.current&&c({error:e,loading:!1}),e}))}),t);return[u,d]}},,function(e,t,n){"use strict";n.r(t),n.d(t,"registerUrlParam",(function(){return r})),n.d(t,"deregisterUrlParam",(function(){return s})),n.d(t,"updateUrlParam",(function(){return o}));var a=n(26);const i=n.n(a)()("x-pack/security_solution/local/global_url_param"),r=i("REGISTER_URL_PARAM"),s=i("DEREGISTER_URL_PARAM"),o=i("UPDATE_URL_PARAM")},function(e,t,n){"use strict";n.r(t),n.d(t,"selectNotesById",(function(){return o})),n.d(t,"getNotes",(function(){return u})),n.d(t,"getNotesAsCommentsList",(function(){return c})),n.d(t,"selectNotesByIdSelector",(function(){return d})),n.d(t,"notesByIdsSelector",(function(){return p})),n.d(t,"selectNotesAsCommentsListSelector",(function(){return m})),n.d(t,"errorsSelector",(function(){return f}));var a=n(45),i=n(234),r=n.n(i),s=n(57);const o=e=>e.app.notesById,l=e=>e.app.errors,u=r()(((e,t)=>Object(a.keys)(e).reduce(((n,a)=>{if(t.includes(a)){const t=e[a];return[...n,t]}return n}),[]))),c=e=>Object(a.values)(e).map((e=>{var t;return{eventId:e.eventId,savedObjectId:e.saveObjectId,note:e.note,noteId:e.id,updated:(null!==(t=e.lastEdit)&&void 0!==t?t:e.created).getTime(),updatedBy:e.user}})),d=Object(s.createSelector)(o,(e=>e)),p=()=>Object(s.createSelector)(o,(e=>e)),m=()=>Object(s.createSelector)(o,c),f=()=>Object(s.createSelector)(l,(e=>e))},function(e,t,n){"use strict";let a;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e.name="name",e.domain="domain",e.lastSeen="lastSeen"}(a||(a={}));const i={bool:{must_not:[{term:{"event.kind":"asset"}}]}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"a",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"d",(function(){return g}));var a=n(45),i=n(14),r=n(145);const s=e=>Object(a.omit)("and",e),o=e=>null!=e,l=e=>e.reduce(((e,t)=>[...e,[s(t),...t.and]]),[]),u=e=>Number(e.substring(e.lastIndexOf(".")+1)),c=({index:e,dataProviderGroups:t})=>e>=0&&e<t.length,d=e=>e.reduce(((e,t)=>[...e,{...t[0],and:t.slice(1)}]),[]),p=[[]],m=({dataProviders:e,destination:t,dispatch:n,source:a,timelineId:r})=>{if(!o(t))return;const s=[...l(e),...p];(({destination:e,source:t})=>t.droppableId===e.droppableId)({source:a,destination:t})?(({dataProviderGroups:e,destination:t,dispatch:n,source:a,timelineId:r})=>{const s=u(a.droppableId);if(c({index:s,dataProviderGroups:e})){const o=(({endIndex:e,group:t,startIndex:n})=>{const a=[...t],[i]=a.splice(n,1);return a.splice(e,0,i),a})({group:e[s],startIndex:a.index,endIndex:t.index}),l=e.reduce(((e,t,n)=>[...e,n===s?[...o]:[...t]]),[]);n(Object(i.updateProviders)({id:r,providers:d(l.filter((e=>e.length)))}))}})({dataProviderGroups:s,destination:t,dispatch:n,source:a,timelineId:r}):(({dataProviderGroups:e,destination:t,dispatch:n,source:a,timelineId:r})=>{const s=u(a.droppableId),o=u(t.droppableId);if(c({index:s,dataProviderGroups:e})&&c({index:o,dataProviderGroups:e})){const l=e[s],u=e[o],c=a.index,p=t.index,{updatedDestinationGroup:m,updatedSourcererScope:f}=(({destinationGroup:e,moveProviderFromSourceIndex:t,moveProviderToDestinationIndex:n,sourceGroup:a})=>{const i=[...a],r=[...e],[s]=i.splice(t,1);return r.splice(n,0,s),{updatedDestinationGroup:r.filter(((e,t)=>e.id!==s.id||t===n)),updatedSourcererScope:i}})({destinationGroup:u,moveProviderFromSourceIndex:c,moveProviderToDestinationIndex:p,sourceGroup:l}),g=e.reduce(((e,t,n)=>[...e,n===s?[...f]:n===o?[...m]:[...t]]),[]);n(Object(i.updateProviders)({id:r,providers:d(g.filter((e=>e.length)))}))}})({dataProviderGroups:s,destination:t,dispatch:n,source:a,timelineId:r})},f=({dataProviders:e,destination:t,dispatch:n,onAddedToTimeline:a,providerToAdd:r,timelineId:m})=>{0===e.length?(({dispatch:e,onAddedToTimeline:t,providerToAdd:n,timelineId:a})=>{e(Object(i.updateProviders)({id:a,providers:[n]})),t(n.name)})({dispatch:n,onAddedToTimeline:a,providerToAdd:r,timelineId:m}):(({dataProviders:e,destination:t,dispatch:n,onAddedToTimeline:a,providerToAdd:r,timelineId:m})=>{const f=[...l(e),...p];if(!o(t))return;const g=u(t.droppableId);if(c({index:g,dataProviderGroups:f})){const e=[...f[g]];e.splice(t.index,0,s(r));const o=e.filter(((e,n)=>e.id!==r.id||n===t.index)),l=f.reduce(((e,t,n)=>[...e,n===g?[...o]:[...t]]),[]);n(Object(i.updateProviders)({id:m,providers:d(l.filter((e=>e.length)))})),a(r.name)}})({dataProviders:e,destination:t,dispatch:n,onAddedToTimeline:a,providerToAdd:r,timelineId:m})},g=e=>Object(r.k)(e)?e.length?`( ${e.join(" OR ")} )`:"":e},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(45);function i(e){return Object(a.isString)(e)?r(e):`${e}`}function r(e){return`"${function(e=""){return s(e)}(e)}"`}const s=Object(a.flow)((e=>e.replace(/["]/g,"\\$&")),(e=>e.replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n")))},function(e,t,n){"use strict";n.r(t),n.d(t,"setUsersTablesActivePageToZero",(function(){return r})),n.d(t,"setUsersDetailsTablesActivePageToZero",(function(){return s})),n.d(t,"updateTableLimit",(function(){return o})),n.d(t,"updateTableActivePage",(function(){return l})),n.d(t,"updateTableSorting",(function(){return u})),n.d(t,"updateUserRiskScoreSeverityFilter",(function(){return c})),n.d(t,"updateUsersAnomaliesJobIdFilter",(function(){return d})),n.d(t,"updateUsersAnomaliesInterval",(function(){return p})),n.d(t,"addUserAssetTableField",(function(){return m})),n.d(t,"removeUserAssetTableField",(function(){return f}));var a=n(26);const i=n.n(a)()("x-pack/security_solution/local/users"),r=i("SET_USERS_TABLES_ACTIVE_PAGE_TO_ZERO"),s=i("SET_USERS_DETAILS_TABLES_ACTIVE_PAGE_TO_ZERO"),o=i("UPDATE_USERS_TABLE_LIMIT"),l=i("UPDATE_USERS_ACTIVE_PAGE"),u=i("UPDATE_USERS_SORTING"),c=i("UPDATE_USERS_RISK_SEVERITY_FILTER"),d=i("UPDATE_USERS_ANOMALIES_JOB_ID_FILTER"),p=i("UPDATE_USERS_ANOMALIES_INTERVAL"),m=i("ADD_USER_ASSET_TABLE_FIELD"),f=i("REMOVE_USER_ASSET_TABLE_FIELD")},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("securitySolutionPackages.ecsDataQualityDashboard.incompatibleTab.dataQualityDashboardConversationId",{defaultMessage:"Data Quality dashboard"})},function(e,t,n){"use strict";n.d(t,"d",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(395);const s=Object(r.c)(),o=Object(r.c)(),l=()=>{const[e]=Object(a.useState)(s);return{portalNode:e}},u=i.a.memo((()=>{const{portalNode:e}=l();return i.a.createElement(r.b,{node:e})}));u.displayName="TimelineEventsCountBadge";const c=()=>{const[e]=Object(a.useState)(o);return{portalNode:e}},d=i.a.memo((()=>{const{portalNode:e}=c();return i.a.createElement(r.b,{node:e})}));d.displayName="EqlEventsCountBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(23),i=n.n(a),r=n(44),s=n.n(r),o=n(2),l=n.n(o),u=n(17);const c=s()((({loading:e,...t})=>l.a.createElement(u.EuiPanel,i()({},t,{hasBorder:!0})))).withConfig({displayName:"Panel",componentId:"sc-h09jgf-0"})(["position:relative;",""],(({loading:e})=>e&&"\n    overflow: hidden;\n  "));c.displayName="Panel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"c",(function(){return s}));const a="kibana.alert.rule.name",i="host.name",r=300,s=500},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o}));var a=n(2),i=n.n(a);const r=i.a.createContext(null),s=Object(a.memo)((({upsellingService:e,children:t})=>i.a.createElement(r.Provider,{value:e},t)));s.displayName="UpsellingProvider";const o=()=>{const e=Object(a.useContext)(r);if(!e)throw new Error("UpsellingProviderContext not found");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return d}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(17);const c=l.a.span.withConfig({displayName:"EllipsisText",componentId:"sc-saif2w-0"})(["&,& *{display:inline-block;max-width:100%;overflow:hidden;text-overflow:ellipsis;vertical-align:top;white-space:nowrap;}"]);function d({tooltipContent:e,children:t,dataTestSubj:n,...a}){return e?s.a.createElement(u.EuiToolTip,{display:"block",content:e},s.a.createElement(c,i()({"data-test-subj":n},a),t)):s.a.createElement(c,i()({"data-test-subj":n},a),t)}c.displayName="EllipsisText"},function(e,t,n){"use strict";(function(t){const a=n(354),i=n(626),r=n(441),s={needsProtoHack:new Set([i.set,i.map,i.weakSet,i.weakMap])};e.exports=s.clone=function(e,n={},a=null){if("object"!=typeof e||null===e)return e;let o=s.clone,l=a;if(n.shallow){if(!0!==n.shallow)return s.cloneWithShallow(e,n);o=e=>e}else if(l){const t=l.get(e);if(t)return t}else l=new Map;const u=i.getInternalProto(e);if(u===i.buffer)return t&&t.from(e);if(u===i.date)return new Date(e.getTime());if(u===i.regex)return new RegExp(e);const c=s.base(e,u,n);if(c===e)return e;if(l&&l.set(e,c),u===i.set)for(const t of e)c.add(o(t,n,l));else if(u===i.map)for(const[t,a]of e)c.set(t,o(a,n,l));const d=r.keys(e,n);for(const t of d){if("__proto__"===t)continue;if(u===i.array&&"length"===t){c.length=e.length;continue}const a=Object.getOwnPropertyDescriptor(e,t);a?a.get||a.set?Object.defineProperty(c,t,a):a.enumerable?c[t]=o(e[t],n,l):Object.defineProperty(c,t,{enumerable:!1,writable:!0,configurable:!0,value:o(e[t],n,l)}):Object.defineProperty(c,t,{enumerable:!0,writable:!0,configurable:!0,value:o(e[t],n,l)})}return c},s.cloneWithShallow=function(e,t){const n=t.shallow;(t=Object.assign({},t)).shallow=!1;const i=new Map;for(const t of n){const n=a(e,t);"object"!=typeof n&&"function"!=typeof n||i.set(n,n)}return s.clone(e,t,i)},s.base=function(e,t,n){if(!1===n.prototype)return s.needsProtoHack.has(t)?new t.constructor:t===i.array?[]:{};const a=Object.getPrototypeOf(e);if(a&&a.isImmutable)return e;if(t===i.array){const e=[];return a!==t&&Object.setPrototypeOf(e,a),e}if(s.needsProtoHack.has(t)){const e=new a.constructor;return a!==t&&Object.setPrototypeOf(e,a),e}return Object.create(a)}}).call(this,n(242).Buffer)},function(e,t,n){"use strict";t.keys=function(e,t={}){return!1!==t.symbols?Reflect.ownKeys(e):Object.getOwnPropertyNames(e)}},function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getErrorMap=t.setErrorMap=t.defaultErrorMap=void 0;const i=a(n(632));t.defaultErrorMap=i.default;let r=i.default;t.setErrorMap=function(e){r=e},t.getErrorMap=function(){return r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ZodError=t.quotelessJson=t.ZodIssueCode=void 0;const a=n(355);t.ZodIssueCode=a.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),t.quotelessJson=e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(e){return e.message},n={_errors:[]},a=e=>{for(const i of e.issues)if("invalid_union"===i.code)i.unionErrors.map(a);else if("invalid_return_type"===i.code)a(i.returnTypeError);else if("invalid_arguments"===i.code)a(i.argumentsError);else if(0===i.path.length)n._errors.push(t(i));else{let e=n,a=0;for(;a<i.path.length;){const n=i.path[a];a===i.path.length-1?(e[n]=e[n]||{_errors:[]},e[n]._errors.push(t(i))):e[n]=e[n]||{_errors:[]},e=e[n],a++}}};return a(this),n}toString(){return this.message}get message(){return JSON.stringify(this.issues,a.util.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=(e=>e.message)){const t={},n=[];for(const a of this.issues)a.path.length>0?(t[a.path[0]]=t[a.path[0]]||[],t[a.path[0]].push(e(a))):n.push(e(a));return{formErrors:n,fieldErrors:t}}get formErrors(){return this.flatten()}}t.ZodError=ZodError,ZodError.create=e=>new ZodError(e)},,function(e,t,n){"use strict";var a=n(58);n.d(t,"a",(function(){return a.Direction}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(124);n(4);const i=e=>({hasQuery:null!=e.kqlQuery&&null!=e.kqlQuery.filterQuery&&null!=e.kqlQuery.filterQuery.kuery&&""!==e.kqlQuery.filterQuery.kuery.expression||null!=e.dataProviders&&e.dataProviders.length>0||null!=e.filters&&e.filters.length>0,hasEql:null!=e.eqlOptions&&null!=e.eqlOptions.query&&e.eqlOptions.query.length>0}),r=[a.e.alertsOnAlertsPage,a.e.alertsOnRuleDetailsPage]},function(e,t,n){"use strict";n.r(t),n.d(t,"allUsersSelector",(function(){return o})),n.d(t,"userRiskScoreSelector",(function(){return l})),n.d(t,"userRiskScoreSeverityFilterSelector",(function(){return u})),n.d(t,"authenticationsSelector",(function(){return c})),n.d(t,"usersAnomaliesJobIdFilterSelector",(function(){return d})),n.d(t,"usersAnomaliesIntervalSelector",(function(){return p})),n.d(t,"selectUserAssetTableById",(function(){return m})),n.d(t,"selectUserAssetTables",(function(){return f}));var a=n(57),i=n(176);const r=e=>e.users.page,s=(e,t)=>t===i.UsersType.details||t===i.UsersType.page?e.users[t]:null,o=()=>Object(a.createSelector)(r,(e=>e.queries[i.UsersTableType.allUsers])),l=()=>Object(a.createSelector)(r,(e=>e.queries[i.UsersTableType.risk])),u=()=>Object(a.createSelector)(r,(e=>e.queries[i.UsersTableType.risk].severitySelection)),c=()=>Object(a.createSelector)(r,(e=>e.queries[i.UsersTableType.authentications])),d=()=>Object(a.createSelector)(s,(e=>{var t;return null!==(t=null==e?void 0:e.queries[i.UsersTableType.anomalies].jobIdSelection)&&void 0!==t?t:[]})),p=()=>Object(a.createSelector)(s,(e=>{var t;return null!==(t=null==e?void 0:e.queries[i.UsersTableType.anomalies].intervalSelection)&&void 0!==t?t:"auto"})),m=(e,t)=>e.users.flyout.queries[t],f=e=>e.users.flyout.queries},function(e,t,n){t.set=t.assoc=t.assocPath=n(995),t.setWith=n(1053)},function(e,t,n){var a=n(637),i=n(1e3),r=n(1001),s=n(641),o=n(1019),l=n(645),u=n(1020),c=n(647),d=n(648),p=n(651),m=Math.max;e.exports=function(e,t,n,f,g,b,y,v){var h=2&t;if(!h&&"function"!=typeof e)throw new TypeError("Expected a function");var E=f?f.length:0;if(E||(t&=-97,f=g=void 0),y=void 0===y?y:m(p(y),0),v=void 0===v?v:p(v),E-=g?g.length:0,64&t){var x=f,j=g;f=g=void 0}var O=h?void 0:l(e),S=[e,t,n,f,g,x,j,b,y,v];if(O&&u(S,O),e=S[0],t=S[1],n=S[2],f=S[3],g=S[4],!(v=S[9]=void 0===S[9]?h?0:e.length:m(S[9]-E,0))&&24&t&&(t&=-25),t&&1!=t)k=8==t||16==t?r(e,t,v):32!=t&&33!=t||g.length?s.apply(void 0,S):o(e,t,n,f);else var k=i(e,t,n);return d((O?a:c)(k,S),e,t)}},function(e,t,n){e.exports=n(24)(3390)},function(e,t,n){e.exports=n(24)(363)},function(e,t,n){var a=n(450),i=n(453),r=4294967295;function s(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=r,this.__views__=[]}s.prototype=a(i.prototype),s.prototype.constructor=s,e.exports=s},function(e,t){e.exports=function(){}},function(e,t,n){e.exports=n(24)(286)},function(e,t,n){e.exports=n(24)(3380)},function(e,t,n){e.exports=n(24)(1620)},function(e,t){var n="__lodash_placeholder__";e.exports=function(e,t){for(var a=-1,i=e.length,r=0,s=[];++a<i;){var o=e[a];o!==t&&o!==n||(e[a]=n,s[r++]=a)}return s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.warn=t.deprecate=t.resetDeprecationsSeen=void 0;var a={};t.resetDeprecationsSeen=function(){a={}};var i="object"==typeof console&&"function"==typeof console.warn?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return console.warn.apply(console,e)}:function(){};t.deprecate=function(e){a[e]||(a[e]=!0,i("redux-observable | DEPRECATION: "+e))},t.warn=function(e){i("redux-observable | WARNING: "+e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"c",(function(){return d}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.notes.addNoteButtonLabel",{defaultMessage:"Add Note"}),r=a.i18n.translate("xpack.securitySolution.notes.noteLabel",{defaultMessage:"Note"}),s=a.i18n.translate("xpack.securitySolution.notes.notesTitle",{defaultMessage:"Notes"}),o=a.i18n.translate("xpack.securitySolution.notes.search.FilterByUserOrNotePlaceholder",{defaultMessage:"Filter by User or Note"}),l=a.i18n.translate("xpack.securitySolution.notes.cancelButtonLabel",{defaultMessage:"Cancel"}),u=a.i18n.translate("xpack.securitySolution.notes.youAreEditingANoteScreenReaderOnly",{defaultMessage:"You are editing a note. Click Add Note when finished, or press escape to cancel."}),c=e=>a.i18n.translate("xpack.securitySolution.notes.youAreViewingNotesScreenReaderOnly",{values:{row:e},defaultMessage:"You are viewing notes for the event in row {row}. Press the up arrow key when finished to return to the event."}),d=a.i18n.translate("xpack.securitySolution.notes.createdByLabel",{defaultMessage:"Created by"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),i=n(706);const r=()=>{const e=Object(a.useContext)(i.a);if(!e)throw new Error("useDiscoverInTimelineContext should only used within a tree with parent as DiscoverInTimelineContextProvider");return e}},function(e,t,n){e.exports=n(24)(1069)},function(e,t,n){"use strict";var a=n(25);n.d(t,"c",(function(){return a.e})),n.d(t,"b",(function(){return a.d})),n.d(t,"d",(function(){return a.f})),n.d(t,"a",(function(){return a.a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17),l=n(146),u=n(380);const c=s()(o.EuiFlexGroup).withConfig({displayName:"BottomContentWrapper",componentId:"sc-1819ayg-0"})(["",""],(({theme:e})=>`\n    padding: ${e.eui.euiSizeM} 0;\n  `)),d=i.a.memo(Object(a.forwardRef)((({id:e,field:t,dataTestSubj:n,idAria:r,bottomRightContent:s},d)=>{const{isInvalid:p,errorMessage:m}=Object(l.i)(t),[f,g]=Object(a.useState)(!1);return i.a.createElement(o.EuiFormRow,{"data-test-subj":n,describedByIds:r?[r]:void 0,error:m,fullWidth:!0,helpText:t.helpText,isInvalid:p||f,label:t.label,labelAppend:t.labelAppend},i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{ref:d,ariaLabel:r,editorId:e,onChange:t.setValue,value:t.value,"data-test-subj":`${n}-markdown-editor`,setIsMarkdownInvalid:g}),s&&i.a.createElement(c,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},s))))})));d.displayName="MarkdownEditorForm"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(48),r=n(119),s=n(112),o=n(128),l=n(181);const u=({inputId:e=r.a.global,inspectIndex:t=0,isDisabled:n,multiple:u=!1,onClick:c,onCloseInspect:d,queryId:p})=>{const m=Object(i.useDispatch)(),f=o.d.globalQueryByIdSelector(),g=o.d.timelineQueryByIdSelector(),{loading:b,inspect:y,selectedInspectIndex:v,isInspected:h}=Object(s.a)((t=>e===r.a.global?f(t,p):g(t,p))),E=Object(a.useCallback)((()=>{c&&c(),m(l.c.setInspectionParameter({id:p,inputId:e,isInspected:!0,selectedInspectIndex:t}))}),[c,m,p,e,t]),x=Object(a.useCallback)((()=>{null!=d&&d(),m(l.c.setInspectionParameter({id:p,inputId:e,isInspected:!1,selectedInspectIndex:t}))}),[d,m,p,e,t]);let j=null,O=null;null!=y&&y.dsl.length>0&&(u?[j,...O]=y.dsl:j=y.dsl[t]);let S=null,k=null;null!=y&&y.response.length>0&&(u?[S,...k]=y.response:S=y.response[t]);const w=Object(a.useMemo)((()=>!b&&v===t&&h),[t,h,b,v]);return{additionalRequests:O,additionalResponses:k,handleClick:E,handleCloseModal:x,isButtonDisabled:Object(a.useMemo)((()=>b||n||null==j||null==S||null==p),[n,b,p,j,S]),isShowingModal:w,loading:b,request:j,response:S}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(122),s=n(113),o=n(228);const l=({onClick:e,outline:t,title:n,timelineId:a=r.c.active})=>{const{getButton:i}=Object(o.b)({timelineId:a,timelineType:s.l.template,onClick:e});return i({outline:t,title:n})},u=i.a.memo(l);u.displayName="NewTemplateTimeline"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(17),i=n(2),r=n.n(i),s=n(132),o=n(739);const l=r.a.memo((({hideActions:e=[],modalTitle:t,onClose:n,onOpen:i})=>r.a.createElement(a.EuiModal,{"data-test-subj":"open-timeline-modal",maxWidth:1100,onClose:n},r.a.createElement(o.a,{closeModalTimeline:n,hideActions:e,isModal:!0,defaultPageSize:10,onOpenTimeline:i,title:null!=t?t:s.H}))));l.displayName="OpenTimelineModal"},function(e,t,n){"use strict";n.d(t,"i",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"e",(function(){return m})),n.d(t,"a",(function(){return f}));var a=n(45),i=n(113),r=n(592);const s=(e,t)=>"__typename"!==e&&null!=t?t:void 0,o=e=>!Object(a.isEmpty)(e),l=({isAlert:e,isPinned:t,eventHasNotes:n,timelineType:a})=>a===i.l.template?r.b(e):t&&n?r.d(e):t?r.c(e):r.g(e),u=({eventId:e,pinnedEventIds:t})=>!0===t[e],c=({allowUnpinning:e,eventId:t,onPinEvent:n,onUnPinEvent:a,isEventPinned:i})=>{e&&(i?a(t):n(t))},d=(e,t,n)=>e.reduce(((e,a)=>({...e,...t.includes(a._id)?{[a._id]:a.data.filter((e=>n.includes(e.field)))}:{}})),{}),p=e=>{var t;if(!Object(a.isEmpty)(null===(t=e.eql)||void 0===t?void 0:t.sequenceNumber))try{var n,i;const t=(null!==(n=null===(i=e.eql)||void 0===i?void 0:i.sequenceNumber)&&void 0!==n?n:"").split("-")[0];return parseInt(t,10)%2==0}catch{return!1}return!1},m=e=>{var t,n,i,r;return Object(a.isEmpty)(null===(t=e.kibana)||void 0===t||null===(n=t.alert)||void 0===n||null===(i=n.rule)||void 0===i?void 0:i.uuid)?Object(a.isEmpty)(null===(r=e.eql)||void 0===r?void 0:r.parentId)?"raw":"eql":"signal"},f="note-content"},function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.flows="flows",e.dns="dns",e.anomalies="anomalies",e.tls="tls",e.http="http",e.events="events"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(17),l=n(47),u=n(44),c=n.n(u),d=n(112),p=n(151),m=n(134),f=n(118),g=n(305),b=n(266);const y=(e,t)=>(t===b.a.createCase||t===b.a.submitCase)&&e===b.b.alertsCases,v=c()(o.EuiTourStep).withConfig({displayName:"StyledTourStep",componentId:"sc-1l8wop5-0"})(["&.euiPopover__panel[data-popover-open]{z-index:",";}"],(({step:e,tourId:t})=>y(t,e)?"9000 !important":"1000 !important")),h=({children:e,onClick:t,step:n,tourId:a})=>{const{activeStep:u,incrementStep:c,isTourShown:h}=Object(g.b)(),E=Object(r.useMemo)((()=>b.e[a].find((e=>e.step===n))),[n,a]),x=Object(r.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),j=Object(d.b)((e=>{var t;return(null!==(t=x(e,p.f.active))&&void 0!==t?t:m.b).show})),O=Object(r.useCallback)((()=>t?t():c(a)),[c,t,a]),S=Object(r.useCallback)((e=>{"Enter"===e.key&&e.stopPropagation()}),[]),k=y(a,n);if(null==E||(n!==u||!h(a))&&!k||j)return e||null;const{anchor:w,content:T,imageConfig:I,dataTestSubj:C,hideNextButton:M=!1,..._}=E,A=M?s.a.createElement(s.a.Fragment,null):s.a.createElement(o.EuiButtonEmpty,{onClick:O,onKeyDown:S,size:"xs",color:"text",flush:"right","data-test-subj":"onboarding--securityTourNextStepButton","tour-step":"nextButton"},s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.guided_onboarding.nextStep.buttonLabel",defaultMessage:"Next"})),P={..._,content:s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiText,{size:"s"},s.a.createElement("p",null,T)),I&&s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiImage,{alt:I.altText,src:I.src,size:"fullWidth"}))),footerAction:A,isStepOpen:!0,onFinish:()=>null,stepsTotal:b.e[a].length,panelProps:{"data-test-subj":C}};return null!=w?s.a.createElement(s.a.Fragment,null,s.a.createElement(v,i()({tourId:a},P,{anchor:w})),s.a.createElement(s.a.Fragment,null,e)):null!=e?s.a.createElement(v,i()({tourId:a},P),e):null},E=({children:e,isTourAnchor:t=!0,...n})=>t?s.a.createElement(h,n,e):s.a.createElement(s.a.Fragment,null,e)},function(e,t,n){"use strict";n.d(t,"g",(function(){return b})),n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return h})),n.d(t,"f",(function(){return E})),n.d(t,"e",(function(){return j})),n.d(t,"d",(function(){return k})),n.d(t,"c",(function(){return w}));var a=n(45),i=n(56),r=n.n(i),s=n(324),o=n.n(s),l=n(1171),u=n.n(l),c=n(175),d=n(143),p=n(1156),m=n(307),f=n(686),g=n(27);const b=e=>{const t={unit:"ms",value:0},n=e.match(/\d+/g),i=e.match(/[a-zA-Z]+/g);return Object(a.isEmpty)(n)||null==n||isNaN(Number(n[0]))||(t.value=Number(n[0])),!Object(a.isEmpty)(i)&&null!=i&&["s","m","h","d"].includes(i[0])&&(t.unit=i[0]),t},y=(e,t)=>{switch(t){case"machine_learning":const{index:t,queryBar:n,threshold:a,threatIndex:i,threatQueryBar:r,threatMapping:s,eqlOptions:o,newTermsFields:l,historyWindowSize:u,...c}=e;return c;case"threshold":const{anomalyThreshold:d,machineLearningJobId:p,threatIndex:m,threatQueryBar:f,threatMapping:g,eqlOptions:b,newTermsFields:y,historyWindowSize:v,...h}=e;return h;case"threat_match":const{anomalyThreshold:E,machineLearningJobId:x,threshold:j,eqlOptions:O,newTermsFields:S,historyWindowSize:k,...w}=e;return w;case"query":case"saved_query":const{anomalyThreshold:T,machineLearningJobId:I,threshold:C,threatIndex:M,threatQueryBar:_,threatMapping:A,eqlOptions:P,newTermsFields:F,historyWindowSize:D,...N}=e;return N;case"eql":const{anomalyThreshold:R,machineLearningJobId:L,threshold:z,threatIndex:B,threatQueryBar:q,threatMapping:$,newTermsFields:V,historyWindowSize:U,...H}=e;return H;case"new_terms":const{anomalyThreshold:Z,machineLearningJobId:G,threshold:Q,threatIndex:W,threatQueryBar:K,threatMapping:J,eqlOptions:Y,...X}=e;return X;case"esql":const{anomalyThreshold:ee,machineLearningJobId:te,threshold:ne,threatIndex:ae,threatQueryBar:ie,threatMapping:re,newTermsFields:se,historyWindowSize:oe,eqlOptions:le,index:ue,dataViewId:ce,...de}=e;return de}Object(d.a)(t)};function v(e){return e.filter((e=>"none"!==e.name))}const h=e=>e.filter((e=>"none"!==e.tactic.name)).map((e=>{var t;return{...e,technique:v(null!==(t=e.technique)&&void 0!==t?t:[]).map((e=>({...e,subtechnique:null!=e.subtechnique?v(e.subtechnique):[]})))}})),E=e=>{const t={...e};return e.dataSourceType===m.a.DataView?u()(t,["index","dataSourceType"]):e.dataSourceType===m.a.IndexPatterns?u()(t,["dataViewId","dataSourceType"]):t},x=e=>{var t,n,i,r,s,o,l,u,c,d,p,f,b,v,h,x,j,O,S,k,w,T,I,C,M,_,A,P,F,D,N,R,L,z,B,q,$,V,U,H,Z,G,Q,W,K,J,Y,X,ee,te;const ne=E(e),ae=y(ne,ne.ruleType),{ruleType:ie,timeline:re}=ae;var se;return{...{type:ie,...null!=re.id&&null!=re.title&&{timeline_id:re.id,timeline_title:re.title}},...(se=ae,Object(a.has)("anomalyThreshold",se)?{anomaly_threshold:ae.anomalyThreshold,machine_learning_job_id:ae.machineLearningJobId}:(e=>Object(a.has)("threshold",e))(ae)?{index:ae.index,filters:null===(t=ae.queryBar)||void 0===t?void 0:t.filters,language:null===(n=ae.queryBar)||void 0===n||null===(i=n.query)||void 0===i?void 0:i.language,query:null===(r=ae.queryBar)||void 0===r||null===(s=r.query)||void 0===s?void 0:s.query,saved_id:null!==(o=null===(l=ae.queryBar)||void 0===l?void 0:l.saved_id)&&void 0!==o?o:void 0,..."threshold"===ie&&{threshold:{field:null!==(u=null===(c=ae.threshold)||void 0===c?void 0:c.field)&&void 0!==u?u:[],value:null!==(d=parseInt(null===(p=ae.threshold)||void 0===p?void 0:p.value,10))&&void 0!==d?d:0,cardinality:Object(a.isEmpty)(null===(f=ae.threshold.cardinality)||void 0===f?void 0:f.field)||null==(null===(b=ae.threshold.cardinality)||void 0===b?void 0:b.value)?[]:[{field:ae.threshold.cardinality.field[0],value:parseInt(ae.threshold.cardinality.value,10)}]},...ae.enableThresholdSuppression&&{alert_suppression:{duration:ae.groupByDuration}}}}:(e=>Object(a.has)("threatIndex",e))(ae)?{index:ae.index,filters:null===(v=ae.queryBar)||void 0===v?void 0:v.filters,language:null===(h=ae.queryBar)||void 0===h||null===(x=h.query)||void 0===x?void 0:x.language,query:null===(j=ae.queryBar)||void 0===j||null===(O=j.query)||void 0===O?void 0:O.query,saved_id:null!==(S=null===(k=ae.queryBar)||void 0===k?void 0:k.saved_id)&&void 0!==S?S:void 0,threat_index:ae.threatIndex,threat_query:null===(w=ae.threatQueryBar)||void 0===w||null===(T=w.query)||void 0===T?void 0:T.query,threat_filters:null===(I=ae.threatQueryBar)||void 0===I?void 0:I.filters,threat_mapping:ae.threatMapping,threat_language:null===(C=ae.threatQueryBar)||void 0===C||null===(M=C.query)||void 0===M?void 0:M.language}:(e=>Object(a.has)("eqlOptions",e))(ae)?{index:ae.index,filters:null===(_=ae.queryBar)||void 0===_?void 0:_.filters,language:null===(A=ae.queryBar)||void 0===A||null===(P=A.query)||void 0===P?void 0:P.language,query:null===(F=ae.queryBar)||void 0===F||null===(D=F.query)||void 0===D?void 0:D.query,saved_id:null!==(N=null===(R=ae.queryBar)||void 0===R?void 0:R.saved_id)&&void 0!==N?N:void 0,timestamp_field:null===(L=ae.eqlOptions)||void 0===L?void 0:L.timestampField,event_category_override:null===(z=ae.eqlOptions)||void 0===z?void 0:z.eventCategoryField,tiebreaker_field:null===(B=ae.eqlOptions)||void 0===B?void 0:B.tiebreakerField}:(e=>Object(a.has)("newTermsFields",e))(ae)?{index:ae.index,filters:null===(q=ae.queryBar)||void 0===q?void 0:q.filters,language:null===($=ae.queryBar)||void 0===$||null===(V=$.query)||void 0===V?void 0:V.language,query:null===(U=ae.queryBar)||void 0===U||null===(H=U.query)||void 0===H?void 0:H.query,new_terms_fields:ae.newTermsFields,history_window_start:`now-${ae.historyWindowSize}`}:(e=>"esql"===Object(a.get)("queryBar.query.language",e))(ae)&&!("index"in ae)?{language:null===(Z=ae.queryBar)||void 0===Z||null===(G=Z.query)||void 0===G?void 0:G.language,query:null===(Q=ae.queryBar)||void 0===Q||null===(W=Q.query)||void 0===W?void 0:W.query}:{...ae.groupByFields.length>0?{alert_suppression:{group_by:ae.groupByFields,duration:ae.groupByRadioSelection===m.b.PerTimePeriod?ae.groupByDuration:void 0,missing_fields_strategy:ae.suppressionMissingFields||g.a}}:{},index:ae.index,filters:null===(K=ae.queryBar)||void 0===K?void 0:K.filters,language:null===(J=ae.queryBar)||void 0===J||null===(Y=J.query)||void 0===Y?void 0:Y.language,query:null===(X=ae.queryBar)||void 0===X||null===(ee=X.query)||void 0===ee?void 0:ee.query,saved_id:void 0,type:"query",...["query","saved_query"].includes(ie)&&(null===(te=ae.queryBar)||void 0===te?void 0:te.saved_id)&&ae.shouldLoadQueryDynamically&&{type:"saved_query",query:void 0,filters:void 0,saved_id:ae.queryBar.saved_id}}),..."dataViewId"in ae?{data_view_id:ae.dataViewId}:{}}},j=e=>{const{...t}=e;if(!Object(a.isEmpty)(t.interval)&&!Object(a.isEmpty)(t.from)){const{unit:e,value:n}=b(t.interval),{unit:a,value:i}=b(t.from),s=r.a.duration(n,e);s.add(i,a),t.from=`now-${s.asSeconds()}s`,t.to="now"}return{...t,meta:{from:e.from}}},O=(e,t)=>{const{author:n,falsePositives:i,investigationFields:r,references:s,riskScore:o,severity:l,threat:u,isAssociatedToEndpointList:d,isBuildingBlock:p,note:m,ruleNameOverride:f,threatIndicatorPath:g,timestampOverride:b,timestampOverrideFallbackDisabled:y,...v}=e,E=null!=t?t.filter((e=>"endpoint"!==e.type)):[],x=r.every((e=>Object(a.isEmpty)(e.trim())));return{author:n.filter((e=>!Object(a.isEmpty)(e))),...p?{building_block_type:"default"}:{},...d?{exceptions_list:[{id:c.k,list_id:c.k,namespace_type:"agnostic",type:"endpoint"},...E]}:null!=t?{exceptions_list:[...E]}:{},false_positives:i.filter((e=>!Object(a.isEmpty)(e))),references:s.filter((e=>!Object(a.isEmpty)(e))),investigation_fields:x?void 0:{field_names:r},risk_score:o.value,risk_score_mapping:o.isMappingChecked?o.mapping.filter((e=>null!=e.field&&""!==e.field)):[],rule_name_override:""!==f?f:void 0,severity:l.value,severity_mapping:l.isMappingChecked?l.mapping.filter((e=>null!=e.field&&""!==e.field&&null!=e.value)):[],threat:h(u).map((e=>({...e,framework:"MITRE ATT&CK"}))),threat_indicator_path:g,timestamp_override:""!==b?b:void 0,timestamp_override_fallback_disabled:y,...Object(a.isEmpty)(m)?{}:{note:m},...v}},S=e=>{const{actions:t=[],responseActions:n,enabled:a,kibanaSiemAppUrl:i}=e;return{actions:t.map((e=>Object(p.b)(e))),response_actions:null==n?void 0:n.map(p.c),enabled:a,meta:{kibana_siem_app_url:i}}},k=(e,t,n,a,i)=>o.a.all([x(e),O(t,i),j(n),S(a)]),w=({defineRuleData:e,aboutRuleData:t,scheduleRuleData:n,exceptionsList:a})=>{const i={...t,name:"Preview Rule",description:"Preview Rule"};return{...k(e,i,n,f.c,a)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(2),i=n(50),r=n(410),s=n(163),o=n(337);const l=["GET",r.b],u=e=>Object(i.useQuery)(l,(async({signal:e})=>await Object(s.i)({signal:e})),{...o.a,...e}),c=()=>{const e=Object(i.useQueryClient)();return Object(a.useCallback)((()=>{e.invalidateQueries(l,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"x",(function(){return s})),n.d(t,"t",(function(){return o})),n.d(t,"v",(function(){return l})),n.d(t,"y",(function(){return u})),n.d(t,"w",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"s",(function(){return m})),n.d(t,"u",(function(){return f})),n.d(t,"o",(function(){return g})),n.d(t,"n",(function(){return b})),n.d(t,"m",(function(){return y})),n.d(t,"j",(function(){return v})),n.d(t,"h",(function(){return h})),n.d(t,"i",(function(){return E})),n.d(t,"f",(function(){return x})),n.d(t,"p",(function(){return j})),n.d(t,"q",(function(){return O})),n.d(t,"r",(function(){return S})),n.d(t,"l",(function(){return k})),n.d(t,"k",(function(){return w})),n.d(t,"g",(function(){return T})),n.d(t,"c",(function(){return I}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.pageTitle",{defaultMessage:"MITRE ATT&CKÂ® coverage"}),r=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.collapseCellsButton",{defaultMessage:"Collapse cells"}),s=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.expandCellsButton",{defaultMessage:"Expand cells"}),o=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRulesMetadataLabel",{defaultMessage:"Disabled Rules:"}),l=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRulesMetadataLabel",{defaultMessage:"Enabled Rules:"}),u=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.subtechniques",{defaultMessage:"Sub-techniques"}),c=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enableAllDisabledButtonLabel",{defaultMessage:"Enable all disabled"}),d=(e,t)=>a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.coveredMitreTechniques",{values:{enabledTechniques:e,totalTechniques:t},defaultMessage:"{enabledTechniques}/{totalTechniques} techniques"}),p=(e,t)=>a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.coveredMitreSubtechniques",{values:{enabledSubtechniques:e,totalSubtechniques:t},defaultMessage:"Sub-techniques {enabledSubtechniques}/{totalSubtechniques}"}),m=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRulesListLabel",{defaultMessage:"Disabled rules"}),f=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRulesListLabel",{defaultMessage:"Enabled rules"}),g=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendTitle",{defaultMessage:"Legend"}),b=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendSubtitle",{defaultMessage:"(count will include all rules selected)"}),y=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.legendRulesLabel",{defaultMessage:"rules"}),v=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.enabledRuleActivity",{defaultMessage:"Enabled rules"}),h=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.disabledRuleActivity",{defaultMessage:"Disabled rules"}),E=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.elasticRuleSource",{defaultMessage:"Elastic rules"}),x=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.customRuleSource",{defaultMessage:"Custom rules"}),j=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.ruleActivityFilterLabel",{defaultMessage:"Installed rule status"}),O=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.ruleSourceFilterLabel",{defaultMessage:"Installed rule type"}),S=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.searchBarPlaceholder",{defaultMessage:'Search for the tactic, technique (e.g.,"defense evasion" or "TA0005") or rule name'}),k=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.filterPopoverTitle",{defaultMessage:"Select to view on framework"}),w=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.filterPopoverClearAll",{defaultMessage:"Clear all"}),T=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.dashboardInformation",{defaultMessage:"Your current coverage of MITRE ATT&CKÂ® tactics and techniques, based on installed rules. Click a cell to view and enable a technique's rules. Rules must be mapped to the MITRE ATT&CKÂ® framework to be displayed."}),I=a.i18n.translate("xpack.securitySolution.coverageOverviewDashboard.fetchErrorTitle",{defaultMessage:"Failed to fetch coverage overview data"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(29),i=n(50),r=n(2),s=n(163),o=n(337);const l=["GET",a.INTERNAL_ALERTING_API_FIND_RULES_PATH],u=(e,t)=>Object(i.useQuery)([...l,...e],(({signal:t})=>Object(s.k)({ids:e,signal:t})),{...o.a,...t}),c=()=>{const e=Object(i.useQueryClient)();return Object(r.useCallback)((()=>e.invalidateQueries(l,{refetchType:"active"})),[e])}},function(e,t,n){"use strict";n.d(t,"m",(function(){return i})),n.d(t,"k",(function(){return r})),n.d(t,"l",(function(){return s})),n.d(t,"i",(function(){return o})),n.d(t,"j",(function(){return l})),n.d(t,"h",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"f",(function(){return g})),n.d(t,"e",(function(){return b}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.requestError",{defaultMessage:"An error occurred while validating your EQL query"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.title",{defaultMessage:"EQL Validation Errors"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlValidation.showErrorsLabel",{defaultMessage:"Show EQL Validation Errors"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOverViewLink.text",{defaultMessage:"Event Query Language (EQL) Overview"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlSettings.title",{defaultMessage:"EQL settings"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.label",{defaultMessage:"Size"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsSize.text",{defaultMessage:"For basic queries, the maximum number of matching events to return. For sequence queries, the maximum number of matching sequences to return."}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.label",{defaultMessage:"Event category field"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventCategoryField.text",{defaultMessage:"Field containing the event classification, such as process, file, or network. This field is typically mapped as a field type in the keyword family"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.label",{defaultMessage:"Tiebreaker field"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTiebreakerField.text",{defaultMessage:"Field used to sort hits with the same timestamp in ascending, lexicographic order"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.label",{defaultMessage:"Timestamp field"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.eqlOptionsEventTimestampField.text",{defaultMessage:"Field containing event timestamp"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));class BadRequestError extends Error{}n(622),n(623);var a=n(973),i=n.n(a),r=n(182),s=n(111),o=n(295),l=n(4),u=n(554);const c=async({body:e,dataViewService:t,dataViewId:n})=>{if(null===n)return;let a=await t.getIdsWithTitle();const c=a.find((e=>e.id===n)),{patternList:d}=e,p=Object(o.a)(d).join();let m;if(void 0===c)try{m=await t.createAndSave({allowNoIndex:!0,id:n,title:p,timeFieldName:l.X},!0)}catch(e){const a=(e=>i.a.isBoom(e)?{message:e.output.payload.message,statusCode:e.output.statusCode}:e instanceof s.ZodError?{message:Object(r.f)(e),statusCode:500}:null!=e.statusCode?null!=e.body&&null!=e.body.error?{statusCode:e.statusCode,message:`${e.body.error.type}: ${e.body.error.reason}`}:{statusCode:e.statusCode,message:e.message}:e instanceof BadRequestError?{message:e.message,statusCode:400}:{message:null!=e.message?e.message:"(unknown error message)",statusCode:500})(e);if("DuplicateDataViewError"!==e.name&&409!==a.statusCode)throw a;m=await t.get(n)}else{const e=c?Object(o.a)(c.title.split(",")).join():"";m=await t.get(n),p!==e&&(m.title=p,await t.updateSavedObject(m))}if(a.some((e=>e.id===n)))a=a.map((e=>e.id===n?{...e,title:p}:e));else if(null!==m){var f,g;a.push({id:null!==(f=m.id)&&void 0!==f?f:n,title:null===(g=m)||void 0===g?void 0:g.title})}const b=await Object(u.a)(n,t);return{defaultDataView:b,kibanaDataViews:a.map((e=>e.id===n?b:{id:e.id,patternList:e.title.split(","),title:e.title}))}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return E})),n.d(t,"e",(function(){return x}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r);const o=s.a.aside.attrs({className:"siemUtilityBar"}).withConfig({displayName:"Bar",componentId:"sc-yj1vvr-0"})(["",""],(({border:e,theme:t})=>Object(r.css)([""," @media only screen and (min-width:","){display:flex;justify-content:space-between;}"],e&&Object(r.css)(["border-bottom:",";padding-bottom:",";align-items:center;"],t.eui.euiBorderThin,t.eui.euiSizeXS),t.eui.euiBreakpoints.l)));o.displayName="Bar";const l=s.a.div.attrs({className:"siemUtilityBar__section"}).withConfig({displayName:"BarSection",componentId:"sc-yj1vvr-1"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["& + &{margin-top:",";align-items:center;}@media only screen and (min-width:","){display:flex;flex-wrap:wrap;}@media only screen and (min-width:","){& + &{margin-top:0;margin-left:",";}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBreakpoints.l,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));l.displayName="BarSection";const u=s.a.div.attrs({className:"siemUtilityBar__group"}).withConfig({displayName:"BarGroup",componentId:"sc-yj1vvr-2"})(["",""],(({grow:e,theme:t})=>Object(r.css)(["align-items:flex-start;display:flex;flex-wrap:wrap;& + &{margin-top:",";}@media only screen and (min-width:","){border-right:",";flex-wrap:nowrap;margin-right:",";padding-right:",";& + &{margin-top:0;}&:last-child{border-right:none;margin-right:0;padding-right:0;}}& > *{margin-right:",";&:last-child{margin-right:0;}}",""],t.eui.euiSizeS,t.eui.euiBreakpoints.m,t.eui.euiBorderThin,t.eui.euiSizeM,t.eui.euiSizeM,t.eui.euiSize,e&&Object(r.css)(["flex:1;"]))));u.displayName="BarGroup";const c=s.a.p.attrs((({className:e})=>({className:e||"siemUtilityBar__text"}))).withConfig({displayName:"BarText",componentId:"sc-yj1vvr-3"})(["",""],(({shouldWrap:e,theme:t})=>Object(r.css)(["color:",";font-size:",";line-height:",";white-space:",";"],t.eui.euiTextSubduedColor,t.eui.euiFontSizeXS,t.eui.euiLineHeight,e?"normal":"nowrap")));c.displayName="BarText";const d=s.a.div.attrs({className:"siemUtilityBar__action"}).withConfig({displayName:"BarAction",componentId:"sc-yj1vvr-4"})(["",""],(({theme:e})=>Object(r.css)(["font-size:",";"],e.eui.euiFontSizeXS)));d.displayName="BarAction";const p=s.a.div.attrs({className:"siemUtilityBar__spacer"}).withConfig({displayName:"BarSpacer",componentId:"sc-yj1vvr-5"})(["",""],(()=>Object(r.css)(["flex:1;"])));p.displayName="BarSpacer";const m=i.a.memo((({border:e,children:t})=>i.a.createElement(o,{border:e},t)));m.displayName="UtilityBar";var f=n(17),g=n(713);const b=s()(f.EuiButtonEmpty).withConfig({displayName:"LoadingButtonEmpty",componentId:"sc-ou55gk-0"})(["",""],(({theme:e})=>Object(r.css)(["&.euiButtonEmpty{height:",";}"],e.eui.euiSize))),y=i.a.memo((({children:e,color:t,iconSide:n,iconSize:r,iconType:s,popoverContent:o,disabled:l,ownFocus:u,dataTestSubj:c,popoverPanelPaddingSize:d,onClick:p})=>{const[m,b]=Object(a.useState)(!1),y=Object(a.useCallback)((()=>b(!1)),[b]),v=Object(a.useCallback)((()=>{null==p||p(),b(!m)}),[m,p]);return i.a.createElement(f.EuiPopover,{ownFocus:u,panelPaddingSize:d,button:i.a.createElement(g.a,{dataTestSubj:c,color:t,iconSide:n,iconSize:r,iconType:s,disabled:l,onClick:v},e),closePopover:y,isOpen:m,repositionOnScroll:!0},null==o?void 0:o(y))}));y.displayName="Popover";const v=i.a.memo((({children:e,color:t,dataTestSubj:n,disabled:a,href:r,iconSide:s,iconSize:o,iconType:l,ownFocus:u,onClick:c,popoverContent:p,popoverPanelPaddingSize:m,inProgress:f})=>f?i.a.createElement(d,null,i.a.createElement(b,{"data-test-subj":`${n}-progress`,size:"xs",className:"eui-alignTop",isLoading:!0,iconSide:"right",flush:"both"},e)):i.a.createElement(d,{"data-test-subj":n},p?i.a.createElement(y,{dataTestSubj:`${n}-popover`,disabled:a,color:t,iconSide:s,iconSize:o,iconType:l,ownFocus:u,popoverPanelPaddingSize:m,popoverContent:p,onClick:c},e):i.a.createElement(g.a,{color:t,dataTestSubj:`${n}-linkIcon`,disabled:a,href:r,iconSide:s,iconSize:o,iconType:l,onClick:c},e))));v.displayName="UtilityBarAction";const h=i.a.memo((({grow:e,children:t})=>i.a.createElement(u,{grow:e},t)));h.displayName="UtilityBarGroup";const E=i.a.memo((({grow:e,children:t,dataTestSubj:n})=>i.a.createElement(l,{grow:e,"data-test-subj":n},t)));E.displayName="UtilityBarSection",i.a.memo((({dataTestSubj:e})=>i.a.createElement(p,{"data-test-subj":e}))).displayName="UtilityBarSpacer";const x=i.a.memo((({children:e,dataTestSubj:t,shouldWrap:n=!1,className:a})=>i.a.createElement(c,{"data-test-subj":t,shouldWrap:n,className:a},e)));x.displayName="UtilityBarText"},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=`${n(4).Db}/fleet/integrations/installed`},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return h}));var a=n(80),i=n(124),r=n(89),s=n(167),o=n(195),l=n(138),u=n(149),c=n(116),d=n(392),p=n(610),m=n(635),f=n(1274),g=n(187),b=n(903);const y=Object(g.reducerWithInitialState)({app:void 0,internal:void 0,savedSearch:void 0}).case(b.a,((e,{newState:t})=>({...e,app:{...e.app,...t}}))).case(b.b,((e,{newState:t})=>({...e,internal:t}))).case(b.c,((e,{newState:t})=>({...e,savedSearch:t})));Object(r.enableMapSet)();const v=(e,{defaultDataView:t,kibanaDataViews:n,signalIndexName:a,enableExperimental:i},r,m,f)=>{const g={[c.SourcererScopeName.default]:Object(d.b)(t,c.SourcererScopeName.default,a,!0),[c.SourcererScopeName.detections]:Object(d.b)(t,c.SourcererScopeName.detections,a,!0),[c.SourcererScopeName.timeline]:Object(d.b)(t,c.SourcererScopeName.timeline,a,!0)};return{...e,app:{...s.d,enableExperimental:i},dragAndDrop:o.d,inputs:Object(l.a)(i.socTrendsEnabled),sourcerer:{...u.b.initialSourcererState,sourcererScopes:{...u.b.initialSourcererState.sourcererScopes,[c.SourcererScopeName.default]:{...u.b.initialSourcererState.sourcererScopes.default,selectedDataViewId:t.id,selectedPatterns:g[c.SourcererScopeName.default]},[c.SourcererScopeName.detections]:{...u.b.initialSourcererState.sourcererScopes.detections,selectedDataViewId:t.id,selectedPatterns:g[c.SourcererScopeName.detections]},[c.SourcererScopeName.timeline]:{...u.b.initialSourcererState.sourcererScopes.timeline,selectedDataViewId:t.id,selectedPatterns:g[c.SourcererScopeName.timeline]}},defaultDataView:t,kibanaDataViews:n.map((e=>({...c.initDataView,...e}))),signalIndexName:a},globalUrlParam:p.d,dataTable:r.dataTable,groups:m.groups,analyzer:f.analyzer,discover:{app:void 0,internal:void 0,savedSearch:void 0}}},h=e=>Object(a.combineReducers)({app:s.b,dragAndDrop:o.b,inputs:l.c,sourcerer:u.c,globalUrlParam:p.b,dataTable:i.i,groups:m.a,analyzer:f.a,discover:y,...e})},function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return v}));var a=n(50),i=n(2),r=n(473),s=n(289),o=n(163),l=n(9);const u=["TA0043","TA0042","TA0001","TA0002","TA0003","TA0004","TA0005","TA0006","TA0007","TA0008","TA0009","TA0011","TA0010","TA0040"],c=()=>n.e(20).then(n.bind(null,1695));function d(e){const t={totalRulesCount:Object.keys(e).length,totalEnabledRulesCount:0};for(const n of Object.keys(e))e[n].activity===s.b.Enabled&&t.totalEnabledRulesCount++;return t}function p(e){const t={enabledRules:[],disabledRules:[],availableRules:[]};for(const n of e.unmapped_rule_ids)m(t,n,e.rules_data[n]);return t}function m(e,t,n){n&&(n.activity===s.b.Enabled?e.enabledRules.push({id:t,name:n.name}):n.activity===s.b.Disabled&&e.disabledRules.push({id:t,name:n.name}))}var f=n(337),g=n(117);const b=["POST",s.d],y=(e={},t)=>{const{addError:n}=Object(g.a)();return Object(a.useQuery)([...b,e],(async({signal:t})=>async function(e){const t=await c(),{tactics:n,techniques:a,subtechniques:i}=t,r=function(e,t,n){const a=new Map;for(const e of n){const t={id:e.id,name:e.name,reference:e.reference,enabledRules:[],disabledRules:[],availableRules:[]},n=a.get(e.techniqueId);n?n.push(t):a.set(e.techniqueId,[t])}const i=new Map;for(const e of t){var r;const t=null!==(r=a.get(e.id))&&void 0!==r?r:[];for(const n of e.tactics){const a={id:e.id,name:e.name,reference:e.reference,subtechniques:t,enabledRules:[],disabledRules:[],availableRules:[]},r=i.get(n);r?r.push(a):i.set(n,[a])}}const s=e.sort(((e,t)=>u.indexOf(e.id)-u.indexOf(t.id))),o=[];for(const e of s){var c;o.push({id:e.id,name:e.name,reference:e.reference,techniques:null!==(c=i.get(Object(l.kebabCase)(e.name)))&&void 0!==c?c:[],enabledRules:[],disabledRules:[],availableRules:[]})}return o}(n,a,i);for(const t of r){for(const n of null!==(s=e.coverage[t.id])&&void 0!==s?s:[]){var s;m(t,n,e.rules_data[n])}for(const n of t.techniques){for(const a of null!==(o=e.coverage[n.id])&&void 0!==o?o:[]){var o,f;null!==(f=e.coverage[t.id])&&void 0!==f&&f.includes(a)&&m(n,a,e.rules_data[a])}for(const a of n.subtechniques)for(const n of null!==(g=e.coverage[a.id])&&void 0!==g?g:[]){var g,b;null!==(b=e.coverage[t.id])&&void 0!==b&&b.includes(n)&&m(a,n,e.rules_data[n])}}}return{mitreTactics:r,unmappedRules:p(e),metrics:d(e.rules_data)}}(await Object(o.g)({signal:t,filter:e}))),{...f.a,...t,onError:e=>{n(e,{title:r.c})}})},v=()=>{const e=Object(a.useQueryClient)();return Object(i.useCallback)((()=>{e.invalidateQueries(b,{refetchType:"active"})}),[e])}},function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return b}));var a=n(61),i=n.n(a),r=n(294),s=n(198),o=n(51);const l=Object(o.v4)();var u,c,d=n(725);const p=(e,t)=>n=>`${d.g}: ${i()(n).format(e)} ${t?d.f(n):d.e(n)}`,m=[{text:"event.action",value:"event.action"},{text:"event.dataset",value:"event.dataset"},{text:"event.module",value:"event.module"}],f={defaultStackByOption:null!==(u=m.find((e=>"event.action"===e.text)))&&void 0!==u?u:m[0],errorMessage:d.c,histogramType:r.i.events,stackByOptions:m,subtitle:void 0,title:d.d,getLensAttributes:(e="event.action",t={})=>{var n;return{title:"Events",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:l,accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:null!==(n=t.filters)&&void 0!==n?n:[],datasourceStates:{formBased:{layers:{[l]:{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${l}`}]}}},g=[{text:"event.category",value:"event.category"},{text:"event.module",value:"event.module"}],b={defaultStackByOption:null!==(c=g.find((e=>"event.module"===e.text)))&&void 0!==c?c:g[0],errorMessage:d.b,histogramType:r.i.alerts,stackByOptions:g,subtitle:void 0,title:d.a,getLensAttributes:(e="event.module")=>({title:"External alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:"a3c54471-615f-4ff9-9fda-69b5b2ea3eef",accessors:["0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"37bdf546-3c11-4b08-8c5d-e37debc44f1d",splitAccessor:"42334c6e-98d9-47a2-b4cb-a445abb44c93"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:[{meta:{index:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",alias:null,negate:!1,disabled:!1,type:"phrase",key:"event.kind",params:{query:"alert"}},query:{match_phrase:{"event.kind":"alert"}},$state:{store:"appState"}}],datasourceStates:{formBased:{layers:{"a3c54471-615f-4ff9-9fda-69b5b2ea3eef":{columns:{"37bdf546-3c11-4b08-8c5d-e37debc44f1d":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"0a923af2-c880-4aa3-aa93-a0b9c2801f6d":{label:s.g,dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"42334c6e-98d9-47a2-b4cb-a445abb44c93":{label:Object(s.p)(`${e}`),dataType:"string",operationType:"terms",scale:"ordinal",sourceField:`${e}`,isBucketed:!0,params:{size:10,orderBy:{type:"column",columnId:"0a923af2-c880-4aa3-aa93-a0b9c2801f6d"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"}}}},columnOrder:["42334c6e-98d9-47a2-b4cb-a445abb44c93","37bdf546-3c11-4b08-8c5d-e37debc44f1d","0a923af2-c880-4aa3-aa93-a0b9c2801f6d"],incompleteColumns:{}}}}}},references:[{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-current-indexpattern"},{type:"index-pattern",id:"{dataViewId}",name:"indexpattern-datasource-layer-a3c54471-615f-4ff9-9fda-69b5b2ea3eef"},{type:"index-pattern",name:"723c4653-681b-4105-956e-abef287bf025",id:"{dataViewId}"},{type:"index-pattern",name:"a04472fc-94a3-4b8d-ae05-9d30ea8fbd6a",id:"{dataViewId}"}]})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(45),i=n(429),r=n(2),s=n(561),o=n(405),l=n(194),u=n(154),c=n(215),d=n(720),p=n(520);const m={[c.e]:{id:c.e,isDefault:!0,messages:[],apiConfig:{}},[i.a]:{id:i.a,isDefault:!0,messages:[],apiConfig:{}},[u.yb]:{id:u.yb,isDefault:!0,messages:[],apiConfig:{}},[c.i]:{id:c.i,isDefault:!0,messages:[],apiConfig:{}},[p.a]:{excludeFromLastConversationStorage:!0,id:p.a,isDefault:!0,messages:[],apiConfig:{}},[l.h]:{id:l.h,isDefault:!0,theme:{title:l.e,titleIcon:"logoSecurity",assistant:{name:d.f,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}},messages:[],apiConfig:{}}};var f=n(20),g=n(39);const b=()=>{const e=Object(f.f)(g.SecurityPageName.dataQuality),t=Object(r.useMemo)((()=>e?m:Object(a.unset)(i.a,m)),[e]),[n,l]=Object(s.a)({defaultValue:t,key:o.a,isInvalidDefault:e=>!e});return{conversations:n,setConversations:l}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(2),i=n(157),r=n(20);const s=e=>{const t=o();return Object(a.useMemo)((()=>t(e)),[t,e])},o=()=>{const e=Object(i.a)();return Object(a.useCallback)((t=>((e,t)=>Object(r.d)(e)&&t.length>0?`?${t}`:"")(t,e)),[e])}},function(e,t,n){"use strict";var a=n(971),i={"text/plain":"Text","text/html":"Url",default:"Text"};e.exports=function(e,t){var n,r,s,o,l,u,c=!1;t||(t={}),n=t.debug||!1;try{if(s=a(),o=document.createRange(),l=document.getSelection(),(u=document.createElement("span")).textContent=e,u.style.all="unset",u.style.position="fixed",u.style.top=0,u.style.clip="rect(0, 0, 0, 0)",u.style.whiteSpace="pre",u.style.webkitUserSelect="text",u.style.MozUserSelect="text",u.style.msUserSelect="text",u.style.userSelect="text",u.addEventListener("copy",(function(a){if(a.stopPropagation(),t.format)if(a.preventDefault(),void 0===a.clipboardData){n&&console.warn("unable to use e.clipboardData"),n&&console.warn("trying IE specific stuff"),window.clipboardData.clearData();var r=i[t.format]||i.default;window.clipboardData.setData(r,e)}else a.clipboardData.clearData(),a.clipboardData.setData(t.format,e);t.onCopy&&(a.preventDefault(),t.onCopy(a.clipboardData))})),document.body.appendChild(u),o.selectNodeContents(u),l.addRange(o),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");c=!0}catch(a){n&&console.error("unable to copy using execCommand: ",a),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData(t.format||"text",e),t.onCopy&&t.onCopy(window.clipboardData),c=!0}catch(a){n&&console.error("unable to copy using clipboardData: ",a),n&&console.error("falling back to prompt"),r=function(e){var t=(/mac os x/i.test(navigator.userAgent)?"âŒ˜":"Ctrl")+"+C";return e.replace(/#{\s*key\s*}/g,t)}("message"in t?t.message:"Copy to clipboard: #{key}, Enter"),window.prompt(r,e)}}finally{l&&("function"==typeof l.removeRange?l.removeRange(o):l.removeAllRanges()),u&&document.body.removeChild(u),s()}return c}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>Object.keys(t).reduce(((e,n)=>e.replace(new RegExp(`\\{${n}\\}`,"g"),String(t[n]))),e)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return s}));var a=n(272),i=n(150);n.d(t,"a",(function(){return i.a}));const r=Object.keys(a.d),s=e=>r.includes(e)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(51);const i=()=>Object(a.v4)(),r=({prevPromptContexts:e,promptContext:t})=>({...e,[t.id]:{...t}})},function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"i",(function(){return r})),n.d(t,"j",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"b",(function(){return m})),n.d(t,"g",(function(){return f}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAriaLabel",{defaultMessage:"Settings"}),r=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsTooltip",{defaultMessage:"Settings"}),s=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsUpdatedToastTitle",{defaultMessage:"Settings updated"}),o=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsConversationsMenuItemTitle",{defaultMessage:"Conversations"}),l=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsQuickPromptsMenuItemTitle",{defaultMessage:"Quick Prompts"}),u=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsSystemPromptsMenuItemTitle",{defaultMessage:"System Prompts"}),c=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsAnonymizationMenuItemTitle",{defaultMessage:"Anonymization"}),d=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsKnowledgeBaseMenuItemTitle",{defaultMessage:"Knowledge Base"}),p=a.i18n.translate("xpack.elasticAssistant.assistant.settings.settingsEvaluationMenuItemTitle",{defaultMessage:"Evaluation"}),m=(a.i18n.translate("xpack.elasticAssistant.assistant.settings.modalTitle",{defaultMessage:"System Prompts"}),a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slCancelButtonTitle",{defaultMessage:"Cancel"})),f=a.i18n.translate("xpack.elasticAssistant.assistant.promptEditor.systemPrompt.slSaveButtonTitle",{defaultMessage:"Save"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return o}));const a=e=>"string"!=typeof e,i=({field:e,list:t,operation:n})=>"add"===n?t.includes(e)?t:[...t,e]:t.filter((t=>t!==e)),r=({field:e,operation:t,selectedPromptContext:n,update:a})=>{const{allow:r,allowReplacement:s}=n;switch(a){case"allow":return{...n,allow:i({field:e,list:r,operation:t})};case"allowReplacement":return{...n,allowReplacement:i({field:e,list:s,operation:t})};default:return n}},s=({currentList:e,setDefaultList:t,update:n,updates:a})=>{const r=a.filter((e=>e.update===n));r.length>0&&t(r.reduce(((e,{field:t,operation:n})=>i({field:t,list:e,operation:n})),e))},o=({defaultAllow:e,defaultAllowReplacement:t,setDefaultAllow:n,setDefaultAllowReplacement:a,updates:i})=>{s({currentList:e,setDefaultList:n,update:"defaultAllow",updates:i}),s({currentList:t,setDefaultList:a,update:"defaultAllowReplacement",updates:i})}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.placeholderText",{defaultMessage:"Select or type to create new..."}),r=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.modelTitle",{defaultMessage:"Model"}),s=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.helpLabel",{defaultMessage:"Model to use for this connector"}),o=a.i18n.translate("xpack.elasticAssistant.connectors.models.modelSelector.customOptionText",{defaultMessage:"Create new Model named"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(17),i=n(2),r=n.n(i),s=n(220),o=n(177),l=n(497),u=n(123),c=n(252),d=n(548),p=n(13);const m="ADD_NEW_CONNECTOR",f=r.a.memo((({isDisabled:e=!1,isOpen:t=!1,displayFancy:n,selectedConnectorId:f,onConnectorSelectionChange:g,setIsOpen:b})=>{const{actionTypeRegistry:y,http:v,assistantAvailability:h}=Object(u.b)(),[E,x]=Object(i.useState)(!1),{data:j}=Object(l.a)({http:v}),[O,S]=Object(i.useState)(null),{data:k,isLoading:w,isFetching:T,refetch:I}=Object(s.a)({http:v}),C=Object(i.useMemo)((()=>k?k.map((e=>({...e,connectorTypeTitle:Object(c.a)(y.get(e.actionTypeId))}))):[]),[y,k]),M=w||T,_=e||!h.hasConnectorsReadPrivilege,A=Object(i.useMemo)((()=>({value:m,inputDisplay:o.e,dropdownDisplay:Object(p.jsx)(a.EuiFlexGroup,{gutterSize:"none",key:m},Object(p.jsx)(a.EuiFlexItem,{grow:!0},Object(p.jsx)(a.EuiButtonEmpty,{"data-test-subj":"addNewConnectorButton",href:"#",iconType:"plus",size:"xs"},o.e)),Object(p.jsx)(a.EuiFlexItem,{grow:!1},Object(p.jsx)("div",{style:{width:"24px"}})))})),[]),P=Object(i.useMemo)((()=>C.map((e=>{var t,i;const s=null!==(t=null===(i=Object(c.b)(e))||void 0===i?void 0:i.apiProvider)&&void 0!==t?t:e.connectorTypeTitle,l=e.isPreconfigured?o.r:s;return{value:e.id,"data-test-subj":e.id,inputDisplay:n?n(e.name):e.name,dropdownDisplay:Object(p.jsx)(r.a.Fragment,{key:e.id},Object(p.jsx)("strong",null,e.name),l&&Object(p.jsx)(a.EuiText,{size:"xs",color:"subdued"},Object(p.jsx)("p",null,l)))}}))),[C,n]),F=Object(i.useMemo)((()=>h.hasConnectorsAllPrivilege?[...P,A]:[...P]),[A,h.hasConnectorsAllPrivilege,P]),D=Object(i.useCallback)((()=>{null==b||b(!1),x(!1),S(null)}),[b]),[N,R]=Object(i.useState)(t),L=Object(i.useCallback)((e=>{if(e===m)return R(!1),void x(!0);const t=C.find((t=>t.id===e));t&&g(t)}),[C,g]),z=Object(i.useCallback)((e=>{g({...e,connectorTypeTitle:Object(c.a)(y.get(e.actionTypeId))}),null==I||I(),D()}),[y,D,g,I]);return Object(p.jsx)(r.a.Fragment,null,Object(p.jsx)(a.EuiSuperSelect,{"aria-label":o.f,compressed:!0,"data-test-subj":"connector-selector",disabled:_,hasDividers:!0,isLoading:M,isOpen:N,onChange:L,options:F,valueOfSelected:null!=f?f:""}),E&&Object(p.jsx)(d.a,{actionTypeRegistry:y,actionTypes:j,onClose:()=>x(!1),onSaveConnector:z,onSelectActionType:e=>S(e),selectedActionType:O}))}));f.displayName="ConnectorSelector"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(50),i=n(76),r=n(72),s=n(177);const o=["elastic-assistant, load-action-types"],l=({http:e,toasts:t})=>Object(a.useQuery)(o,(async()=>(await Object(i.loadActionTypes)({http:e,featureId:r.GenerativeAIConnectorFeatureId})).sort(((e,t)=>e.name.localeCompare(t.name)))),{retry:!1,keepPreviousData:!0,staleTime:6e4,onError:e=>{"AbortError"!==e.name&&(null==t||t.addError(e.body&&e.body.message?new Error(e.body.message):e,{title:s.n}))}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var a=n(2),i=n.n(a),r=n(17),s=n(495),o=n(13);const l="gpt-3.5-turbo",u=[l,"gpt-4"],c=i.a.memo((({models:e=u,onModelSelectionChange:t,selectedModel:n=u[0]})=>{const[i,l]=Object(a.useState)(e.map((e=>({"data-test-subj":e,label:e})))),c=Object(a.useMemo)((()=>n?[{label:n}]:[]),[n]),d=Object(a.useCallback)((n=>{var a,i;const r=0===n.length?void 0:null!==(a=e.find((e=>{var t;return e===(null===(t=n[0])||void 0===t?void 0:t.label)})))&&void 0!==a?a:null===(i=n[0])||void 0===i?void 0:i.label;null==t||t(r)}),[t,e]),p=Object(a.useCallback)(((e,t=[])=>{if(!e||!e.trim().toLowerCase())return;const n=e.trim().toLowerCase(),a={value:e,label:e};-1!==t.findIndex((e=>e.label.trim().toLowerCase()===n))||l([...i,a]),d([a])}),[d,i]),m=Object(a.useCallback)((e=>{0===e.length?d([]):-1!==i.findIndex((t=>t.label===(null==e?void 0:e[0].label)))&&d(e)}),[d,i]);return Object(o.jsx)(r.EuiComboBox,{"aria-label":s.b,compressed:!0,"data-test-subj":"model-selector",isClearable:!1,placeholder:s.d,customOptionText:`${s.a} {searchValue}`,singleSelection:{asPlainText:!0},options:i,selectedOptions:c,onChange:m,onCreateOption:p,fullWidth:!0})}));c.displayName="ModelSelector"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importStar(n(2)),r=n(2),s=a.__importDefault(n(255)),o=a.__importDefault(n(772));t.default=function(e){return function(t){var n,l;l=i.isValidElement(t)?(n=t).props:t;var u=s.default({buffered:[],time:0,duration:0,paused:!0,muted:!1,volume:1}),c=u[0],d=u[1],p=r.useRef(null),m=function(e,t){return function(n){try{t&&t(n)}finally{e&&e(n)}}},f=function(){return d({paused:!1})},g=function(){return d({paused:!0})},b=function(){var e=p.current;e&&d({muted:e.muted,volume:e.volume})},y=function(){var e=p.current;if(e){var t=e.duration,n=e.buffered;d({duration:t,buffered:o.default(n)})}},v=function(){var e=p.current;e&&d({time:e.currentTime})},h=function(){var e=p.current;e&&d({buffered:o.default(e.buffered)})};n=n?i.cloneElement(n,a.__assign(a.__assign({controls:!1},l),{ref:p,onPlay:m(l.onPlay,f),onPause:m(l.onPause,g),onVolumeChange:m(l.onVolumeChange,b),onDurationChange:m(l.onDurationChange,y),onTimeUpdate:m(l.onTimeUpdate,v),onProgress:m(l.onProgress,h)})):i.createElement(e,a.__assign(a.__assign({controls:!1},l),{ref:p,onPlay:m(l.onPlay,f),onPause:m(l.onPause,g),onVolumeChange:m(l.onVolumeChange,b),onDurationChange:m(l.onDurationChange,y),onTimeUpdate:m(l.onTimeUpdate,v),onProgress:m(l.onProgress,h)}));var E=!1,x={play:function(){var e=p.current;if(e&&!E){var t=e.play();if("object"==typeof t){E=!0;var n=function(){E=!1};t.then(n,n)}return t}},pause:function(){var e=p.current;if(e&&!E)return e.pause()},seek:function(e){var t=p.current;t&&void 0!==c.duration&&(e=Math.min(c.duration,Math.max(0,e)),t.currentTime=e)},volume:function(e){var t=p.current;t&&(e=Math.min(1,Math.max(0,e)),t.volume=e,d({volume:e}))},mute:function(){var e=p.current;e&&(e.muted=!0)},unmute:function(){var e=p.current;e&&(e.muted=!1)}};return r.useEffect((function(){var e=p.current;e&&(d({volume:e.volume,muted:e.muted,paused:e.paused}),l.autoPlay&&e.paused&&x.play())}),[l.src]),[n,c,x,p]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e,t){return"boolean"==typeof t?t:!e};t.default=function(e){return a.useReducer(i,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(502)),s=n(301);t.default=function(e,t,n){void 0===e&&(e=0),void 0===t&&(t=null),void 0===n&&(n=null);var a=s.resolveHookState(e);"number"!=typeof a&&console.error("initialValue has to be a number, got "+typeof e),"number"==typeof n?a=Math.max(a,n):null!==n&&console.error("min has to be a number, got "+typeof n),"number"==typeof t?a=Math.min(a,t):null!==t&&console.error("max has to be a number, got "+typeof t);var o=r.default(a),l=o[0],u=o[1];return[l(),i.useMemo((function(){var e=function(e){var a=l(),i=s.resolveHookState(e,a);a!==i&&("number"==typeof n&&(i=Math.max(i,n)),"number"==typeof t&&(i=Math.min(i,t)),a!==i&&u(i))};return{get:l,set:e,inc:function(t){void 0===t&&(t=1);var n=s.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e+n}))},dec:function(t){void 0===t&&(t=1);var n=s.resolveHookState(t,l());"number"!=typeof n&&console.error("delta has to be a number or function returning a number, got "+typeof n),e((function(e){return e-n}))},reset:function(t){void 0===t&&(t=a);var n=s.resolveHookState(t,l());"number"!=typeof n&&console.error("value has to be a number or function returning a number, got "+typeof n),a=n,e(n)}}}),[a,n,t])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(223)),s=n(301);t.default=function(e){var t=i.useRef(s.resolveHookState(e)),n=r.default();return i.useMemo((function(){return[function(){return t.current},function(e){t.current=s.resolveHookState(e,t.current),n()}]}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useState(!1),i=n[0],r=n[1];return a.useEffect((function(){var n=function(){return r(!0)},a=function(){return r(!1)};t&&e&&e.current&&(e.current.addEventListener("mouseover",n),e.current.addEventListener("mouseout",a));var i=e.current;return function(){t&&i&&(i.removeEventListener("mouseover",n),i.removeEventListener("mouseout",a))}}),[t,e]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(302)),s=function(){};t.default=function(e,t,n,a){void 0===t&&(t=s),void 0===n&&(n={}),void 0===a&&(a=[e]);var o=n.event,l=void 0===o?"keydown":o,u=n.target,c=n.options,d=i.useMemo((function(){var n,a="function"==typeof(n=e)?n:"string"==typeof n?function(e){return e.key===n}:n?function(){return!0}:function(){return!1};return function(e){if(a(e))return t(e)}}),a);r.default(l,d,u,c)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(504));t.default=function(e){var t=i.useState([!1,null]),n=t[0],a=t[1];return r.default(e,(function(e){return a([!0,e])}),{event:"keydown"},[n]),r.default(e,(function(e){return a([!1,e])}),{event:"keyup"},[n]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useRef(e);return t.current=e,t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){a.useEffect((function(){return e&&e(),function(){t&&t()}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(223)),s=n(301);t.default=function(e){void 0===e&&(e=[]);var t=i.useRef(s.resolveHookState(e)),n=r.default(),a=i.useMemo((function(){var i={set:function(e){t.current=s.resolveHookState(e,t.current),n()},push:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];e.length&&a.set((function(t){return t.concat(e)}))},updateAt:function(e,t){a.set((function(n){var a=n.slice();return a[e]=t,a}))},insertAt:function(e,t){a.set((function(n){var a=n.slice();return e>a.length?a[e]=t:a.splice(e,0,t),a}))},update:function(e,t){a.set((function(n){return n.map((function(n){return e(n,t)?t:n}))}))},updateFirst:function(e,n){var i=t.current.findIndex((function(t){return e(t,n)}));i>=0&&a.updateAt(i,n)},upsert:function(e,n){var i=t.current.findIndex((function(t){return e(t,n)}));i>=0?a.updateAt(i,n):a.push(n)},sort:function(e){a.set((function(t){return t.slice().sort(e)}))},filter:function(e,t){a.set((function(n){return n.slice().filter(e,t)}))},removeAt:function(e){a.set((function(t){var n=t.slice();return n.splice(e,1),n}))},clear:function(){a.set([])},reset:function(){a.set(s.resolveHookState(e).slice())}};return i.remove=i.removeAt,i}),[]);return[t.current,a]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(256));t.default=function(e){a.default((function(){e()}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(257));t.default=function(e){var t=r.default({docX:0,docY:0,posX:0,posY:0,elX:0,elY:0,elH:0,elW:0}),n=t[0],a=t[1];return i.useEffect((function(){var t=function(t){if(e&&e.current){var n=e.current.getBoundingClientRect(),i=n.left,r=n.top,s=n.width,o=n.height,l=i+window.pageXOffset,u=r+window.pageYOffset,c=t.pageX-l,d=t.pageY-u;a({docX:t.pageX,docY:t.pageY,posX:l,posY:u,elX:c,elY:d,elH:o,elW:s})}};return document.addEventListener("mousemove",t),function(){document.removeEventListener("mousemove",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(40));t.default=function(e,t){void 0===e&&(e=1e12),void 0===t&&(t=0);var n=i.useState(0),a=n[0],s=n[1];return r.default((function(){var n,a,i,r=function(){var t=Math.min(1,(Date.now()-i)/e);s(t),o()},o=function(){n=requestAnimationFrame(r)},l=setTimeout((function(){a=setTimeout((function(){cancelAnimationFrame(n),s(1)}),e),i=Date.now(),o()}),t);return function(){clearTimeout(a),clearTimeout(l),cancelAnimationFrame(n)}}),[e,t]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=parseInt(i.version.substr(0,i.version.indexOf(".")))>15,s=function(e){return"function"==typeof e};t.default=function(e,t){for(var n=[],o=2;o<arguments.length;o++)n[o-2]=arguments[o];var l=e.render,u=e.children,c=void 0===u?l:u,d=e.component,p=e.comp,m=void 0===p?d:p;return s(c)?c.apply(void 0,a.__spreadArrays([t],n)):m?i.createElement(m,t):c instanceof Array?r?c:i.createElement.apply(void 0,a.__spreadArrays(["div",null],c)):c&&c instanceof Object?"string"==typeof c.type?c:i.cloneElement(c,Object.assign({},c.props,t)):c||null}},function(e,t,n){!function(e){"use strict";var t,n=[],a="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(t||(t={}));var i,r=function(e){return Object.freeze(e)},s=function(e,t){this.inlineSize=e,this.blockSize=t,r(this)},o=function(){function e(e,t,n,a){return this.x=e,this.y=t,this.width=n,this.height=a,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,r(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),l=function(e){return e instanceof SVGElement&&"getBBox"in e},u=function(e){if(l(e)){var t=e.getBBox(),n=t.width,a=t.height;return!n&&!a}var i=e,r=i.offsetWidth,s=i.offsetHeight;return!(r||s||e.getClientRects().length)},c=function(e){var t;if(e instanceof Element)return!0;var n=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(n&&e instanceof n.Element)},d="undefined"!=typeof window?window:{},p=new WeakMap,m=/auto|scroll/,f=/^tb|vertical/,g=/msie|trident/i.test(d.navigator&&d.navigator.userAgent),b=function(e){return parseFloat(e||"0")},y=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new s((n?t:e)||0,(n?e:t)||0)},v=r({devicePixelContentBoxSize:y(),borderBoxSize:y(),contentBoxSize:y(),contentRect:new o(0,0,0,0)}),h=function(e,t){if(void 0===t&&(t=!1),p.has(e)&&!t)return p.get(e);if(u(e))return p.set(e,v),v;var n=getComputedStyle(e),a=l(e)&&e.ownerSVGElement&&e.getBBox(),i=!g&&"border-box"===n.boxSizing,s=f.test(n.writingMode||""),c=!a&&m.test(n.overflowY||""),d=!a&&m.test(n.overflowX||""),h=a?0:b(n.paddingTop),E=a?0:b(n.paddingRight),x=a?0:b(n.paddingBottom),j=a?0:b(n.paddingLeft),O=a?0:b(n.borderTopWidth),S=a?0:b(n.borderRightWidth),k=a?0:b(n.borderBottomWidth),w=j+E,T=h+x,I=(a?0:b(n.borderLeftWidth))+S,C=O+k,M=d?e.offsetHeight-C-e.clientHeight:0,_=c?e.offsetWidth-I-e.clientWidth:0,A=i?w+I:0,P=i?T+C:0,F=a?a.width:b(n.width)-A-_,D=a?a.height:b(n.height)-P-M,N=F+w+_+I,R=D+T+M+C,L=r({devicePixelContentBoxSize:y(Math.round(F*devicePixelRatio),Math.round(D*devicePixelRatio),s),borderBoxSize:y(N,R,s),contentBoxSize:y(F,D,s),contentRect:new o(j,h,F,D)});return p.set(e,L),L},E=function(e,n,a){var i=h(e,a),r=i.borderBoxSize,s=i.contentBoxSize,o=i.devicePixelContentBoxSize;switch(n){case t.DEVICE_PIXEL_CONTENT_BOX:return o;case t.BORDER_BOX:return r;default:return s}},x=function(e){var t=h(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=r([t.borderBoxSize]),this.contentBoxSize=r([t.contentBoxSize]),this.devicePixelContentBoxSize=r([t.devicePixelContentBoxSize])},j=function(e){if(u(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},O=function(){var e=1/0,t=[];n.forEach((function(n){if(0!==n.activeTargets.length){var a=[];n.activeTargets.forEach((function(t){var n=new x(t.target),i=j(t.target);a.push(n),t.lastReportedSize=E(t.target,t.observedBox),i<e&&(e=i)})),t.push((function(){n.callback.call(n.observer,a,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var a=0,i=t;a<i.length;a++)(0,i[a])();return e},S=function(e){n.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(j(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},k=function(){var e,t=0;for(S(t);n.some((function(e){return e.activeTargets.length>0}));)t=O(),S(t);return n.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:a}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=a),window.dispatchEvent(e)),t>0},w=[],T=function(e){if(!i){var t=0,n=document.createTextNode("");new MutationObserver((function(){return w.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),i=function(){n.textContent="".concat(t?t--:t++)}}w.push(e),i()},I=0,C={attributes:!0,characterData:!0,childList:!0,subtree:!0},M=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],_=function(e){return void 0===e&&(e=0),Date.now()+e},A=!1,P=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t,n=this;if(void 0===e&&(e=250),!A){A=!0;var a=_(e);t=function(){var t=!1;try{t=k()}finally{if(A=!1,e=a-_(),!I)return;t?n.run(1e3):e>0?n.run(e):n.start()}},T((function(){requestAnimationFrame(t)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,C)};document.body?t():d.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),M.forEach((function(t){return d.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),M.forEach((function(t){return d.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),F=function(e){!I&&e>0&&P.start(),!(I+=e)&&P.stop()},D=function(){function e(e,n){this.target=e,this.observedBox=n||t.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=E(this.target,this.observedBox,!0);return e=this.target,!l(e)&&!function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)&&"inline"===getComputedStyle(e).display&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),N=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},R=new WeakMap,L=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},z=function(){function e(){}return e.connect=function(e,t){var n=new N(e,t);R.set(e,n)},e.observe=function(e,t,a){var i=R.get(e),r=0===i.observationTargets.length;L(i.observationTargets,t)<0&&(r&&n.push(i),i.observationTargets.push(new D(t,a&&a.box)),F(1),P.schedule())},e.unobserve=function(e,t){var a=R.get(e),i=L(a.observationTargets,t),r=1===a.observationTargets.length;i>=0&&(r&&n.splice(n.indexOf(a),1),a.observationTargets.splice(i,1),F(-1))},e.disconnect=function(e){var t=this,n=R.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),B=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");z.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!c(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");z.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!c(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");z.unobserve(this,e)},e.prototype.disconnect=function(){z.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();e.ResizeObserver=B,e.ResizeObserverEntry=x,e.ResizeObserverSize=s,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t){const n=/^[0-9]+$/,a=(e,t)=>{const a=n.test(e),i=n.test(t);return a&&i&&(e=+e,t=+t),e===t?0:a&&!i?-1:i&&!a?1:e<t?-1:1};e.exports={compareIdentifiers:a,rcompareIdentifiers:(e,t)=>a(t,e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(145);const l=s.a.div.withConfig({displayName:"ProviderContainerComponent",componentId:"sc-11ewwh0-0"})([""," ",""],(({isDragging:e})=>!e&&Object(r.css)(["&{border-radius:2px;padding:0 4px 0 8px;position:relative;z-index:"," !important;&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );background-position:0 0,1px 0,1px -1px,0px 1px;background-size:2px 2px;bottom:2px;content:'';display:block;left:2px;position:absolute;top:2px;width:4px;}}&:hover{&,& .euiBadge,& .euiBadge__text{cursor:move;cursor:grab;}}.",":hover &,tr:hover &{&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}&:hover,&:focus,.",":hover &:hover,.",":focus &:focus,tr:hover &:hover,tr:hover &:focus{background-color:",";&,& a,& a:hover{color:",";}&::before{background-image:linear-gradient( 135deg,"," 25%,transparent 25% ),linear-gradient( -135deg,"," 25%,transparent 25% ),linear-gradient( 135deg,transparent 75%,"," 75% ),linear-gradient( -135deg,transparent 75%,"," 75% );}}"],(({theme:e})=>e.eui.euiZLevel0),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),(({theme:e})=>e.eui.euiColorMediumShade),o.f,(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),(({theme:e})=>e.eui.euiColorDarkShade),o.f,o.f,(({theme:e})=>e.eui.euiColorPrimary),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade),(({theme:e})=>e.eui.euiColorEmptyShade))),(({isDragging:e})=>e&&Object(r.css)(["&{z-index:9999 !important;}"])));l.displayName="ProviderContainerComponent";const u=i.a.memo(l);u.displayName="ProviderContainer"},function(e,t,n){"use strict";n.d(t,"n",(function(){return i})),n.d(t,"o",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"m",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"g",(function(){return m})),n.d(t,"l",(function(){return f})),n.d(t,"i",(function(){return g})),n.d(t,"k",(function(){return b})),n.d(t,"f",(function(){return y})),n.d(t,"e",(function(){return v}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.timeline.tour.subTitle",{defaultMessage:"Recent Timeline improvements"}),r=a.i18n.translate("xpack.securitySolution.timeline.tour.newTimeline.title",{defaultMessage:"Actions are now easier to find"}),s=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.title",{defaultMessage:"The query builder is collapsed by default"}),o=a.i18n.translate("xpack.securitySolution.timeline.tour.dataProviderToggle.description",{defaultMessage:"Click to expand or collapse the query builder."}),l=a.i18n.translate("xpack.securitySolution.timeline.tour.saveTimeline.title",{defaultMessage:"An easier way to save new changes"}),u=a.i18n.translate("xpack.securitySolution.timeline.tour.changeDataView.title",{defaultMessage:"The Data view menu has moved"}),c=a.i18n.translate("xpack.securitySolution.timeline.tour.addToFavorites.title",{defaultMessage:"A new and intuitive way to favorite your Timeline"}),d=a.i18n.translate("xpack.securitySolution.timeline.tour.next",{defaultMessage:"Next"}),p=a.i18n.translate("xpack.securitySolution.timeline.tour.finish",{defaultMessage:"Finish tour"}),m=a.i18n.translate("xpack.securitySolution.timeline.tour.exit",{defaultMessage:"Exit tour"}),f=a.i18n.translate("xpack.securitySolution.timeline.tour.save",{defaultMessage:"Save"}),g=a.i18n.translate("xpack.securitySolution.timeline.tour.new",{defaultMessage:"New"}),b=a.i18n.translate("xpack.securitySolution.timeline.tour.open",{defaultMessage:"Open"}),y=a.i18n.translate("xpack.securitySolution.timeline.tour.edit",{defaultMessage:"Edit"}),v=a.i18n.translate("xpack.securitySolution.timeline.tour.dataView",{defaultMessage:"Data view"})},function(e,t,n){"use strict";e.exports=n(869)},function(e,t,n){"use strict";e.exports=n(871)},function(e,t,n){"use strict";e.exports=n(872)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.assistant.conversations.timelineConversationTitle",{defaultMessage:"Timeline"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.topN.closeButtonLabel",{defaultMessage:"Close"}),r=a.i18n.translate("xpack.securitySolution.topN.allEventsSelectLabel",{defaultMessage:"Alerts and events"}),s=a.i18n.translate("xpack.securitySolution.topN.rawEventsSelectLabel",{defaultMessage:"Raw events"}),o=a.i18n.translate("xpack.securitySolution.topN.alertEventsSelectLabel",{defaultMessage:"Detection alerts"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n(4),r=n(469),s=n(121),o=n(112),l=n(128),u=n(116),c=n(202),d=n(190);const p=({applyGlobalQueriesAndFilters:e=!0,extraOptions:t,getLensAttributes:n,lensAttributes:p,scopeId:m=u.SourcererScopeName.default,stackByField:f,title:g})=>{var b,y;const{selectedPatterns:v,dataViewId:h,indicesExist:E}=Object(s.d)(m),x=Object(a.useMemo)((()=>l.d.globalQuerySelector()),[]),j=Object(a.useMemo)((()=>l.d.globalFiltersQuerySelector()),[]),O=Object(o.a)(x),S=Object(o.a)(j),[{detailName:k,pageName:w,tabName:T}]=Object(c.a)(),I=Object(a.useMemo)((()=>T===r.a.events?w===i.yc.network?d.h:Object(d.b)(w):[]),[w,T]),C=Object(a.useMemo)((()=>[i.yc.hosts,i.yc.users].indexOf(w)>=0&&null!=k?Object(d.c)(w,k):i.yc.network===w?Object(d.e)(k):[]),[k,w]),M=Object(a.useMemo)((()=>null!=p?p:n&&f&&n(f,t)),[t,n,p,f]),_=Object.values(null!==(b=null==M||null===(y=M.state)||void 0===y?void 0:y.adHocDataViews)&&void 0!==b?b:{}).length>0,A=Object(a.useMemo)((()=>{var t;if(null==p&&(null==n||null==f||0===(null==f?void 0:f.length)))return null;const a=_?[]:Object(d.d)(v);return{...M,...null!=g?{title:g}:{},state:{...M.state,...e?{query:O}:{},filters:[...M.state.filters,...C,...I,...a,...e?S:[]]},references:null==M||null===(t=M.references)||void 0===t?void 0:t.map((e=>({...e,id:h})))}}),[e,M,h,S,n,_,p,C,O,v,f,I,g]);return _||!_&&E?A:null}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(68),r=n(39),s=n(110),o=n(198);const l=({onAddToCaseClicked:e,lensAttributes:t,timeRange:n})=>{const{cases:l}=Object(s.i)().services,u=l.helpers.canUseCases([r.APP_ID]),c=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:t,timeRange:n},persistableStateAttachmentTypeId:i.LENS_ATTACHMENT_TYPE,type:i.AttachmentType.persistableState}]),[t,n]),d=l.hooks.useCasesAddToExistingCaseModal({onClose:e,successToaster:{title:o.b}});return{onAddToExistingCaseClicked:Object(a.useCallback)((()=>{e&&e(),d.open({getAttachments:()=>c})}),[c,e,d]),disabled:null==t||null==n||!u.create||!u.read}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(68),r=n(39),s=n(110),o=n(198);const l=({onClick:e,timeRange:t,lensAttributes:n})=>{const{cases:l}=Object(s.i)().services,u=l.helpers.canUseCases([r.APP_ID]),c=Object(a.useMemo)((()=>[{persistableStateAttachmentState:{attributes:n,timeRange:t},persistableStateAttachmentTypeId:i.LENS_ATTACHMENT_TYPE,type:i.AttachmentType.persistableState}]),[n,t]),d=l.hooks.useCasesAddToNewCaseFlyout({toastContent:o.b});return{onAddToNewCaseClicked:Object(a.useCallback)((()=>{e&&e(),d.open({attachments:c})}),[c,d,e]),disabled:null==n||null==t||!u.create||!u.read}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(17),s=n(44);const o=n.n(s)()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-1tb0fg5-0"})(["flex:1;"]),l=()=>i.a.createElement(o,{alignItems:"center",justifyContent:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}))),u=i.a.memo(l)},function(e,t,n){"use strict";var a=n(305);n.d(t,"b",(function(){return a.b})),n.d(t,"a",(function(){return a.a}))},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(185);const i=(e,t)=>`/name/${e}${Object(a.a)(t)}`,r=(e,t,n)=>`/name/${e}/${t}${Object(a.a)(n)}`,s=(e,t)=>`/${e}${Object(a.a)(t)}`},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m}));var a=n(17),i=n(44),r=n.n(i),s=n(2),o=n.n(s),l=n(432),u=n(398),c=n(399);const d=r()(a.EuiPanel).withConfig({displayName:"KpiPanel",componentId:"sc-12zc7xr-0"})(["display:flex;flex-direction:column;position:relative;overflow-x:hidden;overflow-y:",";@media only screen and (min-width:","){","}",""],(({$overflowY:e})=>null!=e?e:"hidden"),(e=>e.theme.eui.euiBreakpoints.m),(({height:e,$toggleStatus:t})=>t&&`\n      height: ${null!=e?e:l.d}px;\n  `),(({$toggleStatus:e})=>e&&`\n    height: ${l.c}px;\n  `)),p=r.a.div.withConfig({displayName:"StackByComboBoxWrapper",componentId:"sc-12zc7xr-1"})(["max-width:400px;width:","px;"],(({width:e})=>e)),m=o.a.forwardRef((({"aria-label":e=c.c,"data-test-subj":t,isDisabled:n=!1,onSelect:i,prepend:r=c.d,selected:l,inputRef:d,width:m=400,dropDownoptions:f,useLensCompatibleFields:g},b)=>{const y=Object(s.useCallback)((e=>{e&&e.length>0?i(e[0].value):i("")}),[i]),v=Object(s.useMemo)((()=>[{label:l,value:l}]),[l]),h=Object(u.b)(g),E=Object(s.useMemo)((()=>null!=f?f:h()),[f,h]),x=Object(s.useMemo)((()=>({asPlainText:!0})),[]);return o.a.createElement(p,{width:m},o.a.createElement(a.EuiComboBox,{"data-test-subj":t,"aria-label":e,inputRef:d,isDisabled:n,placeholder:c.e,prepend:r,ref:b,singleSelection:x,isClearable:!1,sortMatchesBy:"startsWith",options:E,selectedOptions:v,compressed:!0,onChange:y}))}));m.displayName="StackByComboBox"},,,,,function(e,t,n){"use strict";var a=String.fromCharCode;e.exports=a},function(e,t,n){"use strict";var a=n(156),i=n(171),r={tokenize:function(e,t,n){return i(e,(function(e){return null===e||a(e)?t(e):n(e)}),"linePrefix")},partial:!0};e.exports=r},function(e,t,n){"use strict";var a=n(932);e.exports=function(e,t){var n=e[e.length-1];return n&&n[1].type===t?a(n[2].sliceStream(n[1])):0}},function(e,t,n){"use strict";var a=n(288)(/[\dA-Za-z]/);e.exports=a},function(e,t,n){"use strict";n.d(t,"w",(function(){return i})),n.d(t,"r",(function(){return r})),n.d(t,"U",(function(){return s})),n.d(t,"k",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"i",(function(){return u})),n.d(t,"E",(function(){return c})),n.d(t,"F",(function(){return d})),n.d(t,"u",(function(){return p})),n.d(t,"j",(function(){return m})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"d",(function(){return b})),n.d(t,"G",(function(){return y})),n.d(t,"H",(function(){return v})),n.d(t,"A",(function(){return h})),n.d(t,"B",(function(){return E})),n.d(t,"x",(function(){return x})),n.d(t,"l",(function(){return j})),n.d(t,"q",(function(){return O})),n.d(t,"s",(function(){return S})),n.d(t,"C",(function(){return k})),n.d(t,"M",(function(){return w})),n.d(t,"P",(function(){return T})),n.d(t,"T",(function(){return I})),n.d(t,"L",(function(){return C})),n.d(t,"o",(function(){return M})),n.d(t,"f",(function(){return _})),n.d(t,"h",(function(){return A})),n.d(t,"g",(function(){return P})),n.d(t,"D",(function(){return F})),n.d(t,"R",(function(){return D})),n.d(t,"t",(function(){return N})),n.d(t,"b",(function(){return R})),n.d(t,"y",(function(){return L})),n.d(t,"z",(function(){return z})),n.d(t,"S",(function(){return B})),n.d(t,"O",(function(){return q})),n.d(t,"Q",(function(){return $})),n.d(t,"N",(function(){return V})),n.d(t,"J",(function(){return U})),n.d(t,"K",(function(){return H})),n.d(t,"I",(function(){return Z})),n.d(t,"v",(function(){return G})),n.d(t,"n",(function(){return Q})),n.d(t,"p",(function(){return W})),n.d(t,"m",(function(){return K}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.overviewTabLabel",{defaultMessage:"Overview"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.investigationGuideTabLabel",{defaultMessage:"Investigation guide"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.updatesTabLabel",{defaultMessage:"Updates"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dismissButtonLabel",{defaultMessage:"Dismiss"}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.aboutSectionLabel",{defaultMessage:"About"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.definitionSectionLabel",{defaultMessage:"Definition"}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.scheduleSectionLabel",{defaultMessage:"Schedule"}),d=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.setupGuideSectionLabel",{defaultMessage:"Setup guide"}),p=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.nameFieldLabel",{defaultMessage:"Name"}),m=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.descriptionFieldLabel",{defaultMessage:"Description"}),f=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.authorFieldLabel",{defaultMessage:"Author"}),g=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.buildingBlockFieldLabel",{defaultMessage:"Building block"}),b=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.buildingBlockFieldDescription",{defaultMessage:'All generated alerts will be marked as "building block" alerts'}),y=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.severityFieldLabel",{defaultMessage:"Severity"}),v=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.severityMappingFieldLabel",{defaultMessage:"Severity override"}),h=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.riskScoreFieldLabel",{defaultMessage:"Risk score"}),E=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.riskScoreMappingFieldLabel",{defaultMessage:"Risk score override"}),x=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.referencesFieldLabel",{defaultMessage:"Reference URLs"}),j=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.falsePositivesFieldLabel",{defaultMessage:"False positive examples"}),O=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.investigationFieldsFieldLabel",{defaultMessage:"Custom highlighted fields"}),S=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.licenseFieldLabel",{defaultMessage:"License"}),k=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleNameOverrideFieldLabel",{defaultMessage:"Rule name override"}),w=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatFieldLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),T=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatIndicatorPathFieldLabel",{defaultMessage:"Indicator prefix override"}),I=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.timestampOverrideFieldLabel",{defaultMessage:"Timestamp override"}),C=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.tagsFieldLabel",{defaultMessage:"Tags"}),M=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.indexFieldLabel",{defaultMessage:"Index patterns"}),_=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIdFieldLabel",{defaultMessage:"Data view ID"}),A=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIndexPatternFieldLabel",{defaultMessage:"Data view index pattern"}),P=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.dataViewIndexPatternFetchErrorMessage",{defaultMessage:"Could not load data view index pattern"}),F=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.ruleTypeFieldLabel",{defaultMessage:"Rule type"}),D=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.thresholdFieldLabel",{defaultMessage:"Threshold"}),N=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.machineLearningJobIdFieldLabel",{defaultMessage:"Machine Learning job"}),R=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.anomalyThresholdFieldLabel",{defaultMessage:"Anomaly score threshold"}),L=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.relatedIntegrationsFieldLabel",{defaultMessage:"Related integrations"}),z=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.requiredFieldsFieldLabel",{defaultMessage:"Required fields"}),B=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.timelineTitleFieldLabel",{defaultMessage:"Timeline template"}),q=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatIndexFieldLabel",{defaultMessage:"Indicator index patterns"}),$=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatMappingFieldLabel",{defaultMessage:"Indicator mapping"}),V=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.threatFiltersFieldLabel",{defaultMessage:"Indicator filters"}),U=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressAlertsByFieldLabel",{defaultMessage:"Suppress alerts by"}),H=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressAlertsForFieldLabel",{defaultMessage:"Suppress alerts for"}),Z=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.suppressionFieldMissingFieldLabel",{defaultMessage:"If a suppression field is missing"}),G=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.newTermsFieldsFieldLabel",{defaultMessage:"Fields"}),Q=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.historyWindowSizeFieldLabel",{defaultMessage:"History Window Size"}),W=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.intervalFieldLabel",{defaultMessage:"Runs every"}),K=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.fromFieldLabel",{defaultMessage:"Additional look-back time"})},function(e,t,n){const a=n(225);e.exports=(e,t,n)=>a(e,t,n)>0},function(e,t,n){const a=n(225);e.exports=(e,t,n)=>a(e,t,n)>=0},function(e,t,n){const a=Symbol("SemVer ANY");class Comparator{static get ANY(){return a}constructor(e,t){if(t=i(t),e instanceof Comparator){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),l("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===a?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(e){const t=this.options.loose?r[s.COMPARATORLOOSE]:r[s.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=void 0!==n[1]?n[1]:"","="===this.operator&&(this.operator=""),n[2]?this.semver=new u(n[2],this.options.loose):this.semver=a}toString(){return this.value}test(e){if(l("Comparator.test",e,this.options.loose),this.semver===a||e===a)return!0;if("string"==typeof e)try{e=new u(e,this.options)}catch(e){return!1}return o(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof Comparator))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new c(e.value,t).test(this.value):""===e.operator?""===e.value||new c(this.value,t).test(e.semver):!((t=i(t)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===e.value)||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!e.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!e.operator.startsWith("<"))&&(this.semver.version!==e.semver.version||!this.operator.includes("=")||!e.operator.includes("="))&&!(o(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<"))&&!(o(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}}e.exports=Comparator;const i=n(412),{safeRe:r,t:s}=n(316),o=n(948),l=n(314),u=n(173),c=n(217)},function(e,t,n){const a=n(217);e.exports=(e,t,n)=>{try{t=new a(t,n)}catch(e){return!1}return t.test(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return Ie})),n.d(t,"c",(function(){return Ce})),n.d(t,"b",(function(){return Me})),n.d(t,"d",(function(){return _e}));var a=n(17),i=n(747),r=n(378),s=n(2),o=n.n(s),l=n(9),u=n(47),c=n(5),d=n(23),p=n.n(d);const m=({euiFieldProps:e})=>{const{field:{onChange:t,value:n,name:i},fieldState:{error:l}}=Object(r.useController)({name:"label",defaultValue:""}),u=Object(s.useMemo)((()=>!(null==l||!l.message)),[null==l?void 0:l.message]);return o.a.createElement(a.EuiFormRow,{label:c.i18n.translate("xpack.securitySolution.markdown.osquery.labelFieldText",{defaultMessage:"Label"}),error:null==l?void 0:l.message,isInvalid:u,fullWidth:!0},o.a.createElement(a.EuiFieldText,p()({isInvalid:u,onChange:t,value:n,name:i,fullWidth:!0,"data-test-subj":"input"},e)))},f=o.a.memo(m),g=c.i18n.translate("xpack.securitySolution.markdown.osquery.permissionDenied",{defaultMessage:"Permission denied"}),b=()=>o.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:o.a.createElement("h2",null,g),titleSize:"xs",body:o.a.createElement("p",null,o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:o.a.createElement(a.EuiCode,null,"osquery")}}))});var y=n(110);const v=({node:e,onSave:t,onCancel:n})=>{var i,d,p;const m=null!=e,{osquery:g,application:{capabilities:{osquery:v}}}=Object(y.i)().services,h=Object(r.useForm)({defaultValues:{label:null==e||null===(i=e.configuration)||void 0===i?void 0:i.label,query:null==e||null===(d=e.configuration)||void 0===d?void 0:d.query,ecs_mapping:null==e||null===(p=e.configuration)||void 0===p?void 0:p.ecs_mapping}}),E=Object(s.useCallback)((e=>{t(`!{osquery${JSON.stringify(Object(l.pickBy)({query:e.query,label:e.label,ecs_mapping:e.ecs_mapping},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t]),x=Object(s.useMemo)((()=>!(v.runSavedQueries&&v.readSavedQueries||v.writeLiveQueries)),[v.readSavedQueries,v.runSavedQueries,v.writeLiveQueries]),j=Object(s.useMemo)((()=>{if(null!=g&&g.LiveQueryField){const{LiveQueryField:e}=g;return o.a.createElement(r.FormProvider,h,o.a.createElement(f,null),o.a.createElement(a.EuiSpacer,{size:"m"}),o.a.createElement(e,{formMethods:h}))}return null}),[h,g]);return x?o.a.createElement(b,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiModalHeader,null,o.a.createElement(a.EuiModalHeaderTitle,null,o.a.createElement("h1",null,m?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalTitle",defaultMessage:"Edit query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalTitle",defaultMessage:"Add query"})))),o.a.createElement(a.EuiModalBody,null,o.a.createElement(o.a.Fragment,null,j)),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButtonEmpty,{onClick:n},c.i18n.translate("xpack.securitySolution.markdown.osquery.modalCancelButtonLabel",{defaultMessage:"Cancel"})),o.a.createElement(a.EuiButton,{onClick:h.handleSubmit(E),fill:!0},m?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.osquery.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},h=o.a.memo(v),E={name:"osquery",button:{label:"Osquery",iconType:"logoOsquery"},helpText:o.a.createElement("div",null,o.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},"!{osquery{options}}"),o.a.createElement(a.EuiSpacer,{size:"s"})),editor:h};var x=n(411),j=n(44),O=n.n(j),S=n(404),k=n(325),w=n(868),T=n.n(w),I=n(695);const C=O()(a.EuiButton).withConfig({displayName:"StyledEuiButton",componentId:"sc-14wavsd-0"})(["> span > img{margin-block-end:0;}"]);var M=n(56),_=n.n(M),A=n(61),P=n.n(A),F=(n(13),n(87)),D=n(53),N=n(117),R=n(54),L=n(122),z=n(172),B=n(559),q=n(121),$=n(116),V=n(113),U=n(153);const H=e=>e===D.FILTERS.EXISTS?U.b:e===D.FILTERS.PHRASES?U.c:U.d,Z={$state:{store:D.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:void 0}},G={and:[],enabled:!0,id:"",name:"",excluded:!1,kqlQuery:"",type:V.a.default,queryMatch:{field:"",value:"",operator:U.b}},Q=e=>{const t={...Z,meta:{...Z.meta,negate:e.excluded,type:e.queryType}};if(e.queryType===D.FILTERS.EXISTS)return{...t,meta:{...t.meta,params:void 0,value:"exists"},query:{exists:{field:e.field}}};if(e.queryType===D.FILTERS.PHRASES){var n;let a=JSON.parse(String(e.value));return"number"===e.valueType?a=a.map(Number):"boolean"===e.valueType&&(a=a.map(Boolean)),{...t,meta:{...t.meta},query:{bool:{minimum_should_match:1,should:null===(n=a)||void 0===n?void 0:n.map((t=>({match_phrase:{[e.field]:t}})))}}}}var a;if(e.queryType===D.FILTERS.PHRASE)return{...t,meta:{...t.meta,params:{query:e.value},value:void 0},query:{match_phrase:{[e.field]:null!==(a=e.value)&&void 0!==a?a:""}}};if(e.queryType===D.FILTERS.RANGE){let n,a;try{const t=JSON.parse(String(e.value));n=t.gte,a=t.lt}catch{n="",a=""}const i={gte:n,lt:a};return{...t,meta:{...t.meta,params:i},query:{range:{[e.field]:i}}}}return t},W=({providers:e,alertData:t})=>{const n=Object(s.useMemo)((()=>e.some((e=>e.some((e=>"range"===e.queryType))))),[e]);return{dataProviders:Object(s.useMemo)((()=>n?[]:((e,t)=>e.map((e=>e.reduce(((e,n,a)=>{const{field:i,value:r,excluded:s,queryType:o}=n,{result:u,matchedBrackets:c}=((e,t)=>{if("number"==typeof e||"boolean"==typeof e)return{result:e,skipped:!0,matchedBrackets:null};const n=/\{{([^}]+)\}}/g,a=e.match(new RegExp(n));let i=e;a&&t&&Object(l.each)(a,(e=>{const n=e.replace(/{{|}}/g,"").trim();if(i.includes(e)){const a=t.find((({field:e})=>e===n));if(a&&a.values){const{values:[t]}=a;i=i.replace(e,t)}}}));const r=new RegExp(n).test(i);return{result:i,skipped:r,matchedBrackets:a}})(r,t),d=!t&&c;if(0===a)return{and:[],enabled:!0,id:JSON.stringify(i+r),name:i,excluded:s,kqlQuery:"",type:d?V.a.template:V.a.default,queryMatch:{field:i,value:u,operator:H(o)}};{const t={enabled:!0,id:JSON.stringify(i+r),name:i,excluded:s,kqlQuery:"",type:d?V.a.template:V.a.default,queryMatch:{field:i,value:u,operator:H(o)}};e.and.push(t)}return e}),G))))(e,t)),[t,e,n]),filters:Object(s.useMemo)((()=>n?((e,t)=>{const n=[];for(let t=0;t<e.length;t++){const a=e[t];if(a.length>1){const e=a.map((e=>Q(e))),t={$state:{store:D.FilterStateStore.APP_STATE},meta:{type:D.FILTERS.COMBINED,relation:D.BooleanRelation.AND,params:e,index:void 0,disabled:!1,negate:!1}};n.push(t)}else{const e=a[0],t=Q(e);n.push(t)}}return n})(e):[]),[n,e,t])}};var K=n(379),J=n(281),Y=n(4);const X=e=>{var t,n,a,i,r,s;const o=null!==(t=null===(n=e.meta)||void 0===n?void 0:n.key)&&void 0!==t?t:"",l={field:o,excluded:null!==(a=null===(i=e.meta)||void 0===i?void 0:i.negate)&&void 0!==a&&a,queryType:null!==(r=null===(s=e.meta)||void 0===s?void 0:s.type)&&void 0!==r?r:D.FILTERS.PHRASE};if(Object(D.isRangeFilter)(e)){var u;const{gte:t,lt:n}=e.query.range[o],a=JSON.stringify({gte:t,lt:n});return{...l,value:a,queryType:null!==(u=e.meta.type)&&void 0!==u?u:D.FILTERS.RANGE}}if(Object(D.isPhrasesFilter)(e)){var c,d,p,m;const t=typeof(null===(c=e.meta)||void 0===c?void 0:c.params[0]);return{...l,value:JSON.stringify(null!==(d=null===(p=e.meta)||void 0===p?void 0:p.params)&&void 0!==d?d:[]),valueType:t,queryType:null!==(m=e.meta.type)&&void 0!==m?m:D.FILTERS.PHRASES}}var f;if(Object(D.isExistsFilter)(e))return{...l,value:"",queryType:null!==(f=e.meta.type)&&void 0!==f?f:D.FILTERS.EXISTS};if(Object(D.isPhraseFilter)(e)){var g,b,y,v,h,E;const t=typeof(null===(g=e.meta)||void 0===g||null===(b=g.params)||void 0===b?void 0:b.query);return{...l,value:null!==(y=null===(v=e.meta)||void 0===v||null===(h=v.params)||void 0===h?void 0:h.query)&&void 0!==y?y:"",valueType:t,queryType:null!==(E=e.meta.type)&&void 0!==E?E:D.FILTERS.PHRASE}}return{...l,value:"",queryType:D.FILTERS.PHRASE}},ee=e=>e.map((e=>X(e))),te=e=>!1===e.some(D.isCombinedFilter)?[ee(e)]:e.reduce(((e,t)=>{if(Object(D.isCombinedFilter)(t)){const n=t.meta.params;if(t.meta.relation===D.BooleanRelation.OR){const t=n.map((e=>{const t=te([e]);return Object(l.flatten)(t)}));return[...e,...t]}{const t=te(n);return[...e,...t]}}return[...e,[X(t)]]}),[]);var ne=n(18),ae=n(65),ie=n.n(ae),re=n(591),se=n.n(re),oe=n(328);function le(e,t,n){var a;if(void 0===t||"undefined"===n)return!1;switch(e.type){case"date":const n="string"==typeof t?ie.a.parse(t):null;return Boolean("string"==typeof t&&n&&n.isValid());case"ip":if("string"==typeof t||"number"==typeof t)try{return Boolean(new R.IpAddress(t))}catch(e){return!1}return!1;case"string":return"string"==typeof t&&null!==(a=e.esTypes)&&void 0!==a&&a.includes(oe.a.VERSION)?Boolean(se()(t)):"string"==typeof t&&t.trim().length>0;case"boolean":return"boolean"==typeof t;case"number":return"number"==typeof t||"string"==typeof t&&!isNaN(parseFloat(t));default:return!0}}const ue=c.i18n.translate("xpack.securitySolution.markdown.insight.label",{defaultMessage:"Label"}),ce=c.i18n.translate("xpack.securitySolution.markdown.insight.title",{defaultMessage:"Investigate"}),de=c.i18n.translate("xpack.securitySolution.markdown.insight.labelText",{defaultMessage:"Label on the query button."}),pe=c.i18n.translate("xpack.securitySolution.markdown.insight.description",{defaultMessage:"Description"}),me=c.i18n.translate("xpack.securitySolution.markdown.insight.descriptionText",{defaultMessage:"Additional description of the query."}),fe=c.i18n.translate("xpack.securitySolution.markdown.insight.formDescription",{defaultMessage:"Create a query to investigate an alert in Timeline, using a clickable query button in the investigation guide. The button also displays a count of matching documents."}),ge=c.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilder",{defaultMessage:"Filters"}),be=c.i18n.translate("xpack.securitySolution.markdown.insight.filterBuilderText",{defaultMessage:"Create filters to populate the Timeline query builder. To use a value from the alert document, enter the field name in double braces {example} as a custom option in the value field.",values:{example:"{{kibana.alert.example}}"}}),ye=c.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerange",{defaultMessage:"Relative time range"}),ve=c.i18n.translate("xpack.securitySolution.markdown.insight.relativeTimerangeText",{defaultMessage:"Select a time range to limit the query, relative to the alert's creation time (optional)."}),he=c.i18n.translate("xpack.securitySolution.markdown.insight.modalCancelButtonLabel",{defaultMessage:"Cancel"}),Ee=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightProviderError",{defaultMessage:"Unable to parse insight provider configuration"}),xe="!{investigate",je=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:r})=>{const{addError:l}=Object(N.a)();let u=[];try{void 0!==n&&(u=JSON.parse(n))}catch(e){l(e,{title:Ee})}const{data:c,timestamp:d}=Object(s.useContext)(S.a),{dataProviders:p,filters:m}=W({providers:u,alertData:c}),f=Object(s.useMemo)((()=>{if(i&&r){const e=d?_()(d):_()();return{kind:"absolute",from:Object(J.e)(i,J.a,!1,_.a,e.toDate()).toISOString(),to:Object(J.e)(r,J.b,!0,_.a,e.toDate()).toISOString()}}return null}),[i,r,d]),{totalCount:g,isQueryLoading:b,oldestTimestamp:v,hasError:h}=(({dataProviders:e,filters:t,relativeTimerange:n})=>{const{uiSettings:a}=Object(y.i)().services,i=Object(s.useMemo)((()=>Object(R.getEsQueryConfig)(a)),[a]),{browserFields:r,selectedPatterns:o,indexPattern:l,dataViewId:u}=Object(q.d)($.SourcererScopeName.timeline),[c,d]=Object(s.useState)(!1),p=Object(s.useMemo)((()=>{try{if(!1===c)return Object(z.d)({config:i,dataProviders:e,indexPattern:l,browserFields:r,filters:t,kqlQuery:{query:"",language:"kuery"},kqlMode:"filter"})}catch(e){return d(!0),null}}),[r,e,i,c,l,t]),[m,{events:f,totalCount:g}]=Object(B.a)({dataViewId:u,fields:["*"],filterQuery:null==p?void 0:p.filterQuery,id:L.c.active,indexNames:o,language:"kuery",limit:1,runtimeMappings:{},...n?{startDate:null==n?void 0:n.from,endDate:null==n?void 0:n.to}:{}}),[b]=f,v=b&&b.data&&b.data.find((e=>"@timestamp"===e.field));return{isQueryLoading:m,totalCount:g,oldestTimestamp:v&&v.value&&v.value[0],hasError:c}})({dataProviders:p,filters:m,relativeTimerange:f}),E=Object(s.useMemo)((()=>{if(f)return f;if(null!=v)return{kind:"absolute",from:v,to:(new Date).toISOString()};{const{to:e,from:t,fromStr:n,toStr:a}=Object(J.d)();return{kind:"relative",to:e,from:t,fromStr:n,toStr:a}}}),[v,f]);return b?o.a.createElement(a.EuiLoadingSpinner,null):o.a.createElement(o.a.Fragment,null,o.a.createElement(K.a,{asEmptyButton:!1,isDisabled:h,dataProviders:p,filters:m,timeRange:E,keepDataView:!0,"data-test-subj":"insight-investigate-in-timeline-button"},o.a.createElement(a.EuiIcon,{type:"timeline"}),` ${e} (${P()(g).format("0,0.[000]a")})`),o.a.createElement("div",null,t))},Oe=({node:e,onSave:t,onCancel:n})=>{const i=null!=e,{sourcererDataView:c,indexPattern:d}=Object(q.d)($.SourcererScopeName.default),{unifiedSearch:{ui:{FiltersBuilderLazy:m}},uiSettings:f,fieldFormats:g}=Object(y.i)().services,b=Object(s.useMemo)((()=>null!=c?new F.DataView({spec:c,fieldFormats:g}):null),[c,g]),[v,h]=Object(s.useState)([[]]),E=Object(s.useMemo)((()=>[{value:"0",text:""},...f.get(Y.W).map((({display:e},t)=>({value:String(t),text:e})))]),[f]),x=Object(r.useForm)({defaultValues:{label:null==e?void 0:e.label,description:null==e?void 0:e.description,relativeTimerange:(null==e?void 0:e.relativeTimerange)||"0"},shouldUnregister:!0}),j=Object(r.useController)({name:"label",control:x.control}),O=Object(r.useController)({name:"description",control:x.control}),S=Object(r.useController)({name:"relativeTimerange",control:x.control}),k=Object(s.useCallback)((e=>{const t=E.find((t=>t.value===e));if(t&&"0"!==t.value){const e=Number(t.value),n=f.get(Y.W);return{relativeFrom:n[e].from,relativeTo:n[e].to}}return{}}),[E,f]),w=Object(s.useCallback)((()=>{t(`${xe}${JSON.stringify(Object(l.pickBy)({label:j.field.value,description:O.field.value,providers:v,...k(S.field.value)},(e=>!Object(l.isEmpty)(e))))}}`,{block:!0})}),[t,v,j.field.value,O.field.value,S.field.value,k]),T=Object(s.useCallback)((e=>{h(te(e))}),[]),I=Object(s.useCallback)((e=>{S.field.onChange(e.target.value)}),[S.field]),C=Object(s.useMemo)((()=>{var e;const t=null!==(e=j.field.value)&&void 0!==e?e:"",n=v.flat();return""===t.trim()||0===n.length||n.some((e=>!function(e,t){if(!t||!e.field)return!1;switch(e.queryType){case"phrase":return le(t,e.value,e.valueType);case"phrases":const n="string"==typeof e.value?JSON.parse(`${e.value}`):null;return!(!Array.isArray(n)||!n.length)&&n.every((n=>le(t,n,e.valueType)));case"range":const a=JSON.parse("string"==typeof e.value?e.value:"");return"object"==typeof a&&(!a.gte||le(t,a.gte,e.valueType))&&(!a.lt||le(t,a.lt,e.valueType));case"exists":return!0;default:throw new Error(`Unknown operator type: ${e.queryType}`)}}(e,null==b?void 0:b.getFieldByName(e.field))))}),[j.field.value,v,b]),M=Object(s.useMemo)((()=>{const e=d&&d.getName?d.getName():"*";return[{$state:{store:D.FilterStateStore.APP_STATE},meta:{disabled:!1,negate:!1,alias:null,index:e}}]}),[d]),_=Object(ne.b)().isAtLeast("platinum");return o.a.createElement(o.a.Fragment,null,o.a.createElement(we,null,o.a.createElement(a.EuiModalHeaderTitle,null,o.a.createElement(a.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(a.EuiFlexItem,null,i?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalTitle",defaultMessage:"Edit investigation query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalTitle",defaultMessage:"Add investigation query"}))))),!1===_&&o.a.createElement(a.EuiCallOut,{title:"To add suggested queries to an investigation guide, please upgrade to platinum",iconType:"timeline"}),o.a.createElement(a.EuiModalBody,null,o.a.createElement(r.FormProvider,x,o.a.createElement(a.EuiForm,{fullWidth:!0},o.a.createElement(a.EuiFormRow,{label:fe,fullWidth:!0},o.a.createElement(o.a.Fragment,null)),o.a.createElement(a.EuiFormRow,{label:ue,helpText:de,isInvalid:void 0!==j.field.value&&0===j.field.value.trim().length,fullWidth:!0},o.a.createElement(a.EuiFieldText,p()({},x.register("label"),{ref:null,name:"label",onChange:j.field.onChange}))),o.a.createElement(a.EuiFormRow,{label:pe,helpText:me,fullWidth:!0},o.a.createElement(a.EuiFieldText,p()({},x.register("description"),{ref:null,name:"description",onChange:O.field.onChange}))),o.a.createElement(a.EuiFormRow,{label:ge,helpText:be,fullWidth:!0},b?o.a.createElement(m,{filters:M,onChange:T,dataView:b,maxDepth:1}):o.a.createElement(o.a.Fragment,null)),o.a.createElement(a.EuiFormRow,{label:ye,helpText:ve,fullWidth:!0},o.a.createElement(a.EuiSelect,p()({},x.register("relativeTimerange"),{ref:null,onChange:I,options:E})))))),o.a.createElement(a.EuiModalFooter,null,o.a.createElement(a.EuiButtonEmpty,{onClick:n},he),o.a.createElement(a.EuiButton,{onClick:x.handleSubmit(w),fill:!0,disabled:C},i?o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.addModalConfirmButtonLabel",defaultMessage:"Add query"}):o.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.markdown.insight.editModalConfirmButtonLabel",defaultMessage:"Save changes"}))))},Se=o.a.memo(Oe),ke=`${xe}{\n  "label": "Test action",\n  "description": "Click to investigate",\n  "providers": [\n    [\n      {"field": "event.id", "value": "{{kibana.alert.original_event.id}}", "queryType": "phrase", "excluded": "false"}\n    ],\n    [\n      {"field": "event.action", "value": "", "queryType": "exists", "excluded": "false"},\n      {"field": "process.pid", "value": "{{process.pid}}", "queryType": "phrase", "excluded":"false"}\n    ]\n  ]\n}}`;var we=O()(a.EuiModalHeader).withConfig({displayName:"_StyledEuiModalHeader",componentId:"sc-1kbgjgu-0"})(["min-width:700px;"]);const Te=Object(a.getDefaultEuiMarkdownUiPlugins)(),Ie=Object(a.getDefaultEuiMarkdownParsingPlugins)(),Ce=Object(a.getDefaultEuiMarkdownProcessingPlugins)(),Me=[xe],_e=({insightsUpsellingMessage:e})=>{const t=Te.map((e=>e.name)),n=(({insightsUpsellingMessage:e})=>({name:"insights",button:{label:null!=e?e:ce,iconType:"timelineWithArrow",isDisabled:!!e},helpText:o.a.createElement("div",null,o.a.createElement(a.EuiCodeBlock,{language:"md",fontSize:"l",paddingSize:"s",isCopyable:!0},ke),o.a.createElement(a.EuiSpacer,{size:"s"})),editor:Se}))({insightsUpsellingMessage:e});if(!1===t.includes(n.name))Te.push(i.b),Te.push(E),Te.push(n);else{const e=Te.findIndex((e=>e.name===n.name));Te[e]=n}return Te};Ie.push((function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){if(!1===t.startsWith(xe))return!1;const a=t[xe.length];if("{"!==a&&"}"!==a)return!1;if(n)return!0;let i={};if("{"===a){let n="",a=0;for(let e=xe.length;e<t.length;e++){const i=t[e];if("{"===i)a++,n+=i;else if("}"===i){if(a--,-1===a)break;n+=i}else n+=i}try{return i=JSON.parse(n),e(t)({type:"insight",...i,providers:JSON.stringify(i.providers)})}catch(t){const n=e.now();this.file.fail((e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.insightConfigError",{values:{err:e},defaultMessage:"Unable to parse insight JSON configuration: {err}"}))(t),{line:n.line,column:n.column+xe.length})}}return!1};a.locator=(e,t)=>e.indexOf(xe,t),t.insight=a,n.splice(n.indexOf("text"),0,"insight")})),Ie.push(i.a),Ie.push(x.a),Ce[1][1].components.insight=({label:e,description:t,providers:n,relativeFrom:i,relativeTo:r})=>!1===Object(ne.b)().isPlatinumPlus()?o.a.createElement(o.a.Fragment,null,o.a.createElement(a.EuiButton,{isDisabled:!0,iconSide:"left",iconType:"timeline","data-test-subj":"insight-investigate-in-timeline-button"},`${e}`),o.a.createElement("div",null,t)):o.a.createElement(je,{label:e,description:t,providers:n,relativeFrom:i,relativeTo:r}),Ce[1][1].components.timeline=i.c,Ce[1][1].components.osquery=({configuration:e})=>{var t;const[n,a]=Object(s.useState)(!1),{agentId:i,alertId:r,data:u}=Object(s.useContext)(S.a),d=Object(s.useCallback)((()=>a(!0)),[a]),p=Object(s.useCallback)((()=>a(!1)),[a]),m=Object(s.useMemo)((()=>{const e=Object(l.reduce)(u,((e,t)=>{var n;return{...e,[t.field]:null==t||null===(n=t.values)||void 0===n?void 0:n[0]}}),{});return Object(k.a)(e)}),[u]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(C,{iconType:T.a,onClick:d},null!==(t=e.label)&&void 0!==t?t:c.i18n.translate("xpack.securitySolution.markdown.osquery.runOsqueryButtonLabel",{defaultMessage:"Run Osquery"})),n&&o.a.createElement(I.a,{defaultValues:{...r?{alertIds:[r]}:{},query:e.query,ecs_mapping:e.ecs_mapping,queryField:!1},agentId:i,onClose:p,ecsData:m}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(5);const u=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allActionsTooltip",{defaultMessage:"All actions"}),c=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowAction",{defaultMessage:"Allow"}),d=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowByDefaultAction",{defaultMessage:"Allow by default"}),p=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.allowedColumnTitle",{defaultMessage:"Allowed"}),m=(l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.alwaysSubmenu",{defaultMessage:"Always"}),l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeAction",{defaultMessage:"Anonymize"})),f=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizeByDefaultAction",{defaultMessage:"Anonymize by default"}),g=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.anonymizedColumnTitle",{defaultMessage:"Anonymized"}),b=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.bulkActions",{defaultMessage:"Bulk actions"}),y=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.defaultsSubmenu",{defaultMessage:"Defaults"}),v=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyAction",{defaultMessage:"Deny"}),h=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.denyByDefaultAction",{defaultMessage:"Deny by default"}),E=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.fieldColumnTitle",{defaultMessage:"Field"}),x=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.noButtonLabel",{defaultMessage:"No"}),j=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.resetButton",{defaultMessage:"Reset"}),O=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeAction",{defaultMessage:"Unanonymize"}),S=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.unanonymizeByDefaultAction",{defaultMessage:"Unanonymize by default"}),k=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.valuesColumnTitle",{defaultMessage:"Values"}),w=l.i18n.translate("xpack.elasticAssistant.assistant.dataAnonymizationEditor.contextEditor.yesButtonLabel",{defaultMessage:"Yes"}),T="primary-panel-id",I="secondary-panel-id";var C=n(13);const M=({appliesTo:e,disabled:t,disableAllow:n=!1,disableAnonymize:r=!1,disableDeny:s=!1,disableUnanonymize:o=!1,onListUpdated:l,onlyDefaults:p,selected:g})=>{const[E,x]=Object(i.useState)(!1),j=Object(a.useGeneratedHtmlId)({prefix:"contextEditorBulkActions"}),k=Object(i.useCallback)((()=>x(!1)),[]),w=Object(i.useCallback)((()=>x((e=>!e))),[]),M=Object(i.useMemo)((()=>Object(C.jsx)(a.EuiToolTip,{content:"multipleRows"===e?void 0:u},Object(C.jsx)(a.EuiButtonEmpty,{"data-test-subj":"bulkActionsButton",disabled:t,iconType:"multipleRows"===e?"arrowDown":"boxesVertical",iconSide:"multipleRows"===e?"right":void 0,onClick:w,size:"xs"},"multipleRows"===e?b:null))),[e,t,w]),_=Object(i.useMemo)((()=>(({disableAllow:e,disableAnonymize:t,disableDeny:n,disableUnanonymize:a,closePopover:i,onListUpdated:r,onlyDefaults:s,selected:o})=>{const l=s?T:I,u=s?I:T,p=[s?[]:{icon:"check",name:d,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allow"}))),t=o.map((({field:e})=>({field:e,operation:"add",update:"defaultAllow"})));r([...e,...t])}}].flat(),g=[{id:l,title:y,items:[...p,{icon:"cross",name:h,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allow"}))),t=o.map((({field:e})=>({field:e,operation:"remove",update:"defaultAllow"})));r([...e,...t])}},{icon:"eyeClosed",name:f,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allowReplacement"}))),t=o.map((({field:e})=>({field:e,operation:"add",update:"defaultAllowReplacement"})));r([...e,...t])}},{icon:"eye",name:S,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allowReplacement"}))),t=o.map((({field:e})=>({field:e,operation:"remove",update:"defaultAllowReplacement"})));r([...e,...t])}}]}],b=[{id:u,items:[{disabled:e,icon:"check",name:c,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allow"})));r(e)}},{disabled:n,icon:"cross",name:v,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allow"})));r(e)}},{disabled:t,icon:"eyeClosed",name:m,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"add",update:"allowReplacement"})));r(e)}},{disabled:a,icon:"eye",name:O,onClick:()=>{i();const e=o.map((({field:e})=>({field:e,operation:"remove",update:"allowReplacement"})));r(e)}},{isSeparator:!0,key:"sep"},{name:y,panel:l}]},...g];return s?g:b})({disableAllow:n,disableAnonymize:r,disableDeny:s,disableUnanonymize:o,closePopover:k,onListUpdated:l,onlyDefaults:p,selected:g})),[k,n,r,s,o,l,p,g]);return Object(C.jsx)(a.EuiPopover,{anchorPosition:"downLeft",button:M,closePopover:k,"data-test-subj":"bulkActions",id:j,isOpen:E,panelPaddingSize:"none"},Object(C.jsx)(a.EuiContextMenu,{initialPanelId:T,panels:_,size:"s"}))},_=r.a.memo(M),A="allowed",P="anonymized",F="field",D=o()(a.EuiButtonEmpty)`
  max-height: 24px;
`;var N=n(388);const R=({onListUpdated:e,onlyDefaults:t,onReset:n,onSelectAll:i,selected:r,totalFields:s})=>Object(C.jsx)(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"toolbar",gutterSize:"none"},Object(C.jsx)(a.EuiFlexItem,{grow:!1},Object(C.jsx)(a.EuiText,{color:"subdued","data-test-subj":"selectedFields",size:"xs"},(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectedFields",{values:{selected:e},defaultMessage:"Selected {selected} fields"}))(r.length))),Object(C.jsx)(a.EuiFlexItem,{grow:!1},Object(C.jsx)(a.EuiButtonEmpty,{"data-test-subj":"selectAllFields",iconType:"pagesSelect",onClick:i,size:"xs"},(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.contextEditor.selectAllFields",{values:{totalFields:e},defaultMessage:"Select all {totalFields} fields"}))(s))),Object(C.jsx)(a.EuiFlexItem,{grow:!1},Object(C.jsx)(_,{appliesTo:"multipleRows",disabled:0===r.length,onListUpdated:e,onlyDefaults:t,selected:r})),null!=n&&Object(C.jsx)(a.EuiFlexItem,{grow:!0},Object(C.jsx)(a.EuiFlexGroup,{alignItems:"center","data-test-subj":"toolbarTrailingActions",gutterSize:"none",justifyContent:"flexEnd"},Object(C.jsx)(a.EuiFlexItem,{grow:!1},Object(C.jsx)(a.EuiButtonEmpty,{"data-test-subj":"resetFields",iconType:"eraser",onClick:n,size:"xs"},j)))));R.displayName="ToolbarComponent";const L=r.a.memo(R),z={sort:{direction:"desc",field:A}},B={box:{incremental:!0},filters:[{field:A,type:"is",name:p},{field:P,type:"is",name:g}]},q=({allow:e,allowReplacement:t,onListUpdated:n,onReset:r,rawData:s,pageSize:o=10})=>{const[l,u]=Object(i.useState)([]),c=Object(i.useMemo)((()=>({selectable:()=>!0,onSelectionChange:e=>u(e),initialSelected:[]})),[]),d=Object(i.useRef)(null),m=Object(i.useMemo)((()=>(({onListUpdated:e,rawData:t})=>{const n={field:"actions",name:"",render:(n,a)=>Object(C.jsx)(_,{appliesTo:"singleRow",disabled:!1,disableAllow:a.allowed,disableDeny:!a.allowed,disableAnonymize:!a.allowed||a.allowed&&a.anonymized,disableUnanonymize:!a.allowed||a.allowed&&!a.anonymized,onListUpdated:e,onlyDefaults:null==t,selected:[a]}),sortable:!1,width:"36px"},i={field:"rawValues",name:k,render:e=>Object(C.jsx)(a.EuiCode,{"data-test-subj":"rawValues"},e.join(",")),sortable:!1},r=[{field:A,name:p,render:(n,{allowed:i,field:r})=>Object(C.jsx)(a.EuiSwitch,{"data-test-subj":"allowed",checked:i,label:"",showLabel:!1,onChange:()=>{e([{field:r,operation:i?"remove":"add",update:null==t?"defaultAllow":"allow"}]),null==t&&i&&e([{field:r,operation:"remove",update:"defaultAllowReplacement"}])}}),sortable:!0,width:"75px"},{field:P,name:g,render:(n,{allowed:i,anonymized:r,field:s})=>Object(C.jsx)(D,{"data-test-subj":"anonymized",disabled:!i,color:r?"primary":"text",flush:"both",iconType:r?"eyeClosed":"eye",isSelected:!!r,onClick:()=>e([{field:s,operation:r?"remove":"add",update:null==t?"defaultAllowReplacement":"allowReplacement"}])},Object(C.jsx)(a.EuiText,{size:"xs"},r?w:x)),sortable:!0,width:"102px"},{field:F,name:E,sortable:!0,width:"260px"}];return null==t?[...r,n]:[...r,i,n]})({onListUpdated:n,rawData:s})),[n,s]),f=Object(i.useMemo)((()=>(({allow:e,allowReplacement:t,rawData:n})=>{const a=new Set(t),i=new Set(e);return null!==n&&"object"==typeof n?Object.keys(n).sort().reduce(((e,t)=>[...e,{field:t,allowed:Object(N.a)({allowSet:i,field:t}),anonymized:Object(N.b)({allowReplacementSet:a,field:t}),denied:Object(N.c)({allowSet:i,field:t}),rawValues:n[t]}]),[]):e.sort().reduce(((e,t)=>[...e,{field:t,allowed:!0,anonymized:a.has(t),denied:!1,rawValues:[]}]),[])})({allow:e,allowReplacement:t,rawData:s})),[e,t,s]),b=Object(i.useCallback)((()=>{var e;null===(e=d.current)||void 0===e||e.setSelection(f),setTimeout((()=>u(f)),0)}),[f]),y=Object(i.useMemo)((()=>({initialPageSize:o,pageSizeOptions:[5,10,25,50]})),[o]),v=Object(i.useMemo)((()=>Object(C.jsx)(L,{onListUpdated:n,onlyDefaults:null==s,onReset:r,onSelectAll:b,selected:l,totalFields:f.length})),[n,r,b,s,f.length,l]);return Object(C.jsx)(a.EuiInMemoryTable,{allowNeutralSort:!1,childrenBetween:v,columns:m,compressed:!0,"data-test-subj":"contextEditor",isSelectable:!0,itemId:F,items:f,pagination:y,ref:d,search:B,selection:c,sorting:z})};q.displayName="ContextEditorComponent";const $=r.a.memo(q)},function(e,t,n){"use strict";n.d(t,"a",(function(){return Q})),n.d(t,"c",(function(){return K})),n.d(t,"b",(function(){return ee}));var a=n(23),i=n.n(a),r=n(17),s=n(114),o=n(2),l=n.n(o),u=n(82),c=n(48),d=n(44),p=n.n(d),m=n(124),f=n(195),g=n(291),b=n(439),y=n(666),v=n(174),h=n(515),E=n(710),x=n(689),j=n(5),O=n(66),S=n(122),k=n(9),w=n(19),T=n(127),I=n(118),C=n(110),M=n(758),_=n(116),A=n(121),P=n(754);const F=({field:e,value:t})=>null==t?e:Array.isArray(t)?`${e} ${t.join(" ")}`:`${e} ${t}`;var D=n(318);const N=l.a.memo((({className:e,Component:t,enablePopOver:n,field:a,flush:i,iconSide:s,iconType:u,isExpandable:c,onClick:d,onFilterAdded:p,ownFocus:m,paddingSize:f,showLegend:g,showTooltip:b=!0,showTopN:y,scopeId:v,title:h,value:E,globalFilters:x})=>{const O=Object(T.isActiveTimeline)(null!=v?v:"")?_.SourcererScopeName.timeline:null!=v&&Object(D.c)(v)?_.SourcererScopeName.detections:_.SourcererScopeName.default,{browserFields:S,indexPattern:k}=Object(A.d)(O),w=null!=u?u:"visBarVertical",I=null!=s?s:"left",C=null!=h?h:(N=a,j.i18n.translate("xpack.securitySolution.hoverActions.showTopTooltip",{values:{fieldName:N},defaultMessage:"Show top {fieldName}"}));var N;const R=Object(o.useMemo)((()=>t?l.a.createElement(t,{"aria-label":C,className:e,"data-test-subj":"show-top-field",icon:w,iconType:w,iconSide:I,flush:i,onClick:d,title:C},C):l.a.createElement(r.EuiButtonIcon,{"aria-label":C,className:"securitySolution__hoverActionButton","data-test-subj":"show-top-field",iconSize:"s",iconType:w,onClick:d})),[t,C,e,i,w,d,I]),L=Object(o.useMemo)((()=>b&&!y?l.a.createElement(r.EuiToolTip,{content:l.a.createElement(P.a,{additionalScreenReaderOnlyContext:F({field:a,value:E}),content:C,shortcut:"t",showShortcut:m})},R):R),[R,C,a,m,b,y,E]),z=Object(o.useMemo)((()=>l.a.createElement(M.a,{browserFields:S,field:a,indexPattern:k,onFilterAdded:p,paddingSize:f,showLegend:g,scopeId:null!=v?v:void 0,toggleTopN:d,globalFilters:x})),[S,a,k,p,f,g,v,d,x]);return c?l.a.createElement(l.a.Fragment,null,R,y&&z):y?n?l.a.createElement(r.EuiPopover,{button:R,isOpen:y,closePopover:d,panelClassName:"withHoverActions__popover","data-test-subj":"showTopNContainer"},z):z:L}));N.displayName="ShowTopNButton";var R=n(14),L=n(112),z=n(129);const B=p.a.div.withConfig({displayName:"AdditionalContent",componentId:"sc-hbiy4s-0"})(["padding:2px;"]);B.displayName="AdditionalContent";const q=p.a.div.withConfig({displayName:"StyledHoverActionsContainer",componentId:"sc-hbiy4s-1"})(["display:flex;"," ",""],(e=>e.$isActive?"\n    .hoverActions-active {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n  ":""),(e=>e.$showOwnFocus?`\n    &:focus-within {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n    &:hover {\n      .timelines__hoverActionButton,\n      .securitySolution__hoverActionButton {\n        opacity: 1;\n      }\n    }\n\n  .timelines__hoverActionButton,\n  .securitySolution__hoverActionButton {\n    opacity: ${e.$showTopN?1:0};\n\n      &:focus {\n        opacity: 1;\n      }\n    }\n  `:"")),$=p()(q).withConfig({displayName:"StyledHoverActionsContainerWithPaddingsAndMinWidth",componentId:"sc-hbiy4s-2"})(["min-width:",";padding:",";position:relative;"],(({$hiddenActionsCount:e})=>138-26*e+"px"),(e=>`0 ${e.theme.eui.euiSizeS}`)),V=({ownFocus:e,showTopN:t})=>!t&&!e,U=l.a.memo((({additionalContent:e=null,closePopOver:t,closeTopN:n,dataProvider:a,dataType:i,draggableId:s,enableOverflowButton:u=!1,applyWidthAndPadding:d=!0,field:p,fieldType:m,isAggregatable:f,goGetTimelineId:g,isObjectArray:b,hideAddToTimeline:y=!1,hideTopN:h=!1,onFilterAdded:E,ownFocus:x,showOwnFocus:M=!0,showTopN:_,scopeId:A,toggleColumn:P,toggleTopN:F,values:D})=>{const[U,H]=Object(o.useState)(),[Z,G]=Object(o.useState)(!1),[Q,W]=Object(o.useState)(!1),K=Object(o.useCallback)((()=>{G((e=>!e)),W(!Q)}),[Q,W]),J=Object(o.useCallback)((()=>{n&&n(),G(!1),W(!1),t&&t()}),[t,n]),Y=Object(o.useRef)(!0),X=Object(o.useRef)(null);Object(o.useEffect)((()=>{Y.current&&null!=g&&null==A&&(Y.current=!1,g(!0))}),[g,A]),Object(o.useEffect)((()=>{x&&setTimeout((()=>{var e;null===(e=X.current)||void 0===e||e.focus()}),0)}),[x]);const ee=Object(o.useCallback)((e=>{if(x)switch(e.key){case"t":Object(O.stopPropagationAndPreventDefault)(e),F();break;case"Enter":break;case"Escape":Object(O.stopPropagationAndPreventDefault)(e);break;default:H(e)}}),[x,F]),te=A===S.c.casePage,ne=A===S.c.active,ae=A===z.a.entityAnalytics,ie=Object(o.useMemo)((()=>ae&&!ne),[ne,ae]),re=Object(o.useMemo)((()=>(h?1:0)+(ie?2:0)),[ie,h]),{overflowActionItems:se,allActionItems:oe}=(({dataProvider:e,dataType:t,defaultFocusedButtonRef:n,draggableId:a,enableOverflowButton:i,field:s,fieldType:u,isAggregatable:d,handleHoverActionClicked:p,hideFilters:m,hideTopN:f,hideAddToTimeline:g,isCaseView:b,isObjectArray:y,isOverflowPopoverOpen:h,itemsToShow:E=2,onFilterAdded:x,onOverflowButtonClick:j,ownFocus:O,showTopN:M,stKeyboardEvent:_,scopeId:A,toggleColumn:P,toggleTopN:F,values:D})=>{const z=Object(C.i)(),B=Object(c.useDispatch)(),{timelines:q,uiSettings:$}=z.services,{getAddToTimelineButton:V,getColumnToggleButton:U,getCopyButton:H,getFilterForValueButton:Z,getFilterOutValueButton:G,getOverflowButton:Q}=q.getHoverActions(),W=Object(o.useMemo)((()=>z.services.data.query.filterManager),[z.services.data.query.filterManager]),K=Object(o.useMemo)((()=>I.b.getTimelineByIdSelector()),[]),J=Object(L.a)((e=>{var t;return Object(T.isActiveTimeline)(null!=A?A:"")?null===(t=K(e,null!=A?A:""))||void 0===t?void 0:t.filterManager:void 0})),Y=Object(o.useMemo)((()=>Object(T.isActiveTimeline)(null!=A?A:"")?null!=J?J:new w.FilterManager($):W),[A,J,$,W]),X=Object(o.useCallback)((()=>{e&&!Object(k.isEmpty)(e)&&B(Object(R.addProvider)({id:S.c.active,providers:e instanceof Array?e:[e]}))}),[e,B]),ee=Object(o.useCallback)((()=>{p&&p(),X()}),[p,X]),te=Object(o.useMemo)((()=>!m&&null!=D&&(i||!M&&!i)&&!b),[i,m,b,M,D]),ne=y&&"geo_point"!==s||b,ae=Object(o.useMemo)((()=>l.a.createElement(N,{Component:i?r.EuiContextMenuItem:void 0,"data-test-subj":"hover-actions-show-top-n",enablePopOver:!i&&b,field:s,key:"hover-actions-show-top-n",onClick:F,onFilterAdded:x,ownFocus:O,showTopN:M,showTooltip:!i,scopeId:A,value:D})),[i,b,s,F,x,O,M,A,D]),ie=Object(o.useMemo)((()=>[te?l.a.createElement("div",{"data-test-subj":"hover-actions-filter-for",key:"hover-actions-filter-for"},Z({defaultFocusedButtonRef:n,field:s,filterManager:Y,keyboardEvent:_,onClick:p,onFilterAdded:x,ownFocus:O,showTooltip:!i,value:D})):null,te?l.a.createElement("div",{"data-test-subj":"hover-actions-filter-out",key:"hover-actions-filter-out"},G({field:s,filterManager:Y,keyboardEvent:_,onFilterAdded:x,ownFocus:O,onClick:p,showTooltip:!i,value:D})):null,P&&!ne?l.a.createElement("div",{"data-test-subj":"hover-actions-toggle-column",key:"hover-actions-toggle-column"},U({Component:i?r.EuiContextMenuItem:void 0,field:s,isDisabled:y&&"geo_point"!==t,isObjectArray:y,keyboardEvent:_,ownFocus:O,onClick:p,showTooltip:!i,toggleColumn:P,value:D})):null,null==D||null==a&&Object(k.isEmpty)(e)||g?null:l.a.createElement("div",{"data-test-subj":"hover-actions-add-timeline",key:"hover-actions-add-timeline"},V({Component:i?r.EuiContextMenuItem:void 0,dataProvider:e,draggableId:a,field:s,keyboardEvent:_,ownFocus:O,onClick:ee,showTooltip:!i,value:D})),Object(v.e)({fieldType:u,isAggregatable:d,fieldName:s,hideTopN:f})?ae:null,null!=s?l.a.createElement("div",{"data-test-subj":"hover-actions-copy-button",key:"hover-actions-copy-button"},H({Component:i?r.EuiContextMenuItem:void 0,field:s,isHoverAction:!0,keyboardEvent:_,ownFocus:O,onClick:p,showTooltip:!i,value:D})):null].filter((e=>null!=e))),[e,t,n,a,i,s,u,d,Y,V,U,H,Z,G,p,ee,g,f,y,x,O,ne,te,ae,_,P,D]);return{overflowActionItems:Object(o.useMemo)((()=>[...ie.slice(0,E),...i&&E>0&&E<ie.length?[Q({closePopOver:p,field:s,keyboardEvent:_,ownFocus:O,onClick:j,showTooltip:!i,value:D,items:M?[ae]:ie.slice(E),isOverflowPopoverOpen:!!h})]:[]].filter((e=>null!=e))),[ie,i,s,Q,p,h,E,j,ae,O,M,_,D]),allActionItems:Object(o.useMemo)((()=>!M||i||b?ie:[ae]),[M,i,b,ae,ie])}})({dataProvider:a,dataType:i,defaultFocusedButtonRef:X,draggableId:s,enableOverflowButton:u&&!te,field:p,fieldType:m,hideFilters:ie,isAggregatable:f,handleHoverActionClicked:J,hideAddToTimeline:y,hideTopN:h,isCaseView:te,isObjectArray:b,isOverflowPopoverOpen:Q,onFilterAdded:E,onOverflowButtonClick:K,ownFocus:x,showTopN:_,stKeyboardEvent:U,toggleColumn:P,toggleTopN:F,values:D,scopeId:A}),le=d?$:q;return l.a.createElement(r.EuiFocusTrap,{disabled:V({ownFocus:x,showTopN:_})},l.a.createElement(le,{"data-test-subj":"hover-actions-container",onKeyDown:ee,$showTopN:_,$showOwnFocus:M,$hiddenActionsCount:re,$isActive:Z,className:Z?"hoverActions-active":""},l.a.createElement(r.EuiScreenReaderOnly,null,l.a.createElement("p",null,(ue=p,j.i18n.translate("xpack.securitySolution.dragAndDrop.youAreInADialogContainingOptionsScreenReaderOnly",{values:{fieldName:ue},defaultMessage:"You are in a dialog, containing options for field {fieldName}. Press tab to navigate options. Press escape to exit."})))),null!=e&&l.a.createElement(B,null,e),u&&!te?se:oe));var ue}));U.displayName="HoverActions";var H=n(729);const Z=({dataProvider:e,isAggregatable:t,fieldType:n,hideTopN:a,isDraggable:i,onFilterAdded:r,render:s,scopeId:u})=>{const{timelineId:c}=Object(o.useContext)(x.b),{tableId:d}=Object(o.useContext)(H.b),p=Object(o.useRef)(null),m=Object(o.useRef)(null),[f,g]=Object(o.useState)(!1),[b,y]=Object(o.useState)(!1),h=Object(o.useMemo)((()=>u||(null!=c?c:d)),[u,d,c]),E=Object(o.useCallback)((()=>{g((e=>!e)),y((e=>(e&&setTimeout((()=>{var e;null===(e=m.current)||void 0===e||e.focus()}),0),!1))),setTimeout((()=>{y(!1)}),0)}),[m]),{closeTopN:j,toggleTopN:O,isShowingTopN:S}=(e=>{const[t,n]=Object(o.useState)(!1),a=Object(o.useCallback)((()=>{n((t=>{const n=!t;return e&&e(n),n}))}),[e]);return{closeTopN:Object(o.useCallback)((()=>{n(!1)}),[]),toggleTopN:a,isShowingTopN:t}})(E),k=Object(o.useMemo)((()=>{const t=e.queryMatch.value;return"number"==typeof t||"boolean"==typeof t?t.toString():Array.isArray(t)?t.map((e=>String(e))):t}),[e.queryMatch.value]),w=Object(o.useMemo)((()=>{const o=b&&!S&&(null!==(c=null==(u=p.current)?void 0:u.querySelectorAll(".euiLink"))&&void 0!==c?c:[]).length>0?l.a.createElement(K,{"data-test-subj":`draggable-link-content-${e.queryMatch.field}`},s(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):null;var u,c;return l.a.createElement(U,{additionalContent:o,closeTopN:j,closePopOver:E,dataProvider:e,draggableId:i?Object(v.l)(e.id):void 0,field:e.queryMatch.field,isAggregatable:t,fieldType:n,hideTopN:a,isObjectArray:!1,onFilterAdded:r,ownFocus:b,showOwnFocus:!1,showTopN:S,scopeId:h,toggleTopN:O,values:k})}),[b,S,e,s,j,E,i,t,n,a,r,h,O,k]),T=Object(o.useCallback)((e=>{p.current=e}),[]),I=Object(o.useCallback)((()=>{var e;b||null===(e=m.current)||void 0===e||e.focus()}),[b,m]),C=Object(o.useCallback)((()=>{j(),b&&(y(!1),setTimeout((()=>{I()}),0))}),[I,b,j]),M=Object(o.useCallback)((()=>{y(!0)}),[]);return Object(o.useMemo)((()=>({closePopOverTrigger:f,handleClosePopOverTrigger:E,hoverActionsOwnFocus:b,hoverContent:w,keyboardHandlerRef:m,onCloseRequested:C,onFocus:I,openPopover:M,setContainerRef:T,isShowingTopN:S})),[f,E,b,w,C,I,M,T,S])};var G=n(694);const Q=p.a.div.withConfig({displayName:"DragEffects",componentId:"sc-1n4vnmw-0"})([""]);Q.displayName="DragEffects";class draggable_wrapper_DragDropErrorBoundary extends l.a.PureComponent{componentDidCatch(){this.forceUpdate()}render(){return this.props.children}}const W=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-1n4vnmw-1"})(["display:inline-block;max-width:100%;[data-rbd-placeholder-context-id]{display:none !important;}",""],(({disabled:e})=>e&&"\n    [data-rbd-draggable-id]:hover,\n    .euiBadge:hover,\n    .euiBadge__text:hover {\n      cursor: default;\n    }\n  "));W.displayName="Wrapper";const K=p.a.span.withConfig({displayName:"ProviderContentWrapper",componentId:"sc-1n4vnmw-2"})(["> span.euiToolTipAnchor{display:block;}> span.euiToolTipAnchor.eui-textTruncate{display:inline-block;}"]),J=(e,t)=>t.isDropAnimating?{...e,transitionDuration:"0.00000001s"}:e,Y=({dataProvider:e,hideTopN:t=!1,onFilterAdded:n,render:a,fieldType:d="",isAggregatable:p=!1,scopeId:m,truncate:x})=>{const[j,O]=Object(o.useState)(!1),S=e.id.includes(`-${g.a}-`),k=Object(c.useDispatch)(),{closePopOverTrigger:w,handleClosePopOverTrigger:T,hoverActionsOwnFocus:I,hoverContent:C,keyboardHandlerRef:M,onCloseRequested:_,openPopover:A,onFocus:P,setContainerRef:F,isShowingTopN:D}=Z({dataProvider:e,hideTopN:t,onFilterAdded:n,render:a,fieldType:d,isAggregatable:p,scopeId:m,truncate:x}),N=Object(o.useCallback)((()=>{S||(k(f.a.registerProvider({provider:e})),O(!0))}),[S,k,e]),R=Object(o.useCallback)((()=>j&&k(f.a.unRegisterProvider({id:e.id}))),[j,k,e.id]);Object(o.useEffect)((()=>()=>{R()}),[R]);const L=Object(o.useCallback)(((t,n)=>l.a.createElement(te,{registerProvider:N},l.a.createElement("div",i()({},t.draggableProps,t.dragHandleProps,{style:J(t.draggableProps.style,n),ref:t.innerRef,"data-test-subj":"providerContainer",tabIndex:-1}),l.a.createElement(K,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},a(e,t,n))))),[e,N,a]),z=Object(o.useCallback)(((t,n)=>l.a.createElement(h.a,i()({},t.draggableProps,t.dragHandleProps,{ref:e=>{t.innerRef(e),F(e)},"data-test-subj":"providerContainer",isDragging:n.isDragging,registerProvider:N,tabIndex:-1}),l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyField"},l.a.createElement("p",null,e.queryMatch.field)),x&&!n.isDragging?l.a.createElement(b.b,{"data-test-subj":"draggable-truncatable-content"},a(e,t,n)):l.a.createElement(K,{"data-test-subj":`draggable-content-${e.queryMatch.field}`},a(e,t,n)),!n.isDragging&&l.a.createElement(r.EuiScreenReaderOnly,{"data-test-subj":"draggableKeyboardInstructionsNotDragging"},l.a.createElement("p",null,E.b)))),[e,N,a,F,x]),{onBlur:B,onKeyDown:q}=Object(G.a)({closePopover:T,draggableId:Object(v.l)(e.id),fieldName:e.queryMatch.field,keyboardHandlerRef:M,openPopover:A}),$=Object(o.useCallback)((t=>l.a.createElement("div",i()({ref:t.innerRef},t.droppableProps),l.a.createElement("div",{className:s.a,"data-test-subj":"draggableWrapperKeyboardHandler",onClick:P,onBlur:B,onKeyDown:q,ref:M,role:"button",tabIndex:0},l.a.createElement(u.Draggable,{draggableId:Object(v.l)(e.id),index:0,key:Object(v.l)(e.id),isDragDisabled:S},z)),t.placeholder)),[z,e.id,S,M,B,P,q]),V=Object(o.useMemo)((()=>l.a.createElement(W,{"data-test-subj":"draggableWrapperDiv",disabled:S},l.a.createElement(draggable_wrapper_DragDropErrorBoundary,null,l.a.createElement(u.Droppable,{isDropDisabled:!0,droppableId:Object(v.m)(e.id),renderClone:L},$)))),[$,L,e.id,S]),U=Object(o.useCallback)((()=>V),[V]);return S?l.a.createElement(l.a.Fragment,null,V):l.a.createElement(y.a,{alwaysShow:D||I,closePopOverTrigger:w,hoverContent:C,onCloseRequested:_,render:U})},X=({dataProvider:e,hideTopN:t=!1,isDraggable:n=!1,onFilterAdded:a,render:i,isAggregatable:r=!1,fieldType:s="",scopeId:u,truncate:c})=>{const{closePopOverTrigger:d,hoverActionsOwnFocus:p,hoverContent:f,onCloseRequested:h,setContainerRef:E,isShowingTopN:x}=Z({dataProvider:e,hideTopN:t,isDraggable:n,isAggregatable:r,fieldType:s,onFilterAdded:a,render:i,scopeId:u,truncate:c}),j=Object(o.useCallback)((()=>l.a.createElement("div",{ref:e=>{E(e)},tabIndex:-1,"data-provider-id":Object(v.l)(e.id)},c?l.a.createElement(b.b,{"data-test-subj":"render-truncatable-content"},i(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})):l.a.createElement(K,{"data-test-subj":`render-content-${e.queryMatch.field}`},i(e,null,{isDragging:!1,isDropAnimating:!1,isClone:!1,dropAnimation:null,draggingOver:null,combineWith:null,combineTargetFor:null,mode:null})))),[e,i,E,c]);return n?l.a.createElement(Y,{dataProvider:e,hideTopN:t,onFilterAdded:a,fieldType:s,isAggregatable:r,render:i,scopeId:u,truncate:c}):l.a.createElement(y.a,{alwaysShow:x||p,closePopOverTrigger:d,hoverContent:(O=u,[m.e.rulePreview,g.a].includes(null!=O?O:"")?void 0:f),onCloseRequested:h,render:j});var O},ee=l.a.memo(X);ee.displayName="DraggableWrapper";const te=l.a.memo((({children:e,registerProvider:t})=>(Object(o.useEffect)((()=>{t()}),[t]),l.a.createElement(l.a.Fragment,null,e))));te.displayName="ConditionalPortal"},function(e,t,n){"use strict";n.d(t,"b",(function(){return a.a})),n.d(t,"a",(function(){return i.a})),n.d(t,"c",(function(){return r.h}));var a=n(423),i=n(584),r=n(150)},function(e,t,n){"use strict";n.d(t,"a",(function(){return M}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17),l=n(48),u=n(45);const c=n(5).i18n.translate("xpack.securitySolution.components.histogram.stackByOptions.stackByLabel",{defaultMessage:"Stack by"});var d=n(170),p=n(431),m=n(383),f=n(759),g=n(158),b=n(119),y=n(276),v=n(339),h=n(160),E=n(130),x=n(190),j=n(330),O=n(598),S=n(525);const k=({isInitialLoading:e,barChart:t,configs:n,stackByField:a,scopeId:r})=>e?i.a.createElement(S.a,null):i.a.createElement(O.a,{barChart:t,configs:n,stackByField:a,scopeId:r}),w=i.a.memo(k);k.displayName="MatrixHistogramChartContentComponent";var T=n(347);const I=s()(p.a).withConfig({displayName:"HistogramPanel",componentId:"sc-cnfih-0"})(["display:flex;flex-direction:column;",""],(({height:e})=>null!=e?`min-height: ${e}px;`:"")),C=({chartHeight:e,defaultStackByOption:t,endDate:n,errorMessage:r,filterQuery:s,getLensAttributes:p,headerChildren:O,histogramType:S,hideHistogramIfEmpty:k=!1,id:C,indexNames:M,runtimeMappings:_,isPtrIncluded:A,legendPosition:P,lensAttributes:F,mapping:D,onError:N,paddingSize:R="m",panelHeight:L=300,setAbsoluteRangeDatePickerTarget:z=b.a.global,setQuery:B,showInspectButton:q=!1,showLegend:$,showSpacer:V=!0,stackByOptions:U,startDate:H,subtitle:Z,scopeId:G,sourcererScopeId:Q,title:W,titleSize:K,yTickFormatter:J,skip:Y,hideQueryToggle:X=!1,applyGlobalQueriesAndFilters:ee=!0})=>{const te=`${C}-embeddable`,ne=Object(l.useDispatch)(),ae=Object(a.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;ne(Object(g.setAbsoluteRangeDatePicker)({id:z,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[ne,z]),ie=Object(a.useMemo)((()=>Object(m.b)({chartHeight:e,from:H,legendPosition:P,to:n,onBrushEnd:ae,yTickFormatter:J,showLegend:$})),[e,H,P,n,ae,J,$]),[re,se]=Object(a.useState)(!0),[oe,le]=Object(a.useState)(t);Object(a.useEffect)((()=>{le(t)}),[t]);const ue=Object(a.useCallback)((e=>{var n;le(null!==(n=U.find((t=>t.value===e.target.value)))&&void 0!==n?n:t)}),[t,U]),{toggleStatus:ce,setToggleStatus:de}=Object(h.a)(C),[pe,me]=Object(a.useState)(Y||!ce);Object(a.useEffect)((()=>{me(Y||!ce)}),[Y,ce]);const fe=Object(a.useCallback)((e=>{de(e),me(!e)}),[me,de]),ge=Object(E.a)("chartEmbeddablesEnabled"),be={endDate:n,errorMessage:r,filterQuery:s,histogramType:S,indexNames:M,onError:N,startDate:H,stackByField:oe.value,runtimeMappings:_,isPtrIncluded:A,skip:pe||ge},[ye,{data:ve,inspect:he,totalCount:Ee,refetch:xe}]=Object(f.a)(be),je=Object(a.useMemo)((()=>null!=W&&"function"==typeof W?W(oe):W),[W,oe]),Oe=Object(T.a)({visualizationId:te}),Se=Object(a.useMemo)((()=>{if(re)return null;if("function"==typeof Z){if(ge){if(!Oe||(e=Oe[0],!Object.values(null!==(t=e.aggregations)&&void 0!==t?t:{}).some((({buckets:e})=>e.length>0))))return Z(0);const n=Oe[0].hits.total;return n>=0?Z(n):null}return Ee>=0?Z(Ee):null}var e,t;return Z}),[ge,re,Z,Ee,Oe]),ke=Object(a.useMemo)((()=>!!(Ee<=0&&k)),[Ee,k]),we=Object(a.useMemo)((()=>Object(m.c)(ve,D)),[ve,D]);Object(a.useEffect)((()=>{ye||re||B({id:C,inspect:he,loading:ye,refetch:xe}),re&&we&&ve&&se(!1)}),[we,ve,C,he,ge,re,ye,xe,se,B]);const Te=Object(a.useMemo)((()=>({from:H,to:n})),[H,n]),Ie=Object(a.useMemo)((()=>({dnsIsPtrIncluded:null!=A&&A,filters:s?[{query:Object(u.isString)(s)?JSON.parse(s):s,meta:{}}]:void 0})),[A,s]);return ke?null:i.a.createElement(i.a.Fragment,null,i.a.createElement(y.a,{show:!re,targetClassNames:[x.a]},i.a.createElement(I,{"data-test-subj":`${C}Panel`,height:ce?L:void 0,paddingSize:R},ye&&!re&&i.a.createElement(o.EuiProgress,{"data-test-subj":"initialLoadingPanelMatrixOverTime",size:"xs",position:"absolute",color:"accent"}),i.a.createElement(d.a,{id:C,height:ce?void 0:0,title:je,titleSize:K,toggleStatus:ce,toggleQuery:X?void 0:fe,subtitle:Se,inspectMultiple:!0,showInspectButton:q&&!ge,isInspectDisabled:void 0===s},i.a.createElement(o.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},(p||F)&&Te&&!ge&&i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(v.a,{className:"histogram-viz-actions",extraOptions:Ie,getLensAttributes:p,isInspectButtonDisabled:void 0===s,lensAttributes:F,queryId:C,stackByField:oe.value,timerange:Te,title:W})),i.a.createElement(o.EuiFlexItem,{grow:!1},U.length>1&&i.a.createElement(o.EuiSelect,{onChange:ue,options:U,prepend:c,value:null==oe?void 0:oe.value})),i.a.createElement(o.EuiFlexItem,{grow:!1},O))),ce?ge?i.a.createElement(j.a,{scopeId:Q,applyGlobalQueriesAndFilters:ee,"data-test-subj":"embeddable-matrix-histogram",extraOptions:Ie,getLensAttributes:p,height:null!=e?e:150,id:te,inspectTitle:W,lensAttributes:F,stackByField:oe.value,timerange:Te}):i.a.createElement(w,{isInitialLoading:re,barChart:we,configs:ie,stackByField:oe.value,scopeId:G}):null)),V&&i.a.createElement(o.EuiSpacer,{"data-test-subj":"spacer",size:"l"}))},M=i.a.memo(C)},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(5);const u=l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.anonymizeFieldsdDescription",{defaultMessage:"Anonymized"});var c=n(372),d=n(13);const p=o()(a.EuiFlexItem)`
  margin-right: ${({theme:e})=>e.eui.euiSizeS};
`,m=({anonymized:e,isDataAnonymizable:t,showIcon:n=!1})=>{const r=Object(i.useMemo)((()=>(e=>e?"default":"subdued")(t)),[t]),s=Object(i.useMemo)((()=>(({anonymized:e,isDataAnonymizable:t})=>t&&0!==e?(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.fieldsWillBeAnonymizedTooltip",{values:{anonymized:e},defaultMessage:"{anonymized} {anonymized, plural, =1 {field} other {fields}} in this context will be replaced with random values. Responses are automatically translated back to the original values."}))(e):(e=>l.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.anonymizedStat.noneOfTheDataWillBeAnonymizedTooltip",{values:{isDataAnonymizable:e},defaultMessage:"{isDataAnonymizable, select, true {Select fields to be replaced with random values. Responses are automatically translated back to the original values.} other {This context cannot be anonymized}}"}))(t))({anonymized:e,isDataAnonymizable:t})),[e,t]),o=Object(i.useMemo)((()=>Object(d.jsx)(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n&&Object(d.jsx)(p,{grow:!1},Object(d.jsx)(a.EuiIcon,{color:r,"data-test-subj":"anonymizationIcon",size:"m",type:"eyeClosed"})),Object(d.jsx)(a.EuiFlexItem,{grow:!1},Object(d.jsx)(a.EuiText,{color:r,"data-test-subj":"description",size:"s"},u)))),[r,n]);return Object(d.jsx)(a.EuiToolTip,{content:s},Object(d.jsx)(a.EuiStat,{"data-test-subj":"anonymizedFieldsStat",description:o,reverse:!0,titleColor:r,title:e,titleSize:c.a}))};m.displayName="AnonymizedStatComponent";const f=r.a.memo(m)},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(76),s=n(17),o=n(179),l=n(177),u=n(13);const c=Object(o.css)({name:"1les383",styles:".euiKeyPadMenuItem__label{white-space:nowrap;overflow:hidden;}"}),d=({actionTypes:e,actionTypeRegistry:t,onClose:n,onSelect:a})=>e&&e.length>0?Object(u.jsx)(s.EuiModal,{onClose:n,"data-test-subj":"action-type-selector-modal"},Object(u.jsx)(s.EuiModalHeader,null,Object(u.jsx)(s.EuiModalHeaderTitle,null,l.m)),Object(u.jsx)(s.EuiModalBody,null,Object(u.jsx)(s.EuiFlexGroup,null,e.map((e=>{const n=t.get(e.id);return Object(u.jsx)(s.EuiFlexItem,{"data-test-subj":"action-option",key:e.id,grow:!1},Object(u.jsx)(s.EuiKeyPadMenuItem,{className:c,key:e.id,isDisabled:!e.enabled,label:e.name,"data-test-subj":`action-option-${e.name}`,onClick:()=>a(e)},Object(u.jsx)(s.EuiIcon,{size:"xl",type:n.iconClass})))}))))):null,p=i.a.memo((({actionTypeRegistry:e,actionTypes:t,onClose:n,onSaveConnector:a,onSelectActionType:i,selectedActionType:s})=>s?Object(u.jsx)(r.ConnectorAddModal,{actionType:s,actionTypeRegistry:e,onClose:n,postSaveEventHandler:a}):Object(u.jsx)(d,{actionTypes:t,actionTypeRegistry:e,onClose:n,onSelect:i})));p.displayName="AddConnectorModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(5);const i=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneralPrompt",{defaultMessage:"Welcome to your Elastic AI Assistant! I am your 100% open-code portal into your Elastic life. In time, I will be able to answer questions and provide assistance across all your information in Elastic, and oh-so much more. Till then, I hope this early preview will open your mind to the possibilities of what we can create when we work together, in the open. Cheers!"}),r=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneral2Prompt",{defaultMessage:"First things first, we'll need to set up a Generative AI Connector to get this chat experience going! With the Generative AI Connector, you'll be able to configure access to either an OpenAI service or an Amazon Bedrock service, but you better believe you'll be able to deploy your own models within your Elastic Cloud instance and use those here in the future... ðŸ˜‰"}),s=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.welcomeGeneral3Prompt",{defaultMessage:"Go ahead and click the add connector button below to continue the conversation!"}),o=a.i18n.translate("xpack.elasticAssistant.securityAssistant.content.prompts.welcome.enterprisePrompt",{defaultMessage:"Elastic AI Assistant is available to Enterprise users only. Please upgrade your license to use this feature."});var l=n(168);const u={id:l.d,theme:{title:l.c,titleIcon:"logoSecurity",assistant:{name:l.b,icon:"logoSecurity"},system:{icon:"logoElastic"},user:{}},messages:[{role:"assistant",content:i,timestamp:"",presentation:{delay:2e3,stream:!0}},{role:"assistant",content:r,timestamp:"",presentation:{delay:1e3,stream:!0}},{role:"assistant",content:s,timestamp:"",presentation:{delay:1e3,stream:!0}}],apiConfig:{}},c=[{role:"assistant",content:o,timestamp:"",presentation:{delay:2e3,stream:!0}}]},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n.n(a),r=n(743),s=n(67),o=n(110),l=n(39),u=n(164);const c=({attributes:e})=>{const{lens:t,theme:n,i18n:c}=Object(o.i)().services,{SaveModalComponent:d,canUseEditor:p}=t,m=Object(u.m)(),{redirectTo:f,getEditOrCreateDashboardPath:g}=(({getSecuritySolutionUrl:e})=>{const{navigateTo:t}=Object(o.j)(),n=Object(a.useMemo)((()=>`${e({deepLinkId:l.SecurityPageName.dashboards})}`),[e]),i=Object(a.useCallback)((e=>null!=e&&"new"!==e?`${e}/edit`:"/create"),[]),r=Object(a.useCallback)((t=>`${e({deepLinkId:l.SecurityPageName.dashboards,path:i(t)})}`),[i,e]);return{redirectTo:Object(a.useCallback)((e=>{"listing"===e.destination&&t({url:n}),"dashboard"===e.destination&&t({url:r(e.id)})}),[n,r,t]),getEditOrCreateDashboardPath:i,getEditOrCreateDashboardUrl:r,dashboardListingUrl:n}})({getSecuritySolutionUrl:m});return{openSaveVisualizationFlyout:Object(a.useCallback)((()=>{const t=document.createElement("div");Object(r.a)(i.a.createElement(d,{initialInput:e,onSave:e=>{Object(s.unmountComponentAtNode)(t)},onClose:()=>{Object(s.unmountComponentAtNode)(t)},originatingApp:l.APP_UI_ID,getOriginatingPath:e=>`${l.SecurityPageName.dashboards}/${g(e)}`,redirectTo:f}),{theme:n,i18n:c})(t)}),[d,e,g,c,f,n]),disableVisualizations:Object(a.useMemo)((()=>!p()||null==e),[e,p])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return j}));var a=n(13),i=n(17),r=n(2),s=n.n(r),o=n(55),l=n(44),u=n.n(l),c=n(45),d=n(373);const p=u.a.strong`
  margin-right: ${({theme:e})=>e.eui.euiSizeS};
`;var m={name:"16fopk3",styles:"overflow:hidden;&:hover{cursor:pointer;text-decoration:underline;}"};var f=n(123),g=n(221),b=n(259),y=n(251);const v="ADD_NEW_SYSTEM_PROMPT";var h={name:"1bxycju",styles:"min-width:100%"},E={name:"qhxz92",styles:"max-width:100%"};const x=({allSystemPrompts:e,compressed:t=!1,conversation:n,selectedPrompt:l,clearSelectedSystemPrompt:u,isClearable:x=!1,isEditing:j=!1,isDisabled:O=!1,isOpen:S=!1,isSettingsModalVisible:k,onSystemPromptSelectionChange:w,setIsEditing:T,setIsSettingsModalVisible:I,showTitles:C=!1})=>{var M;const{setSelectedSettingsTab:_}=Object(f.b)(),{setApiConfig:A}=Object(g.a)(),[P,F]=Object(r.useState)(S),D=Object(r.useCallback)((()=>F(!1)),[]),N=Object(r.useCallback)((e=>{n&&A({conversationId:n.id,apiConfig:{...n.apiConfig,defaultSystemPromptId:null==e?void 0:e.id}})}),[n,A]),R=Object(r.useMemo)((()=>({value:v,inputDisplay:d.a,dropdownDisplay:Object(a.jsx)(i.EuiFlexGroup,{gutterSize:"none",key:v},Object(a.jsx)(i.EuiFlexItem,{grow:!0},Object(a.jsx)(i.EuiButtonEmpty,{href:"#",iconType:"plus",size:"xs","data-test-subj":"addSystemPrompt"},d.a)),Object(a.jsx)(i.EuiFlexItem,{grow:!1},Object(a.jsx)("div",{style:{width:"24px"}})))})),[]),L=Object(r.useMemo)((()=>(({prompts:e,showTitles:t=!1})=>{var n;return null!==(n=null==e?void 0:e.map((e=>(({content:e,id:t,name:n,showTitles:r=!1})=>({value:t,inputDisplay:Object(a.jsx)(i.EuiText,{color:"subdued","data-test-subj":"systemPromptText",css:m},r?n:e),dropdownDisplay:Object(a.jsx)(s.a.Fragment,null,Object(a.jsx)(p,{"data-test-subj":"name"},n),Object(a.jsx)(i.EuiToolTip,{content:void 0},Object(a.jsx)(i.EuiText,{color:"subdued","data-test-subj":"content",size:"s"},Object(c.isEmpty)(e)?Object(a.jsx)("p",null,d.d):Object(a.jsx)("p",null,e))))}))({...e,showTitles:t}))))&&void 0!==n?n:[]})({prompts:e,showTitles:C})),[e,C]),z=Object(r.useCallback)((t=>{if(t===v)return I(!0),void _(b.d);null!=w?w(t):N(e.find((e=>e.id===t))),null==T||T(!1)}),[e,w,T,I,_,N]),B=Object(r.useCallback)((()=>{N(void 0),null==T||T(!1),null==u||u()}),[u,T,N]),q=Object(r.useCallback)((()=>{null==T||T(!0),F(!0)}),[T]);return Object(a.jsx)(i.EuiFlexGroup,{"data-test-subj":"selectSystemPrompt",gutterSize:"none"},Object(a.jsx)(i.EuiFlexItem,{css:E},j&&Object(a.jsx)(i.EuiFormRow,{css:h},Object(a.jsx)(i.EuiSuperSelect,{popoverProps:{zIndex:o.euiThemeVars.euiZLevel8},compressed:t,"data-test-subj":y.a.PROMPT_SUPERSELECT,fullWidth:!0,hasDividers:!0,itemLayoutAlign:"top",disabled:O,isOpen:P&&!k,onChange:z,onBlur:D,options:[...L,R],placeholder:d.e,valueOfSelected:null!==(M=null==l?void 0:l.id)&&void 0!==M?M:e[0].id}))),Object(a.jsx)(i.EuiFlexItem,{grow:!1},j&&x&&Object(a.jsx)(i.EuiToolTip,{content:d.c},Object(a.jsx)(i.EuiButtonIcon,{"aria-label":d.c,"data-test-subj":"clearSystemPrompt",iconType:"cross",onClick:B})),!j&&Object(a.jsx)(i.EuiToolTip,{content:d.b},Object(a.jsx)(i.EuiButtonIcon,{"aria-label":d.b,"data-test-subj":"addSystemPrompt",iconType:"plus",onClick:q}))))};x.displayName="SelectSystemPromptComponent";const j=s.a.memo(x)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(17),i=n(2),r=n.n(i),s=n(372),o=n(5);const l=o.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedDescription",{defaultMessage:"Allowed"});var u=n(13);const c=({allowed:e,total:t})=>{const n=Object(i.useMemo)((()=>(({allowed:e,total:t})=>o.i18n.translate("xpack.elasticAssistant.dataAnonymizationEditor.stats.allowedStat.allowedTooltip",{values:{allowed:e,total:t},defaultMessage:"{allowed} of {total} fields in this context are allowed to be included in the conversation"}))({allowed:e,total:t})),[e,t]);return Object(u.jsx)(a.EuiToolTip,{content:n},Object(u.jsx)(a.EuiStat,{"data-test-subj":"allowedStat",description:l,reverse:!0,title:e,titleSize:s.a}))};c.displayName="AllowedStatComponent";const d=r.a.memo(c)},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorGetAlertDescription",{defaultMessage:"Failed to get signal index name"}),r=a.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.errorPostAlertDescription",{defaultMessage:"Failed to create signal index"}),s=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.failedToIsolate.title",{defaultMessage:"Failed to isolate host"}),o=a.i18n.translate("xpack.securitySolution.endpoint.hostIsolation.casesFromAlerts.title",{defaultMessage:"Failed to find associated cases"});a.i18n.translate("xpack.securitySolution.containers.detectionEngine.users.userProfiles.title",{defaultMessage:"Failed to find users"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(295),i=n(334);const r=async(e,t,n=!1)=>{var r,s;const o=await t.get(e,!0,n),l=o.toSpec(),u=Object(a.a)(o.getIndexPattern().split(",")),c=await t.getExistingIndices(u);return{loading:!1,id:null!==(r=l.id)&&void 0!==r?r:"",title:o.getIndexPattern(),indexFields:o.fields,fields:l.fields,patternList:c,dataView:l,browserFields:Object(i.a)(null!==(s=l.id)&&void 0!==s?s:"",l.fields).browserFields,runtimeMappings:l.runtimeFieldMap}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.indexFieldsSearch.errorSearchDescription",{defaultMessage:"An error has occurred creating the ad-hoc data view"}),r=a.i18n.translate("xpack.securitySolution.dataView.fetchFields.warning",{defaultMessage:"Failed to fetch detailed fields information"})},,,function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),n(338).NetworkType.details,function(e){e.anomalies="anomalies",e.flows="flows",e.tls="tls",e.http="http",e.events="events",e.users="users"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return S})),n.d(t,"a",(function(){return k}));var a=n(136),i=n.n(a),r=n(45),s=n(2),o=n(48),l=n(3),u=n(54),c=n(110),d=n(209),p=n(118),m=n(446),f=n(127),g=n(125),b=n(122),y=n(202),v=n(282),h=n(336),E=n(4);const x="timelineEventsQuery",j=[{field:"@timestamp",direction:g.b.asc,type:"date",esTypes:["date"]}],O=e=>({...Object(r.isEmpty)(null==e?void 0:e.eventCategoryField)?{}:{eventCategoryField:null==e?void 0:e.eventCategoryField},...Object(r.isEmpty)(null==e?void 0:e.size)?{}:{size:null==e?void 0:e.size},...Object(r.isEmpty)(null==e?void 0:e.tiebreakerField)?{}:{tiebreakerField:null==e?void 0:e.tiebreakerField},...Object(r.isEmpty)(null==e?void 0:e.timestampField)?{}:{timestampField:null==e?void 0:e.timestampField}}),S=({dataViewId:e,endDate:t,eqlOptions:n,id:a=x,indexNames:S,fields:k,filterQuery:w,runtimeMappings:T,startDate:I,language:C="kuery",limit:M,sort:_=j,skip:A=!1,timerangeKind:P})=>{const[{pageName:F}]=Object(y.a)(),D=Object(o.useDispatch)(),{data:N}=Object(c.i)().services,R=Object(s.useRef)(r.noop),L=Object(s.useRef)(new AbortController),z=Object(s.useRef)(new l.Subscription),[B,q]=Object(s.useState)(!1),[$,V]=Object(s.useState)(a===b.c.active?v.a.getActivePage():0),[U,H]=Object(s.useState)(null),Z=Object(s.useRef)(null),{startTracking:G}=Object(h.a)(),Q=Object(s.useCallback)((()=>{null!=a&&m.a.some((e=>e===a))&&(D(p.a.clearEventsLoading({id:a})),D(p.a.clearEventsDeleted({id:a})))}),[D,a]),W=Object(s.useCallback)((e=>{Q(),a===b.c.active&&(v.a.setExpandedDetail({}),v.a.setActivePage(e)),V(e)}),[Q,a]),K=Object(s.useCallback)((()=>{null!=R.current&&R.current(),W(0)}),[W]),[J,Y]=Object(s.useState)({id:a,inspect:{dsl:[],response:[]},refetch:K,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:W,refreshedAt:0}),X=Object(s.useCallback)((async(t,n)=>{if(null==t||""===F||A)return;const i=async()=>{Z.current=t,L.current=new AbortController,q(!0);const{endTracking:i}=G({name:`${E.l} timeline events search`});z.current=N.search.search(t,{strategy:"eql"===t.language?"timelineEqlSearchStrategy":"timelineSearchStrategy",abortSignal:L.current.signal,indexPattern:{id:e}}).subscribe({next:e=>{Object(u.isRunningResponse)(e)||(i("success"),q(!1),Y((i=>{const r={...i,events:(s=e.edges,s.map((e=>e.node))),inspect:Object(f.getInspectResponse)(e,i.inspect),pageInfo:e.pageInfo,totalCount:e.totalCount,refreshedAt:Date.now()};var s;return a===b.c.active&&(v.a.setExpandedDetail({}),v.a.setPageName(F),"eql"===t.language?(v.a.setEqlRequest(t),v.a.setEqlResponse(r)):(v.a.setRequest(t),v.a.setResponse(r))),n&&n(r),r})),z.current.unsubscribe())},error:e=>{i(L.current.signal.aborted?"aborted":"error"),q(!1),N.search.showError(e),z.current.unsubscribe()}})};if(a===b.c.active&&""!==v.a.getPageName()&&F!==v.a.getPageName()){if(v.a.setPageName(F),L.current.abort(),q(!1),"eql"===t.language?(Z.current=v.a.getEqlRequest(),R.current=i.bind(null,v.a.getEqlRequest())):(Z.current=v.a.getRequest(),R.current=i.bind(null,v.a.getRequest())),Y((e=>{const n="eql"===t.language?v.a.getEqlResponse():v.a.getResponse();return null!=n?{...n,refetch:K,loadPage:W}:e})),"eql"!==t.language&&null!=v.a.getResponse())return;if("eql"===t.language&&null!=v.a.getEqlResponse())return}z.current.unsubscribe(),L.current.abort(),await i(),R.current=i}),[F,A,a,G,N.search,e,K,W]);Object(s.useEffect)((()=>{0!==S.length&&H((e=>{var r,s,o,l,u,c,p;const m=e,f={defaultIndex:null!==(r=null==e?void 0:e.defaultIndex)&&void 0!==r?r:[],filterQuery:null!==(s=null==e?void 0:e.filterQuery)&&void 0!==s?s:"",querySize:null!==(o=null==e||null===(l=e.pagination)||void 0===l?void 0:l.querySize)&&void 0!==o?o:0,sort:null!==(u=null==e?void 0:e.sort)&&void 0!==u?u:j,timerange:null!==(c=null==e?void 0:e.timerange)&&void 0!==c?c:{},runtimeMappings:null!==(p=null==e?void 0:e.runtimeMappings)&&void 0!==p?p:{},...O(m)},y=I&&t?{timerange:{interval:"12h",from:I,to:t}}:{},h={defaultIndex:S,filterQuery:Object(d.a)(w),querySize:M,sort:_,runtimeMappings:T,...y,...O(n)},E=i()(f,h)?$:0,x={defaultIndex:S,factoryQueryType:g.y.all,fieldRequested:k,fields:k,filterQuery:Object(d.a)(w),pagination:{activePage:E,querySize:M},language:C,runtimeMappings:T,sort:_,...y,...n||{}};return $!==E&&(V(E),a===b.c.active&&v.a.setActivePage(E)),i()(e,x)?e:x}))}),[D,S,$,t,n,w,a,C,M,I,_,k,T]);const ee=Object(s.useCallback)((async e=>{a===b.c.active&&"absolute"!==P&&i()(Z.current,U)||await X(U,e)}),[a,U,X,P]);return Object(s.useEffect)((()=>{Object(r.isEmpty)(w)&&Y({id:a,inspect:{dsl:[],response:[]},refetch:K,totalCount:-1,pageInfo:{activePage:0,querySize:0},events:[],loadPage:W,refreshedAt:0})}),[w,a,K,W]),[B,J,ee]},k=({dataViewId:e,endDate:t,eqlOptions:n,id:a=x,indexNames:i,fields:r,filterQuery:o,runtimeMappings:l,startDate:u,language:c="kuery",limit:d,sort:p=j,skip:m=!1,timerangeKind:f})=>{const[g,b,y]=S({dataViewId:e,endDate:t,eqlOptions:n,id:a,indexNames:i,fields:r,filterQuery:o,runtimeMappings:l,startDate:u,language:c,limit:d,sort:p,skip:m,timerangeKind:f});return Object(s.useEffect)((()=>{y&&y()}),[y]),[g,b]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(19),r=n(110);const s=()=>{const e=Object(r.i)(),{http:t}=e.services,[n,s]=Object(a.useState)(Object(i.createSavedQueryService)(t));return Object(a.useEffect)((()=>{s(Object(i.createSavedQueryService)(t))}),[t]),n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(4),r=n(110);const s=({defaultValue:e,key:t,plugin:n=i.i,isInvalidDefault:s})=>{const{storage:o}=Object(r.i)().services,[l,u]=Object(a.useState)(!1),[c,d]=Object(a.useState)(e),p=Object(a.useCallback)((()=>{const a=o.get(`${n}.${t}`),i=typeof a!=typeof e,r=null!=s&&s(a);d(i||r?e:a)}),[e,s,t,n,o]),m=Object(a.useCallback)((e=>{if("function"==typeof e){const a=e;d((e=>{const i=a(e);return o.set(`${n}.${t}`,i),i}))}else o.set(`${n}.${t}`,e),d(e)}),[t,n,o]);return Object(a.useEffect)((()=>{l||(p(),u(!0))}),[l,p]),[c,m,u]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.exitFullScreenButton",{defaultMessage:"Exit full screen"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(45);const i=e=>e.replace(/:/g,"-"),r=e=>e.replace(/-/g,":"),s=e=>Object(a.isUndefined)(e)?void 0:Object(a.castArray)(e)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(45),i=n(2),r=n.n(i),s=n(153),o=n(753);const l=r.a.memo((({dataProvider:e})=>{var t;const[n,l]=Object(i.useState)(!1);return r.a.createElement(o.a,{deleteProvider:a.noop,field:e.queryMatch.displayField||e.queryMatch.field,kqlQuery:e.kqlQuery,isEnabled:e.enabled,isExcluded:e.excluded,providerId:e.id,isPopoverOpen:n,setIsPopoverOpen:l,toggleExcludedProvider:a.noop,toggleEnabledProvider:a.noop,toggleTypeProvider:a.noop,displayValue:String(null!==(t=e.queryMatch.displayValue)&&void 0!==t?t:e.queryMatch.value),val:e.queryMatch.value,operator:e.queryMatch.operator||s.d,type:e.type||s.a.default})}));l.displayName="Provider"},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i}));const a=["50%","50%"],i=["30%","70%"]},function(e,t,n){"use strict";let a,i;n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r.c})),n(227),function(e){e.success="success",e.failure="failure",e.warning="warning",e.unsupported="unsupported"}(a||(a={})),function(e){e.kpiHosts="hostsKpiHosts",e.kpiUniqueIps="hostsKpiUniqueIps"}(i||(i={}));var r=n(150)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return a.LastEventIndexKey})),n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(58);let i,r;!function(e){e.all="eventsAll",e.details="eventsDetails",e.kpi="eventsKpi",e.lastEventTime="eventsLastEventTime"}(i||(i={})),function(e){e.uniDirectional="uniDirectional",e.biDirectional="biDirectional"}(r||(r={}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return b})),n.d(t,"a",(function(){return y}));var a=n(2),i=n.n(a),r=n(17),s=n(44),o=n.n(s),l=n(110),u=n(205),c=n(867),d=n(5);const p=d.i18n.translate("xpack.securitySolution.noPermissionsTitle",{defaultMessage:"Privileges required"}),m=d.i18n.translate("xpack.securitySolution.noPrivilegesDefaultMessage",{defaultMessage:"To view this page, you must update privileges. For more information, contact your Kibana administrator."}),f=d.i18n.translate("xpack.securitySolution.goToDocumentationButton",{defaultMessage:"View documentation"}),g=o()(r.EuiFlexItem).withConfig({displayName:"SizedEuiFlexItem",componentId:"sc-156zz3c-0"})(["min-height:460px;font-size:1.1rem;"]),b=i.a.memo((({pageName:e,docLinkSelector:t})=>i.a.createElement(u.a,null,i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(g,null,i.a.createElement(r.EuiPageTemplate.EmptyPrompt,null,i.a.createElement(y,{pageName:e,docLinkSelector:t})))))));b.displayName="NoPrivilegePage";const y=i.a.memo((({pageName:e,docLinkSelector:t})=>{const{docLinks:n}=Object(l.i)().services,r=Object(a.useMemo)((()=>({feature:{icon:"documents",label:f,url:t(n.links),target:"_blank"}})),[t,n.links]),s=e?(e=>d.i18n.translate("xpack.securitySolution.noPrivilegesPerPageMessage",{values:{pageName:e},defaultMessage:"To view {pageName}, you must update privileges. For more information, contact your Kibana administrator."}))(e):m;return i.a.createElement(c.a,{actions:r,message:s,"data-test-subj":"noPrivilegesPage",title:p})}));y.displayName="NoPrivileges"},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return o}));var a=n(9),i=n(420);function r(e,t){var n,a,i;return null!==(n=null===(a=e.packagePrivileges)||void 0===a||null===(i=a.endpoint)||void 0===i?void 0:i.actions[t].executePackageAction)&&void 0!==n&&n}function s(e,t){var n,a;return null!==(n=null===(a=e.endpointExceptionsPrivileges)||void 0===a?void 0:a.actions[t])&&void 0!==n&&n}const o=(e,t,n=[])=>{var o;const l=e.isPlatinumPlus(),u=e.isEnterprise(),c=n.includes("superuser"),d=r(t,"writeSecuritySolution"),p=r(t,"readSecuritySolution"),m=r(t,"writeEndpointList"),f=r(t,"readEndpointList"),g=r(t,"writePolicyManagement"),b=r(t,"readPolicyManagement"),y=r(t,"writeActionsLogManagement"),v=r(t,"readActionsLogManagement"),h=r(t,"writeHostIsolation"),E=r(t,"writeHostIsolationRelease"),x=r(t,"writeProcessOperations"),j=r(t,"writeTrustedApplications"),O=r(t,"readTrustedApplications"),S=r(t,"writeHostIsolationExceptions"),k=r(t,"readHostIsolationExceptions"),w=r(t,"accessHostIsolationExceptions"),T=r(t,"deleteHostIsolationExceptions"),I=r(t,"writeBlocklist"),C=r(t,"readBlocklist"),M=r(t,"writeEventFilters"),_=r(t,"readEventFilters"),A=r(t,"writeFileOperations"),P=r(t,"writeExecuteOperations"),F=s(t,"showEndpointExceptions"),D=s(t,"crudEndpointExceptions"),N={canWriteSecuritySolution:d,canReadSecuritySolution:p,canAccessFleet:null!==(o=null==t?void 0:t.fleet.all)&&void 0!==o&&o,canAccessEndpointManagement:c,canCreateArtifactsByPolicy:l,canWriteEndpointList:m,canReadEndpointList:f,canWritePolicyManagement:g,canReadPolicyManagement:b,canWriteActionsLogManagement:y,canReadActionsLogManagement:v&&u,canAccessEndpointActionsLogManagement:v&&l,canIsolateHost:h&&l,canUnIsolateHost:E,canKillProcess:x&&u,canSuspendProcess:x&&u,canGetRunningProcesses:x&&u,canAccessResponseConsole:!1,canWriteExecuteOperations:P&&u,canWriteFileOperations:A&&u,canWriteTrustedApplications:j,canReadTrustedApplications:O,canWriteHostIsolationExceptions:S&&l,canAccessHostIsolationExceptions:w&&l,canReadHostIsolationExceptions:k,canDeleteHostIsolationExceptions:T,canWriteBlocklist:I,canReadBlocklist:C,canWriteEventFilters:M,canReadEventFilters:_,canReadEndpointExceptions:F,canWriteEndpointExceptions:D};return N.canAccessResponseConsole=u&&Object.values(Object(a.omit)(i.g,"release")).some((e=>N[e])),N},l=()=>({canWriteSecuritySolution:!1,canReadSecuritySolution:!1,canAccessFleet:!1,canAccessEndpointActionsLogManagement:!1,canAccessEndpointManagement:!1,canCreateArtifactsByPolicy:!1,canWriteEndpointList:!1,canReadEndpointList:!1,canWritePolicyManagement:!1,canReadPolicyManagement:!1,canWriteActionsLogManagement:!1,canReadActionsLogManagement:!1,canIsolateHost:!1,canUnIsolateHost:!1,canKillProcess:!1,canSuspendProcess:!1,canGetRunningProcesses:!1,canAccessResponseConsole:!1,canWriteFileOperations:!1,canWriteExecuteOperations:!1,canWriteTrustedApplications:!1,canReadTrustedApplications:!1,canWriteHostIsolationExceptions:!1,canAccessHostIsolationExceptions:!1,canReadHostIsolationExceptions:!1,canDeleteHostIsolationExceptions:!1,canWriteBlocklist:!1,canReadBlocklist:!1,canWriteEventFilters:!1,canReadEventFilters:!1,canReadEndpointExceptions:!1,canWriteEndpointExceptions:!1})},,,function(e,t,n){"use strict";n.r(t),n.d(t,"sourcererKibanaDataViewsSelector",(function(){return i})),n.d(t,"sourcererSignalIndexNameSelector",(function(){return r})),n.d(t,"sourcererDefaultDataViewSelector",(function(){return s})),n.d(t,"dataViewSelector",(function(){return o})),n.d(t,"sourcererScopeIdSelector",(function(){return l})),n.d(t,"scopeIdSelector",(function(){return u})),n.d(t,"kibanaDataViewsSelector",(function(){return c})),n.d(t,"signalIndexNameSelector",(function(){return d})),n.d(t,"defaultDataViewSelector",(function(){return p})),n.d(t,"sourcererDataViewSelector",(function(){return m})),n.d(t,"getSourcererDataViewsSelector",(function(){return f})),n.d(t,"getSourcererScopeSelector",(function(){return g})),n.d(t,"getSelectedDataviewSelector",(function(){return b}));var a=n(57);const i=({sourcerer:e})=>e.kibanaDataViews,r=({sourcerer:e})=>e.signalIndexName,s=({sourcerer:e})=>e.defaultDataView,o=({sourcerer:e},t)=>e.kibanaDataViews.find((e=>e.id===t)),l=({sourcerer:e},t)=>e.sourcererScopes[t],u=()=>Object(a.createSelector)(l,(e=>e)),c=()=>Object(a.createSelector)(i,(e=>e)),d=()=>Object(a.createSelector)(r,(e=>e)),p=()=>Object(a.createSelector)(s,(e=>e)),m=()=>Object(a.createSelector)(o,(e=>e)),f=()=>{const e=c(),t=p(),n=d();return a=>{const i=e(a);return{defaultDataView:t(a),kibanaDataViews:i,signalIndexName:n(a)}}},g=()=>{const e=f(),t=m(),n=u();return(a,i)=>{const r=e(a),s=n(a,i);return{...r,selectedDataView:t(a,s.selectedDataViewId),sourcererScope:s}}},b=()=>{const e=m(),t=u();return(n,a)=>{const i=t(n,a),r=e(n,i.selectedDataViewId);return null==r?void 0:r.dataView}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a=e=>"relative"===e.kind,i=e=>"absolute"===e.kind},function(e,t,n){"use strict";n.r(t),n.d(t,"inputsSelector",(function(){return c})),n.d(t,"timelineTimeRangeSelector",(function(){return d})),n.d(t,"socTrendsTimeRangeSelector",(function(){return p})),n.d(t,"globalFullScreenSelector",(function(){return m})),n.d(t,"timelineFullScreenSelector",(function(){return f})),n.d(t,"globalTimeRangeSelector",(function(){return g})),n.d(t,"globalQuery",(function(){return b})),n.d(t,"globalQueryByIdSelector",(function(){return y})),n.d(t,"timelineQueryByIdSelector",(function(){return v})),n.d(t,"globalSelector",(function(){return h})),n.d(t,"globalQuerySelector",(function(){return x})),n.d(t,"globalSavedQuerySelector",(function(){return j})),n.d(t,"globalFiltersQuerySelector",(function(){return S})),n.d(t,"getTimelineSelector",(function(){return k})),n.d(t,"getTimelinePolicySelector",(function(){return w}));var a=n(57);const i={id:"kql",inspect:null,isInspected:!1,loading:!1,refetch:null,selectedInspectIndex:0},r=e=>e.inputs,s=e=>e.inputs.global,o=e=>e.inputs.timeline,l=(e,t)=>e.inputs.global.queries.find((e=>e.id===t))||i,u=(e,t)=>e.inputs.timeline.queries.find((e=>e.id===t))||e.inputs.global.queries.find((e=>e.id===t))||i,c=()=>Object(a.createSelector)(r,(e=>e)),d=Object(a.createSelector)(o,(e=>e.timerange)),p=Object(a.createSelector)((e=>e.inputs.socTrends),(e=>null==e?void 0:e.timerange)),m=Object(a.createSelector)(s,(e=>e.fullScreen)),f=Object(a.createSelector)(o,(e=>e.fullScreen)),g=Object(a.createSelector)(s,(e=>e.timerange)),b=()=>Object(a.createSelector)(s,(e=>e.queries)),y=()=>Object(a.createSelector)(l,(e=>e)),v=()=>Object(a.createSelector)(u,(e=>e)),h=()=>Object(a.createSelector)(s,(e=>e)),E={query:"",language:"kuery"},x=()=>Object(a.createSelector)(s,(e=>e.query||E)),j=()=>Object(a.createSelector)(s,(e=>e.savedQuery||null)),O=[],S=()=>Object(a.createSelector)(s,(e=>e.filters||O)),k=()=>Object(a.createSelector)(o,(e=>e)),w=()=>Object(a.createSelector)(o,(e=>e.policy))},function(e,t,n){"use strict";n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"e",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return b}));var a=n(45),i=n(634),r=n(119);const s=(e,t,n)=>({...n,global:{...n.global,fullScreen:e===r.a.global?t:n.global.fullScreen},timeline:{...n.timeline,fullScreen:e===r.a.timeline?t:n.timeline.fullScreen}}),o=(e,t,n)=>t!==r.a.global&&t!==r.a.timeline||n!==r.a.socTrends?t!==r.a.socTrends||n!==r.a.global&&n!==r.a.timeline?e:Object(i.a)(e):Object(i.b)(e),l=(e,t,n)=>{const i=Object(a.get)(e,n);return null!=i?{...[e,...i.linkTo].reduce(((i,r)=>({...i,[r]:{...Object(a.get)(r,n),timerange:o(t,e,r)}})),e===r.a.timeline?{...n,global:{...n.global,linkTo:[]}}:n)}:n},u=e=>e.global.linkTo.indexOf(r.a.timeline)>-1?f([r.a.global,r.a.timeline],e):m([r.a.global,r.a.timeline],e),c=e=>e.global.linkTo.indexOf(r.a.socTrends)>-1?f([r.a.global,r.a.socTrends],e):m([r.a.global,r.a.socTrends],e),d=({inputId:e,id:t,inspect:n,loading:i,refetch:r,state:s,searchSessionId:o})=>{const l=s[e].queries.findIndex((e=>e.id===t));return{...s,[e]:{...Object(a.get)(e,s),queries:l>-1?[...s[e].queries.slice(0,l),{id:t,inspect:n,isInspected:s[e].queries[l].isInspected,loading:i,refetch:r,searchSessionId:s[e].queries[l].searchSessionId,selectedInspectIndex:s[e].queries[l].selectedInspectIndex},...s[e].queries.slice(l+1)]:[...s[e].queries,{id:t,inspect:n,isInspected:!1,loading:i,refetch:r,selectedInspectIndex:0,searchSessionId:o}]}}},p=({id:e,inputId:t,isInspected:n,selectedInspectIndex:i,state:r,searchSessionId:s})=>{const o=r[t].queries.findIndex((t=>t.id===e)),l=o>-1?r[t].queries[o]:null;return{...r,[t]:{...Object(a.get)(t,r),queries:o>-1?[...r[t].queries.slice(0,o),{...l,isInspected:n,selectedInspectIndex:i,searchSessionId:s},...r[t].queries.slice(o+1)]:[...r[t].queries]}}},m=(e,t)=>{if(2!==e.length)throw new Error("Only link 2 input states at a time");if(e.includes(r.a.socTrends)&&e.includes(r.a.timeline))throw new Error("Do not link socTrends to timeline. Only link socTrends to global");if(1===Array.from(new Set(e)).length)throw new Error("Input linkTo cannot link to itself");if(e.includes(r.a.timeline)&&e.includes(r.a.global)){const e=t.timeline.linkTo.includes(r.a.socTrends)||t.global.linkTo.includes(r.a.socTrends)?[r.a.socTrends]:[];return{...t,timeline:{...t.timeline,linkTo:[...e,r.a.global]},global:{...t.global,linkTo:[...e,r.a.timeline]},...t.socTrends&&e.length?{socTrends:{...t.socTrends,linkTo:[r.a.global,r.a.timeline]}}:{}}}if(e.includes(r.a.socTrends)&&e.includes(r.a.global)){const e=t.global.linkTo.includes(r.a.timeline)?[r.a.timeline]:[];return{...t,...t.socTrends?{socTrends:{...t.socTrends,linkTo:[...e,r.a.global]}}:{},global:{...t.global,linkTo:[...e,r.a.socTrends]},...e.length?{timeline:{...t.timeline,linkTo:[r.a.global,r.a.socTrends]}}:{}}}return t},f=(e,t)=>{if(2!==e.length)throw new Error("Only remove linkTo from 2 input states at a time");if(e.includes(r.a.socTrends)&&e.includes(r.a.timeline))throw new Error("Do not remove link socTrends to timeline. Only remove link socTrends to global");if(1===Array.from(new Set(e)).length)throw new Error("Input linkTo cannot remove link to itself");if(e.includes(r.a.timeline)&&e.includes(r.a.global)){const e=t.timeline.linkTo.includes(r.a.socTrends)||t.global.linkTo.includes(r.a.socTrends)?[r.a.socTrends]:[];return{...t,timeline:{...t.timeline,linkTo:[]},global:{...t.global,linkTo:e},...t.socTrends&&e.length?{socTrends:{...t.socTrends,linkTo:[r.a.global]}}:{}}}if(e.includes(r.a.socTrends)&&e.includes(r.a.global)){const e=t.global.linkTo.includes(r.a.timeline)?[r.a.timeline]:[];return{...t,...t.socTrends?{socTrends:{...t.socTrends,linkTo:[]}}:{},global:{...t.global,linkTo:e},...e.length?{timeline:{...t.timeline,linkTo:[r.a.global]}}:{}}}return t},g=({inputId:e,id:t,state:n})=>{const i=n[e].queries.findIndex((e=>e.id===t));return{...n,[e]:{...Object(a.get)(e,n),queries:i>-1?[...n[e].queries.slice(0,i),...n[e].queries.slice(i+1)]:[...n[e].queries]}}},b=e=>"queries"in e},function(e,t,n){"use strict";var a=n(167);n.d(t,"a",(function(){return a.c}));var i=n(195);n.d(t,"b",(function(){return i.c}));var r=n(138);n.d(t,"c",(function(){return r.d}));var s=n(149);n.d(t,"d",(function(){return s.d}))},function(e,t,n){"use strict";let a,i;n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i})),function(e){e.host="host",e.user="user"}(a||(a={})),function(e){e.NOT_INSTALLED="NOT_INSTALLED",e.DISABLED="DISABLED",e.ENABLED="ENABLED"}(i||(i={}))},function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.userName="user.name",e.hostName="host.name"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return d}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.timelines.pageTitle",{defaultMessage:"Timelines"}),r=a.i18n.translate("xpack.securitySolution.timelines.allTimelines.panelTitle",{defaultMessage:"All timelines"}),s=a.i18n.translate("xpack.securitySolution.timelines.allTimelines.importTimelineTitle",{defaultMessage:"Import"}),o=a.i18n.translate("xpack.securitySolution.timelines.allTimelines.errorFetchingTimelinesTitle",{defaultMessage:"Failed to query all timelines data"}),l=a.i18n.translate("xpack.securitySolution.timelines.updateTimelineErrorTitle",{defaultMessage:"Timeline error"}),u=a.i18n.translate("xpack.securitySolution.timelines.updateTimelineErrorText",{defaultMessage:"Something went wrong"}),c=a.i18n.translate("xpack.securitySolution.timelines.timelineVersionConflictTitle",{defaultMessage:"Version conflict"}),d=a.i18n.translate("xpack.securitySolution.timelines.timelineVersionConflictDescription",{defaultMessage:"Another user has made changes to this timeline. You need to refresh the page to make changes to this timeline."})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(45),i=n(56),r=n.n(i);const s=e=>{if(Object(a.isString)(e)&&""!==e.trim()){const t=r()(new Date(e));return t.isValid()||isNaN(+e)?t:r()(new Date(+e))}return r()(new Date(e))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"a",(function(){return f}));var a=n(45),i=n(124),r=n(357),s=n(4);n(110);const o="securityDataTable",l="timelines",u={},c=e=>e?Object.keys(e).reduce(((t,n)=>{const a=e[n];return{...t,[n]:{defaultColumns:a.defaultColumns,dataViewId:a.dataViewId,excludedRowRendererIds:a.excludedRowRendererIds,filters:a.filters,indexNames:a.indexNames,loadingEventIds:a.loadingEventIds,isSelectAllChecked:a.isSelectAllChecked,itemsPerPage:a.itemsPerPage,itemsPerPageOptions:a.itemsPerPageOptions,showCheckboxes:a.showCheckboxes,graphEventId:a.graphEventId,sessionViewConfig:a.sessionViewConfig,selectAll:a.selectAll,id:a.id,title:a.title,initialized:a.initialized,updated:a.updated,sort:a.sort,selectedEventIds:a.selectedEventIds,deletedEventIds:a.deletedEventIds,expandedDetail:a.expandedDetail,totalCount:a.totalCount||0,viewMode:s.Mc.gridView,additionalFilters:{showBuildingBlockAlerts:!1,showOnlyThreatIndicatorAlerts:!1},...Array.isArray(a.columns)?{columns:a.columns.map(d).map(p)}:{}}}}),{}):u,d=e=>({...e,...Number.isInteger(e.width)&&!Number.isInteger(e.initialWidth)?{initialWidth:e.width}:e.initialWidth?{initialWidth:e.initialWidth}:{}}),p=e=>({...e,...Object(a.isEmpty)(e.label)||null!=e.displayAsText?e.displayAsText?{displayAsText:e.displayAsText}:{}:{displayAsText:e.label}}),m=(e,t)=>{let n=e.get(o);const a=e.get(l);if(!n){if(!a)return u;n=c(a)}return((e,t)=>{const n={[i.e.alertsOnAlertsPage]:`detection-engine-alert-table-${s.e.ALERTS_PAGE}-gridView`,[i.e.alertsOnRuleDetailsPage]:`detection-engine-alert-table-${s.e.RULE_DETAILS}-gridView`};Object.keys(t).filter((t=>t in n&&!e.get(n[t]))).map((e=>({[n[e]]:{columns:t[e].columns,sort:t[e].sort.map((e=>({[e.columnId]:{order:e.sortDirection}}))),visibleColumns:t[e].columns}}))).forEach((t=>Object.keys(t).forEach((n=>{e.set(n,t[n])}))))})(e,n),(e=>{[`detection-engine-alert-table-${s.e.ALERTS_PAGE}-gridView`,`detection-engine-alert-table-${s.e.RULE_DETAILS}-gridView`].forEach((t=>{const n=e.get(t);if(n&&"visibleColumns"in n){const a=n.visibleColumns;if(a.every((e=>"string"==typeof e)))return;const i=a.map((e=>"string"==typeof e?e:e.id)).filter(Boolean);e.set(t,{...n,visibleColumns:i})}}))})(e),((e,t)=>{let n=!1;for(const[e,a]of Object.entries(t)){if(i.r[e]!==i.d.alert)continue;const t=a.columns;Array.isArray(t)&&(-1!==t.findIndex((e=>e.id===r.a.id))||(n=!0,a.columns.push(r.a)));const s=a.defaultColumns;s&&(-1!==s.findIndex((e=>e.id===r.a.id))||(n=!0,a.defaultColumns.push(r.a)))}n&&(e.set(o,t),(e=>{[`detection-engine-alert-table-${s.e.ALERTS_PAGE}-gridView`,`detection-engine-alert-table-${s.e.RULE_DETAILS}-gridView`].forEach((t=>{const n=e.get(t);if(n&&"columns"in n){let a=!1;-1!==n.columns.findIndex((e=>e.id===r.a.id))||(n.columns.splice(1,0,r.a),a=!0),"visibleColumns"in n&&(-1!==n.visibleColumns.findIndex((e=>e===r.a.id))||(n.visibleColumns.splice(1,0,r.a.id),a=!0)),a&&e.set(t,n)}}))})(e))})(e,n),t.reduce(((e,t)=>{const a=n[t];return a?{...e,[t]:{...a,...null==a.sort||Array.isArray(a.sort)?{}:{sort:[a.sort]}}}:{...e}}),{})},f=(e,t,n)=>{const a=g(n),i=(e=>{let t=e.get(o);const n=e.get(l);if(!t){if(!n)return u;t=c(n)}return t})(e);e.set(o,{...i,[t]:a})},g=e=>{const{isLoading:t,loadingText:n,queryFields:a,unit:i,...r}=e;return r}},function(e,t,n){var a=n(996),i=n(997);e.exports=function(e,t,n){return a(i,e,t,n)}},function(e,t,n){e.exports=n(24)(3829)},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g}));var a=n(17),i=n(56),r=n.n(i),s=n(2),o=n.n(s),l=n(44),u=n.n(l),c=n(51),d=n(459),p=n(214);d.f;const m=u.a.h3.withConfig({displayName:"TitleText",componentId:"sc-7x1zh4-0"})(["margin:0 5px;cursor:default;user-select:none;"]);m.displayName="TitleText",o.a.memo((({noteIds:e})=>o.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiIcon,{color:"text",size:"l",type:"editorComment"})),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(a.EuiTitle,{size:"s"},o.a.createElement(m,null,d.e))),o.a.createElement(a.EuiFlexItem,{grow:!1},o.a.createElement(p.c,{color:"hollow"},e.length))))).displayName="NotesCount";const f=({newNote:e,user:t})=>({created:r.a.utc().toDate(),id:Object(c.v4)(),lastEdit:null,note:e,saveObjectId:null,user:t,version:null}),g=({associateNote:e,newNote:t,updateNewNote:n,updateNote:a,user:i})=>{const r=f({newNote:t,user:i});a(r),e(r.id),n("")}},function(e,t,n){const a=n(304);e.exports=(e,t)=>{const n=a(e,t);return n?n.version:null}},function(e,t,n){"use strict";n.d(t,"g",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return c}));var a=n(5);const i=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinTooltip",{values:{isAlert:e},defaultMessage:"Pin {isAlert, select, true{alert} other{event}}"}),r=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.unpinTooltip",{values:{isAlert:e},defaultMessage:"Unpin {isAlert, select, true{alert} other{event}}"}),s=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.pinnnedWithNotesTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} cannot be unpinned because it has notes"}),o=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedAscendingTooltip",{defaultMessage:"Sorted ascending"}),l=a.i18n.translate("xpack.securitySolution.timeline.body.sort.sortedDescendingTooltip",{defaultMessage:"Sorted descending"}),u=e=>a.i18n.translate("xpack.securitySolution.timeline.body.pinning.disablePinnnedTooltip",{values:{isAlert:e},defaultMessage:"This {isAlert, select, true{alert} other{event}} may not be pinned while editing a template timeline"}),c=({ariaRowindex:e,columnValues:t})=>a.i18n.translate("xpack.securitySolution.timeline.body.actions.attachAlertToCaseForRowAriaLabel",{values:{ariaRowindex:e,columnValues:t},defaultMessage:"Attach the alert or event in row {ariaRowindex} to a case, with columns {columnValues}"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var a=n(17),i=n(2),r=n.n(i),s=n(562);const o="exit-full-screen",l=({fullScreen:e,setFullScreen:t})=>{const n=Object(i.useCallback)((()=>{t(!1)}),[t]),l=Object(i.useCallback)((e=>{"Escape"===e.key&&(e.preventDefault(),n())}),[n]);return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiWindowEvent,{event:"keydown",handler:l}),r.a.createElement(a.EuiButton,{className:o,"data-test-subj":"exit-full-screen",fullWidth:!1,iconType:"fullScreen",fill:!0,isDisabled:!e,onClick:n},s.a)):null};l.displayName="ExitFullScreenComponent";const u=r.a.memo(l)},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.eventsViewer.showingLabel",{defaultMessage:"Showing"}),r=(a.i18n.translate("xpack.securitySolution.eventsViewer.eventsLabel",{defaultMessage:"Events"}),e=>a.i18n.translate("xpack.securitySolution.eventsViewer.unit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"})),s=a.i18n.translate("xpack.securitySolution.eventsViewer.actionsColumnLabel",{defaultMessage:"Actions"});a.i18n.translate("xpack.securitySolution.eventsViewer.timelineEvents.errorSearchDescription",{defaultMessage:"An error has occurred on timeline events search"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(236);const u=o.a.div.withConfig({displayName:"PlaceHolder",componentId:"sc-pcodem-0"})(["padding:",";"],(e=>e.theme.eui.euiSizeS)),c=({count:e,onClick:t})=>{const n=Object(i.useCallback)((()=>t&&t()),[t]);return e?t?r.a.createElement(a.EuiLink,{onClick:n},r.a.createElement("b",null,r.a.createElement(l.a,{count:e}))):r.a.createElement("b",null,r.a.createElement(l.a,{count:e})):r.a.createElement(u,null)};c.displayName="ChartLabelComponent";const d=r.a.memo(c)},function(e,t,n){"use strict";n.d(t,"b",(function(){return v})),n.d(t,"a",(function(){return h}));var a=n(17),i=n(2),r=n.n(i),s=n(62),o=n(9),l=n(44),u=n.n(l),c=n(5),d=n(265),p=n(351),m=n(597);const f={chartMargins:{top:0,bottom:0,left:0,right:0},partition:{idealFontSizeJump:1.1,outerSizeRatio:1,emptySizeRatio:.8,circlePadding:4}},g=u()(a.EuiFlexGroup).withConfig({displayName:"DonutTextWrapper",componentId:"sc-g5h38u-0"})(["top:",";width:100%;max-width:77px;position:absolute;z-index:1;",""],(({$isChartEmbeddablesEnabled:e,$dataExists:t})=>e&&!t?"66%":"34%;"),(({className:e,$donutTextWrapperStyles:t})=>e&&t?`&.${e} {${t}}`:"")),b=u()(a.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItem",componentId:"sc-g5h38u-1"})(["position:relative;align-items:center;"]),y=({children:e,dataExists:t,donutTextWrapperClassName:n,donutTextWrapperStyles:s,isChartEmbeddablesEnabled:o,label:l,title:u})=>{const{euiTheme:c}=Object(a.useEuiTheme)(),d=Object(i.useMemo)((()=>({color:c.colors.disabled})),[c.colors.disabled]),p=o?void 0:"eui-textTruncate";return r.a.createElement(a.EuiFlexGroup,{alignItems:"center",justifyContent:"center",responsive:!1,gutterSize:"l","data-test-subj":"donut-chart"},r.a.createElement(b,{grow:o},r.a.createElement(g,{$dataExists:t,$donutTextWrapperStyles:s,$isChartEmbeddablesEnabled:o,alignItems:"center",className:n,direction:"column",gutterSize:"none",justifyContent:"center"},r.a.createElement(a.EuiFlexItem,null,u),l&&r.a.createElement(a.EuiFlexItem,{className:p},r.a.createElement(a.EuiToolTip,{content:l},r.a.createElement(a.EuiText,{className:p,size:"s",style:t?void 0:d},l)))),e))},v=r.a.memo(y),h=({data:e,fillColor:t,height:n=90,label:l,legendItems:u,onPartitionClick:g,title:b,totalCount:y})=>{const{baseTheme:h,theme:E}=Object(d.i)(),x=Object(i.useCallback)((e=>{if(g){var t;const n=e.flat(2),a=n.length>0&&"groupByRollup"in n[0]&&null!=(null===(t=n[0])||void 0===t?void 0:t.groupByRollup)?`${n[0].groupByRollup}`:"";Object(o.isEmpty)(a.trim())||g(a.toLowerCase())}}),[g]);return r.a.createElement(v,{dataExists:null!=e&&e.length>0,label:l,title:b,isChartEmbeddablesEnabled:!1},r.a.createElement(r.a.Fragment,null,null==e||null==y||0===y?r.a.createElement(m.a,{size:n}):r.a.createElement(s.Chart,{size:n},r.a.createElement(s.Settings,{theme:[f,E],baseTheme:h,onElementClick:x,locale:c.i18n.getLocale()}),r.a.createElement(s.Partition,{id:"donut-chart",data:e,layout:s.PartitionLayout.sunburst,valueAccessor:e=>e.value,valueFormatter:e=>`${Object(s.defaultPartitionValueFormatter)(e)}`,layers:[{groupByRollup:e=>{var t;return null!==(t=e.label)&&void 0!==t?t:e.key},nodeLabel:e=>e,shape:{fillColor:t}}]})),u&&(null==u?void 0:u.length)>0&&r.a.createElement(a.EuiFlexItem,null,r.a.createElement(p.a,{legendItems:u,height:n}))))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17);const l="#FAFBFD",u=s.a.div.withConfig({displayName:"BigRing",componentId:"sc-1m6sj8k-0"})(["border-radius:50%;",""],(({size:e})=>`height: ${e}px;\n    width: ${e}px;\n    background-color: ${l};\n    text-align: center;\n    line-height: ${e}px;`)),c=s.a.div.withConfig({displayName:"SmallRing",componentId:"sc-1m6sj8k-1"})(["border-radius:50%;",""],(({size:e})=>`\n    height: ${e}px;\n    width: ${e}px;\n    background-color: ${Object(o.useEuiBackgroundColor)("plain")};\n    display: inline-block;\n    vertical-align: middle;`)),d=({size:e=90,donutWidth:t=20})=>e-t>0?i.a.createElement(u,{size:e,"data-test-subj":"empty-donut"},i.a.createElement(c,{size:e-t,"data-test-subj":"empty-donut-small"})):null,p=i.a.memo(d)},function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n(23),i=n.n(a),r=n(17),s=n(2),o=n.n(s),l=n(5),u=n(62),c=n(45),d=n(324),p=n.n(d),m=n(51),f=n(44),g=n.n(f),b=n(136),y=n.n(b),v=n(174),h=n(110),E=n(383),x=n(283),j=n(226),O=n(293),S=n(724),k=n(265),w=n(351),T=n(339),I=n(276),C=n(190);const M=g()(r.EuiFlexItem).withConfig({displayName:"LegendFlexItem",componentId:"sc-1257qcd-0"})(["overview:hidden;"]),_=e=>null!=e&&!!Object(c.get)("value.length",e)&&(e.value||[]).every((({x:e,y:t})=>Object(c.isNumber)(t)&&t>=0)),A=["y"],P=[e=>Object(j.a)(e.g)?e.g:O.c],F=({data:e,forceHiddenLegend:t=!1,yAxisTitle:n,...a})=>{const r=Object(k.i)(),d=Object(h.l)(),m=Object(c.get)("configs.axis.xTickFormatter",a),f=Object(c.get)("configs.axis.yTickFormatter",a),g=Object(c.getOr)(0,"configs.axis.tickSize",a),b=`stat-items-barchart-${e[0].key}-x`,y=`stat-items-barchart-${e[0].key}-y`,v={...k.e,...p()(Object(c.get)("configs.settings",a),r)},E=Object(s.useMemo)((()=>p()({tickLine:{size:g}},Object(c.getOr)({},"configs.axis.bottom.style",a))),[a,g]),x=Object(s.useMemo)((()=>p()({tickLine:{size:g}},Object(c.getOr)({},"configs.axis.left.style",a))),[a,g]),j=Object(c.get)("configs.axis.bottom.labelFormat",a);return a.width&&a.height?o.a.createElement(u.Chart,null,o.a.createElement(u.Settings,i()({},v,{showLegend:v.showLegend&&!t,locale:l.i18n.getLocale()})),e.map((e=>{var t;const n=e.key;return _(e)?o.a.createElement(u.BarSeries,{id:n,key:n,name:e.key,xScaleType:Object(c.getOr)(u.ScaleType.Linear,"configs.series.xScaleType",a),yScaleType:Object(c.getOr)(u.ScaleType.Linear,"configs.series.yScaleType",a),xAccessor:"x",yAccessors:A,timeZone:d,splitSeriesAccessors:P,data:null!==(t=e.value)&&void 0!==t?t:[],stackAccessors:Object(c.get)("configs.series.stackAccessors",a),color:e.color?e.color:void 0,barSeriesStyle:Object(c.get)("configs.series.barSeriesStyle",a)}):null})),o.a.createElement(u.Axis,{id:b,position:u.Position.Bottom,showOverlappingTicks:!1,style:E,tickFormat:m,labelFormat:j}),o.a.createElement(u.Axis,{id:y,position:u.Position.Left,style:x,tickFormat:f,title:n})):null};F.displayName="BarChartBaseComponent";const D=o.a.memo(F);D.displayName="BarChartBase";const N=[],R=({barChart:e,configs:t,stackByField:n,scopeId:a,visualizationActionsOptions:l})=>{const{ref:u,width:d,height:p}=Object(x.b)(),f=Object(s.useMemo)((()=>null!=e&&null!=n?e.map(((e,t)=>{var i;return{color:null!==(i=e.color)&&void 0!==i?i:t<E.a.length?E.a[t]:void 0,dataProviderId:Object(v.i)(`draggable-legend-item-${Object(m.v4)()}-${n}-${e.key}`),scopeId:a,field:n,value:e.key}})):N),[e,n,a]),g=Object(c.get)("yAxisTitle",t),b=Object(c.get)("customHeight",t),y=Object(c.get)("customWidth",t),h=Object(k.g)(b,p),j=Object(k.h)(y,d),O=Object(s.useMemo)((()=>{return t=e,Array.isArray(t)&&!Object(k.f)(t)&&t.some(_);var t}),[e]);return o.a.createElement(k.d,null,o.a.createElement(I.a,{targetClassNames:[C.a]},O&&e&&o.a.createElement(k.a,{gutterSize:"none"},o.a.createElement(r.EuiFlexItem,{grow:!0},o.a.createElement(k.c,{ref:u,height:h},o.a.createElement(D,{configs:t,data:e,yAxisTitle:g,forceHiddenLegend:null!=n,height:h,width:h}))),o.a.createElement(M,{grow:!1},o.a.createElement(w.a,{legendItems:f,height:p}))),!O&&o.a.createElement(S.a,{height:h,width:j,data:e}),null!=l&&o.a.createElement(T.a,i()({},l,{className:"viz-actions"}))))},L=o.a.memo(R,((e,t)=>e.stackByField===t.stackByField&&e.scopeId===t.scopeId&&y()(e.configs,t.configs)&&y()(e.barChart,t.barChart)))},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return c}));var a=n(2),i=n.n(a),r=n(901),s=n(491),o=n(394);const l=Object(a.createContext)(void 0),u=Object(a.memo)((({id:e,indexName:t,scopeId:n,ruleId:u,children:c})=>{const{dataAsNestedObject:d,indexPattern:p,loading:m}=Object(r.a)({eventId:e,indexName:t}),f=Object(a.useMemo)((()=>e&&t&&n&&d?{eventId:e,indexName:t,scopeId:n,ruleId:null!=u?u:"",indexPattern:p,dataAsNestedObject:d}:void 0),[e,t,n,u,p,d]);return m?i.a.createElement(o.a,null):f?i.a.createElement(l.Provider,{value:f},c):i.a.createElement(s.a,null)}));u.displayName="PreviewPanelProvider";const c=()=>{const e=Object(a.useContext)(l);if(!e)throw new Error("PreviewPanelContext can only be used within PreviewPanelContext provider");return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));var a=n(4);const i=20,r=[5,10,20,50,a.pc],s="securitySolution.rulesTable"},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a.d})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r}));var a=n(150);let i;!function(e){e.authentications="authentications",e.anomalies="anomalies",e.events="events",e.alerts="alerts",e.dns="dns",e.preview="preview"}(i||(i={}));const r={[i.alerts]:"aggregations.alertsGroup.buckets",[i.anomalies]:"aggregations.anomalyActionGroup.buckets",[i.authentications]:"aggregations.eventActionGroup.buckets",[i.dns]:"aggregations.dns_name_query_count.buckets",[i.events]:"aggregations.eventActionGroup.buckets",[i.preview]:"aggregations.preview.buckets"}},function(e,t,n){"use strict";n.d(t,"d",(function(){return a.q})),n.d(t,"c",(function(){return a.n})),n.d(t,"g",(function(){return f})),n.d(t,"e",(function(){return b})),n.d(t,"a",(function(){return E})),n.d(t,"b",(function(){return x})),n.d(t,"f",(function(){return j.a}));var a=n(163),i=n(117),r=n(50),s=n(765),o=n(4),l=n(532),u=n(1060),c=n(472),d=n(483);const p=["PUT",o.jb];var m=n(557);const f=()=>{const{addError:e}=Object(i.a)();return(e=>{const t=Object(l.b)(),n=Object(c.b)(),i=Object(d.b)(),o=Object(u.c)();return Object(r.useMutation)((e=>Object(a.y)({rule:Object(s.b)(e)})),{...e,mutationKey:p,onSettled:(...a)=>{var r;t(),n(),i();const[s]=a;s&&o(s),null==e||null===(r=e.onSettled)||void 0===r||r.call(e,...a)}})})({onError:t=>{e(t,{title:m.a})}})},g=["POST",o.jb],b=()=>{const{addError:e}=Object(i.a)();return(e=>{const t=Object(l.b)(),n=Object(c.b)(),i=Object(d.b)();return Object(r.useMutation)((e=>Object(a.d)({rule:Object(s.b)(e)})),{...e,mutationKey:g,onSettled:(...a)=>{t(),n(),i(),null!=e&&e.onSettled&&e.onSettled(...a)}})})({onError:t=>{e(t,{title:m.a})}})};var y=n(111),v=n(289),h=n(191);const E=y.object({page:y.number().int().min(0),perPage:y.number().int().min(0),total:y.number().int().min(0)}),x=y.object({field:h.e,order:v.g});var j=n(1059)},function(e,t,n){"use strict";let a,i;n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"k",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return u.g})),n.d(t,"i",(function(){return c})),n.d(t,"j",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return m})),n.d(t,"f",(function(){return f})),n.d(t,"c",(function(){return l.e})),function(e){e.timestamp="@timestamp",e.hostName="host.name",e.hostRiskScore="host.risk.calculated_score_norm",e.hostRisk="host.risk.calculated_level",e.userName="user.name",e.userRiskScore="user.risk.calculated_score_norm",e.userRisk="user.risk.calculated_level",e.alertsCount="alertsCount"}(a||(a={})),function(e){e.unknown="Unknown",e.low="Low",e.moderate="Moderate",e.high="High",e.critical="Critical"}(i||(i={}));const r=e=>"user"in e,s={[i.critical]:0,[i.high]:0,[i.low]:0,[i.moderate]:0,[i.unknown]:0};var o=n(4),l=n(403),u=n(150);const c=(e,t=!0,n)=>n?Object(l.f)(e):`${o.ac}${t?"latest_":""}${e}`,d=(e,t=!0,n)=>n?t?Object(l.f)(e):Object(l.g)(e):`${o.bc}${t?"latest_":""}${e}`,p=e=>({terms:{"host.name":e}}),m=e=>({terms:{"user.name":e}}),f=(e,t)=>t===l.e.host?{terms:{"host.name":e}}:{terms:{"user.name":e}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return u})),n.d(t,"b",(function(){return c}));var a={};n.r(a),n.d(a,"selectGlobalUrlParam",(function(){return r}));var i=n(421);const r=e=>e.globalUrlParam;var s=n(136),o=n.n(s),l=n(187);const u={},c=Object(l.reducerWithInitialState)(u).case(i.registerUrlParam,((e,{key:t,initialValue:n})=>void 0!==e[t]?(console.error(`Url param key '${t}' is already being used.`),e):{...e,[t]:n})).case(i.deregisterUrlParam,((e,{key:t})=>{const n={...e};return delete n[t],n})).case(i.updateUrlParam,((e,{key:t,value:n})=>void 0===e[t]||o()(e[t],n)?e:{...e,[t]:n})).build()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(612);n(74),n(268),n(269);var i=a.default({key:"css"}),r=i.flush,s=i.hydrate,o=i.cx,l=i.merge,u=i.getRegisteredStyles,c=i.injectGlobal,d=i.keyframes,p=i.css,m=i.sheet,f=i.cache;t.cache=f,t.css=p,t.cx=o,t.flush=r,t.getRegisteredStyles=u,t.hydrate=s,t.injectGlobal=c,t.keyframes=d,t.merge=l,t.sheet=m},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(74),i=n(268),r=n(269);function s(e){return e&&e.__esModule?e:{default:e}}var o=s(a);function l(e,t){if(void 0===e.inserted[t.name])return e.insert("",t,e.sheet,!0)}function u(e,t,n){var a=[],i=r.getRegisteredStyles(e,a,n);return a.length<2?n:i+t(a)}var c=function e(t){for(var n="",a=0;a<t.length;a++){var i=t[a];if(null!=i){var r=void 0;switch(typeof i){case"boolean":break;case"object":if(Array.isArray(i))r=e(i);else for(var s in r="",i)i[s]&&s&&(r&&(r+=" "),r+=s);break;default:r=i}r&&(n&&(n+=" "),n+=r)}}return n};t.default=function(e){var t=o.default(e);t.sheet.speedy=function(e){this.isSpeedy=e},t.compat=!0;var n=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var s=i.serializeStyles(n,t.registered,void 0);return r.insertStyles(t,s,!1),t.key+"-"+s.name};return{css:n,cx:function(){for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return u(t.registered,n,c(a))},injectGlobal:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered);l(t,r)},keyframes:function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];var r=i.serializeStyles(n,t.registered),s="animation-"+r.name;return l(t,{name:r.name,styles:"@keyframes "+s+"{"+r.styles+"}"}),s},hydrate:function(e){e.forEach((function(e){t.inserted[e]=!0}))},flush:function(){t.registered={},t.inserted={},t.sheet.flush()},sheet:t.sheet,cache:t,getRegisteredStyles:r.getRegisteredStyles.bind(null,t.registered),merge:u.bind(null,t.registered,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(614),i=n(616),r=n(418);function s(e){return e&&e.__esModule?e:{default:e}}var o=s(a),l=s(i),u=/[A-Z]|^ms/g,c=/_EMO_([^_]+?)_([^]*?)_EMO_/g,d=function(e){return 45===e.charCodeAt(1)},p=function(e){return null!=e&&"boolean"!=typeof e},m=s(r).default((function(e){return d(e)?e:e.replace(u,"-$&").toLowerCase()})),f=function(e,t){switch(e){case"animation":case"animationName":if("string"==typeof t)return t.replace(c,(function(e,t,n){return b={name:t,styles:n,next:b},t}))}return 1===l.default[e]||d(e)||"number"!=typeof t||0===t?t:t+"px"};function g(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return b={name:n.name,styles:n.styles,next:b},n.name;if(void 0!==n.styles){var a=n.next;if(void 0!==a)for(;void 0!==a;)b={name:a.name,styles:a.styles,next:b},a=a.next;return n.styles+";"}return function(e,t,n){var a="";if(Array.isArray(n))for(var i=0;i<n.length;i++)a+=g(e,t,n[i])+";";else for(var r in n){var s=n[r];if("object"!=typeof s)null!=t&&void 0!==t[s]?a+=r+"{"+t[s]+"}":p(s)&&(a+=m(r)+":"+f(r,s)+";");else if(!Array.isArray(s)||"string"!=typeof s[0]||null!=t&&void 0!==t[s[0]]){var o=g(e,t,s);switch(r){case"animation":case"animationName":a+=m(r)+":"+o+";";break;default:a+=r+"{"+o+"}"}}else for(var l=0;l<s.length;l++)p(s[l])&&(a+=m(r)+":"+f(r,s[l])+";")}return a}(e,t,n);case"function":if(void 0!==e){var i=b,r=n(e);return b=i,g(e,t,r)}}if(null==t)return n;var s=t[n];return void 0!==s?s:n}var b,y=/label:\s*([^\s;\n{]+)\s*(;|$)/g;t.serializeStyles=function(e,t,n){if(1===e.length&&"object"==typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var a=!0,i="";b=void 0;var r=e[0];null==r||void 0===r.raw?(a=!1,i+=g(n,t,r)):i+=r[0];for(var s=1;s<e.length;s++)i+=g(n,t,e[s]),a&&(i+=r[s]);y.lastIndex=0;for(var l,u="";null!==(l=y.exec(i));)u+="-"+l[1];return{name:o.default(i)+u,styles:i,next:b}}},function(e,t,n){"use strict";e.exports=n(615)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t,n=0,a=0,i=e.length;i>=4;++a,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(a)|(255&e.charCodeAt(++a))<<8|(255&e.charCodeAt(++a))<<16|(255&e.charCodeAt(++a))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(a+2))<<16;case 2:n^=(255&e.charCodeAt(a+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(a)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)}},function(e,t,n){"use strict";e.exports=n(617)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="undefined"!=typeof document,i=function(e,t,n){var i=e.key+"-"+t.name;(!1===n||!1===a&&void 0!==e.compat)&&void 0===e.registered[i]&&(e.registered[i]=t.styles)};t.getRegisteredStyles=function(e,t,n){var a="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):a+=n+" "})),a},t.insertStyles=function(e,t,n){i(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var s="",o=t;do{var l=e.insert(t===o?"."+r:"",o,e.sheet,!0);a||void 0===l||(s+=l),o=o.next}while(void 0!==o);if(!a&&0!==s.length)return s}},t.registerStyles=i},,function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(110),i=n(200);const r=async e=>a.b.get().http.post(i.s,{body:JSON.stringify(e),version:"2023-10-31"}),s=async e=>a.b.get().http.post(i.z,{body:JSON.stringify(e),version:"2023-10-31"})},function(e,t,n){"use strict";(function(e){}).call(this,n(242).Buffer)},function(e,t,n){"use strict";(function(e){}).call(this,n(242).Buffer)},function(e,t,n){"use strict";const a=n(625);e.exports=class extends Error{constructor(e){super(e.filter((e=>""!==e)).map((e=>"string"==typeof e?e:e instanceof Error?e.message:a(e))).join(" ")||"Unknown error"),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t.assert)}}},function(e,t,n){"use strict";e.exports=function(...e){try{return JSON.stringify.apply(null,e)}catch(e){return"[Cannot display object: "+e.message+"]"}}},function(e,t,n){"use strict";(function(n){const a={};t=e.exports={array:Array.prototype,buffer:n&&n.prototype,date:Date.prototype,error:Error.prototype,generic:Object.prototype,map:Map.prototype,promise:Promise.prototype,regex:RegExp.prototype,set:Set.prototype,weakMap:WeakMap.prototype,weakSet:WeakSet.prototype},a.typeMap=new Map([["[object Error]",t.error],["[object Map]",t.map],["[object Promise]",t.promise],["[object Set]",t.set],["[object WeakMap]",t.weakMap],["[object WeakSet]",t.weakSet]]),t.getInternalProto=function(e){if(Array.isArray(e))return t.array;if(n&&e instanceof n)return t.buffer;if(e instanceof Date)return t.date;if(e instanceof RegExp)return t.regex;if(e instanceof Error)return t.error;const i=Object.prototype.toString.call(e);return a.typeMap.get(i)||t.generic}}).call(this,n(242).Buffer)},function(e,t,n){"use strict";(function(t){const a=n(270),i=n(440),r=n(441),s={};e.exports=s.merge=function(e,n,o){if(a(e&&"object"==typeof e,"Invalid target value: must be an object"),a(null==n||"object"==typeof n,"Invalid source value: must be null, undefined, or an object"),!n)return e;if(o=Object.assign({nullOverride:!0,mergeArrays:!0},o),Array.isArray(n)){a(Array.isArray(e),"Cannot merge array onto an object"),o.mergeArrays||(e.length=0);for(let t=0;t<n.length;++t)e.push(i(n[t],{symbols:o.symbols}));return e}const l=r.keys(n,o);for(let a=0;a<l.length;++a){const r=l[a];if("__proto__"===r||!Object.prototype.propertyIsEnumerable.call(n,r))continue;const u=n[r];if(u&&"object"==typeof u){if(e[r]===u)continue;!e[r]||"object"!=typeof e[r]||Array.isArray(e[r])!==Array.isArray(u)||u instanceof Date||t&&t.isBuffer(u)||u instanceof RegExp?e[r]=i(u,{symbols:o.symbols}):s.merge(e[r],u,o)}else(null!=u||o.nullOverride)&&(e[r]=u)}return e}}).call(this,n(242).Buffer)},function(e,t,n){"use strict";e.exports=function(){}},function(e,t,n){"use strict";(function(t){const a=n(626),i={mismatched:null};e.exports=function(e,t,n){return n=Object.assign({prototype:!0},n),!!i.isDeepEqual(e,t,n,[])},i.isDeepEqual=function(e,n,r,s){if(e===n)return 0!==e||1/e==1/n;const o=typeof e;if(o!==typeof n)return!1;if(null===e||null===n)return!1;if("function"===o){if(!r.deepFunction||e.toString()!==n.toString())return!1}else if("object"!==o)return e!=e&&n!=n;const l=i.getSharedType(e,n,!!r.prototype);switch(l){case a.buffer:return t&&t.prototype.equals.call(e,n);case a.promise:return e===n;case a.regex:return e.toString()===n.toString();case i.mismatched:return!1}for(let t=s.length-1;t>=0;--t)if(s[t].isSame(e,n))return!0;s.push(new i.SeenEntry(e,n));try{return!!i.isDeepEqualObj(l,e,n,r,s)}finally{s.pop()}},i.getSharedType=function(e,t,n){if(n)return Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?i.mismatched:a.getInternalProto(e);const r=a.getInternalProto(e);return r!==a.getInternalProto(t)?i.mismatched:r},i.valueOf=function(e){const t=e.valueOf;if(void 0===t)return e;try{return t.call(e)}catch(e){return e}},i.hasOwnEnumerableProperty=function(e,t){return Object.prototype.propertyIsEnumerable.call(e,t)},i.isSetSimpleEqual=function(e,t){for(const n of Set.prototype.values.call(e))if(!Set.prototype.has.call(t,n))return!1;return!0},i.isDeepEqualObj=function(e,t,n,r,s){const{isDeepEqual:o,valueOf:l,hasOwnEnumerableProperty:u}=i,{keys:c,getOwnPropertySymbols:d}=Object;if(e===a.array){if(!r.part){if(t.length!==n.length)return!1;for(let e=0;e<t.length;++e)if(!o(t[e],n[e],r,s))return!1;return!0}for(const e of t)for(const t of n)if(o(e,t,r,s))return!0}else if(e===a.set){if(t.size!==n.size)return!1;if(!i.isSetSimpleEqual(t,n)){const e=new Set(Set.prototype.values.call(n));for(const n of Set.prototype.values.call(t)){if(e.delete(n))continue;let t=!1;for(const a of e)if(o(n,a,r,s)){e.delete(a),t=!0;break}if(!t)return!1}}}else if(e===a.map){if(t.size!==n.size)return!1;for(const[e,a]of Map.prototype.entries.call(t)){if(void 0===a&&!Map.prototype.has.call(n,e))return!1;if(!o(a,Map.prototype.get.call(n,e),r,s))return!1}}else if(e===a.error&&(t.name!==n.name||t.message!==n.message))return!1;const p=l(t),m=l(n);if((t!==p||n!==m)&&!o(p,m,r,s))return!1;const f=c(t);if(!r.part&&f.length!==c(n).length&&!r.skip)return!1;let g=0;for(const e of f)if(r.skip&&r.skip.includes(e))void 0===n[e]&&++g;else{if(!u(n,e))return!1;if(!o(t[e],n[e],r,s))return!1}if(!r.part&&f.length-g!==c(n).length)return!1;if(!1!==r.symbols){const e=d(t),a=new Set(d(n));for(const i of e){if(!r.skip||!r.skip.includes(i))if(u(t,i)){if(!u(n,i))return!1;if(!o(t[i],n[i],r,s))return!1}else if(u(n,i))return!1;a.delete(i)}for(const e of a)if(u(n,e))return!1}return!0},i.SeenEntry=class{constructor(e,t){this.obj=e,this.ref=t}isSame(e,t){return this.obj===e&&this.ref===t}}}).call(this,n(242).Buffer)},function(e,t,n){"use strict";e.exports=function(e){return e.replace(/[\^\$\.\*\+\-\?\=\!\:\|\\\/\(\)\[\]\{\}\,]/g,"\\$&")}},function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(442),t),i(n(633),t),i(n(988),t),i(n(355),t),i(n(989),t),i(n(443),t)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=n(355),i=n(443);t.default=(e,t)=>{let n;switch(e.code){case i.ZodIssueCode.invalid_type:n=e.received===a.ZodParsedType.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case i.ZodIssueCode.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,a.util.jsonStringifyReplacer)}`;break;case i.ZodIssueCode.unrecognized_keys:n=`Unrecognized key(s) in object: ${a.util.joinValues(e.keys,", ")}`;break;case i.ZodIssueCode.invalid_union:n="Invalid input";break;case i.ZodIssueCode.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${a.util.joinValues(e.options)}`;break;case i.ZodIssueCode.invalid_enum_value:n=`Invalid enum value. Expected ${a.util.joinValues(e.options)}, received '${e.received}'`;break;case i.ZodIssueCode.invalid_arguments:n="Invalid function arguments";break;case i.ZodIssueCode.invalid_return_type:n="Invalid function return type";break;case i.ZodIssueCode.invalid_date:n="Invalid date";break;case i.ZodIssueCode.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:a.util.assertNever(e.validation):n="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case i.ZodIssueCode.too_small:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case i.ZodIssueCode.too_big:n="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case i.ZodIssueCode.custom:n="Invalid input";break;case i.ZodIssueCode.invalid_intersection_types:n="Intersection results could not be merged";break;case i.ZodIssueCode.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case i.ZodIssueCode.not_finite:n="Number must be finite";break;default:n=t.defaultError,a.util.assertNever(e)}return{message:n}}},function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.isAsync=t.isValid=t.isDirty=t.isAborted=t.OK=t.DIRTY=t.INVALID=t.ParseStatus=t.addIssueToContext=t.EMPTY_PATH=t.makeIssue=void 0;const i=n(442),r=a(n(632));t.makeIssue=e=>{const{data:t,path:n,errorMaps:a,issueData:i}=e,r=[...n,...i.path||[]],s={...i,path:r};let o="";const l=a.filter((e=>!!e)).slice().reverse();for(const e of l)o=e(s,{data:t,defaultError:o}).message;return{...i,path:r,message:i.message||o}},t.EMPTY_PATH=[],t.addIssueToContext=function(e,n){const a=(0,t.makeIssue)({issueData:n,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,(0,i.getErrorMap)(),r.default].filter((e=>!!e))});e.common.issues.push(a)};class ParseStatus{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,n){const a=[];for(const i of n){if("aborted"===i.status)return t.INVALID;"dirty"===i.status&&e.dirty(),a.push(i.value)}return{status:e.value,value:a}}static async mergeObjectAsync(e,t){const n=[];for(const e of t)n.push({key:await e.key,value:await e.value});return ParseStatus.mergeObjectSync(e,n)}static mergeObjectSync(e,n){const a={};for(const i of n){const{key:n,value:r}=i;if("aborted"===n.status)return t.INVALID;if("aborted"===r.status)return t.INVALID;"dirty"===n.status&&e.dirty(),"dirty"===r.status&&e.dirty(),"__proto__"===n.value||void 0===r.value&&!i.alwaysSet||(a[n.value]=r.value)}return{status:e.value,value:a}}}t.ParseStatus=ParseStatus,t.INVALID=Object.freeze({status:"aborted"}),t.DIRTY=e=>({status:"dirty",value:e}),t.OK=e=>({status:"valid",value:e}),t.isAborted=e=>"aborted"===e.status,t.isDirty=e=>"dirty"===e.status,t.isValid=e=>"valid"===e.status,t.isAsync=e=>"undefined"!=typeof Promise&&e instanceof Promise},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(56),i=n.n(a);const r=e=>{const{from:t,to:n}=e,a=i()(n).diff(i()(t));return{kind:"absolute",fromStr:void 0,toStr:void 0,from:i()(t).subtract(a).toISOString(),to:i()(n).subtract(a).toISOString()}},s=e=>{const{from:t,to:n}=e,a=i()(n).diff(i()(t));return{kind:"absolute",fromStr:void 0,toStr:void 0,from:i()(t).add(a).toISOString(),to:i()(n).add(a).toISOString()}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(187),i=n(755),r=n(762);const s={},o=Object(a.reducerWithInitialState)(s).case(r.a,((e,{tableId:t,...n})=>({...e,[t]:{activeGroups:[],options:Object(i.c)(t),...e[t]?e[t]:{},...n}})))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i}));var a=n(58);n.d(t,"a",(function(){return a.Direction}));const i=n(111).z.enum([a.Direction.asc,a.Direction.desc])},function(e,t,n){var a=n(638),i=n(639),r=i?function(e,t){return i.set(e,t),e}:a;e.exports=r},function(e,t,n){e.exports=n(24)(1630)},function(e,t,n){var a=n(999),i=a&&new a;e.exports=i},function(e,t,n){e.exports=n(24)(3406)},function(e,t,n){var a=n(642),i=n(643),r=n(1002),s=n(358),o=n(644),l=n(650),u=n(1018),c=n(457),d=n(359);e.exports=function e(t,n,p,m,f,g,b,y,v,h){var E=128&n,x=1&n,j=2&n,O=24&n,S=512&n,k=j?void 0:s(t);return function w(){for(var T=arguments.length,I=Array(T),C=T;C--;)I[C]=arguments[C];if(O)var M=l(w),_=r(I,M);if(m&&(I=a(I,m,f,O)),g&&(I=i(I,g,b,O)),T-=_,O&&T<h){var A=c(I,M);return o(t,n,e,w.placeholder,p,I,A,y,v,h-T)}var P=x?p:this,F=j?P[t]:t;return T=I.length,y?I=u(I,y):S&&T>1&&I.reverse(),E&&v<T&&(I.length=v),this&&this!==d&&this instanceof w&&(F=k||s(F)),F.apply(P,I)}}},function(e,t){var n=Math.max;e.exports=function(e,t,a,i){for(var r=-1,s=e.length,o=a.length,l=-1,u=t.length,c=n(s-o,0),d=Array(u+c),p=!i;++l<u;)d[l]=t[l];for(;++r<o;)(p||r<s)&&(d[a[r]]=e[r]);for(;c--;)d[l++]=e[r++];return d}},function(e,t){var n=Math.max;e.exports=function(e,t,a,i){for(var r=-1,s=e.length,o=-1,l=a.length,u=-1,c=t.length,d=n(s-l,0),p=Array(d+c),m=!i;++r<d;)p[r]=e[r];for(var f=r;++u<c;)p[f+u]=t[u];for(;++o<l;)(m||r<s)&&(p[f+a[o]]=e[r++]);return p}},function(e,t,n){var a=n(1003),i=n(647),r=n(648);e.exports=function(e,t,n,s,o,l,u,c,d,p){var m=8&t;t|=m?32:64,4&(t&=~(m?64:32))||(t&=-4);var f=[e,t,o,m?l:void 0,m?u:void 0,m?void 0:l,m?void 0:u,c,d,p],g=n.apply(void 0,f);return a(e)&&i(g,f),g.placeholder=s,r(g,e,t)}},function(e,t,n){var a=n(639),i=n(700),r=a?function(e){return a.get(e)}:i;e.exports=r},function(e,t,n){var a=n(450),i=n(453);function r(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=void 0}r.prototype=a(i.prototype),r.prototype.constructor=r,e.exports=r},function(e,t,n){var a=n(637),i=n(1008)(a);e.exports=i},function(e,t,n){var a=n(1009),i=n(1010),r=n(1011),s=n(1012);e.exports=function(e,t,n){var o=t+"";return r(e,i(o,s(a(o),n)))}},function(e,t,n){e.exports=n(24)(3374)},function(e,t){e.exports=function(e){return e.placeholder}},function(e,t,n){e.exports=n(24)(3362)},function(e,t,n){e.exports=n(24)(3373)},function(e,t,n){e.exports=n(24)(940)},function(e,t,n){e.exports=n(24)(3309)},function(e,t,n){var a=n(451);e.exports=function(e){return e==e&&!a(e)}},function(e,t){e.exports=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}}},function(e,t,n){e.exports=n(24)(1235)},function(e,t,n){e.exports=n(24)(3368)},function(e,t,n){var a=n(1052),i=n(657),r=n(653),s=n(456),o=n(451),l=n(312);e.exports=function(e,t,n,u){if(!o(e))return e;for(var c=-1,d=(t=i(t,e)).length,p=d-1,m=e;null!=m&&++c<d;){var f=l(t[c]),g=n;if("prototype"==f&&r(m))throw new Error("Illegal access of function prototype");if(c!=p){var b=hasOwnProperty.call(m,f)?m[f]:void 0;void 0===(g=u?u(b,f,m):void 0)&&(g=o(b)?b:s(t[c+1])?[]:{})}a(m,f,g),m=m[f]}return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));const a="securityUserFlyoutAssetTable",i=e=>e.get(a),r=(e,t,n)=>{const i=e.get(a);e.set(a,{...i,[t]:n})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__FOR_TESTING__resetDeprecationsSeen=t.ofType=t.combineEpics=t.StateObservable=t.createEpicMiddleware=void 0;var a=n(1056);Object.defineProperty(t,"createEpicMiddleware",{enumerable:!0,get:function(){return a.createEpicMiddleware}});var i=n(662);Object.defineProperty(t,"StateObservable",{enumerable:!0,get:function(){return i.StateObservable}});var r=n(1057);Object.defineProperty(t,"combineEpics",{enumerable:!0,get:function(){return r.combineEpics}});var s=n(1058);Object.defineProperty(t,"ofType",{enumerable:!0,get:function(){return s.ofType}});var o=n(458);Object.defineProperty(t,"__FOR_TESTING__resetDeprecationsSeen",{enumerable:!0,get:function(){return o.resetDeprecationsSeen}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StateObservable=void 0;var a=n(38),i=n(3),r=function(e){function t(t,n){var a=e.call(this,(function(e){var t=a.__notifier.subscribe(e);return t&&!t.closed&&e.next(a.value),t}))||this;return a.__notifier=new i.Subject,a.value=n,t.subscribe((function(e){e!==a.value&&(a.value=e,a.__notifier.next(e))})),a}return a.__extends(t,e),t}(i.Observable);t.StateObservable=r},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(289),i=n(425),r=n(32);const s=`${r.c}: true`,o=`${r.c}: false`,l=`${r.a}: true`,u=`${r.a}: false`;function c({filter:e,showCustomRules:t,showElasticRules:n,enabled:c,tags:p,excludeRuleTypes:m=[],ruleExecutionStatus:f}){const g=[];var b;return null!=e&&e.length&&g.push(`(${function(e,t=d){return t.map((t=>`${t}: ${Object(i.b)(e)}`)).join(" OR ")}(e)})`),t&&n||(n?g.push(s):t&&g.push(o)),void 0!==c&&g.push(c?l:u),null!=p&&p.length&&g.push(function(e){return`${r.g}:(${e.map(i.b).join(" AND ")})`}(p)),m.length&&g.push("NOT "+(b=m,`${r.d}: (${b.map(i.b).join(" OR ")})`)),f===a.f.succeeded?g.push(`${r.b}: "succeeded"`):f===a.f["partial failure"]?g.push(`${r.b}: "warning"`):f===a.f.failed&&g.push(`${r.b}: "failed"`),g.join(" AND ")}const d=[r.e,r.f.INDEX,r.f.TACTIC_ID,r.f.TACTIC_NAME,r.f.TECHNIQUE_ID,r.f.TECHNIQUE_NAME,r.f.SUBTECHNIQUE_ID,r.f.SUBTECHNIQUE_NAME]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(131),r=a.__importDefault(n(375));t.default=function(e,t){r.default(e,t,i.isDeepEqual)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(49),r=n(707);const s=()=>{const{pathname:e}=Object(i.useLocation)(),t=Object(r.a)();return[Object(a.useMemo)((()=>t(e)),[e,t])]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(17),i=n(114),r=n(2),s=n.n(r),o=n(44);const l=n.n(o)()(a.EuiPopover).withConfig({displayName:"WithHoverActionsPopover",componentId:"sc-1w6un7x-0"})([".euiPopover__anchor{width:100%;}"]),u=s.a.memo((({alwaysShow:e=!1,closePopOverTrigger:t,hoverContent:n,onCloseRequested:a,render:o})=>{const[u,c]=Object(r.useState)(null!=n&&e),[d,p]=Object(r.useState)(!1),[,m]=Object(r.useState)(void 0),f=Object(r.useRef)(null),g=Object(r.useCallback)((()=>{m((e=>{clearTimeout(e)})),p(!1),null!=a&&setTimeout((()=>{a()}))}),[a]),b=Object(r.useCallback)((()=>{m(Number(setTimeout((()=>{document.body.classList.contains(i.d)||p(!0)}),100)))}),[m,p]),y=Object(r.useCallback)((()=>{e||g()}),[e,g]),v=Object(r.useCallback)((e=>{u&&"Escape"===e.key&&y()}),[u,y]),h=Object(r.useMemo)((()=>s.a.createElement("div",{"data-test-subj":"withHoverActionsButton",onMouseEnter:b},o(d))),[b,o,d]);return Object(r.useEffect)((()=>{c(null!=n&&(d||e))}),[n,d,e]),Object(r.useEffect)((()=>{p(!1)}),[t]),Object(r.useEffect)((()=>{var e;u&&(null==f||null===(e=f.current)||void 0===e||e.positionPopoverFluid())}),[n,u]),s.a.createElement("div",{className:e?i.c:"",onMouseLeave:y},s.a.createElement(l,{ref:f,anchorPosition:"downCenter",button:h,closePopover:g,hasArrow:!1,isOpen:u,ownFocus:!1,panelPaddingSize:"none",panelClassName:"withHoverActions__popover",repositionOnScroll:!0},u?s.a.createElement("div",{onKeyDown:v},n):null))}));u.displayName="WithHoverActions"},,,,,,,function(e,t,n){"use strict";e.exports=function(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}},function(e,t,n){"use strict";e.exports=function(e){return null==e?[]:"length"in e?e:[e]}},function(e,t,n){"use strict";var a=n(286);e.exports=function(e,t){return e.length?(a(e,e.length,0,t),e):t}},function(e,t,n){"use strict";e.exports=function(e,t,n){for(var a,i=[],r=-1;++r<e.length;)(a=e[r].resolveAll)&&i.indexOf(a)<0&&(t=a(t,n),i.push(a));return t}},function(e,t,n){"use strict";var a=n(288)(/[A-Za-z]/);e.exports=a},function(e,t,n){"use strict";var a=n(287),i=n(675),r=n(286),s=n(673),o=n(676),l=n(349),u=n(938),c=n(939),d=n(941),p=n(940),m={name:"labelEnd",tokenize:function(e,t,n){for(var a,i,r=this,o=r.events.length;o--;)if(("labelImage"===r.events[o][1].type||"labelLink"===r.events[o][1].type)&&!r.events[o][1]._balanced){a=r.events[o][1];break}return function(t){return a?a._inactive?u(t):(i=r.parser.defined.indexOf(s(r.sliceSerialize({start:a.end,end:r.now()})))>-1,e.enter("labelEnd"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelEnd"),l):n(t)};function l(n){return 40===n?e.attempt(f,t,i?t:u)(n):91===n?e.attempt(g,t,i?e.attempt(b,t,u):u)(n):i?t(n):u(n)}function u(e){return a._balanced=!0,n(e)}},resolveTo:function(e,t){for(var n,a,s,u,c,d,p,m=e.length,f=0;m--;)if(u=e[m][1],c){if("link"===u.type||"labelLink"===u.type&&u._inactive)break;"enter"===e[m][0]&&"labelLink"===u.type&&(u._inactive=!0)}else if(d){if("enter"===e[m][0]&&("labelImage"===u.type||"labelLink"===u.type)&&!u._balanced&&(c=m,"labelLink"!==u.type)){f=2;break}}else"labelEnd"===u.type&&(d=m);return n={type:"labelLink"===e[c][1].type?"link":"image",start:l(e[c][1].start),end:l(e[e.length-1][1].end)},a={type:"label",start:l(e[c][1].start),end:l(e[d][1].end)},s={type:"labelText",start:l(e[c+f+2][1].end),end:l(e[d-2][1].start)},p=i(p=[["enter",n,t],["enter",a,t]],e.slice(c+1,c+f+3)),p=i(p,[["enter",s,t]]),p=i(p,o(t.parser.constructs.insideSpan.null,e.slice(c+f+4,d-3),t)),p=i(p,[["exit",s,t],e[d-2],e[d-1],["exit",a,t]]),p=i(p,e.slice(d+1)),p=i(p,[["exit",n,t]]),r(e,c,e.length,p),e},resolveAll:function(e){for(var t,n=-1;++n<e.length;)(t=e[n][1])._used||"labelImage"!==t.type&&"labelLink"!==t.type&&"labelEnd"!==t.type||(e.splice(n+1,"labelImage"===t.type?4:2),t.type="data",n++);return e}},f={tokenize:function(e,t,n){return function(t){return e.enter("resource"),e.enter("resourceMarker"),e.consume(t),e.exit("resourceMarker"),p(e,i)};function i(t){return 41===t?o(t):u(e,r,n,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",3)(t)}function r(t){return a(t)?p(e,s)(t):o(t)}function s(t){return 34===t||39===t||40===t?d(e,p(e,o),n,"resourceTitle","resourceTitleMarker","resourceTitleString")(t):o(t)}function o(a){return 41===a?(e.enter("resourceMarker"),e.consume(a),e.exit("resourceMarker"),e.exit("resource"),t):n(a)}}},g={tokenize:function(e,t,n){var a=this;return function(t){return c.call(a,e,i,n,"reference","referenceMarker","referenceString")(t)};function i(e){return a.parser.defined.indexOf(s(a.sliceSerialize(a.events[a.events.length-1][1]).slice(1,-1)))<0?n(e):t(e)}}},b={tokenize:function(e,t,n){return function(t){return e.enter("reference"),e.enter("referenceMarker"),e.consume(t),e.exit("referenceMarker"),a};function a(a){return 93===a?(e.enter("referenceMarker"),e.consume(a),e.exit("referenceMarker"),e.exit("reference"),t):n(a)}}};e.exports=m},function(e,t,n){const a=n(173);e.exports=(e,t,n)=>{const i=new a(e,n),r=new a(t,n);return i.compare(r)||i.compareBuild(r)}},function(e,t,n){const a=n(225);e.exports=(e,t,n)=>a(e,t,n)<0},function(e,t,n){const a=n(173),i=n(540),{ANY:r}=i,s=n(217),o=n(541),l=n(538),u=n(680),c=n(603),d=n(539);e.exports=(e,t,n,p)=>{let m,f,g,b,y;switch(e=new a(e,p),t=new s(t,p),n){case">":m=l,f=c,g=u,b=">",y=">=";break;case"<":m=u,f=d,g=l,b="<",y="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(o(e,t,p))return!1;for(let n=0;n<t.set.length;++n){const a=t.set[n];let s=null,o=null;if(a.forEach((e=>{e.semver===r&&(e=new i(">=0.0.0")),s=s||e,o=o||e,m(e.semver,s.semver,p)?s=e:g(e.semver,o.semver,p)&&(o=e)})),s.operator===b||s.operator===y)return!1;if((!o.operator||o.operator===b)&&f(e,o.semver))return!1;if(o.operator===y&&g(e,o.semver))return!1}return!0}},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return o}));var a=n(2),i=n.n(a),r=n(50);class SecuritySolutionQueryClient extends r.QueryClient{constructor(e={}){var t,n,a;super({...e,defaultOptions:{...null!==(t=e.defaultOptions)&&void 0!==t?t:{},queries:{refetchIntervalInBackground:!1,refetchOnWindowFocus:!1,refetchOnMount:!0,keepPreviousData:!0,...null!==(n=null==e||null===(a=e.defaultOptions)||void 0===a?void 0:a.queries)&&void 0!==n?n:{}}}})}}const s=new SecuritySolutionQueryClient,o=Object(a.memo)((({queryClient:e,children:t})=>{const n=Object(a.useMemo)((()=>e||s),[e]);return i.a.createElement(r.QueryClientProvider,{client:n},t)}));o.displayName="ReactQueryClientProvider"},function(e,t,n){"use strict";n.d(t,"f",(function(){return o})),n.d(t,"h",(function(){return l})),n.d(t,"j",(function(){return u})),n.d(t,"m",(function(){return c})),n.d(t,"l",(function(){return d})),n.d(t,"p",(function(){return p})),n.d(t,"k",(function(){return m})),n.d(t,"n",(function(){return f})),n.d(t,"o",(function(){return g})),n.d(t,"g",(function(){return b})),n.d(t,"q",(function(){return y})),n.d(t,"x",(function(){return v})),n.d(t,"y",(function(){return h})),n.d(t,"t",(function(){return E})),n.d(t,"u",(function(){return x})),n.d(t,"s",(function(){return j})),n.d(t,"r",(function(){return O})),n.d(t,"b",(function(){return S})),n.d(t,"c",(function(){return k})),n.d(t,"a",(function(){return w})),n.d(t,"i",(function(){return T})),n.d(t,"d",(function(){return I})),n.d(t,"e",(function(){return C})),n.d(t,"v",(function(){return M})),n.d(t,"w",(function(){return _}));var a=n(2),i=n.n(a),r=n(5),s=n(47);const o=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldRequiredError",{defaultMessage:"A custom query is required."}),l=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.eqlQueryFieldRequiredError",{defaultMessage:"An EQL query is required."}),u=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlQueryFieldRequiredError",{defaultMessage:"An ES|QL query is required."}),c=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customQueryFieldInvalidError",{defaultMessage:"The KQL is invalid"}),d=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.indicesHelperDescription",{defaultMessage:"Enter the pattern of Elasticsearch indices where you would like this rule to run. By default, these will include index patterns defined in Security Solution advanced settings."}),p=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.resetDefaultIndicesButton",{defaultMessage:"Reset to default index patterns"}),m=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.importTimelineQueryButton",{defaultMessage:"Import query from saved timeline"}),f=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.mlJobSelectPlaceholderText",{defaultMessage:"Select a job"}),g=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldQuerBarLabel",{defaultMessage:"Custom query"}),b=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.EqlQueryBarLabel",{defaultMessage:"EQL query"}),y=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.SavedQueryFormRowLabel",{defaultMessage:"Saved query"}),v=e=>r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabel",{defaultMessage:'Load saved query "{savedQueryName}" dynamically on each rule execution',values:{savedQueryName:e}}),h=()=>r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldShouldLoadQueryDynamicallyLabelWithoutName",{defaultMessage:"Load saved query dynamically on each rule execution"}),E=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchingIcesHelperDescription",{defaultMessage:"Select threat indices"}),x=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredError",{defaultMessage:"At least one indicator match is required."}),j=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.customThreatQueryFieldRequiredEmptyError",{defaultMessage:"All matches require both a field and threat index field."}),O=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.source",{defaultMessage:"Source"}),S=(r.i18n.translate("xpack.securitySolution.detections.dataSource.popover.title",{defaultMessage:"Select a data source"}),r.i18n.translate("xpack.securitySolution.detections.dataSource.popover.subTitle",{defaultMessage:"Data sources"}),r.i18n.translate("xpack.securitySolution.detections.dataSource.popover.content",{defaultMessage:"Rules can now query index patterns or data views."}),r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.rulePreviewTitle",{defaultMessage:"Rule Preview"}),r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsLabel",{defaultMessage:"If a suppression field is missing"})),k=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsSuppressLabel",{defaultMessage:"Suppress and group alerts for events with missing fields"}),w=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionMissingFieldsDoNotSuppressLabel",{defaultMessage:"Do not suppress alerts for events with missing fields"}),T=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.esqlQueryLabel",{defaultMessage:"ES|QL query"}),I=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionOptions.perRuleExecutionLabel",{defaultMessage:"Per rule execution"}),C=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.alertSuppressionOptions.perTimePeriodLabel",{defaultMessage:"Per time period"}),M=r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.Su.perRuleExecutionWarning",{defaultMessage:"Per rule execution option is not available for Threshold rule type"}),_=e=>null!=e&&e.length?i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepDefineRule.enableThresholdSuppressionForFieldsLabel",defaultMessage:"Suppress alerts by selected fields: {fieldsString} (Technical Preview)",values:{fieldsString:i.a.createElement("strong",null,e.join(", "))}}):r.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.enableThresholdSuppressionLabel",{defaultMessage:"Suppress alerts (Technical Preview)"})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return ft}));var a=n(2),i=n.n(a),r=n(17),s=n(44),o=n.n(s),l=n(110);const u="commandInputHistory";var c=n(260),d=n(0),p=n.n(d);class parsed_command_input_ParsedCommand{constructor(e){p()(this,"name",void 0),p()(this,"args",void 0),p()(this,"hasArgs",void 0),this.input=e;const t=(e=>{const t=e.trim(),n={name:f(t),args:{}};if(!t)return n;const a=t.indexOf(" "),i=-1===a?[]:t.substring(a).trim().split(/--/);for(const e of i){const t=e.trim();if(t){const e=/[ =]/.exec(t),a=(e?t.substring(0,e.index).trim():t).trim();if(a)if(n.args[a]||(n.args[a]=[]),a!==t&&e){let i=t.substring(e.index+1).trim().replace(/\\-\\-/g,"--");'"'===i.charAt(0)&&(i=i.substring(1)),'"'===i.charAt(i.length-1)&&(i=i.substring(0,i.length-1)),n.args[a].push(i)}else n.args[a].push(!0)}}return n})(e);this.name=t.name,this.args=t.args,this.hasArgs=Object.keys(this.args).length>0}hasArg(e){return e in this.args}}const m=e=>new parsed_command_input_ParsedCommand(e),f=e=>{const t=e.trimStart();if(!t)return"";const n=e.indexOf(" ");return-1===n?t:t.substring(0,n)},g=e=>{let t="",n="";const a=[];if(e.args)for(const[i,r]of Object.entries(e.args))r.required?(t.length&&(t+=" "),t+=`--${i}`):r.exclusiveOr?a.push(`--${i}`):(n.length&&(n+=" "),n+=`--${i}`);const i=({required:e,exclusive:t,optional:n})=>`${e||""}${t?` ${t}`:""} ${n&&n.length>0?`[${n}]`:""}`.trim();return a.length>0?a.map((e=>i({required:t,exclusive:e,optional:n}))):t||n?[i({required:t,optional:n})]:[]};var b=n(5),y=n(51);const v=b.i18n.translate("xpack.securitySolution.handleInputAreaState.inputPlaceholderText",{defaultMessage:"Submit response action"}),h=(e,t)=>{if(t&&t.argsWithValueSelectors)for(const a of Object.keys(t.argsWithValueSelectors))if(e.hasArg(a)){var n;const i=null!==(n=t.argState[a])&&void 0!==n?n:[];e.args[a]=i.map((e=>e.value))}},E=(e,{type:t,payload:n})=>{var a;switch(t){case"updateInputPopoverState":if(e.input.showPopover!==n.show)return{...e,input:{...e.input,showPopover:n.show}};break;case"updateInputHistoryState":return{...e,input:{...e.input,history:[{id:Object(y.v4)(),input:n.command,display:null!==(a=n.display)&&void 0!==a?a:n.command},...e.input.history.slice(0,99)]}};case"clearInputHistoryState":return{...e,input:{...e.input,history:[]}};case"updateInputTextEnteredState":const{leftOfCursorText:t,rightOfCursorText:o="",argState:l}="function"==typeof n?n(e.input):n;if(e.input.leftOfCursorText!==t||e.input.rightOfCursorText!==o){var i;const n=m(t+o);let a=e.input.enteredCommand;if(a&&l&&(null===(i=a)||void 0===i?void 0:i.argState)!==l&&(a={...a,argState:l}),n.name&&(!a||n.name!==a.commandDefinition.name)||!n.name&&a){a=void 0;const t=e.commands.find((e=>e.name===n.name));if(t){let e;for(const[n,a]of Object.entries(null!==(r=t.args)&&void 0!==r?r:{})){var r;a.SelectorComponent&&(e||(e={}),e[n]=a)}a={argState:{},commandDefinition:t,argsWithValueSelectors:e}}}return h(n,a),{...e,input:{...e.input,leftOfCursorText:t,rightOfCursorText:o,parsedInput:n,enteredCommand:a}}}break;case"updateInputPlaceholderState":if(e.input.placeholder!==n.placeholder)return{...e,input:{...e.input,placeholder:n.placeholder||v}};break;case"setInputState":if(e.input.visibleState!==n.value)return{...e,input:{...e.input,visibleState:n.value}};break;case"updateInputCommandArgState":if(e.input.enteredCommand){var s;const{name:t,instance:a,state:i}=n,r=[...null!==(s=e.input.enteredCommand.argState[t])&&void 0!==s?s:[]];r[a]=i;const o={...e.input.enteredCommand,argState:{...e.input.enteredCommand.argState,[t]:r}},l=m(e.input.leftOfCursorText+e.input.rightOfCursorText);return h(l,o),{...e,input:{...e.input,parsedInput:l,enteredCommand:o}}}}return e};var x=n(47),j=n(199);const O=Object.freeze({mustHaveValue:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveValue",{defaultMessage:"Argument --{argName} must have a value",values:{argName:e}}),mustBeNumber:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustBeNumber",{defaultMessage:"Argument --${argName} value must be a number",values:{argName:e}}),mustBeGreaterThanZero:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustBeGreaterThanZero",{defaultMessage:"Argument --{argName} value must be greater than zero",values:{argName:e}}),NO_ARGUMENTS_SUPPORTED:b.i18n.translate("xpack.securitySolution.console.commandValidation.noArgumentsSupported",{defaultMessage:"Command does not support any arguments"}),missingRequiredArg:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.missingRequiredArg",{defaultMessage:"Missing required argument: --{argName}",values:{argName:e}}),unsupportedArg:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.unsupportedArg",{defaultMessage:"Unsupported argument: --{argName}",values:{argName:e}}),noMultiplesAllowed:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.argSupportedOnlyOnce",{defaultMessage:"Argument can only be used once: --{argName}",values:{argName:e}}),argValueValidatorError:(e,t)=>b.i18n.translate("xpack.securitySolution.console.commandValidation.invalidArgValue",{defaultMessage:"Invalid argument value: --{argName}. {error}",values:{argName:e,error:t}}),missingArguments:e=>b.i18n.translate("xpack.securitySolution.console.commandValidation.mustHaveArgs",{defaultMessage:"Missing required arguments: {missingArgs}",values:{missingArgs:e}}),MUST_HAVE_AT_LEAST_ONE_ARG:b.i18n.translate("xpack.securitySolution.console.commandValidation.oneArgIsRequired",{defaultMessage:"At least one argument must be used"}),onlyOneFromExclusiveOr:e=>i.a.createElement(j.a,null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.exclusiveOr",defaultMessage:"This command supports only one of the following arguments: {argNames}",values:{argNames:i.a.createElement(j.a,{bold:!0,inline:!0},e)}})),unknownArgument:(e,t,n)=>i.a.createElement(j.a,null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandValidation.unknownArgument",defaultMessage:"The following {command} {countOfInvalidArgs, plural, =1 {argument is} other {arguments are}} not supported by this command: {unknownArgs}",values:{countOfInvalidArgs:e,command:i.a.createElement(j.a,{bold:!0,inline:!0},t),unknownArgs:i.a.createElement(j.a,{bold:!0,inline:!0},n)}}))});var S=n(115);const k=(e="")=>{const t=oe().state.dataTestSubj;return t?t+(e?`-${e}`:""):""},w=b.i18n.translate("xpack.securitySolution.console.unsupportedMessageCallout.title",{defaultMessage:"Unsupported"}),T=Object(a.memo)((({children:e,header:t=w,"data-test-subj":n})=>i.a.createElement("div",{"data-test-subj":n},i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(r.EuiTextColor,{color:"danger"},t)),i.a.createElement(r.EuiSpacer,{size:"s"}),e)));T.displayName="UnsupportedMessageCallout";const I={className:"euiTruncateText"},C=Object(a.memo)((({commandDef:e})=>{const t=Object(a.useMemo)((()=>g(e).map(((t,n)=>i.a.createElement(i.a.Fragment,{key:`helpUsage-${n}`},n>0&&i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(j.a,null,`${e.name} ${t}`))))),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(j.a,null,b.i18n.translate("xpack.securitySolution.console.commandUsage.inputUsage",{defaultMessage:"Usage"})),description:t&&t.length>0?t:e.name}],descriptionProps:I,titleProps:I}),i.a.createElement(r.EuiSpacer,{size:"s"}),e.exampleUsage&&i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(j.a,null,b.i18n.translate("xpack.securitySolution.console.commandUsage.exampleUsage",{defaultMessage:"Example"})),description:i.a.createElement(j.a,null,e.exampleUsage)}],descriptionProps:I,titleProps:I}))}));C.displayName="CommandInputUsage";const M=Object(a.memo)((({commandDef:e,errorMessage:t})=>{const n=Object(S.a)(k()),s=Object(a.useMemo)((()=>{var t;return Object.keys(null!==(t=e.args)&&void 0!==t?t:[]).length>0}),[e.args]),o=Object(a.useMemo)((()=>s&&e.args?Object.entries(e.args).reduce(((e,t)=>{const n={title:`--${t[0]}`,description:t[1].about};return t[1].required?e.required.push(n):t[1].exclusiveOr?e.exclusiveOr.push(n):e.optional.push(n),e}),{required:[],exclusiveOr:[],optional:[]}):{required:[],exclusiveOr:[],optional:[]}),[e.args,s]),l=(t,a)=>{const s=a.map((e=>i.a.createElement("div",null,i.a.createElement(j.a,{bold:!0,inline:!0},e.title),i.a.createElement(j.a,{inline:!0}," - ",e.description))));return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"s"}),e.args&&i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(j.a,null,t),description:s}],descriptionProps:I,titleProps:I,"data-test-subj":n("commandUsage-options")}))},u=Object(a.useCallback)((()=>t?i.a.createElement(T,{header:i.a.createElement(j.a,{textColor:"danger"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":n("validationError")},i.a.createElement("div",{"data-test-subj":n("badArgument-message")},t),i.a.createElement(r.EuiSpacer,{size:"s"})):null),[t,n]);return i.a.createElement(r.EuiPanel,{paddingSize:"none",color:"transparent","data-test-subj":n("commandUsage")},u(),i.a.createElement(r.EuiDescriptionList,{compressed:!0,type:"column",columnWidths:[1,4],listItems:[{title:i.a.createElement(j.a,null,b.i18n.translate("xpack.securitySolution.console.commandUsage.about",{defaultMessage:"About"})),description:i.a.createElement(j.a,null,e.about)}],descriptionProps:I,titleProps:I,"data-test-subj":n("commandUsage-options")}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(C,{commandDef:e}),o.required&&o.required.length>0&&l(b.i18n.translate("xpack.securitySolution.console.commandUsage.requiredLabel",{defaultMessage:"Required parameters"}),o.required),o.exclusiveOr&&o.exclusiveOr.length>0&&l(b.i18n.translate("xpack.securitySolution.console.commandUsage.exclusiveOr",{defaultMessage:"Include only one parameter"}),o.exclusiveOr),o.optional&&o.optional.length>0&&l(b.i18n.translate("xpack.securitySolution.console.commandUsage.optional",{defaultMessage:"Optional parameters"}),o.optional))}));M.displayName="CommandUsage";const _=Object(a.memo)((({title:e,children:t})=>{const n=Object(S.a)(k());return i.a.createElement(r.EuiPanel,{hasShadow:!1,color:"transparent",paddingSize:"none","data-test-subj":n("helpOutput")},t)}));_.displayName="HelpOutput";const A=Object(a.memo)((e=>{const t=e.command.commandDefinition.HelpComponent;return Object(a.useEffect)((()=>{t||e.setStatus("success")}),[t,e]),t?i.a.createElement(t,e):i.a.createElement(_,{command:e.command,title:b.i18n.translate("xpack.securitySolution.console.buildInCommand.helpArgument.helpTitle",{defaultMessage:"{cmdName} command",values:{cmdName:e.command.args.name}})},i.a.createElement(M,{commandDef:e.command.commandDefinition,errorMessage:e.store.errorMessage}))}));A.displayName="HelpCommandArgument";const P=Object(a.memo)((({command:e,setStatus:t})=>{const n=Object(S.a)(k()),s=Object(a.useMemo)((()=>i.a.createElement(j.a,null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage",defaultMessage:"The text you entered {userInput} is unsupported! Click {helpIcon} {boldHelp} or type {helpCmd} for assistance.",values:{userInput:i.a.createElement(j.a,{bold:!0,inline:!0},e.input),helpIcon:i.a.createElement(r.EuiIcon,{type:"help"}),helpCmd:i.a.createElement(j.a,{bold:!0,inline:!0},"help"),boldHelp:i.a.createElement("strong",null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.helpMessage.help",defaultMessage:"Help"}))}}))),[e.input]);return Object(a.useEffect)((()=>{t("success")}),[t]),i.a.createElement(T,{header:i.a.createElement(j.a,{textColor:"danger"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.unknownCommand.title",defaultMessage:"Unsupported text/command"})),"data-test-subj":n("unknownCommandError")},s)}));P.displayName="UnknownCommand";const F=Object(a.memo)((({command:e,setStatus:t,store:n})=>{const s=Object(S.a)(k());return Object(a.useEffect)((()=>{t("success")}),[t]),i.a.createElement(T,{header:i.a.createElement(j.a,{textColor:"danger"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.title",defaultMessage:"Unsupported argument"})),"data-test-subj":s("badArgument")},i.a.createElement("div",{"data-test-subj":s("badArgument-message")},n.errorMessage),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(C,{commandDef:e.commandDefinition}),i.a.createElement(j.a,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.badArgument.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:i.a.createElement(j.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}})))}));F.displayName="BadArgument";const D=Object(a.memo)((({command:e,setStatus:t,store:n})=>{const s=Object(S.a)(k());return Object(a.useEffect)((()=>{t("success")}),[t]),i.a.createElement(T,{header:i.a.createElement(j.a,{textColor:"error"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.validationError.title",defaultMessage:"Unsupported action"})),"data-test-subj":s("validationError")},i.a.createElement("div",{"data-test-subj":s("validationError-message")},n.errorMessage),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(C,{commandDef:e.commandDefinition}),i.a.createElement(j.a,null,i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.validationError.helpMessage",defaultMessage:"Enter {helpCmd} for further assistance.",values:{helpCmd:i.a.createElement(j.a,{bold:!0,inline:!0},`${e.commandDefinition.name} --help`)}})))}));D.displayName="ValidationError";const N=e=>`--${e}`,R=(e,t)=>{const n=E(e,{type:"updateInputHistoryState",payload:{command:t.command.input,display:t.command.inputDisplay}});return n.commandHistory=[...e.commandHistory,t],n},L={name:"unknown-command",about:"unknown command",RenderComponent:()=>null},z=(e={})=>({status:"pending",store:e}),B=(e,t)=>({...e,commandDefinition:{...e.commandDefinition,RenderComponent:t}}),q=(e,t=z(),n=!0)=>({id:Object(y.v4)(),isValid:n,enteredAt:(new Date).toISOString(),command:e,state:t}),$=()=>oe().dispatch,V=Object(a.memo)((({status:e,setStatus:t})=>{const n=$();return Object(a.useEffect)((()=>{"pending"===e&&n({type:"clear"}),t("success")}),[e,t,n]),null}));V.displayName="ClearCommand";var U=n(9);const H=e=>{if(!e.mustHaveArgs||!e.args)return e.name;let t=!1;const n=Object.entries(e.args).reduce(((e,[n,a])=>a.required?(e[n]=a,e):a.exclusiveOr&&!t?(t=!0,e[n]=a,e):e),{});return`${e.name} --${Object.keys(n).join(" --")}`},Z=b.i18n.translate("xpack.securitySolution.console.commandList.otherCommandsGroup.label",{defaultMessage:"Other commands"}),G=e=>e.replace(/[^A-Za-z0-9]/g,""),Q=o()(r.EuiBasicTable).withConfig({displayName:"StyledEuiBasicTable",componentId:"sc-10x4uz4-0"})(["margin-top:",";.euiTableHeaderCell{.euiTableCellContent__text{color:",";font-size:",";padding-bottom:",";padding-left:",";}}"],(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiTextColor),(({theme:{eui:e}})=>e.euiFontSize),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiSizeS)),W=o()(r.EuiCallOut).withConfig({displayName:"StyledEuiCallOut",componentId:"sc-10x4uz4-1"})(["margin:",";padding:",";border-radius:",";"],(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS)),K=o()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-10x4uz4-2"})(["padding-left:",";"],(({theme:{eui:e}})=>e.euiSizeS)),J=o()(r.EuiFlexGrid).withConfig({displayName:"StyledEuiFlexGrid",componentId:"sc-10x4uz4-3"})(["@media only screen and (min-width:","){max-width:75%;}@media only screen and (min-width:","){max-width:50%;}"],(e=>e.theme.eui.euiBreakpoints.l),(e=>e.theme.eui.euiBreakpoints.xl)),Y=o()(r.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-10x4uz4-4"})(["font-size:10px !important;span{color:"," !important;}"],(({theme:{eui:e}})=>e.euiShadowColor)),X=Object(a.memo)((({commands:e,display:t="default"})=>{const n=Object(S.a)(k("commandList")),s=$(),{docLinks:o}=Object(l.i)().services,u=Object(a.useMemo)((()=>{var e;return i.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:i.a.createElement(Y,null,i.a.createElement(j.a,{inline:!0,bold:!0},null===(e=ae.find((e=>"--help"===e.name)))||void 0===e?void 0:e.name)),description:i.a.createElement(r.EuiText,{color:"subdued",size:"xs"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.footerText",defaultMessage:"For more help with the individual commands use the --help argument. Ex: processes --help"}))}]})}),[]),c=Object(a.useCallback)((e=>()=>{s({type:"updateInputTextEnteredState",payload:()=>({leftOfCursorText:e,rightOfCursorText:""})}),s({type:"addFocusToKeyCapture"})}),[s]),d=Object(a.useMemo)((()=>{const t=new Map,n=e.filter((e=>!0!==e.helpHidden));for(const e of n){const{helpGroupLabel:n=Z,helpGroupPosition:a=1/0}=e,i=t.get(n);i?(i.list.push(e),i.position===1/0&&void 0!==a&&a!==i.position&&(i.position=a)):t.set(e.helpGroupLabel,{label:n,position:a,list:[e]})}return Object(U.sortBy)(Array.from(t.values()),"position").map((e=>{const t=e.list.map((e=>void 0===e.helpCommandPosition?{...e,helpCommandPosition:1/0}:e));return Object(U.sortBy)(t,"helpCommandPosition")}))}),[e]),p=Object(a.useCallback)((e=>e[0].helpGroupLabel===ne.supporting.label?[...ae,...e].map((t=>{var n,a;return{[null!==(n=null===(a=e[0])||void 0===a?void 0:a.helpGroupLabel)&&void 0!==n?n:Z]:t}})):e.map((t=>{var n,a;return{[null!==(n=null===(a=e[0])||void 0===a?void 0:a.helpGroupLabel)&&void 0!==n?n:Z]:t}}))),[]),m=Object(a.useCallback)((e=>{var t,a;const s=null!==(t=null===(a=e[0])||void 0===a?void 0:a.helpGroupLabel)&&void 0!==t?t:Z,o=G(s);return[{field:s,name:i.a.createElement("div",{"data-test-subj":n("group")},s),render:e=>{const t=H(e);return i.a.createElement(K,{alignItems:"center","data-test-subj":n(`${o}-${e.name}`)},i.a.createElement(r.EuiFlexItem,{grow:1},i.a.createElement(r.EuiDescriptionList,{"data-test-subj":n("command"),listItems:[{title:i.a.createElement(r.EuiBadge,{"data-test-subj":n("commandName")},t),description:i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about))}]})),e.helpGroupLabel!==ne.supporting.label&&!0!==e.helpHidden&&e.RenderComponent&&i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiToolTip,{content:!0===e.helpDisabled?b.i18n.translate("xpack.securitySolution.console.commandList.disabledButtonTooltip",{defaultMessage:"Unsupported command"}):b.i18n.translate("xpack.securitySolution.console.commandList.addButtonTooltip",{defaultMessage:"Add to text bar"})},i.a.createElement(r.EuiButtonIcon,{iconType:"plusInCircle","aria-label":`updateTextInputCommand-${e.name}`,onClick:c(`${t} `),isDisabled:!0===e.helpDisabled,"data-test-subj":n(`${o}-${e.name}-addToInput`)}))))}}]}),[n,c]),f=Object(a.useCallback)((e=>e.filter((e=>"help"!==e.name&&"clear"!==e.name))),[]);if("table"===t){const e=[i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.multipleResponses",defaultMessage:"You can enter consecutive response actions â€” no need to wait for previous actions to complete."}),i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.leavingResponder",defaultMessage:"Leaving the response console does not terminate any actions that have been submitted."}),i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.visitSupportSections",defaultMessage:"{learnMore} about response actions and using the console.",values:{learnMore:i.a.createElement(r.EuiLink,{href:o.links.securitySolution.responseActions,target:"_blank","data-test-subj":n("helpfulHintDocLink")},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.readMoreLink",defaultMessage:"Learn more"}))}})],t=i.a.createElement(W,{title:i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.commandList.callout.title",defaultMessage:"Helpful tips:"}),"data-test-subj":n("helpfulTips")},i.a.createElement("ul",null,e.map(((e,t)=>i.a.createElement("li",{key:t},i.a.createElement(r.EuiText,{size:"s"},e))))));return i.a.createElement("div",{"data-test-subj":n()},d.map(((e,t)=>{var a;return i.a.createElement(Q,{"data-test-subj":n(G(null!==(a=e[0].helpGroupLabel)&&void 0!==a?a:Z)),key:`styledEuiBasicTable-${t}`,items:p(e),columns:m(e)})})),t)}return i.a.createElement("div",{"data-test-subj":n()},i.a.createElement(r.EuiSpacer,{size:"s"}),d.map((e=>{const t=e[0].helpGroupLabel,a=f(e);return 0===a.length?null:i.a.createElement(J,{columns:3,responsive:!1,gutterSize:"l",key:t,direction:"column"},a.map((e=>{const t=H(e);return i.a.createElement(r.EuiFlexItem,{key:e.name},i.a.createElement(r.EuiDescriptionList,{compressed:!0,listItems:[{title:i.a.createElement(r.EuiToolTip,{content:t},i.a.createElement(Y,null,i.a.createElement(j.a,{inline:!0,bold:!0},t))),description:i.a.createElement(r.EuiText,{color:"subdued",size:"xs"},e.about)}],"data-test-subj":n("command")}))})))})),i.a.createElement(r.EuiSpacer,{size:"xl"}),u)}));X.displayName="CommandList";const ee=()=>oe().state.commands,te=Object(a.memo)((e=>{const t=ee(),n=oe().state.HelpComponent;return Object(a.useEffect)((()=>{n||e.setStatus("success")}),[n,e]),n?i.a.createElement(n,e):i.a.createElement(_,{command:e.command,title:b.i18n.translate("xpack.securitySolution.console.builtInCommands.help.helpTitle",{defaultMessage:"Available commands"})},i.a.createElement(X,{commands:t}))}));te.displayName="HelpCommand";const ne=Object.freeze({supporting:{label:b.i18n.translate("xpack.securitySolution.console.builtInCommands.groups.supporting",{defaultMessage:"Supporting commands & parameters"})}}),ae=Object.freeze([{name:"--comment",about:b.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.comment",{defaultMessage:"Add comment to any action Ex: isolate --comment your comment"})},{name:"--help",about:b.i18n.translate("xpack.securitySolution.console.commandList.commonArgs.help",{defaultMessage:"Command assistance Ex: isolate --help"})}]),ie=(e,t)=>{var n,a,r,s;let o=e;switch(t.type){case"scrollDown":e.scrollToBottom();break;case"addFocusToKeyCapture":null===(n=e.keyCapture)||void 0===n||null===(a=n.current)||void 0===a||a.focus();break;case"removeFocusFromKeyCapture":null===(r=e.keyCapture)||void 0===r||null===(s=r.current)||void 0===s||s.blur();break;case"updateFooterContent":e.footerContent!==t.payload.value&&(o={...e,footerContent:t.payload.value});break;case"executeCommand":o=((e,t)=>{const{parsedInput:n,enteredCommand:a,input:r}=t.payload;if(""===n.name)return e;const s=null==a?void 0:a.commandDefinition;if(!s)return R(e,q({input:n.input,inputDisplay:r,args:n,commandDefinition:{...L,RenderComponent:P}},void 0,!1));const o={input:n.input,inputDisplay:r,args:n,commandDefinition:s},l=(u=s.args)?Object.entries(u).filter((([e,t])=>t.required)).map((([e])=>e)):[];var u;const c=(e=>e?Object.entries(e).reduce(((e,[t,n])=>(n.exclusiveOr&&e.push(t),e)),[]):[])(s.args),d=O.onlyOneFromExclusiveOr(c.map(N).join(", "));if(n.hasArgs){if(n.hasArg("help")){if(Object.keys(n.args).length>1||n.args.help.length>1||!0!==n.args.help[0])return R(e,q(B(o,F),void 0,!1));if(null!=s&&s.validate){const t=s.validate(o);if(!0!==t)return R(e,q(B(o,A),z({errorMessage:t}),!1))}return R(e,q(B(o,A),void 0,!1))}if(!s.args||0===Object.keys(s.args).length)return R(e,q(B(o,F),z({errorMessage:O.NO_ARGUMENTS_SUPPORTED}),!1));const t=((e,t)=>{const n=[];return Object.keys(e).forEach((e=>{"help"===e||t&&t[e]||n.push(e)})),n})(n.args,s.args);if(t.length)return R(e,q(B(o,F),z({errorMessage:O.unknownArgument(t.length,n.name,t.map(N).join(", "))}),!1));for(const t of l)if(!n.args[t])return R(e,q(B(o,F),z({errorMessage:i.a.createElement(j.a,null,O.missingRequiredArg(t))}),!1));if(c.filter((e=>n.args[e])).length>1)return R(e,q(B(o,F),z({errorMessage:d}),!1));for(const t of Object.keys(n.args)){var p;const a=null===(p=s.args)||void 0===p?void 0:p[t],r=n.args[t];if(!a)return R(e,q(B(o,F),z({errorMessage:i.a.createElement(j.a,null,O.unsupportedArg(t))}),!1));if(!a.allowMultiples&&Array.isArray(r)&&r.length>1)return R(e,q(B(o,F),z({errorMessage:i.a.createElement(j.a,null,O.noMultiplesAllowed(t))}),!1));if(void 0!==a.mustHaveValue&&!1!==a.mustHaveValue){let n="";if(0===r.length?n=O.mustHaveValue(t):r.some(((e,i)=>{switch(a.mustHaveValue){case!0:case"non-empty-string":("boolean"==typeof e||"non-empty-string"===a.mustHaveValue&&0===e.trim().length)&&(n=O.mustHaveValue(t));break;case"truthy":e||(n=O.mustHaveValue(t));break;case"number":case"number-greater-than-zero":{const s=Number(e);Number.isSafeInteger(s)?"number-greater-than-zero"===a.mustHaveValue&&s<=0&&(n=O.mustBeGreaterThanZero(t)):n=O.mustBeNumber(t),n||(r[i]=s)}}return!!n})),n)return R(e,q(B(o,F),z({errorMessage:i.a.createElement(j.a,null,n)}),!1))}if(a.validate){const n=a.validate(r);if(!0!==n)return R(e,q(B(o,F),z({errorMessage:i.a.createElement(j.a,null,O.argValueValidatorError(t,n))}),!1))}}}else{if(l.length>0)return R(e,q(B(o,F),z({errorMessage:i.a.createElement(j.a,null,O.missingArguments(l.map((e=>N(e))).join(", ")))}),!1));if(c.length>0)return R(e,q(B(o,F),z({errorMessage:d}),!1));if(s.mustHaveArgs)return R(e,q(B(o,F),z({errorMessage:i.a.createElement(j.a,null,O.MUST_HAVE_AT_LEAST_ONE_ARG)}),!1))}if(s.validate){const t=s.validate(o);if(!0!==t)return R(e,q(B(o,D),z({errorMessage:t}),!1))}return R(e,q(o))})(e,t);break;case"updateCommandStatusState":case"updateCommandStoreState":o=((e,{type:t,payload:{id:n,value:a}})=>{let i=!1;const r=e.commandHistory.map((e=>{if(i||e.id!==n)return e;i=!0;const r={...e,state:{...e.state}};switch(t){case"updateCommandStoreState":r.state.store=a(r.state.store);break;case"updateCommandStatusState":if(r.state.status===a)return i=!1,e;r.state.status=a}return r}));return i?{...e,commandHistory:r}:e})(e,t);break;case"showSidePanel":o=((e,t)=>"showSidePanel"===t.type&&e.sidePanel.show!==t.payload.show?{...e,sidePanel:{...e.sidePanel,show:t.payload.show}}:e)(e,t);break;case"updateInputPopoverState":case"updateInputHistoryState":case"clearInputHistoryState":case"updateInputTextEnteredState":case"updateInputPlaceholderState":case"setInputState":case"updateInputCommandArgState":o=E(e,t);break;case"clear":o={...e,commandHistory:[]}}return o},re=Object(a.createContext)(null),se=Object(a.memo)((({commands:e,scrollToBottom:t,keyCapture:n,HelpComponent:r,dataTestSubj:s,storagePrefix:o,managedKey:d,children:p})=>{const[f,g]=Object(c.d)(d),y=(e=>{const{storage:t}=Object(l.i)().services;return Object(a.useMemo)((()=>{if(e){var n;const a=null!==(n=t.get(`${e}.${u}`))&&void 0!==n?n:{version:2,data:[]};return 2!==a.version&&(e=>{const{data:t,version:n}=e;for(const e of t)n<2&&(e.display=e.input);e.version=2})(a),a.data}return[]}),[t,e])})(o),h=(e=>{const{storage:t}=Object(l.i)().services;return Object(a.useCallback)((n=>{if(e){const a={version:2,data:n};t.set(`${e}.${u}`,a)}}),[t,e])})(o),E=Object(a.useCallback)((e=>{const t=(({commands:e,...t},n)=>{const a=[{name:"help",about:b.i18n.translate("xpack.securitySolution.console.builtInCommands.helpAbout",{defaultMessage:"List all available commands"}),RenderComponent:te,helpGroupLabel:ne.supporting.label,helpCommandPosition:1},{name:"clear",about:b.i18n.translate("xpack.securitySolution.console.builtInCommands.clearAbout",{defaultMessage:"Clear console screen"}),RenderComponent:V,helpGroupLabel:ne.supporting.label,helpCommandPosition:0}].concat(e),i=null!=n?n:{commands:a,...t,commandHistory:[],sidePanel:{show:null},footerContent:"",input:{leftOfCursorText:"",rightOfCursorText:"",parsedInput:m(""),enteredCommand:void 0,placeholder:v,showPopover:void 0,history:[],visibleState:void 0}};return n&&Object.assign(i,{commands:a,...t}),i})(e,f?f():void 0);return t.input.history=y,t}),[f,y]),[x,j]=Object(a.useReducer)(ie,{commands:e,scrollToBottom:t,keyCapture:n,HelpComponent:r,dataTestSubj:s,storagePrefix:o},E);return Object(a.useEffect)((()=>{g&&g(x)}),[x,g]),Object(a.useEffect)((()=>{o&&x.input.history&&h(x.input.history)}),[h,x.input.history,o]),i.a.createElement(re.Provider,{value:{state:x,dispatch:j}},p)}));se.displayName="ConsoleStateProvider";const oe=()=>{const e=Object(a.useContext)(re);if(!e)throw new Error("ConsoleStateContext not defined");return e},le=()=>oe().state.input.visibleState,ue=Object(a.memo)((()=>{const e=oe().state.footerContent,t=Object(S.a)(k()),n=le(),s=Object(a.useMemo)((()=>"error"===n?"danger":"subdued"),[n]);return i.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",color:"transparent","data-test-subj":t("footer")},i.a.createElement(r.EuiText,{size:"xs",color:s,className:"font-style-italic"},e||i.a.createElement(i.a.Fragment,null,"Â ")))}));ue.displayName="ConsoleFooter";const ce=()=>oe().state.sidePanel,de=(b.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonTitle",{defaultMessage:"Help"}),b.i18n.translate("xpack.securitySolution.console.layoutHeader.helpButtonLabel",{defaultMessage:"Show help"})),pe=o()(r.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-lvlnbi-0"})(["margin-left:auto;height:inherit;"]),me=Object(a.memo)((({TitleComponent:e})=>{const t=$(),n=ce().show,s=Object(S.a)(k("header")),o="help"===n,l=Object(a.useCallback)((()=>{t({type:"showSidePanel",payload:{show:o?null:"help"}})}),[t,o]);return i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"spaceBetween",responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:1,className:"eui-textTruncate noThemeOverrides","data-test-subj":s("titleComponentContainer")},e?i.a.createElement(e,null):""),!o&&i.a.createElement(r.EuiFlexItem,{grow:1},i.a.createElement(pe,{style:{marginLeft:"auto"},onClick:l,iconType:"help",title:de,"aria-label":de,isSelected:o,"data-test-subj":s("helpButton")},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.layoutHeader.helpButtonTitle",defaultMessage:"Help"}))))}));me.displayName="ConsoleHeader";var fe=n(23),ge=n.n(fe),be=n(59),ye=n.n(be);const ve=()=>{const{leftOfCursorText:e,rightOfCursorText:t,parsedInput:n,enteredCommand:i}=oe().state.input;return Object(a.useMemo)((()=>({leftOfCursorText:e,rightOfCursorText:t,parsedInput:n,enteredCommand:i,fullTextEntered:e+t})),[i,e,n,t])},he=o.a.div.withConfig({displayName:"InputDisplayContainer",componentId:"sc-cduvts-0"})(["overflow:hidden !important;.inputDisplay{& > *{flex-direction:row;align-items:center;}}.cursor{display:inline-block;width:1px;height:","em;background-color:",";}"],(({theme:{eui:e}})=>e.euiLineHeight),(({theme:e})=>e.eui.euiTextSubduedColor)),Ee=Object(a.memo)((({leftOfCursor:e,rightOfCursor:t})=>{const n=Object(S.a)(k()),s=$(),{leftOfCursorText:o,fullTextEntered:l}=ve(),u=Object(a.useRef)(null),c=Object(a.useRef)(null),d=Object(a.useRef)(null),p=o.length,m=Object(a.useCallback)((e=>{const t=e.target;if(l.length&&t.classList&&t.classList.contains("chr")){const n=Array.from(e.currentTarget.querySelectorAll("span.chr")).indexOf(t),a=l.substring(0,n+1),i=l.substring(n+1);s({type:"updateInputTextEnteredState",payload:{leftOfCursorText:a,rightOfCursorText:i}})}}),[s,l]);return Object(a.useEffect)((()=>{if(c.current){const e=e=>{if(c.current){const t=e[0];if(t&&t.rootBounds){const e=c.current.scrollLeft,n=t.rootBounds.right,a=t.rootBounds.left,i=t.boundingClientRect.right;if(i>n-20){const n=e+(i-t.rootBounds.width)+20;c.current.scrollLeft=n}else if(i<a+20){const t=i-20<0?0:e-20;c.current.scrollLeft=t}}}};return u.current=new IntersectionObserver(e,{root:c.current,rootMargin:"0px -10px",threshold:0}),()=>{var e;null===(e=u.current)||void 0===e||e.disconnect(),u.current=null}}}),[]),Object(a.useEffect)((()=>{if(u.current&&d.current){const e=u.current,t=d.current;return e.observe(t),()=>{e.unobserve(t)}}}),[p]),i.a.createElement(he,{ref:c},i.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none",className:"inputDisplay",onClick:m},i.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":n("cmdInput-leftOfCursor"),className:"noMinWidth"},e),i.a.createElement(r.EuiFlexItem,{grow:!1,className:"noMinWidth"},i.a.createElement("span",{className:"cursor essentialAnimation",ref:d})),i.a.createElement(r.EuiFlexItem,{className:"noMinWidth","data-test-subj":n("cmdInput-rightOfCursor")},t)))}));Ee.displayName="InputDisplay";const xe=()=>oe().state.input.showPopover,je=o.a.span.withConfig({displayName:"ArgumentSelectorWrapperContainer",componentId:"sc-jnz75k-0"})(["border:",";border-radius:",";overflow:hidden;user-select:none;.flexGroup{align-items:stretch;}.selectorContainer{padding:0 ",";max-width:25vw;display:flex;align-items:center;height:100%;}.argNameContainer{background-color:",";}.argName{padding-left:",";height:100%;display:flex;align-items:center;white-space:nowrap;}"],(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormInputGroupLabelBackground),(({theme:{eui:e}})=>e.euiSizeXS)),Oe=Object(a.memo)((({argName:e,argIndex:t,argDefinition:{SelectorComponent:n}})=>{const s=$(),{valueText:o,value:l,store:u}=((e,t)=>{const n=oe().state.input.enteredCommand;return Object(a.useMemo)((()=>{var a;const i=null==n||null===(a=n.argState[e])||void 0===a?void 0:a.at(t);return null!=i?i:{value:void 0,valueText:""}}),[e,n,t])})(e,t),c=Object(a.useCallback)((n=>{s({type:"updateInputCommandArgState",payload:{name:e,instance:t,state:n}})}),[t,e,s]);return i.a.createElement(je,{className:"eui-displayInlineBlock"},i.a.createElement(r.EuiFlexGroup,{className:"flexGroup",responsive:!1,alignItems:"center",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1,className:"argNameContainer"},i.a.createElement("div",{className:"argName"},i.a.createElement("span",null,`--${e}=`))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement("div",{className:"selectorContainer noThemeOverrides eui-textTruncate"},i.a.createElement(n,{value:l,valueText:null!=o?o:"",argName:e,argIndex:t,store:u,onChange:c})))))}));Oe.displayName="ArgumentSelectorWrapper";const Se=[""," ","="],ke=(e={})=>({value:"",renderValue:null,isArgSelector:!1,argName:"",argIndex:0,argState:void 0,...e}),we=e=>e.split("").map((e=>ke({value:e,renderValue:e}))),Te=(e,t,n)=>{var a;return i.a.createElement("span",{className:"chr",key:`${e}.${n}.${null!==(a=t.value)&&void 0!==a?a:"$"}`},t.renderValue)},Ie=(e,t)=>{let n=t.value;var a,i;return e&&t.isArgSelector&&(n+=`="${null!==(a=null===(i=t.argState)||void 0===i?void 0:i.valueText)&&void 0!==a?a:""}"`),n};class entered_input_EnteredInput{constructor(e,t,n,a){if(p()(this,"leftOfCursorContent",void 0),p()(this,"rightOfCursorContent",void 0),p()(this,"canHaveArgValueSelectors",void 0),p()(this,"argState",void 0),this.leftOfCursorContent=we(e),this.rightOfCursorContent=we(t),this.canHaveArgValueSelectors=Boolean(null==a?void 0:a.argsWithValueSelectors),n.hasArgs&&a&&a.argsWithValueSelectors){this.argState=a.argState;const s=[{input:e,items:this.leftOfCursorContent,side:"left"},{input:t,items:this.rightOfCursorContent,side:"right"}];for(const[e,o]of Object.entries(a.argsWithValueSelectors))if(n.hasArg(e)){let n=0;for(const{input:l,items:u,side:c}of s){const s=`--${e}`;let d=l.indexOf(s);for(;d>-1;){const p=s.length,m=d+p,f=l.charAt(m),g="left"===c&&""===f&&Se.includes(t.charAt(0));if(Se.includes(f)&&(g||"left"===c&&""!==f||"right"===c)){var r;const t=Array.from({length:p},ke),l=null===(r=a.argState[e])||void 0===r?void 0:r.at(n);t[0]=ke({value:s,renderValue:i.a.createElement(Oe,{argName:e,argIndex:n,argDefinition:o}),isArgSelector:!0,argName:e,argIndex:n++,argState:l}),u.splice(d,p,...t)}d=l.indexOf(s,m)}}}this.leftOfCursorContent=this.leftOfCursorContent.filter((({value:e})=>e.length>0)),this.rightOfCursorContent=this.rightOfCursorContent.filter((({value:e})=>e.length>0))}}replaceSelection(e,t){const n=this.getFullText(),a=t?ke({value:t}):void 0;let i=n.indexOf(e);const r=[...this.leftOfCursorContent,...this.rightOfCursorContent];this.canHaveArgValueSelectors&&r.forEach(((e,t)=>{e.isArgSelector&&t<i&&(i-=e.value.length-1)}));const s=r.splice(i,e.length);a&&(r.splice(i,0,a),i++),this.leftOfCursorContent=r.splice(0,i),this.rightOfCursorContent=r,this.removeArgState(s)}removeArgState(e){if(this.argState){let n=!1;const a={...this.argState};for(const{argName:i,argIndex:r,isArgSelector:s}of e){var t;s&&null!==(t=a[i])&&void 0!==t&&t.at(r)&&(a[i]=a[i].filter(((e,t)=>t!==r)),n=!0)}n&&(this.argState=a)}}getLeftOfCursorText(e=!1){return this.leftOfCursorContent.map(Ie.bind(null,e)).join("")}getRightOfCursorText(e=!1){return this.rightOfCursorContent.map(Ie.bind(null,e)).join("")}getFullText(e=!1){return this.getLeftOfCursorText(e)+this.getRightOfCursorText(e)}getLeftOfCursorRenderingContent(){return i.a.createElement(i.a.Fragment,null,this.leftOfCursorContent.map(Te.bind(null,"left")))}getRightOfCursorRenderingContent(){return i.a.createElement(i.a.Fragment,null,this.rightOfCursorContent.map(Te.bind(null,"right")))}getArgState(){return this.argState}moveCursorTo(e){switch(e){case"end":this.leftOfCursorContent.push(...this.rightOfCursorContent.splice(0));break;case"home":this.rightOfCursorContent.unshift(...this.leftOfCursorContent.splice(0));break;case"left":if(this.leftOfCursorContent.length){const e=this.leftOfCursorContent.pop();e&&this.rightOfCursorContent.unshift(e)}break;case"right":if(this.rightOfCursorContent.length){const e=this.rightOfCursorContent.shift();e&&this.leftOfCursorContent.push(e)}}}addValue(e,t=""){t.length&&e.length?this.replaceSelection(t,e):e&&this.leftOfCursorContent.push(ke({value:e}))}deleteChar(e=""){if(e)this.replaceSelection(e,"");else{const e=this.rightOfCursorContent.shift();null!=e&&e.isArgSelector&&this.removeArgState([e])}}backspaceChar(e=""){if(e)this.replaceSelection(e,"");else{const e=this.leftOfCursorContent.pop();null!=e&&e.isArgSelector&&this.removeArgState([e])}}clear(){this.leftOfCursorContent=[],this.rightOfCursorContent=[],this.argState=void 0}}const Ce=b.i18n.translate("xpack.securitySolution.inputCapture.ariaPlaceHolder",{defaultMessage:"Enter a command"}),Me=()=>{const e=getSelection();e&&e.removeAllRanges()},_e=o.a.div.withConfig({displayName:"InputCaptureContainer",componentId:"sc-19dx6ae-0"})([".focus-container{outline:none !important;}.textSelectionBoundaryHelper{opacity:0;position:absolute;top:-100vh;left:-100vw;}.invisible-input{&,&:focus{border:none;outline:none;background-image:none;background-color:transparent;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none;animation:none !important;width:1ch !important;position:absolute;opacity:0;top:-100vh;left:-100vw;}"]),Ae=Object(a.memo)((({onCapture:e,focusRef:t,onChangeFocus:n,children:r})=>{const s=Object(S.a)(k()),o=Object(a.useRef)(null),l=Object(a.useRef)(null),u=Object(a.useRef)(null),c=Object(a.useCallback)((()=>{if(o.current){var e,t,n;const a=document.getSelection(),i=(null!==(e=null==a?void 0:a.toString())&&void 0!==e?e:"").replace(/[\r\n]/g,""),r=!(!o.current||!a)&&(null===(t=o.current)||void 0===t?void 0:t.contains(a.focusNode))&&(null===(n=o.current)||void 0===n?void 0:n.contains(a.anchorNode));return a&&0!==i.length&&r?i:""}return""}),[]),d=Object(a.useCallback)((t=>{if(t.metaKey||t.ctrlKey){if("a"===t.key){t.preventDefault();const e=window.getSelection();if(e&&l.current){const t=document.createRange();t.selectNodeContents(l.current),t.toString().length>0&&(e.removeAllRanges(),e.addRange(t))}}return}const n=/^[\w\d]{2}/.test(t.key)?"":t.key,a=c(),i=Object(U.pick)(t,["key","altKey","ctrlKey","keyCode","metaKey","repeat","shiftKey"]);e({value:n,selection:a,eventDetails:i}),a&&Me()}),[c,e]),p=Object(a.useCallback)((t=>{t.preventDefault(),t.stopPropagation();const n=t.clipboardData.getData("text").replace(/[\r\n]/g,""),a=c();e({value:n,selection:a,eventDetails:{altKey:!1,ctrlKey:!1,key:"Meta",keyCode:91,metaKey:!0,repeat:!1,shiftKey:!1}}),a&&Me()}),[c,e]),m=Object(a.useCallback)((()=>{n&&n(!0)}),[n]),f=Object(a.useCallback)((()=>{n&&n(!1)}),[n]),g=Object(a.useMemo)((()=>({focus:(e=!1)=>{var t,n,a;!e&&(null!==(t=null===(n=window.getSelection())||void 0===n?void 0:n.toString())&&void 0!==t?t:"").length>0||document.activeElement===u.current||null===(a=u.current)||void 0===a||a.focus()},blur:()=>{var e;u.current&&document.activeElement===u.current&&(null===(e=u.current)||void 0===e||e.blur())}})),[]);return t&&(t.current=g),i.a.createElement(_e,{"data-test-subj":s("inputCapture"),onKeyDown:d,onPaste:p},i.a.createElement("div",{role:"textbox","aria-placeholder":Ce,tabIndex:0,ref:o,className:"focus-container","data-test-subj":s("keyCapture-input"),onBlur:f,onFocus:m},i.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),i.a.createElement("div",{ref:l,className:"text-container"},r),i.a.createElement("div",{className:"textSelectionBoundaryHelper"}," "),i.a.createElement("input",{ref:u,type:"text",value:"",tabIndex:-1,onPaste:p,onChange:()=>{},spellCheck:"false",className:"invisible-input"})))}));Ae.displayName="InputCapture";const Pe=b.i18n.translate("xpack.securitySolution.useInputHints.noArguments",{defaultMessage:"Hit enter to execute"}),Fe=b.i18n.translate("xpack.securitySolution.useInputHints.viewInputHistory",{defaultMessage:"Press the up arrow key to access previously entered commands"}),De=o()(r.EuiText).withConfig({displayName:"InputPlaceholderContainer",componentId:"sc-6afwlc-0"})(["position:absolute;pointer-events:none;padding-left:0.5em;width:96%;color:",";user-select:none;"],(({theme:{eui:e}})=>e.euiFormControlPlaceholderText)),Ne=Object(a.memo)((()=>{const{fullTextEntered:e}=ve(),t=oe().state.input.placeholder,n=Object(S.a)(k());return e.length>0?null:i.a.createElement(De,{size:"s",className:"eui-textTruncate","data-test-subj":n("inputPlaceholder")},i.a.createElement("div",{className:"eui-textTruncate"},t))}));Ne.displayName="InputPlaceholder";const Re=o()(r.EuiCode).withConfig({displayName:"StyledEuiCode",componentId:"sc-qp7srp-0"})(["padding-left:0;"]),Le=Object(a.memo)((({input:e,isValid:t=!0})=>{const n=Object(S.a)(k()),s=Object(a.useMemo)((()=>t?e:i.a.createElement(r.EuiTextColor,null,e)),[e,t]);return i.a.createElement(Re,{transparentBackground:!0,"data-test-subj":n("userCommandText")},s)}));Le.displayName="UserCommandInput";const ze=Object(a.memo)((()=>{const[e,t]=Object(a.useState)(!1),n=$(),s=Object(S.a)(k()),o=Object(a.useCallback)((()=>{t(!0)}),[]),l=Object(a.useCallback)((()=>{t(!1)}),[]),u=Object(a.useCallback)((()=>{n({type:"clearInputHistoryState"}),t(!1)}),[n]);return i.a.createElement(i.a.Fragment,null,e&&i.a.createElement(r.EuiConfirmModal,{title:b.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmTitle",{defaultMessage:"Clear input history"}),cancelButtonText:b.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:b.i18n.translate("xpack.securitySolution.commandInputClearHistory.confirmSubmitButton",{defaultMessage:"Clear"}),buttonColor:"danger",onCancel:l,onConfirm:u},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.commandInputClearHistory.confirmMessage",defaultMessage:"This action cannot be undone. Are you sure you wish to continue?"})),i.a.createElement(r.EuiFlexGroup,{responsive:!1,justifyContent:"flexEnd",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{size:"xs",tabIndex:-1,onClick:o,disabled:e,"data-test-subj":s("clearInputHistoryButton")},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.commandInputClearHistory.clearHistoryButtonLabel",defaultMessage:"Clear input history"})))))}));ze.displayName="CommandInputClearHistory";const Be=b.i18n.translate("xpack.securitySolution.commandInputHistory.noHistoryEmptyMessage",{defaultMessage:"No commands have been entered"}),qe=b.i18n.translate("xpack.securitySolution.commandInputHistory.filterPlaceholder",{defaultMessage:"Filter previously entered actions"}),$e=b.i18n.translate("xpack.securitySolution.commandInputHistory.noFilteredMatchesFoundMessage",{defaultMessage:"No entries found matching the filter entered"}),Ve=Object(a.memo)((()=>{const e=$(),t=oe().state.input.history,[n]=Object(a.useState)(ve()),s=Object(a.useRef)(!1),o=Object(S.a)(k()),l=Object(a.useMemo)((()=>t.map(((e,t)=>({label:e.display,key:e.id,data:e})))),[t]),u=Object(a.useMemo)((()=>({showIcons:!1,bordered:!0})),[]),c=Object(a.useMemo)((()=>({placeholder:qe,compressed:!0,fullWidth:!0})),[]),d=Object(a.useCallback)(((e,n)=>i.a.createElement(i.a.Fragment,null,e,i.a.createElement(r.EuiSpacer,{size:"s"}),t.length>0?n:i.a.createElement("div",{tabIndex:-1}))),[t.length]),p=Object(a.useCallback)((t=>{s.current=!0;const n=t.find((e=>"on"===e.checked));e({type:"updateInputPopoverState",payload:{show:void 0}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}),n&&e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:n.data.input,rightOfCursorText:""}}),e({type:"addFocusToKeyCapture"})}),[e]),m=Object(a.useCallback)((t=>{t&&e({type:"updateInputPlaceholderState",payload:{placeholder:t.data.input}})}),[e]),f=Object(a.useCallback)((e=>i.a.createElement(Le,{input:e.label})),[]);return Object(a.useEffect)((()=>(e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:"",rightOfCursorText:""}}),()=>{s.current||(e({type:"updateInputTextEnteredState",payload:{leftOfCursorText:n.leftOfCursorText,rightOfCursorText:n.rightOfCursorText}}),e({type:"updateInputPlaceholderState",payload:{placeholder:""}}))})),[e,s,n]),i.a.createElement("div",null,t.length>0&&i.a.createElement(ze,null),i.a.createElement(r.EuiSelectable,{options:l,onChange:p,onActiveOptionChange:m,renderOption:f,listProps:u,singleSelection:!0,searchable:!0,searchProps:c,emptyMessage:Be,noMatchesMessage:$e,"data-test-subj":o("inputHistorySelector"),"data-console-input-history":!0},d))}));Ve.displayName="CommandInputHistory";const Ue=Object(a.memo)((({children:e,width:t="92vw"})=>{const n=Object(S.a)(k()),s=xe(),o=void 0!==s,l=$(),u=Object(a.useMemo)((()=>({width:t,borderBottomLeftRadius:0,borderBottomRightRadius:0})),[t]),c=Object(a.useMemo)((()=>({clickOutsideDisables:!0})),[]),d=Object(a.useCallback)((()=>{l({type:"updateInputPopoverState",payload:{show:void 0}}),l({type:"addFocusToKeyCapture"})}),[l]);return Object(a.useEffect)((()=>{s||l({type:"addFocusToKeyCapture"})}),[l,s]),i.a.createElement(r.EuiPopover,{button:e,closePopover:d,isOpen:o,panelStyle:u,anchorPosition:"upLeft",hasArrow:!1,display:"block",attachToAnchor:!0,focusTrapProps:c,ownFocus:!1,"data-test-subj":n("inputPopover")},s&&i.a.createElement(r.EuiFocusTrap,{clickOutsideDisables:!0},"input-history"===s&&i.a.createElement(Ve,null)))}));Ue.displayName="InputAreaPopover";const He=o.a.div.withConfig({displayName:"CommandInputContainer",componentId:"sc-ujnhrt-0"})(["background-color:",";border-radius:",";padding:",";outline:",";&:focus-within{border-bottom:",";border-bottom-color:",";}&.error{border-bottom-color:",";}.textEntered{white-space:break-spaces;}.prompt{padding-right:1ch;}&.withPopover{border-top-left-radius:0;border-top-right-radius:0;}&.hasFocus{.cursor{background-color:",";animation:cursor-blink-animation 1s steps(5,start) infinite;-webkit-animation:cursor-blink-animation 1s steps(5,start) infinite;@keyframes cursor-blink-animation{to{visibility:hidden;}}@-webkit-keyframes cursor-blink-animation{to{visibility:hidden;}}}}"],(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderRadius),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderThick),(({theme:{eui:e}})=>e.euiColorPrimary),(({theme:{eui:e}})=>e.euiColorDanger),(({theme:{eui:e}})=>e.euiTextColor)),Ze=Object(a.memo)((({prompt:e="",focusRef:t,...n})=>{(()=>{const e=$(),t=Boolean(xe()),n=(()=>{const e=oe().state.input.parsedInput;return-1!==e.input.trimStart().indexOf(" ")?e.name:""})(),i=ee(),{leftOfCursorText:r}=ve(),s=Object(a.useMemo)((()=>{if(n)return i.find((e=>e.name===n))}),[n,i]);Object(a.useEffect)((()=>{if(n&&!t)if(s&&!0!==s.helpHidden){var a,i;const t=null!==(a=null==s?void 0:s.exampleInstruction)&&void 0!==a?a:"",n=null!==(i=null==s?void 0:s.exampleUsage)&&void 0!==i?i:"";let r=null!=t?t:"";if(n&&(r+=t?` ${b.i18n.translate("xpack.securitySolution.useInputHints.exampleInstructions",{defaultMessage:"Ex: [ {exampleUsage} ]",values:{exampleUsage:n}})}`:n),!r||!n){const e=g(s);e.length>0?r+=`${s.name} ${e}`:r+=Pe}e({type:"updateFooterContent",payload:{value:r}}),e({type:"setInputState",payload:{value:void 0}})}else e({type:"updateFooterContent",payload:{value:(o=n,b.i18n.translate("xpack.securitySolution.useInputHints.unknownCommand",{defaultMessage:"Unknown command {commandName}",values:{commandName:o}}))}}),e({type:"setInputState",payload:{value:"error"}});else e({type:"updateFooterContent",payload:{value:r||t?"":Fe}}),e({type:"setInputState",payload:{value:void 0}});var o}),[n,s,e,t,r])})();const s=Object(S.a)(k()),o=$(),{rightOfCursorText:l,leftOfCursorText:u,fullTextEntered:c,enteredCommand:d,parsedInput:p}=ve(),m=le(),f=!!xe(),[y,v]=Object(a.useState)(!1),[h,E]=Object(a.useState)(void 0),[x,j]=Object(a.useState)("94vw"),O=Object(a.useRef)(null),w=t||O,T=Object(a.useMemo)((()=>ye()({cmdInput:!0,hasFocus:y,error:"error"===m,withPopover:f})),[y,f,m]),I=Object(a.useMemo)((()=>0===c.trim().length),[c]),C=Object(a.useMemo)((()=>new entered_input_EnteredInput(u,l,p,d)),[d,u,p,l]),M=Object(a.useCallback)((({width:e})=>{e>0&&j(`${e}px`)}),[]),_=Object(a.useCallback)((()=>{E({input:C.getFullText(!0),enteredCommand:d,parsedInput:p})}),[d,p,C]),A=Object(a.useCallback)((e=>{v(e)}),[]),P=Object(a.useCallback)((e=>{w.current&&w.current.focus(),f&&o({type:"updateInputPopoverState",payload:{show:void 0}})}),[o,f,w]),F=Object(a.useCallback)((({value:e,selection:t,eventDetails:n})=>{const a=n.keyCode;if(38===a)return o({type:"removeFocusFromKeyCapture"}),void o({type:"updateInputPopoverState",payload:{show:"input-history"}});o({type:"updateInputTextEnteredState",payload:({leftOfCursorText:n,rightOfCursorText:i,enteredCommand:r,parsedInput:s})=>{const o=new entered_input_EnteredInput(n,i,s,r);switch(o.addValue(null!=e?e:"",t),a){case 8:o.backspaceChar(t);break;case 46:o.deleteChar(t);break;case 13:E({input:o.getFullText(!0),enteredCommand:r,parsedInput:s}),o.clear();break;case 37:o.moveCursorTo("left");break;case 39:o.moveCursorTo("right");break;case 36:o.moveCursorTo("home");break;case 35:o.moveCursorTo("end")}return{leftOfCursorText:o.getLeftOfCursorText(),rightOfCursorText:o.getRightOfCursorText(),argState:o.getArgState()}}})}),[o]);return Object(a.useEffect)((()=>{h&&(o({type:"executeCommand",payload:h}),E(void 0),o({type:"updateInputTextEnteredState",payload:{leftOfCursorText:"",rightOfCursorText:""}}))}),[h,o]),i.a.createElement(Ue,{width:x},i.a.createElement(r.EuiResizeObserver,{onResize:M},(a=>i.a.createElement(He,ge()({},n,{className:T,onClick:P,ref:a,"data-test-subj":s("cmdInput-container")}),i.a.createElement(r.EuiFlexGroup,{responsive:!1,alignItems:"center",gutterSize:"none"},e&&i.a.createElement(r.EuiFlexItem,{grow:!1,"data-test-subj":s("cmdInput-prompt")},i.a.createElement("span",{className:"eui-displayInlineBlock prompt"},e)),i.a.createElement(r.EuiFlexItem,{className:"textEntered"},i.a.createElement(Ae,{onCapture:F,onChangeFocus:A,focusRef:t},i.a.createElement(Ee,{leftOfCursor:C.getLeftOfCursorRenderingContent(),rightOfCursor:C.getRightOfCursorRenderingContent()})),i.a.createElement(Ne,null)),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{"data-test-subj":s("inputTextSubmitButton"),"aria-label":"submit-command",iconType:"playFilled",color:"primary",isDisabled:I,onClick:_})))))))}));Ze.displayName="CommandInput";var Ge=n(56),Qe=n.n(Ge);const We=Object(a.memo)((({size:e="s",color:t,children:n,"data-test-subj":a,className:s})=>{const{euiTheme:o}=Object(r.useEuiTheme)();return i.a.createElement(r.EuiText,{size:e,"data-test-subj":a,className:`font-family-code ${null!=s?s:""}`},i.a.createElement(r.EuiTextColor,{color:null!=t?t:o.colors.text},n))}));We.displayName="ConsoleText";const Ke=Object(a.memo)((()=>{const e=Object(S.a)(k());return i.a.createElement(We,{"data-test-subj":e("longRunningCommandHint")},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.longRunningCommandHintMessage",defaultMessage:"Hint: We are still working on this task. You may leave the console or place another command while this command is processing."}))}));Ke.displayName="LongRunningCommandHint";const Je=b.i18n.translate("xpack.securitySolution.commandExecutionResult.successTitle",{defaultMessage:"Action completed."}),Ye=b.i18n.translate("xpack.securitySolution.commandExecutionResult.failureTitle",{defaultMessage:"Action failed."}),Xe=b.i18n.translate("xpack.securitySolution.commandExecutionResult.pending",{defaultMessage:"Action pending."}),et=Object(a.memo)((({showAs:e="success",title:t,showTitle:n=!0,"data-test-subj":s,className:o,children:l})=>{const u=k(),c=Object(S.a)(null!=s?s:u),d=Object(a.useMemo)((()=>ye()({"eui-displayInlineBlock":"pending"===e,"font-family-code":!0,[o||"_"]:Boolean(o)})),[o,e]);return i.a.createElement(r.EuiPanel,{hasShadow:!1,paddingSize:"none",borderRadius:"none",color:"transparent",className:d,"data-test-subj":s||c("commandExecutionResult")},"pending"===e?i.a.createElement(We,null,null!=l?l:Xe):i.a.createElement(i.a.Fragment,null,n&&i.a.createElement(i.a.Fragment,null,i.a.createElement(We,{color:"success"===e?"success":"danger"},t||("success"===e?Je:Ye)),i.a.createElement(r.EuiSpacer,{size:"s"})),l))}));et.displayName="CommandExecutionResult";const tt=o.a.div.withConfig({displayName:"CommandOutputContainer",componentId:"sc-1wmcd6l-0"})(["position:relative;.busy-indicator{margin-left:0.5em;}"]),nt=Object(a.memo)((({item:{command:e,state:t,id:n,enteredAt:s,isValid:o}})=>{const l=$(),u=e.commandDefinition.RenderComponent,[c,d]=Object(a.useState)(!1),p=Object(a.useMemo)((()=>"pending"===t.status),[t.status]),m=Object(a.useCallback)((e=>{l({type:"updateCommandStatusState",payload:{id:n,value:e}})}),[l,n]),f=Object(a.useCallback)((e=>{l({type:"updateCommandStoreState",payload:{id:n,value:e}})}),[l,n]);return Object(a.useEffect)((()=>{let e;if(p&&!c){const t=Qe()().diff(Qe()(s),"seconds");if(t>=15)return void d(!0);e=setTimeout((()=>{d(!0)}),1e3*(15-t))}return()=>{e&&clearTimeout(e)}}),[s,c,p]),i.a.createElement(tt,null,i.a.createElement("div",null,i.a.createElement(Le,{input:e.inputDisplay,isValid:o})),i.a.createElement("div",{className:"noThemeOverrides"},i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(u,{command:e,store:t.store,status:t.status,setStore:f,setStatus:m,ResultComponent:et}),p&&i.a.createElement(r.EuiLoadingChart,{className:"busy-indicator",mono:!0}),p&&c&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(Ke,null))))}));nt.displayName="CommandExecutionOutput";const at=n(69).css`
  ${({theme:{eui:e}})=>e.euiSizeL}
`,it=o()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemHistoryItem",componentId:"sc-1249lql-0"})(["border-bottom:"," dashed ",";margin-bottom:",";padding-bottom:",";"],(({theme:{eui:e}})=>e.euiBorderWidthThin),(({theme:{eui:e}})=>e.euiBorderColor),at,at),rt=Object(a.memo)((({children:e})=>{const t=Object(S.a)(k());return i.a.createElement(it,{grow:!0,"data-test-subj":t("historyItem")},e)}));rt.displayName="HistoryItem";const st=Object(a.memo)((e=>{const t=oe().state.commandHistory,n=$(),s=Object(S.a)(k()),o=Object(a.useMemo)((()=>t.map((e=>i.a.createElement(rt,{key:e.id},i.a.createElement(nt,{item:e}))))),[t]);return Object(a.useEffect)((()=>{n({type:"scrollDown"})}),[n,t.length]),i.a.createElement(r.EuiFlexGroup,ge()({"data-test-subj":s("historyOutput")},e,{wrap:!0,direction:"column",alignItems:"stretch",responsive:!1,gutterSize:"none"}),o)}));st.displayName="HistoryOutput";const ot=o()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemNoPadding",componentId:"sc-ojfnk7-0"})(["padding:0 !important;"]),lt=Object(a.memo)((({headerContent:e,children:t})=>{const n=Object(S.a)(k("sidePanel"));return i.a.createElement(r.EuiFlexGroup,{direction:"column",responsive:!1,className:"eui-fullHeight",gutterSize:"none","data-test-subj":n()},e&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container","data-test-subj":n("header")},e),i.a.createElement(r.EuiHorizontalRule,{margin:"none"})),i.a.createElement(ot,{className:"eui-scrollBar eui-yScroll layout-container"},i.a.createElement("div",{"data-test-subj":n("body")},t)))}));lt.displayName="SidePanelContentLayout";const ut=o()(r.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-u9ickv-0"})(["padding-top:",";padding-right:",";"],(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingSmall)),ct=Object(a.memo)((()=>{const e=$(),t=ee(),n=Object(S.a)(k("sidePanel")),s=ce().show,o=Object(a.useCallback)((()=>{e({type:"showSidePanel",payload:{show:null}})}),[e]),l=Object(a.useMemo)((()=>"help"===s?i.a.createElement(i.a.Fragment,null,i.a.createElement(ut,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiTitle,{size:"s","data-test-subj":n("headerTitle")},i.a.createElement("h3",null,i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpTitle",defaultMessage:"Help"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonIcon,{"aria-label":"closeSidePanelIcon",iconType:"cross",color:"text",onClick:o,"data-test-subj":n("headerCloseButton")}))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(x.FormattedMessage,{id:"xpack.securitySolution.console.sidePanel.helpDescription",defaultMessage:"Use the add ({icon}) button to populate a response action to the text bar. Add additional parameters or comments as necessary.",values:{icon:i.a.createElement(r.EuiIcon,{type:"plusInCircle"})}}))):null),[s,n,o]),u=Object(a.useMemo)((()=>"help"===s?i.a.createElement("div",{"data-test-subj":n("helpContent")},i.a.createElement(X,{commands:t,display:"table"})):null),[t,n,s]);return s?i.a.createElement(lt,{headerContent:l},u):null}));ct.displayName="RightPanelContentManager";const dt=o()(r.EuiFlexItem).withConfig({displayName:"StyledEuiFlexItemWhite",componentId:"sc-hd3kv7-0"})(["background-color:"," !important;border-radius:",";box-shadow:0 "," "," ",";"],(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>`0 ${e.euiSizeXS} ${e.euiSizeXS} 0`),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>Object(r.transparentize)(e.euiShadowColor,.04))),pt=Object(a.memo)((e=>Boolean(ce().show)?i.a.createElement(dt,{grow:!1,className:"layout-rightPanel"},i.a.createElement(ct,null)):null));pt.displayName="SidePanelFlexItem";const mt=o.a.div.withConfig({displayName:"ConsoleWindow",componentId:"sc-d15gh7-0"})(["height:100%;background-color:",";border:",";border-radius:",";.layout{height:100%;width:100%;min-height:300px;min-width:300px;overflow:hidden;&-hideOverflow{overflow:hidden;}&-bottomBorder{border-bottom:"," solid ",";}&-container{padding:",";}&-header{background-color:",";border-bottom:1px solid ",";border-top-left-radius:",";border-top-right-radius:",";padding:"," "," "," ",";}&-commandInput{padding-top:",";padding-bottom:",";}&-footer{padding-top:0;padding-bottom:",";}&-rightPanel{width:35%;background-color:",";border-left:",";}&-historyOutput{overflow:auto;}&-historyViewport{height:100%;overflow-x:hidden;white-space:pre-wrap;}.euiFlexItem:not(.noMinWidth):not(.noThemeOverrides .euiFlexItem){min-width:0;}}.font-family-code{font-family:",";}.font-style-italic{font-style:italic;}"],(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSizeS),(({theme:{eui:e}})=>e.euiPageBackgroundColor),(({theme:{eui:e}})=>e.euiPanelPaddingModifiers.paddingMedium),(({theme:{eui:e}})=>e.euiColorEmptyShade),(({theme:{eui:e}})=>e.euiColorLightShade),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiBorderRadiusSmall),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSize),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiSizeXS),(({theme:{eui:e}})=>e.euiFormBackgroundColor),(({theme:{eui:e}})=>e.euiBorderThin),(({theme:{eui:e}})=>e.euiCodeFontFamily)),ft=Object(a.memo)((({prompt:e,commands:t,HelpComponent:n,TitleComponent:s,storagePrefix:o,managedKey:l,...u})=>{const d=Object(a.useRef)(null),p=Object(a.useRef)(null),m=Object(S.a)(u["data-test-subj"]),f=Object(c.c)(l),g=Object(a.useCallback)((()=>{setTimeout((()=>{d.current&&(d.current.scrollTop=d.current.scrollHeight)}),1)}),[]),b=Object(a.useCallback)((()=>{p.current&&p.current.focus()}),[]);return Object(a.useEffect)((()=>{f&&!f.isOpen||setTimeout(b,2)}),[b,f]),i.a.createElement(se,{commands:t,scrollToBottom:g,keyCapture:p,managedKey:l,HelpComponent:n,dataTestSubj:u["data-test-subj"],storagePrefix:o},i.a.createElement(mt,u,i.a.createElement(r.EuiFlexGroup,{className:"layout",gutterSize:"none",responsive:!1},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{direction:"column",className:"layout",gutterSize:"none",responsive:!1,"data-test-subj":m("mainPanel")},i.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-header"},i.a.createElement(me,{TitleComponent:s})),i.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-hideOverflow"},i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},i.a.createElement(r.EuiFlexItem,{className:"eui-fullHeight layout-hideOverflow"},i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none",responsive:!1,className:"layout-hideOverflow"},i.a.createElement(r.EuiFlexItem,{grow:!0,className:"layout-historyOutput"},i.a.createElement("div",{className:"layout-container layout-historyViewport eui-scrollBar eui-yScroll",ref:d},i.a.createElement(st,null))),i.a.createElement(r.EuiFlexItem,{onClick:b,grow:!1,className:"layout-container layout-commandInput","data-test-subj":m("mainPanel-inputArea")},i.a.createElement(Ze,{prompt:e,focusRef:p})),i.a.createElement(r.EuiFlexItem,{grow:!1,className:"layout-container layout-footer"},i.a.createElement(ue,null)))))))),i.a.createElement(pt,null))))}));ft.displayName="Console"},function(e,t,n){"use strict";n.d(t,"c",(function(){return Ze})),n.d(t,"a",(function(){return Ke})),n.d(t,"b",(function(){return Ye}));var a=n(17),i=n(2),r=n.n(i),s=n(47),o=n(52),l=n(231),u=n(130),c=n(9),d=n(930),p=n.n(d),m=n(49),f=n(44),g=n.n(f);const b=r.a.memo((({onClick:e,queriesLength:t})=>{const[n,o]=Object(i.useState)(!1),l=Object(i.useCallback)((()=>{e(),o(!0)}),[e]);return n?null:r.a.createElement(y,{color:"primary",paddingSize:"xs"},r.a.createElement(v,{direction:"row",alignItems:"center"},r.a.createElement(a.EuiFlexItem,{grow:!0,"data-test-subj":"osquery-investigation-guide-text"},r.a.createElement(a.EuiText,{size:"s"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.investigationGuideSuggestion",defaultMessage:"You have {queriesLength, plural, one {a query} other {queries}} in the investigation guide. Add {queriesLength, plural, one {it as a response action} other {them as response actions}}?",values:{queriesLength:t}}))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiButtonEmpty,{size:"m",color:"primary",onClick:l,"data-test-subj":"osqueryAddInvestigationGuideQueries"},r.a.createElement(a.EuiText,{size:"s"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.addButton",defaultMessage:"Add"}))))))}));b.displayName="OsqueryInvestigationGuidePanel";var y=g()(a.EuiPanel).withConfig({displayName:"_StyledEuiPanel",componentId:"sc-10xybv0-0"})(["",""],{marginBottom:"16px"}),v=g()(a.EuiFlexGroup).withConfig({displayName:"_StyledEuiFlexGroup",componentId:"sc-10xybv0-1"})(["",""],{padding:"0 24px"}),h=n(607),E=n(5),x=n(958),j=n(696),O=n(135),S=n(71);const k={label:E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commentLabel",{defaultMessage:"Comment (optional)"}),helpText:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.commentDescription",defaultMessage:"Leave a note that explains or describes the action. You can see your comment in the response actions history log."})},w=({basePath:e,disabled:t,readDefaultValueOnForm:n})=>r.a.createElement(o.UseField,{path:`${e}.comment`,readDefaultValueOnForm:n,config:k,isDisabled:t,component:S.TextField}),T=r.a.memo(w);var I=n(81),C=n(110);E.i18n.translate("xpack.securitySolution.endpoint.action.permissionDenied",{defaultMessage:"Permission denied"});const M=E.i18n.translate("xpack.securitySolution.endpoint.action.chooseFromTheList",{defaultMessage:"Choose action from the list"}),_=E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commentLearnMore",{defaultMessage:"Learn more"}),A=({name:e,isDisabled:t})=>{const{title:n,description:i,tooltip:s}=P(e),o=r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiTitle,{size:"xs"},r.a.createElement(a.EuiText,null,n)),r.a.createElement(a.EuiSpacer,{size:"xs"}),r.a.createElement(a.EuiText,null,i));return t?r.a.createElement(a.EuiToolTip,{position:"top",content:s},o):o},P=e=>"isolate"===e?{title:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.isolate",defaultMessage:"Isolate"}),description:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.isolateDescription",defaultMessage:"Quarantine a host from the network to prevent further spread of threats and limit potential damage"}),tooltip:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.isolateTooltip",defaultMessage:"Insufficient privileges to isolate hosts. Contact your Kibana administrator if you think you should have this permission."})}:{title:"",description:"",tooltip:""},F=r.a.memo(A);var D=n(420);const N=({basePath:e,disabled:t,readDefaultValueOnForm:n})=>{const{endpointPrivileges:l}=Object(O.a)(),[u]=Object(o.useFormData)(),{docLinks:{links:{securitySolution:{responseActions:d}}}}=Object(C.i)().services,p=Object(i.useMemo)((()=>D.a.map((e=>{const t=!Object(x.b)({commandName:Object(j.d)(e),privileges:l}),n=Object(c.map)(u.responseActions,"params.command").includes(e)||t;return{value:e,inputDisplay:e,dropdownDisplay:r.a.createElement(F,{name:e,isDisabled:t}),disabled:n,"data-test-subj":`command-type-${e}`}}))),[u.responseActions,l]);return r.a.createElement(o.UseField,{path:`${e}.command`,readDefaultValueOnForm:n,config:{label:E.i18n.translate("xpack.securitySolution.responseActions.endpoint.commandLabel",{defaultMessage:"Response action"}),helpText:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.commandDescription",defaultMessage:"Select an endpoint response action. The response action only runs on hosts with Elastic Defend installed. {docs}",values:{docs:r.a.createElement(a.EuiLink,{href:d,target:"_blank"},_)}}),validations:[{validator:I.fieldValidators.emptyField(E.i18n.translate("xpack.securitySolution.responseActions.endpoint.validations.commandIsRequiredErrorMessage",{defaultMessage:"Action is a required field."}))}]},component:S.SuperSelectField,isDisabled:t,componentProps:{euiFieldProps:{options:p,placeholder:M,"data-test-subj":"commandTypeField"}}})},R=r.a.memo(N),L=({basePath:e,editDisabled:t})=>{const[n]=Object(o.useFormData)(),i=Object(c.get)(n,`${e}.command`);return t?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(a.EuiCallOut,{color:"warning",iconType:"warning",title:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.privileges",defaultMessage:"Insufficient privileges"})},r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActions.endpoint.isolateTooltip",defaultMessage:"Insufficient privileges to isolate hosts. Contact your Kibana administrator if you think you should have this permission."}))),r.a.createElement(a.EuiSpacer,{size:"s"})):"isolate"===i?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"s"}),r.a.createElement(a.EuiCallOut,{color:"warning",iconType:"warning",title:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.cautionTitle",defaultMessage:"Proceed with caution"})},r.a.createElement(a.EuiText,{size:"xs"},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.responseActionsList.endpoint.cautionDescription",defaultMessage:"Only select this option if youâ€™re certain that you want to automatically block communication with other hosts on your network until you release this host."}))),r.a.createElement(a.EuiSpacer,{size:"s"})):r.a.createElement(r.a.Fragment,null)},z=r.a.memo(L),B=r.a.memo((e=>{const t=`${e.item.path}.params`;return r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{basePath:t,disabled:e.editDisabled,readDefaultValueOnForm:!e.item.isNew}),r.a.createElement(z,{basePath:t,editDisabled:e.editDisabled}),r.a.createElement(T,{basePath:t,disabled:e.editDisabled,readDefaultValueOnForm:!e.item.isNew}))}));B.displayName="EndpointResponseAction";var q=n(264),$=n(152);let V,U,H;!function(e){e.advancedInsights="advanced_insights",e.investigationGuide="investigation_guide",e.endpointHostManagement="endpoint_host_management",e.endpointPolicyManagement="endpoint_policy_management",e.endpointPolicyProtections="endpoint_policy_protections",e.endpointArtifactManagement="endpoint_artifact_management",e.endpointResponseActions="endpoint_response_actions",e.threatIntelligence="threat-intelligence",e.osqueryAutomatedResponseActions="osquery_automated_response_actions",e.endpointExceptions="endpointExceptions",e.externalRuleActions="external_rule_actions"}(V||(V={})),function(e){e.casesConnectors="cases_connectors"}(U||(U={})),function(e){e.assistant="assistant"}(H||(H={}));const Z={...V,...U,...H};let G,Q,W;Object.freeze(Object.values(Z)),function(e){e.endpointList="endpointListSubFeature",e.endpointExceptions="endpointExceptionsSubFeature",e.trustedApplications="trustedApplicationsSubFeature",e.hostIsolationExceptions="hostIsolationExceptionsSubFeature",e.blocklist="blocklistSubFeature",e.eventFilters="eventFiltersSubFeature",e.policyManagement="policyManagementSubFeature",e.responseActionsHistory="responseActionsHistorySubFeature",e.hostIsolation="hostIsolationSubFeature",e.processOperations="processOperationsSubFeature",e.fileOperations="fileOperationsSubFeature",e.executeAction="executeActionSubFeature"}(G||(G={})),function(e){e.deleteCases="deleteCasesSubFeature",e.casesSettings="casesSettingsSubFeature"}(Q||(Q={})),function(e){e.createConversation="createConversationSubFeature"}(W||(W={}));var K=n(317);const J=r.a.memo((({field:e})=>{const{clearErrors:t,value:n,setValue:a,path:s}=e,{osquery:l}=Object(C.i)().services,u=Object(o.useFormContext)(),d=Object(i.useMemo)((()=>null==l?void 0:l.OsqueryResponseActionTypeForm),[null==l?void 0:l.OsqueryResponseActionTypeForm]),p=Object(i.useCallback)((e=>{if(Object(c.isEmpty)(e))t();else{const t=Object(c.map)(e,(e=>({message:e.message})));u.setFieldErrors(s,t)}}),[t,u,s]);return r.a.createElement(d,{defaultValues:n,onError:p,onChange:a})}));J.displayName="ResponseActionFormField";var Y=n(146),X=n(1304);const ee=()=>r.a.createElement(r.a.Fragment,null),te=r.a.memo((e=>{const{osquery:t,application:n}=Object(C.i)().services,i=Object($.b)(),o=Object(K.a)(Z.osqueryAutomatedResponseActions);if(t){var l,u,c,d,p,m,f,g;const{disabled:b,permissionDenied:y}=t.fetchInstallationStatus(),v=!(null!=n&&null!==(l=n.capabilities)&&void 0!==l&&null!==(u=l.osquery)&&void 0!==u&&u.writeLiveQueries||null!=n&&null!==(c=n.capabilities)&&void 0!==c&&null!==(d=c.osquery)&&void 0!==d&&d.runSavedQueries&&(null!=n&&null!==(p=n.capabilities)&&void 0!==p&&null!==(m=p.osquery)&&void 0!==m&&m.readSavedQueries||null!=n&&null!==(f=n.capabilities)&&void 0!==f&&null!==(g=f.osquery)&&void 0!==g&&g.readPacks));if(o)return r.a.createElement(o,null);if(y||v)return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.e,{path:`${e.item.path}.params`,component:ee}),r.a.createElement(a.EuiEmptyPrompt,{title:r.a.createElement("h2",null,X.b),titleSize:"xs",iconType:"logoOsquery",body:r.a.createElement("p",null,r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.osquery.action.missingPrivileges",defaultMessage:"To access this page, ask your administrator for {osquery} Kibana privileges.",values:{osquery:r.a.createElement(a.EuiCode,null,"osquery")}}))}));if(b)return r.a.createElement(r.a.Fragment,null,r.a.createElement(Y.e,{path:`${e.item.path}.params`,component:ee}),r.a.createElement(a.EuiEmptyPrompt,{iconType:"logoOsquery",title:r.a.createElement("h2",null,X.c),titleSize:"xs",body:r.a.createElement("p",null,X.a)}));if(i())return r.a.createElement(Y.e,{path:`${e.item.path}.params`,component:J,readDefaultValueOnForm:!e.item.isNew})}return null}));te.displayName="OsqueryResponseAction";const ne=e=>{switch(e){case q.b[".osquery"]:return{logo:"logoOsquery",name:"Osquery"};case q.b[".endpoint"]:return{logo:"logoSecurity",name:"Endpoint Security"};default:return{logo:"logoOsquery",name:"Osquery"}}},ae=g()(a.EuiAccordion).withConfig({displayName:"StyledEuiAccordion",componentId:"sc-16pdpi-0"})(["background:",";.euiAccordion__buttonContent{padding:",";}"],(({theme:e})=>e.eui.euiColorLightestShade),(({theme:e})=>e.eui.euiSizeM)),ie=({item:e,onDeleteAction:t})=>{var n;const[s,o]=Object(i.useState)(!0),[l]=Object(Y.m)(),u=Object(c.get)(l,e.path),d=null!==(n=(e=>{var t;const n=Object(O.a)().endpointPrivileges;if(".endpoint"===(null==e?void 0:e.actionTypeId)&&null!=e&&null!==(t=e.params)&&void 0!==t&&t.command)return!Object(x.b)({commandName:Object(j.d)(e.params.command),privileges:n})})(u))&&void 0!==n&&n,p=Object(i.useMemo)((()=>(null==u?void 0:u.actionTypeId)===q.b[".osquery"]?r.a.createElement(te,{item:e}):(null==u?void 0:u.actionTypeId)===q.b[".endpoint"]?r.a.createElement(B,{item:e,editDisabled:d}):null),[null==u?void 0:u.actionTypeId,d,e]),m=Object(i.useCallback)((()=>{t(e.id)}),[e,t]),f=Object(i.useMemo)((()=>{const{logo:e,name:t}=ne(null==u?void 0:u.actionTypeId);return r.a.createElement(a.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiIcon,{type:e,size:"m"})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,null,t)))}),[null==u?void 0:u.actionTypeId]),g=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonIcon,{"data-test-subj":"remove-response-action",iconType:"minusInCircle",color:"danger",className:"actAccordionActionForm__extraAction","aria-label":E.i18n.translate("xpack.securitySolution.actionTypeForm.accordion.deleteIconAriaLabel",{defaultMessage:"Delete"}),disabled:d,onClick:m})),[d,m]);return r.a.createElement(ae,{initialIsOpen:!0,key:e.id,id:e.id.toString(),onToggle:o,paddingSize:"l","data-test-subj":"alertActionAccordion",buttonContent:f,extraAction:g},p)};ie.displayName="ResponseActionTypeForm";const re=r.a.memo(ie);var se=n(461),oe=n.n(se),le=n(1234),ue=n.n(le),ce=n(411);const de=()=>r.a.createElement(r.a.Fragment,null),pe=r.a.memo((({items:e,removeItem:t})=>{const{detailName:n}=Object(m.useParams)(),{data:s}=Object(h.f)(n),o=Object(i.useMemo)((()=>null!=s&&s.note?(e=>{const t=oe()().use([[ue.a,{}],ce.a]).parse(e);return Object(c.filter)(null==t?void 0:t.children,["type","osquery"])})(s.note):[]),[null==s?void 0:s.note]),l=Object(Y.l)(),[u]=Object(Y.m)(),d=Object(i.useCallback)((()=>{const e=((e,t=[])=>Object(c.reduce)(e,((e,{configuration:t})=>(e.responseActions.push({actionTypeId:q.b[".osquery"],params:{savedQueryId:void 0,packId:void 0,queries:void 0,query:t.query,ecsMapping:t.ecs_mapping}}),e)),{responseActions:t}))(o,u.responseActions);l.updateFieldValues(e)}),[l,null==u?void 0:u.responseActions,o]);return r.a.createElement("div",{"data-test-subj":"response-actions-list"},e.map(((e,n)=>r.a.createElement("div",{key:e.id,"data-test-subj":`response-actions-list-item-${n}`},r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(re,{item:e,onDeleteAction:t}),r.a.createElement(Y.e,{path:`${e.path}.actionTypeId`,component:de})))),r.a.createElement(a.EuiSpacer,{size:"m"}),o.length?r.a.createElement(b,{onClick:d,queriesLength:o.length}):null)}));pe.displayName="ResponseActionsList";var me=n(18);const fe=E.i18n.translate("xpack.securitySolution.actionForm.platinumOnly",{defaultMessage:"This functionality is available only in Platinum and above."}),ge=({supportedResponseActionTypes:e,addActionType:t,updateActionTypeId:n})=>{const[o]=Object(Y.m)(),[l,u]=Object(i.useState)(o.responseActions&&o.responseActions.length>0),c=Object(me.b)().isPlatinumPlus(),d=Object(i.useCallback)((e=>{u(!1),t(),n(e.id)}),[t,n]),p=Object(i.useMemo)((()=>r.a.createElement(a.EuiFlexGroup,{direction:"row"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(a.EuiButton,{size:"s","data-test-subj":"addAlertActionButton",onClick:()=>u(!1)},r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.sections.actionForm.addResponseActionButtonLabel",defaultMessage:"Add response action"}))))),[]),m=Object(i.useMemo)((()=>(null==e?void 0:e.length)&&e.map((function(e,t){const n=r.a.createElement(a.EuiKeyPadMenuItem,{key:t,isDisabled:!c||e.disabled,"data-test-subj":`${e.name}-response-action-type-selection-option`,label:e.name,betaBadgeTooltipContent:"should be visible",onClick:()=>d(e)},r.a.createElement(a.EuiIcon,{size:"xl",type:e.iconClass}));return c?r.a.createElement(a.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},n):r.a.createElement(a.EuiToolTip,{position:"top",content:fe},r.a.createElement(a.EuiFlexItem,{grow:!1,key:`keypad-${e.id}`},n))}))),[d,c,e]);return null!=e&&e.length?r.a.createElement(r.a.Fragment,null,l?p:r.a.createElement(a.EuiFlexGroup,{direction:"row"},m)):r.a.createElement(r.a.Fragment,null)},be=r.a.memo((({items:e,removeItem:t,supportedResponseActionTypes:n,addItem:a})=>{const s=Object(i.useRef)(null),o=Object(i.useCallback)((e=>{s.current=e}),[]),l=Object(Y.l)(),u=Object(i.useMemo)((()=>r.a.createElement(ge,{supportedResponseActionTypes:n,addActionType:a,updateActionTypeId:o})),[a,o,n]);return Object(i.useEffect)((()=>{if(s.current){const t=`responseActions[${e.length-1}].actionTypeId`;l.setFieldValue(t,s.current),s.current=null}}),[l,e.length]),r.a.createElement("div",{"data-test-subj":"response-actions-wrapper"},r.a.createElement(pe,{items:e,removeItem:t}),u)}));be.displayName="ResponseActionsWrapper";var ye=n(943);const ve=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexItem,{grow:!1,"data-test-subj":"response-actions-header"},r.a.createElement(a.EuiTitle,{size:"s"},r.a.createElement("h4",null,r.a.createElement(s.FormattedMessage,{defaultMessage:"Response Actions",id:"xpack.securitySolution.actionForm.responseActionSectionsDescription"})))),r.a.createElement(a.EuiSpacer,{size:"m"}),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(s.FormattedMessage,{defaultMessage:"Response actions are run on each rule execution.",id:"xpack.securitySolution.actionForm.responseActionSectionsTitle"})),r.a.createElement(a.EuiSpacer,{size:"m"})),he=[{id:q.b[".osquery"],name:"Osquery",iconClass:"logoOsquery"},{id:q.b[".endpoint"],name:"Endpoint Security",iconClass:"logoSecurity"}],Ee=({items:e,addItem:t,removeItem:n,form:s})=>{const o=(()=>{const[e,t]=Object(i.useState)(),n=Object(u.a)("endpointResponseActionsEnabled"),{canIsolateHost:a}=Object(O.a)().endpointPrivileges,r=Object(i.useMemo)((()=>({endpoint:n})),[n]),s=Object(i.useMemo)((()=>({endpoint:a})),[a]);return Object(i.useEffect)((()=>{const e=((e,t,n)=>e.reduce(((e,a)=>{const i=a.id===q.b[".endpoint"];return!t.endpoint&&i?e:q.a.options.includes(a.id)?[...e,{...a,disabled:i?!n.endpoint:void 0}]:e}),[]))(he,r,s);t(e)}),[n,r,s]),e})(),[l,d]=Object(i.useState)(null),m=s.getFields(),f=s.getErrors(),g=Object(i.useMemo)((()=>null!=o&&o.length?r.a.createElement(be,{items:e,removeItem:n,supportedResponseActionTypes:o,addItem:t}):null),[t,e,n,o]);return Object(i.useEffect)((()=>{d((()=>{const t=Object(c.reduce)(Object(c.map)(e,"path"),((e,t)=>{var n,a;return null!==(n=m[`${t}.params`])&&void 0!==n&&null!==(a=n.errors)&&void 0!==a&&a.length?(e.push({type:Object(c.upperFirst)(m[`${t}.actionTypeId`].value.substring(1)),errors:Object(c.map)(m[`${t}.params`].errors,"message")}),e):e}),[]);return Object(c.reduce)(t,((e,t)=>(e.push(`**${t.type}:**\n`),t.errors.forEach((t=>{e.push(`- ${t}\n`)})),e)),[]).join("\n")}))}),[m,f,e]),r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{size:"xxl","data-test-subj":"response-actions-form"}),r.a.createElement(ve,null),null!=l&&l.length?r.a.createElement(r.a.Fragment,null,r.a.createElement("p",null,r.a.createElement(a.EuiCallOut,{"data-test-subj":"response-actions-error",title:ye.b,color:"danger",iconType:"warning"},r.a.createElement(p.a,null,l))),r.a.createElement(a.EuiSpacer,null)):null,g)};var xe=n(944),je=n(1114),Oe=n(50),Se=n(72),ke=n(117),we=n(163);const Te=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.connectorsFetchError",{defaultMessage:"Failed to fetch connectors"}),Ie=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.connectorTypesFetchError",{defaultMessage:"Failed to fetch connector types"}),Ce=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.actions.actionsFetchErrorDescription",{defaultMessage:"Viewing actions is not available"}),Me=E.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.noReadActionsPrivileges",{defaultMessage:'Cannot create rule actions. You do not have "Read" permissions for the "Actions" plugin.'}),_e=E.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.docsLinkText",{defaultMessage:"Learn more"});function Ae(){const{docLinks:{links:{securitySolution:{manageDetectionRules:e}}}}=Object(C.i)().services,t=`${e}#edit-rules-settings`;return r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.createRule.stepRuleActions.snoozeDescription",defaultMessage:"Choose when to perform actions or snooze them. Notifications are not created for snoozed actions. {docs}.",values:{docs:r.a.createElement(a.EuiLink,{href:t,target:"_blank"},_e)}})}const Pe=r.a.createElement(Ae,null),Fe=(E.i18n.translate("xpack.securitySolution.detectionEngine.actionsSectionLabel",{defaultMessage:"Actions"}),E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.notificationActions",{defaultMessage:"Notification actions"})),De=E.i18n.translate("xpack.securitySolution.detectionEngine.ruleDetails.responseActions",{defaultMessage:"Response actions"}),Ne=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.forEachOption",{defaultMessage:"For each alert. Per rule run."}),Re=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.summaryOption",{defaultMessage:"Summary of alerts. Per rule run."}),Le=E.i18n.translate("xpack.securitySolution.detectionEngine.actionNotifyWhen.periodically",{defaultMessage:"Periodically"});var ze=n(1082);function Be({ruleId:e}){return r.a.createElement(a.EuiFlexGroup,{direction:"column",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,{size:"s"},Pe)),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(ze.a,{ruleId:e,showTooltipInline:!0})))}var qe=n(471);const $e=({children:e})=>r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,{size:"xs",color:"subdued"},e)),Ve=({frequency:e})=>{if(!e)return null;if(!e.summary)return r.a.createElement($e,null,Ne);if("onActiveAlert"===e.notifyWhen)return r.a.createElement($e,null,Re);if(!e.throttle)return null;const{unit:t,value:n}=Object(qe.g)(e.throttle),a={s:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEverySecondsLabel",defaultMessage:"Once {secondsCount, plural, one {a} other {in every}} {secondsCount, plural, one {second} other {# seconds}}",values:{secondsCount:n}}),m:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryMinutesLabel",defaultMessage:"Once {minutesCount, plural, one {a} other {in every}} {minutesCount, plural, one {minute} other {# minutes}}",values:{minutesCount:n}}),h:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryHoursLabel",defaultMessage:"Once {hoursCount, plural, one {an} other {in every}} {hoursCount, plural, one {hour} other {# hours}}",values:{hoursCount:n}}),d:r.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.onceInEveryDaysLabel",defaultMessage:"Once {daysCount, plural, one {a} other {in every}} {daysCount, plural, one {day} other {# days}}",values:{daysCount:n}})};return r.a.createElement($e,null,a[t]||Le)};function Ue({action:e,connectorTypes:t,connectors:n,actionTypeRegistry:i}){var s,o,l,u;const c=t.find((({id:t})=>t===e.actionTypeId)),d=null!==(s=null==c?void 0:c.name)&&void 0!==s?s:"",p=n.find((({id:t})=>t===e.id)),m=null!==(o=null==p?void 0:p.name)&&void 0!==o?o:"",f=null!==(l=null===(u=i.get(e.actionTypeId))||void 0===u?void 0:u.iconClass)&&void 0!==l?l:"apps";return r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",component:"span",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{content:d,anchorClassName:"eui-textTruncate"},r.a.createElement(a.EuiIcon,{size:"m",type:f}))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,{size:"s"},m),r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"xs",component:"span",responsive:!1},r.a.createElement(a.EuiSpacer,{size:"xs"}),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiIcon,{size:"s",type:"bell",color:"subdued"})),r.a.createElement(Ve,{frequency:e.frequency})))))}function He({action:e}){const{name:t,logo:n}=ne(e.actionTypeId);return r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"s",component:"span",responsive:!1},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{content:t,anchorClassName:"eui-textTruncate"},r.a.createElement(a.EuiIcon,{size:"m",type:n}))),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(a.EuiText,{size:"s"},t))))}const Ze={enabled:!0,actions:[],responseActions:[],kibanaSiemAppUrl:""},Ge=()=>r.a.createElement(r.a.Fragment,null),Qe=()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiTitle,{size:"s"},r.a.createElement("h4",null,r.a.createElement(s.FormattedMessage,{defaultMessage:"Actions",id:"xpack.securitySolution.detectionEngine.rule.editRule.actionSectionsTitle"}))),r.a.createElement(a.EuiSpacer,{size:"l"})),We=({ruleId:e,isUpdateView:t=!1,actionMessageParams:n,summaryActionMessageParams:s,ruleType:c,form:d})=>{const{services:{application:p}}=Object(C.i)(),m=Object(u.a)("responseActionsEnabled"),f=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,null),r.a.createElement(Y.e,{path:"actions",component:je.a,componentProps:{messageVariables:n,summaryMessageVariables:s}}))),[n,s]),g=Object(i.useMemo)((()=>Object(l.f)(c)?r.a.createElement(o.UseArray,{path:"responseActions",initialNumberOfItems:0},Ee):null),[c]),b=Object(i.useMemo)((()=>p.capabilities.actions.show?r.a.createElement(r.a.Fragment,null,r.a.createElement(Qe,null),e&&r.a.createElement(Be,{ruleId:e}),f,m&&g,r.a.createElement(Y.e,{path:"kibanaSiemAppUrl",component:Ge}),r.a.createElement(Y.e,{path:"enabled",component:Ge})):r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiText,null,Me))),[e,p.capabilities.actions.show,f,g,m]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(xe.a,{addPadding:!t},r.a.createElement(Y.c,{form:d,"data-test-subj":"stepRuleActions"},r.a.createElement(a.EuiForm,null,b))))},Ke=Object(i.memo)(We),Je=({addPadding:e,defaultValues:t})=>{const{services:{triggersActionsUi:n}}=Object(C.i)(),i=n.actionTypeRegistry,{data:s}=(()=>{const{addError:e}=Object(ke.a)();return Object(Oe.useQuery)(["GET",Se.BASE_ACTION_API_PATH,"connectors"],(({signal:e})=>Object(we.f)(e)),{onError:t=>{e(t,{title:Te,toastMessage:Ce})}})})(),{data:o}=(()=>{const{addError:e}=Object(ke.a)();return Object(Oe.useQuery)(["GET",Se.BASE_ACTION_API_PATH,"connector_types","siem"],(({signal:e})=>Object(we.e)(e)),{onError:t=>{e(t,{title:Ie,toastMessage:Ce})}})})(),l=t.actions,u=t.responseActions||[];if(!(l.length>0||u.length>0)||!s||!o)return null;const c=l.length>0&&u.length>0;return r.a.createElement(xe.a,{addPadding:e},l.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiText,{size:"m"},Fe),r.a.createElement(a.EuiSpacer,{size:"s"})),l.map(((e,t)=>{const n=t===l.length-1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ue,{action:e,connectorTypes:o,connectors:s,actionTypeRegistry:i,key:e.id}),!n&&r.a.createElement(a.EuiSpacer,{size:"s"}))})),c&&r.a.createElement(a.EuiSpacer,{size:"l"}),u.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiText,{size:"m"},De),r.a.createElement(a.EuiSpacer,{size:"s"})),u.map(((e,t)=>{const n=t===u.length-1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(He,{action:e,key:`${e.actionTypeId}-${t}`}),!n&&r.a.createElement(a.EuiSpacer,{size:"s"}))})))},Ye=Object(i.memo)(Je)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return ne}));var a=n(17),i=n(2),r=n.n(i),s=n(44),o=n.n(s),l=n(45),u=n(51),c=n(53),d=n(54),p=n(147),m=n(4),f=n(174),g=n(170),b=n(298),y=n(297),v=n(164),h=n(383),E=n(159),x=n(525),j=n(110),O=n(726),S=n(5),k=n(62),w=n(265),T=n(283),I=n(226),C=n(351),M=n(293);const _=r.a.memo((({chartHeight:e=174,data:t,from:n,legendItems:s,legendPosition:o=k.Position.Right,legendMinWidth:l,loading:u,showLegend:c,to:d,updateDateRange:p})=>{const{baseTheme:m,theme:f}=Object(w.i)(),g=Object(i.useMemo)((()=>["100%",e]),[e]),b=Object(i.useMemo)((()=>["y"]),[]),y=Object(i.useMemo)((()=>[e=>Object(I.a)(e.g)?e.g:M.c]),[]),v=Object(i.useMemo)((()=>Object(T.a)([n,d])),[n,d]);return r.a.createElement(r.a.Fragment,null,u&&r.a.createElement(a.EuiProgress,{"data-test-subj":"loadingPanelAlertsHistogram",size:"xs",position:"absolute",color:"accent"}),r.a.createElement(a.EuiFlexGroup,{gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(k.Chart,{size:g},r.a.createElement(k.Settings,{legendPosition:o,onBrushEnd:p,showLegend:c&&0===s.length,showLegendExtra:c,theme:f,baseTheme:m,locale:S.i18n.getLocale()}),r.a.createElement(k.Axis,{id:"alertsHistogramAxisX",position:k.Position.Bottom,tickFormat:v}),r.a.createElement(k.Axis,{id:"alertsHistogramAxisY",position:k.Position.Left}),r.a.createElement(k.HistogramBarSeries,{id:"alertsHistogram",xScaleType:k.ScaleType.Time,yScaleType:k.ScaleType.Linear,xAccessor:"x",yAccessors:b,splitSeriesAccessors:y,data:t}))),r.a.createElement(a.EuiFlexItem,{grow:!1},s.length>0&&r.a.createElement(C.a,{legendItems:s,height:e,minWidth:l}))))}));_.displayName="AlertsHistogram";const A=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.headerTitle",{defaultMessage:"Trend"}),P=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.notAvailableTooltip",{defaultMessage:"Not available for trend view"}),F=S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.viewAlertsButtonLabel",{defaultMessage:"View alerts"}),D=(e,t,n)=>S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.showingAlertsTitle",{values:{totalAlertsFormatted:e,totalAlerts:t,modifier:n},defaultMessage:"Showing: {modifier}{totalAlertsFormatted} {totalAlerts, plural, =1 {alert} other {alerts}}"});var N=n(137),R=n(129),L=n(432),z=n(528),B=n(398),q=n(160),$=n(399),V=n(130);const U=Object(u.v4)(),H=(e="kibana.alert.rule.name",t)=>({title:"Alerts",description:"",visualizationType:"lnsXY",state:{visualization:{title:"Empty XY chart",legend:{isVisible:!0,position:"right",legendSize:"xlarge"},valueLabels:"hide",preferredSeriesType:"bar_stacked",layers:[{layerId:U,accessors:["e09e0380-0740-4105-becc-0a4ca12e3944"],position:"top",seriesType:"bar_stacked",showGridlines:!1,layerType:"data",xAccessor:"aac9d7d0-13a3-480a-892b-08207a787926",splitAccessor:"34919782-4546-43a5-b668-06ac934d3acd"}],yRightExtent:{mode:"full"},yLeftExtent:{mode:"full"},axisTitlesVisibilitySettings:{x:!1,yLeft:!1,yRight:!0},valuesInLegend:!0},query:{query:"",language:"kuery"},filters:null!=t&&t.filters?t.filters:[],datasourceStates:{formBased:{layers:{[U]:{columns:{"aac9d7d0-13a3-480a-892b-08207a787926":{label:"@timestamp",dataType:"date",operationType:"date_histogram",sourceField:"@timestamp",isBucketed:!0,scale:"interval",params:{interval:"auto"}},"e09e0380-0740-4105-becc-0a4ca12e3944":{label:"Count of records",dataType:"number",operationType:"count",isBucketed:!1,scale:"ratio",sourceField:"___records___"},"34919782-4546-43a5-b668-06ac934d3acd":{label:`Top values of ${e}`,dataType:"string",operationType:"terms",scale:"ordinal",sourceField:e,isBucketed:!0,params:{size:1e3,orderBy:{type:"column",columnId:"e09e0380-0740-4105-becc-0a4ca12e3944"},orderDirection:"desc",otherBucket:!0,missingBucket:!1,parentFormat:{id:"terms"},secondaryFields:[]}}},columnOrder:["34919782-4546-43a5-b668-06ac934d3acd","aac9d7d0-13a3-480a-892b-08207a787926","e09e0380-0740-4105-becc-0a4ca12e3944"],incompleteColumns:{}}}}},internalReferences:[],adHocDataViews:{}},references:[{type:"index-pattern",id:"{dataViewId}",name:`indexpattern-datasource-layer-${U}`}]});var Z=n(116),G=n(330),Q=n(61),W=n.n(Q),K=n(347);const J={value:0,relation:"eq"},Y="detections-histogram",X=o()(a.EuiFlexItem).withConfig({displayName:"ViewAlertsFlexItem",componentId:"sc-tvqkga-0"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeL)),ee=o()(a.EuiFlexItem).withConfig({displayName:"OptionsFlexItem",componentId:"sc-tvqkga-1"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),te=[],ne=Object(i.memo)((({alignHeader:e,chartHeight:t=155,chartOptionsContextMenu:n,combinedQueries:s,comboboxRef:o,defaultStackByOption:k=L.a,extraActions:w,filters:T,headerChildren:I,inspectTitle:C,legendPosition:M="right",onFieldSelected:U,onlyField:Q,paddingSize:ne="m",panelHeight:ae=L.d,query:ie,runtimeMappings:re,setComboboxInputRef:se,showCountsInLegend:oe=!1,showGroupByPlaceholder:le=!1,showLegend:ue=!0,showLinkToAlerts:ce=!1,showStackBy:de=!0,showTotalAlertsCount:pe=!1,signalIndexName:me,stackByLabel:fe,stackByWidth:ge,timelineId:be,title:ye=A,titleSize:ve="m",updateDateRange:he,hideQueryToggle:Ee=!1,isExpanded:xe,setIsExpanded:je})=>{var Oe;const{to:Se,from:ke,deleteQuery:we,setQuery:Te}=Object(p.a)(),Ie=Object(i.useMemo)((()=>`${Y}-${Object(u.v4)()}`),[]),Ce=`alerts-trend-embeddable-${Ie}`,[Me,_e]=Object(i.useState)(!0),[Ae,Pe]=Object(i.useState)(!1),[Fe,De]=Object(i.useState)(J),[Ne,Re]=Object(i.useState)(null==Q?k:Q),Le=Object(V.a)("chartEmbeddablesEnabled"),ze=Object(V.a)("alertsPageChartsEnabled"),Be=Object(i.useCallback)((e=>{Re(e),null!=U&&U(e)}),[U]);Object(i.useEffect)((()=>{Re(null==Q?k:Q)}),[k,Q]);const{toggleStatus:qe,setToggleStatus:$e}=Object(q.a)(Y),Ve=Object(i.useCallback)((e=>{ze&&void 0!==je?je(e):$e(e)}),[$e,je,ze]),Ue=Object(i.useMemo)((()=>ze&&void 0!==je?!xe:!qe),[ze,je,xe,qe]),He=Object(i.useMemo)((()=>({from:ke,to:Se})),[ke,Se]),{loading:Ze,data:Ge,setQuery:Qe,response:We,request:Ke,refetch:Je}=Object(b.a)({query:Object(O.d)(Ne,ke,Se,Object(O.a)(s),re),indexName:me,skip:Ue||Le,queryName:y.a.HISTOGRAM}),Ye=Object(j.i)(),{navigateToApp:Xe}=Ye.services.application,{formatUrl:et,search:tt}=Object(v.l)(R.a.alerts),nt=(({totalAlertsObj:e,visualizationId:t,isChartEmbeddablesEnabled:n})=>{const[a]=Object(j.o)(m.P),r=Object(K.a)({visualizationId:t}),s=Object(i.useMemo)((()=>D(W()(e.value).format(a),e.value,"gte"===e.relation?">":"lte"===e.relation?"<":"")),[e.value,e.relation,a]),o=Object(i.useMemo)((()=>{const e=null!=r?r[0].hits.total:0;return D(W()(e).format(a),e,"")}),[a,r]);return n?o:s})({totalAlertsObj:Fe,visualizationId:Ce,isChartEmbeddablesEnabled:Le}),at=Object(i.useCallback)((e=>{e.preventDefault(),Xe(m.l,{deepLinkId:R.a.alerts,path:Object(v.c)(tt)})}),[Xe,tt]),it=Object(i.useMemo)((()=>Object(O.c)(Ge)),[Ge]),rt=Object(i.useMemo)((()=>{var e,t;return ue&&null!=(null==Ge||null===(e=Ge.aggregations)||void 0===e||null===(t=e.alertsByGrouping)||void 0===t?void 0:t.buckets)?Ge.aggregations.alertsByGrouping.buckets.map(((e,t)=>{var n;return{color:t<h.a.length?h.a[t]:void 0,count:oe?e.doc_count:void 0,dataProviderId:Object(f.i)(`draggable-legend-item-${Object(u.v4)()}-${Ne}-${e.key}`),field:Ne,timelineId:be,value:null!==(n=null==e?void 0:e.key_as_string)&&void 0!==n?n:e.key}})):te}),[null==Ge||null===(Oe=Ge.aggregations)||void 0===Oe?void 0:Oe.alertsByGrouping.buckets,Ne,oe,ue,be]);Object(i.useEffect)((()=>{let e=!1;return e||Object(O.f)({isInitialLoading:Me,isLoadingAlerts:Ze})||_e(!1),()=>{e=!0}}),[Me,Ze,_e]),Object(B.a)({deleteQuery:we,loading:Ze,refetch:Je,request:Ke,response:We,setQuery:Te,uniqueQueryId:Ie}),Object(i.useEffect)((()=>{var e;De(null!==(e=null==Ge?void 0:Ge.hits.total)&&void 0!==e?e:{value:0,relation:"eq"})}),[Ge]),Object(i.useEffect)((()=>{try{let t=null;var e;t=null!=s?Object(O.e)(s):Object(c.buildEsQuery)(void 0,null!=ie?[ie]:[],null!==(e=null==T?void 0:T.filter((e=>!1===e.meta.disabled)))&&void 0!==e?e:[],{...Object(d.getEsQueryConfig)(Ye.services.uiSettings),dateFormatTZ:void 0}),Pe(!1),Qe(Object(O.d)(Ne,ke,Se,Object(l.isEmpty)(t)?[]:[t],re))}catch(e){Pe(!0),Qe(Object(O.d)(Ne,ke,Se,[],re))}}),[Ne,ke,Se,ie,T,s,re]);const st=Object(i.useMemo)((()=>{if(ce)return r.a.createElement(X,{grow:!1},r.a.createElement(N.g,{"data-test-subj":"alerts-histogram-panel-go-to-alerts-page",onClick:at,href:et(Object(v.c)())},F))}),[ce,at,et]),ot=Object(i.useMemo)((()=>{return null==Q?ye:(e=Q,S.i18n.translate("xpack.securitySolution.detectionEngine.alerts.histogram.topNLabel",{values:{fieldName:e},defaultMessage:"Top {fieldName}"}));var e}),[Q,ye]),lt=Object(i.useMemo)((()=>ze&&void 0!==xe?xe:qe),[ze,xe,qe]);return r.a.createElement(E.c,{show:!Me&&lt},r.a.createElement(z.a,{height:ae,hasBorder:!0,paddingSize:ne,"data-test-subj":"alerts-histogram-panel",$toggleStatus:lt},r.a.createElement(g.a,{alignHeader:e,id:Ie,inspectTitle:C,outerDirection:"column",title:ot,titleSize:ve,toggleStatus:lt,toggleQuery:Ee?void 0:Ve,showInspectButton:!Le&&null==n,subtitle:!Me&&pe&&nt,isInspectDisabled:Ae},r.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart","data-test-subj":"panelFlexGroup",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},de&&r.a.createElement(r.a.Fragment,null,r.a.createElement(z.b,{"data-test-subj":"stackByComboBox",inputRef:se,onSelect:Be,prepend:fe,ref:o,selected:Ne,useLensCompatibleFields:Le,width:ge}),le&&r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiSpacer,{"data-test-subj":"placeholderSpacer",size:"s"}),r.a.createElement(a.EuiToolTip,{"data-test-subj":"placeholderTooltip",content:P},r.a.createElement(z.b,{"data-test-subj":"stackByPlaceholder",isDisabled:!0,onSelect:l.noop,prepend:$.b,selected:"",useLensCompatibleFields:Le,width:ge})))),null!=I&&I),null!=n&&!Le&&r.a.createElement(ee,{grow:!1},n(Ie)),st)),lt?Le?r.a.createElement(G.a,{"data-test-subj":"embeddable-matrix-histogram",extraActions:w,extraOptions:{filters:T},getLensAttributes:H,height:null!=t?t:155,id:Ce,inspectTitle:null!=C?C:ye,scopeId:Z.SourcererScopeName.detections,stackByField:Ne,timerange:He}):Me?r.a.createElement(x.a,null):r.a.createElement(_,{chartHeight:t,data:it,from:ke,legendItems:rt,legendPosition:M,legendMinWidth:oe?300:void 0,loading:Ze,to:Se,showLegend:ue,updateDateRange:he}):null))}));ne.displayName="AlertsHistogramPanel"},function(e,t,n){"use strict";n.d(t,"b",(function(){return we})),n.d(t,"a",(function(){return Me}));var a=n(45),i=n(17),r=n(2),s=n.n(r),o=n(48),l=n(44),u=n.n(l),c=n(66),d=n(135),p=n(118),m=n(134),f=n(196),g=n(116),b=n(742),y=n(113),v=n(112),h=n(282),E=n(145),x=n(296),j=n(23),O=n.n(j),S=(n(13),n(194)),k=n(47),w=n(130),T=n(110),I=n(719),C=n(485),M=n(377),_=n(122),A=n(430),P=n(721),F=n(5);const D=F.i18n.translate("xpack.securitySolution.timeline.tabs.queyTabTimelineTitle",{defaultMessage:"Query"}),N=F.i18n.translate("xpack.securitySolution.timeline.tabs.eqlTabTimelineTitle",{defaultMessage:"Correlation"}),R=F.i18n.translate("xpack.securitySolution.timeline.tabs.analyserTabTimelineTitle",{defaultMessage:"Analyzer"}),L=F.i18n.translate("xpack.securitySolution.timeline.tabs.notesTabTimelineTitle",{defaultMessage:"Notes"}),z=F.i18n.translate("xpack.securitySolution.timeline.tabs.pinnedTabTimelineTitle",{defaultMessage:"Pinned"}),B=F.i18n.translate("xpack.securitySolution.timeline.tabs.securityAssistantTimelineTitle",{defaultMessage:"Elastic AI Assistant"}),q=F.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline",{defaultMessage:"ES|QL"}),$=F.i18n.translate("xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline.technicalPreviewLabel",{defaultMessage:"Technical Preview"}),V=F.i18n.translate("xpack.securitySolution.timeline.tabs.sessionTabTimelineTitle",{defaultMessage:"Session View"});var U=n(18),H=n(520),Z=n(14);const G=u.a.div.attrs((({$isVisible:e=!1,isOverflowYScroll:t=!1})=>({style:{display:e?"flex":"none",overflow:t?"hidden scroll":"hidden"}}))).withConfig({displayName:"HideShowContainer",componentId:"sc-1ib7jds-0"})(["flex:1;"]);var Q=u()(G).withConfig({displayName:"_StyledHideShowContainer",componentId:"sc-1ib7jds-1"})(["overflow:hidden !important;"]);const W=(e,t=s.a.createElement(i.EuiSkeletonText,{lines:10}))=>{var n;const a=s.a.forwardRef(((n,a)=>s.a.createElement(r.Suspense,{fallback:t},s.a.createElement(e,O()({},n,{ref:a})))));return a.displayName=`${null!==(n=e.displayName)&&void 0!==n?n:"Tab"}WithSuspense`,a},K=u.a.div.withConfig({displayName:"AssistantTabContainer",componentId:"sc-1ib7jds-2"})(["overflow-y:auto;width:100%;"]),J=W(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(15),n.e(16),n.e(44)]).then(n.bind(null,1724))))),Y=W(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(15),n.e(16),n.e(37)]).then(n.bind(null,1732))))),X=W(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(17),n.e(38)]).then(n.bind(null,1710))))),ee=W(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(46)]).then(n.bind(null,1735))))),te=W(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(15),n.e(50)]).then(n.bind(null,1711))))),ne=W(Object(r.lazy)((()=>Promise.all([n.e(1),n.e(5),n.e(9),n.e(7),n.e(10),n.e(13),n.e(47)]).then(n.bind(null,1712))))),ae=W(Object(r.lazy)((()=>n.e(43).then(n.bind(null,1726))))),ie=Object(r.memo)((({shouldRefocusPrompt:e,setConversationId:t})=>s.a.createElement(r.Suspense,{fallback:s.a.createElement(i.EuiSkeletonText,{lines:10})},s.a.createElement(K,null,s.a.createElement(S.a,{conversationId:H.a,embeddedLayout:!0,setConversationId:t,shouldRefocusPrompt:e})))));ie.displayName="AssistantTab";const re=Object(r.memo)((({activeTimelineTab:e,renderCellValue:t,rowRenderers:n,timelineId:a,timelineType:i,setConversationId:o,showTimeline:l})=>{const{hasAssistantPrivilege:u}=Object(M.a)(),c=Object(T.i)().services.configSettings.ESQLEnabled,d=Object(r.useCallback)((e=>{switch(e){case _.d.graph:return s.a.createElement(X,{timelineId:a});case _.d.notes:return s.a.createElement(ee,{timelineId:a});case _.d.session:return s.a.createElement(ne,{timelineId:a});default:return null}}),[a]),p=Object(r.useMemo)((()=>[_.d.graph,_.d.notes,_.d.session].includes(e)),[e]),{conversations:m}=Object(C.a)(),f=Object(r.useMemo)((()=>m[H.a].messages.length>0),[m]);return s.a.createElement(s.a.Fragment,null,s.a.createElement(G,{$isVisible:_.d.query===e,"data-test-subj":`timeline-tab-content-${_.d.query}`},s.a.createElement(J,{renderCellValue:t,rowRenderers:n,timelineId:a})),l&&c&&e===_.d.esql&&s.a.createElement(G,{$isVisible:!0,"data-test-subj":`timeline-tab-content-${_.d.esql}`},s.a.createElement(ae,{timelineId:a})),s.a.createElement(G,{$isVisible:_.d.pinned===e,"data-test-subj":`timeline-tab-content-${_.d.pinned}`},s.a.createElement(te,{renderCellValue:t,rowRenderers:n,timelineId:a})),i===y.l.default&&s.a.createElement(G,{$isVisible:_.d.eql===e,"data-test-subj":`timeline-tab-content-${_.d.eql}`},s.a.createElement(Y,{renderCellValue:t,rowRenderers:n,timelineId:a})),s.a.createElement(G,{$isVisible:p,isOverflowYScroll:e===_.d.session,"data-test-subj":`timeline-tab-content-${_.d.graph}-${_.d.notes}`},p&&d(e)),u&&s.a.createElement(Q,{$isVisible:e===_.d.securityAssistant,isOverflowYScroll:e===_.d.securityAssistant,"data-test-subj":"timeline-tab-content-security-assistant"},(e===_.d.securityAssistant||f)&&s.a.createElement(ie,{setConversationId:o,shouldRefocusPrompt:l&&e===_.d.securityAssistant})))}));re.displayName="ActiveTimelineTab";const se=u()(i.EuiBadge).withConfig({displayName:"CountBadge",componentId:"sc-1ib7jds-3"})(["margin-left:",";"],(({theme:e})=>e.eui.euiSizeS)),oe=u()(i.EuiBetaBadge).withConfig({displayName:"StyledEuiBetaBadge",componentId:"sc-1ib7jds-4"})(["vertical-align:middle;margin-left:",";&:hover{cursor:pointer;}"],(({theme:e})=>e.eui.euiSizeS)),le=u()(i.EuiTab).withConfig({displayName:"StyledEuiTab",componentId:"sc-1ib7jds-5"})([".euiTab__content{align-items:center;display:flex;flex-direction:row;white-space:pre;}:focus{text-decoration:none;> span > span{text-decoration:underline;}}"]),ue=u()(i.EuiTabs).withConfig({displayName:"StyledEuiTabs",componentId:"sc-1ib7jds-6"})(["padding-inline:",";"],(e=>e.theme.eui.euiSizeM)),ce=({renderCellValue:e,rowRenderers:t,timelineId:n,timelineFullScreen:l,timelineType:u,graphEventId:c,sessionViewConfig:d,timelineDescription:m})=>{const f=Object(w.a)("timelineEsqlTabDisabled"),g=Object(T.i)().services.configSettings.ESQLEnabled,{hasAssistantPrivilege:b}=Object(M.a)(),h=Object(o.useDispatch)(),E=Object(r.useMemo)((()=>Object(P.a)()),[]),x=Object(r.useMemo)((()=>Object(P.g)()),[]),j=Object(r.useMemo)((()=>Object(P.e)()),[]),O=Object(r.useMemo)((()=>Object(P.d)()),[]),S=Object(r.useMemo)((()=>Object(P.c)()),[]),C=Object(r.useMemo)((()=>Object(P.b)()),[]),F=Object(v.b)((e=>E(e,n))),G=Object(v.b)((e=>x(e,n))),Q=Object(v.b)((e=>j(e,n))),W=Object(v.a)((e=>S(e,n))),K=Object(v.a)((e=>C(e,n))),J=Object(v.a)((e=>O(e))),Y=Object(U.b)().isEnterprise(),[X,ee]=Object(r.useState)(H.a),{reportAssistantInvoked:te}=Object(I.a)(),ne=Object(r.useMemo)((()=>{const e=Object.values(K).reduce(((e,t)=>[...e,...t]),[]);return[...W,...e]}),[W,K]),ae=Object(r.useMemo)((()=>J.filter((e=>ne.includes(e.id))).length+(Object(a.isEmpty)(m)?0:1)),[J,ne,m]),ie=Object(r.useCallback)((e=>{h(p.a.setActiveTabTimeline({id:n,activeTab:e}))}),[h,n]),ce=Object(r.useCallback)((()=>{ie(_.d.query)}),[ie]),de=Object(r.useCallback)((()=>{ie(_.d.eql)}),[ie]),pe=Object(r.useCallback)((()=>{ie(_.d.graph)}),[ie]),me=Object(r.useCallback)((()=>{ie(_.d.notes)}),[ie]),fe=Object(r.useCallback)((()=>{ie(_.d.pinned)}),[ie]),ge=Object(r.useCallback)((()=>{ie(_.d.session)}),[ie]),be=Object(r.useCallback)((()=>{ie(_.d.securityAssistant),F!==_.d.securityAssistant&&te({conversationId:X,invokedBy:H.a})}),[F,X,te,ie]),ye=Object(r.useCallback)((()=>{h(Object(Z.initializeTimelineSettings)({id:n})),ie(_.d.esql)}),[ie,h,n]);return Object(r.useEffect)((()=>{c||F!==_.d.graph||ce()}),[F,c,ce]),s.a.createElement(s.a.Fragment,null,!l&&s.a.createElement(ue,{className:"eui-scrollBar"},s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.query}`,onClick:ce,isSelected:F===_.d.query,disabled:!1,key:_.d.query},s.a.createElement("span",null,D),G&&s.a.createElement(A.b,null)),!f&&g&&s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.esql}`,onClick:ye,isSelected:F===_.d.esql,disabled:!1,key:_.d.esql},s.a.createElement("span",null,q),s.a.createElement(oe,{label:$,size:"s",iconType:"beaker",tooltipContent:s.a.createElement(k.FormattedMessage,{id:"xpack.securitySolution.timeline.tabs.discoverEsqlInTimeline.technicalPreviewTooltip",defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."})})),u===y.l.default&&s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.eql}`,onClick:de,isSelected:F===_.d.eql,disabled:!1,key:_.d.eql},s.a.createElement("span",null,N),G&&s.a.createElement(A.a,null)),s.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${_.d.graph}`,onClick:pe,isSelected:F===_.d.graph,disabled:!c,key:_.d.graph},R),Y&&s.a.createElement(i.EuiTab,{"data-test-subj":`timelineTabs-${_.d.session}`,onClick:ge,isSelected:F===_.d.session,disabled:null===d,key:_.d.session},V),s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.notes}`,onClick:me,isSelected:F===_.d.notes,disabled:u===y.l.template,key:_.d.notes},s.a.createElement("span",null,L),G&&ae>0&&u===y.l.default&&s.a.createElement("div",null,s.a.createElement(se,null,ae))),s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.pinned}`,onClick:fe,disabled:u===y.l.template,isSelected:F===_.d.pinned,key:_.d.pinned},s.a.createElement("span",null,z),G&&Q>0&&u===y.l.default&&s.a.createElement("div",null,s.a.createElement(se,null,Q))),b&&s.a.createElement(le,{"data-test-subj":`timelineTabs-${_.d.securityAssistant}`,onClick:be,disabled:u===y.l.template,isSelected:F===_.d.securityAssistant,key:_.d.securityAssistant},s.a.createElement("span",null,B))),s.a.createElement(re,{activeTimelineTab:F,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:u,timelineDescription:m,setConversationId:ee,showTimeline:G}))},de=Object(r.memo)(ce);var pe=n(243),me=n(189),fe=n(593),ge=n(49),be=n(60),ye=n(218),ve=n(128),he=n(722),Ee=n(4),xe=n(292),je=n(516);const Oe=e=>{var t;const{activeTab:n,switchToTab:a,timelineType:o}=e,{services:{storage:l}}=Object(T.i)(),u=Object(r.useMemo)((()=>xe.b.filter((e=>!e.timelineType||e.timelineType===o))),[o]),[c,d]=Object(r.useState)((()=>{const e=l.get(Ee.Qb.TIMELINE);return null!=e?e:xe.c})),p=Object(r.useCallback)((()=>{d((e=>({...e,isTourActive:!1})))}),[]),m=Object(r.useCallback)((()=>{d((e=>({...e,currentTourStep:e.currentTourStep+1})))}),[]);Object(r.useEffect)((()=>{l.set(Ee.Qb.TIMELINE,c)}),[c,l]);const f=Object(r.useCallback)((e=>e===u.length?s.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:p},je.h):[s.a.createElement(i.EuiButtonEmpty,{size:"s",color:"text",onClick:p},je.g),s.a.createElement(i.EuiButton,{color:"success",size:"s",onClick:m},je.j)]),[p,m,u.length]),g=null===(t=u[c.currentTourStep-1])||void 0===t?void 0:t.anchor,b=Object(he.a)(g),y=u[c.currentTourStep-1];return null!=y&&y.timelineTab&&y.timelineTab!==n&&a(y.timelineTab),c.isTourActive&&b?s.a.createElement(s.a.Fragment,null,u.map(((e,t)=>{const n=t+1;if(c.currentTourStep!==n)return null;const a={"data-test-subj":`timeline-tour-step-${t+1}`};return s.a.createElement(i.EuiTourStep,{panelProps:a,key:t,step:n,isStepOpen:c.isTourActive&&c.currentTourStep===t+1,minWidth:c.tourPopoverWidth,stepsTotal:u.length,onFinish:p,title:e.title,content:e.content,anchor:`#${e.anchor}`,subtitle:xe.c.tourSubtitle,footerAction:f(n)})}))):null},Se=s.a.memo(Oe),ke=u.a.div.withConfig({displayName:"TimelineTemplateBadge",componentId:"sc-4r2lej-0"})(["background:",";color:#fff;padding:10px 15px;font-size:0.8em;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),we=Object(r.createContext)({timelineId:null}),Te=({timelineId:e})=>{const t=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]);return Object(v.b)((n=>{var a;return(null!==(a=t(n,e))&&void 0!==a?a:m.b).isSaving}))?s.a.createElement(i.EuiProgress,{size:"s",color:"primary",position:"absolute"}):null},Ie=s.a.memo(Te),Ce=({renderCellValue:e,rowRenderers:t,timelineId:n})=>{const l=Object(o.useDispatch)(),u=Object(r.useRef)(null),j=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),O=Object(r.useMemo)((()=>ve.e.scopeIdSelector()),[]),{selectedPatterns:S,selectedDataViewId:k}=Object(v.a)((e=>O(e,g.SourcererScopeName.timeline))),{dataViewId:w,indexNames:I,graphEventId:C,savedObjectId:M,timelineType:A,description:P,sessionViewConfig:F,initialized:D,show:N,isLoading:R,activeTab:L}=Object(v.a)((e=>{var t;return Object(a.pick)(["indexNames","dataViewId","graphEventId","savedObjectId","timelineType","description","sessionViewConfig","initialized","show","isLoading","activeTab"],null!==(t=j(e,n))&&void 0!==t?t:m.b)})),{kibanaSecuritySolutionsPrivileges:{crud:z}}=Object(d.a)(),{timelineFullScreen:B}=Object(me.c)();Object(r.useEffect)((()=>{M||D||l(p.a.createTimeline({id:n,columns:f.b,dataViewId:k,indexNames:S,expandedDetail:h.a.getExpandedDetail(),show:!1}))}),[]);const q=Object(r.useCallback)((()=>{!M||null==k||null===w&&0===I.length||w===k&&I.sort().join()===S.sort().join()||l(p.a.updateDataView({dataViewId:k,id:n,indexNames:S}))}),[l,M,k,w,S,I,n]);Object(r.useEffect)((()=>{q()}),[k,S]);const $=Object(r.useCallback)((()=>{var e;const t=null===(e=u.current)||void 0===e?void 0:e.querySelector(fe.a);var n,a;null!=t?t.focus():null===(n=u.current)||void 0===n||null===(a=n.querySelector(".globalFilterBar__addButton"))||void 0===a||a.focus()}),[u]),V=Object(r.useCallback)((()=>{var e,t;null===(e=u.current)||void 0===e||null===(t=e.querySelector(`.${E.d}`))||void 0===t||t.focus()}),[u]),U=Object(r.useCallback)((e=>{Object(c.isTab)(e)&&Object(E.l)({containerElement:u.current,keyboardEvent:e,onSkipFocusBeforeEventsTable:$,onSkipFocusAfterEventsTable:V})}),[u,$,V]),H=Object(r.useMemo)((()=>({timelineId:n})),[n]),Z=(()=>{const{search:e,pathname:t}=Object(ge.useLocation)(),{spaces:n}=Object(T.i)().services,a=Object(r.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:o,savedObjectId:l,show:u,graphEventId:c,activeTab:d}=Object(v.a)((e=>{var t;return null!==(t=a(e,_.c.active))&&void 0!==t?t:m.b})),f=Object(r.useCallback)((()=>{var a,r,p;const m=new URLSearchParams(e),f=null!==(a=m.get(ye.a.timeline))&&void 0!==a?a:void 0,g={id:null!=l?l:"",isOpen:!!u,activeTab:d,graphEventId:c},b=null!==(r=Object(be.safeDecode)(null!=f?f:""))&&void 0!==r?r:g,y=null==b?void 0:b.id;if(!n||"conflict"!==(null==o?void 0:o.outcome)||null==(null==o?void 0:o.alias_target_id)||null==y)return null;const v=null!==(p=null==o?void 0:o.alias_target_id)&&void 0!==p?p:"",h={...b,id:v},E=Object(be.encode)(h);m.set(ye.a.timeline,E);const x=`${t}?${m.toString()}${window.location.hash}`;return s.a.createElement(s.a.Fragment,null,n.ui.components.getLegacyUrlConflict({objectNoun:ye.a.timeline,currentObjectId:y,otherObjectId:v,otherObjectPath:x}),s.a.createElement(i.EuiSpacer,null))}),[d,c,t,null==o?void 0:o.alias_target_id,null==o?void 0:o.outcome,l,e,u,n]);return Object(r.useMemo)((()=>f()),[f])})(),G=N&&!R&&z,Q=Object(r.useCallback)((e=>{l(p.a.setActiveTabTimeline({id:n,activeTab:e}))}),[n,l]);return s.a.createElement(we.Provider,{value:H},s.a.createElement(pe.B,{"data-test-subj":"timeline","data-timeline-id":n,onKeyDown:U,ref:u},s.a.createElement(Ie,{timelineId:n}),s.a.createElement("div",{className:"timeline-body","data-test-subj":"timeline-body"},A===y.l.template&&s.a.createElement(ke,{className:"timeline-template-badge"},x.f),Z,s.a.createElement(pe.y,{$isVisible:!B,"data-test-subj":"timeline-hide-show-container"},s.a.createElement(b.a,{timelineId:n})),s.a.createElement(de,{graphEventId:C,sessionViewConfig:F,renderCellValue:e,rowRenderers:t,timelineId:n,timelineType:A,timelineDescription:P,timelineFullScreen:B}))),G?s.a.createElement(Se,{activeTab:L,switchToTab:Q,timelineType:A}):null)};Ce.displayName="StatefulTimelineComponent";const Me=s.a.memo(Ce)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5);a.i18n.translate("xpack.securitySolution.guideConfig.title",{defaultMessage:"Detect threats in my data with SIEM"}),a.i18n.translate("xpack.securitySolution.guideConfig.description",{defaultMessage:"There are many ways to get your SIEM data into Elastic. In this guide, we'll help you get set up quickly using the Elastic Defend integration."}),a.i18n.translate("xpack.securitySolution.guideConfig.documentationLink",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description.linkText",{defaultMessage:"Learn more"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.title",{defaultMessage:"Add data with Elastic Defend"}),a.i18n.translate("xpack.securitySolution.guideConfig.addDataStep.description",{defaultMessage:"Install Elastic Agent and its Elastic Defend integration on one of your computers to get SIEM data flowing."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.title",{defaultMessage:"Turn on rules"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.description",{defaultMessage:"Load the Elastic prebuilt rules, select the rules you want, and enable them to generate alerts."}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.title",{defaultMessage:"Continue with the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.rulesStep.manualCompletion.description",{defaultMessage:"After you've enabled the rules you need, continue."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.title",{defaultMessage:"Manage alerts and cases"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.description",{defaultMessage:"Learn how to view and triage alerts with cases."}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.title",{defaultMessage:"Continue the guide"}),a.i18n.translate("xpack.securitySolution.guideConfig.alertsStep.manualCompletion.description",{defaultMessage:"After you've explored the case, continue."});const i="siem"},,function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(110),r=n(114),s=n(66);const o=({closePopover:e,draggableId:t,fieldName:n,keyboardHandlerRef:o,openPopover:l})=>{const{timelines:u}=Object(i.i)().services,c=u.getUseAddToTimeline(),{beginDrag:d,cancelDrag:p,dragToLocation:m,endDrag:f,hasDraggableLock:g}=c({draggableId:t,fieldName:n}),[b,y]=Object(a.useState)(null),v=Object(a.useCallback)((()=>{y((e=>e?(p(e),null):null))}),[p]),h=Object(a.useCallback)((n=>{const a=document.querySelector(`[data-rbd-drag-handle-draggable-id="${t}"]`);var i;a&&((g()||!g()&&" "===n.key)&&(n.preventDefault(),n.stopPropagation()),(({beginDrag:e,cancelDragActions:t,closePopover:n,draggableElement:a,dragActions:i,dragToLocation:o,endDrag:l,keyboardEvent:u,openPopover:c,setDragActions:d})=>{let p=null;switch(u.key){case" ":i?(l(i),d(null)):(null!=n&&n(),d(e()));break;case"Escape":t();break;case"Tab":(e=>{const t=e.querySelectorAll("a, button");t.forEach((e=>{e.setAttribute("tabindex","-1")})),setTimeout((()=>{t.forEach((e=>{e.setAttribute("tabindex","0")}))}),0)})(a);break;case"ArrowUp":p=a.getBoundingClientRect(),o({dragActions:i,position:{x:p.x,y:p.y-r.f}});break;case"ArrowDown":p=a.getBoundingClientRect(),o({dragActions:i,position:{x:p.x,y:p.y+r.f}});break;case"ArrowLeft":p=a.getBoundingClientRect(),o({dragActions:i,position:{x:p.x-r.f,y:p.y}});break;case"ArrowRight":p=a.getBoundingClientRect(),o({dragActions:i,position:{x:p.x+r.f,y:p.y}});break;case"Enter":Object(s.stopPropagationAndPreventDefault)(u),i||null==c||c()}})({beginDrag:d,cancelDragActions:v,closePopover:e,dragActions:b,draggableElement:a,dragToLocation:m,endDrag:f,keyboardEvent:n,openPopover:l,setDragActions:y}),null===(i=o.current)||void 0===i||i.focus())}),[d,v,e,b,t,m,f,g,o,l,y]);return Object(a.useMemo)((()=>({onBlur:v,onKeyDown:h})),[v,h])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17),l=n(50),u=n(110),c=n(47);const d=({handleClick:e})=>i.a.createElement(o.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(o.EuiFlexItem,{grow:!1},i.a.createElement(o.EuiButtonEmpty,{onClick:e,"data-test-subj":"osquery-empty-button"},i.a.createElement(c.FormattedMessage,{id:"xpack.securitySolution.footer.cancel",defaultMessage:"Cancel"})))),p=i.a.memo(d);var m=n(709);const f=s.a.div.withConfig({displayName:"OsqueryActionWrapper",componentId:"sc-flf6q3-0"})(["padding:8px;"]),g=({agentId:e,defaultValues:t,onClose:n,ecsData:r})=>{const{services:{osquery:s}}=Object(u.i)(),c=Object(l.useQueryClient)(),d=Object(a.useCallback)((()=>{var e;c.invalidateQueries({queryKey:["actions",{alertId:null==t||null===(e=t.alertIds)||void 0===e?void 0:e[0]}]})}),[null==t?void 0:t.alertIds,c]);return null!=s&&s.OsqueryAction?i.a.createElement(o.EuiFlyout,{size:"m",onClose:n},i.a.createElement(o.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"flyout-header-osquery"},i.a.createElement(o.EuiTitle,null,i.a.createElement("h2",null,m.a))),i.a.createElement(o.EuiFlyoutBody,null,i.a.createElement(f,{"data-test-subj":"flyout-body-osquery"},i.a.createElement(s.OsqueryAction,{agentId:e,formType:"steps",defaultValues:t,ecsData:r,onSuccess:d}))),i.a.createElement(o.EuiFlyoutFooter,null,i.a.createElement(p,{handleClick:n,"data-test-subj":"flyout-footer-osquery"}))):null},b=i.a.memo(g)},,function(e,t,n){"use strict";n.d(t,"b",(function(){return _})),n.d(t,"a",(function(){return R}));var a=n(45),i=n(17),r=n(47),s=n(2),o=n.n(s),l=n(44),u=n.n(l),c=n(48),d=n(50),p=n(126),m=n(390),f=n(118),g=n(167),b=n(468),y=n(5);const v=y.i18n.translate("xpack.securitySolution.timeline.toggleEventDetailsTitle",{defaultMessage:"Expand event details"}),h=y.i18n.translate("xpack.securitySolution.timeline.addedANoteLabel",{defaultMessage:"added a note"}),E=y.i18n.translate("xpack.securitySolution.timeline.addedADescriptionLabel",{defaultMessage:"added description"}),x=y.i18n.translate("xpack.securitySolution.timeline.anUnknownUserLabel",{defaultMessage:"an unknown user"}),j=y.i18n.translate("xpack.securitySolution.timeline.deleteNoteLabel",{defaultMessage:"Delete Note"}),O=y.i18n.translate("xpack.securitySolution.timeline.cancelDeleteNoteLabel",{defaultMessage:"Keep Note"}),S=y.i18n.translate("xpack.securitySolution.timeline.promptDeleteNoteLabel",{defaultMessage:"Delete timeline note?"});var k=n(122),w=n(112),T=n(116),I=n(121),C=n(110),M=n(117);const _=u.a.section.withConfig({displayName:"NotePreviewsContainer",componentId:"sc-16ieedj-0"})(["padding-top:",";"],(({theme:e})=>`${e.eui.euiSizeS}`));_.displayName="NotePreviewsContainer";const A=({eventId:e,timelineId:t})=>{const n=Object(c.useDispatch)(),{selectedPatterns:a}=Object(I.d)(T.SourcererScopeName.timeline),r=Object(s.useCallback)((()=>{n(f.a.toggleDetailPanel({panelView:"eventDetail",tabType:k.d.notes,id:t,params:{eventId:e,indexName:a.join(",")}}))}),[n,e,a,t]);return o.a.createElement(i.EuiButtonIcon,{title:v,"aria-label":v,color:"text",iconType:"arrowRight",onClick:r})},P=o.a.memo(A),F=o.a.memo((({closeModal:e,confirmModal:t})=>o.a.createElement(i.EuiConfirmModal,{title:S,onCancel:e,onConfirm:t,cancelButtonText:O,confirmButtonText:j,buttonColor:"danger",defaultFocusedButton:"confirm"})));F.displayName="DeleteNoteConfirm";const D=o.a.memo((({noteId:e})=>{const[t,n]=Object(s.useState)(null),{mutate:a,isLoading:r}=function(e){const{services:{http:t}}=Object(C.i)(),n=Object(c.useDispatch)(),{addError:a}=Object(M.a)();return Object(d.useMutation)({mutationFn:e=>t.fetch("/api/note",{method:"DELETE",body:JSON.stringify({noteId:e}),version:"2023-10-31"}),onSuccess:()=>{e&&n(g.a.deleteNote({id:e}))},onError:e=>{var t;a(e,{title:(t=e,y.i18n.translate("xpack.securitySolution.timeline.deleteNoteError",{defaultMessage:"An error occurred deleting note {error}",values:{error:t}}))})}})}(e),l=Object(s.useCallback)((async()=>{n(e)}),[e]),u=Object(s.useCallback)((()=>{n(null)}),[]),p=Object(s.useCallback)((()=>{a(e),n(null)}),[a,e]),m=Object(s.useMemo)((()=>r||null==e),[r,e]);return o.a.createElement(o.a.Fragment,null,o.a.createElement(i.EuiButtonIcon,{title:j,"aria-label":j,"data-test-subj":"delete-note",color:"text",iconType:"trash",onClick:l,disabled:m}),null!=t&&o.a.createElement(F,{closeModal:u,confirmModal:p}))}));D.displayName="DeleteNoteButton";const N=o.a.memo((({eventId:e,timelineId:t,noteId:n})=>e&&t?o.a.createElement(o.a.Fragment,null,o.a.createElement(P,{eventId:e,timelineId:t}),o.a.createElement(D,{noteId:n})):o.a.createElement(D,{noteId:n})));N.displayName="NoteActions";const R=o.a.memo((({eventIdToNoteIds:e,notes:t,timelineId:n,showTimelineDescription:l})=>{const u=Object(s.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),c=Object(w.a)((e=>n?u(e,n):null)),d=Object(s.useMemo)((()=>l&&n&&null!=c&&c.description?[{username:Object(p.a)(c.updatedBy),event:E,"data-test-subj":"note-preview-description",id:"note-preview-description",timestamp:c.updated?o.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(c.updated)}):Object(p.e)(),children:o.a.createElement(i.EuiText,{size:"s"},c.description),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=c.updatedBy?c.updatedBy:"?",size:"l"}),actions:null}]:[]),[c,n,l]),g=Object(s.useMemo)((()=>Object(a.uniqBy)("savedObjectId",t).map((t=>{var a,s,l;const u=null!=e?Object.entries(e).reduce(((e,[n,a])=>{var i;return a.includes(null!==(i=t.noteId)&&void 0!==i?i:"")?n:e}),null):null!==(a=t.eventId)&&void 0!==a?a:null;return{"data-test-subj":`note-preview-${t.savedObjectId}`,username:Object(p.a)(t.updatedBy),event:h,timestamp:t.updated?o.a.createElement(r.FormattedRelative,{"data-test-subj":"updated",value:new Date(t.updated)}):Object(p.e)(),children:o.a.createElement("div",{className:b.a,tabIndex:0},o.a.createElement(i.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnlyUserAddedANote"},o.a.createElement("p",null,`${null!==(s=t.updatedBy)&&void 0!==s?s:x} ${h}`)),o.a.createElement(m.b,null,null!==(l=t.note)&&void 0!==l?l:"")),actions:o.a.createElement(N,{eventId:u,timelineId:n,noteId:t.savedObjectId}),timelineAvatar:o.a.createElement(i.EuiAvatar,{"data-test-subj":"avatar",name:null!=t.updatedBy?t.updatedBy:"?",size:"l"})}}))),[e,t,n]);return o.a.createElement(i.EuiCommentList,{"data-test-subj":"note-comment-list",comments:[...d,...g]})}));R.displayName="NotePreviews"},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(45),i=n(2);const r={pageName:n(129).a.noPage,detailName:void 0,tabName:void 0,search:"",pathName:"/",state:void 0},s=Object(i.createContext)([r,()=>a.noop])},,function(e,t){e.exports=function(){}},function(e,t,n){e.exports=n(24)(817)},function(e,t,n){e.exports=n(24)(1619)},function(e,t,n){e.exports=n(24)(3350)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(766);Object.defineProperty(t,"createMemo",{enumerable:!0,get:function(){return a.default}});var i=n(767);Object.defineProperty(t,"createReducerContext",{enumerable:!0,get:function(){return i.default}});var r=n(768);Object.defineProperty(t,"createReducer",{enumerable:!0,get:function(){return r.default}});var s=n(769);Object.defineProperty(t,"createStateContext",{enumerable:!0,get:function(){return s.default}});var o=n(407);Object.defineProperty(t,"useAsync",{enumerable:!0,get:function(){return o.default}});var l=n(419);Object.defineProperty(t,"useAsyncFn",{enumerable:!0,get:function(){return l.default}});var u=n(770);Object.defineProperty(t,"useAsyncRetry",{enumerable:!0,get:function(){return u.default}});var c=n(771);Object.defineProperty(t,"useAudio",{enumerable:!0,get:function(){return c.default}});var d=n(773);Object.defineProperty(t,"useBattery",{enumerable:!0,get:function(){return d.default}});var p=n(775);Object.defineProperty(t,"useBeforeUnload",{enumerable:!0,get:function(){return p.default}});var m=n(776);Object.defineProperty(t,"useBoolean",{enumerable:!0,get:function(){return m.default}});var f=n(777);Object.defineProperty(t,"useClickAway",{enumerable:!0,get:function(){return f.default}});var g=n(778);Object.defineProperty(t,"useCookie",{enumerable:!0,get:function(){return g.default}});var b=n(780);Object.defineProperty(t,"useCopyToClipboard",{enumerable:!0,get:function(){return b.default}});var y=n(501);Object.defineProperty(t,"useCounter",{enumerable:!0,get:function(){return y.default}});var v=n(781);Object.defineProperty(t,"useCss",{enumerable:!0,get:function(){return v.default}});var h=n(375);Object.defineProperty(t,"useCustomCompareEffect",{enumerable:!0,get:function(){return h.default}});var E=n(787);Object.defineProperty(t,"useDebounce",{enumerable:!0,get:function(){return E.default}});var x=n(664);Object.defineProperty(t,"useDeepCompareEffect",{enumerable:!0,get:function(){return x.default}});var j=n(788);Object.defineProperty(t,"useDefault",{enumerable:!0,get:function(){return j.default}});var O=n(789);Object.defineProperty(t,"useDrop",{enumerable:!0,get:function(){return O.default}});var S=n(790);Object.defineProperty(t,"useDropArea",{enumerable:!0,get:function(){return S.default}});var k=n(256);Object.defineProperty(t,"useEffectOnce",{enumerable:!0,get:function(){return k.default}});var w=n(791);Object.defineProperty(t,"useEnsuredForwardedRef",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"ensuredForwardRef",{enumerable:!0,get:function(){return w.ensuredForwardRef}});var T=n(302);Object.defineProperty(t,"useEvent",{enumerable:!0,get:function(){return T.default}});var I=n(792);Object.defineProperty(t,"useError",{enumerable:!0,get:function(){return I.default}});var C=n(793);Object.defineProperty(t,"useFavicon",{enumerable:!0,get:function(){return C.default}});var M=n(794);Object.defineProperty(t,"useFullscreen",{enumerable:!0,get:function(){return M.default}});var _=n(796);Object.defineProperty(t,"useGeolocation",{enumerable:!0,get:function(){return _.default}});var A=n(502);Object.defineProperty(t,"useGetSet",{enumerable:!0,get:function(){return A.default}});var P=n(797);Object.defineProperty(t,"useGetSetState",{enumerable:!0,get:function(){return P.default}});var F=n(798);Object.defineProperty(t,"useHarmonicIntervalFn",{enumerable:!0,get:function(){return F.default}});var D=n(800);Object.defineProperty(t,"useHover",{enumerable:!0,get:function(){return D.default}});var N=n(503);Object.defineProperty(t,"useHoverDirty",{enumerable:!0,get:function(){return N.default}});var R=n(801);Object.defineProperty(t,"useIdle",{enumerable:!0,get:function(){return R.default}});var L=n(803);Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return L.default}});var z=n(804);Object.defineProperty(t,"useInterval",{enumerable:!0,get:function(){return z.default}});var B=n(40);Object.defineProperty(t,"useIsomorphicLayoutEffect",{enumerable:!0,get:function(){return B.default}});var q=n(504);Object.defineProperty(t,"useKey",{enumerable:!0,get:function(){return q.default}});var $=n(805);Object.defineProperty(t,"createBreakpoint",{enumerable:!0,get:function(){return $.default}});var V=n(505);Object.defineProperty(t,"useKeyPress",{enumerable:!0,get:function(){return V.default}});var U=n(806);Object.defineProperty(t,"useKeyPressEvent",{enumerable:!0,get:function(){return U.default}});var H=n(506);Object.defineProperty(t,"useLatest",{enumerable:!0,get:function(){return H.default}});var Z=n(507);Object.defineProperty(t,"useLifecycles",{enumerable:!0,get:function(){return Z.default}});var G=n(508);Object.defineProperty(t,"useList",{enumerable:!0,get:function(){return G.default}});var Q=n(807);Object.defineProperty(t,"useLocalStorage",{enumerable:!0,get:function(){return Q.default}});var W=n(808);Object.defineProperty(t,"useLocation",{enumerable:!0,get:function(){return W.default}});var K=n(809);Object.defineProperty(t,"useLockBodyScroll",{enumerable:!0,get:function(){return K.default}});var J=n(810);Object.defineProperty(t,"useLogger",{enumerable:!0,get:function(){return J.default}});var Y=n(811);Object.defineProperty(t,"useLongPress",{enumerable:!0,get:function(){return Y.default}});var X=n(705);Object.defineProperty(t,"useMap",{enumerable:!0,get:function(){return X.default}});var ee=n(812);Object.defineProperty(t,"useMedia",{enumerable:!0,get:function(){return ee.default}});var te=n(813);Object.defineProperty(t,"useMediaDevices",{enumerable:!0,get:function(){return te.default}});var ne=n(814);Object.defineProperty(t,"useMediatedState",{enumerable:!0,get:function(){return ne.useMediatedState}});var ae=n(815);Object.defineProperty(t,"useMethods",{enumerable:!0,get:function(){return ae.default}});var ie=n(816);Object.defineProperty(t,"useMotion",{enumerable:!0,get:function(){return ie.default}});var re=n(509);Object.defineProperty(t,"useMount",{enumerable:!0,get:function(){return re.default}});var se=n(207);Object.defineProperty(t,"useMountedState",{enumerable:!0,get:function(){return se.default}});var oe=n(510);Object.defineProperty(t,"useMouse",{enumerable:!0,get:function(){return oe.default}});var le=n(817);Object.defineProperty(t,"useMouseHovered",{enumerable:!0,get:function(){return le.default}});var ue=n(818);Object.defineProperty(t,"useMouseWheel",{enumerable:!0,get:function(){return ue.default}});var ce=n(819);Object.defineProperty(t,"useNetwork",{enumerable:!0,get:function(){return ce.default}});var de=n(820);Object.defineProperty(t,"useNumber",{enumerable:!0,get:function(){return de.default}});var pe=n(11);Object.defineProperty(t,"useObservable",{enumerable:!0,get:function(){return pe.default}});var me=n(821);Object.defineProperty(t,"useOrientation",{enumerable:!0,get:function(){return me.default}});var fe=n(822);Object.defineProperty(t,"usePageLeave",{enumerable:!0,get:function(){return fe.default}});var ge=n(823);Object.defineProperty(t,"usePermission",{enumerable:!0,get:function(){return ge.default}});var be=n(235);Object.defineProperty(t,"usePrevious",{enumerable:!0,get:function(){return be.default}});var ye=n(824);Object.defineProperty(t,"usePreviousDistinct",{enumerable:!0,get:function(){return ye.default}});var ve=n(825);Object.defineProperty(t,"usePromise",{enumerable:!0,get:function(){return ve.default}});var he=n(826);Object.defineProperty(t,"useQueue",{enumerable:!0,get:function(){return he.default}});var Ee=n(511);Object.defineProperty(t,"useRaf",{enumerable:!0,get:function(){return Ee.default}});var xe=n(827);Object.defineProperty(t,"useRafLoop",{enumerable:!0,get:function(){return xe.default}});var je=n(257);Object.defineProperty(t,"useRafState",{enumerable:!0,get:function(){return je.default}});var Oe=n(828);Object.defineProperty(t,"useSearchParam",{enumerable:!0,get:function(){return Oe.default}});var Se=n(829);Object.defineProperty(t,"useScratch",{enumerable:!0,get:function(){return Se.default}});var ke=n(835);Object.defineProperty(t,"useScroll",{enumerable:!0,get:function(){return ke.default}});var we=n(836);Object.defineProperty(t,"useScrolling",{enumerable:!0,get:function(){return we.default}});var Te=n(837);Object.defineProperty(t,"useSessionStorage",{enumerable:!0,get:function(){return Te.default}});var Ie=n(255);Object.defineProperty(t,"useSetState",{enumerable:!0,get:function(){return Ie.default}});var Ce=n(838);Object.defineProperty(t,"useShallowCompareEffect",{enumerable:!0,get:function(){return Ce.default}});var Me=n(840);Object.defineProperty(t,"useSize",{enumerable:!0,get:function(){return Me.default}});var _e=n(841);Object.defineProperty(t,"useSlider",{enumerable:!0,get:function(){return _e.default}});var Ae=n(842);Object.defineProperty(t,"useSpeech",{enumerable:!0,get:function(){return Ae.default}});var Pe=n(843);Object.defineProperty(t,"useStartTyping",{enumerable:!0,get:function(){return Pe.default}});var Fe=n(844);Object.defineProperty(t,"useStateWithHistory",{enumerable:!0,get:function(){return Fe.useStateWithHistory}});var De=n(845);Object.defineProperty(t,"useStateList",{enumerable:!0,get:function(){return De.default}});var Ne=n(846);Object.defineProperty(t,"useThrottle",{enumerable:!0,get:function(){return Ne.default}});var Re=n(847);Object.defineProperty(t,"useThrottleFn",{enumerable:!0,get:function(){return Re.default}});var Le=n(848);Object.defineProperty(t,"useTimeout",{enumerable:!0,get:function(){return Le.default}});var ze=n(376);Object.defineProperty(t,"useTimeoutFn",{enumerable:!0,get:function(){return ze.default}});var Be=n(849);Object.defineProperty(t,"useTitle",{enumerable:!0,get:function(){return Be.default}});var qe=n(500);Object.defineProperty(t,"useToggle",{enumerable:!0,get:function(){return qe.default}});var $e=n(850);Object.defineProperty(t,"useTween",{enumerable:!0,get:function(){return $e.default}});var Ve=n(303);Object.defineProperty(t,"useUnmount",{enumerable:!0,get:function(){return Ve.default}});var Ue=n(851);Object.defineProperty(t,"useUnmountPromise",{enumerable:!0,get:function(){return Ue.default}});var He=n(223);Object.defineProperty(t,"useUpdate",{enumerable:!0,get:function(){return He.default}});var Ze=n(254);Object.defineProperty(t,"useUpdateEffect",{enumerable:!0,get:function(){return Ze.default}});var Ge=n(852);Object.defineProperty(t,"useUpsert",{enumerable:!0,get:function(){return Ge.default}});var Qe=n(853);Object.defineProperty(t,"useVibrate",{enumerable:!0,get:function(){return Qe.default}});var We=n(854);Object.defineProperty(t,"useVideo",{enumerable:!0,get:function(){return We.default}});var Ke=n(855);Object.defineProperty(t,"useStateValidator",{enumerable:!0,get:function(){return Ke.default}});var Je=n(856);Object.defineProperty(t,"useScrollbarWidth",{enumerable:!0,get:function(){return Je.useScrollbarWidth}});var Ye=n(858);Object.defineProperty(t,"useMultiStateValidator",{enumerable:!0,get:function(){return Ye.useMultiStateValidator}});var Xe=n(859);Object.defineProperty(t,"useWindowScroll",{enumerable:!0,get:function(){return Xe.default}});var et=n(860);Object.defineProperty(t,"useWindowSize",{enumerable:!0,get:function(){return et.default}});var tt=n(861);Object.defineProperty(t,"useMeasure",{enumerable:!0,get:function(){return tt.default}});var nt=n(862);Object.defineProperty(t,"useRendersCount",{enumerable:!0,get:function(){return nt.useRendersCount}});var at=n(300);Object.defineProperty(t,"useFirstMountState",{enumerable:!0,get:function(){return at.useFirstMountState}});var it=n(863);Object.defineProperty(t,"useSet",{enumerable:!0,get:function(){return it.default}});var rt=n(864);Object.defineProperty(t,"createGlobalState",{enumerable:!0,get:function(){return rt.createGlobalState}});var st=n(865);Object.defineProperty(t,"useHash",{enumerable:!0,get:function(){return st.useHash}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],r=t[1],s=i.useMemo((function(){return{set:function(e,t){r((function(n){var i;return a.__assign(a.__assign({},n),((i={})[e]=t,i))}))},setAll:function(e){r(e)},remove:function(e){r((function(t){var n=t,i=e;return n[i],a.__rest(n,["symbol"==typeof i?i:i+""])}))},reset:function(){return r(e)}}}),[r]),o=a.__assign({get:i.useCallback((function(e){return n[e]}),[n])},s);return[n,o]}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=Object(a.createContext)(null)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(49),r=n(20),s=n(116),o=n(121),l=n(110);const u=()=>{const{indicesExist:e,dataViewId:t}=Object(o.d)(s.SourcererScopeName.timeline),n=Object(l.i)().services.application.capabilities.siem.show,u=Object(a.useMemo)((()=>n&&(e||null===t)),[e,t,n]);return Object(a.useCallback)((e=>{return!!u&&(t=e,!Object(r.c)().map((e=>e.path)).find((e=>Object(i.matchPath)(t,e))));var t}),[u])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var a=n(17),i=n(45),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(113),c=n(393),d=n(162),p=n(132),m=n(126),f=n(296),g=n(125);const b=l()(a.EuiFlexItem).withConfig({displayName:"TimelineContentItem",componentId:"sc-t3gz96-0"})(["max-width:calc(100% - 56px);"]),y=l()(a.EuiFilterButton).withConfig({displayName:"StyledEuiFilterButton",componentId:"sc-t3gz96-1"})(["border-top:0;border-bottom:0;"]),v=({hideUntitled:e=!1,getSelectableOptions:t,onClosePopover:n,onTimelineChange:o,timelineType:l,placeholder:v})=>{const[h,E]=Object(r.useState)(50),[x,j]=Object(r.useState)(0),[O,S]=Object(r.useState)(""),[k,w]=Object(r.useState)(!1),{fetchAllTimeline:T,timelines:I,loading:C,totalCount:M}=Object(c.b)(),_=Object(r.useRef)(null),A=Object(r.useRef)(null),P=Object(r.useMemo)((()=>Object(i.debounce)(500,S)),[]),F=Object(r.useCallback)((e=>{P(e)}),[P]),D=Object(r.useCallback)((()=>{w(!k)}),[k]),N=Object(r.useCallback)(((e,t,n)=>{if(e<t&&_.current&&A.current){const e=_.current.clientHeight,t=A.current.clientHeight;n>10&&t-n<1.2*e&&t>x&&(j(t),E(h+50))}}),[x,h]),R=Object(r.useCallback)(((e,t)=>{const n=Object(d.f)({...e,title:e.timelineTitle})?p.ab:e.timelineTitle,r=null!=e.description&&e.description.trim().length>0?e.description:null;return s.a.createElement(a.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiIcon,{type:"on"===e.checked?"check":"empty",color:"primary"})),s.a.createElement(b,{grow:!0},s.a.createElement(a.EuiFlexGroup,{gutterSize:"none",direction:"column",responsive:!1},s.a.createElement(a.EuiFlexItem,{"data-test-subj":"timeline"},s.a.createElement(a.EuiToolTip,{content:n,anchorClassName:"eui-textTruncate eui-alignMiddle"},s.a.createElement(a.EuiHighlight,{search:t},n))),s.a.createElement(a.EuiFlexItem,null,s.a.createElement(a.EuiToolTip,{content:r,anchorClassName:"eui-textTruncate eui-alignMiddle"},s.a.createElement(a.EuiTextColor,{color:"subdued",component:"span"},s.a.createElement("small",null,null!=r?r:Object(m.d)())))))),s.a.createElement(a.EuiFlexItem,{grow:!1},s.a.createElement(a.EuiIcon,{type:null!=e.favorite&&Object(i.isEmpty)(e.favorite)?"starEmpty":"starFilled"})))}),[]),L=Object(r.useCallback)((e=>{const t=e.filter((e=>"on"===e.checked));var a;null!=t&&t.length>0&&o(Object(i.isEmpty)(t[0].timelineTitle)?p.ab:t[0].timelineTitle,"-1"===t[0].id?null:t[0].id,null!==(a=t[0].graphEventId)&&void 0!==a?a:""),n()}),[n,o]),z=Object(r.useCallback)(((e,t)=>s.a.createElement(s.a.Fragment,null,t,e)),[]),B=Object(r.useMemo)((()=>({"data-test-subj":"timeline-super-select-search-box",placeholder:null!=v?v:f.e(l),onSearch:F,incremental:!1,append:s.a.createElement(y,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:k,onClick:D},p.D)})),[D,F,k,l,v]),q=Object(r.useMemo)((()=>({rowHeight:50,showIcons:!1,windowProps:{onScroll:({scrollOffset:t})=>N((null!=I?I:[]).filter((t=>!e||""!==t.title)).length,M,t),outerRef:_,innerRef:A}})),[N,e,M,I]);return Object(r.useEffect)((()=>{T({pageInfo:{pageIndex:1,pageSize:h},search:O,sort:{sortField:u.f.updated,sortOrder:g.b.desc},onlyUserFavorite:k,status:null,timelineType:l})}),[T,k,h,O,l]),s.a.createElement(a.EuiSelectable,{"data-test-subj":"selectable-input",height:260,isLoading:C&&null==I,listProps:q,renderOption:R,onChange:L,searchable:!0,searchProps:B,singleSelection:!0,options:($=t({timelines:null!=I?I:[],onlyFavorites:k,searchTimelineValue:O,timelineType:l}),$.map((({title:e,...t})=>({...t,title:void 0,timelineTitle:e}))))},z);var $},h=Object(r.memo)(v)},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.alertsView.osqueryAlertTitle",{defaultMessage:"Run Osquery"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.dragAndDrop.copyToClipboardTooltip",{defaultMessage:"Copy to Clipboard"}),r=a.i18n.translate("xpack.securitySolution.dragAndDrop.draggableKeyboardInstructionsNotDraggingScreenReaderOnly",{defaultMessage:"Press enter for options, or press space to begin dragging."});a.i18n.translate("xpack.securitySolution.dragAndDrop.fieldLabel",{defaultMessage:"Field"}),a.i18n.translate("xpack.securitySolution.dragAndDrop.closeButtonLabel",{defaultMessage:"Close"})},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"c",(function(){return h}));var a=n(45),i=n(2),r=n(48),s=n(5),o=n(172),l=n(14),u=n(117),c=n(121),d=n(149),p=n(162),m=n(203),f=n(145),g=n(712),b=n(116);const y="createRuleFromTimeline",v="createRuleFromEql",h=e=>{const t=Object(r.useDispatch)(),{addError:n}=Object(u.a)(),{browserFields:h,dataViewId:E,selectedPatterns:x}=Object(c.d)(b.SourcererScopeName.timeline),j=Object(i.useRef)(!1),[O,S]=Object(i.useState)(null),[k,w]=Object(i.useState)(!1),T=Object(i.useCallback)((e=>{w(!0),S(e),e.dataViewId===E||Object(a.isEmpty)(e.indexNames)||t(d.a.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:e.dataViewId,selectedPatterns:e.indexNames}))}),[E,t]),[I]=Object(i.useState)({dataViewId:E,selectedPatterns:x}),C=Object(i.useMemo)((()=>null==O||Object(a.isEmpty)(h)||null!==O.dataViewId&&null!==E&&E!==O.dataViewId?null:h),[h,E,O]),M=Object(m.f)(y),_=Object(i.useMemo)(M,[M]),A=Object(m.f)(v),P=Object(i.useMemo)(A,[A]),F=Object(i.useCallback)((()=>{if(null!=O&&null!=C){try{const t=()=>{var e,t,n,a,i,r,s;return{dataProviders:null!=O.dataProviders&&O.dataProviders.length>0?Object(o.f)(Object(f.g)(O.dataProviders,C),{fields:[],title:x.join(",")}):"",query:{query:null!==(e=null===(t=O.kqlQuery.filterQuery)||void 0===t||null===(n=t.kuery)||void 0===n?void 0:n.expression)&&void 0!==e?e:"",language:null!==(a=null===(i=O.kqlQuery.filterQuery)||void 0===i||null===(r=i.kuery)||void 0===r?void 0:r.kind)&&void 0!==a?a:"kuery"},filters:null!==(s=O.filters)&&void 0!==s?s:[],eqlOptions:{}}},n=()=>{var e;return{dataProviders:"",query:{query:null!==(e=O.eqlOptions.query)&&void 0!==e?e:"",language:"eql"},filters:[],eqlOptions:{eqlOptions:O.eqlOptions}}},a=j.current?n():t();w(!1),e({index:x,queryBar:{filters:""!==a.dataProviders?[...a.filters,Object(g.b)(a.dataProviders)]:a.filters,query:a.query,saved_id:null},...a.eqlOptions})}catch(e){w(!1),n(e,{toastMessage:s.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.toastMessage",{defaultMessage:"Failed to create rule from timeline with id: {id}",values:{id:O.id}}),title:s.i18n.translate("xpack.securitySolution.ruleFromTimeline.error.title",{defaultMessage:"Failed to import rule from timeline"})})}j.current=!1,I.dataViewId!==E&&t(d.a.setSelectedDataView({id:b.SourcererScopeName.timeline,selectedDataViewId:I.dataViewId,selectedPatterns:I.selectedPatterns}))}}),[n,E,t,I.dataViewId,I.selectedPatterns,C,x,O,e]);Object(i.useEffect)((()=>{null!=C&&F()}),[F,C]);const D=Object(i.useCallback)((e=>{null!=O&&e===O.id||Object(p.h)({timelineId:e,onOpenTimeline:T,updateIsLoading:({id:e,isLoading:n})=>t(Object(l.updateIsLoading)({id:e,isLoading:n})),updateTimeline:Object(p.b)(t)})}),[t,T,O]),[N,R]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{if(!N){let e=null;null!=_?e=_:null!=P&&(e=P,j.current=!0),null!=e&&(R(!0),D(e),w(!0))}}),[D,_,P,N]),{loading:k,onOpenTimeline:T}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return k}));var a=n(45),i=n(2),r=n.n(i),s=n(48),o=n(3),l=n(136),u=n.n(l),c=n(53),d=n(517),p=n.n(d),m=n(119),f=n(121),g=n(116),b=n(172),y=n(560),v=n(757),h=n(145),E=n(118);const x=p.a.div`
  /*
  *
  * hide search bar default filters as they are disturbing the layout  as shown below
  *
  * Filters are displayed with QueryBar so below is how is the layout with default filters.
  *
  *
  *                    --------------------------------
  *   -----------------|                              |------------
  *   | DataViewPicker |        QueryBar              | Date      |
  *   -------------------------------------------------------------
  *                    |      Filters                 |
  *                    --------------------------------
  *
  * The tree under this component makes sure that default filters are not rendered and we can separately display
  * them outside query component so that layout is as below:
  *
  *   -----------------------------------------------------------
  *   | DataViewPicker |      QueryBar              |   Date    |
  *   -----------------------------------------------------------
  *   |                       Filters                           |
  *   -----------------------------------------------------------
  *
  * */
  .uniSearchBar .filter-items-group {
    display: none;
  }

  .euiDataGrid__restrictBody & {
    .kbnQueryBar {
      display: flex;
    }
  }
`,j="timeline-filter-drop-area",O=(e=[])=>e.filter((e=>e.meta.controlledBy!==j)),S=Object(i.memo)((({dataProviders:e,filters:t,filterManager:n,filterQuery:a,from:l,fromStr:c,kqlMode:d,isRefreshPaused:p,savedQueryId:S,setFilters:w,setSavedQueryId:T,refreshInterval:I,timelineId:C,to:M,toStr:_,updateReduxTime:A})=>{const P=Object(s.useDispatch)(),[F,D]=Object(i.useState)(null!=c?c:new Date(l).toISOString()),[N,R]=Object(i.useState)(null!=_?_:new Date(M).toISOString()),{browserFields:L,indexPattern:z}=Object(f.d)(g.SourcererScopeName.timeline),[B,q]=Object(i.useState)(void 0),[$,V]=Object(i.useState)({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"}),[U,H]=Object(i.useState)(O(t)),[Z,G]=Object(i.useState)(Object(b.f)(Object(h.g)(e,L),z)),Q=Object(y.a)(),W=Object(i.useCallback)(((e,t)=>P(E.a.applyKqlFilterQuery({id:C,filterQuery:{kuery:{kind:t,expression:e},serializedQuery:Object(b.f)(e,z)}}))),[P,z,C]);Object(i.useEffect)((()=>{let e=!0;const a=new o.Subscription;return n.setFilters(t),a.add(n.getUpdates$().subscribe({next:()=>{if(e){const e=O(n.getFilters());w(e),H(e)}}})),()=>{e=!1,a.unsubscribe()}}),[]),Object(i.useEffect)((()=>{const e=O(n.getFilters());u()(t,e)||n.setFilters(t)}),[t]),Object(i.useEffect)((()=>{V({query:null!=a?a.expression:"",language:null!=a?a.kind:"kuery"})}),[a]),Object(i.useEffect)((()=>{G(Object(b.f)(Object(h.g)(e,L),z))}),[e,L,z]),Object(i.useEffect)((()=>{null!=c&&null!=_?(D(c),R(_)):null!=l&&null!=M&&(D(new Date(l).toISOString()),R(new Date(M).toISOString()))}),[l,c,M,_]),Object(i.useEffect)((()=>{let e=!0;return async function(){if(null!=S&&null!=Q)try{const n=await Q.getSavedQuery(S);e&&null!=n&&q({...n,attributes:{...n.attributes,filters:O(t)}})}catch(e){q(void 0)}else e&&q(void 0)}(),()=>{e=!1}}),[S]);const K=Object(i.useCallback)(((e,t)=>{if((null==a||null!=a&&a.expression!==e.query||a.kind!==e.language)&&W(e.query,e.language),null!=t){const e=t.from.includes("now")||t.to.includes("now");A({id:m.a.timeline,end:t.to,start:t.from,isInvalid:!1,isQuickSelection:e,timelineId:C,hasRangeChanged:!0})}}),[a,C]),J=Object(i.useCallback)((e=>{if(null!=e){if(e.id!==S&&T(e.id),null!=Q&&""!==Z){const t=null!=e.attributes.filters?e.attributes.filters.findIndex((e=>e.meta.controlledBy===j)):-1;Q.updateQuery(e.id,{...e.attributes,filters:null!=e.attributes.filters?t>-1?[...e.attributes.filters.slice(0,t),k(Z),...e.attributes.filters.slice(t+1)]:[...e.attributes.filters,k(Z)]:[]})}}else T(null)}),[Z,S,Q]);return r.a.createElement(x,{className:"search_bar_container"},r.a.createElement(v.a,{dateRangeFrom:F,dateRangeTo:N,hideSavedQuery:"search"===d,indexPattern:z,isRefreshPaused:p,filterQuery:$,filterManager:n,filters:U,onSubmitQuery:K,refreshInterval:I,savedQuery:B,onSavedQuery:J,dataTestSubj:"timelineQueryInput",displayStyle:"inPage"}))})),k=e=>{const t=JSON.parse(e),n=Object.keys(t);return{...t,meta:{alias:j,controlledBy:j,negate:!1,disabled:!1,type:"custom",key:Object(a.isEmpty)(n)?"bool":n[0],value:e},$state:{store:c.FilterStateStore.APP_STATE}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(17),i=n(2),r=n.n(i),s=n(44);const o=n.n(s)()((({iconSide:e,children:t,...n})=>r.a.createElement(a.EuiLink,n,t))).withConfig({displayName:"Link",componentId:"sc-z5mbxm-0"})(["",""],(({iconSide:e,theme:t})=>Object(s.css)(["align-items:center;display:inline-flex;vertical-align:top;white-space:nowrap;"," ",""],"left"===e&&Object(s.css)([".euiIcon{margin-right:",";}"],t.eui.euiSizeXS),"right"===e&&Object(s.css)(["flex-direction:row-reverse;.euiIcon{margin-left:",";}"],t.eui.euiSizeXS))));o.displayName="Link";const l=r.a.memo((({ariaLabel:e,children:t,color:n,dataTestSubj:s,disabled:l,href:u,iconSide:c="left",iconSize:d="s",iconType:p,onClick:m})=>{const f=Object(i.useCallback)((e=>"object"==typeof e&&null!=e&&"props"in e&&e.props&&e.props.children?f(e.props.children):null!=e&&Object.keys(e).length>0?e:""),[]),g=Object(i.useMemo)((()=>e||f(t)),[e,t,f]);return r.a.createElement(o,{className:"siemLinkIcon",color:n,"data-test-subj":s,disabled:l,href:u,iconSide:c,onClick:m,"aria-label":g},r.a.createElement(a.EuiIcon,{size:d,type:p}),r.a.createElement("span",{className:"siemLinkIcon__label"},t))}));l.displayName="LinkIcon"},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=(e,t)=>{const n=window.URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,a.click(),window.URL.revokeObjectURL(n),a.remove()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(17),i=n(47),r=n(56),s=n.n(r),o=n(2),l=n.n(o);const u=l.a.memo((({children:e,date:t,fieldName:n,className:r=""})=>l.a.createElement(a.EuiToolTip,{"data-test-subj":"localized-date-tool-tip",anchorClassName:r,content:l.a.createElement(a.EuiFlexGroup,{"data-test-subj":"dates-container",direction:"column",gutterSize:"none"},null!=n?l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement("span",{"data-test-subj":"field-name"},n)):null,l.a.createElement(a.EuiFlexItem,{grow:!1},l.a.createElement(i.FormattedRelative,{"data-test-subj":"humanized-relative-date",value:s.a.utc(t).toDate()})),l.a.createElement(a.EuiFlexItem,{"data-test-subj":"with-day-of-week",grow:!1},s.a.utc(t).local().format("llll")),l.a.createElement(a.EuiFlexItem,{"data-test-subj":"with-time-zone-offset-in-hours",grow:!1},s()(t).format()))},l.a.createElement(l.a.Fragment,null,e))));u.displayName="LocalizedDateTooltip"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(44);const s=n.n(r).a.div.withConfig({displayName:"Wrapper",componentId:"sc-4ssvqk-0"})(["",""],(({theme:e})=>Object(r.css)([".siemSubtitle__item{color:",";font-size:",";line-height:",";@media only screen and (min-width:","){display:inline-block;margin-right:",";&:last-child{margin-right:0;}}}"],e.eui.euiTextSubduedColor,e.eui.euiFontSizeXS,e.eui.euiLineHeight,e.eui.euiBreakpoints.s,e.eui.euiSize)));s.displayName="Wrapper";const o=i.a.memo((({children:e,dataTestSubj:t="header-panel-subtitle"})=>"string"==typeof e?i.a.createElement("p",{className:"siemSubtitle__item siemSubtitle__item--text","data-test-subj":t},e):i.a.createElement("div",{className:"siemSubtitle__item siemSubtitle__item--node","data-test-subj":t},e)));o.displayName="SubtitleItem";const l=i.a.memo((({items:e})=>i.a.createElement(s,{className:"siemSubtitle"},Array.isArray(e)?e.map(((e,t)=>i.a.createElement(o,{key:t},e))):i.a.createElement(o,null,e))));l.displayName="Subtitle"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5);const i=e=>e?a.i18n.translate("xpack.securitySolution.toggleQuery.on",{defaultMessage:"Open"}):a.i18n.translate("xpack.securitySolution.toggleQuery.off",{defaultMessage:"Closed"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(17),s=n(113),o=n(132),l=n(193);const u=({timelineType:e,elasticTemplateTimelineCount:t,customTemplateTimelineCount:n})=>{const[u,c]=Object(a.useState)(null),d=Object(a.useMemo)((()=>e===s.l.template),[e]),p=Object(a.useMemo)((()=>d?u:null),[u,d]),m=Object(a.useMemo)((()=>null==p?null:p===s.g.elastic?s.k.immutable:s.k.active),[p]),f=Object(a.useMemo)((()=>[{id:s.g.elastic,name:o.s,disabled:!d,withNext:!0,count:null!=t?t:void 0},{id:s.g.custom,name:o.r,disabled:!d,withNext:!1,count:null!=n?n:void 0}]),[n,t,d]),g=Object(a.useCallback)((e=>{c(u===e?null:e)}),[c,u]),b=Object(a.useMemo)((()=>d?f.map((e=>i.a.createElement(r.EuiFilterButton,{hasActiveFilters:e.id===p,key:`template-timeline-filter-${e.id}`,numFilters:e.count,onClick:g.bind(null,e.id),withNext:e.withNext,isDisabled:e.disabled,"data-test-subj":e.name},e.name))):null),[p,f,d,g]),y=Object(a.useCallback)((async()=>{p!==s.g.custom&&await Object(l.g)()}),[p]);return{timelineStatus:m,templateTimelineType:p,templateTimelineFilter:b,installPrepackagedTimelines:y}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(485),r=n(110);const s=()=>{const{conversations:e}=Object(i.a)(),{services:{telemetry:t}}=Object(r.i)(),n=Object(a.useCallback)((t=>{var n;return(null!==(n=e[t])&&void 0!==n?n:{isDefault:!1}).isDefault?t:"Custom"}),[e]),s=Object(a.useCallback)((({fn:e,params:{conversationId:t,...a}})=>e({...a,conversationId:n(t)})),[n]);return{reportAssistantInvoked:e=>s({fn:t.reportAssistantInvoked,params:e}),reportAssistantMessageSent:e=>s({fn:t.reportAssistantMessageSent,params:e}),reportAssistantQuickPrompt:e=>s({fn:t.reportAssistantQuickPrompt,params:e})}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"g",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"e",(function(){return c}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addedNoteToTimelineToast",{defaultMessage:"Added note to timeline"}),r=a.i18n.translate("xpack.securitySolution.assistant.commentActions.viewAPMTraceLabel",{defaultMessage:"View APM Trace for this message"}),s=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addMessageContentAsTimelineNoteAriaLabel",{defaultMessage:"Add message content as a timeline note"}),o=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addNoteToTimelineTooltip",{defaultMessage:"Add note to timeline"}),l=a.i18n.translate("xpack.securitySolution.assistant.commentActions.addToCaseExistingCase",{defaultMessage:"Add to existing case"}),u=a.i18n.translate("xpack.securitySolution.assistant.commentActions.elasticAiAssistantTitle",{defaultMessage:"Elastic AI Assistant"}),c=a.i18n.translate("xpack.securitySolution.assistant.commentActions.copyToClipboard",{defaultMessage:"Copy to clipboard"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"g",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(57),i=n(122),r=n(422),s=n(353);const o=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:i.d.query})),l=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.show)&&void 0!==t&&t})),u=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return Object.keys(null!==(t=null==e?void 0:e.pinnedEventIds)&&void 0!==t?t:{}).length})),c=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.noteIds)&&void 0!==t?t:[]})),d=()=>Object(a.createSelector)(s.selectTimeline,(e=>{var t;return null!==(t=null==e?void 0:e.eventIdToNoteIds)&&void 0!==t?t:{}})),p=()=>Object(a.createSelector)(r.selectNotesById,(e=>Object.values(e))),m=()=>Object(a.createSelector)(s.selectTimeline,(e=>null==e?void 0:e.scrollToTop))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2);const i=e=>{const[t,n]=Object(a.useState)(!1);return Object(a.useEffect)((()=>{const a=new MutationObserver((()=>{const a=!!document.getElementById(e);a&&!t&&n(!0),!a&&t&&n(!1)}));return a.observe(document.body,{childList:!0,subtree:!0}),()=>a.disconnect()}),[t,e]),t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return C}));var a=n(23),i=n.n(a),r=n(62),s=n(61),o=n.n(s),l=n(2),u=n.n(l),c=n(44),d=n.n(c),p=n(17),m=n(54),f=n(4),g=n(594),b=n(229),y=n(546),v=n(172),h=n(110),E=n(484),x=n(230),j=n(384),O=n(129),S=n(164),k=n(319);const w=e=>({text:e,value:e}),T=d()(p.EuiButton).withConfig({displayName:"StyledLinkButton",componentId:"sc-11itwu1-0"})(["margin-left:0;@media only screen and (min-width:","){margin-left:",";}"],(e=>e.theme.eui.euiBreakpoints.m),(({theme:e})=>e.eui.euiSizeL)),I=({combinedQueries:e,deleteQuery:t,filters:n,from:a,headerChildren:s,indexPattern:c,indexNames:d,runtimeMappings:p,onlyField:I,paddingSize:C,query:M,queryType:_,setAbsoluteRangeDatePickerTarget:A,setQuery:P,showLegend:F,showSpacer:D=!0,scopeId:N,sourcererScopeId:R,to:L,toggleTopN:z,hideQueryToggle:B=!1})=>{const q=Object(l.useMemo)((()=>`eventsByDatasetOverview-${_}`),[_]);Object(l.useEffect)((()=>()=>{t&&t({id:q})}),[t,q]);const $=Object(h.i)(),{formatUrl:V,search:U}=Object(S.l)(O.a.hosts),{navigateToApp:H}=$.services.application,[Z]=Object(h.o)(f.P),G=Object(l.useCallback)((e=>{e.preventDefault(),H(f.l,{deepLinkId:O.a.hosts,path:Object(b.c)(x.HostsTableType.events,U)})}),[H,U]),Q=Object(l.useMemo)((()=>u.a.createElement(T,{onClick:G,href:V(Object(b.c)(x.HostsTableType.events))},j.o)),[G,V]),[W,K]=Object(l.useMemo)((()=>null==e?Object(v.i)({config:Object(m.getEsQueryConfig)($.services.uiSettings),indexPattern:c,queries:[M],filters:n}):[e]),[e,$,c,M,n]);Object(k.a)({id:q,filterQuery:W,kqlError:K,query:M,startDate:a,endDate:L});const J=Object(l.useMemo)((()=>{var e;return{...E.b,stackByOptions:null!=I?[w(I)]:E.b.stackByOptions,defaultStackByOption:null!=I?w(I):null!==(e=E.c.find((e=>"event.dataset"===e.text)))&&void 0!==e?e:E.c[0],legendPosition:r.Position.Right,subtitle:e=>`${g.b}: ${o()(e).format(Z)} ${Object(g.c)(e)}`,titleSize:null==I?"m":"s"}}),[I,Z]),Y=Object(l.useMemo)((()=>null==I||null!=s?u.a.createElement(u.a.Fragment,null,s,null==I&&Q):null),[I,s,Q]);return u.a.createElement(y.a,i()({endDate:L,filterQuery:W,headerChildren:Y,id:q,indexNames:d,runtimeMappings:p,onError:z,paddingSize:C,setAbsoluteRangeDatePickerTarget:A,setQuery:P,showSpacer:D,showLegend:F,skip:void 0===W,startDate:a,scopeId:N,sourcererScopeId:R},J,{title:null!=I?j.l(I):J.title,chartHeight:160,hideQueryToggle:B}))};I.displayName="EventsByDatasetComponent";const C=u.a.memo(I)},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(17),s=n(44),o=n.n(s),l=n(265),u=n(293);const c=o()(r.EuiFlexGroup).withConfig({displayName:"FlexGroup",componentId:"sc-1719m3x-0"})(["height:",";width:",";position:relative;margin:0;"],(({height:e})=>e||"100%"),(({width:e})=>e||"100%"));c.displayName="FlexGroup";const d=({height:e="100%",width:t="100%",data:n})=>i.a.createElement(c,{justifyContent:"center",alignItems:"center",height:e,width:t},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiText,{size:"s",textAlign:"center",color:"subdued","data-test-subj":"chartHolderText"},Object(l.f)(n)?u.a:u.b)))},function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"g",(function(){return s})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"h",(function(){return c})),n.d(t,"d",(function(){return d}));var a=n(5);const i=e=>a.i18n.translate("xpack.securitySolution.eventsTab.externalAlertsUnit",{values:{totalCount:e},defaultMessage:"external {totalCount, plural, =1 {alert} other {alerts}}"}),r=e=>a.i18n.translate("xpack.securitySolution.hosts.navigaton.eventsUnit",{values:{totalCount:e},defaultMessage:"{totalCount, plural, =1 {event} other {events}}"}),s=a.i18n.translate("xpack.securitySolution.eventsTab.showing",{defaultMessage:"Showing"}),o=a.i18n.translate("xpack.securitySolution.eventsTab.alertsGraphTitle",{defaultMessage:"External alert trend"}),l=a.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingAlertsData",{defaultMessage:"Failed to query alerts data"}),u=a.i18n.translate("xpack.securitySolution.eventsTab.errorFetchingEventsData",{defaultMessage:"Failed to query events data"}),c=a.i18n.translate("xpack.securitySolution.eventsTab.showExternalAlerts",{defaultMessage:"Show only external alerts"}),d=a.i18n.translate("xpack.securitySolution.eventsGraphTitle",{defaultMessage:"Events"})},function(e,t,n){"use strict";n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"e",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return m}));var a=n(45),i=n(56),r=n.n(i),s=n(727);const o=[],l=e=>{var t,n,a;return(null!==(t=null==e||null===(n=e.aggregations)||void 0===n||null===(a=n.alertsByGrouping)||void 0===a?void 0:a.buckets)&&void 0!==t?t:[]).reduce(((e,{key_as_string:t,key:n,alerts:a})=>{var i;return[...e,...(null!==(i=a.buckets)&&void 0!==i?i:[]).map((({key:e,doc_count:a})=>({x:e,y:a,g:null!=t?t:n.toString()})))]}),o)},u=(e,t,n,a,i)=>({aggs:{alertsByGrouping:{terms:{field:e,order:{_count:"desc"},size:10},aggs:{alerts:{date_histogram:{field:"@timestamp",fixed_interval:`${Math.floor(r()(n).diff(r()(t))/32)}ms`,min_doc_count:0,extended_bounds:{min:t,max:n}}}}}},query:{bool:{filter:[...a,{range:{"@timestamp":{gte:t,lte:n}}}]}},runtime_mappings:i,_source:!1,size:0}),c=({isInitialLoading:e,isLoadingAlerts:t})=>e&&t,d=e=>{try{return null==e||Object(a.isEmpty)(e)?{}:JSON.parse(e)}catch{return{}}},p=e=>{try{return Object(a.isEmpty)(e)?[]:[d(e)]}catch{return[]}},m=({callback:e,order:t}={})=>({id:"resetGroupByField",getDisplayName:()=>s.b,getIconType:()=>"editorRedo",type:"actionButton",isCompatible:async()=>!0,async execute({embeddable:t}){null==e||e();const n=t.getInput(),{attributes:{state:{visualization:{columns:a}}}}=n;t.updateInput({...n,attributes:{...n.attributes,state:{...n.attributes.state,visualization:{...n.attributes.state.visualization,columns:a.map((e=>({...e,hidden:!1})))}}}})},order:t})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.inspectTitle",{defaultMessage:"Inspect"}),r=a.i18n.translate("xpack.securitySolution.components.chartSettingsPopover.contextMenuItems.resetGroupByFieldsMenuItem",{defaultMessage:"Reset group by fields"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(328);const i=new Set([a.b.STRING,a.b.BOOLEAN,a.b.NUMBER,a.b.IP]),r=e=>!!e&&i.has(e)},function(e,t,n){"use strict";n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(17),s=n(47),o=n(63);const l={tall:490,short:250},u=Object(a.createContext)({tableId:null}),c=({height:e="tall"})=>i.a.createElement(r.EuiPanel,{color:"subdued"},i.a.createElement(r.EuiFlexGroup,{style:{height:l[e]},alignItems:"center",justifyContent:"center","data-test-subj":"loading-alerts-panel"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingSpinner,{size:"xl"})))),d={maxWidth:500},p=()=>{const{http:e}=Object(o.useKibana)().services;return i.a.createElement(r.EuiPanel,{color:"subdued","data-test-subj":"tGridEmptyState"},i.a.createElement(r.EuiFlexGroup,{alignItems:"center",justifyContent:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiPanel,{hasBorder:!0,style:d},i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement(r.EuiTitle,null,i.a.createElement("h3",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.title",defaultMessage:"No results match your search criteria"}))),i.a.createElement("p",null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.eventsViewer.empty.description",defaultMessage:"Try searching over a longer period of time or modifying your search"})))),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiImage,{size:"200",alt:"",url:e.basePath.prepend("/plugins/timelines/assets/illustration_product_no_results_magnifying_glass.svg")})))))))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.isPlatinumOrTrialLicense},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(0),i=n.n(a);class InvariantError extends Error{constructor(...e){super(...e),i()(this,"name","InvariantError")}}function r(e,t){if(!e)throw new InvariantError(t)}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return s})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n(186);const i=(e="",t=!1,n="",i="",r="",s=!1)=>({meta:{license:e,license_uuid:n,cluster_uuid:i,cluster_name:r,cloud:t,serverless:s},global_manifest_version:"latest",windows:{events:{credential_access:!0,dll_and_driver_load:!0,dns:!0,file:!0,network:!0,process:!0,registry:!0,security:!0},malware:{mode:a.f.prevent,blocklist:!0},ransomware:{mode:a.f.prevent,supported:!0},memory_protection:{mode:a.f.prevent,supported:!0},behavior_protection:{mode:a.f.prevent,reputation_service:t,supported:!0},popup:{malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0}},logging:{file:"info"},antivirus_registration:{enabled:!1},attack_surface_reduction:{credential_hardening:{enabled:!0}}},mac:{events:{process:!0,file:!0,network:!0},malware:{mode:a.f.prevent,blocklist:!0},behavior_protection:{mode:a.f.prevent,reputation_service:t,supported:!0},memory_protection:{mode:a.f.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"},advanced:{capture_env_vars:"DYLD_INSERT_LIBRARIES,DYLD_FRAMEWORK_PATH,DYLD_LIBRARY_PATH,LD_PRELOAD"}},linux:{events:{process:!0,file:!0,network:!0,session_data:!1,tty_io:!1},malware:{mode:a.f.prevent,blocklist:!0},behavior_protection:{mode:a.f.prevent,reputation_service:t,supported:!0},memory_protection:{mode:a.f.prevent,supported:!0},popup:{malware:{message:"",enabled:!0},behavior_protection:{message:"",enabled:!0},memory_protection:{message:"",enabled:!0}},logging:{file:"info"},advanced:{capture_env_vars:"LD_PRELOAD,LD_LIBRARY_PATH"}}}),r=(e=i())=>({...e,global_manifest_version:"latest"}),s=(e=i())=>{const t={rollback:{self_healing:{enabled:!1}}};return{...e,global_manifest_version:"latest",windows:{...e.windows,advanced:void 0===e.windows.advanced?void 0:{...e.windows.advanced,alerts:void 0===e.windows.advanced.alerts?{...t}:{...e.windows.advanced.alerts,...t}},ransomware:{mode:a.f.off,supported:!1},memory_protection:{mode:a.f.off,supported:!1},behavior_protection:{mode:a.f.off,reputation_service:!1,supported:!1},attack_surface_reduction:{credential_hardening:{enabled:!1}},popup:{...e.windows.popup,malware:{message:"",enabled:!0},ransomware:{message:"",enabled:!1},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},mac:{...e.mac,behavior_protection:{mode:a.f.off,reputation_service:!1,supported:!1},memory_protection:{mode:a.f.off,supported:!1},popup:{...e.mac.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}},linux:{...e.linux,behavior_protection:{mode:a.f.off,reputation_service:!1,supported:!1},memory_protection:{mode:a.f.off,supported:!1},popup:{...e.linux.popup,malware:{message:"",enabled:!0},memory_protection:{message:"",enabled:!1},behavior_protection:{message:"",enabled:!1}}}}},o=(e=i())=>({...e,windows:{...e.windows,ransomware:{...e.windows.ransomware,supported:!0},memory_protection:{...e.windows.memory_protection,supported:!0},behavior_protection:{...e.windows.behavior_protection,supported:!0}},mac:{...e.mac,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.mac.memory_protection,supported:!0}},linux:{...e.linux,behavior_protection:{...e.windows.behavior_protection,supported:!0},memory_protection:{...e.linux.memory_protection,supported:!0}}}),l="Elastic Security {action} {filename}",u="Elastic Security {action} {rule}"},,,function(e,t,n){"use strict";n.d(t,"c",(function(){return be})),n.d(t,"b",(function(){return ye})),n.d(t,"a",(function(){return he}));var a=n(2),i=n.n(a),r=n(48),s=n(60),o=n(711),l=n(110),u=n(4),c=n(112),d=n(122),p=n(118),m=n(14),f=n(393),g=n(196),b=n(47),y=n(44),v=n.n(y),h=n(113),E=n(750),x=n(478),j=n(193),O=n(135),S=n(17),k=n(132),w=n(49),T=n(117),I=n(714);const C=({onComplete:e,isEnableDownloader:t,exportedIds:n})=>{const{tabName:i}=Object(w.useParams)(),{addSuccess:r}=Object(T.a)(),s=Object(a.useCallback)((t=>{null!=e&&e(),r({title:i===h.l.template?k.U(t):k.T(t),"data-test-subj":"addObjectToContainerSuccess"})}),[r,e,i]),o=Object(a.useCallback)((()=>{null!=e&&e()}),[e]);return Object(a.useEffect)((()=>{(async()=>{if(null!=n&&n.length&&t){const e=await Object(j.c)({ids:n});e instanceof Blob?(Object(I.a)(e,`${k.n}.ndjson`),s(n.length)):o()}})()}),[n,t]),null};C.displayName="ExportTimeline";const M=i.a.memo(C);var _=n(45);const A=i.a.memo((({title:e,closeModal:t,onDelete:n})=>{const{tabName:r}=Object(w.useParams)(),s=r===h.l.template?k.j:k.k,o=Object(a.useCallback)((()=>{const t=null!=e?e.trim():"",n=Object(_.isEmpty)(t)?k.ab:t;return i.a.createElement(b.FormattedMessage,{id:"xpack.securitySolution.open.timeline.deleteTimelineModalTitle",defaultMessage:'Delete "{title}"?',"data-test-subj":"title",values:{title:n}})}),[e]);return i.a.createElement(S.EuiConfirmModal,{buttonColor:"danger",cancelButtonText:k.b,confirmButtonText:k.h,defaultFocusedButton:S.EUI_MODAL_CONFIRM_BUTTON,onCancel:t,onConfirm:n,title:o()},i.a.createElement("div",{"data-test-subj":"warning"},s))}));A.displayName="DeleteTimelineModal";const P=Object(y.createGlobalStyle)(["div[data-popover-open]{display:none;}"]),F=i.a.memo((({deleteTimelines:e,isModalOpen:t,savedObjectIds:n,title:r,onComplete:s,savedSearchIds:o})=>{const{addSuccess:l}=Object(T.a)(),{tabName:u}=Object(w.useParams)(),c=Object(a.useCallback)((()=>{null!=s&&s()}),[s]),d=Object(a.useCallback)((()=>{n.length>0&&null!=o&&o.length>0?(e(n,o),l({title:u===h.l.template?k.S(n.length):k.R(n.length)})):n.length>0&&(e(n),l({title:u===h.l.template?k.S(n.length):k.R(n.length)})),null!=s&&s()}),[e,n,s,l,u,o]);return i.a.createElement(i.a.Fragment,null,t&&i.a.createElement(P,{"data-test-subj":"remove-popover"}),t?i.a.createElement(S.EuiModal,{maxWidth:600,onClose:c},i.a.createElement(A,{"data-test-subj":"delete-timeline-modal",onDelete:d,title:r,closeModal:c})):null)}));F.displayName="DeleteTimelineModalOverlay";const D=({deleteTimelines:e,ids:t,savedSearchIds:n,isEnableDownloader:a,isDeleteTimelineModalOpen:r,onComplete:s,title:o})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(M,{"data-test-subj":"TimelineDownloader",exportedIds:t,isEnableDownloader:a,onComplete:s}),null!=e&&i.a.createElement(F,{"data-test-subj":"DeleteTimelineModalOverlay",deleteTimelines:e,isModalOpen:r,onComplete:s,savedObjectIds:t,savedSearchIds:n,title:o})),N=i.a.memo(D),R=()=>{const[e,t]=Object(a.useState)(null),[n,i]=Object(a.useState)(!1),[r,s]=Object(a.useState)(!1),o=Object(a.useCallback)((()=>{i(!1),t(null)}),[e]),l=Object(a.useCallback)((e=>{i(!0),null!=e&&t(e)}),[]),u=Object(a.useCallback)((e=>{s(!0),null!=e&&t(e)}),[]),c=Object(a.useCallback)((()=>{s(!1),t(null)}),[]);return{actionItem:e,onCompleteEditTimelineAction:Object(a.useCallback)((()=>{i(!1),s(!1),t(null)}),[]),isDeleteTimelineModalOpen:n,onCloseDeleteTimelineModal:o,onOpenDeleteTimelineModal:l,isEnableDownloader:r,enableExportTimelineDownloader:u,disableExportTimelineDownloader:c}},L=v.a.div.withConfig({displayName:"SearchRowContainer",componentId:"sc-1dq1et8-0"})(["&:not(:last-child){margin-bottom:",";}"],(e=>e.theme.eui.euiSizeL));L.displayName="SearchRowContainer";const z=v()(S.EuiFlexGroup).withConfig({displayName:"SearchRowFlexGroup",componentId:"sc-1dq1et8-1"})(["margin-bottom:",";"],(e=>e.theme.eui.euiSizeXS));z.displayName="SearchRowFlexGroup";const B=i.a.memo((({favoriteCount:e,onlyFavorites:t,onQueryChange:n,onToggleOnlyFavorites:r,children:s,timelineType:o})=>{const l=Object(a.useMemo)((()=>({placeholder:o===h.l.default?k.L:k.M,incremental:!1,"data-test-subj":"search-bar"})),[o]);return i.a.createElement(L,null,i.a.createElement(z,{gutterSize:"s"},i.a.createElement(S.EuiFlexItem,null,i.a.createElement(S.EuiSearchBar,{box:l,onChange:n})),i.a.createElement(S.EuiFlexItem,{grow:!1},i.a.createElement(S.EuiFilterGroup,{fullWidth:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiFilterButton,{"data-test-subj":"only-favorites-toggle",hasActiveFilters:t,onClick:r,numFilters:null!=e?e:void 0},k.D),!!s&&s)))))}));B.displayName="SearchRow";var q=n(23),$=n.n(q);const V=({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:a,onOpenTimeline:i,onCreateRule:r,onCreateRuleFromEql:s,hasCrudAccess:o})=>[{width:o?"80px":"150px",actions:[{name:k.g,icon:"timeline",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:h.l.default,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.g,"data-test-subj":"create-from-template",available:t=>t.timelineType===h.l.template&&e.includes("createFrom")},{name:k.f,icon:"visText",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineType:h.l.template,timelineId:e})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.f,"data-test-subj":"create-template-from-timeline",available:t=>t.timelineType!==h.l.template&&e.includes("createFrom")},{name:k.E,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.E,"data-test-subj":"open-duplicate",available:t=>t.timelineType!==h.l.template&&e.includes("duplicate")},{name:k.F,icon:"copy",onClick:({savedObjectId:e})=>{i({duplicate:!0,timelineId:null!=e?e:""})},type:"icon",enabled:({savedObjectId:e})=>null!=e,description:k.F,"data-test-subj":"open-duplicate-template",available:t=>t.timelineType===h.l.template&&e.includes("duplicate")},{name:k.o,icon:"exportAction",onClick:e=>{null!=n&&n(e)},enabled:e=>null!=e.savedObjectId&&e.status!==h.k.immutable,description:k.o,"data-test-subj":"export-timeline",available:()=>e.includes("export")},{name:k.i,icon:"trash",onClick:e=>{null!=a&&a(e)},enabled:({savedObjectId:e,status:t})=>null!=e&&t!==h.k.immutable,description:k.i,"data-test-subj":"delete-timeline",available:()=>e.includes("delete")&&null!=t},{name:k.d,icon:"indexEdit",onClick:e=>{null!=r&&e.savedObjectId&&r(e.savedObjectId)},enabled:e=>null!=r&&null!=e.savedObjectId&&e.status!==h.k.immutable,description:k.d,"data-test-subj":"create-rule-from-timeline",available:({queryType:t})=>e.includes("createRule")&&null!=r&&null!=t&&t.hasQuery},{name:k.e,icon:"indexEdit",onClick:e=>{null!=s&&e.savedObjectId&&s(e.savedObjectId)},enabled:e=>null!=s&&null!=e.savedObjectId&&e.status!==h.k.immutable,description:k.d,"data-test-subj":"create-rule-from-eql",available:({queryType:t})=>e.includes("createRuleFromEql")&&null!=s&&null!=t&&t.hasEql}]}],U="45px";var H=n(162),Z=n(697),G=n(126),Q=n(155);const W=v.a.span.withConfig({displayName:"LineClampTextContainer",componentId:"sc-4zme7l-0"})(["text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical;overflow:hidden;"]),K=({itemIdToExpandedNotesRowMap:e,onOpenTimeline:t,onToggleShowNotes:n,timelineType:a})=>[{isExpander:!0,render:({notes:t,savedObjectId:a})=>null!=t&&t.length>0&&null!=a?i.a.createElement(S.EuiButtonIcon,{"data-test-subj":"expand-notes",onClick:()=>null!=e[a]?n(Object(_.omit)(a,e)):n({...e,[a]:i.a.createElement(Z.a,{notes:t})}),"aria-label":e[a]?k.c:k.m,iconType:e[a]?"arrowDown":"arrowRight"}):null,width:U},{dataType:"string",field:"title",name:a===h.l.default?k.Y:k.Z,render:(e,n)=>null!=n.savedObjectId?i.a.createElement(S.EuiLink,{"data-test-subj":`timeline-title-${n.savedObjectId}`,onClick:()=>t({duplicate:!1,timelineId:`${n.savedObjectId}`})},Object(H.f)(n)?k.ab:i.a.createElement(W,null,e)):i.a.createElement("div",{"data-test-subj":`title-no-saved-object-id-${e||"no-title"}`},Object(H.f)(n)?k.ab:e),sortable:!1},{dataType:"string",field:"description",name:k.l,render:e=>i.a.createElement(W,{"data-test-subj":"description"},null!=e&&e.trim().length>0?e:Object(G.d)()),sortable:!1},{dataType:"date",field:"updated",name:k.y,render:(e,t)=>i.a.createElement("div",{"data-test-subj":"updated"},null!=t.updated?i.a.createElement(Q.b,{value:e}):Object(G.d)()),sortable:!0}],J=e=>e?[{dataType:"string",field:"updatedBy",name:k.B,render:e=>i.a.createElement("div",{"data-test-subj":"username"},Object(G.a)(e)),sortable:!1}]:[],Y=({timelineType:e})=>{const t={note:{align:"center",field:"eventIdToNoteIds",name:i.a.createElement(S.EuiToolTip,{content:k.C},i.a.createElement(S.EuiIcon,{"data-test-subj":"notes-count-header-icon",size:"m",type:"editorComment"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"notes-count"},Object(H.d)(t)),sortable:!1,width:U},pinnedEvent:{align:"center",field:"pinnedEventIds",name:i.a.createElement(S.EuiToolTip,{content:k.J},i.a.createElement(S.EuiIcon,{"data-test-subj":"pinned-event-header-icon",size:"m",type:"pin"})),render:(e,t)=>i.a.createElement("span",{"data-test-subj":"pinned-event-count"},`${Object(H.e)(t)}`),sortable:!1,width:U},favorite:{align:"center",field:"favorite",name:i.a.createElement(S.EuiToolTip,{content:k.p},i.a.createElement(S.EuiIcon,{"data-test-subj":"favorites-header-icon",size:"m",type:"starEmpty"})),render:e=>{const t=null!=e&&e.length>0?"starFilled":"starEmpty";return i.a.createElement(S.EuiIcon,{"data-test-subj":`favorite-${t}-star`,type:t,size:"m"})},sortable:!1,width:U}},n=[t.note,t.favorite],a=[t.pinnedEvent,t.note,t.favorite];return e===h.l.template?n:a},X=S.EuiBasicTable,ee=v()(X).withConfig({displayName:"BasicTable",componentId:"sc-1yfhyq7-0"})([".euiTableCellContent{animation:none;}.euiTableRow-isExpandedRow .euiTableCellContent__text{width:100%;}"]);ee.displayName="BasicTable";const te=i.a.memo((({actionTimelineToShow:e,deleteTimelines:t,defaultPageSize:n,loading:r,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:o,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:c,onOpenTimeline:d,onSelectionChange:p,onTableChange:m,onToggleShowNotes:f,pageIndex:g,pageSize:b,searchResults:y,showExtendedColumns:v,sortField:E,sortDirection:x,tableRef:j,timelineType:S,totalSearchResultsCount:w})=>{const T={showPerPageOptions:v,pageIndex:g,pageSize:b,pageSizeOptions:[Math.floor(Math.max(n,1)/2),n,2*n],totalItemCount:w},I={sort:{field:E,direction:x}},C={selectable:e=>null!=e.savedObjectId&&e.status!==h.k.immutable,selectableMessage:e=>e?void 0:k.A,onSelectionChange:p},M=null!=j?{ref:j}:{},{kibanaSecuritySolutionsPrivileges:_}=Object(O.a)(),A=Object(a.useMemo)((()=>(({actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,itemIdToExpandedNotesRowMap:a,onCreateRule:i,onCreateRuleFromEql:r,onOpenDeleteTimelineModal:s,onOpenTimeline:o,onToggleShowNotes:l,showExtendedColumns:u,timelineType:c,hasCrudAccess:d})=>[...K({itemIdToExpandedNotesRowMap:a,onOpenTimeline:o,onToggleShowNotes:l,timelineType:c}),...J(u),...Y({timelineType:c}),...e.length?V({onCreateRule:i,onCreateRuleFromEql:r,actionTimelineToShow:e,deleteTimelines:t,enableExportTimelineDownloader:n,onOpenDeleteTimelineModal:s,onOpenTimeline:o,hasCrudAccess:d}):[]])({actionTimelineToShow:e,deleteTimelines:t,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:o,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:c,onOpenTimeline:d,onSelectionChange:p,onToggleShowNotes:f,showExtendedColumns:v,timelineType:S,hasCrudAccess:_.crud})),[e,t,s,o,l,u,c,d,p,f,v,S,_]),P=r||null==y?k.z:S===h.l.template?k.db:k.cb;return i.a.createElement(ee,$()({columns:A,"data-test-subj":"timelines-table",isExpandable:!0,isSelectable:e.includes("selectable"),itemId:"savedObjectId",itemIdToExpandedRowMap:s,items:null!=y?y:[],loading:r,noItemsMessage:P,onChange:m,pagination:T,selection:e.includes("selectable")?C:void 0,sorting:I},M))}));te.displayName="TimelinesTable";const ne=v.a.span.withConfig({displayName:"QueryText",componentId:"sc-1qxahey-0"})(["white-space:normal;word-break:break-word;"]),ae=i.a.memo((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,isLoading:r,itemIdToExpandedNotesRowMap:s,importDataModalToggle:o,onCreateRule:l,onCreateRuleFromEql:u,onDeleteSelected:c,onlyFavorites:d,onOpenTimeline:p,onQueryChange:m,onSelectionChange:f,onTableChange:g,onToggleOnlyFavorites:y,onToggleShowNotes:v,pageIndex:w,pageSize:T,query:I,refetch:C,searchResults:M,selectedItems:_,sortDirection:A,setImportDataModalToggle:P,sortField:F,timelineType:D=h.l.default,timelineStatus:L,timelineFilter:z,templateTimelineFilter:q,totalSearchResultsCount:$})=>{var V;const U=Object(a.useRef)(),{actionItem:Z,enableExportTimelineDownloader:G,isEnableDownloader:Q,isDeleteTimelineModalOpen:W,onOpenDeleteTimelineModal:K,onCompleteEditTimelineAction:J}=R(),{kibanaSecuritySolutionsPrivileges:Y}=Object(O.a)(),{getBatchItemsPopoverContent:X}=(({deleteTimelines:e,selectedItems:t,tableRef:n,timelineType:r=h.l.default})=>{const{enableExportTimelineDownloader:s,disableExportTimelineDownloader:o,isEnableDownloader:l,isDeleteTimelineModalOpen:u,onOpenDeleteTimelineModal:c,onCloseDeleteTimelineModal:d}=R(),p=Object(a.useCallback)((e=>{null!=e&&e(),null!=n&&null!=n.current&&n.current.changeSelection([]),o(),d()}),[o,d,n]),{timelineIds:m,searchIds:f}=Object(a.useMemo)((()=>null!=t?ye(be(t)):{timelineIds:[],searchIds:void 0}),[t]),g=Object(a.useCallback)((()=>s()),[s]),b=Object(a.useCallback)((()=>c()),[c]),y=Object(a.useCallback)((n=>{var a,s,o,c;const d=null==t||0===t.length,y=[];return t&&y.push(i.a.createElement(S.EuiContextMenuItem,{"data-test-subj":"export-timeline-action",disabled:d,icon:"exportAction",key:"ExportItemKey",onClick:g},k.o)),e&&y.push(i.a.createElement(S.EuiContextMenuItem,{"data-test-subj":"delete-timeline-action",disabled:d,icon:"trash",key:"DeleteItemKey",onClick:b},k.i)),i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{deleteTimelines:e,ids:m,savedSearchIds:f,isEnableDownloader:l,isDeleteTimelineModalOpen:u,onComplete:p.bind(null,n),title:1!==(null==t?void 0:t.length)?r===h.l.template?k.N(null!==(a=null==t?void 0:t.length)&&void 0!==a?a:0):k.O(null!==(s=null==t?void 0:t.length)&&void 0!==s?s:0):null!==(o=null===(c=t[0])||void 0===c?void 0:c.title)&&void 0!==o?o:""}),i.a.createElement(S.EuiContextMenuPanel,{items:y}))}),[t,e,m,f,l,u,p,r,g,b]);return{onCompleteBatchActions:p,getBatchItemsPopoverContent:y}})({deleteTimelines:Y.crud?e:void 0,selectedItems:_,tableRef:U,timelineType:D}),ee=Object(a.useMemo)((()=>i.a.createElement(b.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTemplatesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {template} other {templates}} {with}",values:{totalSearchResultsCount:$,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},I.trim().length?`${k.bb} "${I.trim()}"`:"")}})),[$,I]),ae=Object(a.useMemo)((()=>i.a.createElement(b.FormattedMessage,{id:"xpack.securitySolution.open.timeline.showingNTimelinesLabel",defaultMessage:"{totalSearchResultsCount} {totalSearchResultsCount, plural, one {timeline} other {timelines}} {with}",values:{totalSearchResultsCount:$,with:i.a.createElement(ne,{"data-test-subj":"selectable-query-text"},I.trim().length?`${k.bb} "${I.trim()}"`:"")}})),[$,I]),ie=Object(a.useMemo)((()=>null!=Z&&null!=Z.savedObjectId?[Z.savedObjectId]:[]),[Z]),re=Object(a.useMemo)((()=>null!=Z&&null!=Z.savedSearchId?[Z.savedSearchId]:void 0),[Z]),se=Object(a.useCallback)((()=>{null!=C&&C()}),[C]),oe=Object(a.useCallback)((()=>{null!=P&&P(!1)}),[P]),le=Object(a.useCallback)((()=>{null!=P&&P(!1),null!=C&&C()}),[P,C]),ue=Object(a.useMemo)((()=>{if(Y.crud){const t=["createFrom","duplicate",...null!=l?["createRule"]:[],...null!=u?["createRuleFromEql"]:[]];return L!==h.k.immutable&&(t.push("export"),t.push("selectable")),null!=c&&null!=e&&L!==h.k.immutable&&t.push("delete"),t}return L!==h.k.immutable?["export","selectable"]:[]}),[l,u,L,c,e,Y]),ce=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,q)),[q]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(N,{deleteTimelines:e,ids:ie,savedSearchIds:re,isDeleteTimelineModalOpen:W,isEnableDownloader:Q,onComplete:J,title:null!==(V=null==Z?void 0:Z.title)&&void 0!==V?V:k.ab}),i.a.createElement(E.a,{checkBoxLabel:k.I,closeModal:oe,description:k.P,errorMessage:k.t,failedDetailed:k.u,importComplete:le,importData:j.f,successMessage:k.V,showCheckBox:!1,showModal:null!=o&&o,submitBtnText:k.w,subtitle:k.x,title:k.v}),i.a.createElement("div",{className:H.a},!!z&&z,i.a.createElement(B,{"data-test-subj":"search-row",favoriteCount:n,onlyFavorites:d,onQueryChange:m,onToggleOnlyFavorites:y,query:I,timelineType:D},ce),i.a.createElement(x.a,{border:!0},i.a.createElement(x.d,null,i.a.createElement(x.c,null,i.a.createElement(x.e,{"data-test-subj":"query-message"},i.a.createElement(i.a.Fragment,null,k.Q," ",D===h.l.template?ee:ae))),i.a.createElement(x.c,null,L!==h.k.immutable&&i.a.createElement(i.a.Fragment,null,i.a.createElement(x.e,{"data-test-subj":"selected-count"},D===h.l.template?k.N(_.length):k.O(_.length)),i.a.createElement(x.b,{dataTestSubj:"batchActions",iconSide:"right",iconType:"arrowDown",popoverContent:X,"data-test-subj":"utility-bar-action"},i.a.createElement("span",{"data-test-subj":"utility-bar-action-button"},k.a))),i.a.createElement(x.b,{dataTestSubj:"refreshButton",iconSide:"right",iconType:"refresh",onClick:se},k.K)))),i.a.createElement(te,{actionTimelineToShow:ue,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:r,itemIdToExpandedNotesRowMap:s,enableExportTimelineDownloader:G,onCreateRule:l,onCreateRuleFromEql:u,onOpenDeleteTimelineModal:K,onOpenTimeline:p,onSelectionChange:f,onTableChange:g,onToggleShowNotes:v,pageIndex:w,pageSize:T,searchResults:M,showExtendedColumns:!0,sortDirection:A,sortField:F,timelineType:D,tableRef:U,totalSearchResultsCount:$})))}));ae.displayName="OpenTimeline";var ie=n(170);const re=i.a.memo((({children:e,onAddTimelinesToFavorites:t,selectedTimelinesCount:n,title:a})=>i.a.createElement(ie.a,{title:a,split:!0,height:40},i.a.createElement(S.EuiFlexGroup,{gutterSize:"s",responsive:!1},t&&i.a.createElement(S.EuiFlexItem,{grow:!1},i.a.createElement(S.EuiButton,{"data-test-subj":"favorite-selected",iconSide:"left",iconType:"starEmptySpace",isDisabled:0===n,onClick:t},k.q)),e&&i.a.createElement(S.EuiFlexItem,null,e)))));re.displayName="TitleRow";const se=v.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-98e87t-0"})(["width:100%;"]);se.displayName="HeaderContainer";const oe=Object(a.memo)((({deleteTimelines:e,defaultPageSize:t,favoriteCount:n,hideActions:r=[],isLoading:s,itemIdToExpandedNotesRowMap:o,onAddTimelinesToFavorites:l,onDeleteSelected:u,onlyFavorites:c,onOpenTimeline:d,onQueryChange:p,onSelectionChange:m,onTableChange:f,onToggleOnlyFavorites:g,onToggleShowNotes:b,pageIndex:y,pageSize:v,searchResults:h,selectedItems:E,sortDirection:x,sortField:j,timelineFilter:O,timelineType:k,templateTimelineFilter:w,title:T,totalSearchResultsCount:I})=>{const C=Object(a.useMemo)((()=>{const t=["createFrom","duplicate"];return null!=u&&null!=e&&t.push("delete"),t.filter((e=>!r.includes(e)))}),[u,e,r]),M=Object(a.useMemo)((()=>i.a.createElement(a.Fragment,{key:"search-row-content"},!!w&&w)),[w]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiModalHeader,null,i.a.createElement(se,null,i.a.createElement(re,{"data-test-subj":"title-row",onAddTimelinesToFavorites:l,selectedTimelinesCount:E.length,title:T}))),i.a.createElement(S.EuiModalBody,null,i.a.createElement(i.a.Fragment,null,!!O&&i.a.createElement(i.a.Fragment,null,O,i.a.createElement(S.EuiSpacer,{size:"m"})),i.a.createElement(B,{"data-test-subj":"search-row",onlyFavorites:c,onQueryChange:p,onToggleOnlyFavorites:g,query:"",timelineType:k},M),i.a.createElement(te,{actionTimelineToShow:C,"data-test-subj":"timelines-table",deleteTimelines:e,defaultPageSize:t,loading:s,itemIdToExpandedNotesRowMap:o,onOpenTimeline:d,onSelectionChange:m,onTableChange:f,onToggleShowNotes:b,pageIndex:y,pageSize:v,searchResults:h,showExtendedColumns:!1,sortDirection:x,sortField:j,timelineType:k,totalSearchResultsCount:I}))))}));oe.displayName="OpenTimelineModalBody";var le=n(129),ue=n(164);let ce;!function(e){e.tab="tab",e.filter="filter"}(ce||(ce={}));var de=n(718),pe=n(116),me=n(121),fe=n(184),ge=n(224);const be=e=>e.reduce(((e,t)=>null!=t.savedObjectId&&null!=t.savedSearchId?[...e,{timelineId:t.savedObjectId,searchId:t.savedSearchId}]:null!=t.savedObjectId?[...e,{timelineId:t.savedObjectId}]:e),[]),ye=e=>e.reduce(((e,{timelineId:t,searchId:n})=>{let a=e;return null!=n&&(a={...a,searchIds:[...a.searchIds,n]}),null!=t&&(a={...a,timelineIds:[...a.timelineIds,t]}),a}),{timelineIds:[],searchIds:[]}),ve=i.a.memo((({closeModalTimeline:e,defaultPageSize:t,hideActions:n=[],isModal:b=!1,importDataModalToggle:y,onOpenTimeline:v,setImportDataModalToggle:E,title:x})=>{const O=Object(r.useDispatch)(),{startTransaction:T}=Object(fe.b)(),[I,C]=Object(a.useState)({}),[M,A]=Object(a.useState)(!1),[P,F]=Object(a.useState)(0),[D,N]=Object(a.useState)(t),[R,L]=Object(a.useState)(""),[z,B]=Object(a.useState)([]),[q,$]=Object(a.useState)("desc"),[V,U]=Object(a.useState)("updated"),Z=Object(a.useMemo)((()=>p.b.getTimelineByIdSelector()),[]),G=Object(c.b)((e=>{var t,n;return null!==(t=null===(n=Z(e,d.c.active))||void 0===n?void 0:n.savedObjectId)&&void 0!==t?t:""})),{dataViewId:Q,selectedPatterns:W}=Object(me.d)(pe.SourcererScopeName.timeline),K=Object(a.useMemo)((()=>Object(H.b)(O)),[O]),J=Object(a.useCallback)((e=>O(Object(m.updateIsLoading)(e))),[O]),{customTemplateTimelineCount:Y,defaultTimelineCount:X,elasticTemplateTimelineCount:ee,favoriteCount:te,fetchAllTimeline:ne,timelines:ie,loading:re,totalCount:se,templateTimelineCount:ve}=Object(f.b)(),{timelineType:he,timelineTabs:Ee,timelineFilters:xe}=(({defaultTimelineCount:e,templateTimelineCount:t})=>{const{formatUrl:n,search:r}=Object(ue.l)(le.a.timelines),{navigateToUrl:s}=Object(l.i)().services.application,{tabName:o}=Object(w.useParams)(),[u,c]=Object(a.useState)(o===h.l.default||o===h.l.template?o:h.l.default),d=n(Object(ue.j)(h.l.default,r)),p=n(Object(ue.j)(h.l.template,r)),m=Object(a.useCallback)((e=>{e.preventDefault(),s(d)}),[s,d]),f=Object(a.useCallback)((e=>{e.preventDefault(),s(p)}),[s,p]),g=Object(a.useCallback)((e=>[{id:h.l.default,name:k.X,href:d,disabled:!1,onClick:e===ce.tab?m:_.noop},{id:h.l.template,name:k.W,href:p,disabled:!1,onClick:e===ce.tab?f:_.noop}]),[d,p,m,f]),b=Object(a.useCallback)(((e,t)=>{c((t=>(t!==e&&c(e),t)))}),[c]),y=Object(a.useMemo)((()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(S.EuiTabs,{"data-test-subj":"open-timeline-subtabs"},g(ce.tab).map((e=>i.a.createElement(S.EuiTab,{"data-test-subj":`timeline-${ce.tab}-${e.id}`,isSelected:e.id===o,disabled:e.disabled,key:`timeline-${ce.tab}-${e.id}`,href:e.href,onClick:t=>{e.onClick(t),b(e.id,ce.tab)}},e.name)))),i.a.createElement(S.EuiSpacer,{size:"m"}))),[o]),v=Object(a.useMemo)((()=>i.a.createElement(S.EuiTabs,null,g(ce.filter).map((e=>i.a.createElement(S.EuiTab,{"data-test-subj":`open-timeline-modal-body-${ce.filter}-${e.id}`,isSelected:e.id===u,key:`timeline-${ce.filter}-${e.id}`,onClick:t=>{e.onClick(t),b(e.id,ce.filter)}},e.name))))),[u,g,b]);return{timelineType:u,timelineTabs:y,timelineFilters:v}})({defaultTimelineCount:X,templateTimelineCount:ve}),{timelineStatus:je,templateTimelineFilter:Oe,installPrepackagedTimelines:Se}=Object(de.a)({timelineType:he,customTemplateTimelineCount:Y,elasticTemplateTimelineCount:ee}),ke=Object(a.useCallback)((()=>{ne({pageInfo:{pageIndex:P+1,pageSize:D},search:R,sort:{sortField:V,sortOrder:q},onlyUserFavorite:M,timelineType:he,status:je})}),[ne,P,D,R,V,q,he,je,M]),we=Object(a.useCallback)((e=>{L(e.queryText.trim())}),[]),Te=Object(a.useCallback)((async(e,t)=>{T({name:e.length>1?ge.f.BULK_DELETE:ge.f.DELETE}),e.includes(G)&&O(Object(m.createTimeline)({id:d.c.active,columns:g.b,dataViewId:Q,indexNames:W,show:!1})),await Object(j.b)(e,t),ke()}),[T,G,ke,O,Q,W]),Ie=Object(a.useCallback)((async(e,t)=>{await Te(e,t)}),[Te]),Ce=Object(a.useCallback)((async()=>{const e=be(z),{timelineIds:t,searchIds:n}=ye(e);await Te(t,n),Re()}),[z,Te]),Me=Object(a.useCallback)((e=>{B(e)}),[]),_e=Object(a.useCallback)((({page:e,sort:t})=>{const{index:n,size:a}=e,{field:i,direction:r}=t;F(n),N(a),$(r),U(i)}),[]),Ae=Object(a.useCallback)((()=>{A(!M)}),[M]),Pe=Object(a.useCallback)((e=>{C(e)}),[]),{navigateTo:Fe}=Object(l.k)(),De=Object(a.useCallback)((e=>Fe({deepLinkId:u.yc.rulesCreate,path:`?${o.b}=${Object(s.encode)(e)}`})),[Fe]),Ne=Object(a.useCallback)((e=>Fe({deepLinkId:u.yc.rulesCreate,path:`?${o.a}=${Object(s.encode)(e)}`})),[Fe]),Re=Object(a.useCallback)((()=>{B([])}),[]),Le=Object(a.useCallback)((({duplicate:t,timelineId:n,timelineType:a})=>{t&&T({name:ge.f.DUPLICATE}),b&&null!=e&&e(),Object(H.h)({duplicate:t,onOpenTimeline:v,timelineId:n,timelineType:a,updateIsLoading:J,updateTimeline:K})}),[J,K]);return Object(a.useEffect)((()=>{(()=>{const e=document.querySelector(`.${H.a} input`);null!=e&&e.focus()})()}),[]),Object(a.useEffect)((()=>{(async()=>{await Se(),ke()})()}),[ke,Se]),b?i.a.createElement(oe,{"data-test-subj":"open-timeline-modal",deleteTimelines:Ie,defaultPageSize:t,favoriteCount:te,hideActions:n,isLoading:re,itemIdToExpandedNotesRowMap:I,onAddTimelinesToFavorites:void 0,onlyFavorites:M,onOpenTimeline:Le,onQueryChange:we,onSelectionChange:Me,onTableChange:_e,onToggleOnlyFavorites:Ae,onToggleShowNotes:Pe,pageIndex:P,pageSize:D,query:R,searchResults:ie,selectedItems:z,sortDirection:q,sortField:V,templateTimelineFilter:Oe,timelineType:he,timelineStatus:je,timelineFilter:xe,title:x,totalSearchResultsCount:se}):i.a.createElement(ae,{"data-test-subj":"open-timeline",deleteTimelines:Ie,defaultPageSize:t,favoriteCount:te,isLoading:re,itemIdToExpandedNotesRowMap:I,importDataModalToggle:y,onAddTimelinesToFavorites:void 0,onCreateRule:De,onCreateRuleFromEql:Ne,onDeleteSelected:Ce,onlyFavorites:M,onOpenTimeline:Le,onQueryChange:we,onSelectionChange:Me,onTableChange:_e,onToggleOnlyFavorites:Ae,onToggleShowNotes:Pe,pageIndex:P,pageSize:D,query:R,refetch:ke,searchResults:ie,setImportDataModalToggle:E,selectedItems:z,sortDirection:q,sortField:V,templateTimelineFilter:Oe,timelineType:he,timelineStatus:je,timelineFilter:Ee,title:x,totalSearchResultsCount:se})})),he=i.a.memo(ve)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Le}));var a=n(17),i=n(2),r=n.n(i),s=n(45),o=n(48),l=n(44),u=n.n(l),c=n(54),d=n(69),p=n(203),m=n(112),f=n(118),g=n(110),b=n(121),y=n(145),v=n(172),h=n(116),E=n(113),x=n(430),j=n(244),O=n(5);const S=e=>O.i18n.translate("xpack.securitySolution.timeline.flyout.header.closeTimelineButtonLabel",{defaultMessage:"Close {isTimeline, select, true {timeline} false {template}}",values:{isTimeline:e}}),k=O.i18n.translate("xpack.securitySolution.timeline.properties.unsavedLabel",{defaultMessage:"Unsaved"}),w=(O.i18n.translate("xpack.securitySolution.timeline.properties.savedLabel",{defaultMessage:"Saved"}),O.i18n.translate("xpack.securitySolution.timeline.properties.hasChangesLabel",{defaultMessage:"Unsaved changes"})),T=(O.i18n.translate("xpack.securitySolution.timeline.properties.inspectTimelineTitle",{defaultMessage:"Timeline"}),O.i18n.translate("xpack.securitySolution.timeline.properties.readMore",{defaultMessage:"Read More"}),({isOpen:e,title:t})=>O.i18n.translate("xpack.securitySolution.timeline.properties.timelineToggleButtonAriaLabel",{values:{isOpen:e,title:t},defaultMessage:"{isOpen, select, false {Open} true {Close} other {Toggle}} timeline {title}"})),I=u()(a.EuiButtonEmpty).withConfig({displayName:"StyledEuiButtonEmpty",componentId:"sc-m1giyi-0"})(["&:active,&:focus{background:transparent;}> span{padding:0;}"]),C=u()(a.EuiFlexItem).withConfig({displayName:"TitleConatiner",componentId:"sc-m1giyi-1"})(["overflow:hidden;display:inline-block;text-overflow:ellipsis;white-space:nowrap;"]),M=({timelineId:e,timelineType:t,timelineTitle:n,isOpen:l})=>{const u=Object(o.useDispatch)(),c=Object(i.useCallback)((()=>{u(f.a.showTimeline({id:e,show:!l})),Object(y.i)()}),[u,l,e]),d=Object(s.isEmpty)(n)?t===E.l.template?j.k:j.l:n,p=Object(i.useMemo)((()=>r.a.createElement(a.EuiFlexGroup,{gutterSize:"none",alignItems:"center",justifyContent:"flexStart",responsive:!1},r.a.createElement(C,{"data-test-subj":"timeline-title",grow:!1},l?r.a.createElement(a.EuiText,{grow:!1},r.a.createElement("h3",null,d)):r.a.createElement(r.a.Fragment,null,d)),!l&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(x.b,null)))),[l,d]);return l?r.a.createElement(r.a.Fragment,null,p):r.a.createElement(I,{"aria-label":T({isOpen:l,title:d}),className:y.b,flush:"both","data-test-subj":"flyoutOverlay",size:"s",isSelected:l,onClick:c},p)},_=r.a.memo(M);var A=n(212),P=n(39),F=n(159),D=n(119),N=n(4),R=n(14),L=n(122),z=n(164),B=n(129),q=n(134);const $=({timelineId:e})=>{const t=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{cases:n,application:{navigateToApp:l}}=Object(g.i)().services,u=Object(o.useDispatch)(),{graphEventId:c,savedObjectId:d,status:p,title:b,timelineType:y}=Object(m.a)((n=>{var a;return Object(s.pick)(["graphEventId","savedObjectId","status","title","timelineType"],null!==(a=t(n,e))&&void 0!==a?a:q.b)})),[v,h]=Object(i.useState)(!1),[x,O]=Object(i.useState)(!1),S=Object(i.useCallback)((async t=>{O(!1),await l(N.l,{deepLinkId:B.a.case,path:null!=t?Object(z.a)({id:t.id}):Object(z.b)()}),u(Object(R.setInsertTimeline)({graphEventId:c,timelineId:e,timelineSavedObjectId:d,timelineTitle:b}))}),[u,c,l,d,e,b]),k=n.helpers.canUseCases([N.i]),w=Object(i.useCallback)((()=>{h((e=>!e))}),[]),T=Object(i.useCallback)((()=>h(!1)),[]),I=Object(i.useCallback)((()=>{T(),l(N.l,{deepLinkId:B.a.case,path:Object(z.b)()}).then((()=>{u(Object(R.setInsertTimeline)({graphEventId:c,timelineId:e,timelineSavedObjectId:d,timelineTitle:b.length>0?b:j.l})),u(Object(R.showTimeline)({id:L.c.active,show:!1}))}))}),[u,c,l,T,d,e,b]),C=Object(i.useCallback)((()=>{T(),O(!0)}),[O,T]),M=Object(i.useCallback)((()=>{O(!1)}),[O]),_=Object(i.useCallback)((()=>{h(!1)}),[]),A=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonEmpty,{size:"m","data-test-subj":"attach-timeline-case-button",iconType:"arrowDown",iconSide:"right",onClick:w,disabled:p===E.k.draft||y!==E.l.default},j.c)),[w,p,y]),P=Object(i.useMemo)((()=>[r.a.createElement(a.EuiContextMenuItem,{key:"new-case","data-test-subj":"attach-timeline-new-case",onClick:I},j.e),r.a.createElement(a.EuiContextMenuItem,{key:"existing-case","data-test-subj":"attach-timeline-existing-case",onClick:C},j.d)]),[C,I]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiPopover,{id:"singlePanel",button:A,isOpen:v,closePopover:_,panelPaddingSize:"none",anchorPosition:"downLeft"},r.a.createElement(a.EuiContextMenuPanel,{items:P})),x&&n.ui.getAllCasesSelectorModal({onRowClick:S,onClose:M,owner:[N.i],permissions:k}))};$.displayName="AddToCaseButtonComponent";const V=r.a.memo($);var U=n(327),H=n(466);const Z=O.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimelineBtn",{defaultMessage:"New"}),G=O.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimeline",{defaultMessage:"New Timeline"}),Q=O.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.openTimelineBtn",{defaultMessage:"Open"}),W=O.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.openTimelineBtnLabel",{defaultMessage:"Open Existing Timeline"}),K=(O.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.saveTimelineBtn",{defaultMessage:"Save"}),O.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.saveTimelineBtnLabel",{defaultMessage:"Save currently opened Timeline"}),O.i18n.translate("xpack.securitySolution.flyout.timeline.actionMenu.newTimelineTemplate",{defaultMessage:"New Timeline template"})),J=O.i18n.translate("xpack.securitySolution.timeline.callOut.unauthorized.message.description",{defaultMessage:"You can use Timeline to investigate events, but you do not have the required permissions to save timelines for future use. If you need to save timelines, contact your Kibana administrator."}),Y=(O.i18n.translate("xpack.securitySolution.timeline.callOut.immutable.message.description",{defaultMessage:"This prebuilt timeline template cannot be modified. To make changes, please duplicate this template and make modifications to the duplicate template."}),O.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.header",{defaultMessage:"Save Timeline"})),X=O.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.header",{defaultMessage:"Save Timeline Template"}),ee=O.i18n.translate("xpack.securitySolution.timeline.nameTimeline.save.title",{defaultMessage:"Save"}),te=O.i18n.translate("xpack.securitySolution.timeline.nameTimelineTemplate.modal.header",{defaultMessage:"Name Timeline Template"}),ne=O.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.discard.title",{defaultMessage:"Discard Timeline"}),ae=O.i18n.translate("xpack.securitySolution.timeline.saveTimelineTemplate.modal.discard.title",{defaultMessage:"Discard Timeline Template"}),ie=O.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.close.title",{defaultMessage:"Close"}),re=O.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.titleAriaLabel",{defaultMessage:"Title"}),se=O.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.descriptionLabel",{defaultMessage:"Description"}),oe=O.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.optionalLabel",{defaultMessage:"Optional"}),le=(O.i18n.translate("xpack.securitySolution.timeline.flyout.saveTour.closeButton",{defaultMessage:"Close"}),O.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.title",{defaultMessage:"Title"})),ue=(O.i18n.translate("xpack.securitySolution.timeline.flyout.saveTour.title",{defaultMessage:"Timeline changes now require manual saves"}),O.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.saveAsNew",{defaultMessage:"Save as new timeline"})),ce={padding:0},de=r.a.memo((({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),s=Object(i.useCallback)((()=>{n(!1)}),[]),o=Object(i.useCallback)((()=>n((e=>!e))),[]),l=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonEmpty,{iconType:"arrowDown",size:"s",iconSide:"right",onClick:o},Z)),[o]);return r.a.createElement(a.EuiPopover,{button:l,isOpen:t,closePopover:s,panelStyle:ce},r.a.createElement(a.EuiFlexGroup,{gutterSize:"xs",direction:"column",alignItems:"flexStart"},r.a.createElement(a.EuiFlexItem,null,r.a.createElement(U.c,{timelineId:e,title:G,onClick:s})),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(H.a,{timelineId:e,title:K,onClick:s}))))}));de.displayName="NewTimelineAction";var pe=n(135),me=n(235),fe=n.n(me),ge=n(146),be=n(184),ye=n(224),ve=n(228);const he={title:{type:ge.a.TEXT,validations:[{validator:ge.h.emptyField("")}]},description:{type:ge.a.TEXTAREA,validations:[]}},Ee=Object(ge.j)({component:ge.b}),xe=r.a.memo((({closeSaveTimeline:e,initialFocusOn:t,timelineId:n,showWarning:l})=>{const{startTransaction:u}=Object(be.b)(),c=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{isSaving:d,description:p="",status:g,title:b="",timelineType:y}=Object(m.a)((e=>Object(s.pick)(["isSaving","description","status","title","timelineType"],c(e,n)))),v=g===E.k.draft,h=fe()(d),x=Object(o.useDispatch)(),S=Object(ve.a)({timelineId:L.c.active,timelineType:E.l.default}),[k,w]=Object(i.useState)(!1),T=Object(i.useCallback)((e=>w(e.target.checked)),[]),I=Object(i.useCallback)(((e,t)=>(t&&(x(f.a.updateTitleAndDescription({id:n,...e})),x(f.a.saveTimeline({id:n,saveAsNew:k}))),Promise.resolve())),[x,n,k]),C=Object(i.useMemo)((()=>({title:b,description:p})),[b,p]),{form:M}=Object(ge.k)({id:"timelineTitleAndDescriptionForm",schema:he,onSubmit:I,options:{stripEmptyFields:!1},defaultValue:C}),{isSubmitted:_,isSubmitting:A,submit:P}=M,F=Object(i.useCallback)((()=>{u({name:ye.f.SAVE}),P()}),[P,u]),D=Object(i.useCallback)((()=>{l&&S(),e()}),[e,S,l]),N=Object(i.useMemo)((()=>g===E.k.draft&&l?y===E.l.template?ae:ne:ie),[l,g,y]),R=Object(i.useMemo)((()=>g===E.k.draft?y===E.l.template?X:Y:y===E.l.template?te:Y),[g,y]),z=Object(i.useMemo)((()=>g===E.k.draft&&l?y===E.l.template?X:Y:ee),[l,g,y]),B=Object(i.useMemo)((()=>(e=>O.i18n.translate("xpack.securitySolution.timeline.saveTimeline.modal.warning.title",{values:{timeline:e===E.l.template?"timeline template":"timeline"},defaultMessage:"You have an unsaved {timeline}. Do you wish to save it?"}))(y)),[y]),q=Object(i.useMemo)((()=>`${se} (${oe})`),[]),$=Object(i.useMemo)((()=>({"aria-label":re,autoFocus:"title"===t,"data-test-subj":"save-timeline-title",disabled:d,spellCheck:!0,placeholder:y===E.l.template?j.k:j.l})),[t,d,y]),V=Object(i.useMemo)((()=>({"aria-label":se,"data-test-subj":"save-timeline-description",disabled:d,placeholder:j.f})),[d]);return Object(i.useEffect)((()=>{_&&!d&&h&&e()}),[_,d,h,e]),r.a.createElement(a.EuiModal,{"data-test-subj":"save-timeline-modal",maxWidth:1024,onClose:e},d&&r.a.createElement(a.EuiProgress,{size:"s",color:"primary",position:"absolute","data-test-subj":"progress-bar"}),r.a.createElement(a.EuiModalHeader,{"data-test-subj":"modal-header"},R),r.a.createElement(a.EuiModalBody,null,l&&r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(a.EuiCallOut,{title:B,color:"danger",iconType:"warning","data-test-subj":"edit-timeline-callout"}),r.a.createElement(a.EuiSpacer,{size:"m"})),r.a.createElement(ge.c,{form:M},r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(Ee,{path:"title",fullWidth:!0,label:le,euiFieldProps:$}),r.a.createElement(a.EuiSpacer,null)),r.a.createElement(a.EuiFlexItem,{grow:!0},r.a.createElement(Ee,{label:q,path:"description",fullWidth:!0,euiFieldProps:V}),r.a.createElement(a.EuiSpacer,null)),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFlexGroup,{direction:"row",alignItems:"center"},v?null:r.a.createElement(a.EuiSwitch,{label:ue,checked:k,onChange:T,"data-test-subj":"save-as-new-switch"}),r.a.createElement(a.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"s"},r.a.createElement(a.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(a.EuiButton,{size:"s",fill:!1,onClick:D,isDisabled:d,"data-test-subj":"close-button"},N)),r.a.createElement(a.EuiFlexItem,{grow:!1,component:"span"},r.a.createElement(a.EuiButton,{autoFocus:"save"===t,size:"s",isDisabled:d||A,fill:!0,onClick:F,"data-test-subj":"save-button"},z))))))))}));xe.displayName="SaveTimelineModal";var je=n(57),Oe=n(292);const Se=r.a.memo((({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),s=Object(i.useCallback)((()=>{n(!1)}),[]),o=Object(i.useCallback)((()=>{n(!0)}),[]),{kibanaSecuritySolutionsPrivileges:{crud:l}}=Object(pe.a)(),u=Object(i.useMemo)((()=>Object(je.createSelector)(f.b.selectTimeline,(e=>{var t,n,a,i,r,s;return{status:null!==(t=null==e?void 0:e.status)&&void 0!==t?t:E.k.draft,updated:null!==(n=null==e?void 0:e.updated)&&void 0!==n?n:void 0,isSaving:null!==(a=null==e?void 0:e.isSaving)&&void 0!==a?a:void 0,isLoading:null!==(i=null==e?void 0:e.isLoading)&&void 0!==i?i:void 0,changed:null!==(r=null==e?void 0:e.changed)&&void 0!==r?r:void 0,show:null!==(s=null==e?void 0:e.show)&&void 0!==s?s:void 0}}))),[]),{status:c,isSaving:d}=Object(m.a)((t=>u(t,e))),p=l&&c!==E.k.immutable,g=c===E.k.draft,b=p?null:J;return r.a.createElement(a.EuiToolTip,{content:b,position:"bottom","data-test-subj":"save-timeline-btn-tooltip"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiButton,{id:Oe.a.SAVE_TIMELINE,fill:!0,color:"primary",onClick:o,size:"s",iconType:"save",isLoading:d,disabled:!p,"data-test-subj":"save-timeline-action-btn"},ee),t&&p?r.a.createElement(xe,{closeSaveTimeline:s,initialFocusOn:g?"title":"save",timelineId:e,showWarning:!1}):null))}));Se.displayName="SaveTimelineButton";var ke=n(467);const we=["createFrom"],Te=r.a.memo((()=>{const[e,t]=Object(i.useState)(!1),n=Object(i.useCallback)((()=>t(!1)),[]),s=Object(i.useCallback)((()=>{t(!0)}),[]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiButtonEmpty,{"data-test-subj":"open-timeline-button",onClick:s,"aria-label":W},Q),e?r.a.createElement(ke.a,{onClose:n,hideActions:we}):null)}));Te.displayName="OpenTimelineAction";const Ie=u.a.span.withConfig({displayName:"VerticalDivider",componentId:"sc-1qnxttj-0"})(["width:0px;height:20px;border-left:1px solid ",";"],(({theme:e})=>e.eui.euiColorLightShade)),Ce=({mode:e="normal",timelineId:t,activeTab:n,isInspectButtonDisabled:i})=>{const{cases:s}=Object(A.b)().services,o=s.helpers.canUseCases([P.APP_ID]);return r.a.createElement(a.EuiFlexGroup,{id:Oe.a.ACTION_MENU,gutterSize:"xs",justifyContent:"flexEnd",alignItems:"center",responsive:!1,"data-test-subj":"timeline-action-menu"},r.a.createElement(a.EuiFlexItem,{"data-test-subj":"new-timeline-action"},r.a.createElement(de,{timelineId:t})),r.a.createElement(a.EuiFlexItem,{"data-test-subj":"open-timeline-action"},r.a.createElement(Te,null)),r.a.createElement(a.EuiFlexItem,{"data-test-subj":"inspect-timeline-action"},r.a.createElement(F.b,{compact:"compact"===e,queryId:`${t}-${n}`,inputId:D.a.timeline,isDisabled:i,title:""})),o.create&&o.read?r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexItem,null,r.a.createElement(Ie,null)),r.a.createElement(a.EuiFlexItem,null,r.a.createElement(V,{timelineId:t}))):null,r.a.createElement(a.EuiFlexItem,{"data-test-subj":"save-timeline-action"},r.a.createElement(Se,{timelineId:t})))},Me=r.a.memo(Ce),_e=u()(a.EuiText).withConfig({displayName:"NoWrapText",componentId:"sc-33d5ea-0"})(["white-space:nowrap;"]),Ae=r.a.memo((({status:e,updated:t,changed:n})=>{let i=null;return e!==E.k.draft&&t?n&&(i=r.a.createElement(a.EuiBadge,{color:"warning"},w)):i=r.a.createElement(a.EuiBadge,{color:"warning"},k),i?r.a.createElement(_e,{size:"xs","data-test-subj":"timeline-status"},i):null}));Ae.displayName="TimelineStatusInfo";var Pe=n(756);const Fe=u()(a.EuiFlexGroup).withConfig({displayName:"FlyoutHeaderPanelContentFlexGroupContainer",componentId:"sc-a6ccyo-0"})(["overflow-x:auto;"]),De=u()(a.EuiFlexItem).withConfig({displayName:"ActiveTimelinesContainer",componentId:"sc-a6ccyo-1"})(["overflow:hidden;"]),Ne=Object(d.euiStyled)(a.EuiPanel)`
  backgroundColor: ${e=>e.theme.eui.euiColorEmptyShade};
  color: ${e=>e.theme.eui.euiTextColor};
  padding-inline: ${e=>e.theme.eui.euiSizeM};
  border-radius: ${({$isOpen:e,theme:t})=>e?t.eui.euiBorderRadius:"0px"};
`,Re=({timelineId:e})=>{const t=Object(o.useDispatch)(),{browserFields:n,indexPattern:l}=Object(b.d)(h.SourcererScopeName.timeline),{uiSettings:u}=Object(g.i)().services,d=Object(i.useMemo)((()=>Object(c.getEsQueryConfig)(u)),[u]),E=Object(i.useMemo)((()=>f.b.getTimelineByIdSelector()),[]),{activeTab:x,dataProviders:j,kqlQuery:O,title:k,timelineType:w,status:T,updated:I,show:C,filters:M,kqlMode:A,changed:P=!1}=Object(m.a)((t=>{var n;return Object(s.pick)(["activeTab","dataProviders","kqlQuery","status","title","timelineType","updated","show","filters","kqlMode","changed"],null!==(n=E(t,e))&&void 0!==n?n:q.b)})),F=Object(i.useMemo)((()=>!Object(s.isEmpty)(j)||!Object(s.isEmpty)(Object(s.get)("filterQuery.kuery.expression",O))),[j,O]),D=Object(i.useMemo)((()=>f.b.getKqlFilterQuerySelector()),[]),N=Object(o.useSelector)((t=>D(t,e))),R=Object(s.isEmpty)(j)&&Object(s.isEmpty)(N)&&"template"===w?" ":null!=N?N:"",L=Object(i.useMemo)((()=>({query:R,language:"kuery"})),[R]),z=Object(i.useMemo)((()=>Object(v.d)({config:d,dataProviders:j,indexPattern:l,browserFields:n,filters:M||[],kqlQuery:L,kqlMode:A})),[n,j,d,M,l,A,L]),B=Object(i.useCallback)((()=>{Object(p.a)(),t(f.a.showTimeline({id:e,show:!1})),Object(y.i)()}),[t,e]);return r.a.createElement(Ne,{$isOpen:C,grow:!1,paddingSize:"s",hasShadow:!1,"data-test-subj":"timeline-flyout-header-panel","data-show":C},r.a.createElement(Fe,{className:"eui-scrollBar",alignItems:"center",gutterSize:"s",responsive:!1,justifyContent:"spaceBetween"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},C?null:r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(Pe.b,{timelineId:e})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(U.a,{timelineId:e,compact:!0})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(De,{grow:!1},r.a.createElement(_,{timelineId:e,timelineType:w,timelineTitle:k,isOpen:C}))),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(Ae,{status:T,updated:I,changed:P})))),C&&r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center",gutterSize:"s",responsive:!1},r.a.createElement(Me,{timelineId:e,activeTab:x,isInspectButtonDisabled:!F||void 0===(null==z?void 0:z.filterQuery)}),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiToolTip,{content:S("default"===w)},r.a.createElement(a.EuiButtonIcon,{"aria-label":S("default"===w),"data-test-subj":"close-timeline",iconType:"cross",onClick:B})))))))},Le=r.a.memo(Re)},function(e,t,n){"use strict";n.d(t,"a",(function(){return T}));var a=n(2),i=n(67),r=n.n(i),s=n(23),o=n.n(s),l=n(11),u=n.n(l),c=n(74),d=n.n(c),p=n(17);let m;!function(e){e.preboot="preboot",e.standard="standard"}(m||(m={}));const f="eui-global",g="eui-utilities",b={darkMode:!1};var y=n(13);const v=[p.euiStylisPrefixer],h=d()({key:"css",stylisPlugins:v,container:document.querySelector('meta[name="emotion"]')}),E=d()({key:f,stylisPlugins:v,container:document.querySelector(`meta[name="${f}"]`)}),x=d()({key:g,stylisPlugins:v,container:document.querySelector(`meta[name="${g}"]`)});h.compat=!0,E.compat=!0,x.compat=!0;const j={default:h,global:E,utility:x},O=({theme:{theme$:e},globalStyles:t,colorMode:n,children:i})=>{const r=u()(e,b),s=Object(a.useMemo)((()=>(e=>e.darkMode?p.COLOR_MODES_STANDARD.dark:p.COLOR_MODES_STANDARD.light)(r)),[r]),o=n||s,l=!1!==t&&void 0;return Object(y.jsx)(p.EuiProvider,{cache:j,colorMode:o,globalStyles:l,utilityClasses:l},i)},S=({children:e,i18n:t,...n})=>Object(y.jsx)(O,n,Object(y.jsx)(t.Context,null,e));var k=n(84);const w=({children:e,...t})=>Object(y.jsx)(S,o()({globalStyles:!1},t),Object(y.jsx)(k.KibanaErrorBoundaryProvider,{analytics:t.analytics},Object(y.jsx)(k.KibanaErrorBoundary,null,e))),T=(e,t)=>n=>(r.a.render(Object(y.jsx)(w,t,e),n),()=>r.a.unmountComponentAtNode(n));n(0),n(5);class mount_point_portal_MountPointPortalErrorBoundary extends a.Component{constructor(...e){super(...e),definePropertyfrom_dll_reference_kbnSharedDeps_npm_default()(this,"state",{error:void 0})}static getDerivedStateFromError(e){return{error:e}}componentDidCatch(){}render(){return this.state.error?Object(y.jsx)("p",null,external_kbnSharedDeps_KbnI18n_.i18n.translate("reactPackages.mountPointPortal.errorMessage",{defaultMessage:"Error rendering portal content"})):this.props.children}}},,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return C}));var a=n(2),i=n.n(a),r=n(17),s=n(113),o=n(708),l=n(164);const u="timeline";var c=n(5);const d=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.insertTimelineButtonLabel",{defaultMessage:"Insert timeline link"}),p=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineNameFoundErrorMsg",{defaultMessage:"No timeline name found"}),m=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noTimelineIdFoundErrorMsg",{defaultMessage:"No timeline id found"}),f=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.noParenthesesErrorMsg",{defaultMessage:"Expected left parentheses"}),g=e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.failedRetrieveTimelineErrorMsg",{defaultMessage:"Failed to retrieve timeline id: { timelineId }",values:{timelineId:e}}),b=c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.timelineErrorTitle",{defaultMessage:"Timeline Error"});var y=n(129);const v=({onClosePopover:e,onInsert:t})=>{const{formatUrl:n}=Object(l.l)(y.a.timelines),u=Object(a.useCallback)((({timelines:e})=>[...e.map(((e,t)=>({description:e.description,favorite:e.favorite,label:e.title,id:e.savedObjectId,key:`${e.title}-${t}`,title:e.title,checked:void 0})))]),[]),c=Object(a.useCallback)(((e,a,i)=>{const r=n(Object(l.k)(null!=a?a:"",i),{absolute:!0,skipSearch:!0});t(`[${e}](${r})`,{block:!1})}),[n,t]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiModalHeader,null),i.a.createElement(r.EuiModalBody,null,i.a.createElement(o.a,{hideUntitled:!0,getSelectableOptions:u,onTimelineChange:c,onClosePopover:e,timelineType:s.l.default})))},h=Object(a.memo)(v),E={name:u,button:{label:d,iconType:"timeline"},helpText:i.a.createElement(r.EuiCodeBlock,{language:"md",paddingSize:"s",fontSize:"l"},"[title](url)"),editor:function({node:e,onSave:t,onCancel:n}){return i.a.createElement(h,{onClosePopover:n,onInsert:t})}};var x=n(60),j=n(310);const O=function(){const e=this.Parser,t=e.prototype.inlineTokenizers,n=e.prototype.inlineMethods,a=function(e,t,n){let a=0;if("["!==t[a])return!1;if(n)return!0;function i(e,n){if(t[a]!==e)throw new Error(f);a++;let i="",r=0;for(;a<t.length;a++){const s=t[a];if(s===n&&0===r)return a++,i;s===n?r--:s===e&&r++,i+=s}return""}const r=i("[","]"),s=i("(",")"),o=e.now();if(!r)return this.file.info(p,{line:o.line,column:o.column}),!1;try{var l;const t=s.split("?"),n=Object(j.parse)(t[1]),a=Object(x.safeDecode)(null!==(l=n.timeline)&&void 0!==l?l:""),{id:i="",graphEventId:c=""}=null!=a?a:{id:null,graphEventId:""};return i?e(`[${r}](${s})`)({type:u,id:i,title:r,graphEventId:c}):(this.file.info(m,{line:o.line,column:o.column+s.indexOf("id")}),!1)}catch{this.file.info((e=>c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineUrlIsNotValidErrorMsg",{defaultMessage:"Timeline URL is not valid => {timelineUrl}",values:{timelineUrl:e}}))(s),{line:o.line,column:o.column})}return!1},i=function(e,t,n){return!(!1===t.startsWith("[")||!0===t.startsWith("[")&&!t.includes("timelines?timeline=(id"))&&a.call(this,e,t,n)};i.locator=(e,t)=>e.indexOf("[",t),t.timeline=i,n.splice(n.indexOf("url"),0,u)};var S=n(48),k=n(162),w=n(14),T=n(117);const I=({id:e,title:t,graphEventId:n})=>{const{addError:s}=Object(T.a)(),o=(()=>{const e=Object(S.useDispatch)();return Object(a.useCallback)(((t,n,a)=>{Object(k.h)({graphEventId:a,timelineId:t,onError:n,updateIsLoading:({id:t,isLoading:n})=>e(Object(w.updateIsLoading)({id:t,isLoading:n})),updateTimeline:Object(k.b)(e)})}),[e])})(),l=Object(a.useCallback)(((e,t)=>{s(e,{title:b,toastMessage:g(t)})}),[s]),u=Object(a.useCallback)((()=>o(null!=e?e:"",l,n)),[e,n,o,l]);return i.a.createElement(r.EuiToolTip,{content:(d=null!=e?e:"",c.i18n.translate("xpack.securitySolution.markdownEditor.plugins.timeline.toolTip.timelineId",{defaultMessage:"Timeline id: { timelineId }",values:{timelineId:d}}))},i.a.createElement(r.EuiLink,{onClick:u,"data-test-subj":`markdown-timeline-link-${e}`},t));var d},C=Object(a.memo)(I)},function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(45),i=n(17),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(153),c=n(113),d=n(241),p=n(5);const m=p.i18n.translate("xpack.securitySolution.editDataProvider.doesNotExistLabel",{defaultMessage:"does not exist"}),f=p.i18n.translate("xpack.securitySolution.editDataProvider.existsLabel",{defaultMessage:"exists"}),g=p.i18n.translate("xpack.securitySolution.editDataProvider.fieldLabel",{defaultMessage:"Field"}),b=p.i18n.translate("xpack.securitySolution.editDataProvider.placeholder",{defaultMessage:"Select a field"}),y=p.i18n.translate("xpack.securitySolution.editDataProvider.isLabel",{defaultMessage:"is"}),v=p.i18n.translate("xpack.securitySolution.editDataProvider.isOneOfLabel",{defaultMessage:"is one of"}),h=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotLabel",{defaultMessage:"is not"}),E=p.i18n.translate("xpack.securitySolution.editDataProvider.isNotOneOfLabel",{defaultMessage:"is not one of"}),x=p.i18n.translate("xpack.securitySolution.editDataProvider.includesPlaceholder",{defaultMessage:"enter one or more values"}),j=p.i18n.translate("xpack.securitySolution.editDataProvider.operatorLabel",{defaultMessage:"Operator"}),O=p.i18n.translate("xpack.securitySolution.editDataProvider.saveButton",{defaultMessage:"Save"}),S=p.i18n.translate("xpack.securitySolution.editDataProvider.valuePlaceholder",{defaultMessage:"value"}),k=p.i18n.translate("xpack.securitySolution.editDataProvider.valueLabel",{defaultMessage:"Value"}),w=p.i18n.translate("xpack.securitySolution.editDataProvider.selectAnOperatorPlaceholder",{defaultMessage:"Select an operator"}),T=e=>p.i18n.translate("xpack.securitySolution.editDataProvider.unavailableOperator",{values:{operator:e},defaultMessage:"{operator} operator is unavailable with templates"}),I=[{label:y},{label:h},{label:v},{label:E},{label:f},{label:m}],C=[],M=e=>e?Object.keys(e).sort().map((t=>{return{label:t,options:(n=e[t],null!=n.fields&&Object.keys(n.fields).length>0?Object.keys(n.fields):C).map((e=>({label:e})))};var n})):C,_=({browserFields:e,selectedField:t,selectedOperator:n,type:i})=>{const r=t.length>0?t[0].label:"",s=n.length>0?n[0].label:"",o=e&&null!=Object(d.a)(e)[r],l=-1!==Object(a.findIndex)((e=>e.label===s),I),u=i===c.a.template&&(s===v||s===E);return o&&l&&!u},A=e=>{switch(e.length>0?e[0].label:""){case y:case h:return u.d;case v:case E:return u.c;case f:case m:return u.b;default:return u.d}},P=e=>{switch(e.length>0?e[0].label:""){case h:case E:case m:return!0;default:return!1}},F=e=>Array.isArray(e)?e.length?`${e[0]}`:"":`${e}`;var D=n(145);const N=({value:e,onChangeCallback:t})=>{const[n,a]=Object(r.useState)(R(e));Object(r.useEffect)((()=>{t(L(n))}),[n,t]);const o=Object(r.useCallback)(((e,t=n)=>{const i=e.trim().toLowerCase();i&&-1===t.findIndex((e=>e.label.trim().toLowerCase()===i))&&a([...n,{label:e}])}),[n]),l=Object(r.useCallback)((e=>{a(e)}),[]);return s.a.createElement(i.EuiComboBox,{noSuggestions:!0,isClearable:!0,"data-test-subj":"is-one-of-combobox-input",selectedOptions:n,placeholder:x,onCreateOption:o,onChange:l})},R=e=>Object(D.k)(e)?e.map((e=>({label:String(e)}))):[],L=e=>e.map((e=>e.label)),z=({value:e,onChangeCallback:t})=>{const[n,a]=Object(r.useState)(B(e));Object(r.useEffect)((()=>{t(F(n))}),[n,t]);const o=Object(r.useCallback)((e=>{a(e.target.value)}),[]);return s.a.createElement(i.EuiFieldText,{className:"edit-data-provider-value",onChange:o,placeholder:S,value:F(n)})},B=e=>{var t;return Object(D.k)(e)?null!==(t=e[0])&&void 0!==t?t:"":e},q="edit-data-provider-save";l.a.div.withConfig({displayName:"HeaderContainer",componentId:"sc-1dznxok-0"})(["width:",";"],400).displayName="HeaderContainer";const $=s.a.memo((({andProviderId:e,browserFields:t,field:n,isExcluded:o,onDataProviderEdited:l,operator:c,providerId:d,timelineId:p,value:x,type:S=u.a.default})=>{const[C,F]=Object(r.useState)([{label:n}]),[D,R]=Object(r.useState)(((e,t)=>":"===t?e?[{label:h}]:[{label:y}]:"includes"===t?e?[{label:E}]:[{label:v}]:e?[{label:m}]:[{label:f}])(o,c)),[L,B]=Object(r.useState)(x),$=Object(r.useMemo)((()=>D.length>0&&(D[0].label===v||D[0].label===E)),[D]),V=Object(r.useMemo)((()=>S!==u.a.template&&D.length>0&&D[0].label!==f&&D[0].label!==m&&!$),[$,S,D]),U=Object(r.useMemo)((()=>$&&Array.isArray(L)&&!L.length),[$,L]),H=()=>{const e=document.getElementsByClassName("edit-data-provider-value");if(e.length>0)e[0].focus();else{const e=document.getElementsByClassName(q);e.length>0&&e[0].focus()}},Z=Object(r.useCallback)((e=>{F(e),S===u.a.template&&B(`{${e[0].label}}`),H()}),[S]),G=Object(r.useCallback)((e=>{R(e),H()}),[]),Q=Object(r.useCallback)((e=>{B(e)}),[]),W=Object(r.useCallback)((()=>{l({andProviderId:e,excluded:P(D),field:C.length>0?C[0].label:"",id:p,operator:A(D),providerId:d,value:L,type:S})}),[l,e,D,C,p,d,L,S]);return Object(r.useEffect)((()=>((()=>{const e=void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,t=void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop;window.onscroll=()=>window.scrollTo(e,t)})(),()=>{window.onscroll=()=>a.noop})),[]),s.a.createElement(i.EuiPanel,{paddingSize:"s"},s.a.createElement(i.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFormRow,{label:g},s.a.createElement(i.EuiComboBox,{autoFocus:!0,"data-test-subj":"field",isClearable:!1,onChange:Z,options:M(t),placeholder:b,selectedOptions:C,singleSelection:{asPlainText:!0},fullWidth:!0}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFlexGroup,{gutterSize:"s",direction:"row",justifyContent:"spaceBetween"},s.a.createElement(i.EuiFlexItem,{grow:!0},s.a.createElement(i.EuiFormRow,{label:j},s.a.createElement(i.EuiComboBox,{"data-test-subj":"operator",isClearable:!1,onChange:G,options:I,placeholder:w,selectedOptions:D,singleSelection:{asPlainText:!0},style:{minWidth:152}}))))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!1},V&&s.a.createElement(i.EuiFormRow,{label:k},s.a.createElement(z,{onChangeCallback:Q,value:x})),$&&S!==u.a.template&&s.a.createElement(i.EuiFormRow,{label:k},s.a.createElement(N,{onChangeCallback:Q,value:x}))),s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexItem,{grow:!1},S===u.a.template&&$&&s.a.createElement(s.a.Fragment,null,s.a.createElement(i.EuiCallOut,{color:"warning",iconType:"warning",size:"s",title:T(D[0].label)}),s.a.createElement(i.EuiSpacer,{size:"m"})),s.a.createElement(i.EuiFlexGroup,{justifyContent:"flexEnd",gutterSize:"none"},s.a.createElement(i.EuiFlexItem,{grow:!1},s.a.createElement(i.EuiButton,{className:q,color:"primary","data-test-subj":"save",fill:!0,isDisabled:!_({type:S,browserFields:t,selectedField:C,selectedOperator:D})||U,onClick:W,size:"m"},O))))))}));$.displayName="StatefulEditDataProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(2),i=n.n(a),r=n(90);const s={capabilities:Object(r.getDefaultMlCapabilities)(),isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var o=n(117),l=n(110),u=n(152);const c=Object(u.d)((async({http:e,signal:t})=>e.fetch("/internal/ml/ml_capabilities",{method:"GET",version:"1",asSystemRequest:!0,signal:t}))),d=n(5).i18n.translate("xpack.securitySolution.components.ml.permissions.errors.machineLearningPermissionsFailureTitle",{defaultMessage:"Machine learning permissions failure"}),p={...s,capabilitiesFetched:!1},m=i.a.createContext(p);m.displayName="MlCapabilitiesContext";const f=i.a.memo((({children:e})=>{const[t,n]=Object(a.useState)(p),r=Object(l.h)(),{addError:s}=Object(o.a)(),{start:f,result:g,error:b}=Object(u.a)(c);return Object(a.useEffect)((()=>{f({http:r})}),[r,f]),Object(a.useEffect)((()=>{g&&n({...g,capabilitiesFetched:!0})}),[g]),Object(a.useEffect)((()=>{b&&s(b,{title:d})}),[s,b]),i.a.createElement(m.Provider,{value:t},e)}));f.displayName="MlCapabilitiesProvider"},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(2),i=n.n(a),r=n(17),s=n(117),o=n(5);const l=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.cancelTitle",{defaultMessage:"Cancel"}),u=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteExceptionLabel",{defaultMessage:'Overwrite existing exception lists with conflicting "list_id"'}),c=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.overwriteActionConnectorsLabel",{defaultMessage:'Overwrite existing connectors with conflicting action "id"'}),d=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importExceptionsFailedLabel",{values:{totalExceptions:e},defaultMessage:"Failed to import {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}"}),p=e=>o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.importConnectorsFailedLabel",{values:{totalConnectors:e},defaultMessage:"Failed to import {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}"}),m=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningButton",{defaultMessage:"Go to connectors"}),f=o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsAdditionalPrivilegesError",{defaultMessage:"You need additional privileges to import rules with actions."}),g=(e,t,n)=>{const a=n.map((t=>e(t.error.message))),i=new Error(a.join(". "));return i.stack=void 0,i.name="Network errors",i.raw_network_error=t,i};var b=n(212);const y=({actionConnectorsWarnings:e,importedActionConnectorsCount:t})=>{const{http:n}=Object(b.b)().services;if(!t||!e.length)return null;const{actionPath:a,message:s,buttonLabel:l}=e[0];return i.a.createElement(r.EuiCallOut,{"data-test-subj":"actionConnectorsWarningsCallOut",size:"m",heading:"h2",iconType:"warning",title:i.a.createElement("span",{"data-test-subj":"actionConnectorsWarningsCallOutTitle"},(u=t,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.actionConnectorsWarningTitle",{values:{totalConnectors:u},defaultMessage:"{totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}} imported"}))),color:"warning"},i.a.createElement(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},i.a.createElement(r.EuiFlexItem,{"data-test-subj":"actionConnectorsWarningsCallOutMessage"},i.a.createElement(r.EuiText,{size:"xs"},s)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFlexGroup,{gutterSize:"none",direction:"columnReverse",alignItems:"flexEnd"},i.a.createElement(r.EuiButton,{"data-test-subj":"actionConnectorsWarningsCallOutButton",color:"warning",href:n.basePath.prepend(a)},l||m)))));var u};y.displayName="ActionConnectorWarningsComponent";const v=i.a.memo(y);v.displayName="ActionConnectorWarnings";const h=({checkBoxLabel:e,closeModal:t,description:n,errorMessage:m,failedDetailed:b,importComplete:y,importData:h,showCheckBox:E=!0,showExceptionsCheckBox:x=!1,showActionConnectorsCheckBox:j=!1,showModal:O,submitBtnText:S,subtitle:k,successMessage:w,title:T})=>{const[I,C]=Object(a.useState)(null),[M,_]=Object(a.useState)(!1),[A,P]=Object(a.useState)(!1),[F,D]=Object(a.useState)(!1),[N,R]=Object(a.useState)(!1),{addError:L,addSuccess:z}=Object(s.a)(),[B,q]=Object(a.useState)([]),[$,V]=Object(a.useState)(0),U=Object(a.useCallback)((()=>{t(),P(!1),D(!1),R(!1),q([])}),[t,P,D]),H=Object(a.useCallback)((e=>{_(!1),C(null),y(),e&&(y(),U())}),[U,y]),Z=Object(a.useCallback)((async()=>{if(null!=I){_(!0);const e=new AbortController;try{const{action_connectors_warnings:t,...n}=await h({fileToImport:I[0],overwrite:A,overwriteExceptions:F,overwriteActionConnectors:N,signal:e.signal}),a=n.action_connectors_success_count;q(t),V(a),(({importResponse:e,exceptionsIncluded:t,actionConnectorsIncluded:n,successMessage:a,errorMessage:i,errorMessageDetailed:r,addError:s,addSuccess:l})=>{if(e.success)return e.success_count>0&&l(a(e.success_count)),t&&e.exceptions_success&&null!=e.exceptions_success_count&&e.exceptions_success_count>0&&l((c=e.exceptions_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.exceptionsSuccessLabel",{values:{totalExceptions:c},defaultMessage:"Successfully imported {totalExceptions} {totalExceptions, plural, =1 {exception} other {exceptions}}."}))),void(n&&e.action_connectors_success&&null!=e.action_connectors_success_count&&e.action_connectors_success_count>0&&l((u=e.action_connectors_success_count,o.i18n.translate("xpack.securitySolution.detectionEngine.components.importRuleModal.connectorsSuccessLabel",{values:{totalConnectors:u},defaultMessage:"Successfully imported {totalConnectors} {totalConnectors, plural, =1 {connector} other {connectors}}."}))));var u,c;if(e.errors.length>0){if(n&&null!=e.action_connectors_errors&&e.action_connectors_errors.length>0){const{mappedErrors:t,numberOfActions:n}=(e=>{let t="";return{mappedErrors:e.map((e=>{const{id:n,error:a}=e;t=t&&t!==n?`${t},${n}`:n;const{status_code:i,message:r}=a||{};let s;return s=403===i?f:r,{...e,error:{...a,message:s}}})),numberOfActions:new Set(t&&[...t.split(",")]).size}})(e.action_connectors_errors);return s(g(r,e,t),{title:p(n||t.length)})}s(g(r,e,e.errors),{title:i(e.errors.length)}),t&&null!=e.exceptions_errors&&e.exceptions_errors.length>0&&s(g(r,e,e.exceptions_errors),{title:d(e.exceptions_errors.length)})}})({importResponse:n,exceptionsIncluded:x,actionConnectorsIncluded:j,successMessage:w,errorMessage:m,errorMessageDetailed:b,addError:L,addSuccess:z}),H(!(null!=t&&t.length))}catch(e){U(),L(e,{title:m(1)})}}}),[I,h,A,F,N,x,w,m,b,L,z,j,H,U]),G=Object(a.useCallback)((()=>{U()}),[U]),Q=Object(a.useCallback)((()=>{P((e=>!e))}),[]),W=Object(a.useCallback)((()=>{D((e=>!e))}),[]),K=Object(a.useCallback)((()=>{R((e=>!e))}),[]);return i.a.createElement(i.a.Fragment,null,O&&i.a.createElement(r.EuiModal,{onClose:G,maxWidth:"750px"},i.a.createElement(r.EuiModalHeader,null,i.a.createElement(r.EuiModalHeaderTitle,null,T)),i.a.createElement(r.EuiModalBody,null,i.a.createElement(r.EuiText,{size:"s"},i.a.createElement("h4",null,n)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiFilePicker,{"data-test-subj":"rule-file-picker",accept:".ndjson",id:"rule-file-picker",initialPromptText:k,onChange:e=>{C(e&&e.length>0?e:null)},display:"large",fullWidth:!0,isLoading:M}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(v,{actionConnectorsWarnings:B,importedActionConnectorsCount:$}),i.a.createElement(r.EuiSpacer,{size:"s"}),E&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalCheckboxLabel",id:"importDataModalCheckboxLabel",label:e,checked:A,onChange:Q}),x&&i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalExceptionsCheckboxLabel",id:"importDataModalExceptionsCheckboxLabel",label:u,checked:F,onChange:W}),j&&i.a.createElement(r.EuiCheckbox,{"data-test-subj":"importDataModalActionConnectorsCheckbox",id:"importDataModalActionConnectorsCheckbox",label:c,checked:N,onChange:K}))),i.a.createElement(r.EuiModalFooter,null,i.a.createElement(r.EuiButtonEmpty,{onClick:G},l),i.a.createElement(r.EuiButton,{"data-test-subj":"import-data-modal-button",onClick:Z,disabled:null==I||M,fill:!0},S))))};h.displayName="ImportDataModalComponent";const E=i.a.memo(h);E.displayName="ImportDataModal"},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return O}));var a=n(17),i=n(2),r=n.n(i),s=n(45),o=n(114),l=n(145),u=n(243),c=n(23),d=n.n(c);const p=({rowIndex:e,colIndex:t,data:n,header:a,eventId:s,linkValues:o,renderCellValue:l,tabType:u,timelineId:c})=>{const[p,m]=Object(i.useState)({});return r.a.createElement("div",d()({"data-test-subj":"statefulCell"},p),l({columnId:a.id,eventId:s,data:n,header:a,isDraggable:!0,isExpandable:!0,isExpanded:!1,isDetails:!1,isTimeline:!0,linkValues:o,rowIndex:e,colIndex:t,setCellProps:m,scopeId:c,key:null!=u?`${c}-${u}`:c}))};p.displayName="StatefulCellComponent";const m=r.a.memo(p);var f=n(5);const g=({column:e,row:t})=>f.i18n.translate("xpack.securitySolution.timeline.youAreInATableCellScreenReaderOnly",{values:{column:e,row:t},defaultMessage:"You are in a table cell. row: {row}, column: {column}"}),b=e=>f.i18n.translate("xpack.securitySolution.timeline.eventHasEventRendererScreenReaderOnly",{values:{row:e},defaultMessage:"The event in row {row} has an event renderer. Press shift + down arrow to focus it."}),y=({notesCount:e,row:t})=>f.i18n.translate("xpack.securitySolution.timeline.eventHasNotesScreenReaderOnly",{values:{notesCount:e,row:t},defaultMessage:"The event in row {row} has {notesCount, plural, =1 {a note} other {{notesCount} notes}}. Press shift + right arrow to focus notes."}),v=e=>{var t;const{altKey:n,ctrlKey:a,key:i,metaKey:r,shiftKey:s,target:l,type:c}=e,d=l;if((e=>{switch(e){case" ":case"Enter":return!0;default:return!1}})(i)&&null!==(t=d.className)&&void 0!==t&&t.includes(u.b)){const t=d.querySelector(`.${o.a}`),l=new KeyboardEvent(c,{altKey:n,bubbles:!0,cancelable:!0,ctrlKey:a,key:i,metaKey:r,shiftKey:s});" "===i&&e.preventDefault(),null==t||t.dispatchEvent(l)}},h=({action:e,width:t,actionsColumnWidth:n,ariaRowindex:i,columnId:s,columnValues:o,data:c,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:f,isEventViewer:h,eventId:E,loadingEventIds:x,notesCount:j,onEventDetailsPanelOpened:O,onRowSelected:S,refetch:k,rowIndex:w,hasRowRenderers:T,onRuleChange:I,selectedEventIds:C,showCheckboxes:M,showNotes:_,tabType:A,timelineId:P,toggleShowNotes:F,setEventsLoading:D,setEventsDeleted:N})=>{const R=t||n;return r.a.createElement(u.m,{width:R,"data-test-subj":"event-actions-container",tabIndex:0},r.a.createElement(u.k,{$ariaColumnIndex:m+l.c,key:null!=A?`${E}_${A}`:`${E}`,onKeyDown:v,role:"button",tabIndex:0,width:t},r.a.createElement(u.l,{"data-test-subj":"cell-container"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,g({row:i,column:m+2}))),e&&r.a.createElement(e,{ariaRowindex:i,width:t,checked:Object.keys(C).includes(E),columnId:s,columnValues:o,eventId:E,data:c,ecsData:d,eventIdToNoteIds:p,index:m,isEventPinned:f,isEventViewer:h,loadingEventIds:x,onEventDetailsPanelOpened:O,onRowSelected:S,refetch:k,rowIndex:w,onRuleChange:I,showCheckboxes:M,showNotes:_,timelineId:P,toggleShowNotes:F,setEventsLoading:D,setEventsDeleted:N}))),T?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},r.a.createElement("p",null,b(i))):null,j?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},r.a.createElement("p",null,y({row:i,notesCount:j}))):null))},E=({_id:e,ariaRowindex:t,index:n,header:i,data:o,ecsData:c,hasRowRenderers:d,notesCount:p,renderCellValue:f,tabType:h,timelineId:E})=>{var x;const j=n+l.c;return r.a.createElement(u.k,{$ariaColumnIndex:j,key:null!=h?`${i.id}_${h}`:`${i.id}`,onKeyDown:v,role:"button",tabIndex:0,width:i.initialWidth},r.a.createElement(u.l,{"data-test-subj":"cell-container"},r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"screenReaderOnly"},r.a.createElement("p",null,g({row:t,column:j}))),r.a.createElement(m,{rowIndex:t-1,colIndex:j-1,data:o,header:i,eventId:e,linkValues:Object(s.getOr)([],null!==(x=i.linkField)&&void 0!==x?x:"",c),renderCellValue:f,tabType:h,timelineId:E}))),d?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasRowRendererScreenReaderOnly"},r.a.createElement("p",null,b(t))):null,p?r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"hasNotesScreenReaderOnly"},r.a.createElement("p",null,y({row:t,notesCount:p}))):null)},x=r.a.memo((({ariaRowindex:e,actionsColumnWidth:t,columnHeaders:n,columnValues:a,data:s,ecsData:o,eventIdToNoteIds:l,isEventPinned:c,isEventViewer:d,id:p,loadingEventIds:m,notesCount:f,onEventDetailsPanelOpened:g,onRowSelected:b,refetch:y,hasRowRenderers:v,onRuleChange:x,renderCellValue:j,selectedEventIds:O,showCheckboxes:S,showNotes:k,tabType:w,timelineId:T,toggleShowNotes:I,trailingControlColumns:C,leadingControlColumns:M,setEventsLoading:_,setEventsDeleted:A})=>{const P=Object(i.useMemo)((()=>C?C.map((e=>e.rowCellRender)):[]),[C]),F=Object(i.useMemo)((()=>M.length+n.length),[M,n]),D=Object(i.useMemo)((()=>P.map(((n,i)=>n&&r.a.createElement(h,{action:n,width:C[i].width,actionsColumnWidth:t,ariaRowindex:e,checked:Object.keys(O).includes(p),columnId:C[i].id||"",columnValues:a,onRowSelected:b,"data-test-subj":"actions",eventId:p,data:s,key:i,index:F+i,rowIndex:e,ecsData:o,loadingEventIds:m,onEventDetailsPanelOpened:g,showCheckboxes:S,eventIdToNoteIds:l,isEventPinned:c,isEventViewer:d,notesCount:f,refetch:y,hasRowRenderers:v,onRuleChange:x,selectedEventIds:O,showNotes:k,tabType:w,timelineId:T,toggleShowNotes:I,setEventsLoading:_,setEventsDeleted:A})))),[C,p,s,o,b,c,d,t,e,a,l,v,F,m,f,g,x,y,O,S,k,w,T,I,P,_,A]),N=Object(i.useMemo)((()=>n.map(((t,n)=>r.a.createElement(E,{_id:p,index:n,header:t,key:null!=w?`${t.id}_${w}`:`${t.id}`,ariaRowindex:e,data:s,ecsData:o,hasRowRenderers:v,notesCount:f,renderCellValue:j,tabType:w,timelineId:T})))),[p,e,n,s,o,v,f,j,w,T]);return r.a.createElement(u.n,{"data-test-subj":"data-driven-columns"},N,D)}));x.displayName="DataDrivenColumns";const j=({data:e,fieldName:t})=>{if(!e||0===e.length)return;const n=e.find((e=>e.field===t));return null!=n&&null!=n.value?n.value:void 0},O=({data:e,fieldName:t})=>Object(i.useMemo)((()=>j({data:e,fieldName:t})),[e,t])},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),i=n.n(a),r=n(48),s=n(688),o=n(322),l=n(158),u=n(119),c=n(384),d=n(400);const p=({combinedQueries:e,filters:t,headerChildren:n,onlyField:p,paddingSize:m,query:f,showLegend:g,setAbsoluteRangeDatePickerTarget:b=u.a.global,runtimeMappings:y,hideQueryToggle:v=!1})=>{const h=Object(r.useDispatch)(),{signalIndexName:E}=Object(o.a)(),x=(j=t,Object(a.useMemo)((()=>[...j,...Object(d.e)(!1)]),[j]));var j;const O=Object(a.useCallback)((({x:e})=>{if(!e)return;const[t,n]=e;h(Object(l.setAbsoluteRangeDatePicker)({id:b,from:new Date(t).toISOString(),to:new Date(n).toISOString()}))}),[h,b]);return i.a.createElement(s.a,{combinedQueries:e,filters:x,headerChildren:n,legendPosition:"right",onlyField:p,paddingSize:m,query:f,showLegend:g,showLinkToAlerts:null==p,showStackBy:null==p,showTotalAlertsCount:!0,signalIndexName:E,runtimeMappings:y,title:c.b,titleSize:null==p?"m":"s",updateDateRange:O,hideQueryToggle:v})};p.displayName="SignalsByCategoryComponent";const m=i.a.memo(p)},function(e,t,n){"use strict";n.d(t,"a",(function(){return L}));var a=n(45),i=n(2),r=n.n(i),s=n(48),o=n(113),l=n(112),u=n(118),c=n(17),d=n(59),p=n.n(d),m=n(44),f=n.n(m),g=n(126),b=n(515),y=n(153),v=n(401);const h=f()(c.EuiBadge).withConfig({displayName:"ProviderBadgeStyled",componentId:"sc-l32wgy-0"})([".euiToolTipAnchor{&::after{font-style:normal;content:'|';padding:0px 3px;}}&.globalFilterItem{white-space:nowrap;min-width:",";display:flex;&.globalFilterItem-isDisabled{text-decoration:line-through;font-weight:400;font-style:italic;}&.globalFilterItem-isError{box-shadow:0 1px 1px -1px rgba(152,162,179,0.2),0 3px 2px -2px rgba(152,162,179,0.2),inset 0 0 0 1px #bd271e;}}"],(({$timelineType:e})=>e===o.l.template?"140px":"none"));h.displayName="ProviderBadgeStyled";const E=f.a.div.withConfig({displayName:"ProviderFieldBadge",componentId:"sc-l32wgy-1"})(["display:block;color:#fff;padding:6px 8px;font-size:0.6em;"]),x=f()(E).withConfig({displayName:"StyledTemplateFieldBadge",componentId:"sc-l32wgy-2"})(["background:",";text-transform:uppercase;"],(({theme:e})=>e.eui.euiColorVis3_behindText)),j=f()(E).withConfig({displayName:"ConvertFieldBadge",componentId:"sc-l32wgy-3"})(["background:",";cursor:pointer;&:hover{text-decoration:underline;}"],(({theme:e})=>e.eui.euiColorDarkShade)),O=({type:e,toggleType:t})=>e!==y.a.template?r.a.createElement(j,{onClick:t},v.d):r.a.createElement(x,null,v.w),S=r.a.memo(O),k={tabIndex:-1},w=r.a.memo((({deleteProvider:e,field:t,isEnabled:n,isExcluded:s,operator:l,providerId:u,togglePopover:c,toggleType:d,displayValue:m,val:f,type:E,timelineType:x})=>{const j=Object(i.useCallback)((t=>{t.stopPropagation&&t.stopPropagation(),e()}),[e]),O=Object(i.useMemo)((()=>p()("globalFilterItem",{"globalFilterItem-isDisabled":!n,"globalFilterItem-isExcluded":s})),[n,s]),w=Object(i.useMemo)((()=>Object(a.isString)(f)&&""===f?Object(g.b)():f),[f]),T=Object(i.useMemo)((()=>s?r.a.createElement("span",null,v.q," "):null),[s]),I=Object(i.useMemo)((()=>r.a.createElement(r.a.Fragment,null,T,l!==y.b?r.a.createElement("span",{className:"field-value"},`${t}: "${"includes"===l?m:w}"`):r.a.createElement("span",{className:"field-value"},t," ",v.j))),[m,t,w,l,T]),C=Object(i.useMemo)((()=>v.v({field:t,value:`${w}`})),[t,w]);return r.a.createElement(b.a,{id:`${u}-${t}-${f}`},r.a.createElement(r.a.Fragment,null,r.a.createElement(h,{className:O,color:"hollow",title:"",iconOnClick:j,iconOnClickAriaLabel:v.t,iconType:"cross",iconSide:"right",onClick:c,onClickAriaLabel:C,closeButtonProps:k,"data-test-subj":"providerBadge",$timelineType:x},I),x===o.l.template&&l!==y.c&&r.a.createElement(S,{toggleType:d,type:E})))}));w.displayName="ProviderBadge";var T=n(0),I=n.n(T),C=n(748);const M="edit-data-provider",_="exclude-data-provider",A="enable-data-provider",P="filter-for-field-present-data-provider",F="delete-data-provider",D=f()(c.EuiPopover).withConfig({displayName:"MyEuiPopover",componentId:"sc-2zwix7-0"})(["height:100%;user-select:none;"]);D.displayName="MyEuiPopover";class provider_item_actions_ProviderItemActions extends r.a.PureComponent{constructor(...e){super(...e),I()(this,"onDataProviderEdited",(({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,value:s,type:o})=>{null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,value:s,type:o}),this.props.closePopover()})),I()(this,"onFilterForFieldPresent",(()=>{const{andProviderId:e,field:t,timelineId:n,providerId:a,value:i,type:r}=this.props;null!=this.props.onDataProviderEdited&&this.props.onDataProviderEdited({andProviderId:e,excluded:!1,field:t,id:`${n}`,operator:y.b,providerId:a,value:i,type:r}),this.props.closePopover()}))}render(){const{andProviderId:e,browserFields:t,button:n,closePopover:a,deleteProvider:i,field:s,isEnabled:l,isExcluded:u,isLoading:d,isOpen:p,operator:m,providerId:f,timelineId:g,timelineType:b,toggleEnabledProvider:h,toggleExcludedProvider:E,toggleTypeProvider:x,value:j,type:O}=this.props,S=(({andProviderId:e,browserFields:t,deleteItem:n,field:a,isEnabled:i,isExcluded:s,isLoading:l,operator:u,onDataProviderEdited:c,onFilterForFieldPresent:d,providerId:p,timelineId:m,timelineType:f,toggleEnabled:g,toggleExcluded:b,toggleType:h,type:E,value:x})=>[{id:0,items:[{className:M,disabled:l,icon:"pencil",name:v.g,panel:1},{className:_,disabled:l,icon:s?"plusInCircle":"minusInCircle",name:s?v.p:v.i,onClick:b},{className:A,disabled:l,icon:i?"eyeClosed":"eye",name:i?v.x:v.u,onClick:g},{className:P,disabled:l,icon:"logstashFilter",name:v.k,onClick:d},f===o.l.template?{className:"convert-to-field-data-provider",disabled:l||u===y.c,icon:"visText",name:E===y.a.template?v.c:v.d,onClick:h}:{name:null},{className:F,disabled:l,icon:"trash",name:v.e,onClick:n}].filter((e=>null!=e.name))},{content:null!=t&&null!=m&&null!=c?r.a.createElement(C.a,{andProviderId:e,browserFields:t,field:a,isExcluded:s,onDataProviderEdited:c,operator:u,providerId:p,timelineId:m,value:x,type:E}):null,id:1,title:v.h,width:400}])({andProviderId:e,browserFields:t,deleteItem:i,field:s,isEnabled:l,isExcluded:u,isLoading:d,onDataProviderEdited:this.onDataProviderEdited,onFilterForFieldPresent:this.onFilterForFieldPresent,operator:m,providerId:f,timelineId:g,timelineType:b,toggleEnabled:h,toggleExcluded:E,toggleType:x,value:j,type:O});return r.a.createElement(D,{id:`popoverFor_${f}-${s}-${j}`,isOpen:p,closePopover:a,button:n,anchorPosition:"downCenter",panelPaddingSize:"none",ownFocus:!0},r.a.createElement("div",{style:{userSelect:"none"}},r.a.createElement(c.EuiContextMenu,{initialPanelId:0,panels:S,"data-test-subj":"providerActions"})))}}var N=n(195),R=n(134);const L=r.a.memo((({andProviderId:e,browserFields:t,deleteProvider:n,field:c,kqlQuery:d,isEnabled:p,isExcluded:m,isPopoverOpen:f,onDataProviderEdited:g,operator:b,providerId:v,register:h,setIsPopoverOpen:E,timelineId:x,toggleEnabledProvider:j,toggleExcludedProvider:O,toggleTypeProvider:S,displayValue:k,val:T,type:I=y.a.default,wrapperRef:C})=>{const M=Object(i.useMemo)((()=>u.b.getTimelineByIdSelector()),[]),_=Object(l.b)((e=>{var t,n;return x&&null!==(t=null===(n=M(e,x))||void 0===n?void 0:n.timelineType)&&void 0!==t?t:o.l.default})),{isLoading:A}=Object(l.a)((e=>{var t;return null!==(t=M(e,null!=x?x:""))&&void 0!==t?t:R.b})),P=Object(i.useCallback)((()=>{E(!f)}),[f,E]),F=Object(i.useCallback)((()=>{var e;E(!1),null==C||null===(e=C.current)||void 0===e||e.focus()}),[C,E]),D=Object(i.useCallback)((()=>{j(),F()}),[F,j]),L=Object(i.useCallback)((()=>{O(),F()}),[O,F]),z=Object(i.useCallback)((()=>{S(),F()}),[S,F]),[B,q]=Object(i.useState)(!1),$=Object(s.useDispatch)();Object(i.useEffect)((()=>{null!=h&&($(N.a.registerProvider({provider:{...h,and:[]}})),q(!0))}),[B,$,h,q]);const V=Object(i.useCallback)((()=>{B&&null!=h&&$(N.a.unRegisterProvider({id:h.id}))}),[B,$,h]);Object(i.useEffect)((()=>()=>{V()}),[V]);const U=Object(i.useMemo)((()=>r.a.createElement(w,{deleteProvider:A?a.noop:n,field:c,kqlQuery:d,isEnabled:p,isExcluded:m,providerId:v,togglePopover:P,toggleType:z,displayValue:null!=k?k:String(T),val:T,operator:b,type:I,timelineType:_})),[n,k,c,p,m,A,d,z,b,v,_,P,I,T]);return r.a.createElement(provider_item_actions_ProviderItemActions,{andProviderId:e,browserFields:t,button:U,closePopover:F,deleteProvider:n,field:c,kqlQuery:d,isEnabled:p,isExcluded:m,isLoading:A,isOpen:f,onDataProviderEdited:g,operator:b,providerId:v,timelineId:x,timelineType:_,toggleEnabledProvider:D,toggleExcludedProvider:L,toggleTypeProvider:z,value:T,type:I})}));L.displayName="ProviderItemBadge"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(17),i=n(2),r=n.n(i);const s=n(5).i18n.translate("xpack.securitySolution.accessibility.tooltipWithKeyboardShortcut.pressTooltipLabel",{defaultMessage:"Press"}),o=({additionalScreenReaderOnlyContext:e="",content:t,shortcut:n,showShortcut:i})=>r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{"data-test-subj":"content"},t),""!==e&&r.a.createElement(a.EuiScreenReaderOnly,{"data-test-subj":"additionalScreenReaderOnlyContext"},r.a.createElement("p",null,e)),i&&r.a.createElement(a.EuiText,{color:"subdued","data-test-subj":"shortcut",size:"s",textAlign:"center"},r.a.createElement("span",null,s),"Â ",r.a.createElement(a.EuiBadge,{color:"hollow"},n))),l=r.a.memo(o);l.displayName="TooltipWithKeyboardShortcut"},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return g}));var a=n(85),i=(n(9),n(124)),r=n(5);const s=r.i18n.translate("xpack.securitySolution.selector.groups.ruleName.label",{defaultMessage:"Rule name"}),o=r.i18n.translate("xpack.securitySolution.selector.grouping.userName.label",{defaultMessage:"User name"}),l=r.i18n.translate("xpack.securitySolution.selector.grouping.hostName.label",{defaultMessage:"Host name"}),u=r.i18n.translate("xpack.securitySolution.selector.grouping.sourceIP.label",{defaultMessage:"Source IP"}),c=r.i18n.translate("xpack.securitySolution.selector.groups.sourceAddress.label",{defaultMessage:"Source address"}),d=r.i18n.translate("xpack.securitySolution.selector.groups.destinationAddress.label",{defaultMessage:"Destination address"}),p=e=>0===e.length?{}:{query:{bool:{filter:{ids:{values:e}}}},size:1e4},m=(e,t)=>{const n=e.split(".");return 1===n.length?{[n[0]]:t}:{[n[0]]:m(n.slice(1).join("."),t)}},f=e=>{return t=e,Array.isArray(t)?t:Object.entries(t).reduce(((e,[t,n])=>Object(a.merge)(e,m(t,n))),{});var t},g=e=>e===i.e.alertsOnAlertsPage||e===i.e.alertsRiskInputs?[{label:s,key:"kibana.alert.rule.name"},{label:o,key:"user.name"},{label:l,key:"host.name"},{label:u,key:"source.ip"}]:e===i.e.alertsOnRuleDetailsPage?[{label:c,key:"source.address"},{label:o,key:"user.name"},{label:l,key:"host.name"},{label:d,key:"destination.address,"}]:[]},function(e,t,n){"use strict";n.d(t,"a",(function(){return p})),n.d(t,"b",(function(){return g}));var a=n(17),i=n(2),r=n.n(i),s=n(132);const o=r.a.memo((({onClick:e})=>r.a.createElement(a.EuiButtonEmpty,{color:"text","data-test-subj":"open-timeline-button",iconSide:"left",iconType:"folderOpen",onClick:e},s.G)));o.displayName="OpenTimelineModalButton";var l=n(467),u=n(244),c=n(327),d=n(466);const p="add-timeline-button",m=["createFrom"],f=({timelineId:e})=>{const[t,n]=Object(i.useState)(!1),[s,f]=Object(i.useState)(!1),g=Object(i.useCallback)((()=>n(!t)),[t]),b=Object(i.useCallback)((()=>n(!1)),[]),y=Object(i.useCallback)((()=>f(!1)),[]),v=Object(i.useCallback)((()=>{b(),f(!0)}),[b]),h=Object(i.useMemo)((()=>r.a.createElement(a.EuiButtonIcon,{className:p,"data-test-subj":"timeline-create-open-control",iconType:"plusInCircle",iconSize:"m",color:"primary",onClick:g,"aria-label":u.a})),[g]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(a.EuiPopover,{anchorPosition:"downRight",button:h,id:"timelineSettingsPopover",panelProps:{"data-test-subj":"timeline-addPopupPanel"},isOpen:t,closePopover:b,ownFocus:!0,repositionOnScroll:!0},r.a.createElement(a.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"none"},r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(c.c,{timelineId:e,title:u.h,onClick:b})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(d.a,{onClick:b,timelineId:e,title:u.g})),r.a.createElement(a.EuiFlexItem,{grow:!1},r.a.createElement(o,{onClick:v}))))),s?r.a.createElement(l.a,{onClose:y,hideActions:m}):null)},g=r.a.memo(f)},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(136),s=n.n(r),o=n(19),l=n(79),u=n(15),c=n(110);const d=e=>"esql"in e?{query:e.esql,language:"esql"}:"sql"in e?{query:e.sql,language:"sql"}:e,p=Object(a.memo)((({dateRangeFrom:e,dateRangeTo:t,hideSavedQuery:n=!1,indexPattern:r,isLoading:p=!1,isRefreshPaused:m,filterQuery:f,filterManager:g,filters:b,onChangedQuery:y,onSubmitQuery:v,refreshInterval:h,savedQuery:E,onSavedQuery:x,dataTestSubj:j,displayStyle:O,isDisabled:S})=>{const{data:k}=Object(c.i)().services,[w,T]=Object(a.useState)(),[I,C]=Object(a.useState)(b),M=Object(a.useCallback)((e=>{if(null!=e.query&&!s()(e.query,f)){const t=d(e.query);v(t)}}),[f,v]),_=Object(a.useCallback)((e=>{if(y&&null!=e.query&&!s()(e.query,f)){const t=d(e.query);y(t)}}),[f,y]),A=Object(a.useCallback)((e=>{const{query:t,filters:n,timefilter:a}=e.attributes;v(t,a),g.setFilters(n||[]),x(e)}),[g,v,x]),P=Object(a.useCallback)((()=>{null!=E&&(v({query:"",language:E.attributes.query.language}),g.setFilters([]),x(void 0))}),[g,v,x,E]),F=Object(a.useCallback)((e=>{g.setFilters(e)}),[g]),D="esql"===(null==f?void 0:f.language),N=Object(a.useMemo)((()=>D&&"string"==typeof f.query?{esql:f.query}:f),[f,D]);Object(a.useEffect)((()=>{let e;var t;return null!=(t=r)&&"object"==typeof t&&Object.hasOwn(t,"getName")?T(r):D||(async()=>{e=await k.dataViews.create({id:r.title,title:r.title}),T(e);const t=[...b];t.forEach((e=>e.meta.index=r.title)),C(t)})(),()=>{var t,n;null!==(t=e)&&void 0!==t&&t.id&&k.dataViews.clearInstanceCache(null===(n=e)||void 0===n?void 0:n.id)}}),[k.dataViews,b,r,D]);const R=Object(a.useMemo)((()=>new o.TimeHistory(new u.Storage(localStorage))),[]),L=Object(a.useMemo)((()=>null!=w?[w]:[]),[w]);return i.a.createElement(l.SearchBar,{showSubmitButton:!1,dateRangeFrom:e,dateRangeTo:t,filters:I,indexPatterns:L,isLoading:p,isRefreshPaused:m,query:N,onClearSavedQuery:P,onFiltersUpdated:F,onQueryChange:_,onQuerySubmit:M,onSaved:x,onSavedQueryUpdated:A,refreshInterval:h,showAutoRefreshOnly:!1,showFilterBar:!n,showDatePicker:!1,showQueryInput:!0,showSaveQuery:!0,timeHistory:R,dataTestSubj:j,savedQuery:E,displayStyle:O,isDisabled:S})}));p.displayName="QueryBar"},function(e,t,n){"use strict";n.d(t,"a",(function(){return F}));var a=n(2),i=n.n(a),r=n(48),s=n(54),o=n(127),l=n(119),u=n(147),c=n(110),d=n(172),p=n(128),m=n(134),f=n(118),g=n(318),b=n(17),y=n(44),v=n.n(y),h=n(723),E=n(752),x=n(121),j=n(521);const O=v.a.div.withConfig({displayName:"TopNContainer",componentId:"sc-149y4ld-0"})(["min-width:600px;"]),S=v()(b.EuiButtonIcon).withConfig({displayName:"CloseButton",componentId:"sc-149y4ld-1"})(["position:absolute;right:4px;top:4px;"]),k=v()(b.EuiSuperSelect).withConfig({displayName:"ViewSelect",componentId:"sc-149y4ld-2"})(["width:170px;"]),w=v.a.div.withConfig({displayName:"TopNContent",componentId:"sc-149y4ld-3"})(["margin-top:4px;margin-right:",";.euiPanel{border:none;}"],(({theme:e})=>e.eui.euiSizeXS)),T=({combinedQueries:e,defaultView:t,deleteQuery:n,filters:r,field:s,from:o,indexPattern:l,options:u,paddingSize:c,query:d,showLegend:p,setAbsoluteRangeDatePickerTarget:m,setQuery:f,scopeId:b,to:y,toggleTopN:v})=>{const[T,I]=Object(a.useState)(t),C=Object(a.useCallback)((e=>I(e)),[I]),M=Object(g.b)({scopeId:b,view:T}),{selectedPatterns:_,runtimeMappings:A}=Object(x.d)(M);Object(a.useEffect)((()=>{I(t)}),[t]);const P=Object(a.useMemo)((()=>i.a.createElement(k,{"data-test-subj":"view-select",disabled:1===u.length,onChange:C,options:u,valueOfSelected:T})),[C,u,T]),F=Object(a.useMemo)((()=>Object(g.d)({filters:r,tableId:b,view:T})),[r,b,T]);return i.a.createElement(O,{"data-test-subj":"topN-container"},i.a.createElement(w,null,"raw"===T||"all"===T?i.a.createElement(h.a,{combinedQueries:e,deleteQuery:n,filters:F,from:o,headerChildren:P,indexPattern:l,indexNames:_,runtimeMappings:A,onlyField:s,paddingSize:c,query:d,queryType:"topN",showLegend:p,setAbsoluteRangeDatePickerTarget:m,setQuery:f,showSpacer:!1,toggleTopN:v,scopeId:b,sourcererScopeId:M,to:y,hideQueryToggle:!0}):i.a.createElement(E.a,{combinedQueries:e,filters:F,headerChildren:P,onlyField:s,paddingSize:c,query:d,showLegend:p,setAbsoluteRangeDatePickerTarget:m,runtimeMappings:A,hideQueryToggle:!0})),i.a.createElement(S,{"aria-label":j.c,"data-test-subj":"close",iconType:"cross",onClick:v}))};T.displayName="TopNComponent";const I=i.a.memo(T);var C=n(122);const M=[],_={query:"",language:"kuery"},A=Object(r.connect)((()=>{const e=p.d.globalQuerySelector(),t=p.d.globalFiltersQuerySelector(),n=f.b.getTimelineByIdSelector(),a=p.d.getTimelineSelector(),i=f.b.getKqlFilterQuerySelector();return(r,s)=>{var o,l;const u=null!==(o=n(r,C.c.active))&&void 0!==o?o:m.b,c=null!==(l=u.filters)&&void 0!==l?l:M,d=a(r),{globalFilters:p}=s;return{activeTimelineEventType:u.eventType,activeTimelineFilters:u.activeTab===C.d.query?c:M,activeTimelineFrom:d.timerange.from,activeTimelineKqlQueryExpression:u.activeTab===C.d.query?i(r,C.c.active):null,activeTimelineTo:d.timerange.to,dataProviders:u.activeTab===C.d.query?u.dataProviders:[],globalQuery:e(r),globalFilters:null!=p?p:t(r),kqlMode:u.kqlMode}}})),P=({activeTimelineEventType:e,activeTimelineFilters:t,activeTimelineFrom:n,activeTimelineKqlQueryExpression:r,activeTimelineTo:p,browserFields:m,dataProviders:f,field:b,indexPattern:y,globalFilters:v=M,globalQuery:h=_,kqlMode:E,onFilterAdded:x,paddingSize:j,showLegend:O,scopeId:S,toggleTopN:k})=>{const{uiSettings:w}=Object(c.i)().services,{from:T,deleteQuery:C,setQuery:A,to:P}=Object(u.a)(),F=Object(g.a)(Object(o.isActiveTimeline)(null!=S?S:"")?e:void 0),D=Object(a.useMemo)((()=>{var e;return Object(o.isActiveTimeline)(null!=S?S:"")?null===(e=Object(d.d)({browserFields:m,config:Object(s.getEsQueryConfig)(w),dataProviders:f,filters:t,indexPattern:y,kqlMode:E,kqlQuery:{language:"kuery",query:null!=r?r:""}}))||void 0===e?void 0:e.filterQuery:void 0}),[S,m,w,f,t,y,E,r]),N=Object(a.useMemo)((()=>Object(g.c)(S)?"alert":F[0].value),[F,S]);return i.a.createElement(I,{combinedQueries:D,"data-test-subj":"top-n",defaultView:N,deleteQuery:Object(o.isActiveTimeline)(null!=S?S:"")?void 0:C,field:b,filters:Object(o.isActiveTimeline)(null!=S?S:"")?M:v,from:Object(o.isActiveTimeline)(null!=S?S:"")?n:T,indexPattern:y,options:F,paddingSize:j,query:Object(o.isActiveTimeline)(null!=S?S:"")?_:h,showLegend:O,setAbsoluteRangeDatePickerTarget:Object(o.isActiveTimeline)(null!=S?S:"")?l.a.timeline:l.a.global,setQuery:A,scopeId:S,to:Object(o.isActiveTimeline)(null!=S?S:"")?p:P,toggleTopN:k,onFilterAdded:x})};P.displayName="StatefulTopNComponent";const F=A(i.a.memo(P))},function(e,t,n){"use strict";n.d(t,"a",(function(){return E}));var a=n(136),i=n.n(a),r=n(45),s=n(2),o=n(3),l=n(54),u=n(209),c=n(110),d=n(294),p=n(127),m=n(5);m.i18n.translate("xpack.securitySolution.matrixHistogram.errorSearchDescription",{defaultMessage:"An error has occurred on matrix histogram search"});const f=m.i18n.translate("xpack.securitySolution.matrixHistogram.failSearchDescription",{defaultMessage:"Failed to run search on matrix histogram"});var g=n(117),b=n(336),y=n(4);const v=[],h=({endDate:e,errorMessage:t,filterQuery:n,histogramType:a,indexNames:m,isPtrIncluded:h,onError:E,stackByField:x,runtimeMappings:j,startDate:O,threshold:S,skip:k=!1,includeMissingData:w=!0})=>{const{data:T}=Object(c.i)().services,I=Object(s.useRef)(r.noop),C=Object(s.useRef)(new AbortController),M=Object(s.useRef)(new o.Subscription),[_,A]=Object(s.useState)(!1),{startTracking:P}=Object(b.a)(),[F,D]=Object(s.useState)({defaultIndex:m,factoryQueryType:d.h,filterQuery:Object(u.a)(n),histogramType:a,timerange:{interval:"12h",from:O,to:e},stackByField:x,runtimeMappings:j,threshold:S,...null!=h?{isPtrIncluded:h}:{},...null!=w?{includeMissingData:w}:{}}),{addError:N}=Object(g.a)(),[R,L]=Object(s.useState)({data:[],inspect:{dsl:[],response:[]},refetch:I.current,totalCount:-1,buckets:[]}),z=Object(s.useCallback)((e=>{const n=async()=>{C.current=new AbortController,A(!0);const{endTracking:n}=P({name:`${y.l} matrixHistogram ${a}`});M.current=T.search.search(e,{strategy:"securitySolutionSearchStrategy",abortSignal:C.current.signal}).subscribe({next:e=>{if(!Object(l.isRunningResponse)(e)){const t=Object(r.getOr)(v,d.j[a],e.rawResponse);A(!1),L((n=>({...n,data:e.matrixHistogramData,inspect:Object(p.getInspectResponse)(e,n.inspect),refetch:I.current,totalCount:t.reduce(((e,t)=>t.doc_count+e),0),buckets:t}))),n("success"),M.current.unsubscribe()}},error:e=>{A(!1),N(e,{title:null!=t?t:f}),n("error"),M.current.unsubscribe()}})};M.current.unsubscribe(),C.current.abort(),n(),I.current=n}),[T.search,a,N,t,P]);return Object(s.useEffect)((()=>{D((t=>{const r={...t,defaultIndex:m,filterQuery:Object(u.a)(n),histogramType:a,timerange:{interval:"12h",from:O,to:e},stackByField:x,threshold:S,...null!=h?{isPtrIncluded:h}:{}};return i()(t,r)?t:r}))}),[m,e,n,O,x,a,S,h]),Object(s.useEffect)((()=>(k||z(F),()=>{M.current.unsubscribe(),C.current.abort()})),[F,z,k]),Object(s.useEffect)((()=>{k&&(A(!1),M.current.unsubscribe(),C.current.abort())}),[k]),[_,R,Object(s.useCallback)(((e,t)=>{z({...F,timerange:{interval:"12h",from:t,to:e}})}),[F,z])]},E=e=>{const[t,n]=h({...e,includeMissingData:!0}),a=Object(s.useMemo)((()=>!e.stackByField.endsWith(".ip")),[e.stackByField]),[i,r]=h({...e,includeMissingData:!1,skip:a||void 0===e.filterQuery||e.skip}),o=Object(s.useMemo)((()=>t||i),[t,i]),l=Object(s.useMemo)((()=>{if(a)return n;const{data:e,inspect:t,totalCount:i,refetch:s,buckets:l}=n,{data:u,inspect:c,totalCount:d,refetch:p}=r,m=()=>{s(),p()};return o?{data:[],inspect:{dsl:[],response:[]},refetch:m,totalCount:-1,buckets:[]}:{data:[...e,...u],inspect:{dsl:[...t.dsl,...c.dsl],response:[...t.response,...c.response]},totalCount:i+d,refetch:m,buckets:l}}),[o,n,r,a]);return[o,l]}},function(e,t,n){"use strict";n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return g})),n.d(t,"i",(function(){return b})),n.d(t,"c",(function(){return v})),n.d(t,"b",(function(){return j})),n.d(t,"a",(function(){return O}));var a=n(49),i=n(57),r=n(33),s=n(736),o=n(178),l=n(966),u=n(884);const c=e=>e.policyItem,d=Object(i.createSelector)(c,(e=>e.license),((e,t)=>{if(e){const n=((e,t)=>{if(Object(r.b)(t,"enterprise"))return Object(s.d)(e);if(Object(r.b)(t,"platinum")){const t=Object(s.d)(e);return Object(s.e)(t)}return Object(s.f)(e)})(e.inputs[0].config.policy.value,t);return{...e,inputs:[{...e.inputs[0],config:{...e.inputs[0].config,policy:{...e.inputs[0].config.policy,value:n}}}]}}return e})),p=Object(i.createSelector)(d,(e=>{if(e)return Object(l.a)(e)})),m=e=>!e.policyItem&&!e.apiError,f=e=>Object(u.e)(e)||Object(u.f)(e)||Object(u.d)(e)||Object(u.c)(e)||Object(u.b)(e)||Object(u.g)(e),g=e=>e.license,b=Object(i.createSelector)((e=>e.location),(e=>{var t,n,i,r;return null!==(t=null===(n=Object(a.matchPath)(null!==(r=null==e?void 0:e.pathname)&&void 0!==r?r:"",{path:[o.n,o.r,o.m,o.o,o.l,o.q],exact:!0}))||void 0===n||null===(i=n.params)||void 0===i?void 0:i.policyId)&&void 0!==t?t:""})),y=Object(s.c)(),v=Object(i.createSelector)(d,(e=>{var t,n,a,i;return null!==(t=null==e||null===(n=e.inputs[0])||void 0===n||null===(a=n.config)||void 0===a||null===(i=a.policy)||void 0===i?void 0:i.value)&&void 0!==t?t:y})),h=Object(i.createSelector)(v,(e=>null==e?void 0:e.windows)),E=Object(i.createSelector)(v,(e=>null==e?void 0:e.mac)),x=Object(i.createSelector)(v,(e=>null==e?void 0:e.linux)),j=(Object(i.createSelector)(h,E,x,((e,t,n)=>({windows:{advanced:e.advanced,events:e.events,malware:e.malware,ransomware:e.ransomware,memory_protection:e.memory_protection,behavior_protection:e.behavior_protection,popup:e.popup,antivirus_registration:e.antivirus_registration,attack_surface_reduction:e.attack_surface_reduction},mac:{advanced:t.advanced,events:t.events,malware:t.malware,behavior_protection:t.behavior_protection,memory_protection:t.memory_protection,popup:t.popup},linux:{advanced:n.advanced,events:n.events,malware:n.malware,behavior_protection:n.behavior_protection,memory_protection:n.memory_protection,popup:n.popup}}))),e=>e.apiError),O=e=>e.agentStatusSummary},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(26);const i=n.n(a)()("x-pack/security_solution/groups")("UPDATE_GROUPS")},function(e,t,n){"use strict";n.d(t,"h",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return b})),n.d(t,"e",(function(){return y})),n.d(t,"a",(function(){return v})),n.d(t,"i",(function(){return h})),n.d(t,"I",(function(){return E})),n.d(t,"w",(function(){return x})),n.d(t,"H",(function(){return j})),n.d(t,"d",(function(){return S})),n.d(t,"g",(function(){return k})),n.d(t,"z",(function(){return w})),n.d(t,"J",(function(){return T})),n.d(t,"x",(function(){return I})),n.d(t,"F",(function(){return C})),n.d(t,"G",(function(){return M})),n.d(t,"B",(function(){return P})),n.d(t,"C",(function(){return N})),n.d(t,"D",(function(){return z})),n.d(t,"E",(function(){return $})),n.d(t,"y",(function(){return V})),n.d(t,"A",(function(){return U})),n.d(t,"k",(function(){return G})),n.d(t,"p",(function(){return Q})),n.d(t,"s",(function(){return W})),n.d(t,"r",(function(){return K})),n.d(t,"q",(function(){return J})),n.d(t,"v",(function(){return Y})),n.d(t,"n",(function(){return X})),n.d(t,"j",(function(){return ee})),n.d(t,"K",(function(){return te})),n.d(t,"t",(function(){return ne})),n.d(t,"u",(function(){return ae})),n.d(t,"o",(function(){return ie})),n.d(t,"l",(function(){return re})),n.d(t,"m",(function(){return se})),n.d(t,"f",(function(){return oe}));var a=n(45),i=n(51),r=n(153),s=n(122),o=n(113),l=n(335),u=n(134),c=n(281),d=n(204),p=n(282),m=n(424);const f=e=>null!==e,g=({id:e,noteId:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,noteIds:[...a.noteIds,t]}}},b=({id:e,noteId:t,eventId:n,timelineById:i})=>{const r=i[e],s=Object(a.getOr)([],`eventIdToNoteIds.${n}`,r);return{...i,[e]:{...r,eventIdToNoteIds:{...r.eventIdToNoteIds,[n]:Object(a.uniq)([...s,t])}}}},y=({id:e,resolveTimelineConfig:t,timeline:n,timelineById:a})=>{var i;return((e,t,n)=>e===s.c.active&&t.savedObjectId!==n.savedObjectId)(e,a[e],n)&&(p.a.setActivePage(0),p.a.setExpandedDetail({})),{...a,[e]:{...n,filterManager:a[e].filterManager,isLoading:a[e].isLoading,initialized:null!==(i=n.initialized)&&void 0!==i?i:a[e].initialized,resolveTimelineConfig:t,dateRange:n.status===o.k.immutable&&n.timelineType===o.l.template?{start:c.a.toISOString(),end:c.b.toISOString()}:n.dateRange}}},v=({id:e,timelineById:t,timelineType:n,dateRange:a,...r})=>{const s=t[e],{from:c,to:d}=Object(l.a)({from:"",to:""}),p=null!=a?a:{start:c,end:d},m=n===o.l.template?{templateTimelineId:Object(i.v4)(),templateTimelineVersion:1}:{};return{...t,[e]:{id:e,...s||{},...u.b,...r,dateRange:p,savedObjectId:null,version:null,isSaving:!1,isLoading:!1,timelineType:n,...m}}},h=({id:e,eventId:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,pinnedEventIds:{...a.pinnedEventIds,[t]:!0}}}},E=({id:e,show:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,show:t}}},x=({id:e,graphEventId:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,graphEventId:t,...""===t&&e===s.c.active?{activeTab:a.prevActiveTab,prevActiveTab:a.activeTab}:{}}}},j=({id:e,sessionViewConfig:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,sessionViewConfig:t}}},O=(e,t)=>e.field===t.field&&e.value===t.value&&e.operator===t.operator,S=({id:e,providers:t,timelineById:n})=>{const i=n[e];return""!==i.highlightedDropAndProviderId?((e,t,n,i)=>{if(0===t.length)return i;let r=Object(a.cloneDeep)(n.dataProviders);return t.forEach((e=>{const t=r.findIndex((e=>e.id===n.highlightedDropAndProviderId)),s=r[t],o=s.and.findIndex((t=>t.id===e.id)),{and:l,...u}=e;if(Object(a.isEqualWith)(O,s.queryMatch,u.queryMatch)||-1===o&&s.and.filter((e=>Object(a.isEqualWith)(O,e.queryMatch,u.queryMatch))).length>0)return i;r=[...r.slice(0,t),{...r[t],and:o>-1?[...s.and.slice(0,o),u,...s.and.slice(o+1)]:[...s.and,u]},...r.slice(t+1)]})),{...i,[e]:{...n,dataProviders:r}}})(e,t,i,n):((e,t,n,i)=>{if(0===t.length)return i;let r=Object(a.cloneDeep)(n.dataProviders);return t.forEach((e=>{const t=r.findIndex((t=>t.id===e.id));t>-1&&!Object(a.isEmpty)(r[t].and)&&(e.id=`${e.id}-${r.filter((t=>t.id===e.id)).length}`),r=t>-1&&Object(a.isEmpty)(r[t].and)?[...r.slice(0,t),e,...r.slice(t+1)]:[...r,e]})),{...i,[e]:{...n,dataProviders:r}}})(e,t,i,n)},k=({id:e,filterQuery:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,kqlQuery:{...a.kqlQuery,filterQuery:t}}}},w=({id:e,kqlMode:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,kqlMode:t}}},T=({description:e,id:t,title:n,timelineById:a})=>{const i=a[t];return{...a,[t]:{...i,description:e.trim(),title:n.trim()}}},I=({id:e,isFavorite:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,isFavorite:t}}},C=({id:e,providers:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,dataProviders:t}}},M=({id:e,start:t,end:n,timelineById:a})=>{const i=a[e];return{...a,[e]:{...i,dateRange:{start:t,end:n}}}},_=(e,t,n,a)=>a.dataProviders.map((a=>a.id===n?{...a,and:a.and.map((n=>n.id===e?{...n,enabled:t}:n))}:a)),A=(e,t,n)=>n.dataProviders.map((n=>n.id===t?{...n,enabled:e}:n)),P=({id:e,providerId:t,enabled:n,timelineById:a,andProviderId:i})=>{const r=a[e];return{...a,[e]:{...r,dataProviders:i?_(i,n,t,r):A(n,t,r)}}},F=(e,t,n,a)=>a.dataProviders.map((a=>a.id===n?{...a,and:a.and.map((n=>n.id===e?{...n,excluded:t}:n))}:a)),D=(e,t,n)=>n.dataProviders.map((n=>n.id===t?{...n,excluded:e}:n)),N=({id:e,providerId:t,excluded:n,timelineById:a,andProviderId:i})=>{const r=a[e];return{...a,[e]:{...r,dataProviders:i?F(i,n,t,r):D(n,t,r)}}},R=({excluded:e,field:t,operator:n,providerId:a,timeline:i,value:r})=>i.dataProviders.map((i=>i.id===a?{...i,excluded:e,queryMatch:{...i.queryMatch,field:t,displayField:t,value:r,displayValue:Object(m.d)(r),operator:n}}:i)),L=({andProviderId:e,excluded:t,field:n,operator:a,providerId:i,timeline:r,value:s})=>r.dataProviders.map((r=>r.id===i?{...r,and:r.and.map((i=>i.id===e?{...i,excluded:t,queryMatch:{...i.queryMatch,field:n,displayField:n,value:s,displayValue:Object(m.d)(s),operator:a}}:i))}:r)),z=({andProviderId:e,excluded:t,field:n,id:a,operator:i,providerId:r,timelineById:s,value:o})=>{const l=s[a];return{...s,[a]:{...l,dataProviders:e?L({andProviderId:e,excluded:t,field:n,operator:i,providerId:r,timeline:l,value:o}):R({excluded:t,field:n,operator:i,providerId:r,timeline:l,value:o})}}},B=(e,t,n,a)=>a.dataProviders.map((a=>a.id===n?{...a,and:a.and.map((n=>n.id===e?{...n,type:t,name:t===r.a.template?`${n.queryMatch.field}`:"",queryMatch:{...n.queryMatch,displayField:void 0,displayValue:void 0,value:t===r.a.template?`{${n.queryMatch.field}}`:"",operator:t===r.a.template?r.d:r.b}}:n))}:a)),q=(e,t,n)=>n.dataProviders.map((n=>n.id===t?{...n,type:e,name:e===r.a.template?`${n.queryMatch.field}`:"",queryMatch:{...n.queryMatch,displayField:void 0,displayValue:void 0,value:e===r.a.template?`{${n.queryMatch.field}}`:"",operator:e===r.a.template?r.d:r.b}}:n)),$=({andProviderId:e,id:t,providerId:n,type:a,timelineById:i})=>{const s=i[t];return s.timelineType!==o.l.template&&a===r.a.template?i:{...i,[t]:{...s,dataProviders:e?B(e,a,n,s):q(a,n,s)}}},V=({id:e,itemsPerPage:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,itemsPerPage:t}}},U=({id:e,itemsPerPageOptions:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,itemsPerPageOptions:t}}},H=(e,t,n)=>{var a,i,r,s;const o=n.dataProviders.findIndex((e=>e.id===t)),l=null===(a=n.dataProviders[o])||void 0===a?void 0:a.and.findIndex((t=>t.id===e));return[...n.dataProviders.slice(0,o),{...n.dataProviders[o],and:null!==(i=n.dataProviders[o])&&void 0!==i&&i.and?[...null===(r=n.dataProviders[o])||void 0===r?void 0:r.and.slice(0,l),...null===(s=n.dataProviders[o])||void 0===s?void 0:s.and.slice(l+1)]:[]},...n.dataProviders.slice(o+1)]},Z=(e,t)=>{var n;const a=t.dataProviders.findIndex((t=>t.id===e));return[...t.dataProviders.slice(0,a),...null!==(n=t.dataProviders[a])&&void 0!==n&&n.and.length?[{...t.dataProviders[a].and.slice(0,1)[0],and:[...t.dataProviders[a].and.slice(1)]}]:[],...t.dataProviders.slice(a+1)]},G=({id:e,providerId:t,timelineById:n,andProviderId:a})=>{const i=n[e];return{...n,[e]:{...i,dataProviders:a?H(a,t,i):Z(t,i)}}},Q=({id:e,eventId:t,timelineById:n})=>{const i=n[e];return{...n,[e]:{...i,pinnedEventIds:Object(a.omit)(t,i.pinnedEventIds)}}},W=({id:e,savedQueryId:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,savedQueryId:t}}},K=({id:e,filters:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,filters:t}}},J=({id:e,excludedRowRendererIds:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,excludedRowRendererIds:t}}},Y=e=>{var t;const{tabType:n,id:a,...i}=e,r=new Set(["eventDetail","hostDetail","networkDetail","userDetail"]),s=null!=n?n:"query",o={params:i.params?{...i.params}:{},panelView:i.panelView};return{[s]:r.has(null!==(t=i.panelView)&&void 0!==t?t:"")?o:{}}},X=({id:e,eventIds:t,isLoading:n,timelineById:i})=>{const r=i[e],s=n?Object(a.union)(r.loadingEventIds,t):r.loadingEventIds.filter((e=>!t.includes(e)));return{...i,[e]:{...r,loadingEventIds:s}}},ee=({id:e,columnId:t,timelineById:n})=>{const a=n[e],i=a.columns.filter((e=>e.id!==t));return{...n,[e]:{...a,columns:i}}},te=({column:e,id:t,index:n,timelineById:a})=>{const i=a[t];if(-1!==i.columns.findIndex((t=>t.id===e.id))){const r=i.columns.filter((t=>t.id!==e.id));return r.splice(n,0,e),{...a,[t]:{...i,columns:r}}}const r=[...i.columns];return r.splice(n,0,e),{...a,[t]:{...i,columns:r}}},ne=({id:e,columns:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,columns:t}}},ae=({id:e,sort:t,timelineById:n})=>{const a=n[e];return{...n,[e]:{...a,sort:t}}},ie=({id:e,eventIds:t,isSelectAllChecked:n=!1,isSelected:i,timelineById:r})=>{const s=r[e],o=i?{...s.selectedEventIds,...t}:Object(a.omit)(Object.keys(t),s.selectedEventIds);return{...r,[e]:{...s,selectedEventIds:o,isSelectAllChecked:n}}},re=({id:e,eventIds:t,isDeleted:n,timelineById:i})=>{const r=i[e],s=n?Object(a.union)(r.deletedEventIds,t):r.deletedEventIds.filter((e=>!t.includes(e))),o=Object.fromEntries(Object.entries(r.selectedEventIds).filter((([e])=>!s.includes(e)))),l=Object.keys(o).length>0&&r.isSelectAllChecked;return{...i,[e]:{...r,deletedEventIds:s,selectedEventIds:o,isSelectAllChecked:l}}},se=({id:e,timelineById:t,timelineSettingsProps:n})=>{var i;const r=t[e];return null!=r&&r.initialized?{...t,[e]:{...r,...n}}:{...t,[e]:{...u.b,...Object(u.a)(e),...r,...n,...!r||Object(a.isEmpty)(r.columns)&&!Object(a.isEmpty)(n.defaultColumns)?{columns:n.defaultColumns}:{},sort:null!==(i=n.sort)&&void 0!==i?i:u.b.sort,loadingEventIds:u.b.loadingEventIds,initialized:!0}}},oe=({id:e,columnId:t,delta:n,timelineById:a})=>{var i;const r=a[e],s=r.columns.findIndex((e=>e.id===t));if(-1===s)return{...a,[e]:{...r}};const o=(null!==(i=r.columns[s].initialWidth)&&void 0!==i?i:d.a)+n,l=Math.max(d.c,o),u={...r.columns[s],initialWidth:l},c=[...r.columns.slice(0,s),u,...r.columns.slice(s+1)];return{...a,[e]:{...r,columns:c}}}},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s}));var a=n(5);const i=e=>a.i18n.translate("xpack.securitySolution.configurations.suppressedAlerts",{defaultMessage:"Alert has {numAlertsSuppressed} suppressed alerts",values:{numAlertsSuppressed:e}}),r=180,s=190},,function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return a.useMemo((function(){return e.apply(void 0,t)}),t)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.createContext(void 0);return[function(){var e=a.useContext(n);if(null==e)throw new Error("useReducerContext must be used inside a ReducerProvider.");return e},function(i){var r=i.children,s=i.initialState;return function(e,t){return a.createElement(n.Provider,e,t)}({value:a.useReducer(e,void 0!==s?s:t)},r)},n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(254));t.default=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,a=(n=e,function(e,t){return n.reduceRight((function(t,n){return n(e)(t)}),t)});return function(e,t,n){void 0===n&&(n=function(e){return e});var s=i.useRef(n(t)),o=i.useState(s.current)[1],l=i.useCallback((function(t){return s.current=e(s.current,t),o(s.current),t}),[e]),u=i.useRef(a({getState:function(){return s.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u.current.apply(u,e)}},l));return r.default((function(){u.current=a({getState:function(){return s.current},dispatch:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return u.current.apply(u,e)}},l)}),[l]),[s.current,u.current]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.createContext(void 0);return[function(){var e=a.useContext(t);if(null==e)throw new Error("useStateContext must be used inside a StateProvider.");return e},function(n){var i=n.children,r=n.initialValue;return function(e,n){return a.createElement(t.Provider,e,n)}({value:a.useState(void 0!==r?r:e)},i)},t]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(407));t.default=function(e,t){void 0===t&&(t=[]);var n=i.useState(0),s=n[0],o=n[1],l=r.default(e,a.__spreadArrays(t,[s])),u=l.loading,c=i.useCallback((function(){u||o((function(e){return e+1}))}),a.__spreadArrays(t,[u]));return a.__assign(a.__assign({},l),{retry:c})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(499)).default("audio");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=0;n<e.length;n++)t.push({start:e.start(n),end:e.end(n)});return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r="object"==typeof navigator?navigator:void 0,s=r&&"function"==typeof r.getBattery;t.default=s?function(){var e=a.useState({isSupported:!0,fetched:!1}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,a=null,s=function(){if(e&&a){var r={isSupported:!0,fetched:!0,level:a.level,charging:a.charging,dischargingTime:a.dischargingTime,chargingTime:a.chargingTime};!i.isDeepEqual(t,r)&&n(r)}};return r.getBattery().then((function(t){e&&(a=t,i.on(a,"chargingchange",s),i.on(a,"chargingtimechange",s),i.on(a,"dischargingtimechange",s),i.on(a,"levelchange",s),s())})),function(){e=!1,a&&(i.off(a,"chargingchange",s),i.off(a,"chargingtimechange",s),i.off(a,"dischargingtimechange",s),i.off(a,"levelchange",s))}}),[]),t}:function(){return{isSupported:!1}}},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var a,i,r;if(Array.isArray(t)){if((a=t.length)!=n.length)return!1;for(i=a;0!=i--;)if(!e(t[i],n[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((a=(r=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=a;0!=i--;)if(!Object.prototype.hasOwnProperty.call(n,r[i]))return!1;for(i=a;0!=i--;){var s=r[i];if(!("_owner"===s&&t.$$typeof||e(t[s],n[s])))return!1}return!0}return t!=t&&n!=n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===e&&(e=!0);var n=a.useCallback((function(n){if("function"!=typeof e||e())return n.preventDefault(),t&&(n.returnValue=t),t}),[e,t]);a.useEffect((function(){if(e)return window.addEventListener("beforeunload",n),function(){return window.removeEventListener("beforeunload",n)}}),[e,n])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(500));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r=["mousedown","touchstart"];t.default=function(e,t,n){void 0===n&&(n=r);var s=a.useRef(t);a.useEffect((function(){s.current=t}),[t]),a.useEffect((function(){for(var t=function(t){var n=e.current;n&&!n.contains(t.target)&&s.current(t)},a=0,r=n;a<r.length;a++){var o=r[a];i.on(document,o,t)}return function(){for(var e=0,a=n;e<a.length;e++){var r=a[e];i.off(document,r,t)}}}),[n,e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(779));t.default=function(e){var t=i.useState((function(){return r.default.get(e)||null})),n=t[0],a=t[1];return[n,i.useCallback((function(t,n){r.default.set(e,t,n),a(t)}),[e]),i.useCallback((function(){r.default.remove(e),a(null)}),[e])]}},function(e,t,n){var a,i,r;
/*!
 * JavaScript Cookie v2.2.1
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */r=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var a in n)t[a]=n[a]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function n(a){function i(){}function r(t,n,r){if("undefined"!=typeof document){"number"==typeof(r=e({path:"/"},i.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(e){}n=a.write?a.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var o="";for(var l in r)r[l]&&(o+="; "+l,!0!==r[l]&&(o+="="+r[l].split(";")[0]));return document.cookie=t+"="+n+o}}function s(e,n){if("undefined"!=typeof document){for(var i={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var o=r[s].split("="),l=o.slice(1).join("=");n||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var u=t(o[0]);if(l=(a.read||a)(l,u)||t(l),n)try{l=JSON.parse(l)}catch(e){}if(i[u]=l,e===u)break}catch(e){}}return e?i[e]:i}}return i.set=r,i.get=function(e){return s(e,!1)},i.getJSON=function(e){return s(e,!0)},i.remove=function(t,n){r(t,"",e(n,{expires:-1}))},i.defaults={},i.withConverter=n,i}((function(){}))},void 0===(i="function"==typeof(a=r)?a.call(t,n,t,e):a)||(e.exports=i),e.exports=r()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(487)),r=n(2),s=a.__importDefault(n(207)),o=a.__importDefault(n(255));t.default=function(){var e=s.default(),t=o.default({value:void 0,error:void 0,noUserInteraction:!0}),n=t[0],a=t[1];return[n,r.useCallback((function(t){var n,r;if(e())try{if("string"!=typeof t&&"number"!=typeof t){var s=new Error("Cannot copy typeof "+typeof t+" to clipboard, must be a string");return void a({value:t,error:s,noUserInteraction:!0})}if(""===t)return s=new Error("Cannot copy empty string to clipboard."),void a({value:t,error:s,noUserInteraction:!0});r=t.toString(),n=i.default(r),a({value:r,error:void 0,noUserInteraction:n})}catch(s){a({value:r,error:s,noUserInteraction:n})}}),[])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(782),r=n(783),s=n(784),o=n(786),l=n(2),u=a.__importDefault(n(40)),c=i.create();r.addon(c),s.addon(c);var d=0;t.default=function(e){var t=l.useMemo((function(){return"react-use-css-"+(d++).toString(36)}),[]),n=l.useMemo((function(){return new c.VSheet}),[]);return u.default((function(){var a={};return o.cssToTree(a,e,"."+t,""),n.diff(a),function(){n.diff({})}})),t}},function(e,t,n){"use strict";var a=/[A-Z]/g;t.create=function(e){var t=(e=e||{}).assign||Object.assign,n=t({raw:"",pfx:"_",client:"object"==typeof window,assign:t,stringify:JSON.stringify,kebab:function(e){return e.replace(a,"-$&").toLowerCase()},decl:function(e,t){return(e=n.kebab(e))+":"+t+";"},hash:function(e){return function(e){for(var t=5381,n=e.length;n;)t=33*t^e.charCodeAt(--n);return"_"+(t>>>0).toString(36)}(n.stringify(e))},selector:function(e,t){return e+(":"===t[0]?"":" ")+t},putRaw:function(e){n.raw+=e}},e);return n.client&&(n.sh||document.head.appendChild(n.sh=document.createElement("style")),n.putRaw=function(e){var t=n.sh.sheet;try{t.insertRule(e,t.cssRules.length)}catch(e){}}),n.put=function(e,t,a){var i,r,s="",o=[];for(i in t)(r=t[i])instanceof Object&&!(r instanceof Array)?o.push(i):s+=n.decl(i,r,e,a);s&&(s=e+"{"+s+"}",n.putRaw(a?a+"{"+s+"}":s));for(var l=0;l<o.length;l++)"@"===(i=o[l])[0]&&"@font-face"!==i?n.putAt(e,t[i],i):n.put(n.selector(e,i),t[i],a)},n.putAt=n.put,n}},function(e,t,n){"use strict";t.addon=function(e){e.client&&(document.head.appendChild(e.msh=document.createElement("style")),e.createRule=function(t,n){var a=t+"{}";n&&(a=n+"{"+a+"}");var i=n?e.msh.sheet:e.sh.sheet,r=i.insertRule(a,i.cssRules.length),s=(i.cssRules||i.rules)[r];if(s.index=r,n){var o=(s.cssRules||s.rules)[0];s.style=o.style,s.styleMap=o.styleMap}return s})}},function(e,t,n){"use strict";var a=n(785).removeRule;t.addon=function(e){if(e.client){var t=e.kebab;n.prototype.diff=function(e){var n,a=this.decl,i=this.rule.style;for(n in a)void 0===e[n]&&i.removeProperty(n);for(n in e)e[n]!==a[n]&&i.setProperty(t(n),e[n]);this.decl=e},n.prototype.del=function(){a(this.rule)},i.prototype.diff=function(e){var t=this.tree;for(var a in t)if(void 0===e[a]){var i=t[a];for(var r in i)i[r].del()}for(var a in e)if(void 0===t[a])for(var r in e[a])(l=new n(r,a)).diff(e[a][r]),e[a][r]=l;else{var s=t[a],o=e[a];for(var r in s)o[r]||s[r].del();for(var r in o){var l;(l=s[r])?(l.diff(o[r]),o[r]=l):((l=new n(r,a)).diff(o[r]),o[r]=l)}}this.tree=e},e.VRule=n,e.VSheet=i}function n(t,n){this.rule=e.createRule(t,n),this.decl={}}function i(){this.tree={}}}},function(e,t){t.removeRule=function(e){var t=e.index,n=e.parentStyleSheet,a=n.cssRules||n.rules;for(t=Math.max(t,a.length-1);t>=0;){if(a[t]===e){n.deleteRule(t);break}t--}}},function(e,t){t.cssToTree=function e(t,n,a,i){var r,s,o={},l=!1;for(r in n)"object"!=typeof(s=n[r])&&(l=!0,o[r]=s);for(r in l&&(t[i]||(t[i]={}),t[i][a]=o),n)if("object"==typeof(s=n[r]))if("@"===r[0])e(t,s,a,r);else{var u=r.indexOf("&")>-1,c=a.split(",");if(u)for(var d=0;d<c.length;d++)c[d]=r.replace(/&/g,c[d]);else for(d=0;d<c.length;d++)c[d]=c[d]+" "+r;e(t,s,c.join(","),i)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(376));t.default=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=[]);var a=r.default(e,t),s=a[0],o=a[1],l=a[2];return i.useEffect(l,n),[s,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(t),i=n[0],r=n[1];return null==i?[e,r]:[i,r]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=function(){};t.default=function(e,t){void 0===e&&(e={}),void 0===t&&(t=[]);var n=e.onFiles,s=e.onText,o=e.onUri,l=i.useState(!1),u=l[0],c=l[1],d=i.useCallback(c,[]),p=i.useMemo((function(){return function(e){return function(t,n){var a=t.getData("text/uri-list");if(a)(e.onUri||r)(a,n);else if(t.files&&t.files.length)(e.onFiles||r)(Array.from(t.files),n);else if(n.clipboardData){var i=n.clipboardData.getData("text");(e.onText||r)(i,n)}}}(e)}),[n,s,o]);return i.useEffect((function(){var e=function(e){e.preventDefault(),d(!0)},t=function(e){e.preventDefault(),d(!0)},n=function(){d(!1)},a=function(){d(!1)},i=function(e){e.preventDefault(),d(!1),p(e.dataTransfer,e)},r=function(e){p(e.clipboardData,e)};return document.addEventListener("dragover",e),document.addEventListener("dragenter",t),document.addEventListener("dragleave",n),document.addEventListener("dragexit",a),document.addEventListener("drop",i),s&&document.addEventListener("paste",r),function(){document.removeEventListener("dragover",e),document.removeEventListener("dragenter",t),document.removeEventListener("dragleave",n),document.removeEventListener("dragexit",a),document.removeEventListener("drop",i),document.removeEventListener("paste",r)}}),a.__spreadArrays([p],t)),{over:u}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(207)),s=function(){};t.default=function(e){void 0===e&&(e={});var t=e.onFiles,n=e.onText,a=e.onUri,o=r.default(),l=i.useState(!1),u=l[0],c=l[1],d=i.useMemo((function(){return function(e,t){return function(n,a){var i=n.getData("text/uri-list");i?(e.onUri||s)(i,a):n.files&&n.files.length?(e.onFiles||s)(Array.from(n.files),a):n.items&&n.items.length&&n.items[0].getAsString((function(n){t&&(e.onText||s)(n,a)}))}}(e,o())}),[t,n,a]),p=i.useMemo((function(){return function(e,t){return{onDragOver:function(e){e.preventDefault()},onDragEnter:function(e){e.preventDefault(),t(!0)},onDragLeave:function(){t(!1)},onDrop:function(n){n.preventDefault(),n.persist(),t(!1),e(n.dataTransfer,n)},onPaste:function(t){t.persist(),e(t.clipboardData,t)}}}(d,c)}),[d,c]);return[p,{over:u}]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ensuredForwardRef=void 0;var a=n(2);function i(e){var t=a.useRef(e&&e.current);return a.useEffect((function(){e&&(e.current=t.current)}),[e]),t}t.default=i,t.ensuredForwardRef=function(e){return a.forwardRef((function(t,n){var a=i(n);return e(t,a)}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(null),t=e[0],n=e[1];return a.useEffect((function(){if(t)throw t}),[t]),a.useCallback((function(e){n(e)}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){a.useEffect((function(){var t=document.querySelector("link[rel*='icon']")||document.createElement("link");t.type="image/x-icon",t.rel="shortcut icon",t.href=e,document.getElementsByTagName("head")[0].appendChild(t)}),[e])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(795)),s=a.__importDefault(n(40)),o=function(){};t.default=function(e,t,n){void 0===n&&(n={});var a=n.video,l=n.onClose,u=void 0===l?o:l,c=i.useState(t),d=c[0],p=c[1];return s.default((function(){if(t&&e.current){var n=function(){a.current.removeEventListener("webkitendfullscreen",n),u()},i=function(){if(r.default.isEnabled){var e=r.default.isFullscreen;p(e),e||u()}};if(r.default.isEnabled){try{r.default.request(e.current),p(!0)}catch(e){u(e),p(!1)}r.default.on("change",i)}else a&&a.current&&a.current.webkitEnterFullscreen?(a.current.webkitEnterFullscreen(),a.current.addEventListener("webkitendfullscreen",n),p(!0)):(u(),p(!1));return function(){if(p(!1),r.default.isEnabled)try{r.default.off("change",i),r.default.exit()}catch(e){}else a&&a.current&&a.current.webkitExitFullscreen&&(a.current.removeEventListener("webkitendfullscreen",n),a.current.webkitExitFullscreen())}}}),[t,a,e]),d}},function(e,t,n){
/*!
* screenfull
* v5.0.0 - 2019-09-09
* (c) Sindre Sorhus; MIT License
*/
!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,a=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],a=0,i=n.length,r={};a<i;a++)if((e=n[a])&&e[1]in t){for(a=0;a<e.length;a++)r[n[0][a]]=e[a];return r}return!1}(),i={change:a.fullscreenchange,error:a.fullscreenerror},r={request:function(e){return new Promise(function(n,i){var r=function(){this.off("change",r),n()}.bind(this);this.on("change",r),e=e||t.documentElement,Promise.resolve(e[a.requestFullscreen]()).catch(i)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var i=function(){this.off("change",i),e()}.bind(this);this.on("change",i),Promise.resolve(t[a.exitFullscreen]()).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var a=i[e];a&&t.addEventListener(a,n,!1)},off:function(e,n){var a=i[e];a&&t.removeEventListener(a,n,!1)},raw:a};a?(Object.defineProperties(r,{isFullscreen:{get:function(){return Boolean(t[a.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[a.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[a.fullscreenEnabled])}}}),n?e.exports=r:window.screenfull=r):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){var t,n=i.useState({loading:!0,accuracy:null,altitude:null,altitudeAccuracy:null,heading:null,latitude:null,longitude:null,speed:null,timestamp:Date.now()}),r=n[0],s=n[1],o=!0,l=function(e){o&&s({loading:!1,accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,latitude:e.coords.latitude,longitude:e.coords.longitude,speed:e.coords.speed,timestamp:e.timestamp})},u=function(e){return o&&s((function(t){return a.__assign(a.__assign({},t),{loading:!1,error:e})}))};return i.useEffect((function(){return navigator.geolocation.getCurrentPosition(l,u,e),t=navigator.geolocation.watchPosition(l,u,e),function(){o=!1,navigator.geolocation.clearWatch(t)}}),[]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(223));t.default=function(e){void 0===e&&(e={});var t=r.default(),n=i.useRef(a.__assign({},e));return[i.useCallback((function(){return n.current}),[]),i.useCallback((function(e){e&&(Object.assign(n.current,e),t())}),[])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(799);t.default=function(e,t){void 0===t&&(t=0);var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=i.setHarmonicInterval((function(){return n.current()}),t);return function(){return i.clearHarmonicInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=0,i={};t.clearHarmonicInterval=function(e){var t=e.bucket,n=e.id;delete t.listeners[n];var a=!1;for(var r in t.listeners){a=!0;break}a||(clearInterval(t.timer),delete i[t.ms])},t.setHarmonicInterval=function(e,t){var n,r=a++;if(i[t])i[t].listeners[r]=e;else{var s=setInterval((function(){for(var e,n=i[t].listeners,a=!1,r=0,s=Object.values(n);r<s.length;r++){var o=s[r];try{o()}catch(t){a=!0,e=t}}if(a)throw e}),t);i[t]={ms:t,timer:s,listeners:(n={},n[r]=e,n)}}return{bucket:i[t],id:r}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importStar(n(2)),i=a.useState,r=function(){};t.default=function(e){var t,n,s=i(!1),o=s[0],l=s[1];return"function"==typeof e&&(e=e(o)),[a.cloneElement(e,{onMouseEnter:(n=e.props.onMouseEnter,function(e){(n||r)(e),l(!0)}),onMouseLeave:(t=e.props.onMouseLeave,function(e){(t||r)(e),l(!1)})}),o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(802),r=n(131),s=["mousemove","mousedown","resize","keydown","touchstart","wheel"];t.default=function(e,t,n){void 0===e&&(e=6e4),void 0===t&&(t=!1),void 0===n&&(n=s);var o=a.useState(t),l=o[0],u=o[1];return a.useEffect((function(){for(var t,a=!0,s=l,o=function(e){a&&(s=e,u(e))},c=i.throttle(50,(function(){s&&o(!1),clearTimeout(t),t=setTimeout((function(){return o(!0)}),e)})),d=function(){document.hidden||c()},p=0;p<n.length;p++)r.on(window,n[p],c);return r.on(document,"visibilitychange",d),t=setTimeout((function(){return o(!0)}),e),function(){a=!1;for(var e=0;e<n.length;e++)r.off(window,n[e],c);r.off(document,"visibilitychange",d)}}),[e,n]),l}},function(e,t,n){"use strict";function a(e,t,n,a){var i,r=!1,s=0;function o(){i&&clearTimeout(i)}function l(){var l=this,u=Date.now()-s,c=arguments;function d(){s=Date.now(),n.apply(l,c)}r||(a&&!i&&d(),o(),void 0===a&&u>e?d():!0!==t&&(i=setTimeout(a?function(){i=void 0}:d,void 0===a?e-u:e)))}return"boolean"!=typeof t&&(a=n,n=t,t=void 0),l.cancel=function(){o(),r=!0},l}Object.defineProperty(t,"__esModule",{value:!0}),t.throttle=a,t.debounce=function(e,t,n){return void 0===n?a(e,t,!1):a(e,n,!1!==t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useState(null),i=n[0],r=n[1];return a.useEffect((function(){if(e.current&&"function"==typeof IntersectionObserver){var n=new IntersectionObserver((function(e){r(e[0])}),t);return n.observe(e.current),function(){r(null),n.disconnect()}}return function(){}}),[e.current,t.threshold,t.root,t.rootMargin]),i}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useRef((function(){}));a.useEffect((function(){n.current=e})),a.useEffect((function(){if(null!==t){var e=setInterval((function(){return n.current()}),t||0);return function(){return clearInterval(e)}}}),[t])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){return void 0===e&&(e={laptopL:1440,laptop:1024,tablet:768}),function(){var t=a.useState(0),n=t[0],i=t[1];a.useEffect((function(){var e=function(){i(window.innerWidth)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}));var r=a.useMemo((function(){return Object.entries(e).sort((function(e,t){return e[1]>=t[1]?1:-1}))}),[e]),s=r.reduce((function(e,t){var a=t[0],i=t[1];return n>=i?a:e}),r[0][0]);return s}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(505)),r=a.__importDefault(n(254));t.default=function(e,t,n,a){void 0===a&&(a=i.default);var s=a(e),o=s[0],l=s[1];r.default((function(){!o&&n?n(l):o&&t&&t(l)}),[o])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r=function(){};t.default=function(e,t,n){if(!i.isClient)return[t,r,r];if(!e)throw new Error("useLocalStorage key may not be falsy");var s=n?n.raw?function(e){return e}:n.deserializer:JSON.parse,o=a.useState((function(){try{var a=n?n.raw?String:n.serializer:JSON.stringify,i=localStorage.getItem(e);return null!==i?s(i):(t&&localStorage.setItem(e,a(t)),t)}catch(e){return t}})),l=o[0],u=o[1],c=a.useCallback((function(t){try{var a="function"==typeof t?t(l):t;if(void 0===a)return;var i;i=n?n.raw?"string"==typeof a?a:JSON.stringify(a):n.serializer?n.serializer(a):JSON.stringify(a):JSON.stringify(a),localStorage.setItem(e,i),u(s(i))}catch(e){}}),[e,u]),d=a.useCallback((function(){try{localStorage.removeItem(e),u(void 0)}catch(e){}}),[e,u]);return[l,c,d]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r=function(e){var t=window.history,n=t[e];t[e]=function(t){var a=n.apply(this,arguments),i=new Event(e.toLowerCase());return i.state=t,window.dispatchEvent(i),a}};i.isClient&&(r("pushState"),r("replaceState"));var s=function(e){var t=window.history,n=t.state,a=t.length,i=window.location;return{trigger:e,state:n,length:a,hash:i.hash,host:i.host,hostname:i.hostname,href:i.href,origin:i.origin,pathname:i.pathname,port:i.port,protocol:i.protocol,search:i.search}},o="function"==typeof Event;t.default=i.isClient&&o?function(){var e=a.useState(s("load")),t=e[0],n=e[1];return a.useEffect((function(){var e=function(){return n(s("popstate"))},t=function(){return n(s("pushstate"))},a=function(){return n(s("replacestate"))};return i.on(window,"popstate",e),i.on(window,"pushstate",t),i.on(window,"replacestate",a),function(){i.off(window,"popstate",e),i.off(window,"pushstate",t),i.off(window,"replacestate",a)}}),[]),t}:function(){return{trigger:"load",length:1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getClosestBody=void 0;var a=n(2);function i(e){if(!e)return null;if("BODY"===e.tagName)return e;if("IFRAME"===e.tagName){var t=e.contentDocument;return t?t.body:null}return e.offsetParent?i(e.offsetParent):null}function r(e){var t=e||window.event;return t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)}t.getClosestBody=i;var s="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&/iP(ad|hone|od)/.test(window.navigator.platform),o=new Map,l="object"==typeof document?document:void 0,u=!1;t.default=l?function(e,t){void 0===e&&(e=!0);var n=a.useRef(l.body);t=t||n;var c=function(e){var t=o.get(e);t&&(1===t.counter?(o.delete(e),s?(e.ontouchmove=null,u&&(document.removeEventListener("touchmove",r),u=!1)):e.style.overflow=t.initialOverflow):o.set(e,{counter:t.counter-1,initialOverflow:t.initialOverflow}))};a.useEffect((function(){var n=i(t.current);n&&(e?function(e){var t=o.get(e);t?o.set(e,{counter:t.counter+1,initialOverflow:t.initialOverflow}):(o.set(e,{counter:1,initialOverflow:e.style.overflow}),s?u||(document.addEventListener("touchmove",r,{passive:!1}),u=!0):e.style.overflow="hidden")}(n):c(n))}),[e,t.current]),a.useEffect((function(){var e=i(t.current);if(e)return function(){c(e)}}),[])}:function(e,t){void 0===e&&(e=!0)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(256)),r=a.__importDefault(n(254));t.default=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];i.default((function(){return console.log.apply(console,a.__spreadArrays([e+" mounted"],t)),function(){return console.log(e+" unmounted")}})),r.default((function(){console.log.apply(console,a.__spreadArrays([e+" updated"],t))}))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e){(function(e){return"touches"in e})(e)&&e.touches.length<2&&e.preventDefault&&e.preventDefault()};t.default=function(e,t){var n=void 0===t?{}:t,r=n.isPreventDefault,s=void 0===r||r,o=n.delay,l=void 0===o?300:o,u=a.useRef(),c=a.useRef(),d=a.useCallback((function(t){s&&t.target&&(t.target.addEventListener("touchend",i,{passive:!1}),c.current=t.target),u.current=setTimeout((function(){return e(t)}),l)}),[e,l,s]),p=a.useCallback((function(){u.current&&clearTimeout(u.current),s&&c.current&&c.current.removeEventListener("touchend",i)}),[s]);return{onMouseDown:function(e){return d(e)},onTouchStart:function(e){return d(e)},onMouseUp:p,onMouseLeave:p,onTouchEnd:p}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131);t.default=function(e,t){void 0===t&&(t=!1);var n=a.useState(i.isClient?function(){return window.matchMedia(e).matches}:t),r=n[0],s=n[1];return a.useEffect((function(){var t=!0,n=window.matchMedia(e),a=function(){t&&s(!!n.matches)};return n.addListener(a),s(n.matches),function(){t=!1,n.removeListener(a)}}),[e]),r}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r=function(){};t.default="object"==typeof navigator&&navigator.mediaDevices?function(){var e=a.useState({}),t=e[0],n=e[1];return a.useEffect((function(){var e=!0,t=function(){navigator.mediaDevices.enumerateDevices().then((function(t){e&&n({devices:t.map((function(e){return{deviceId:e.deviceId,groupId:e.groupId,kind:e.kind,label:e.label}}))})})).catch(r)};return i.on(navigator.mediaDevices,"devicechange",t),t(),function(){e=!1,i.off(navigator.mediaDevices,"devicechange",t)}}),[]),t}:function(){return{}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMediatedState=void 0;var a=n(2);t.useMediatedState=function(e,t){var n=a.useRef(e),i=a.useState(t),r=i[0],s=i[1];return[r,a.useCallback((function(e){2===n.current.length?n.current(e,s):s(n.current(e))}),[r])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){var n=a.useMemo((function(){return function(t,n){var a;return(a=e(t))[n.type].apply(a,n.payload)}}),[e]),i=a.useReducer(n,t),r=i[0],s=i[1],o=a.useMemo((function(){return Object.keys(e(t)).reduce((function(e,t){return e[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return s({type:t,payload:e})},e}),{})}),[e,t]);return[r,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r={acceleration:{x:null,y:null,z:null},accelerationIncludingGravity:{x:null,y:null,z:null},rotationRate:{alpha:null,beta:null,gamma:null},interval:16};t.default=function(e){void 0===e&&(e=r);var t=a.useState(e),n=t[0],s=t[1];return a.useEffect((function(){var e=function(e){var t=e.acceleration,n=e.accelerationIncludingGravity,a=e.rotationRate,i=e.interval;s({acceleration:{x:t.x,y:t.y,z:t.z},accelerationIncludingGravity:{x:n.x,y:n.y,z:n.z},rotationRate:{alpha:a.alpha,beta:a.beta,gamma:a.gamma},interval:i})};return i.on(window,"devicemotion",e),function(){i.off(window,"devicemotion",e)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(503)),r=a.__importDefault(n(510)),s={current:null};t.default=function(e,t){void 0===t&&(t={});var n=!!t.whenHovered,a=!!t.bound,o=i.default(e,n),l=r.default(n&&!o?s:e);return a&&(l.elX=Math.max(0,Math.min(l.elX,l.elW)),l.elY=Math.max(0,Math.min(l.elY,l.elH))),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useState(0),t=e[0],n=e[1];return a.useEffect((function(){var e=function(e){n(e.deltaY+t)};return window.addEventListener("wheel",e,!1),function(){return window.removeEventListener("wheel",e)}})),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=n(131),s=function(){if("object"!=typeof navigator)return null;var e=navigator;return e.connection||e.mozConnection||e.webkitConnection},o=function(){var e=s();return e?{downlink:e.downlink,downlinkMax:e.downlinkMax,effectiveType:e.effectiveType,type:e.type,rtt:e.rtt}:{}};t.default=function(e){void 0===e&&(e={});var t=i.useState(e),n=t[0],l=t[1];return i.useEffect((function(){var e=n,t=function(t){e=a.__assign(a.__assign({},e),t),l(e)},i=s(),u=function(){t({online:!0,since:new Date})},c=function(){t({online:!1,since:new Date})},d=function(){t(o())};return r.on(window,"online",u),r.on(window,"offline",c),i&&(r.on(i,"change",d),t(a.__assign(a.__assign(a.__assign({},n),{online:navigator.onLine,since:void 0}),o()))),function(){r.off(window,"online",u),r.off(window,"offline",c),i&&r.off(i,"change",d)}}),[]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(501));t.default=a.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r={angle:0,type:"landscape-primary"};t.default=function(e){void 0===e&&(e=r);var t=window.screen,n=a.useState(e),s=n[0],o=n[1];return a.useEffect((function(){var n=!0,a=function(){if(n){var a=t.orientation;if(a){var i=a.angle,r=a.type;o({angle:i,type:r})}else window.orientation?o({angle:"number"==typeof window.orientation?window.orientation:0,type:""}):o(e)}};return i.on(window,"orientationchange",a),a(),function(){n=!1,i.off(window,"orientationchange",a)}}),[]),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=[]),a.useEffect((function(){if(e){var t=function(t){var n=(t=t||window.event).relatedTarget||t.toElement;n&&"HTML"!==n.nodeName||e()};return document.addEventListener("mouseout",t),function(){document.removeEventListener("mouseout",t)}}}),t)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131),r=function(){};t.default=function(e){var t=!0,n=null,s=a.useState(""),o=s[0],l=s[1],u=function(){t&&n&&l(n.state)};return a.useEffect((function(){return navigator.permissions.query(e).then((function(e){n=e,u(),i.on(n,"change",u)})).catch(r),function(){t=!1,n&&i.off(n,"change",u)}}),[]),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(300),r=function(e,t){return e===t};t.default=function(e,t){void 0===t&&(t=r);var n=a.useRef(),s=a.useRef(e);return i.useFirstMountState()||t(s.current,e)||(n.current=s.current,s.current=e),n.current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(207));t.default=function(){var e=r.default();return i.useCallback((function(t){return new Promise((function(n,a){t.then((function(t){e()&&n(t)}),(function(t){e()&&a(t)}))}))}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){void 0===e&&(e=[]);var t=i.useState(e),n=t[0],r=t[1];return{add:function(e){r((function(t){return a.__spreadArrays(t,[e])}))},remove:function(){var e;return r((function(t){var n=t[0],a=t.slice(1);return e=n,a})),e},get first(){return n[0]},get last(){return n[n.length-1]},get size(){return n.length}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t){void 0===t&&(t=!0);var n=a.useRef(null),i=a.useRef(!1),r=a.useRef(e);r.current=e;var s=a.useCallback((function(e){i.current&&(r.current(e),n.current=requestAnimationFrame(s))}),[]),o=a.useMemo((function(){return[function(){i.current&&(i.current=!1,n.current&&cancelAnimationFrame(n.current))},function(){i.current||(i.current=!0,n.current=requestAnimationFrame(s))},function(){return i.current}]}),[]);return a.useEffect((function(){return t&&o[1](),o[0]}),[]),o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=function(e,t){return new URLSearchParams(e).get(t)};t.default="object"==typeof window?function(e){var t=window.location,n=a.useState((function(){return i(t.search,e)})),r=n[0],s=n[1];return a.useEffect((function(){var n=function(){s(i(t.search,e))};return window.addEventListener("popstate",n),window.addEventListener("pushstate",n),window.addEventListener("replacestate",n),function(){window.removeEventListener("popstate",n),window.removeEventListener("pushstate",n),window.removeEventListener("replacestate",n)}}),[]),r}:function(){return null}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScratchSensor=void 0;var a=n(38),i=n(2),r=n(830),s=a.__importDefault(n(506)),o=function(){},l=function(e){void 0===e&&(e={});var t=e.disabled,n=s.default(e),r=i.useState({isScratching:!1}),l=r[0],u=r[1],c=i.useRef(l),d=i.useRef(!1),p=i.useRef(null),m=i.useState(null),f=m[0],g=m[1];return i.useEffect((function(){if(!t&&f){var e,i,r=function(e,t){cancelAnimationFrame(p.current),p.current=requestAnimationFrame((function(){var i=f.getBoundingClientRect(),r=i.left,s=i.top,l=r+window.scrollX,d=s+window.scrollY,p=e-l,m=t-d;u((function(e){var t=a.__assign(a.__assign({},e),{dx:p-(e.x||0),dy:m-(e.y||0),end:Date.now(),isScratching:!0});return c.current=t,(n.current.onScratch||o)(t),t}))}))},s=function(e){r(e.pageX,e.pageY)},l=function(e){r(e.changedTouches[0].pageX,e.changedTouches[0].pageY)},m=function(){d.current&&(d.current=!1,c.current=a.__assign(a.__assign({},c.current),{isScratching:!1}),(n.current.onScratchEnd||o)(c.current),u({isScratching:!1}),window.removeEventListener("mousemove",s),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i))};e=m,i=m;var g=function(t,a){if(d.current){var r=f.getBoundingClientRect(),p=r.left,m=r.top,g=p+window.scrollX,b=m+window.scrollY,y=t-g,v=a-b,h=Date.now(),E={isScratching:!0,start:h,end:h,docX:t,docY:a,x:y,y:v,dx:0,dy:0,elH:f.offsetHeight,elW:f.offsetWidth,elX:g,elY:b};c.current=E,(n.current.onScratchStart||o)(E),u(E),window.addEventListener("mousemove",s),window.addEventListener("touchmove",l),window.addEventListener("mouseup",e),window.addEventListener("touchend",i)}},b=function(e){d.current=!0,g(e.pageX,e.pageY)},y=function(e){d.current=!0,g(e.changedTouches[0].pageX,e.changedTouches[0].pageY)};return f.addEventListener("mousedown",b),f.addEventListener("touchstart",y),function(){f.removeEventListener("mousedown",b),f.removeEventListener("touchstart",y),window.removeEventListener("mousemove",s),window.removeEventListener("touchmove",l),window.removeEventListener("mouseup",e),window.removeEventListener("touchend",i),p.current&&cancelAnimationFrame(p.current),p.current=null,d.current=!1,c.current={isScratching:!1},u(c.current)}}}),[f,t,n]),[g,l]};t.ScratchSensor=function(e){e.children;var t=a.__rest(e,["children"]),n=l(t),s=n[0],o=n[1],u=r.render(e,o);return i.cloneElement(u,a.__assign(a.__assign({},u.props),{ref:function(e){u.props.ref&&("object"==typeof u.props.ref&&(u.props.ref.current=e),"function"==typeof u.props.ref&&u.props.ref(e)),s(e)}}))},t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hookToRenderProp=t.createEnhancer=t.render=void 0;var a=n(38),i=a.__importDefault(n(512));t.render=i.default;var r=a.__importDefault(n(831));t.createEnhancer=r.default;var s=a.__importDefault(n(834));t.hookToRenderProp=s.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.divWrapper=void 0;var a=n(38),i=a.__importStar(n(2)),r=a.__importDefault(n(832)),s=i.createElement,o=function(e,t,n,i){var r;return s(e,t?a.__assign(((r={})[t]=i,r),n):a.__assign(a.__assign({},i),n))};t.divWrapper=function(e,t,n,a){return s("div",null,o(e,t,n,a))},t.default=function(e,t,n){void 0===n&&(n=o);var a=function(i,o,l){void 0===o&&(o=t),void 0===l&&(l=null);var u="string"==typeof i;if(u)return function(e){return a(e,i||t,o)};var c=function(t){return s(e,l,(function(e){return n(i,o,t,e)}))};return u?r.default(c):c};return a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(833));t.default=function(e){return e.prototype?e:a.default(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importStar(n(2));t.default=function(e){var t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return a.__extends(n,t),n.prototype.render=function(){return e(this.props,this.context)},n}(i.Component);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(512)),i=function(e){return[e]};t.default=function(e,t){return void 0===t&&(t=i),function(n){return a.default(n,e.apply(void 0,t(n)))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(257));t.default=function(e){var t=r.default({x:0,y:0}),n=t[0],a=t[1];return i.useEffect((function(){var t=function(){e.current&&a({x:e.current.scrollLeft,y:e.current.scrollTop})};return e.current&&e.current.addEventListener("scroll",t,{capture:!1,passive:!0}),function(){e.current&&e.current.removeEventListener("scroll",t)}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e){var t=a.useState(!1),n=t[0],i=t[1];return a.useEffect((function(){if(e.current){var t,n=function(){i(!0),clearTimeout(t),t=setTimeout((function(){i(!1)}),150)};return e.current.addEventListener("scroll",n,!1),function(){e.current&&e.current.removeEventListener("scroll",n,!1)}}return function(){}}),[e]),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i=n(131);t.default=function(e,t,n){if(!i.isClient)return[t,function(){}];var r=a.useState((function(){try{var a=sessionStorage.getItem(e);return"string"!=typeof a?(sessionStorage.setItem(e,n?String(t):JSON.stringify(t)),t):n?a:JSON.parse(a||"null")}catch(e){return t}})),s=r[0],o=r[1];return a.useEffect((function(){try{var t=n?String(s):JSON.stringify(s);sessionStorage.setItem(e,t)}catch(e){}})),[s,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(839),r=a.__importDefault(n(375)),s=function(e,t){return e.every((function(e,n){return i.equal(e,t[n])}))};t.default=function(e,t){r.default(e,t,s)}},function(e,t){var n=Object.keys;t.equal=function(e,t){if(e===t)return!0;if(!(e instanceof Object&&t instanceof Object))return!1;for(var a=n(e),i=a.length,r=0;r<i;r++)if(!(a[r]in t))return!1;for(r=0;r<i;r++)if(e[a[r]]!==t[a[r]])return!1;return i===n(t).length}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importStar(n(2)),r=n(131),s=i.useState,o=i.useEffect,l=i.useRef;t.default=function(e,t){var n=void 0===t?{}:t,u=n.width,c=void 0===u?1/0:u,d=n.height,p=void 0===d?1/0:d;if(!r.isClient)return["function"==typeof e?e({width:c,height:p}):e,{width:c,height:p}];var m=s({width:c,height:p}),f=m[0],g=m[1];"function"==typeof e&&(e=e(f));var b=e.props.style||{},y=l(null),v=null,h=function(){var e=y.current,t=e?{width:e.offsetWidth,height:e.offsetHeight}:{width:c,height:p};g(t)},E=function(e){e.addEventListener("resize",h),setTimeout(h,35)};return o((function(){var e=y.current;if(e){if(e.contentWindow)v=e.contentWindow,E(v);else{var t=function(){e.removeEventListener("load",t),v=e.contentWindow,E(v)};e.addEventListener("load",t)}return function(){v&&v.removeEventListener&&v.removeEventListener("resize",h)}}}),[]),b.position="relative",[i.cloneElement.apply(i,a.__spreadArrays([e,{style:b}],a.__spreadArrays([i.createElement("iframe",{ref:y,style:{background:"transparent",border:"none",height:"100%",left:0,position:"absolute",top:0,width:"100%",zIndex:-1}})],i.Children.toArray(e.props.children)))),f]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=n(131),s=a.__importDefault(n(207)),o=a.__importDefault(n(255)),l=function(){};t.default=function(e,t){void 0===t&&(t={});var n=s.default(),a=i.useRef(!1),u=i.useRef(0),c=i.useRef(0),d=o.default({isSliding:!1,value:0}),p=d[0],m=d[1];return u.current=p.value,i.useEffect((function(){if(r.isClient){var i=void 0===t.styles||t.styles,s=void 0!==t.reverse&&t.reverse;e.current&&i&&(e.current.style.userSelect="none");var o=function(){!a.current&&n()&&((t.onScrubStart||l)(),a.current=!0,m({isSliding:!0}),y())},d=function(){a.current&&n()&&((t.onScrubStop||l)(u.current),a.current=!1,m({isSliding:!1}),v())},p=function(e){o(),f(e)},f=t.vertical?function(e){return h(e.clientY)}:function(e){return h(e.clientX)},g=function(e){o(),b(e)},b=t.vertical?function(e){return h(e.changedTouches[0].clientY)}:function(e){return h(e.changedTouches[0].clientX)},y=function(){r.on(document,"mousemove",f),r.on(document,"mouseup",d),r.on(document,"touchmove",b),r.on(document,"touchend",d)},v=function(){r.off(document,"mousemove",f),r.off(document,"mouseup",d),r.off(document,"touchmove",b),r.off(document,"touchend",d)},h=function(a){cancelAnimationFrame(c.current),c.current=requestAnimationFrame((function(){if(n()&&e.current){var i=e.current.getBoundingClientRect(),r=t.vertical?i.top:i.left,o=t.vertical?i.height:i.width;if(!o)return;var u=(a-r)/o;u>1?u=1:u<0&&(u=0),s&&(u=1-u),m({value:u}),(t.onScrub||l)(u)}}))};return r.on(e.current,"mousedown",p),r.on(e.current,"touchstart",g),function(){r.off(e.current,"mousedown",p),r.off(e.current,"touchstart",g)}}}),[e,t.vertical]),p}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(509)),s=a.__importDefault(n(255)),o="object"==typeof window&&"object"==typeof window.speechSynthesis?window.speechSynthesis.getVoices():[];t.default=function(e,t){void 0===t&&(t={});var n=s.default({isPlaying:!1,lang:t.lang||"default",voice:t.voice||o[0],rate:t.rate||1,pitch:t.pitch||1,volume:t.volume||1}),a=n[0],l=n[1],u=i.useRef(null);return r.default((function(){var n=new SpeechSynthesisUtterance(e);t.lang&&(n.lang=t.lang),t.voice&&(n.voice=t.voice),n.rate=t.rate||1,n.pitch=t.pitch||1,n.volume=t.volume||1,n.onstart=function(){return l({isPlaying:!0})},n.onresume=function(){return l({isPlaying:!0})},n.onend=function(){return l({isPlaying:!1})},n.onpause=function(){return l({isPlaying:!1})},u.current=n,window.speechSynthesis.speak(u.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(40));t.default=function(e){a.default((function(){var t=function(t){var n,a,i,r,s;!function(){var e=document.activeElement,t=document.body;if(!e)return!1;if(e===t)return!1;switch(e.tagName){case"INPUT":case"TEXTAREA":return!0}return e.hasAttribute("contenteditable")}()&&(a=(n=t).keyCode,i=n.metaKey,r=n.ctrlKey,s=n.altKey,!(i||r||s)&&(a>=48&&a<=57||a>=65&&a<=90))&&e(t)};return document.addEventListener("keydown",t),function(){document.removeEventListener("keydown",t)}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useStateWithHistory=void 0;var a=n(2),i=n(300),r=n(301);t.useStateWithHistory=function(e,t,n){if(void 0===t&&(t=10),t<1)throw new Error("Capacity has to be greater than 1, got '"+t+"'");var s=i.useFirstMountState(),o=a.useState(e),l=o[0],u=o[1],c=a.useRef(null!=n?n:[]),d=a.useRef(0);return s&&(c.current.length?(c.current[c.current.length-1]!==e&&c.current.push(e),c.current.length>t&&(c.current=c.current.slice(c.current.length-t))):c.current.push(e),d.current=c.current.length&&c.current.length-1),[l,a.useCallback((function(e){u((function(n){return(e=r.resolveHookState(e))!==n&&(d.current<c.current.length-1&&(c.current=c.current.slice(0,d.current+1)),d.current=c.current.push(e)-1,c.current.length>t&&(c.current=c.current.slice(c.current.length-t))),e}))}),[l,t]),a.useMemo((function(){return{history:c.current,position:d.current,capacity:t,back:function(e){void 0===e&&(e=1),d.current&&u((function(){return d.current-=Math.min(e,d.current),c.current[d.current]}))},forward:function(e){void 0===e&&(e=1),d.current!==c.current.length-1&&u((function(){return d.current=Math.min(d.current+e,c.current.length-1),c.current[d.current]}))},go:function(e){e!==d.current&&u((function(){return d.current=e<0?Math.max(c.current.length+e,0):Math.min(c.current.length-1,e),c.current[d.current]}))}}}),[l])]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(207)),s=a.__importDefault(n(223)),o=a.__importDefault(n(254));t.default=function(e){void 0===e&&(e=[]);var t=r.default(),n=s.default(),l=i.useRef(0);o.default((function(){e.length<=l.current&&(l.current=e.length-1,n())}),[e.length]);var u=i.useMemo((function(){return{next:function(){return u.setStateAt(l.current+1)},prev:function(){return u.setStateAt(l.current-1)},setStateAt:function(a){t()&&e.length&&a!==l.current&&(l.current=a>=0?a%e.length:e.length+a%e.length,n())},setState:function(a){if(t()){var i=e.length?e.indexOf(a):-1;if(-1===i)throw new Error("State '"+a+"' is not a valid state (does not exist in state list)");l.current=i,n()}}}}),[e]);return a.__assign({state:e[l.current],currentIndex:l.current},u)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(303));t.default=function(e,t){void 0===t&&(t=200);var n=i.useState(e),a=n[0],s=n[1],o=i.useRef(),l=i.useRef(null),u=i.useRef(0);return i.useEffect((function(){if(o.current)l.current=e,u.current=!0;else{s(e);var n=function(){u.current?(u.current=!1,s(l.current),o.current=setTimeout(n,t)):o.current=void 0};o.current=setTimeout(n,t)}}),[e]),r.default((function(){o.current&&clearTimeout(o.current)})),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(303));t.default=function(e,t,n){void 0===t&&(t=200);var a=i.useState(null),s=a[0],o=a[1],l=i.useRef(),u=i.useRef();return i.useEffect((function(){if(l.current)u.current=n;else{o(e.apply(void 0,n));var a=function(){u.current?(o(e.apply(void 0,u.current)),u.current=void 0,l.current=setTimeout(a,t)):l.current=void 0};l.current=setTimeout(a,t)}}),n),r.default((function(){l.current&&clearTimeout(l.current)})),s}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(376)),r=a.__importDefault(n(223));t.default=function(e){void 0===e&&(e=0);var t=r.default();return i.default(t,e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i={restoreOnUnmount:!1};t.default="undefined"!=typeof document?function(e,t){void 0===t&&(t=i);var n=a.useRef(document.title);document.title=e,a.useEffect((function(){return t&&t.restoreOnUnmount?function(){document.title=n.current}:void 0}),[])}:function(e){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(1092),r=a.__importDefault(n(511));t.default=function(e,t,n){return void 0===e&&(e="inCirc"),void 0===t&&(t=200),void 0===n&&(n=0),(0,i.easing[e])(r.default(t,n))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(){var e=a.useRef(!1);return a.useEffect((function(){return function(){e.current=!0}})),a.useMemo((function(){return function(t,n){return new Promise((function(a,i){t.then((function(t){e.current||a(t)}),(function(t){e.current?n?n(t):console.error("useUnmountPromise",t):i(t)}))}))}}),[])}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=a.__importDefault(n(508));t.default=function(e,t){void 0===t&&(t=[]);var n=i.default(t),r=n[0],s=n[1];return[r,a.__assign(a.__assign({},s),{upsert:function(t){s.upsert(e,t)}})]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),i="object"==typeof navigator&&"vibrate"in navigator;t.default=i?function(e,t,n){void 0===e&&(e=!0),void 0===t&&(t=[1e3,1e3]),void 0===n&&(n=!0),a.useEffect((function(){var a;if(e&&(navigator.vibrate(t),n)){var i=t instanceof Array?t.reduce((function(e,t){return e+t})):t;a=setInterval((function(){navigator.vibrate(t)}),i)}return function(){e&&(navigator.vibrate(0),n&&clearInterval(a))}}),[e])}:function(){}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38).__importDefault(n(499)).default("video");t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2);t.default=function(e,t,n){void 0===n&&(n=[void 0]);var i=a.useRef(t),r=a.useRef(e);i.current=t,r.current=e;var s=a.useState(n),o=s[0],l=s[1],u=a.useCallback((function(){i.current.length>=2?i.current(r.current,l):l(i.current(r.current))}),[l]);return a.useEffect((function(){u()}),[e]),[o,u]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useScrollbarWidth=void 0;var a=n(857),i=n(2);t.useScrollbarWidth=function(){var e=i.useState(a.scrollbarWidth()),t=e[0],n=e[1];return i.useEffect((function(){if(void 0===t){var e=requestAnimationFrame((function(){n(a.scrollbarWidth())}));return function(){return cancelAnimationFrame(e)}}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){if("undefined"==typeof document)return 0;if(document.body&&(!document.readyState||"loading"!==document.readyState)){if(!0!==e&&"number"==typeof a.__cache)return a.__cache;var t=document.createElement("div"),n=t.style;n.display="block",n.position="absolute",n.width="100px",n.height="100px",n.left="-999px",n.top="-999px",n.overflow="scroll",document.body.insertBefore(t,null);var i=t.clientWidth;if(0!==i)return a.__cache=100-i,document.body.removeChild(t),a.__cache;document.body.removeChild(t)}};t.scrollbarWidth=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useMultiStateValidator=void 0;var a=n(2);t.useMultiStateValidator=function(e,t,n){if(void 0===n&&(n=[void 0]),"object"!=typeof e)throw new Error("states expected to be an object or array, got "+typeof e);var i=a.useRef(t),r=a.useRef(e);i.current=t,r.current=e;var s=a.useState(n),o=s[0],l=s[1],u=a.useCallback((function(){i.current.length>=2?i.current(r.current,l):l(i.current(r.current))}),[l]);return a.useEffect((function(){u()}),Object.values(e)),[o,u]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=n(131),s=a.__importDefault(n(257));t.default=function(){var e=s.default({x:r.isClient?window.pageXOffset:0,y:r.isClient?window.pageYOffset:0}),t=e[0],n=e[1];return i.useEffect((function(){var e=function(){n({x:window.pageXOffset,y:window.pageYOffset})};return window.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){window.removeEventListener("scroll",e)}}),[]),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(257)),s=n(131);t.default=function(e,t){void 0===e&&(e=1/0),void 0===t&&(t=1/0);var n=r.default({width:s.isClient?window.innerWidth:e,height:s.isClient?window.innerHeight:t}),a=n[0],o=n[1];return i.useEffect((function(){if(s.isClient){var e=function(){o({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),a}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2),r=a.__importDefault(n(40)),s=n(131),o={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};t.default=s.isClient&&window.ResizeObserver?function(){var e=i.useState(null),t=e[0],n=e[1],a=i.useState(o),s=a[0],l=a[1],u=i.useMemo((function(){return new window.ResizeObserver((function(e){if(e[0]){var t=e[0].contentRect,n=t.x,a=t.y,i=t.width,r=t.height,s=t.top,o=t.left,u=t.bottom,c=t.right;l({x:n,y:a,width:i,height:r,top:s,left:o,bottom:u,right:c})}}))}),[]);return r.default((function(){if(t)return u.observe(t),function(){u.disconnect()}}),[t]),[n,s]}:function(){return[function(){},o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useRendersCount=void 0;var a=n(2);t.useRendersCount=function(){return++a.useRef(0).current}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(38),i=n(2);t.default=function(e){void 0===e&&(e=new Set);var t=i.useState(e),n=t[0],r=t[1],s=i.useMemo((function(){return{add:function(e){return r((function(t){return new Set(a.__spreadArrays(Array.from(t),[e]))}))},remove:function(e){return r((function(t){return new Set(Array.from(t).filter((function(t){return t!==e})))}))},toggle:function(e){return r((function(t){return t.has(e)?new Set(Array.from(t).filter((function(t){return t!==e}))):new Set(a.__spreadArrays(Array.from(t),[e]))}))},reset:function(){return r(e)}}}),[r]),o=a.__assign({has:i.useCallback((function(e){return n.has(e)}),[n])},s);return[n,o]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createGlobalState=void 0;var a=n(38),i=n(2),r=a.__importDefault(n(256)),s=a.__importDefault(n(40));function o(e){var t={state:e,setState:function(e){t.state=e,t.setters.forEach((function(e){return e(t.state)}))},setters:[]};return function(){var e=i.useState(t.state),n=e[0],a=e[1];return r.default((function(){return function(){t.setters=t.setters.filter((function(e){return e!==a}))}})),s.default((function(){t.setters.includes(a)||t.setters.push(a)})),[n,t.setState]}}t.createGlobalState=o,t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useHash=void 0;var a=n(38),i=n(2),r=a.__importDefault(n(507));t.useHash=function(){var e=i.useState((function(){return window.location.hash})),t=e[0],n=e[1],a=i.useCallback((function(){n(window.location.hash)}),[]);r.default((function(){window.addEventListener("hashchange",a)}),(function(){window.removeEventListener("hashchange",a)}));var s=i.useCallback((function(e){e!==t&&(window.location.hash=e)}),[t]);return[t,s]}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(23),i=n.n(a),r=n(17),s=n(2),o=n.n(s),l=n(44);const u=n.n(l)()(r.EuiEmptyPrompt).withConfig({displayName:"EmptyPrompt",componentId:"sc-tln1ed-0"})(["align-self:center;max-width:60em;"]);u.displayName="EmptyPrompt";const c=o.a.memo((({actions:e,message:t,title:n,...a})=>{const l=Object.keys(e),c=Object(s.useMemo)((()=>Object.values(e).filter((e=>e.label&&e.url)).map((({icon:e,label:t,target:n,url:a,descriptionTitle:i,description:s,onClick:u,fill:c=!0},d)=>null!=i||null!=s?o.a.createElement(r.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${l[d]}-action`},o.a.createElement(r.EuiCard,{title:null!=i&&i,description:null!=s&&s,footer:o.a.createElement(r.EuiButton,{href:a,onClick:u,iconType:e,target:n,fill:c,"data-test-subj":`empty-page-${l[d]}-action`},t)})):o.a.createElement(r.EuiFlexItem,{grow:!1,style:{maxWidth:283},key:`empty-page-${l[d]}-action`},o.a.createElement(r.EuiButton,{href:a,onClick:u,iconType:e,target:n,"data-test-subj":`empty-page-${l[d]}-action`},t))))),[e,l]);return o.a.createElement(u,i()({iconType:"logoSecurity",title:o.a.createElement(r.EuiText,null,o.a.createElement("h2",null,n)),body:t&&o.a.createElement("p",null,t),actions:o.a.createElement(r.EuiFlexGroup,{justifyContent:"center"},c)},a))}));c.displayName="EmptyPageComponent";const d=o.a.memo(c);d.displayName="EmptyPage"},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgd2lkdGg9IjI1NnB4IiBoZWlnaHQ9IjI1NXB4IiB2aWV3Qm94PSIwIDAgMjU2IDI1NSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBwcmVzZXJ2ZUFzcGVjdFJhdGlvPSJ4TWlkWU1pZCI+Cgk8Zz4KCQk8cGF0aCBkPSJNMjU1LjIxNDYxNywwLjI1NzU4MDI0NyBMMjU1LjIxNDYxNyw2My45OTM2NzkgTDE5MS42MDk2NzksMTI3LjU5ODYxNyBMMTkxLjYwOTY3OSw2My43Mjk3Nzc4IEwyNTUuMjE0NjE3LDAuMjU3NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTEyOC4wMDYzMjEsMC4yNTc1ODAyNDcgTDEyOC4wMDYzMjEsNjMuOTkzNjc5IEwxOTEuNjExMjU5LDEyNy41OTg2MTcgTDE5MS42MTEyNTksNjMuNzI5Nzc3OCBMMTI4LjAwNjMyMSwwLjI1NzU4MDI0NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDI1NC44MDM3NTMgTDE5MS42MDk2NzksMjU0LjgwMzc1MyBMMTI4LjAwNDc0MSwxOTEuMTk4ODE1IEwxOTEuODcyLDE5MS4xOTg4MTUgTDI1NS4zNDU3NzgsMjU0LjgwMzc1MyIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0yNTUuMzQ1Nzc4LDEyNy41OTU0NTcgTDE5MS42MDk2NzksMTI3LjU5NTQ1NyBMMTI4LjAwNDc0MSwxOTEuMjAwMzk1IEwxOTEuODcyLDE5MS4yMDAzOTUgTDI1NS4zNDU3NzgsMTI3LjU5NTQ1NyIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjgwMTE4NTE4NSwyNTQuOTM2NDk0IEwwLjgwMTE4NTE4NSwxOTEuMTk4ODE1IEw2NC40MDYxMjM1LDEyNy41OTM4NzcgTDY0LjQwNjEyMzUsMTkxLjQ2MjcxNiBMMC44MDExODUxODUsMjU0LjkzNjQ5NCIgZmlsbD0iI0E1OTZGRiI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0xMjguMDA5NDgxLDI1NC45MzY0OTQgTDEyOC4wMDk0ODEsMTkxLjE5ODgxNSBMNjQuNDA0NTQzMiwxMjcuNTkzODc3IEw2NC40MDQ1NDMyLDE5MS40NjI3MTYgTDEyOC4wMDk0ODEsMjU0LjkzNjQ5NCIgZmlsbD0iIzAwMDAwMCI+PC9wYXRoPgoJCTxwYXRoIGQ9Ik0wLjY3MTYwNDkzOCwwLjM4NTU4MDI0NyBMNjQuNDA3NzAzNywwLjM4NTU4MDI0NyBMMTI4LjAxMjY0Miw2My45OTA1MTg1IEw2NC4xNDUzODI3LDYzLjk5MDUxODUgTDAuNjcxNjA0OTM4LDAuMzg1NTgwMjQ3IiBmaWxsPSIjQTU5NkZGIj48L3BhdGg+CgkJPHBhdGggZD0iTTAuNjcxNjA0OTM4LDEyNy41OTM4NzcgTDY0LjQwNzcwMzcsMTI3LjU5Mzg3NyBMMTI4LjAxMjY0Miw2My45ODg5MzgzIEw2NC4xNDUzODI3LDYzLjk4ODkzODMgTDAuNjcxNjA0OTM4LDEyNy41OTM4NzciIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KCTwvZz4KPC9zdmc+Cg=="},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(870);n(23),n(2),n(518),n(13),n(269),n(268),n(519);var i=a.default.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){i[e]=i(e)})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(23),i=n(2),r=n(518),s=n(13),o=n(269),l=n(268),u=n(519);function c(e){return e&&e.__esModule?e:{default:e}}function d(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}var p=d(i),m=c(r).default,f=function(e){return"theme"!==e},g=function(e){return"string"==typeof e&&e.charCodeAt(0)>96?m:f},b=function(e,t,n){var a;if(t){var i=t.shouldForwardProp;a=e.__emotion_forwardProp&&i?function(t){return e.__emotion_forwardProp(t)&&i(t)}:i}return"function"!=typeof a&&n&&(a=e.__emotion_forwardProp),a},y="undefined"!=typeof document,v=function(e){var t=e.cache,n=e.serialized,a=e.isStringTag;o.registerStyles(t,n,a);var i=u.useInsertionEffectAlwaysWithSyncFallback((function(){return o.insertStyles(t,n,a)}));if(!y&&void 0!==i){for(var r,s=n.name,l=n.next;void 0!==l;)s+=" "+l.name,l=l.next;return p.createElement("style",((r={})["data-emotion"]=t.key+" "+s,r.dangerouslySetInnerHTML={__html:i},r.nonce=t.sheet.nonce,r))}return null};t.default=function e(t,n){var i,r,u=t.__emotion_real===t,c=u&&t.__emotion_base||t;void 0!==n&&(i=n.label,r=n.target);var d=b(t,n,u),m=d||g(c),f=!m("as");return function(){var y=arguments,h=u&&void 0!==t.__emotion_styles?t.__emotion_styles.slice(0):[];if(void 0!==i&&h.push("label:"+i+";"),null==y[0]||void 0===y[0].raw)h.push.apply(h,y);else{h.push(y[0][0]);for(var E=y.length,x=1;x<E;x++)h.push(y[x],y[0][x])}var j=s.withEmotionCache((function(e,t,n){var a=f&&e.as||c,i="",u=[],b=e;if(null==e.theme){for(var y in b={},e)b[y]=e[y];b.theme=p.useContext(s.ThemeContext)}"string"==typeof e.className?i=o.getRegisteredStyles(t.registered,u,e.className):null!=e.className&&(i=e.className+" ");var E=l.serializeStyles(h.concat(u),t.registered,b);i+=t.key+"-"+E.name,void 0!==r&&(i+=" "+r);var x=f&&void 0===d?g(a):m,j={};for(var O in e)f&&"as"===O||x(O)&&(j[O]=e[O]);return j.className=i,j.ref=n,p.createElement(p.Fragment,null,p.createElement(v,{cache:t,serialized:E,isStringTag:"string"==typeof a}),p.createElement(a,j))}));return j.displayName=void 0!==i?i:"Styled("+("string"==typeof c?c:c.displayName||c.name||"Component")+")",j.defaultProps=t.defaultProps,j.__emotion_real=j,j.__emotion_base=c,j.__emotion_styles=h,j.__emotion_forwardProp=d,Object.defineProperty(j,"toString",{value:function(){return"."+r}}),j.withComponent=function(t,i){return e(t,a({},n,i,{shouldForwardProp:b(j,i,!0)})).apply(void 0,h)},j}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(418);function i(e){return e&&e.__esModule?e:{default:e}}var r=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,s=i(a).default((function(e){return r.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));t.default=s},function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}})),t.default=e,Object.freeze(t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(2)),r="undefined"!=typeof document,s=!!i.useInsertionEffect&&i.useInsertionEffect,o=r&&s||function(e){return e()},l=s||i.useLayoutEffect;t.useInsertionEffectAlwaysWithSyncFallback=o,t.useInsertionEffectWithLayoutFallback=l},function(e,t,n){"use strict";var a=n(513),i=n(2);function r(e,t,n){return e[t]?e[t][0]?e[t][0][n]:e[t][n]:"contentBoxSize"===t?e.contentRect["inlineSize"===n?"width":"height"]:void 0}e.exports=function(e){void 0===e&&(e={});var t=e.onResize,n=i.useRef(void 0);n.current=t;var s=e.round||Math.round,o=i.useRef(),l=i.useState({width:void 0,height:void 0}),u=l[0],c=l[1],d=i.useRef(!1);i.useEffect((function(){return d.current=!1,function(){d.current=!0}}),[]);var p=i.useRef({width:void 0,height:void 0}),m=function(e,t){var n=i.useRef(null),a=i.useRef(null);a.current=t;var r=i.useRef(null);i.useEffect((function(){s()}));var s=i.useCallback((function(){var t=r.current,i=a.current,s=t||(i?i instanceof Element?i:i.current:null);n.current&&n.current.element===s&&n.current.subscriber===e||(n.current&&n.current.cleanup&&n.current.cleanup(),n.current={element:s,subscriber:e,cleanup:s?e(s):void 0})}),[e]);return i.useEffect((function(){return function(){n.current&&n.current.cleanup&&(n.current.cleanup(),n.current=null)}}),[]),i.useCallback((function(e){r.current=e,s()}),[s])}(i.useCallback((function(t){return o.current&&o.current.box===e.box&&o.current.round===s||(o.current={box:e.box,round:s,instance:new a.ResizeObserver((function(t){var a=t[0],i="border-box"===e.box?"borderBoxSize":"device-pixel-content-box"===e.box?"devicePixelContentBoxSize":"contentBoxSize",o=r(a,i,"inlineSize"),l=r(a,i,"blockSize"),u=o?s(o):void 0,m=l?s(l):void 0;if(p.current.width!==u||p.current.height!==m){var f={width:u,height:m};p.current.width=u,p.current.height=m,n.current?n.current(f):d.current||c(f)}}))}),o.current.instance.observe(t,{box:e.box}),function(){o.current&&o.current.instance.unobserve(t)}}),[e.box,s]),e.ref);return i.useMemo((function(){return{ref:m,width:u.width,height:u.height}}),[m,u.width,u.height])}},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return c}));var a=n(111),i=n(289),r=n(607);let s;!function(e){e.Prebuilt="prebuilt",e.Custom="custom"}(s||(s={}));const o=a.object({searchTerm:a.string(),source:a.nativeEnum(s),tags:a.array(a.string()),enabled:a.boolean(),ruleExecutionStatus:i.e}).partial(),l=r.b.pick({field:!0,order:!0}).partial(),u=r.a.pick({perPage:!0}).partial(),c=r.a.pick({page:!0,perPage:!0}).partial()},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"i",(function(){return s})),n.d(t,"j",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return p})),n.d(t,"f",(function(){return m}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTitle",{defaultMessage:"Installed"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.installedTooltip",{defaultMessage:"Integration is installed. Configure an integration policy and ensure Elastic Agents are assigned this policy to ingest compatible events."}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTitle",{defaultMessage:"Not installed"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.uninstalledTooltip",{defaultMessage:"Integration is not installed. Follow the integration link to install and configure the integration."}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTitle",{defaultMessage:"Installed: enabled"}),u=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.enabledTooltip",{defaultMessage:"Integration is installed and an integration policy with the required configuration exists. Ensure Elastic Agents are assigned this policy to ingest compatible events."}),c=a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.badgeTitle",{defaultMessage:"integrations"}),d=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverTitle",{values:{integrationsCount:e},defaultMessage:"[{integrationsCount}] Related {integrationsCount, plural, =1 {integration} other {integrations}} available"}),p=e=>a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescription",{values:{integrationsCount:e},defaultMessage:"Install and configure {integrationsCount, plural, =1 {the below integration} other {one or more of the below integrations}} to ingest the necessary data for this detection rule:"}),m=(e,t)=>a.i18n.translate("xpack.securitySolution.detectionEngine.relatedIntegrations.popoverDescriptionInstalledVersionTooltip",{values:{installedVersion:e,requiredVersion:t},defaultMessage:"Version mismatch -- please resolve! Installed version `{installedVersion}` when required version `{requiredVersion}`"})},function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"i",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"d",(function(){return d})),n.d(t,"h",(function(){return p})),n.d(t,"c",(function(){return m})),n.d(t,"a",(function(){return f})),n.d(t,"j",(function(){return g})),n.d(t,"b",(function(){return b}));var a=n(51),i=n(5),r=n(169),s=n(277);const o=(e,t,n)=>n.reduce(((n,i,r)=>{const s=((e,t,n,i,r=a.v4)=>{var s;const{fields:o}=e,{fields:l}=t,u=n.field,c=n.value,[d]=o.filter((({name:e})=>null!=u&&u===e)),[p]=l.filter((({name:e})=>null!=c&&c===e));return{id:null!==(s=n.id)&&void 0!==s?s:r(),field:d,type:"mapping",value:p,entryIndex:i}})(e,t,i,r);return[...n,s]}),[]),l=(e,t)=>({...e,entries:[...e.entries.slice(0,t),...e.entries.slice(t+1)]}),u=(e,t)=>{const{entryIndex:n}=e;return{updatedEntry:{id:e.id,field:null!=t?t.name:"",type:"mapping",value:null!=e.value?e.value.name:""},index:n}},c=(e,t)=>{const{entryIndex:n}=e;return{updatedEntry:{id:e.id,field:null!=e.field?e.field.name:"",type:"mapping",value:null!=t?t.name:""},index:n}},d=()=>Object(r.d)({field:"",type:"mapping",value:""}),p=()=>Object(r.d)({entries:[Object(r.d)({field:"",type:"mapping",value:""})]}),m=e=>e.reduce(((e,t)=>{const n={...t,entries:t.entries};return s.o.is(n)?[...e,n]:e}),[]),f=e=>e.some((e=>e.entries.some((e=>""===e.field||""===e.value)))),g=e=>1===e.length&&1===e[0].entries.length&&""===e[0].entries[0].field&&""===e[0].entries[0].value,b={forbiddenField:(e,t)=>{let n;if(n="string"==typeof e?e===t:!!Array.isArray(e)&&!!e.find((e=>e===t)),n)return{code:"ERR_FIELD_FORMAT",message:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchIndexForbiddenError",{defaultMessage:"The index pattern cannot be { forbiddenString }. Please choose a more specific index pattern.",values:{forbiddenString:t}})}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"g",(function(){return m}));var a=n(49),i=n(57),r=n(178);const s=e=>e.artifacts.location,o=e=>{var t;return null===(t=e.location)||void 0===t?void 0:t.pathname},l=Object(i.createSelector)(o,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.n,exact:!0}))),u=Object(i.createSelector)(o,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.r,exact:!0}))),c=Object(i.createSelector)(o,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.m,exact:!0}))),d=Object(i.createSelector)(o,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.o,exact:!0}))),p=Object(i.createSelector)(o,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.l,exact:!0}))),m=Object(i.createSelector)(o,(e=>null!==Object(a.matchPath)(null!=e?e:"",{path:r.q,exact:!0})))},,,,,,function(e,t,n){"use strict";n.d(t,"d",(function(){return J})),n.d(t,"a",(function(){return Y})),n.d(t,"b",(function(){return X})),n.d(t,"c",(function(){return ee}));var a=n(2),i=n.n(a),r=n(17),s=n(517),o=n.n(s),l=n(55),u=n(47),c=n(427),d=n(331);const p=`${c.a}RulePreview`,m=`${p}RulePreviewTitle`,f=`${m}Suppressed`,g=`${p}CreatedByText`,b=`${p}UpdatedByText`,y=`${p}Body`,v=`${p}AboutSection`,h=(d.c,d.a,`${p}DefinitionSection`),E=(d.c,d.a,`${p}ScheduleSection`),x=(d.c,d.a,`${p}ActionsSection`),j=(d.c,d.a,`${p}Loading`),O=`${p}Footer`,S=`${c.a}AlertReasonPreviewBody`;var k=n(601),w=n(960),T=n(572),I=n(491);const C=o.a.div`
  overflow-x: auto;
  padding-block: ${l.euiThemeVars.euiSizeS};
`,M=o.a.div``,_=()=>{const{dataAsNestedObject:e,scopeId:t}=Object(k.b)(),n=Object(a.useMemo)((()=>Object(w.a)({data:e,rowRenderers:T.b})),[e]),s=Object(a.useMemo)((()=>n?n.renderRow({contextId:"event-details",data:e,isDraggable:!1,scopeId:t}):null),[n,e,t]);return n?i.a.createElement(r.EuiPanel,{hasShadow:!1,"data-test-subj":S},i.a.createElement(r.EuiTitle,null,i.a.createElement("h6",null,i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.alertReason.panelTitle",defaultMessage:"Alert reason"}))),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(C,null,i.a.createElement(M,{className:"eui-displayInlineBlock"},s))):i.a.createElement(r.EuiPanel,{hasShadow:!1,hasBorder:!1},i.a.createElement(I.a,null))};_.displayName="AlertReasonPreview";var A=n(179),P=n(428),F=n(340),D=n(1105),N=n(1136);const R=({rule:e,isSuppressed:t})=>i.a.createElement("div",{"data-test-subj":m},i.a.createElement(r.EuiTitle,null,i.a.createElement("h6",null,e.name)),t&&i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiBadge,{"data-test-subj":f,title:""},D.a)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiFlexGroup,{gutterSize:"xs",direction:"column"},i.a.createElement(r.EuiFlexItem,{"data-test-subj":g},i.a.createElement(r.EuiText,{size:"xs"},i.a.createElement(N.a,{createdBy:null==e?void 0:e.created_by,createdAt:null==e?void 0:e.created_at}))),i.a.createElement(r.EuiFlexItem,{"data-test-subj":b},i.a.createElement(r.EuiText,{size:"xs"},i.a.createElement(N.b,{updatedBy:null==e?void 0:e.updated_by,updatedAt:null==e?void 0:e.updated_at})))));R.displayName="RulePreviewTitle";var L=n(1071),z=n(1072),B=n(1073),q=n(686),$=n(394);const V=A.css`
  dt {
    font-size: 90% !important;
  }
  text-overflow: ellipsis;
  .euiFlexGroup {
    flex-wrap: inherit;
  }

  .euiFlexItem {
    inline-size: inherit;
    flex-basis: inherit;
  }
`,U=Object(a.memo)((()=>{var e,t;const{ruleId:n}=Object(k.b)(),[s,o]=Object(a.useState)(null),{rule:l,loading:c,isExistingRule:p}=Object(P.a)(null!=n?n:"");Object(a.useEffect)((()=>{null!=l&&o(l)}),[l]);const{ruleActionsData:m}=null!=s?Object(F.h)({rule:s,detailsView:!0}):{ruleActionsData:null},f=Boolean(null==m||null===(e=m.actions)||void 0===e?void 0:e.length),g=Boolean(null==m||null===(t=m.responseActions)||void 0===t?void 0:t.length),b=null!=m&&(f||g);return c?i.a.createElement($.a,{"data-test-subj":j}):s?i.a.createElement(r.EuiPanel,{hasBorder:!1,hasShadow:!1,"data-test-subj":y,className:"eui-yScroll"},i.a.createElement(R,{rule:s,isSuppressed:!p}),i.a.createElement(r.EuiHorizontalRule,{margin:"s"}),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(d.b,{title:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.aboutLabel",defaultMessage:"About"}),expanded:!0,"data-test-subj":v},i.a.createElement(r.EuiText,{size:"s"},s.description),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(L.b,{rule:s,hideName:!0,hideDescription:!0,type:"row",rowGutterSize:"s",className:V})),i.a.createElement(r.EuiHorizontalRule,{margin:"l"}),i.a.createElement(d.b,{title:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.definitionLabel",defaultMessage:"Definition"}),expanded:!1,"data-test-subj":h},i.a.createElement(B.a,{rule:s,type:"row",rowGutterSize:"s",className:V})),i.a.createElement(r.EuiHorizontalRule,{margin:"l"}),i.a.createElement(d.b,{title:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.scheduleLabel",defaultMessage:"Schedule"}),expanded:!1,"data-test-subj":E},i.a.createElement(z.a,{rule:s,type:"row",rowGutterSize:"s",className:V})),i.a.createElement(r.EuiHorizontalRule,{margin:"l"}),b&&i.a.createElement(d.b,{title:i.a.createElement(u.FormattedMessage,{id:"xpack.securitySolution.flyout.preview.rule.actionsLabel",defaultMessage:"Actions"}),expanded:!1,"data-test-subj":x},i.a.createElement(q.b,{addPadding:!1,defaultValues:m}))):i.a.createElement(r.EuiPanel,{hasBorder:!1,hasShadow:!1},i.a.createElement(I.a,null))}));U.displayName="RulePreview";var H=n(5),Z=n(928),G=n(285);const Q=Object(a.memo)((({children:e,...t})=>i.a.createElement(r.EuiFlyoutFooter,t,i.a.createElement(r.EuiPanel,{hasShadow:!1,color:"transparent"},e))));Q.displayName="FlyoutFooter";const W=Object(a.memo)((()=>{const{scopeId:e,eventId:t,ruleId:n}=Object(k.b)();return n?i.a.createElement(Q,{"data-test-subj":O},i.a.createElement(r.EuiFlexGroup,{justifyContent:"center"},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(Z.a,{contextId:e,eventId:t,fieldName:G.n,fieldType:"string",isAggregatable:!1,isDraggable:!1,linkValue:n,value:H.i18n.translate("xpack.securitySolution.flyout.preview.rule.viewDetailsLabel",{defaultMessage:"Show rule details"}),openInNewTab:!0})))):null}));W.displayName="RulePreviewFooter";const K=[{id:"rule-preview",content:i.a.createElement(U,null),footer:i.a.createElement(W,null)},{id:"alert-reason-preview",content:i.a.createElement(_,null)}],J="rule-preview",Y="alert-reason-preview",X="document-details-preview",ee=Object(a.memo)((({path:e})=>{const t=Object(a.useMemo)((()=>e?K.find((t=>t.id===e.tab)):null),[e]);return t?i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween",direction:"column",gutterSize:"none",style:{height:"100%"}},i.a.createElement(r.EuiFlexItem,{style:{marginTop:"-15px"}},t.content),i.a.createElement(r.EuiFlexItem,{grow:!1},t.footer)):null}));ee.displayName="PreviewPanel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return h}));var a=n(2),i=n.n(a),r=n(4),s=n(387),o=n(117),l=n(110),u=n(5);const c=u.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.readListsPrivileges.errorDescription",{defaultMessage:"Failed to retrieve lists privileges"}),d=u.i18n.translate("xpack.securitySolution.containers.detectionEngine.alerts.detectionEnginePrivileges.errorFetching",{defaultMessage:"Failed to retrieve detection engine privileges"});var p=n(152),m=n(311);var f=n(9),g=n(18),b=n(575),y=n(902);const v=Object(a.createContext)({listPrivileges:{loading:!1,error:void 0,result:void 0},detectionEnginePrivileges:{loading:!1,error:void 0,result:void 0},endpointPrivileges:{loading:!0,...Object(b.b)()},kibanaSecuritySolutionsPrivileges:{crud:!1,read:!1}}),h=({kibanaCapabilities:e,children:t})=>{const n=!0===e[r.vc].crud,u=!0===e[r.vc].show,[h,E]=Object(a.useState)({crud:n,read:u}),x=((e=!0)=>{const t=Object(l.h)(),{lists:n}=Object(l.i)().services,{start:i,...r}=Object(s.l)(),{addError:u}=Object(o.a)(),d=Object(a.useRef)(new AbortController);return Object(a.useEffect)((()=>{const{loading:a,result:s,error:o}=r;!e||!n||a||s||o||(d.current.abort(),d.current=new AbortController,i({http:t,signal:d.current.signal}))}),[t,n,i,r,e]),Object(a.useEffect)((()=>()=>{d.current.abort()}),[]),Object(a.useEffect)((()=>{const e=r.error;null!=e&&u(e,{title:c})}),[u,r.error]),{loading:r.loading,error:r.error,result:r.result}})(u),j=((e=!0)=>{const{start:t,...n}=Object(p.a)(Object(p.d)(m.i)),{addError:i}=Object(o.a)(),r=Object(a.useRef)(new AbortController);return Object(a.useEffect)((()=>{const{loading:a,result:i,error:s}=n;!e||a||i||s||(r.current.abort(),r.current=new AbortController,t({signal:r.current.signal}))}),[t,n,e]),Object(a.useEffect)((()=>()=>{r.current.abort()}),[]),Object(a.useEffect)((()=>{const e=n.error;null!=e&&i(e,{title:d})}),[i,n.error]),n})(u),O=(()=>{var e,t;const n=Object(p.b)(),i=Object(l.f)(),r=Object(l.i)().services.fleet,s=null===(e=Object(y.b)())||void 0===e?void 0:e.fleet,o=null!==(t=null==r?void 0:r.authz)&&void 0!==t?t:null==s?void 0:s.authz,u=Object(g.b)(),[c,d]=Object(a.useState)(!1),[m,v]=Object(a.useState)([]),h=Object(a.useMemo)((()=>{const e=!c||!i;return Object.freeze({loading:e,...e||!o||Object(f.isEmpty)(i)?Object(b.b)():Object(b.a)(u,o,m)})}),[c,i,o,u,m]);return Object(a.useEffect)((()=>{(async()=>{i&&n()&&(v(null==i?void 0:i.roles),d(!0))})()}),[n,i]),h})();return Object(a.useEffect)((()=>{E((e=>e.read!==u||e.crud!==n?{read:u,crud:n}:e))}),[n,u]),i.a.createElement(v.Provider,{value:{listPrivileges:x,detectionEnginePrivileges:j,endpointPrivileges:O,kibanaSecuritySolutionsPrivileges:h}},t)}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return g})),n.d(t,"c",(function(){return b}));var a=n(9),i=n(231),r=n(110),s=n(307),o=n(3),l=n(54);const u=e=>"parsing_exception"===e||"verification_exception"===e||"mapping_exception"===e,c=e=>Object(a.has)(e,"error.type"),d=e=>e.error.root_cause.filter((e=>u(e.type))).map((e=>e.reason));var p=n(475);let m;!function(e){e.FAILED_REQUEST="ERR_FAILED_REQUEST",e.INVALID_EQL="ERR_INVALID_EQL"}(m||(m={}));const f=(e,t)=>{let n,a=[];return(...i)=>(n&&clearTimeout(n),n=setTimeout((()=>{const t=e(...i);a.forEach((e=>e(t))),a=[]}),t),new Promise((e=>a.push(e))))},g=async(...e)=>{const[{value:t,formData:n}]=e,{query:f}=t,g=f.query,{dataViewId:b,index:y,ruleType:v}=n;if(void 0===v&&!Object(a.isEmpty)(g)||Object(i.b)(v)&&!Object(a.isEmpty)(g))try{const{data:e}=r.b.get();let t=null==y?void 0:y.join(),i={};if(null!=b&&""!==b&&n.dataSourceType===s.a.DataView){const n=await e.dataViews.get(b);t=n.title,i=n.getRuntimeMappings()}const p=(new AbortController).signal,f=await(async({data:e,dataViewTitle:t,query:n,signal:i,runtimeMappings:r})=>{const{rawResponse:s}=await Object(o.firstValueFrom)(e.search.search({params:{index:t,body:{query:n,runtime_mappings:r,size:0}},options:{ignore:[400]}},{strategy:l.EQL_SEARCH_STRATEGY,abortSignal:i}));if((e=>c(e)&&u(Object(a.get)(e,"error.type")))(s))return{valid:!1,errors:d(s)};if(c(s))throw new Error(JSON.stringify(s));return{valid:!0,errors:[]}})({data:e,query:g,signal:p,dataViewTitle:t,runtimeMappings:i});if(!1===(null==f?void 0:f.valid))return{code:m.INVALID_EQL,message:"",messages:f.errors}}catch(e){return{code:m.FAILED_REQUEST,message:p.m,error:e}}},b=e=>{const t=e.errors.length>0,n=!e.isChangingValue&&!t;if(t){const[t]=e.errors,a=t.message;return t.code===m.INVALID_EQL?{isValid:n,message:a,messages:t.messages}:{isValid:n,message:a,error:t.error}}return{isValid:n,message:""}}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(45),i=n(2),r=n(117),s=n(110),o=n(21),l=n(1129),u=n(5);const c=u.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.startJobFailureTitle",{defaultMessage:"Start job failure"}),d=u.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.stopJobFailureTitle",{defaultMessage:"Stop job failure"}),p=u.i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.createJobFailureTitle",{defaultMessage:"Create job failure"}),m=()=>{const{telemetry:e}=Object(s.i)().services,{addError:t}=Object(r.a)(),[n,a]=Object(i.useState)(!1);return{enableDatafeed:Object(i.useCallback)((async(n,i)=>{if(a(!0),Object(o.h)(o.a.COUNT,n.isElasticJob?o.c.SIEM_JOB_ENABLED:o.c.CUSTOM_JOB_ENABLED),!n.isInstalled)try{await Object(l.c)({configTemplate:n.moduleId,indexPatternName:n.defaultIndexPattern,jobIdErrorFilter:[n.id],groups:n.groups}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,moduleId:n.moduleId,status:o.b.moduleInstalled})}catch(i){return a(!1),t(i,{title:p}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,moduleId:n.moduleId,status:o.b.installationError,errorMessage:`${p} - ${i.message}`}),{enabled:!1}}const r=new Date,s=r.setDate(r.getDate()-14),u=`datafeed-${n.id}`,d=Math.max(i,s);try{var m;const t=await Object(l.d)({datafeedIds:[u],start:d});if(null!==(m=t[u])&&void 0!==m&&m.error)throw new Error(t[u].error);return e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.started}),{enabled:!!t[u]&&t[u].started}}catch(a){Object(o.h)(o.a.COUNT,o.c.JOB_ENABLE_FAILURE),t(a,{title:c}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.startError,errorMessage:`${c} - ${a.message}`})}finally{a(!1)}return{enabled:!1}}),[t,e]),disableDatafeed:Object(i.useCallback)((async n=>{Object(o.h)(o.a.COUNT,n.isElasticJob?o.c.SIEM_JOB_DISABLED:o.c.CUSTOM_JOB_DISABLED),a(!0);const i=`datafeed-${n.id}`;try{const[t]=await Object(l.e)({datafeedIds:[i]});if(f(t))throw new Error(t.error);return e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.stopped}),{enabled:!t[i]||!t[i].stopped}}catch(a){Object(o.h)(o.a.COUNT,o.c.JOB_DISABLE_FAILURE),t(a,{title:d}),e.reportMLJobUpdate({jobId:n.id,isElasticJob:n.isElasticJob,status:o.b.stopError,errorMessage:`${d} - ${a.message}`})}finally{a(!1)}return{enabled:!0}}),[t,e]),isLoading:n}},f=e=>!Object(a.isEmpty)(e.error)},,,function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.alert="alert",e.asset="asset",e.enrichment="enrichment",e.event="event",e.metric="metric",e.state="state",e.pipeline_error="pipeline_error",e.signal="signal"}(a||(a={}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return r}));var a=n(2);const i=n.n(a).a.createContext(void 0),r=()=>Object(a.useContext)(i)},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o}));var a=n(26);const i=n.n(a)()("x-pack/security_solution/discover"),r=i("UPDATE_DISCOVER_APP_STATE"),s=i("UPDATE_DISCOVER_INTERNAL_STATE"),o=i("UPDATE_DISCOVER_SAVED_SEARCH_STATE")},function(e,t,n){var a=n(1029),i=n(1033),r=n(638),s=n(274),o=n(1039);e.exports=function(e){return"function"==typeof e?e:null==e?r:"object"==typeof e?s(e)?i(e[0],e[1]):a(e):o(e)}},function(e,t,n){e.exports=n(24)(1228)},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n.n(a),r=n(48),s=n(957),o=n(271);const l=i.a.memo((e=>{const t=Object(r.useSelector)((t=>t.analyzer[e.resolverComponentInstanceID])),n=Object(r.useDispatch)();return t||n(Object(o.createResolver)({id:e.resolverComponentInstanceID})),Object(a.useEffect)((()=>{e.shouldUpdate&&n(Object(o.createResolver)({id:e.resolverComponentInstanceID}))}),[n,e.shouldUpdate,e.resolverComponentInstanceID]),i.a.createElement(s.a,e)}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(211),i=n(428);const r=({dataFormattedForFieldBrowser:e})=>{const t=Object(a.b)(e),{loading:n,error:r,rule:s}=Object(i.a)(t.ruleId);return{loading:n,error:r,basicAlertData:t,ruleNote:null==s?void 0:s.note}}},function(e,t,n){"use strict";var a=n(260);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return j}));var a=n(1155),i=n.n(a),r=n(2),s=n.n(r),o=n(17),l=n(47),u=n(236),c=n(18),d=n(379),p=n(963),m=n(183),f=n(201),g=n(670),b=n(126),y=n(151);const v="prevalence-details",h="now-30d",E=()=>{const{euiTheme:e}=Object(o.useEuiTheme)();return s.a.createElement("div",{"data-test-subj":m.t,style:{height:"16px",width:"100%",background:e.colors.lightShade}})},x=[{field:"field",name:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.fieldColumnLabel",defaultMessage:"Field"}),"data-test-subj":m.q,render:e=>s.a.createElement(o.EuiText,{size:"xs"},e),width:"20%"},{field:"values",name:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.valueColumnLabel",defaultMessage:"Value"}),"data-test-subj":m.v,render:e=>s.a.createElement(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},e.map((e=>s.a.createElement(o.EuiFlexItem,{key:e},s.a.createElement(o.EuiText,{size:"xs"},e))))),width:"20%"},{name:s.a.createElement(o.EuiToolTip,{content:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnTooltip",defaultMessage:"Total number of alerts with identical field value pairs."})},s.a.createElement(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnLabel",defaultMessage:"Alert"})),s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.alertCountColumnCountLabel",defaultMessage:"count"})))),"data-test-subj":m.o,render:e=>{const t=e.values.map((t=>Object(g.a)(e.field,`timeline-indicator-${e.field}-${t}`,t)));return e.alertCount>0?s.a.createElement(d.a,{asEmptyButton:!0,dataProviders:t,filters:[],timeRange:{kind:"absolute",from:e.from,to:e.to}},s.a.createElement(u.a,{count:e.alertCount})):Object(b.d)()},width:"10%"},{name:s.a.createElement(o.EuiToolTip,{content:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnTooltip",defaultMessage:"Total number of event documents with identical field value pairs."})},s.a.createElement(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnLabel",defaultMessage:"Document"})),s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.documentCountColumnCountLabel",defaultMessage:"count"})))),"data-test-subj":m.p,render:e=>{const t=e.values.map((t=>({...Object(g.a)(e.field,`timeline-indicator-${e.field}-${t}`,t),and:[Object(g.b)("event.kind","timeline-indicator-event.kind-not-signal","signal",y.e,!0)]})));return e.docCount>0?s.a.createElement(d.a,{asEmptyButton:!0,dataProviders:t,filters:[],timeRange:{kind:"absolute",from:e.from,to:e.to},keepDataView:!0},s.a.createElement(u.a,{count:e.docCount})):Object(b.d)()},width:"10%"},{name:s.a.createElement(o.EuiToolTip,{content:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnTooltip",defaultMessage:"Percentage of unique hosts with identical field value pairs."})},s.a.createElement(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnLabel",defaultMessage:"Host"})),s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.hostPrevalenceColumnCountLabel",defaultMessage:"prevalence"})))),"data-test-subj":m.r,render:e=>s.a.createElement(s.a.Fragment,null,e.isPlatinumPlus?s.a.createElement(o.EuiText,{size:"xs"},`${Math.round(100*e.hostPrevalence)}%`):s.a.createElement(E,null)),width:"10%"},{name:s.a.createElement(o.EuiToolTip,{content:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnTooltip",defaultMessage:"Percentage of unique users with identical field value pairs."})},s.a.createElement(o.EuiFlexGroup,{direction:"column",gutterSize:"none"},s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnLabel",defaultMessage:"User"})),s.a.createElement(o.EuiFlexItem,null,s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.userPrevalenceColumnCountLabel",defaultMessage:"prevalence"})))),"data-test-subj":m.u,render:e=>s.a.createElement(s.a.Fragment,null,e.isPlatinumPlus?s.a.createElement(o.EuiText,{size:"xs"},`${Math.round(100*e.userPrevalence)}%`):s.a.createElement(E,null)),width:"10%"}],j=()=>{const{dataFormattedForFieldBrowser:e,investigationFields:t}=Object(f.b)(),n=Object(c.b)().isPlatinumPlus(),[a,u]=Object(r.useState)(h),[d,g]=Object(r.useState)("now"),[b,y]=Object(r.useState)((i.a.parse(h)||new Date).toISOString()),[v,E]=Object(r.useState)((i.a.parse("now")||new Date).toISOString()),{loading:j,error:O,data:S}=Object(p.a)({dataFormattedForFieldBrowser:e,investigationFields:t,interval:{from:a,to:d}}),k=Object(r.useMemo)((()=>S.map((e=>({...e,from:b,to:v,isPlatinumPlus:n})))),[S,b,v,n]),w=s.a.createElement(s.a.Fragment,null,s.a.createElement(o.EuiCallOut,{"data-test-subj":m.w},s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.tableAlertUpsellDescription",defaultMessage:"Host and user prevalence are only available with a {subscription}.",values:{subscription:s.a.createElement(o.EuiLink,{href:"https://www.elastic.co/pricing/",target:"_blank"},s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.tableAlertUpsellLinkText",defaultMessage:"Platinum or higher subscription"}))}})),s.a.createElement(o.EuiSpacer,{size:"s"}));return s.a.createElement(s.a.Fragment,null,!O&&!n&&w,s.a.createElement(o.EuiPanel,null,s.a.createElement(o.EuiSuperDatePicker,{start:a,end:d,onTimeChange:({start:e,end:t,isInvalid:n})=>{if(n)return;u(e),g(t);const a=i.a.parse(e);a&&a.isValid()&&y(a.toISOString());const r=i.a.parse(t);r&&r.isValid()&&E(r.toISOString())},"data-test-subj":m.n,width:"full"}),s.a.createElement(o.EuiSpacer,{size:"m"}),s.a.createElement(o.EuiInMemoryTable,{items:O?[]:k,columns:x,loading:j,"data-test-subj":m.s,message:s.a.createElement(l.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.prevalence.noDataDescription",defaultMessage:"No prevalence data available."})})))};j.displayName="PrevalenceDetails"},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(45),i=n(142),r=n(566),s=n(911),o=n(1277);const l=({dataFormattedForFieldBrowser:e,investigationFields:t})=>{var n,l;const u=Object(o.a)(e),c=Object(a.find)({category:"event",field:"event.code"},e),d=Array.isArray(null==c?void 0:c.originalValue)?null==c||null===(n=c.originalValue)||void 0===n?void 0:n[0]:null==c?void 0:c.originalValue,p=Object(a.find)({category:"kibana",field:i.R},e),m=Array.isArray(null==p?void 0:p.originalValue)?null==p||null===(l=p.originalValue)||void 0===l?void 0:l[0]:null==p?void 0:p.originalValue;return Object(o.b)({eventCategories:u,eventCode:d,eventRuleType:m,highlightedFieldsOverride:null!=t?t:[]}).reduce(((t,n)=>{const i=e.find((e=>e.field===n.id||n.legacyId&&e.field===n.legacyId));if(!i)return t;const o=i.values;return!o||Object(a.isEmpty)(o)?t:(i.field===n.legacyId&&(n.id=n.legacyId),"agent.id"===n.id&&!Object(s.b)({data:e})||n.id===r.a&&!Object(r.c)({data:e})?t:{...t,[n.id]:{...n.overrideField&&{overrideField:n.overrideField},values:o}})}),{})}},,function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));const a=(e,t,n)=>Object.keys(e).map((a=>{const i=e[a].values,r=e[a].overrideField,s=r||a;return{field:s,description:{field:s,...r?{originalField:a}:{},values:i,scopeId:t,isPreview:n}}})),i=e=>Object.keys(e).reduce(((t,n)=>({...t,[n]:{terms:{[n]:e[n].values}}})),[])},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(879),r=n(127),s=n(313);const o=({entityId:e,scopeId:t})=>{const{loading:n,error:o,count:l,alertIds:u}=Object(i.a)({field:s.c,value:e,isActiveTimelines:Object(r.isActiveTimeline)(t),signalIndexName:null,includeAlertIds:!0,ignoreTimerange:!0});return Object(a.useMemo)((()=>({loading:n,error:o,data:u||[],dataCount:l||0})),[u,l,o,n])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n(313),r=n(879),s=n(127);const o=({originalEventId:e,scopeId:t})=>{const{loading:n,error:o,count:l,alertIds:u}=Object(r.a)({field:i.a,value:e,isActiveTimelines:Object(s.isActiveTimeline)(t),signalIndexName:null,includeAlertIds:!0});return Object(a.useMemo)((()=>({loading:n,error:o,data:u||[],dataCount:l||0})),[u,l,o,n])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(50),i=n(2),r=n(110),s=n(4);const o=({eventId:e})=>{const{services:{cases:t}}=Object(r.i)(),{data:n,isLoading:o,isError:l}=Object(a.useQuery)(["useFetchRelatedCases",e],(()=>t.api.getRelatedCases(e,{owner:s.i})),{keepPreviousData:!0});return Object(i.useMemo)((()=>({loading:o,error:l,data:n||[],dataCount:(null==n?void 0:n.length)||0})),[n,l,o])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(39),i=n(212);const r=()=>{const{cases:e}=Object(i.b)().services;return e.helpers.canUseCases([a.APP_ID]).read}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(2),i=n(45),r=n(1063),s=n(130),o=n(18),l=n(313),u=n(192);const c=({getFieldsData:e,dataAsNestedObject:t,dataFormattedForFieldBrowser:n,eventId:c,isPreview:d})=>{var p;const m=Object(s.a)("insightsRelatedAlertsByProcessAncestry"),f=Object(r.a)(t),g=null!==(p=Object(u.a)(e(l.a)))&&void 0!==p?p:"",b=d?g:c,y=Object(a.useMemo)((()=>Object(i.find)({category:"kibana",field:l.f},n)),[n]),v=Object(o.b)().isPlatinumPlus();return{show:m&&f&&null!=y&&v,documentId:b,...y&&y.values&&{indices:y.values}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(142);const i=({getFieldsData:e})=>{const t=e(a.cb),n=t?parseInt(t[0],10):0;return{show:Boolean(t),alertSuppressionCount:n}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(313),i=n(192);const r=({getFieldsData:e})=>{const t=Object(i.a)(e(a.a));return{show:null!=t,...t&&{originalEventId:t}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(313),i=n(192);const r=({getFieldsData:e})=>{const t=Object(i.a)(e(a.c));return{show:null!=t,...t&&{entityId:t}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(1064),r=n(127);const s=({documentId:e,indices:t,scopeId:n})=>{const s=Object(r.isActiveTimeline)(n),{loading:o,error:l,alertIds:u}=Object(i.a)({isActiveTimeline:s,documentId:e,indices:t});return Object(a.useMemo)((()=>({loading:o,error:l,data:u,dataCount:(null==u?void 0:u.length)||0})),[u,l,o])}},,,,,,,,,function(e,t,n){"use strict";const a=n(2),i=n(1172),r=n(461),s=n(1173),o=n(1220),l=n(1221),u=n(1222),c=n(1223),d=n(1225),p=n(1226).hastChildrenToReact;e.exports=b;const m={}.hasOwnProperty,f="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",g={renderers:{to:"components",id:"change-renderers-to-components"},astPlugins:{id:"remove-buggy-html-in-markdown-parser"},allowDangerousHtml:{id:"remove-buggy-html-in-markdown-parser"},escapeHtml:{id:"remove-buggy-html-in-markdown-parser"},source:{to:"children",id:"change-source-to-children"},allowNode:{to:"allowElement",id:"replace-allownode-allowedtypes-and-disallowedtypes"},allowedTypes:{to:"allowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},disallowedTypes:{to:"disallowedElements",id:"replace-allownode-allowedtypes-and-disallowedtypes"},includeNodeIndex:{to:"includeElementIndex",id:"change-includenodeindex-to-includeelementindex"}};function b(e){for(const t in g)if(m.call(g,t)&&m.call(e,t)){const e=g[t];console.warn(`[react-markdown] Warning: please ${e.to?`use \`${e.to}\` instead of`:"remove"} \`${t}\` (see <${f}#${e.id}> for more info)`),delete g[t]}const t=r().use(s).use(e.remarkPlugins||e.plugins||[]).use(o,{allowDangerousHtml:!0}).use(e.rehypePlugins||[]).use(c,e);let n;"string"==typeof e.children?n=i(e.children):(void 0!==e.children&&null!==e.children&&console.warn(`[react-markdown] Warning: please pass a string as \`children\` (not: \`${e.children}\`)`),n=i());const l=t.runSync(t.parse(n),n);if("root"!==l.type)throw new TypeError("Expected a `root` node");let d=a.createElement(a.Fragment,{},p({options:e,schema:u,listDepth:0},l));return e.className&&(d=a.createElement("div",{className:e.className},d)),d}b.defaultProps={transformLinkUri:d},b.propTypes={children:l.string,className:l.string,allowElement:l.func,allowedElements:l.arrayOf(l.string),disallowedElements:l.arrayOf(l.string),unwrapDisallowed:l.bool,remarkPlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),rehypePlugins:l.arrayOf(l.oneOfType([l.object,l.func,l.arrayOf(l.oneOfType([l.object,l.func]))])),sourcePos:l.bool,rawSourcePos:l.bool,skipHtml:l.bool,includeElementIndex:l.bool,transformLinkUri:l.oneOfType([l.func,l.bool]),linkTarget:l.oneOfType([l.func,l.string]),transformImageUri:l.func,components:l.object},b.uriTransformer=d},function(e,t,n){"use strict";var a={}.hasOwnProperty;e.exports=a},function(e,t,n){"use strict";e.exports=function(e){for(var t=-1,n=0;++t<e.length;)n+="string"==typeof e[t]?e[t].length:1;return n}},function(e,t,n){"use strict";var a=n(414),i=n(286),r=n(349);function s(e,t){for(var n,a,r,s,o,l,u=e[t][1],c=e[t][2],d=t-1,p=[],m=u._tokenizer||c.parser[u.contentType](u.start),f=m.events,g=[],b={};u;){for(;e[++d][1]!==u;);p.push(d),u._tokenizer||(n=c.sliceStream(u),u.next||n.push(null),a&&m.defineSkip(u.start),u.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=!0),m.write(n),u.isInFirstContentOfListItem&&(m._gfmTasklistFirstContentOfListItem=void 0)),a=u,u=u.next}for(u=a,r=f.length;r--;)"enter"===f[r][0]?s=!0:s&&f[r][1].type===f[r-1][1].type&&f[r][1].start.line!==f[r][1].end.line&&(y(f.slice(r+1,o)),u._tokenizer=u.next=void 0,u=u.previous,o=r+1);for(m.events=u._tokenizer=u.next=void 0,y(f.slice(0,o)),r=-1,l=0;++r<g.length;)b[l+g[r][0]]=l+g[r][1],l+=g[r][1]-g[r][0]-1;return b;function y(t){var n=p.pop();g.unshift([n,n+t.length-1]),i(e,n,2,t)}}e.exports=function(e){for(var t,n,o,l,u,c,d,p={},m=-1;++m<e.length;){for(;m in p;)m=p[m];if(t=e[m],m&&"chunkFlow"===t[1].type&&"listItemPrefix"===e[m-1][1].type&&((o=0)<(c=t[1]._tokenizer.events).length&&"lineEndingBlank"===c[o][1].type&&(o+=2),o<c.length&&"content"===c[o][1].type))for(;++o<c.length&&"content"!==c[o][1].type;)"chunkText"===c[o][1].type&&(c[o][1].isInFirstContentOfListItem=!0,o++);if("enter"===t[0])t[1].contentType&&(a(p,s(e,m)),m=p[m],d=!0);else if(t[1]._container||t[1]._movePreviousLineEndings){for(o=m,n=void 0;o--&&("lineEnding"===(l=e[o])[1].type||"lineEndingBlank"===l[1].type);)"enter"===l[0]&&(n&&(e[n][1].type="lineEndingBlank"),l[1].type="lineEnding",n=o);n&&(t[1].end=r(e[n][1].start),(u=e.slice(n,m)).unshift(t),i(e,n,m-n+1,u))}}return!d}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(414),i=n(349),r=l("text"),s=l("string"),o={resolveAll:u()};function l(e){return{tokenize:function(t){var n=this,a=this.parser.constructs[e],i=t.attempt(a,r,s);return r;function r(e){return l(e)?i(e):s(e)}function s(e){if(null!==e)return t.enter("data"),t.consume(e),o;t.consume(e)}function o(e){return l(e)?(t.exit("data"),i(e)):(t.consume(e),o)}function l(e){var t=a[e],i=-1;if(null===e)return!0;if(t)for(;++i<t.length;)if(!t[i].previous||t[i].previous.call(n,n.previous))return!0}},resolveAll:u("text"===e?c:void 0)}}function u(e){return function(t,n){for(var a,i=-1;++i<=t.length;)void 0===a?t[i]&&"data"===t[i][1].type&&(a=i,i++):t[i]&&"data"===t[i][1].type||(i!==a+2&&(t[a][1].end=t[i-1][1].end,t.splice(a+2,i-a-2),i=a+2),a=void 0);return e?e(t,n):t}}function c(e,t){for(var n,r,s,o,l,u,c,d,p=-1;++p<=e.length;)if((p===e.length||"lineEnding"===e[p][1].type)&&"data"===e[p-1][1].type){for(r=e[p-1][1],o=(n=t.sliceStream(r)).length,l=-1,u=0,c=void 0;o--;)if("string"==typeof(s=n[o])){for(l=s.length;32===s.charCodeAt(l-1);)u++,l--;if(l)break;l=-1}else if(-2===s)c=!0,u++;else if(-1!==s){o++;break}u&&(d={type:p===e.length||c||u<2?"lineSuffix":"hardBreakTrailing",start:{line:r.end.line,column:r.end.column-u,offset:r.end.offset-u,_index:r.start._index+o,_bufferIndex:o?l:r.start._bufferIndex+l},end:i(r.end)},r.end=i(d.start),r.start.offset===r.end.offset?a(r,d):(e.splice(p,0,["enter",d,t],["exit",d,t]),p+=2)),p++}return e}t.resolver=o,t.string=s,t.text=r},function(e,t,n){"use strict";e.exports=function(e){return e<32||127===e}},function(e,t,n){e.exports=n(24)(3428)},function(e,t,n){"use strict";var a=n(288)(/\d/);e.exports=a},function(e,t,n){"use strict";var a=n(935),i=n(287),r=n(156);e.exports=function(e,t,n,s,o,l,u,c,d){var p=d||1/0,m=0;return function(t){return 60===t?(e.enter(s),e.enter(o),e.enter(l),e.consume(t),e.exit(l),f):a(t)||41===t?n(t):(e.enter(s),e.enter(u),e.enter(c),e.enter("chunkString",{contentType:"string"}),y(t))};function f(n){return 62===n?(e.enter(l),e.consume(n),e.exit(l),e.exit(o),e.exit(s),t):(e.enter(c),e.enter("chunkString",{contentType:"string"}),g(n))}function g(t){return 62===t?(e.exit("chunkString"),e.exit(c),f(t)):null===t||60===t||r(t)?n(t):(e.consume(t),92===t?b:g)}function b(t){return 60===t||62===t||92===t?(e.consume(t),g):g(t)}function y(r){return 40===r?++m>p?n(r):(e.consume(r),y):41===r?m--?(e.consume(r),y):(e.exit("chunkString"),e.exit(c),e.exit(u),e.exit(s),t(r)):null===r||i(r)?m?n(r):(e.exit("chunkString"),e.exit(c),e.exit(u),e.exit(s),t(r)):a(r)?n(r):(e.consume(r),92===r?v:y)}function v(t){return 40===t||41===t||92===t?(e.consume(t),y):y(t)}}},function(e,t,n){"use strict";var a=n(156),i=n(258);e.exports=function(e,t,n,r,s,o){var l,u=this,c=0;return function(t){return e.enter(r),e.enter(s),e.consume(t),e.exit(s),e.enter(o),d};function d(i){return null===i||91===i||93===i&&!l||94===i&&!c&&"_hiddenFootnoteSupport"in u.parser.constructs||c>999?n(i):93===i?(e.exit(o),e.enter(s),e.consume(i),e.exit(s),e.exit(r),t):a(i)?(e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),p(i))}function p(t){return null===t||91===t||93===t||a(t)||c++>999?(e.exit("chunkString"),d(t)):(e.consume(t),l=l||!i(t),92===t?m:p)}function m(t){return 91===t||92===t||93===t?(e.consume(t),c++,p):p(t)}}},function(e,t,n){"use strict";var a=n(156),i=n(258),r=n(171);e.exports=function(e,t){var n;return function s(o){return a(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),n=!0,s):i(o)?r(e,s,n?"linePrefix":"lineSuffix")(o):t(o)}}},function(e,t,n){"use strict";var a=n(156),i=n(171);e.exports=function(e,t,n,r,s,o){var l;return function(t){return e.enter(r),e.enter(s),e.consume(t),e.exit(s),l=40===t?41:t,u};function u(n){return n===l?(e.enter(s),e.consume(n),e.exit(s),e.exit(r),t):(e.enter(o),c(n))}function c(t){return t===l?(e.exit(o),u(l)):null===t?n(t):a(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,c,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(t))}function d(t){return t===l||null===t||a(t)?(e.exit("chunkString"),c(t)):(e.consume(t),92===t?p:d)}function p(t){return t===l||92===t?(e.consume(t),d):d(t)}}},function(e,t,n){"use strict";var a=n(156),i=n(258),r=n(171),s={name:"thematicBreak",tokenize:function(e,t,n){var s,o=0;return function(t){return e.enter("thematicBreak"),s=t,l(t)};function l(c){return c===s?(e.enter("thematicBreakSequence"),u(c)):i(c)?r(e,l,"whitespace")(c):o<3||null!==c&&!a(c)?n(c):(e.exit("thematicBreak"),t(c))}function u(t){return t===s?(e.consume(t),o++,u):(e.exit("thematicBreakSequence"),l(t))}}};e.exports=s},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return s})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return l}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.ruleActionsField.ruleActionsFormErrorsTitle",{defaultMessage:"Please fix issues listed below"}),r=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleNotifyWhen.onActiveAlert.display",{defaultMessage:"Per rule run"}),s=a.i18n.translate("xpack.securitySolution.detectionEngine.ruleNotifyWhen.onThrottleInterval.display",{defaultMessage:"Custom frequency"}),o=a.i18n.translate("xpack.securitySolution.detectionEngine.body.summary.message",{defaultMessage:"Rule {ruleName} generated {signalsCount} alerts",values:{ruleName:"{{context.rule.name}}",signalsCount:"{{state.signals_count}}"}}),l=a.i18n.translate("xpack.securitySolution.detectionEngine.body.forEachAlert.message",{defaultMessage:"Rule {ruleName} generated alert {alertId}",values:{ruleName:"{{context.rule.name}}",alertId:"{{alert.id}}"}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(2),i=n.n(a),r=n(44);const s=n.n(r).a.div.withConfig({displayName:"StyledDiv",componentId:"sc-1qyhc9r-0"})(["padding-left:",";"],(({addPadding:e})=>e&&"53px"));s.defaultProps={addPadding:!1};const o=i.a.memo(s);o.displayName="StepContentWrapper"},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17);const l=s()(o.EuiBadge).withConfig({displayName:"StyledEuiBadge",componentId:"sc-1oris7-0"})([".euiBadge__text{white-space:pre-wrap !important;}"]),u=({badges:e,"data-test-subj":t})=>i.a.createElement(o.EuiFlexGroup,{responsive:!1,gutterSize:"xs",wrap:!0,"data-test-subj":t},e.map((e=>i.a.createElement(o.EuiFlexItem,{grow:!1,key:`badge-${e}`,"data-test-subj":`${t}Item`},i.a.createElement(l,{color:"hollow"},e)))))},function(e,t,n){const a=n(225);e.exports=(e,t,n)=>0===a(e,t,n)},function(e,t,n){const a=n(225);e.exports=(e,t,n)=>0!==a(e,t,n)},function(e,t,n){const a=n(946),i=n(947),r=n(538),s=n(539),o=n(680),l=n(603);e.exports=(e,t,n,u)=>{switch(t){case"===":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e===n;case"!==":return"object"==typeof e&&(e=e.version),"object"==typeof n&&(n=n.version),e!==n;case"":case"=":case"==":return a(e,n,u);case"!=":return i(e,n,u);case">":return r(e,n,u);case">=":return s(e,n,u);case"<":return o(e,n,u);case"<=":return l(e,n,u);default:throw new TypeError(`Invalid operator: ${t}`)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17),l=n(86),u=n(110);const c=s()(o.EuiLink).withConfig({displayName:"StyledJobEuiLInk",componentId:"sc-ilb29r-0"})(["margin-right:",";"],(({theme:e})=>e.eui.euiSizeS)),d=({jobId:e,jobName:t})=>{const{services:{http:n,ml:a}}=Object(u.i)(),r=Object(l.useMlHref)(a,n.basePath.get(),{page:l.ML_PAGES.ANOMALY_DETECTION_JOBS_MANAGE,pageState:{jobId:[e]}},[e]);return i.a.createElement(c,{"data-test-subj":"machineLearningJobLink",href:r,target:"_blank"},i.a.createElement("span",{"data-test-subj":"machineLearningJob"},null!=t?t:e))},p=Object(a.memo)(d)},,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return Lt})),n.d(t,"b",(function(){return zt}));var a=n(2),i=n.n(a),r=n(144),s=n(900),o=n(192),l=n(140),u=n(17),c=n(5),d=n(194),p=n(218),m=n(1284),f=n(1332),g=n(211),b=n(377),y=n(405),v=n(215),h=n(1085);const E=()=>({promptContextId:void 0});var x=n(133);const j=Object(a.memo)((()=>{const{dataFormattedForFieldBrowser:e,eventId:t,indexName:n}=Object(l.b)(),{isAlert:r,timestamp:s}=Object(g.b)(e),o=Object(f.a)({_id:t,_index:n,timestamp:s}),j=r&&o,O=e=>{const t=new URLSearchParams(window.location.search);return`${e}&${p.a.eventFlyout}=${t.get(p.a.eventFlyout)}`},{showAssistant:S,promptContextId:k}=(({dataFormattedForFieldBrowser:e,isAlert:t})=>{const{hasAssistantPrivilege:n}=Object(b.a)(),i=n?d.k:E,r=Object(a.useCallback)((async()=>Object(y.e)(null!=e?e:[])),[e]),{promptContextId:s}=i(t?"alert":"event",t?v.e:v.i,t?Object(v.d)(v.A):Object(v.h)(v.A),r,null,t?h.b[h.c].suggestedUserPrompt:h.b[h.e].suggestedUserPrompt,t?v.f:v.j);return{showAssistant:n&&null!==s,promptContextId:s||""}})({dataFormattedForFieldBrowser:e,isAlert:r});return i.a.createElement(u.EuiFlexGroup,{direction:"row",justifyContent:"flexEnd",alignItems:"center",gutterSize:"none",responsive:!1},S&&i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(d.g,{conversationId:r?v.e:v.i,promptContextId:k,iconOnly:!0})),j&&i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(u.EuiToolTip,{content:c.i18n.translate("xpack.securitySolution.flyout.right.header.shareButtonToolTip",{defaultMessage:"Share alert"})},i.a.createElement(u.EuiCopy,{textToCopy:o},(e=>i.a.createElement(u.EuiButtonIcon,{iconType:"share",color:"text","aria-label":c.i18n.translate("xpack.securitySolution.flyout.right.header.shareButtonAriaLabel",{defaultMessage:"Share alert"}),"data-test-subj":x.bb,onClick:()=>Object(m.a)(e,o,O),onKeyDown:()=>Object(m.a)(e,o,O)}))))))}));j.displayName="HeaderActions";var O=n(1285),S=n(233);const k=Object(a.memo)((({flyoutIsExpandable:e})=>{const{openLeftPanel:t}=Object(r.d)(),{eventId:n,indexName:s,scopeId:o}=Object(l.b)(),u=Object(a.useCallback)((()=>{t({id:S.a,params:{id:n,indexName:s,scopeId:o}})}),[n,t,s,o]);return i.a.createElement(O.a,{flyoutIsExpandable:e,expandDetails:u,actions:i.a.createElement(j,null)})}));k.displayName="PanelNavigation";var w=n(1325),T=n(1299),I=n(47),C=n(1300),M=n(1329);const _=()=>{const{openLeftPanel:e}=Object(r.d)(),{eventId:t,indexName:n,scopeId:s}=Object(l.b)(),o=Object(a.useCallback)((()=>{e({id:S.a,path:{tab:S.e},params:{id:t,indexName:n,scopeId:s}})}),[t,n,e,s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(u.EuiButton,{onClick:o,iconType:"documentation","data-test-subj":x.V},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.responseButtonLabel",defaultMessage:"Response"})))};_.displayName="ResponseButton";var A=n(331);const P=({expanded:e=!1})=>{const{isPreview:t}=Object(l.b)();return i.a.createElement(A.b,{expanded:e,title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.sectionTitle",defaultMessage:"Response"}),"data-test-subj":x.W},t?i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.response.previewMessage",defaultMessage:"Response is not available in alert preview."}):i.a.createElement(_,null))};P.displayName="ResponseSection";var F=n(912),D=n(428),N=n(1167),R=n(566),L=n(895),z=n(285),B=n(416);const q=({value:e})=>{const{scopeId:t,eventId:n,indexName:s}=Object(l.b)(),{openLeftPanel:o}=Object(r.d)(),c=Object(a.useCallback)((()=>{o({id:S.a,path:{tab:S.c,subTab:B.a},params:{id:n,indexName:s,scopeId:t}})}),[n,s,o,t]);return i.a.createElement(u.EuiLink,{onClick:c,"data-test-subj":x.G},e)},$=({values:e,field:t,originalField:n})=>i.a.createElement(i.a.Fragment,null,null!=e&&e.map(((e,a)=>i.a.createElement(u.EuiFlexItem,{grow:!1,key:`${a}-${e}`,"data-test-subj":`${e}-${x.E}`},t===z.g||t===z.p?i.a.createElement(q,{value:e}):t===z.a&&n===R.a?i.a.createElement(N.b,{agentId:String(null!=e?e:""),"data-test-subj":x.C}):t===z.a?i.a.createElement(L.b,{endpointAgentId:String(null!=e?e:""),"data-test-subj":x.C}):i.a.createElement("span",{"data-test-subj":x.D},e)))));var V=n(600),U=n(910);const H=[{field:"field",name:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.tableFieldColumnLabel",defaultMessage:"Field"}),"data-test-subj":"fieldCell",width:"30%"},{field:"description",name:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.tableValueColumnLabel",defaultMessage:"Value"}),"data-test-subj":"valueCell",width:"70%",render:e=>i.a.createElement(V.a,{field:e.field,value:e.values},i.a.createElement($,{values:e.values,field:e.field,originalField:e.originalField}))}],Z=()=>{var e,t;const{dataFormattedForFieldBrowser:n,scopeId:r,isPreview:s}=Object(l.b)(),{ruleId:o}=Object(g.b)(n),{loading:c,rule:d}=Object(D.a)(o),p=Object(U.a)({dataFormattedForFieldBrowser:n,investigationFields:null!==(e=null==d||null===(t=d.investigation_fields)||void 0===t?void 0:t.field_names)&&void 0!==e?e:[]}),m=Object(a.useMemo)((()=>Object(F.b)(p,r,s)),[p,r,s]);return i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(u.EuiFlexItem,{"data-test-subj":x.H},i.a.createElement(u.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.highlightedFieldsTitle",defaultMessage:"Highlighted fields"})))),i.a.createElement(u.EuiFlexItem,{"data-test-subj":x.F},i.a.createElement(u.EuiPanel,{hasBorder:!0,hasShadow:!1},i.a.createElement(u.EuiInMemoryTable,{items:m,columns:H,compressed:!0,loading:c,message:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.highlightedFields.noDataDescription",defaultMessage:"There's no highlighted fields for this alert."})}))))};var G=n(907);const Q=()=>{const{openLeftPanel:e}=Object(r.d)(),{eventId:t,indexName:n,scopeId:s,dataFormattedForFieldBrowser:o,isPreview:d}=Object(l.b)(),{loading:p,error:m,basicAlertData:f,ruleNote:g}=Object(G.a)({dataFormattedForFieldBrowser:o}),b=Object(a.useCallback)((()=>{e({id:S.a,path:{tab:S.d},params:{id:t,indexName:n,scopeId:s}})}),[t,n,e,s]);return i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"s","data-test-subj":x.N},i.a.createElement(u.EuiFlexItem,null,i.a.createElement(u.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideTitle",defaultMessage:"Investigation guide"})))),d?i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.previewMessage",defaultMessage:"Investigation guide is not available in alert preview."}):p?i.a.createElement(u.EuiSkeletonText,{"data-test-subj":x.M,contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideLoadingAriaLabel",{defaultMessage:"investigation guide"})}):!m&&f.ruleId&&g?i.a.createElement(u.EuiFlexItem,null,i.a.createElement(u.EuiButton,{onClick:b,iconType:"documentation","data-test-subj":x.L,"aria-label":c.i18n.translate("xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideButtonAriaLabel",{defaultMessage:"Show investigation guide"})},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.investigationGuideButtonLabel",defaultMessage:"Show investigation guide"}))):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.investigationGuide.noDataDescription",defaultMessage:"Thereâ€™s no investigation guide for this rule."}))};Q.displayName="InvestigationGuideButton";const W=({expanded:e=!0})=>i.a.createElement(A.b,{expanded:e,title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.investigation.sectionTitle",defaultMessage:"Investigation"}),"data-test-subj":x.O},i.a.createElement(Q,null),i.a.createElement(u.EuiSpacer,{size:"m"}),i.a.createElement(Z,null));W.displayName="InvestigationSection";var K=n(44),J=n.n(K),Y=n(9),X=(n(13),n(890));const ee=()=>{const{dataFormattedForFieldBrowser:e,scopeId:t,eventId:n,indexName:s,isPreview:o}=Object(l.b)(),{isAlert:d,ruleDescription:p,ruleName:m,ruleId:f}=Object(g.b)(e),{openPreviewPanel:b}=Object(r.d)(),y=Object(a.useCallback)((()=>{const e={tab:X.d};b({id:X.b,path:e,params:{id:n,indexName:s,scopeId:t,banner:{title:c.i18n.translate("xpack.securitySolution.flyout.right.about.description.rulePreviewTitle",{defaultMessage:"Preview rule details"}),backgroundColor:"warning",textColor:"warning"},ruleId:f}})}),[n,b,s,t,f]),v=Object(a.useMemo)((()=>i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(u.EuiButtonEmpty,{size:"s",iconType:"expand",onClick:y,iconSide:"right","data-test-subj":x.Z,"aria-label":c.i18n.translate("xpack.securitySolution.flyout.right.about.description.ruleSummaryButtonAriaLabel",{defaultMessage:"Show rule summary"}),disabled:Object(Y.isEmpty)(m)||Object(Y.isEmpty)(f)||o},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.ruleSummaryButtonLabel",defaultMessage:"Show rule summary"})))),[m,y,f,o]),h=(null==p?void 0:p.length)>0?p:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.noRuleDescription",defaultMessage:"There's no description for this rule."});return i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(u.EuiFlexItem,{"data-test-subj":x.o},i.a.createElement(u.EuiTitle,{size:"xxs"},d?i.a.createElement(u.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none",responsive:!1},i.a.createElement(u.EuiFlexItem,null,i.a.createElement("h5",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.ruleTitle",defaultMessage:"Rule description"}))),v):i.a.createElement("h5",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.description.documentTitle",defaultMessage:"Document description"})))),i.a.createElement(u.EuiFlexItem,{"data-test-subj":x.n},i.a.createElement(te,null,d?h:"-")))};ee.displayName="Description";var te=J()("p").withConfig({displayName:"_StyledP",componentId:"sc-1drpqi-0"})(["word-break:break-word;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden;"]),ne=n(142);const ae=()=>{const{eventId:e,indexName:t,scopeId:n,dataFormattedForFieldBrowser:s,getFieldsData:d}=Object(l.b)(),{isAlert:p}=Object(g.b)(s),m=Object(o.a)(d(ne.s)),{openPreviewPanel:f}=Object(r.d)(),b=Object(a.useCallback)((()=>{f({id:X.b,path:{tab:X.a},params:{id:e,indexName:t,scopeId:n,banner:{title:c.i18n.translate("xpack.securitySolution.flyout.right.about.reason.alertReasonPreviewTitle",{defaultMessage:"Preview alert reason"}),backgroundColor:"warning",textColor:"warning"}}})}),[e,f,t,n]),y=Object(a.useMemo)((()=>i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(u.EuiButtonEmpty,{size:"s",iconType:"expand",onClick:b,iconSide:"right","data-test-subj":x.S,"aria-label":c.i18n.translate("xpack.securitySolution.flyout.right.about.reason.alertReasonButtonAriaLabel",{defaultMessage:"Show full reason"}),disabled:!m},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.alertReasonButtonLabel",defaultMessage:"Show full reason"})))),[m,b]),v=m||i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.noReasonDescription",defaultMessage:"There's no source event information for this alert."});return i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(u.EuiFlexItem,{"data-test-subj":x.U},i.a.createElement(u.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,p?i.a.createElement(u.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"none",responsive:!1},i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement("h5",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.alertReasonTitle",defaultMessage:"Alert reason"}))),y):i.a.createElement("p",null,i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.reason.documentReasonTitle",defaultMessage:"Document reason"}))))),i.a.createElement(u.EuiFlexItem,{"data-test-subj":x.T},p?v:"-"))};ae.displayName="Reason";var ie=n(1305);const re=()=>{const{searchHit:e}=Object(l.b)(),t=Object(a.useMemo)((()=>Object(ie.a)(e)),[e]);return t&&t[0]?i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"s"},i.a.createElement(u.EuiSpacer,{size:"m"}),i.a.createElement(u.EuiFlexItem,{"data-test-subj":x.Q},i.a.createElement(u.EuiTitle,{size:"xxs"},i.a.createElement("h5",null,t[0].title))),i.a.createElement(u.EuiFlexItem,{"data-test-subj":x.P},t[0].description)):null};re.displayName="MitreAttack";const se=({expanded:e=!0})=>i.a.createElement(A.b,{expanded:e,title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.about.sectionTitle",defaultMessage:"About"}),"data-test-subj":x.a},i.a.createElement(ee,null),i.a.createElement(u.EuiSpacer,{size:"m"}),i.a.createElement(ae,null),i.a.createElement(re,null));se.displayName="AboutSection";var oe=n(216),le=n(920),ue=n(913),ce=n(236);const de=({loading:e=!1,error:t=!1,icon:n,value:a,text:r,color:s,"data-test-subj":o})=>{const{euiTheme:l}=Object(u.useEuiTheme)(),d=`${o}Loading`;if(e)return i.a.createElement(u.EuiSkeletonText,{lines:1,size:"m",isLoading:e,contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.insights.insightSummaryLoadingAriaLabel",{defaultMessage:"Loading insights for {value}",values:{value:a}}),"data-test-subj":d});if(t)return null;const p=`${o}Icon`,m=`${o}Value`,f=`${o}Color`;return i.a.createElement(u.EuiFlexGroup,{gutterSize:"none",justifyContent:"spaceBetween",alignItems:"center",responsive:!1},i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(pe,{"data-test-subj":p,"aria-label":c.i18n.translate("xpack.securitySolution.flyout.right.insights.insightSummaryButtonIconAriaLabel",{defaultMessage:"Insight summary row icon"}),color:"text",display:"empty",type:n,size:"m",$_css:l.size.s})),i.a.createElement(me,{"data-test-subj":m},a&&i.a.createElement(ce.a,{count:a})," ",r),s&&i.a.createElement(u.EuiFlexItem,{grow:!1,"data-test-subj":f},i.a.createElement(u.EuiHealth,{color:s})))};de.displayName="InsightsSummaryRow";var pe=J()(u.EuiIcon).withConfig({displayName:"_StyledEuiIcon",componentId:"sc-uq3b7l-0"})(["margin:",";"],(e=>e.$_css)),me=J()(u.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-uq3b7l-1"})(["word-break:break-word;display:-webkit-box;-webkit-line-clamp:1;-webkit-box-orient:vertical;overflow:hidden;"]);const fe=({entityId:e,scopeId:t})=>{const{loading:n,error:a,dataCount:r}=Object(ue.a)({entityId:e,scopeId:t}),s=i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.sessionAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by session",values:{count:r}});return i.a.createElement(de,{loading:n,error:a,icon:"warning",value:r,text:s,"data-test-subj":x.i,key:`correlation-row-${s}`})};fe.displayName="RelatedAlertsBySession";var ge=n(919),be=n(914);const ye=({originalEventId:e,scopeId:t})=>{const{loading:n,error:a,dataCount:r}=Object(be.a)({originalEventId:e,scopeId:t}),s=i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.sourceAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by source event",values:{count:r}});return i.a.createElement(de,{loading:n,error:a,icon:"warning",value:r,text:s,"data-test-subj":x.h,key:`correlation-row-${s}`})};ye.displayName="RelatedAlertsBySameSourceEvent";var ve=n(921);const he=({documentId:e,indices:t,scopeId:n})=>{const{loading:a,error:r,dataCount:s}=Object(ve.a)({documentId:e,indices:t,scopeId:n}),o=i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.ancestryAlertsLabel",defaultMessage:"{count, plural, one {alert} other {alerts}} related by ancestry",values:{count:s}});return i.a.createElement(de,{loading:a,error:r,icon:"warning",value:s,text:o,"data-test-subj":x.g,key:`correlation-row-${o}`})};he.displayName="RelatedAlertsByAncestry";var Ee=n(917),xe=n(568);const je=({alertSuppressionCount:e})=>i.a.createElement(u.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(de,{loading:!1,error:!1,icon:"layers",value:e,text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.suppressedAlertsLabel",defaultMessage:"suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:e}}),"data-test-subj":x.l,key:"correlation-row-suppressed-alerts"})),i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(u.EuiBetaBadge,{label:xe.w,size:"s",iconType:"beaker",tooltipContent:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.suppressedAlertTechnicalPreviewTooltip",defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),tooltipPosition:"bottom","data-test-subj":x.k})));je.displayName="SuppressedAlerts";var Oe=n(918),Se=n(915);const ke=({eventId:e})=>{const{loading:t,error:n,dataCount:a}=Object(Se.a)({eventId:e}),r=i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.relatedCasesLabel",defaultMessage:"related {count, plural, one {case} other {cases}}",values:{count:a}});return i.a.createElement(de,{loading:t,error:n,icon:"warning",value:a,text:r,"data-test-subj":x.j,key:`correlation-row-${r}`})};ke.displayName="RelatedCases";var we=n(916),Te=n(959);const Ie=()=>{const{dataAsNestedObject:e,dataFormattedForFieldBrowser:t,eventId:n,indexName:s,getFieldsData:o,scopeId:c,isPreview:d}=Object(l.b)(),{openLeftPanel:p}=Object(r.d)(),m=Object(a.useCallback)((()=>{p({id:S.a,path:{tab:S.c,subTab:Te.a},params:{id:n,indexName:s,scopeId:c}})}),[n,p,s,c]),{show:f,documentId:g,indices:b}=Object(Ee.a)({getFieldsData:o,dataAsNestedObject:e,dataFormattedForFieldBrowser:t,eventId:n,isPreview:d}),{show:y,originalEventId:v}=Object(ge.a)({getFieldsData:o}),{show:h,entityId:E}=Object(le.a)({getFieldsData:o}),j=Object(we.a)(),{show:O,alertSuppressionCount:k}=Object(Oe.a)({getFieldsData:o}),w=f||y||h||j||O;return i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.overviewTitle",defaultMessage:"Correlations"}),link:{callback:m,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.overviewTooltip",defaultMessage:"Show all correlations"})},iconType:"arrowStart"},"data-test-subj":x.m},w?i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"none"},O&&i.a.createElement(je,{alertSuppressionCount:k}),j&&i.a.createElement(ke,{eventId:n}),y&&v&&i.a.createElement(ye,{originalEventId:v,scopeId:c}),h&&E&&i.a.createElement(fe,{entityId:E,scopeId:c}),f&&g&&b&&i.a.createElement(he,{documentId:g,indices:b,scopeId:c})):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.correlations.noDataDescription",defaultMessage:"No correlations data available."}))};Ie.displayName="CorrelationsOverview";var Ce=n(963),Me=n(909);const _e=()=>{const{eventId:e,indexName:t,dataFormattedForFieldBrowser:n,scopeId:s,investigationFields:o}=Object(l.b)(),{openLeftPanel:c}=Object(r.d)(),d=Object(a.useCallback)((()=>{c({id:S.a,path:{tab:S.c,subTab:Me.a},params:{id:e,indexName:t,scopeId:s}})}),[e,c,t,s]),{loading:p,error:m,data:f}=Object(Ce.a)({dataFormattedForFieldBrowser:n,investigationFields:o,interval:{from:"now-30d",to:"now"}}),g=Object(a.useMemo)((()=>f.filter((e=>isFinite(e.hostPrevalence)&&e.hostPrevalence>0&&e.hostPrevalence<.1))),[f]);return i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.prevalenceTitle",defaultMessage:"Prevalence"}),link:{callback:d,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.prevalenceTooltip",defaultMessage:"Show all prevalence"})},iconType:"arrowStart"},content:{loading:p,error:m},"data-test-subj":x.R},i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"none"},g.length>0?g.map((e=>i.a.createElement(de,{icon:"warning",text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.rowDescription",defaultMessage:"{field}, {value} is uncommon",values:{field:e.field,value:e.values.toString()}}),"data-test-subj":`${x.R}${e.field}`,key:`${x.R}${e.field}`}))):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.prevalence.noDataDescription",defaultMessage:"No prevalence data available."})))};_e.displayName="PrevalenceOverview";var Ae=n(741),Pe=n(962),Fe=n(272),De=n(965);const Ne=()=>{const{eventId:e,indexName:t,scopeId:n,dataFormattedForFieldBrowser:s}=Object(l.b)(),{openLeftPanel:o}=Object(r.d)(),c=Object(a.useCallback)((()=>{o({id:S.a,path:{tab:S.c,subTab:De.a},params:{id:e,indexName:t,scopeId:n}})}),[e,o,t,n]),{loading:d,threatMatchesCount:p,threatEnrichmentsCount:m}=(({dataFormattedForFieldBrowser:e})=>{const{isAlert:t}=Object(g.b)(e),n=Object(a.useMemo)((()=>Object(Ae.b)(e||[])),[e]),i=Object(a.useMemo)((()=>t?Object(Ae.f)(e||[]).map((e=>Object(Ae.g)(e))):[]),[e,t]),{result:r,loading:s}=Object(Pe.c)(n),o=Object(a.useMemo)((()=>s||null==r||!r.enrichments?i:Object(Ae.a)([...i,...r.enrichments])),[s,r,i]),{[Fe.c.IndicatorMatchRule]:l,[Fe.c.InvestigationTime]:u}=Object(Y.groupBy)(o,"matched.type");return{loading:s,threatMatches:l,threatMatchesCount:(l||[]).length,threatEnrichments:u,threatEnrichmentsCount:(u||[]).length}})({dataFormattedForFieldBrowser:s});return i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatIntelligenceTitle",defaultMessage:"Threat intelligence"}),link:{callback:c,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatIntelligenceTooltip",defaultMessage:"Show all threat intelligence"})},iconType:"arrowStart"},"data-test-subj":x.K,content:{loading:d}},i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"none","data-test-subj":`${x.K}Container`},i.a.createElement(de,{icon:"warning",value:p,text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatMatchDescription",defaultMessage:"threat {count, plural, one {match} other {matches}} detected",values:{count:p}}),"data-test-subj":x.K}),i.a.createElement(de,{icon:"warning",value:m,text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.threatIntelligence.threatEnrichmentDescription",defaultMessage:"{count, plural, one {field} other {fields}} enriched with threat intelligence",values:{count:m}}),"data-test-subj":x.K})))};Ne.displayName="ThreatIntelligenceOverview",n(179);var Re=n(45),Le=n(730),ze=n(125),Be=n(126),qe=n(214),$e=n(667),Ve=n(306),Ue=n(121),He=n(147),Ze=n(479),Ge=n(896),Qe=n(1288),We=n(898);const Ke=({hostName:e})=>{const{eventId:t,indexName:n,scopeId:s}=Object(l.b)(),{openLeftPanel:d}=Object(r.d)(),p=Object(a.useCallback)((()=>{d({id:S.a,path:{tab:S.c,subTab:B.a},params:{id:t,indexName:n,scopeId:s}})}),[t,d,n,s]),{from:m,to:f}=Object(He.a)(),{selectedPatterns:g}=Object(Ue.d)(),b=Object(a.useMemo)((()=>({from:m,to:f})),[m,f]),y=Object(a.useMemo)((()=>e?Object(ze.B)([e]):void 0),[e]),{data:v,isAuthorized:h,loading:E}=Object(Ze.c)({filterQuery:y,riskEntity:ze.v.host,skip:null==e,timerange:b}),[j,{hostDetails:O}]=Object(Ge.b)({hostName:e,indexNames:g,startDate:m,endDate:f}),k=Object(a.useMemo)((()=>Object(o.a)(Object(Re.getOr)([],"host.os.family",O))),[O]),w=Object(a.useMemo)((()=>[{title:Qe.c,description:k?i.a.createElement(V.a,{field:"host.os.family",value:k},k):Object(Be.d)()}]),[k]),T=Object(a.useMemo)((()=>[{title:Qe.k,description:i.a.createElement(Le.a,{indexPatterns:g,field:"host.name",value:e,type:Le.b.LAST_SEEN})}]),[e,g]),{euiTheme:I}=Object(u.useEuiTheme)(),C=Object(u.useEuiFontSize)("xs").fontSize,[M]=Object(a.useMemo)((()=>{const e=v&&v.length>0?v[0]:void 0;return[{title:i.a.createElement(u.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none",responsive:!1},i.a.createElement(u.EuiFlexItem,{grow:!1},Qe.f),i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(We.a,{riskScoreEntity:ze.v.host}))),description:i.a.createElement(i.a.Fragment,null,e?i.a.createElement(Ve.a,{severity:e.host.risk.calculated_level}):Object(Be.d)())}]}),[v]);return i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1,"data-test-subj":x.u},i.a.createElement(u.EuiFlexItem,null,i.a.createElement(u.EuiFlexGroup,{gutterSize:"m",responsive:!1},i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(u.EuiIcon,{type:"storage"})),i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(Je,{"data-test-subj":x.q,onClick:p,$_css:C,$_css2:I.font.weight.bold},e)))),E||j?i.a.createElement(u.EuiSkeletonText,{"data-test-subj":x.r,contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.insights.entities.hostLoadingAriaLabel",{defaultMessage:"host overview"})}):i.a.createElement(u.EuiFlexItem,null,i.a.createElement(u.EuiFlexGroup,{responsive:!1},i.a.createElement(u.EuiFlexItem,null,i.a.createElement($e.a,{dataTestSubj:x.s,descriptionList:w})),i.a.createElement(u.EuiFlexItem,null,h?i.a.createElement(qe.d,{"data-test-subj":x.t,listItems:[M]}):i.a.createElement($e.a,{dataTestSubj:x.p,descriptionList:T})))))};Ke.displayName="HostEntityOverview";var Je=J()(u.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-cud8pg-0"})(["font-size:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2)),Ye=n(1286),Xe=n(693);const et=({userName:e})=>{const{eventId:t,indexName:n,scopeId:s}=Object(l.b)(),{openLeftPanel:d}=Object(r.d)(),p=Object(a.useCallback)((()=>{d({id:S.a,path:{tab:S.c,subTab:B.a},params:{id:t,indexName:n,scopeId:s}})}),[t,d,n,s]),{from:m,to:f}=Object(He.a)(),{selectedPatterns:g}=Object(Ue.d)(),b=Object(a.useMemo)((()=>({from:m,to:f})),[m,f]),y=Object(a.useMemo)((()=>e?Object(ze.C)([e]):void 0),[e]),[v,{userDetails:h}]=Object(Xe.b)({endDate:f,userName:e,indexNames:g,startDate:m}),{data:E,isAuthorized:j,loading:O}=Object(Ze.c)({filterQuery:y,riskEntity:ze.v.user,timerange:b}),k=Object(a.useMemo)((()=>Object(o.a)(Object(Re.getOr)([],"user.domain",h))),[h]),w=Object(a.useMemo)((()=>[{title:Ye.h,description:k?i.a.createElement(V.a,{field:"user.domain",value:k},k):Object(Be.d)()}]),[k]),T=Object(a.useMemo)((()=>[{title:Ye.f,description:i.a.createElement(Le.a,{indexPatterns:g,field:"user.name",value:e,type:Le.b.LAST_SEEN})}]),[e,g]),{euiTheme:I}=Object(u.useEuiTheme)(),C=Object(u.useEuiFontSize)("xs").fontSize,[M]=Object(a.useMemo)((()=>{const e=E&&E.length>0?E[0]:void 0;return[{title:i.a.createElement(u.EuiFlexGroup,{alignItems:"flexEnd",gutterSize:"none",responsive:!1},i.a.createElement(u.EuiFlexItem,{grow:!1},Ye.j),i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(We.a,{riskScoreEntity:ze.v.user}))),description:i.a.createElement(i.a.Fragment,null,e?i.a.createElement(Ve.a,{severity:e.user.risk.calculated_level}):Object(Be.d)())}]}),[E]);return i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1,"data-test-subj":x.A},i.a.createElement(u.EuiFlexItem,null,i.a.createElement(u.EuiFlexGroup,{gutterSize:"m",responsive:!1},i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(u.EuiIcon,{type:"user"})),i.a.createElement(u.EuiFlexItem,{grow:!1},i.a.createElement(tt,{"data-test-subj":x.x,onClick:p,$_css:C,$_css2:I.font.weight.bold},e)))),i.a.createElement(u.EuiFlexItem,null,v||O?i.a.createElement(u.EuiSkeletonText,{contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.insights.entities.userLoadingAriaLabel",{defaultMessage:"user overview"}),"data-test-subj":x.y}):i.a.createElement(u.EuiFlexGroup,{responsive:!1},i.a.createElement(u.EuiFlexItem,null,i.a.createElement($e.a,{dataTestSubj:x.v,descriptionList:w})),i.a.createElement(u.EuiFlexItem,null,j?i.a.createElement(qe.d,{"data-test-subj":x.z,listItems:[M]}):i.a.createElement($e.a,{dataTestSubj:x.w,descriptionList:T})))))};var tt=J()(u.EuiLink).withConfig({displayName:"_StyledEuiLink",componentId:"sc-f1yfvo-0"})(["font-size:",";font-weight:",";"],(e=>e.$_css),(e=>e.$_css2));const nt=()=>{const{eventId:e,getFieldsData:t,indexName:n,scopeId:s}=Object(l.b)(),{openLeftPanel:c}=Object(r.d)(),d=Object(o.a)(t("host.name")),p=Object(o.a)(t("user.name")),m=Object(a.useCallback)((()=>{c({id:S.a,path:{tab:S.c,subTab:B.a},params:{id:e,indexName:n,scopeId:s}})}),[e,c,n,s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.entitiesTitle",defaultMessage:"Entities"}),link:{callback:m,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.entitiesTooltip",defaultMessage:"Show all entities"})},iconType:"arrowStart"},"data-test-subj":x.I},p||d?i.a.createElement(u.EuiFlexGroup,{direction:"column",gutterSize:"s",responsive:!1},p&&i.a.createElement(i.a.Fragment,null,i.a.createElement(u.EuiFlexItem,null,i.a.createElement(et,{userName:p})),i.a.createElement(u.EuiSpacer,{size:"s"})),d&&i.a.createElement(u.EuiFlexItem,null,i.a.createElement(Ke,{hostName:d}))):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.entities.noDataDescription",defaultMessage:"Host and user information are unavailable for this alert."})))};nt.displayName="EntitiesOverview";const at=({expanded:e=!1})=>i.a.createElement(A.b,{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.insights.sectionTitle",defaultMessage:"Insights"}),expanded:e,"data-test-subj":x.J},i.a.createElement(nt,null),i.a.createElement(u.EuiSpacer,{size:"s"}),i.a.createElement(Ne,null),i.a.createElement(u.EuiSpacer,{size:"s"}),i.a.createElement(Ie,null),i.a.createElement(u.EuiSpacer,{size:"s"}),i.a.createElement(_e,null));at.displayName="InsightsSection";var it=n(48),rt=n(124),st=n(184),ot=n(929),lt=n(224),ut=n(127),ct=n(14),dt=n(1063);const pt=(e,t,n,a,i)=>{const r=e.find((e=>e.id===t.parent));if(i===a&&r)return{id:"ancestor",label:"...",children:[n],isExpanded:!0};if(a<0||i<0||i>=a||!r)return n;const s={id:r.id,label:r.name,children:[n],isExpanded:!0};return pt(e,r,s,a,i+1)},mt=(e,t,n,a,i)=>{const r=e.filter((e=>e.parent===t.id));if(i===a&&r.length>0)return[{id:"descendant",label:"...",isExpanded:!1}];if(n<0||a<0||i<0||i>=a||!r||0===r.length)return;const s=[];return r.forEach(((t,r)=>{r<n&&s.push({id:t.id,label:t.name,children:mt(e,t,n,a,i+1),isExpanded:!1}),r===n&&s.push({id:"more-child",label:"..."})})),s};var ft=n(313),gt=n(1064);const bt=()=>{var e,t;const[n,r]=Object(a.useState)({}),{dataFormattedForFieldBrowser:s,getFieldsData:d,scopeId:p,eventId:m,isPreview:f}=Object(l.b)(),g=null!==(e=Object(o.a)(d(ft.a)))&&void 0!==e?e:"",b=f?g:m,y=Object(Re.find)({category:"kibana",field:ft.e},s),v=null!==(t=null==y?void 0:y.values)&&void 0!==t?t:[],{statsNodes:h,loading:E,error:j}=Object(gt.a)({isActiveTimeline:Object(ut.isActiveTimeline)(p),documentId:b,indices:v});Object(a.useEffect)((()=>{h&&0!==h.length&&r({statsNodes:h})}),[h,r]);const O=Object(a.useMemo)((()=>{var e;return((e,t=3,n=3,a=3)=>{if(0===e.length)return[];const r=e[0],s={id:r.id,label:i.a.createElement("b",{},r.name),children:mt(e,r,t,a,0),isExpanded:!0,icon:i.a.createElement(u.EuiToken,{iconType:"tokenConstant"})};return[pt(e,r,s,n,0)]})(null!==(e=n.statsNodes)&&void 0!==e?e:[],3,3,3)}),[n.statsNodes]),S=m&&y&&O&&O.length>0&&!j;return E?i.a.createElement(u.EuiSkeletonText,{"data-test-subj":x.b,contentAriaLabel:c.i18n.translate("xpack.securitySolution.flyout.right.visualizations.analyzerPreview.loadingAriaLabel",{defaultMessage:"analyzer preview"})}):S?i.a.createElement(u.EuiTreeView,{items:O,display:"compressed","aria-label":c.i18n.translate("xpack.securitySolution.flyout.right.visualizations.analyzerPreview.treeViewAriaLabel",{defaultMessage:"Analyzer preview"}),showExpansionArrows:!0,"data-test-subj":x.c}):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.errorDescription",defaultMessage:"An error is preventing this alert from being analyzed."})};bt.displayName="AnalyzerPreview";const yt="timeline-1",vt=()=>{const{dataAsNestedObject:e,isPreview:t}=Object(l.b)(),n=Object(dt.a)(e),r=Object(it.useDispatch)(),{startTransaction:s}=Object(st.b)(),{investigateInTimelineAlertClick:o}=Object(ot.a)({ecsRowData:e}),c=Object(a.useCallback)((()=>{o(),s({name:lt.a.OPEN_ANALYZER});const t=Object(ut.getScopedActions)(yt);t&&e&&r(t.updateGraphEventId({id:yt,graphEventId:e._id})),r(Object(ct.setActiveTabTimeline)({id:yt,activeTab:rt.f.graph}))}),[e,r,o,s]);return i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.analyzerPreviewTitle",defaultMessage:"Analyzer preview"}),iconType:"timeline",...n&&!t&&{link:{callback:c,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.analyzerPreviewTooltip",defaultMessage:"Show analyzer graph"})}}},"data-test-subj":x.c},n?i.a.createElement(bt,null):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.noDataDescription",defaultMessage:"You can only visualize events triggered by hosts configured with the Elastic Defend integration or any {sysmon} data from {winlogbeat}. Refer to {link} for more information.",values:{sysmon:i.a.createElement(u.EuiMark,null,"sysmon"),winlogbeat:i.a.createElement(u.EuiMark,null,"winlogbeat"),link:i.a.createElement(u.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/visual-event-analyzer.html",target:"_blank"},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.analyzerPreview.noDataLinkText",defaultMessage:"Visual event analyzer"}))}}))};vt.displayName="AnalyzerPreviewContainer";var ht=n(18),Et=n(155);const xt=e=>{const t=Object(o.a)(e("process.entry_leader.user.name")),n=Object(o.a)(e("process.entry_leader.user.id"));return t||(n?"0"===n?"root":`uid: ${n}`:"unknown")};var jt=n(928);const Ot=({text:e,children:t})=>i.a.createElement(i.a.Fragment,null,e&&i.a.createElement(i.a.Fragment,null,"Â ",i.a.createElement("span",null,e),"Â "),t),St=()=>{const{eventId:e,scopeId:t,isPreview:n}=Object(l.b)(),{processName:r,userName:s,startAt:c,ruleName:d,ruleId:p,workdir:m,command:f}=(()=>{const{getFieldsData:e}=Object(l.b)();return Object(a.useMemo)((()=>({userName:xt(e),processName:Object(o.a)(e("process.entry_leader.name")),startAt:Object(o.a)(e("process.entry_leader.start")),ruleName:Object(o.a)(e(ne.G)),ruleId:Object(o.a)(e(ne.V)),workdir:Object(o.a)(e("process.group_leader.working_directory")),command:Object(o.a)(e("process.command_line"))})),[e])})(),{euiTheme:g}=Object(u.useEuiTheme)(),b=Object(a.useMemo)((()=>({fontWeight:g.font.weight.bold})),[g.font.weight.bold]),y=Object(a.useMemo)((()=>r&&i.a.createElement(Ot,{text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.processDescription",defaultMessage:"started"})},i.a.createElement("span",{style:b},r))),[b,r]),v=Object(a.useMemo)((()=>c&&i.a.createElement(Ot,{text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.timeDescription",defaultMessage:"at"})},i.a.createElement(Et.c,{value:new Date(c)}))),[c]),h=Object(a.useMemo)((()=>d&&p&&i.a.createElement(Ot,{text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.ruleDescription",defaultMessage:"with rule"})},i.a.createElement(jt.a,{contextId:t,eventId:e,fieldName:z.n,fieldType:"string",isAggregatable:!1,isDraggable:!1,linkValue:n?null:p,value:d}))),[d,p,t,e,n]),E=Object(a.useMemo)((()=>f&&i.a.createElement(Ot,{text:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.commandDescription",defaultMessage:"by"})},i.a.createElement(u.EuiCode,null,m," ",f))),[f,m]);return i.a.createElement(kt,{"data-test-subj":x.ab},i.a.createElement(Ot,null,i.a.createElement(u.EuiIcon,{type:"user"}),"Â ",i.a.createElement("span",{style:b},s)),y,v,h,E)};var kt=J()("div").withConfig({displayName:"_StyledDiv",componentId:"sc-16jqh3v-0"})(["line-height:1.5;"]);const wt="timeline-1",Tt=()=>{const{dataAsNestedObject:e,getFieldsData:t,isPreview:n}=Object(l.b)(),r=(({getFieldsData:e})=>{const t=Object(o.a)(e("_id")),n=Object(o.a)(e("kibana.alert.ancestors.index"))||Object(o.a)(e("_index")),a=Object(o.a)(e("process.entry_leader.entity_id")),i=Object(o.a)(e("process.entry_leader.start")),r=Object(o.a)(e("process.entity_id")),s=Object(o.a)(e("kibana.alert.original_time"))||Object(o.a)(e("timestamp"));return n&&a&&i?{index:n,sessionEntityId:a,sessionStartTime:i,...r&&{jumpToEntityId:r},...s&&{jumpToCursor:s},...t&&{investigatedAlertId:t}}:null})({getFieldsData:t}),s=Object(ht.b)().isEnterprise(),c=r&&s,d=Object(it.useDispatch)(),{startTransaction:p}=Object(st.b)(),m=Object(ut.getScopedActions)(wt),{investigateInTimelineAlertClick:f}=Object(ot.a)({ecsRowData:e}),g=Object(a.useCallback)((()=>{f(),p({name:lt.a.OPEN_SESSION_VIEW}),null!==r&&(d(Object(ct.setActiveTabTimeline)({id:wt,activeTab:rt.f.session})),m&&d(m.updateSessionViewConfig({id:wt,sessionViewConfig:r})))}),[d,f,m,r,p]),{euiTheme:b}=Object(u.useEuiTheme)(),y=s?r?null:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataDescription",defaultMessage:"You can only view Linux session details if youâ€™ve enabled the {setting} setting in your Elastic Defend integration policy. Refer to {link} for more information.",values:{setting:i.a.createElement(It,{$_css:b.font.weight.bold},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataSettingDescription",defaultMessage:"Include session data"})),link:i.a.createElement(u.EuiLink,{href:"https://www.elastic.co/guide/en/security/current/session-view.html#enable-session-view",target:"_blank"},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.noDataLinkText",defaultMessage:"Enable Session View data"}))}}):i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.upsellDescription",defaultMessage:"This feature requires an {subscription}",values:{subscription:i.a.createElement(u.EuiLink,{href:"https://www.elastic.co/pricing/",target:"_blank"},i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.upsellLinkText",defaultMessage:"Enterprise subscription"}))}});return i.a.createElement(oe.a,{header:{title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.sessionPreviewTitle",defaultMessage:"Session viewer preview"}),iconType:"timeline",...c&&!n&&{link:{callback:g,tooltip:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sessionPreview.sessionPreviewTooltip",defaultMessage:"Show session viewer"})}}},"data-test-subj":x.ab},c?i.a.createElement(St,null):y)};var It=J()("span").withConfig({displayName:"_StyledSpan",componentId:"sc-4u5d2b-0"})(["font-weight:",";"],(e=>e.$_css));const Ct=({expanded:e=!1})=>i.a.createElement(A.b,{expanded:e,title:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.visualizations.sectionTitle",defaultMessage:"Visualizations"}),"data-test-subj":x.db},i.a.createElement(Tt,null),i.a.createElement(u.EuiSpacer,null),i.a.createElement(vt,null));Ct.displayName="VisualizationsSection";const Mt=Object(a.memo)((()=>i.a.createElement(u.EuiPanel,{hasBorder:!1,hasShadow:!1,paddingSize:"none","aria-label":c.i18n.translate("xpack.securitySolution.flyout.right.overview.overviewContentAriaLabel",{defaultMessage:"Alert overview"})},i.a.createElement(se,null),i.a.createElement(u.EuiHorizontalRule,{margin:"m"}),i.a.createElement(W,null),i.a.createElement(u.EuiHorizontalRule,{margin:"m"}),i.a.createElement(Ct,null),i.a.createElement(u.EuiHorizontalRule,{margin:"m"}),i.a.createElement(at,null),i.a.createElement(u.EuiHorizontalRule,{margin:"m"}),i.a.createElement(P,null))));Mt.displayName="OverviewTab";var _t=n(1301);const At=[{id:"overview","data-test-subj":C.c,name:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.overviewTabLabel",defaultMessage:"Overview"}),content:i.a.createElement(Mt,null)},{id:"table","data-test-subj":C.d,name:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.tableTabLabel",defaultMessage:"Table"}),content:i.a.createElement(_t.a,null)},{id:"json","data-test-subj":C.b,name:i.a.createElement(I.FormattedMessage,{id:"xpack.securitySolution.flyout.right.header.jsonTabLabel",defaultMessage:"JSON"}),content:i.a.createElement(M.a,null)}];var Pt=n(55),Ft=n(1273),Dt=n(1121);const Nt=J()("div").withConfig({displayName:"ContainerDiv",componentId:"sc-vi2r7u-0"})([".side-panel-flyout-footer{padding:",";}"],Pt.euiThemeVars.euiPanelPaddingModifiers.paddingMedium),Rt=({isPreview:e})=>{const{closeFlyout:t,openRightPanel:n}=Object(r.d)(),{eventId:s,indexName:o,dataFormattedForFieldBrowser:u,dataAsNestedObject:c,refetchFlyoutData:d,scopeId:p}=Object(l.b)(),{isHostIsolationPanelOpen:m,showHostIsolationPanel:f}=Object(Dt.a)(),g=Object(a.useCallback)((e=>{f(e),n({id:"document-details-isolate-host",params:{id:s,indexName:o,scopeId:p,isolateAction:e}})}),[s,o,n,p,f]);return e?null:i.a.createElement(Nt,null,i.a.createElement(Ft.b,{detailsData:u,detailsEcsData:c,handleOnEventClosed:t,isHostIsolationPanelOpen:m,isReadOnly:!1,loadingEventDetails:!1,onAddIsolationStatusClick:g,scopeId:p,refetchFlyoutData:d}))},Lt="document-details-right",zt=Object(a.memo)((({path:e})=>{const{openRightPanel:t}=Object(r.d)(),{eventId:n,getFieldsData:u,indexName:c,scopeId:d,isPreview:p}=Object(l.b)(),m=Object(o.a)(u("event.kind"))===s.a.signal,f=m?At:At.filter((e=>"overview"!==e.id)),g=Object(a.useMemo)((()=>{var t;const n=f[0].id;return e&&null!==(t=f.map((e=>e.id)).find((t=>t===e.tab)))&&void 0!==t?t:n}),[e,f]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(k,{flyoutIsExpandable:m}),i.a.createElement(w.a,{tabs:f,selectedTabId:g,setSelectedTabId:e=>{t({id:Lt,path:{tab:e},params:{id:n,indexName:c,scopeId:d}})}}),i.a.createElement(T.a,{tabs:f,selectedTabId:g}),i.a.createElement(Rt,{isPreview:p}))}));zt.displayName="RightPanel"},function(e,t,n){"use strict";n.d(t,"a",(function(){return St}));var a=n(2),i=n.n(a),r=n(48),s=n(17),o=n(47),l=n(49),u=n(1093),c=n(161),d=n(44),p=n.n(d),m=n(489);function f(e,t,n){return t+(e>1?n*(e-1):0)}var g=n(55);function b(){return Object(a.useMemo)((()=>({copyableFieldBackground:g.euiThemeVars.euiColorLightShade,descriptionText:g.euiThemeVars.euiTextColor,full:g.euiThemeVars.euiColorFullShade,graphControls:g.euiThemeVars.euiColorDarkestShade,graphControlsBackground:g.euiThemeVars.euiColorEmptyShade,graphControlsBorderColor:g.euiThemeVars.euiColorLightShade,processBackingFill:`${g.euiThemeVars.euiColorPrimary}${g.darkMode?"1F":"0F"}`,resolverBackground:g.euiThemeVars.euiColorEmptyShade,resolverEdge:g.darkMode?g.euiThemeVars.euiColorLightShade:g.euiThemeVars.euiColorLightestShade,resolverBreadcrumbBackground:g.euiThemeVars.euiColorLightestShade,resolverEdgeText:g.darkMode?g.euiThemeVars.euiColorFullShade:g.euiThemeVars.euiColorDarkShade,triggerBackingFill:`${g.euiThemeVars.euiColorDanger}${g.darkMode?"1F":"0F"}`,pillStroke:g.euiThemeVars.euiColorLightShade,linkColor:g.euiThemeVars.euiLinkColor})),[])}const y=p.a.div.withConfig({displayName:"StyledEdgeLine",componentId:"sc-15liy6m-0"})(["position:absolute;height:",";background-color:",";z-index:10;"],(e=>`${f(e.magFactorX,12,8.5)}px`),(e=>e.resolverEdgeColor)),v=p.a.div.withConfig({displayName:"StyledElapsedTime",componentId:"sc-15liy6m-1"})(["background-color:",";color:",";font-size:",";font-weight:bold;max-width:75%;overflow:hidden;position:absolute;text-overflow:ellipsis;top:50%;white-space:nowrap;left:",";padding:6px 8px;border-radius:999px;transform:translate(-50%,-50%);user-select:none;"],(e=>e.backgroundColor),(e=>e.textColor),(e=>`${e.scaledTypeSize}px`),(e=>`${e.leftPct}%`)),h=i.a.memo((({className:e,edgeLineMetadata:t,startPosition:n,endPosition:a,projectionMatrix:r})=>{const s=Object(m.c)(n,r),l=Object(m.c)(a,r),[u]=r,c=b(),d=null==t?void 0:t.elapsedTime,p=Object(m.d)(s,l),g=f(u,10,7.5),h={left:`${s[0]}px`,top:`${s[1]}px`,width:`${p}px`,transformOrigin:"top left",transform:`translateY(-50%) rotateZ(${Object(m.b)(s,l)}rad)`};let E=50;return u<1&&(E+=1/u*(10*(1-u))),i.a.createElement(y,{className:e,style:h,resolverEdgeColor:c.resolverEdge,magFactorX:u,"data-test-subj":"resolver:graph:edgeline"},d&&i.a.createElement(v,{backgroundColor:c.resolverEdge,leftPct:E,scaledTypeSize:g,textColor:c.resolverEdgeText},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.elapsedTime",defaultMessage:"{duration} {durationType}",values:{duration:d.duration,durationType:d.durationType}})))}));var E=n(5);const x={timestamp:()=>Date.now(),requestAnimationFrame:(...e)=>window.requestAnimationFrame(...e),cancelAnimationFrame:(...e)=>window.cancelAnimationFrame(...e),ResizeObserver:n(513).ResizeObserver,writeTextToClipboard:e=>navigator.clipboard.writeText(e),getBoundingClientRect:e=>e.getBoundingClientRect()},j=Object(a.createContext)(x),O=Object(a.memo)(p()(s.EuiDescriptionList).withConfig({displayName:"StyledDescriptionList",componentId:"sc-o40dfq-0"})([".euiDescriptionList__title{word-break:normal;}.euiDescriptionList__title,.euiDescriptionList__description{overflow-wrap:break-word;}"])),S=p()("h4").withConfig({displayName:"StyledTitle",componentId:"sc-o40dfq-1"})(["overflow-wrap:break-word;"]),k=p()(s.EuiBreadcrumbs).withConfig({displayName:"ThemedBreadcrumbs",componentId:"sc-o40dfq-2"})(["&.euiBreadcrumbs{background-color:",";color:",";padding:1em;border-radius:5px;}& .euiBreadcrumbSeparator{background:",";}"],(e=>e.background),(e=>e.text),(e=>e.text)),w=p.a.div.withConfig({displayName:"StyledButtonTextContainer",componentId:"sc-o40dfq-3"})(["align-items:center;display:flex;flex-direction:row;"]),T=p.a.div.withConfig({displayName:"StyledAnalyzedEvent",componentId:"sc-o40dfq-4"})(["color:",";font-size:10.5px;font-weight:700;"],(e=>e.color)),I=p.a.div.withConfig({displayName:"StyledLabelTitle",componentId:"sc-o40dfq-5"})([""]),C=p.a.div.withConfig({displayName:"StyledLabelContainer",componentId:"sc-o40dfq-6"})(["display:inline-block;flex:3;min-width:0;",",","{overflow:hidden;text-align:left;text-overflow:ellipsis;white-space:nowrap;}"],T,I),M=p()(s.EuiCode).withConfig({displayName:"BoldCode",componentId:"sc-o40dfq-7"})(["&.euiCodeBlock code.euiCodeBlock__code{font-weight:900;}"]),_=p()("time").withConfig({displayName:"StyledTime",componentId:"sc-o40dfq-8"})(["display:inline-block;text-align:start;"]);function A({id:e}){return Object(a.useMemo)((()=>{const t=`${e}-symbols`;return{processNodeLabel:`${t}-nodeSymbol`,runningProcessCube:`${t}-runningCube`,runningTriggerCube:`${t}-runningTriggerCube`,terminatedProcessCube:`${t}-terminatedCube`,terminatedTriggerCube:`${t}-terminatedTriggerCube`,processCubeActiveBacking:`${t}-activeBacking`,loadingCube:`${t}-loadingCube`,errorCube:`${t}-errorCube`}}),[e])}function P(e,t,n){const i=A({id:e}),r=b(),s=Object(a.useMemo)((()=>({runningProcessCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.runningProcessCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningProcess",{defaultMessage:"Running Process"}),isLabelFilled:!0,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},loadingCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.loadingCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.loadingProcess",{defaultMessage:"Loading Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},errorCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.errorCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.errorProcess",{defaultMessage:"Error Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},runningTriggerCube:{backingFill:r.triggerBackingFill,cubeSymbol:`#${i.runningTriggerCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.runningTrigger",{defaultMessage:"Running Trigger"}),isLabelFilled:!0,labelButtonFill:"danger",strokeColor:g.euiThemeVars.euiColorDanger},terminatedProcessCube:{backingFill:r.processBackingFill,cubeSymbol:`#${i.terminatedProcessCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedProcess",{defaultMessage:"Terminated Process"}),isLabelFilled:!1,labelButtonFill:"primary",strokeColor:g.euiThemeVars.euiColorPrimary},terminatedTriggerCube:{backingFill:r.triggerBackingFill,cubeSymbol:`#${i.terminatedTriggerCube}`,descriptionFill:r.descriptionText,descriptionText:E.i18n.translate("xpack.securitySolution.endpoint.resolver.terminatedTrigger",{defaultMessage:"Terminated Trigger"}),isLabelFilled:!1,labelButtonFill:"danger",strokeColor:g.euiThemeVars.euiColorDanger}})),[i,r]);return"terminated"===t?n?s.terminatedTriggerCube:s[F.processTerminated]:"running"===t?n?s[F.processCausedAlert]:s[F.processRan]:"error"===t?s[F.processError]:s[F.processLoading]}const F={processCreated:"runningProcessCube",processRan:"runningProcessCube",processTerminated:"terminatedProcessCube",unknownProcessEvent:"runningProcessCube",processCausedAlert:"runningTriggerCube",processLoading:"loadingCube",processError:"errorCube",unknownEvent:"runningProcessCube"},D=Object(a.memo)((function({id:e,className:t,size:n="2.15em",state:a,isOrigin:r,"data-test-subj":s}){const{cubeSymbol:o,strokeColor:l}=P(e,a,!1),{processCubeActiveBacking:u}=A({id:e});return i.a.createElement(N,{className:t,width:n,height:n,viewBox:"0 0 34 34","data-test-subj":s,isOrigin:r,style:{verticalAlign:"middle"}},i.a.createElement("desc",null,E.i18n.translate("xpack.securitySolution.resolver.node_icon",{defaultMessage:"{state, select, running {Running Process} terminated {Terminated Process} loading {Loading Process} error {Error Process}}",values:{state:a}})),r&&i.a.createElement("use",{xlinkHref:`#${u}`,fill:"transparent",x:0,y:-1,stroke:l,strokeDashoffset:0,width:"100%",height:"100%"}),i.a.createElement("use",{role:"presentation",xlinkHref:o,x:5.25,y:4.25,width:"70%",height:"70%",opacity:"1",className:"cube"}))})),N=p.a.svg.withConfig({displayName:"StyledSVG",componentId:"sc-wfcaav-0"})(["margin-right:",";"],(e=>e.isOrigin?"0.15em":0)),R=i.a.memo((function({children:e}){return i.a.createElement(i.a.Fragment,null,i.a.Children.map(e,(e=>{if("string"==typeof e){const t=e.split(/\b/);return t.length<2?t[0]:[t[0],...t.splice(1).reduce((function(e,t){return[...e,t,i.a.createElement("wbr",null)]}),[])]}return e})))}));var L=n(699);const z=p()(s.EuiRange).withConfig({displayName:"StyledEuiRange",componentId:"sc-1bgkbkz-0"})(["& .euiRangeTrack:after{left:-65px;transform:rotate(90deg);}"]),B=p.a.div.withConfig({displayName:"StyledGraphControlsColumn",componentId:"sc-1bgkbkz-1"})(["display:flex;flex-direction:column;&:not(last-of-type){margin-right:5px;}"]),q=["fit-content(10em)","auto"],$=p()(s.EuiDescriptionListTitle).withConfig({displayName:"StyledEuiDescriptionListTitle",componentId:"sc-1bgkbkz-2"})(["text-transform:uppercase;"]),V=p()(s.EuiDescriptionListDescription).withConfig({displayName:"StyledEuiDescriptionListDescription",componentId:"sc-1bgkbkz-3"})(["lineheight:'2.2em';"]),U=p()(s.EuiButtonIcon).withConfig({displayName:"StyledEuiButtonIcon",componentId:"sc-1bgkbkz-4"})(["background-color:",";color:",";border-color:",";border-width:1px;border-style:solid;border-radius:4px;width:40px;height:40px;&:not(last-of-type){margin-bottom:7px;}"],(e=>e.$backgroundColor),(e=>e.$iconColor),(e=>e.$borderColor)),H=p.a.div.withConfig({displayName:"StyledGraphControls",componentId:"sc-1bgkbkz-5"})(["display:flex;flex-direction:row;position:absolute;top:5px;right:5px;background-color:transparent;color:",";.zoom-controls{display:flex;flex-direction:column;align-items:center;padding:5px 0px;.zoom-slider{width:20px;height:150px;margin:5px 0px 2px 0px;input[type='range']{width:150px;height:20px;transform-origin:75px 75px;transform:rotate(-90deg);}}}.panning-controls{text-align:center;}"],(e=>e.$iconColor)),Z=i.a.memo((({id:e,className:t})=>{const n=Object(r.useDispatch)(),o=Object(r.useSelector)((t=>c.G(t.analyzer[e]))),{timestamp:l}=Object(a.useContext)(j),[u,d]=Object(a.useState)(null),p=b(),m=Object(a.useCallback)((e=>{d(e===u?null:e)}),[d,u]),f=Object(a.useCallback)((()=>d(null)),[]),g=Object(a.useCallback)((t=>{const a=parseFloat(t.target.value);!1===isNaN(a)&&n(Object(L.userSetZoomLevel)({id:e,zoomLevel:a}))}),[n,e]),y=Object(a.useCallback)((()=>{n(Object(L.userSetPositionOfCamera)({id:e,cameraView:[0,0]}))}),[n,e]),v=Object(a.useCallback)((()=>{n(Object(L.userClickedZoomOut)({id:e}))}),[n,e]),h=Object(a.useCallback)((()=>{n(Object(L.userClickedZoomIn)({id:e}))}),[n,e]),[x,O,S,k]=Object(a.useMemo)((()=>[[0,1],[1,0],[0,-1],[-1,0]].map((t=>()=>{n(Object(L.userNudgedCamera)({id:e,direction:t,time:l()}))}))),[n,l,e]);return i.a.createElement(H,{className:t,$iconColor:p.graphControls,"data-test-subj":"resolver:graph-controls"},i.a.createElement(B,null,i.a.createElement(G,{id:e,closePopover:f,isOpen:"schemaInfo"===u,setActivePopover:m}),i.a.createElement(Q,{id:e,closePopover:f,isOpen:"nodeLegend"===u,setActivePopover:m})),i.a.createElement(B,null,i.a.createElement(s.EuiPanel,{className:"panning-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("div",{className:"panning-controls-top"},i.a.createElement("button",{className:"north-button","data-test-subj":"resolver:graph-controls:north-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.north",{defaultMessage:"North"}),onClick:x},i.a.createElement(s.EuiIcon,{type:"arrowUp"}))),i.a.createElement("div",{className:"panning-controls-middle"},i.a.createElement("button",{className:"west-button","data-test-subj":"resolver:graph-controls:west-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.west",{defaultMessage:"West"}),onClick:k},i.a.createElement(s.EuiIcon,{type:"arrowLeft"})),i.a.createElement("button",{className:"center-button","data-test-subj":"resolver:graph-controls:center-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.center",{defaultMessage:"Center"}),onClick:y},i.a.createElement(s.EuiIcon,{type:"bullseye"})),i.a.createElement("button",{className:"east-button","data-test-subj":"resolver:graph-controls:east-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.east",{defaultMessage:"East"}),onClick:O},i.a.createElement(s.EuiIcon,{type:"arrowRight"}))),i.a.createElement("div",{className:"panning-controls-bottom"},i.a.createElement("button",{className:"south-button","data-test-subj":"resolver:graph-controls:south-button",title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.south",{defaultMessage:"South"}),onClick:S},i.a.createElement(s.EuiIcon,{type:"arrowDown"})))),i.a.createElement(s.EuiPanel,{className:"zoom-controls",paddingSize:"none",hasBorder:!0},i.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomIn",{defaultMessage:"Zoom In"}),"data-test-subj":"resolver:graph-controls:zoom-in",onClick:h},i.a.createElement(s.EuiIcon,{type:"plusInCircle"})),i.a.createElement(z,{className:"zoom-slider","data-test-subj":"resolver:graph-controls:zoom-slider",min:0,max:1,step:.01,value:o,onChange:g}),i.a.createElement("button",{title:E.i18n.translate("xpack.securitySolution.resolver.graphControls.zoomOut",{defaultMessage:"Zoom Out"}),"data-test-subj":"resolver:graph-controls:zoom-out",onClick:v},i.a.createElement(s.EuiIcon,{type:"minusInCircle"})))))})),G=({id:e,closePopover:t,setActivePopover:n,isOpen:o})=>{var l,u,d;const p=b(),m=Object(r.useSelector)((t=>c.F(t.analyzer[e]))),f=Object(a.useCallback)((()=>n("schemaInfo")),[n]),g=E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoButtonTitle",{defaultMessage:"Schema Information"}),y=E.i18n.translate("xpack.securitySolution.resolver.graphControls.unknownSchemaValue",{defaultMessage:"Unknown"});return i.a.createElement(s.EuiPopover,{button:i.a.createElement(U,{"data-test-subj":"resolver:graph-controls:schema-info-button",size:"m",title:g,"aria-label":g,onClick:f,iconType:"iInCircle",$backgroundColor:p.graphControlsBackground,$iconColor:p.graphControls,$borderColor:p.graphControlsBorderColor}),isOpen:o,closePopover:t,anchorPosition:"leftCenter"},i.a.createElement(s.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTitle",{defaultMessage:"process tree"}),i.a.createElement(s.EuiIconTip,{content:E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaInfoTooltip",{defaultMessage:"These are the fields used to create the process tree"}),position:"right"})),i.a.createElement("div",{style:{maxWidth:"268px"}},i.a.createElement(O,{"data-test-subj":"resolver:graph-controls:schema-info",type:"column",columnWidths:q,align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaSource",{defaultMessage:"source"})),i.a.createElement(s.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},i.a.createElement(R,null,null!==(l=null==m?void 0:m.dataSource)&&void 0!==l?l:y)),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaID",{defaultMessage:"id"})),i.a.createElement(s.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},i.a.createElement(R,null,null!==(u=null==m?void 0:m.schema.id)&&void 0!==u?u:y)),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:schema-info:title"},E.i18n.translate("xpack.securitySolution.resolver.graphControls.schemaEdge",{defaultMessage:"edge"})),i.a.createElement(s.EuiDescriptionListDescription,{"data-test-subj":"resolver:graph-controls:schema-info:description"},i.a.createElement(R,null,null!==(d=null==m?void 0:m.schema.parent)&&void 0!==d?d:y))))))},Q=({id:e,closePopover:t,setActivePopover:n,isOpen:r})=>{const o=Object(a.useCallback)((()=>n("nodeLegend")),[n]),l=b(),u=E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegendButtonTitle",{defaultMessage:"Node Legend"});return i.a.createElement(s.EuiPopover,{button:i.a.createElement(U,{"data-test-subj":"resolver:graph-controls:node-legend-button",size:"m",title:u,"aria-label":u,onClick:o,iconType:"node",$backgroundColor:l.graphControlsBackground,$iconColor:l.graphControls,$borderColor:l.graphControlsBorderColor}),isOpen:r,closePopover:t,anchorPosition:"leftCenter"},i.a.createElement(s.EuiPopoverTitle,{style:{textTransform:"uppercase"}},E.i18n.translate("xpack.securitySolution.resolver.graphControls.nodeLegend",{defaultMessage:"legend"})),i.a.createElement("div",{style:{maxWidth:"212px"}},i.a.createElement(O,{"data-test-subj":"resolver:graph-controls:node-legend",type:"column",columnWidths:q,align:"left",compressed:!0},i.a.createElement(i.a.Fragment,null,i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(D,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"running"})),i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(R,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.runningProcessCube",{defaultMessage:"Running Process"}))),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(D,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"terminated"})),i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(R,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.terminatedProcessCube",{defaultMessage:"Terminated Process"}))),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(D,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"loading"})),i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(R,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.currentlyLoadingCube",{defaultMessage:"Loading Process"}))),i.a.createElement($,{"data-test-subj":"resolver:graph-controls:node-legend:title"},i.a.createElement(D,{id:e,size:"2.5em","data-test-subj":"resolver:node-detail:title-icon",state:"error"})),i.a.createElement(V,{"data-test-subj":"resolver:graph-controls:node-legend:description"},i.a.createElement(R,null,E.i18n.translate("xpack.securitySolution.resolver.graphControls.errorCube",{defaultMessage:"Error Process"})))))))};function W(e,t){return function(e,t){const n=Object(l.useHistory)(),i=Object(a.useCallback)((t=>{t.defaultPrevented||0===t.button&&(t.currentTarget instanceof HTMLAnchorElement&&""!==t.currentTarget.target&&"_self"!==t.currentTarget.target||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey||(t.preventDefault(),n.push(e)))}),[n,t,e]);return{href:n.createHref(e),onClick:i}}({search:Object(r.useSelector)((n=>c.D(n.analyzer[e])(t)))})}var K=n(236),J=n(271);const Y=i.a.memo((({id:e,className:t,nodeID:n,nodeStats:r})=>{const s=Object(a.useMemo)((()=>void 0===r?[]:Object.entries(r.byCategory).map((([e,t])=>({prefix:i.a.createElement(K.a,{count:t||0}),category:e})))),[r]);return void 0===s?null:i.a.createElement("ul",{className:`${t} options`,"aria-describedby":n},s.sort(((e,t)=>e.category.localeCompare(t.category))).map((t=>i.a.createElement(X,{id:e,pill:t,nodeID:n,key:t.category}))))})),X=({id:e,pill:t,nodeID:n})=>{const s=W(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:n,eventCategory:t.category}}),{pillStroke:o,resolverBackground:l}=b(),u=Object(a.useMemo)((()=>({border:`1.5px solid ${o}`,backgroundColor:l})),[o,l]),c=Object(r.useDispatch)(),{timestamp:d}=Object(a.useContext)(j),p=Object(a.useCallback)((t=>{s.onClick(t),c(Object(J.userSelectedResolverNode)({id:e,nodeID:n,time:d()}))}),[d,s,c,n,e]);return i.a.createElement("li",{className:"item","data-test-subj":"resolver:map:node-submenu-item",style:u,key:t.category},i.a.createElement("button",{type:"button",className:"kbn-resetFocusState",onClick:p},t.prefix," ",t.category))},ee=p()(Y).withConfig({displayName:"NodeSubMenu",componentId:"sc-bt8orj-0"})(["margin:2px 0 0 0;padding:0;border:none;display:flex;flex-flow:column;z-index:auto;&.options{font-size:0.8rem;display:flex;flex-flow:row wrap;background:transparent;position:absolute;top:4.5em;overflow-x:visible;width:24ch;z-index:auto;}&.options::after{position:absolute;content:'';width:100%;height:100%;left:0;top:0;z-index:20;backdrop-filter:blur(2px);pointer-events:none;}&.options .item{margin:0.25ch 0.35ch 0.35ch 0;padding:0.35em 0.5em;height:fit-content;width:fit-content;border-radius:2px;line-height:0.8;z-index:40;}&.options .item button{appearance:none;height:fit-content;width:fit-content;line-height:0.8;outline-style:none;border-color:transparent;box-shadow:none;}&.options .item button:focus{outline-style:none;border-color:transparent;box-shadow:none;text-decoration:underline;}&.options .item button:active{transform:scale(0.95);}"]),te=p.a.div.withConfig({displayName:"StyledMapContainer",componentId:"sc-bt8orj-1"})(["&,.resolver-graph{display:flex;flex-grow:1;}.loading-container{display:flex;align-items:center;justify-content:center;flex-grow:1;}min-height:652px;position:relative;overflow:hidden;contain:strict;background-color:",";"],(e=>e.backgroundColor)),ne=p()(s.EuiPanel).withConfig({displayName:"StyledPanel",componentId:"sc-bt8orj-2"})(["position:absolute;left:0;top:0;bottom:0;overflow:auto;width:25em;max-width:50%;border-radius:0;border-top:none;"]),ae=p.a.div.withConfig({displayName:"GraphContainer",componentId:"sc-bt8orj-3"})(["display:flex;flex-grow:1;contain:layout;position:relative;z-index:0;"]),ie=p()(s.EuiCallOut).withConfig({displayName:"LimitWarningsEuiCallOut",componentId:"sc-bt8orj-4"})(["flex-flow:row wrap;display:block;align-items:baseline;margin-top:1em;& .euiCallOutHeader{display:inline;margin-right:0.25em;}& .euiText{display:inline;}& .euiText p{display:inline;}"]);var re=n(356),se=n(263),oe=n(408),le=n(444);const ue=p.a.div.withConfig({displayName:"StyledActionsContainer",componentId:"sc-tk4vjc-0"})(["background-color:transparent;color:",";display:flex;flex-flow:column;font-size:",";left:20.9%;line-height:140%;padding:0.25rem 0 0 0.1rem;position:absolute;top:",";width:auto;pointer-events:all;"],(e=>e.color),(e=>`${e.fontSize}px`),(e=>`${e.topPct}%`)),ce=p.a.div.withConfig({displayName:"StyledDescriptionText",componentId:"sc-tk4vjc-1"})(["background-color:",";color:",";display:",";font-size:0.8rem;font-weight:bold;letter-spacing:-0.01px;line-height:1;margin:0;padding:4px 0 0 2px;text-align:left;text-transform:uppercase;width:fit-content;z-index:45;"],(e=>e.backgroundColor),(e=>e.color),(e=>e.isDisplaying?"block":"none")),de=p.a.span.withConfig({displayName:"StyledEuiButtonContent",componentId:"sc-tk4vjc-2"})(["padding:",";"],(e=>e.isShowingIcon?"0px":"0 12px")),pe=p.a.g.withConfig({displayName:"StyledOuterGroup",componentId:"sc-tk4vjc-3"})(["fill:none;pointer-events:visiblePainted;",""],(e=>e.isNodeLoading&&"\n    & .cube {\n    animation-name: pulse;\n    /**\n     * his is a multiple of .6 so it can match up with the EUI button's loading spinner\n     * which is (0.6s). Using .6 here makes it a bit too fast.\n     */\n    animation-duration: 1.8s;\n    animation-delay: 0;\n    animation-direction: normal;\n    animation-iteration-count: infinite;\n    animation-timing-function: linear;\n  }\n\n  /**\n   * Animation loading state of the cube.\n   */\n  @keyframes pulse {\n    0% {\n      opacity: 1;\n    }\n    50% {\n      opacity: 0.35;\n    }\n    100% {\n      opacity: 1;\n    }\n  }\n  ")),me=i.a.memo((({id:e,className:t,position:n,node:l,nodeID:u,projectionMatrix:d,timeAtRender:p})=>{const g=`resolver:${e}`,y=A({id:e}),{timestamp:v}=Object(a.useContext)(j),[h,x]=Object(m.c)(n,d),[O]=d,S=Object(r.useSelector)((t=>c.a(t.analyzer[e]))),k=Object(r.useSelector)((t=>c.H(t.analyzer[e]))),w=Object(r.useSelector)((t=>c.y(t.analyzer[e]))),T=Object(r.useSelector)((t=>c.x(t.analyzer[e])(u))),I=Object(a.useCallback)((e=>Object(s.htmlIdGenerator)(g)(`${e}:node`)),[g]),C=Object(r.useSelector)((t=>c.c(t.analyzer[e])(u))),M=Object(r.useSelector)((t=>c.b(t.analyzer[e])(p)(u))),_=O>.8,F=O>=.55,D=(_?3.5:F?1:21)*O+5,N=360*(_?-.147413:-.147413-.08*(O-.5))*O,R=120*(_?-.53684:.2*-O*(1-O)/O-.53684)*O,L=Object(a.useMemo)((()=>({left:`${h+N}px`,top:`${x+R}px`,width:360*O+"px",height:120*O+"px"})),[h,O,N,R,x]),z=f(O,18.75,12.5),B=i.a.createRef(),q=b(),$=Object(r.useSelector)((t=>c.v(t.analyzer[e])(u))),V="loading"===$,{backingFill:U,cubeSymbol:H,descriptionText:Z,isLabelFilled:G,labelButtonFill:Q,strokeColor:K}=P(e,$,!1),Y=Object(a.useMemo)((()=>Object(s.htmlIdGenerator)("resolver")(`${u}:label`)),[u]),X=u===S,te=u===k,ne=u===w,ae=Object(r.useDispatch)(),ie=W(e,{panelView:"nodeDetail",panelParameters:{nodeID:u}}),me=Object(a.useCallback)((()=>{ae(Object(J.userFocusedOnResolverNode)({id:e,nodeID:u,time:v()}))}),[ae,u,v,e]),fe=Object(a.useCallback)((t=>{var n;null!==(n=B.current)&&void 0!==n&&n.beginElement&&B.current.beginElement(),"error"===$?ae(Object(le.userReloadedResolverNode)({id:e,nodeID:u})):(ae(Object(J.userSelectedResolverNode)({id:e,nodeID:u,time:v()})),ie.onClick(t))}),[B,ae,u,ie,$,v,e]),ge=Object(r.useSelector)((t=>c.I(t.analyzer[e])(l))),be=re.c(l),ye=Object(r.useSelector)((t=>oe.a(c.u(t.analyzer[e])(String(l.id))))),ve=Object(a.useMemo)((()=>void 0!==ye?se.l(ye):be),[ye,be]),he=Object(a.useMemo)((()=>null===M?void 0:I(M)),[M,I]),Ee=Object(a.useMemo)((()=>I(u)),[I,u]);return i.a.createElement("div",{"data-test-subj":"resolver:node","data-test-resolver-node-id":u,className:`${t} kbn-resetFocusState`,role:"treeitem","aria-level":null===C?void 0:C,"aria-flowto":he,"aria-labelledby":Y,"aria-haspopup":"true","aria-current":X?"true":void 0,"aria-selected":te?"true":void 0,style:L,id:Ee,tabIndex:-1},i.a.createElement("svg",{viewBox:"-15 -15 90 30",preserveAspectRatio:"xMidYMid meet",onClick:e=>{me(),fe(e)},role:"img","aria-labelledby":Y,fill:"none",style:{display:"block",width:"100%",height:"100%",position:"absolute",top:"0",left:"0",outline:"transparent",border:"none",pointerEvents:"none",zIndex:30}},i.a.createElement(pe,{isNodeLoading:V},i.a.createElement("use",{xlinkHref:`#${y.processCubeActiveBacking}`,fill:U,x:-15.35,y:-15.35,stroke:K,width:22.5,height:22.5,className:"backing"}),ne&&i.a.createElement("use",{xlinkHref:`#${y.processCubeActiveBacking}`,fill:"transparent",x:-15.35,y:-15.35,stroke:K,strokeOpacity:.35,strokeDashoffset:0,width:22.5,height:22.5,className:"origin"}),i.a.createElement("use",{role:"presentation",xlinkHref:H,x:-11.5,y:-11.5,width:15,height:15,opacity:"1",className:"cube"},i.a.createElement("animateTransform",{attributeType:"XML",attributeName:"transform",type:"scale",values:"1 1; 1 .83; 1 .8; 1 .83; 1 1",dur:"0.2s",repeatCount:"1",className:"squish",ref:B})))),i.a.createElement(ue,{color:q.full,fontSize:z,topPct:D},i.a.createElement(ce,{backgroundColor:q.resolverBackground,color:q.descriptionText,isDisplaying:F,"data-test-subj":"resolver:node:description"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.processDescription",defaultMessage:"{isEventBeingAnalyzed, select, true {Analyzed Event Â· {descriptionText}} false {{descriptionText}}}",values:{isEventBeingAnalyzed:ne,descriptionText:Z}})),i.a.createElement("div",{className:"euiButton euiButton--small",id:Y,onClick:fe,onFocus:me,tabIndex:-1,style:{backgroundColor:q.resolverBackground,alignSelf:"flex-start",padding:0,zIndex:45}},i.a.createElement(s.EuiButton,{iconSide:V?"right":"left",isLoading:V,color:Q,fill:G,iconType:"error"===$?"refresh":"",size:"s",style:{maxHeight:`${Math.min(26+3*O,32)}px`,maxWidth:(_?400:210*O)+"px"},tabIndex:-1,title:ve,"data-test-subj":"resolver:node:primary-button","data-test-resolver-node-id":u},i.a.createElement(de,{isShowingIcon:"loading"===$||"error"===$,className:"eui-textTruncate","data-test-subj":"euiButton__text"},E.i18n.translate("xpack.securitySolution.resolver.node_button_name",{defaultMessage:"{nodeState, select, error {Reload {nodeName}} other {{nodeName}}}",values:{nodeState:$,nodeName:ve}})))),i.a.createElement(s.EuiFlexGroup,{justifyContent:"flexStart",gutterSize:"xs",style:{alignSelf:"flex-start",background:q.resolverBackground,display:_?"flex":"none",margin:"2px 0 0 0",padding:0}},i.a.createElement(s.EuiFlexItem,{grow:!1,className:"related-dropdown"},null!==ge&&ge>0&&i.a.createElement(ee,{id:e,buttonFill:q.resolverBackground,nodeStats:T,nodeID:u})))))})),fe=p()(me).withConfig({displayName:"ProcessEventDot",componentId:"sc-tk4vjc-4"})(["position:absolute;text-align:left;font-size:10px;user-select:none;box-sizing:border-box;border-radius:10%;white-space:nowrap;will-change:left,top,width,height;min-width:280px;min-height:90px;overflow-y:visible;pointer-events:none;z-index:auto;& .backing{stroke-dasharray:500;stroke-dashoffset:500;fill-opacity:0;}&:hover:not([aria-current]) .backing{transition-property:fill-opacity;transition-duration:0.25s;fill-opacity:1;}&[aria-current] .backing{transition-property:stroke-dashoffset;transition-duration:1s;stroke-dashoffset:0;}& .euiButton{width:fit-content;}& .euiSelectableList-bordered{border-top-right-radius:0px;border-top-left-radius:0px;}& .euiSelectableListItem{background-color:black;}& .euiSelectableListItem path{fill:white;}& .euiSelectableListItem__text{color:white;}"]);var ge=n(63);function be({id:e}){const t=e;return Object(a.useMemo)((()=>{const e=`${t}-symbols`;return{runningProcessCube:`${e}-psRunningProcessCube`,runningTriggerCube:`${e}-psRunningTriggerCube`,terminatedProcessCube:`${e}-psTerminatedProcessCube`,terminatedTriggerCube:`${e}-psTerminatedTriggerCube`,loadingCube:`${e}-psLoadingCube`,errorCube:`${e}-psErrorCube`}}),[t])}const ye=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.loadingProcess",{defaultMessage:"Loading Process"}),ve=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.errorProcess",{defaultMessage:"Error Process"}),he=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.runningProcess",{defaultMessage:"Running Process"}),Ee=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.triggerProcess",{defaultMessage:"Trigger Process"}),xe=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedProcess",{defaultMessage:"Terminated Process"}),je=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.terminatedTriggerProcess",{defaultMessage:"Terminated Trigger Process"}),Oe=E.i18n.translate("xpack.securitySolution.resolver.symbolDefinitions.hoveredProcessBackground",{defaultMessage:"Hovered Process Background"}),Se=Object(a.memo)((({id:e,isDarkMode:t})=>{const n=be({id:e});return i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:n.errorCube,x1:"10.2372",y1:"9.49068",x2:"46.5307",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#6D6D6D"}),i.a.createElement("stop",{offset:"1",stopColor:"#B9B9B9"})),i.a.createElement("linearGradient",{id:n.runningProcessCube,x1:"-381.23556",y1:"264.73802",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0.00087",stopColor:"#006bb4"}),i.a.createElement("stop",{offset:"1",stopColor:"#54b399"})),i.a.createElement("linearGradient",{id:n.runningTriggerCube,x1:"-381.18643",y1:"264.68195",x2:"-380.48514",y2:"263.8816",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"})),t?i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:n.terminatedProcessCube,x1:"-381.23752",y1:"264.24026",x2:"-380.48514",y2:"263.3816",gradientTransform:"matrix(70.05178, 0, 0, -79.94771, 26724.01313, 21140.72096)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#4c82c3"}),i.a.createElement("stop",{offset:"1",stopColor:"#8bd1c7"})),i.a.createElement("linearGradient",{id:n.terminatedTriggerCube,x1:"-381.18658",y1:"264.68187",x2:"-380.48546",y2:"263.8817",gradientTransform:"matrix(70.05179, 0, 0, -79.94774, 26724.01618, 21181.09848)",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#dd0a73"}),i.a.createElement("stop",{offset:"1",stopColor:"#f66"}))):i.a.createElement(i.a.Fragment,null,i.a.createElement("linearGradient",{id:n.terminatedProcessCube,x1:"10.5206",y1:"9.49068",x2:"46.8141",y2:"45.7844",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{offset:"0",stopColor:"#2F6EB6"}),i.a.createElement("stop",{offset:"1",stopColor:"#00B4AC"})),i.a.createElement("linearGradient",{id:n.terminatedTriggerCube,x1:"15.4848",y1:"12.0468",x2:"43.1049",y2:"47.2331",gradientUnits:"userSpaceOnUse"},i.a.createElement("stop",{stopColor:"#DD0A73"}),i.a.createElement("stop",{offset:"1",stopColor:"#FF6666"}))))})),ke=Object(a.memo)((({id:e,isDarkMode:t})=>{const n=A({id:e}),a=be({id:e});return i.a.createElement(i.a.Fragment,null,i.a.createElement("symbol",{id:n.processNodeLabel,viewBox:"0 0 144 25",preserveAspectRatio:"xMidYMid meet"},i.a.createElement("rect",{x:"1",y:"1",width:"142",height:"23",fill:"inherit",strokeWidth:"0",paintOrder:"normal"})),i.a.createElement("symbol",{id:n.loadingCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,ye),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",fill:t?"#1d1e24":"white",stroke:"#98A2B3",strokeWidth:"2"})),i.a.createElement("symbol",{id:n.errorCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,ve),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.errorCube})`}),i.a.createElement("g",{opacity:"0.6"},i.a.createElement("path",{opacity:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${a.errorCube})`}),i.a.createElement("path",{opacity:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:n.runningProcessCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,he),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.runningProcessCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{id:n.runningTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,Ee),i.a.createElement("path",{d:"M87.52127,25.129a3.79536,3.79536,0,0,0-1.43184-1.47165L45.91025.57471a3.83652,3.83652,0,0,0-3.8205,0L1.91039,23.65739A3.86308,3.86308,0,0,0,0,26.95V73.11541a3.79835,3.79835,0,0,0,1.9104,3.2925L42.08975,99.49067a3.83691,3.83691,0,0,0,3.8205,0L86.08943,76.40791A3.79852,3.79852,0,0,0,88,73.11541V26.95A3.77641,3.77641,0,0,0,87.52127,25.129Z",transform:"translate(0.00001 0)",fill:`url(#${a.runningTriggerCube})`}),i.a.createElement("g",{opacity:"0.5"},i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M59.18326,40.255,44.93983,32.07224a1.7853,1.7853,0,0,0-1.77779,0L28.91861,40.255a1.77022,1.77022,0,0,0-.64527.64058L44.0088,49.96977,59.838,40.91219a1.77,1.77,0,0,0-.65469-.65719Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M28.27334,40.89555a1.75837,1.75837,0,0,0-.24347.89149V58.1525a1.76751,1.76751,0,0,0,.88874,1.532L43.162,67.86729a1.77951,1.77951,0,0,0,.84679.2316V49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff"}),i.a.createElement("path",{d:"M44.0088,68.0989a1.7772,1.7772,0,0,0,.931-.2316l14.24344-8.18274a1.76754,1.76754,0,0,0,.889-1.532V41.787a1.76037,1.76037,0,0,0-.23432-.87485L44.0088,49.96977Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("path",{d:"M.57144,24.91834a3.79909,3.79909,0,0,1,1.34825-1.32625L42.0989.50939a3.837,3.837,0,0,1,3.82081,0L86.09892,23.59206a3.79782,3.79782,0,0,1,1.4318,1.47169L44.00915,49.96733Z",transform:"translate(0.00001 0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.99984,50.03265V100a3.83392,3.83392,0,0,1-1.91024-.50933L1.91039,76.40791A3.79835,3.79835,0,0,1,0,73.11541V26.95a3.77423,3.77423,0,0,1,.56216-1.96625Z",transform:"translate(0.00001 0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}})),i.a.createElement("symbol",{viewBox:"0 0 88 100",id:n.terminatedProcessCube},i.a.createElement("title",null,xe),i.a.createElement("path",{d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:t?"#010101":"#fff"}),i.a.createElement("g",{opacity:"0.7"},i.a.createElement("path",{opacity:t?1:.6,d:"M87.52113,24.73352a3.7956,3.7956,0,0,0-1.43182-1.47166L45.91012.17918a3.8365,3.8365,0,0,0-3.82049,0L1.91029,23.26186A3.86312,3.86312,0,0,0-.00009,26.55445V72.7199a3.79834,3.79834,0,0,0,1.91041,3.29249L42.08963,99.09514a3.83689,3.83689,0,0,0,3.82049,0L86.08931,76.01239a3.79852,3.79852,0,0,0,1.91056-3.29249V26.55445A3.77643,3.77643,0,0,0,87.52113,24.73352Z",transform:"translate(0.00013 0.39551)",fill:`url(#${a.terminatedProcessCube})`}),i.a.createElement("path",{opacity:t?.3:.4,d:"M.57134,24.52282a3.79906,3.79906,0,0,1,1.34824-1.32625L42.09878.11387a3.83708,3.83708,0,0,1,3.8208,0L86.09877,23.19655a3.79771,3.79771,0,0,1,1.43182,1.47165L44.00909,49.57182Z",transform:"translate(0.00013 0.39551)",fill:"#fff",style:{isolation:"isolate"}}),i.a.createElement("path",{opacity:t?.2:.4,d:"M43.99972,49.63713V99.60449a3.83406,3.83406,0,0,1-1.91025-.50932L1.91029,76.01239A3.79835,3.79835,0,0,1-.00013,72.7199V26.55445A3.77431,3.77431,0,0,1,.562,24.5882Z",transform:"translate(0.00013 0.39551)",fill:"#353944",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{id:n.terminatedTriggerCube,viewBox:"0 0 88 100"},i.a.createElement("title",null,je),t&&i.a.createElement("path",{opacity:"1",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("g",{opacity:"0.6"},!t&&i.a.createElement("path",{opacity:"0.6",d:"M87.52143,25.06372a3.795,3.795,0,0,0-1.43129-1.47166L45.92578.50939a3.83384,3.83384,0,0,0-3.81907,0L1.94219,23.59206A3.8634,3.8634,0,0,0,.03252,26.88465V73.05008a3.7986,3.7986,0,0,0,1.90971,3.2925L42.10671,99.42532a3.83423,3.83423,0,0,0,3.81907,0L86.09014,76.34258A3.79881,3.79881,0,0,0,88,73.05008V26.88465A3.77748,3.77748,0,0,0,87.52143,25.06372Z",transform:"translate(0)",fill:"#010101"}),i.a.createElement("path",{opacity:t?1:.604,d:"M87.48893,25.129a3.79468,3.79468,0,0,0-1.4313-1.47165L45.89329.57472a3.83381,3.83381,0,0,0-3.81908,0L1.90969,23.65739A3.86331,3.86331,0,0,0,0,26.95V73.11541a3.79859,3.79859,0,0,0,1.90969,3.2925L42.07421,99.49067a3.83425,3.83425,0,0,0,3.81908,0L86.05763,76.40791a3.79876,3.79876,0,0,0,1.90985-3.2925V26.95A3.77746,3.77746,0,0,0,87.48893,25.129Z",transform:"translate(0)",fill:`url(#${a.terminatedTriggerCube})`}),i.a.createElement("path",{d:"M.57124,24.91834A3.79833,3.79833,0,0,1,1.919,23.59209L42.08335.50939a3.83441,3.83441,0,0,1,3.8194,0L86.06711,23.59206a3.7972,3.7972,0,0,1,1.43128,1.47169L43.99289,49.96733Z",transform:"translate(0)",fill:"#fff",opacity:"0.3",style:{isolation:"isolate"}}),i.a.createElement("path",{d:"M43.98359,50.03265V100a3.83139,3.83139,0,0,1-1.90953-.50933L1.90969,76.40791A3.79859,3.79859,0,0,1,0,73.11541V26.95a3.77523,3.77523,0,0,1,.56195-1.96625Z",transform:"translate(0)",fill:"#353944",opacity:"0.2",style:{isolation:"isolate"}}))),i.a.createElement("symbol",{viewBox:"0 -3 88 106",id:n.processCubeActiveBacking},i.a.createElement("title",null,Oe),i.a.createElement("path",{d:"m87.521 25.064a3.795 3.795 0 0 0-1.4313-1.4717l-40.164-23.083a3.8338 3.8338 0 0 0-3.8191 0l-40.165 23.083a3.8634 3.8634 0 0 0-1.9097 3.2926v46.165a3.7986 3.7986 0 0 0 1.9097 3.2925l40.164 23.083a3.8342 3.8342 0 0 0 3.8191 0l40.164-23.083a3.7988 3.7988 0 0 0 1.9099-3.2925v-46.165a3.7775 3.7775 0 0 0-0.47857-1.8209z",strokeWidth:"2"})))})),we=Object(a.memo)((({id:e})=>{const t=Object(ge.useUiSetting)("theme:darkMode");return i.a.createElement(Te,null,i.a.createElement("defs",null,i.a.createElement(Se,{id:e,isDarkMode:t}),i.a.createElement(ke,{id:e,isDarkMode:t})))})),Te=p()("svg").withConfig({displayName:"HiddenSVG",componentId:"sc-zh7upd-0"})(["position:absolute;left:100%;top:100%;width:0;height:0;"]);var Ie=n(23),Ce=n.n(Ie);const Me=Object(a.memo)((function({breadcrumbs:e}){const t=Object(a.useMemo)((()=>{const t=e.slice(-1).map((e=>(e["data-test-subj"]="resolver:breadcrumbs:last",e.truncate=!0,e)));return[...e.slice(0,-1),...t]}),[e]),{resolverBreadcrumbBackground:n,resolverEdgeText:r}=b();return i.a.createElement(i.a.Fragment,null,i.a.createElement(k,{background:n,text:r,breadcrumbs:t,truncate:!1}))})),_e=p.a.span.withConfig({displayName:"StyledSpinnerFlexItem",componentId:"sc-189s69h-0"})(["margin-right:5px;"]);function Ae({id:e}){const t=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedDetail.wait",{defaultMessage:"Loading Events..."}),n=E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),r=W(e,{panelView:"nodes"}),o=Object(a.useMemo)((()=>[{text:n,...r}]),[r,n]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Me,{breadcrumbs:o}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiFlexGroup,{alignItems:"center",direction:"row",gutterSize:"none"},i.a.createElement(_e,null,i.a.createElement(s.EuiLoadingSpinner,{size:"m"})),i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiText,{"data-test-subj":"resolver:panel:loading"},t))))}function Pe({event:e}){var t,n,a,r,s,l,u,c,d,p,m,f,g,b,y,v,h,E,x;return Object(se.i)(e)?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.legacyEventLabel",defaultMessage:"{ processName }",values:{processName:Object(se.l)(e)}}):null!==(t=e.network)&&void 0!==t&&t.forwarded_ip?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.networkEventLabel",defaultMessage:"{ networkDirection } { forwardedIP }",values:{forwardedIP:String(null===(p=e.network)||void 0===p?void 0:p.forwarded_ip),networkDirection:String(null===(m=e.network)||void 0===m?void 0:m.direction)}}):null!==(n=e.kibana)&&void 0!==n&&null!==(a=n.alert)&&void 0!==a&&null!==(r=a.rule)&&void 0!==r&&r.name?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.alertEventNameLabel",defaultMessage:"{ ruleName }",values:{ruleName:String(null===(f=e.kibana)||void 0===f||null===(g=f.alert)||void 0===g||null===(b=g.rule)||void 0===b?void 0:b.name)}}):null!==(s=e.file)&&void 0!==s&&s.path?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.fileEventLabel",defaultMessage:"{ filePath }",values:{filePath:String(null===(y=e.file)||void 0===y?void 0:y.path)}}):null!==(l=e.registry)&&void 0!==l&&l.path?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryPathLabel",defaultMessage:"{ registryPath }",values:{registryPath:String(null===(v=e.registry)||void 0===v?void 0:v.path)}}):null!==(u=e.registry)&&void 0!==u&&u.key?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.registryKeyLabel",defaultMessage:"{ registryKey }",values:{registryKey:String(null===(h=e.registry)||void 0===h?void 0:h.key)}}):null!==(c=e.dns)&&void 0!==c&&null!==(d=c.question)&&void 0!==d&&d.name?i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.dnsQuestionNameLabel",defaultMessage:"{ dnsQuestionName }",values:{dnsQuestionName:String(null===(E=e.dns)||void 0===E||null===(x=E.question)||void 0===x?void 0:x.name)}}):i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.resolver.eventDescription.entityIDLabel",defaultMessage:"{ entityID }",values:{entityID:Object(se.b)(e)}})}var Fe=n(78),De=n.n(Fe);const Ne=E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.invaliddate",{defaultMessage:"Invalid Date"}),Re=new Intl.DateTimeFormat(E.i18n.getLocale(),{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});function Le(e){const t=Object(ge.useUiSetting)("dateFormat"),n=Object(ge.useUiSetting)("dateFormat:tz"),a="Browser"===n?De.a.tz.guess():n;if(!e)return;const i=new Date(e);return i&&Number.isFinite(i.getTime())?t?De.a.tz(i,a).format(t):Re.format(i):Ne}var ze=n(325);const Be=Object(a.memo)((function({id:e,nodeID:t,eventCategory:n}){const a=Object(r.useSelector)((n=>c.g(n.analyzer[e])(t))),l=Object(r.useSelector)((t=>c.p(t.analyzer[e]))),u=Object(r.useSelector)((t=>c.h(t.analyzer[e])));return i.a.createElement(i.a.Fragment,null,l?i.a.createElement(ne,{hasBorder:!0},i.a.createElement(Ae,{id:e})):i.a.createElement(ne,{hasBorder:!0,"data-test-subj":"resolver:panel:events-in-category"},u||!a?i.a.createElement(s.EuiCallOut,{title:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorPrimary",{defaultMessage:"Unable to load events."}),color:"danger",iconType:"warning","data-test-subj":"resolver:nodeEventsInCategory:error"},i.a.createElement("p",null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.errorSecondary",defaultMessage:"An error occurred when fetching the events."}))):i.a.createElement(i.a.Fragment,null,i.a.createElement(Ve,{id:e,nodeName:a.name,eventCategory:n,nodeID:t}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement($e,{id:e,eventCategory:n,nodeID:t}))))})),qe=Object(a.memo)((function({id:e,event:t,nodeID:n,eventCategory:a}){const r=Object(ze.a)(t),l=se.g(r),u=se.e(r),c=se.p(r),d=Le(l)||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),p=W(e,{panelView:"eventDetail",panelParameters:{nodeID:n,eventCategory:a,eventID:u,eventTimestamp:String(l),winlogRecordID:String(c)}});return i.a.createElement(i.a.Fragment,null,i.a.createElement(s.EuiText,null,i.a.createElement(M,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:se.d(r).join(", "),eventType:se.h(r).join(", ")},defaultMessage:"{category} {eventType}"})),i.a.createElement(_,{dateTime:d},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:d},defaultMessage:"@ {date}"}))),i.a.createElement(s.EuiSpacer,{size:"xs"}),i.a.createElement(s.EuiButtonEmpty,Ce()({"data-test-subj":"resolver:panel:node-events-in-category:event-link"},p),i.a.createElement(Pe,{event:r})))})),$e=Object(a.memo)((function({id:e,eventCategory:t,nodeID:n}){const l=Object(r.useSelector)((t=>c.w(t.analyzer[e]))),u=Object(r.useDispatch)(),d=Object(a.useCallback)((()=>{u(Object(le.userRequestedAdditionalRelatedEvents)({id:e}))}),[u,e]),p=Object(r.useSelector)((t=>c.o(t.analyzer[e]))),m=Object(r.useSelector)((t=>c.r(t.analyzer[e])));return i.a.createElement(i.a.Fragment,null,l.map(((r,o)=>i.a.createElement(a.Fragment,{key:o},i.a.createElement(qe,{id:e,nodeID:n,eventCategory:t,event:r}),o===l.length-1?null:i.a.createElement(s.EuiHorizontalRule,{margin:"m"})))),m&&i.a.createElement(s.EuiFlexItem,{grow:!1},i.a.createElement(s.EuiButton,{color:"primary",size:"s",fill:!0,onClick:d,isLoading:p,"data-test-subj":"resolver:nodeEventsInCategory:loadMore"},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.nodeEventsByType.loadMore",defaultMessage:"Load More Data"}))))})),Ve=Object(a.memo)((function({id:e,nodeName:t,eventCategory:n,nodeID:a}){const s=Object(r.useSelector)((t=>c.K(t.analyzer[e])(a))),l=Object(r.useSelector)((t=>c.B(t.analyzer[e])(a,n))),u=W(e,{panelView:"nodes"}),d=W(e,{panelView:"nodeDetail",panelParameters:{nodeID:a}}),p=W(e,{panelView:"nodeEvents",panelParameters:{nodeID:a}});return i.a.createElement(Me,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventListByType.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-events-in-category:breadcrumbs:node-list-link",...u},{text:t,...d},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.numberOfEvents",values:{totalCount:s},defaultMessage:"{totalCount} Events"}),...p},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventList.countByCategory",values:{count:l,category:n},defaultMessage:"{count} {category}"})}]})}));function Ue({id:e,nodeID:t}){const n=Object(r.useSelector)((n=>oe.a(c.u(n.analyzer[e])(t)))),a=Object(r.useSelector)((n=>c.x(n.analyzer[e])(t)));return void 0===n||void 0===a?i.a.createElement(ne,{hasBorder:!0},i.a.createElement(Ae,{id:e})):i.a.createElement(ne,{hasBorder:!0},i.a.createElement(Ze,{id:e,nodeName:se.l(n),nodeID:t,totalEventCount:a.total}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(He,{id:e,nodeID:t,relatedStats:a}))}const He=Object(a.memo)((function({id:e,nodeID:t,relatedStats:n}){const r=Object(a.useMemo)((()=>Object.entries(n.byCategory).map((([e,t])=>({eventType:e,count:t})))),[n.byCategory]),o=Object(a.useMemo)((()=>[{field:"count",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.count",{defaultMessage:"Count"}),"data-test-subj":"resolver:panel:node-events:event-type-count",width:"20%",sortable:!0},{field:"eventType",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.eventType",{defaultMessage:"Event Type"}),width:"80%",sortable:!0,render:n=>i.a.createElement(Ge,{id:e,nodeID:t,eventType:n},n)}]),[t,e]);return i.a.createElement(s.EuiInMemoryTable,{items:r,columns:o,sorting:!0})})),Ze=Object(a.memo)((function({id:e,nodeID:t,nodeName:n,totalEventCount:a}){return i.a.createElement(Me,{breadcrumbs:[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processEventCounts.events",{defaultMessage:"Events"}),...W(e,{panelView:"nodes"})},{text:n,...W(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}})},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedCounts.numberOfEventsInCrumb",values:{totalCount:a},defaultMessage:"{totalCount} Events"}),...W(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}})}]})})),Ge=Object(a.memo)((({id:e,nodeID:t,eventType:n,children:a})=>{const r=W(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:n}});return i.a.createElement(s.EuiButtonEmpty,Ce()({"data-test-subj":"resolver:panel:node-events:event-type-link"},r),a)})),Qe=p.a.div.withConfig({displayName:"StyledCopyableField",componentId:"sc-1sthks-0"})(["border-radius:3px;padding:4px;transition:background 0.2s ease;",":hover &{background-color:",";&:hover{background-color:",";color:#fff;}}"],ne,(e=>e.backgroundColor),(e=>e.activeBackgroundColor)),We=Object(a.memo)((({textToCopy:e,content:t})=>{var n;const{linkColor:r,copyableFieldBackground:o}=b(),[l,u]=Object(a.useState)(!1),c=null===(n=Object(ge.useKibana)().services.notifications)||void 0===n?void 0:n.toasts,d=()=>u(!0),p=()=>u(!1),m=Object(a.useMemo)((()=>i.a.createElement(Qe,{backgroundColor:o,"data-test-subj":"resolver:panel:copyable-field-hover-area",activeBackgroundColor:r,onMouseEnter:d},t)),[t,o,r]),{writeTextToClipboard:f}=Object(a.useContext)(j),g=Object(a.useCallback)((async()=>{try{await f(e)}catch(e){c&&c.addError(e,{title:E.i18n.translate("xpack.securitySolution.resolver.panel.copyFailureTitle",{defaultMessage:"Copy Failure"})})}}),[e,c,f]);return i.a.createElement("div",{onMouseLeave:p},i.a.createElement(s.EuiPopover,{anchorPosition:"downCenter",button:m,closePopover:p,hasArrow:!1,isOpen:l,panelPaddingSize:"s"},i.a.createElement(s.EuiToolTip,{content:E.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"})},i.a.createElement(s.EuiButtonIcon,{"aria-label":E.i18n.translate("xpack.securitySolution.resolver.panel.copyToClipboard",{defaultMessage:"Copy to Clipboard"}),color:"text","data-test-subj":"resolver:panel:clipboard",iconType:"copyClipboard",onClick:g}))))}));var Ke=n(1094);const Je=Object(a.memo)((function({id:e,translatedErrorMessage:t}){const n=W(e,{panelView:"nodes"}),r=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.events",{defaultMessage:"Events"}),...n},{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.error",{defaultMessage:"Error"})}]),[n]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Me,{breadcrumbs:r}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiText,{textAlign:"center","data-test-subj":"resolver:panel:error"},t),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiButtonEmpty,n,E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.error.goBack",{defaultMessage:"View all processes"})))})),Ye=p()(D).withConfig({displayName:"StyledCubeForProcess",componentId:"sc-f4b2od-0"})(["position:relative;"]),Xe=["fit-content(10em)","auto"],et=E.i18n.translate("xpack.securitySolution.resolver.panel.nodeDetail.Error",{defaultMessage:"Node details were unable to be retrieved"}),tt=Object(a.memo)((function({id:e,nodeID:t}){const n=Object(r.useSelector)((n=>oe.a(c.u(n.analyzer[e])(t))));return"loading"===Object(r.useSelector)((n=>c.v(n.analyzer[e])(t)))?i.a.createElement(ne,{hasBorder:!0},i.a.createElement(Ae,{id:e})):n?i.a.createElement(ne,{hasBorder:!0,"data-test-subj":"resolver:panel:node-detail"},i.a.createElement(nt,{id:e,nodeID:t,processEvent:n})):i.a.createElement(ne,{hasBorder:!0},i.a.createElement(Je,{id:e,translatedErrorMessage:et}))})),nt=Object(a.memo)((function({id:e,processEvent:t,nodeID:n}){const l=se.l(t),u=Object(r.useSelector)((t=>c.v(t.analyzer[e])(n))),d=Object(r.useSelector)((t=>c.C(t.analyzer[e])(n))),p=Le(se.g(t)),m=Object(a.useMemo)((()=>{const e={title:"@timestamp",description:p},n={title:"process.executable",description:Object(Ke.d)(t)},a={title:"process.pid",description:Object(Ke.c)(t)},r={title:"user.name",description:se.o(t)};return[e,n,a,{title:"process.entity_id",description:se.c(t)},r,{title:"user.domain",description:se.n(t)},{title:"process.parent.pid",description:se.k(t)},{title:"process.hash.md5",description:se.j(t)},{title:"process.args",description:se.a(t)}].reduce(((e,t)=>Array.isArray(t.description)?[...e,...t.description.map((e=>({title:t.title,description:e})))]:[...e,t]),[]).filter((e=>void 0!==e.description)).map((e=>({...e,description:i.a.createElement(We,{textToCopy:String(e.description),content:i.a.createElement(R,null,String(e.description))})})))}),[p,t]),f=W(e,{panelView:"nodes"}),g=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.processDescList.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:node-detail:breadcrumbs:node-list-link",...f},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.detailsForProcessName",values:{processName:l},defaultMessage:"Details for: {processName}"})}]),[l,f]),{descriptionText:b}=P(e,u,!1),y=W(e,{panelView:"nodeEvents",panelParameters:{nodeID:n}}),v=Object(a.useMemo)((()=>Object(s.htmlIdGenerator)("resolverTable")()),[]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Me,{breadcrumbs:g}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiTitle,{size:"xs"},i.a.createElement(S,{"aria-describedby":v},i.a.createElement(Ye,{id:e,"data-test-subj":"resolver:node-detail:title-icon",state:u}),i.a.createElement("span",{"data-test-subj":"resolver:node-detail:title"},i.a.createElement(R,null,l)))),i.a.createElement(s.EuiText,null,i.a.createElement(s.EuiTextColor,{color:"subdued"},i.a.createElement("span",{id:v},b))),i.a.createElement(s.EuiSpacer,{size:"s"}),i.a.createElement(s.EuiLink,Ce()({},y,{"data-test-subj":"resolver:node-detail:node-events-link"}),i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.processDescList.numberOfEvents",values:{relatedEventTotal:d},defaultMessage:"{relatedEventTotal} Events"})),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(O,{"data-test-subj":"resolver:node-detail",type:"column",columnWidths:Xe,align:"left",titleProps:{"data-test-subj":"resolver:node-detail:entry-title",className:"desc-title"},descriptionProps:{"data-test-subj":"resolver:node-detail:entry-description"},compressed:!0,listItems:m}))})),at=i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.eitherLineageLimitExceeded",defaultMessage:"Some process events in the visualization and event list below could not be displayed because the data limit has been reached."}),it=i.a.memo((function({numberOfEntries:e}){return i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.relatedEventLimitTitle",defaultMessage:"This list includes {numberOfEntries} process events.",values:{numberOfEntries:e}})})),rt=i.a.memo((function({numberDisplayed:e}){return i.a.createElement(ie,{size:"s",title:i.a.createElement(it,{numberOfEntries:e})},i.a.createElement("p",null,at))})),st=Object(a.memo)((({id:e})=>{const t=Object(a.useMemo)((()=>[{field:"name",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.processNameTitle",{defaultMessage:"Process Name"}),sortable:!0,truncateText:!0,render:(t,n)=>i.a.createElement(ot,{id:e,name:t,nodeID:n.nodeID})},{field:"timestamp",name:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.timestampTitle",{defaultMessage:"Timestamp"}),dataType:"date",sortable:!0,render:e=>i.a.createElement(lt,{eventDate:e})}]),[e]),n=Object(r.useSelector)(Object(a.useCallback)((t=>{const{processNodePositions:n}=c.s(t.analyzer[e]),a=[];for(const e of n.keys()){const t=re.c(e),n=re.b(e);void 0!==n&&a.push({name:t,timestamp:re.e(e),nodeID:n})}return a}),[e])),o=n.length,l=Object(a.useMemo)((()=>[{text:E.i18n.translate("xpack.securitySolution.resolver.panel.nodeList.title",{defaultMessage:"All Process Events"})}]),[]),u=Object(r.useSelector)((t=>c.k(t.analyzer[e]))),d=Object(r.useSelector)((t=>c.j(t.analyzer[e]))),p=Object(r.useSelector)((t=>c.l(t.analyzer[e]))),m=!0===u||!0===d||!0===p,f=Object(a.useMemo)((()=>({"data-test-subj":"resolver:node-list:item"})),[]);return i.a.createElement(ne,{hasBorder:!0},i.a.createElement(Me,{breadcrumbs:l}),m&&i.a.createElement(rt,{numberDisplayed:o}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiInMemoryTable,{rowProps:f,"data-test-subj":"resolver:node-list",items:n,columns:t,sorting:!0}))}));function ot({id:e,name:t,nodeID:n}){const o=Object(r.useSelector)((t=>c.y(t.analyzer[e])===n)),l=Object(r.useSelector)((t=>c.v(t.analyzer[e])(n))),{descriptionText:u}=b(),d=W(e,{panelView:"nodeDetail",panelParameters:{nodeID:n}}),p=Object(r.useDispatch)(),{timestamp:m}=Object(a.useContext)(j),f=Object(a.useCallback)((t=>{d.onClick(t),p(Object(J.userSelectedResolverNode)({id:e,nodeID:n,time:m()}))}),[m,d,p,n,e]);return i.a.createElement(s.EuiButtonEmpty,{onClick:f,href:d.href,"data-test-subj":"resolver:node-list:node-link","data-test-node-id":n},void 0===t?i.a.createElement(s.EuiBadge,{color:"warning"},E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.table.row.valueMissingDescription",{defaultMessage:"Value is missing"})):i.a.createElement(w,null,i.a.createElement(D,{id:e,state:l,isOrigin:o,"data-test-subj":"resolver:node-list:node-link:icon"}),i.a.createElement(C,null,o&&i.a.createElement(T,{color:u,"data-test-subj":"resolver:node-list:node-link:analyzed-event"},E.i18n.translate("xpack.securitySolution.resolver.panel.table.row.analyzedEvent",{defaultMessage:"ANALYZED EVENT"})),i.a.createElement(I,{"data-test-subj":"resolver:node-list:node-link:title"},t))))}const lt=Object(a.memo)((({eventDate:e})=>{const t=Le(e);return t?i.a.createElement(We,{textToCopy:t,content:t}):i.a.createElement("span",null,"â€”")}));function ut(e){const t=[{path:[],value:e}],n=[];for(;t.length;){const e=t.shift();if(void 0===e)throw new Error;const{path:a,value:i}=e;Array.isArray(i)?t.push(...i.map((e=>({path:[...a],value:e})))):"object"==typeof i&&null!==i?t.push(...Object.keys(i).map((e=>({path:[...a,e],value:i[e]})))):null!=i&&n.push([a,i])}return n}const ct=E.i18n.translate("xpack.securitySolution.resolver.panel.eventDetail.requestError",{defaultMessage:"Event details were unable to be retrieved"}),dt=Object(a.memo)((function({id:e,nodeID:t,eventCategory:n}){const a=Object(r.useSelector)((t=>c.n(t.analyzer[e]))),s=Object(r.useSelector)((t=>c.q(t.analyzer[e]))),o=Object(r.useSelector)((n=>oe.a(c.u(n.analyzer[e])(t)))),l=Object(r.useSelector)((n=>c.v(n.analyzer[e])(t))),u=a||s||"loading"===l,d=Object(r.useSelector)((t=>c.d(t.analyzer[e])));return u?i.a.createElement(ne,{hasBorder:!0},i.a.createElement(Ae,{id:e})):d?i.a.createElement(pt,{id:e,nodeID:t,event:d,processEvent:o,eventType:n}):i.a.createElement(ne,{hasBorder:!0},i.a.createElement(Je,{id:e,translatedErrorMessage:ct}))})),pt=Object(a.memo)((function({id:e,nodeID:t,event:n,eventType:a,processEvent:r}){const l=Le(se.m(n))||E.i18n.translate("xpack.securitySolution.enpdoint.resolver.panelutils.noTimestampRetrieved",{defaultMessage:"No timestamp retrieved"}),u=r?se.l(r):null;return i.a.createElement(ne,{hasBorder:!0,"data-test-subj":"resolver:panel:event-detail"},i.a.createElement(ft,{id:e,nodeID:t,nodeName:u,event:n,breadcrumbEventCategory:a}),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(s.EuiText,{size:"s"},i.a.createElement(M,null,i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.categoryAndType",values:{category:a,eventType:String(se.h(n))},defaultMessage:"{category} {eventType}"})),i.a.createElement(_,{dateTime:l},i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.atTime",values:{date:l},defaultMessage:"@ {date}"}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(gt,null,i.a.createElement(R,null,i.a.createElement(Pe,{event:n}))),i.a.createElement(s.EuiSpacer,{size:"l"}),i.a.createElement(mt,{event:n}))}));function mt({event:e}){const t=Object(a.useMemo)((()=>{const t=[],n=Object(ze.a)(e);for(const[e,a]of Object.entries(n)){if("agent"===e||"ecs"===e||"@timestamp"===e||!a)continue;const n={namespace:i.a.createElement(R,null,e),descriptions:ut(a).map((([t,n])=>{const a=[e,...t].join(".");return{title:i.a.createElement(R,null,a),description:i.a.createElement(We,{textToCopy:String(n),content:i.a.createElement(R,null,String(n))})}}))};t.push(n)}return t}),[e]);return i.a.createElement(i.a.Fragment,null,t.map((({namespace:e,descriptions:n},r)=>i.a.createElement(a.Fragment,{key:r},0===r?null:i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiTitle,{size:"xxxs"},i.a.createElement(s.EuiTextColor,{color:"subdued"},i.a.createElement(bt,null,e,i.a.createElement(yt,null)))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(O,{type:"column",columnWidths:["fit-content(8em)","auto"],align:"left",titleProps:{className:"desc-title","data-test-subj":"resolver:panel:event-detail:event-field-title"},compressed:!0,listItems:n}),r===t.length-1?null:i.a.createElement(s.EuiSpacer,{size:"m"})))))}function ft({id:e,nodeID:t,nodeName:n,event:s,breadcrumbEventCategory:l}){const u=Object(r.useSelector)((n=>c.B(n.analyzer[e])(t,l))),d=Object(r.useSelector)((n=>c.C(n.analyzer[e])(t))),p=W(e,{panelView:"nodes"}),m=W(e,{panelView:"nodeDetail",panelParameters:{nodeID:t}}),f=W(e,{panelView:"nodeEvents",panelParameters:{nodeID:t}}),g=W(e,{panelView:"nodeEventsInCategory",panelParameters:{nodeID:t,eventCategory:l}}),b=Object(a.useMemo)((()=>{const e=[{text:E.i18n.translate("xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.events",{defaultMessage:"Events"}),"data-test-subj":"resolver:event-detail:breadcrumbs:node-list-link",...p},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.numberOfEvents",values:{totalCount:d},defaultMessage:"{totalCount} Events"}),...f},{text:i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.panel.relatedEventDetail.countByCategory",values:{count:u,category:l},defaultMessage:"{count} {category}"}),...g},{text:i.a.createElement(Pe,{event:s})}];return n&&e.splice(1,0,{text:n,...m}),e}),[l,u,s,m,f,n,d,p,g]);return i.a.createElement(Me,{breadcrumbs:b})}const gt=Object(a.memo)(p()(s.EuiText).withConfig({displayName:"StyledDescriptiveName",componentId:"sc-1monurs-0"})(["padding-right:1em;overflow-wrap:break-word;"])),bt=Object(a.memo)(p()("h3").withConfig({displayName:"StyledFlexTitle",componentId:"sc-1monurs-1"})(["align-items:center;display:flex;flex-flow:row;font-size:1.2em;"])),yt=Object(a.memo)((()=>i.a.createElement(s.EuiHorizontalRule,{margin:"none",size:"half"}))),vt=Object(a.memo)((function({id:e}){const t=Object(r.useSelector)((t=>c.z(t.analyzer[e])));return"nodeDetail"===t.panelView?i.a.createElement(tt,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEvents"===t.panelView?i.a.createElement(Ue,{id:e,nodeID:t.panelParameters.nodeID}):"nodeEventsInCategory"===t.panelView?i.a.createElement(Be,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):"eventDetail"===t.panelView?i.a.createElement(dt,{id:e,nodeID:t.panelParameters.nodeID,eventCategory:t.panelParameters.eventCategory}):i.a.createElement(st,{id:e})}));var ht=n(1131);const Et=p()(s.EuiCodeBlock).withConfig({displayName:"StyledEuiCodeBlock",componentId:"sc-84kags-0"})(["align-self:flex-start;display:inline-block;"]),xt=p()(s.EuiFlexGroup).withConfig({displayName:"StyledEuiFlexGroup",componentId:"sc-84kags-1"})(["max-width:600px;margin:60px auto 0;"]),jt=()=>i.a.createElement(xt,{"data-test-subj":"resolver:no-process-events",direction:"column"},i.a.createElement(s.EuiTitle,null,i.a.createElement("h4",null,E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.title",{defaultMessage:"No Process Events Found"}))),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.timeRange",{defaultMessage:"\n            The Analyze Event tool creates graphs based on process events.\n            If the analyzed event does not have an associated process in the current time range,\n            or stored in Elasticsearch within any time range, a graph will not be created.\n            You can check for associated processes by expanding your time range.\n          "})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.dataView",{defaultMessage:'In case you selected a different data view,\n          make sure your data view contains all of the indices that are stored in the source event at "{field}".',values:{field:"kibana.alert.rule.parameters.index"}})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(s.EuiText,{size:"s"},E.i18n.translate("xpack.securitySolution.resolver.noProcessEvents.eventCategory",{defaultMessage:"You may also add the below to your timeline query to check for process events.\n            If none are listed, a graph cannot be created from events found in that query."})),i.a.createElement(s.EuiSpacer,{size:"m"}),i.a.createElement(Et,{language:"html",paddingSize:"s",isCopyable:!0},'event.category: "process"'));var Ot=n(117);const St=i.a.memo(i.a.forwardRef((function({className:e,databaseDocumentID:t,resolverComponentInstanceID:n,indices:d,shouldUpdate:p,filters:m},f){!function(e){const t=Object(a.useRef)();t.current=Object(l.useLocation)().search;const n=Object(l.useHistory)(),i=Object(u.a)(e);Object(a.useEffect)((()=>{const e=i;return()=>{const a=new URLSearchParams(t.current);a.delete(e);const i={search:a.toString()};n.replace(i)}}),[i,n])}(n),function({databaseDocumentID:e,resolverComponentInstanceID:t,indices:n,filters:i,shouldUpdate:s}){const o=Object(r.useDispatch)(),u=Object(l.useLocation)().search;Object(a.useLayoutEffect)((()=>{o(Object(J.appReceivedNewExternalProperties)({id:t,databaseDocumentID:e,resolverComponentInstanceID:t,locationSearch:u,indices:n,shouldUpdate:s,filters:i}))}),[o,e,t,u,n,s,i])}({databaseDocumentID:t,resolverComponentInstanceID:n,indices:d,shouldUpdate:p,filters:m}),function({id:e}){const{addSuccess:t}=Object(Ot.a)(),{from:n,to:i}=Object(r.useSelector)((t=>{const n=c.e(t.analyzer[e]);return{from:null!=n&&n.from?n.from:void 0,to:null!=n&&n.to?n.to:void 0}})),s=Le(n),o=Le(i),l=Object(a.useMemo)((()=>E.i18n.translate("xpack.securitySolution.resolver.unboundedRequest.toast",{defaultMessage:"No results found in the selected time, expanded to {from} - {to}.",values:{from:s,to:o}})),[s,o]);Object(a.useEffect)((()=>{(n||i)&&t(l)}),[t,l,n,i])}({id:n}),function({id:e}){const t=Object(r.useDispatch)(),n=e,i=Object(l.useLocation)().search,s=Object(a.useContext)(j),o=Object(r.useSelector)((t=>c.H(t.analyzer[e]))),u=Object(r.useSelector)((t=>c.g(t.analyzer[e]))),d=Object(ht.a)({locationSearch:i,resolverComponentInstanceID:n});let p;"nodes"!==d.panelView&&(p=d.panelParameters.nodeID),Object(a.useEffect)((()=>{p&&u(p)&&p!==o&&t(Object(J.userSelectedResolverNode)({id:e,nodeID:p,time:s.timestamp()}))}),[d.panelView,p,t,u,o,s,e])}({id:n});const{timestamp:g}=Object(a.useContext)(j),y=g(),{processNodePositions:v,connectingEdgeLineSegments:x}=Object(r.useSelector)((e=>c.O(e.analyzer[n])(y))),{projectionMatrix:O,ref:S,onMouseDown:k}=function({id:e}){const t=Object(r.useDispatch)(),n=Object(a.useContext)(j),[i,s]=Object(a.useState)(null),o=Object(r.useSelector)(Object(a.useCallback)((t=>c.A(t.analyzer[e])),[e])),l=Object(a.useRef)(),[u,d]=Object(a.useState)(o(n.timestamp())),p=Object(r.useSelector)((t=>c.N(t.analyzer[e]))),m=Object(r.useSelector)((t=>c.m(t.analyzer[e]))),[f,g]=function(){const{getBoundingClientRect:e}=Object(a.useContext)(j),[t,n]=Object(a.useState)(null),{ResizeObserver:i,requestAnimationFrame:r}=Object(a.useContext)(j),[s,o]=Object(a.useState)(null),l=Object(a.useCallback)((e=>{o(e)}),[]);return Object(a.useEffect)((()=>{null!==s&&n(e(s))}),[s,e]),Object(a.useEffect)((()=>{let t=window.scrollX,a=window.scrollY;const i=()=>{r((()=>{const i=window.scrollX,r=window.scrollY;null===s||t===i&&a===r||n(e(s)),t=i,a=r}))};return window.addEventListener("scroll",i,{passive:!0}),()=>{window.removeEventListener("scroll",i)}}),[s,r,e]),Object(a.useEffect)((()=>{if(null!==s){const t=new i((t=>{null!==s&&s===t[0].target&&n(e(s))}));return t.observe(s),()=>{t.disconnect()}}}),[i,s,e]),[t,l]}(),b=Object(a.useCallback)((e=>null===f?null:[e.clientX-f.x,e.clientY-f.y]),[f]),y=Object(a.useCallback)((a=>{const i=b(a);null!==i&&t(Object(L.userStartedPanning)({id:e,screenCoordinates:i,time:n.timestamp()}))}),[t,b,n,e]),v=Object(a.useCallback)((a=>{const i=b(a);i&&t(Object(L.userMovedPointer)({id:e,screenCoordinates:i,time:n.timestamp()}))}),[t,b,n,e]),h=Object(a.useCallback)((()=>{p&&t(Object(L.userStoppedPanning)({id:e,time:n.timestamp()}))}),[t,n,p,e]),E=Object(a.useCallback)((a=>{null!==f&&a.ctrlKey&&0!==a.deltaY&&0===a.deltaMode&&(a.preventDefault(),t(Object(L.userZoomed)({id:e,zoomChange:a.deltaY/-f.height,time:n.timestamp()})))}),[f,t,n,e]),x=Object(a.useCallback)((e=>{s(e),g(e)}),[g]);return Object(a.useEffect)((()=>(window.addEventListener("mouseup",h,{passive:!0}),()=>{window.removeEventListener("mouseup",h)})),[h]),Object(a.useEffect)((()=>(window.addEventListener("mousemove",v,{passive:!0}),()=>{window.removeEventListener("mousemove",v)})),[v]),Object(a.useEffect)((()=>{if(null!==i)return i.addEventListener("wheel",E),()=>{i.removeEventListener("wheel",E)}}),[i,E]),Object(a.useLayoutEffect)((()=>{l.current=o}),[o]),Object(a.useLayoutEffect)((()=>{d(o(n.timestamp()))}),[o,n]),Object(a.useLayoutEffect)((()=>{const e=n.timestamp();if(m(e)){let e=null;const t=()=>{const a=n.timestamp();void 0!==l.current&&d(l.current(a)),e=m(a)?n.requestAnimationFrame(t):null};return e=n.requestAnimationFrame(t),()=>{null!==e&&n.cancelAnimationFrame(e)}}}),[m,n]),Object(a.useEffect)((()=>{null!==f&&t(Object(L.userSetRasterSize)({id:e,dimensions:[f.width,f.height]}))}),[t,f,e]),{ref:x,onMouseDown:y,projectionMatrix:u}}({id:n}),w=Object(a.useCallback)((e=>{S(e),"function"==typeof f?f(e):null!==f&&(f.current=e)}),[S,f]),T=Object(r.useSelector)((e=>c.q(e.analyzer[n]))),I=Object(r.useSelector)((e=>c.i(e.analyzer[n]))),C=Object(r.useSelector)((e=>c.a(e.analyzer[n]))),M=Object(r.useSelector)((e=>c.E(e.analyzer[n]))),_=b();return i.a.createElement(te,{className:e,backgroundColor:_.resolverBackground},T?i.a.createElement("div",{"data-test-subj":"resolver:graph:loading",className:"loading-container"},i.a.createElement(s.EuiLoadingSpinner,{size:"xl"})):I?i.a.createElement("div",{"data-test-subj":"resolver:graph:error",className:"loading-container"},i.a.createElement("div",null," ",i.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.endpoint.resolver.loadingError",defaultMessage:"Error loading data."}))):M?i.a.createElement(i.a.Fragment,null,i.a.createElement(ae,{"data-test-subj":"resolver:graph",className:"resolver-graph kbn-resetFocusState",onMouseDown:k,ref:w,role:"tree",tabIndex:0,"aria-activedescendant":C||void 0},x.map((({points:[e,t],metadata:n})=>i.a.createElement(h,{edgeLineMetadata:n,key:n.reactKey,startPosition:e,endPosition:t,projectionMatrix:O}))),[...v].map((([e,t])=>{const a=re.b(e);if(void 0===a)throw new Error("Tried to render a node without an ID");return i.a.createElement(fe,{id:n,key:a,nodeID:a,position:t,projectionMatrix:O,node:e,timeAtRender:y})}))),i.a.createElement(vt,{id:n})):i.a.createElement(jt,null),i.a.createElement(Z,{id:n}),i.a.createElement(we,{id:n}))})))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return J})),n.d(t,"b",(function(){return Y}));var a=n(2),i=n.n(a),r=n(17),s=n(47),o=n(183),l=n(277),u=n(180),c=n(142),d=n(5);const p=({tooltip:e,anchorPosition:t="top",children:n})=>i.a.createElement(r.EuiToolTip,{content:e,position:t},n);var m=n(567),f=n(50),g=n(9),b=n(110),y=n(19);const v=[5,10,20],h={pageIndex:0,pageSize:v[0]},E=(e,t)=>t,x={sort:{field:"@timestamp",direction:"desc"},enableAllColumns:!0},j=(e,t)=>({...e,sort:t}),O=e=>{const{setPagination:t,pagination:n,pageSizeOptions:i}=(()=>{const[e,t]=Object(a.useReducer)(E,h);return Object(a.useMemo)((()=>({pageSizeOptions:[...v],pagination:e,setPagination:t})),[e])})(),{sorting:r,sortConfig:s,setSorting:o}=(()=>{const[e,t]=Object(a.useReducer)(j,x),n=Object(a.useMemo)((()=>[{[e.sort.field]:e.sort.direction}]),[e.sort.direction,e.sort.field]);return{sorting:e,setSorting:t,sortConfig:n}})(),{data:l,totalItemCount:u,loading:c,error:d}=(({alertIds:e,from:t,size:n,sort:i})=>{const{services:{data:r}}=Object(b.i)(),s=Object(a.useMemo)((()=>{return e=r.search,async({signal:t,alertIds:n,from:a,size:i,sort:r})=>new Promise(((s,o)=>{const l=e.search({params:{body:{query:{ids:{values:n}},from:a,size:i,sort:r,fields:["*"],_source:!1}}},{abortSignal:t}).subscribe({next:e=>{Object(y.isRunningResponse)(e)||(l.unsubscribe(),s(e.rawResponse))},error:e=>{l.unsubscribe(),o(new Error("Error while loading alerts"))}})}));var e}),[r.search]),{data:o,isLoading:l,isError:u}=Object(f.useQuery)(["useFetchAlerts",e,t,n,i],(async({signal:a})=>s({signal:a,alertIds:e,from:t,size:n,sort:i})),{keepPreviousData:!0});return Object(a.useMemo)((()=>{var e,t;const n=null==o||null===(e=o.hits)||void 0===e?void 0:e.total;return{loading:l,error:u,data:(null==o||null===(t=o.hits)||void 0===t?void 0:t.hits)||[],totalItemCount:Object(g.isNumber)(n)?n:0}}),[o,u,l])})({alertIds:e,from:n.pageIndex*n.pageSize,size:n.pageSize,sort:s});return{paginationConfig:Object(a.useMemo)((()=>({...n,pageSizeOptions:i,totalItemCount:u})),[i,n,u]),setPagination:t,setSorting:o,loading:c,data:l,sorting:r,error:d}};var S=n(216),k=n(379),w=n(197),T=n(670);const I=[{field:"@timestamp",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.timestampColumnLabel",defaultMessage:"Timestamp"}),truncateText:!0,dataType:"date",render:e=>{const t=Object(r.formatDate)(e,"MMM D, YYYY @ HH:mm:ss.SSS");return i.a.createElement(p,{tooltip:t},i.a.createElement("span",null,t))}},{field:c.G,name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ruleColumnLabel",defaultMessage:"Rule"}),truncateText:!0,render:e=>i.a.createElement(p,{tooltip:e},i.a.createElement("span",null,e))},{field:c.s,name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.reasonColumnLabel",defaultMessage:"Reason"}),truncateText:!0,render:e=>i.a.createElement(p,{tooltip:e,anchorPosition:"left"},i.a.createElement("span",null,e))},{field:"kibana.alert.severity",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.severityColumnLabel",defaultMessage:"Severity"}),truncateText:!0,render:e=>{const t=l.h.decode(e),n=Object(u.isRight)(t)?i.a.createElement(m.a,{value:t.right}):i.a.createElement("p",null,e);return i.a.createElement(p,{tooltip:e},n)}}],C=({title:e,loading:t,alertIds:n,scopeId:s,eventId:o,noItemsMessage:l,"data-test-subj":u})=>{const{setPagination:c,setSorting:d,data:p,loading:m,paginationConfig:f,sorting:g,error:b}=O(n||[]),y=Object(a.useCallback)((({page:e,sort:t})=>{if(e){const{index:t,size:n}=e;c({pageIndex:t,pageSize:n})}t&&d(t)}),[c,d]),v=Object(a.useMemo)((()=>p.map((e=>e.fields)).map(((e={})=>Object.keys(e).reduce(((t,n)=>{var a;return t[n]=(null==e||null===(a=e[n])||void 0===a?void 0:a[0])||(null==e?void 0:e[n]),t}),{})))),[p]),h=Boolean(n&&n.length&&n.length>=5),E=Object(a.useMemo)((()=>h?null:_(s,o,n)),[n,h,s,o]),x=Object(a.useMemo)((()=>h?M(n):null),[n,h]);return i.a.createElement(S.a,{header:{title:e,iconType:"warning",headerContent:n&&n.length&&n.length>0?i.a.createElement("div",{"data-test-subj":`${u}InvestigateInTimeline`},i.a.createElement(k.a,{dataProviders:E,filters:x,asEmptyButton:!0,iconType:"timeline"},w.i)):null},content:{error:b},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":u},i.a.createElement(r.EuiBasicTable,{"data-test-subj":`${u}Table`,loading:t||m,items:v,columns:I,pagination:f,sorting:g,onChange:y,noItemsMessage:l}))},M=e=>e&&e.length?[{meta:{alias:d.i18n.translate("xpack.securitySolution.flyout.left.insights.correlations.tableFilterLabel",{defaultMessage:"Correlations Details Table Alert IDs."}),type:"phrases",key:"_id",params:[...e],negate:!1,disabled:!1,value:e.join()},query:{bool:{should:e.map((e=>({match_phrase:{_id:e}}))),minimum_should_match:1}}}]:null,_=(e,t,n)=>n&&n.length?n.reduce(((n,a,i)=>{const r=`${e}-${t}-event.id-${i}-${a}`;return n.push(Object(T.a)("_id",r,a)),n}),[]):null;var A=n(913);const P=({entityId:e,scopeId:t,eventId:n})=>{const{loading:a,error:r,data:l,dataCount:u}=Object(A.a)({entityId:e,scopeId:t});return r?null:i.a.createElement(C,{title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sessionAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by session",values:{count:u}}),loading:a,alertIds:l,scopeId:t,eventId:n,noItemsMessage:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sessionAlertsNoDataDescription",defaultMessage:"No alerts related by session."}),"data-test-subj":o.c})};P.displayName="RelatedAlertsBySession";var F=n(914);const D=({originalEventId:e,scopeId:t,eventId:n})=>{const{loading:a,error:r,data:l,dataCount:u}=Object(F.a)({originalEventId:e,scopeId:t});return r?null:i.a.createElement(C,{title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sourceAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by source event",values:{count:u}}),loading:a,alertIds:l,scopeId:t,eventId:n,noItemsMessage:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.sourceAlertsNoDataDescription",defaultMessage:"No related source events."}),"data-test-subj":o.d})};D.displayName="RelatedAlertsBySameSourceEvent";var N=n(137),R=n(915);const L=[{field:"title",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.nameColumnLabel",defaultMessage:"Name"}),render:(e,t)=>i.a.createElement(p,{tooltip:t.title},i.a.createElement(N.a,{detailName:t.id,title:t.title},t.title))},{field:"status",name:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.statusColumnLabel",defaultMessage:"Status"}),truncateText:!0,width:"25%"}],z=({eventId:e})=>{const{loading:t,error:n,data:a,dataCount:l}=Object(R.a)({eventId:e});return n?null:i.a.createElement(S.a,{header:{title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.relatedCasesTitle",defaultMessage:"{count} related {count, plural, one {case} other {cases}}",values:{count:l}}),iconType:"warning"},content:{error:n},expand:{expandable:!0,expandedOnFirstRender:!0},"data-test-subj":o.f},i.a.createElement(r.EuiInMemoryTable,{loading:t,items:a,columns:L,pagination:!0,message:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.relatedCasesNoDataDescription",defaultMessage:"No related cases."}),"data-test-subj":o.e}))};z.displayName="RelatedCases";var B=n(916),q=n(917),$=n(918),V=n(201),U=n(919),H=n(920),Z=n(921);const G=({documentId:e,indices:t,scopeId:n})=>{const{loading:a,error:r,data:l,dataCount:u}=Object(Z.a)({documentId:e,indices:t,scopeId:n});return r?null:i.a.createElement(C,{title:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ancestryAlertsTitle",defaultMessage:"{count} {count, plural, one {alert} other {alerts}} related by ancestry",values:{count:u}}),loading:a,alertIds:l,scopeId:n,eventId:e,noItemsMessage:i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.ancestryAlertsNoDataDescription",defaultMessage:"No alerts related by ancestry."}),"data-test-subj":o.b})};G.displayName="RelatedAlertsByAncestry";var Q=n(568),W=n(1290);const K=({dataAsNestedObject:e,alertSuppressionCount:t})=>{const n=i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.suppressedAlertsTitle",defaultMessage:"{count} suppressed {count, plural, =1 {alert} other {alerts}}",values:{count:t}})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiBetaBadge,{label:Q.w,style:{verticalAlign:"middle"},size:"s","data-test-subj":o.A}))),a=t>0&&i.a.createElement("div",{"data-test-subj":`${o.g}InvestigateInTimeline`},i.a.createElement(W.a,{ecsRowData:e,buttonType:"emptyButton"}));return i.a.createElement(S.a,{header:{title:n,iconType:"layers",headerContent:a},"data-test-subj":o.g})};K.displayName="SuppressedAlerts";const J="correlations-details",Y=()=>{const{dataAsNestedObject:e,dataFormattedForFieldBrowser:t,eventId:n,getFieldsData:a,scopeId:l,isPreview:u}=Object(V.b)(),{show:c,indices:d,documentId:p}=Object(q.a)({getFieldsData:a,dataAsNestedObject:e,dataFormattedForFieldBrowser:t,eventId:n,isPreview:u}),{show:m,originalEventId:f}=Object(U.a)({getFieldsData:a}),{show:g,entityId:b}=Object(H.a)({getFieldsData:a}),y=Object(B.a)(),{show:v,alertSuppressionCount:h}=Object($.a)({getFieldsData:a}),E=c||m||g||y||v;return i.a.createElement(r.EuiPanel,{paddingSize:"none","data-test-subj":o.h,color:"transparent"},E?i.a.createElement(r.EuiFlexGroup,{gutterSize:"l",direction:"column"},v&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(K,{alertSuppressionCount:h,dataAsNestedObject:e})),y&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(z,{eventId:n})),m&&f&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(D,{originalEventId:f,scopeId:l,eventId:n})),g&&b&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(P,{entityId:b,scopeId:l,eventId:n})),c&&p&&d&&i.a.createElement(r.EuiFlexItem,null,i.a.createElement(G,{indices:d,scopeId:l,documentId:p}))):i.a.createElement(s.FormattedMessage,{id:"xpack.securitySolution.flyout.left.insights.correlations.noDataDescription",defaultMessage:"No correlations data available."}))};Y.displayName="CorrelationsDetails"},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var a=n(2),i=n(910),r=n(912),s=n(53),o=n(50),l=n(110),u=n(866),c=n(127),d=n(116);const p="fieldNames",m="eventKind",f="hostName",g="userName",b="hosts",y="users",v=(e,t,n,a)=>{const i=Object(s.buildEsQuery)(void 0,[],[{query:{bool:{filter:[{range:{"@timestamp":{gte:t,lte:n}}}]}},meta:{}}]);return h(i,e,a)},h=(e,t,n)=>({params:{index:n,body:{query:e,aggs:{[p]:{filters:{filters:t},aggs:{[f]:{cardinality:{field:"host.name"}},[g]:{cardinality:{field:"user.name"}},[m]:{terms:{field:"event.kind",size:10}}}},[b]:{cardinality:{field:"host.name"}},[y]:{cardinality:{field:"user.name"}}},size:0}}});var E=n(900);const x=({interval:e,dataFormattedForFieldBrowser:t,investigationFields:n})=>{const s=Object(i.a)({dataFormattedForFieldBrowser:t,investigationFields:n}),h=Object(a.useMemo)((()=>Object(r.a)(s)),[s]),{data:x,loading:j,error:O}=(({highlightedFieldsFilters:e,interval:{from:t,to:n}})=>{const{services:{data:{search:a}}}=Object(l.i)(),{selectedPatterns:i}=Object(u.a)(Object(c.isActiveTimeline)(d.SourcererScopeName.default)),r=v(e,t,n,i),{data:s,isLoading:p,isError:m}=Object(o.useQuery)(["useFetchFieldValuePairWithAggregation",e,t,n],(()=>(async(e,t)=>{let n;return new Promise(((a,i)=>{e.search(t).subscribe({next:e=>{n=e.rawResponse},complete:()=>{a(n)},error:e=>{i(e)}})}))})(a,r)));return{loading:p,error:m,data:s}})({highlightedFieldsFilters:h,interval:e}),S=[];if(x&&x.aggregations){const e=x.aggregations[b].value,t=x.aggregations[y].value;Object.keys(x.aggregations[p].buckets).forEach((n=>{var a;const i=s[n].values,r=(null===(a=x.aggregations[p].buckets[n][m].buckets.find((e=>e.key===E.a.signal)))||void 0===a?void 0:a.doc_count)||0;let o=0;x.aggregations[p].buckets[n][m].buckets.reduce(((e,t)=>(t.key!==E.a.signal&&(o+=t.doc_count),e)),o);const l=x.aggregations[p].buckets[n][f].value,u=x.aggregations[p].buckets[n][g].value,c=e?l/e:0,d=t?u/t:0;S.push({field:n,values:i,alertCount:r,docCount:o,hostPrevalence:c,userPrevalence:d})}))}return{loading:j,error:O,data:S}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j}));var a=n(2),i=n.n(a),r=n(17),s=n(1151),o=n.n(s),l=n(1289),u=n(1323),c=n(211),d=n(741),p=n(4),m=n(116),f=n(962),g=n(1135),b=n(121),y=n(202),v=n(201),h=n(183),E=n(394);const x="threat-intelligence-details",j=()=>{const{enrichments:e,eventFields:t,isEnrichmentsLoading:n,isEventDataLoading:s,isLoading:x,range:j,setRange:O}=(()=>{const{indexName:e,eventId:t}=Object(v.b)(),[{pageName:n}]=Object(y.a)(),i=n===p.yc.detections?m.SourcererScopeName.detections:m.SourcererScopeName.default,r=Object(b.d)(i),[s,o]=Object(g.a)({indexName:e,eventId:t,runtimeMappings:r.runtimeMappings,skip:!t}),{isAlert:l}=Object(c.b)(o),u=Object(a.useMemo)((()=>o||[]),[o]),h=Object(a.useMemo)((()=>Object(d.b)(u||[])),[u]),{result:E,loading:x,setRange:j,range:O}=Object(f.c)(h),S=Object(a.useMemo)((()=>l?Object(d.f)(u).map((e=>Object(d.g)(e))):[]),[u,l]);return{enrichments:Object(a.useMemo)((()=>x||null==E||!E.enrichments?S:Object(d.a)([...S,...E.enrichments])),[x,E,S]),eventFields:h,isEnrichmentsLoading:x,isEventDataLoading:s,isLoading:x||s,range:O,setRange:j}})();return s?i.a.createElement(E.a,{"data-test-subj":h.B}):i.a.createElement(u.a,{before:null,loading:x,enrichments:e,showInvestigationTimeEnrichments:!o()(t)},i.a.createElement(i.a.Fragment,null,i.a.createElement(l.a,{setRange:O,loading:n,range:j}),i.a.createElement(r.EuiSpacer,{size:"m"})))};j.displayName="ThreatIntelligenceDetails"},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(9);const i=e=>{const{id:t,revision:n,created_by:i,created_at:r,updated_by:s,updated_at:o,...l}=e,u=Object(a.cloneDeep)(l),c=u.inputs[0].config.policy.value;return[c.windows.popup.malware,c.mac.popup.malware].forEach((e=>e.message.trim())),u}},,function(e,t,n){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,(e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`))},function(e,t,n){"use strict";var a="%[a-f0-9]{2}",i=new RegExp("("+a+")|([^%]+?)","gi"),r=new RegExp("("+a+")+","gi");function s(e,t){try{return[decodeURIComponent(e.join(""))]}catch(e){}if(1===e.length)return e;t=t||1;var n=e.slice(0,t),a=e.slice(t);return Array.prototype.concat.call([],s(n),s(a))}function o(e){try{return decodeURIComponent(e)}catch(a){for(var t=e.match(i)||[],n=1;n<t.length;n++)t=(e=s(t,n).join("")).match(i)||[];return e}}e.exports=function(e){if("string"!=typeof e)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"ï¿½ï¿½","%FF%FE":"ï¿½ï¿½"},n=r.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var a=o(n[0]);a!==n[0]&&(t[n[0]]=a)}n=r.exec(e)}t["%C2"]="ï¿½";for(var i=Object.keys(t),s=0;s<i.length;s++){var l=i[s];e=e.replace(new RegExp(l,"g"),t[l])}return e}(e)}}},function(e,t,n){"use strict";e.exports=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw new TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];const n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}},function(e,t){e.exports=function(){var e=document.getSelection();if(!e.rangeCount)return function(){};for(var t=document.activeElement,n=[],a=0;a<e.rangeCount;a++)n.push(e.getRangeAt(a));switch(t.tagName.toUpperCase()){case"INPUT":case"TEXTAREA":t.blur();break;default:t=null}return e.removeAllRanges(),function(){"Caret"===e.type&&e.removeAllRanges(),e.rangeCount||n.forEach((function(t){e.addRange(t)})),t&&t.focus()}}},,function(e,t,n){"use strict";const a=n(974),i={codes:new Map([[100,"Continue"],[101,"Switching Protocols"],[102,"Processing"],[200,"OK"],[201,"Created"],[202,"Accepted"],[203,"Non-Authoritative Information"],[204,"No Content"],[205,"Reset Content"],[206,"Partial Content"],[207,"Multi-Status"],[300,"Multiple Choices"],[301,"Moved Permanently"],[302,"Moved Temporarily"],[303,"See Other"],[304,"Not Modified"],[305,"Use Proxy"],[307,"Temporary Redirect"],[400,"Bad Request"],[401,"Unauthorized"],[402,"Payment Required"],[403,"Forbidden"],[404,"Not Found"],[405,"Method Not Allowed"],[406,"Not Acceptable"],[407,"Proxy Authentication Required"],[408,"Request Time-out"],[409,"Conflict"],[410,"Gone"],[411,"Length Required"],[412,"Precondition Failed"],[413,"Request Entity Too Large"],[414,"Request-URI Too Large"],[415,"Unsupported Media Type"],[416,"Requested Range Not Satisfiable"],[417,"Expectation Failed"],[418,"I'm a teapot"],[422,"Unprocessable Entity"],[423,"Locked"],[424,"Failed Dependency"],[425,"Too Early"],[426,"Upgrade Required"],[428,"Precondition Required"],[429,"Too Many Requests"],[431,"Request Header Fields Too Large"],[451,"Unavailable For Legal Reasons"],[500,"Internal Server Error"],[501,"Not Implemented"],[502,"Bad Gateway"],[503,"Service Unavailable"],[504,"Gateway Time-out"],[505,"HTTP Version Not Supported"],[506,"Variant Also Negotiates"],[507,"Insufficient Storage"],[509,"Bandwidth Limit Exceeded"],[510,"Not Extended"],[511,"Network Authentication Required"]])};t.Boom=class extends Error{constructor(e,n={}){if(e instanceof Error)return t.boomify(a.clone(e),n);const{statusCode:r=500,data:s=null,ctor:o=t.Boom}=n,l=new Error(e||void 0);Error.captureStackTrace(l,o),l.data=s;const u=i.initialize(l,r);return Object.defineProperty(u,"typeof",{value:o}),n.decorate&&Object.assign(u,n.decorate),u}static[Symbol.hasInstance](e){return this===t.Boom?t.isBoom(e):this.prototype.isPrototypeOf(e)}},t.isBoom=function(e,t){return e instanceof Error&&!!e.isBoom&&(!t||e.output.statusCode===t)},t.boomify=function(e,t){return a.assert(e instanceof Error,"Cannot wrap non-Error object"),void 0!==(t=t||{}).data&&(e.data=t.data),t.decorate&&Object.assign(e,t.decorate),e.isBoom?!1===t.override||!t.statusCode&&!t.message?e:i.initialize(e,t.statusCode||e.output.statusCode,t.message):i.initialize(e,t.statusCode||500,t.message)},t.badRequest=function(e,n){return new t.Boom(e,{statusCode:400,data:n,ctor:t.badRequest})},t.unauthorized=function(e,n,i){const r=new t.Boom(e,{statusCode:401,ctor:t.unauthorized});if(!n)return r;if("string"!=typeof n)return r.output.headers["WWW-Authenticate"]=n.join(", "),r;let s=`${n}`;return(i||e)&&(r.output.payload.attributes={}),i&&("string"==typeof i?(s+=" "+a.escapeHeaderAttribute(i),r.output.payload.attributes=i):s+=" "+Object.keys(i).map((e=>{let t=i[e];return null==t&&(t=""),r.output.payload.attributes[e]=t,`${e}="${a.escapeHeaderAttribute(t.toString())}"`})).join(", ")),e?(i&&(s+=","),s+=` error="${a.escapeHeaderAttribute(e)}"`,r.output.payload.attributes.error=e):r.isMissing=!0,r.output.headers["WWW-Authenticate"]=s,r},t.paymentRequired=function(e,n){return new t.Boom(e,{statusCode:402,data:n,ctor:t.paymentRequired})},t.forbidden=function(e,n){return new t.Boom(e,{statusCode:403,data:n,ctor:t.forbidden})},t.notFound=function(e,n){return new t.Boom(e,{statusCode:404,data:n,ctor:t.notFound})},t.methodNotAllowed=function(e,n,a){const i=new t.Boom(e,{statusCode:405,data:n,ctor:t.methodNotAllowed});return"string"==typeof a&&(a=[a]),Array.isArray(a)&&(i.output.headers.Allow=a.join(", ")),i},t.notAcceptable=function(e,n){return new t.Boom(e,{statusCode:406,data:n,ctor:t.notAcceptable})},t.proxyAuthRequired=function(e,n){return new t.Boom(e,{statusCode:407,data:n,ctor:t.proxyAuthRequired})},t.clientTimeout=function(e,n){return new t.Boom(e,{statusCode:408,data:n,ctor:t.clientTimeout})},t.conflict=function(e,n){return new t.Boom(e,{statusCode:409,data:n,ctor:t.conflict})},t.resourceGone=function(e,n){return new t.Boom(e,{statusCode:410,data:n,ctor:t.resourceGone})},t.lengthRequired=function(e,n){return new t.Boom(e,{statusCode:411,data:n,ctor:t.lengthRequired})},t.preconditionFailed=function(e,n){return new t.Boom(e,{statusCode:412,data:n,ctor:t.preconditionFailed})},t.entityTooLarge=function(e,n){return new t.Boom(e,{statusCode:413,data:n,ctor:t.entityTooLarge})},t.uriTooLong=function(e,n){return new t.Boom(e,{statusCode:414,data:n,ctor:t.uriTooLong})},t.unsupportedMediaType=function(e,n){return new t.Boom(e,{statusCode:415,data:n,ctor:t.unsupportedMediaType})},t.rangeNotSatisfiable=function(e,n){return new t.Boom(e,{statusCode:416,data:n,ctor:t.rangeNotSatisfiable})},t.expectationFailed=function(e,n){return new t.Boom(e,{statusCode:417,data:n,ctor:t.expectationFailed})},t.teapot=function(e,n){return new t.Boom(e,{statusCode:418,data:n,ctor:t.teapot})},t.badData=function(e,n){return new t.Boom(e,{statusCode:422,data:n,ctor:t.badData})},t.locked=function(e,n){return new t.Boom(e,{statusCode:423,data:n,ctor:t.locked})},t.failedDependency=function(e,n){return new t.Boom(e,{statusCode:424,data:n,ctor:t.failedDependency})},t.tooEarly=function(e,n){return new t.Boom(e,{statusCode:425,data:n,ctor:t.tooEarly})},t.preconditionRequired=function(e,n){return new t.Boom(e,{statusCode:428,data:n,ctor:t.preconditionRequired})},t.tooManyRequests=function(e,n){return new t.Boom(e,{statusCode:429,data:n,ctor:t.tooManyRequests})},t.illegal=function(e,n){return new t.Boom(e,{statusCode:451,data:n,ctor:t.illegal})},t.internal=function(e,n,a=500){return i.serverError(e,n,a,t.internal)},t.notImplemented=function(e,n){return i.serverError(e,n,501,t.notImplemented)},t.badGateway=function(e,n){return i.serverError(e,n,502,t.badGateway)},t.serverUnavailable=function(e,n){return i.serverError(e,n,503,t.serverUnavailable)},t.gatewayTimeout=function(e,n){return i.serverError(e,n,504,t.gatewayTimeout)},t.badImplementation=function(e,n){const a=i.serverError(e,n,500,t.badImplementation);return a.isDeveloperError=!0,a},i.initialize=function(e,t,n){const r=parseInt(t,10);if(a.assert(!isNaN(r)&&r>=400,"First argument must be a number (400+):",t),e.isBoom=!0,e.isServer=r>=500,e.hasOwnProperty("data")||(e.data=null),e.output={statusCode:r,payload:{},headers:{}},Object.defineProperty(e,"reformat",{value:i.reformat,configurable:!0}),n||e.message||(e.reformat(),n=e.output.payload.error),n){const t=Object.getOwnPropertyDescriptor(e,"message")||Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"message");a.assert(!t||t.configurable&&!t.get,"The error is not compatible with boom"),e.message=n+(e.message?": "+e.message:""),e.output.payload.message=e.message}return e.reformat(),e},i.reformat=function(e=!1){this.output.payload.statusCode=this.output.statusCode,this.output.payload.error=i.codes.get(this.output.statusCode)||"Unknown",500===this.output.statusCode&&!0!==e?this.output.payload.message="An internal server error occurred":this.message&&(this.output.payload.message=this.message)},i.serverError=function(e,n,a,i){return n instanceof Error&&!n.isBoom?t.boomify(n,{statusCode:a,message:e}):new t.Boom(e,{statusCode:a,data:n,ctor:i})}},function(e,t,n){"use strict";t.applyToDefaults=n(975),t.assert=n(270),t.Bench=n(976),t.block=n(977),t.clone=n(440),t.contain=n(978),t.deepEqual=n(629),t.Error=n(624),t.escapeHeaderAttribute=n(979),t.escapeHtml=n(980),t.escapeJson=n(981),t.escapeRegex=n(630),t.flatten=n(982),t.ignore=n(628),t.intersect=n(983),t.isPromise=n(984),t.merge=n(627),t.once=n(985),t.reach=n(354),t.reachTemplate=n(986),t.stringify=n(625),t.wait=n(987)},function(e,t,n){"use strict";const a=n(270),i=n(440),r=n(627),s=n(354),o={};e.exports=function(e,t,n={}){if(a(e&&"object"==typeof e,"Invalid defaults value: must be an object"),a(!t||!0===t||"object"==typeof t,"Invalid source value: must be true, falsy or an object"),a("object"==typeof n,"Invalid options: must be an object"),!t)return null;if(n.shallow)return o.applyToDefaultsWithShallow(e,t,n);const s=i(e);if(!0===t)return s;const l=void 0!==n.nullOverride&&n.nullOverride;return r(s,t,{nullOverride:l,mergeArrays:!1})},o.applyToDefaultsWithShallow=function(e,t,n){const l=n.shallow;a(Array.isArray(l),"Invalid keys");const u=new Map,c=!0===t?null:new Set;for(let n of l){n=Array.isArray(n)?n:n.split(".");const a=s(e,n);a&&"object"==typeof a?u.set(a,c&&s(t,n)||a):c&&c.add(n)}const d=i(e,{},u);if(!c)return d;for(const e of c)o.reachCopy(d,t,e);const p=void 0!==n.nullOverride&&n.nullOverride;return r(d,t,{nullOverride:p,mergeArrays:!1})},o.reachCopy=function(e,t,n){for(const e of n){if(!(e in t))return;const n=t[e];if("object"!=typeof n||null===n)return;t=n}const a=t;let i=e;for(let e=0;e<n.length-1;++e){const t=n[e];"object"!=typeof i[t]&&(i[t]={}),i=i[t]}i[n[n.length-1]]=a}},function(e,t,n){"use strict";(function(t){const n={};e.exports=n.Bench=class{constructor(){this.ts=0,this.reset()}reset(){this.ts=n.Bench.now()}elapsed(){return n.Bench.now()-this.ts}static now(){const e=t.hrtime();return 1e3*e[0]+e[1]/1e6}}}).call(this,n(391))},function(e,t,n){"use strict";const a=n(628);e.exports=function(){return new Promise(a)}},function(e,t,n){"use strict";const a=n(270),i=n(629),r=n(630),s=n(441),o={};e.exports=function(e,t,n={}){return"object"!=typeof t&&(t=[t]),a(!Array.isArray(t)||t.length,"Values array cannot be empty"),"string"==typeof e?o.string(e,t,n):Array.isArray(e)?o.array(e,t,n):(a("object"==typeof e,"Reference must be string or an object"),o.object(e,t,n))},o.array=function(e,t,n){if(Array.isArray(t)||(t=[t]),!e.length)return!1;if(n.only&&n.once&&e.length!==t.length)return!1;let a;const i=new Map;for(const e of t)if(n.deep&&e&&"object"==typeof e){a=a||o.compare(n);let t=!1;for(const[n,r]of i.entries())if(a(n,e)){++r.allowed,t=!0;break}t||i.set(e,{allowed:1,hits:0})}else{const t=i.get(e);t?++t.allowed:i.set(e,{allowed:1,hits:0})}let r=0;for(const t of e){let e;if(n.deep&&t&&"object"==typeof t){a=a||o.compare(n);for(const[n,r]of i.entries())if(a(n,t)){e=r;break}}else e=i.get(t);if(e&&(++e.hits,++r,n.once&&e.hits>e.allowed))return!1}if(n.only&&r!==e.length)return!1;for(const e of i.values())if(e.hits!==e.allowed&&e.hits<e.allowed&&!n.part)return!1;return!!r},o.object=function(e,t,n){a(void 0===n.once,"Cannot use option once with object");const i=s.keys(e,n);if(!i.length)return!1;if(Array.isArray(t))return o.array(i,t,n);const r=Object.getOwnPropertySymbols(t).filter((e=>t.propertyIsEnumerable(e))),l=[...Object.keys(t),...r],u=o.compare(n),c=new Set(l);for(const a of i)if(c.has(a)){if(!u(t[a],e[a]))return!1;c.delete(a)}else if(n.only)return!1;return!c.size||!!n.part&&c.size<l.length},o.string=function(e,t,n){if(""===e)return 1===t.length&&""===t[0]||!n.once&&!t.some((e=>""!==e));const i=new Map,s=[];for(const e of t)if(a("string"==typeof e,"Cannot compare string reference to non-string value"),e){const t=i.get(e);t?++t.allowed:(i.set(e,{allowed:1,hits:0}),s.push(r(e)))}else if(n.once||n.only)return!1;if(!s.length)return!0;const o=new RegExp(`(${s.join("|")})`,"g"),l=e.replace(o,((e,t)=>(++i.get(t).hits,"")));if(n.only&&l)return!1;let u=!1;for(const e of i.values())if(e.hits&&(u=!0),e.hits!==e.allowed){if(e.hits<e.allowed&&!n.part)return!1;if(n.once)return!1}return!!u},o.compare=function(e){if(!e.deep)return o.shallow;const t=void 0!==e.only,n=void 0!==e.part,a={prototype:t?e.only:!!n&&!e.part,part:t?!e.only:!!n&&e.part};return(e,t)=>i(e,t,a)},o.shallow=function(e,t){return e===t}},function(e,t,n){"use strict";const a=n(270);e.exports=function(e){return a(/^[ \w\!#\$%&'\(\)\*\+,\-\.\/\:;<\=>\?@\[\]\^`\{\|\}~\"\\]*$/.test(e),"Bad attribute value ("+e+")"),e.replace(/\\/g,"\\\\").replace(/\"/g,'\\"')}},function(e,t,n){"use strict";const a={};e.exports=function(e){if(!e)return"";let t="";for(let n=0;n<e.length;++n){const i=e.charCodeAt(n);a.isSafe(i)?t+=e[n]:t+=a.escapeHtmlChar(i)}return t},a.escapeHtmlChar=function(e){const t=a.namedHtml[e];return void 0!==t?t:e>=256?"&#"+e+";":`&#x${e.toString(16).padStart(2,"0")};`},a.isSafe=function(e){return void 0!==a.safeCharCodes[e]},a.namedHtml={38:"&amp;",60:"&lt;",62:"&gt;",34:"&quot;",160:"&nbsp;",162:"&cent;",163:"&pound;",164:"&curren;",169:"&copy;",174:"&reg;"},a.safeCharCodes=function(){const e={};for(let t=32;t<123;++t)(t>=97||t>=65&&t<=90||t>=48&&t<=57||32===t||46===t||44===t||45===t||58===t||95===t)&&(e[t]=null);return e}()},function(e,t,n){"use strict";e.exports=function(e){if(!e)return"";let t;return e.replace(/[<>&\u2028\u2029]/g,(e=>(t=e.charCodeAt(0),60===t?"\\u003c":62===t?"\\u003e":38===t?"\\u0026":8232===t?"\\u2028":"\\u2029")))}},function(e,t,n){"use strict";const a={};e.exports=a.flatten=function(e,t){const n=t||[];for(let t=0;t<e.length;++t)Array.isArray(e[t])?a.flatten(e[t],n):n.push(e[t]);return n}},function(e,t,n){"use strict";const a={};e.exports=function(e,t,n={}){if(!e||!t)return n.first?null:[];const i=[],r=Array.isArray(e)?new Set(e):e,s=new Set;for(const e of t)if(a.has(r,e)&&!s.has(e)){if(n.first)return e;i.push(e),s.add(e)}return n.first?null:i},a.has=function(e,t){return"function"==typeof e.has?e.has(t):void 0!==e[t]}},function(e,t,n){"use strict";e.exports=function(e){return!!e&&"function"==typeof e.then}},function(e,t,n){"use strict";e.exports=function(e){if(e._hoekOnce)return e;let t=!1;const n=function(...n){t||(t=!0,e(...n))};return n._hoekOnce=!0,n}},function(e,t,n){"use strict";const a=n(354);e.exports=function(e,t,n){return t.replace(/{([^{}]+)}/g,((t,i)=>{const r=a(e,i,n);return null==r?"":r}))}},function(e,t,n){"use strict";e.exports=function(e,t){if("number"!=typeof e&&void 0!==e)throw new TypeError("Timeout must be a number");return new Promise((n=>setTimeout(n,e,t)))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.date=t.boolean=t.bigint=t.array=t.any=t.coerce=t.ZodFirstPartyTypeKind=t.late=t.ZodSchema=t.Schema=t.custom=t.ZodReadonly=t.ZodPipeline=t.ZodBranded=t.BRAND=t.ZodNaN=t.ZodCatch=t.ZodDefault=t.ZodNullable=t.ZodOptional=t.ZodTransformer=t.ZodEffects=t.ZodPromise=t.ZodNativeEnum=t.ZodEnum=t.ZodLiteral=t.ZodLazy=t.ZodFunction=t.ZodSet=t.ZodMap=t.ZodRecord=t.ZodTuple=t.ZodIntersection=t.ZodDiscriminatedUnion=t.ZodUnion=t.ZodObject=t.ZodArray=t.ZodVoid=t.ZodNever=t.ZodUnknown=t.ZodAny=t.ZodNull=t.ZodUndefined=t.ZodSymbol=t.ZodDate=t.ZodBoolean=t.ZodBigInt=t.ZodNumber=t.ZodString=t.ZodType=void 0,t.NEVER=t.void=t.unknown=t.union=t.undefined=t.tuple=t.transformer=t.symbol=t.string=t.strictObject=t.set=t.record=t.promise=t.preprocess=t.pipeline=t.ostring=t.optional=t.onumber=t.oboolean=t.object=t.number=t.nullable=t.null=t.never=t.nativeEnum=t.nan=t.map=t.literal=t.lazy=t.intersection=t.instanceof=t.function=t.enum=t.effect=t.discriminatedUnion=void 0;const a=n(442),i=n(990),r=n(633),s=n(355),o=n(443);class ParseInputLazyPath{constructor(e,t,n,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=n,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const l=(e,t)=>{if((0,r.isValid)(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new o.ZodError(e.common.issues);return this._error=t,this._error}}};function u(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:a,description:i}=e;if(t&&(n||a))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:i}:{errorMap:(e,t)=>"invalid_type"!==e.code?{message:t.defaultError}:void 0===t.data?{message:null!=a?a:t.defaultError}:{message:null!=n?n:t.defaultError},description:i}}class ZodType{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return(0,s.getParsedType)(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:(0,s.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new r.ParseStatus,ctx:{common:e.parent.common,data:e.data,parsedType:(0,s.getParsedType)(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if((0,r.isAsync)(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const n=this.safeParse(e,t);if(n.success)return n.data;throw n.error}safeParse(e,t){var n;const a={common:{issues:[],async:null!==(n=null==t?void 0:t.async)&&void 0!==n&&n,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,s.getParsedType)(e)},i=this._parseSync({data:e,path:a.path,parent:a});return l(a,i)}async parseAsync(e,t){const n=await this.safeParseAsync(e,t);if(n.success)return n.data;throw n.error}async safeParseAsync(e,t){const n={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:(0,s.getParsedType)(e)},a=this._parse({data:e,path:n.path,parent:n}),i=await((0,r.isAsync)(a)?a:Promise.resolve(a));return l(n,i)}refine(e,t){const n=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,a)=>{const i=e(t),r=()=>a.addIssue({code:o.ZodIssueCode.custom,...n(t)});return"undefined"!=typeof Promise&&i instanceof Promise?i.then((e=>!!e||(r(),!1))):!!i||(r(),!1)}))}refinement(e,t){return this._refinement(((n,a)=>!!e(n)||(a.addIssue("function"==typeof t?t(n,a):t),!1)))}_refinement(e){return new ZodEffects({schema:this,typeName:O.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this,this._def)}promise(){return ZodPromise.create(this,this._def)}or(e){return ZodUnion.create([this,e],this._def)}and(e){return ZodIntersection.create(this,e,this._def)}transform(e){return new ZodEffects({...u(this._def),schema:this,typeName:O.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new ZodDefault({...u(this._def),innerType:this,defaultValue:t,typeName:O.ZodDefault})}brand(){return new ZodBranded({typeName:O.ZodBranded,type:this,...u(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new ZodCatch({...u(this._def),innerType:this,catchValue:t,typeName:O.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return ZodPipeline.create(this,e)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}t.ZodType=ZodType,t.Schema=ZodType,t.ZodSchema=ZodType;const c=/^c[^\s-]{8,}$/i,d=/^[a-z][a-z0-9]*$/,p=/[0-9A-HJKMNP-TV-Z]{26}/,m=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,f=/^(?!\.)(?!.*\.\.)([A-Z0-9_+-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,g=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,b=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,y=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/;class ZodString extends ZodType{constructor(){super(...arguments),this._regex=(e,t,n)=>this.refinement((t=>e.test(t)),{validation:t,code:o.ZodIssueCode.invalid_string,...i.errorUtil.errToObj(n)}),this.nonempty=e=>this.min(1,i.errorUtil.errToObj(e)),this.trim=()=>new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==s.ZodParsedType.string){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.string,received:t.parsedType}),r.INVALID}const t=new r.ParseStatus;let n;for(const u of this._def.checks)if("min"===u.kind)e.data.length<u.value&&(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),t.dirty());else if("max"===u.kind)e.data.length>u.value&&(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),t.dirty());else if("length"===u.kind){const a=e.data.length>u.value,i=e.data.length<u.value;(a||i)&&(n=this._getOrReturnCtx(e,n),a?(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):i&&(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),t.dirty())}else if("email"===u.kind)f.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{validation:"email",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("emoji"===u.kind)g.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{validation:"emoji",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("uuid"===u.kind)m.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{validation:"uuid",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("cuid"===u.kind)c.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{validation:"cuid",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("cuid2"===u.kind)d.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{validation:"cuid2",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("ulid"===u.kind)p.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{validation:"ulid",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty());else if("url"===u.kind)try{new URL(e.data)}catch(a){n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{validation:"url",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty()}else"regex"===u.kind?(u.regex.lastIndex=0,u.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{validation:"regex",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty())):"trim"===u.kind?e.data=e.data.trim():"includes"===u.kind?e.data.includes(u.value,u.position)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),t.dirty()):"toLowerCase"===u.kind?e.data=e.data.toLowerCase():"toUpperCase"===u.kind?e.data=e.data.toUpperCase():"startsWith"===u.kind?e.data.startsWith(u.value)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.invalid_string,validation:{startsWith:u.value},message:u.message}),t.dirty()):"endsWith"===u.kind?e.data.endsWith(u.value)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.invalid_string,validation:{endsWith:u.value},message:u.message}),t.dirty()):"datetime"===u.kind?((l=u).precision?l.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${l.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${l.precision}}Z$`):0===l.precision?l.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):l.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$")).test(e.data)||(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.invalid_string,validation:"datetime",message:u.message}),t.dirty()):"ip"===u.kind?(a=e.data,("v4"!==(i=u.version)&&i||!b.test(a))&&("v6"!==i&&i||!y.test(a))&&(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{validation:"ip",code:o.ZodIssueCode.invalid_string,message:u.message}),t.dirty())):s.util.assertNever(u);var a,i,l;return{status:t.value,value:e.data}}_addCheck(e){return new ZodString({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...i.errorUtil.errToObj(e)})}url(e){return this._addCheck({kind:"url",...i.errorUtil.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...i.errorUtil.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...i.errorUtil.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...i.errorUtil.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...i.errorUtil.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...i.errorUtil.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...i.errorUtil.errToObj(e)})}datetime(e){var t;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,...i.errorUtil.errToObj(null==e?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...i.errorUtil.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...i.errorUtil.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...i.errorUtil.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...i.errorUtil.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...i.errorUtil.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...i.errorUtil.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...i.errorUtil.errToObj(t)})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function v(e,t){const n=(e.toString().split(".")[1]||"").length,a=(t.toString().split(".")[1]||"").length,i=n>a?n:a;return parseInt(e.toFixed(i).replace(".",""))%parseInt(t.toFixed(i).replace(".",""))/Math.pow(10,i)}t.ZodString=ZodString,ZodString.create=e=>{var t;return new ZodString({checks:[],typeName:O.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...u(e)})};class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==s.ZodParsedType.number){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.number,received:t.parsedType}),r.INVALID}let t;const n=new r.ParseStatus;for(const a of this._def.checks)"int"===a.kind?s.util.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:a.message}),n.dirty()):"min"===a.kind?(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):"max"===a.kind?(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),n.dirty()):"multipleOf"===a.kind?0!==v(e.data,a.value)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):"finite"===a.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.not_finite,message:a.message}),n.dirty()):s.util.assertNever(a);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.errorUtil.toString(t))}setLimit(e,t,n,a){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:i.errorUtil.toString(a)}]})}_addCheck(e){return new ZodNumber({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:i.errorUtil.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:i.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:i.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:i.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:i.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.errorUtil.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:i.errorUtil.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:i.errorUtil.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:i.errorUtil.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&s.util.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const n of this._def.checks){if("finite"===n.kind||"int"===n.kind||"multipleOf"===n.kind)return!0;"min"===n.kind?(null===t||n.value>t)&&(t=n.value):"max"===n.kind&&(null===e||n.value<e)&&(e=n.value)}return Number.isFinite(t)&&Number.isFinite(e)}}t.ZodNumber=ZodNumber,ZodNumber.create=e=>new ZodNumber({checks:[],typeName:O.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...u(e)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==s.ZodParsedType.bigint){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.bigint,received:t.parsedType}),r.INVALID}let t;const n=new r.ParseStatus;for(const a of this._def.checks)"min"===a.kind?(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):"max"===a.kind?(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),n.dirty()):"multipleOf"===a.kind?e.data%a.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.not_multiple_of,multipleOf:a.value,message:a.message}),n.dirty()):s.util.assertNever(a);return{status:n.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,i.errorUtil.toString(t))}gt(e,t){return this.setLimit("min",e,!1,i.errorUtil.toString(t))}lte(e,t){return this.setLimit("max",e,!0,i.errorUtil.toString(t))}lt(e,t){return this.setLimit("max",e,!1,i.errorUtil.toString(t))}setLimit(e,t,n,a){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:n,message:i.errorUtil.toString(a)}]})}_addCheck(e){return new ZodBigInt({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:i.errorUtil.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:i.errorUtil.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:i.errorUtil.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:i.errorUtil.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:i.errorUtil.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}t.ZodBigInt=ZodBigInt,ZodBigInt.create=e=>{var t;return new ZodBigInt({checks:[],typeName:O.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...u(e)})};class ZodBoolean extends ZodType{_parse(e){if(this._def.coerce&&(e.data=Boolean(e.data)),this._getType(e)!==s.ZodParsedType.boolean){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.boolean,received:t.parsedType}),r.INVALID}return(0,r.OK)(e.data)}}t.ZodBoolean=ZodBoolean,ZodBoolean.create=e=>new ZodBoolean({typeName:O.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...u(e)});class ZodDate extends ZodType{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==s.ZodParsedType.date){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.date,received:t.parsedType}),r.INVALID}if(isNaN(e.data.getTime())){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_date}),r.INVALID}const t=new r.ParseStatus;let n;for(const a of this._def.checks)"min"===a.kind?e.data.getTime()<a.value&&(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),t.dirty()):"max"===a.kind?e.data.getTime()>a.value&&(n=this._getOrReturnCtx(e,n),(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),t.dirty()):s.util.assertNever(a);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new ZodDate({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:i.errorUtil.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:i.errorUtil.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}t.ZodDate=ZodDate,ZodDate.create=e=>new ZodDate({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:O.ZodDate,...u(e)});class ZodSymbol extends ZodType{_parse(e){if(this._getType(e)!==s.ZodParsedType.symbol){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.symbol,received:t.parsedType}),r.INVALID}return(0,r.OK)(e.data)}}t.ZodSymbol=ZodSymbol,ZodSymbol.create=e=>new ZodSymbol({typeName:O.ZodSymbol,...u(e)});class ZodUndefined extends ZodType{_parse(e){if(this._getType(e)!==s.ZodParsedType.undefined){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.undefined,received:t.parsedType}),r.INVALID}return(0,r.OK)(e.data)}}t.ZodUndefined=ZodUndefined,ZodUndefined.create=e=>new ZodUndefined({typeName:O.ZodUndefined,...u(e)});class ZodNull extends ZodType{_parse(e){if(this._getType(e)!==s.ZodParsedType.null){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.null,received:t.parsedType}),r.INVALID}return(0,r.OK)(e.data)}}t.ZodNull=ZodNull,ZodNull.create=e=>new ZodNull({typeName:O.ZodNull,...u(e)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(e){return(0,r.OK)(e.data)}}t.ZodAny=ZodAny,ZodAny.create=e=>new ZodAny({typeName:O.ZodAny,...u(e)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(e){return(0,r.OK)(e.data)}}t.ZodUnknown=ZodUnknown,ZodUnknown.create=e=>new ZodUnknown({typeName:O.ZodUnknown,...u(e)});class ZodNever extends ZodType{_parse(e){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.never,received:t.parsedType}),r.INVALID}}t.ZodNever=ZodNever,ZodNever.create=e=>new ZodNever({typeName:O.ZodNever,...u(e)});class ZodVoid extends ZodType{_parse(e){if(this._getType(e)!==s.ZodParsedType.undefined){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.void,received:t.parsedType}),r.INVALID}return(0,r.OK)(e.data)}}t.ZodVoid=ZodVoid,ZodVoid.create=e=>new ZodVoid({typeName:O.ZodVoid,...u(e)});class ZodArray extends ZodType{_parse(e){const{ctx:t,status:n}=this._processInputParams(e),a=this._def;if(t.parsedType!==s.ZodParsedType.array)return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.array,received:t.parsedType}),r.INVALID;if(null!==a.exactLength){const e=t.data.length>a.exactLength.value,i=t.data.length<a.exactLength.value;(e||i)&&((0,r.addIssueToContext)(t,{code:e?o.ZodIssueCode.too_big:o.ZodIssueCode.too_small,minimum:i?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),n.dirty())}if(null!==a.minLength&&t.data.length<a.minLength.value&&((0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),n.dirty()),null!==a.maxLength&&t.data.length>a.maxLength.value&&((0,r.addIssueToContext)(t,{code:o.ZodIssueCode.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),n.dirty()),t.common.async)return Promise.all([...t.data].map(((e,n)=>a.type._parseAsync(new ParseInputLazyPath(t,e,t.path,n))))).then((e=>r.ParseStatus.mergeArray(n,e)));const i=[...t.data].map(((e,n)=>a.type._parseSync(new ParseInputLazyPath(t,e,t.path,n))));return r.ParseStatus.mergeArray(n,i)}get element(){return this._def.type}min(e,t){return new ZodArray({...this._def,minLength:{value:e,message:i.errorUtil.toString(t)}})}max(e,t){return new ZodArray({...this._def,maxLength:{value:e,message:i.errorUtil.toString(t)}})}length(e,t){return new ZodArray({...this._def,exactLength:{value:e,message:i.errorUtil.toString(t)}})}nonempty(e){return this.min(1,e)}}function h(e){if(e instanceof ZodObject){const t={};for(const n in e.shape){const a=e.shape[n];t[n]=ZodOptional.create(h(a))}return new ZodObject({...e._def,shape:()=>t})}return e instanceof ZodArray?new ZodArray({...e._def,type:h(e.element)}):e instanceof ZodOptional?ZodOptional.create(h(e.unwrap())):e instanceof ZodNullable?ZodNullable.create(h(e.unwrap())):e instanceof ZodTuple?ZodTuple.create(e.items.map((e=>h(e)))):e}t.ZodArray=ZodArray,ZodArray.create=(e,t)=>new ZodArray({type:e,minLength:null,maxLength:null,exactLength:null,typeName:O.ZodArray,...u(t)});class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=s.util.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==s.ZodParsedType.object){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.object,received:t.parsedType}),r.INVALID}const{status:t,ctx:n}=this._processInputParams(e),{shape:a,keys:i}=this._getCached(),l=[];if(!(this._def.catchall instanceof ZodNever&&"strip"===this._def.unknownKeys))for(const e in n.data)i.includes(e)||l.push(e);const u=[];for(const e of i){const t=a[e],i=n.data[e];u.push({key:{status:"valid",value:e},value:t._parse(new ParseInputLazyPath(n,i,n.path,e)),alwaysSet:e in n.data})}if(this._def.catchall instanceof ZodNever){const e=this._def.unknownKeys;if("passthrough"===e)for(const e of l)u.push({key:{status:"valid",value:e},value:{status:"valid",value:n.data[e]}});else if("strict"===e)l.length>0&&((0,r.addIssueToContext)(n,{code:o.ZodIssueCode.unrecognized_keys,keys:l}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of l){const a=n.data[t];u.push({key:{status:"valid",value:t},value:e._parse(new ParseInputLazyPath(n,a,n.path,t)),alwaysSet:t in n.data})}}return n.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of u){const n=await t.key;e.push({key:n,value:await t.value,alwaysSet:t.alwaysSet})}return e})).then((e=>r.ParseStatus.mergeObjectSync(t,e))):r.ParseStatus.mergeObjectSync(t,u)}get shape(){return this._def.shape()}strict(e){return i.errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,n)=>{var a,r,s,o;const l=null!==(s=null===(r=(a=this._def).errorMap)||void 0===r?void 0:r.call(a,t,n).message)&&void 0!==s?s:n.defaultError;return"unrecognized_keys"===t.code?{message:null!==(o=i.errorUtil.errToObj(e).message)&&void 0!==o?o:l}:{message:l}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(e){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ZodObject({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:O.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new ZodObject({...this._def,catchall:e})}pick(e){const t={};return s.util.objectKeys(e).forEach((n=>{e[n]&&this.shape[n]&&(t[n]=this.shape[n])})),new ZodObject({...this._def,shape:()=>t})}omit(e){const t={};return s.util.objectKeys(this.shape).forEach((n=>{e[n]||(t[n]=this.shape[n])})),new ZodObject({...this._def,shape:()=>t})}deepPartial(){return h(this)}partial(e){const t={};return s.util.objectKeys(this.shape).forEach((n=>{const a=this.shape[n];e&&!e[n]?t[n]=a:t[n]=a.optional()})),new ZodObject({...this._def,shape:()=>t})}required(e){const t={};return s.util.objectKeys(this.shape).forEach((n=>{if(e&&!e[n])t[n]=this.shape[n];else{let e=this.shape[n];for(;e instanceof ZodOptional;)e=e._def.innerType;t[n]=e}})),new ZodObject({...this._def,shape:()=>t})}keyof(){return j(s.util.objectKeys(this.shape))}}t.ZodObject=ZodObject,ZodObject.create=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:O.ZodObject,...u(t)}),ZodObject.strictCreate=(e,t)=>new ZodObject({shape:()=>e,unknownKeys:"strict",catchall:ZodNever.create(),typeName:O.ZodObject,...u(t)}),ZodObject.lazycreate=(e,t)=>new ZodObject({shape:e,unknownKeys:"strip",catchall:ZodNever.create(),typeName:O.ZodObject,...u(t)});class ZodUnion extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),n=this._def.options;if(t.common.async)return Promise.all(n.map((async e=>{const n={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:n}),ctx:n}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const n of e)if("dirty"===n.result.status)return t.common.issues.push(...n.ctx.common.issues),n.result;const n=e.map((e=>new o.ZodError(e.ctx.common.issues)));return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union,unionErrors:n}),r.INVALID}));{let e;const a=[];for(const i of n){const n={...t,common:{...t.common,issues:[]},parent:null},r=i._parseSync({data:t.data,path:t.path,parent:n});if("valid"===r.status)return r;"dirty"!==r.status||e||(e={result:r,ctx:n}),n.common.issues.length&&a.push(n.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const i=a.map((e=>new o.ZodError(e)));return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union,unionErrors:i}),r.INVALID}}get options(){return this._def.options}}t.ZodUnion=ZodUnion,ZodUnion.create=(e,t)=>new ZodUnion({options:e,typeName:O.ZodUnion,...u(t)});const E=e=>e instanceof ZodLazy?E(e.schema):e instanceof ZodEffects?E(e.innerType()):e instanceof ZodLiteral?[e.value]:e instanceof ZodEnum?e.options:e instanceof ZodNativeEnum?Object.keys(e.enum):e instanceof ZodDefault?E(e._def.innerType):e instanceof ZodUndefined?[void 0]:e instanceof ZodNull?[null]:null;class ZodDiscriminatedUnion extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.ZodParsedType.object)return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.object,received:t.parsedType}),r.INVALID;const n=this.discriminator,a=t.data[n],i=this.optionsMap.get(a);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):((0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[n]}),r.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,n){const a=new Map;for(const n of t){const t=E(n.shape[e]);if(!t)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const i of t){if(a.has(i))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(i)}`);a.set(i,n)}}return new ZodDiscriminatedUnion({typeName:O.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:a,...u(n)})}}function x(e,t){const n=(0,s.getParsedType)(e),a=(0,s.getParsedType)(t);if(e===t)return{valid:!0,data:e};if(n===s.ZodParsedType.object&&a===s.ZodParsedType.object){const n=s.util.objectKeys(t),a=s.util.objectKeys(e).filter((e=>-1!==n.indexOf(e))),i={...e,...t};for(const n of a){const a=x(e[n],t[n]);if(!a.valid)return{valid:!1};i[n]=a.data}return{valid:!0,data:i}}if(n===s.ZodParsedType.array&&a===s.ZodParsedType.array){if(e.length!==t.length)return{valid:!1};const n=[];for(let a=0;a<e.length;a++){const i=x(e[a],t[a]);if(!i.valid)return{valid:!1};n.push(i.data)}return{valid:!0,data:n}}return n===s.ZodParsedType.date&&a===s.ZodParsedType.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}t.ZodDiscriminatedUnion=ZodDiscriminatedUnion;class ZodIntersection extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e),a=(e,a)=>{if((0,r.isAborted)(e)||(0,r.isAborted)(a))return r.INVALID;const i=x(e.value,a.value);return i.valid?(((0,r.isDirty)(e)||(0,r.isDirty)(a))&&t.dirty(),{status:t.value,value:i.data}):((0,r.addIssueToContext)(n,{code:o.ZodIssueCode.invalid_intersection_types}),r.INVALID)};return n.common.async?Promise.all([this._def.left._parseAsync({data:n.data,path:n.path,parent:n}),this._def.right._parseAsync({data:n.data,path:n.path,parent:n})]).then((([e,t])=>a(e,t))):a(this._def.left._parseSync({data:n.data,path:n.path,parent:n}),this._def.right._parseSync({data:n.data,path:n.path,parent:n}))}}t.ZodIntersection=ZodIntersection,ZodIntersection.create=(e,t,n)=>new ZodIntersection({left:e,right:t,typeName:O.ZodIntersection,...u(n)});class ZodTuple extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==s.ZodParsedType.array)return(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.array,received:n.parsedType}),r.INVALID;if(n.data.length<this._def.items.length)return(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.INVALID;!this._def.rest&&n.data.length>this._def.items.length&&((0,r.addIssueToContext)(n,{code:o.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...n.data].map(((e,t)=>{const a=this._def.items[t]||this._def.rest;return a?a._parse(new ParseInputLazyPath(n,e,n.path,t)):null})).filter((e=>!!e));return n.common.async?Promise.all(a).then((e=>r.ParseStatus.mergeArray(t,e))):r.ParseStatus.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new ZodTuple({...this._def,rest:e})}}t.ZodTuple=ZodTuple,ZodTuple.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:e,typeName:O.ZodTuple,rest:null,...u(t)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==s.ZodParsedType.object)return(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.object,received:n.parsedType}),r.INVALID;const a=[],i=this._def.keyType,l=this._def.valueType;for(const e in n.data)a.push({key:i._parse(new ParseInputLazyPath(n,e,n.path,e)),value:l._parse(new ParseInputLazyPath(n,n.data[e],n.path,e))});return n.common.async?r.ParseStatus.mergeObjectAsync(t,a):r.ParseStatus.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,n){return new ZodRecord(t instanceof ZodType?{keyType:e,valueType:t,typeName:O.ZodRecord,...u(n)}:{keyType:ZodString.create(),valueType:e,typeName:O.ZodRecord,...u(t)})}}t.ZodRecord=ZodRecord;class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==s.ZodParsedType.map)return(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.map,received:n.parsedType}),r.INVALID;const a=this._def.keyType,i=this._def.valueType,l=[...n.data.entries()].map((([e,t],r)=>({key:a._parse(new ParseInputLazyPath(n,e,n.path,[r,"key"])),value:i._parse(new ParseInputLazyPath(n,t,n.path,[r,"value"]))})));if(n.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const n of l){const a=await n.key,i=await n.value;if("aborted"===a.status||"aborted"===i.status)return r.INVALID;"dirty"!==a.status&&"dirty"!==i.status||t.dirty(),e.set(a.value,i.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const n of l){const a=n.key,i=n.value;if("aborted"===a.status||"aborted"===i.status)return r.INVALID;"dirty"!==a.status&&"dirty"!==i.status||t.dirty(),e.set(a.value,i.value)}return{status:t.value,value:e}}}}t.ZodMap=ZodMap,ZodMap.create=(e,t,n)=>new ZodMap({valueType:t,keyType:e,typeName:O.ZodMap,...u(n)});class ZodSet extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.parsedType!==s.ZodParsedType.set)return(0,r.addIssueToContext)(n,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.set,received:n.parsedType}),r.INVALID;const a=this._def;null!==a.minSize&&n.data.size<a.minSize.value&&((0,r.addIssueToContext)(n,{code:o.ZodIssueCode.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),null!==a.maxSize&&n.data.size>a.maxSize.value&&((0,r.addIssueToContext)(n,{code:o.ZodIssueCode.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());const i=this._def.valueType;function l(e){const n=new Set;for(const a of e){if("aborted"===a.status)return r.INVALID;"dirty"===a.status&&t.dirty(),n.add(a.value)}return{status:t.value,value:n}}const u=[...n.data.values()].map(((e,t)=>i._parse(new ParseInputLazyPath(n,e,n.path,t))));return n.common.async?Promise.all(u).then((e=>l(e))):l(u)}min(e,t){return new ZodSet({...this._def,minSize:{value:e,message:i.errorUtil.toString(t)}})}max(e,t){return new ZodSet({...this._def,maxSize:{value:e,message:i.errorUtil.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}t.ZodSet=ZodSet,ZodSet.create=(e,t)=>new ZodSet({valueType:e,minSize:null,maxSize:null,typeName:O.ZodSet,...u(t)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.ZodParsedType.function)return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.function,received:t.parsedType}),r.INVALID;function n(e,n){return(0,r.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,a.getErrorMap)(),a.defaultErrorMap].filter((e=>!!e)),issueData:{code:o.ZodIssueCode.invalid_arguments,argumentsError:n}})}function i(e,n){return(0,r.makeIssue)({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,(0,a.getErrorMap)(),a.defaultErrorMap].filter((e=>!!e)),issueData:{code:o.ZodIssueCode.invalid_return_type,returnTypeError:n}})}const l={errorMap:t.common.contextualErrorMap},u=t.data;if(this._def.returns instanceof ZodPromise){const e=this;return(0,r.OK)((async function(...t){const a=new o.ZodError([]),r=await e._def.args.parseAsync(t,l).catch((e=>{throw a.addIssue(n(t,e)),a})),s=await Reflect.apply(u,this,r);return await e._def.returns._def.type.parseAsync(s,l).catch((e=>{throw a.addIssue(i(s,e)),a}))}))}{const e=this;return(0,r.OK)((function(...t){const a=e._def.args.safeParse(t,l);if(!a.success)throw new o.ZodError([n(t,a.error)]);const r=Reflect.apply(u,this,a.data),s=e._def.returns.safeParse(r,l);if(!s.success)throw new o.ZodError([i(r,s.error)]);return s.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ZodFunction({...this._def,args:ZodTuple.create(e).rest(ZodUnknown.create())})}returns(e){return new ZodFunction({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,n){return new ZodFunction({args:e||ZodTuple.create([]).rest(ZodUnknown.create()),returns:t||ZodUnknown.create(),typeName:O.ZodFunction,...u(n)})}}t.ZodFunction=ZodFunction;class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}t.ZodLazy=ZodLazy,ZodLazy.create=(e,t)=>new ZodLazy({getter:e,typeName:O.ZodLazy,...u(t)});class ZodLiteral extends ZodType{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{received:t.data,code:o.ZodIssueCode.invalid_literal,expected:this._def.value}),r.INVALID}return{status:"valid",value:e.data}}get value(){return this._def.value}}function j(e,t){return new ZodEnum({values:e,typeName:O.ZodEnum,...u(t)})}t.ZodLiteral=ZodLiteral,ZodLiteral.create=(e,t)=>new ZodLiteral({value:e,typeName:O.ZodLiteral,...u(t)});class ZodEnum extends ZodType{_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),n=this._def.values;return(0,r.addIssueToContext)(t,{expected:s.util.joinValues(n),received:t.parsedType,code:o.ZodIssueCode.invalid_type}),r.INVALID}if(-1===this._def.values.indexOf(e.data)){const t=this._getOrReturnCtx(e),n=this._def.values;return(0,r.addIssueToContext)(t,{received:t.data,code:o.ZodIssueCode.invalid_enum_value,options:n}),r.INVALID}return(0,r.OK)(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return ZodEnum.create(e)}exclude(e){return ZodEnum.create(this.options.filter((t=>!e.includes(t))))}}t.ZodEnum=ZodEnum,ZodEnum.create=j;class ZodNativeEnum extends ZodType{_parse(e){const t=s.util.getValidEnumValues(this._def.values),n=this._getOrReturnCtx(e);if(n.parsedType!==s.ZodParsedType.string&&n.parsedType!==s.ZodParsedType.number){const e=s.util.objectValues(t);return(0,r.addIssueToContext)(n,{expected:s.util.joinValues(e),received:n.parsedType,code:o.ZodIssueCode.invalid_type}),r.INVALID}if(-1===t.indexOf(e.data)){const e=s.util.objectValues(t);return(0,r.addIssueToContext)(n,{received:n.data,code:o.ZodIssueCode.invalid_enum_value,options:e}),r.INVALID}return(0,r.OK)(e.data)}get enum(){return this._def.values}}t.ZodNativeEnum=ZodNativeEnum,ZodNativeEnum.create=(e,t)=>new ZodNativeEnum({values:e,typeName:O.ZodNativeEnum,...u(t)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==s.ZodParsedType.promise&&!1===t.common.async)return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.promise,received:t.parsedType}),r.INVALID;const n=t.parsedType===s.ZodParsedType.promise?t.data:Promise.resolve(t.data);return(0,r.OK)(n.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}t.ZodPromise=ZodPromise,ZodPromise.create=(e,t)=>new ZodPromise({type:e,typeName:O.ZodPromise,...u(t)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===O.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:n}=this._processInputParams(e),a=this._def.effect||null,i={addIssue:e=>{(0,r.addIssueToContext)(n,e),e.fatal?t.abort():t.dirty()},get path(){return n.path}};if(i.addIssue=i.addIssue.bind(i),"preprocess"===a.type){const e=a.transform(n.data,i);return n.common.issues.length?{status:"dirty",value:n.data}:n.common.async?Promise.resolve(e).then((e=>this._def.schema._parseAsync({data:e,path:n.path,parent:n}))):this._def.schema._parseSync({data:e,path:n.path,parent:n})}if("refinement"===a.type){const e=e=>{const t=a.refinement(e,i);if(n.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===n.common.async){const a=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===a.status?r.INVALID:("dirty"===a.status&&t.dirty(),e(a.value),{status:t.value,value:a.value})}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((n=>"aborted"===n.status?r.INVALID:("dirty"===n.status&&t.dirty(),e(n.value).then((()=>({status:t.value,value:n.value}))))))}if("transform"===a.type){if(!1===n.common.async){const e=this._def.schema._parseSync({data:n.data,path:n.path,parent:n});if(!(0,r.isValid)(e))return e;const s=a.transform(e.value,i);if(s instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:s}}return this._def.schema._parseAsync({data:n.data,path:n.path,parent:n}).then((e=>(0,r.isValid)(e)?Promise.resolve(a.transform(e.value,i)).then((e=>({status:t.value,value:e}))):e))}s.util.assertNever(a)}}t.ZodEffects=ZodEffects,t.ZodTransformer=ZodEffects,ZodEffects.create=(e,t,n)=>new ZodEffects({schema:e,typeName:O.ZodEffects,effect:t,...u(n)}),ZodEffects.createWithPreprocess=(e,t,n)=>new ZodEffects({schema:t,effect:{type:"preprocess",transform:e},typeName:O.ZodEffects,...u(n)});class ZodOptional extends ZodType{_parse(e){return this._getType(e)===s.ZodParsedType.undefined?(0,r.OK)(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodOptional=ZodOptional,ZodOptional.create=(e,t)=>new ZodOptional({innerType:e,typeName:O.ZodOptional,...u(t)});class ZodNullable extends ZodType{_parse(e){return this._getType(e)===s.ZodParsedType.null?(0,r.OK)(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}t.ZodNullable=ZodNullable,ZodNullable.create=(e,t)=>new ZodNullable({innerType:e,typeName:O.ZodNullable,...u(t)});class ZodDefault extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e);let n=t.data;return t.parsedType===s.ZodParsedType.undefined&&(n=this._def.defaultValue()),this._def.innerType._parse({data:n,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}t.ZodDefault=ZodDefault,ZodDefault.create=(e,t)=>new ZodDefault({innerType:e,typeName:O.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...u(t)});class ZodCatch extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),n={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:n.data,path:n.path,parent:{...n}});return(0,r.isAsync)(a)?a.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new o.ZodError(n.common.issues)},input:n.data})}))):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new o.ZodError(n.common.issues)},input:n.data})}}removeCatch(){return this._def.innerType}}t.ZodCatch=ZodCatch,ZodCatch.create=(e,t)=>new ZodCatch({innerType:e,typeName:O.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...u(t)});class ZodNaN extends ZodType{_parse(e){if(this._getType(e)!==s.ZodParsedType.nan){const t=this._getOrReturnCtx(e);return(0,r.addIssueToContext)(t,{code:o.ZodIssueCode.invalid_type,expected:s.ZodParsedType.nan,received:t.parsedType}),r.INVALID}return{status:"valid",value:e.data}}}t.ZodNaN=ZodNaN,ZodNaN.create=e=>new ZodNaN({typeName:O.ZodNaN,...u(e)}),t.BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(e){const{ctx:t}=this._processInputParams(e),n=t.data;return this._def.type._parse({data:n,path:t.path,parent:t})}unwrap(){return this._def.type}}t.ZodBranded=ZodBranded;class ZodPipeline extends ZodType{_parse(e){const{status:t,ctx:n}=this._processInputParams(e);if(n.common.async)return(async()=>{const e=await this._def.in._parseAsync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?r.INVALID:"dirty"===e.status?(t.dirty(),(0,r.DIRTY)(e.value)):this._def.out._parseAsync({data:e.value,path:n.path,parent:n})})();{const e=this._def.in._parseSync({data:n.data,path:n.path,parent:n});return"aborted"===e.status?r.INVALID:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:n.path,parent:n})}}static create(e,t){return new ZodPipeline({in:e,out:t,typeName:O.ZodPipeline})}}t.ZodPipeline=ZodPipeline;class ZodReadonly extends ZodType{_parse(e){const t=this._def.innerType._parse(e);return(0,r.isValid)(t)&&(t.value=Object.freeze(t.value)),t}}var O;t.ZodReadonly=ZodReadonly,ZodReadonly.create=(e,t)=>new ZodReadonly({innerType:e,typeName:O.ZodReadonly,...u(t)}),t.custom=(e,t={},n)=>e?ZodAny.create().superRefine(((a,i)=>{var r,s;if(!e(a)){const e="function"==typeof t?t(a):"string"==typeof t?{message:t}:t,o=null===(s=null!==(r=e.fatal)&&void 0!==r?r:n)||void 0===s||s,l="string"==typeof e?{message:e}:e;i.addIssue({code:"custom",...l,fatal:o})}})):ZodAny.create(),t.late={object:ZodObject.lazycreate},function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(O=t.ZodFirstPartyTypeKind||(t.ZodFirstPartyTypeKind={})),t.instanceof=(e,n={message:`Input not instance of ${e.name}`})=>(0,t.custom)((t=>t instanceof e),n);const S=ZodString.create;t.string=S;const k=ZodNumber.create;t.number=k;const w=ZodNaN.create;t.nan=w;const T=ZodBigInt.create;t.bigint=T;const I=ZodBoolean.create;t.boolean=I;const C=ZodDate.create;t.date=C;const M=ZodSymbol.create;t.symbol=M;const _=ZodUndefined.create;t.undefined=_;const A=ZodNull.create;t.null=A;const P=ZodAny.create;t.any=P;const F=ZodUnknown.create;t.unknown=F;const D=ZodNever.create;t.never=D;const N=ZodVoid.create;t.void=N;const R=ZodArray.create;t.array=R;const L=ZodObject.create;t.object=L;const z=ZodObject.strictCreate;t.strictObject=z;const B=ZodUnion.create;t.union=B;const q=ZodDiscriminatedUnion.create;t.discriminatedUnion=q;const $=ZodIntersection.create;t.intersection=$;const V=ZodTuple.create;t.tuple=V;const U=ZodRecord.create;t.record=U;const H=ZodMap.create;t.map=H;const Z=ZodSet.create;t.set=Z;const G=ZodFunction.create;t.function=G;const Q=ZodLazy.create;t.lazy=Q;const W=ZodLiteral.create;t.literal=W;const K=ZodEnum.create;t.enum=K;const J=ZodNativeEnum.create;t.nativeEnum=J;const Y=ZodPromise.create;t.promise=Y;const X=ZodEffects.create;t.effect=X,t.transformer=X;const ee=ZodOptional.create;t.optional=ee;const te=ZodNullable.create;t.nullable=te;const ne=ZodEffects.createWithPreprocess;t.preprocess=ne;const ae=ZodPipeline.create;t.pipeline=ae,t.ostring=()=>S().optional(),t.onumber=()=>k().optional(),t.oboolean=()=>I().optional(),t.coerce={string:e=>ZodString.create({...e,coerce:!0}),number:e=>ZodNumber.create({...e,coerce:!0}),boolean:e=>ZodBoolean.create({...e,coerce:!0}),bigint:e=>ZodBigInt.create({...e,coerce:!0}),date:e=>ZodDate.create({...e,coerce:!0})},t.NEVER=r.INVALID},function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.errorUtil=void 0,(a=t.errorUtil||(t.errorUtil={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},a.toString=e=>"string"==typeof e?e:null==e?void 0:e.message},function(e,t,n){e.exports=n(24)(5)},function(e,t,n){e.exports=n(24)(2982)},function(e,t,n){e.exports=n(24)(2993)},function(e,t,n){e.exports=n(24)(2989)},function(e,t,n){var a=n(588)("set",n(1050));a.placeholder=n(589),e.exports=a},function(e,t,n){e.exports=n(24)(3827)},function(e,t,n){e.exports={ary:n(998),assign:n(1021),clone:n(1022),curry:n(1023),forEach:n(649),isArray:n(274),isError:n(1024),isFunction:n(653),isWeakMap:n(1027),iteratee:n(1028),keys:n(703),rearg:n(1043),toInteger:n(651),toPath:n(1045)}},function(e,t,n){var a=n(449);e.exports=function(e,t,n){return t=n?void 0:t,t=e&&null==t?e.length:t,a(e,128,void 0,void 0,void 0,void 0,t)}},function(e,t,n){e.exports=n(24)(3355)},function(e,t,n){var a=n(358),i=n(359);e.exports=function(e,t,n){var r=1&t,s=a(e);return function t(){return(this&&this!==i&&this instanceof t?s:e).apply(r?n:this,arguments)}}},function(e,t,n){var a=n(640),i=n(358),r=n(641),s=n(644),o=n(650),l=n(457),u=n(359);e.exports=function(e,t,n){var c=i(e);return function i(){for(var d=arguments.length,p=Array(d),m=d,f=o(i);m--;)p[m]=arguments[m];var g=d<3&&p[0]!==f&&p[d-1]!==f?[]:l(p,f);return(d-=g.length)<n?s(e,t,r,i.placeholder,void 0,p,g,void 0,void 0,n-d):a(this&&this!==u&&this instanceof i?c:e,this,p)}}},function(e,t){e.exports=function(e,t){for(var n=e.length,a=0;n--;)e[n]===t&&++a;return a}},function(e,t,n){var a=n(452),i=n(645),r=n(1004),s=n(1006);e.exports=function(e){var t=r(e),n=s[t];if("function"!=typeof n||!(t in a.prototype))return!1;if(e===n)return!0;var o=i(n);return!!o&&e===o[0]}},function(e,t,n){var a=n(1005),i=Object.prototype.hasOwnProperty;e.exports=function(e){for(var t=e.name+"",n=a[t],r=i.call(a,t)?n.length:0;r--;){var s=n[r],o=s.func;if(null==o||o==e)return s.name}return t}},function(e,t){e.exports={}},function(e,t,n){var a=n(452),i=n(646),r=n(453),s=n(274),o=n(454),l=n(1007),u=Object.prototype.hasOwnProperty;function c(e){if(o(e)&&!s(e)&&!(e instanceof a)){if(e instanceof i)return e;if(u.call(e,"__wrapped__"))return l(e)}return new i(e)}c.prototype=r.prototype,c.prototype.constructor=c,e.exports=c},function(e,t,n){var a=n(452),i=n(646),r=n(455);e.exports=function(e){if(e instanceof a)return e.clone();var t=new i(e.__wrapped__,e.__chain__);return t.__actions__=r(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}},function(e,t,n){e.exports=n(24)(3410)},function(e,t){var n=/\{\n\/\* \[wrapped with (.+)\] \*/,a=/,? & /;e.exports=function(e){var t=e.match(n);return t?t[1].split(a):[]}},function(e,t){var n=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/;e.exports=function(e,t){var a=t.length;if(!a)return e;var i=a-1;return t[i]=(a>1?"& ":"")+t[i],t=t.join(a>2?", ":" "),e.replace(n,"{\n/* [wrapped with "+t+"] */\n")}},function(e,t,n){e.exports=n(24)(3407)},function(e,t,n){var a=n(649),i=n(1013),r=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]];e.exports=function(e,t){return a(r,(function(n){var a="_."+n[0];t&n[1]&&!i(e,a)&&e.push(a)})),e.sort()}},function(e,t,n){var a=n(1014);e.exports=function(e,t){return!(null==e||!e.length)&&a(e,t,0)>-1}},function(e,t,n){var a=n(1015),i=n(1016),r=n(1017);e.exports=function(e,t,n){return t==t?r(e,t,n):a(e,i,n)}},function(e,t){e.exports=function(e,t,n,a){for(var i=e.length,r=n+(a?1:-1);a?r--:++r<i;)if(t(e[r],r,e))return r;return-1}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,n){for(var a=n-1,i=e.length;++a<i;)if(e[a]===t)return a;return-1}},function(e,t,n){var a=n(455),i=n(456),r=Math.min;e.exports=function(e,t){for(var n=e.length,s=r(t.length,n),o=a(e);s--;){var l=t[s];e[s]=i(l,n)?o[l]:void 0}return e}},function(e,t,n){var a=n(640),i=n(358),r=n(359);e.exports=function(e,t,n,s){var o=1&t,l=i(e);return function t(){for(var i=-1,u=arguments.length,c=-1,d=s.length,p=Array(d+u),m=this&&this!==r&&this instanceof t?l:e;++c<d;)p[c]=s[c];for(;u--;)p[c++]=arguments[++i];return a(m,o?n:this,p)}}},function(e,t,n){var a=n(642),i=n(643),r=n(457),s="__lodash_placeholder__",o=128,l=Math.min;e.exports=function(e,t){var n=e[1],u=t[1],c=n|u,d=c<131,p=u==o&&8==n||u==o&&256==n&&e[7].length<=t[8]||384==u&&t[7].length<=t[8]&&8==n;if(!d&&!p)return e;1&u&&(e[2]=t[2],c|=1&n?0:4);var m=t[3];if(m){var f=e[3];e[3]=f?a(f,m,t[4]):m,e[4]=f?r(e[3],s):t[4]}return(m=t[5])&&(f=e[5],e[5]=f?i(f,m,t[6]):m,e[6]=f?r(e[5],s):t[6]),(m=t[7])&&(e[7]=m),u&o&&(e[8]=null==e[8]?t[8]:l(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=c,e}},function(e,t,n){e.exports=n(24)(3375)},function(e,t,n){var a=n(652);e.exports=function(e){return a(e,4)}},function(e,t,n){var a=n(449),i=8;function r(e,t,n){var s=a(e,i,void 0,void 0,void 0,void 0,void 0,t=n?void 0:t);return s.placeholder=r.placeholder,s}r.placeholder={},e.exports=r},function(e,t,n){var a=n(1025),i=n(454),r=n(1026);e.exports=function(e){if(!i(e))return!1;var t=a(e);return"[object Error]"==t||"[object DOMException]"==t||"string"==typeof e.message&&"string"==typeof e.name&&!r(e)}},function(e,t,n){e.exports=n(24)(356)},function(e,t,n){e.exports=n(24)(3400)},function(e,t,n){var a=n(701),i=n(454);e.exports=function(e){return i(e)&&"[object WeakMap]"==a(e)}},function(e,t,n){var a=n(652),i=n(904);e.exports=function(e){return i("function"==typeof e?e:a(e,1))}},function(e,t,n){var a=n(1030),i=n(1032),r=n(656);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?r(t[0][0],t[0][1]):function(n){return n===e||a(n,e,t)}}},function(e,t,n){var a=n(1031),i=n(654);e.exports=function(e,t,n,r){var s=n.length,o=s,l=!r;if(null==e)return!o;for(e=Object(e);s--;){var u=n[s];if(l&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++s<o;){var c=(u=n[s])[0],d=e[c],p=u[1];if(l&&u[2]){if(void 0===d&&!(c in e))return!1}else{var m=new a;if(r)var f=r(d,p,c,e,t,m);if(!(void 0===f?i(p,d,3,r,m):f))return!1}}return!0}},function(e,t,n){e.exports=n(24)(1610)},function(e,t,n){var a=n(655),i=n(905);e.exports=function(e){for(var t=i(e),n=t.length;n--;){var r=t[n],s=e[r];t[n]=[r,s,a(s)]}return t}},function(e,t,n){var a=n(654),i=n(1034),r=n(1035),s=n(658),o=n(655),l=n(656),u=n(312);e.exports=function(e,t){return s(e)&&o(t)?l(u(e),t):function(n){var s=i(n,e);return void 0===s&&s===t?r(n,e):a(t,s,3)}}},function(e,t,n){e.exports=n(24)(1918)},function(e,t,n){var a=n(1036),i=n(1037);e.exports=function(e,t){return null!=e&&i(e,t,a)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,n){var a=n(657),i=n(702),r=n(274),s=n(456),o=n(1038),l=n(312);e.exports=function(e,t,n){for(var u=-1,c=(t=a(t,e)).length,d=!1;++u<c;){var p=l(t[u]);if(!(d=null!=e&&n(e,p)))break;e=e[p]}return d||++u!=c?d:!!(c=null==e?0:e.length)&&o(c)&&s(p,c)&&(r(e)||i(e))}},function(e,t,n){e.exports=n(24)(1622)},function(e,t,n){var a=n(1040),i=n(1041),r=n(658),s=n(312);e.exports=function(e){return r(e)?a(s(e)):i(e)}},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,n){var a=n(1042);e.exports=function(e){return function(t){return a(t,e)}}},function(e,t,n){e.exports=n(24)(1632)},function(e,t,n){var a=n(449),i=n(1044)((function(e,t){return a(e,256,void 0,void 0,void 0,t)}));e.exports=i},function(e,t,n){e.exports=n(24)(3401)},function(e,t,n){var a=n(1046),i=n(455),r=n(274),s=n(1047),o=n(1048),l=n(312),u=n(1049);e.exports=function(e){return r(e)?a(e,l):s(e)?[e]:i(o(u(e)))}},function(e,t,n){e.exports=n(24)(1633)},function(e,t,n){e.exports=n(24)(818)},function(e,t,n){e.exports=n(24)(3369)},function(e,t,n){e.exports=n(24)(3371)},function(e,t,n){e.exports=n(1051)},function(e,t,n){var a=n(659);e.exports=function(e,t,n){return null==e?e:a(e,t,n)}},function(e,t,n){e.exports=n(24)(1635)},function(e,t,n){var a=n(588)("setWith",n(1054));a.placeholder=n(589),e.exports=a},function(e,t,n){e.exports=n(1055)},function(e,t,n){var a=n(659);e.exports=function(e,t,n,i){return i="function"==typeof i?i:void 0,null==e?e:a(e,t,n,i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEpicMiddleware=void 0;var a=n(3),i=n(64),r=n(662);n(458),t.createEpicMiddleware=function(e){void 0===e&&(e={});var t,n=new(0,a.queueScheduler.constructor)(a.queueScheduler.schedulerActionCtor),s=new a.Subject,o=function(o){t=o;var l=new a.Subject,u=new a.Subject,c=l.asObservable().pipe(i.observeOn(n)),d=new r.StateObservable(u.pipe(i.observeOn(n)),t.getState());return s.pipe(i.map((function(t){var n=t(c,d,e.dependencies);if(!n)throw new TypeError('Your root Epic "'+(t.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return n})),i.mergeMap((function(e){return a.from(e).pipe(i.subscribeOn(n),i.observeOn(n))}))).subscribe(t.dispatch),function(e){return function(n){var a=e(n);return u.next(t.getState()),l.next(n),a}}};return o.run=function(e){s.next(e)},o}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.combineEpics=void 0;var a=n(3);t.combineEpics=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return a.merge.apply(void 0,e.map((function(e){var n=e.apply(void 0,t);if(!n)throw new TypeError('combineEpics: one of the provided Epics "'+(e.name||"<anonymous>")+"\" does not return a stream. Double check you're not missing a return statement!");return n})))};try{Object.defineProperty(n,"name",{value:"combineEpics("+e.map((function(e){return e.name||"<anonymous>"})).join(", ")+")"})}catch(e){}return n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ofType=void 0;var a=n(64),i=(n(458),function(e,t){return e===t||"function"==typeof t&&e===t.toString()});t.ofType=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=e.length;return a.filter(1===n?function(t){return i(t.type,e[0])}:function(t){for(var a=0;a<n;a++)if(i(t.type,e[a]))return!0;return!1})}},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=n(5).i18n.translate("xpack.securitySolution.components.mlPopup.hooks.errors.siemJobFetchFailureTitle",{defaultMessage:"Security job fetch failure"})},,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return z}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(45),c=n(17),d=n(142),p=n(182),m=n(567),f=n(126),g=n(471),b=n(1306),y=n(945),v=n(570),h=n(537);const E=l()(c.EuiFlexItem).withConfig({displayName:"OverrideColumn",componentId:"sc-ssmf6u-0"})(["width:125px;max-width:125px;overflow:hidden;text-overflow:ellipsis;"]),x=l()(c.EuiFlexItem).withConfig({displayName:"OverrideValueColumn",componentId:"sc-ssmf6u-1"})(["width:30px;max-width:30px;overflow:hidden;text-overflow:ellipsis;"]),j=l()(c.EuiLink).withConfig({displayName:"StyledEuiLink",componentId:"sc-ssmf6u-2"})(["word-break:break-word;"]),O=({name:e})=>s.a.createElement(c.EuiText,{size:"s"},e),S=({description:e})=>s.a.createElement(c.EuiText,{size:"s"},e),k=({author:e})=>s.a.createElement(y.a,{badges:e,"data-test-subj":"authorPropertyValue"}),w=()=>s.a.createElement(c.EuiText,{size:"s","data-test-subj":"buildingBlockPropertyValue"},h.d),T=({severityMappingItem:e})=>s.a.createElement(c.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(E,null,s.a.createElement(c.EuiToolTip,{content:e.field,"data-test-subj":`severityOverrideField-${e.value}`},s.a.createElement("span",{"data-test-subj":"severityOverrideField"},`${e.field}:`))),s.a.createElement(x,null,s.a.createElement(c.EuiToolTip,{content:e.value,"data-test-subj":`severityOverrideValue-${e.value}`},s.a.createElement("span",{"data-test-subj":"severityOverrideValue"},Object(f.a)(e.value)))),s.a.createElement(c.EuiFlexItem,{grow:!1},s.a.createElement(c.EuiIcon,{type:"sortRight"})),s.a.createElement(c.EuiFlexItem,null,s.a.createElement(m.a,{"data-test-subj":"severityOverrideSeverity",value:e.severity}))),I=({riskScore:e})=>s.a.createElement(c.EuiText,{size:"s","data-test-subj":"riskScorePropertyValue"},e),C=({riskScoreMappingItem:e})=>s.a.createElement(c.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},s.a.createElement(E,null,s.a.createElement(c.EuiToolTip,{content:e.field,"data-test-subj":`riskScoreOverrideField-${e.value}`},s.a.createElement("span",{"data-test-subj":"riskScoreOverridePropertyFieldName"},e.field))),s.a.createElement(c.EuiFlexItem,{grow:!1},s.a.createElement(c.EuiIcon,{type:"sortRight"})),s.a.createElement(c.EuiFlexItem,{"data-test-subj":"riskScoreOverridePropertyOverride"},d.t)),M=({references:e})=>s.a.createElement(c.EuiText,{size:"s"},s.a.createElement("ul",null,e.filter((e=>!Object(u.isEmpty)(e))).map(((e,t)=>s.a.createElement("li",{"data-test-subj":"urlsDescriptionReferenceLinkItem",key:`${t}-${e}`},s.a.createElement(j,{href:e,external:!0,target:"_blank"},e)))))),_=({falsePositives:e})=>s.a.createElement(c.EuiText,{size:"s"},s.a.createElement("ul",null,e.map((e=>s.a.createElement("li",{"data-test-subj":"falsePositivesPropertyValueItem",key:`falsePositives-${e}`},e))))),A=({investigationFields:e})=>s.a.createElement(y.a,{badges:e,"data-test-subj":"investigationFieldsPropertyValue"}),P=({license:e})=>s.a.createElement(c.EuiText,{size:"s","data-test-subj":"licensePropertyValue"},e),F=({ruleNameOverride:e})=>s.a.createElement(c.EuiText,{size:"s","data-test-subj":"ruleNameOverridePropertyValue"},e),D=({threat:e})=>s.a.createElement(b.a,{threat:Object(g.a)(e),"data-test-subj":"threatPropertyValue"}),N=({threatIndicatorPath:e})=>s.a.createElement(c.EuiText,{size:"s"},e),R=({timestampOverride:e})=>s.a.createElement(c.EuiText,{size:"s","data-test-subj":"timestampOverridePropertyValue"},e),L=({tags:e})=>s.a.createElement(y.a,{badges:e,"data-test-subj":"tagsPropertyValue"}),z=({rule:e,columnWidths:t=v.a,hideName:n,hideDescription:a,...r})=>{var o,l;const u=((e,t,n)=>{const a=[];return!t&&e.name&&a.push({title:h.u,description:s.a.createElement(O,{name:e.name})}),!n&&e.description&&a.push({title:h.j,description:s.a.createElement(S,{description:e.description})}),e.author&&e.author.length>0&&a.push({title:s.a.createElement("span",{"data-test-subj":"authorPropertyTitle"},h.c),description:s.a.createElement(k,{author:e.author})}),e.building_block_type&&a.push({title:s.a.createElement("span",{"data-test-subj":"buildingBlockPropertyTitle"},h.e),description:s.a.createElement(w,null)}),e.severity&&a.push({title:s.a.createElement("span",{"data-test-subj":"severityPropertyTitle"},h.G),description:s.a.createElement(m.a,{value:e.severity,"data-test-subj":"severityPropertyValue"})}),e.severity_mapping&&e.severity_mapping.length>0&&a.push(...e.severity_mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?s.a.createElement("span",{"data-test-subj":"severityOverridePropertyTitle"},h.H):"",description:s.a.createElement(T,{severityMappingItem:e})})))),e.risk_score&&a.push({title:s.a.createElement("span",{"data-test-subj":"riskScorePropertyTitle"},h.A),description:s.a.createElement(I,{riskScore:e.risk_score})}),e.risk_score_mapping&&e.risk_score_mapping.length>0&&a.push(...e.risk_score_mapping.filter((e=>""!==e.field)).map(((e,t)=>({title:0===t?s.a.createElement("span",{"data-test-subj":"riskScoreOverridePropertyTitle"},h.B):"",description:s.a.createElement(C,{riskScoreMappingItem:Object(p.d)(e)})})))),e.references&&e.references.length>0&&a.push({title:s.a.createElement("span",{"data-test-subj":"referencesPropertyTitle"},h.x),description:s.a.createElement(M,{references:e.references})}),e.false_positives&&e.false_positives.length>0&&a.push({title:s.a.createElement("span",{"data-test-subj":"falsePositivesPropertyTitle"},h.l),description:s.a.createElement(_,{falsePositives:e.false_positives})}),e.investigation_fields&&e.investigation_fields.field_names.length>0&&a.push({title:s.a.createElement("span",{"data-test-subj":"investigationFieldsPropertyTitle"},h.q),description:s.a.createElement(A,{investigationFields:e.investigation_fields.field_names})}),e.license&&a.push({title:s.a.createElement("span",{"data-test-subj":"licensePropertyTitle"},h.s),description:s.a.createElement(P,{license:e.license})}),e.rule_name_override&&a.push({title:s.a.createElement("span",{"data-test-subj":"ruleNameOverridePropertyTitle"},h.C),description:s.a.createElement(F,{ruleNameOverride:e.rule_name_override})}),e.threat&&e.threat.length>0&&a.push({title:s.a.createElement("span",{"data-test-subj":"threatPropertyTitle"},h.M),description:s.a.createElement(D,{threat:e.threat})}),"threat_indicator_path"in e&&e.threat_indicator_path&&a.push({title:h.P,description:s.a.createElement(N,{threatIndicatorPath:e.threat_indicator_path})}),e.timestamp_override&&a.push({title:s.a.createElement("span",{"data-test-subj":"timestampOverridePropertyTitle"},h.T),description:s.a.createElement(R,{timestampOverride:e.timestamp_override})}),e.tags&&e.tags.length>0&&a.push({title:s.a.createElement("span",{"data-test-subj":"tagsPropertyTitle"},h.L),description:s.a.createElement(L,{tags:e.tags})}),a})(e,n,a);return s.a.createElement("div",null,s.a.createElement(c.EuiSpacer,{size:"m"}),s.a.createElement(c.EuiDescriptionList,i()({type:null!==(o=r.type)&&void 0!==o?o:"column",rowGutterSize:null!==(l=r.rowGutterSize)&&void 0!==l?l:"m",listItems:u,columnWidths:t,"data-test-subj":"listItemColumnStepRuleDescription"},r)))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(17),l=n(340),u=n(570),c=n(537);const d=({interval:e})=>s.a.createElement(o.EuiText,{size:"s","data-test-subj":"intervalPropertyValue"},e),p=({from:e,interval:t})=>s.a.createElement(o.EuiText,{size:"s","data-test-subj":`fromPropertyValue-${e}`},Object(l.f)(e,t)),m=({rule:e,columnWidths:t=u.a,...n})=>{var a,r;if(!e.interval||!e.from)return null;const l=[];return l.push({title:s.a.createElement("span",{"data-test-subj":"intervalPropertyTitle"},c.p),description:s.a.createElement(d,{interval:e.interval})},{title:s.a.createElement("span",{"data-test-subj":"fromPropertyTitle"},c.m),description:s.a.createElement(p,{from:e.from,interval:e.interval})}),s.a.createElement("div",{"data-test-subj":"listItemColumnStepRuleDescription"},s.a.createElement(o.EuiDescriptionList,i()({type:null!==(a=n.type)&&void 0!==a?a:"column",rowGutterSize:null!==(r=n.rowGutterSize)&&void 0!==r?r:"m",listItems:l,columnWidths:t},n)))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return ae}));var a=n(23),i=n.n(a),r=n(44),s=n.n(r),o=n(2),l=n.n(o),u=n(45),c=n(17),d=n(19),p=n(1279),m=n(328),f=n(79),g=n(247),b=n(143),y=n(1113),v=n(1083),h=n(1307),E=n(1117),x=n(1112),j=n(296),O=n(1088),S=n(307),k=n(340),w=n(1079),T=n(949),I=n(690),C=n(212),M=n(1138),_=n(945),A=n(570),P=n(537);const F=({savedQueryName:e})=>l.a.createElement(c.EuiText,{size:"s","data-test-subj":"savedQueryNamePropertyValue"},e),D=s()(c.EuiBadge).withConfig({displayName:"EuiBadgeWrap",componentId:"sc-1lxmnf2-0"})([".euiBadge__text{white-space:pre-wrap !important;}"]),N=({filters:e,dataViewId:t,index:n,"data-test-subj":a})=>{const{indexPattern:i}=Object(O.b)({dataSourceType:t?S.a.DataView:S.a.IndexPatterns,index:null!=n?n:[],dataViewId:t}),r=Object(d.mapAndFlattenFilters)(e);return l.a.createElement(c.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs","data-test-subj":a},r.map(((e,t)=>{const n=e.meta.alias?e.meta.alias:l.a.createElement(f.FilterBadgeGroup,{filters:[e],dataViews:[i]});return l.a.createElement(ie,{grow:!1,key:`filter-${t}`,"data-test-subj":`filterItem-${e.meta.key}`},l.a.createElement(D,{color:"hollow"},null!=i?n:l.a.createElement(c.EuiLoadingSpinner,{size:"m"})))})))},R=s.a.div.withConfig({displayName:"QueryContent",componentId:"sc-1lxmnf2-1"})(["white-space:pre-wrap;"]),L=({query:e,"data-test-subj":t="query"})=>l.a.createElement(R,{"data-test-subj":t},e),z=({index:e})=>l.a.createElement(_.a,{badges:e,"data-test-subj":"indexPropertyValue"}),B=({dataViewId:e})=>l.a.createElement(c.EuiText,{size:"s","data-test-subj":"dataViewIdPropertyValue"},e),q=({dataViewId:e})=>{const{data:t}=Object(C.b)().services,[n,a]=l.a.useState(""),[i,r]=l.a.useState(!1);return l.a.useEffect((()=>{t.dataViews.get(e).then((e=>{a(e.getIndexPattern())})).catch((()=>{r(!0)}))}),[t,e]),i?l.a.createElement(c.EuiText,{size:"s"},P.g):n?l.a.createElement(c.EuiText,{size:"s","data-test-subj":"dataViewIndexPatternPropertyValue"},n):l.a.createElement(c.EuiLoadingSpinner,{size:"m"})},$=({threshold:e})=>l.a.createElement("div",{"data-test-subj":"thresholdPropertyValue"},Object(u.isEmpty)(e.field[0])?`${y.x} >= ${e.value}`:`${y.w} ${Array.isArray(e.field)?e.field.join(","):e.field} >= ${e.value}`),V=({anomalyThreshold:e})=>l.a.createElement(c.EuiText,{size:"s","data-test-subj":"anomalyThresholdPropertyValue"},e),U=({jobIds:e,isInteractive:t})=>{const{jobs:n}=Object(I.a)();if(t)return l.a.createElement(w.a,{jobIds:e});const a=n.filter((t=>e.includes(t.id)));return l.a.createElement(l.a.Fragment,null,a.map((e=>{var t;return l.a.createElement(T.a,{key:e.id,jobId:e.id,jobName:null===(t=e.customSettings)||void 0===t?void 0:t.security_app_display_name})})))},H=({type:e})=>l.a.createElement(c.EuiText,{size:"s"},(e=>{switch(e){case"machine_learning":return y.n;case"query":case"saved_query":return y.q;case"threshold":return y.y;case"eql":return y.j;case"esql":return l.a.createElement(M.a,{label:y.l});case"threat_match":return y.u;case"new_terms":return y.o;default:return Object(b.a)(e)}})(e)),Z=s()(c.EuiText).withConfig({displayName:"StyledFieldTypeText",componentId:"sc-1lxmnf2-2"})(["font-size:",";font-family:",";display:inline;"],(({theme:e})=>e.eui.euiFontSizeXS),(({theme:e})=>e.eui.euiCodeFontFamily)),G=({requiredFields:e})=>l.a.createElement(c.EuiFlexGrid,{gutterSize:"s","data-test-subj":"requiredFieldsPropertyValue"},e.map(((t,n)=>l.a.createElement(c.EuiFlexItem,{grow:!1,key:t.name},l.a.createElement(c.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(p.a,{"data-test-subj":"field-type-icon",type:Object(m.c)(t.type),label:t.type})),l.a.createElement(c.EuiFlexItem,{grow:!1},l.a.createElement(Z,{grow:!1,size:"s","data-test-subj":"requiredFieldsPropertyValueItem"},` ${t.name}${n+1!==e.length?", ":""}`))))))),Q=({timelineTitle:e})=>l.a.createElement(c.EuiText,{size:"s","data-test-subj":"timelineTemplatePropertyValue"},e),W=({threatIndex:e})=>l.a.createElement(_.a,{badges:e,"data-test-subj":"threatIndexPropertyValue"}),K=({threatMapping:e})=>{const t=e.reduce(((e,t,n,{length:a})=>{const i=t.entries.reduce(((e,t,n,{length:a})=>1===a?`${t.field} ${x.d} ${t.value}`:0===n?`(${t.field} ${x.d} ${t.value})`:`${e} ${x.a} (${t.field} ${x.d} ${t.value})`),"");return 1===a?`${i}`:0===n?`(${i})`:`${e} ${x.e} (${i})`}),"");return l.a.createElement(c.EuiText,{size:"s","data-test-subj":"threatMappingPropertyValue"},t)},J=({title:e})=>l.a.createElement(h.a,{label:e}),Y=({fields:e})=>l.a.createElement(_.a,{badges:e,"data-test-subj":"alertSuppressionGroupByPropertyValue"}),X=({duration:e})=>{const t=e?`${e.value}${e.unit}`:y.b;return l.a.createElement(c.EuiText,{size:"s","data-test-subj":"alertSuppressionDurationPropertyValue"},t)},ee=({missingFieldsStrategy:e})=>{const t=e===g.a.suppress?y.c:y.a;return l.a.createElement(c.EuiText,{size:"s","data-test-subj":"alertSuppressionSuppressionFieldPropertyValue"},t)},te=({newTermsFields:e})=>l.a.createElement(_.a,{badges:e,"data-test-subj":"newTermsFieldsPropertyValue"}),ne=({historyWindowStart:e})=>{const t=e?Object(k.b)(e):"7d";return l.a.createElement(c.EuiText,{size:"s","data-test-subj":`newTermsWindowSizePropertyValue-${e}`},t)},ae=({rule:e,isInteractive:t=!1,columnWidths:n=A.a,dataTestSubj:a,...r})=>{var s,o;const{savedQuery:u}=Object(E.a)({savedQueryId:"saved_query"===e.type?e.saved_id:"",ruleType:e.type}),d=((e,t,n,a)=>{var i;const r=[];return"index"in e&&e.index&&e.index.length>0&&r.push({title:l.a.createElement("span",{"data-test-subj":"indexPropertyTitle"},P.o),description:l.a.createElement(z,{index:e.index})}),"data_view_id"in e&&e.data_view_id&&r.push({title:l.a.createElement("span",{"data-test-subj":"dataViewIdPropertyTitle"},P.f),description:l.a.createElement(B,{dataViewId:e.data_view_id})},{title:l.a.createElement("span",{"data-test-subj":"dataViewIndexPatternPropertyTitle"},P.h),description:l.a.createElement(q,{dataViewId:e.data_view_id})}),n&&(r.push({title:l.a.createElement("span",{"data-test-subj":"savedQueryNamePropertyTitle"},y.t),description:l.a.createElement(F,{savedQueryName:n.attributes.title})}),n.attributes.filters&&r.push({title:l.a.createElement("span",{"data-test-subj":"savedQueryFiltersPropertyTitle"},y.r),description:l.a.createElement(N,{filters:n.attributes.filters,"data-test-subj":"savedQueryFiltersPropertyValue"})}),"string"==typeof n.attributes.query.query&&r.push({title:l.a.createElement("span",{"data-test-subj":"savedQueryContentPropertyTitle"},y.s),description:l.a.createElement(L,{query:n.attributes.query.query,"data-test-subj":"savedQueryContentPropertyValue"})})),"filters"in e&&null!==(i=e.filters)&&void 0!==i&&i.length&&r.push({title:l.a.createElement("span",{"data-test-subj":"filtersPropertyTitle"},y.m),description:l.a.createElement(N,{filters:e.filters,dataViewId:e.data_view_id,index:e.index,"data-test-subj":"filtersPropertyValue"})}),"query"in e&&e.query&&("eql"===e.type?r.push({title:l.a.createElement("span",{"data-test-subj":"eqlQueryPropertyTitle"},y.g),description:l.a.createElement(L,{query:e.query,"data-test-subj":"eqlQueryPropertyValue"})}):"esql"===e.type?r.push({title:l.a.createElement("span",{"data-test-subj":"esqlQueryPropertyTitle"},y.k),description:l.a.createElement(L,{query:e.query,"data-test-subj":"esqlQueryPropertyValue"})}):r.push({title:l.a.createElement("span",{"data-test-subj":"customQueryPropertyTitle"},y.p),description:l.a.createElement(L,{query:e.query,"data-test-subj":"customQueryPropertyValue"})})),e.type&&r.push({title:P.D,description:l.a.createElement(H,{type:e.type})}),"anomaly_threshold"in e&&e.anomaly_threshold&&r.push({title:l.a.createElement("span",{"data-test-subj":"anomalyThresholdPropertyTitle"},P.b),description:l.a.createElement(V,{anomalyThreshold:e.anomaly_threshold})}),"machine_learning_job_id"in e&&r.push({title:l.a.createElement("span",{"data-test-subj":"mlJobPropertyTitle"},P.t),description:l.a.createElement(U,{jobIds:e.machine_learning_job_id,isInteractive:t})}),e.related_integrations&&e.related_integrations.length>0&&r.push({title:l.a.createElement("span",{"data-test-subj":"relatedIntegrationsPropertyTitle"},P.y),description:l.a.createElement(v.b,{relatedIntegrations:e.related_integrations,dataTestSubj:"relatedIntegrationsPropertyValue"})}),e.required_fields&&e.required_fields.length>0&&r.push({title:l.a.createElement("span",{"data-test-subj":"requiredFieldsPropertyTitle"},P.z),description:l.a.createElement(G,{requiredFields:e.required_fields})}),r.push({title:l.a.createElement("span",{"data-test-subj":"timelineTemplatePropertyTitle"},P.S),description:l.a.createElement(Q,{timelineTitle:e.timeline_title||j.b})}),"threshold"in e&&e.threshold&&r.push({title:l.a.createElement("span",{"data-test-subj":"thresholdPropertyTitle"},P.R),description:l.a.createElement($,{threshold:e.threshold})}),"threat_index"in e&&e.threat_index&&r.push({title:l.a.createElement("span",{"data-test-subj":"threatIndexPropertyTitle"},P.O),description:l.a.createElement(W,{threatIndex:e.threat_index})}),"threat_mapping"in e&&e.threat_mapping&&r.push({title:l.a.createElement("span",{"data-test-subj":"threatMappingPropertyTitle"},P.Q),description:l.a.createElement(K,{threatMapping:e.threat_mapping})}),"threat_filters"in e&&e.threat_filters&&e.threat_filters.length>0&&r.push({title:l.a.createElement("span",{"data-test-subj":"threatFiltersPropertyTitle"},P.N),description:l.a.createElement(N,{filters:e.threat_filters,dataViewId:e.data_view_id,index:e.index,"data-test-subj":"threatFiltersPropertyValue"})}),"threat_query"in e&&e.threat_query&&r.push({title:l.a.createElement("span",{"data-test-subj":"threatQueryPropertyTitle"},y.v),description:l.a.createElement(L,{query:e.threat_query,"data-test-subj":"threatQueryPropertyValue"})}),"alert_suppression"in e&&e.alert_suppression&&("group_by"in e.alert_suppression&&r.push({title:l.a.createElement("span",{"data-test-subj":"alertSuppressionGroupByPropertyTitle"},l.a.createElement(J,{title:P.J})),description:l.a.createElement(Y,{fields:e.alert_suppression.group_by})}),r.push({title:l.a.createElement("span",{"data-test-subj":"alertSuppressionDurationPropertyTitle"},l.a.createElement(J,{title:P.K})),description:l.a.createElement(X,{duration:e.alert_suppression.duration})}),"missing_fields_strategy"in e.alert_suppression&&r.push({title:l.a.createElement("span",{"data-test-subj":"alertSuppressionSuppressionFieldPropertyTitle"},l.a.createElement(J,{title:P.I})),description:l.a.createElement(ee,{missingFieldsStrategy:e.alert_suppression.missing_fields_strategy})})),"new_terms_fields"in e&&e.new_terms_fields&&e.new_terms_fields.length>0&&r.push({title:l.a.createElement("span",{"data-test-subj":"newTermsFieldsPropertyTitle"},P.v),description:l.a.createElement(te,{newTermsFields:e.new_terms_fields})}),"history_window_start"in e&&r.push({title:l.a.createElement("span",{"data-test-subj":"newTermsWindowSizePropertyTitle"},P.n),description:l.a.createElement(ne,{historyWindowStart:e.history_window_start})}),r})(e,t,u);return l.a.createElement("div",{"data-test-subj":a},l.a.createElement(c.EuiDescriptionList,i()({type:null!==(s=r.type)&&void 0!==s?s:"column",rowGutterSize:null!==(o=r.rowGutterSize)&&void 0!==o?o:"m",listItems:d,columnWidths:n,"data-test-subj":"listItemColumnStepRuleDescription"},r)))};var ie=s()(c.EuiFlexItem).withConfig({displayName:"_StyledEuiFlexItem",componentId:"sc-1lxmnf2-3"})({width:"100%"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(44),i=n.n(a),r=n(2),s=n.n(r),o=n(17),l=n(232);const u=i()(o.EuiSwitch).withConfig({displayName:"StaticSwitch",componentId:"sc-g8lc0e-0"})([".euiSwitch__thumb,.euiSwitch__icon{transition:none;}"]);u.displayName="StaticSwitch";const c=({job:e,isSecurityJobsLoading:t,onJobStateChange:n})=>{const[a,i]=Object(r.useState)(!1),c=Object(r.useCallback)((async t=>{i(!0),await n(e,e.latestTimestampMs||0,t.target.checked),i(!1)}),[e,i,n]);return s.a.createElement(o.EuiFlexGroup,{justifyContent:"spaceAround"},s.a.createElement(o.EuiFlexItem,{grow:!1},t||a||Object(l.b)(e.jobState,e.datafeedState)?s.a.createElement(o.EuiLoadingSpinner,{size:"m","data-test-subj":"job-switch-loader"}):s.a.createElement(u,{"data-test-subj":"job-switch",disabled:Object(l.a)(e.jobState,e.datafeedState),checked:Object(l.c)(e.jobState,e.datafeedState),onChange:c,showLabel:!1,label:""})))};c.displayName="JobSwitchComponent";const d=s.a.memo(c);d.displayName="JobSwitch"},function(e,t,n){"use strict";n.d(t,"c",(function(){return d})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m}));var a=n(2),i=n(49),r=n(48),s=n(175),o=n(178),l=n(238),u=n(1263),c=n(4);function d(e){return Object(r.useSelector)((t=>e(t[o.v][o.w])))}function p(e){const t=d(u.c),n=Object(i.useHistory)(),r=d(u.k),{state:o}=Object(i.useLocation)(),c=Object(a.useCallback)((n=>e===s.n?Object(l.k)(r,{...t,...n}):e===s.f?Object(l.l)(r,{...t,...n}):e===s.c?Object(l.i)(r,{...t,...n}):Object(l.m)(r,{...t,...n})),[e,t,r]);return Object(a.useCallback)((e=>n.push(c(e),o)),[c,n,o])}const m=()=>window.location.pathname.includes(c.Yb)&&window.location.pathname.includes("/settings")},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return $}));var a=n(2),i=n.n(a),r=n(210),s=n(1065),o=n(385),l=n(690),u=n(897),c=n(1074),d=n(44),p=n.n(d),m=n(17),f=n(5);const g=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlRunJobLabel",{defaultMessage:"Run job"}),b=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlStopJobLabel",{defaultMessage:"Stop job"}),y=(f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlAdminPermissionsRequiredDescription",{defaultMessage:"ML Admin Permissions required to perform this action"}));var v,h=n(232),E=n(949);!function(e){e.info="info",e.warning="warning",e.error="error"}(v||(v={}));const x=({message:e})=>{if(!e)return null;let t="primary",n="warning";return e.level===v.info?n="iInCircle":e.level===v.warning?t="warning":e.level===v.error&&(t="danger"),i.a.createElement(m.EuiToolTip,{content:e.text},i.a.createElement(m.EuiIcon,{"data-test-subj":"mlJobAuditIcon",type:n,color:t}))},j=Object(a.memo)(x),O=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStartedDescription",{defaultMessage:"Started"}),S=f.i18n.translate("xpack.securitySolution.detectionEngine.ruleDescription.mlJobStoppedDescription",{defaultMessage:"Stopped"}),k=({job:e})=>{const t=Object(h.c)(e.jobState,e.datafeedState),n=t?"success":"danger",a=t?O:S;return i.a.createElement(m.EuiBadge,{"data-test-subj":"machineLearningJobStatus",color:n},a)},w=Object(a.memo)(k),T=p.a.div.withConfig({displayName:"Wrapper",componentId:"sc-ilmnak-0"})(["overflow:hidden;"]),I=({job:e,switchComponent:t,...n})=>{var a;const r=Object(h.c)(e.jobState,e.datafeedState);return i.a.createElement(T,n,i.a.createElement("div",null,i.a.createElement(E.a,{jobId:e.id,jobName:null===(a=e.customSettings)||void 0===a?void 0:a.security_app_display_name}),i.a.createElement(j,{message:e.auditMessage})),i.a.createElement(m.EuiFlexGroup,{justifyContent:"flexStart"},i.a.createElement(m.EuiFlexItem,{grow:!1,style:{marginRight:"0"}},i.a.createElement(w,{job:e})),i.a.createElement(m.EuiFlexItem,{grow:!1},t),i.a.createElement(m.EuiFlexItem,{grow:!1,style:{marginLeft:"0"},"data-test-subj":"mlJobActionLabel"},r?b:g)))},C=Object(a.memo)(I),M=({job:e,loading:t,refreshJob:n})=>{const{enableDatafeed:r,disableDatafeed:s,isLoading:o}=Object(u.a)(),l=Object(a.useCallback)((async(t,a,i)=>{i?await r(e,a):await s(e),n(e)}),[r,s,e,n]),d=Object(a.useMemo)((()=>i.a.createElement(c.a,{job:e,isSecurityJobsLoading:t||o,onJobStateChange:l})),[l,o,e,t]);return i.a.createElement(C,{job:e,switchComponent:d})},_=Object(a.memo)(M),A=({jobIds:e})=>{const{loading:t,jobs:n,refetch:a,isMlAdmin:r}=Object(l.a)();if(!r)return null;const s=n.filter((t=>e.includes(t.id)));return i.a.createElement(i.a.Fragment,null,s.map((e=>i.a.createElement(_,{key:e.id,job:e,loading:t,refreshJob:a}))))},P=Object(a.memo)(A);var F=n(577),D=n(700),N=n.n(D);const R=({job:e})=>{const t=Object(a.useMemo)((()=>i.a.createElement(m.EuiToolTip,{content:y},i.a.createElement(m.EuiSwitch,{disabled:!0,"data-test-subj":"mlUserJobSwitch",showLabel:!1,label:"",checked:Object(h.c)(e.jobState,e.datafeedState),onChange:N.a}))),[e]);return i.a.createElement(C,{job:e,switchComponent:t})},L=Object(a.memo)(R),z=({jobIds:e})=>{const{isMlUser:t,jobs:n}=Object(F.b)();if(!t)return null;const a=n.filter((t=>e.includes(t.id)));return i.a.createElement(i.a.Fragment,null,a.map((e=>i.a.createElement(L,{key:e.id,job:e}))))},B=Object(a.memo)(z),q=({jobIds:e})=>{const t=Object(r.a)(),n=Object(o.a)(t);return Object(s.a)(t)?i.a.createElement(P,{jobIds:e}):n?i.a.createElement(B,{jobIds:e}):null},$=Object(a.memo)(q)},,function(e,t,n){"use strict";n.d(t,"a",(function(){return S}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(751),l=n(572);var u=n(5);u.i18n.translate("xpack.securitySolution.expandedValue.showTopN.showTopValues",{defaultMessage:"Show top values"}),u.i18n.translate("xpack.securitySolution.expandedValue.hideTopValues.HideTopValues",{defaultMessage:"Hide top values"});const c=u.i18n.translate("xpack.securitySolution.expandedValue.links.viewHostSummary",{defaultMessage:"View host summary"}),d=u.i18n.translate("xpack.securitySolution.expandedValue.links.viewUserSummary",{defaultMessage:"View user summary"}),p=u.i18n.translate("xpack.securitySolution.expandedValue.links.expandIpDetails",{defaultMessage:"Expand ip details"}),m=u.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleDetails",{defaultMessage:"View rule details"}),f=u.i18n.translate("xpack.securitySolution.expandedValue.links.viewPortDetails",{defaultMessage:"View port details"}),g=u.i18n.translate("xpack.securitySolution.expandedValue.links.viewRuleReference",{defaultMessage:"View rule reference"}),b=u.i18n.translate("xpack.securitySolution.expandedValue.links.viewEventReference",{defaultMessage:"View event reference"}),y=u.i18n.translate("xpack.securitySolution.expandedValue.links.viewIndicatorReference",{defaultMessage:"View indicator reference"});var v=n(285),h=n(272),E=n(927),x=n(878);n(110);const j=[{columnId:v.g,label:c},{columnId:"source.ip",fieldType:E.b,label:p},{columnId:"destination.ip",fieldType:E.b,label:p},{columnId:"signal.rule.name",label:m,linkField:"signal.rule.id"},...x.b.map((e=>({columnId:e,label:f}))),{columnId:v.m,label:g},{columnId:v.l,label:g},{columnId:v.e,label:b},{columnId:h.j,label:y},{columnId:v.p,label:d}],O=s.a.div.withConfig({displayName:"StyledContent",componentId:"sc-18lfxbd-0"})(["padding:",";width:100%;margin:0 auto;"],(({$isDetails:e})=>e?"0 8px":void 0)),S=({data:e,ecsData:t,eventId:n,header:r,isDetails:s,isDraggable:u,isTimeline:c,linkValues:d,rowRenderers:p,scopeId:m,truncate:f,asPlainText:g,context:b})=>{const y=Object(a.useMemo)((()=>{return void 0!==(e=r.id,t=r.type,n=r.linkField,j.find((a=>a.columnId===e||!(!a.fieldType||t!==a.fieldType||void 0===n&&void 0===a.linkField))))&&!c;var e,t,n}),[r.id,r.linkField,r.type,c]),v=Object(o.c)({data:e,fieldName:r.id}),h=s?"eui-textBreakWord":"eui-displayInlineBlock eui-textTruncate";return i.a.createElement(O,{className:h,$isDetails:s},((e,t,n,a)=>{const i=t.find((t=>t.isInstance(e,n,a)));return null!=i?i:(()=>{throw new Error("Unhandled Column Renderer")})()})(r.id,l.a,e,b).renderColumn({asPlainText:null!=g?g:y,columnName:r.id,ecsData:t,eventId:n,field:r,isDetails:s,isDraggable:u,linkValues:d,rowRenderers:p,scopeId:m,truncate:f,values:v,context:b}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n.n(a),r=n(213),s=n(415),o=n(110),l=n(474),u=n(406);const c=n(5).i18n.translate("xpack.securitySolution.detectionEngine.rulesSnoozeBadge.error.unableToFetch",{defaultMessage:"Unable to fetch snooze settings"});function d({ruleId:e,showTooltipInline:t=!1}){const n=Object(o.i)().services.triggersActionsUi.getRulesListNotifyBadge,{snoozeSettings:a,error:d}=function(e){var t,n;const{state:{rulesSnoozeSettings:a}}=null!==(t=Object(u.c)())&&void 0!==t?t:{state:{}},{data:i,isFetching:r,isError:s}=Object(l.a)([e],{enabled:!(null!=a&&a.data[e]||null!=a&&a.isFetching)}),o=null!==(n=null==a?void 0:a.data[e])&&void 0!==n?n:null==i?void 0:i[e],d=(null==a?void 0:a.isFetching)||r;return{snoozeSettings:o,error:(null==a?void 0:a.isError)||s||!o&&!d?c:void 0}}(e),[{canUserCRUD:p}]=Object(r.b)(),m=Object(s.c)(p),f=Object(l.b)();return i.a.createElement(n,{ruleId:e,snoozeSettings:a,loading:!a&&!d,disabled:!m||d,showTooltipInline:t,onRuleChanged:f})}},function(e,t,n){"use strict";n.d(t,"a",(function(){return x})),n.d(t,"b",(function(){return j})),n.d(t,"c",(function(){return O}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(1140),l=n(17),u=n(110);const c=({integration:e})=>{const t=Object(u.d)(),n=e.integrationTitle,a=`${t}/${e.targetUrl}`;return i.a.createElement(l.EuiLink,{href:a,target:"_blank","data-test-subj":"integrationLink"},n)},d=i.a.memo(c);d.displayName="IntegrationLink";var p=n(882);const m=s()(l.EuiBadge).withConfig({displayName:"PaddedBadge",componentId:"sc-63ceph-0"})(["margin-left:5px;"]),f=({integration:e})=>{const{installationStatus:t}=e;if(!t.isKnown)return null;const{isInstalled:n,isEnabled:a}=t,r=n?"success":"#E0E5EE",s=n?a?p.c:p.e:p.j,o=n?a?p.b:p.d:p.i;return i.a.createElement(l.EuiToolTip,{content:s},i.a.createElement(m,{color:r,"data-test-subj":"statusBadge"},o))},g=i.a.memo(f);g.displayName="IntegrationStatusBadge";const b=s.a.span.withConfig({displayName:"VersionWarningIconContainer",componentId:"sc-8orjjk-0"})(["margin-left:5px;"]),y=({integration:e})=>{const{installationStatus:t}=e;return t.isKnown&&t.isInstalled&&t.isVersionMismatch?i.a.createElement(b,null,i.a.createElement(l.EuiIconTip,{type:"warning",color:"warning",content:p.f(t.installedVersion,e.requiredVersion)})):null},v=i.a.memo(y);v.displayName="IntegrationVersionMismatchIcon";const h=s.a.div.withConfig({displayName:"Wrapper",componentId:"sc-hszsn0-0"})(["overflow:hidden;"]),E=({integration:e,dataTestSubj:t="integrationDescription"})=>i.a.createElement(h,{"data-test-subj":`${t}-${e.packageName}`},i.a.createElement(d,{integration:e})," ",i.a.createElement(g,{integration:e}),i.a.createElement(v,{integration:e})),x=i.a.memo(E),j=({relatedIntegrations:e,dataTestSubj:t="relatedIntegrationsDescription"})=>{const{integrations:n}=Object(o.a)(e);return i.a.createElement(i.a.Fragment,null,n.map(((e,n)=>i.a.createElement(x,{key:`${e.packageName}-${n}`,integration:e,dataTestSubj:t}))))},O=(e,t)=>null==t||0===t.length?[]:[{title:e,description:i.a.createElement(j,{relatedIntegrations:t})}]},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var a=n(9),i=n(5),r=n(17),s=n(2),o=n.n(s),l=n(53),u=n(883),c=n(231),d=n(4),p=n(232),m=n(146),f=n(307),g=n(893),b=n(169),y=n(110),v=n(682);const h=i.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.unknownError",{defaultMessage:"Unknown error while validating ES|QL"}),E=i.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.missingIdInQueryError",{defaultMessage:"Queries that donâ€™t use the STATS...BY function (non-aggregating queries) must include the [metadata _id, _version, _index] operator after the source command. For example: FROM logs* [metadata _id, _version, _index].  In addition, the metadata properties (_id, _version, and _index)  must be returned in the query response."});var x=n(1141);let j;!function(e){e.INVALID_ESQL="ERR_INVALID_ESQL",e.ERR_MISSING_ID_FIELD_FROM_RESULT="ERR_MISSING_ID_FIELD_FROM_RESULT"}(j||(j={}));const O=e=>{return{code:j.INVALID_ESQL,message:null!=e&&e.message?(t=e.message,i.i18n.translate("xpack.securitySolution.detectionEngine.esqlValidation.errorMessage",{values:{message:t},defaultMessage:'Error validating ES|QL: "{message}"'})):h,error:e};var t};var S=n(683),k=n(1118);const w={index:{defaultValue:[],fieldsToValidateOnChange:["index","queryBar"],type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fiedIndexPatternsLabel",{defaultMessage:"Index patterns"}),helpText:o.a.createElement(r.EuiText,{size:"xs"},S.l),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(!Object(p.d)(t.ruleType)&&!Object(c.c)(t.ruleType)&&t.dataSourceType===f.a.IndexPatterns)return m.h.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.outputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}}]},dataViewId:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewSelector",{defaultMessage:"Data view"}),fieldsToValidateOnChange:["dataViewId"],validations:[{validator:(...e)=>{const[{path:t,formData:n}]=e,a=null!=n.dataViewId&&""!==n.dataViewId;if(!Object(p.d)(n.ruleType)&&!a&&n.dataSourceType===f.a.DataView)return{path:t,message:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.dataViewSelectorFieldRequired",{defaultMessage:"Please select an available Data View or Index Pattern."})}}}]},dataViewTitle:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.dataViewTitleSelector",{defaultMessage:"Data view index pattern"}),validations:[]},eqlOptions:{},queryBar:{fieldsToValidateOnChange:["queryBar"],validations:[{validator:(...e)=>{const[{value:t,path:n,formData:i}]=e,{query:r,filters:s,saved_id:o}=t;if(!Object(p.d)(i.ruleType)&&Object(a.isEmpty)(r.query)&&Object(a.isEmpty)(s)&&!o)return{code:"ERR_FIELD_MISSING",path:n,message:Object(k.a)(i.ruleType)}}},{validator:(...e)=>{const[{value:t,path:n,formData:i}]=e,{query:r}=t;if(!Object(p.d)(i.ruleType)&&!Object(a.isEmpty)(r.query)&&"kuery"===r.language)try{Object(l.fromKueryExpression)(r.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:n,message:S.m}}}},{validator:Object(g.a)(g.b,300)},{validator:Object(g.a)((async(...e)=>{const[{value:t,formData:n}]=e,{query:i}=t,r=i.query,{ruleType:s}=n;if(Object(c.c)(s)&&!Object(a.isEmpty)(r))try{var o;const e=y.b.get(),t=Object(b.e)(r);if(!t&&!/(?<!\|[\s\S.]*)\[\s*metadata[\s\S.]*_id[\s\S.]*\]/i.test(r))return{code:j.ERR_MISSING_ID_FIELD_FROM_RESULT,message:E};const n=await v.b.fetchQuery(Object(x.a)({esqlQuery:r,expressions:e.expressions}));if(n&&"error"in n)return O(n.error);const a=(null!==(o=null==n?void 0:n.columns)&&void 0!==o?o:[]).find((({id:e})=>"_id"===e));if(!t&&!a)return{code:j.ERR_MISSING_ID_FIELD_FROM_RESULT,message:E}}catch(e){return O(e)}}),300)}]},ruleType:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldRuleTypeLabel",{defaultMessage:"Rule type"}),validations:[]},anomalyThreshold:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldAnomalyThresholdLabel",{defaultMessage:"Anomaly score threshold"}),validations:[]},machineLearningJobId:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldMachineLearningJobIdLabel",{defaultMessage:"Machine Learning job"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(p.d)(t.ruleType))return m.h.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.machineLearningJobIdRequired",{defaultMessage:"A Machine Learning job is required."}))(...e)}}]},relatedIntegrations:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsLabel",{defaultMessage:"Related integrations"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRelatedIntegrationsHelpText",{defaultMessage:"Integration related to this Rule."})},requiredFields:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsLabel",{defaultMessage:"Required fields"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRequiredFieldsHelpText",{defaultMessage:"Fields required for this Rule to function."})},timeline:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateLabel",{defaultMessage:"Timeline template"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimelineTemplateHelpText",{defaultMessage:"Select which timeline to use when investigating generated alerts."})},threshold:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdLabel",{defaultMessage:"Threshold"}),field:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldLabel",{defaultMessage:"Group by"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdFieldHelpText",{defaultMessage:"Select fields to group by. Fields are joined together with 'AND'"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(c.h)(t.ruleType))return m.h.maxLengthField({length:3,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdFieldFieldData.arrayLengthGreaterThanMaxErrorMessage",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},value:{type:m.a.NUMBER,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThresholdValueLabel",{defaultMessage:"Threshold"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(c.h)(t.ruleType))return m.h.numberGreaterThanField({than:1,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]},cardinality:{field:{defaultValue:[],fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityFieldLabel",{defaultMessage:"Count"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(c.h)(t.ruleType))return Object(a.isEmpty)(t["threshold.cardinality.field"])&&!Object(a.isEmpty)(t["threshold.cardinality.value"])?m.h.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityFieldFieldData.thresholdCardinalityFieldNotSuppliedMessage",{defaultMessage:"A Cardinality Field is required."}))(...e):void 0}}],helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdFieldCardinalityFieldHelpText",{defaultMessage:"Select a field to check cardinality"})},value:{fieldsToValidateOnChange:["threshold.cardinality.field","threshold.cardinality.value"],type:m.a.NUMBER,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThresholdCardinalityValueFieldLabel",{defaultMessage:"Unique values"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(c.h)(t.ruleType))return Object(a.isEmpty)(t["threshold.cardinality.field"])?void 0:m.h.numberGreaterThanField({than:1,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.thresholdCardinalityValueFieldData.numberGreaterThanOrEqualOneErrorMessage",{defaultMessage:"Value must be greater than or equal to one."}),allowEquality:!0})(...e)}}]}}},threatIndex:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatIndexPatternsLabel",{defaultMessage:"Indicator index patterns"}),helpText:o.a.createElement(r.EuiText,{size:"xs"},S.t),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(c.g)(t.ruleType))return m.h.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.threatMatchoutputIndiceNameFieldRequiredError",{defaultMessage:"A minimum of one index pattern is required."}))(...e)}},{validator:(...e)=>{const[{formData:t,value:n}]=e;if(Object(c.g)(t.ruleType))return u.b.forbiddenField(n,"*")}}]},threatMapping:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatMappingLabel",{defaultMessage:"Indicator mapping"}),validations:[{validator:(...e)=>{const[{path:t,formData:n}]=e;if(Object(c.g)(n.ruleType))return Object(u.j)(n.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:S.u}:Object(u.a)(n.threatMapping)?{code:"ERR_FIELD_MISSING",path:t,message:S.s}:void 0}}]},threatQueryBar:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldThreatQueryBarLabel",{defaultMessage:"Indicator index query"}),validations:[{validator:(...e)=>{const[{value:t,path:n,formData:i}]=e;if(!Object(c.g)(i.ruleType))return;const{query:r,filters:s}=t;return Object(a.isEmpty)(r.query)&&Object(a.isEmpty)(s)?{code:"ERR_FIELD_MISSING",path:n,message:S.f}:void 0}},{validator:(...e)=>{const[{value:t,path:n,formData:i}]=e;if(!Object(c.g)(i.ruleType))return;const{query:r}=t;if(!Object(a.isEmpty)(r.query)&&"kuery"===r.language)try{Object(l.fromKueryExpression)(r.query)}catch(e){return{code:"ERR_FIELD_FORMAT",path:n,message:S.m}}}}]},groupByFields:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsLabel",{defaultMessage:"Suppress alerts by"}),labelAppend:o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByFieldsLabelAppend",{defaultMessage:"Optional (Technical Preview)"})),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldGroupByFieldHelpText",{defaultMessage:"Select field(s) to use for suppressing extra alerts"}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(c.f)(t.ruleType))return m.h.maxLengthField({length:3,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.groupByFieldsMax",{defaultMessage:"Number of grouping fields must be at most 3"})})(...e)}}]},groupByRadioSelection:{},groupByDuration:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.groupByDurationValueLabel",{defaultMessage:"Suppress alerts for"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.fieldGroupByDurationValueHelpText",{defaultMessage:"Suppress alerts for"}),value:{},unit:{}},suppressionMissingFields:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.suppressionMissingFieldsLabel",{defaultMessage:"If a suppression field is missing"})},newTermsFields:{type:m.a.COMBO_BOX,label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsLabel",{defaultMessage:"Fields"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNewTermsFieldHelpText",{defaultMessage:"Select a field to check for new terms."}),validations:[{validator:(...e)=>{const[{formData:t}]=e;if(Object(c.e)(t.ruleType))return m.h.emptyField(i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.newTermsFieldsMin",{defaultMessage:"A minimum of one field is required."}))(...e)}},{validator:(...e)=>{const[{formData:t}]=e;if(Object(c.e)(t.ruleType))return m.h.maxLengthField({length:d.Mb,message:i.i18n.translate("xpack.securitySolution.detectionEngine.validations.stepDefineRule.newTermsFieldsMax",{defaultMessage:"Number of fields must be 3 or less."})})(...e)}}]},historyWindowSize:{label:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepDefineRule.historyWindowSizeLabel",{defaultMessage:"History Window Size"}),helpText:i.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.historyWindowSizeHelpText",{defaultMessage:"New terms rules only alert if terms don't appear in historical data."})},shouldLoadQueryDynamically:{type:m.a.CHECKBOX,defaultValue:!1},enableThresholdSuppression:{type:m.a.CHECKBOX,defaultValue:!1}}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return f}));var a=n(2),i=n(231),r=n(307),s=n(110),o=n(146),l=n(1086),u=n(1139),c=n(1119),d=n(1130),p=n(241);const m=({defineStepDefault:e,aboutStepDefault:t,scheduleStepDefault:n,actionsStepDefault:r})=>{const{triggersActionsUi:{actionTypeRegistry:p}}=Object(s.i)().services,{form:m}=Object(o.k)({defaultValue:e,options:{stripEmptyFields:!1},schema:l.a}),[f,g]=Object(a.useState)(e.eqlOptions),[b]=Object(o.m)({form:m}),y=Object(a.useMemo)((()=>"index"in b?{...b,eqlOptions:f}:e),[e,b,f]),v=Object(a.useMemo)((()=>Object(i.g)(y.ruleType)?u.b:u.a),[y.ruleType]),{form:h}=Object(o.k)({defaultValue:t,options:{stripEmptyFields:!1},schema:v}),[E]=Object(o.m)({form:h}),x="name"in E?E:t,{form:j}=Object(o.k)({defaultValue:n,options:{stripEmptyFields:!1},schema:c.a}),[O]=Object(o.m)({form:j}),S="interval"in O?O:n,k=Object(a.useMemo)((()=>(({actionTypeRegistry:e})=>({actions:{validations:[{validator:Object(d.a)(e)}]},responseActions:{},enabled:{},kibanaSiemAppUrl:{}}))({actionTypeRegistry:p})),[p]),{form:w}=Object(o.k)({defaultValue:r,options:{stripEmptyFields:!1},schema:k}),[T]=Object(o.m)({form:w});return{defineStepForm:m,defineStepData:y,aboutStepForm:h,aboutStepData:x,scheduleStepForm:j,scheduleStepData:S,actionsStepForm:w,actionsStepData:"actions"in T?T:r,eqlOptionsSelected:f,setEqlOptionsSelected:g}},f=({dataSourceType:e,index:t,dataViewId:n})=>{const{data:i}=Object(s.i)().services,[o,{browserFields:l,indexPatterns:u}]=Object(p.b)(t),[c,d]=Object(a.useState)(u);return Object(a.useEffect)((()=>{e!==r.a.IndexPatterns||o||d(u),e===r.a.DataView&&(async()=>{if(null!=n){const e=await i.dataViews.get(n);d(e)}})()}),[e,o,i,n,u]),{indexPattern:c,isIndexPatternLoading:o,browserFields:l}}},,,,,,,,,,,function(e,t,n){e.exports=n(24)(1233)},,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n.n(a),r=n(44),s=n.n(r),o=n(17);const l=s.a.div.withConfig({displayName:"StatusTextWrapper",componentId:"sc-1nku0d-0"})(["width:100%;display:inline-grid;"]),u=({tooltipContent:e,children:t,healthColor:n,dataTestSubj:a})=>i.a.createElement(o.EuiToolTip,{content:e},i.a.createElement(o.EuiHealth,{color:n,"data-test-subj":a},i.a.createElement(l,null,i.a.createElement("span",{className:"eui-textTruncate"},t))));u.displayName="HealthTruncateText"},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var a=n(45),i=n(17),r=n(2),s=n.n(r),o=n(324),l=n.n(o),u=n(930),c=n.n(u),d=n(44),p=n.n(d),m=n(72),f=n(47),g=n(142),b=n(4),y=n(146),v=n(110),h=n(943);const E=[{isSummaryOption:!0,isForEachAlertOption:!0,value:{value:"onActiveAlert",inputDisplay:h.d,"data-test-subj":"onActiveAlert",dropdownDisplay:s.a.createElement(i.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(f.FormattedMessage,{defaultMessage:"Per rule run",id:"xpack.securitySolution.detectionEngine.ruleNotifyWhen.onActiveAlert.label"})))}},{isSummaryOption:!0,isForEachAlertOption:!1,value:{value:"onThrottleInterval",inputDisplay:h.a,"data-test-subj":"onThrottleInterval",dropdownDisplay:s.a.createElement(i.EuiText,{size:"s"},s.a.createElement("p",null,s.a.createElement(f.FormattedMessage,{defaultMessage:"Custom frequency",id:"xpack.securitySolution.detectionEngine.ruleNotifyWhen.onThrottleInterval.label"})))}}],x=p.a.div.withConfig({displayName:"FieldErrorsContainer",componentId:"sc-kyvj3t-0"})(["p{margin-bottom:0;}"]),j=p.a.div.attrs((({className:e="",$caseIndexes:t=[]})=>({className:e}))).withConfig({displayName:"ContainerActions",componentId:"sc-kyvj3t-1"})(["",""],(({$caseIndexes:e})=>e.map((e=>`\n        div[id="${e}"].euiAccordion__childWrapper .euiAccordion__children {\n          padding: 0px;\n          .euiFlexGroup {\n            display: none;\n          }\n          .euiSpacer.euiSpacer--xl {\n            height: 0px;\n          }\n        }\n      `)))),O=({field:e,messageVariables:t,summaryMessageVariables:n})=>{const[o,u]=Object(r.useState)(null),d=Object(y.l)(),{isValid:p}=d,{triggersActionsUi:{getActionForm:f}}=Object(v.i)().services,[O,S]=Object(r.useState)(!1),k=Object(r.useMemo)((()=>Object(a.isEmpty)(e.value)?[]:e.value),[e.value]),w=Object(r.useMemo)((()=>k.reduce(((e,t,n)=>".case"===t.actionTypeId?[...e,`${n}`]:e),[])),[k]),T=Object(r.useCallback)(((t,n)=>{const i=[...k];Object(a.isEmpty)(i[n].params)&&S(!0),i[n]=l()(i[n],{id:t}),e.setValue(i)}),[e,k]),I=Object(r.useCallback)((t=>e.setValue(t)),[e]),C=Object(r.useCallback)(((t,n,a)=>{const i=()=>{e.setValue((e=>{const i=[...e];return i[a]={...i[a],params:{...i[a].params,[t]:n}},i}))};O?(setTimeout(i,0),S(!1)):i()}),[e,O]),M=Object(r.useCallback)(((t,n,i)=>{e.setValue((e=>{const r=[...e],{alertsFilter:s,...o}=r[i],l={...s};return n?l[t]=n:delete l[t],r[i]={...o,...Object(a.isEmpty)(l)?{}:{alertsFilter:l}},r}))}),[e]),_=Object(r.useCallback)(((t,n,a)=>{e.setValue((e=>{var i;const r=[...e];return r[a]={...r[a],frequency:{...null!==(i=r[a].frequency)&&void 0!==i?i:b.Sb,[t]:n}},r}))}),[e]),A=void 0!==p,P=Object(r.useMemo)((()=>f({actions:k,messageVariables:t,summaryMessageVariables:n,defaultActionGroupId:"default",setActionIdByIndex:T,setActions:I,setActionParamsProperty:C,setActionFrequencyProperty:_,setActionAlertsFilterProperty:M,featureId:m.SecurityConnectorFeatureId,producerId:g.sb.SIEM,defaultActionMessage:h.c,defaultSummaryMessage:h.e,hideActionHeader:!0,hasAlertsMappings:!0,notifyWhenSelectOptions:E,defaultRuleFrequency:b.Sb,disableErrorMessages:!A})),[k,f,t,n,_,T,C,I,M,A]);return Object(r.useEffect)((()=>{if(!1===p){const t=e.errors.map((({message:e})=>e)).join("\n");return u(t)}return u(null)}),[e.errors,p]),s.a.createElement(j,{$caseIndexes:w},o?s.a.createElement(s.a.Fragment,null,s.a.createElement(x,null,s.a.createElement(i.EuiCallOut,{title:h.b,color:"danger",iconType:"warning"},s.a.createElement(c.a,null,o))),s.a.createElement(i.EuiSpacer,null)):null,P)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"d",(function(){return i})),n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s}));const a={filter:"",tags:[],showCustomRules:!1,showElasticRules:!1,enabled:void 0,ruleExecutionStatus:void 0},i={field:"enabled",order:"desc"},r=1,s=20},function(e,t,n){const a=n(173),i=n(304),{safeRe:r,t:s}=n(316);e.exports=(e,t)=>{if(e instanceof a)return e;if("number"==typeof e&&(e=String(e)),"string"!=typeof e)return null;let n=null;if((t=t||{}).rtl){let t;for(;(t=r[s.COERCERTL].exec(e))&&(!n||n.index+n[0].length!==e.length);)n&&t.index+t[0].length===n.index+n[0].length||(n=t),r[s.COERCERTL].lastIndex=t.index+t[1].length+t[2].length;r[s.COERCERTL].lastIndex=-1}else n=e.match(r[s.COERCE]);return null===n?null:i(`${n[2]}.${n[3]||"0"}.${n[4]||"0"}`,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var a=n(2),i=n(50),r=n(560),s=n(117),o=n(154);const l=({savedQueryId:e,ruleType:t,onError:n})=>{var l;const u=Object(r.a)(),{addError:c}=Object(s.a)(),d=Object(i.useQuery)(["detectionEngine","rule","savedQuery",e],(async()=>e&&"saved_query"===t?u.getSavedQuery(e):null),{onError:null!=n?n:e=>{c(e,{title:o.Lc})},retry:!1,refetchOnWindowFocus:!1}),p=Object(a.useMemo)((()=>{var e;return d.data?{saved_id:d.data.id,filters:null!==(e=d.data.attributes.filters)&&void 0!==e?e:[],query:d.data.attributes.query,title:d.data.attributes.title}:null}),[d.data]);return{isSavedQueryLoading:!!e&&d.isLoading,savedQueryBar:p,savedQuery:null!==(l=d.data)&&void 0!==l?l:void 0}}},function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return s}));var a=n(683),i=n(231);const r=e=>{const t=new Set(["string","number","ip","boolean"]);return e.filter((e=>!0===e.aggregatable&&t.has(e.type)))},s=e=>Object(i.c)(e)?a.j:Object(i.b)(e)?a.h:a.f},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(5);const i={interval:{label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalLabel",{defaultMessage:"Runs every"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldIntervalHelpText",{defaultMessage:"Rules run periodically and detect alerts within the specified time frame."})},from:{label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackLabel",{defaultMessage:"Additional look-back time"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepScheduleRule.fieldAdditionalLookBackHelpText",{defaultMessage:"Adds time to the look-back period to prevent missed alerts."})}}},,,function(e,t,n){"use strict";n.d(t,"f",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return o})),n.d(t,"e",(function(){return l})),n.d(t,"d",(function(){return u}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.users.pageTitle",{defaultMessage:"Users"}),r=a.i18n.translate("xpack.securitySolution.users.navigation.allUsersTitle",{defaultMessage:"All users"}),s=a.i18n.translate("xpack.securitySolution.users.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),o=a.i18n.translate("xpack.securitySolution.users.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),l=a.i18n.translate("xpack.securitySolution.users.navigation.riskTitle",{defaultMessage:"User risk"}),u=a.i18n.translate("xpack.securitySolution.users.navigation.eventsTitle",{defaultMessage:"Events"});a.i18n.translate("xpack.securitySolution.users.navigation.userScoreOverTimeTitle",{defaultMessage:"User risk score over time"})},,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var a=n(83),i=n(1260),r=n.n(i),s=n(45),o=n(5);const l=e=>{if(!e)return"";const t=e.split(".")[1];return t?Object(s.startCase)(t):""},u=async(e,t)=>{const n=await(async(e,t)=>{var n;const a=await(null===(n=t.get(e.actionTypeId))||void 0===n?void 0:n.validateParams(e.params));if(a){const e=Object.values(a.errors);if(e.length){const t=e.filter((e=>Object(s.isString)(e)||Object(s.isArray)(e))),n=Object(s.uniq)(Object(s.flattenDeep)(t));if(n.length)return n}}return[]})(e,t),i=(e=>{const t=[];return Object.entries(e).forEach((([e,n])=>{if(Object(s.isString)(n))try{r.a.render(n,{})}catch(n){t.push((e=>o.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepRuleActions.invalidMustacheTemplateErrorMessage",{defaultMessage:"{key} is not valid mustache template",values:{key:Object(s.startCase)(e)}}))(e))}})),t})(e.params),l=Object(a.validateActionFilterQuery)(e);return[...n,...i,...l?[l]:[]]},c=(e,t=100)=>n=>{let a=!1;const i=new Promise((i=>{setTimeout((()=>{a?i():i((e=>async(...t)=>{const[{value:n,path:a}]=t,i=[];for(const t of n){const n=await u(t,e);if(n.length){const e=l(t.actionTypeId),a=n.map((e=>`*   ${e}\n`));i.push(`\n**${e}:**\n${a.join("")}`)}}if(i.length)return{code:"ERR_FIELD_FORMAT",path:a,message:`${i.join("\n")}`}})(e)(n))}),t)}));return i.cancel=()=>{a=!0},i}},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n(2),i=n.n(a),r=n(47);const s=n(5).i18n.translate("xpack.securitySolution.detectionEngine.ruleInfo.UnknownText",{defaultMessage:"Unknown"});var o=n(155);const l=({createdBy:e,createdAt:t,"data-test-subj":n})=>i.a.createElement("div",{"data-test-subj":n},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleCreationDescription",defaultMessage:"Created by: {by} on {date}",values:{by:null!=e?e:s,date:i.a.createElement(o.a,{value:null!=t?t:(new Date).toISOString(),fieldName:"createdAt"})}}));l.displayName="CreatedBy";const u=({updatedBy:e,updatedAt:t,"data-test-subj":n})=>i.a.createElement("div",{"data-test-subj":n},i.a.createElement(r.FormattedMessage,{id:"xpack.securitySolution.detectionEngine.ruleDetails.ruleUpdateDescription",defaultMessage:"Updated by: {by} on {date}",values:{by:null!=e?e:s,date:i.a.createElement(o.a,{value:null!=t?t:(new Date).toISOString(),fieldName:"updatedAt"})}}));u.displayName="UpdatedBy"},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(50),i=(n(2),n(110));const r=["POST","/api/ml/jobs/jobs_summary"],s=(e,t)=>Object(a.useQuery)([r,e],(async({signal:t})=>(async({jobIds:e,signal:t})=>i.b.get().http.fetch("/internal/ml/jobs/jobs_summary",{method:"POST",version:"1",body:JSON.stringify({jobIds:null!=e?e:[]}),asSystemRequest:!0,signal:t}))({signal:t,...e})),{refetchIntervalInBackground:!1,staleTime:3e5,retry:!1,...t})},,function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return g}));var a=n(5),i=n(146),r=n(17),s=n(2),o=n.n(s),l=n(154);const u=o.a.createElement(r.EuiText,{color:"subdued",size:"xs"},l.Zb);var c=n(226),d=n(1157);const{emptyField:p}=i.h,m={author:{type:i.a.COMBO_BOX,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorLabel",{defaultMessage:"Author"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAuthorHelpText",{defaultMessage:"Type one or more authors for this rule. Press enter after each author to add a new one."}),labelAppend:u,validations:[{validator:p(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.authorFieldEmptyError",{defaultMessage:"An author must not be empty"})),type:i.g.ARRAY_ITEM,isBlocking:!1}]},name:{type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldNameLabel",{defaultMessage:"Name"}),validations:[{validator:p(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.nameFieldRequiredError",{defaultMessage:"A name is required."}))}]},description:{type:i.a.TEXTAREA,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldDescriptionLabel",{defaultMessage:"Description"}),validations:[{validator:p(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.descriptionFieldRequiredError",{defaultMessage:"A description is required."}))}]},isBuildingBlock:{type:i.a.CHECKBOX,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldBuildingBlockLabel",{defaultMessage:'Mark all generated alerts as "building block" alerts'}),labelAppend:u},isAssociatedToEndpointList:{type:i.a.CHECKBOX,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldAssociatedToEndpointListLabel",{defaultMessage:"Add existing Endpoint exceptions to the rule"}),labelAppend:u},severity:{value:{},mapping:{},isMappingChecked:{}},riskScore:{value:{},mapping:{},isMappingChecked:{}},references:{label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldReferenceUrlsLabel",{defaultMessage:"Reference URLs"}),labelAppend:u,validations:[{validator:(...e)=>{const[{value:t,path:n}]=e;let a=!1;return t.forEach((e=>{Object(c.c)(e)&&(a=!0)})),a?{code:"ERR_FIELD_FORMAT",path:n,message:d.k}:void 0}}]},falsePositives:{label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldFalsePositiveLabel",{defaultMessage:"False positive examples"}),labelAppend:u},investigationFields:{type:i.a.COMBO_BOX,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldCustomHighlightedFieldsLabel",{defaultMessage:"Custom highlighted fields"}),labelAppend:u},license:{type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseLabel",{defaultMessage:"License"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldLicenseHelpText",{defaultMessage:"Add a license name"}),labelAppend:u},ruleNameOverride:{type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideLabel",{defaultMessage:"Rule name override"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldRuleNameOverrideHelpText",{defaultMessage:"Choose a field from the source event to populate the rule name in the alert list."}),labelAppend:u},threat:{label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldMitreThreatLabel",{defaultMessage:"MITRE ATT&CK\\u2122"}),labelAppend:u},threatIndicatorPath:{type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),labelAppend:u},timestampOverride:{type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideLabel",{defaultMessage:"Timestamp override"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideHelpText",{defaultMessage:"Choose timestamp field used when executing rule. Pick field with timestamp closest to ingest time (e.g. event.ingested)."}),labelAppend:u},timestampOverrideFallbackDisabled:{type:i.a.CHECKBOX,defaultValue:!1,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTimestampOverrideFallbackDisabledLabel",{defaultMessage:"Do not use @timestamp as a fallback timestamp field"}),labelAppend:u},tags:{type:i.a.COMBO_BOX,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsLabel",{defaultMessage:"Tags"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldTagsHelpText",{defaultMessage:"Type one or more custom identifying tags for this rule. Press enter after each tag to begin a new one."}),labelAppend:u,validations:[{validator:p(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.tagFieldEmptyError",{defaultMessage:"A tag must not be empty"})),type:i.g.ARRAY_ITEM,isBlocking:!1}]},note:{type:i.a.TEXTAREA,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideLabel",{defaultMessage:"Investigation guide"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.guideHelpText",{defaultMessage:"Provide helpful information for analysts that are investigating detection alerts. This guide will appear on the rule details page and in timelines (as notes) created from detection alerts generated by this rule."}),labelAppend:u}},f={type:i.a.TEXT,label:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathLabel",{defaultMessage:"Indicator prefix override"}),helpText:a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.fieldThreatIndicatorPathHelpText",{defaultMessage:"Specify the document prefix containing your indicator fields. Used for enrichment of indicator match alerts."}),validations:[{validator:p(a.i18n.translate("xpack.securitySolution.detectionEngine.createRule.stepAboutRule.threatIndicatorPathFieldEmptyError",{defaultMessage:"Indicator prefix override must not be empty"})),type:i.g.FIELD}]},g={...m,threatIndicatorPath:f}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var a=n(2),i=n(9),r=n(1235),s=n.n(r);const o=(e,t)=>null==t?`${Object(i.capitalize)(e)}`:`${Object(i.capitalize)(e)} ${Object(i.capitalize)(t)}`,l=e=>{var t;return null!==(t=s.a.valid(s.a.coerce(e)))&&void 0!==t?t:""},u=(e,t,n)=>`app/integrations/detail/${n?`${e}-${n}`:e}/overview${t?`?integration=${t}`:""}`;var c=n(1326);const d=e=>{const{data:t}=Object(c.a)({packages:[]});return Object(a.useMemo)((()=>{const n=((e,t)=>((e,t)=>e.map((e=>{if(null==t)return{related:e,installed:null,isLoaded:!1};{const n=t.find((t=>t.package_name===e.package&&(null==t?void 0:t.integration_name)===(null==e?void 0:e.integration)));return{related:e,installed:null!=n?n:null,isLoaded:!0}}})))(e,t).map((e=>(e=>{var t;const{related:n,installed:a,isLoaded:i}=e,r=n.package,c=null!==(t=n.integration)&&void 0!==t?t:null,d=n.version;if(!i){const e=o(r,c),t=l(d);return{packageName:r,integrationName:c,integrationTitle:e,requiredVersion:d,targetVersion:t,targetUrl:u(r,c,t),installationStatus:{isKnown:!1}}}if(null==a){const e=o(r,c),t=l(d);return{packageName:r,integrationName:c,integrationTitle:e,requiredVersion:d,targetVersion:t,targetUrl:u(r,c,t),installationStatus:{isKnown:!0,isInstalled:!1,isEnabled:!1,isVersionMismatch:!1,installedVersion:""}}}{var p;const e=null!==(p=a.integration_title)&&void 0!==p?p:a.package_title,t=a.package_version,n=s.a.satisfies(t,d),i=n?t:l(d);return{packageName:r,integrationName:c,integrationTitle:e,requiredVersion:d,targetVersion:i,targetUrl:u(r,c,i),installationStatus:{isKnown:!0,isInstalled:!0,isEnabled:a.is_enabled,isVersionMismatch:!n,installedVersion:t}}}})(e))).sort(((e,t)=>e.integrationTitle.localeCompare(t.integrationTitle))))(e,t);return{integrations:n,isLoaded:null!=t}}),[e,t])}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(64),i=n(3),r=n(54);const s=({esqlQuery:e,expressions:t})=>{const n=`${e} | limit 0`;return{queryKey:[(null!=e?e:"").trim()],queryFn:async()=>{if(!e)return null;try{const e=await function(e,t,n){return Object(r.textBasedQueryStateToAstWithValidation)({query:e,time:void 0}).then((e=>{if(e){const n=t.run(e,null);let r,s;return n.pipe(Object(a.pluck)("result")).subscribe((e=>{const t=e;"error"===t.type?s=t.error.message:r=t})),Object(i.lastValueFrom)(n).then((()=>{if(s)throw new Error(s);return r}))}})).catch((e=>{throw new Error(e.message)}))}({esql:n},t);return e}catch(e){return{error:e}}},staleTime:6e4}}},,function(e,t,n){"use strict";e.exports=function(e,t){return t||(t={}),"string"!=typeof(e=e&&e.__esModule?e.default:e)?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),t.hash&&(e+=t.hash),/["'() \t\n]/.test(e)||t.needQuotes?'"'.concat(e.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):e)}},function(e,t,n){e.exports=n.p+"1cbd62546f764080f7071e03889e9de3.svg"},,,,,,,function(e,t,n){var a=n(703),i=n(701),r=n(702),s=n(274),o=n(1099),l=n(1152),u=n(1153),c=n(1154),d=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(s(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||c(e)||r(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(u(e))return!a(e).length;for(var n in e)if(d.call(e,n))return!1;return!0}},function(e,t,n){e.exports=n(24)(1229)},function(e,t,n){e.exports=n(24)(1232)},function(e,t,n){e.exports=n(24)(1621)},function(e,t,n){e.exports=n(24)(172)},,,,,,,,,,,,,,,,function(e,t,n){e.exports=n(24)(1919)},function(e,t,n){e.exports=n(24)(3706)},function(e,t,n){"use strict";e.exports=function(e){var t=this;this.Parser=function(n){return a(n,Object.assign({},t.data("settings"),e,{extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]}))}};var a=n(1174)},function(e,t,n){"use strict";e.exports=n(1175)},function(e,t,n){"use strict";e.exports=function(e,t,n){return"string"!=typeof t&&(n=t,t=void 0),function(e){var t=e||{},n=function(e,t){for(var n=-1;++n<t.length;)m(e,t[n]);return e}({canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:b(M),autolinkProtocol:j,autolinkEmail:j,atxHeading:b(T),blockQuote:b((function(){return{type:"blockquote",children:[]}})),characterEscape:j,characterReference:j,codeFenced:b(w),codeFencedFenceInfo:y,codeFencedFenceMeta:y,codeIndented:b(w,y),codeText:b((function(){return{type:"inlineCode",value:""}}),y),codeTextData:j,data:j,codeFlowValue:j,definition:b((function(){return{type:"definition",identifier:"",label:null,title:null,url:""}})),definitionDestinationString:y,definitionLabelString:y,definitionTitleString:y,emphasis:b((function(){return{type:"emphasis",children:[]}})),hardBreakEscape:b(I),hardBreakTrailing:b(I),htmlFlow:b(C,y),htmlFlowData:j,htmlText:b(C,y),htmlTextData:j,image:b((function(){return{type:"image",title:null,url:"",alt:null}})),label:y,link:b(M),listItem:b((function(e){return{type:"listItem",spread:e._spread,checked:null,children:[]}})),listItemValue:function(e){f("expectingFirstListItemValue")&&(this.stack[this.stack.length-2].start=parseInt(this.sliceSerialize(e),10),c("expectingFirstListItemValue"))},listOrdered:b(_,(function(){c("expectingFirstListItemValue",!0)})),listUnordered:b(_),paragraph:b((function(){return{type:"paragraph",children:[]}})),reference:function(){c("referenceType","collapsed")},referenceString:y,resourceDestinationString:y,resourceTitleString:y,setextHeading:b(T),strong:b((function(){return{type:"strong",children:[]}})),thematicBreak:b((function(){return{type:"thematicBreak"}}))},exit:{atxHeading:h(),atxHeadingSequence:function(e){this.stack[this.stack.length-1].depth||(this.stack[this.stack.length-1].depth=this.sliceSerialize(e).length)},autolink:h(),autolinkEmail:function(e){O.call(this,e),this.stack[this.stack.length-1].url="mailto:"+this.sliceSerialize(e)},autolinkProtocol:function(e){O.call(this,e),this.stack[this.stack.length-1].url=this.sliceSerialize(e)},blockQuote:h(),characterEscapeValue:O,characterReferenceMarkerHexadecimal:k,characterReferenceMarkerNumeric:k,characterReferenceValue:function(e){var t,n,a=this.sliceSerialize(e),i=f("characterReferenceType");i?(t=o(a,"characterReferenceMarkerNumeric"===i?10:16),c("characterReferenceType")):t=d(a),(n=this.stack.pop()).value+=t,n.position.end=g(e.end)},codeFenced:h((function(){var e=this.resume();this.stack[this.stack.length-1].value=e.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),c("flowCodeInside")})),codeFencedFence:function(){f("flowCodeInside")||(this.buffer(),c("flowCodeInside",!0))},codeFencedFenceInfo:function(){var e=this.resume();this.stack[this.stack.length-1].lang=e},codeFencedFenceMeta:function(){var e=this.resume();this.stack[this.stack.length-1].meta=e},codeFlowValue:O,codeIndented:h((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeText:h((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),codeTextData:O,data:O,definition:h(),definitionDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},definitionLabelString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=s(this.sliceSerialize(e)).toLowerCase()},definitionTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},emphasis:h(),hardBreakEscape:h(S),hardBreakTrailing:h(S),htmlFlow:h((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlFlowData:O,htmlText:h((function(){var e=this.resume();this.stack[this.stack.length-1].value=e})),htmlTextData:O,image:h((function(){var e=this.stack[this.stack.length-1];f("inReference")?(e.type+="Reference",e.referenceType=f("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),c("referenceType")})),label:function(){var e=this.stack[this.stack.length-1],t=this.resume();this.stack[this.stack.length-1].label=t,c("inReference",!0),"link"===this.stack[this.stack.length-1].type?this.stack[this.stack.length-1].children=e.children:this.stack[this.stack.length-1].alt=t},labelText:function(e){this.stack[this.stack.length-2].identifier=s(this.sliceSerialize(e)).toLowerCase()},lineEnding:function(e){var t=this.stack[this.stack.length-1];if(f("atHardBreak"))return t.children[t.children.length-1].position.end=g(e.end),void c("atHardBreak");!f("setextHeadingSlurpLineEnding")&&n.canContainEols.indexOf(t.type)>-1&&(j.call(this,e),O.call(this,e))},link:h((function(){var e=this.stack[this.stack.length-1];f("inReference")?(e.type+="Reference",e.referenceType=f("referenceType")||"shortcut",delete e.url,delete e.title):(delete e.identifier,delete e.label,delete e.referenceType),c("referenceType")})),listItem:h(),listOrdered:h(),listUnordered:h(),paragraph:h(),referenceString:function(e){var t=this.resume();this.stack[this.stack.length-1].label=t,this.stack[this.stack.length-1].identifier=s(this.sliceSerialize(e)).toLowerCase(),c("referenceType","full")},resourceDestinationString:function(){var e=this.resume();this.stack[this.stack.length-1].url=e},resourceTitleString:function(){var e=this.resume();this.stack[this.stack.length-1].title=e},resource:function(){c("inReference")},setextHeading:h((function(){c("setextHeadingSlurpLineEnding")})),setextHeadingLineSequence:function(e){this.stack[this.stack.length-1].depth=61===this.sliceSerialize(e).charCodeAt(0)?1:2},setextHeadingText:function(){c("setextHeadingSlurpLineEnding",!0)},strong:h(),thematicBreak:h()}},t.mdastExtensions||[]),l={};return function(e){for(var t,a=[{type:"root",children:[]}],s=[],o=[],l=-1,d={stack:a,tokenStack:s,config:n,enter:v,exit:E,buffer:y,resume:x,setData:c,getData:f};++l<e.length;)"listOrdered"!==e[l][1].type&&"listUnordered"!==e[l][1].type||("enter"===e[l][0]?o.push(l):l=u(e,o.pop(l),l));for(l=-1;++l<e.length;)t=n[e[l][0]],r.call(t,e[l][1].type)&&t[e[l][1].type].call(i({sliceSerialize:e[l][2].sliceSerialize},d),e[l][1]);if(s.length)throw new Error("Cannot close document, a token (`"+s[s.length-1].type+"`, "+p({start:s[s.length-1].start,end:s[s.length-1].end})+") is still open");return a[0].position={start:g(e.length?e[0][1].start:{line:1,column:1,offset:0}),end:g(e.length?e[e.length-2][1].end:{line:1,column:1,offset:0})},a[0]};function u(e,t,n){for(var a,i,r,s,o,l,u,c=t-1,d=-1,p=!1;++c<=n;)if("listUnordered"===(o=e[c])[1].type||"listOrdered"===o[1].type||"blockQuote"===o[1].type?("enter"===o[0]?d++:d--,u=void 0):"lineEndingBlank"===o[1].type?"enter"===o[0]&&(!a||u||d||l||(l=c),u=void 0):"linePrefix"===o[1].type||"listItemValue"===o[1].type||"listItemMarker"===o[1].type||"listItemPrefix"===o[1].type||"listItemPrefixWhitespace"===o[1].type||(u=void 0),!d&&"enter"===o[0]&&"listItemPrefix"===o[1].type||-1===d&&"exit"===o[0]&&("listUnordered"===o[1].type||"listOrdered"===o[1].type)){if(a){for(i=c,r=void 0;i--;)if("lineEnding"===(s=e[i])[1].type||"lineEndingBlank"===s[1].type){if("exit"===s[0])continue;r&&(e[r][1].type="lineEndingBlank",p=!0),s[1].type="lineEnding",r=i}else if("linePrefix"!==s[1].type&&"blockQuotePrefix"!==s[1].type&&"blockQuotePrefixWhitespace"!==s[1].type&&"blockQuoteMarker"!==s[1].type&&"listItemIndent"!==s[1].type)break;l&&(!r||l<r)&&(a._spread=!0),a.end=g(r?e[r][1].start:o[1].end),e.splice(r||c,0,["exit",a,o[2]]),c++,n++}"listItemPrefix"===o[1].type&&(a={type:"listItem",_spread:!1,start:g(o[1].start)},e.splice(c,0,["enter",a,o[2]]),c++,n++,l=void 0,u=!0)}return e[t][1]._spread=p,n}function c(e,t){l[e]=t}function f(e){return l[e]}function g(e){return{line:e.line,column:e.column,offset:e.offset}}function b(e,t){return function(n){v.call(this,e(n),n),t&&t.call(this,n)}}function y(){this.stack.push({type:"fragment",children:[]})}function v(e,t){return this.stack[this.stack.length-1].children.push(e),this.stack.push(e),this.tokenStack.push(t),e.position={start:g(t.start)},e}function h(e){return function(t){e&&e.call(this,t),E.call(this,t)}}function E(e){var t=this.stack.pop(),n=this.tokenStack.pop();if(!n)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): itâ€™s not open");if(n.type!==e.type)throw new Error("Cannot close `"+e.type+"` ("+p({start:e.start,end:e.end})+"): a different token (`"+n.type+"`, "+p({start:n.start,end:n.end})+") is open");return t.position.end=g(e.end),t}function x(){return a(this.stack.pop())}function j(e){var t=this.stack[this.stack.length-1].children,n=t[t.length-1];n&&"text"===n.type||((n={type:"text",value:""}).position={start:g(e.start)},this.stack[this.stack.length-1].children.push(n)),this.stack.push(n)}function O(e){var t=this.stack.pop();t.value+=this.sliceSerialize(e),t.position.end=g(e.end)}function S(){c("atHardBreak",!0)}function k(e){c("characterReferenceType",e.type)}function w(){return{type:"code",lang:null,meta:null,value:""}}function T(){return{type:"heading",depth:void 0,children:[]}}function I(){return{type:"break"}}function C(){return{type:"html",value:""}}function M(){return{type:"link",title:null,url:"",children:[]}}function _(e){return{type:"list",ordered:"listOrdered"===e.type,start:null,spread:e._spread,children:[]}}}(n)(c(l(n).document().write(u()(e,t,!0))))};var a=n(1176),i=n(414),r=n(931),s=n(673),o=n(1177),l=n(1178),u=n(1217),c=n(1218),d=n(936),p=n(1219);function m(e,t){var n,a;for(n in t)a=r.call(e,n)?e[n]:e[n]={},"canContainEols"===n?e[n]=[].concat(a,t[n]):Object.assign(a,t[n])}},function(e,t,n){"use strict";function a(e){return e&&(e.value||e.alt||e.title||"children"in e&&i(e.children)||"length"in e&&i(e))||""}function i(e){for(var t=[],n=-1;++n<e.length;)t[n]=a(e[n]);return t.join("")}e.exports=a},function(e,t,n){"use strict";var a=n(533);e.exports=function(e,t){var n=parseInt(e,t);return n<9||11===n||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||65535==(65535&n)||65534==(65535&n)||n>1114111?"ï¿½":a(n)}},function(e,t,n){"use strict";var a=n(1179),i=n(1180),r=n(1181),s=n(934),o=n(1184),l=n(1185),u=n(674),c=n(1188);e.exports=function(e){var t={defined:[],constructs:o([c].concat(u((e||{}).extensions))),content:n(a),document:n(i),flow:n(r),string:n(s.string),text:n(s.text)};return t;function n(e){return function(n){return l(t,e,n)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(156),i=n(171);t.tokenize=function(e){var t,n=e.attempt(this.parser.constructs.contentInitial,(function(t){if(null!==t)return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),i(e,n,"linePrefix");e.consume(t)}),(function(t){return e.enter("paragraph"),r(t)}));return n;function r(n){var a=e.enter("chunkText",{contentType:"text",previous:t});return t&&(t.next=a),t=a,s(n)}function s(t){return null===t?(e.exit("chunkText"),e.exit("paragraph"),void e.consume(t)):a(t)?(e.consume(t),e.exit("chunkText"),r):(e.consume(t),s)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(156),i=n(171),r=n(534),s={tokenize:function(e,t,n){return i(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},o={tokenize:function(e,t,n){return i(e,e.lazy(this.parser.constructs.flow,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}};t.tokenize=function(e){var t,n,i,l=this,u=[],c=0,d={tokenize:function(e,a){var i=0;return t={},c;function c(a){return i<u.length?(l.containerState=u[i][1],e.attempt(u[i][0].continuation,d,p)(a)):n.currentConstruct&&n.currentConstruct.concrete?(t.flowContinue=!0,g(a)):(l.interrupt=n.currentConstruct&&n.currentConstruct.interruptible,l.containerState={},e.attempt(s,f,g)(a))}function d(e){return i++,l.containerState._closeFlow?f(e):c(e)}function p(t){return n.currentConstruct&&n.currentConstruct.lazy?(l.containerState={},e.attempt(s,f,e.attempt(o,f,e.check(r,f,m)))(t)):f(t)}function m(e){return i=u.length,t.lazy=!0,t.flowContinue=!0,g(e)}function f(e){return t.flowEnd=!0,g(e)}function g(e){return t.continued=i,l.interrupt=l.containerState=void 0,a(e)}},partial:!0};return p;function p(t){return c<u.length?(l.containerState=u[c][1],e.attempt(u[c][0].continuation,m,f)(t)):f(t)}function m(e){return c++,p(e)}function f(a){return t&&t.flowContinue?b(a):(l.interrupt=n&&n.currentConstruct&&n.currentConstruct.interruptible,l.containerState={},e.attempt(s,g,b)(a))}function g(e){return u.push([l.currentConstruct,l.containerState]),l.containerState=void 0,f(e)}function b(t){return null===t?(E(0,!0),void e.consume(t)):(n=n||l.parser.flow(l.now()),e.enter("chunkFlow",{contentType:"flow",previous:i,_tokenizer:n}),y(t))}function y(t){return null===t?(h(e.exit("chunkFlow")),b(t)):a(t)?(e.consume(t),h(e.exit("chunkFlow")),e.check(d,v)):(e.consume(t),y)}function v(e){return E(t.continued,t&&t.flowEnd),c=0,p(e)}function h(e){i&&(i.next=e),i=e,n.lazy=t&&t.lazy,n.defineSkip(e.start),n.write(l.sliceStream(e))}function E(t,a){var r=u.length;for(n&&a&&(n.write([null]),i=n=void 0);r-- >t;)l.containerState=u[r][1],u[r][0].exit.call(l,e);u.length=t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1182),i=n(171),r=n(534);t.tokenize=function(e){var t=this,n=e.attempt(r,(function(a){if(null!==a)return e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n;e.consume(a)}),e.attempt(this.parser.constructs.flowInitial,s,i(e,e.attempt(this.parser.constructs.flow,s,e.attempt(a,s)),"linePrefix")));return n;function s(a){if(null!==a)return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),t.currentConstruct=void 0,n;e.consume(a)}}},function(e,t,n){"use strict";var a=n(156),i=n(535),r=n(933),s=n(171),o={tokenize:function(e,t){var n;return function(t){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),i(t)};function i(t){return null===t?r(t):a(t)?e.check(l,s,r)(t):(e.consume(t),i)}function r(n){return e.exit("chunkContent"),e.exit("content"),t(n)}function s(t){return e.consume(t),e.exit("chunkContent"),n=n.next=e.enter("chunkContent",{contentType:"content",previous:n}),i}},resolve:function(e){return r(e),e},interruptible:!0,lazy:!0},l={tokenize:function(e,t,n){var r=this;return function(t){return e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),s(e,o,"linePrefix")};function o(s){return null===s||a(s)?n(s):r.parser.constructs.disable.null.indexOf("codeIndented")>-1||i(r.events,"linePrefix")<4?e.interrupt(r.parser.constructs.flow,n,t)(s):t(s)}},partial:!0};e.exports=o},function(e,t,n){"use strict";var a=[].splice;e.exports=a},function(e,t,n){"use strict";var a=n(931),i=n(286),r=n(674);function s(e,t){var n,i,s,l;for(n in t)for(l in i=a.call(e,n)?e[n]:e[n]={},s=t[n])i[l]=o(r(s[l]),a.call(i,l)?i[l]:[])}function o(e,t){for(var n=-1,a=[];++n<e.length;)("after"===e[n].add?t:a).push(e[n]);return i(t,0,0,a),t}e.exports=function(e){for(var t={},n=-1;++n<e.length;)s(t,e[n]);return t}},function(e,t,n){"use strict";var a=n(414),i=n(156),r=n(675),s=n(286),o=n(674),l=n(676),u=n(1186),c=n(349),d=n(1187);e.exports=function(e,t,n){var p=n?c(n):{line:1,column:1,offset:0},m={},f=[],g=[],b=[],y={consume:function(e){i(e)?(p.line++,p.column=1,p.offset+=-3===e?2:1,w()):-1!==e&&(p.column++,p.offset++),p._bufferIndex<0?p._index++:(p._bufferIndex++,p._bufferIndex===g[p._index].length&&(p._bufferIndex=-1,p._index++)),v.previous=e},enter:function(e,t){var n=t||{};return n.type=e,n.start=x(),v.events.push(["enter",n,v]),b.push(n),n},exit:function(e){var t=b.pop();return t.end=x(),v.events.push(["exit",t,v]),t},attempt:S((function(e,t){k(e,t.from)})),check:S(O),interrupt:S(O,{interrupt:!0}),lazy:S(O,{lazy:!0})},v={previous:null,events:[],parser:e,sliceStream:E,sliceSerialize:function(e){return u(E(e))},now:x,defineSkip:function(e){m[e.line]=e.column,w()},write:function(e){return g=r(g,e),function(){for(var e,t;p._index<g.length;)if("string"==typeof(t=g[p._index]))for(e=p._index,p._bufferIndex<0&&(p._bufferIndex=0);p._index===e&&p._bufferIndex<t.length;)j(t.charCodeAt(p._bufferIndex));else j(t)}(),null!==g[g.length-1]?[]:(k(t,0),v.events=l(f,v.events,v),v.events)}},h=t.tokenize.call(v,y);return t.resolveAll&&f.push(t),p._index=0,p._bufferIndex=-1,v;function E(e){return d(g,e)}function x(){return c(p)}function j(e){h=h(e)}function O(e,t){t.restore()}function S(e,t){return function(n,i,r){var s,l,u,c;return n.tokenize||"length"in n?d(o(n)):function(e){return e in n||null in n?d(n.null?o(n[e]).concat(o(n.null)):n[e])(e):r(e)};function d(e){return s=e,m(e[l=0])}function m(e){return function(n){var i,r,s,o,l;return i=x(),r=v.previous,s=v.currentConstruct,o=v.events.length,l=Array.from(b),c={restore:function(){p=i,v.previous=r,v.currentConstruct=s,v.events.length=o,b=l,w()},from:o},u=e,e.partial||(v.currentConstruct=e),e.name&&v.parser.constructs.disable.null.indexOf(e.name)>-1?g():e.tokenize.call(t?a({},v,t):v,y,f,g)(n)}}function f(t){return e(u,c),i}function g(e){return c.restore(),++l<s.length?m(s[l]):r}}}function k(e,t){e.resolveAll&&f.indexOf(e)<0&&f.push(e),e.resolve&&s(v.events,t,v.events.length-t,e.resolve(v.events.slice(t),v)),e.resolveTo&&(v.events=e.resolveTo(v.events,v))}function w(){p.line in m&&p.column<2&&(p.column=m[p.line],p.offset+=m[p.line]-1)}}},function(e,t,n){"use strict";var a=n(533);e.exports=function(e){for(var t,n,i,r=-1,s=[];++r<e.length;){if("string"==typeof(t=e[r]))n=t;else if(-5===t)n="\r";else if(-4===t)n="\n";else if(-3===t)n="\r\n";else if(-2===t)n="\t";else if(-1===t){if(i)continue;n=" "}else n=a(t);i=-2===t,s.push(n)}return s.join("")}},function(e,t,n){"use strict";e.exports=function(e,t){var n,a=t.start._index,i=t.start._bufferIndex,r=t.end._index,s=t.end._bufferIndex;return a===r?n=[e[a].slice(i,s)]:(n=e.slice(a,r),i>-1&&(n[0]=n[0].slice(i)),s>0&&n.push(e[r].slice(0,s))),n}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(934),i=n(1189),r=n(1195),s=n(1197),o=n(1198),l=n(1200),u=n(1202),c=n(1203),d=n(1204),p=n(1205),m=n(1206),f=n(1207),g=n(1208),b=n(1211),y=n(678),v=n(1212),h=n(1213),E=n(1214),x=n(1215),j=n(1216),O=n(942),S={42:x,43:x,45:x,48:x,49:x,50:x,51:x,52:x,53:x,54:x,55:x,56:x,57:x,62:s},k={91:p},w={"-2":c,"-1":c,32:c},T={35:f,42:O,45:[j,O],60:g,61:j,95:O,96:u,126:u},I={38:l,92:o},C={"-5":E,"-4":E,"-3":E,33:v,38:l,42:i,60:[r,b],91:h,92:[m,o],93:y,95:i,96:d},M={null:[i,a.resolver]};t.contentInitial=k,t.disable={null:[]},t.document=S,t.flow=T,t.flowInitial=w,t.insideSpan=M,t.string=I,t.text=C},function(e,t,n){"use strict";var a=n(675),i=n(286),r=n(1190),s=n(1194),o=n(676),l=n(349),u={name:"attention",tokenize:function(e,t){var n,a=r(this.previous);return function(t){return e.enter("attentionSequence"),n=t,i(t)};function i(s){var o,l,u,c;return s===n?(e.consume(s),i):(o=e.exit("attentionSequence"),u=!(l=r(s))||2===l&&a,c=!a||2===a&&l,o._open=42===n?u:u&&(a||!c),o._close=42===n?c:c&&(l||!u),t(s))}},resolveAll:function(e,t){for(var n,r,u,c,d,p,m,f,g=-1;++g<e.length;)if("enter"===e[g][0]&&"attentionSequence"===e[g][1].type&&e[g][1]._close)for(n=g;n--;)if("exit"===e[n][0]&&"attentionSequence"===e[n][1].type&&e[n][1]._open&&t.sliceSerialize(e[n][1]).charCodeAt(0)===t.sliceSerialize(e[g][1]).charCodeAt(0)){if((e[n][1]._close||e[g][1]._open)&&(e[g][1].end.offset-e[g][1].start.offset)%3&&!((e[n][1].end.offset-e[n][1].start.offset+e[g][1].end.offset-e[g][1].start.offset)%3))continue;c={type:(p=e[n][1].end.offset-e[n][1].start.offset>1&&e[g][1].end.offset-e[g][1].start.offset>1?2:1)>1?"strongSequence":"emphasisSequence",start:s(l(e[n][1].end),-p),end:l(e[n][1].end)},d={type:p>1?"strongSequence":"emphasisSequence",start:l(e[g][1].start),end:s(l(e[g][1].start),p)},u={type:p>1?"strongText":"emphasisText",start:l(e[n][1].end),end:l(e[g][1].start)},r={type:p>1?"strong":"emphasis",start:l(c.start),end:l(d.end)},e[n][1].end=l(c.start),e[g][1].start=l(d.end),m=[],e[n][1].end.offset-e[n][1].start.offset&&(m=a(m,[["enter",e[n][1],t],["exit",e[n][1],t]])),m=a(m,[["enter",r,t],["enter",c,t],["exit",c,t],["enter",u,t]]),m=a(m,o(t.parser.constructs.insideSpan.null,e.slice(n+1,g),t)),m=a(m,[["exit",u,t],["enter",d,t],["exit",d,t],["exit",r,t]]),e[g][1].end.offset-e[g][1].start.offset?(f=2,m=a(m,[["enter",e[g][1],t],["exit",e[g][1],t]])):f=0,i(e,n-1,g-n+3,m),g=n+m.length-f-2;break}for(g=-1;++g<e.length;)"attentionSequence"===e[g][1].type&&(e[g][1].type="data");return e}};e.exports=u},function(e,t,n){"use strict";var a=n(287),i=n(1191),r=n(1193);e.exports=function(e){return null===e||a(e)||r(e)?1:i(e)?2:void 0}},function(e,t,n){"use strict";var a=n(1192),i=n(288)(a);e.exports=i},function(e,t,n){"use strict";e.exports=/[!-\/:-@\[-`\{-~\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]/},function(e,t,n){"use strict";var a=n(288)(/\s/);e.exports=a},function(e,t,n){"use strict";e.exports=function(e,t){return e.column+=t,e.offset+=t,e._bufferIndex+=t,e}},function(e,t,n){"use strict";var a=n(677),i=n(536),r=n(1196),s=n(935),o={name:"autolink",tokenize:function(e,t,n){var o=1;return function(t){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(t),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),l};function l(t){return a(t)?(e.consume(t),u):r(t)?p(t):n(t)}function u(e){return 43===e||45===e||46===e||i(e)?c(e):p(e)}function c(t){return 58===t?(e.consume(t),d):(43===t||45===t||46===t||i(t))&&o++<32?(e.consume(t),c):p(t)}function d(t){return 62===t?(e.exit("autolinkProtocol"),b(t)):32===t||60===t||s(t)?n(t):(e.consume(t),d)}function p(t){return 64===t?(e.consume(t),o=0,m):r(t)?(e.consume(t),p):n(t)}function m(e){return i(e)?f(e):n(e)}function f(t){return 46===t?(e.consume(t),o=0,m):62===t?(e.exit("autolinkProtocol").type="autolinkEmail",b(t)):g(t)}function g(t){return(45===t||i(t))&&o++<63?(e.consume(t),45===t?g:f):n(t)}function b(n){return e.enter("autolinkMarker"),e.consume(n),e.exit("autolinkMarker"),e.exit("autolink"),t}}};e.exports=o},function(e,t,n){"use strict";var a=n(288)(/[#-'*+\--9=?A-Z^-~]/);e.exports=a},function(e,t,n){"use strict";var a=n(258),i=n(171),r={name:"blockQuote",tokenize:function(e,t,n){var i=this;return function(t){return 62===t?(i.containerState.open||(e.enter("blockQuote",{_container:!0}),i.containerState.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(t),e.exit("blockQuoteMarker"),r):n(t)};function r(n){return a(n)?(e.enter("blockQuotePrefixWhitespace"),e.consume(n),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(n))}},continuation:{tokenize:function(e,t,n){return i(e,e.attempt(r,t,n),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}},exit:function(e){e.exit("blockQuote")}};e.exports=r},function(e,t,n){"use strict";var a=n(1199),i={name:"characterEscape",tokenize:function(e,t,n){return function(t){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(t),e.exit("escapeMarker"),i};function i(i){return a(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}};e.exports=i},function(e,t,n){"use strict";var a=n(288)(/[!-/:-@[-`{-~]/);e.exports=a},function(e,t,n){"use strict";var a=n(936),i=n(536),r=n(937),s=n(1201);function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var l=o(a),u={name:"characterReference",tokenize:function(e,t,n){var a,o,u=this,c=0;return function(t){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(t),e.exit("characterReferenceMarker"),d};function d(t){return 35===t?(e.enter("characterReferenceMarkerNumeric"),e.consume(t),e.exit("characterReferenceMarkerNumeric"),p):(e.enter("characterReferenceValue"),a=31,o=i,m(t))}function p(t){return 88===t||120===t?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(t),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),a=6,o=s,m):(e.enter("characterReferenceValue"),a=7,o=r,m(t))}function m(r){var s;return 59===r&&c?(s=e.exit("characterReferenceValue"),o!==i||l.default(u.sliceSerialize(s))?(e.enter("characterReferenceMarker"),e.consume(r),e.exit("characterReferenceMarker"),e.exit("characterReference"),t):n(r)):o(r)&&c++<a?(e.consume(r),m):n(r)}}};e.exports=u},function(e,t,n){"use strict";var a=n(288)(/[\dA-Fa-f]/);e.exports=a},function(e,t,n){"use strict";var a=n(156),i=n(287),r=n(535),s=n(171),o={name:"codeFenced",tokenize:function(e,t,n){var o,l=this,u={tokenize:function(e,t,n){var i=0;return s(e,(function(t){return e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),r(t)}),"linePrefix",this.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4);function r(t){return t===o?(e.consume(t),i++,r):i<d?n(t):(e.exit("codeFencedFenceSequence"),s(e,l,"whitespace")(t))}function l(i){return null===i||a(i)?(e.exit("codeFencedFence"),t(i)):n(i)}},partial:!0},c=r(this.events,"linePrefix"),d=0;return function(t){return e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),o=t,p(t)};function p(t){return t===o?(e.consume(t),d++,p):(e.exit("codeFencedFenceSequence"),d<3?n(t):s(e,m,"whitespace")(t))}function m(t){return null===t||a(t)?y(t):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(t))}function f(t){return null===t||i(t)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),s(e,g,"whitespace")(t)):96===t&&t===o?n(t):(e.consume(t),f)}function g(t){return null===t||a(t)?y(t):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),b(t))}function b(t){return null===t||a(t)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),y(t)):96===t&&t===o?n(t):(e.consume(t),b)}function y(n){return e.exit("codeFencedFence"),l.interrupt?t(n):v(n)}function v(t){return null===t?E(t):a(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),e.attempt(u,E,c?s(e,v,"linePrefix",c+1):v)):(e.enter("codeFlowValue"),h(t))}function h(t){return null===t||a(t)?(e.exit("codeFlowValue"),v(t)):(e.consume(t),h)}function E(n){return e.exit("codeFenced"),t(n)}},concrete:!0};e.exports=o},function(e,t,n){"use strict";var a=n(156),i=n(286),r=n(535),s=n(171),o={name:"codeIndented",tokenize:function(e,t,n){return e.attempt(l,i,n);function i(n){return null===n?t(n):a(n)?e.attempt(l,i,t)(n):(e.enter("codeFlowValue"),r(n))}function r(t){return null===t||a(t)?(e.exit("codeFlowValue"),i(t)):(e.consume(t),r)}},resolve:function(e,t){var n={type:"codeIndented",start:e[0][1].start,end:e[e.length-1][1].end};return i(e,0,0,[["enter",n,t]]),i(e,e.length,0,[["exit",n,t]]),e}},l={tokenize:function(e,t,n){var i=this;return s(e,(function o(l){return a(l)?(e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),s(e,o,"linePrefix",5)):r(i.events,"linePrefix")<4?n(l):t(l)}),"linePrefix",5)},partial:!0};e.exports=o},function(e,t,n){"use strict";var a=n(156),i={name:"codeText",tokenize:function(e,t,n){var i,r,s=0;return function(t){return e.enter("codeText"),e.enter("codeTextSequence"),o(t)};function o(t){return 96===t?(e.consume(t),s++,o):(e.exit("codeTextSequence"),l(t))}function l(t){return null===t?n(t):96===t?(r=e.enter("codeTextSequence"),i=0,c(t)):32===t?(e.enter("space"),e.consume(t),e.exit("space"),l):a(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l):(e.enter("codeTextData"),u(t))}function u(t){return null===t||32===t||96===t||a(t)?(e.exit("codeTextData"),l(t)):(e.consume(t),u)}function c(n){return 96===n?(e.consume(n),i++,c):i===s?(e.exit("codeTextSequence"),e.exit("codeText"),t(n)):(r.type="codeTextData",u(n))}},resolve:function(e){var t,n,a=e.length-4,i=3;if(!("lineEnding"!==e[i][1].type&&"space"!==e[i][1].type||"lineEnding"!==e[a][1].type&&"space"!==e[a][1].type))for(t=i;++t<a;)if("codeTextData"===e[t][1].type){e[a][1].type=e[i][1].type="codeTextPadding",i+=2,a-=2;break}for(t=i-1,a++;++t<=a;)void 0===n?t!==a&&"lineEnding"!==e[t][1].type&&(n=t):t!==a&&"lineEnding"!==e[t][1].type||(e[n][1].type="codeTextData",t!==n+2&&(e[n][1].end=e[t-1][1].end,e.splice(n+2,t-n-2),a-=t-n-2,t=n+2),n=void 0);return e},previous:function(e){return 96!==e||"characterEscape"===this.events[this.events.length-1][1].type}};e.exports=i},function(e,t,n){"use strict";var a=n(156),i=n(287),r=n(673),s=n(938),o=n(939),l=n(171),u=n(940),c=n(941),d={name:"definition",tokenize:function(e,t,n){var i,c=this;return function(t){return e.enter("definition"),o.call(c,e,d,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(t)};function d(t){return i=r(c.sliceSerialize(c.events[c.events.length-1][1]).slice(1,-1)),58===t?(e.enter("definitionMarker"),e.consume(t),e.exit("definitionMarker"),u(e,s(e,e.attempt(p,l(e,m,"whitespace"),l(e,m,"whitespace")),n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString"))):n(t)}function m(r){return null===r||a(r)?(e.exit("definition"),c.parser.defined.indexOf(i)<0&&c.parser.defined.push(i),t(r)):n(r)}}},p={tokenize:function(e,t,n){return function(t){return i(t)?u(e,r)(t):n(t)};function r(t){return 34===t||39===t||40===t?c(e,l(e,s,"whitespace"),n,"definitionTitle","definitionTitleMarker","definitionTitleString")(t):n(t)}function s(e){return null===e||a(e)?t(e):n(e)}},partial:!0};e.exports=d},function(e,t,n){"use strict";var a=n(156),i={name:"hardBreakEscape",tokenize:function(e,t,n){return function(t){return e.enter("hardBreakEscape"),e.enter("escapeMarker"),e.consume(t),i};function i(i){return a(i)?(e.exit("escapeMarker"),e.exit("hardBreakEscape"),t(i)):n(i)}}};e.exports=i},function(e,t,n){"use strict";var a=n(156),i=n(287),r=n(258),s=n(286),o=n(171),l={name:"headingAtx",tokenize:function(e,t,n){var s=this,l=0;return function(t){return e.enter("atxHeading"),e.enter("atxHeadingSequence"),u(t)};function u(a){return 35===a&&l++<6?(e.consume(a),u):null===a||i(a)?(e.exit("atxHeadingSequence"),s.interrupt?t(a):c(a)):n(a)}function c(n){return 35===n?(e.enter("atxHeadingSequence"),d(n)):null===n||a(n)?(e.exit("atxHeading"),t(n)):r(n)?o(e,c,"whitespace")(n):(e.enter("atxHeadingText"),p(n))}function d(t){return 35===t?(e.consume(t),d):(e.exit("atxHeadingSequence"),c(t))}function p(t){return null===t||35===t||i(t)?(e.exit("atxHeadingText"),c(t)):(e.consume(t),p)}},resolve:function(e,t){var n,a,i=e.length-2,r=3;return"whitespace"===e[r][1].type&&(r+=2),i-2>r&&"whitespace"===e[i][1].type&&(i-=2),"atxHeadingSequence"===e[i][1].type&&(r===i-1||i-4>r&&"whitespace"===e[i-2][1].type)&&(i-=r+1===i?2:4),i>r&&(n={type:"atxHeadingText",start:e[r][1].start,end:e[i][1].end},a={type:"chunkText",start:e[r][1].start,end:e[i][1].end,contentType:"text"},s(e,r,i-r+1,[["enter",n,t],["enter",a,t],["exit",a,t],["exit",n,t]])),e}};e.exports=l},function(e,t,n){"use strict";var a=n(677),i=n(536),r=n(156),s=n(287),o=n(258),l=n(533),u=n(1209),c=n(1210),d=n(534),p={name:"htmlFlow",tokenize:function(e,t,n){var d,p,f,g,b,y=this;return function(t){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(t),v};function v(i){return 33===i?(e.consume(i),h):47===i?(e.consume(i),j):63===i?(e.consume(i),d=3,y.interrupt?t:$):a(i)?(e.consume(i),f=l(i),p=!0,O):n(i)}function h(i){return 45===i?(e.consume(i),d=2,E):91===i?(e.consume(i),d=5,f="CDATA[",g=0,x):a(i)?(e.consume(i),d=4,y.interrupt?t:$):n(i)}function E(a){return 45===a?(e.consume(a),y.interrupt?t:$):n(a)}function x(a){return a===f.charCodeAt(g++)?(e.consume(a),g===f.length?y.interrupt?t:D:x):n(a)}function j(t){return a(t)?(e.consume(t),f=l(t),O):n(t)}function O(a){return null===a||47===a||62===a||s(a)?47!==a&&p&&c.indexOf(f.toLowerCase())>-1?(d=1,y.interrupt?t(a):D(a)):u.indexOf(f.toLowerCase())>-1?(d=6,47===a?(e.consume(a),S):y.interrupt?t(a):D(a)):(d=7,y.interrupt?n(a):p?w(a):k(a)):45===a||i(a)?(e.consume(a),f+=l(a),O):n(a)}function S(a){return 62===a?(e.consume(a),y.interrupt?t:D):n(a)}function k(t){return o(t)?(e.consume(t),k):P(t)}function w(t){return 47===t?(e.consume(t),P):58===t||95===t||a(t)?(e.consume(t),T):o(t)?(e.consume(t),w):P(t)}function T(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),T):I(t)}function I(t){return 61===t?(e.consume(t),C):o(t)?(e.consume(t),I):w(t)}function C(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),b=t,M):o(t)?(e.consume(t),C):(b=void 0,_(t))}function M(t){return t===b?(e.consume(t),A):null===t||r(t)?n(t):(e.consume(t),M)}function _(t){return null===t||34===t||39===t||60===t||61===t||62===t||96===t||s(t)?I(t):(e.consume(t),_)}function A(e){return 47===e||62===e||o(e)?w(e):n(e)}function P(t){return 62===t?(e.consume(t),F):n(t)}function F(t){return o(t)?(e.consume(t),F):null===t||r(t)?D(t):n(t)}function D(t){return 45===t&&2===d?(e.consume(t),L):60===t&&1===d?(e.consume(t),z):62===t&&4===d?(e.consume(t),V):63===t&&3===d?(e.consume(t),$):93===t&&5===d?(e.consume(t),q):!r(t)||6!==d&&7!==d?null===t||r(t)?N(t):(e.consume(t),D):e.check(m,V,N)(t)}function N(t){return e.exit("htmlFlowData"),R(t)}function R(t){return null===t?U(t):r(t)?(e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),R):(e.enter("htmlFlowData"),D(t))}function L(t){return 45===t?(e.consume(t),$):D(t)}function z(t){return 47===t?(e.consume(t),f="",B):D(t)}function B(t){return 62===t&&c.indexOf(f.toLowerCase())>-1?(e.consume(t),V):a(t)&&f.length<8?(e.consume(t),f+=l(t),B):D(t)}function q(t){return 93===t?(e.consume(t),$):D(t)}function $(t){return 62===t?(e.consume(t),V):D(t)}function V(t){return null===t||r(t)?(e.exit("htmlFlowData"),U(t)):(e.consume(t),V)}function U(n){return e.exit("htmlFlow"),t(n)}},resolveTo:function(e){for(var t=e.length;t--&&("enter"!==e[t][0]||"htmlFlow"!==e[t][1].type););return t>1&&"linePrefix"===e[t-2][1].type&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e},concrete:!0},m={tokenize:function(e,t,n){return function(a){return e.exit("htmlFlowData"),e.enter("lineEndingBlank"),e.consume(a),e.exit("lineEndingBlank"),e.attempt(d,t,n)}},partial:!0};e.exports=p},function(e,t,n){"use strict";e.exports=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","section","source","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"]},function(e,t,n){"use strict";e.exports=["pre","script","style","textarea"]},function(e,t,n){"use strict";var a=n(677),i=n(536),r=n(156),s=n(287),o=n(258),l=n(171),u={name:"htmlText",tokenize:function(e,t,n){var u,c,d,p,m=this;return function(t){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(t),f};function f(t){return 33===t?(e.consume(t),g):47===t?(e.consume(t),I):63===t?(e.consume(t),w):a(t)?(e.consume(t),_):n(t)}function g(t){return 45===t?(e.consume(t),b):91===t?(e.consume(t),c="CDATA[",d=0,x):a(t)?(e.consume(t),k):n(t)}function b(t){return 45===t?(e.consume(t),y):n(t)}function y(t){return null===t||62===t?n(t):45===t?(e.consume(t),v):h(t)}function v(e){return null===e||62===e?n(e):h(e)}function h(t){return null===t?n(t):45===t?(e.consume(t),E):r(t)?(p=h,z(t)):(e.consume(t),h)}function E(t){return 45===t?(e.consume(t),q):h(t)}function x(t){return t===c.charCodeAt(d++)?(e.consume(t),d===c.length?j:x):n(t)}function j(t){return null===t?n(t):93===t?(e.consume(t),O):r(t)?(p=j,z(t)):(e.consume(t),j)}function O(t){return 93===t?(e.consume(t),S):j(t)}function S(t){return 62===t?q(t):93===t?(e.consume(t),S):j(t)}function k(t){return null===t||62===t?q(t):r(t)?(p=k,z(t)):(e.consume(t),k)}function w(t){return null===t?n(t):63===t?(e.consume(t),T):r(t)?(p=w,z(t)):(e.consume(t),w)}function T(e){return 62===e?q(e):w(e)}function I(t){return a(t)?(e.consume(t),C):n(t)}function C(t){return 45===t||i(t)?(e.consume(t),C):M(t)}function M(t){return r(t)?(p=M,z(t)):o(t)?(e.consume(t),M):q(t)}function _(t){return 45===t||i(t)?(e.consume(t),_):47===t||62===t||s(t)?A(t):n(t)}function A(t){return 47===t?(e.consume(t),q):58===t||95===t||a(t)?(e.consume(t),P):r(t)?(p=A,z(t)):o(t)?(e.consume(t),A):q(t)}function P(t){return 45===t||46===t||58===t||95===t||i(t)?(e.consume(t),P):F(t)}function F(t){return 61===t?(e.consume(t),D):r(t)?(p=F,z(t)):o(t)?(e.consume(t),F):A(t)}function D(t){return null===t||60===t||61===t||62===t||96===t?n(t):34===t||39===t?(e.consume(t),u=t,N):r(t)?(p=D,z(t)):o(t)?(e.consume(t),D):(e.consume(t),u=void 0,L)}function N(t){return t===u?(e.consume(t),R):null===t?n(t):r(t)?(p=N,z(t)):(e.consume(t),N)}function R(e){return 62===e||47===e||s(e)?A(e):n(e)}function L(t){return null===t||34===t||39===t||60===t||61===t||96===t?n(t):62===t||s(t)?A(t):(e.consume(t),L)}function z(t){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(t),e.exit("lineEnding"),l(e,B,"linePrefix",m.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)}function B(t){return e.enter("htmlTextData"),p(t)}function q(a){return 62===a?(e.consume(a),e.exit("htmlTextData"),e.exit("htmlText"),t):n(a)}}};e.exports=u},function(e,t,n){"use strict";var a={name:"labelStartImage",tokenize:function(e,t,n){var a=this;return function(t){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(t),e.exit("labelImageMarker"),i};function i(t){return 91===t?(e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelImage"),r):n(t)}function r(e){return 94===e&&"_hiddenFootnoteSupport"in a.parser.constructs?n(e):t(e)}},resolveAll:n(678).resolveAll};e.exports=a},function(e,t,n){"use strict";var a={name:"labelStartLink",tokenize:function(e,t,n){var a=this;return function(t){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(t),e.exit("labelMarker"),e.exit("labelLink"),i};function i(e){return 94===e&&"_hiddenFootnoteSupport"in a.parser.constructs?n(e):t(e)}},resolveAll:n(678).resolveAll};e.exports=a},function(e,t,n){"use strict";var a=n(171),i={name:"lineEnding",tokenize:function(e,t){return function(n){return e.enter("lineEnding"),e.consume(n),e.exit("lineEnding"),a(e,t,"linePrefix")}}};e.exports=i},function(e,t,n){"use strict";var a=n(937),i=n(258),r=n(535),s=n(932),o=n(171),l=n(534),u=n(942),c={name:"list",tokenize:function(e,t,n){var o=this,c=r(o.events,"linePrefix"),p=0;return function(t){var i=o.containerState.type||(42===t||43===t||45===t?"listUnordered":"listOrdered");if("listUnordered"===i?!o.containerState.marker||t===o.containerState.marker:a(t)){if(o.containerState.type||(o.containerState.type=i,e.enter(i,{_container:!0})),"listUnordered"===i)return e.enter("listItemPrefix"),42===t||45===t?e.check(u,n,f)(t):f(t);if(!o.interrupt||49===t)return e.enter("listItemPrefix"),e.enter("listItemValue"),m(t)}return n(t)};function m(t){return a(t)&&++p<10?(e.consume(t),m):(!o.interrupt||p<2)&&(o.containerState.marker?t===o.containerState.marker:41===t||46===t)?(e.exit("listItemValue"),f(t)):n(t)}function f(t){return e.enter("listItemMarker"),e.consume(t),e.exit("listItemMarker"),o.containerState.marker=o.containerState.marker||t,e.check(l,o.interrupt?n:g,e.attempt(d,y,b))}function g(e){return o.containerState.initialBlankLine=!0,c++,y(e)}function b(t){return i(t)?(e.enter("listItemPrefixWhitespace"),e.consume(t),e.exit("listItemPrefixWhitespace"),y):n(t)}function y(n){return o.containerState.size=c+s(o.sliceStream(e.exit("listItemPrefix"))),t(n)}},continuation:{tokenize:function(e,t,n){var a=this;return a.containerState._closeFlow=void 0,e.check(l,(function(n){return a.containerState.furtherBlankLines=a.containerState.furtherBlankLines||a.containerState.initialBlankLine,o(e,t,"listItemIndent",a.containerState.size+1)(n)}),(function(n){return a.containerState.furtherBlankLines||!i(n)?(a.containerState.furtherBlankLines=a.containerState.initialBlankLine=void 0,r(n)):(a.containerState.furtherBlankLines=a.containerState.initialBlankLine=void 0,e.attempt(p,t,r)(n))}));function r(i){return a.containerState._closeFlow=!0,a.interrupt=void 0,o(e,e.attempt(c,t,n),"linePrefix",a.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:4)(i)}}},exit:function(e){e.exit(this.containerState.type)}},d={tokenize:function(e,t,n){var a=this;return o(e,(function(e){return i(e)||!r(a.events,"listItemPrefixWhitespace")?n(e):t(e)}),"listItemPrefixWhitespace",a.parser.constructs.disable.null.indexOf("codeIndented")>-1?void 0:5)},partial:!0},p={tokenize:function(e,t,n){var a=this;return o(e,(function(e){return r(a.events,"listItemIndent")===a.containerState.size?t(e):n(e)}),"listItemIndent",a.containerState.size+1)},partial:!0};e.exports=c},function(e,t,n){"use strict";var a=n(156),i=n(349),r=n(171),s={name:"setextUnderline",tokenize:function(e,t,n){for(var i,s,o=this,l=o.events.length;l--;)if("lineEnding"!==o.events[l][1].type&&"linePrefix"!==o.events[l][1].type&&"content"!==o.events[l][1].type){s="paragraph"===o.events[l][1].type;break}return function(t){return o.lazy||!o.interrupt&&!s?n(t):(e.enter("setextHeadingLine"),e.enter("setextHeadingLineSequence"),i=t,u(t))};function u(t){return t===i?(e.consume(t),u):(e.exit("setextHeadingLineSequence"),r(e,c,"lineSuffix")(t))}function c(i){return null===i||a(i)?(e.exit("setextHeadingLine"),t(i)):n(i)}},resolveTo:function(e,t){for(var n,a,r,s,o=e.length;o--;)if("enter"===e[o][0]){if("content"===e[o][1].type){n=o;break}"paragraph"===e[o][1].type&&(a=o)}else"content"===e[o][1].type&&e.splice(o,1),r||"definition"!==e[o][1].type||(r=o);return s={type:"setextHeading",start:i(e[a][1].start),end:i(e[e.length-1][1].end)},e[a][1].type="setextHeadingText",r?(e.splice(a,0,["enter",s,t]),e.splice(r+1,0,["exit",e[n][1],t]),e[n][1].end=i(e[r][1].end)):e[n][1]=s,e.push(["exit",s,t]),e}};e.exports=s},function(e,t,n){"use strict";var a=/[\0\t\n\r]/g;e.exports=function(){var e,t=!0,n=1,i="";return function(r,s,o){var l,u,c,d,p,m=[];for(r=i+r.toString(s),c=0,i="",t&&(65279===r.charCodeAt(0)&&c++,t=void 0);c<r.length;){if(a.lastIndex=c,d=(l=a.exec(r))?l.index:r.length,p=r.charCodeAt(d),!l){i=r.slice(c);break}if(10===p&&c===d&&e)m.push(-3),e=void 0;else if(e&&(m.push(-5),e=void 0),c<d&&(m.push(r.slice(c,d)),n+=d-c),0===p)m.push(65533),n++;else if(9===p)for(u=4*Math.ceil(n/4),m.push(-2);n++<u;)m.push(-1);else 10===p?(m.push(-4),n=1):(e=!0,n=1);c=d+1}return o&&(e&&m.push(-5),i&&m.push(i),m.push(null)),m}}},function(e,t,n){"use strict";var a=n(933);e.exports=function(e){for(;!a(e););return e}},function(e,t,n){e.exports=n(24)(3709)},function(e,t,n){e.exports=n(24)(2067)},function(e,t,n){e.exports=n(24)(8)},function(e,t,n){e.exports=n(24)(1647)},function(e,t,n){const a=n(1224);e.exports=function(e){if(e.allowedElements&&e.disallowedElements)throw new TypeError("Only one of `allowedElements` and `disallowedElements` should be defined");if(e.allowedElements||e.disallowedElements||e.allowElement)return e=>{a(e,"element",t)};function t(t,n,a){const i=t,r=a;let s;if(e.allowedElements?s=!e.allowedElements.includes(i.tagName):e.disallowedElements&&(s=e.disallowedElements.includes(i.tagName)),!s&&e.allowElement&&"number"==typeof n&&(s=!e.allowElement(i,n,r)),s&&"number"==typeof n)return e.unwrapDisallowed&&i.children?r.children.splice(n,1,...i.children):r.children.splice(n,1),n}}},function(e,t,n){e.exports=n(24)(365)},function(e,t){const n=["http","https","mailto","tel"];e.exports=function(e){const t=(e||"").trim(),a=t.charAt(0);if("#"===a||"/"===a)return t;const i=t.indexOf(":");if(-1===i)return t;let r=-1;for(;++r<n.length;){const e=n[r];if(i===e.length&&t.slice(0,e.length).toLowerCase()===e)return t}return r=t.indexOf("?"),-1!==r&&i>r?t:(r=t.indexOf("#"),-1!==r&&i>r?t:"javascript:void(0)")}},function(e,t,n){"use strict";const a=n(2),i=n(1227),r=n(1228),s=n(1229),o=n(1230),l=n(1231),u=n(1232),c=n(1233);t.hastToReact=f,t.hastChildrenToReact=m;const d={}.hasOwnProperty,p=new Set(["table","thead","tbody","tfoot","tr"]);function m(e,t){const n=[];let a,i=-1;for(;++i<t.children.length;)a=t.children[i],"element"===a.type?n.push(f(e,a,i,t)):"text"===a.type?"element"===t.type&&p.has(t.tagName)&&"\n"===a.value||n.push(a.value):"raw"!==a.type||e.options.skipHtml||n.push(a.value);return n}function f(e,t,n,s){const o=e.options,l=e.schema,u=t.tagName,c={};let p,f=l;if("html"===l.space&&"svg"===u&&(f=r,e.schema=f),t.properties)for(p in t.properties)d.call(t.properties,p)&&b(c,p,t.properties[p],e);"ol"!==u&&"ul"!==u||e.listDepth++;const y=m(e,t);"ol"!==u&&"ul"!==u||e.listDepth--,e.schema=l;const v=t.position||{start:{line:null,column:null,offset:null},end:{line:null,column:null,offset:null}},h=o.components&&d.call(o.components,u)?o.components[u]:u,E="string"==typeof h||h===a.Fragment;if(!i.isValidElementType(h))throw new TypeError(`Component for name \`${u}\` not defined or is not renderable`);if(c.key=[u,v.start.line,v.start.column,n].join("-"),"a"===u&&o.linkTarget&&(c.target="function"==typeof o.linkTarget?o.linkTarget(c.href,t.children,c.title):o.linkTarget),"a"===u&&o.transformLinkUri&&(c.href=o.transformLinkUri(c.href,t.children,c.title)),E||"code"!==u||"element"!==s.type||"pre"===s.tagName||(c.inline=!0),E||"h1"!==u&&"h2"!==u&&"h3"!==u&&"h4"!==u&&"h5"!==u&&"h6"!==u||(c.level=parseInt(u.charAt(1),10)),"img"===u&&o.transformImageUri&&(c.src=o.transformImageUri(c.src,c.alt,c.title)),!E&&"li"===u&&"element"===s.type){const e=function(e){let t=-1;for(;++t<e.children.length;){const n=e.children[t];if("element"===n.type&&"input"===n.tagName)return n}return null}(t);c.checked=e&&e.properties?Boolean(e.properties.checked):null,c.index=g(s,t),c.ordered="ol"===s.tagName}var x;return E||"ol"!==u&&"ul"!==u||(c.ordered="ol"===u,c.depth=e.listDepth),"td"!==u&&"th"!==u||(c.align&&(c.style||(c.style={}),c.style.textAlign=c.align,delete c.align),E||(c.isHeader="th"===u)),E||"tr"!==u||"element"!==s.type||(c.isHeader=Boolean("thead"===s.tagName)),o.sourcePos&&(c["data-sourcepos"]=[(x=v).start.line,":",x.start.column,"-",x.end.line,":",x.end.column].map((e=>String(e))).join("")),!E&&o.rawSourcePos&&(c.sourcePosition=t.position),!E&&o.includeElementIndex&&(c.index=g(s,t),c.siblingCount=g(s)),E||(c.node=t),y.length>0?a.createElement(h,c,y):a.createElement(h,c)}function g(e,t){let n=-1,a=0;for(;++n<e.children.length&&e.children[n]!==t;)"element"===e.children[n].type&&a++;return a}function b(e,t,n,a){const i=s(a.schema,t);let r=n;null!=r&&r==r&&(r&&"object"==typeof r&&"length"in r&&(r=(i.commaSeparated?u:l).stringify(r)),"style"===i.property&&"string"==typeof r&&(r=function(e){const t={};try{c(e,(function(e,n){const a="-ms-"===e.slice(0,4)?`ms-${e.slice(4)}`:e;t[a.replace(/-([a-z])/g,y)]=n}))}catch(e){}return t}(r)),i.space&&i.property?e[d.call(o,i.property)?o[i.property]:i.property]=r:i.attribute&&(e[i.attribute]=r))}function y(e,t){return t.toUpperCase()}},function(e,t,n){e.exports=n(24)(476)},function(e,t,n){e.exports=n(24)(3772)},function(e,t,n){e.exports=n(24)(1658)},function(e,t,n){e.exports=n(24)(3774)},function(e,t,n){e.exports=n(24)(1659)},function(e,t,n){e.exports=n(24)(1660)},function(e,t,n){e.exports=n(24)(3775)},function(e,t,n){e.exports=n(24)(2063)},function(e,t,n){const a=n(316),i=n(315),r=n(173),s=n(514),o=n(304),l=n(591),u=n(1236),c=n(1237),d=n(1238),p=n(1239),m=n(1240),f=n(1241),g=n(1242),b=n(225),y=n(1243),v=n(1244),h=n(679),E=n(1245),x=n(1246),j=n(538),O=n(680),S=n(946),k=n(947),w=n(539),T=n(603),I=n(948),C=n(1116),M=n(540),_=n(217),A=n(541),P=n(1250),F=n(1251),D=n(1252),N=n(1253),R=n(1254),L=n(681),z=n(1255),B=n(1256),q=n(1257),$=n(1258),V=n(1259);e.exports={parse:o,valid:l,clean:u,inc:c,diff:d,major:p,minor:m,patch:f,prerelease:g,compare:b,rcompare:y,compareLoose:v,compareBuild:h,sort:E,rsort:x,gt:j,lt:O,eq:S,neq:k,gte:w,lte:T,cmp:I,coerce:C,Comparator:M,Range:_,satisfies:A,toComparators:P,maxSatisfying:F,minSatisfying:D,minVersion:N,validRange:R,outside:L,gtr:z,ltr:B,intersects:q,simplifyRange:$,subset:V,SemVer:r,re:a.re,src:a.src,tokens:a.t,SEMVER_SPEC_VERSION:i.SEMVER_SPEC_VERSION,RELEASE_TYPES:i.RELEASE_TYPES,compareIdentifiers:s.compareIdentifiers,rcompareIdentifiers:s.rcompareIdentifiers}},function(e,t,n){const a=n(304);e.exports=(e,t)=>{const n=a(e.trim().replace(/^[=v]+/,""),t);return n?n.version:null}},function(e,t,n){const a=n(173);e.exports=(e,t,n,i,r)=>{"string"==typeof n&&(r=i,i=n,n=void 0);try{return new a(e instanceof a?e.version:e,n).inc(t,i,r).version}catch(e){return null}}},function(e,t,n){const a=n(304);e.exports=(e,t)=>{const n=a(e,null,!0),i=a(t,null,!0),r=n.compare(i);if(0===r)return null;const s=r>0,o=s?n:i,l=s?i:n,u=!!o.prerelease.length;if(l.prerelease.length&&!u)return l.patch||l.minor?o.patch?"patch":o.minor?"minor":"major":"major";const c=u?"pre":"";return n.major!==i.major?c+"major":n.minor!==i.minor?c+"minor":n.patch!==i.patch?c+"patch":"prerelease"}},function(e,t,n){const a=n(173);e.exports=(e,t)=>new a(e,t).major},function(e,t,n){const a=n(173);e.exports=(e,t)=>new a(e,t).minor},function(e,t,n){const a=n(173);e.exports=(e,t)=>new a(e,t).patch},function(e,t,n){const a=n(304);e.exports=(e,t)=>{const n=a(e,t);return n&&n.prerelease.length?n.prerelease:null}},function(e,t,n){const a=n(225);e.exports=(e,t,n)=>a(t,e,n)},function(e,t,n){const a=n(225);e.exports=(e,t)=>a(e,t,!0)},function(e,t,n){const a=n(679);e.exports=(e,t)=>e.sort(((e,n)=>a(e,n,t)))},function(e,t,n){const a=n(679);e.exports=(e,t)=>e.sort(((e,n)=>a(n,e,t)))},function(e,t,n){"use strict";const a=n(1248),i=Symbol("max"),r=Symbol("length"),s=Symbol("lengthCalculator"),o=Symbol("allowStale"),l=Symbol("maxAge"),u=Symbol("dispose"),c=Symbol("noDisposeOnSet"),d=Symbol("lruList"),p=Symbol("cache"),m=Symbol("updateAgeOnGet"),f=()=>1,g=(e,t,n)=>{const a=e[p].get(t);if(a){const t=a.value;if(b(e,t)){if(v(e,a),!e[o])return}else n&&(e[m]&&(a.value.now=Date.now()),e[d].unshiftNode(a));return t.value}},b=(e,t)=>{if(!t||!t.maxAge&&!e[l])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[l]&&n>e[l]},y=e=>{if(e[r]>e[i])for(let t=e[d].tail;e[r]>e[i]&&null!==t;){const n=t.prev;v(e,t),t=n}},v=(e,t)=>{if(t){const n=t.value;e[u]&&e[u](n.key,n.value),e[r]-=n.length,e[p].delete(n.key),e[d].removeNode(t)}};class Entry{constructor(e,t,n,a,i){this.key=e,this.value=t,this.length=n,this.now=a,this.maxAge=i||0}}const h=(e,t,n,a)=>{let i=n.value;b(e,i)&&(v(e,n),e[o]||(i=void 0)),i&&t.call(a,i.value,i.key,e)};e.exports=class LRUCache{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[i]=e.max||1/0;const t=e.length||f;if(this[s]="function"!=typeof t?f:t,this[o]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[l]=e.maxAge||0,this[u]=e.dispose,this[c]=e.noDisposeOnSet||!1,this[m]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[i]=e||1/0,y(this)}get max(){return this[i]}set allowStale(e){this[o]=!!e}get allowStale(){return this[o]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[l]=e,y(this)}get maxAge(){return this[l]}set lengthCalculator(e){"function"!=typeof e&&(e=f),e!==this[s]&&(this[s]=e,this[r]=0,this[d].forEach((e=>{e.length=this[s](e.value,e.key),this[r]+=e.length}))),y(this)}get lengthCalculator(){return this[s]}get length(){return this[r]}get itemCount(){return this[d].length}rforEach(e,t){t=t||this;for(let n=this[d].tail;null!==n;){const a=n.prev;h(this,e,n,t),n=a}}forEach(e,t){t=t||this;for(let n=this[d].head;null!==n;){const a=n.next;h(this,e,n,t),n=a}}keys(){return this[d].toArray().map((e=>e.key))}values(){return this[d].toArray().map((e=>e.value))}reset(){this[u]&&this[d]&&this[d].length&&this[d].forEach((e=>this[u](e.key,e.value))),this[p]=new Map,this[d]=new a,this[r]=0}dump(){return this[d].map((e=>!b(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)})).toArray().filter((e=>e))}dumpLru(){return this[d]}set(e,t,n){if((n=n||this[l])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const a=n?Date.now():0,o=this[s](t,e);if(this[p].has(e)){if(o>this[i])return v(this,this[p].get(e)),!1;const s=this[p].get(e).value;return this[u]&&(this[c]||this[u](e,s.value)),s.now=a,s.maxAge=n,s.value=t,this[r]+=o-s.length,s.length=o,this.get(e),y(this),!0}const m=new Entry(e,t,o,a,n);return m.length>this[i]?(this[u]&&this[u](e,t),!1):(this[r]+=m.length,this[d].unshift(m),this[p].set(e,this[d].head),y(this),!0)}has(e){if(!this[p].has(e))return!1;const t=this[p].get(e).value;return!b(this,t)}get(e){return g(this,e,!0)}peek(e){return g(this,e,!1)}pop(){const e=this[d].tail;return e?(v(this,e),e.value):null}del(e){v(this,this[p].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const a=e[n],i=a.e||0;if(0===i)this.set(a.k,a.v);else{const e=i-t;e>0&&this.set(a.k,a.v,e)}}}prune(){this[p].forEach(((e,t)=>g(this,t,!1)))}}},function(e,t,n){"use strict";function a(e){var t=this;if(t instanceof a||(t=new a),t.tail=null,t.head=null,t.length=0,e&&"function"==typeof e.forEach)e.forEach((function(e){t.push(e)}));else if(arguments.length>0)for(var n=0,i=arguments.length;n<i;n++)t.push(arguments[n]);return t}function i(e,t,n,a){if(!(this instanceof i))return new i(e,t,n,a);this.list=a,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}e.exports=a,a.Node=i,a.create=a,a.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},a.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},a.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},a.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)a=arguments[e],(n=this).tail=new i(a,n.tail,null,n),n.head||(n.head=n.tail),n.length++;var n,a;return this.length},a.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)a=arguments[e],(n=this).head=new i(a,null,n.head,n),n.tail||(n.tail=n.head),n.length++;var n,a;return this.length},a.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},a.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},a.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,a=0;null!==n;a++)e.call(t,n.value,a,this),n=n.next},a.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,a=this.length-1;null!==n;a--)e.call(t,n.value,a,this),n=n.prev},a.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},a.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},a.prototype.map=function(e,t){t=t||this;for(var n=new a,i=this.head;null!==i;)n.push(e.call(t,i.value,this)),i=i.next;return n},a.prototype.mapReverse=function(e,t){t=t||this;for(var n=new a,i=this.tail;null!==i;)n.push(e.call(t,i.value,this)),i=i.prev;return n},a.prototype.reduce=function(e,t){var n,a=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");a=this.head.next,n=this.head.value}for(var i=0;null!==a;i++)n=e(n,a.value,i),a=a.next;return n},a.prototype.reduceReverse=function(e,t){var n,a=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");a=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==a;i--)n=e(n,a.value,i),a=a.prev;return n},a.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},a.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},a.prototype.slice=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new a;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=0,r=this.head;null!==r&&i<e;i++)r=r.next;for(;null!==r&&i<t;i++,r=r.next)n.push(r.value);return n},a.prototype.sliceReverse=function(e,t){(t=t||this.length)<0&&(t+=this.length),(e=e||0)<0&&(e+=this.length);var n=new a;if(t<e||t<0)return n;e<0&&(e=0),t>this.length&&(t=this.length);for(var i=this.length,r=this.tail;null!==r&&i>t;i--)r=r.prev;for(;null!==r&&i>e;i--,r=r.prev)n.push(r.value);return n},a.prototype.splice=function(e,t,...n){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var a=0,r=this.head;null!==r&&a<e;a++)r=r.next;var s,o,l,u,c=[];for(a=0;r&&a<t;a++)c.push(r.value),r=this.removeNode(r);for(null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev),a=0;a<n.length;a++)s=this,o=r,l=n[a],u=void 0,null===(u=o===s.head?new i(l,null,o,s):new i(l,o,o.next,s)).next&&(s.tail=u),null===u.prev&&(s.head=u),s.length++,r=u;return c},a.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var a=n.prev;n.prev=n.next,n.next=a}return this.head=t,this.tail=e,this};try{n(1249)(a)}catch(e){}},function(e,t,n){"use strict";e.exports=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}},function(e,t,n){const a=n(217);e.exports=(e,t)=>new a(e,t).set.map((e=>e.map((e=>e.value)).join(" ").trim().split(" ")))},function(e,t,n){const a=n(173),i=n(217);e.exports=(e,t,n)=>{let r=null,s=null,o=null;try{o=new i(t,n)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(r&&-1!==s.compare(e)||(r=e,s=new a(r,n)))})),r}},function(e,t,n){const a=n(173),i=n(217);e.exports=(e,t,n)=>{let r=null,s=null,o=null;try{o=new i(t,n)}catch(e){return null}return e.forEach((e=>{o.test(e)&&(r&&1!==s.compare(e)||(r=e,s=new a(r,n)))})),r}},function(e,t,n){const a=n(173),i=n(217),r=n(538);e.exports=(e,t)=>{e=new i(e,t);let n=new a("0.0.0");if(e.test(n))return n;if(n=new a("0.0.0-0"),e.test(n))return n;n=null;for(let t=0;t<e.set.length;++t){const i=e.set[t];let s=null;i.forEach((e=>{const t=new a(e.semver.version);switch(e.operator){case">":0===t.prerelease.length?t.patch++:t.prerelease.push(0),t.raw=t.format();case"":case">=":s&&!r(t,s)||(s=t);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${e.operator}`)}})),!s||n&&!r(n,s)||(n=s)}return n&&e.test(n)?n:null}},function(e,t,n){const a=n(217);e.exports=(e,t)=>{try{return new a(e,t).range||"*"}catch(e){return null}}},function(e,t,n){const a=n(681);e.exports=(e,t,n)=>a(e,t,">",n)},function(e,t,n){const a=n(681);e.exports=(e,t,n)=>a(e,t,"<",n)},function(e,t,n){const a=n(217);e.exports=(e,t,n)=>(e=new a(e,n),t=new a(t,n),e.intersects(t,n))},function(e,t,n){const a=n(541),i=n(225);e.exports=(e,t,n)=>{const r=[];let s=null,o=null;const l=e.sort(((e,t)=>i(e,t,n)));for(const e of l)a(e,t,n)?(o=e,s||(s=e)):(o&&r.push([s,o]),o=null,s=null);s&&r.push([s,null]);const u=[];for(const[e,t]of r)e===t?u.push(e):t||e!==l[0]?t?e===l[0]?u.push(`<=${t}`):u.push(`${e} - ${t}`):u.push(`>=${e}`):u.push("*");const c=u.join(" || "),d="string"==typeof t.raw?t.raw:String(t);return c.length<d.length?c:t}},function(e,t,n){const a=n(217),i=n(540),{ANY:r}=i,s=n(541),o=n(225),l=[new i(">=0.0.0-0")],u=[new i(">=0.0.0")],c=(e,t,n)=>{if(e===t)return!0;if(1===e.length&&e[0].semver===r){if(1===t.length&&t[0].semver===r)return!0;e=n.includePrerelease?l:u}if(1===t.length&&t[0].semver===r){if(n.includePrerelease)return!0;t=u}const a=new Set;let i,c,m,f,g,b,y;for(const t of e)">"===t.operator||">="===t.operator?i=d(i,t,n):"<"===t.operator||"<="===t.operator?c=p(c,t,n):a.add(t.semver);if(a.size>1)return null;if(i&&c){if(m=o(i.semver,c.semver,n),m>0)return null;if(0===m&&(">="!==i.operator||"<="!==c.operator))return null}for(const e of a){if(i&&!s(e,String(i),n))return null;if(c&&!s(e,String(c),n))return null;for(const a of t)if(!s(e,String(a),n))return!1;return!0}let v=!(!c||n.includePrerelease||!c.semver.prerelease.length)&&c.semver,h=!(!i||n.includePrerelease||!i.semver.prerelease.length)&&i.semver;v&&1===v.prerelease.length&&"<"===c.operator&&0===v.prerelease[0]&&(v=!1);for(const e of t){if(y=y||">"===e.operator||">="===e.operator,b=b||"<"===e.operator||"<="===e.operator,i)if(h&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===h.major&&e.semver.minor===h.minor&&e.semver.patch===h.patch&&(h=!1),">"===e.operator||">="===e.operator){if(f=d(i,e,n),f===e&&f!==i)return!1}else if(">="===i.operator&&!s(i.semver,String(e),n))return!1;if(c)if(v&&e.semver.prerelease&&e.semver.prerelease.length&&e.semver.major===v.major&&e.semver.minor===v.minor&&e.semver.patch===v.patch&&(v=!1),"<"===e.operator||"<="===e.operator){if(g=p(c,e,n),g===e&&g!==c)return!1}else if("<="===c.operator&&!s(c.semver,String(e),n))return!1;if(!e.operator&&(c||i)&&0!==m)return!1}return!(i&&b&&!c&&0!==m||c&&y&&!i&&0!==m||h||v)},d=(e,t,n)=>{if(!e)return t;const a=o(e.semver,t.semver,n);return a>0?e:a<0||">"===t.operator&&">="===e.operator?t:e},p=(e,t,n)=>{if(!e)return t;const a=o(e.semver,t.semver,n);return a<0?e:a>0||"<"===t.operator&&"<="===e.operator?t:e};e.exports=(e,t,n={})=>{if(e===t)return!0;e=new a(e,n),t=new a(t,n);let i=!1;e:for(const a of e.set){for(const e of t.set){const t=c(a,e,n);if(i=i||null!==t,t)continue e}if(i)return!1}return!0}},function(e,t,n){var a,i,r,s;
/*!
 * mustache.js - Logic-less {{mustache}} templates with JavaScript
 * http://github.com/janl/mustache.js
 */s=function(e){var t=Object.prototype.toString,n=Array.isArray||function(e){return"[object Array]"===t.call(e)};function a(e){return"function"==typeof e}function i(e){return e.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function r(e,t){return null!=e&&"object"==typeof e&&t in e}var s=RegExp.prototype.test,o=/\S/;var l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"},u=/\s*/,c=/\s+/,d=/\s*=/,p=/\s*\}/,m=/#|\^|\/|>|\{|&|=|!/;function f(e){this.string=e,this.tail=e,this.pos=0}function g(e,t){this.view=e,this.cache={".":this.view},this.parent=t}function b(){this.cache={}}f.prototype.eos=function(){return""===this.tail},f.prototype.scan=function(e){var t=this.tail.match(e);if(!t||0!==t.index)return"";var n=t[0];return this.tail=this.tail.substring(n.length),this.pos+=n.length,n},f.prototype.scanUntil=function(e){var t,n=this.tail.search(e);switch(n){case-1:t=this.tail,this.tail="";break;case 0:t="";break;default:t=this.tail.substring(0,n),this.tail=this.tail.substring(n)}return this.pos+=t.length,t},g.prototype.push=function(e){return new g(e,this)},g.prototype.lookup=function(e){var t,n=this.cache;if(n.hasOwnProperty(e))t=n[e];else{for(var i,s,o=this,l=!1;o;){if(e.indexOf(".")>0)for(t=o.view,i=e.split("."),s=0;null!=t&&s<i.length;)s===i.length-1&&(l=r(t,i[s])),t=t[i[s++]];else t=o.view[e],l=r(o.view,e);if(l)break;o=o.parent}n[e]=t}return a(t)&&(t=t.call(this.view)),t},b.prototype.clearCache=function(){this.cache={}},b.prototype.parse=function(t,a){var r=this.cache,l=r[t];return null==l&&(l=r[t]=function(t,a){if(!t)return[];var r,l,g,b,y=[],v=[],h=[],E=!1,x=!1;function j(){if(E&&!x)for(;h.length;)delete v[h.pop()];else h=[];E=!1,x=!1}function O(e){if("string"==typeof e&&(e=e.split(c,2)),!n(e)||2!==e.length)throw new Error("Invalid tags: "+e);r=new RegExp(i(e[0])+"\\s*"),l=new RegExp("\\s*"+i(e[1])),g=new RegExp("\\s*"+i("}"+e[1]))}O(a||e.tags);for(var S,k,w,T,I,C,M=new f(t);!M.eos();){if(S=M.pos,w=M.scanUntil(r))for(var _=0,A=w.length;_<A;++_)b=T=w.charAt(_),function(e,t){return s.call(e,t)}(o,b)?x=!0:h.push(v.length),v.push(["text",T,S,S+1]),S+=1,"\n"===T&&j();if(!M.scan(r))break;if(E=!0,k=M.scan(m)||"name",M.scan(u),"="===k?(w=M.scanUntil(d),M.scan(d),M.scanUntil(l)):"{"===k?(w=M.scanUntil(g),M.scan(p),M.scanUntil(l),k="&"):w=M.scanUntil(l),!M.scan(l))throw new Error("Unclosed tag at "+M.pos);if(I=[k,w,S,M.pos],v.push(I),"#"===k||"^"===k)y.push(I);else if("/"===k){if(!(C=y.pop()))throw new Error('Unopened section "'+w+'" at '+S);if(C[1]!==w)throw new Error('Unclosed section "'+C[1]+'" at '+S)}else"name"===k||"{"===k||"&"===k?x=!0:"="===k&&O(w)}if(C=y.pop())throw new Error('Unclosed section "'+C[1]+'" at '+M.pos);return function(e){for(var t,n=[],a=n,i=[],r=0,s=e.length;r<s;++r)switch((t=e[r])[0]){case"#":case"^":a.push(t),i.push(t),a=t[4]=[];break;case"/":i.pop()[5]=t[2],a=i.length>0?i[i.length-1][4]:n;break;default:a.push(t)}return n}(function(e){for(var t,n,a=[],i=0,r=e.length;i<r;++i)(t=e[i])&&("text"===t[0]&&n&&"text"===n[0]?(n[1]+=t[1],n[3]=t[3]):(a.push(t),n=t));return a}(v))}(t,a)),l},b.prototype.render=function(e,t,n){var a=this.parse(e),i=t instanceof g?t:new g(t);return this.renderTokens(a,i,n,e)},b.prototype.renderTokens=function(e,t,n,a){for(var i,r,s,o="",l=0,u=e.length;l<u;++l)s=void 0,"#"===(r=(i=e[l])[0])?s=this.renderSection(i,t,n,a):"^"===r?s=this.renderInverted(i,t,n,a):">"===r?s=this.renderPartial(i,t,n,a):"&"===r?s=this.unescapedValue(i,t):"name"===r?s=this.escapedValue(i,t):"text"===r&&(s=this.rawValue(i)),void 0!==s&&(o+=s);return o},b.prototype.renderSection=function(e,t,i,r){var s=this,o="",l=t.lookup(e[1]);if(l){if(n(l))for(var u=0,c=l.length;u<c;++u)o+=this.renderTokens(e[4],t.push(l[u]),i,r);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)o+=this.renderTokens(e[4],t.push(l),i,r);else if(a(l)){if("string"!=typeof r)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(t.view,r.slice(e[3],e[5]),(function(e){return s.render(e,t,i)})))&&(o+=l)}else o+=this.renderTokens(e[4],t,i,r);return o}},b.prototype.renderInverted=function(e,t,a,i){var r=t.lookup(e[1]);if(!r||n(r)&&0===r.length)return this.renderTokens(e[4],t,a,i)},b.prototype.renderPartial=function(e,t,n){if(n){var i=a(n)?n(e[1]):n[e[1]];return null!=i?this.renderTokens(this.parse(i),t,n,i):void 0}},b.prototype.unescapedValue=function(e,t){var n=t.lookup(e[1]);if(null!=n)return n},b.prototype.escapedValue=function(t,n){var a=n.lookup(t[1]);if(null!=a)return e.escape(a)},b.prototype.rawValue=function(e){return e[1]},e.name="mustache.js",e.version="2.3.2",e.tags=["{{","}}"];var y=new b;return e.clearCache=function(){return y.clearCache()},e.parse=function(e,t){return y.parse(e,t)},e.render=function(e,t,a){if("string"!=typeof e)throw new TypeError('Invalid template! Template should be a "string" but "'+(n(i=e)?"array":typeof i)+'" was given as the first argument for mustache#render(template, view, partials)');var i;return y.render(e,t,a)},e.to_html=function(t,n,i,r){var s=e.render(t,n,i);if(!a(r))return s;r(s)},e.escape=function(e){return String(e).replace(/[&<>"'`=\/]/g,(function(e){return l[e]}))},e.Scanner=f,e.Context=g,e.Writer=b,e},t&&"string"!=typeof t.nodeName?s(t):(i=[t],void 0===(r="function"==typeof(a=s)?a.apply(t,i):a)||(e.exports=r))},function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"g",(function(){return o})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return d}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.hosts.pageTitle",{defaultMessage:"Hosts"}),r=a.i18n.translate("xpack.securitySolution.hosts.navigation.allHostsTitle",{defaultMessage:"All hosts"}),s=a.i18n.translate("xpack.securitySolution.hosts.navigation.authenticationsTitle",{defaultMessage:"Authentications"}),o=a.i18n.translate("xpack.securitySolution.hosts.navigation.uncommonProcessesTitle",{defaultMessage:"Uncommon processes"}),l=a.i18n.translate("xpack.securitySolution.hosts.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),u=a.i18n.translate("xpack.securitySolution.hosts.navigation.eventsTitle",{defaultMessage:"Events"}),c=a.i18n.translate("xpack.securitySolution.hosts.navigation.hostRiskTitle",{defaultMessage:"Host risk"}),d=a.i18n.translate("xpack.securitySolution.hosts.navigation.sessionsTitle",{defaultMessage:"Sessions"});a.i18n.translate("xpack.securitySolution.hosts.navigaton.matrixHistogram.errorFetchingEventsData",{defaultMessage:"Failed to query events data"})},function(e,t,n){"use strict";n.d(t,"h",(function(){return i})),n.d(t,"d",(function(){return r})),n.d(t,"b",(function(){return s})),n.d(t,"g",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"e",(function(){return u})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return d}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.network.pageTitle",{defaultMessage:"Network"}),r=a.i18n.translate("xpack.securitySolution.network.navigation.flowsTitle",{defaultMessage:"Flows"}),s=a.i18n.translate("xpack.securitySolution.network.navigation.dnsTitle",{defaultMessage:"DNS"}),o=a.i18n.translate("xpack.securitySolution.network.navigation.usersTitle",{defaultMessage:"Users"}),l=a.i18n.translate("xpack.securitySolution.network.navigation.tlsTitle",{defaultMessage:"TLS"}),u=a.i18n.translate("xpack.securitySolution.network.navigation.httpTitle",{defaultMessage:"HTTP"}),c=a.i18n.translate("xpack.securitySolution.network.navigation.anomaliesTitle",{defaultMessage:"Anomalies"}),d=a.i18n.translate("xpack.securitySolution.network.navigation.eventsTitle",{defaultMessage:"Events"})},function(e,t,n){"use strict";var a=n(760);n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return a.b})),n.d(t,"j",(function(){return a.g})),n.d(t,"k",(function(){return a.i}));var i=n(884);n.d(t,"c",(function(){return i.a})),n.d(t,"d",(function(){return i.b})),n.d(t,"e",(function(){return i.c})),n.d(t,"f",(function(){return i.d})),n.d(t,"g",(function(){return i.e})),n.d(t,"h",(function(){return i.f})),n.d(t,"i",(function(){return i.g}))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1344);case"v8light":return n(1346)}},function(e,t,n){var a=n(332),i=n(1345);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(333)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#141519}.kbnSolutionNav{background:linear-gradient(160deg,#3437414d,#3437414d 32px,#f000 0),linear-gradient(175deg,#3437414d,#3437414d 16px,#f000 0);display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#98a2b380 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#98a2b380;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px) and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px) and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav__title{align-items:center;display:inline-flex}.kbnSolutionNav__titleAvatar{align-self:flex-start;margin-right:12px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},function(e,t,n){var a=n(332),i=n(1347);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(333)(!1)).push([e.i,'.kbnSolutionNav__flyout{background-color:#fafbfd}.kbnSolutionNav{background:linear-gradient(160deg,#d3dae64d,#d3dae64d 32px,#f000 0),linear-gradient(175deg,#d3dae64d,#d3dae64d 16px,#f000 0);display:flex;flex-direction:column;height:100%;overflow-x:hidden;overflow-y:auto;scrollbar-color:#69707d80 #0000;scrollbar-width:thin}.kbnSolutionNav::-webkit-scrollbar{height:16px;width:16px}.kbnSolutionNav::-webkit-scrollbar-thumb{background-clip:content-box;background-color:#69707d80;border:6px solid #0000;border-radius:16px}.kbnSolutionNav::-webkit-scrollbar-corner,.kbnSolutionNav::-webkit-scrollbar-track{background-color:#0000}.kbnSolutionNav:focus{outline:none}.kbnSolutionNav[tabindex="0"]:focus:focus-visible{outline-style:auto}@media only screen and (min-width:768px) and (max-width:991px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:992px) and (max-width:1199px){.kbnSolutionNav{padding:24px;width:248px}}@media only screen and (min-width:1200px){.kbnSolutionNav{padding:24px;width:248px}}.kbnSolutionNav__title{align-items:center;display:inline-flex}.kbnSolutionNav__titleAvatar{align-self:flex-start;margin-right:12px}.kbnSolutionNav--hidden{opacity:0;pointer-events:none}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNav--hidden{transition:opacity .15s cubic-bezier(.694,.0482,.335,1)}}',""]),e.exports=t},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1349);case"v8light":return n(1351)}},function(e,t,n){var a=n(332),i=n(1350);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){var a=n(333),i=n(1143),r=n(1144);t=a(!1);var s=i(r);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px rgba(0,0,0,.175),0 1.9px 4px rgba(0,0,0,.125),0 4.5px 10px rgba(0,0,0,.125)}.kbnSolutionAvatar--xxl{background:#1d1e24 url("+s+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #0003,0 2.6px 8px -1px #00000026,0 5.7px 12px -1px rgba(0,0,0,.125),0 15px 15px -1px #0000001a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},function(e,t,n){var a=n(332),i=n(1352);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){var a=n(333),i=n(1143),r=n(1144);t=a(!1);var s=i(r);t.push([e.i,".kbnSolutionAvatar{box-shadow:0 .7px 1.4px #00000012,0 1.9px 4px #0000000d,0 4.5px 10px #0000000d}.kbnSolutionAvatar--xxl{background:#fff url("+s+") no-repeat;background-size:cover,125%;border-radius:100px;box-shadow:0 .9px 4px -1px #00000014,0 2.6px 8px -1px #0000000f,0 5.7px 12px -1px #0000000d,0 15px 15px -1px #0000000a;display:inline-block;height:100px;line-height:100px;text-align:center;width:100px}",""]),e.exports=t},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(1354);case"v8light":return n(1356)}},function(e,t,n){var a=n(332),i=n(1355);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(333)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#1d1e24!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},function(e,t,n){var a=n(332),i=n(1357);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);a(i,{insert:"head",singleton:!1}),e.exports=i.locals||{}},function(e,t,n){(t=n(333)(!1)).push([e.i,".kbnSolutionNavCollapseButton{left:232px;opacity:0;position:absolute;top:24px;z-index:2}@media screen and (prefers-reduced-motion:no-preference){.kbnSolutionNavCollapseButton{transition:opacity .15s,left .15s,background .15s}}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover{transition-delay:0s!important}.kbnSolutionNavCollapseButton:focus,.kbnSolutionNavCollapseButton:hover,.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{left:224px;opacity:1}.kbnSolutionNav__sidebar:hover .kbnSolutionNavCollapseButton{transition-delay:.7s}.kbnSolutionNavCollapseButton:not(.kbnSolutionNavCollapseButton-isCollapsed){background-color:#fff!important}.kbnSolutionNavCollapseButton-isCollapsed{align-items:flex-start;border-radius:0;bottom:0;height:100%;left:0!important;opacity:1!important;padding-top:32px;right:auto;top:0;transition-delay:0s!important;width:40px}",""]),e.exports=t},function(e,t,n){e.exports=n.p+"baad30acfe492601d08a0e839c9bb3f5.svg"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var a=n(5);const i=a.i18n.translate("xpack.securitySolution.dashboards.pageTitle",{defaultMessage:"Dashboards"}),r=a.i18n.translate("xpack.securitySolution.dashboards.dashboard.createDashboardTitle",{defaultMessage:"Editing New Dashboard"})},function(e,t,n){"use strict";let a;n.d(t,"a",(function(){return a})),function(e){e.top="top",e.bottom="bottom"}(a||(a={}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var a=n(2),i=n(395);const r=Object(i.c)(),s=()=>{const[e]=Object(a.useState)(r);return{globalKQLHeaderPortalNode:e}}},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return V}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(17),l=n(59),u=n.n(l),c=(n(1343),n(47)),d=n(5),p=(n(1348),n(13));const m=e=>{const{className:t,size:n,...a}=e,r={};return(e=>void 0===e.iconType)(e)&&(r.iconType=`logo${e.name.replace(/\s+/g,"")}`),Object(p.jsx)(o.EuiAvatar,i()({className:u()("kbnSolutionAvatar",{[`kbnSolutionAvatar--${n}`]:n},t),size:"xxl"===n?"xl":n,iconSize:n,color:"plain"},a,r))};n(1353);const f=d.i18n.translate("sharedUXPackages.solutionNav.collapsibleLabel",{defaultMessage:"Collapse side navigation"}),g=d.i18n.translate("sharedUXPackages.solutionNav.openLabel",{defaultMessage:"Open side navigation"}),b=({className:e,isCollapsed:t,...n})=>{const a=u()("kbnSolutionNavCollapseButton",{"kbnSolutionNavCollapseButton-isCollapsed":t},e);return Object(p.jsx)(o.EuiButtonIcon,i()({className:a,size:"s",color:"text",iconType:t?"menuRight":"menuLeft","aria-label":t?g:f,title:t?g:f},n))},y=(e,t)=>e.map((e=>(e.tabIndex=t?-1:void 0,e.items=e.items&&y(e.items,t),e))),v=Object(o.htmlIdGenerator)("SolutionNav"),h=({children:e,headingProps:t,icon:n,isOpenOnDesktop:a=!1,items:l,mobileBreakpoints:f=["xs","s"],closeFlyoutButtonPosition:g="outside",name:h,onCollapse:E,canBeCollapsed:x=!0,...j})=>{const O=Object(o.useIsWithinBreakpoints)(f),S=Object(o.useIsWithinBreakpoints)(["m"]),k=Object(o.useIsWithinMinBreakpoint)("l"),[w,T]=Object(r.useState)(!1),I=k&&!a&&x,C=!!e,M=u()("kbnSolutionNav",{"kbnSolutionNav--hidden":I}),_=(null==t?void 0:t.id)||v("heading"),A=(null==t?void 0:t.element)||"h2",P=Object(p.jsx)(o.EuiTitle,{size:"xs",id:_,"data-test-subj":null==t?void 0:t["data-test-subj"],className:"kbnSolutionNav__title"},Object(p.jsx)(A,null,n&&Object(p.jsx)(m,{className:"kbnSolutionNav__titleAvatar",iconType:n,name:h}),Object(p.jsx)("strong",null,Object(p.jsx)(c.FormattedMessage,{id:"sharedUXPackages.solutionNav.mobileTitleText",defaultMessage:"{solutionName} {menuText}",values:{solutionName:h||"Navigation",menuText:O?d.i18n.translate("sharedUXPackages.solutionNav.menuText",{defaultMessage:"menu"}):""}})))),F=Object(r.useMemo)((()=>C?e:l?Object(p.jsx)(o.EuiSideNav,i()({"aria-labelledby":_,"aria-hidden":I,items:y(l,I),mobileBreakpoints:[]},j)):null),[e,_,C,I,l,j]);return Object(p.jsx)(s.a.Fragment,null,O&&Object(p.jsx)(o.EuiCollapsibleNavGroup,{className:M,paddingSize:"none",background:"none",title:P,titleElement:"span",isCollapsible:x,initialIsOpen:!1},Object(p.jsx)(o.EuiPanel,{color:"transparent",paddingSize:"s"},F)),S&&Object(p.jsx)(s.a.Fragment,null,(w||!x)&&Object(p.jsx)(o.EuiFlyout,{ownFocus:!1,outsideClickCloses:!0,onClose:()=>T(!1),side:"left",size:248,closeButtonPosition:g,className:"kbnSolutionNav__flyout",hideCloseButton:!x},Object(p.jsx)("div",{className:M},P,Object(p.jsx)(o.EuiSpacer,{size:"l"}),F)),x&&Object(p.jsx)(b,{isCollapsed:!0,onClick:()=>{T(!w)}})),k&&Object(p.jsx)(s.a.Fragment,null,Object(p.jsx)("div",{className:M},P,Object(p.jsx)(o.EuiSpacer,{size:"l"}),F),x&&Object(p.jsx)(b,{isCollapsed:!a,onClick:E})))};var E=n(179);const x="solutionNavIsCollapsed",j=e=>{const t=t=>{var n;const a=Object(o.useIsWithinBreakpoints)(["m"]),s=Object(o.useIsWithinMinBreakpoint)("l"),[l,c]=Object(r.useState)(!JSON.parse(String(localStorage.getItem(x)))),{solutionNav:d,children:m,...f}=t,{euiTheme:g}=Object(o.useEuiTheme)(),{canBeCollapsed:b=!0}=d,y=a||b&&s&&!l,v=(e=>Object(E.css)("flex:0 1 0;overflow:hidden;",o.euiCanAnimate,"{transition:min-width ",e.animation.fast," ",e.animation.resistance,";}",""))(g),j=u()("kbnSolutionNav__sidebar",{"kbnSolutionNav__sidebar--shrink":y},null===(n=t.pageSideBarProps)||void 0===n?void 0:n.className,v),O=Object(p.jsx)(h,i()({isOpenOnDesktop:l,onCollapse:()=>{c(!l),localStorage.setItem(x,JSON.stringify(l))}},d)),S={paddingSize:"none",...t.pageSideBarProps,minWidth:y?g.size.xxl:void 0,className:j};return Object(p.jsx)(e,i()({},f,{pageSideBar:O,pageSideBarProps:S}),m)};var n;return t.displayName=`WithSolutionNavBar(${n=e,n.displayName||n.name||"UnnamedComponent"})`,t};n(11);const O=s.a.createContext(null);n(84);const S={name:"h42ud6",styles:"display:inherit;height:inherit;width:inherit;flex:1;flex-flow:column nowrap"},k=({children:e,navigateToUrl:t,currentAppId:n,...a})=>{const s=Object(r.useRef)(null),o=Object(r.useCallback)((e=>(({event:e,container:t,navigateToUrl:n,currentAppId:a})=>{if(!t||!a)return;const i=((e,t)=>{let n=e;do{var a,i;if("a"===(null===(a=n)||void 0===a?void 0:a.tagName.toLowerCase()))return n;const e=null===(i=n)||void 0===i?void 0:i.parentElement;if(!e||e===document.body||e===t)break;n=e}while(parent||parent!==document.body||parent!==t)})(e.target,t);if(!i)return;const r=i.href,s=""===i.target||"_self"===i.target,o=0===e.button;r&&s&&o&&!e.defaultPrevented&&!(e=>e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)(e)&&(e.preventDefault(),n(i.href))})({event:e,currentAppId:n,navigateToUrl:t,container:s.current})),[n,t]);return Object(p.jsx)("div",i()({onClick:o,ref:s,css:S,"data-test-subj":"kbnRedirectAppLink"},a),e)},w=({children:e,...t})=>Object(p.jsx)(k,i()({},function(){const e=Object(r.useContext)(O);if(!e)throw new Error("RedirectAppLinksContext is missing.  Ensure your component or React root is wrapped with RedirectAppLinksProvider.");return e}(),t),e);var T=n(1358),I=n.n(T);const C=d.i18n.translate("sharedUXPackages.card.noData.noPermission.title",{defaultMessage:"Contact your administrator"}),M=d.i18n.translate("sharedUXPackages.card.noData.noPermission.description",{defaultMessage:"This integration is not yet enabled. Your administrator has the required permissions to turn it on."}),_=d.i18n.translate("sharedUXPackages.card.noData.title",{defaultMessage:"Add Elastic Agent"}),A=d.i18n.translate("sharedUXPackages.card.noData.description",{defaultMessage:"Use Elastic Agent for a simple, unified way to collect data from your machines."}),P=()=>Object(p.jsx)(o.EuiImage,{size:"fullWidth",style:{width:"max(100%, 360px)",height:240,objectFit:"cover",background:"aliceblue"},url:I.a,alt:""}),F=({title:e,description:t,canAccessFleet:n,button:a,...r})=>Object(p.jsx)(o.EuiCard,i()({css:{maxWidth:400,marginInline:"auto"},paddingSize:"l",title:n?Object(p.jsx)(o.EuiScreenReaderOnly,null,Object(p.jsx)("span",null,e||_)):Object(p.jsx)(o.EuiTextColor,{color:"default"},C),description:n?t||A:Object(p.jsx)(o.EuiTextColor,{color:"default"},M),footer:(()=>{if(n)return a&&"string"!=typeof a?a:Object(p.jsx)(o.EuiButton,{fill:!0},a||e||_)})(),isDisabled:!n,image:Object(p.jsx)(P,null)},r)),D=s.a.createContext(null),N=({href:e,category:t,description:n,...a})=>{var s;const{canAccessFleet:o,addBasePath:l}=function(){const e=Object(r.useContext)(D);if(!e)throw new Error("NoDataCard Context is missing.  Ensure your component or React root is wrapped with NoDataCardContext.");return e}(),u=Object(r.useMemo)((()=>{if(e)return e;const n="/app/integrations/browse";return l(t?`${n}/${t}`:n)}),[l,e,t]);return Object(p.jsx)(w,null,Object(p.jsx)(F,i()({},a,{href:u,canAccessFleet:null!==(s=a.canAccessFleet)&&void 0!==s?s:o,description:n})))},R=({action:e})=>{const t=Object.keys(e);if(1!==t.length)return null;const n=t[0],a="elasticAgent"===n?"empty-page-agent-action":`empty-page-${n}-action`;return Object(p.jsx)(N,i()({key:a},e[n]))},L=({solution:e,logo:t,action:n,docsLink:a,pageTitle:i,pageDescription:r,className:s})=>{const l=i||d.i18n.translate("sharedUXPackages.noDataPage.welcomeTitle",{defaultMessage:"Welcome to Elastic {solution}!",values:{solution:e}}),f=a?Object(p.jsx)(o.EuiLink,{href:a,target:"_blank"},Object(p.jsx)(c.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro.link",defaultMessage:"learn more"})):null,g=null!=r?r:f?Object(p.jsx)(c.FormattedMessage,{id:"sharedUXPackages.noDataPage.intro",defaultMessage:"Add your data to get started, or {link} about {solution}.",values:{solution:e,link:f}}):Object(p.jsx)(c.FormattedMessage,{id:"sharedUXPackages.noDataPage.introNoDocLink",defaultMessage:"Add your data to get started."});return Object(p.jsx)(o.EuiPageTemplate.Section,{alignment:"center",grow:!0,className:u()("kbnNoDataPageContents",s),"data-test-subj":"kbnNoDataPage"},Object(p.jsx)(o.EuiText,{textAlign:"center"},Object(p.jsx)(m,{name:e,iconType:t||`logo${e}`,size:"xxl"}),Object(p.jsx)(o.EuiSpacer,{size:"l"}),Object(p.jsx)("h1",null,l),Object(p.jsx)(o.EuiTextColor,{color:"subdued"},Object(p.jsx)("p",null,g))),Object(p.jsx)(o.EuiSpacer,{size:"xxl"}),Object(p.jsx)(R,{action:n}))},z=e=>{const{className:t,noDataConfig:n,pageSideBar:a,pageSideBarProps:r,...s}=e;if(!n)return null;let l;a&&(l=Object(p.jsx)(o.EuiPageTemplate.Sidebar,r,a));const c=((e,t)=>u()("kbnPageTemplate","",t||""))(0,t);return Object(p.jsx)(o.EuiPageTemplate,i()({className:c,restrictWidth:950,panelled:!1,offset:0,minHeight:0},s),l,Object(p.jsx)(L,n))},B=j(z),q=({className:e,pageHeader:t,children:n,isEmptyState:a,pageSideBar:r,pageSideBarProps:s,...l})=>{let c,d;if(a&&t&&!n){const{iconType:e,pageTitle:a,description:i,rightSideItems:r}=t,s=a?Object(p.jsx)("h1",null,a):void 0,l=i?Object(p.jsx)("p",null,i):void 0;n=Object(p.jsx)(o.EuiPageTemplate.EmptyPrompt,{iconType:e,iconColor:"",title:s,body:l,actions:r})}else t&&(c=Object(p.jsx)(o.EuiPageTemplate.Header,t));if(r){const e={...s};e.sticky=!0,d=Object(p.jsx)(o.EuiPageTemplate.Sidebar,e,r)}const m=((e,t)=>u()("kbnPageTemplate","",t||""))(0,e);return Object(p.jsx)(o.EuiPageTemplate,i()({className:m,offset:0,minHeight:c?"calc(100vh - var(--euiFixedHeadersOffset, 0))":0,grow:!c&&void 0},l),d,c,n)},$=j(q),V=Object.assign((({className:e,children:t,solutionNav:n,noDataConfig:a,...r})=>a&&n?Object(p.jsx)(B,{"data-test-subj":r["data-test-subj"],className:e,noDataConfig:a,solutionNav:n}):a?Object(p.jsx)(z,{"data-test-subj":r["data-test-subj"],className:e,noDataConfig:a}):n?Object(p.jsx)($,i()({className:e,solutionNav:n,children:t},r)):Object(p.jsx)(q,i()({className:e,children:t},r))),{Sidebar:o.EuiPageTemplate.Sidebar,Header:o.EuiPageTemplate.Header,Section:o.EuiPageTemplate.Section,BottomBar:o.EuiPageTemplate.BottomBar,EmptyPrompt:o.EuiPageTemplate.EmptyPrompt})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,"SecuritySolutionTemplateWrapper",(function(){return Ct}));var a=n(23),i=n.n(a),r=n(2),s=n.n(r),o=n(44),l=n.n(o),u=n(17),c=n(114),d=n(1415),p=n(144),m=n(956),f=n(211),g=n(892),b=n(1121),y=n(901),v=n(491),h=n(394);const E=Object(r.createContext)(void 0),x=Object(r.memo)((({id:e,indexName:t,scopeId:n,isolateAction:a,children:i})=>{const{dataFormattedForFieldBrowser:o,loading:l}=Object(y.a)({eventId:e,indexName:t}),u=Object(r.useMemo)((()=>e&&t&&n&&a&&o?{eventId:e,indexName:t,scopeId:n,dataFormattedForFieldBrowser:o,isolateAction:a}:void 0),[e,t,n,o,a]);return l?s.a.createElement(h.a,null):u?s.a.createElement(E.Provider,{value:u},i):s.a.createElement(v.a,null)}));x.displayName="IsolateHostPanelProvider";const j=()=>{const e=Object(r.useContext)(E);if(!e)throw new Error("IsolateHostPanelContext can only be used within IsolateHostPanelContext provider");return e};var O=n(1322),S=n(1067);const k=()=>{const{openRightPanel:e}=Object(p.d)(),{dataFormattedForFieldBrowser:t,eventId:n,scopeId:a,indexName:i,isolateAction:o}=j(),{isIsolateActionSuccessBannerVisible:l,handleIsolationActionSuccess:u}=Object(b.a)(),{alertId:c,hostName:d}=Object(f.b)(t),y=Object(r.useCallback)((()=>e({id:m.a,params:{id:n,indexName:i,scopeId:a}})),[n,i,a,e]);return s.a.createElement(S.a,null,l&&s.a.createElement(g.c,{hostName:d,alertId:c,isolateAction:o}),s.a.createElement(O.a,{details:t,cancelCallback:y,successCallback:u,isolateAction:o}))};var w=n(47),T=n(130),I=n(1399);const C=`${n(427).a}HeaderTitle`;var M=n(1111),_=n(566);const A=()=>{const{isolateAction:e,dataFormattedForFieldBrowser:t}=j(),n=Object(_.c)({data:t}),a=Object(T.a)("sentinelOneManualHostActionsEnabled"),i=s.a.createElement(u.EuiFlexGroup,{responsive:!0,gutterSize:"s"},s.a.createElement(u.EuiFlexItem,{grow:!1},"isolateHost"===e?s.a.createElement(w.FormattedMessage,{id:"xpack.securitySolution.flyout.isolateHost.isolateTitle",defaultMessage:"Isolate host"}):s.a.createElement(w.FormattedMessage,{id:"xpack.securitySolution.flyout.isolateHost.releaseTitle",defaultMessage:"Release host"})),a&&n&&s.a.createElement(u.EuiFlexItem,{grow:!1},s.a.createElement(u.EuiBetaBadge,{label:I.f,tooltipContent:I.g})));return s.a.createElement(M.a,null,s.a.createElement(u.EuiTitle,{size:"s"},s.a.createElement("h4",{"data-test-subj":C},i)))},P=()=>s.a.createElement(s.a.Fragment,null,s.a.createElement(A,null),s.a.createElement(k,null));var F=n(140),D=n(233),N=n(201),R=n(890),L=n(601),z=n(1519),B=n(1422),q=n(1537);const $=[{key:m.a,component:e=>s.a.createElement(F.a,e.params,s.a.createElement(m.b,{path:e.path}))},{key:q.b,component:e=>s.a.createElement(F.a,e.params,s.a.createElement(q.a,e))},{key:D.a,component:e=>s.a.createElement(N.a,e.params,s.a.createElement(D.b,{path:e.path}))},{key:R.b,component:e=>s.a.createElement(L.a,e.params,s.a.createElement(R.c,{path:e.path}))},{key:"document-details-isolate-host",component:e=>s.a.createElement(x,e.params,s.a.createElement(P,{path:e.path}))},{key:z.c,component:e=>s.a.createElement(z.b,e.params)},{key:B.b,component:e=>s.a.createElement(B.a,e.params)}],V=({children:e})=>s.a.createElement(p.c,{storage:"url"},e);V.displayName="SecuritySolutionFlyoutContextProvider";const U=Object(r.memo)((()=>s.a.createElement(p.b,{registeredPanels:$,paddingSize:"none"})));U.displayName="SecuritySolutionFlyout";var H=n(5),Z=n(110),G=n(48),Q=n(129),W=n(118),K=n(122),J=n(164),Y=n(202),X=n(37),ee=n(20),te=n(4),ne=n(39),ae=n(45),ie=n(230),re=n(229),se=n(1261);const oe={[ie.HostsTableType.hosts]:se.a,[ie.HostsTableType.authentications]:se.c,[ie.HostsTableType.uncommonProcesses]:se.g,[ie.HostsTableType.anomalies]:se.b,[ie.HostsTableType.events]:se.d,[ie.HostsTableType.risk]:se.e,[ie.HostsTableType.sessions]:se.f};var le=n(563),ue=n(346),ce=n(1262),de=n(558),pe=n(469);const me={[de.a.events]:ce.c,[de.a.anomalies]:ce.a,[de.a.flows]:ce.d,[de.a.users]:ce.g,[de.a.http]:ce.e,[de.a.tls]:ce.f,[pe.a.dns]:ce.b};var fe=n(922),ge=n(237),be=n(154),ye=n(1105);const ve=e=>e.includes(te.oc)&&e.includes("/edit");var he=n(176),Ee=n(527),xe=n(1122);const je={[he.UsersTableType.allUsers]:xe.a,[he.UsersTableType.authentications]:xe.c,[he.UsersTableType.anomalies]:xe.b,[he.UsersTableType.risk]:xe.e,[he.UsersTableType.events]:xe.d,[he.UsersTableType.risk]:xe.e};var Oe=n(49),Se=n(1400);const ke=(e,t)=>{switch(e.pageName){case ne.SecurityPageName.hosts:return((e,t)=>{let n=[];if(null!=e.detailName&&(n=[...n,{text:e.detailName,href:t({path:Object(re.a)(e.detailName,""),deepLinkId:Q.a.hosts})}]),null!=e.tabName){const t=Object(ae.get)("tabName",e);if(!t)return n;n=[...n,{text:oe[t],href:""}]}return n})(e,t);case ne.SecurityPageName.network:return((e,t)=>{let n=[];null!=e.detailName&&(n=[{text:Object(le.b)(e.detailName),href:t({deepLinkId:Q.a.network,path:Object(ue.a)(e.detailName,e.flowTarget,"")})}]);const a=Object(ae.get)("tabName",e);return a?(n=[...n,{text:me[a],href:""}],n):n})(e,t);case ne.SecurityPageName.users:return((e,t)=>{let n=[];if(null!=e.detailName&&(n=[{text:e.detailName,href:t({path:Object(Ee.c)(e.detailName,""),deepLinkId:Q.a.users})}]),null!=e.tabName){const t=Object(ae.get)("tabName",e);if(!t)return n;n=[...n,{text:je[t],href:""}]}return n})(e,t);case ne.SecurityPageName.rules:case ne.SecurityPageName.rulesAdd:case ne.SecurityPageName.rulesCreate:return((e,t)=>{var n,a,i;let r=[];var s,o,l;return e.detailName&&null!==(n=e.state)&&void 0!==n&&n.ruleName&&(r=[...r,{text:e.state.ruleName,href:t({deepLinkId:Q.a.rules,path:Object(ge.d)(e.detailName,"")})}]),e.detailName&&null!==(a=e.state)&&void 0!==a&&a.ruleName&&e.tabName&&(r=[...r,{text:(s=e.tabName,null!==(o=fe.a[s])&&void 0!==o?o:fe.a[fe.b.alerts]),href:t({deepLinkId:Q.a.rules,path:Object(ge.c)(e.detailName,e.tabName,"")})}]),(l=e.pathName).includes(te.oc)&&l.includes("/create")&&(r=[...r,{text:be.e,href:""}]),ve(e.pathName)&&e.detailName&&null!==(i=e.state)&&void 0!==i&&i.ruleName&&(r=[...r,{text:be.Bb,href:""}]),ve(e.pathName)||!e.state||e.state.isExistingRule||(r=[...r,{text:ye.a,href:""}]),r})(e,t);case ne.SecurityPageName.exceptions:return((e,t)=>{var n;let a=[];var i;return(i=e.pathName).includes(te.vb)&&i.includes("/details")&&null!==(n=e.state)&&void 0!==n&&n.listName&&(a=[...a,{text:e.state.listName}]),a})(e);case ne.SecurityPageName.kubernetes:return((e,t)=>{let n=[];return null!=e.detailName&&(n=[{text:e.detailName,href:t({path:Object(J.e)(e.detailName,""),deepLinkId:Q.a.kubernetes})}]),n})(e,t);case ne.SecurityPageName.cloudSecurityPostureBenchmarks:return((e,t)=>{var n;const a=[];return null!==(n=e.state)&&void 0!==n&&n.ruleName&&a.push({text:e.state.ruleName}),a})(e);case ne.SecurityPageName.dashboards:return((e,t)=>{var n;if(Object(Oe.matchPath)(e.pathName,{path:"/create"}))return[{text:Se.a}];const a=null==e||null===(n=e.state)||void 0===n?void 0:n.dashboardName;return a?[{text:a}]:[]})(e)}return[]},we=(e,t,n,a)=>e.map((e=>({...e,...e.href&&!e.onClick&&{onClick:Te(e.href,t,n,a,e.text)}}))),Te=(e,t,n,a,i)=>r=>{r.preventDefault(),"string"==typeof i&&a.reportBreadcrumbClicked({title:i}),t(W.a.showTimeline({id:K.c.active,show:!1})),n({url:e})};var Ie=n(13);const Ce=Object(r.lazy)((()=>n.e(32).then(n.bind(null,1727)))),Me=e=>Object(Ie.jsx)(r.Suspense,{fallback:Object(Ie.jsx)(u.EuiLoadingSpinner,{size:"xl"})},Object(Ie.jsx)(Ce,e));var _e=n(1401),Ae=n(11),Pe=n.n(Ae),Fe=n(137),De=n(31),Ne=n(665),Re=n(1075),Le=n(21),ze=n(28);const Be=[{type:ze.a.separator,linkIds:[ne.SecurityPageName.dashboards]},{type:ze.a.separator,linkIds:[ne.SecurityPageName.rulesLanding,ne.SecurityPageName.alerts,ne.SecurityPageName.cloudSecurityPostureFindings,ne.SecurityPageName.case]},{type:ze.a.separator,linkIds:[ne.SecurityPageName.timelines,ne.SecurityPageName.threatIntelligence,ne.SecurityPageName.exploreLanding]}],qe=()=>{const e=(()=>{const e=Object(De.b)(),t=Object(Fe.o)();return Object(r.useMemo)((()=>{if(null!=e&&e.length)return e.reduce(((e,n)=>(n.disabled||(n.id===Q.a.landing?e.push(((e,t)=>({id:e.id,label:e.title,iconType:e.sideNavIcon,position:_e.a.bottom,appendSeparator:!0,...t({deepLinkId:e.id})}))(n,t)):e.push(((e,t)=>{var n,a,i;return{id:e.id,label:e.title,position:(i=e.id,i===Q.a.landing||i===Q.a.administration?_e.a.bottom:_e.a.top),...t({deepLinkId:e.id}),...e.sideNavIcon&&{iconType:e.sideNavIcon},...(null===(n=e.categories)||void 0===n?void 0:n.length)&&{categories:e.categories},...(null===(a=e.links)||void 0===a?void 0:a.length)&&{items:e.links.reduce(((e,n)=>(n.disabled||e.push({id:n.id,label:n.title,iconType:n.sideNavIcon,isBeta:n.isBeta,betaOptions:n.betaOptions,...t({deepLinkId:n.id})}),e)),[])}}})(n,t))),e)),[])}),[e,t])})(),t=(()=>{const[{pageName:e}]=Object(Y.a)();return Object(r.useMemo)((()=>{var t;const[n]=Object(ee.a)(e);return null!==(t=null==n?void 0:n.id)&&void 0!==t?t:""}),[e])})(),n=(()=>{const{chrome:{hasHeaderBanner$:e}}=Object(Z.i)().services,t=Pe()(e()),{euiTheme:n}=Object(u.useEuiTheme)();return t?`calc(93px + ${n.size.xl})`:void 0})(),a=(()=>{const e=Object(Re.a)(),[t]=Object(Ne.a)();return t||e?"50px":void 0})();return e?s.a.createElement(Me,{items:e,categories:Be,selectedId:t,panelTopOffset:n,panelBottomOffset:a,tracker:Le.h}):s.a.createElement(u.EuiLoadingSpinner,{size:"m","data-test-subj":"sideNavLoader"})},$e=H.i18n.translate("xpack.securitySolution.navigation.mainLabel",{defaultMessage:"Security"}),Ve=()=>{const{sideNavEnabled:e}=Object(Z.i)().services.configSettings;if((()=>{const e=Object(G.useDispatch)(),{telemetry:t}=Object(Z.i)().services,[n]=Object(Y.a)(),{navigateTo:a}=Object(Z.j)(),i=Object(J.m)();Object(r.useEffect)((()=>{if(!n.pageName||n.pageName===Q.a.case)return;const r=(({pageName:e},t)=>[{text:te.j,href:t({deepLinkId:Q.a.landing})},...Object(ee.a)(e).map((({title:e,id:n})=>({text:e,href:t({deepLinkId:n})})))])(n,i),s=ke(n,i);Object(X.b)({leading:we(r,e,a,t),trailing:we(s,e,a,t)})}),[n,i,e,a,t])})(),e)return{canBeCollapsed:!0,name:$e,icon:"logoSecurity",children:s.a.createElement(qe,null),closeFlyoutButtonPosition:"inside"}};var Ue=n(57),He=n(113);const Ze=()=>Object(Ue.createSelector)(W.b.selectTimeline,(e=>{var t,n,a,i,r;return{activeTab:null!==(t=null==e?void 0:e.activeTab)&&void 0!==t?t:K.d.query,status:null!==(n=null==e?void 0:e.status)&&void 0!==n?n:He.k.draft,show:null!==(a=null==e?void 0:e.show)&&void 0!==a&&a,updated:null!==(i=null==e?void 0:e.updated)&&void 0!==i?i:void 0,changed:null!==(r=null==e?void 0:e.changed)&&void 0!==r&&r}}));var Ge=n(112),Qe=n(395),We=n(1402);const Ke=l.a.div.withConfig({displayName:"StyledStickyWrapper",componentId:"sc-1cu1slq-0"})(["position:sticky;z-index:",";top:var(--kbnAppHeadersOffset,var(--euiFixedHeadersOffset,0));"],(e=>e.theme.eui.euiZHeaderBelowDataGrid)),Je=s.a.memo((()=>{const{globalKQLHeaderPortalNode:e}=Object(We.a)();return s.a.createElement(Ke,{id:"securitySolutionStickyKQL"},s.a.createElement(Qe.b,{node:e}))}));Je.displayName="GlobalKQLHeader";var Ye=n(212),Xe=n(145),et=n(742);const tt=s.a.memo((({showTimelineHeaderPanel:e,timelineId:t})=>s.a.createElement("div",{className:Xe.e,"data-test-subj":"flyoutBottomBar"},e&&s.a.createElement(et.a,{timelineId:t}))));tt.displayName="FlyoutBottomBar";var nt=n(59),at=n.n(nt),it=n(689);const rt=H.i18n.translate("xpack.securitySolution.timeline.flyout.pane.timelinePropertiesAriaLabel",{defaultMessage:"Timeline Properties"});var st=n(572),ot=n(1081),lt=n(0),ut=n.n(lt),ct=n(136),dt=n.n(ct),pt=n(67);const mt={after:"afterend",before:"beforebegin"};class custom_portal_EuiPortal extends r.Component{constructor(e){if(super(e),ut()(this,"portalNode",null),"undefined"==typeof window)return;const{insert:t}=this.props;if(this.portalNode=document.createElement("div"),this.portalNode.dataset.euiportal="true",null==t||null==t.sibling)document.body.appendChild(this.portalNode);else{const{sibling:e,position:n}=t;e.insertAdjacentElement(mt[n],this.portalNode)}}componentDidMount(){this.updatePortalRef(this.portalNode)}componentWillUnmount(){var e;null!==(e=this.portalNode)&&void 0!==e&&e.parentNode&&this.portalNode.parentNode.removeChild(this.portalNode),this.updatePortalRef(null)}componentDidUpdate(e){var t;if(!dt()(e.insert,this.props.insert)&&null!==(t=this.portalNode)&&void 0!==t&&t.parentNode&&this.portalNode.parentNode.removeChild(this.portalNode),this.portalNode)if(null==this.props.insert||null==this.props.insert.sibling)document.body.appendChild(this.portalNode);else{const{sibling:e,position:t}=this.props.insert;e.insertAdjacentElement(mt[t],this.portalNode)}}updatePortalRef(e){this.props.portalRef&&this.props.portalRef(e)}render(){return this.portalNode?Object(pt.createPortal)(this.props.children,this.portalNode):null}}var ft=n(582),gt=n(179);const bt=()=>s.a.createElement(Ie.Global,{styles:"body { overflow: hidden }"}),yt=({timelineId:e,visible:t=!0})=>{var n;const a=Object(r.useRef)(null),i=null!==(n=Object(Ge.b)(ft.c.timelineFullScreenSelector))&&void 0!==n&&n,o=(()=>{const e=Object(u.useEuiTheme)(),{euiTheme:t}=e;return gt.css`
    // euiOverlayMask styles
    position: fixed;
    top: var(--euiFixedHeadersOffset, 0);
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    background: ${Object(u.transparentize)(t.colors.ink,.5)};
    z-index: ${t.levels.flyout};

    ${u.euiCanAnimate} {
      animation: ${u.euiAnimFadeIn} ${t.animation.fast} ease-in;
    }

    &.timeline-wrapper--hidden {
      display: none;
    }

    .timeline-flyout {
      min-width: 150px;
      height: inherit;
      position: fixed;
      top: var(--euiFixedHeadersOffset, 0);
      right: 0;
      bottom: 0;
      left: 0;
      background: ${Object(u.euiBackgroundColor)(e,"plain")};
      ${u.euiCanAnimate} {
        animation: ${Object(u.euiAnimSlideInUp)(t.size.xxl)} ${t.animation.normal}
          cubic-bezier(0.39, 0.575, 0.565, 1);
      }

      .timeline-body {
        height: 100%;
        display: flex;
        flex-direction: column;
      }
    }

    &:not(.timeline-wrapper--full-screen) .timeline-flyout {
      margin: ${t.size.m};
      border-radius: ${t.border.radius.medium};

      .timeline-template-badge {
        border-radius: ${t.border.radius.medium} ${t.border.radius.medium} 0 0; // top corners only
      }
    }
  `})(),l=at()("timeline-wrapper",o,{"timeline-wrapper--full-screen":i,"timeline-wrapper--hidden":!t});return s.a.createElement("div",{"data-test-subj":"flyout-pane",ref:a},s.a.createElement(custom_portal_EuiPortal,{insert:{sibling:t?null:null==a?void 0:a.current,position:"after"}},s.a.createElement("div",{"data-test-subj":"timeline-wrapper",className:l},s.a.createElement("div",{"aria-label":rt,"data-test-subj":"timeline-flyout",className:"timeline-flyout"},s.a.createElement(it.a,{renderCellValue:ot.a,rowRenderers:st.b,timelineId:e})))),t&&s.a.createElement(bt,null))},vt=s.a.memo(yt);vt.displayName="Pane";var ht=n(707),Et=n(151),xt=n(22);const jt=({timelineId:e,onAppLeave:t})=>{const n=Object(r.useMemo)((()=>Ze()),[]),{show:a}=Object(Ge.a)((t=>n(t,e))),i=Object(G.useDispatch)(),o=Object(r.useCallback)((()=>{i(W.a.showTimeline({id:e,show:!1})),Object(Xe.i)()}),[i,e]),l=Object(r.useCallback)((e=>{e.key===u.keys.ESCAPE&&o()}),[o]);return((e,t)=>{const n=Object(G.useDispatch)(),{overlays:a,application:i,http:s}=Object(Z.i)().services,o=Object(ht.a)(),l=Object(Oe.useHistory)(),u=Object(r.useMemo)((()=>Ze()),[]),{status:c,updated:d,changed:p}=Object(Ge.a)((t=>u(t,e))),m=Object(r.useCallback)((()=>{n(W.a.showTimeline({id:e,show:!0})),n(W.a.setActiveTabTimeline({id:e,activeTab:Et.g.query})),n(W.a.toggleModalSaveTimeline({id:e,showModalSaveTimeline:!0}))}),[n,e]);Object(r.useEffect)((()=>{const e=l.block((t=>{const n=t.pathname.replace(te.k,"");if(!o(n)&&(p||c===He.k.draft&&null!=d))return async function(){await(null==a?void 0:a.openConfirm(xt.d,{title:xt.e,"data-test-subj":"appLeaveConfirmModal"}))?(e(),i.navigateToUrl(s.basePath.get()+t.pathname+t.hash+t.search,{state:t.state})):m()}(),!1}));return()=>{e()}}),[l,s.basePath,i,a,m,o,c,d,p]),Object(r.useEffect)((()=>(t(((e,t)=>!(null!=t?t:"").includes(te.i)&&(p||c===He.k.draft&&null!=d)?e.confirm(xt.d,xt.e,m):e.default())),()=>{t((e=>e.default()))})))})(e,t),s.a.createElement(s.a.Fragment,null,s.a.createElement(u.EuiFocusTrap,{disabled:!a},s.a.createElement(vt,{timelineId:e,visible:a})),s.a.createElement(tt,{showTimelineHeaderPanel:!a,timelineId:e}),s.a.createElement(u.EuiWindowEvent,{event:"keydown",handler:l}))};jt.displayName="FlyoutComponent";const Ot=s.a.memo(jt);Ot.displayName="Flyout";var St=n(60),kt=n(134),wt=n(218);const Tt=s.a.memo((()=>{(()=>{const{search:e,pathname:t}=Object(Oe.useLocation)(),[n,a]=Object(r.useState)(!1),{spaces:i}=Object(Z.i)().services,s=Object(r.useMemo)((()=>W.b.getTimelineByIdSelector()),[]),{resolveTimelineConfig:o,savedObjectId:l,show:u,activeTab:c,graphEventId:d}=Object(Ge.a)((e=>{var t;return null!==(t=s(e,K.c.active))&&void 0!==t?t:kt.b})),p=Object(r.useCallback)((()=>{var r,s,p;const m=new URLSearchParams(e),f=null!==(r=m.get(wt.a.timeline))&&void 0!==r?r:void 0,g={id:null!=l?l:"",isOpen:!!u,activeTab:c,graphEventId:d},b=null!==(s=Object(St.safeDecode)(null!=f?f:""))&&void 0!==s?s:g;if(n||!i||"aliasMatch"!==(null==o?void 0:o.outcome)||null==(null==o?void 0:o.alias_target_id))return null;const y={...b,id:null!==(p=o.alias_target_id)&&void 0!==p?p:""},v=Object(St.encode)(y);m.set(wt.a.timeline,v);const h=`${t}?${m.toString()}`;i.ui.redirectLegacyUrl({path:h,aliasPurpose:o.alias_purpose,objectNoun:wt.a.timeline}),a(!0)}),[c,d,n,t,o,l,e,u,i]);Object(r.useEffect)((()=>{p()}),[p])})();const{onAppLeave:e}=Object(Ye.b)().services;return s.a.createElement(Ot,{timelineId:K.c.active,onAppLeave:e})})),It=l()(d.a).withConfig({displayName:"StyledKibanaPageTemplate",componentId:"sc-hfq6ac-0"})([".kbnSolutionNav{background-color:",";}."," &{transform:none;}}"],(({theme:e})=>e.colors.emptyShade),c.d),Ct=s.a.memo((({children:e,...t})=>{var n;const a=Ve(),[o]=Object(Ne.a)(),l=Object(r.useMemo)((()=>Ze()),[]),{show:c}=Object(Ge.a)((e=>l(e,K.c.active))),{euiTheme:p,colorMode:m}=Object(u.useEuiTheme)();return s.a.createElement(V,null,s.a.createElement(It,i()({theme:p,$isShowingTimelineOverlay:c,paddingSize:"none",solutionNav:a,restrictWidth:!1},t),s.a.createElement(Je,null),s.a.createElement(d.a.Section,{className:"securityPageWrapper","data-test-subj":"pageContainer",paddingSize:null!==(n=t.paddingSize)&&void 0!==n?n:"l",alignment:"top",component:"div",grow:!0},e),o&&s.a.createElement(d.a.BottomBar,{"data-test-subj":"timeline-bottom-bar-container"},s.a.createElement(u.EuiThemeProvider,{colorMode:m},s.a.createElement(Tt,null))),s.a.createElement(U,null)))}));Ct.displayName="SecuritySolutionTemplateWrapper"}])]);