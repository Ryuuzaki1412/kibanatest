/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[47],{1134:function(e,t,i){"use strict";i.d(t,"b",(function(){return M})),i.d(t,"a",(function(){return V}));var l=i(2),n=i.n(l),a=i(17),c=i(44),o=i.n(c),s=i(48),r=i(124),u=i(127),b=i(110),d=i(5);const m=d.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeAnalyzerButton",{defaultMessage:"Close analyzer"}),p=d.i18n.translate("xpack.securitySolution.timeline.graphOverlay.closeSessionButton",{defaultMessage:"Close session viewer"});var g=i(122),v=i(118),S=i(121),j=i(282),O=i(134),T=i(112),y=i(745),h=i(116),w=i(1078),E=i(4),I=i(1109),F=i(562),C=i(189),f=i(446),D=i(135);const A=o()(a.EuiButtonIcon).withConfig({displayName:"FullScreenButtonIcon",componentId:"sc-tyt961-0"})(["margin:4px 0 4px 0;"]),x=({fullScreen:e,globalFullScreen:t,onCloseOverlay:i,isActiveTimelines:l,timelineFullScreen:c,toggleFullScreen:o,graphEventId:s,activeTab:r})=>n.a.createElement(a.EuiFlexGroup,{alignItems:"center",gutterSize:"none"},n.a.createElement(a.EuiFlexItem,{grow:!1},n.a.createElement(a.EuiButtonEmpty,{iconType:"cross",onClick:i,size:"xs","data-test-subj":"close-overlay"},l?r===g.d.graph?m:p:s?m:p)),!1===l&&n.a.createElement(a.EuiFlexItem,{grow:!1},n.a.createElement(a.EuiToolTip,{content:e?F.a:I.d},n.a.createElement(A,{"aria-label":Object(w.b)({globalFullScreen:t,isActiveTimelines:l,timelineFullScreen:c})?F.a:I.d,display:e?"fill":"empty",color:"primary","data-test-subj":"full-screen",iconType:"fullScreen",onClick:o}))));x.displayName="NavigationComponent";const P=n.a.memo(x),M=({scopeId:e})=>{const t=Object(s.useDispatch)(),i=Object(l.useMemo)((()=>Object(u.isTimelineScope)(e)?v.b.getTimelineByIdSelector():Object(u.isInTableScope)(e)?r.j.getTableByIdSelector():void 0),[e]),{globalFullScreen:a,setGlobalFullScreen:c}=Object(C.a)(),{timelineFullScreen:o,setTimelineFullScreen:b}=Object(C.c)(),d=Object(u.isTimelineScope)(e)?O.b:r.q,{graphEventId:m,sessionViewConfig:p,activeTab:S,prevActiveTab:j}=Object(T.a)((t=>{var l;return{activeTab:O.b.activeTab,prevActiveTab:O.b.prevActiveTab,...null!==(l=i&&i(t,e))&&void 0!==l?l:d}})),y=Object(u.getScopedActions)(e),h=Object(l.useCallback)((()=>{null!==document.querySelector(".euiDataGrid--fullScreen")?Object(u.isActiveTimeline)(e)?document.body.classList.add("euiDataGrid__restrictBody"):document.body.classList.add(E.rc,"euiDataGrid__restrictBody"):Object(u.isActiveTimeline)(e)?b(!1):c(!1),!1===Object(u.isActiveTimeline)(e)?y&&(t(y.updateGraphEventId({id:e,graphEventId:""})),t(y.updateSessionViewConfig({id:e,sessionViewConfig:null}))):S===g.d.graph?(y&&t(y.updateGraphEventId({id:e,graphEventId:""})),j!==g.d.session||p||t(v.a.setActiveTabTimeline({id:e,activeTab:g.d.query}))):S===g.d.session&&(Object(u.isTimelineScope)(e)&&(j!==g.d.graph||m?t(v.a.setActiveTabTimeline({id:e,activeTab:j})):t(v.a.setActiveTabTimeline({id:e,activeTab:g.d.query}))),y&&t(y.updateSessionViewConfig({id:e,sessionViewConfig:null})))}),[b,c,y,t,e,S,j,p,m]),I=Object(l.useMemo)((()=>Object(w.b)({globalFullScreen:a,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:o})),[a,e,o]),F=Object(l.useCallback)((()=>{Object(u.isActiveTimeline)(e)?b(!o):c(!a)}),[e,b,o,c,a]),f=Object(l.useMemo)((()=>n.a.createElement(P,{fullScreen:I,globalFullScreen:a,activeTab:S,onCloseOverlay:h,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:o,toggleFullScreen:F,graphEventId:m})),[I,a,S,h,e,o,F,m]);return{onCloseOverlay:h,Navigation:f}},V=({scopeId:e,entityType:t,height:i})=>{const{sessionView:a}=Object(b.i)().services,c=Object(l.useMemo)((()=>Object(u.isTimelineScope)(e)?v.b.getTimelineByIdSelector():Object(u.isInTableScope)(e)?r.j.getTableByIdSelector():void 0),[e]),{globalFullScreen:o}=Object(C.a)(),{timelineFullScreen:d}=Object(C.c)(),{canReadPolicyManagement:m}=Object(D.a)().endpointPrivileges,p=Object(u.isTimelineScope)(e)?O.b:r.q,{sessionViewConfig:E,activeTab:I}=Object(T.a)((t=>{var i;return{activeTab:O.b.activeTab,prevActiveTab:O.b.prevActiveTab,...null!==(i=c&&c(t,e))&&void 0!==i?i:p}})),F=Object(l.useMemo)((()=>Object(w.b)({globalFullScreen:o,isActiveTimelines:Object(u.isActiveTimeline)(e),timelineFullScreen:d})),[o,e,d]),A=Object(l.useMemo)((()=>Object(u.isActiveTimeline)(e)?h.SourcererScopeName.timeline:f.a.includes(e)?h.SourcererScopeName.detections:h.SourcererScopeName.default),[e]),{openEventDetailsPanel:x,shouldShowDetailsPanel:P,DetailsPanel:M}=(({entityType:e,isFlyoutView:t,sourcererScope:i,scopeId:a,tabType:c=g.d.query})=>{const{browserFields:o,selectedPatterns:b,runtimeMappings:d}=Object(S.d)(i),m=Object(s.useDispatch)(),p=Object(l.useMemo)((()=>Object(u.isTimelineScope)(a)?v.b.getTimelineByIdSelector():Object(u.isInTableScope)(a)?r.j.getTableByIdSelector():void 0),[a]),h=Object(l.useMemo)((()=>b.join(",")),[b]),w=Object(T.a)((e=>{var t,i;return null===(t=null!==(i=p&&p(e,a))&&void 0!==i?i:O.b)||void 0===t?void 0:t.expandedDetail})),E=Object(l.useRef)((()=>{})),I=()=>{},F=Object(l.useMemo)((()=>{var e;return!!(c&&w&&w[c]&&null!==(e=w[c])&&void 0!==e&&e.panelView)}),[w,c]),C=Object(u.getScopedActions)(a),f=Object(l.useCallback)((e=>{e&&C&&m(C.toggleDetailPanel({...e,tabType:c,id:a}))}),[C,a,m,c]),D=Object(l.useCallback)(((e,t)=>{e&&f({panelView:"eventDetail",params:{eventId:e,indexName:h}}),E.current=null!=t?t:I}),[f,h]),A=Object(l.useCallback)(((e,t)=>{f({panelView:"hostDetail",params:{hostName:e}}),E.current=null!=t?t:I}),[f]),x=Object(l.useCallback)(((e,t,i)=>{f({panelView:"networkDetail",params:{ip:e,flowTarget:t}}),E.current=null!=i?i:I}),[f]),P=Object(l.useCallback)(((e,t)=>{f({panelView:"userDetail",params:{userName:e}}),E.current=null!=t?t:I}),[f]),M=Object(l.useCallback)((()=>{var e;E.current&&E.current(),C&&m(C.toggleDetailPanel({tabType:c,id:a})),c&&null!==(e=w[c])&&void 0!==e&&e.panelView&&a===g.c.active&&F&&j.a.toggleExpandedDetail({})}),[C,c,w,a,F,m]),V=Object(l.useMemo)((()=>F?n.a.createElement(y.a,{browserFields:o,entityType:e,handleOnPanelClosed:M,isFlyoutView:t,runtimeMappings:d,tabType:c,scopeId:a}):null),[o,e,M,t,d,F,c,a]);return{openEventDetailsPanel:D,openHostDetailsPanel:A,openNetworkDetailsPanel:x,openUserDetailsPanel:P,handleOnDetailsPanelClosed:M,shouldShowDetailsPanel:F,DetailsPanel:V}})({isFlyoutView:!Object(u.isActiveTimeline)(e),entityType:t,sourcererScope:A,scopeId:e,tabType:Object(u.isActiveTimeline)(e)?I:g.d.query}),V=Object(l.useMemo)((()=>{const e=i?i-118:void 0;return null!==E?a.getSessionView({...E,loadAlertDetails:x,isFullScreen:F,height:e,canReadPolicyManagement:m}):null}),[i,E,a,x,F,m]);return{openEventDetailsPanel:x,shouldShowDetailsPanel:P,SessionView:V,DetailsPanel:M}}},1712:function(e,t,i){"use strict";i.r(t);var l=i(2),n=i.n(l),a=i(17),c=i(44),o=i.n(c),s=i(1134);const r=o()(a.EuiFlexItem).withConfig({displayName:"MaxWidthFlexItem",componentId:"sc-5l332w-0"})(["width:100%;"]),u=o.a.div.withConfig({displayName:"SessionViewWrapper",componentId:"sc-5l332w-1"})(["",""],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`)),b=o()(a.EuiFlexGroup).withConfig({displayName:"MaxWidthPageFlexGroup",componentId:"sc-5l332w-2"})(["max-width:100%;box-sizing:border-box;"]),d=o.a.div.withConfig({displayName:"VerticalRule",componentId:"sc-5l332w-3"})(["width:2px;height:100%;background:",";"],(({theme:e})=>e.eui.euiColorLightShade)),m=o()(a.EuiFlexItem).withConfig({displayName:"StyledFlexItem",componentId:"sc-5l332w-4"})([""," height:100%;min-width:320px;"],(({theme:e})=>`margin: 0 ${e.eui.euiSizeM};`));t.default=({timelineId:e})=>{const[t,i]=Object(l.useState)(0),c=Object(l.useCallback)((e=>{null!==e&&i(e.getBoundingClientRect().height)}),[]),{Navigation:o}=Object(s.b)({scopeId:e}),{SessionView:p,shouldShowDetailsPanel:g,DetailsPanel:v}=Object(s.a)({scopeId:e,height:t});return n.a.createElement(b,{alignItems:"flexStart",gutterSize:"none",ref:c,"data-test-subj":"timeline-session-content"},n.a.createElement(r,{grow:!1},n.a.createElement(a.EuiHorizontalRule,{margin:"none"}),o,n.a.createElement(a.EuiHorizontalRule,{margin:"none"}),n.a.createElement(a.EuiSpacer,{size:"m"}),n.a.createElement(u,null,p)),g&&n.a.createElement(n.a.Fragment,null,n.a.createElement(d,null),n.a.createElement(m,{grow:1},v)))}}}]);