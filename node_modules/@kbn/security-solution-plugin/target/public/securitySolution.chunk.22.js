/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements.
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.securitySolution_bundle_jsonpfunction=window.securitySolution_bundle_jsonpfunction||[]).push([[22],{1729:function(e,t,n){"use strict";n.r(t),n.d(t,"resolverPluginSetup",(function(){return g}));var r=n(48),i=n(80),o=n(1146),s=n(1274),a=n(1278);const c=e=>{const t=Object(o.composeWithDevTools)({name:"Resolver",actionsBlacklist:["userMovedPointer"]}),n=Object(i.applyMiddleware)(Object(a.a)(e));return Object(i.createStore)(s.a,t(n))};var l=n(957);function u({entityID:e,processName:t="process name",parentEntityID:n,timestamp:r=0,eventType:i="start",eventCategory:o="process",pid:s=0,eventID:a="event id"}){return{"@timestamp":r,event:{type:i,category:o,id:String(a)},agent:{id:"agent.id",version:"agent.version",type:"agent.type"},ecs:{version:"ecs.version"},user:{name:"user.name",domain:"user.domain"},process:{entity_id:e,executable:"executable",args:["args0","args1","args2"],name:t,pid:s,hash:{md5:"hash.md5"},parent:{pid:0,entity_id:n}}}}var d=n(263),p=n(356);function h({id:e,name:t="node",timestamp:n,parentID:r,stats:i={total:0,byCategory:{}}}){return{id:e,name:t,stats:i,parent:r,data:{"@timestamp":n,"process.entity_id":e,"process.name":t,"process.parent.entity_id":r}}}const v="id of first related event",f="id of second related event";function y(){const e={databaseDocumentID:"_id",entityIDs:{origin:"origin",firstChild:"firstChild",secondChild:"secondChild"}},{tree:t,relatedEvents:n,nodeDataResponse:r}=function({originID:e,firstChildID:t,secondChildID:n}){const{resolverTree:r,nodeDataResponse:i}=function({originID:e,firstChildID:t,secondChildID:n}){const r=u({pid:0,entityID:e,processName:"c.ext",parentEntityID:"none",timestamp:1600863932316}),i=u({pid:1,entityID:t,processName:"d",parentEntityID:e,timestamp:1600863932317}),o=u({pid:2,entityID:n,processName:"really_really_really_really_really_really_really_really_really_really_really_really_really_really_long_node_name",parentEntityID:e,timestamp:1600863932318}),s=[h({id:e,name:"c.ext",stats:{total:2,byCategory:{}},timestamp:1600863932316}),h({id:t,name:"d",parentID:e,timestamp:1600863932317}),h({id:n,name:"really_really_really_really_really_really_really_really_really_really_really_really_really_really_long_node_name",parentID:e,timestamp:1600863932318})];return{treeResponse:s,resolverTree:{originID:e,nodes:s},relatedEvents:{entityID:e,events:[],nextEvent:null},nodeDataResponse:[r,i,o]}}({originID:e,firstChildID:t,secondChildID:n}),o=p.d(r.nodes.find((t=>t.id===e))),s=[u({entityID:e,parentEntityID:o,eventID:v,eventType:"access",eventCategory:"registry"}),u({entityID:e,parentEntityID:o,eventID:f,eventType:"access",eventCategory:"registry"})],a=["authentication","database","driver","file","host","iam","intrusion_detection","malware","network","package","process","web"];for(const t of a)s.push(u({entityID:e,parentEntityID:o,eventID:`${s.length}`,eventType:"access",eventCategory:t}));return function(e,t,n,r){const i={total:0,byCategory:{}};for(const e of t){i.total++;for(const t of d.d(e))i.byCategory[t]=i.byCategory[t]?i.byCategory[t]+1:1}const o=e.nodes.find((e=>e.id===r));return o&&(o.stats=i),{tree:e,relatedEvents:{entityID:r,events:t,nextEvent:null},nodeDataResponse:n}}(r,s,i,e)}({originID:e.entityIDs.origin,firstChildID:e.entityIDs.firstChild,secondChildID:e.entityIDs.secondChild});return{metadata:e,dataAccessLayer:{relatedEvents:async({entityID:t,timeRange:r,indexPatterns:i})=>({entityID:t,events:t===e.entityIDs.origin?n.events:[],nextEvent:null}),eventsWithEntityIDAndCategory:async({entityID:t,category:r,after:i,timeRange:o,indexPatterns:s})=>({events:t===e.entityIDs.origin?n.events.filter((e=>d.d(e).includes(r))):[],nextEvent:null}),async event({nodeID:e,eventID:t,eventCategory:r,eventTimestamp:i,winlogRecordID:o,timeRange:s,indexPatterns:a}){var c;return null!==(c=n.events.find((e=>d.e(e)===t)))&&void 0!==c?c:null},nodeData:async({ids:e,timeRange:t,indexPatterns:n,limit:i})=>r,resolverTree:async({dataId:e,schema:n,timeRange:r,indices:i,ancestors:o,descendants:s})=>t.nodes,entities:async()=>[{name:"endpoint",schema:{id:"process.entity_id",parent:"process.parent.entity_id",ancestry:"process.Ext.ancestry",name:"process.name"},id:e.entityIDs.origin}]}}}function g(){return{Provider:r.Provider,storeFactory:c,ResolverWithoutProviders:l.a,mocks:{dataAccessLayer:{noAncestorsTwoChildrenWithRelatedEventsOnOrigin:y}}}}},236:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(17),i=n(5),o=n(47),s=n(2),a=n.n(s);const c=({count:e})=>{const[t,n,c]=Object(s.useMemo)((()=>function(e){var t;if(!Number.isFinite(e))return[e,"",""];const n=Math.pow(10,3*Math.min(Math.floor(Math.floor(Math.log10(e))/3),4)),r={compactThousands:i.i18n.translate("xpack.securitySolution.formattedNumber.compactThousands",{defaultMessage:"k"}),compactMillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactMillions",{defaultMessage:"M"}),compactBillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactBillions",{defaultMessage:"B"}),compactTrillions:i.i18n.translate("xpack.securitySolution.formattedNumber.compactTrillions",{defaultMessage:"T"})},o=new Map([[1,""],[1e3,r.compactThousands],[1e6,r.compactMillions],[1e9,r.compactBillions],[1e12,r.compactTrillions]]),s=i.i18n.translate("xpack.securitySolution.formattedNumber.compactOverflow",{defaultMessage:"+"}),a=null!==(t=o.get(n))&&void 0!==t?t:"";return[Math.floor(e/n),a,e/n%1>Number.EPSILON?s:""]}(e||0)),[e]);return null==e?null:0===e?a.a.createElement(a.a.Fragment,null,0):a.a.createElement(o.FormattedMessage,{id:"xpack.securitySolution.formattedNumber.countsLabel",description:"",defaultMessage:"{mantissa}{scale}{hasRemainder}",values:{mantissa:a.a.createElement(r.EuiI18nNumber,{value:t}),scale:n,hasRemainder:c}})},l=a.a.memo(c)},325:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(9);const i=(e,t=!1)=>{if(Array.isArray(e))return e;const n={};return Object.entries(e).forEach((([e,i])=>{const o=t&&Array.isArray(i)&&1===i.length;Object(r.merge)(n,Object(r.setWith)({},e,o?i[0]:i,Object))})),n}},513:function(e,t,n){!function(e){"use strict";var t,n=[],r="ResizeObserver loop completed with undelivered notifications.";!function(e){e.BORDER_BOX="border-box",e.CONTENT_BOX="content-box",e.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(t||(t={}));var i,o=function(e){return Object.freeze(e)},s=function(e,t){this.inlineSize=e,this.blockSize=t,o(this)},a=function(){function e(e,t,n,r){return this.x=e,this.y=t,this.width=n,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,o(this)}return e.prototype.toJSON=function(){var e=this;return{x:e.x,y:e.y,top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.width,height:e.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),c=function(e){return e instanceof SVGElement&&"getBBox"in e},l=function(e){if(c(e)){var t=e.getBBox(),n=t.width,r=t.height;return!n&&!r}var i=e,o=i.offsetWidth,s=i.offsetHeight;return!(o||s||e.getClientRects().length)},u=function(e){var t;if(e instanceof Element)return!0;var n=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(n&&e instanceof n.Element)},d="undefined"!=typeof window?window:{},p=new WeakMap,h=/auto|scroll/,v=/^tb|vertical/,f=/msie|trident/i.test(d.navigator&&d.navigator.userAgent),y=function(e){return parseFloat(e||"0")},g=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=!1),new s((n?t:e)||0,(n?e:t)||0)},m=o({devicePixelContentBoxSize:g(),borderBoxSize:g(),contentBoxSize:g(),contentRect:new a(0,0,0,0)}),b=function(e,t){if(void 0===t&&(t=!1),p.has(e)&&!t)return p.get(e);if(l(e))return p.set(e,m),m;var n=getComputedStyle(e),r=c(e)&&e.ownerSVGElement&&e.getBBox(),i=!f&&"border-box"===n.boxSizing,s=v.test(n.writingMode||""),u=!r&&h.test(n.overflowY||""),d=!r&&h.test(n.overflowX||""),b=r?0:y(n.paddingTop),E=r?0:y(n.paddingRight),D=r?0:y(n.paddingBottom),x=r?0:y(n.paddingLeft),w=r?0:y(n.borderTopWidth),I=r?0:y(n.borderRightWidth),T=r?0:y(n.borderBottomWidth),_=x+E,S=b+D,R=(r?0:y(n.borderLeftWidth))+I,O=w+T,C=d?e.offsetHeight-O-e.clientHeight:0,z=u?e.offsetWidth-R-e.clientWidth:0,B=i?_+R:0,M=i?S+O:0,N=r?r.width:y(n.width)-B-z,k=r?r.height:y(n.height)-M-C,P=N+_+z+R,A=k+S+C+O,W=o({devicePixelContentBoxSize:g(Math.round(N*devicePixelRatio),Math.round(k*devicePixelRatio),s),borderBoxSize:g(P,A,s),contentBoxSize:g(N,k,s),contentRect:new a(x,b,N,k)});return p.set(e,W),W},E=function(e,n,r){var i=b(e,r),o=i.borderBoxSize,s=i.contentBoxSize,a=i.devicePixelContentBoxSize;switch(n){case t.DEVICE_PIXEL_CONTENT_BOX:return a;case t.BORDER_BOX:return o;default:return s}},D=function(e){var t=b(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=o([t.borderBoxSize]),this.contentBoxSize=o([t.contentBoxSize]),this.devicePixelContentBoxSize=o([t.devicePixelContentBoxSize])},x=function(e){if(l(e))return 1/0;for(var t=0,n=e.parentNode;n;)t+=1,n=n.parentNode;return t},w=function(){var e=1/0,t=[];n.forEach((function(n){if(0!==n.activeTargets.length){var r=[];n.activeTargets.forEach((function(t){var n=new D(t.target),i=x(t.target);r.push(n),t.lastReportedSize=E(t.target,t.observedBox),i<e&&(e=i)})),t.push((function(){n.callback.call(n.observer,r,n.observer)})),n.activeTargets.splice(0,n.activeTargets.length)}}));for(var r=0,i=t;r<i.length;r++)(0,i[r])();return e},I=function(e){n.forEach((function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach((function(n){n.isActive()&&(x(n.target)>e?t.activeTargets.push(n):t.skippedTargets.push(n))}))}))},T=function(){var e,t=0;for(I(t);n.some((function(e){return e.activeTargets.length>0}));)t=w(),I(t);return n.some((function(e){return e.skippedTargets.length>0}))&&("function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:r}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=r),window.dispatchEvent(e)),t>0},_=[],S=function(e){if(!i){var t=0,n=document.createTextNode("");new MutationObserver((function(){return _.splice(0).forEach((function(e){return e()}))})).observe(n,{characterData:!0}),i=function(){n.textContent="".concat(t?t--:t++)}}_.push(e),i()},R=0,O={attributes:!0,characterData:!0,childList:!0,subtree:!0},C=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],z=function(e){return void 0===e&&(e=0),Date.now()+e},B=!1,M=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t,n=this;if(void 0===e&&(e=250),!B){B=!0;var r=z(e);t=function(){var t=!1;try{t=T()}finally{if(B=!1,e=r-z(),!R)return;t?n.run(1e3):e>0?n.run(e):n.start()}},S((function(){requestAnimationFrame(t)}))}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,O)};document.body?t():d.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),C.forEach((function(t){return d.addEventListener(t,e.listener,!0)})))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),C.forEach((function(t){return d.removeEventListener(t,e.listener,!0)})),this.stopped=!0)},e}()),N=function(e){!R&&e>0&&M.start(),!(R+=e)&&M.stop()},k=function(){function e(e,n){this.target=e,this.observedBox=n||t.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=E(this.target,this.observedBox,!0);return e=this.target,!c(e)&&!function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(e)&&"inline"===getComputedStyle(e).display&&(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),P=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},A=new WeakMap,W=function(e,t){for(var n=0;n<e.length;n+=1)if(e[n].target===t)return n;return-1},j=function(){function e(){}return e.connect=function(e,t){var n=new P(e,t);A.set(e,n)},e.observe=function(e,t,r){var i=A.get(e),o=0===i.observationTargets.length;W(i.observationTargets,t)<0&&(o&&n.push(i),i.observationTargets.push(new k(t,r&&r.box)),N(1),M.schedule())},e.unobserve=function(e,t){var r=A.get(e),i=W(r.observationTargets,t),o=1===r.observationTargets.length;i>=0&&(o&&n.splice(n.indexOf(r),1),r.observationTargets.splice(i,1),N(-1))},e.disconnect=function(e){var t=this,n=A.get(e);n.observationTargets.slice().forEach((function(n){return t.unobserve(e,n.target)})),n.activeTargets.splice(0,n.activeTargets.length)},e}(),F=function(){function e(e){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");j.connect(this,e)}return e.prototype.observe=function(e,t){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!u(e))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");j.observe(this,e,t)},e.prototype.unobserve=function(e){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!u(e))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");j.unobserve(this,e)},e.prototype.disconnect=function(){j.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}();e.ResizeObserver=F,e.ResizeObserverEntry=D,e.ResizeObserverSize=s,Object.defineProperty(e,"__esModule",{value:!0})}(t)}}]);